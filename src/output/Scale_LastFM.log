2025-02-16 15:25:05,638 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-16 15:25:08,415 - HyperRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-16 15:25:08,419 - Total Parameters: 388325
2025-02-16 15:25:14,097 - {'epoch': 0, 'rec_loss': '8.0336'}
2025-02-16 15:25:14,677 - {'Epoch': 0, 'HR@5': '0.0229', 'NDCG@5': '0.0157', 'HR@10': '0.0339', 'NDCG@10': '0.0191', 'HR@20': '0.0569', 'NDCG@20': '0.0250'}
2025-02-16 15:25:14,678 - Validation score increased.  Saving model ...
2025-02-16 15:25:20,006 - {'epoch': 1, 'rec_loss': '7.7471'}
2025-02-16 15:25:20,616 - {'Epoch': 1, 'HR@5': '0.0220', 'NDCG@5': '0.0132', 'HR@10': '0.0376', 'NDCG@10': '0.0182', 'HR@20': '0.0596', 'NDCG@20': '0.0238'}
2025-02-16 15:25:20,617 - EarlyStopping counter: 1 out of 10
2025-02-16 15:25:25,475 - {'epoch': 2, 'rec_loss': '7.5385'}
2025-02-16 15:25:26,044 - {'Epoch': 2, 'HR@5': '0.0229', 'NDCG@5': '0.0166', 'HR@10': '0.0413', 'NDCG@10': '0.0223', 'HR@20': '0.0670', 'NDCG@20': '0.0288'}
2025-02-16 15:25:26,045 - Validation score increased.  Saving model ...
2025-02-16 15:25:30,930 - {'epoch': 3, 'rec_loss': '7.3362'}
2025-02-16 15:25:31,529 - {'Epoch': 3, 'HR@5': '0.0303', 'NDCG@5': '0.0215', 'HR@10': '0.0450', 'NDCG@10': '0.0261', 'HR@20': '0.0761', 'NDCG@20': '0.0339'}
2025-02-16 15:25:31,530 - Validation score increased.  Saving model ...
2025-02-16 15:25:36,241 - {'epoch': 4, 'rec_loss': '7.1159'}
2025-02-16 15:25:36,837 - {'Epoch': 4, 'HR@5': '0.0330', 'NDCG@5': '0.0222', 'HR@10': '0.0569', 'NDCG@10': '0.0297', 'HR@20': '0.0853', 'NDCG@20': '0.0369'}
2025-02-16 15:25:36,838 - Validation score increased.  Saving model ...
2025-02-16 15:25:41,717 - {'epoch': 5, 'rec_loss': '6.9049'}
2025-02-16 15:25:42,301 - {'Epoch': 5, 'HR@5': '0.0404', 'NDCG@5': '0.0266', 'HR@10': '0.0587', 'NDCG@10': '0.0325', 'HR@20': '0.0972', 'NDCG@20': '0.0420'}
2025-02-16 15:25:42,303 - Validation score increased.  Saving model ...
2025-02-16 15:25:47,057 - {'epoch': 6, 'rec_loss': '6.7122'}
2025-02-16 15:25:47,644 - {'Epoch': 6, 'HR@5': '0.0394', 'NDCG@5': '0.0255', 'HR@10': '0.0624', 'NDCG@10': '0.0329', 'HR@20': '0.0954', 'NDCG@20': '0.0412'}
2025-02-16 15:25:47,645 - EarlyStopping counter: 1 out of 10
2025-02-16 15:25:52,347 - {'epoch': 7, 'rec_loss': '6.5408'}
2025-02-16 15:25:52,924 - {'Epoch': 7, 'HR@5': '0.0413', 'NDCG@5': '0.0261', 'HR@10': '0.0688', 'NDCG@10': '0.0348', 'HR@20': '0.0991', 'NDCG@20': '0.0424'}
2025-02-16 15:25:52,925 - Validation score increased.  Saving model ...
2025-02-16 15:25:57,544 - {'epoch': 8, 'rec_loss': '6.3876'}
2025-02-16 15:25:58,137 - {'Epoch': 8, 'HR@5': '0.0459', 'NDCG@5': '0.0282', 'HR@10': '0.0706', 'NDCG@10': '0.0362', 'HR@20': '0.1028', 'NDCG@20': '0.0442'}
2025-02-16 15:25:58,139 - Validation score increased.  Saving model ...
2025-02-16 15:26:03,119 - {'epoch': 9, 'rec_loss': '6.2440'}
2025-02-16 15:26:03,652 - {'Epoch': 9, 'HR@5': '0.0459', 'NDCG@5': '0.0285', 'HR@10': '0.0716', 'NDCG@10': '0.0367', 'HR@20': '0.1064', 'NDCG@20': '0.0454'}
2025-02-16 15:26:03,654 - Validation score increased.  Saving model ...
2025-02-16 15:26:08,542 - {'epoch': 10, 'rec_loss': '6.1274'}
2025-02-16 15:26:09,094 - {'Epoch': 10, 'HR@5': '0.0422', 'NDCG@5': '0.0261', 'HR@10': '0.0752', 'NDCG@10': '0.0367', 'HR@20': '0.1138', 'NDCG@20': '0.0463'}
2025-02-16 15:26:09,095 - Validation score increased.  Saving model ...
2025-02-16 15:26:13,944 - {'epoch': 11, 'rec_loss': '6.0414'}
2025-02-16 15:26:14,534 - {'Epoch': 11, 'HR@5': '0.0450', 'NDCG@5': '0.0279', 'HR@10': '0.0752', 'NDCG@10': '0.0378', 'HR@20': '0.1165', 'NDCG@20': '0.0481'}
2025-02-16 15:26:14,535 - Validation score increased.  Saving model ...
2025-02-16 15:26:19,483 - {'epoch': 12, 'rec_loss': '5.9432'}
2025-02-16 15:26:20,045 - {'Epoch': 12, 'HR@5': '0.0532', 'NDCG@5': '0.0336', 'HR@10': '0.0789', 'NDCG@10': '0.0420', 'HR@20': '0.1165', 'NDCG@20': '0.0514'}
2025-02-16 15:26:20,046 - Validation score increased.  Saving model ...
2025-02-16 15:26:25,781 - {'epoch': 13, 'rec_loss': '5.8796'}
2025-02-16 15:26:26,329 - {'Epoch': 13, 'HR@5': '0.0514', 'NDCG@5': '0.0315', 'HR@10': '0.0798', 'NDCG@10': '0.0406', 'HR@20': '0.1202', 'NDCG@20': '0.0509'}
2025-02-16 15:26:26,331 - EarlyStopping counter: 1 out of 10
2025-02-16 15:26:31,209 - {'epoch': 14, 'rec_loss': '5.8250'}
2025-02-16 15:26:31,778 - {'Epoch': 14, 'HR@5': '0.0477', 'NDCG@5': '0.0309', 'HR@10': '0.0844', 'NDCG@10': '0.0425', 'HR@20': '0.1229', 'NDCG@20': '0.0524'}
2025-02-16 15:26:31,779 - Validation score increased.  Saving model ...
2025-02-16 15:26:36,526 - {'epoch': 15, 'rec_loss': '5.7562'}
2025-02-16 15:26:37,067 - {'Epoch': 15, 'HR@5': '0.0560', 'NDCG@5': '0.0327', 'HR@10': '0.0853', 'NDCG@10': '0.0421', 'HR@20': '0.1239', 'NDCG@20': '0.0520'}
2025-02-16 15:26:37,068 - EarlyStopping counter: 1 out of 10
2025-02-16 15:26:41,777 - {'epoch': 16, 'rec_loss': '5.7083'}
2025-02-16 15:26:42,344 - {'Epoch': 16, 'HR@5': '0.0569', 'NDCG@5': '0.0358', 'HR@10': '0.0881', 'NDCG@10': '0.0458', 'HR@20': '0.1248', 'NDCG@20': '0.0551'}
2025-02-16 15:26:42,345 - Validation score increased.  Saving model ...
2025-02-16 15:26:47,156 - {'epoch': 17, 'rec_loss': '5.6622'}
2025-02-16 15:26:47,795 - {'Epoch': 17, 'HR@5': '0.0569', 'NDCG@5': '0.0344', 'HR@10': '0.0917', 'NDCG@10': '0.0455', 'HR@20': '0.1257', 'NDCG@20': '0.0540'}
2025-02-16 15:26:47,797 - EarlyStopping counter: 1 out of 10
2025-02-16 15:26:52,656 - {'epoch': 18, 'rec_loss': '5.6263'}
2025-02-16 15:26:53,258 - {'Epoch': 18, 'HR@5': '0.0596', 'NDCG@5': '0.0368', 'HR@10': '0.0853', 'NDCG@10': '0.0451', 'HR@20': '0.1275', 'NDCG@20': '0.0558'}
2025-02-16 15:26:53,260 - Validation score increased.  Saving model ...
2025-02-16 15:26:58,027 - {'epoch': 19, 'rec_loss': '5.5950'}
2025-02-16 15:26:58,627 - {'Epoch': 19, 'HR@5': '0.0587', 'NDCG@5': '0.0357', 'HR@10': '0.0890', 'NDCG@10': '0.0453', 'HR@20': '0.1321', 'NDCG@20': '0.0562'}
2025-02-16 15:26:58,629 - Validation score increased.  Saving model ...
2025-02-16 15:27:03,626 - {'epoch': 20, 'rec_loss': '5.5639'}
2025-02-16 15:27:04,192 - {'Epoch': 20, 'HR@5': '0.0578', 'NDCG@5': '0.0362', 'HR@10': '0.0927', 'NDCG@10': '0.0475', 'HR@20': '0.1330', 'NDCG@20': '0.0577'}
2025-02-16 15:27:04,194 - Validation score increased.  Saving model ...
2025-02-16 15:27:09,031 - {'epoch': 21, 'rec_loss': '5.5493'}
2025-02-16 15:27:09,600 - {'Epoch': 21, 'HR@5': '0.0688', 'NDCG@5': '0.0396', 'HR@10': '0.0936', 'NDCG@10': '0.0475', 'HR@20': '0.1321', 'NDCG@20': '0.0572'}
2025-02-16 15:27:09,602 - EarlyStopping counter: 1 out of 10
2025-02-16 15:27:14,230 - {'epoch': 22, 'rec_loss': '5.5109'}
2025-02-16 15:27:14,761 - {'Epoch': 22, 'HR@5': '0.0615', 'NDCG@5': '0.0371', 'HR@10': '0.0917', 'NDCG@10': '0.0470', 'HR@20': '0.1367', 'NDCG@20': '0.0583'}
2025-02-16 15:27:14,763 - Validation score increased.  Saving model ...
2025-02-16 15:27:19,789 - {'epoch': 23, 'rec_loss': '5.4919'}
2025-02-16 15:27:20,357 - {'Epoch': 23, 'HR@5': '0.0606', 'NDCG@5': '0.0368', 'HR@10': '0.0908', 'NDCG@10': '0.0466', 'HR@20': '0.1339', 'NDCG@20': '0.0575'}
2025-02-16 15:27:20,358 - EarlyStopping counter: 1 out of 10
2025-02-16 15:27:25,174 - {'epoch': 24, 'rec_loss': '5.4862'}
2025-02-16 15:27:25,752 - {'Epoch': 24, 'HR@5': '0.0587', 'NDCG@5': '0.0350', 'HR@10': '0.0890', 'NDCG@10': '0.0448', 'HR@20': '0.1349', 'NDCG@20': '0.0564'}
2025-02-16 15:27:25,753 - EarlyStopping counter: 2 out of 10
2025-02-16 15:27:30,719 - {'epoch': 25, 'rec_loss': '5.4728'}
2025-02-16 15:27:31,279 - {'Epoch': 25, 'HR@5': '0.0633', 'NDCG@5': '0.0385', 'HR@10': '0.0927', 'NDCG@10': '0.0480', 'HR@20': '0.1349', 'NDCG@20': '0.0586'}
2025-02-16 15:27:31,280 - Validation score increased.  Saving model ...
2025-02-16 15:27:36,341 - {'epoch': 26, 'rec_loss': '5.4546'}
2025-02-16 15:27:36,932 - {'Epoch': 26, 'HR@5': '0.0633', 'NDCG@5': '0.0388', 'HR@10': '0.0936', 'NDCG@10': '0.0484', 'HR@20': '0.1394', 'NDCG@20': '0.0598'}
2025-02-16 15:27:36,934 - Validation score increased.  Saving model ...
2025-02-16 15:27:42,323 - {'epoch': 27, 'rec_loss': '5.4302'}
2025-02-16 15:27:42,896 - {'Epoch': 27, 'HR@5': '0.0651', 'NDCG@5': '0.0399', 'HR@10': '0.0945', 'NDCG@10': '0.0494', 'HR@20': '0.1294', 'NDCG@20': '0.0581'}
2025-02-16 15:27:42,897 - EarlyStopping counter: 1 out of 10
2025-02-16 15:27:47,597 - {'epoch': 28, 'rec_loss': '5.4352'}
2025-02-16 15:27:48,154 - {'Epoch': 28, 'HR@5': '0.0633', 'NDCG@5': '0.0389', 'HR@10': '0.0917', 'NDCG@10': '0.0482', 'HR@20': '0.1312', 'NDCG@20': '0.0582'}
2025-02-16 15:27:48,155 - EarlyStopping counter: 2 out of 10
2025-02-16 15:27:53,085 - {'epoch': 29, 'rec_loss': '5.4122'}
2025-02-16 15:27:53,692 - {'Epoch': 29, 'HR@5': '0.0633', 'NDCG@5': '0.0378', 'HR@10': '0.0963', 'NDCG@10': '0.0484', 'HR@20': '0.1394', 'NDCG@20': '0.0592'}
2025-02-16 15:27:53,693 - EarlyStopping counter: 3 out of 10
2025-02-16 15:27:58,598 - {'epoch': 30, 'rec_loss': '5.3917'}
2025-02-16 15:27:59,172 - {'Epoch': 30, 'HR@5': '0.0651', 'NDCG@5': '0.0390', 'HR@10': '0.0945', 'NDCG@10': '0.0486', 'HR@20': '0.1394', 'NDCG@20': '0.0598'}
2025-02-16 15:27:59,174 - EarlyStopping counter: 4 out of 10
2025-02-16 15:28:04,057 - {'epoch': 31, 'rec_loss': '5.3782'}
2025-02-16 15:28:04,585 - {'Epoch': 31, 'HR@5': '0.0679', 'NDCG@5': '0.0416', 'HR@10': '0.0954', 'NDCG@10': '0.0505', 'HR@20': '0.1422', 'NDCG@20': '0.0622'}
2025-02-16 15:28:04,586 - Validation score increased.  Saving model ...
2025-02-16 15:28:09,290 - {'epoch': 32, 'rec_loss': '5.3692'}
2025-02-16 15:28:09,844 - {'Epoch': 32, 'HR@5': '0.0642', 'NDCG@5': '0.0389', 'HR@10': '0.0936', 'NDCG@10': '0.0483', 'HR@20': '0.1495', 'NDCG@20': '0.0624'}
2025-02-16 15:28:09,845 - Validation score increased.  Saving model ...
2025-02-16 15:28:14,755 - {'epoch': 33, 'rec_loss': '5.3531'}
2025-02-16 15:28:15,299 - {'Epoch': 33, 'HR@5': '0.0670', 'NDCG@5': '0.0424', 'HR@10': '0.0972', 'NDCG@10': '0.0520', 'HR@20': '0.1440', 'NDCG@20': '0.0638'}
2025-02-16 15:28:15,301 - Validation score increased.  Saving model ...
2025-02-16 15:28:20,026 - {'epoch': 34, 'rec_loss': '5.3347'}
2025-02-16 15:28:20,573 - {'Epoch': 34, 'HR@5': '0.0615', 'NDCG@5': '0.0385', 'HR@10': '0.0963', 'NDCG@10': '0.0497', 'HR@20': '0.1431', 'NDCG@20': '0.0614'}
2025-02-16 15:28:20,574 - EarlyStopping counter: 1 out of 10
2025-02-16 15:28:25,327 - {'epoch': 35, 'rec_loss': '5.3313'}
2025-02-16 15:28:25,914 - {'Epoch': 35, 'HR@5': '0.0679', 'NDCG@5': '0.0423', 'HR@10': '0.0936', 'NDCG@10': '0.0505', 'HR@20': '0.1477', 'NDCG@20': '0.0639'}
2025-02-16 15:28:25,916 - Validation score increased.  Saving model ...
2025-02-16 15:28:30,881 - {'epoch': 36, 'rec_loss': '5.3297'}
2025-02-16 15:28:31,451 - {'Epoch': 36, 'HR@5': '0.0651', 'NDCG@5': '0.0418', 'HR@10': '0.0954', 'NDCG@10': '0.0516', 'HR@20': '0.1450', 'NDCG@20': '0.0639'}
2025-02-16 15:28:31,452 - EarlyStopping counter: 1 out of 10
2025-02-16 15:28:36,441 - {'epoch': 37, 'rec_loss': '5.3102'}
2025-02-16 15:28:36,986 - {'Epoch': 37, 'HR@5': '0.0651', 'NDCG@5': '0.0408', 'HR@10': '0.0927', 'NDCG@10': '0.0496', 'HR@20': '0.1376', 'NDCG@20': '0.0609'}
2025-02-16 15:28:36,987 - EarlyStopping counter: 2 out of 10
2025-02-16 15:28:42,116 - {'epoch': 38, 'rec_loss': '5.3058'}
2025-02-16 15:28:42,672 - {'Epoch': 38, 'HR@5': '0.0615', 'NDCG@5': '0.0403', 'HR@10': '0.0908', 'NDCG@10': '0.0499', 'HR@20': '0.1394', 'NDCG@20': '0.0621'}
2025-02-16 15:28:42,674 - EarlyStopping counter: 3 out of 10
2025-02-16 15:28:48,158 - {'epoch': 39, 'rec_loss': '5.3045'}
2025-02-16 15:28:48,749 - {'Epoch': 39, 'HR@5': '0.0624', 'NDCG@5': '0.0396', 'HR@10': '0.0991', 'NDCG@10': '0.0513', 'HR@20': '0.1440', 'NDCG@20': '0.0625'}
2025-02-16 15:28:48,751 - EarlyStopping counter: 4 out of 10
2025-02-16 15:28:53,553 - {'epoch': 40, 'rec_loss': '5.2930'}
2025-02-16 15:28:54,091 - {'Epoch': 40, 'HR@5': '0.0651', 'NDCG@5': '0.0405', 'HR@10': '0.1009', 'NDCG@10': '0.0520', 'HR@20': '0.1440', 'NDCG@20': '0.0627'}
2025-02-16 15:28:54,092 - EarlyStopping counter: 5 out of 10
2025-02-16 15:28:58,873 - {'epoch': 41, 'rec_loss': '5.2871'}
2025-02-16 15:28:59,414 - {'Epoch': 41, 'HR@5': '0.0716', 'NDCG@5': '0.0449', 'HR@10': '0.0954', 'NDCG@10': '0.0527', 'HR@20': '0.1486', 'NDCG@20': '0.0661'}
2025-02-16 15:28:59,415 - Validation score increased.  Saving model ...
2025-02-16 15:29:04,153 - {'epoch': 42, 'rec_loss': '5.2838'}
2025-02-16 15:29:04,670 - {'Epoch': 42, 'HR@5': '0.0615', 'NDCG@5': '0.0393', 'HR@10': '0.0963', 'NDCG@10': '0.0505', 'HR@20': '0.1468', 'NDCG@20': '0.0633'}
2025-02-16 15:29:04,671 - EarlyStopping counter: 1 out of 10
2025-02-16 15:29:09,595 - {'epoch': 43, 'rec_loss': '5.2613'}
2025-02-16 15:29:10,139 - {'Epoch': 43, 'HR@5': '0.0633', 'NDCG@5': '0.0413', 'HR@10': '0.0954', 'NDCG@10': '0.0516', 'HR@20': '0.1431', 'NDCG@20': '0.0637'}
2025-02-16 15:29:10,140 - EarlyStopping counter: 2 out of 10
2025-02-16 15:29:14,780 - {'epoch': 44, 'rec_loss': '5.2662'}
2025-02-16 15:29:15,337 - {'Epoch': 44, 'HR@5': '0.0587', 'NDCG@5': '0.0398', 'HR@10': '0.1009', 'NDCG@10': '0.0534', 'HR@20': '0.1468', 'NDCG@20': '0.0650'}
2025-02-16 15:29:15,338 - EarlyStopping counter: 3 out of 10
2025-02-16 15:29:20,340 - {'epoch': 45, 'rec_loss': '5.2630'}
2025-02-16 15:29:20,887 - {'Epoch': 45, 'HR@5': '0.0651', 'NDCG@5': '0.0421', 'HR@10': '0.0982', 'NDCG@10': '0.0528', 'HR@20': '0.1376', 'NDCG@20': '0.0627'}
2025-02-16 15:29:20,888 - EarlyStopping counter: 4 out of 10
2025-02-16 15:29:25,682 - {'epoch': 46, 'rec_loss': '5.2491'}
2025-02-16 15:29:26,266 - {'Epoch': 46, 'HR@5': '0.0642', 'NDCG@5': '0.0396', 'HR@10': '0.0982', 'NDCG@10': '0.0505', 'HR@20': '0.1431', 'NDCG@20': '0.0618'}
2025-02-16 15:29:26,268 - EarlyStopping counter: 5 out of 10
2025-02-16 15:29:31,001 - {'epoch': 47, 'rec_loss': '5.2306'}
2025-02-16 15:29:31,512 - {'Epoch': 47, 'HR@5': '0.0633', 'NDCG@5': '0.0413', 'HR@10': '0.0954', 'NDCG@10': '0.0518', 'HR@20': '0.1477', 'NDCG@20': '0.0649'}
2025-02-16 15:29:31,513 - EarlyStopping counter: 6 out of 10
2025-02-16 15:29:36,343 - {'epoch': 48, 'rec_loss': '5.2310'}
2025-02-16 15:29:36,930 - {'Epoch': 48, 'HR@5': '0.0688', 'NDCG@5': '0.0431', 'HR@10': '0.0991', 'NDCG@10': '0.0527', 'HR@20': '0.1505', 'NDCG@20': '0.0656'}
2025-02-16 15:29:36,931 - EarlyStopping counter: 7 out of 10
2025-02-16 15:29:41,760 - {'epoch': 49, 'rec_loss': '5.2285'}
2025-02-16 15:29:42,348 - {'Epoch': 49, 'HR@5': '0.0642', 'NDCG@5': '0.0403', 'HR@10': '0.0991', 'NDCG@10': '0.0515', 'HR@20': '0.1486', 'NDCG@20': '0.0640'}
2025-02-16 15:29:42,349 - EarlyStopping counter: 8 out of 10
2025-02-16 15:29:47,151 - {'epoch': 50, 'rec_loss': '5.2243'}
2025-02-16 15:29:47,684 - {'Epoch': 50, 'HR@5': '0.0651', 'NDCG@5': '0.0399', 'HR@10': '0.1009', 'NDCG@10': '0.0515', 'HR@20': '0.1505', 'NDCG@20': '0.0640'}
2025-02-16 15:29:47,685 - EarlyStopping counter: 9 out of 10
2025-02-16 15:29:52,377 - {'epoch': 51, 'rec_loss': '5.2188'}
2025-02-16 15:29:52,943 - {'Epoch': 51, 'HR@5': '0.0661', 'NDCG@5': '0.0408', 'HR@10': '0.1009', 'NDCG@10': '0.0519', 'HR@20': '0.1486', 'NDCG@20': '0.0640'}
2025-02-16 15:29:52,944 - EarlyStopping counter: 10 out of 10
2025-02-16 15:29:52,944 - Early stopping
2025-02-16 15:29:52,944 - ---------------Test Score---------------
2025-02-16 15:29:53,480 - {'Epoch': 0, 'HR@5': '0.0523', 'NDCG@5': '0.0346', 'HR@10': '0.0716', 'NDCG@10': '0.0407', 'HR@20': '0.1018', 'NDCG@20': '0.0484'}
2025-02-16 15:29:53,481 - Scale_LastFM
2025-02-16 15:29:53,481 - {'Epoch': 0, 'HR@5': '0.0523', 'NDCG@5': '0.0346', 'HR@10': '0.0716', 'NDCG@10': '0.0407', 'HR@20': '0.1018', 'NDCG@20': '0.0484'}
2025-02-18 15:08:14,859 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-18 15:08:19,483 - HyperRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-18 15:08:19,501 - Total Parameters: 388325
2025-02-18 15:08:27,295 - {'epoch': 0, 'rec_loss': '8.0343'}
2025-02-18 15:08:27,987 - {'Epoch': 0, 'HR@5': '0.0239', 'NDCG@5': '0.0168', 'HR@10': '0.0339', 'NDCG@10': '0.0199', 'HR@20': '0.0569', 'NDCG@20': '0.0258'}
2025-02-18 15:08:27,988 - Validation score increased.  Saving model ...
2025-02-18 15:08:34,463 - {'epoch': 1, 'rec_loss': '7.7565'}
2025-02-18 15:08:35,168 - {'Epoch': 1, 'HR@5': '0.0229', 'NDCG@5': '0.0135', 'HR@10': '0.0376', 'NDCG@10': '0.0184', 'HR@20': '0.0624', 'NDCG@20': '0.0245'}
2025-02-18 15:08:35,170 - EarlyStopping counter: 1 out of 10
2025-02-18 15:08:41,822 - {'epoch': 2, 'rec_loss': '7.5623'}
2025-02-18 15:08:42,409 - {'Epoch': 2, 'HR@5': '0.0183', 'NDCG@5': '0.0139', 'HR@10': '0.0376', 'NDCG@10': '0.0201', 'HR@20': '0.0606', 'NDCG@20': '0.0259'}
2025-02-18 15:08:42,410 - Validation score increased.  Saving model ...
2025-02-18 15:08:48,926 - {'epoch': 3, 'rec_loss': '7.3765'}
2025-02-18 15:08:49,553 - {'Epoch': 3, 'HR@5': '0.0275', 'NDCG@5': '0.0197', 'HR@10': '0.0404', 'NDCG@10': '0.0238', 'HR@20': '0.0697', 'NDCG@20': '0.0311'}
2025-02-18 15:08:49,554 - Validation score increased.  Saving model ...
2025-02-18 15:08:56,267 - {'epoch': 4, 'rec_loss': '7.1748'}
2025-02-18 15:08:56,904 - {'Epoch': 4, 'HR@5': '0.0303', 'NDCG@5': '0.0217', 'HR@10': '0.0569', 'NDCG@10': '0.0299', 'HR@20': '0.0771', 'NDCG@20': '0.0350'}
2025-02-18 15:08:56,905 - Validation score increased.  Saving model ...
2025-02-18 15:09:03,422 - {'epoch': 5, 'rec_loss': '6.9715'}
2025-02-18 15:09:04,065 - {'Epoch': 5, 'HR@5': '0.0376', 'NDCG@5': '0.0253', 'HR@10': '0.0560', 'NDCG@10': '0.0313', 'HR@20': '0.0890', 'NDCG@20': '0.0395'}
2025-02-18 15:09:04,066 - Validation score increased.  Saving model ...
2025-02-18 15:09:10,603 - {'epoch': 6, 'rec_loss': '6.7926'}
2025-02-18 15:09:11,232 - {'Epoch': 6, 'HR@5': '0.0385', 'NDCG@5': '0.0259', 'HR@10': '0.0606', 'NDCG@10': '0.0330', 'HR@20': '0.0899', 'NDCG@20': '0.0404'}
2025-02-18 15:09:11,233 - Validation score increased.  Saving model ...
2025-02-18 15:09:17,832 - {'epoch': 7, 'rec_loss': '6.6239'}
2025-02-18 15:09:18,525 - {'Epoch': 7, 'HR@5': '0.0413', 'NDCG@5': '0.0256', 'HR@10': '0.0651', 'NDCG@10': '0.0333', 'HR@20': '0.0936', 'NDCG@20': '0.0406'}
2025-02-18 15:09:18,527 - Validation score increased.  Saving model ...
2025-02-18 15:09:25,067 - {'epoch': 8, 'rec_loss': '6.4695'}
2025-02-18 15:09:25,734 - {'Epoch': 8, 'HR@5': '0.0431', 'NDCG@5': '0.0278', 'HR@10': '0.0670', 'NDCG@10': '0.0355', 'HR@20': '0.0982', 'NDCG@20': '0.0433'}
2025-02-18 15:09:25,735 - Validation score increased.  Saving model ...
2025-02-18 15:09:32,251 - {'epoch': 9, 'rec_loss': '6.3324'}
2025-02-18 15:09:32,942 - {'Epoch': 9, 'HR@5': '0.0459', 'NDCG@5': '0.0281', 'HR@10': '0.0679', 'NDCG@10': '0.0353', 'HR@20': '0.1037', 'NDCG@20': '0.0443'}
2025-02-18 15:09:32,943 - Validation score increased.  Saving model ...
2025-02-18 15:09:39,493 - {'epoch': 10, 'rec_loss': '6.2181'}
2025-02-18 15:09:40,165 - {'Epoch': 10, 'HR@5': '0.0440', 'NDCG@5': '0.0273', 'HR@10': '0.0734', 'NDCG@10': '0.0369', 'HR@20': '0.1101', 'NDCG@20': '0.0459'}
2025-02-18 15:09:40,166 - Validation score increased.  Saving model ...
2025-02-18 15:09:47,091 - {'epoch': 11, 'rec_loss': '6.1297'}
2025-02-18 15:09:47,746 - {'Epoch': 11, 'HR@5': '0.0413', 'NDCG@5': '0.0267', 'HR@10': '0.0734', 'NDCG@10': '0.0371', 'HR@20': '0.1101', 'NDCG@20': '0.0465'}
2025-02-18 15:09:47,748 - Validation score increased.  Saving model ...
2025-02-18 15:09:54,266 - {'epoch': 12, 'rec_loss': '6.0282'}
2025-02-18 15:09:54,899 - {'Epoch': 12, 'HR@5': '0.0514', 'NDCG@5': '0.0330', 'HR@10': '0.0780', 'NDCG@10': '0.0416', 'HR@20': '0.1183', 'NDCG@20': '0.0515'}
2025-02-18 15:09:54,901 - Validation score increased.  Saving model ...
2025-02-18 15:10:00,982 - {'epoch': 13, 'rec_loss': '5.9619'}
2025-02-18 15:10:01,652 - {'Epoch': 13, 'HR@5': '0.0495', 'NDCG@5': '0.0306', 'HR@10': '0.0798', 'NDCG@10': '0.0402', 'HR@20': '0.1119', 'NDCG@20': '0.0484'}
2025-02-18 15:10:01,653 - EarlyStopping counter: 1 out of 10
2025-02-18 15:10:08,198 - {'epoch': 14, 'rec_loss': '5.9011'}
2025-02-18 15:10:08,905 - {'Epoch': 14, 'HR@5': '0.0450', 'NDCG@5': '0.0299', 'HR@10': '0.0798', 'NDCG@10': '0.0410', 'HR@20': '0.1165', 'NDCG@20': '0.0503'}
2025-02-18 15:10:08,906 - EarlyStopping counter: 2 out of 10
2025-02-18 15:10:15,472 - {'epoch': 15, 'rec_loss': '5.8329'}
2025-02-18 15:10:16,107 - {'Epoch': 15, 'HR@5': '0.0514', 'NDCG@5': '0.0310', 'HR@10': '0.0798', 'NDCG@10': '0.0400', 'HR@20': '0.1229', 'NDCG@20': '0.0509'}
2025-02-18 15:10:16,108 - EarlyStopping counter: 3 out of 10
2025-02-18 15:10:22,609 - {'epoch': 16, 'rec_loss': '5.7810'}
2025-02-18 15:10:23,266 - {'Epoch': 16, 'HR@5': '0.0486', 'NDCG@5': '0.0328', 'HR@10': '0.0817', 'NDCG@10': '0.0434', 'HR@20': '0.1220', 'NDCG@20': '0.0538'}
2025-02-18 15:10:23,267 - Validation score increased.  Saving model ...
2025-02-18 15:10:29,725 - {'epoch': 17, 'rec_loss': '5.7219'}
2025-02-18 15:10:30,376 - {'Epoch': 17, 'HR@5': '0.0505', 'NDCG@5': '0.0322', 'HR@10': '0.0844', 'NDCG@10': '0.0431', 'HR@20': '0.1229', 'NDCG@20': '0.0529'}
2025-02-18 15:10:30,378 - EarlyStopping counter: 1 out of 10
2025-02-18 15:10:37,167 - {'epoch': 18, 'rec_loss': '5.6935'}
2025-02-18 15:10:37,796 - {'Epoch': 18, 'HR@5': '0.0560', 'NDCG@5': '0.0358', 'HR@10': '0.0835', 'NDCG@10': '0.0449', 'HR@20': '0.1257', 'NDCG@20': '0.0553'}
2025-02-18 15:10:37,797 - Validation score increased.  Saving model ...
2025-02-18 15:10:44,371 - {'epoch': 19, 'rec_loss': '5.6578'}
2025-02-18 15:10:45,031 - {'Epoch': 19, 'HR@5': '0.0505', 'NDCG@5': '0.0321', 'HR@10': '0.0862', 'NDCG@10': '0.0436', 'HR@20': '0.1303', 'NDCG@20': '0.0546'}
2025-02-18 15:10:45,032 - EarlyStopping counter: 1 out of 10
2025-02-18 15:10:51,559 - {'epoch': 20, 'rec_loss': '5.6232'}
2025-02-18 15:10:52,217 - {'Epoch': 20, 'HR@5': '0.0578', 'NDCG@5': '0.0361', 'HR@10': '0.0936', 'NDCG@10': '0.0476', 'HR@20': '0.1275', 'NDCG@20': '0.0561'}
2025-02-18 15:10:52,218 - Validation score increased.  Saving model ...
2025-02-18 15:10:58,756 - {'epoch': 21, 'rec_loss': '5.6076'}
2025-02-18 15:10:59,379 - {'Epoch': 21, 'HR@5': '0.0587', 'NDCG@5': '0.0359', 'HR@10': '0.0917', 'NDCG@10': '0.0466', 'HR@20': '0.1257', 'NDCG@20': '0.0550'}
2025-02-18 15:10:59,380 - EarlyStopping counter: 1 out of 10
2025-02-18 15:11:05,937 - {'epoch': 22, 'rec_loss': '5.5680'}
2025-02-18 15:11:06,527 - {'Epoch': 22, 'HR@5': '0.0615', 'NDCG@5': '0.0363', 'HR@10': '0.0853', 'NDCG@10': '0.0441', 'HR@20': '0.1303', 'NDCG@20': '0.0555'}
2025-02-18 15:11:06,529 - EarlyStopping counter: 2 out of 10
2025-02-18 15:11:13,113 - {'epoch': 23, 'rec_loss': '5.5419'}
2025-02-18 15:11:13,753 - {'Epoch': 23, 'HR@5': '0.0624', 'NDCG@5': '0.0374', 'HR@10': '0.0844', 'NDCG@10': '0.0444', 'HR@20': '0.1321', 'NDCG@20': '0.0565'}
2025-02-18 15:11:13,755 - Validation score increased.  Saving model ...
2025-02-18 15:11:20,392 - {'epoch': 24, 'rec_loss': '5.5441'}
2025-02-18 15:11:21,057 - {'Epoch': 24, 'HR@5': '0.0550', 'NDCG@5': '0.0342', 'HR@10': '0.0936', 'NDCG@10': '0.0466', 'HR@20': '0.1339', 'NDCG@20': '0.0567'}
2025-02-18 15:11:21,058 - Validation score increased.  Saving model ...
2025-02-18 15:11:27,600 - {'epoch': 25, 'rec_loss': '5.5255'}
2025-02-18 15:11:28,258 - {'Epoch': 25, 'HR@5': '0.0587', 'NDCG@5': '0.0373', 'HR@10': '0.0908', 'NDCG@10': '0.0478', 'HR@20': '0.1358', 'NDCG@20': '0.0590'}
2025-02-18 15:11:28,259 - Validation score increased.  Saving model ...
2025-02-18 15:11:35,041 - {'epoch': 26, 'rec_loss': '5.5106'}
2025-02-18 15:11:35,653 - {'Epoch': 26, 'HR@5': '0.0624', 'NDCG@5': '0.0369', 'HR@10': '0.0899', 'NDCG@10': '0.0459', 'HR@20': '0.1376', 'NDCG@20': '0.0578'}
2025-02-18 15:11:35,654 - EarlyStopping counter: 1 out of 10
2025-02-18 15:11:42,226 - {'epoch': 27, 'rec_loss': '5.4861'}
2025-02-18 15:11:42,846 - {'Epoch': 27, 'HR@5': '0.0624', 'NDCG@5': '0.0379', 'HR@10': '0.0936', 'NDCG@10': '0.0481', 'HR@20': '0.1312', 'NDCG@20': '0.0574'}
2025-02-18 15:11:42,847 - EarlyStopping counter: 2 out of 10
2025-02-18 15:11:49,392 - {'epoch': 28, 'rec_loss': '5.4812'}
2025-02-18 15:11:50,046 - {'Epoch': 28, 'HR@5': '0.0615', 'NDCG@5': '0.0380', 'HR@10': '0.0936', 'NDCG@10': '0.0485', 'HR@20': '0.1349', 'NDCG@20': '0.0588'}
2025-02-18 15:11:50,048 - EarlyStopping counter: 3 out of 10
2025-02-18 15:11:56,561 - {'epoch': 29, 'rec_loss': '5.4622'}
2025-02-18 15:11:57,247 - {'Epoch': 29, 'HR@5': '0.0624', 'NDCG@5': '0.0386', 'HR@10': '0.0936', 'NDCG@10': '0.0485', 'HR@20': '0.1404', 'NDCG@20': '0.0603'}
2025-02-18 15:11:57,248 - Validation score increased.  Saving model ...
2025-02-18 15:12:02,998 - {'epoch': 30, 'rec_loss': '5.4437'}
2025-02-18 15:12:03,718 - {'Epoch': 30, 'HR@5': '0.0642', 'NDCG@5': '0.0406', 'HR@10': '0.0927', 'NDCG@10': '0.0497', 'HR@20': '0.1394', 'NDCG@20': '0.0613'}
2025-02-18 15:12:03,719 - Validation score increased.  Saving model ...
2025-02-18 15:12:10,322 - {'epoch': 31, 'rec_loss': '5.4241'}
2025-02-18 15:12:10,912 - {'Epoch': 31, 'HR@5': '0.0670', 'NDCG@5': '0.0405', 'HR@10': '0.0963', 'NDCG@10': '0.0500', 'HR@20': '0.1468', 'NDCG@20': '0.0626'}
2025-02-18 15:12:10,913 - Validation score increased.  Saving model ...
2025-02-18 15:12:17,360 - {'epoch': 32, 'rec_loss': '5.4138'}
2025-02-18 15:12:18,002 - {'Epoch': 32, 'HR@5': '0.0633', 'NDCG@5': '0.0397', 'HR@10': '0.0954', 'NDCG@10': '0.0498', 'HR@20': '0.1468', 'NDCG@20': '0.0626'}
2025-02-18 15:12:18,003 - Validation score increased.  Saving model ...
2025-02-18 15:12:24,485 - {'epoch': 33, 'rec_loss': '5.3988'}
2025-02-18 15:12:25,152 - {'Epoch': 33, 'HR@5': '0.0642', 'NDCG@5': '0.0434', 'HR@10': '0.0936', 'NDCG@10': '0.0531', 'HR@20': '0.1440', 'NDCG@20': '0.0658'}
2025-02-18 15:12:25,153 - Validation score increased.  Saving model ...
2025-02-18 15:12:32,305 - {'epoch': 34, 'rec_loss': '5.3749'}
2025-02-18 15:12:32,918 - {'Epoch': 34, 'HR@5': '0.0615', 'NDCG@5': '0.0391', 'HR@10': '0.0927', 'NDCG@10': '0.0491', 'HR@20': '0.1440', 'NDCG@20': '0.0621'}
2025-02-18 15:12:32,919 - EarlyStopping counter: 1 out of 10
2025-02-18 15:12:39,483 - {'epoch': 35, 'rec_loss': '5.3841'}
2025-02-18 15:12:40,134 - {'Epoch': 35, 'HR@5': '0.0624', 'NDCG@5': '0.0407', 'HR@10': '0.0872', 'NDCG@10': '0.0490', 'HR@20': '0.1468', 'NDCG@20': '0.0639'}
2025-02-18 15:12:40,135 - EarlyStopping counter: 2 out of 10
2025-02-18 15:12:46,602 - {'epoch': 36, 'rec_loss': '5.3807'}
2025-02-18 15:12:47,291 - {'Epoch': 36, 'HR@5': '0.0651', 'NDCG@5': '0.0415', 'HR@10': '0.0972', 'NDCG@10': '0.0518', 'HR@20': '0.1459', 'NDCG@20': '0.0638'}
2025-02-18 15:12:47,292 - EarlyStopping counter: 3 out of 10
2025-02-18 15:12:53,982 - {'epoch': 37, 'rec_loss': '5.3583'}
2025-02-18 15:12:54,685 - {'Epoch': 37, 'HR@5': '0.0624', 'NDCG@5': '0.0398', 'HR@10': '0.0927', 'NDCG@10': '0.0496', 'HR@20': '0.1431', 'NDCG@20': '0.0623'}
2025-02-18 15:12:54,686 - EarlyStopping counter: 4 out of 10
2025-02-18 15:13:01,243 - {'epoch': 38, 'rec_loss': '5.3501'}
2025-02-18 15:13:01,885 - {'Epoch': 38, 'HR@5': '0.0651', 'NDCG@5': '0.0405', 'HR@10': '0.0954', 'NDCG@10': '0.0503', 'HR@20': '0.1431', 'NDCG@20': '0.0622'}
2025-02-18 15:13:01,886 - EarlyStopping counter: 5 out of 10
2025-02-18 15:13:08,489 - {'epoch': 39, 'rec_loss': '5.3494'}
2025-02-18 15:13:09,164 - {'Epoch': 39, 'HR@5': '0.0679', 'NDCG@5': '0.0417', 'HR@10': '0.0936', 'NDCG@10': '0.0500', 'HR@20': '0.1486', 'NDCG@20': '0.0637'}
2025-02-18 15:13:09,165 - EarlyStopping counter: 6 out of 10
2025-02-18 15:13:16,046 - {'epoch': 40, 'rec_loss': '5.3340'}
2025-02-18 15:13:16,698 - {'Epoch': 40, 'HR@5': '0.0642', 'NDCG@5': '0.0402', 'HR@10': '0.0945', 'NDCG@10': '0.0500', 'HR@20': '0.1450', 'NDCG@20': '0.0627'}
2025-02-18 15:13:16,699 - EarlyStopping counter: 7 out of 10
2025-02-18 15:13:23,251 - {'epoch': 41, 'rec_loss': '5.3286'}
2025-02-18 15:13:23,905 - {'Epoch': 41, 'HR@5': '0.0697', 'NDCG@5': '0.0443', 'HR@10': '0.0954', 'NDCG@10': '0.0526', 'HR@20': '0.1459', 'NDCG@20': '0.0653'}
2025-02-18 15:13:23,906 - EarlyStopping counter: 8 out of 10
2025-02-18 15:13:30,417 - {'epoch': 42, 'rec_loss': '5.3240'}
2025-02-18 15:13:31,055 - {'Epoch': 42, 'HR@5': '0.0624', 'NDCG@5': '0.0405', 'HR@10': '0.0936', 'NDCG@10': '0.0506', 'HR@20': '0.1422', 'NDCG@20': '0.0629'}
2025-02-18 15:13:31,057 - EarlyStopping counter: 9 out of 10
2025-02-18 15:13:37,545 - {'epoch': 43, 'rec_loss': '5.3039'}
2025-02-18 15:13:38,192 - {'Epoch': 43, 'HR@5': '0.0615', 'NDCG@5': '0.0407', 'HR@10': '0.0982', 'NDCG@10': '0.0525', 'HR@20': '0.1394', 'NDCG@20': '0.0629'}
2025-02-18 15:13:38,193 - EarlyStopping counter: 10 out of 10
2025-02-18 15:13:38,194 - Early stopping
2025-02-18 15:13:38,194 - ---------------Test Score---------------
2025-02-18 15:13:38,895 - {'Epoch': 0, 'HR@5': '0.0514', 'NDCG@5': '0.0337', 'HR@10': '0.0688', 'NDCG@10': '0.0393', 'HR@20': '0.0972', 'NDCG@20': '0.0464'}
2025-02-18 15:13:38,896 - Scale_LastFM
2025-02-18 15:13:38,897 - {'Epoch': 0, 'HR@5': '0.0514', 'NDCG@5': '0.0337', 'HR@10': '0.0688', 'NDCG@10': '0.0393', 'HR@20': '0.0972', 'NDCG@20': '0.0464'}
2025-02-18 15:39:46,013 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-18 15:39:50,594 - HyperRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-18 15:39:50,619 - Total Parameters: 388325
2025-02-18 15:39:57,517 - {'epoch': 0, 'rec_loss': '8.0388'}
2025-02-18 15:39:58,121 - {'Epoch': 0, 'HR@5': '0.0239', 'NDCG@5': '0.0165', 'HR@10': '0.0349', 'NDCG@10': '0.0200', 'HR@20': '0.0569', 'NDCG@20': '0.0256'}
2025-02-18 15:39:58,122 - Validation score increased.  Saving model ...
2025-02-18 15:40:05,557 - {'epoch': 1, 'rec_loss': '7.7716'}
2025-02-18 15:40:06,204 - {'Epoch': 1, 'HR@5': '0.0257', 'NDCG@5': '0.0151', 'HR@10': '0.0358', 'NDCG@10': '0.0185', 'HR@20': '0.0642', 'NDCG@20': '0.0256'}
2025-02-18 15:40:06,205 - EarlyStopping counter: 1 out of 10
2025-02-18 15:40:12,685 - {'epoch': 2, 'rec_loss': '7.5930'}
2025-02-18 15:40:13,327 - {'Epoch': 2, 'HR@5': '0.0229', 'NDCG@5': '0.0148', 'HR@10': '0.0367', 'NDCG@10': '0.0193', 'HR@20': '0.0633', 'NDCG@20': '0.0259'}
2025-02-18 15:40:13,328 - Validation score increased.  Saving model ...
2025-02-18 15:40:20,278 - {'epoch': 3, 'rec_loss': '7.4250'}
2025-02-18 15:40:20,861 - {'Epoch': 3, 'HR@5': '0.0248', 'NDCG@5': '0.0177', 'HR@10': '0.0450', 'NDCG@10': '0.0242', 'HR@20': '0.0661', 'NDCG@20': '0.0294'}
2025-02-18 15:40:20,863 - Validation score increased.  Saving model ...
2025-02-18 15:40:27,814 - {'epoch': 4, 'rec_loss': '7.2390'}
2025-02-18 15:40:28,461 - {'Epoch': 4, 'HR@5': '0.0312', 'NDCG@5': '0.0216', 'HR@10': '0.0468', 'NDCG@10': '0.0266', 'HR@20': '0.0734', 'NDCG@20': '0.0332'}
2025-02-18 15:40:28,462 - Validation score increased.  Saving model ...
2025-02-18 15:40:35,958 - {'epoch': 5, 'rec_loss': '7.0570'}
2025-02-18 15:40:36,596 - {'Epoch': 5, 'HR@5': '0.0349', 'NDCG@5': '0.0230', 'HR@10': '0.0523', 'NDCG@10': '0.0286', 'HR@20': '0.0844', 'NDCG@20': '0.0368'}
2025-02-18 15:40:36,597 - Validation score increased.  Saving model ...
2025-02-18 15:40:43,314 - {'epoch': 6, 'rec_loss': '6.8918'}
2025-02-18 15:40:43,896 - {'Epoch': 6, 'HR@5': '0.0367', 'NDCG@5': '0.0244', 'HR@10': '0.0615', 'NDCG@10': '0.0324', 'HR@20': '0.0890', 'NDCG@20': '0.0393'}
2025-02-18 15:40:43,898 - Validation score increased.  Saving model ...
2025-02-18 15:40:50,574 - {'epoch': 7, 'rec_loss': '6.7362'}
2025-02-18 15:40:51,123 - {'Epoch': 7, 'HR@5': '0.0413', 'NDCG@5': '0.0245', 'HR@10': '0.0624', 'NDCG@10': '0.0312', 'HR@20': '0.0972', 'NDCG@20': '0.0399'}
2025-02-18 15:40:51,124 - Validation score increased.  Saving model ...
2025-02-18 15:40:57,533 - {'epoch': 8, 'rec_loss': '6.5868'}
2025-02-18 15:40:58,125 - {'Epoch': 8, 'HR@5': '0.0431', 'NDCG@5': '0.0270', 'HR@10': '0.0624', 'NDCG@10': '0.0334', 'HR@20': '0.0954', 'NDCG@20': '0.0418'}
2025-02-18 15:40:58,126 - Validation score increased.  Saving model ...
2025-02-18 15:41:04,687 - {'epoch': 9, 'rec_loss': '6.4567'}
2025-02-18 15:41:05,260 - {'Epoch': 9, 'HR@5': '0.0440', 'NDCG@5': '0.0269', 'HR@10': '0.0706', 'NDCG@10': '0.0355', 'HR@20': '0.1028', 'NDCG@20': '0.0434'}
2025-02-18 15:41:05,261 - Validation score increased.  Saving model ...
2025-02-18 15:41:12,052 - {'epoch': 10, 'rec_loss': '6.3362'}
2025-02-18 15:41:12,714 - {'Epoch': 10, 'HR@5': '0.0422', 'NDCG@5': '0.0260', 'HR@10': '0.0734', 'NDCG@10': '0.0360', 'HR@20': '0.1055', 'NDCG@20': '0.0439'}
2025-02-18 15:41:12,715 - Validation score increased.  Saving model ...
2025-02-18 15:41:19,881 - {'epoch': 11, 'rec_loss': '6.2472'}
2025-02-18 15:41:20,473 - {'Epoch': 11, 'HR@5': '0.0440', 'NDCG@5': '0.0276', 'HR@10': '0.0716', 'NDCG@10': '0.0365', 'HR@20': '0.1128', 'NDCG@20': '0.0470'}
2025-02-18 15:41:20,474 - Validation score increased.  Saving model ...
2025-02-18 15:41:27,508 - {'epoch': 12, 'rec_loss': '6.1427'}
2025-02-18 15:41:28,134 - {'Epoch': 12, 'HR@5': '0.0486', 'NDCG@5': '0.0318', 'HR@10': '0.0706', 'NDCG@10': '0.0390', 'HR@20': '0.1128', 'NDCG@20': '0.0497'}
2025-02-18 15:41:28,135 - Validation score increased.  Saving model ...
2025-02-18 15:41:34,999 - {'epoch': 13, 'rec_loss': '6.0776'}
2025-02-18 15:41:35,617 - {'Epoch': 13, 'HR@5': '0.0486', 'NDCG@5': '0.0295', 'HR@10': '0.0780', 'NDCG@10': '0.0389', 'HR@20': '0.1128', 'NDCG@20': '0.0478'}
2025-02-18 15:41:35,619 - EarlyStopping counter: 1 out of 10
2025-02-18 15:41:42,292 - {'epoch': 14, 'rec_loss': '6.0094'}
2025-02-18 15:41:42,894 - {'Epoch': 14, 'HR@5': '0.0450', 'NDCG@5': '0.0298', 'HR@10': '0.0844', 'NDCG@10': '0.0423', 'HR@20': '0.1193', 'NDCG@20': '0.0510'}
2025-02-18 15:41:42,896 - Validation score increased.  Saving model ...
2025-02-18 15:41:50,254 - {'epoch': 15, 'rec_loss': '5.9346'}
2025-02-18 15:41:50,854 - {'Epoch': 15, 'HR@5': '0.0514', 'NDCG@5': '0.0299', 'HR@10': '0.0835', 'NDCG@10': '0.0401', 'HR@20': '0.1229', 'NDCG@20': '0.0500'}
2025-02-18 15:41:50,855 - EarlyStopping counter: 1 out of 10
2025-02-18 15:41:56,604 - {'epoch': 16, 'rec_loss': '5.8851'}
2025-02-18 15:41:57,234 - {'Epoch': 16, 'HR@5': '0.0495', 'NDCG@5': '0.0314', 'HR@10': '0.0853', 'NDCG@10': '0.0431', 'HR@20': '0.1239', 'NDCG@20': '0.0530'}
2025-02-18 15:41:57,235 - Validation score increased.  Saving model ...
2025-02-18 15:42:04,122 - {'epoch': 17, 'rec_loss': '5.8274'}
2025-02-18 15:42:04,773 - {'Epoch': 17, 'HR@5': '0.0514', 'NDCG@5': '0.0319', 'HR@10': '0.0890', 'NDCG@10': '0.0441', 'HR@20': '0.1257', 'NDCG@20': '0.0533'}
2025-02-18 15:42:04,774 - Validation score increased.  Saving model ...
2025-02-18 15:42:12,009 - {'epoch': 18, 'rec_loss': '5.7867'}
2025-02-18 15:42:12,620 - {'Epoch': 18, 'HR@5': '0.0569', 'NDCG@5': '0.0356', 'HR@10': '0.0844', 'NDCG@10': '0.0443', 'HR@20': '0.1303', 'NDCG@20': '0.0559'}
2025-02-18 15:42:12,621 - Validation score increased.  Saving model ...
2025-02-18 15:42:19,782 - {'epoch': 19, 'rec_loss': '5.7592'}
2025-02-18 15:42:20,387 - {'Epoch': 19, 'HR@5': '0.0541', 'NDCG@5': '0.0328', 'HR@10': '0.0862', 'NDCG@10': '0.0432', 'HR@20': '0.1303', 'NDCG@20': '0.0542'}
2025-02-18 15:42:20,388 - EarlyStopping counter: 1 out of 10
2025-02-18 15:42:27,221 - {'epoch': 20, 'rec_loss': '5.7151'}
2025-02-18 15:42:27,841 - {'Epoch': 20, 'HR@5': '0.0606', 'NDCG@5': '0.0375', 'HR@10': '0.0945', 'NDCG@10': '0.0484', 'HR@20': '0.1321', 'NDCG@20': '0.0578'}
2025-02-18 15:42:27,842 - Validation score increased.  Saving model ...
2025-02-18 15:42:34,567 - {'epoch': 21, 'rec_loss': '5.7070'}
2025-02-18 15:42:35,154 - {'Epoch': 21, 'HR@5': '0.0633', 'NDCG@5': '0.0374', 'HR@10': '0.0936', 'NDCG@10': '0.0472', 'HR@20': '0.1294', 'NDCG@20': '0.0561'}
2025-02-18 15:42:35,155 - EarlyStopping counter: 1 out of 10
2025-02-18 15:42:42,110 - {'epoch': 22, 'rec_loss': '5.6593'}
2025-02-18 15:42:42,782 - {'Epoch': 22, 'HR@5': '0.0560', 'NDCG@5': '0.0338', 'HR@10': '0.0872', 'NDCG@10': '0.0441', 'HR@20': '0.1321', 'NDCG@20': '0.0554'}
2025-02-18 15:42:42,784 - EarlyStopping counter: 2 out of 10
2025-02-18 15:42:49,713 - {'epoch': 23, 'rec_loss': '5.6405'}
2025-02-18 15:42:50,343 - {'Epoch': 23, 'HR@5': '0.0596', 'NDCG@5': '0.0367', 'HR@10': '0.0853', 'NDCG@10': '0.0450', 'HR@20': '0.1330', 'NDCG@20': '0.0569'}
2025-02-18 15:42:50,344 - EarlyStopping counter: 3 out of 10
2025-02-18 15:42:57,357 - {'epoch': 24, 'rec_loss': '5.6341'}
2025-02-18 15:42:58,003 - {'Epoch': 24, 'HR@5': '0.0569', 'NDCG@5': '0.0347', 'HR@10': '0.0899', 'NDCG@10': '0.0456', 'HR@20': '0.1349', 'NDCG@20': '0.0568'}
2025-02-18 15:42:58,004 - EarlyStopping counter: 4 out of 10
2025-02-18 15:43:04,663 - {'epoch': 25, 'rec_loss': '5.6153'}
2025-02-18 15:43:05,298 - {'Epoch': 25, 'HR@5': '0.0587', 'NDCG@5': '0.0372', 'HR@10': '0.0899', 'NDCG@10': '0.0474', 'HR@20': '0.1330', 'NDCG@20': '0.0583'}
2025-02-18 15:43:05,300 - Validation score increased.  Saving model ...
2025-02-18 15:43:11,955 - {'epoch': 26, 'rec_loss': '5.6026'}
2025-02-18 15:43:12,548 - {'Epoch': 26, 'HR@5': '0.0642', 'NDCG@5': '0.0382', 'HR@10': '0.0890', 'NDCG@10': '0.0461', 'HR@20': '0.1358', 'NDCG@20': '0.0578'}
2025-02-18 15:43:12,549 - EarlyStopping counter: 1 out of 10
2025-02-18 15:43:19,498 - {'epoch': 27, 'rec_loss': '5.5811'}
2025-02-18 15:43:20,135 - {'Epoch': 27, 'HR@5': '0.0633', 'NDCG@5': '0.0381', 'HR@10': '0.0908', 'NDCG@10': '0.0470', 'HR@20': '0.1339', 'NDCG@20': '0.0578'}
2025-02-18 15:43:20,137 - EarlyStopping counter: 2 out of 10
2025-02-18 15:43:27,391 - {'epoch': 28, 'rec_loss': '5.5736'}
2025-02-18 15:43:28,046 - {'Epoch': 28, 'HR@5': '0.0587', 'NDCG@5': '0.0366', 'HR@10': '0.0927', 'NDCG@10': '0.0478', 'HR@20': '0.1358', 'NDCG@20': '0.0586'}
2025-02-18 15:43:28,048 - Validation score increased.  Saving model ...
2025-02-18 15:43:35,212 - {'epoch': 29, 'rec_loss': '5.5539'}
2025-02-18 15:43:35,835 - {'Epoch': 29, 'HR@5': '0.0651', 'NDCG@5': '0.0383', 'HR@10': '0.0963', 'NDCG@10': '0.0480', 'HR@20': '0.1404', 'NDCG@20': '0.0591'}
2025-02-18 15:43:35,837 - Validation score increased.  Saving model ...
2025-02-18 15:43:42,999 - {'epoch': 30, 'rec_loss': '5.5311'}
2025-02-18 15:43:43,641 - {'Epoch': 30, 'HR@5': '0.0670', 'NDCG@5': '0.0405', 'HR@10': '0.0908', 'NDCG@10': '0.0483', 'HR@20': '0.1413', 'NDCG@20': '0.0610'}
2025-02-18 15:43:43,642 - Validation score increased.  Saving model ...
2025-02-18 15:43:50,322 - {'epoch': 31, 'rec_loss': '5.5181'}
2025-02-18 15:43:50,910 - {'Epoch': 31, 'HR@5': '0.0670', 'NDCG@5': '0.0406', 'HR@10': '0.0936', 'NDCG@10': '0.0494', 'HR@20': '0.1440', 'NDCG@20': '0.0622'}
2025-02-18 15:43:50,911 - Validation score increased.  Saving model ...
2025-02-18 15:43:57,512 - {'epoch': 32, 'rec_loss': '5.5064'}
2025-02-18 15:43:58,111 - {'Epoch': 32, 'HR@5': '0.0587', 'NDCG@5': '0.0362', 'HR@10': '0.0945', 'NDCG@10': '0.0479', 'HR@20': '0.1468', 'NDCG@20': '0.0610'}
2025-02-18 15:43:58,112 - EarlyStopping counter: 1 out of 10
2025-02-18 15:44:04,098 - {'epoch': 33, 'rec_loss': '5.4878'}
2025-02-18 15:44:04,733 - {'Epoch': 33, 'HR@5': '0.0661', 'NDCG@5': '0.0425', 'HR@10': '0.0945', 'NDCG@10': '0.0517', 'HR@20': '0.1468', 'NDCG@20': '0.0647'}
2025-02-18 15:44:04,734 - Validation score increased.  Saving model ...
2025-02-18 15:44:11,554 - {'epoch': 34, 'rec_loss': '5.4729'}
2025-02-18 15:44:12,143 - {'Epoch': 34, 'HR@5': '0.0569', 'NDCG@5': '0.0360', 'HR@10': '0.0945', 'NDCG@10': '0.0481', 'HR@20': '0.1404', 'NDCG@20': '0.0599'}
2025-02-18 15:44:12,144 - EarlyStopping counter: 1 out of 10
2025-02-18 15:44:19,293 - {'epoch': 35, 'rec_loss': '5.4742'}
2025-02-18 15:44:19,946 - {'Epoch': 35, 'HR@5': '0.0624', 'NDCG@5': '0.0386', 'HR@10': '0.0936', 'NDCG@10': '0.0487', 'HR@20': '0.1450', 'NDCG@20': '0.0616'}
2025-02-18 15:44:19,947 - EarlyStopping counter: 2 out of 10
2025-02-18 15:44:26,914 - {'epoch': 36, 'rec_loss': '5.4656'}
2025-02-18 15:44:27,585 - {'Epoch': 36, 'HR@5': '0.0642', 'NDCG@5': '0.0408', 'HR@10': '0.0945', 'NDCG@10': '0.0505', 'HR@20': '0.1440', 'NDCG@20': '0.0629'}
2025-02-18 15:44:27,586 - EarlyStopping counter: 3 out of 10
2025-02-18 15:44:34,661 - {'epoch': 37, 'rec_loss': '5.4483'}
2025-02-18 15:44:35,309 - {'Epoch': 37, 'HR@5': '0.0615', 'NDCG@5': '0.0386', 'HR@10': '0.0982', 'NDCG@10': '0.0502', 'HR@20': '0.1422', 'NDCG@20': '0.0612'}
2025-02-18 15:44:35,310 - EarlyStopping counter: 4 out of 10
2025-02-18 15:44:41,884 - {'epoch': 38, 'rec_loss': '5.4365'}
2025-02-18 15:44:42,503 - {'Epoch': 38, 'HR@5': '0.0615', 'NDCG@5': '0.0412', 'HR@10': '0.0936', 'NDCG@10': '0.0514', 'HR@20': '0.1505', 'NDCG@20': '0.0657'}
2025-02-18 15:44:42,504 - Validation score increased.  Saving model ...
2025-02-18 15:44:49,126 - {'epoch': 39, 'rec_loss': '5.4404'}
2025-02-18 15:44:49,716 - {'Epoch': 39, 'HR@5': '0.0633', 'NDCG@5': '0.0398', 'HR@10': '0.0982', 'NDCG@10': '0.0507', 'HR@20': '0.1459', 'NDCG@20': '0.0627'}
2025-02-18 15:44:49,717 - EarlyStopping counter: 1 out of 10
2025-02-18 15:44:56,189 - {'epoch': 40, 'rec_loss': '5.4328'}
2025-02-18 15:44:56,755 - {'Epoch': 40, 'HR@5': '0.0606', 'NDCG@5': '0.0388', 'HR@10': '0.0936', 'NDCG@10': '0.0494', 'HR@20': '0.1450', 'NDCG@20': '0.0625'}
2025-02-18 15:44:56,756 - EarlyStopping counter: 2 out of 10
2025-02-18 15:45:03,277 - {'epoch': 41, 'rec_loss': '5.4261'}
2025-02-18 15:45:03,933 - {'Epoch': 41, 'HR@5': '0.0633', 'NDCG@5': '0.0406', 'HR@10': '0.0954', 'NDCG@10': '0.0510', 'HR@20': '0.1477', 'NDCG@20': '0.0642'}
2025-02-18 15:45:03,935 - EarlyStopping counter: 3 out of 10
2025-02-18 15:45:10,978 - {'epoch': 42, 'rec_loss': '5.4254'}
2025-02-18 15:45:11,600 - {'Epoch': 42, 'HR@5': '0.0624', 'NDCG@5': '0.0404', 'HR@10': '0.0908', 'NDCG@10': '0.0496', 'HR@20': '0.1468', 'NDCG@20': '0.0637'}
2025-02-18 15:45:11,601 - EarlyStopping counter: 4 out of 10
2025-02-18 15:45:18,639 - {'epoch': 43, 'rec_loss': '5.4011'}
2025-02-18 15:45:19,265 - {'Epoch': 43, 'HR@5': '0.0624', 'NDCG@5': '0.0381', 'HR@10': '0.0963', 'NDCG@10': '0.0488', 'HR@20': '0.1459', 'NDCG@20': '0.0612'}
2025-02-18 15:45:19,266 - EarlyStopping counter: 5 out of 10
2025-02-18 15:45:26,083 - {'epoch': 44, 'rec_loss': '5.4025'}
2025-02-18 15:45:26,706 - {'Epoch': 44, 'HR@5': '0.0633', 'NDCG@5': '0.0416', 'HR@10': '0.0954', 'NDCG@10': '0.0519', 'HR@20': '0.1505', 'NDCG@20': '0.0656'}
2025-02-18 15:45:26,708 - EarlyStopping counter: 6 out of 10
2025-02-18 15:45:33,707 - {'epoch': 45, 'rec_loss': '5.4100'}
2025-02-18 15:45:34,346 - {'Epoch': 45, 'HR@5': '0.0615', 'NDCG@5': '0.0401', 'HR@10': '0.0991', 'NDCG@10': '0.0520', 'HR@20': '0.1431', 'NDCG@20': '0.0631'}
2025-02-18 15:45:34,347 - EarlyStopping counter: 7 out of 10
2025-02-18 15:45:41,261 - {'epoch': 46, 'rec_loss': '5.3998'}
2025-02-18 15:45:41,875 - {'Epoch': 46, 'HR@5': '0.0633', 'NDCG@5': '0.0387', 'HR@10': '0.0963', 'NDCG@10': '0.0493', 'HR@20': '0.1440', 'NDCG@20': '0.0612'}
2025-02-18 15:45:41,876 - EarlyStopping counter: 8 out of 10
2025-02-18 15:45:48,686 - {'epoch': 47, 'rec_loss': '5.3729'}
2025-02-18 15:45:49,301 - {'Epoch': 47, 'HR@5': '0.0596', 'NDCG@5': '0.0396', 'HR@10': '0.1000', 'NDCG@10': '0.0524', 'HR@20': '0.1477', 'NDCG@20': '0.0644'}
2025-02-18 15:45:49,303 - EarlyStopping counter: 9 out of 10
2025-02-18 15:45:56,081 - {'epoch': 48, 'rec_loss': '5.3734'}
2025-02-18 15:45:56,692 - {'Epoch': 48, 'HR@5': '0.0670', 'NDCG@5': '0.0419', 'HR@10': '0.1009', 'NDCG@10': '0.0526', 'HR@20': '0.1450', 'NDCG@20': '0.0637'}
2025-02-18 15:45:56,693 - EarlyStopping counter: 10 out of 10
2025-02-18 15:45:56,693 - Early stopping
2025-02-18 15:45:56,693 - ---------------Test Score---------------
2025-02-18 15:45:57,343 - {'Epoch': 0, 'HR@5': '0.0468', 'NDCG@5': '0.0327', 'HR@10': '0.0706', 'NDCG@10': '0.0402', 'HR@20': '0.0972', 'NDCG@20': '0.0469'}
2025-02-18 15:45:57,344 - Scale_LastFM
2025-02-18 15:45:57,344 - {'Epoch': 0, 'HR@5': '0.0468', 'NDCG@5': '0.0327', 'HR@10': '0.0706', 'NDCG@10': '0.0402', 'HR@20': '0.0972', 'NDCG@20': '0.0469'}
2025-02-18 15:52:53,807 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-18 15:52:59,003 - HyperRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-18 15:52:59,055 - Total Parameters: 388325
2025-02-18 15:53:07,280 - {'epoch': 0, 'rec_loss': '8.0315'}
2025-02-18 15:53:07,838 - {'Epoch': 0, 'HR@5': '0.0229', 'NDCG@5': '0.0156', 'HR@10': '0.0339', 'NDCG@10': '0.0190', 'HR@20': '0.0596', 'NDCG@20': '0.0254'}
2025-02-18 15:53:07,839 - Validation score increased.  Saving model ...
2025-02-18 15:53:14,509 - {'epoch': 1, 'rec_loss': '7.7369'}
2025-02-18 15:53:15,158 - {'Epoch': 1, 'HR@5': '0.0229', 'NDCG@5': '0.0136', 'HR@10': '0.0358', 'NDCG@10': '0.0178', 'HR@20': '0.0615', 'NDCG@20': '0.0242'}
2025-02-18 15:53:15,159 - EarlyStopping counter: 1 out of 10
2025-02-18 15:53:21,746 - {'epoch': 2, 'rec_loss': '7.5159'}
2025-02-18 15:53:22,394 - {'Epoch': 2, 'HR@5': '0.0229', 'NDCG@5': '0.0170', 'HR@10': '0.0394', 'NDCG@10': '0.0223', 'HR@20': '0.0651', 'NDCG@20': '0.0288'}
2025-02-18 15:53:22,395 - Validation score increased.  Saving model ...
2025-02-18 15:53:29,732 - {'epoch': 3, 'rec_loss': '7.2951'}
2025-02-18 15:53:30,390 - {'Epoch': 3, 'HR@5': '0.0303', 'NDCG@5': '0.0212', 'HR@10': '0.0431', 'NDCG@10': '0.0253', 'HR@20': '0.0780', 'NDCG@20': '0.0341'}
2025-02-18 15:53:30,391 - Validation score increased.  Saving model ...
2025-02-18 15:53:37,258 - {'epoch': 4, 'rec_loss': '7.0587'}
2025-02-18 15:53:37,863 - {'Epoch': 4, 'HR@5': '0.0339', 'NDCG@5': '0.0227', 'HR@10': '0.0569', 'NDCG@10': '0.0300', 'HR@20': '0.0826', 'NDCG@20': '0.0365'}
2025-02-18 15:53:37,865 - Validation score increased.  Saving model ...
2025-02-18 15:53:44,595 - {'epoch': 5, 'rec_loss': '6.8369'}
2025-02-18 15:53:45,221 - {'Epoch': 5, 'HR@5': '0.0413', 'NDCG@5': '0.0269', 'HR@10': '0.0651', 'NDCG@10': '0.0343', 'HR@20': '0.0908', 'NDCG@20': '0.0407'}
2025-02-18 15:53:45,222 - Validation score increased.  Saving model ...
2025-02-18 15:53:51,953 - {'epoch': 6, 'rec_loss': '6.6406'}
2025-02-18 15:53:52,589 - {'Epoch': 6, 'HR@5': '0.0431', 'NDCG@5': '0.0282', 'HR@10': '0.0606', 'NDCG@10': '0.0338', 'HR@20': '0.0972', 'NDCG@20': '0.0430'}
2025-02-18 15:53:52,590 - Validation score increased.  Saving model ...
2025-02-18 15:53:59,519 - {'epoch': 7, 'rec_loss': '6.4639'}
2025-02-18 15:54:00,145 - {'Epoch': 7, 'HR@5': '0.0431', 'NDCG@5': '0.0267', 'HR@10': '0.0679', 'NDCG@10': '0.0345', 'HR@20': '0.1028', 'NDCG@20': '0.0434'}
2025-02-18 15:54:00,147 - Validation score increased.  Saving model ...
2025-02-18 15:54:07,330 - {'epoch': 8, 'rec_loss': '6.3085'}
2025-02-18 15:54:07,938 - {'Epoch': 8, 'HR@5': '0.0450', 'NDCG@5': '0.0281', 'HR@10': '0.0725', 'NDCG@10': '0.0369', 'HR@20': '0.1046', 'NDCG@20': '0.0449'}
2025-02-18 15:54:07,939 - Validation score increased.  Saving model ...
2025-02-18 15:54:15,115 - {'epoch': 9, 'rec_loss': '6.1646'}
2025-02-18 15:54:15,769 - {'Epoch': 9, 'HR@5': '0.0468', 'NDCG@5': '0.0283', 'HR@10': '0.0697', 'NDCG@10': '0.0358', 'HR@20': '0.1055', 'NDCG@20': '0.0449'}
2025-02-18 15:54:15,770 - EarlyStopping counter: 1 out of 10
2025-02-18 15:54:22,166 - {'epoch': 10, 'rec_loss': '6.0511'}
2025-02-18 15:54:22,780 - {'Epoch': 10, 'HR@5': '0.0440', 'NDCG@5': '0.0280', 'HR@10': '0.0752', 'NDCG@10': '0.0380', 'HR@20': '0.1165', 'NDCG@20': '0.0482'}
2025-02-18 15:54:22,781 - Validation score increased.  Saving model ...
2025-02-18 15:54:29,595 - {'epoch': 11, 'rec_loss': '5.9649'}
2025-02-18 15:54:30,236 - {'Epoch': 11, 'HR@5': '0.0459', 'NDCG@5': '0.0287', 'HR@10': '0.0761', 'NDCG@10': '0.0386', 'HR@20': '0.1165', 'NDCG@20': '0.0487'}
2025-02-18 15:54:30,237 - Validation score increased.  Saving model ...
2025-02-18 15:54:37,152 - {'epoch': 12, 'rec_loss': '5.8663'}
2025-02-18 15:54:37,746 - {'Epoch': 12, 'HR@5': '0.0550', 'NDCG@5': '0.0357', 'HR@10': '0.0826', 'NDCG@10': '0.0445', 'HR@20': '0.1202', 'NDCG@20': '0.0541'}
2025-02-18 15:54:37,747 - Validation score increased.  Saving model ...
2025-02-18 15:54:44,744 - {'epoch': 13, 'rec_loss': '5.8085'}
2025-02-18 15:54:45,364 - {'Epoch': 13, 'HR@5': '0.0514', 'NDCG@5': '0.0323', 'HR@10': '0.0862', 'NDCG@10': '0.0433', 'HR@20': '0.1211', 'NDCG@20': '0.0522'}
2025-02-18 15:54:45,365 - EarlyStopping counter: 1 out of 10
2025-02-18 15:54:52,434 - {'epoch': 14, 'rec_loss': '5.7535'}
2025-02-18 15:54:53,016 - {'Epoch': 14, 'HR@5': '0.0532', 'NDCG@5': '0.0340', 'HR@10': '0.0881', 'NDCG@10': '0.0452', 'HR@20': '0.1248', 'NDCG@20': '0.0546'}
2025-02-18 15:54:53,018 - Validation score increased.  Saving model ...
2025-02-18 15:55:00,061 - {'epoch': 15, 'rec_loss': '5.6912'}
2025-02-18 15:55:00,661 - {'Epoch': 15, 'HR@5': '0.0541', 'NDCG@5': '0.0325', 'HR@10': '0.0881', 'NDCG@10': '0.0435', 'HR@20': '0.1303', 'NDCG@20': '0.0542'}
2025-02-18 15:55:00,662 - EarlyStopping counter: 1 out of 10
2025-02-18 15:55:07,404 - {'epoch': 16, 'rec_loss': '5.6398'}
2025-02-18 15:55:08,039 - {'Epoch': 16, 'HR@5': '0.0615', 'NDCG@5': '0.0399', 'HR@10': '0.0899', 'NDCG@10': '0.0489', 'HR@20': '0.1312', 'NDCG@20': '0.0592'}
2025-02-18 15:55:08,040 - Validation score increased.  Saving model ...
2025-02-18 15:55:15,069 - {'epoch': 17, 'rec_loss': '5.6018'}
2025-02-18 15:55:15,791 - {'Epoch': 17, 'HR@5': '0.0587', 'NDCG@5': '0.0363', 'HR@10': '0.0872', 'NDCG@10': '0.0455', 'HR@20': '0.1303', 'NDCG@20': '0.0562'}
2025-02-18 15:55:15,793 - EarlyStopping counter: 1 out of 10
2025-02-18 15:55:23,728 - {'epoch': 18, 'rec_loss': '5.5711'}
2025-02-18 15:55:24,527 - {'Epoch': 18, 'HR@5': '0.0606', 'NDCG@5': '0.0370', 'HR@10': '0.0844', 'NDCG@10': '0.0447', 'HR@20': '0.1312', 'NDCG@20': '0.0567'}
2025-02-18 15:55:24,529 - EarlyStopping counter: 2 out of 10
2025-02-18 15:55:31,624 - {'epoch': 19, 'rec_loss': '5.5406'}
2025-02-18 15:55:32,275 - {'Epoch': 19, 'HR@5': '0.0624', 'NDCG@5': '0.0380', 'HR@10': '0.0945', 'NDCG@10': '0.0481', 'HR@20': '0.1394', 'NDCG@20': '0.0593'}
2025-02-18 15:55:32,276 - Validation score increased.  Saving model ...
2025-02-18 15:55:39,210 - {'epoch': 20, 'rec_loss': '5.5061'}
2025-02-18 15:55:39,870 - {'Epoch': 20, 'HR@5': '0.0624', 'NDCG@5': '0.0382', 'HR@10': '0.0945', 'NDCG@10': '0.0485', 'HR@20': '0.1431', 'NDCG@20': '0.0605'}
2025-02-18 15:55:39,871 - Validation score increased.  Saving model ...
2025-02-18 15:55:46,742 - {'epoch': 21, 'rec_loss': '5.4932'}
2025-02-18 15:55:47,405 - {'Epoch': 21, 'HR@5': '0.0679', 'NDCG@5': '0.0396', 'HR@10': '0.0908', 'NDCG@10': '0.0470', 'HR@20': '0.1349', 'NDCG@20': '0.0581'}
2025-02-18 15:55:47,407 - EarlyStopping counter: 1 out of 10
2025-02-18 15:55:54,275 - {'epoch': 22, 'rec_loss': '5.4620'}
2025-02-18 15:55:54,973 - {'Epoch': 22, 'HR@5': '0.0624', 'NDCG@5': '0.0375', 'HR@10': '0.0908', 'NDCG@10': '0.0469', 'HR@20': '0.1367', 'NDCG@20': '0.0584'}
2025-02-18 15:55:54,974 - EarlyStopping counter: 2 out of 10
2025-02-18 15:56:01,919 - {'epoch': 23, 'rec_loss': '5.4421'}
2025-02-18 15:56:02,567 - {'Epoch': 23, 'HR@5': '0.0642', 'NDCG@5': '0.0400', 'HR@10': '0.0936', 'NDCG@10': '0.0493', 'HR@20': '0.1339', 'NDCG@20': '0.0594'}
2025-02-18 15:56:02,568 - EarlyStopping counter: 3 out of 10
2025-02-18 15:56:09,493 - {'epoch': 24, 'rec_loss': '5.4344'}
2025-02-18 15:56:10,135 - {'Epoch': 24, 'HR@5': '0.0615', 'NDCG@5': '0.0373', 'HR@10': '0.0908', 'NDCG@10': '0.0467', 'HR@20': '0.1385', 'NDCG@20': '0.0587'}
2025-02-18 15:56:10,137 - EarlyStopping counter: 4 out of 10
2025-02-18 15:56:16,826 - {'epoch': 25, 'rec_loss': '5.4255'}
2025-02-18 15:56:17,465 - {'Epoch': 25, 'HR@5': '0.0679', 'NDCG@5': '0.0396', 'HR@10': '0.0963', 'NDCG@10': '0.0487', 'HR@20': '0.1367', 'NDCG@20': '0.0587'}
2025-02-18 15:56:17,466 - EarlyStopping counter: 5 out of 10
2025-02-18 15:56:24,203 - {'epoch': 26, 'rec_loss': '5.4042'}
2025-02-18 15:56:24,884 - {'Epoch': 26, 'HR@5': '0.0697', 'NDCG@5': '0.0411', 'HR@10': '0.0945', 'NDCG@10': '0.0490', 'HR@20': '0.1459', 'NDCG@20': '0.0617'}
2025-02-18 15:56:24,885 - Validation score increased.  Saving model ...
2025-02-18 15:56:31,581 - {'epoch': 27, 'rec_loss': '5.3806'}
2025-02-18 15:56:32,175 - {'Epoch': 27, 'HR@5': '0.0670', 'NDCG@5': '0.0411', 'HR@10': '0.0936', 'NDCG@10': '0.0496', 'HR@20': '0.1394', 'NDCG@20': '0.0611'}
2025-02-18 15:56:32,177 - EarlyStopping counter: 1 out of 10
2025-02-18 15:56:39,250 - {'epoch': 28, 'rec_loss': '5.3821'}
2025-02-18 15:56:39,895 - {'Epoch': 28, 'HR@5': '0.0679', 'NDCG@5': '0.0404', 'HR@10': '0.0945', 'NDCG@10': '0.0489', 'HR@20': '0.1404', 'NDCG@20': '0.0604'}
2025-02-18 15:56:39,896 - EarlyStopping counter: 2 out of 10
2025-02-18 15:56:47,264 - {'epoch': 29, 'rec_loss': '5.3620'}
2025-02-18 15:56:47,907 - {'Epoch': 29, 'HR@5': '0.0642', 'NDCG@5': '0.0385', 'HR@10': '0.0972', 'NDCG@10': '0.0490', 'HR@20': '0.1450', 'NDCG@20': '0.0609'}
2025-02-18 15:56:47,908 - EarlyStopping counter: 3 out of 10
2025-02-18 15:56:54,677 - {'epoch': 30, 'rec_loss': '5.3417'}
2025-02-18 15:56:55,230 - {'Epoch': 30, 'HR@5': '0.0642', 'NDCG@5': '0.0401', 'HR@10': '0.0972', 'NDCG@10': '0.0507', 'HR@20': '0.1376', 'NDCG@20': '0.0609'}
2025-02-18 15:56:55,231 - EarlyStopping counter: 4 out of 10
2025-02-18 15:57:02,721 - {'epoch': 31, 'rec_loss': '5.3302'}
2025-02-18 15:57:03,383 - {'Epoch': 31, 'HR@5': '0.0642', 'NDCG@5': '0.0406', 'HR@10': '0.0945', 'NDCG@10': '0.0505', 'HR@20': '0.1450', 'NDCG@20': '0.0632'}
2025-02-18 15:57:03,384 - Validation score increased.  Saving model ...
2025-02-18 15:57:09,897 - {'epoch': 32, 'rec_loss': '5.3202'}
2025-02-18 15:57:10,605 - {'Epoch': 32, 'HR@5': '0.0606', 'NDCG@5': '0.0393', 'HR@10': '0.0945', 'NDCG@10': '0.0503', 'HR@20': '0.1440', 'NDCG@20': '0.0628'}
2025-02-18 15:57:10,607 - EarlyStopping counter: 1 out of 10
2025-02-18 15:57:17,369 - {'epoch': 33, 'rec_loss': '5.3046'}
2025-02-18 15:57:18,031 - {'Epoch': 33, 'HR@5': '0.0651', 'NDCG@5': '0.0429', 'HR@10': '0.0954', 'NDCG@10': '0.0528', 'HR@20': '0.1495', 'NDCG@20': '0.0664'}
2025-02-18 15:57:18,032 - Validation score increased.  Saving model ...
2025-02-18 15:57:24,988 - {'epoch': 34, 'rec_loss': '5.2860'}
2025-02-18 15:57:25,631 - {'Epoch': 34, 'HR@5': '0.0624', 'NDCG@5': '0.0395', 'HR@10': '0.0972', 'NDCG@10': '0.0506', 'HR@20': '0.1394', 'NDCG@20': '0.0612'}
2025-02-18 15:57:25,633 - EarlyStopping counter: 1 out of 10
2025-02-18 15:57:32,901 - {'epoch': 35, 'rec_loss': '5.2812'}
2025-02-18 15:57:33,551 - {'Epoch': 35, 'HR@5': '0.0642', 'NDCG@5': '0.0416', 'HR@10': '0.0945', 'NDCG@10': '0.0513', 'HR@20': '0.1459', 'NDCG@20': '0.0642'}
2025-02-18 15:57:33,552 - EarlyStopping counter: 2 out of 10
2025-02-18 15:57:40,702 - {'epoch': 36, 'rec_loss': '5.2825'}
2025-02-18 15:57:41,339 - {'Epoch': 36, 'HR@5': '0.0615', 'NDCG@5': '0.0410', 'HR@10': '0.1000', 'NDCG@10': '0.0535', 'HR@20': '0.1422', 'NDCG@20': '0.0639'}
2025-02-18 15:57:41,340 - EarlyStopping counter: 3 out of 10
2025-02-18 15:57:47,855 - {'epoch': 37, 'rec_loss': '5.2580'}
2025-02-18 15:57:48,512 - {'Epoch': 37, 'HR@5': '0.0651', 'NDCG@5': '0.0418', 'HR@10': '0.0936', 'NDCG@10': '0.0509', 'HR@20': '0.1404', 'NDCG@20': '0.0626'}
2025-02-18 15:57:48,513 - EarlyStopping counter: 4 out of 10
2025-02-18 15:57:55,495 - {'epoch': 38, 'rec_loss': '5.2636'}
2025-02-18 15:57:56,122 - {'Epoch': 38, 'HR@5': '0.0606', 'NDCG@5': '0.0405', 'HR@10': '0.0945', 'NDCG@10': '0.0514', 'HR@20': '0.1477', 'NDCG@20': '0.0646'}
2025-02-18 15:57:56,123 - EarlyStopping counter: 5 out of 10
2025-02-18 15:58:03,038 - {'epoch': 39, 'rec_loss': '5.2509'}
2025-02-18 15:58:03,752 - {'Epoch': 39, 'HR@5': '0.0642', 'NDCG@5': '0.0404', 'HR@10': '0.1018', 'NDCG@10': '0.0523', 'HR@20': '0.1422', 'NDCG@20': '0.0624'}
2025-02-18 15:58:03,753 - EarlyStopping counter: 6 out of 10
2025-02-18 15:58:10,700 - {'epoch': 40, 'rec_loss': '5.2511'}
2025-02-18 15:58:11,352 - {'Epoch': 40, 'HR@5': '0.0624', 'NDCG@5': '0.0407', 'HR@10': '0.0982', 'NDCG@10': '0.0523', 'HR@20': '0.1450', 'NDCG@20': '0.0639'}
2025-02-18 15:58:11,354 - EarlyStopping counter: 7 out of 10
2025-02-18 15:58:18,109 - {'epoch': 41, 'rec_loss': '5.2392'}
2025-02-18 15:58:18,783 - {'Epoch': 41, 'HR@5': '0.0688', 'NDCG@5': '0.0429', 'HR@10': '0.0963', 'NDCG@10': '0.0517', 'HR@20': '0.1486', 'NDCG@20': '0.0648'}
2025-02-18 15:58:18,784 - EarlyStopping counter: 8 out of 10
2025-02-18 15:58:25,996 - {'epoch': 42, 'rec_loss': '5.2382'}
2025-02-18 15:58:26,589 - {'Epoch': 42, 'HR@5': '0.0578', 'NDCG@5': '0.0381', 'HR@10': '0.0972', 'NDCG@10': '0.0507', 'HR@20': '0.1477', 'NDCG@20': '0.0632'}
2025-02-18 15:58:26,590 - EarlyStopping counter: 9 out of 10
2025-02-18 15:58:33,475 - {'epoch': 43, 'rec_loss': '5.2132'}
2025-02-18 15:58:34,149 - {'Epoch': 43, 'HR@5': '0.0633', 'NDCG@5': '0.0403', 'HR@10': '0.0954', 'NDCG@10': '0.0506', 'HR@20': '0.1450', 'NDCG@20': '0.0632'}
2025-02-18 15:58:34,151 - EarlyStopping counter: 10 out of 10
2025-02-18 15:58:34,151 - Early stopping
2025-02-18 15:58:34,151 - ---------------Test Score---------------
2025-02-18 15:58:34,725 - {'Epoch': 0, 'HR@5': '0.0541', 'NDCG@5': '0.0358', 'HR@10': '0.0752', 'NDCG@10': '0.0426', 'HR@20': '0.0972', 'NDCG@20': '0.0482'}
2025-02-18 15:58:34,726 - Scale_LastFM
2025-02-18 15:58:34,726 - {'Epoch': 0, 'HR@5': '0.0541', 'NDCG@5': '0.0358', 'HR@10': '0.0752', 'NDCG@10': '0.0426', 'HR@20': '0.0972', 'NDCG@20': '0.0482'}
2025-02-24 21:26:38,542 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-24 21:26:41,327 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-24 21:26:41,331 - Total Parameters: 388325
2025-02-24 21:26:47,024 - {'epoch': 0, 'rec_loss': '8.0336'}
2025-02-24 21:26:47,674 - {'Epoch': 0, 'HR@5': '0.0229', 'NDCG@5': '0.0157', 'HR@10': '0.0339', 'NDCG@10': '0.0191', 'HR@20': '0.0569', 'NDCG@20': '0.0250'}
2025-02-24 21:26:47,675 - Validation score increased.  Saving model ...
2025-02-24 21:26:53,011 - {'epoch': 1, 'rec_loss': '7.7471'}
2025-02-24 21:26:53,698 - {'Epoch': 1, 'HR@5': '0.0220', 'NDCG@5': '0.0132', 'HR@10': '0.0376', 'NDCG@10': '0.0182', 'HR@20': '0.0596', 'NDCG@20': '0.0238'}
2025-02-24 21:26:53,699 - EarlyStopping counter: 1 out of 10
2025-02-24 21:26:58,428 - {'epoch': 2, 'rec_loss': '7.5385'}
2025-02-24 21:26:59,064 - {'Epoch': 2, 'HR@5': '0.0229', 'NDCG@5': '0.0166', 'HR@10': '0.0413', 'NDCG@10': '0.0223', 'HR@20': '0.0670', 'NDCG@20': '0.0288'}
2025-02-24 21:26:59,065 - Validation score increased.  Saving model ...
2025-02-24 21:27:04,057 - {'epoch': 3, 'rec_loss': '7.3362'}
2025-02-24 21:27:04,795 - {'Epoch': 3, 'HR@5': '0.0303', 'NDCG@5': '0.0215', 'HR@10': '0.0450', 'NDCG@10': '0.0261', 'HR@20': '0.0761', 'NDCG@20': '0.0339'}
2025-02-24 21:27:04,797 - Validation score increased.  Saving model ...
2025-02-24 21:27:09,743 - {'epoch': 4, 'rec_loss': '7.1159'}
2025-02-24 21:27:10,384 - {'Epoch': 4, 'HR@5': '0.0330', 'NDCG@5': '0.0222', 'HR@10': '0.0569', 'NDCG@10': '0.0297', 'HR@20': '0.0853', 'NDCG@20': '0.0369'}
2025-02-24 21:27:10,385 - Validation score increased.  Saving model ...
2025-02-24 21:27:15,361 - {'epoch': 5, 'rec_loss': '6.9049'}
2025-02-24 21:27:16,021 - {'Epoch': 5, 'HR@5': '0.0404', 'NDCG@5': '0.0266', 'HR@10': '0.0587', 'NDCG@10': '0.0325', 'HR@20': '0.0972', 'NDCG@20': '0.0420'}
2025-02-24 21:27:16,023 - Validation score increased.  Saving model ...
2025-02-24 21:27:20,867 - {'epoch': 6, 'rec_loss': '6.7122'}
2025-02-24 21:27:21,541 - {'Epoch': 6, 'HR@5': '0.0394', 'NDCG@5': '0.0255', 'HR@10': '0.0624', 'NDCG@10': '0.0329', 'HR@20': '0.0954', 'NDCG@20': '0.0412'}
2025-02-24 21:27:21,542 - EarlyStopping counter: 1 out of 10
2025-02-24 21:27:26,385 - {'epoch': 7, 'rec_loss': '6.5408'}
2025-02-24 21:27:27,054 - {'Epoch': 7, 'HR@5': '0.0413', 'NDCG@5': '0.0261', 'HR@10': '0.0688', 'NDCG@10': '0.0348', 'HR@20': '0.0991', 'NDCG@20': '0.0424'}
2025-02-24 21:27:27,055 - Validation score increased.  Saving model ...
2025-02-24 21:27:31,993 - {'epoch': 8, 'rec_loss': '6.3876'}
2025-02-24 21:27:32,610 - {'Epoch': 8, 'HR@5': '0.0459', 'NDCG@5': '0.0282', 'HR@10': '0.0706', 'NDCG@10': '0.0362', 'HR@20': '0.1028', 'NDCG@20': '0.0442'}
2025-02-24 21:27:32,611 - Validation score increased.  Saving model ...
2025-02-24 21:27:37,935 - {'epoch': 9, 'rec_loss': '6.2440'}
2025-02-24 21:27:38,634 - {'Epoch': 9, 'HR@5': '0.0459', 'NDCG@5': '0.0285', 'HR@10': '0.0716', 'NDCG@10': '0.0367', 'HR@20': '0.1064', 'NDCG@20': '0.0454'}
2025-02-24 21:27:38,635 - Validation score increased.  Saving model ...
2025-02-24 21:27:43,888 - {'epoch': 10, 'rec_loss': '6.1274'}
2025-02-24 21:27:44,624 - {'Epoch': 10, 'HR@5': '0.0422', 'NDCG@5': '0.0261', 'HR@10': '0.0752', 'NDCG@10': '0.0367', 'HR@20': '0.1138', 'NDCG@20': '0.0463'}
2025-02-24 21:27:44,625 - Validation score increased.  Saving model ...
2025-02-24 21:27:49,670 - {'epoch': 11, 'rec_loss': '6.0414'}
2025-02-24 21:27:50,338 - {'Epoch': 11, 'HR@5': '0.0450', 'NDCG@5': '0.0279', 'HR@10': '0.0752', 'NDCG@10': '0.0378', 'HR@20': '0.1165', 'NDCG@20': '0.0481'}
2025-02-24 21:27:50,339 - Validation score increased.  Saving model ...
2025-02-24 21:27:56,043 - {'epoch': 12, 'rec_loss': '5.9432'}
2025-02-24 21:27:56,661 - {'Epoch': 12, 'HR@5': '0.0532', 'NDCG@5': '0.0336', 'HR@10': '0.0789', 'NDCG@10': '0.0420', 'HR@20': '0.1165', 'NDCG@20': '0.0514'}
2025-02-24 21:27:56,662 - Validation score increased.  Saving model ...
2025-02-24 21:28:01,932 - {'epoch': 13, 'rec_loss': '5.8796'}
2025-02-24 21:28:02,596 - {'Epoch': 13, 'HR@5': '0.0514', 'NDCG@5': '0.0315', 'HR@10': '0.0798', 'NDCG@10': '0.0406', 'HR@20': '0.1202', 'NDCG@20': '0.0509'}
2025-02-24 21:28:02,597 - EarlyStopping counter: 1 out of 10
2025-02-24 21:28:07,858 - {'epoch': 14, 'rec_loss': '5.8250'}
2025-02-24 21:28:08,569 - {'Epoch': 14, 'HR@5': '0.0477', 'NDCG@5': '0.0309', 'HR@10': '0.0844', 'NDCG@10': '0.0425', 'HR@20': '0.1229', 'NDCG@20': '0.0524'}
2025-02-24 21:28:08,571 - Validation score increased.  Saving model ...
2025-02-24 21:28:13,547 - {'epoch': 15, 'rec_loss': '5.7562'}
2025-02-24 21:28:14,317 - {'Epoch': 15, 'HR@5': '0.0560', 'NDCG@5': '0.0327', 'HR@10': '0.0853', 'NDCG@10': '0.0421', 'HR@20': '0.1239', 'NDCG@20': '0.0520'}
2025-02-24 21:28:14,318 - EarlyStopping counter: 1 out of 10
2025-02-24 21:28:19,265 - {'epoch': 16, 'rec_loss': '5.7083'}
2025-02-24 21:28:19,960 - {'Epoch': 16, 'HR@5': '0.0569', 'NDCG@5': '0.0358', 'HR@10': '0.0881', 'NDCG@10': '0.0458', 'HR@20': '0.1248', 'NDCG@20': '0.0551'}
2025-02-24 21:28:19,961 - Validation score increased.  Saving model ...
2025-02-24 21:28:25,307 - {'epoch': 17, 'rec_loss': '5.6622'}
2025-02-24 21:28:25,988 - {'Epoch': 17, 'HR@5': '0.0569', 'NDCG@5': '0.0344', 'HR@10': '0.0917', 'NDCG@10': '0.0455', 'HR@20': '0.1257', 'NDCG@20': '0.0540'}
2025-02-24 21:28:25,989 - EarlyStopping counter: 1 out of 10
2025-02-24 21:28:31,017 - {'epoch': 18, 'rec_loss': '5.6263'}
2025-02-24 21:28:31,735 - {'Epoch': 18, 'HR@5': '0.0596', 'NDCG@5': '0.0368', 'HR@10': '0.0853', 'NDCG@10': '0.0451', 'HR@20': '0.1275', 'NDCG@20': '0.0558'}
2025-02-24 21:28:31,736 - Validation score increased.  Saving model ...
2025-02-24 21:28:36,709 - {'epoch': 19, 'rec_loss': '5.5950'}
2025-02-24 21:28:37,435 - {'Epoch': 19, 'HR@5': '0.0587', 'NDCG@5': '0.0357', 'HR@10': '0.0890', 'NDCG@10': '0.0453', 'HR@20': '0.1321', 'NDCG@20': '0.0562'}
2025-02-24 21:28:37,436 - Validation score increased.  Saving model ...
2025-02-24 21:28:42,514 - {'epoch': 20, 'rec_loss': '5.5639'}
2025-02-24 21:28:43,192 - {'Epoch': 20, 'HR@5': '0.0578', 'NDCG@5': '0.0362', 'HR@10': '0.0927', 'NDCG@10': '0.0475', 'HR@20': '0.1330', 'NDCG@20': '0.0577'}
2025-02-24 21:28:43,193 - Validation score increased.  Saving model ...
2025-02-24 21:28:48,208 - {'epoch': 21, 'rec_loss': '5.5493'}
2025-02-24 21:28:48,894 - {'Epoch': 21, 'HR@5': '0.0688', 'NDCG@5': '0.0396', 'HR@10': '0.0936', 'NDCG@10': '0.0475', 'HR@20': '0.1321', 'NDCG@20': '0.0572'}
2025-02-24 21:28:48,895 - EarlyStopping counter: 1 out of 10
2025-02-24 21:28:54,440 - {'epoch': 22, 'rec_loss': '5.5109'}
2025-02-24 21:28:55,127 - {'Epoch': 22, 'HR@5': '0.0615', 'NDCG@5': '0.0371', 'HR@10': '0.0917', 'NDCG@10': '0.0470', 'HR@20': '0.1367', 'NDCG@20': '0.0583'}
2025-02-24 21:28:55,128 - Validation score increased.  Saving model ...
2025-02-24 21:29:00,803 - {'epoch': 23, 'rec_loss': '5.4919'}
2025-02-24 21:29:01,440 - {'Epoch': 23, 'HR@5': '0.0606', 'NDCG@5': '0.0368', 'HR@10': '0.0908', 'NDCG@10': '0.0466', 'HR@20': '0.1339', 'NDCG@20': '0.0575'}
2025-02-24 21:29:01,441 - EarlyStopping counter: 1 out of 10
2025-02-24 21:29:06,436 - {'epoch': 24, 'rec_loss': '5.4862'}
2025-02-24 21:29:07,082 - {'Epoch': 24, 'HR@5': '0.0587', 'NDCG@5': '0.0350', 'HR@10': '0.0890', 'NDCG@10': '0.0448', 'HR@20': '0.1349', 'NDCG@20': '0.0564'}
2025-02-24 21:29:07,083 - EarlyStopping counter: 2 out of 10
2025-02-24 21:29:12,132 - {'epoch': 25, 'rec_loss': '5.4728'}
2025-02-24 21:29:12,779 - {'Epoch': 25, 'HR@5': '0.0633', 'NDCG@5': '0.0385', 'HR@10': '0.0927', 'NDCG@10': '0.0480', 'HR@20': '0.1349', 'NDCG@20': '0.0586'}
2025-02-24 21:29:12,780 - Validation score increased.  Saving model ...
2025-02-24 21:29:17,890 - {'epoch': 26, 'rec_loss': '5.4546'}
2025-02-24 21:29:18,574 - {'Epoch': 26, 'HR@5': '0.0633', 'NDCG@5': '0.0388', 'HR@10': '0.0936', 'NDCG@10': '0.0484', 'HR@20': '0.1394', 'NDCG@20': '0.0598'}
2025-02-24 21:29:18,575 - Validation score increased.  Saving model ...
2025-02-24 21:29:23,479 - {'epoch': 27, 'rec_loss': '5.4302'}
2025-02-24 21:29:24,213 - {'Epoch': 27, 'HR@5': '0.0651', 'NDCG@5': '0.0399', 'HR@10': '0.0945', 'NDCG@10': '0.0494', 'HR@20': '0.1294', 'NDCG@20': '0.0581'}
2025-02-24 21:29:24,215 - EarlyStopping counter: 1 out of 10
2025-02-24 21:29:29,413 - {'epoch': 28, 'rec_loss': '5.4352'}
2025-02-24 21:29:30,044 - {'Epoch': 28, 'HR@5': '0.0633', 'NDCG@5': '0.0389', 'HR@10': '0.0917', 'NDCG@10': '0.0482', 'HR@20': '0.1312', 'NDCG@20': '0.0582'}
2025-02-24 21:29:30,045 - EarlyStopping counter: 2 out of 10
2025-02-24 21:29:35,842 - {'epoch': 29, 'rec_loss': '5.4122'}
2025-02-24 21:29:36,513 - {'Epoch': 29, 'HR@5': '0.0633', 'NDCG@5': '0.0378', 'HR@10': '0.0963', 'NDCG@10': '0.0484', 'HR@20': '0.1394', 'NDCG@20': '0.0592'}
2025-02-24 21:29:36,514 - EarlyStopping counter: 3 out of 10
2025-02-24 21:29:42,246 - {'epoch': 30, 'rec_loss': '5.3917'}
2025-02-24 21:29:42,941 - {'Epoch': 30, 'HR@5': '0.0651', 'NDCG@5': '0.0390', 'HR@10': '0.0945', 'NDCG@10': '0.0486', 'HR@20': '0.1394', 'NDCG@20': '0.0598'}
2025-02-24 21:29:42,942 - EarlyStopping counter: 4 out of 10
2025-02-24 21:29:47,908 - {'epoch': 31, 'rec_loss': '5.3782'}
2025-02-24 21:29:48,568 - {'Epoch': 31, 'HR@5': '0.0679', 'NDCG@5': '0.0416', 'HR@10': '0.0954', 'NDCG@10': '0.0505', 'HR@20': '0.1422', 'NDCG@20': '0.0622'}
2025-02-24 21:29:48,569 - Validation score increased.  Saving model ...
2025-02-24 21:29:53,636 - {'epoch': 32, 'rec_loss': '5.3692'}
2025-02-24 21:29:54,354 - {'Epoch': 32, 'HR@5': '0.0642', 'NDCG@5': '0.0389', 'HR@10': '0.0936', 'NDCG@10': '0.0483', 'HR@20': '0.1495', 'NDCG@20': '0.0624'}
2025-02-24 21:29:54,356 - Validation score increased.  Saving model ...
2025-02-24 21:29:59,065 - {'epoch': 33, 'rec_loss': '5.3531'}
2025-02-24 21:29:59,775 - {'Epoch': 33, 'HR@5': '0.0670', 'NDCG@5': '0.0424', 'HR@10': '0.0972', 'NDCG@10': '0.0520', 'HR@20': '0.1440', 'NDCG@20': '0.0638'}
2025-02-24 21:29:59,776 - Validation score increased.  Saving model ...
2025-02-24 21:30:04,841 - {'epoch': 34, 'rec_loss': '5.3347'}
2025-02-24 21:30:05,499 - {'Epoch': 34, 'HR@5': '0.0615', 'NDCG@5': '0.0385', 'HR@10': '0.0963', 'NDCG@10': '0.0497', 'HR@20': '0.1431', 'NDCG@20': '0.0614'}
2025-02-24 21:30:05,500 - EarlyStopping counter: 1 out of 10
2025-02-24 21:30:10,493 - {'epoch': 35, 'rec_loss': '5.3313'}
2025-02-24 21:30:11,150 - {'Epoch': 35, 'HR@5': '0.0679', 'NDCG@5': '0.0423', 'HR@10': '0.0936', 'NDCG@10': '0.0505', 'HR@20': '0.1477', 'NDCG@20': '0.0639'}
2025-02-24 21:30:11,151 - Validation score increased.  Saving model ...
2025-02-24 21:30:16,602 - {'epoch': 36, 'rec_loss': '5.3297'}
2025-02-24 21:30:17,322 - {'Epoch': 36, 'HR@5': '0.0651', 'NDCG@5': '0.0418', 'HR@10': '0.0954', 'NDCG@10': '0.0516', 'HR@20': '0.1450', 'NDCG@20': '0.0639'}
2025-02-24 21:30:17,323 - EarlyStopping counter: 1 out of 10
2025-02-24 21:30:22,137 - {'epoch': 37, 'rec_loss': '5.3102'}
2025-02-24 21:30:22,812 - {'Epoch': 37, 'HR@5': '0.0651', 'NDCG@5': '0.0408', 'HR@10': '0.0927', 'NDCG@10': '0.0496', 'HR@20': '0.1376', 'NDCG@20': '0.0609'}
2025-02-24 21:30:22,813 - EarlyStopping counter: 2 out of 10
2025-02-24 21:30:27,687 - {'epoch': 38, 'rec_loss': '5.3058'}
2025-02-24 21:30:28,326 - {'Epoch': 38, 'HR@5': '0.0615', 'NDCG@5': '0.0403', 'HR@10': '0.0908', 'NDCG@10': '0.0499', 'HR@20': '0.1394', 'NDCG@20': '0.0621'}
2025-02-24 21:30:28,327 - EarlyStopping counter: 3 out of 10
2025-02-24 21:30:33,487 - {'epoch': 39, 'rec_loss': '5.3045'}
2025-02-24 21:30:34,097 - {'Epoch': 39, 'HR@5': '0.0624', 'NDCG@5': '0.0396', 'HR@10': '0.0991', 'NDCG@10': '0.0513', 'HR@20': '0.1440', 'NDCG@20': '0.0625'}
2025-02-24 21:30:34,099 - EarlyStopping counter: 4 out of 10
2025-02-24 21:30:40,012 - {'epoch': 40, 'rec_loss': '5.2930'}
2025-02-24 21:30:40,688 - {'Epoch': 40, 'HR@5': '0.0651', 'NDCG@5': '0.0405', 'HR@10': '0.1009', 'NDCG@10': '0.0520', 'HR@20': '0.1440', 'NDCG@20': '0.0627'}
2025-02-24 21:30:40,689 - EarlyStopping counter: 5 out of 10
2025-02-24 21:30:46,262 - {'epoch': 41, 'rec_loss': '5.2871'}
2025-02-24 21:30:46,955 - {'Epoch': 41, 'HR@5': '0.0716', 'NDCG@5': '0.0449', 'HR@10': '0.0954', 'NDCG@10': '0.0527', 'HR@20': '0.1486', 'NDCG@20': '0.0661'}
2025-02-24 21:30:46,956 - Validation score increased.  Saving model ...
2025-02-24 21:30:52,095 - {'epoch': 42, 'rec_loss': '5.2838'}
2025-02-24 21:30:52,773 - {'Epoch': 42, 'HR@5': '0.0615', 'NDCG@5': '0.0393', 'HR@10': '0.0963', 'NDCG@10': '0.0505', 'HR@20': '0.1468', 'NDCG@20': '0.0633'}
2025-02-24 21:30:52,774 - EarlyStopping counter: 1 out of 10
2025-02-24 21:30:58,165 - {'epoch': 43, 'rec_loss': '5.2613'}
2025-02-24 21:30:58,809 - {'Epoch': 43, 'HR@5': '0.0633', 'NDCG@5': '0.0413', 'HR@10': '0.0954', 'NDCG@10': '0.0516', 'HR@20': '0.1431', 'NDCG@20': '0.0637'}
2025-02-24 21:30:58,811 - EarlyStopping counter: 2 out of 10
2025-02-24 21:31:04,258 - {'epoch': 44, 'rec_loss': '5.2662'}
2025-02-24 21:31:04,932 - {'Epoch': 44, 'HR@5': '0.0587', 'NDCG@5': '0.0398', 'HR@10': '0.1009', 'NDCG@10': '0.0534', 'HR@20': '0.1468', 'NDCG@20': '0.0650'}
2025-02-24 21:31:04,933 - EarlyStopping counter: 3 out of 10
2025-02-24 21:31:09,652 - {'epoch': 45, 'rec_loss': '5.2630'}
2025-02-24 21:31:10,288 - {'Epoch': 45, 'HR@5': '0.0651', 'NDCG@5': '0.0421', 'HR@10': '0.0982', 'NDCG@10': '0.0528', 'HR@20': '0.1376', 'NDCG@20': '0.0627'}
2025-02-24 21:31:10,290 - EarlyStopping counter: 4 out of 10
2025-02-24 21:31:15,518 - {'epoch': 46, 'rec_loss': '5.2491'}
2025-02-24 21:31:16,206 - {'Epoch': 46, 'HR@5': '0.0642', 'NDCG@5': '0.0396', 'HR@10': '0.0982', 'NDCG@10': '0.0505', 'HR@20': '0.1431', 'NDCG@20': '0.0618'}
2025-02-24 21:31:16,207 - EarlyStopping counter: 5 out of 10
2025-02-24 21:31:20,817 - {'epoch': 47, 'rec_loss': '5.2306'}
2025-02-24 21:31:21,513 - {'Epoch': 47, 'HR@5': '0.0633', 'NDCG@5': '0.0413', 'HR@10': '0.0954', 'NDCG@10': '0.0518', 'HR@20': '0.1477', 'NDCG@20': '0.0649'}
2025-02-24 21:31:21,514 - EarlyStopping counter: 6 out of 10
2025-02-24 21:31:26,355 - {'epoch': 48, 'rec_loss': '5.2310'}
2025-02-24 21:31:27,008 - {'Epoch': 48, 'HR@5': '0.0688', 'NDCG@5': '0.0431', 'HR@10': '0.0991', 'NDCG@10': '0.0527', 'HR@20': '0.1505', 'NDCG@20': '0.0656'}
2025-02-24 21:31:27,009 - EarlyStopping counter: 7 out of 10
2025-02-24 21:31:31,762 - {'epoch': 49, 'rec_loss': '5.2285'}
2025-02-24 21:31:32,427 - {'Epoch': 49, 'HR@5': '0.0642', 'NDCG@5': '0.0403', 'HR@10': '0.0991', 'NDCG@10': '0.0515', 'HR@20': '0.1486', 'NDCG@20': '0.0640'}
2025-02-24 21:31:32,428 - EarlyStopping counter: 8 out of 10
2025-02-24 21:31:37,268 - {'epoch': 50, 'rec_loss': '5.2243'}
2025-02-24 21:31:37,936 - {'Epoch': 50, 'HR@5': '0.0651', 'NDCG@5': '0.0399', 'HR@10': '0.1009', 'NDCG@10': '0.0515', 'HR@20': '0.1505', 'NDCG@20': '0.0640'}
2025-02-24 21:31:37,937 - EarlyStopping counter: 9 out of 10
2025-02-24 21:31:42,847 - {'epoch': 51, 'rec_loss': '5.2188'}
2025-02-24 21:31:43,553 - {'Epoch': 51, 'HR@5': '0.0661', 'NDCG@5': '0.0408', 'HR@10': '0.1009', 'NDCG@10': '0.0519', 'HR@20': '0.1486', 'NDCG@20': '0.0640'}
2025-02-24 21:31:43,554 - EarlyStopping counter: 10 out of 10
2025-02-24 21:31:43,554 - Early stopping
2025-02-24 21:31:43,554 - ---------------Test Score---------------
2025-02-24 21:31:44,228 - {'Epoch': 0, 'HR@5': '0.0523', 'NDCG@5': '0.0346', 'HR@10': '0.0716', 'NDCG@10': '0.0407', 'HR@20': '0.1018', 'NDCG@20': '0.0484'}
2025-02-24 21:31:44,229 - Scale_LastFM
2025-02-24 21:31:44,229 - {'Epoch': 0, 'HR@5': '0.0523', 'NDCG@5': '0.0346', 'HR@10': '0.0716', 'NDCG@10': '0.0407', 'HR@20': '0.1018', 'NDCG@20': '0.0484'}
2025-02-24 21:34:51,296 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-24 21:34:54,100 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-24 21:34:54,103 - Total Parameters: 388325
2025-02-24 21:34:59,811 - {'epoch': 0, 'rec_loss': '8.0343'}
2025-02-24 21:35:00,476 - {'Epoch': 0, 'HR@5': '0.0239', 'NDCG@5': '0.0168', 'HR@10': '0.0339', 'NDCG@10': '0.0199', 'HR@20': '0.0569', 'NDCG@20': '0.0258'}
2025-02-24 21:35:00,478 - Validation score increased.  Saving model ...
2025-02-24 21:35:05,427 - {'epoch': 1, 'rec_loss': '7.7565'}
2025-02-24 21:35:06,160 - {'Epoch': 1, 'HR@5': '0.0229', 'NDCG@5': '0.0135', 'HR@10': '0.0376', 'NDCG@10': '0.0184', 'HR@20': '0.0624', 'NDCG@20': '0.0245'}
2025-02-24 21:35:06,161 - EarlyStopping counter: 1 out of 10
2025-02-24 21:35:11,040 - {'epoch': 2, 'rec_loss': '7.5623'}
2025-02-24 21:35:11,679 - {'Epoch': 2, 'HR@5': '0.0183', 'NDCG@5': '0.0139', 'HR@10': '0.0376', 'NDCG@10': '0.0201', 'HR@20': '0.0606', 'NDCG@20': '0.0259'}
2025-02-24 21:35:11,681 - Validation score increased.  Saving model ...
2025-02-24 21:35:16,759 - {'epoch': 3, 'rec_loss': '7.3765'}
2025-02-24 21:35:17,484 - {'Epoch': 3, 'HR@5': '0.0275', 'NDCG@5': '0.0197', 'HR@10': '0.0404', 'NDCG@10': '0.0238', 'HR@20': '0.0697', 'NDCG@20': '0.0311'}
2025-02-24 21:35:17,486 - Validation score increased.  Saving model ...
2025-02-24 21:35:22,633 - {'epoch': 4, 'rec_loss': '7.1748'}
2025-02-24 21:35:23,342 - {'Epoch': 4, 'HR@5': '0.0303', 'NDCG@5': '0.0217', 'HR@10': '0.0569', 'NDCG@10': '0.0299', 'HR@20': '0.0771', 'NDCG@20': '0.0350'}
2025-02-24 21:35:23,343 - Validation score increased.  Saving model ...
2025-02-24 21:35:28,620 - {'epoch': 5, 'rec_loss': '6.9715'}
2025-02-24 21:35:29,262 - {'Epoch': 5, 'HR@5': '0.0376', 'NDCG@5': '0.0253', 'HR@10': '0.0560', 'NDCG@10': '0.0313', 'HR@20': '0.0890', 'NDCG@20': '0.0395'}
2025-02-24 21:35:29,263 - Validation score increased.  Saving model ...
2025-02-24 21:35:34,448 - {'epoch': 6, 'rec_loss': '6.7926'}
2025-02-24 21:35:35,093 - {'Epoch': 6, 'HR@5': '0.0385', 'NDCG@5': '0.0259', 'HR@10': '0.0606', 'NDCG@10': '0.0330', 'HR@20': '0.0899', 'NDCG@20': '0.0404'}
2025-02-24 21:35:35,094 - Validation score increased.  Saving model ...
2025-02-24 21:35:39,970 - {'epoch': 7, 'rec_loss': '6.6239'}
2025-02-24 21:35:40,703 - {'Epoch': 7, 'HR@5': '0.0413', 'NDCG@5': '0.0256', 'HR@10': '0.0651', 'NDCG@10': '0.0333', 'HR@20': '0.0936', 'NDCG@20': '0.0406'}
2025-02-24 21:35:40,704 - Validation score increased.  Saving model ...
2025-02-24 21:35:45,395 - {'epoch': 8, 'rec_loss': '6.4695'}
2025-02-24 21:35:46,131 - {'Epoch': 8, 'HR@5': '0.0431', 'NDCG@5': '0.0278', 'HR@10': '0.0670', 'NDCG@10': '0.0355', 'HR@20': '0.0982', 'NDCG@20': '0.0433'}
2025-02-24 21:35:46,133 - Validation score increased.  Saving model ...
2025-02-24 21:35:51,441 - {'epoch': 9, 'rec_loss': '6.3324'}
2025-02-24 21:35:52,129 - {'Epoch': 9, 'HR@5': '0.0459', 'NDCG@5': '0.0281', 'HR@10': '0.0679', 'NDCG@10': '0.0353', 'HR@20': '0.1037', 'NDCG@20': '0.0443'}
2025-02-24 21:35:52,131 - Validation score increased.  Saving model ...
2025-02-24 21:35:57,308 - {'epoch': 10, 'rec_loss': '6.2181'}
2025-02-24 21:35:58,017 - {'Epoch': 10, 'HR@5': '0.0440', 'NDCG@5': '0.0273', 'HR@10': '0.0734', 'NDCG@10': '0.0369', 'HR@20': '0.1101', 'NDCG@20': '0.0459'}
2025-02-24 21:35:58,018 - Validation score increased.  Saving model ...
2025-02-24 21:36:02,830 - {'epoch': 11, 'rec_loss': '6.1297'}
2025-02-24 21:36:03,526 - {'Epoch': 11, 'HR@5': '0.0413', 'NDCG@5': '0.0267', 'HR@10': '0.0734', 'NDCG@10': '0.0371', 'HR@20': '0.1101', 'NDCG@20': '0.0465'}
2025-02-24 21:36:03,527 - Validation score increased.  Saving model ...
2025-02-24 21:36:08,941 - {'epoch': 12, 'rec_loss': '6.0282'}
2025-02-24 21:36:09,660 - {'Epoch': 12, 'HR@5': '0.0514', 'NDCG@5': '0.0330', 'HR@10': '0.0780', 'NDCG@10': '0.0416', 'HR@20': '0.1183', 'NDCG@20': '0.0515'}
2025-02-24 21:36:09,661 - Validation score increased.  Saving model ...
2025-02-24 21:36:14,760 - {'epoch': 13, 'rec_loss': '5.9619'}
2025-02-24 21:36:15,489 - {'Epoch': 13, 'HR@5': '0.0495', 'NDCG@5': '0.0306', 'HR@10': '0.0798', 'NDCG@10': '0.0402', 'HR@20': '0.1119', 'NDCG@20': '0.0484'}
2025-02-24 21:36:15,490 - EarlyStopping counter: 1 out of 10
2025-02-24 21:36:20,698 - {'epoch': 14, 'rec_loss': '5.9011'}
2025-02-24 21:36:21,384 - {'Epoch': 14, 'HR@5': '0.0450', 'NDCG@5': '0.0299', 'HR@10': '0.0798', 'NDCG@10': '0.0410', 'HR@20': '0.1165', 'NDCG@20': '0.0503'}
2025-02-24 21:36:21,385 - EarlyStopping counter: 2 out of 10
2025-02-24 21:36:26,292 - {'epoch': 15, 'rec_loss': '5.8329'}
2025-02-24 21:36:26,957 - {'Epoch': 15, 'HR@5': '0.0514', 'NDCG@5': '0.0310', 'HR@10': '0.0798', 'NDCG@10': '0.0400', 'HR@20': '0.1229', 'NDCG@20': '0.0509'}
2025-02-24 21:36:26,958 - EarlyStopping counter: 3 out of 10
2025-02-24 21:36:31,634 - {'epoch': 16, 'rec_loss': '5.7810'}
2025-02-24 21:36:32,295 - {'Epoch': 16, 'HR@5': '0.0486', 'NDCG@5': '0.0328', 'HR@10': '0.0817', 'NDCG@10': '0.0434', 'HR@20': '0.1220', 'NDCG@20': '0.0538'}
2025-02-24 21:36:32,296 - Validation score increased.  Saving model ...
2025-02-24 21:36:37,221 - {'epoch': 17, 'rec_loss': '5.7219'}
2025-02-24 21:36:37,923 - {'Epoch': 17, 'HR@5': '0.0505', 'NDCG@5': '0.0322', 'HR@10': '0.0844', 'NDCG@10': '0.0431', 'HR@20': '0.1229', 'NDCG@20': '0.0529'}
2025-02-24 21:36:37,924 - EarlyStopping counter: 1 out of 10
2025-02-24 21:36:42,871 - {'epoch': 18, 'rec_loss': '5.6935'}
2025-02-24 21:36:43,589 - {'Epoch': 18, 'HR@5': '0.0560', 'NDCG@5': '0.0358', 'HR@10': '0.0835', 'NDCG@10': '0.0449', 'HR@20': '0.1257', 'NDCG@20': '0.0553'}
2025-02-24 21:36:43,591 - Validation score increased.  Saving model ...
2025-02-24 21:36:48,421 - {'epoch': 19, 'rec_loss': '5.6578'}
2025-02-24 21:36:49,117 - {'Epoch': 19, 'HR@5': '0.0505', 'NDCG@5': '0.0321', 'HR@10': '0.0862', 'NDCG@10': '0.0436', 'HR@20': '0.1303', 'NDCG@20': '0.0546'}
2025-02-24 21:36:49,118 - EarlyStopping counter: 1 out of 10
2025-02-24 21:36:54,631 - {'epoch': 20, 'rec_loss': '5.6232'}
2025-02-24 21:36:55,320 - {'Epoch': 20, 'HR@5': '0.0578', 'NDCG@5': '0.0361', 'HR@10': '0.0936', 'NDCG@10': '0.0476', 'HR@20': '0.1275', 'NDCG@20': '0.0561'}
2025-02-24 21:36:55,322 - Validation score increased.  Saving model ...
2025-02-24 21:37:00,385 - {'epoch': 21, 'rec_loss': '5.6076'}
2025-02-24 21:37:01,050 - {'Epoch': 21, 'HR@5': '0.0587', 'NDCG@5': '0.0359', 'HR@10': '0.0917', 'NDCG@10': '0.0466', 'HR@20': '0.1257', 'NDCG@20': '0.0550'}
2025-02-24 21:37:01,051 - EarlyStopping counter: 1 out of 10
2025-02-24 21:37:06,100 - {'epoch': 22, 'rec_loss': '5.5680'}
2025-02-24 21:37:06,788 - {'Epoch': 22, 'HR@5': '0.0615', 'NDCG@5': '0.0363', 'HR@10': '0.0853', 'NDCG@10': '0.0441', 'HR@20': '0.1303', 'NDCG@20': '0.0555'}
2025-02-24 21:37:06,789 - EarlyStopping counter: 2 out of 10
2025-02-24 21:37:11,529 - {'epoch': 23, 'rec_loss': '5.5419'}
2025-02-24 21:37:12,246 - {'Epoch': 23, 'HR@5': '0.0624', 'NDCG@5': '0.0374', 'HR@10': '0.0844', 'NDCG@10': '0.0444', 'HR@20': '0.1321', 'NDCG@20': '0.0565'}
2025-02-24 21:37:12,247 - Validation score increased.  Saving model ...
2025-02-24 21:37:17,426 - {'epoch': 24, 'rec_loss': '5.5441'}
2025-02-24 21:37:18,098 - {'Epoch': 24, 'HR@5': '0.0550', 'NDCG@5': '0.0342', 'HR@10': '0.0936', 'NDCG@10': '0.0466', 'HR@20': '0.1339', 'NDCG@20': '0.0567'}
2025-02-24 21:37:18,099 - Validation score increased.  Saving model ...
2025-02-24 21:37:22,982 - {'epoch': 25, 'rec_loss': '5.5255'}
2025-02-24 21:37:23,690 - {'Epoch': 25, 'HR@5': '0.0587', 'NDCG@5': '0.0373', 'HR@10': '0.0908', 'NDCG@10': '0.0478', 'HR@20': '0.1358', 'NDCG@20': '0.0590'}
2025-02-24 21:37:23,691 - Validation score increased.  Saving model ...
2025-02-24 21:37:28,781 - {'epoch': 26, 'rec_loss': '5.5106'}
2025-02-24 21:37:29,429 - {'Epoch': 26, 'HR@5': '0.0624', 'NDCG@5': '0.0369', 'HR@10': '0.0899', 'NDCG@10': '0.0459', 'HR@20': '0.1376', 'NDCG@20': '0.0578'}
2025-02-24 21:37:29,430 - EarlyStopping counter: 1 out of 10
2025-02-24 21:37:34,642 - {'epoch': 27, 'rec_loss': '5.4861'}
2025-02-24 21:37:35,323 - {'Epoch': 27, 'HR@5': '0.0624', 'NDCG@5': '0.0379', 'HR@10': '0.0936', 'NDCG@10': '0.0481', 'HR@20': '0.1312', 'NDCG@20': '0.0574'}
2025-02-24 21:37:35,324 - EarlyStopping counter: 2 out of 10
2025-02-24 21:37:40,354 - {'epoch': 28, 'rec_loss': '5.4812'}
2025-02-24 21:37:40,995 - {'Epoch': 28, 'HR@5': '0.0615', 'NDCG@5': '0.0380', 'HR@10': '0.0936', 'NDCG@10': '0.0485', 'HR@20': '0.1349', 'NDCG@20': '0.0588'}
2025-02-24 21:37:40,996 - EarlyStopping counter: 3 out of 10
2025-02-24 21:37:46,093 - {'epoch': 29, 'rec_loss': '5.4622'}
2025-02-24 21:37:46,785 - {'Epoch': 29, 'HR@5': '0.0624', 'NDCG@5': '0.0386', 'HR@10': '0.0936', 'NDCG@10': '0.0485', 'HR@20': '0.1404', 'NDCG@20': '0.0603'}
2025-02-24 21:37:46,786 - Validation score increased.  Saving model ...
2025-02-24 21:37:51,872 - {'epoch': 30, 'rec_loss': '5.4437'}
2025-02-24 21:37:52,562 - {'Epoch': 30, 'HR@5': '0.0642', 'NDCG@5': '0.0406', 'HR@10': '0.0927', 'NDCG@10': '0.0497', 'HR@20': '0.1394', 'NDCG@20': '0.0613'}
2025-02-24 21:37:52,563 - Validation score increased.  Saving model ...
2025-02-24 21:37:57,669 - {'epoch': 31, 'rec_loss': '5.4241'}
2025-02-24 21:37:58,373 - {'Epoch': 31, 'HR@5': '0.0670', 'NDCG@5': '0.0405', 'HR@10': '0.0963', 'NDCG@10': '0.0500', 'HR@20': '0.1468', 'NDCG@20': '0.0626'}
2025-02-24 21:37:58,374 - Validation score increased.  Saving model ...
2025-02-24 21:38:03,404 - {'epoch': 32, 'rec_loss': '5.4138'}
2025-02-24 21:38:04,080 - {'Epoch': 32, 'HR@5': '0.0633', 'NDCG@5': '0.0397', 'HR@10': '0.0954', 'NDCG@10': '0.0498', 'HR@20': '0.1468', 'NDCG@20': '0.0626'}
2025-02-24 21:38:04,081 - Validation score increased.  Saving model ...
2025-02-24 21:38:08,855 - {'epoch': 33, 'rec_loss': '5.3988'}
2025-02-24 21:38:09,590 - {'Epoch': 33, 'HR@5': '0.0642', 'NDCG@5': '0.0434', 'HR@10': '0.0936', 'NDCG@10': '0.0531', 'HR@20': '0.1440', 'NDCG@20': '0.0658'}
2025-02-24 21:38:09,592 - Validation score increased.  Saving model ...
2025-02-24 21:38:14,804 - {'epoch': 34, 'rec_loss': '5.3749'}
2025-02-24 21:38:15,517 - {'Epoch': 34, 'HR@5': '0.0615', 'NDCG@5': '0.0391', 'HR@10': '0.0927', 'NDCG@10': '0.0491', 'HR@20': '0.1440', 'NDCG@20': '0.0621'}
2025-02-24 21:38:15,518 - EarlyStopping counter: 1 out of 10
2025-02-24 21:38:20,759 - {'epoch': 35, 'rec_loss': '5.3841'}
2025-02-24 21:38:21,407 - {'Epoch': 35, 'HR@5': '0.0624', 'NDCG@5': '0.0407', 'HR@10': '0.0872', 'NDCG@10': '0.0490', 'HR@20': '0.1468', 'NDCG@20': '0.0639'}
2025-02-24 21:38:21,408 - EarlyStopping counter: 2 out of 10
2025-02-24 21:38:26,233 - {'epoch': 36, 'rec_loss': '5.3807'}
2025-02-24 21:38:26,890 - {'Epoch': 36, 'HR@5': '0.0651', 'NDCG@5': '0.0415', 'HR@10': '0.0972', 'NDCG@10': '0.0518', 'HR@20': '0.1459', 'NDCG@20': '0.0638'}
2025-02-24 21:38:26,892 - EarlyStopping counter: 3 out of 10
2025-02-24 21:38:32,299 - {'epoch': 37, 'rec_loss': '5.3583'}
2025-02-24 21:38:33,055 - {'Epoch': 37, 'HR@5': '0.0624', 'NDCG@5': '0.0398', 'HR@10': '0.0927', 'NDCG@10': '0.0496', 'HR@20': '0.1431', 'NDCG@20': '0.0623'}
2025-02-24 21:38:33,056 - EarlyStopping counter: 4 out of 10
2025-02-24 21:38:38,116 - {'epoch': 38, 'rec_loss': '5.3501'}
2025-02-24 21:38:38,799 - {'Epoch': 38, 'HR@5': '0.0651', 'NDCG@5': '0.0405', 'HR@10': '0.0954', 'NDCG@10': '0.0503', 'HR@20': '0.1431', 'NDCG@20': '0.0622'}
2025-02-24 21:38:38,800 - EarlyStopping counter: 5 out of 10
2025-02-24 21:38:43,686 - {'epoch': 39, 'rec_loss': '5.3494'}
2025-02-24 21:38:44,377 - {'Epoch': 39, 'HR@5': '0.0679', 'NDCG@5': '0.0417', 'HR@10': '0.0936', 'NDCG@10': '0.0500', 'HR@20': '0.1486', 'NDCG@20': '0.0637'}
2025-02-24 21:38:44,378 - EarlyStopping counter: 6 out of 10
2025-02-24 21:38:49,447 - {'epoch': 40, 'rec_loss': '5.3340'}
2025-02-24 21:38:50,083 - {'Epoch': 40, 'HR@5': '0.0642', 'NDCG@5': '0.0402', 'HR@10': '0.0945', 'NDCG@10': '0.0500', 'HR@20': '0.1450', 'NDCG@20': '0.0627'}
2025-02-24 21:38:50,084 - EarlyStopping counter: 7 out of 10
2025-02-24 21:38:55,633 - {'epoch': 41, 'rec_loss': '5.3286'}
2025-02-24 21:38:56,338 - {'Epoch': 41, 'HR@5': '0.0697', 'NDCG@5': '0.0443', 'HR@10': '0.0954', 'NDCG@10': '0.0526', 'HR@20': '0.1459', 'NDCG@20': '0.0653'}
2025-02-24 21:38:56,339 - EarlyStopping counter: 8 out of 10
2025-02-24 21:39:01,655 - {'epoch': 42, 'rec_loss': '5.3240'}
2025-02-24 21:39:02,315 - {'Epoch': 42, 'HR@5': '0.0624', 'NDCG@5': '0.0405', 'HR@10': '0.0936', 'NDCG@10': '0.0506', 'HR@20': '0.1422', 'NDCG@20': '0.0629'}
2025-02-24 21:39:02,316 - EarlyStopping counter: 9 out of 10
2025-02-24 21:39:07,390 - {'epoch': 43, 'rec_loss': '5.3039'}
2025-02-24 21:39:08,090 - {'Epoch': 43, 'HR@5': '0.0615', 'NDCG@5': '0.0407', 'HR@10': '0.0982', 'NDCG@10': '0.0525', 'HR@20': '0.1394', 'NDCG@20': '0.0629'}
2025-02-24 21:39:08,091 - EarlyStopping counter: 10 out of 10
2025-02-24 21:39:08,092 - Early stopping
2025-02-24 21:39:08,092 - ---------------Test Score---------------
2025-02-24 21:39:08,746 - {'Epoch': 0, 'HR@5': '0.0514', 'NDCG@5': '0.0337', 'HR@10': '0.0688', 'NDCG@10': '0.0393', 'HR@20': '0.0972', 'NDCG@20': '0.0464'}
2025-02-24 21:39:08,747 - Scale_LastFM
2025-02-24 21:39:08,747 - {'Epoch': 0, 'HR@5': '0.0514', 'NDCG@5': '0.0337', 'HR@10': '0.0688', 'NDCG@10': '0.0393', 'HR@20': '0.0972', 'NDCG@20': '0.0464'}
2025-02-24 21:42:58,072 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 12], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-24 21:43:00,885 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-24 21:43:00,889 - Total Parameters: 388325
2025-02-24 21:43:06,803 - {'epoch': 0, 'rec_loss': '8.0388'}
2025-02-24 21:43:07,565 - {'Epoch': 0, 'HR@5': '0.0239', 'NDCG@5': '0.0165', 'HR@10': '0.0349', 'NDCG@10': '0.0200', 'HR@20': '0.0569', 'NDCG@20': '0.0256'}
2025-02-24 21:43:07,567 - Validation score increased.  Saving model ...
2025-02-24 21:43:12,692 - {'epoch': 1, 'rec_loss': '7.7716'}
2025-02-24 21:43:13,402 - {'Epoch': 1, 'HR@5': '0.0257', 'NDCG@5': '0.0151', 'HR@10': '0.0358', 'NDCG@10': '0.0185', 'HR@20': '0.0642', 'NDCG@20': '0.0256'}
2025-02-24 21:43:13,403 - EarlyStopping counter: 1 out of 10
2025-02-24 21:43:18,521 - {'epoch': 2, 'rec_loss': '7.5930'}
2025-02-24 21:43:19,189 - {'Epoch': 2, 'HR@5': '0.0229', 'NDCG@5': '0.0148', 'HR@10': '0.0367', 'NDCG@10': '0.0193', 'HR@20': '0.0633', 'NDCG@20': '0.0259'}
2025-02-24 21:43:19,190 - Validation score increased.  Saving model ...
2025-02-24 21:43:24,167 - {'epoch': 3, 'rec_loss': '7.4250'}
2025-02-24 21:43:24,818 - {'Epoch': 3, 'HR@5': '0.0248', 'NDCG@5': '0.0177', 'HR@10': '0.0450', 'NDCG@10': '0.0242', 'HR@20': '0.0661', 'NDCG@20': '0.0294'}
2025-02-24 21:43:24,819 - Validation score increased.  Saving model ...
2025-02-24 21:43:29,963 - {'epoch': 4, 'rec_loss': '7.2390'}
2025-02-24 21:43:30,645 - {'Epoch': 4, 'HR@5': '0.0312', 'NDCG@5': '0.0216', 'HR@10': '0.0468', 'NDCG@10': '0.0266', 'HR@20': '0.0734', 'NDCG@20': '0.0332'}
2025-02-24 21:43:30,646 - Validation score increased.  Saving model ...
2025-02-24 21:43:35,551 - {'epoch': 5, 'rec_loss': '7.0570'}
2025-02-24 21:43:36,209 - {'Epoch': 5, 'HR@5': '0.0349', 'NDCG@5': '0.0230', 'HR@10': '0.0523', 'NDCG@10': '0.0286', 'HR@20': '0.0844', 'NDCG@20': '0.0368'}
2025-02-24 21:43:36,210 - Validation score increased.  Saving model ...
2025-02-24 21:43:41,356 - {'epoch': 6, 'rec_loss': '6.8918'}
2025-02-24 21:43:42,059 - {'Epoch': 6, 'HR@5': '0.0367', 'NDCG@5': '0.0244', 'HR@10': '0.0615', 'NDCG@10': '0.0324', 'HR@20': '0.0890', 'NDCG@20': '0.0393'}
2025-02-24 21:43:42,060 - Validation score increased.  Saving model ...
2025-02-24 21:43:46,771 - {'epoch': 7, 'rec_loss': '6.7362'}
2025-02-24 21:43:47,406 - {'Epoch': 7, 'HR@5': '0.0413', 'NDCG@5': '0.0245', 'HR@10': '0.0624', 'NDCG@10': '0.0312', 'HR@20': '0.0972', 'NDCG@20': '0.0399'}
2025-02-24 21:43:47,407 - Validation score increased.  Saving model ...
2025-02-24 21:43:52,683 - {'epoch': 8, 'rec_loss': '6.5868'}
2025-02-24 21:43:53,337 - {'Epoch': 8, 'HR@5': '0.0431', 'NDCG@5': '0.0270', 'HR@10': '0.0624', 'NDCG@10': '0.0334', 'HR@20': '0.0954', 'NDCG@20': '0.0418'}
2025-02-24 21:43:53,338 - Validation score increased.  Saving model ...
2025-02-24 21:43:58,119 - {'epoch': 9, 'rec_loss': '6.4567'}
2025-02-24 21:43:58,822 - {'Epoch': 9, 'HR@5': '0.0440', 'NDCG@5': '0.0269', 'HR@10': '0.0706', 'NDCG@10': '0.0355', 'HR@20': '0.1028', 'NDCG@20': '0.0434'}
2025-02-24 21:43:58,823 - Validation score increased.  Saving model ...
2025-02-24 21:44:03,571 - {'epoch': 10, 'rec_loss': '6.3362'}
2025-02-24 21:44:04,266 - {'Epoch': 10, 'HR@5': '0.0422', 'NDCG@5': '0.0260', 'HR@10': '0.0734', 'NDCG@10': '0.0360', 'HR@20': '0.1055', 'NDCG@20': '0.0439'}
2025-02-24 21:44:04,267 - Validation score increased.  Saving model ...
2025-02-24 21:44:09,026 - {'epoch': 11, 'rec_loss': '6.2472'}
2025-02-24 21:44:09,723 - {'Epoch': 11, 'HR@5': '0.0440', 'NDCG@5': '0.0276', 'HR@10': '0.0716', 'NDCG@10': '0.0365', 'HR@20': '0.1128', 'NDCG@20': '0.0470'}
2025-02-24 21:44:09,724 - Validation score increased.  Saving model ...
2025-02-24 21:44:14,424 - {'epoch': 12, 'rec_loss': '6.1427'}
2025-02-24 21:44:15,062 - {'Epoch': 12, 'HR@5': '0.0486', 'NDCG@5': '0.0318', 'HR@10': '0.0706', 'NDCG@10': '0.0390', 'HR@20': '0.1128', 'NDCG@20': '0.0497'}
2025-02-24 21:44:15,064 - Validation score increased.  Saving model ...
2025-02-24 21:44:19,725 - {'epoch': 13, 'rec_loss': '6.0776'}
2025-02-24 21:44:20,324 - {'Epoch': 13, 'HR@5': '0.0486', 'NDCG@5': '0.0295', 'HR@10': '0.0780', 'NDCG@10': '0.0389', 'HR@20': '0.1128', 'NDCG@20': '0.0478'}
2025-02-24 21:44:20,325 - EarlyStopping counter: 1 out of 10
2025-02-24 21:44:25,399 - {'epoch': 14, 'rec_loss': '6.0094'}
2025-02-24 21:44:26,154 - {'Epoch': 14, 'HR@5': '0.0450', 'NDCG@5': '0.0298', 'HR@10': '0.0844', 'NDCG@10': '0.0423', 'HR@20': '0.1193', 'NDCG@20': '0.0510'}
2025-02-24 21:44:26,155 - Validation score increased.  Saving model ...
2025-02-24 21:44:30,981 - {'epoch': 15, 'rec_loss': '5.9346'}
2025-02-24 21:44:31,720 - {'Epoch': 15, 'HR@5': '0.0514', 'NDCG@5': '0.0299', 'HR@10': '0.0835', 'NDCG@10': '0.0401', 'HR@20': '0.1229', 'NDCG@20': '0.0500'}
2025-02-24 21:44:31,721 - EarlyStopping counter: 1 out of 10
2025-02-24 21:44:36,393 - {'epoch': 16, 'rec_loss': '5.8851'}
2025-02-24 21:44:37,049 - {'Epoch': 16, 'HR@5': '0.0495', 'NDCG@5': '0.0314', 'HR@10': '0.0853', 'NDCG@10': '0.0431', 'HR@20': '0.1239', 'NDCG@20': '0.0530'}
2025-02-24 21:44:37,051 - Validation score increased.  Saving model ...
2025-02-24 21:44:41,832 - {'epoch': 17, 'rec_loss': '5.8274'}
2025-02-24 21:44:42,541 - {'Epoch': 17, 'HR@5': '0.0514', 'NDCG@5': '0.0319', 'HR@10': '0.0890', 'NDCG@10': '0.0441', 'HR@20': '0.1257', 'NDCG@20': '0.0533'}
2025-02-24 21:44:42,543 - Validation score increased.  Saving model ...
2025-02-24 21:44:47,298 - {'epoch': 18, 'rec_loss': '5.7867'}
2025-02-24 21:44:47,971 - {'Epoch': 18, 'HR@5': '0.0569', 'NDCG@5': '0.0356', 'HR@10': '0.0844', 'NDCG@10': '0.0443', 'HR@20': '0.1303', 'NDCG@20': '0.0559'}
2025-02-24 21:44:47,972 - Validation score increased.  Saving model ...
2025-02-24 21:44:53,071 - {'epoch': 19, 'rec_loss': '5.7592'}
2025-02-24 21:44:53,853 - {'Epoch': 19, 'HR@5': '0.0541', 'NDCG@5': '0.0328', 'HR@10': '0.0862', 'NDCG@10': '0.0432', 'HR@20': '0.1303', 'NDCG@20': '0.0542'}
2025-02-24 21:44:53,854 - EarlyStopping counter: 1 out of 10
2025-02-24 21:44:58,531 - {'epoch': 20, 'rec_loss': '5.7151'}
2025-02-24 21:44:59,252 - {'Epoch': 20, 'HR@5': '0.0606', 'NDCG@5': '0.0375', 'HR@10': '0.0945', 'NDCG@10': '0.0484', 'HR@20': '0.1321', 'NDCG@20': '0.0578'}
2025-02-24 21:44:59,253 - Validation score increased.  Saving model ...
2025-02-24 21:45:03,993 - {'epoch': 21, 'rec_loss': '5.7070'}
2025-02-24 21:45:04,614 - {'Epoch': 21, 'HR@5': '0.0633', 'NDCG@5': '0.0374', 'HR@10': '0.0936', 'NDCG@10': '0.0472', 'HR@20': '0.1294', 'NDCG@20': '0.0561'}
2025-02-24 21:45:04,616 - EarlyStopping counter: 1 out of 10
2025-02-24 21:45:09,693 - {'epoch': 22, 'rec_loss': '5.6593'}
2025-02-24 21:45:10,377 - {'Epoch': 22, 'HR@5': '0.0560', 'NDCG@5': '0.0338', 'HR@10': '0.0872', 'NDCG@10': '0.0441', 'HR@20': '0.1321', 'NDCG@20': '0.0554'}
2025-02-24 21:45:10,378 - EarlyStopping counter: 2 out of 10
2025-02-24 21:45:15,143 - {'epoch': 23, 'rec_loss': '5.6405'}
2025-02-24 21:45:15,844 - {'Epoch': 23, 'HR@5': '0.0596', 'NDCG@5': '0.0367', 'HR@10': '0.0853', 'NDCG@10': '0.0450', 'HR@20': '0.1330', 'NDCG@20': '0.0569'}
2025-02-24 21:45:15,845 - EarlyStopping counter: 3 out of 10
2025-02-24 21:45:20,512 - {'epoch': 24, 'rec_loss': '5.6341'}
2025-02-24 21:45:21,233 - {'Epoch': 24, 'HR@5': '0.0569', 'NDCG@5': '0.0347', 'HR@10': '0.0899', 'NDCG@10': '0.0456', 'HR@20': '0.1349', 'NDCG@20': '0.0568'}
2025-02-24 21:45:21,234 - EarlyStopping counter: 4 out of 10
2025-02-24 21:45:25,933 - {'epoch': 25, 'rec_loss': '5.6153'}
2025-02-24 21:45:26,582 - {'Epoch': 25, 'HR@5': '0.0587', 'NDCG@5': '0.0372', 'HR@10': '0.0899', 'NDCG@10': '0.0474', 'HR@20': '0.1330', 'NDCG@20': '0.0583'}
2025-02-24 21:45:26,583 - Validation score increased.  Saving model ...
2025-02-24 21:45:31,362 - {'epoch': 26, 'rec_loss': '5.6026'}
2025-02-24 21:45:32,002 - {'Epoch': 26, 'HR@5': '0.0642', 'NDCG@5': '0.0382', 'HR@10': '0.0890', 'NDCG@10': '0.0461', 'HR@20': '0.1358', 'NDCG@20': '0.0578'}
2025-02-24 21:45:32,003 - EarlyStopping counter: 1 out of 10
2025-02-24 21:45:36,667 - {'epoch': 27, 'rec_loss': '5.5811'}
2025-02-24 21:45:37,400 - {'Epoch': 27, 'HR@5': '0.0633', 'NDCG@5': '0.0381', 'HR@10': '0.0908', 'NDCG@10': '0.0470', 'HR@20': '0.1339', 'NDCG@20': '0.0578'}
2025-02-24 21:45:37,401 - EarlyStopping counter: 2 out of 10
2025-02-24 21:45:42,138 - {'epoch': 28, 'rec_loss': '5.5736'}
2025-02-24 21:45:42,780 - {'Epoch': 28, 'HR@5': '0.0587', 'NDCG@5': '0.0366', 'HR@10': '0.0927', 'NDCG@10': '0.0478', 'HR@20': '0.1358', 'NDCG@20': '0.0586'}
2025-02-24 21:45:42,781 - Validation score increased.  Saving model ...
2025-02-24 21:45:47,879 - {'epoch': 29, 'rec_loss': '5.5539'}
2025-02-24 21:45:48,665 - {'Epoch': 29, 'HR@5': '0.0651', 'NDCG@5': '0.0383', 'HR@10': '0.0963', 'NDCG@10': '0.0480', 'HR@20': '0.1404', 'NDCG@20': '0.0591'}
2025-02-24 21:45:48,666 - Validation score increased.  Saving model ...
2025-02-24 21:45:53,530 - {'epoch': 30, 'rec_loss': '5.5311'}
2025-02-24 21:45:54,320 - {'Epoch': 30, 'HR@5': '0.0670', 'NDCG@5': '0.0405', 'HR@10': '0.0908', 'NDCG@10': '0.0483', 'HR@20': '0.1413', 'NDCG@20': '0.0610'}
2025-02-24 21:45:54,321 - Validation score increased.  Saving model ...
2025-02-24 21:45:58,982 - {'epoch': 31, 'rec_loss': '5.5181'}
2025-02-24 21:45:59,734 - {'Epoch': 31, 'HR@5': '0.0670', 'NDCG@5': '0.0406', 'HR@10': '0.0936', 'NDCG@10': '0.0494', 'HR@20': '0.1440', 'NDCG@20': '0.0622'}
2025-02-24 21:45:59,735 - Validation score increased.  Saving model ...
2025-02-24 21:46:04,415 - {'epoch': 32, 'rec_loss': '5.5064'}
2025-02-24 21:46:05,166 - {'Epoch': 32, 'HR@5': '0.0587', 'NDCG@5': '0.0362', 'HR@10': '0.0945', 'NDCG@10': '0.0479', 'HR@20': '0.1468', 'NDCG@20': '0.0610'}
2025-02-24 21:46:05,167 - EarlyStopping counter: 1 out of 10
2025-02-24 21:46:10,118 - {'epoch': 33, 'rec_loss': '5.4878'}
2025-02-24 21:46:10,942 - {'Epoch': 33, 'HR@5': '0.0661', 'NDCG@5': '0.0425', 'HR@10': '0.0945', 'NDCG@10': '0.0517', 'HR@20': '0.1468', 'NDCG@20': '0.0647'}
2025-02-24 21:46:10,943 - Validation score increased.  Saving model ...
2025-02-24 21:46:15,757 - {'epoch': 34, 'rec_loss': '5.4729'}
2025-02-24 21:46:16,500 - {'Epoch': 34, 'HR@5': '0.0569', 'NDCG@5': '0.0360', 'HR@10': '0.0945', 'NDCG@10': '0.0481', 'HR@20': '0.1404', 'NDCG@20': '0.0599'}
2025-02-24 21:46:16,501 - EarlyStopping counter: 1 out of 10
2025-02-24 21:46:21,618 - {'epoch': 35, 'rec_loss': '5.4742'}
2025-02-24 21:46:22,336 - {'Epoch': 35, 'HR@5': '0.0624', 'NDCG@5': '0.0386', 'HR@10': '0.0936', 'NDCG@10': '0.0487', 'HR@20': '0.1450', 'NDCG@20': '0.0616'}
2025-02-24 21:46:22,337 - EarlyStopping counter: 2 out of 10
2025-02-24 21:46:27,098 - {'epoch': 36, 'rec_loss': '5.4656'}
2025-02-24 21:46:27,889 - {'Epoch': 36, 'HR@5': '0.0642', 'NDCG@5': '0.0408', 'HR@10': '0.0945', 'NDCG@10': '0.0505', 'HR@20': '0.1440', 'NDCG@20': '0.0629'}
2025-02-24 21:46:27,890 - EarlyStopping counter: 3 out of 10
2025-02-24 21:46:32,901 - {'epoch': 37, 'rec_loss': '5.4483'}
2025-02-24 21:46:33,706 - {'Epoch': 37, 'HR@5': '0.0615', 'NDCG@5': '0.0386', 'HR@10': '0.0982', 'NDCG@10': '0.0502', 'HR@20': '0.1422', 'NDCG@20': '0.0612'}
2025-02-24 21:46:33,708 - EarlyStopping counter: 4 out of 10
2025-02-24 21:46:38,425 - {'epoch': 38, 'rec_loss': '5.4365'}
2025-02-24 21:46:39,214 - {'Epoch': 38, 'HR@5': '0.0615', 'NDCG@5': '0.0412', 'HR@10': '0.0936', 'NDCG@10': '0.0514', 'HR@20': '0.1505', 'NDCG@20': '0.0657'}
2025-02-24 21:46:39,215 - Validation score increased.  Saving model ...
2025-02-24 21:46:44,022 - {'epoch': 39, 'rec_loss': '5.4404'}
2025-02-24 21:46:44,808 - {'Epoch': 39, 'HR@5': '0.0633', 'NDCG@5': '0.0398', 'HR@10': '0.0982', 'NDCG@10': '0.0507', 'HR@20': '0.1459', 'NDCG@20': '0.0627'}
2025-02-24 21:46:44,809 - EarlyStopping counter: 1 out of 10
2025-02-24 21:46:49,631 - {'epoch': 40, 'rec_loss': '5.4328'}
2025-02-24 21:46:50,420 - {'Epoch': 40, 'HR@5': '0.0606', 'NDCG@5': '0.0388', 'HR@10': '0.0936', 'NDCG@10': '0.0494', 'HR@20': '0.1450', 'NDCG@20': '0.0625'}
2025-02-24 21:46:50,421 - EarlyStopping counter: 2 out of 10
2025-02-24 21:46:55,242 - {'epoch': 41, 'rec_loss': '5.4261'}
2025-02-24 21:46:55,984 - {'Epoch': 41, 'HR@5': '0.0633', 'NDCG@5': '0.0406', 'HR@10': '0.0954', 'NDCG@10': '0.0510', 'HR@20': '0.1477', 'NDCG@20': '0.0642'}
2025-02-24 21:46:55,985 - EarlyStopping counter: 3 out of 10
2025-02-24 21:47:00,706 - {'epoch': 42, 'rec_loss': '5.4254'}
2025-02-24 21:47:01,504 - {'Epoch': 42, 'HR@5': '0.0624', 'NDCG@5': '0.0404', 'HR@10': '0.0908', 'NDCG@10': '0.0496', 'HR@20': '0.1468', 'NDCG@20': '0.0637'}
2025-02-24 21:47:01,505 - EarlyStopping counter: 4 out of 10
2025-02-24 21:47:06,245 - {'epoch': 43, 'rec_loss': '5.4011'}
2025-02-24 21:47:07,036 - {'Epoch': 43, 'HR@5': '0.0624', 'NDCG@5': '0.0381', 'HR@10': '0.0963', 'NDCG@10': '0.0488', 'HR@20': '0.1459', 'NDCG@20': '0.0612'}
2025-02-24 21:47:07,037 - EarlyStopping counter: 5 out of 10
2025-02-24 21:47:11,816 - {'epoch': 44, 'rec_loss': '5.4025'}
2025-02-24 21:47:12,622 - {'Epoch': 44, 'HR@5': '0.0633', 'NDCG@5': '0.0416', 'HR@10': '0.0954', 'NDCG@10': '0.0519', 'HR@20': '0.1505', 'NDCG@20': '0.0656'}
2025-02-24 21:47:12,623 - EarlyStopping counter: 6 out of 10
2025-02-24 21:47:17,843 - {'epoch': 45, 'rec_loss': '5.4100'}
2025-02-24 21:47:18,469 - {'Epoch': 45, 'HR@5': '0.0615', 'NDCG@5': '0.0401', 'HR@10': '0.0991', 'NDCG@10': '0.0520', 'HR@20': '0.1431', 'NDCG@20': '0.0631'}
2025-02-24 21:47:18,470 - EarlyStopping counter: 7 out of 10
2025-02-24 21:47:23,236 - {'epoch': 46, 'rec_loss': '5.3998'}
2025-02-24 21:47:24,012 - {'Epoch': 46, 'HR@5': '0.0633', 'NDCG@5': '0.0387', 'HR@10': '0.0963', 'NDCG@10': '0.0493', 'HR@20': '0.1440', 'NDCG@20': '0.0612'}
2025-02-24 21:47:24,013 - EarlyStopping counter: 8 out of 10
2025-02-24 21:47:28,896 - {'epoch': 47, 'rec_loss': '5.3729'}
2025-02-24 21:47:29,651 - {'Epoch': 47, 'HR@5': '0.0596', 'NDCG@5': '0.0396', 'HR@10': '0.1000', 'NDCG@10': '0.0524', 'HR@20': '0.1477', 'NDCG@20': '0.0644'}
2025-02-24 21:47:29,652 - EarlyStopping counter: 9 out of 10
2025-02-24 21:47:34,877 - {'epoch': 48, 'rec_loss': '5.3734'}
2025-02-24 21:47:35,663 - {'Epoch': 48, 'HR@5': '0.0670', 'NDCG@5': '0.0419', 'HR@10': '0.1009', 'NDCG@10': '0.0526', 'HR@20': '0.1450', 'NDCG@20': '0.0637'}
2025-02-24 21:47:35,665 - EarlyStopping counter: 10 out of 10
2025-02-24 21:47:35,665 - Early stopping
2025-02-24 21:47:35,665 - ---------------Test Score---------------
2025-02-24 21:47:36,302 - {'Epoch': 0, 'HR@5': '0.0468', 'NDCG@5': '0.0327', 'HR@10': '0.0706', 'NDCG@10': '0.0402', 'HR@20': '0.0972', 'NDCG@20': '0.0469'}
2025-02-24 21:47:36,303 - Scale_LastFM
2025-02-24 21:47:36,303 - {'Epoch': 0, 'HR@5': '0.0468', 'NDCG@5': '0.0327', 'HR@10': '0.0706', 'NDCG@10': '0.0402', 'HR@20': '0.0972', 'NDCG@20': '0.0469'}
2025-02-24 21:50:09,128 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-24 21:50:11,915 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-24 21:50:11,919 - Total Parameters: 387350
2025-02-24 21:50:17,901 - {'epoch': 0, 'rec_loss': '8.0388'}
2025-02-24 21:50:18,655 - {'Epoch': 0, 'HR@5': '0.0202', 'NDCG@5': '0.0143', 'HR@10': '0.0358', 'NDCG@10': '0.0194', 'HR@20': '0.0642', 'NDCG@20': '0.0264'}
2025-02-24 21:50:18,656 - Validation score increased.  Saving model ...
2025-02-24 21:50:23,721 - {'epoch': 1, 'rec_loss': '7.7563'}
2025-02-24 21:50:24,403 - {'Epoch': 1, 'HR@5': '0.0220', 'NDCG@5': '0.0149', 'HR@10': '0.0349', 'NDCG@10': '0.0192', 'HR@20': '0.0633', 'NDCG@20': '0.0262'}
2025-02-24 21:50:24,404 - EarlyStopping counter: 1 out of 10
2025-02-24 21:50:29,366 - {'epoch': 2, 'rec_loss': '7.5485'}
2025-02-24 21:50:30,024 - {'Epoch': 2, 'HR@5': '0.0294', 'NDCG@5': '0.0199', 'HR@10': '0.0495', 'NDCG@10': '0.0264', 'HR@20': '0.0697', 'NDCG@20': '0.0315'}
2025-02-24 21:50:30,025 - Validation score increased.  Saving model ...
2025-02-24 21:50:35,374 - {'epoch': 3, 'rec_loss': '7.3251'}
2025-02-24 21:50:36,103 - {'Epoch': 3, 'HR@5': '0.0330', 'NDCG@5': '0.0220', 'HR@10': '0.0486', 'NDCG@10': '0.0269', 'HR@20': '0.0716', 'NDCG@20': '0.0326'}
2025-02-24 21:50:36,105 - Validation score increased.  Saving model ...
2025-02-24 21:50:40,947 - {'epoch': 4, 'rec_loss': '7.1145'}
2025-02-24 21:50:41,619 - {'Epoch': 4, 'HR@5': '0.0358', 'NDCG@5': '0.0242', 'HR@10': '0.0550', 'NDCG@10': '0.0304', 'HR@20': '0.0862', 'NDCG@20': '0.0385'}
2025-02-24 21:50:41,620 - Validation score increased.  Saving model ...
2025-02-24 21:50:46,807 - {'epoch': 5, 'rec_loss': '6.9066'}
2025-02-24 21:50:47,466 - {'Epoch': 5, 'HR@5': '0.0367', 'NDCG@5': '0.0250', 'HR@10': '0.0541', 'NDCG@10': '0.0308', 'HR@20': '0.0917', 'NDCG@20': '0.0402'}
2025-02-24 21:50:47,467 - Validation score increased.  Saving model ...
2025-02-24 21:50:52,267 - {'epoch': 6, 'rec_loss': '6.7099'}
2025-02-24 21:50:52,953 - {'Epoch': 6, 'HR@5': '0.0440', 'NDCG@5': '0.0252', 'HR@10': '0.0670', 'NDCG@10': '0.0326', 'HR@20': '0.0963', 'NDCG@20': '0.0400'}
2025-02-24 21:50:52,954 - EarlyStopping counter: 1 out of 10
2025-02-24 21:50:57,945 - {'epoch': 7, 'rec_loss': '6.5310'}
2025-02-24 21:50:58,581 - {'Epoch': 7, 'HR@5': '0.0450', 'NDCG@5': '0.0275', 'HR@10': '0.0688', 'NDCG@10': '0.0350', 'HR@20': '0.1009', 'NDCG@20': '0.0431'}
2025-02-24 21:50:58,582 - Validation score increased.  Saving model ...
2025-02-24 21:51:03,983 - {'epoch': 8, 'rec_loss': '6.3667'}
2025-02-24 21:51:04,643 - {'Epoch': 8, 'HR@5': '0.0431', 'NDCG@5': '0.0269', 'HR@10': '0.0706', 'NDCG@10': '0.0356', 'HR@20': '0.1083', 'NDCG@20': '0.0451'}
2025-02-24 21:51:04,644 - Validation score increased.  Saving model ...
2025-02-24 21:51:09,766 - {'epoch': 9, 'rec_loss': '6.2518'}
2025-02-24 21:51:10,388 - {'Epoch': 9, 'HR@5': '0.0486', 'NDCG@5': '0.0297', 'HR@10': '0.0780', 'NDCG@10': '0.0390', 'HR@20': '0.1147', 'NDCG@20': '0.0482'}
2025-02-24 21:51:10,389 - Validation score increased.  Saving model ...
2025-02-24 21:51:15,316 - {'epoch': 10, 'rec_loss': '6.1121'}
2025-02-24 21:51:15,986 - {'Epoch': 10, 'HR@5': '0.0459', 'NDCG@5': '0.0296', 'HR@10': '0.0716', 'NDCG@10': '0.0379', 'HR@20': '0.1110', 'NDCG@20': '0.0478'}
2025-02-24 21:51:15,988 - EarlyStopping counter: 1 out of 10
2025-02-24 21:51:20,903 - {'epoch': 11, 'rec_loss': '6.0401'}
2025-02-24 21:51:21,594 - {'Epoch': 11, 'HR@5': '0.0459', 'NDCG@5': '0.0305', 'HR@10': '0.0716', 'NDCG@10': '0.0387', 'HR@20': '0.1183', 'NDCG@20': '0.0505'}
2025-02-24 21:51:21,595 - Validation score increased.  Saving model ...
2025-02-24 21:51:27,072 - {'epoch': 12, 'rec_loss': '5.9514'}
2025-02-24 21:51:27,784 - {'Epoch': 12, 'HR@5': '0.0431', 'NDCG@5': '0.0295', 'HR@10': '0.0780', 'NDCG@10': '0.0406', 'HR@20': '0.1239', 'NDCG@20': '0.0523'}
2025-02-24 21:51:27,785 - Validation score increased.  Saving model ...
2025-02-24 21:51:32,810 - {'epoch': 13, 'rec_loss': '5.8706'}
2025-02-24 21:51:33,542 - {'Epoch': 13, 'HR@5': '0.0431', 'NDCG@5': '0.0298', 'HR@10': '0.0789', 'NDCG@10': '0.0411', 'HR@20': '0.1239', 'NDCG@20': '0.0526'}
2025-02-24 21:51:33,543 - Validation score increased.  Saving model ...
2025-02-24 21:51:38,810 - {'epoch': 14, 'rec_loss': '5.8017'}
2025-02-24 21:51:39,462 - {'Epoch': 14, 'HR@5': '0.0440', 'NDCG@5': '0.0297', 'HR@10': '0.0835', 'NDCG@10': '0.0424', 'HR@20': '0.1257', 'NDCG@20': '0.0529'}
2025-02-24 21:51:39,463 - Validation score increased.  Saving model ...
2025-02-24 21:51:44,763 - {'epoch': 15, 'rec_loss': '5.7607'}
2025-02-24 21:51:45,411 - {'Epoch': 15, 'HR@5': '0.0523', 'NDCG@5': '0.0344', 'HR@10': '0.0807', 'NDCG@10': '0.0436', 'HR@20': '0.1257', 'NDCG@20': '0.0548'}
2025-02-24 21:51:45,412 - Validation score increased.  Saving model ...
2025-02-24 21:51:50,433 - {'epoch': 16, 'rec_loss': '5.7270'}
2025-02-24 21:51:51,164 - {'Epoch': 16, 'HR@5': '0.0505', 'NDCG@5': '0.0334', 'HR@10': '0.0716', 'NDCG@10': '0.0403', 'HR@20': '0.1239', 'NDCG@20': '0.0536'}
2025-02-24 21:51:51,165 - EarlyStopping counter: 1 out of 10
2025-02-24 21:51:56,266 - {'epoch': 17, 'rec_loss': '5.6781'}
2025-02-24 21:51:56,898 - {'Epoch': 17, 'HR@5': '0.0495', 'NDCG@5': '0.0320', 'HR@10': '0.0798', 'NDCG@10': '0.0418', 'HR@20': '0.1303', 'NDCG@20': '0.0545'}
2025-02-24 21:51:56,899 - EarlyStopping counter: 2 out of 10
2025-02-24 21:52:02,158 - {'epoch': 18, 'rec_loss': '5.6279'}
2025-02-24 21:52:02,886 - {'Epoch': 18, 'HR@5': '0.0495', 'NDCG@5': '0.0312', 'HR@10': '0.0853', 'NDCG@10': '0.0425', 'HR@20': '0.1349', 'NDCG@20': '0.0548'}
2025-02-24 21:52:02,887 - Validation score increased.  Saving model ...
2025-02-24 21:52:08,096 - {'epoch': 19, 'rec_loss': '5.5949'}
2025-02-24 21:52:08,767 - {'Epoch': 19, 'HR@5': '0.0523', 'NDCG@5': '0.0318', 'HR@10': '0.0899', 'NDCG@10': '0.0439', 'HR@20': '0.1349', 'NDCG@20': '0.0551'}
2025-02-24 21:52:08,768 - Validation score increased.  Saving model ...
2025-02-24 21:52:13,824 - {'epoch': 20, 'rec_loss': '5.5773'}
2025-02-24 21:52:14,476 - {'Epoch': 20, 'HR@5': '0.0477', 'NDCG@5': '0.0315', 'HR@10': '0.0826', 'NDCG@10': '0.0428', 'HR@20': '0.1349', 'NDCG@20': '0.0561'}
2025-02-24 21:52:14,477 - Validation score increased.  Saving model ...
2025-02-24 21:52:19,268 - {'epoch': 21, 'rec_loss': '5.5393'}
2025-02-24 21:52:19,877 - {'Epoch': 21, 'HR@5': '0.0541', 'NDCG@5': '0.0352', 'HR@10': '0.0899', 'NDCG@10': '0.0464', 'HR@20': '0.1330', 'NDCG@20': '0.0573'}
2025-02-24 21:52:19,878 - Validation score increased.  Saving model ...
2025-02-24 21:52:25,107 - {'epoch': 22, 'rec_loss': '5.5309'}
2025-02-24 21:52:25,764 - {'Epoch': 22, 'HR@5': '0.0578', 'NDCG@5': '0.0368', 'HR@10': '0.0853', 'NDCG@10': '0.0455', 'HR@20': '0.1376', 'NDCG@20': '0.0587'}
2025-02-24 21:52:25,765 - Validation score increased.  Saving model ...
2025-02-24 21:52:30,791 - {'epoch': 23, 'rec_loss': '5.5223'}
2025-02-24 21:52:31,454 - {'Epoch': 23, 'HR@5': '0.0514', 'NDCG@5': '0.0343', 'HR@10': '0.0890', 'NDCG@10': '0.0464', 'HR@20': '0.1413', 'NDCG@20': '0.0597'}
2025-02-24 21:52:31,455 - Validation score increased.  Saving model ...
2025-02-24 21:52:36,445 - {'epoch': 24, 'rec_loss': '5.4830'}
2025-02-24 21:52:37,060 - {'Epoch': 24, 'HR@5': '0.0541', 'NDCG@5': '0.0358', 'HR@10': '0.0927', 'NDCG@10': '0.0483', 'HR@20': '0.1349', 'NDCG@20': '0.0589'}
2025-02-24 21:52:37,061 - EarlyStopping counter: 1 out of 10
2025-02-24 21:52:41,957 - {'epoch': 25, 'rec_loss': '5.4523'}
2025-02-24 21:52:42,628 - {'Epoch': 25, 'HR@5': '0.0560', 'NDCG@5': '0.0354', 'HR@10': '0.0890', 'NDCG@10': '0.0458', 'HR@20': '0.1431', 'NDCG@20': '0.0596'}
2025-02-24 21:52:42,630 - EarlyStopping counter: 2 out of 10
2025-02-24 21:52:47,502 - {'epoch': 26, 'rec_loss': '5.4571'}
2025-02-24 21:52:48,112 - {'Epoch': 26, 'HR@5': '0.0578', 'NDCG@5': '0.0360', 'HR@10': '0.0890', 'NDCG@10': '0.0459', 'HR@20': '0.1450', 'NDCG@20': '0.0598'}
2025-02-24 21:52:48,113 - Validation score increased.  Saving model ...
2025-02-24 21:52:53,181 - {'epoch': 27, 'rec_loss': '5.4431'}
2025-02-24 21:52:53,851 - {'Epoch': 27, 'HR@5': '0.0550', 'NDCG@5': '0.0362', 'HR@10': '0.0890', 'NDCG@10': '0.0470', 'HR@20': '0.1385', 'NDCG@20': '0.0596'}
2025-02-24 21:52:53,852 - EarlyStopping counter: 1 out of 10
2025-02-24 21:52:59,112 - {'epoch': 28, 'rec_loss': '5.4230'}
2025-02-24 21:52:59,765 - {'Epoch': 28, 'HR@5': '0.0587', 'NDCG@5': '0.0374', 'HR@10': '0.0917', 'NDCG@10': '0.0479', 'HR@20': '0.1431', 'NDCG@20': '0.0609'}
2025-02-24 21:52:59,766 - Validation score increased.  Saving model ...
2025-02-24 21:53:04,891 - {'epoch': 29, 'rec_loss': '5.4098'}
2025-02-24 21:53:05,524 - {'Epoch': 29, 'HR@5': '0.0569', 'NDCG@5': '0.0378', 'HR@10': '0.0853', 'NDCG@10': '0.0469', 'HR@20': '0.1431', 'NDCG@20': '0.0616'}
2025-02-24 21:53:05,525 - Validation score increased.  Saving model ...
2025-02-24 21:53:10,494 - {'epoch': 30, 'rec_loss': '5.4006'}
2025-02-24 21:53:11,202 - {'Epoch': 30, 'HR@5': '0.0550', 'NDCG@5': '0.0372', 'HR@10': '0.0872', 'NDCG@10': '0.0475', 'HR@20': '0.1431', 'NDCG@20': '0.0615'}
2025-02-24 21:53:11,203 - EarlyStopping counter: 1 out of 10
2025-02-24 21:53:16,144 - {'epoch': 31, 'rec_loss': '5.3940'}
2025-02-24 21:53:16,761 - {'Epoch': 31, 'HR@5': '0.0624', 'NDCG@5': '0.0396', 'HR@10': '0.1000', 'NDCG@10': '0.0515', 'HR@20': '0.1440', 'NDCG@20': '0.0625'}
2025-02-24 21:53:16,762 - Validation score increased.  Saving model ...
2025-02-24 21:53:21,789 - {'epoch': 32, 'rec_loss': '5.3823'}
2025-02-24 21:53:22,448 - {'Epoch': 32, 'HR@5': '0.0606', 'NDCG@5': '0.0374', 'HR@10': '0.0881', 'NDCG@10': '0.0462', 'HR@20': '0.1431', 'NDCG@20': '0.0602'}
2025-02-24 21:53:22,449 - EarlyStopping counter: 1 out of 10
2025-02-24 21:53:27,485 - {'epoch': 33, 'rec_loss': '5.3618'}
2025-02-24 21:53:28,175 - {'Epoch': 33, 'HR@5': '0.0633', 'NDCG@5': '0.0395', 'HR@10': '0.0982', 'NDCG@10': '0.0505', 'HR@20': '0.1477', 'NDCG@20': '0.0630'}
2025-02-24 21:53:28,176 - Validation score increased.  Saving model ...
2025-02-24 21:53:33,343 - {'epoch': 34, 'rec_loss': '5.3504'}
2025-02-24 21:53:33,983 - {'Epoch': 34, 'HR@5': '0.0651', 'NDCG@5': '0.0403', 'HR@10': '0.0972', 'NDCG@10': '0.0504', 'HR@20': '0.1505', 'NDCG@20': '0.0637'}
2025-02-24 21:53:33,984 - Validation score increased.  Saving model ...
2025-02-24 21:53:38,940 - {'epoch': 35, 'rec_loss': '5.3207'}
2025-02-24 21:53:39,569 - {'Epoch': 35, 'HR@5': '0.0679', 'NDCG@5': '0.0421', 'HR@10': '0.0982', 'NDCG@10': '0.0516', 'HR@20': '0.1486', 'NDCG@20': '0.0644'}
2025-02-24 21:53:39,571 - Validation score increased.  Saving model ...
2025-02-24 21:53:44,543 - {'epoch': 36, 'rec_loss': '5.3182'}
2025-02-24 21:53:45,216 - {'Epoch': 36, 'HR@5': '0.0651', 'NDCG@5': '0.0395', 'HR@10': '0.0917', 'NDCG@10': '0.0479', 'HR@20': '0.1468', 'NDCG@20': '0.0620'}
2025-02-24 21:53:45,217 - EarlyStopping counter: 1 out of 10
2025-02-24 21:53:50,223 - {'epoch': 37, 'rec_loss': '5.3163'}
2025-02-24 21:53:50,992 - {'Epoch': 37, 'HR@5': '0.0596', 'NDCG@5': '0.0377', 'HR@10': '0.0954', 'NDCG@10': '0.0493', 'HR@20': '0.1495', 'NDCG@20': '0.0629'}
2025-02-24 21:53:50,993 - EarlyStopping counter: 2 out of 10
2025-02-24 21:53:56,044 - {'epoch': 38, 'rec_loss': '5.3201'}
2025-02-24 21:53:56,740 - {'Epoch': 38, 'HR@5': '0.0587', 'NDCG@5': '0.0391', 'HR@10': '0.0908', 'NDCG@10': '0.0496', 'HR@20': '0.1477', 'NDCG@20': '0.0641'}
2025-02-24 21:53:56,741 - EarlyStopping counter: 3 out of 10
2025-02-24 21:54:01,579 - {'epoch': 39, 'rec_loss': '5.3132'}
2025-02-24 21:54:02,243 - {'Epoch': 39, 'HR@5': '0.0569', 'NDCG@5': '0.0363', 'HR@10': '0.1000', 'NDCG@10': '0.0503', 'HR@20': '0.1468', 'NDCG@20': '0.0622'}
2025-02-24 21:54:02,244 - EarlyStopping counter: 4 out of 10
2025-02-24 21:54:07,278 - {'epoch': 40, 'rec_loss': '5.2700'}
2025-02-24 21:54:07,893 - {'Epoch': 40, 'HR@5': '0.0606', 'NDCG@5': '0.0388', 'HR@10': '0.1028', 'NDCG@10': '0.0523', 'HR@20': '0.1468', 'NDCG@20': '0.0633'}
2025-02-24 21:54:07,894 - EarlyStopping counter: 5 out of 10
2025-02-24 21:54:12,864 - {'epoch': 41, 'rec_loss': '5.2867'}
2025-02-24 21:54:13,491 - {'Epoch': 41, 'HR@5': '0.0624', 'NDCG@5': '0.0414', 'HR@10': '0.0954', 'NDCG@10': '0.0522', 'HR@20': '0.1440', 'NDCG@20': '0.0645'}
2025-02-24 21:54:13,492 - Validation score increased.  Saving model ...
2025-02-24 21:54:18,759 - {'epoch': 42, 'rec_loss': '5.2864'}
2025-02-24 21:54:19,420 - {'Epoch': 42, 'HR@5': '0.0679', 'NDCG@5': '0.0433', 'HR@10': '0.0972', 'NDCG@10': '0.0526', 'HR@20': '0.1413', 'NDCG@20': '0.0637'}
2025-02-24 21:54:19,421 - EarlyStopping counter: 1 out of 10
2025-02-24 21:54:24,126 - {'epoch': 43, 'rec_loss': '5.2554'}
2025-02-24 21:54:24,813 - {'Epoch': 43, 'HR@5': '0.0633', 'NDCG@5': '0.0399', 'HR@10': '0.0972', 'NDCG@10': '0.0509', 'HR@20': '0.1477', 'NDCG@20': '0.0635'}
2025-02-24 21:54:24,814 - EarlyStopping counter: 2 out of 10
2025-02-24 21:54:29,822 - {'epoch': 44, 'rec_loss': '5.2617'}
2025-02-24 21:54:30,481 - {'Epoch': 44, 'HR@5': '0.0642', 'NDCG@5': '0.0422', 'HR@10': '0.0982', 'NDCG@10': '0.0530', 'HR@20': '0.1431', 'NDCG@20': '0.0642'}
2025-02-24 21:54:30,482 - EarlyStopping counter: 3 out of 10
2025-02-24 21:54:35,383 - {'epoch': 45, 'rec_loss': '5.2585'}
2025-02-24 21:54:36,061 - {'Epoch': 45, 'HR@5': '0.0624', 'NDCG@5': '0.0412', 'HR@10': '0.0954', 'NDCG@10': '0.0519', 'HR@20': '0.1468', 'NDCG@20': '0.0649'}
2025-02-24 21:54:36,062 - Validation score increased.  Saving model ...
2025-02-24 21:54:41,406 - {'epoch': 46, 'rec_loss': '5.2415'}
2025-02-24 21:54:42,105 - {'Epoch': 46, 'HR@5': '0.0716', 'NDCG@5': '0.0432', 'HR@10': '0.0991', 'NDCG@10': '0.0520', 'HR@20': '0.1514', 'NDCG@20': '0.0652'}
2025-02-24 21:54:42,106 - Validation score increased.  Saving model ...
2025-02-24 21:54:47,192 - {'epoch': 47, 'rec_loss': '5.2380'}
2025-02-24 21:54:47,859 - {'Epoch': 47, 'HR@5': '0.0679', 'NDCG@5': '0.0424', 'HR@10': '0.0954', 'NDCG@10': '0.0513', 'HR@20': '0.1459', 'NDCG@20': '0.0641'}
2025-02-24 21:54:47,860 - EarlyStopping counter: 1 out of 10
2025-02-24 21:54:52,990 - {'epoch': 48, 'rec_loss': '5.2459'}
2025-02-24 21:54:53,680 - {'Epoch': 48, 'HR@5': '0.0651', 'NDCG@5': '0.0414', 'HR@10': '0.1055', 'NDCG@10': '0.0543', 'HR@20': '0.1541', 'NDCG@20': '0.0665'}
2025-02-24 21:54:53,681 - Validation score increased.  Saving model ...
2025-02-24 21:54:58,631 - {'epoch': 49, 'rec_loss': '5.2283'}
2025-02-24 21:54:59,306 - {'Epoch': 49, 'HR@5': '0.0596', 'NDCG@5': '0.0385', 'HR@10': '0.1018', 'NDCG@10': '0.0522', 'HR@20': '0.1550', 'NDCG@20': '0.0654'}
2025-02-24 21:54:59,307 - EarlyStopping counter: 1 out of 10
2025-02-24 21:55:04,335 - {'epoch': 50, 'rec_loss': '5.2276'}
2025-02-24 21:55:05,017 - {'Epoch': 50, 'HR@5': '0.0596', 'NDCG@5': '0.0376', 'HR@10': '0.1009', 'NDCG@10': '0.0510', 'HR@20': '0.1514', 'NDCG@20': '0.0636'}
2025-02-24 21:55:05,018 - EarlyStopping counter: 2 out of 10
2025-02-24 21:55:10,220 - {'epoch': 51, 'rec_loss': '5.2124'}
2025-02-24 21:55:10,816 - {'Epoch': 51, 'HR@5': '0.0661', 'NDCG@5': '0.0406', 'HR@10': '0.0972', 'NDCG@10': '0.0506', 'HR@20': '0.1505', 'NDCG@20': '0.0640'}
2025-02-24 21:55:10,817 - EarlyStopping counter: 3 out of 10
2025-02-24 21:55:15,747 - {'epoch': 52, 'rec_loss': '5.2063'}
2025-02-24 21:55:16,420 - {'Epoch': 52, 'HR@5': '0.0679', 'NDCG@5': '0.0402', 'HR@10': '0.1037', 'NDCG@10': '0.0515', 'HR@20': '0.1477', 'NDCG@20': '0.0625'}
2025-02-24 21:55:16,421 - EarlyStopping counter: 4 out of 10
2025-02-24 21:55:21,468 - {'epoch': 53, 'rec_loss': '5.2117'}
2025-02-24 21:55:22,104 - {'Epoch': 53, 'HR@5': '0.0670', 'NDCG@5': '0.0435', 'HR@10': '0.1028', 'NDCG@10': '0.0549', 'HR@20': '0.1532', 'NDCG@20': '0.0677'}
2025-02-24 21:55:22,105 - Validation score increased.  Saving model ...
2025-02-24 21:55:26,789 - {'epoch': 54, 'rec_loss': '5.1894'}
2025-02-24 21:55:27,501 - {'Epoch': 54, 'HR@5': '0.0670', 'NDCG@5': '0.0428', 'HR@10': '0.1064', 'NDCG@10': '0.0553', 'HR@20': '0.1459', 'NDCG@20': '0.0653'}
2025-02-24 21:55:27,502 - EarlyStopping counter: 1 out of 10
2025-02-24 21:55:32,180 - {'epoch': 55, 'rec_loss': '5.1803'}
2025-02-24 21:55:32,845 - {'Epoch': 55, 'HR@5': '0.0642', 'NDCG@5': '0.0428', 'HR@10': '0.1101', 'NDCG@10': '0.0574', 'HR@20': '0.1468', 'NDCG@20': '0.0666'}
2025-02-24 21:55:32,846 - EarlyStopping counter: 2 out of 10
2025-02-24 21:55:37,944 - {'epoch': 56, 'rec_loss': '5.1874'}
2025-02-24 21:55:38,591 - {'Epoch': 56, 'HR@5': '0.0642', 'NDCG@5': '0.0413', 'HR@10': '0.1028', 'NDCG@10': '0.0536', 'HR@20': '0.1477', 'NDCG@20': '0.0651'}
2025-02-24 21:55:38,592 - EarlyStopping counter: 3 out of 10
2025-02-24 21:55:43,666 - {'epoch': 57, 'rec_loss': '5.2110'}
2025-02-24 21:55:44,372 - {'Epoch': 57, 'HR@5': '0.0624', 'NDCG@5': '0.0411', 'HR@10': '0.1055', 'NDCG@10': '0.0545', 'HR@20': '0.1532', 'NDCG@20': '0.0665'}
2025-02-24 21:55:44,374 - EarlyStopping counter: 4 out of 10
2025-02-24 21:55:49,111 - {'epoch': 58, 'rec_loss': '5.2084'}
2025-02-24 21:55:49,874 - {'Epoch': 58, 'HR@5': '0.0661', 'NDCG@5': '0.0438', 'HR@10': '0.1018', 'NDCG@10': '0.0552', 'HR@20': '0.1459', 'NDCG@20': '0.0660'}
2025-02-24 21:55:49,875 - EarlyStopping counter: 5 out of 10
2025-02-24 21:55:54,946 - {'epoch': 59, 'rec_loss': '5.1895'}
2025-02-24 21:55:55,641 - {'Epoch': 59, 'HR@5': '0.0633', 'NDCG@5': '0.0431', 'HR@10': '0.1073', 'NDCG@10': '0.0572', 'HR@20': '0.1440', 'NDCG@20': '0.0663'}
2025-02-24 21:55:55,642 - EarlyStopping counter: 6 out of 10
2025-02-24 21:56:00,347 - {'epoch': 60, 'rec_loss': '5.1626'}
2025-02-24 21:56:00,986 - {'Epoch': 60, 'HR@5': '0.0606', 'NDCG@5': '0.0401', 'HR@10': '0.1064', 'NDCG@10': '0.0548', 'HR@20': '0.1440', 'NDCG@20': '0.0643'}
2025-02-24 21:56:00,987 - EarlyStopping counter: 7 out of 10
2025-02-24 21:56:05,947 - {'epoch': 61, 'rec_loss': '5.1622'}
2025-02-24 21:56:06,612 - {'Epoch': 61, 'HR@5': '0.0642', 'NDCG@5': '0.0439', 'HR@10': '0.1018', 'NDCG@10': '0.0560', 'HR@20': '0.1450', 'NDCG@20': '0.0669'}
2025-02-24 21:56:06,613 - EarlyStopping counter: 8 out of 10
2025-02-24 21:56:11,709 - {'epoch': 62, 'rec_loss': '5.1746'}
2025-02-24 21:56:12,372 - {'Epoch': 62, 'HR@5': '0.0688', 'NDCG@5': '0.0436', 'HR@10': '0.1000', 'NDCG@10': '0.0536', 'HR@20': '0.1495', 'NDCG@20': '0.0661'}
2025-02-24 21:56:12,373 - EarlyStopping counter: 9 out of 10
2025-02-24 21:56:17,394 - {'epoch': 63, 'rec_loss': '5.1688'}
2025-02-24 21:56:18,023 - {'Epoch': 63, 'HR@5': '0.0642', 'NDCG@5': '0.0417', 'HR@10': '0.1073', 'NDCG@10': '0.0556', 'HR@20': '0.1514', 'NDCG@20': '0.0666'}
2025-02-24 21:56:18,025 - EarlyStopping counter: 10 out of 10
2025-02-24 21:56:18,025 - Early stopping
2025-02-24 21:56:18,025 - ---------------Test Score---------------
2025-02-24 21:56:18,674 - {'Epoch': 0, 'HR@5': '0.0587', 'NDCG@5': '0.0379', 'HR@10': '0.0752', 'NDCG@10': '0.0432', 'HR@20': '0.1119', 'NDCG@20': '0.0522'}
2025-02-24 21:56:18,675 - Scale_LastFM
2025-02-24 21:56:18,675 - {'Epoch': 0, 'HR@5': '0.0587', 'NDCG@5': '0.0379', 'HR@10': '0.0752', 'NDCG@10': '0.0432', 'HR@20': '0.1119', 'NDCG@20': '0.0522'}
2025-02-24 22:01:34,318 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 10], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-24 22:01:37,080 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-24 22:01:37,088 - Total Parameters: 387350
2025-02-24 22:01:43,040 - {'epoch': 0, 'rec_loss': '8.0334'}
2025-02-24 22:01:43,734 - {'Epoch': 0, 'HR@5': '0.0211', 'NDCG@5': '0.0155', 'HR@10': '0.0367', 'NDCG@10': '0.0207', 'HR@20': '0.0606', 'NDCG@20': '0.0267'}
2025-02-24 22:01:43,735 - Validation score increased.  Saving model ...
2025-02-24 22:01:48,369 - {'epoch': 1, 'rec_loss': '7.7527'}
2025-02-24 22:01:48,998 - {'Epoch': 1, 'HR@5': '0.0220', 'NDCG@5': '0.0146', 'HR@10': '0.0358', 'NDCG@10': '0.0191', 'HR@20': '0.0606', 'NDCG@20': '0.0253'}
2025-02-24 22:01:49,000 - EarlyStopping counter: 1 out of 10
2025-02-24 22:01:54,410 - {'epoch': 2, 'rec_loss': '7.5501'}
2025-02-24 22:01:55,040 - {'Epoch': 2, 'HR@5': '0.0248', 'NDCG@5': '0.0170', 'HR@10': '0.0413', 'NDCG@10': '0.0223', 'HR@20': '0.0624', 'NDCG@20': '0.0277'}
2025-02-24 22:01:55,042 - Validation score increased.  Saving model ...
2025-02-24 22:02:00,180 - {'epoch': 3, 'rec_loss': '7.3371'}
2025-02-24 22:02:00,872 - {'Epoch': 3, 'HR@5': '0.0284', 'NDCG@5': '0.0196', 'HR@10': '0.0440', 'NDCG@10': '0.0245', 'HR@20': '0.0642', 'NDCG@20': '0.0296'}
2025-02-24 22:02:00,873 - Validation score increased.  Saving model ...
2025-02-24 22:02:05,939 - {'epoch': 4, 'rec_loss': '7.1118'}
2025-02-24 22:02:06,619 - {'Epoch': 4, 'HR@5': '0.0294', 'NDCG@5': '0.0215', 'HR@10': '0.0477', 'NDCG@10': '0.0272', 'HR@20': '0.0807', 'NDCG@20': '0.0354'}
2025-02-24 22:02:06,620 - Validation score increased.  Saving model ...
2025-02-24 22:02:12,308 - {'epoch': 5, 'rec_loss': '6.8950'}
2025-02-24 22:02:12,951 - {'Epoch': 5, 'HR@5': '0.0394', 'NDCG@5': '0.0245', 'HR@10': '0.0523', 'NDCG@10': '0.0286', 'HR@20': '0.0890', 'NDCG@20': '0.0378'}
2025-02-24 22:02:12,952 - Validation score increased.  Saving model ...
2025-02-24 22:02:18,058 - {'epoch': 6, 'rec_loss': '6.7123'}
2025-02-24 22:02:18,751 - {'Epoch': 6, 'HR@5': '0.0404', 'NDCG@5': '0.0281', 'HR@10': '0.0569', 'NDCG@10': '0.0335', 'HR@20': '0.0954', 'NDCG@20': '0.0430'}
2025-02-24 22:02:18,753 - Validation score increased.  Saving model ...
2025-02-24 22:02:23,911 - {'epoch': 7, 'rec_loss': '6.5258'}
2025-02-24 22:02:24,625 - {'Epoch': 7, 'HR@5': '0.0440', 'NDCG@5': '0.0287', 'HR@10': '0.0596', 'NDCG@10': '0.0337', 'HR@20': '0.1018', 'NDCG@20': '0.0443'}
2025-02-24 22:02:24,626 - Validation score increased.  Saving model ...
2025-02-24 22:02:29,688 - {'epoch': 8, 'rec_loss': '6.3799'}
2025-02-24 22:02:30,407 - {'Epoch': 8, 'HR@5': '0.0404', 'NDCG@5': '0.0279', 'HR@10': '0.0725', 'NDCG@10': '0.0380', 'HR@20': '0.1073', 'NDCG@20': '0.0469'}
2025-02-24 22:02:30,408 - Validation score increased.  Saving model ...
2025-02-24 22:02:35,476 - {'epoch': 9, 'rec_loss': '6.2417'}
2025-02-24 22:02:36,165 - {'Epoch': 9, 'HR@5': '0.0468', 'NDCG@5': '0.0290', 'HR@10': '0.0725', 'NDCG@10': '0.0374', 'HR@20': '0.1128', 'NDCG@20': '0.0477'}
2025-02-24 22:02:36,166 - Validation score increased.  Saving model ...
2025-02-24 22:02:40,807 - {'epoch': 10, 'rec_loss': '6.1405'}
2025-02-24 22:02:41,470 - {'Epoch': 10, 'HR@5': '0.0532', 'NDCG@5': '0.0347', 'HR@10': '0.0890', 'NDCG@10': '0.0461', 'HR@20': '0.1156', 'NDCG@20': '0.0528'}
2025-02-24 22:02:41,471 - Validation score increased.  Saving model ...
2025-02-24 22:02:46,524 - {'epoch': 11, 'rec_loss': '6.0399'}
2025-02-24 22:02:47,205 - {'Epoch': 11, 'HR@5': '0.0514', 'NDCG@5': '0.0333', 'HR@10': '0.0798', 'NDCG@10': '0.0426', 'HR@20': '0.1156', 'NDCG@20': '0.0517'}
2025-02-24 22:02:47,206 - EarlyStopping counter: 1 out of 10
2025-02-24 22:02:52,233 - {'epoch': 12, 'rec_loss': '5.9385'}
2025-02-24 22:02:52,907 - {'Epoch': 12, 'HR@5': '0.0550', 'NDCG@5': '0.0347', 'HR@10': '0.0835', 'NDCG@10': '0.0438', 'HR@20': '0.1220', 'NDCG@20': '0.0536'}
2025-02-24 22:02:52,908 - Validation score increased.  Saving model ...
2025-02-24 22:02:57,828 - {'epoch': 13, 'rec_loss': '5.8668'}
2025-02-24 22:02:58,527 - {'Epoch': 13, 'HR@5': '0.0541', 'NDCG@5': '0.0337', 'HR@10': '0.0826', 'NDCG@10': '0.0428', 'HR@20': '0.1220', 'NDCG@20': '0.0529'}
2025-02-24 22:02:58,528 - EarlyStopping counter: 1 out of 10
2025-02-24 22:03:03,757 - {'epoch': 14, 'rec_loss': '5.8102'}
2025-02-24 22:03:04,466 - {'Epoch': 14, 'HR@5': '0.0523', 'NDCG@5': '0.0343', 'HR@10': '0.0835', 'NDCG@10': '0.0442', 'HR@20': '0.1275', 'NDCG@20': '0.0554'}
2025-02-24 22:03:04,467 - Validation score increased.  Saving model ...
2025-02-24 22:03:09,601 - {'epoch': 15, 'rec_loss': '5.7557'}
2025-02-24 22:03:10,293 - {'Epoch': 15, 'HR@5': '0.0587', 'NDCG@5': '0.0364', 'HR@10': '0.0881', 'NDCG@10': '0.0461', 'HR@20': '0.1312', 'NDCG@20': '0.0571'}
2025-02-24 22:03:10,295 - Validation score increased.  Saving model ...
2025-02-24 22:03:15,640 - {'epoch': 16, 'rec_loss': '5.6962'}
2025-02-24 22:03:16,371 - {'Epoch': 16, 'HR@5': '0.0541', 'NDCG@5': '0.0366', 'HR@10': '0.0844', 'NDCG@10': '0.0465', 'HR@20': '0.1248', 'NDCG@20': '0.0568'}
2025-02-24 22:03:16,372 - EarlyStopping counter: 1 out of 10
2025-02-24 22:03:21,467 - {'epoch': 17, 'rec_loss': '5.6672'}
2025-02-24 22:03:22,133 - {'Epoch': 17, 'HR@5': '0.0550', 'NDCG@5': '0.0369', 'HR@10': '0.0835', 'NDCG@10': '0.0460', 'HR@20': '0.1321', 'NDCG@20': '0.0582'}
2025-02-24 22:03:22,134 - Validation score increased.  Saving model ...
2025-02-24 22:03:27,208 - {'epoch': 18, 'rec_loss': '5.6182'}
2025-02-24 22:03:27,826 - {'Epoch': 18, 'HR@5': '0.0541', 'NDCG@5': '0.0370', 'HR@10': '0.0826', 'NDCG@10': '0.0464', 'HR@20': '0.1358', 'NDCG@20': '0.0597'}
2025-02-24 22:03:27,827 - Validation score increased.  Saving model ...
2025-02-24 22:03:32,548 - {'epoch': 19, 'rec_loss': '5.5871'}
2025-02-24 22:03:33,287 - {'Epoch': 19, 'HR@5': '0.0578', 'NDCG@5': '0.0380', 'HR@10': '0.0908', 'NDCG@10': '0.0486', 'HR@20': '0.1394', 'NDCG@20': '0.0608'}
2025-02-24 22:03:33,288 - Validation score increased.  Saving model ...
2025-02-24 22:03:38,016 - {'epoch': 20, 'rec_loss': '5.5512'}
2025-02-24 22:03:38,689 - {'Epoch': 20, 'HR@5': '0.0606', 'NDCG@5': '0.0388', 'HR@10': '0.0945', 'NDCG@10': '0.0495', 'HR@20': '0.1422', 'NDCG@20': '0.0614'}
2025-02-24 22:03:38,690 - Validation score increased.  Saving model ...
2025-02-24 22:03:43,726 - {'epoch': 21, 'rec_loss': '5.5518'}
2025-02-24 22:03:44,415 - {'Epoch': 21, 'HR@5': '0.0587', 'NDCG@5': '0.0384', 'HR@10': '0.0945', 'NDCG@10': '0.0498', 'HR@20': '0.1404', 'NDCG@20': '0.0612'}
2025-02-24 22:03:44,416 - EarlyStopping counter: 1 out of 10
2025-02-24 22:03:49,667 - {'epoch': 22, 'rec_loss': '5.5126'}
2025-02-24 22:03:50,371 - {'Epoch': 22, 'HR@5': '0.0514', 'NDCG@5': '0.0358', 'HR@10': '0.0917', 'NDCG@10': '0.0488', 'HR@20': '0.1413', 'NDCG@20': '0.0613'}
2025-02-24 22:03:50,372 - EarlyStopping counter: 2 out of 10
2025-02-24 22:03:56,045 - {'epoch': 23, 'rec_loss': '5.4914'}
2025-02-24 22:03:56,680 - {'Epoch': 23, 'HR@5': '0.0615', 'NDCG@5': '0.0391', 'HR@10': '0.0917', 'NDCG@10': '0.0487', 'HR@20': '0.1459', 'NDCG@20': '0.0623'}
2025-02-24 22:03:56,681 - Validation score increased.  Saving model ...
2025-02-24 22:04:01,787 - {'epoch': 24, 'rec_loss': '5.4770'}
2025-02-24 22:04:02,428 - {'Epoch': 24, 'HR@5': '0.0606', 'NDCG@5': '0.0397', 'HR@10': '0.0945', 'NDCG@10': '0.0504', 'HR@20': '0.1468', 'NDCG@20': '0.0636'}
2025-02-24 22:04:02,429 - Validation score increased.  Saving model ...
2025-02-24 22:04:07,625 - {'epoch': 25, 'rec_loss': '5.4718'}
2025-02-24 22:04:08,286 - {'Epoch': 25, 'HR@5': '0.0587', 'NDCG@5': '0.0391', 'HR@10': '0.0899', 'NDCG@10': '0.0491', 'HR@20': '0.1422', 'NDCG@20': '0.0623'}
2025-02-24 22:04:08,287 - EarlyStopping counter: 1 out of 10
2025-02-24 22:04:13,448 - {'epoch': 26, 'rec_loss': '5.4438'}
2025-02-24 22:04:14,103 - {'Epoch': 26, 'HR@5': '0.0596', 'NDCG@5': '0.0389', 'HR@10': '0.0862', 'NDCG@10': '0.0474', 'HR@20': '0.1431', 'NDCG@20': '0.0620'}
2025-02-24 22:04:14,104 - EarlyStopping counter: 2 out of 10
2025-02-24 22:04:19,390 - {'epoch': 27, 'rec_loss': '5.4292'}
2025-02-24 22:04:20,041 - {'Epoch': 27, 'HR@5': '0.0596', 'NDCG@5': '0.0386', 'HR@10': '0.0927', 'NDCG@10': '0.0490', 'HR@20': '0.1404', 'NDCG@20': '0.0613'}
2025-02-24 22:04:20,042 - EarlyStopping counter: 3 out of 10
2025-02-24 22:04:24,785 - {'epoch': 28, 'rec_loss': '5.4112'}
2025-02-24 22:04:25,421 - {'Epoch': 28, 'HR@5': '0.0606', 'NDCG@5': '0.0400', 'HR@10': '0.0917', 'NDCG@10': '0.0500', 'HR@20': '0.1413', 'NDCG@20': '0.0624'}
2025-02-24 22:04:25,422 - EarlyStopping counter: 4 out of 10
2025-02-24 22:04:30,089 - {'epoch': 29, 'rec_loss': '5.3953'}
2025-02-24 22:04:30,725 - {'Epoch': 29, 'HR@5': '0.0587', 'NDCG@5': '0.0381', 'HR@10': '0.0908', 'NDCG@10': '0.0487', 'HR@20': '0.1450', 'NDCG@20': '0.0624'}
2025-02-24 22:04:30,726 - EarlyStopping counter: 5 out of 10
2025-02-24 22:04:35,590 - {'epoch': 30, 'rec_loss': '5.3897'}
2025-02-24 22:04:36,256 - {'Epoch': 30, 'HR@5': '0.0569', 'NDCG@5': '0.0366', 'HR@10': '0.0917', 'NDCG@10': '0.0479', 'HR@20': '0.1450', 'NDCG@20': '0.0613'}
2025-02-24 22:04:36,258 - EarlyStopping counter: 6 out of 10
2025-02-24 22:04:41,069 - {'epoch': 31, 'rec_loss': '5.3793'}
2025-02-24 22:04:41,734 - {'Epoch': 31, 'HR@5': '0.0587', 'NDCG@5': '0.0380', 'HR@10': '0.0972', 'NDCG@10': '0.0504', 'HR@20': '0.1431', 'NDCG@20': '0.0621'}
2025-02-24 22:04:41,735 - EarlyStopping counter: 7 out of 10
2025-02-24 22:04:47,480 - {'epoch': 32, 'rec_loss': '5.3563'}
2025-02-24 22:04:48,152 - {'Epoch': 32, 'HR@5': '0.0606', 'NDCG@5': '0.0411', 'HR@10': '0.1000', 'NDCG@10': '0.0537', 'HR@20': '0.1505', 'NDCG@20': '0.0663'}
2025-02-24 22:04:48,153 - Validation score increased.  Saving model ...
2025-02-24 22:04:53,614 - {'epoch': 33, 'rec_loss': '5.3430'}
2025-02-24 22:04:54,319 - {'Epoch': 33, 'HR@5': '0.0596', 'NDCG@5': '0.0394', 'HR@10': '0.0853', 'NDCG@10': '0.0477', 'HR@20': '0.1450', 'NDCG@20': '0.0628'}
2025-02-24 22:04:54,321 - EarlyStopping counter: 1 out of 10
2025-02-24 22:04:59,312 - {'epoch': 34, 'rec_loss': '5.3404'}
2025-02-24 22:04:59,957 - {'Epoch': 34, 'HR@5': '0.0606', 'NDCG@5': '0.0381', 'HR@10': '0.0954', 'NDCG@10': '0.0491', 'HR@20': '0.1495', 'NDCG@20': '0.0628'}
2025-02-24 22:04:59,958 - EarlyStopping counter: 2 out of 10
2025-02-24 22:05:04,720 - {'epoch': 35, 'rec_loss': '5.3296'}
2025-02-24 22:05:05,358 - {'Epoch': 35, 'HR@5': '0.0587', 'NDCG@5': '0.0392', 'HR@10': '0.1009', 'NDCG@10': '0.0528', 'HR@20': '0.1569', 'NDCG@20': '0.0668'}
2025-02-24 22:05:05,359 - Validation score increased.  Saving model ...
2025-02-24 22:05:10,790 - {'epoch': 36, 'rec_loss': '5.3161'}
2025-02-24 22:05:11,478 - {'Epoch': 36, 'HR@5': '0.0624', 'NDCG@5': '0.0395', 'HR@10': '0.0991', 'NDCG@10': '0.0512', 'HR@20': '0.1569', 'NDCG@20': '0.0657'}
2025-02-24 22:05:11,479 - EarlyStopping counter: 1 out of 10
2025-02-24 22:05:16,540 - {'epoch': 37, 'rec_loss': '5.3033'}
2025-02-24 22:05:17,214 - {'Epoch': 37, 'HR@5': '0.0615', 'NDCG@5': '0.0384', 'HR@10': '0.0936', 'NDCG@10': '0.0488', 'HR@20': '0.1523', 'NDCG@20': '0.0637'}
2025-02-24 22:05:17,216 - EarlyStopping counter: 2 out of 10
2025-02-24 22:05:22,116 - {'epoch': 38, 'rec_loss': '5.2955'}
2025-02-24 22:05:22,777 - {'Epoch': 38, 'HR@5': '0.0615', 'NDCG@5': '0.0402', 'HR@10': '0.1018', 'NDCG@10': '0.0530', 'HR@20': '0.1505', 'NDCG@20': '0.0652'}
2025-02-24 22:05:22,778 - EarlyStopping counter: 3 out of 10
2025-02-24 22:05:27,734 - {'epoch': 39, 'rec_loss': '5.3091'}
2025-02-24 22:05:28,444 - {'Epoch': 39, 'HR@5': '0.0624', 'NDCG@5': '0.0410', 'HR@10': '0.0972', 'NDCG@10': '0.0523', 'HR@20': '0.1505', 'NDCG@20': '0.0657'}
2025-02-24 22:05:28,446 - EarlyStopping counter: 4 out of 10
2025-02-24 22:05:33,324 - {'epoch': 40, 'rec_loss': '5.2785'}
2025-02-24 22:05:34,061 - {'Epoch': 40, 'HR@5': '0.0670', 'NDCG@5': '0.0411', 'HR@10': '0.1000', 'NDCG@10': '0.0517', 'HR@20': '0.1505', 'NDCG@20': '0.0646'}
2025-02-24 22:05:34,063 - EarlyStopping counter: 5 out of 10
2025-02-24 22:05:38,958 - {'epoch': 41, 'rec_loss': '5.2704'}
2025-02-24 22:05:39,607 - {'Epoch': 41, 'HR@5': '0.0624', 'NDCG@5': '0.0398', 'HR@10': '0.0991', 'NDCG@10': '0.0516', 'HR@20': '0.1505', 'NDCG@20': '0.0645'}
2025-02-24 22:05:39,608 - EarlyStopping counter: 6 out of 10
2025-02-24 22:05:44,367 - {'epoch': 42, 'rec_loss': '5.2780'}
2025-02-24 22:05:45,059 - {'Epoch': 42, 'HR@5': '0.0633', 'NDCG@5': '0.0407', 'HR@10': '0.0945', 'NDCG@10': '0.0510', 'HR@20': '0.1532', 'NDCG@20': '0.0657'}
2025-02-24 22:05:45,060 - EarlyStopping counter: 7 out of 10
2025-02-24 22:05:49,999 - {'epoch': 43, 'rec_loss': '5.2490'}
2025-02-24 22:05:50,648 - {'Epoch': 43, 'HR@5': '0.0651', 'NDCG@5': '0.0412', 'HR@10': '0.1018', 'NDCG@10': '0.0528', 'HR@20': '0.1523', 'NDCG@20': '0.0653'}
2025-02-24 22:05:50,649 - EarlyStopping counter: 8 out of 10
2025-02-24 22:05:55,484 - {'epoch': 44, 'rec_loss': '5.2721'}
2025-02-24 22:05:56,111 - {'Epoch': 44, 'HR@5': '0.0615', 'NDCG@5': '0.0389', 'HR@10': '0.1055', 'NDCG@10': '0.0528', 'HR@20': '0.1550', 'NDCG@20': '0.0649'}
2025-02-24 22:05:56,112 - EarlyStopping counter: 9 out of 10
2025-02-24 22:06:00,946 - {'epoch': 45, 'rec_loss': '5.2463'}
2025-02-24 22:06:01,642 - {'Epoch': 45, 'HR@5': '0.0642', 'NDCG@5': '0.0400', 'HR@10': '0.1037', 'NDCG@10': '0.0526', 'HR@20': '0.1505', 'NDCG@20': '0.0643'}
2025-02-24 22:06:01,644 - EarlyStopping counter: 10 out of 10
2025-02-24 22:06:01,644 - Early stopping
2025-02-24 22:06:01,644 - ---------------Test Score---------------
2025-02-24 22:06:02,290 - {'Epoch': 0, 'HR@5': '0.0495', 'NDCG@5': '0.0348', 'HR@10': '0.0725', 'NDCG@10': '0.0421', 'HR@20': '0.1092', 'NDCG@20': '0.0511'}
2025-02-24 22:06:02,291 - Scale_LastFM
2025-02-24 22:06:02,291 - {'Epoch': 0, 'HR@5': '0.0495', 'NDCG@5': '0.0348', 'HR@10': '0.0725', 'NDCG@10': '0.0421', 'HR@20': '0.1092', 'NDCG@20': '0.0511'}
2025-02-24 22:11:58,376 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 5], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-24 22:12:01,163 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-24 22:12:01,167 - Total Parameters: 387025
2025-02-24 22:12:07,514 - {'epoch': 0, 'rec_loss': '8.0388'}
2025-02-24 22:12:08,183 - {'Epoch': 0, 'HR@5': '0.0239', 'NDCG@5': '0.0182', 'HR@10': '0.0404', 'NDCG@10': '0.0234', 'HR@20': '0.0615', 'NDCG@20': '0.0287'}
2025-02-24 22:12:08,184 - Validation score increased.  Saving model ...
2025-02-24 22:12:13,119 - {'epoch': 1, 'rec_loss': '7.7494'}
2025-02-24 22:12:13,881 - {'Epoch': 1, 'HR@5': '0.0229', 'NDCG@5': '0.0161', 'HR@10': '0.0376', 'NDCG@10': '0.0208', 'HR@20': '0.0615', 'NDCG@20': '0.0266'}
2025-02-24 22:12:13,882 - EarlyStopping counter: 1 out of 10
2025-02-24 22:12:19,175 - {'epoch': 2, 'rec_loss': '7.5459'}
2025-02-24 22:12:19,851 - {'Epoch': 2, 'HR@5': '0.0248', 'NDCG@5': '0.0168', 'HR@10': '0.0422', 'NDCG@10': '0.0225', 'HR@20': '0.0651', 'NDCG@20': '0.0282'}
2025-02-24 22:12:19,852 - EarlyStopping counter: 2 out of 10
2025-02-24 22:12:24,945 - {'epoch': 3, 'rec_loss': '7.3303'}
2025-02-24 22:12:25,655 - {'Epoch': 3, 'HR@5': '0.0330', 'NDCG@5': '0.0228', 'HR@10': '0.0450', 'NDCG@10': '0.0265', 'HR@20': '0.0679', 'NDCG@20': '0.0323'}
2025-02-24 22:12:25,656 - Validation score increased.  Saving model ...
2025-02-24 22:12:30,755 - {'epoch': 4, 'rec_loss': '7.0980'}
2025-02-24 22:12:31,476 - {'Epoch': 4, 'HR@5': '0.0321', 'NDCG@5': '0.0216', 'HR@10': '0.0477', 'NDCG@10': '0.0266', 'HR@20': '0.0807', 'NDCG@20': '0.0349'}
2025-02-24 22:12:31,477 - Validation score increased.  Saving model ...
2025-02-24 22:12:37,232 - {'epoch': 5, 'rec_loss': '6.8974'}
2025-02-24 22:12:37,995 - {'Epoch': 5, 'HR@5': '0.0376', 'NDCG@5': '0.0238', 'HR@10': '0.0560', 'NDCG@10': '0.0297', 'HR@20': '0.0844', 'NDCG@20': '0.0368'}
2025-02-24 22:12:37,997 - Validation score increased.  Saving model ...
2025-02-24 22:12:42,786 - {'epoch': 6, 'rec_loss': '6.7114'}
2025-02-24 22:12:43,468 - {'Epoch': 6, 'HR@5': '0.0404', 'NDCG@5': '0.0268', 'HR@10': '0.0624', 'NDCG@10': '0.0339', 'HR@20': '0.0945', 'NDCG@20': '0.0420'}
2025-02-24 22:12:43,469 - Validation score increased.  Saving model ...
2025-02-24 22:12:48,570 - {'epoch': 7, 'rec_loss': '6.5406'}
2025-02-24 22:12:49,319 - {'Epoch': 7, 'HR@5': '0.0440', 'NDCG@5': '0.0276', 'HR@10': '0.0716', 'NDCG@10': '0.0365', 'HR@20': '0.1000', 'NDCG@20': '0.0437'}
2025-02-24 22:12:49,321 - Validation score increased.  Saving model ...
2025-02-24 22:12:54,015 - {'epoch': 8, 'rec_loss': '6.3889'}
2025-02-24 22:12:54,780 - {'Epoch': 8, 'HR@5': '0.0523', 'NDCG@5': '0.0329', 'HR@10': '0.0734', 'NDCG@10': '0.0397', 'HR@20': '0.1101', 'NDCG@20': '0.0488'}
2025-02-24 22:12:54,782 - Validation score increased.  Saving model ...
2025-02-24 22:13:00,237 - {'epoch': 9, 'rec_loss': '6.2382'}
2025-02-24 22:13:00,925 - {'Epoch': 9, 'HR@5': '0.0523', 'NDCG@5': '0.0344', 'HR@10': '0.0752', 'NDCG@10': '0.0418', 'HR@20': '0.1147', 'NDCG@20': '0.0517'}
2025-02-24 22:13:00,926 - Validation score increased.  Saving model ...
2025-02-24 22:13:05,607 - {'epoch': 10, 'rec_loss': '6.1491'}
2025-02-24 22:13:06,354 - {'Epoch': 10, 'HR@5': '0.0569', 'NDCG@5': '0.0344', 'HR@10': '0.0761', 'NDCG@10': '0.0407', 'HR@20': '0.1119', 'NDCG@20': '0.0499'}
2025-02-24 22:13:06,355 - EarlyStopping counter: 1 out of 10
2025-02-24 22:13:11,275 - {'epoch': 11, 'rec_loss': '6.0568'}
2025-02-24 22:13:12,052 - {'Epoch': 11, 'HR@5': '0.0560', 'NDCG@5': '0.0369', 'HR@10': '0.0789', 'NDCG@10': '0.0443', 'HR@20': '0.1165', 'NDCG@20': '0.0539'}
2025-02-24 22:13:12,053 - Validation score increased.  Saving model ...
2025-02-24 22:13:17,039 - {'epoch': 12, 'rec_loss': '5.9579'}
2025-02-24 22:13:17,807 - {'Epoch': 12, 'HR@5': '0.0615', 'NDCG@5': '0.0390', 'HR@10': '0.0817', 'NDCG@10': '0.0454', 'HR@20': '0.1193', 'NDCG@20': '0.0548'}
2025-02-24 22:13:17,809 - Validation score increased.  Saving model ...
2025-02-24 22:13:22,867 - {'epoch': 13, 'rec_loss': '5.8820'}
2025-02-24 22:13:23,628 - {'Epoch': 13, 'HR@5': '0.0596', 'NDCG@5': '0.0380', 'HR@10': '0.0817', 'NDCG@10': '0.0449', 'HR@20': '0.1220', 'NDCG@20': '0.0549'}
2025-02-24 22:13:23,629 - Validation score increased.  Saving model ...
2025-02-24 22:13:28,751 - {'epoch': 14, 'rec_loss': '5.8236'}
2025-02-24 22:13:29,486 - {'Epoch': 14, 'HR@5': '0.0587', 'NDCG@5': '0.0378', 'HR@10': '0.0817', 'NDCG@10': '0.0454', 'HR@20': '0.1275', 'NDCG@20': '0.0568'}
2025-02-24 22:13:29,487 - Validation score increased.  Saving model ...
2025-02-24 22:13:34,519 - {'epoch': 15, 'rec_loss': '5.7637'}
2025-02-24 22:13:35,231 - {'Epoch': 15, 'HR@5': '0.0587', 'NDCG@5': '0.0391', 'HR@10': '0.0835', 'NDCG@10': '0.0471', 'HR@20': '0.1239', 'NDCG@20': '0.0571'}
2025-02-24 22:13:35,232 - Validation score increased.  Saving model ...
2025-02-24 22:13:40,155 - {'epoch': 16, 'rec_loss': '5.7152'}
2025-02-24 22:13:40,864 - {'Epoch': 16, 'HR@5': '0.0505', 'NDCG@5': '0.0343', 'HR@10': '0.0789', 'NDCG@10': '0.0437', 'HR@20': '0.1303', 'NDCG@20': '0.0566'}
2025-02-24 22:13:40,865 - EarlyStopping counter: 1 out of 10
2025-02-24 22:13:46,127 - {'epoch': 17, 'rec_loss': '5.6752'}
2025-02-24 22:13:46,856 - {'Epoch': 17, 'HR@5': '0.0532', 'NDCG@5': '0.0337', 'HR@10': '0.0853', 'NDCG@10': '0.0440', 'HR@20': '0.1294', 'NDCG@20': '0.0550'}
2025-02-24 22:13:46,857 - EarlyStopping counter: 2 out of 10
2025-02-24 22:13:51,873 - {'epoch': 18, 'rec_loss': '5.6263'}
2025-02-24 22:13:52,603 - {'Epoch': 18, 'HR@5': '0.0596', 'NDCG@5': '0.0375', 'HR@10': '0.0826', 'NDCG@10': '0.0448', 'HR@20': '0.1358', 'NDCG@20': '0.0582'}
2025-02-24 22:13:52,604 - Validation score increased.  Saving model ...
2025-02-24 22:13:57,516 - {'epoch': 19, 'rec_loss': '5.6021'}
2025-02-24 22:13:58,264 - {'Epoch': 19, 'HR@5': '0.0550', 'NDCG@5': '0.0356', 'HR@10': '0.0844', 'NDCG@10': '0.0451', 'HR@20': '0.1349', 'NDCG@20': '0.0578'}
2025-02-24 22:13:58,265 - EarlyStopping counter: 1 out of 10
2025-02-24 22:14:03,180 - {'epoch': 20, 'rec_loss': '5.5741'}
2025-02-24 22:14:03,898 - {'Epoch': 20, 'HR@5': '0.0578', 'NDCG@5': '0.0375', 'HR@10': '0.0881', 'NDCG@10': '0.0473', 'HR@20': '0.1312', 'NDCG@20': '0.0583'}
2025-02-24 22:14:03,899 - Validation score increased.  Saving model ...
2025-02-24 22:14:08,992 - {'epoch': 21, 'rec_loss': '5.5468'}
2025-02-24 22:14:09,760 - {'Epoch': 21, 'HR@5': '0.0560', 'NDCG@5': '0.0375', 'HR@10': '0.0890', 'NDCG@10': '0.0483', 'HR@20': '0.1367', 'NDCG@20': '0.0604'}
2025-02-24 22:14:09,761 - Validation score increased.  Saving model ...
2025-02-24 22:14:14,855 - {'epoch': 22, 'rec_loss': '5.5309'}
2025-02-24 22:14:15,593 - {'Epoch': 22, 'HR@5': '0.0523', 'NDCG@5': '0.0350', 'HR@10': '0.0927', 'NDCG@10': '0.0480', 'HR@20': '0.1404', 'NDCG@20': '0.0601'}
2025-02-24 22:14:15,594 - EarlyStopping counter: 1 out of 10
2025-02-24 22:14:20,696 - {'epoch': 23, 'rec_loss': '5.5142'}
2025-02-24 22:14:21,399 - {'Epoch': 23, 'HR@5': '0.0606', 'NDCG@5': '0.0385', 'HR@10': '0.0862', 'NDCG@10': '0.0467', 'HR@20': '0.1385', 'NDCG@20': '0.0599'}
2025-02-24 22:14:21,400 - EarlyStopping counter: 2 out of 10
2025-02-24 22:14:26,168 - {'epoch': 24, 'rec_loss': '5.4801'}
2025-02-24 22:14:26,902 - {'Epoch': 24, 'HR@5': '0.0606', 'NDCG@5': '0.0392', 'HR@10': '0.0872', 'NDCG@10': '0.0477', 'HR@20': '0.1385', 'NDCG@20': '0.0608'}
2025-02-24 22:14:26,903 - Validation score increased.  Saving model ...
2025-02-24 22:14:32,641 - {'epoch': 25, 'rec_loss': '5.4882'}
2025-02-24 22:14:33,346 - {'Epoch': 25, 'HR@5': '0.0578', 'NDCG@5': '0.0373', 'HR@10': '0.0862', 'NDCG@10': '0.0465', 'HR@20': '0.1394', 'NDCG@20': '0.0599'}
2025-02-24 22:14:33,347 - EarlyStopping counter: 1 out of 10
2025-02-24 22:14:38,276 - {'epoch': 26, 'rec_loss': '5.4503'}
2025-02-24 22:14:38,968 - {'Epoch': 26, 'HR@5': '0.0596', 'NDCG@5': '0.0387', 'HR@10': '0.0881', 'NDCG@10': '0.0480', 'HR@20': '0.1413', 'NDCG@20': '0.0612'}
2025-02-24 22:14:38,969 - Validation score increased.  Saving model ...
2025-02-24 22:14:44,018 - {'epoch': 27, 'rec_loss': '5.4565'}
2025-02-24 22:14:44,726 - {'Epoch': 27, 'HR@5': '0.0624', 'NDCG@5': '0.0418', 'HR@10': '0.0917', 'NDCG@10': '0.0515', 'HR@20': '0.1404', 'NDCG@20': '0.0635'}
2025-02-24 22:14:44,727 - Validation score increased.  Saving model ...
2025-02-24 22:14:49,877 - {'epoch': 28, 'rec_loss': '5.4306'}
2025-02-24 22:14:50,628 - {'Epoch': 28, 'HR@5': '0.0615', 'NDCG@5': '0.0407', 'HR@10': '0.0954', 'NDCG@10': '0.0516', 'HR@20': '0.1459', 'NDCG@20': '0.0641'}
2025-02-24 22:14:50,629 - Validation score increased.  Saving model ...
2025-02-24 22:14:55,699 - {'epoch': 29, 'rec_loss': '5.4172'}
2025-02-24 22:14:56,357 - {'Epoch': 29, 'HR@5': '0.0569', 'NDCG@5': '0.0345', 'HR@10': '0.0899', 'NDCG@10': '0.0449', 'HR@20': '0.1385', 'NDCG@20': '0.0571'}
2025-02-24 22:14:56,358 - EarlyStopping counter: 1 out of 10
2025-02-24 22:15:01,313 - {'epoch': 30, 'rec_loss': '5.4087'}
2025-02-24 22:15:02,051 - {'Epoch': 30, 'HR@5': '0.0523', 'NDCG@5': '0.0352', 'HR@10': '0.0881', 'NDCG@10': '0.0468', 'HR@20': '0.1450', 'NDCG@20': '0.0610'}
2025-02-24 22:15:02,052 - EarlyStopping counter: 2 out of 10
2025-02-24 22:15:07,162 - {'epoch': 31, 'rec_loss': '5.3865'}
2025-02-24 22:15:07,861 - {'Epoch': 31, 'HR@5': '0.0569', 'NDCG@5': '0.0383', 'HR@10': '0.0853', 'NDCG@10': '0.0475', 'HR@20': '0.1440', 'NDCG@20': '0.0622'}
2025-02-24 22:15:07,862 - EarlyStopping counter: 3 out of 10
2025-02-24 22:15:13,400 - {'epoch': 32, 'rec_loss': '5.3884'}
2025-02-24 22:15:14,116 - {'Epoch': 32, 'HR@5': '0.0532', 'NDCG@5': '0.0344', 'HR@10': '0.0945', 'NDCG@10': '0.0477', 'HR@20': '0.1440', 'NDCG@20': '0.0600'}
2025-02-24 22:15:14,117 - EarlyStopping counter: 4 out of 10
2025-02-24 22:15:18,946 - {'epoch': 33, 'rec_loss': '5.3622'}
2025-02-24 22:15:19,691 - {'Epoch': 33, 'HR@5': '0.0596', 'NDCG@5': '0.0384', 'HR@10': '0.0982', 'NDCG@10': '0.0506', 'HR@20': '0.1422', 'NDCG@20': '0.0617'}
2025-02-24 22:15:19,692 - EarlyStopping counter: 5 out of 10
2025-02-24 22:15:24,598 - {'epoch': 34, 'rec_loss': '5.3478'}
2025-02-24 22:15:25,276 - {'Epoch': 34, 'HR@5': '0.0679', 'NDCG@5': '0.0418', 'HR@10': '0.1000', 'NDCG@10': '0.0521', 'HR@20': '0.1495', 'NDCG@20': '0.0644'}
2025-02-24 22:15:25,277 - Validation score increased.  Saving model ...
2025-02-24 22:15:30,220 - {'epoch': 35, 'rec_loss': '5.3517'}
2025-02-24 22:15:30,888 - {'Epoch': 35, 'HR@5': '0.0587', 'NDCG@5': '0.0382', 'HR@10': '0.1037', 'NDCG@10': '0.0528', 'HR@20': '0.1532', 'NDCG@20': '0.0652'}
2025-02-24 22:15:30,889 - Validation score increased.  Saving model ...
2025-02-24 22:15:35,785 - {'epoch': 36, 'rec_loss': '5.3400'}
2025-02-24 22:15:36,506 - {'Epoch': 36, 'HR@5': '0.0633', 'NDCG@5': '0.0398', 'HR@10': '0.1009', 'NDCG@10': '0.0521', 'HR@20': '0.1495', 'NDCG@20': '0.0642'}
2025-02-24 22:15:36,508 - EarlyStopping counter: 1 out of 10
2025-02-24 22:15:41,588 - {'epoch': 37, 'rec_loss': '5.3162'}
2025-02-24 22:15:42,326 - {'Epoch': 37, 'HR@5': '0.0624', 'NDCG@5': '0.0381', 'HR@10': '0.1028', 'NDCG@10': '0.0512', 'HR@20': '0.1450', 'NDCG@20': '0.0618'}
2025-02-24 22:15:42,327 - EarlyStopping counter: 2 out of 10
2025-02-24 22:15:47,398 - {'epoch': 38, 'rec_loss': '5.3165'}
2025-02-24 22:15:48,084 - {'Epoch': 38, 'HR@5': '0.0670', 'NDCG@5': '0.0408', 'HR@10': '0.1055', 'NDCG@10': '0.0532', 'HR@20': '0.1532', 'NDCG@20': '0.0650'}
2025-02-24 22:15:48,085 - EarlyStopping counter: 3 out of 10
2025-02-24 22:15:52,971 - {'epoch': 39, 'rec_loss': '5.3200'}
2025-02-24 22:15:53,761 - {'Epoch': 39, 'HR@5': '0.0661', 'NDCG@5': '0.0408', 'HR@10': '0.0972', 'NDCG@10': '0.0508', 'HR@20': '0.1459', 'NDCG@20': '0.0629'}
2025-02-24 22:15:53,762 - EarlyStopping counter: 4 out of 10
2025-02-24 22:15:58,914 - {'epoch': 40, 'rec_loss': '5.3004'}
2025-02-24 22:15:59,619 - {'Epoch': 40, 'HR@5': '0.0596', 'NDCG@5': '0.0378', 'HR@10': '0.0963', 'NDCG@10': '0.0496', 'HR@20': '0.1505', 'NDCG@20': '0.0631'}
2025-02-24 22:15:59,620 - EarlyStopping counter: 5 out of 10
2025-02-24 22:16:04,640 - {'epoch': 41, 'rec_loss': '5.3032'}
2025-02-24 22:16:05,311 - {'Epoch': 41, 'HR@5': '0.0651', 'NDCG@5': '0.0400', 'HR@10': '0.1018', 'NDCG@10': '0.0519', 'HR@20': '0.1495', 'NDCG@20': '0.0640'}
2025-02-24 22:16:05,312 - EarlyStopping counter: 6 out of 10
2025-02-24 22:16:10,283 - {'epoch': 42, 'rec_loss': '5.2803'}
2025-02-24 22:16:10,999 - {'Epoch': 42, 'HR@5': '0.0606', 'NDCG@5': '0.0388', 'HR@10': '0.1037', 'NDCG@10': '0.0530', 'HR@20': '0.1459', 'NDCG@20': '0.0636'}
2025-02-24 22:16:11,000 - EarlyStopping counter: 7 out of 10
2025-02-24 22:16:15,811 - {'epoch': 43, 'rec_loss': '5.2716'}
2025-02-24 22:16:16,582 - {'Epoch': 43, 'HR@5': '0.0633', 'NDCG@5': '0.0422', 'HR@10': '0.1000', 'NDCG@10': '0.0541', 'HR@20': '0.1495', 'NDCG@20': '0.0665'}
2025-02-24 22:16:16,583 - Validation score increased.  Saving model ...
2025-02-24 22:16:21,641 - {'epoch': 44, 'rec_loss': '5.2752'}
2025-02-24 22:16:22,312 - {'Epoch': 44, 'HR@5': '0.0642', 'NDCG@5': '0.0408', 'HR@10': '0.1046', 'NDCG@10': '0.0541', 'HR@20': '0.1541', 'NDCG@20': '0.0665'}
2025-02-24 22:16:22,313 - EarlyStopping counter: 1 out of 10
2025-02-24 22:16:27,322 - {'epoch': 45, 'rec_loss': '5.2764'}
2025-02-24 22:16:28,025 - {'Epoch': 45, 'HR@5': '0.0688', 'NDCG@5': '0.0439', 'HR@10': '0.1009', 'NDCG@10': '0.0542', 'HR@20': '0.1569', 'NDCG@20': '0.0682'}
2025-02-24 22:16:28,026 - Validation score increased.  Saving model ...
2025-02-24 22:16:33,253 - {'epoch': 46, 'rec_loss': '5.2633'}
2025-02-24 22:16:33,955 - {'Epoch': 46, 'HR@5': '0.0624', 'NDCG@5': '0.0402', 'HR@10': '0.1028', 'NDCG@10': '0.0530', 'HR@20': '0.1486', 'NDCG@20': '0.0646'}
2025-02-24 22:16:33,956 - EarlyStopping counter: 1 out of 10
2025-02-24 22:16:39,043 - {'epoch': 47, 'rec_loss': '5.2407'}
2025-02-24 22:16:39,765 - {'Epoch': 47, 'HR@5': '0.0688', 'NDCG@5': '0.0430', 'HR@10': '0.1000', 'NDCG@10': '0.0531', 'HR@20': '0.1431', 'NDCG@20': '0.0639'}
2025-02-24 22:16:39,766 - EarlyStopping counter: 2 out of 10
2025-02-24 22:16:44,778 - {'epoch': 48, 'rec_loss': '5.2530'}
2025-02-24 22:16:45,529 - {'Epoch': 48, 'HR@5': '0.0734', 'NDCG@5': '0.0456', 'HR@10': '0.1009', 'NDCG@10': '0.0545', 'HR@20': '0.1468', 'NDCG@20': '0.0662'}
2025-02-24 22:16:45,530 - EarlyStopping counter: 3 out of 10
2025-02-24 22:16:50,542 - {'epoch': 49, 'rec_loss': '5.2334'}
2025-02-24 22:16:51,241 - {'Epoch': 49, 'HR@5': '0.0706', 'NDCG@5': '0.0441', 'HR@10': '0.1018', 'NDCG@10': '0.0539', 'HR@20': '0.1450', 'NDCG@20': '0.0648'}
2025-02-24 22:16:51,242 - EarlyStopping counter: 4 out of 10
2025-02-24 22:16:56,628 - {'epoch': 50, 'rec_loss': '5.2465'}
2025-02-24 22:16:57,291 - {'Epoch': 50, 'HR@5': '0.0651', 'NDCG@5': '0.0422', 'HR@10': '0.1055', 'NDCG@10': '0.0551', 'HR@20': '0.1477', 'NDCG@20': '0.0657'}
2025-02-24 22:16:57,292 - EarlyStopping counter: 5 out of 10
2025-02-24 22:17:02,351 - {'epoch': 51, 'rec_loss': '5.2297'}
2025-02-24 22:17:03,026 - {'Epoch': 51, 'HR@5': '0.0651', 'NDCG@5': '0.0417', 'HR@10': '0.1046', 'NDCG@10': '0.0542', 'HR@20': '0.1505', 'NDCG@20': '0.0658'}
2025-02-24 22:17:03,027 - EarlyStopping counter: 6 out of 10
2025-02-24 22:17:08,159 - {'epoch': 52, 'rec_loss': '5.2241'}
2025-02-24 22:17:08,862 - {'Epoch': 52, 'HR@5': '0.0633', 'NDCG@5': '0.0402', 'HR@10': '0.1009', 'NDCG@10': '0.0525', 'HR@20': '0.1459', 'NDCG@20': '0.0638'}
2025-02-24 22:17:08,863 - EarlyStopping counter: 7 out of 10
2025-02-24 22:17:13,821 - {'epoch': 53, 'rec_loss': '5.2219'}
2025-02-24 22:17:14,550 - {'Epoch': 53, 'HR@5': '0.0661', 'NDCG@5': '0.0403', 'HR@10': '0.1055', 'NDCG@10': '0.0531', 'HR@20': '0.1477', 'NDCG@20': '0.0635'}
2025-02-24 22:17:14,551 - EarlyStopping counter: 8 out of 10
2025-02-24 22:17:19,805 - {'epoch': 54, 'rec_loss': '5.2126'}
2025-02-24 22:17:20,484 - {'Epoch': 54, 'HR@5': '0.0661', 'NDCG@5': '0.0409', 'HR@10': '0.1055', 'NDCG@10': '0.0535', 'HR@20': '0.1486', 'NDCG@20': '0.0642'}
2025-02-24 22:17:20,485 - EarlyStopping counter: 9 out of 10
2025-02-24 22:17:25,535 - {'epoch': 55, 'rec_loss': '5.1944'}
2025-02-24 22:17:26,230 - {'Epoch': 55, 'HR@5': '0.0697', 'NDCG@5': '0.0411', 'HR@10': '0.1046', 'NDCG@10': '0.0524', 'HR@20': '0.1450', 'NDCG@20': '0.0625'}
2025-02-24 22:17:26,231 - EarlyStopping counter: 10 out of 10
2025-02-24 22:17:26,231 - Early stopping
2025-02-24 22:17:26,231 - ---------------Test Score---------------
2025-02-24 22:17:26,957 - {'Epoch': 0, 'HR@5': '0.0523', 'NDCG@5': '0.0349', 'HR@10': '0.0743', 'NDCG@10': '0.0419', 'HR@20': '0.1073', 'NDCG@20': '0.0503'}
2025-02-24 22:17:26,958 - Scale_LastFM
2025-02-24 22:17:26,958 - {'Epoch': 0, 'HR@5': '0.0523', 'NDCG@5': '0.0349', 'HR@10': '0.0743', 'NDCG@10': '0.0419', 'HR@20': '0.1073', 'NDCG@20': '0.0503'}
2025-02-25 10:40:48,348 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[4, 8, 12], start_prob=0.1, end_prob=0.4, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-25 10:40:51,137 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-25 10:40:51,140 - Total Parameters: 387350
2025-02-25 10:40:57,203 - {'epoch': 0, 'rec_loss': '8.0361'}
2025-02-25 10:40:57,869 - {'Epoch': 0, 'HR@5': '0.0220', 'NDCG@5': '0.0149', 'HR@10': '0.0339', 'NDCG@10': '0.0187', 'HR@20': '0.0633', 'NDCG@20': '0.0260'}
2025-02-25 10:40:57,870 - Validation score increased.  Saving model ...
2025-02-25 10:41:02,907 - {'epoch': 1, 'rec_loss': '7.7384'}
2025-02-25 10:41:03,631 - {'Epoch': 1, 'HR@5': '0.0183', 'NDCG@5': '0.0130', 'HR@10': '0.0321', 'NDCG@10': '0.0176', 'HR@20': '0.0615', 'NDCG@20': '0.0251'}
2025-02-25 10:41:03,633 - EarlyStopping counter: 1 out of 10
2025-02-25 10:41:08,731 - {'epoch': 2, 'rec_loss': '7.5023'}
2025-02-25 10:41:09,414 - {'Epoch': 2, 'HR@5': '0.0284', 'NDCG@5': '0.0200', 'HR@10': '0.0486', 'NDCG@10': '0.0265', 'HR@20': '0.0688', 'NDCG@20': '0.0315'}
2025-02-25 10:41:09,415 - Validation score increased.  Saving model ...
2025-02-25 10:41:14,523 - {'epoch': 3, 'rec_loss': '7.2412'}
2025-02-25 10:41:15,248 - {'Epoch': 3, 'HR@5': '0.0339', 'NDCG@5': '0.0232', 'HR@10': '0.0505', 'NDCG@10': '0.0284', 'HR@20': '0.0817', 'NDCG@20': '0.0362'}
2025-02-25 10:41:15,249 - Validation score increased.  Saving model ...
2025-02-25 10:41:20,309 - {'epoch': 4, 'rec_loss': '6.9990'}
2025-02-25 10:41:20,972 - {'Epoch': 4, 'HR@5': '0.0385', 'NDCG@5': '0.0268', 'HR@10': '0.0624', 'NDCG@10': '0.0343', 'HR@20': '0.0881', 'NDCG@20': '0.0408'}
2025-02-25 10:41:20,973 - Validation score increased.  Saving model ...
2025-02-25 10:41:26,187 - {'epoch': 5, 'rec_loss': '6.7671'}
2025-02-25 10:41:26,855 - {'Epoch': 5, 'HR@5': '0.0422', 'NDCG@5': '0.0274', 'HR@10': '0.0624', 'NDCG@10': '0.0339', 'HR@20': '0.0899', 'NDCG@20': '0.0408'}
2025-02-25 10:41:26,856 - EarlyStopping counter: 1 out of 10
2025-02-25 10:41:31,846 - {'epoch': 6, 'rec_loss': '6.5473'}
2025-02-25 10:41:32,553 - {'Epoch': 6, 'HR@5': '0.0459', 'NDCG@5': '0.0272', 'HR@10': '0.0679', 'NDCG@10': '0.0342', 'HR@20': '0.0991', 'NDCG@20': '0.0421'}
2025-02-25 10:41:32,554 - Validation score increased.  Saving model ...
2025-02-25 10:41:37,406 - {'epoch': 7, 'rec_loss': '6.3570'}
2025-02-25 10:41:38,102 - {'Epoch': 7, 'HR@5': '0.0477', 'NDCG@5': '0.0297', 'HR@10': '0.0706', 'NDCG@10': '0.0368', 'HR@20': '0.1028', 'NDCG@20': '0.0450'}
2025-02-25 10:41:38,104 - Validation score increased.  Saving model ...
2025-02-25 10:41:43,188 - {'epoch': 8, 'rec_loss': '6.1920'}
2025-02-25 10:41:43,930 - {'Epoch': 8, 'HR@5': '0.0440', 'NDCG@5': '0.0291', 'HR@10': '0.0716', 'NDCG@10': '0.0379', 'HR@20': '0.1110', 'NDCG@20': '0.0479'}
2025-02-25 10:41:43,932 - Validation score increased.  Saving model ...
2025-02-25 10:41:49,518 - {'epoch': 9, 'rec_loss': '6.0752'}
2025-02-25 10:41:50,183 - {'Epoch': 9, 'HR@5': '0.0495', 'NDCG@5': '0.0304', 'HR@10': '0.0835', 'NDCG@10': '0.0412', 'HR@20': '0.1229', 'NDCG@20': '0.0510'}
2025-02-25 10:41:50,184 - Validation score increased.  Saving model ...
2025-02-25 10:41:55,165 - {'epoch': 10, 'rec_loss': '5.9412'}
2025-02-25 10:41:55,909 - {'Epoch': 10, 'HR@5': '0.0505', 'NDCG@5': '0.0333', 'HR@10': '0.0761', 'NDCG@10': '0.0415', 'HR@20': '0.1147', 'NDCG@20': '0.0513'}
2025-02-25 10:41:55,910 - Validation score increased.  Saving model ...
2025-02-25 10:42:00,806 - {'epoch': 11, 'rec_loss': '5.8796'}
2025-02-25 10:42:01,512 - {'Epoch': 11, 'HR@5': '0.0495', 'NDCG@5': '0.0338', 'HR@10': '0.0761', 'NDCG@10': '0.0424', 'HR@20': '0.1229', 'NDCG@20': '0.0542'}
2025-02-25 10:42:01,513 - Validation score increased.  Saving model ...
2025-02-25 10:42:06,467 - {'epoch': 12, 'rec_loss': '5.7859'}
2025-02-25 10:42:07,178 - {'Epoch': 12, 'HR@5': '0.0459', 'NDCG@5': '0.0326', 'HR@10': '0.0789', 'NDCG@10': '0.0434', 'HR@20': '0.1266', 'NDCG@20': '0.0554'}
2025-02-25 10:42:07,179 - Validation score increased.  Saving model ...
2025-02-25 10:42:12,203 - {'epoch': 13, 'rec_loss': '5.7135'}
2025-02-25 10:42:12,852 - {'Epoch': 13, 'HR@5': '0.0477', 'NDCG@5': '0.0328', 'HR@10': '0.0807', 'NDCG@10': '0.0435', 'HR@20': '0.1257', 'NDCG@20': '0.0548'}
2025-02-25 10:42:12,853 - EarlyStopping counter: 1 out of 10
2025-02-25 10:42:18,036 - {'epoch': 14, 'rec_loss': '5.6580'}
2025-02-25 10:42:18,697 - {'Epoch': 14, 'HR@5': '0.0486', 'NDCG@5': '0.0314', 'HR@10': '0.0899', 'NDCG@10': '0.0446', 'HR@20': '0.1275', 'NDCG@20': '0.0541'}
2025-02-25 10:42:18,698 - EarlyStopping counter: 2 out of 10
2025-02-25 10:42:23,778 - {'epoch': 15, 'rec_loss': '5.6198'}
2025-02-25 10:42:24,475 - {'Epoch': 15, 'HR@5': '0.0532', 'NDCG@5': '0.0357', 'HR@10': '0.0817', 'NDCG@10': '0.0448', 'HR@20': '0.1303', 'NDCG@20': '0.0572'}
2025-02-25 10:42:24,476 - Validation score increased.  Saving model ...
2025-02-25 10:42:29,499 - {'epoch': 16, 'rec_loss': '5.5791'}
2025-02-25 10:42:30,174 - {'Epoch': 16, 'HR@5': '0.0486', 'NDCG@5': '0.0331', 'HR@10': '0.0807', 'NDCG@10': '0.0436', 'HR@20': '0.1312', 'NDCG@20': '0.0564'}
2025-02-25 10:42:30,175 - EarlyStopping counter: 1 out of 10
2025-02-25 10:42:35,190 - {'epoch': 17, 'rec_loss': '5.5475'}
2025-02-25 10:42:35,881 - {'Epoch': 17, 'HR@5': '0.0523', 'NDCG@5': '0.0333', 'HR@10': '0.0872', 'NDCG@10': '0.0445', 'HR@20': '0.1404', 'NDCG@20': '0.0578'}
2025-02-25 10:42:35,882 - Validation score increased.  Saving model ...
2025-02-25 10:42:40,803 - {'epoch': 18, 'rec_loss': '5.5042'}
2025-02-25 10:42:41,523 - {'Epoch': 18, 'HR@5': '0.0486', 'NDCG@5': '0.0309', 'HR@10': '0.0844', 'NDCG@10': '0.0426', 'HR@20': '0.1385', 'NDCG@20': '0.0564'}
2025-02-25 10:42:41,524 - EarlyStopping counter: 1 out of 10
2025-02-25 10:42:46,729 - {'epoch': 19, 'rec_loss': '5.4697'}
2025-02-25 10:42:47,439 - {'Epoch': 19, 'HR@5': '0.0541', 'NDCG@5': '0.0332', 'HR@10': '0.0945', 'NDCG@10': '0.0461', 'HR@20': '0.1413', 'NDCG@20': '0.0579'}
2025-02-25 10:42:47,440 - Validation score increased.  Saving model ...
2025-02-25 10:42:52,381 - {'epoch': 20, 'rec_loss': '5.4523'}
2025-02-25 10:42:53,151 - {'Epoch': 20, 'HR@5': '0.0468', 'NDCG@5': '0.0311', 'HR@10': '0.0844', 'NDCG@10': '0.0433', 'HR@20': '0.1413', 'NDCG@20': '0.0577'}
2025-02-25 10:42:53,152 - EarlyStopping counter: 1 out of 10
2025-02-25 10:42:58,422 - {'epoch': 21, 'rec_loss': '5.4081'}
2025-02-25 10:42:59,099 - {'Epoch': 21, 'HR@5': '0.0486', 'NDCG@5': '0.0316', 'HR@10': '0.0936', 'NDCG@10': '0.0461', 'HR@20': '0.1394', 'NDCG@20': '0.0576'}
2025-02-25 10:42:59,100 - EarlyStopping counter: 2 out of 10
2025-02-25 10:43:04,079 - {'epoch': 22, 'rec_loss': '5.4107'}
2025-02-25 10:43:04,814 - {'Epoch': 22, 'HR@5': '0.0578', 'NDCG@5': '0.0366', 'HR@10': '0.0936', 'NDCG@10': '0.0480', 'HR@20': '0.1404', 'NDCG@20': '0.0596'}
2025-02-25 10:43:04,815 - Validation score increased.  Saving model ...
2025-02-25 10:43:09,614 - {'epoch': 23, 'rec_loss': '5.4042'}
2025-02-25 10:43:10,294 - {'Epoch': 23, 'HR@5': '0.0514', 'NDCG@5': '0.0339', 'HR@10': '0.0890', 'NDCG@10': '0.0463', 'HR@20': '0.1468', 'NDCG@20': '0.0609'}
2025-02-25 10:43:10,296 - Validation score increased.  Saving model ...
2025-02-25 10:43:15,699 - {'epoch': 24, 'rec_loss': '5.3621'}
2025-02-25 10:43:16,386 - {'Epoch': 24, 'HR@5': '0.0596', 'NDCG@5': '0.0380', 'HR@10': '0.0972', 'NDCG@10': '0.0499', 'HR@20': '0.1431', 'NDCG@20': '0.0613'}
2025-02-25 10:43:16,387 - Validation score increased.  Saving model ...
2025-02-25 10:43:21,713 - {'epoch': 25, 'rec_loss': '5.3411'}
2025-02-25 10:43:22,335 - {'Epoch': 25, 'HR@5': '0.0560', 'NDCG@5': '0.0348', 'HR@10': '0.0954', 'NDCG@10': '0.0474', 'HR@20': '0.1376', 'NDCG@20': '0.0579'}
2025-02-25 10:43:22,336 - EarlyStopping counter: 1 out of 10
2025-02-25 10:43:27,393 - {'epoch': 26, 'rec_loss': '5.3423'}
2025-02-25 10:43:28,127 - {'Epoch': 26, 'HR@5': '0.0541', 'NDCG@5': '0.0347', 'HR@10': '0.0908', 'NDCG@10': '0.0466', 'HR@20': '0.1440', 'NDCG@20': '0.0598'}
2025-02-25 10:43:28,128 - EarlyStopping counter: 2 out of 10
2025-02-25 10:43:32,811 - {'epoch': 27, 'rec_loss': '5.3328'}
2025-02-25 10:43:33,540 - {'Epoch': 27, 'HR@5': '0.0606', 'NDCG@5': '0.0377', 'HR@10': '0.0890', 'NDCG@10': '0.0467', 'HR@20': '0.1431', 'NDCG@20': '0.0603'}
2025-02-25 10:43:33,541 - EarlyStopping counter: 3 out of 10
2025-02-25 10:43:38,387 - {'epoch': 28, 'rec_loss': '5.3029'}
2025-02-25 10:43:39,093 - {'Epoch': 28, 'HR@5': '0.0532', 'NDCG@5': '0.0362', 'HR@10': '0.0927', 'NDCG@10': '0.0487', 'HR@20': '0.1440', 'NDCG@20': '0.0616'}
2025-02-25 10:43:39,094 - Validation score increased.  Saving model ...
2025-02-25 10:43:44,218 - {'epoch': 29, 'rec_loss': '5.2975'}
2025-02-25 10:43:44,862 - {'Epoch': 29, 'HR@5': '0.0550', 'NDCG@5': '0.0365', 'HR@10': '0.0908', 'NDCG@10': '0.0478', 'HR@20': '0.1486', 'NDCG@20': '0.0623'}
2025-02-25 10:43:44,863 - Validation score increased.  Saving model ...
2025-02-25 10:43:49,779 - {'epoch': 30, 'rec_loss': '5.2821'}
2025-02-25 10:43:50,511 - {'Epoch': 30, 'HR@5': '0.0550', 'NDCG@5': '0.0364', 'HR@10': '0.0881', 'NDCG@10': '0.0470', 'HR@20': '0.1431', 'NDCG@20': '0.0610'}
2025-02-25 10:43:50,512 - EarlyStopping counter: 1 out of 10
2025-02-25 10:43:55,414 - {'epoch': 31, 'rec_loss': '5.2663'}
2025-02-25 10:43:56,179 - {'Epoch': 31, 'HR@5': '0.0569', 'NDCG@5': '0.0375', 'HR@10': '0.0963', 'NDCG@10': '0.0500', 'HR@20': '0.1523', 'NDCG@20': '0.0641'}
2025-02-25 10:43:56,181 - Validation score increased.  Saving model ...
2025-02-25 10:44:01,413 - {'epoch': 32, 'rec_loss': '5.2613'}
2025-02-25 10:44:02,205 - {'Epoch': 32, 'HR@5': '0.0596', 'NDCG@5': '0.0378', 'HR@10': '0.0991', 'NDCG@10': '0.0505', 'HR@20': '0.1486', 'NDCG@20': '0.0629'}
2025-02-25 10:44:02,206 - EarlyStopping counter: 1 out of 10
2025-02-25 10:44:07,296 - {'epoch': 33, 'rec_loss': '5.2363'}
2025-02-25 10:44:08,055 - {'Epoch': 33, 'HR@5': '0.0606', 'NDCG@5': '0.0380', 'HR@10': '0.0954', 'NDCG@10': '0.0493', 'HR@20': '0.1459', 'NDCG@20': '0.0622'}
2025-02-25 10:44:08,056 - EarlyStopping counter: 2 out of 10
2025-02-25 10:44:13,160 - {'epoch': 34, 'rec_loss': '5.2307'}
2025-02-25 10:44:13,843 - {'Epoch': 34, 'HR@5': '0.0615', 'NDCG@5': '0.0393', 'HR@10': '0.0954', 'NDCG@10': '0.0502', 'HR@20': '0.1459', 'NDCG@20': '0.0631'}
2025-02-25 10:44:13,845 - EarlyStopping counter: 3 out of 10
2025-02-25 10:44:18,721 - {'epoch': 35, 'rec_loss': '5.2132'}
2025-02-25 10:44:19,424 - {'Epoch': 35, 'HR@5': '0.0661', 'NDCG@5': '0.0418', 'HR@10': '0.1009', 'NDCG@10': '0.0528', 'HR@20': '0.1495', 'NDCG@20': '0.0650'}
2025-02-25 10:44:19,425 - Validation score increased.  Saving model ...
2025-02-25 10:44:24,416 - {'epoch': 36, 'rec_loss': '5.1994'}
2025-02-25 10:44:25,104 - {'Epoch': 36, 'HR@5': '0.0587', 'NDCG@5': '0.0380', 'HR@10': '0.0972', 'NDCG@10': '0.0502', 'HR@20': '0.1505', 'NDCG@20': '0.0636'}
2025-02-25 10:44:25,105 - EarlyStopping counter: 1 out of 10
2025-02-25 10:44:30,139 - {'epoch': 37, 'rec_loss': '5.1988'}
2025-02-25 10:44:30,838 - {'Epoch': 37, 'HR@5': '0.0578', 'NDCG@5': '0.0362', 'HR@10': '0.0972', 'NDCG@10': '0.0490', 'HR@20': '0.1505', 'NDCG@20': '0.0624'}
2025-02-25 10:44:30,839 - EarlyStopping counter: 2 out of 10
2025-02-25 10:44:35,923 - {'epoch': 38, 'rec_loss': '5.2060'}
2025-02-25 10:44:36,561 - {'Epoch': 38, 'HR@5': '0.0569', 'NDCG@5': '0.0384', 'HR@10': '0.0982', 'NDCG@10': '0.0517', 'HR@20': '0.1541', 'NDCG@20': '0.0658'}
2025-02-25 10:44:36,562 - Validation score increased.  Saving model ...
2025-02-25 10:44:41,495 - {'epoch': 39, 'rec_loss': '5.2047'}
2025-02-25 10:44:42,166 - {'Epoch': 39, 'HR@5': '0.0550', 'NDCG@5': '0.0350', 'HR@10': '0.0945', 'NDCG@10': '0.0476', 'HR@20': '0.1578', 'NDCG@20': '0.0636'}
2025-02-25 10:44:42,167 - EarlyStopping counter: 1 out of 10
2025-02-25 10:44:47,250 - {'epoch': 40, 'rec_loss': '5.1514'}
2025-02-25 10:44:47,897 - {'Epoch': 40, 'HR@5': '0.0606', 'NDCG@5': '0.0386', 'HR@10': '0.1018', 'NDCG@10': '0.0519', 'HR@20': '0.1505', 'NDCG@20': '0.0640'}
2025-02-25 10:44:47,898 - EarlyStopping counter: 2 out of 10
2025-02-25 10:44:52,939 - {'epoch': 41, 'rec_loss': '5.1704'}
2025-02-25 10:44:53,656 - {'Epoch': 41, 'HR@5': '0.0596', 'NDCG@5': '0.0388', 'HR@10': '0.1000', 'NDCG@10': '0.0519', 'HR@20': '0.1505', 'NDCG@20': '0.0644'}
2025-02-25 10:44:53,657 - EarlyStopping counter: 3 out of 10
2025-02-25 10:44:58,618 - {'epoch': 42, 'rec_loss': '5.1750'}
2025-02-25 10:44:59,299 - {'Epoch': 42, 'HR@5': '0.0642', 'NDCG@5': '0.0413', 'HR@10': '0.0945', 'NDCG@10': '0.0510', 'HR@20': '0.1459', 'NDCG@20': '0.0641'}
2025-02-25 10:44:59,301 - EarlyStopping counter: 4 out of 10
2025-02-25 10:45:04,669 - {'epoch': 43, 'rec_loss': '5.1345'}
2025-02-25 10:45:05,350 - {'Epoch': 43, 'HR@5': '0.0606', 'NDCG@5': '0.0384', 'HR@10': '0.0936', 'NDCG@10': '0.0490', 'HR@20': '0.1514', 'NDCG@20': '0.0637'}
2025-02-25 10:45:05,352 - EarlyStopping counter: 5 out of 10
2025-02-25 10:45:10,092 - {'epoch': 44, 'rec_loss': '5.1449'}
2025-02-25 10:45:10,749 - {'Epoch': 44, 'HR@5': '0.0615', 'NDCG@5': '0.0406', 'HR@10': '0.0963', 'NDCG@10': '0.0518', 'HR@20': '0.1495', 'NDCG@20': '0.0652'}
2025-02-25 10:45:10,750 - EarlyStopping counter: 6 out of 10
2025-02-25 10:45:15,996 - {'epoch': 45, 'rec_loss': '5.1397'}
2025-02-25 10:45:16,652 - {'Epoch': 45, 'HR@5': '0.0596', 'NDCG@5': '0.0398', 'HR@10': '0.0954', 'NDCG@10': '0.0512', 'HR@20': '0.1505', 'NDCG@20': '0.0650'}
2025-02-25 10:45:16,653 - EarlyStopping counter: 7 out of 10
2025-02-25 10:45:22,008 - {'epoch': 46, 'rec_loss': '5.1360'}
2025-02-25 10:45:22,666 - {'Epoch': 46, 'HR@5': '0.0688', 'NDCG@5': '0.0404', 'HR@10': '0.0982', 'NDCG@10': '0.0498', 'HR@20': '0.1532', 'NDCG@20': '0.0637'}
2025-02-25 10:45:22,667 - EarlyStopping counter: 8 out of 10
2025-02-25 10:45:27,800 - {'epoch': 47, 'rec_loss': '5.1213'}
2025-02-25 10:45:28,491 - {'Epoch': 47, 'HR@5': '0.0633', 'NDCG@5': '0.0383', 'HR@10': '0.0982', 'NDCG@10': '0.0495', 'HR@20': '0.1523', 'NDCG@20': '0.0630'}
2025-02-25 10:45:28,492 - EarlyStopping counter: 9 out of 10
2025-02-25 10:45:33,536 - {'epoch': 48, 'rec_loss': '5.1296'}
2025-02-25 10:45:34,236 - {'Epoch': 48, 'HR@5': '0.0596', 'NDCG@5': '0.0384', 'HR@10': '0.0991', 'NDCG@10': '0.0514', 'HR@20': '0.1550', 'NDCG@20': '0.0654'}
2025-02-25 10:45:34,237 - EarlyStopping counter: 10 out of 10
2025-02-25 10:45:34,238 - Early stopping
2025-02-25 10:45:34,238 - ---------------Test Score---------------
2025-02-25 10:45:34,876 - {'Epoch': 0, 'HR@5': '0.0587', 'NDCG@5': '0.0387', 'HR@10': '0.0725', 'NDCG@10': '0.0430', 'HR@20': '0.1064', 'NDCG@20': '0.0515'}
2025-02-25 10:45:34,877 - Scale_LastFM
2025-02-25 10:45:34,877 - {'Epoch': 0, 'HR@5': '0.0587', 'NDCG@5': '0.0387', 'HR@10': '0.0725', 'NDCG@10': '0.0430', 'HR@20': '0.1064', 'NDCG@20': '0.0515'}
2025-02-25 10:47:21,494 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[4, 8, 12], start_prob=0.1, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-25 10:47:24,277 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-25 10:47:24,280 - Total Parameters: 387350
2025-02-25 10:47:30,119 - {'epoch': 0, 'rec_loss': '8.0370'}
2025-02-25 10:47:30,808 - {'Epoch': 0, 'HR@5': '0.0202', 'NDCG@5': '0.0142', 'HR@10': '0.0330', 'NDCG@10': '0.0183', 'HR@20': '0.0624', 'NDCG@20': '0.0257'}
2025-02-25 10:47:30,809 - Validation score increased.  Saving model ...
2025-02-25 10:47:35,856 - {'epoch': 1, 'rec_loss': '7.7461'}
2025-02-25 10:47:36,579 - {'Epoch': 1, 'HR@5': '0.0202', 'NDCG@5': '0.0141', 'HR@10': '0.0339', 'NDCG@10': '0.0187', 'HR@20': '0.0615', 'NDCG@20': '0.0256'}
2025-02-25 10:47:36,580 - EarlyStopping counter: 1 out of 10
2025-02-25 10:47:41,571 - {'epoch': 2, 'rec_loss': '7.5214'}
2025-02-25 10:47:42,260 - {'Epoch': 2, 'HR@5': '0.0312', 'NDCG@5': '0.0198', 'HR@10': '0.0477', 'NDCG@10': '0.0251', 'HR@20': '0.0697', 'NDCG@20': '0.0306'}
2025-02-25 10:47:42,261 - Validation score increased.  Saving model ...
2025-02-25 10:47:47,135 - {'epoch': 3, 'rec_loss': '7.2803'}
2025-02-25 10:47:47,845 - {'Epoch': 3, 'HR@5': '0.0349', 'NDCG@5': '0.0230', 'HR@10': '0.0477', 'NDCG@10': '0.0271', 'HR@20': '0.0761', 'NDCG@20': '0.0342'}
2025-02-25 10:47:47,847 - Validation score increased.  Saving model ...
2025-02-25 10:47:52,707 - {'epoch': 4, 'rec_loss': '7.0488'}
2025-02-25 10:47:53,494 - {'Epoch': 4, 'HR@5': '0.0358', 'NDCG@5': '0.0248', 'HR@10': '0.0569', 'NDCG@10': '0.0316', 'HR@20': '0.0899', 'NDCG@20': '0.0401'}
2025-02-25 10:47:53,495 - Validation score increased.  Saving model ...
2025-02-25 10:47:58,369 - {'epoch': 5, 'rec_loss': '6.8275'}
2025-02-25 10:47:58,991 - {'Epoch': 5, 'HR@5': '0.0413', 'NDCG@5': '0.0268', 'HR@10': '0.0606', 'NDCG@10': '0.0330', 'HR@20': '0.0899', 'NDCG@20': '0.0403'}
2025-02-25 10:47:58,992 - Validation score increased.  Saving model ...
2025-02-25 10:48:04,010 - {'epoch': 6, 'rec_loss': '6.6171'}
2025-02-25 10:48:04,680 - {'Epoch': 6, 'HR@5': '0.0440', 'NDCG@5': '0.0258', 'HR@10': '0.0697', 'NDCG@10': '0.0342', 'HR@20': '0.0982', 'NDCG@20': '0.0413'}
2025-02-25 10:48:04,681 - Validation score increased.  Saving model ...
2025-02-25 10:48:10,323 - {'epoch': 7, 'rec_loss': '6.4329'}
2025-02-25 10:48:10,982 - {'Epoch': 7, 'HR@5': '0.0459', 'NDCG@5': '0.0288', 'HR@10': '0.0670', 'NDCG@10': '0.0355', 'HR@20': '0.1037', 'NDCG@20': '0.0447'}
2025-02-25 10:48:10,983 - Validation score increased.  Saving model ...
2025-02-25 10:48:16,009 - {'epoch': 8, 'rec_loss': '6.2672'}
2025-02-25 10:48:16,673 - {'Epoch': 8, 'HR@5': '0.0440', 'NDCG@5': '0.0284', 'HR@10': '0.0688', 'NDCG@10': '0.0362', 'HR@20': '0.1110', 'NDCG@20': '0.0469'}
2025-02-25 10:48:16,674 - Validation score increased.  Saving model ...
2025-02-25 10:48:21,702 - {'epoch': 9, 'rec_loss': '6.1497'}
2025-02-25 10:48:22,393 - {'Epoch': 9, 'HR@5': '0.0505', 'NDCG@5': '0.0309', 'HR@10': '0.0780', 'NDCG@10': '0.0396', 'HR@20': '0.1202', 'NDCG@20': '0.0503'}
2025-02-25 10:48:22,394 - Validation score increased.  Saving model ...
2025-02-25 10:48:27,203 - {'epoch': 10, 'rec_loss': '6.0115'}
2025-02-25 10:48:27,925 - {'Epoch': 10, 'HR@5': '0.0486', 'NDCG@5': '0.0316', 'HR@10': '0.0780', 'NDCG@10': '0.0410', 'HR@20': '0.1119', 'NDCG@20': '0.0494'}
2025-02-25 10:48:27,926 - EarlyStopping counter: 1 out of 10
2025-02-25 10:48:32,712 - {'epoch': 11, 'rec_loss': '5.9434'}
2025-02-25 10:48:33,438 - {'Epoch': 11, 'HR@5': '0.0486', 'NDCG@5': '0.0328', 'HR@10': '0.0716', 'NDCG@10': '0.0402', 'HR@20': '0.1183', 'NDCG@20': '0.0520'}
2025-02-25 10:48:33,439 - Validation score increased.  Saving model ...
2025-02-25 10:48:38,554 - {'epoch': 12, 'rec_loss': '5.8531'}
2025-02-25 10:48:39,233 - {'Epoch': 12, 'HR@5': '0.0440', 'NDCG@5': '0.0315', 'HR@10': '0.0752', 'NDCG@10': '0.0415', 'HR@20': '0.1193', 'NDCG@20': '0.0527'}
2025-02-25 10:48:39,234 - Validation score increased.  Saving model ...
2025-02-25 10:48:44,032 - {'epoch': 13, 'rec_loss': '5.7782'}
2025-02-25 10:48:44,733 - {'Epoch': 13, 'HR@5': '0.0477', 'NDCG@5': '0.0320', 'HR@10': '0.0761', 'NDCG@10': '0.0410', 'HR@20': '0.1248', 'NDCG@20': '0.0534'}
2025-02-25 10:48:44,734 - Validation score increased.  Saving model ...
2025-02-25 10:48:49,688 - {'epoch': 14, 'rec_loss': '5.7174'}
2025-02-25 10:48:50,353 - {'Epoch': 14, 'HR@5': '0.0486', 'NDCG@5': '0.0313', 'HR@10': '0.0807', 'NDCG@10': '0.0417', 'HR@20': '0.1220', 'NDCG@20': '0.0522'}
2025-02-25 10:48:50,354 - EarlyStopping counter: 1 out of 10
2025-02-25 10:48:55,163 - {'epoch': 15, 'rec_loss': '5.6768'}
2025-02-25 10:48:55,849 - {'Epoch': 15, 'HR@5': '0.0523', 'NDCG@5': '0.0346', 'HR@10': '0.0789', 'NDCG@10': '0.0432', 'HR@20': '0.1257', 'NDCG@20': '0.0549'}
2025-02-25 10:48:55,850 - Validation score increased.  Saving model ...
2025-02-25 10:49:00,917 - {'epoch': 16, 'rec_loss': '5.6360'}
2025-02-25 10:49:01,611 - {'Epoch': 16, 'HR@5': '0.0505', 'NDCG@5': '0.0341', 'HR@10': '0.0761', 'NDCG@10': '0.0424', 'HR@20': '0.1239', 'NDCG@20': '0.0545'}
2025-02-25 10:49:01,612 - EarlyStopping counter: 1 out of 10
2025-02-25 10:49:06,515 - {'epoch': 17, 'rec_loss': '5.6008'}
2025-02-25 10:49:07,195 - {'Epoch': 17, 'HR@5': '0.0486', 'NDCG@5': '0.0326', 'HR@10': '0.0844', 'NDCG@10': '0.0441', 'HR@20': '0.1367', 'NDCG@20': '0.0572'}
2025-02-25 10:49:07,196 - Validation score increased.  Saving model ...
2025-02-25 10:49:12,276 - {'epoch': 18, 'rec_loss': '5.5533'}
2025-02-25 10:49:12,917 - {'Epoch': 18, 'HR@5': '0.0459', 'NDCG@5': '0.0301', 'HR@10': '0.0798', 'NDCG@10': '0.0412', 'HR@20': '0.1367', 'NDCG@20': '0.0555'}
2025-02-25 10:49:12,918 - EarlyStopping counter: 1 out of 10
2025-02-25 10:49:18,005 - {'epoch': 19, 'rec_loss': '5.5166'}
2025-02-25 10:49:18,699 - {'Epoch': 19, 'HR@5': '0.0505', 'NDCG@5': '0.0324', 'HR@10': '0.0890', 'NDCG@10': '0.0449', 'HR@20': '0.1367', 'NDCG@20': '0.0568'}
2025-02-25 10:49:18,700 - EarlyStopping counter: 2 out of 10
2025-02-25 10:49:23,785 - {'epoch': 20, 'rec_loss': '5.4974'}
2025-02-25 10:49:24,485 - {'Epoch': 20, 'HR@5': '0.0477', 'NDCG@5': '0.0323', 'HR@10': '0.0844', 'NDCG@10': '0.0440', 'HR@20': '0.1349', 'NDCG@20': '0.0568'}
2025-02-25 10:49:24,486 - EarlyStopping counter: 3 out of 10
2025-02-25 10:49:29,272 - {'epoch': 21, 'rec_loss': '5.4584'}
2025-02-25 10:49:29,969 - {'Epoch': 21, 'HR@5': '0.0505', 'NDCG@5': '0.0335', 'HR@10': '0.0908', 'NDCG@10': '0.0463', 'HR@20': '0.1376', 'NDCG@20': '0.0582'}
2025-02-25 10:49:29,970 - Validation score increased.  Saving model ...
2025-02-25 10:49:35,082 - {'epoch': 22, 'rec_loss': '5.4523'}
2025-02-25 10:49:35,775 - {'Epoch': 22, 'HR@5': '0.0569', 'NDCG@5': '0.0372', 'HR@10': '0.0890', 'NDCG@10': '0.0474', 'HR@20': '0.1404', 'NDCG@20': '0.0602'}
2025-02-25 10:49:35,776 - Validation score increased.  Saving model ...
2025-02-25 10:49:40,917 - {'epoch': 23, 'rec_loss': '5.4454'}
2025-02-25 10:49:41,575 - {'Epoch': 23, 'HR@5': '0.0578', 'NDCG@5': '0.0366', 'HR@10': '0.0908', 'NDCG@10': '0.0472', 'HR@20': '0.1394', 'NDCG@20': '0.0596'}
2025-02-25 10:49:41,576 - EarlyStopping counter: 1 out of 10
2025-02-25 10:49:46,669 - {'epoch': 24, 'rec_loss': '5.4044'}
2025-02-25 10:49:47,361 - {'Epoch': 24, 'HR@5': '0.0596', 'NDCG@5': '0.0378', 'HR@10': '0.0991', 'NDCG@10': '0.0505', 'HR@20': '0.1349', 'NDCG@20': '0.0595'}
2025-02-25 10:49:47,362 - EarlyStopping counter: 2 out of 10
2025-02-25 10:49:52,453 - {'epoch': 25, 'rec_loss': '5.3794'}
2025-02-25 10:49:53,123 - {'Epoch': 25, 'HR@5': '0.0578', 'NDCG@5': '0.0358', 'HR@10': '0.0872', 'NDCG@10': '0.0451', 'HR@20': '0.1422', 'NDCG@20': '0.0591'}
2025-02-25 10:49:53,124 - EarlyStopping counter: 3 out of 10
2025-02-25 10:49:57,784 - {'epoch': 26, 'rec_loss': '5.3860'}
2025-02-25 10:49:58,531 - {'Epoch': 26, 'HR@5': '0.0550', 'NDCG@5': '0.0353', 'HR@10': '0.0917', 'NDCG@10': '0.0471', 'HR@20': '0.1431', 'NDCG@20': '0.0599'}
2025-02-25 10:49:58,533 - EarlyStopping counter: 4 out of 10
2025-02-25 10:50:03,450 - {'epoch': 27, 'rec_loss': '5.3765'}
2025-02-25 10:50:04,157 - {'Epoch': 27, 'HR@5': '0.0560', 'NDCG@5': '0.0364', 'HR@10': '0.0917', 'NDCG@10': '0.0477', 'HR@20': '0.1422', 'NDCG@20': '0.0605'}
2025-02-25 10:50:04,158 - Validation score increased.  Saving model ...
2025-02-25 10:50:09,949 - {'epoch': 28, 'rec_loss': '5.3481'}
2025-02-25 10:50:10,645 - {'Epoch': 28, 'HR@5': '0.0606', 'NDCG@5': '0.0380', 'HR@10': '0.0927', 'NDCG@10': '0.0481', 'HR@20': '0.1450', 'NDCG@20': '0.0613'}
2025-02-25 10:50:10,646 - Validation score increased.  Saving model ...
2025-02-25 10:50:15,639 - {'epoch': 29, 'rec_loss': '5.3378'}
2025-02-25 10:50:16,323 - {'Epoch': 29, 'HR@5': '0.0560', 'NDCG@5': '0.0377', 'HR@10': '0.0936', 'NDCG@10': '0.0495', 'HR@20': '0.1450', 'NDCG@20': '0.0625'}
2025-02-25 10:50:16,324 - Validation score increased.  Saving model ...
2025-02-25 10:50:21,446 - {'epoch': 30, 'rec_loss': '5.3237'}
2025-02-25 10:50:22,201 - {'Epoch': 30, 'HR@5': '0.0541', 'NDCG@5': '0.0372', 'HR@10': '0.0917', 'NDCG@10': '0.0493', 'HR@20': '0.1450', 'NDCG@20': '0.0627'}
2025-02-25 10:50:22,202 - Validation score increased.  Saving model ...
2025-02-25 10:50:27,231 - {'epoch': 31, 'rec_loss': '5.3114'}
2025-02-25 10:50:27,884 - {'Epoch': 31, 'HR@5': '0.0596', 'NDCG@5': '0.0400', 'HR@10': '0.0991', 'NDCG@10': '0.0526', 'HR@20': '0.1440', 'NDCG@20': '0.0638'}
2025-02-25 10:50:27,885 - Validation score increased.  Saving model ...
2025-02-25 10:50:32,930 - {'epoch': 32, 'rec_loss': '5.3062'}
2025-02-25 10:50:33,623 - {'Epoch': 32, 'HR@5': '0.0569', 'NDCG@5': '0.0357', 'HR@10': '0.0945', 'NDCG@10': '0.0477', 'HR@20': '0.1431', 'NDCG@20': '0.0600'}
2025-02-25 10:50:33,624 - EarlyStopping counter: 1 out of 10
2025-02-25 10:50:38,734 - {'epoch': 33, 'rec_loss': '5.2750'}
2025-02-25 10:50:39,360 - {'Epoch': 33, 'HR@5': '0.0633', 'NDCG@5': '0.0385', 'HR@10': '0.0972', 'NDCG@10': '0.0493', 'HR@20': '0.1450', 'NDCG@20': '0.0615'}
2025-02-25 10:50:39,361 - EarlyStopping counter: 2 out of 10
2025-02-25 10:50:44,293 - {'epoch': 34, 'rec_loss': '5.2699'}
2025-02-25 10:50:45,034 - {'Epoch': 34, 'HR@5': '0.0624', 'NDCG@5': '0.0399', 'HR@10': '0.1009', 'NDCG@10': '0.0522', 'HR@20': '0.1468', 'NDCG@20': '0.0637'}
2025-02-25 10:50:45,035 - EarlyStopping counter: 3 out of 10
2025-02-25 10:50:50,300 - {'epoch': 35, 'rec_loss': '5.2439'}
2025-02-25 10:50:51,009 - {'Epoch': 35, 'HR@5': '0.0679', 'NDCG@5': '0.0435', 'HR@10': '0.0982', 'NDCG@10': '0.0530', 'HR@20': '0.1422', 'NDCG@20': '0.0642'}
2025-02-25 10:50:51,010 - Validation score increased.  Saving model ...
2025-02-25 10:50:56,104 - {'epoch': 36, 'rec_loss': '5.2408'}
2025-02-25 10:50:56,776 - {'Epoch': 36, 'HR@5': '0.0633', 'NDCG@5': '0.0398', 'HR@10': '0.0899', 'NDCG@10': '0.0486', 'HR@20': '0.1486', 'NDCG@20': '0.0635'}
2025-02-25 10:50:56,777 - EarlyStopping counter: 1 out of 10
2025-02-25 10:51:01,620 - {'epoch': 37, 'rec_loss': '5.2430'}
2025-02-25 10:51:02,258 - {'Epoch': 37, 'HR@5': '0.0624', 'NDCG@5': '0.0388', 'HR@10': '0.0917', 'NDCG@10': '0.0482', 'HR@20': '0.1514', 'NDCG@20': '0.0632'}
2025-02-25 10:51:02,260 - EarlyStopping counter: 2 out of 10
2025-02-25 10:51:07,374 - {'epoch': 38, 'rec_loss': '5.2431'}
2025-02-25 10:51:08,063 - {'Epoch': 38, 'HR@5': '0.0578', 'NDCG@5': '0.0389', 'HR@10': '0.0945', 'NDCG@10': '0.0507', 'HR@20': '0.1541', 'NDCG@20': '0.0655'}
2025-02-25 10:51:08,064 - Validation score increased.  Saving model ...
2025-02-25 10:51:13,162 - {'epoch': 39, 'rec_loss': '5.2425'}
2025-02-25 10:51:13,835 - {'Epoch': 39, 'HR@5': '0.0606', 'NDCG@5': '0.0366', 'HR@10': '0.0954', 'NDCG@10': '0.0477', 'HR@20': '0.1431', 'NDCG@20': '0.0599'}
2025-02-25 10:51:13,837 - EarlyStopping counter: 1 out of 10
2025-02-25 10:51:18,887 - {'epoch': 40, 'rec_loss': '5.1941'}
2025-02-25 10:51:19,514 - {'Epoch': 40, 'HR@5': '0.0651', 'NDCG@5': '0.0412', 'HR@10': '0.1000', 'NDCG@10': '0.0523', 'HR@20': '0.1422', 'NDCG@20': '0.0629'}
2025-02-25 10:51:19,515 - EarlyStopping counter: 2 out of 10
2025-02-25 10:51:24,478 - {'epoch': 41, 'rec_loss': '5.2087'}
2025-02-25 10:51:25,181 - {'Epoch': 41, 'HR@5': '0.0624', 'NDCG@5': '0.0400', 'HR@10': '0.0972', 'NDCG@10': '0.0513', 'HR@20': '0.1440', 'NDCG@20': '0.0632'}
2025-02-25 10:51:25,182 - EarlyStopping counter: 3 out of 10
2025-02-25 10:51:30,316 - {'epoch': 42, 'rec_loss': '5.2065'}
2025-02-25 10:51:30,953 - {'Epoch': 42, 'HR@5': '0.0651', 'NDCG@5': '0.0414', 'HR@10': '0.1009', 'NDCG@10': '0.0528', 'HR@20': '0.1459', 'NDCG@20': '0.0641'}
2025-02-25 10:51:30,954 - EarlyStopping counter: 4 out of 10
2025-02-25 10:51:35,843 - {'epoch': 43, 'rec_loss': '5.1719'}
2025-02-25 10:51:36,584 - {'Epoch': 43, 'HR@5': '0.0624', 'NDCG@5': '0.0406', 'HR@10': '0.0982', 'NDCG@10': '0.0519', 'HR@20': '0.1486', 'NDCG@20': '0.0647'}
2025-02-25 10:51:36,586 - EarlyStopping counter: 5 out of 10
2025-02-25 10:51:41,708 - {'epoch': 44, 'rec_loss': '5.1864'}
2025-02-25 10:51:42,449 - {'Epoch': 44, 'HR@5': '0.0606', 'NDCG@5': '0.0406', 'HR@10': '0.0991', 'NDCG@10': '0.0529', 'HR@20': '0.1431', 'NDCG@20': '0.0639'}
2025-02-25 10:51:42,450 - EarlyStopping counter: 6 out of 10
2025-02-25 10:51:47,661 - {'epoch': 45, 'rec_loss': '5.1723'}
2025-02-25 10:51:48,286 - {'Epoch': 45, 'HR@5': '0.0615', 'NDCG@5': '0.0409', 'HR@10': '0.0982', 'NDCG@10': '0.0526', 'HR@20': '0.1486', 'NDCG@20': '0.0652'}
2025-02-25 10:51:48,288 - EarlyStopping counter: 7 out of 10
2025-02-25 10:51:53,163 - {'epoch': 46, 'rec_loss': '5.1641'}
2025-02-25 10:51:53,866 - {'Epoch': 46, 'HR@5': '0.0633', 'NDCG@5': '0.0398', 'HR@10': '0.1000', 'NDCG@10': '0.0517', 'HR@20': '0.1541', 'NDCG@20': '0.0653'}
2025-02-25 10:51:53,867 - EarlyStopping counter: 8 out of 10
2025-02-25 10:51:58,925 - {'epoch': 47, 'rec_loss': '5.1528'}
2025-02-25 10:51:59,579 - {'Epoch': 47, 'HR@5': '0.0642', 'NDCG@5': '0.0407', 'HR@10': '0.0963', 'NDCG@10': '0.0510', 'HR@20': '0.1477', 'NDCG@20': '0.0640'}
2025-02-25 10:51:59,581 - EarlyStopping counter: 9 out of 10
2025-02-25 10:52:04,546 - {'epoch': 48, 'rec_loss': '5.1665'}
2025-02-25 10:52:05,246 - {'Epoch': 48, 'HR@5': '0.0670', 'NDCG@5': '0.0416', 'HR@10': '0.0991', 'NDCG@10': '0.0519', 'HR@20': '0.1477', 'NDCG@20': '0.0643'}
2025-02-25 10:52:05,247 - EarlyStopping counter: 10 out of 10
2025-02-25 10:52:05,247 - Early stopping
2025-02-25 10:52:05,247 - ---------------Test Score---------------
2025-02-25 10:52:05,874 - {'Epoch': 0, 'HR@5': '0.0560', 'NDCG@5': '0.0372', 'HR@10': '0.0706', 'NDCG@10': '0.0419', 'HR@20': '0.1064', 'NDCG@20': '0.0509'}
2025-02-25 10:52:05,876 - Scale_LastFM
2025-02-25 10:52:05,876 - {'Epoch': 0, 'HR@5': '0.0560', 'NDCG@5': '0.0372', 'HR@10': '0.0706', 'NDCG@10': '0.0419', 'HR@20': '0.1064', 'NDCG@20': '0.0509'}
2025-02-25 10:54:14,305 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.4, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-25 10:54:17,196 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-25 10:54:17,200 - Total Parameters: 387350
2025-02-25 10:54:23,100 - {'epoch': 0, 'rec_loss': '8.0360'}
2025-02-25 10:54:23,846 - {'Epoch': 0, 'HR@5': '0.0202', 'NDCG@5': '0.0142', 'HR@10': '0.0330', 'NDCG@10': '0.0183', 'HR@20': '0.0633', 'NDCG@20': '0.0259'}
2025-02-25 10:54:23,847 - Validation score increased.  Saving model ...
2025-02-25 10:54:28,878 - {'epoch': 1, 'rec_loss': '7.7477'}
2025-02-25 10:54:29,572 - {'Epoch': 1, 'HR@5': '0.0202', 'NDCG@5': '0.0138', 'HR@10': '0.0349', 'NDCG@10': '0.0186', 'HR@20': '0.0587', 'NDCG@20': '0.0246'}
2025-02-25 10:54:29,573 - EarlyStopping counter: 1 out of 10
2025-02-25 10:54:34,583 - {'epoch': 2, 'rec_loss': '7.5265'}
2025-02-25 10:54:35,311 - {'Epoch': 2, 'HR@5': '0.0312', 'NDCG@5': '0.0206', 'HR@10': '0.0486', 'NDCG@10': '0.0263', 'HR@20': '0.0679', 'NDCG@20': '0.0312'}
2025-02-25 10:54:35,312 - Validation score increased.  Saving model ...
2025-02-25 10:54:40,397 - {'epoch': 3, 'rec_loss': '7.2842'}
2025-02-25 10:54:41,162 - {'Epoch': 3, 'HR@5': '0.0303', 'NDCG@5': '0.0207', 'HR@10': '0.0486', 'NDCG@10': '0.0266', 'HR@20': '0.0743', 'NDCG@20': '0.0330'}
2025-02-25 10:54:41,163 - Validation score increased.  Saving model ...
2025-02-25 10:54:46,639 - {'epoch': 4, 'rec_loss': '7.0583'}
2025-02-25 10:54:47,373 - {'Epoch': 4, 'HR@5': '0.0358', 'NDCG@5': '0.0250', 'HR@10': '0.0560', 'NDCG@10': '0.0315', 'HR@20': '0.0899', 'NDCG@20': '0.0402'}
2025-02-25 10:54:47,374 - Validation score increased.  Saving model ...
2025-02-25 10:54:52,059 - {'epoch': 5, 'rec_loss': '6.8386'}
2025-02-25 10:54:52,799 - {'Epoch': 5, 'HR@5': '0.0376', 'NDCG@5': '0.0259', 'HR@10': '0.0596', 'NDCG@10': '0.0330', 'HR@20': '0.0936', 'NDCG@20': '0.0414'}
2025-02-25 10:54:52,800 - Validation score increased.  Saving model ...
2025-02-25 10:54:57,635 - {'epoch': 6, 'rec_loss': '6.6319'}
2025-02-25 10:54:58,399 - {'Epoch': 6, 'HR@5': '0.0459', 'NDCG@5': '0.0266', 'HR@10': '0.0679', 'NDCG@10': '0.0335', 'HR@20': '0.0954', 'NDCG@20': '0.0404'}
2025-02-25 10:54:58,400 - EarlyStopping counter: 1 out of 10
2025-02-25 10:55:03,184 - {'epoch': 7, 'rec_loss': '6.4490'}
2025-02-25 10:55:03,947 - {'Epoch': 7, 'HR@5': '0.0459', 'NDCG@5': '0.0277', 'HR@10': '0.0716', 'NDCG@10': '0.0357', 'HR@20': '0.1055', 'NDCG@20': '0.0441'}
2025-02-25 10:55:03,948 - Validation score increased.  Saving model ...
2025-02-25 10:55:08,764 - {'epoch': 8, 'rec_loss': '6.2867'}
2025-02-25 10:55:09,512 - {'Epoch': 8, 'HR@5': '0.0459', 'NDCG@5': '0.0284', 'HR@10': '0.0688', 'NDCG@10': '0.0357', 'HR@20': '0.1073', 'NDCG@20': '0.0454'}
2025-02-25 10:55:09,513 - Validation score increased.  Saving model ...
2025-02-25 10:55:14,338 - {'epoch': 9, 'rec_loss': '6.1660'}
2025-02-25 10:55:15,048 - {'Epoch': 9, 'HR@5': '0.0514', 'NDCG@5': '0.0306', 'HR@10': '0.0807', 'NDCG@10': '0.0400', 'HR@20': '0.1165', 'NDCG@20': '0.0490'}
2025-02-25 10:55:15,049 - Validation score increased.  Saving model ...
2025-02-25 10:55:19,850 - {'epoch': 10, 'rec_loss': '6.0282'}
2025-02-25 10:55:20,573 - {'Epoch': 10, 'HR@5': '0.0505', 'NDCG@5': '0.0333', 'HR@10': '0.0761', 'NDCG@10': '0.0414', 'HR@20': '0.1110', 'NDCG@20': '0.0502'}
2025-02-25 10:55:20,575 - Validation score increased.  Saving model ...
2025-02-25 10:55:25,404 - {'epoch': 11, 'rec_loss': '5.9611'}
2025-02-25 10:55:26,140 - {'Epoch': 11, 'HR@5': '0.0505', 'NDCG@5': '0.0336', 'HR@10': '0.0743', 'NDCG@10': '0.0411', 'HR@20': '0.1165', 'NDCG@20': '0.0518'}
2025-02-25 10:55:26,141 - Validation score increased.  Saving model ...
2025-02-25 10:55:31,271 - {'epoch': 12, 'rec_loss': '5.8700'}
2025-02-25 10:55:32,007 - {'Epoch': 12, 'HR@5': '0.0431', 'NDCG@5': '0.0313', 'HR@10': '0.0798', 'NDCG@10': '0.0431', 'HR@20': '0.1284', 'NDCG@20': '0.0552'}
2025-02-25 10:55:32,008 - Validation score increased.  Saving model ...
2025-02-25 10:55:37,048 - {'epoch': 13, 'rec_loss': '5.7907'}
2025-02-25 10:55:37,824 - {'Epoch': 13, 'HR@5': '0.0468', 'NDCG@5': '0.0332', 'HR@10': '0.0807', 'NDCG@10': '0.0441', 'HR@20': '0.1257', 'NDCG@20': '0.0555'}
2025-02-25 10:55:37,826 - Validation score increased.  Saving model ...
2025-02-25 10:55:42,918 - {'epoch': 14, 'rec_loss': '5.7313'}
2025-02-25 10:55:43,679 - {'Epoch': 14, 'HR@5': '0.0459', 'NDCG@5': '0.0300', 'HR@10': '0.0853', 'NDCG@10': '0.0427', 'HR@20': '0.1239', 'NDCG@20': '0.0524'}
2025-02-25 10:55:43,681 - EarlyStopping counter: 1 out of 10
2025-02-25 10:55:48,338 - {'epoch': 15, 'rec_loss': '5.6942'}
2025-02-25 10:55:49,100 - {'Epoch': 15, 'HR@5': '0.0532', 'NDCG@5': '0.0361', 'HR@10': '0.0853', 'NDCG@10': '0.0464', 'HR@20': '0.1239', 'NDCG@20': '0.0562'}
2025-02-25 10:55:49,101 - Validation score increased.  Saving model ...
2025-02-25 10:55:54,994 - {'epoch': 16, 'rec_loss': '5.6550'}
2025-02-25 10:55:55,793 - {'Epoch': 16, 'HR@5': '0.0523', 'NDCG@5': '0.0347', 'HR@10': '0.0780', 'NDCG@10': '0.0430', 'HR@20': '0.1248', 'NDCG@20': '0.0549'}
2025-02-25 10:55:55,795 - EarlyStopping counter: 1 out of 10
2025-02-25 10:56:00,543 - {'epoch': 17, 'rec_loss': '5.6158'}
2025-02-25 10:56:01,309 - {'Epoch': 17, 'HR@5': '0.0532', 'NDCG@5': '0.0345', 'HR@10': '0.0844', 'NDCG@10': '0.0446', 'HR@20': '0.1376', 'NDCG@20': '0.0581'}
2025-02-25 10:56:01,310 - Validation score increased.  Saving model ...
2025-02-25 10:56:06,025 - {'epoch': 18, 'rec_loss': '5.5697'}
2025-02-25 10:56:06,765 - {'Epoch': 18, 'HR@5': '0.0486', 'NDCG@5': '0.0315', 'HR@10': '0.0807', 'NDCG@10': '0.0420', 'HR@20': '0.1358', 'NDCG@20': '0.0561'}
2025-02-25 10:56:06,766 - EarlyStopping counter: 1 out of 10
2025-02-25 10:56:11,931 - {'epoch': 19, 'rec_loss': '5.5368'}
2025-02-25 10:56:12,660 - {'Epoch': 19, 'HR@5': '0.0587', 'NDCG@5': '0.0344', 'HR@10': '0.0908', 'NDCG@10': '0.0446', 'HR@20': '0.1422', 'NDCG@20': '0.0576'}
2025-02-25 10:56:12,661 - EarlyStopping counter: 2 out of 10
2025-02-25 10:56:17,820 - {'epoch': 20, 'rec_loss': '5.5171'}
2025-02-25 10:56:18,610 - {'Epoch': 20, 'HR@5': '0.0477', 'NDCG@5': '0.0315', 'HR@10': '0.0862', 'NDCG@10': '0.0439', 'HR@20': '0.1394', 'NDCG@20': '0.0573'}
2025-02-25 10:56:18,611 - EarlyStopping counter: 3 out of 10
2025-02-25 10:56:23,451 - {'epoch': 21, 'rec_loss': '5.4779'}
2025-02-25 10:56:24,225 - {'Epoch': 21, 'HR@5': '0.0532', 'NDCG@5': '0.0345', 'HR@10': '0.0954', 'NDCG@10': '0.0478', 'HR@20': '0.1394', 'NDCG@20': '0.0588'}
2025-02-25 10:56:24,226 - Validation score increased.  Saving model ...
2025-02-25 10:56:29,025 - {'epoch': 22, 'rec_loss': '5.4744'}
2025-02-25 10:56:29,777 - {'Epoch': 22, 'HR@5': '0.0587', 'NDCG@5': '0.0377', 'HR@10': '0.0899', 'NDCG@10': '0.0476', 'HR@20': '0.1367', 'NDCG@20': '0.0594'}
2025-02-25 10:56:29,778 - Validation score increased.  Saving model ...
2025-02-25 10:56:34,786 - {'epoch': 23, 'rec_loss': '5.4685'}
2025-02-25 10:56:35,565 - {'Epoch': 23, 'HR@5': '0.0550', 'NDCG@5': '0.0353', 'HR@10': '0.0890', 'NDCG@10': '0.0464', 'HR@20': '0.1459', 'NDCG@20': '0.0608'}
2025-02-25 10:56:35,566 - Validation score increased.  Saving model ...
2025-02-25 10:56:40,458 - {'epoch': 24, 'rec_loss': '5.4274'}
2025-02-25 10:56:41,224 - {'Epoch': 24, 'HR@5': '0.0541', 'NDCG@5': '0.0353', 'HR@10': '0.0945', 'NDCG@10': '0.0484', 'HR@20': '0.1394', 'NDCG@20': '0.0598'}
2025-02-25 10:56:41,226 - EarlyStopping counter: 1 out of 10
2025-02-25 10:56:46,040 - {'epoch': 25, 'rec_loss': '5.4021'}
2025-02-25 10:56:46,854 - {'Epoch': 25, 'HR@5': '0.0569', 'NDCG@5': '0.0350', 'HR@10': '0.0936', 'NDCG@10': '0.0467', 'HR@20': '0.1413', 'NDCG@20': '0.0587'}
2025-02-25 10:56:46,855 - EarlyStopping counter: 2 out of 10
2025-02-25 10:56:51,542 - {'epoch': 26, 'rec_loss': '5.4071'}
2025-02-25 10:56:52,280 - {'Epoch': 26, 'HR@5': '0.0578', 'NDCG@5': '0.0359', 'HR@10': '0.0853', 'NDCG@10': '0.0446', 'HR@20': '0.1440', 'NDCG@20': '0.0594'}
2025-02-25 10:56:52,281 - EarlyStopping counter: 3 out of 10
2025-02-25 10:56:57,296 - {'epoch': 27, 'rec_loss': '5.3932'}
2025-02-25 10:56:58,089 - {'Epoch': 27, 'HR@5': '0.0587', 'NDCG@5': '0.0371', 'HR@10': '0.0936', 'NDCG@10': '0.0480', 'HR@20': '0.1404', 'NDCG@20': '0.0597'}
2025-02-25 10:56:58,091 - EarlyStopping counter: 4 out of 10
2025-02-25 10:57:03,028 - {'epoch': 28, 'rec_loss': '5.3744'}
2025-02-25 10:57:03,801 - {'Epoch': 28, 'HR@5': '0.0578', 'NDCG@5': '0.0375', 'HR@10': '0.0881', 'NDCG@10': '0.0472', 'HR@20': '0.1422', 'NDCG@20': '0.0608'}
2025-02-25 10:57:03,802 - Validation score increased.  Saving model ...
2025-02-25 10:57:08,483 - {'epoch': 29, 'rec_loss': '5.3618'}
2025-02-25 10:57:09,260 - {'Epoch': 29, 'HR@5': '0.0569', 'NDCG@5': '0.0375', 'HR@10': '0.0890', 'NDCG@10': '0.0477', 'HR@20': '0.1413', 'NDCG@20': '0.0609'}
2025-02-25 10:57:09,262 - Validation score increased.  Saving model ...
2025-02-25 10:57:14,118 - {'epoch': 30, 'rec_loss': '5.3526'}
2025-02-25 10:57:14,820 - {'Epoch': 30, 'HR@5': '0.0569', 'NDCG@5': '0.0370', 'HR@10': '0.0890', 'NDCG@10': '0.0472', 'HR@20': '0.1431', 'NDCG@20': '0.0607'}
2025-02-25 10:57:14,821 - EarlyStopping counter: 1 out of 10
2025-02-25 10:57:19,755 - {'epoch': 31, 'rec_loss': '5.3385'}
2025-02-25 10:57:20,511 - {'Epoch': 31, 'HR@5': '0.0596', 'NDCG@5': '0.0387', 'HR@10': '0.0954', 'NDCG@10': '0.0500', 'HR@20': '0.1505', 'NDCG@20': '0.0638'}
2025-02-25 10:57:20,512 - Validation score increased.  Saving model ...
2025-02-25 10:57:25,303 - {'epoch': 32, 'rec_loss': '5.3333'}
2025-02-25 10:57:26,067 - {'Epoch': 32, 'HR@5': '0.0615', 'NDCG@5': '0.0384', 'HR@10': '0.1000', 'NDCG@10': '0.0505', 'HR@20': '0.1459', 'NDCG@20': '0.0620'}
2025-02-25 10:57:26,068 - EarlyStopping counter: 1 out of 10
2025-02-25 10:57:30,816 - {'epoch': 33, 'rec_loss': '5.3069'}
2025-02-25 10:57:31,568 - {'Epoch': 33, 'HR@5': '0.0615', 'NDCG@5': '0.0382', 'HR@10': '0.1000', 'NDCG@10': '0.0506', 'HR@20': '0.1477', 'NDCG@20': '0.0627'}
2025-02-25 10:57:31,569 - EarlyStopping counter: 2 out of 10
2025-02-25 10:57:36,548 - {'epoch': 34, 'rec_loss': '5.2976'}
2025-02-25 10:57:37,280 - {'Epoch': 34, 'HR@5': '0.0633', 'NDCG@5': '0.0412', 'HR@10': '0.0899', 'NDCG@10': '0.0498', 'HR@20': '0.1459', 'NDCG@20': '0.0642'}
2025-02-25 10:57:37,281 - Validation score increased.  Saving model ...
2025-02-25 10:57:42,001 - {'epoch': 35, 'rec_loss': '5.2751'}
2025-02-25 10:57:42,762 - {'Epoch': 35, 'HR@5': '0.0697', 'NDCG@5': '0.0437', 'HR@10': '0.0991', 'NDCG@10': '0.0530', 'HR@20': '0.1505', 'NDCG@20': '0.0660'}
2025-02-25 10:57:42,763 - Validation score increased.  Saving model ...
2025-02-25 10:57:48,017 - {'epoch': 36, 'rec_loss': '5.2670'}
2025-02-25 10:57:48,844 - {'Epoch': 36, 'HR@5': '0.0651', 'NDCG@5': '0.0396', 'HR@10': '0.0908', 'NDCG@10': '0.0480', 'HR@20': '0.1532', 'NDCG@20': '0.0637'}
2025-02-25 10:57:48,845 - EarlyStopping counter: 1 out of 10
2025-02-25 10:57:53,716 - {'epoch': 37, 'rec_loss': '5.2652'}
2025-02-25 10:57:54,470 - {'Epoch': 37, 'HR@5': '0.0606', 'NDCG@5': '0.0379', 'HR@10': '0.0991', 'NDCG@10': '0.0502', 'HR@20': '0.1532', 'NDCG@20': '0.0637'}
2025-02-25 10:57:54,472 - EarlyStopping counter: 2 out of 10
2025-02-25 10:57:59,534 - {'epoch': 38, 'rec_loss': '5.2733'}
2025-02-25 10:58:00,259 - {'Epoch': 38, 'HR@5': '0.0606', 'NDCG@5': '0.0396', 'HR@10': '0.0945', 'NDCG@10': '0.0506', 'HR@20': '0.1468', 'NDCG@20': '0.0640'}
2025-02-25 10:58:00,260 - EarlyStopping counter: 3 out of 10
2025-02-25 10:58:05,205 - {'epoch': 39, 'rec_loss': '5.2680'}
2025-02-25 10:58:05,937 - {'Epoch': 39, 'HR@5': '0.0578', 'NDCG@5': '0.0356', 'HR@10': '0.0954', 'NDCG@10': '0.0476', 'HR@20': '0.1523', 'NDCG@20': '0.0621'}
2025-02-25 10:58:05,938 - EarlyStopping counter: 4 out of 10
2025-02-25 10:58:10,629 - {'epoch': 40, 'rec_loss': '5.2238'}
2025-02-25 10:58:11,409 - {'Epoch': 40, 'HR@5': '0.0633', 'NDCG@5': '0.0405', 'HR@10': '0.1009', 'NDCG@10': '0.0526', 'HR@20': '0.1459', 'NDCG@20': '0.0639'}
2025-02-25 10:58:11,410 - EarlyStopping counter: 5 out of 10
2025-02-25 10:58:16,372 - {'epoch': 41, 'rec_loss': '5.2425'}
2025-02-25 10:58:17,166 - {'Epoch': 41, 'HR@5': '0.0596', 'NDCG@5': '0.0401', 'HR@10': '0.0963', 'NDCG@10': '0.0521', 'HR@20': '0.1450', 'NDCG@20': '0.0642'}
2025-02-25 10:58:17,167 - EarlyStopping counter: 6 out of 10
2025-02-25 10:58:21,853 - {'epoch': 42, 'rec_loss': '5.2456'}
2025-02-25 10:58:22,602 - {'Epoch': 42, 'HR@5': '0.0661', 'NDCG@5': '0.0426', 'HR@10': '0.0954', 'NDCG@10': '0.0519', 'HR@20': '0.1505', 'NDCG@20': '0.0658'}
2025-02-25 10:58:22,603 - EarlyStopping counter: 7 out of 10
2025-02-25 10:58:27,444 - {'epoch': 43, 'rec_loss': '5.2071'}
2025-02-25 10:58:28,194 - {'Epoch': 43, 'HR@5': '0.0587', 'NDCG@5': '0.0384', 'HR@10': '0.0917', 'NDCG@10': '0.0493', 'HR@20': '0.1486', 'NDCG@20': '0.0638'}
2025-02-25 10:58:28,195 - EarlyStopping counter: 8 out of 10
2025-02-25 10:58:33,384 - {'epoch': 44, 'rec_loss': '5.2121'}
2025-02-25 10:58:34,173 - {'Epoch': 44, 'HR@5': '0.0615', 'NDCG@5': '0.0411', 'HR@10': '0.0927', 'NDCG@10': '0.0512', 'HR@20': '0.1477', 'NDCG@20': '0.0652'}
2025-02-25 10:58:34,174 - EarlyStopping counter: 9 out of 10
2025-02-25 10:58:39,174 - {'epoch': 45, 'rec_loss': '5.2111'}
2025-02-25 10:58:39,852 - {'Epoch': 45, 'HR@5': '0.0633', 'NDCG@5': '0.0426', 'HR@10': '0.0945', 'NDCG@10': '0.0525', 'HR@20': '0.1450', 'NDCG@20': '0.0653'}
2025-02-25 10:58:39,853 - EarlyStopping counter: 10 out of 10
2025-02-25 10:58:39,853 - Early stopping
2025-02-25 10:58:39,853 - ---------------Test Score---------------
2025-02-25 10:58:40,603 - {'Epoch': 0, 'HR@5': '0.0578', 'NDCG@5': '0.0378', 'HR@10': '0.0752', 'NDCG@10': '0.0435', 'HR@20': '0.1119', 'NDCG@20': '0.0527'}
2025-02-25 10:58:40,604 - Scale_LastFM
2025-02-25 10:58:40,604 - {'Epoch': 0, 'HR@5': '0.0578', 'NDCG@5': '0.0378', 'HR@10': '0.0752', 'NDCG@10': '0.0435', 'HR@20': '0.1119', 'NDCG@20': '0.0527'}
2025-02-25 11:08:15,769 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 5], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-25 11:08:18,543 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-25 11:08:18,546 - Total Parameters: 387025
2025-02-25 11:08:24,567 - {'epoch': 0, 'rec_loss': '8.0386'}
2025-02-25 11:08:25,225 - {'Epoch': 0, 'HR@5': '0.0248', 'NDCG@5': '0.0179', 'HR@10': '0.0349', 'NDCG@10': '0.0212', 'HR@20': '0.0615', 'NDCG@20': '0.0279'}
2025-02-25 11:08:25,226 - Validation score increased.  Saving model ...
2025-02-25 11:08:30,400 - {'epoch': 1, 'rec_loss': '7.7395'}
2025-02-25 11:08:31,113 - {'Epoch': 1, 'HR@5': '0.0266', 'NDCG@5': '0.0177', 'HR@10': '0.0367', 'NDCG@10': '0.0209', 'HR@20': '0.0541', 'NDCG@20': '0.0253'}
2025-02-25 11:08:31,114 - EarlyStopping counter: 1 out of 10
2025-02-25 11:08:35,910 - {'epoch': 2, 'rec_loss': '7.5362'}
2025-02-25 11:08:36,557 - {'Epoch': 2, 'HR@5': '0.0202', 'NDCG@5': '0.0151', 'HR@10': '0.0349', 'NDCG@10': '0.0198', 'HR@20': '0.0615', 'NDCG@20': '0.0263'}
2025-02-25 11:08:36,558 - EarlyStopping counter: 2 out of 10
2025-02-25 11:08:41,734 - {'epoch': 3, 'rec_loss': '7.3252'}
2025-02-25 11:08:42,415 - {'Epoch': 3, 'HR@5': '0.0303', 'NDCG@5': '0.0209', 'HR@10': '0.0450', 'NDCG@10': '0.0257', 'HR@20': '0.0661', 'NDCG@20': '0.0310'}
2025-02-25 11:08:42,416 - Validation score increased.  Saving model ...
2025-02-25 11:08:47,342 - {'epoch': 4, 'rec_loss': '7.1147'}
2025-02-25 11:08:48,060 - {'Epoch': 4, 'HR@5': '0.0321', 'NDCG@5': '0.0216', 'HR@10': '0.0440', 'NDCG@10': '0.0253', 'HR@20': '0.0798', 'NDCG@20': '0.0344'}
2025-02-25 11:08:48,061 - Validation score increased.  Saving model ...
2025-02-25 11:08:53,111 - {'epoch': 5, 'rec_loss': '6.9126'}
2025-02-25 11:08:53,809 - {'Epoch': 5, 'HR@5': '0.0321', 'NDCG@5': '0.0211', 'HR@10': '0.0505', 'NDCG@10': '0.0271', 'HR@20': '0.0872', 'NDCG@20': '0.0364'}
2025-02-25 11:08:53,811 - Validation score increased.  Saving model ...
2025-02-25 11:08:58,966 - {'epoch': 6, 'rec_loss': '6.7063'}
2025-02-25 11:08:59,697 - {'Epoch': 6, 'HR@5': '0.0394', 'NDCG@5': '0.0240', 'HR@10': '0.0596', 'NDCG@10': '0.0305', 'HR@20': '0.0945', 'NDCG@20': '0.0393'}
2025-02-25 11:08:59,698 - Validation score increased.  Saving model ...
2025-02-25 11:09:04,653 - {'epoch': 7, 'rec_loss': '6.5392'}
2025-02-25 11:09:05,350 - {'Epoch': 7, 'HR@5': '0.0431', 'NDCG@5': '0.0281', 'HR@10': '0.0661', 'NDCG@10': '0.0356', 'HR@20': '0.0954', 'NDCG@20': '0.0430'}
2025-02-25 11:09:05,351 - Validation score increased.  Saving model ...
2025-02-25 11:09:10,902 - {'epoch': 8, 'rec_loss': '6.3686'}
2025-02-25 11:09:11,582 - {'Epoch': 8, 'HR@5': '0.0404', 'NDCG@5': '0.0254', 'HR@10': '0.0661', 'NDCG@10': '0.0336', 'HR@20': '0.1064', 'NDCG@20': '0.0438'}
2025-02-25 11:09:11,583 - Validation score increased.  Saving model ...
2025-02-25 11:09:17,371 - {'epoch': 9, 'rec_loss': '6.2540'}
2025-02-25 11:09:18,077 - {'Epoch': 9, 'HR@5': '0.0477', 'NDCG@5': '0.0289', 'HR@10': '0.0697', 'NDCG@10': '0.0361', 'HR@20': '0.1101', 'NDCG@20': '0.0462'}
2025-02-25 11:09:18,078 - Validation score increased.  Saving model ...
2025-02-25 11:09:22,924 - {'epoch': 10, 'rec_loss': '6.1171'}
2025-02-25 11:09:23,585 - {'Epoch': 10, 'HR@5': '0.0477', 'NDCG@5': '0.0298', 'HR@10': '0.0743', 'NDCG@10': '0.0382', 'HR@20': '0.1174', 'NDCG@20': '0.0490'}
2025-02-25 11:09:23,587 - Validation score increased.  Saving model ...
2025-02-25 11:09:28,500 - {'epoch': 11, 'rec_loss': '6.0379'}
2025-02-25 11:09:29,217 - {'Epoch': 11, 'HR@5': '0.0468', 'NDCG@5': '0.0323', 'HR@10': '0.0780', 'NDCG@10': '0.0422', 'HR@20': '0.1220', 'NDCG@20': '0.0533'}
2025-02-25 11:09:29,218 - Validation score increased.  Saving model ...
2025-02-25 11:09:34,272 - {'epoch': 12, 'rec_loss': '5.9625'}
2025-02-25 11:09:34,916 - {'Epoch': 12, 'HR@5': '0.0495', 'NDCG@5': '0.0323', 'HR@10': '0.0725', 'NDCG@10': '0.0396', 'HR@20': '0.1239', 'NDCG@20': '0.0525'}
2025-02-25 11:09:34,917 - EarlyStopping counter: 1 out of 10
2025-02-25 11:09:39,813 - {'epoch': 13, 'rec_loss': '5.8662'}
2025-02-25 11:09:40,501 - {'Epoch': 13, 'HR@5': '0.0514', 'NDCG@5': '0.0329', 'HR@10': '0.0771', 'NDCG@10': '0.0411', 'HR@20': '0.1156', 'NDCG@20': '0.0508'}
2025-02-25 11:09:40,502 - EarlyStopping counter: 2 out of 10
2025-02-25 11:09:45,410 - {'epoch': 14, 'rec_loss': '5.8125'}
2025-02-25 11:09:46,103 - {'Epoch': 14, 'HR@5': '0.0532', 'NDCG@5': '0.0335', 'HR@10': '0.0853', 'NDCG@10': '0.0438', 'HR@20': '0.1156', 'NDCG@20': '0.0515'}
2025-02-25 11:09:46,105 - EarlyStopping counter: 3 out of 10
2025-02-25 11:09:51,491 - {'epoch': 15, 'rec_loss': '5.7600'}
2025-02-25 11:09:52,210 - {'Epoch': 15, 'HR@5': '0.0505', 'NDCG@5': '0.0334', 'HR@10': '0.0872', 'NDCG@10': '0.0451', 'HR@20': '0.1294', 'NDCG@20': '0.0556'}
2025-02-25 11:09:52,211 - Validation score increased.  Saving model ...
2025-02-25 11:09:57,352 - {'epoch': 16, 'rec_loss': '5.7216'}
2025-02-25 11:09:58,043 - {'Epoch': 16, 'HR@5': '0.0505', 'NDCG@5': '0.0319', 'HR@10': '0.0817', 'NDCG@10': '0.0419', 'HR@20': '0.1294', 'NDCG@20': '0.0539'}
2025-02-25 11:09:58,044 - EarlyStopping counter: 1 out of 10
2025-02-25 11:10:02,861 - {'epoch': 17, 'rec_loss': '5.6650'}
2025-02-25 11:10:03,621 - {'Epoch': 17, 'HR@5': '0.0541', 'NDCG@5': '0.0344', 'HR@10': '0.0890', 'NDCG@10': '0.0457', 'HR@20': '0.1321', 'NDCG@20': '0.0565'}
2025-02-25 11:10:03,622 - Validation score increased.  Saving model ...
2025-02-25 11:10:08,490 - {'epoch': 18, 'rec_loss': '5.6174'}
2025-02-25 11:10:09,234 - {'Epoch': 18, 'HR@5': '0.0541', 'NDCG@5': '0.0362', 'HR@10': '0.0817', 'NDCG@10': '0.0449', 'HR@20': '0.1248', 'NDCG@20': '0.0559'}
2025-02-25 11:10:09,235 - EarlyStopping counter: 1 out of 10
2025-02-25 11:10:14,198 - {'epoch': 19, 'rec_loss': '5.6157'}
2025-02-25 11:10:14,906 - {'Epoch': 19, 'HR@5': '0.0495', 'NDCG@5': '0.0310', 'HR@10': '0.0835', 'NDCG@10': '0.0422', 'HR@20': '0.1294', 'NDCG@20': '0.0537'}
2025-02-25 11:10:14,908 - EarlyStopping counter: 2 out of 10
2025-02-25 11:10:20,023 - {'epoch': 20, 'rec_loss': '5.5973'}
2025-02-25 11:10:20,765 - {'Epoch': 20, 'HR@5': '0.0514', 'NDCG@5': '0.0333', 'HR@10': '0.0872', 'NDCG@10': '0.0447', 'HR@20': '0.1330', 'NDCG@20': '0.0562'}
2025-02-25 11:10:20,766 - EarlyStopping counter: 3 out of 10
2025-02-25 11:10:26,164 - {'epoch': 21, 'rec_loss': '5.5467'}
2025-02-25 11:10:26,861 - {'Epoch': 21, 'HR@5': '0.0541', 'NDCG@5': '0.0357', 'HR@10': '0.0862', 'NDCG@10': '0.0461', 'HR@20': '0.1349', 'NDCG@20': '0.0585'}
2025-02-25 11:10:26,862 - Validation score increased.  Saving model ...
2025-02-25 11:10:32,191 - {'epoch': 22, 'rec_loss': '5.5300'}
2025-02-25 11:10:32,929 - {'Epoch': 22, 'HR@5': '0.0569', 'NDCG@5': '0.0364', 'HR@10': '0.0881', 'NDCG@10': '0.0464', 'HR@20': '0.1367', 'NDCG@20': '0.0587'}
2025-02-25 11:10:32,931 - Validation score increased.  Saving model ...
2025-02-25 11:10:38,413 - {'epoch': 23, 'rec_loss': '5.5338'}
2025-02-25 11:10:39,091 - {'Epoch': 23, 'HR@5': '0.0569', 'NDCG@5': '0.0371', 'HR@10': '0.0917', 'NDCG@10': '0.0481', 'HR@20': '0.1358', 'NDCG@20': '0.0593'}
2025-02-25 11:10:39,092 - Validation score increased.  Saving model ...
2025-02-25 11:10:44,210 - {'epoch': 24, 'rec_loss': '5.4856'}
2025-02-25 11:10:44,867 - {'Epoch': 24, 'HR@5': '0.0541', 'NDCG@5': '0.0363', 'HR@10': '0.0945', 'NDCG@10': '0.0491', 'HR@20': '0.1404', 'NDCG@20': '0.0606'}
2025-02-25 11:10:44,868 - Validation score increased.  Saving model ...
2025-02-25 11:10:49,998 - {'epoch': 25, 'rec_loss': '5.4704'}
2025-02-25 11:10:50,652 - {'Epoch': 25, 'HR@5': '0.0550', 'NDCG@5': '0.0373', 'HR@10': '0.0945', 'NDCG@10': '0.0501', 'HR@20': '0.1450', 'NDCG@20': '0.0628'}
2025-02-25 11:10:50,653 - Validation score increased.  Saving model ...
2025-02-25 11:10:55,898 - {'epoch': 26, 'rec_loss': '5.4606'}
2025-02-25 11:10:56,622 - {'Epoch': 26, 'HR@5': '0.0560', 'NDCG@5': '0.0382', 'HR@10': '0.0927', 'NDCG@10': '0.0499', 'HR@20': '0.1431', 'NDCG@20': '0.0627'}
2025-02-25 11:10:56,623 - EarlyStopping counter: 1 out of 10
2025-02-25 11:11:01,645 - {'epoch': 27, 'rec_loss': '5.4439'}
2025-02-25 11:11:02,318 - {'Epoch': 27, 'HR@5': '0.0606', 'NDCG@5': '0.0380', 'HR@10': '0.0936', 'NDCG@10': '0.0485', 'HR@20': '0.1486', 'NDCG@20': '0.0624'}
2025-02-25 11:11:02,319 - EarlyStopping counter: 2 out of 10
2025-02-25 11:11:07,241 - {'epoch': 28, 'rec_loss': '5.4297'}
2025-02-25 11:11:07,948 - {'Epoch': 28, 'HR@5': '0.0560', 'NDCG@5': '0.0367', 'HR@10': '0.0945', 'NDCG@10': '0.0488', 'HR@20': '0.1486', 'NDCG@20': '0.0623'}
2025-02-25 11:11:07,949 - EarlyStopping counter: 3 out of 10
2025-02-25 11:11:12,755 - {'epoch': 29, 'rec_loss': '5.4046'}
2025-02-25 11:11:13,487 - {'Epoch': 29, 'HR@5': '0.0578', 'NDCG@5': '0.0374', 'HR@10': '0.0954', 'NDCG@10': '0.0495', 'HR@20': '0.1495', 'NDCG@20': '0.0630'}
2025-02-25 11:11:13,488 - Validation score increased.  Saving model ...
2025-02-25 11:11:18,465 - {'epoch': 30, 'rec_loss': '5.4010'}
2025-02-25 11:11:19,146 - {'Epoch': 30, 'HR@5': '0.0596', 'NDCG@5': '0.0369', 'HR@10': '0.0954', 'NDCG@10': '0.0482', 'HR@20': '0.1477', 'NDCG@20': '0.0614'}
2025-02-25 11:11:19,147 - EarlyStopping counter: 1 out of 10
2025-02-25 11:11:23,913 - {'epoch': 31, 'rec_loss': '5.4065'}
2025-02-25 11:11:24,584 - {'Epoch': 31, 'HR@5': '0.0587', 'NDCG@5': '0.0368', 'HR@10': '0.0963', 'NDCG@10': '0.0487', 'HR@20': '0.1468', 'NDCG@20': '0.0613'}
2025-02-25 11:11:24,585 - EarlyStopping counter: 2 out of 10
2025-02-25 11:11:29,322 - {'epoch': 32, 'rec_loss': '5.3894'}
2025-02-25 11:11:30,010 - {'Epoch': 32, 'HR@5': '0.0587', 'NDCG@5': '0.0390', 'HR@10': '0.0972', 'NDCG@10': '0.0517', 'HR@20': '0.1495', 'NDCG@20': '0.0647'}
2025-02-25 11:11:30,012 - Validation score increased.  Saving model ...
2025-02-25 11:11:34,910 - {'epoch': 33, 'rec_loss': '5.3610'}
2025-02-25 11:11:35,595 - {'Epoch': 33, 'HR@5': '0.0596', 'NDCG@5': '0.0384', 'HR@10': '0.0936', 'NDCG@10': '0.0494', 'HR@20': '0.1505', 'NDCG@20': '0.0637'}
2025-02-25 11:11:35,596 - EarlyStopping counter: 1 out of 10
2025-02-25 11:11:40,462 - {'epoch': 34, 'rec_loss': '5.3701'}
2025-02-25 11:11:41,150 - {'Epoch': 34, 'HR@5': '0.0560', 'NDCG@5': '0.0358', 'HR@10': '0.1055', 'NDCG@10': '0.0516', 'HR@20': '0.1468', 'NDCG@20': '0.0619'}
2025-02-25 11:11:41,151 - EarlyStopping counter: 2 out of 10
2025-02-25 11:11:46,124 - {'epoch': 35, 'rec_loss': '5.3322'}
2025-02-25 11:11:46,863 - {'Epoch': 35, 'HR@5': '0.0578', 'NDCG@5': '0.0367', 'HR@10': '0.1028', 'NDCG@10': '0.0513', 'HR@20': '0.1550', 'NDCG@20': '0.0643'}
2025-02-25 11:11:46,864 - EarlyStopping counter: 3 out of 10
2025-02-25 11:11:51,749 - {'epoch': 36, 'rec_loss': '5.3245'}
2025-02-25 11:11:52,404 - {'Epoch': 36, 'HR@5': '0.0569', 'NDCG@5': '0.0364', 'HR@10': '0.1028', 'NDCG@10': '0.0512', 'HR@20': '0.1523', 'NDCG@20': '0.0636'}
2025-02-25 11:11:52,405 - EarlyStopping counter: 4 out of 10
2025-02-25 11:11:57,387 - {'epoch': 37, 'rec_loss': '5.3107'}
2025-02-25 11:11:58,108 - {'Epoch': 37, 'HR@5': '0.0596', 'NDCG@5': '0.0379', 'HR@10': '0.0991', 'NDCG@10': '0.0506', 'HR@20': '0.1486', 'NDCG@20': '0.0634'}
2025-02-25 11:11:58,109 - EarlyStopping counter: 5 out of 10
2025-02-25 11:12:03,017 - {'epoch': 38, 'rec_loss': '5.3230'}
2025-02-25 11:12:03,657 - {'Epoch': 38, 'HR@5': '0.0578', 'NDCG@5': '0.0374', 'HR@10': '0.0991', 'NDCG@10': '0.0508', 'HR@20': '0.1541', 'NDCG@20': '0.0645'}
2025-02-25 11:12:03,658 - EarlyStopping counter: 6 out of 10
2025-02-25 11:12:08,918 - {'epoch': 39, 'rec_loss': '5.3005'}
2025-02-25 11:12:09,610 - {'Epoch': 39, 'HR@5': '0.0624', 'NDCG@5': '0.0409', 'HR@10': '0.1009', 'NDCG@10': '0.0533', 'HR@20': '0.1514', 'NDCG@20': '0.0659'}
2025-02-25 11:12:09,611 - Validation score increased.  Saving model ...
2025-02-25 11:12:14,628 - {'epoch': 40, 'rec_loss': '5.2918'}
2025-02-25 11:12:15,307 - {'Epoch': 40, 'HR@5': '0.0633', 'NDCG@5': '0.0405', 'HR@10': '0.0991', 'NDCG@10': '0.0522', 'HR@20': '0.1514', 'NDCG@20': '0.0653'}
2025-02-25 11:12:15,308 - EarlyStopping counter: 1 out of 10
2025-02-25 11:12:20,384 - {'epoch': 41, 'rec_loss': '5.2888'}
2025-02-25 11:12:21,102 - {'Epoch': 41, 'HR@5': '0.0642', 'NDCG@5': '0.0395', 'HR@10': '0.1073', 'NDCG@10': '0.0534', 'HR@20': '0.1550', 'NDCG@20': '0.0654'}
2025-02-25 11:12:21,103 - EarlyStopping counter: 2 out of 10
2025-02-25 11:12:26,473 - {'epoch': 42, 'rec_loss': '5.2872'}
2025-02-25 11:12:27,161 - {'Epoch': 42, 'HR@5': '0.0624', 'NDCG@5': '0.0400', 'HR@10': '0.1064', 'NDCG@10': '0.0541', 'HR@20': '0.1569', 'NDCG@20': '0.0668'}
2025-02-25 11:12:27,162 - Validation score increased.  Saving model ...
2025-02-25 11:12:32,237 - {'epoch': 43, 'rec_loss': '5.2704'}
2025-02-25 11:12:32,963 - {'Epoch': 43, 'HR@5': '0.0624', 'NDCG@5': '0.0387', 'HR@10': '0.0991', 'NDCG@10': '0.0505', 'HR@20': '0.1550', 'NDCG@20': '0.0646'}
2025-02-25 11:12:32,964 - EarlyStopping counter: 1 out of 10
2025-02-25 11:12:37,976 - {'epoch': 44, 'rec_loss': '5.2830'}
2025-02-25 11:12:38,661 - {'Epoch': 44, 'HR@5': '0.0606', 'NDCG@5': '0.0369', 'HR@10': '0.0908', 'NDCG@10': '0.0465', 'HR@20': '0.1532', 'NDCG@20': '0.0624'}
2025-02-25 11:12:38,662 - EarlyStopping counter: 2 out of 10
2025-02-25 11:12:43,969 - {'epoch': 45, 'rec_loss': '5.2627'}
2025-02-25 11:12:44,663 - {'Epoch': 45, 'HR@5': '0.0596', 'NDCG@5': '0.0355', 'HR@10': '0.0963', 'NDCG@10': '0.0473', 'HR@20': '0.1550', 'NDCG@20': '0.0621'}
2025-02-25 11:12:44,664 - EarlyStopping counter: 3 out of 10
2025-02-25 11:12:49,743 - {'epoch': 46, 'rec_loss': '5.2495'}
2025-02-25 11:12:50,430 - {'Epoch': 46, 'HR@5': '0.0651', 'NDCG@5': '0.0413', 'HR@10': '0.0982', 'NDCG@10': '0.0521', 'HR@20': '0.1550', 'NDCG@20': '0.0661'}
2025-02-25 11:12:50,431 - EarlyStopping counter: 4 out of 10
2025-02-25 11:12:55,200 - {'epoch': 47, 'rec_loss': '5.2603'}
2025-02-25 11:12:55,884 - {'Epoch': 47, 'HR@5': '0.0661', 'NDCG@5': '0.0413', 'HR@10': '0.0945', 'NDCG@10': '0.0503', 'HR@20': '0.1468', 'NDCG@20': '0.0634'}
2025-02-25 11:12:55,885 - EarlyStopping counter: 5 out of 10
2025-02-25 11:13:00,757 - {'epoch': 48, 'rec_loss': '5.2462'}
2025-02-25 11:13:01,451 - {'Epoch': 48, 'HR@5': '0.0642', 'NDCG@5': '0.0412', 'HR@10': '0.0945', 'NDCG@10': '0.0509', 'HR@20': '0.1569', 'NDCG@20': '0.0665'}
2025-02-25 11:13:01,452 - EarlyStopping counter: 6 out of 10
2025-02-25 11:13:06,353 - {'epoch': 49, 'rec_loss': '5.2422'}
2025-02-25 11:13:06,997 - {'Epoch': 49, 'HR@5': '0.0642', 'NDCG@5': '0.0413', 'HR@10': '0.0954', 'NDCG@10': '0.0512', 'HR@20': '0.1550', 'NDCG@20': '0.0662'}
2025-02-25 11:13:06,998 - EarlyStopping counter: 7 out of 10
2025-02-25 11:13:12,287 - {'epoch': 50, 'rec_loss': '5.2348'}
2025-02-25 11:13:12,935 - {'Epoch': 50, 'HR@5': '0.0578', 'NDCG@5': '0.0383', 'HR@10': '0.0945', 'NDCG@10': '0.0502', 'HR@20': '0.1587', 'NDCG@20': '0.0665'}
2025-02-25 11:13:12,937 - EarlyStopping counter: 8 out of 10
2025-02-25 11:13:17,665 - {'epoch': 51, 'rec_loss': '5.2274'}
2025-02-25 11:13:18,326 - {'Epoch': 51, 'HR@5': '0.0587', 'NDCG@5': '0.0376', 'HR@10': '0.0917', 'NDCG@10': '0.0482', 'HR@20': '0.1532', 'NDCG@20': '0.0637'}
2025-02-25 11:13:18,327 - EarlyStopping counter: 9 out of 10
2025-02-25 11:13:23,115 - {'epoch': 52, 'rec_loss': '5.2178'}
2025-02-25 11:13:23,863 - {'Epoch': 52, 'HR@5': '0.0606', 'NDCG@5': '0.0396', 'HR@10': '0.0945', 'NDCG@10': '0.0507', 'HR@20': '0.1505', 'NDCG@20': '0.0648'}
2025-02-25 11:13:23,864 - EarlyStopping counter: 10 out of 10
2025-02-25 11:13:23,865 - Early stopping
2025-02-25 11:13:23,865 - ---------------Test Score---------------
2025-02-25 11:13:24,514 - {'Epoch': 0, 'HR@5': '0.0541', 'NDCG@5': '0.0345', 'HR@10': '0.0716', 'NDCG@10': '0.0402', 'HR@20': '0.1037', 'NDCG@20': '0.0482'}
2025-02-25 11:13:24,515 - Scale_LastFM
2025-02-25 11:13:24,515 - {'Epoch': 0, 'HR@5': '0.0541', 'NDCG@5': '0.0345', 'HR@10': '0.0716', 'NDCG@10': '0.0402', 'HR@20': '0.1037', 'NDCG@20': '0.0482'}
2025-02-25 11:17:58,004 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[10, 5], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-25 11:18:00,816 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-25 11:18:00,820 - Total Parameters: 387025
2025-02-25 11:18:06,951 - {'epoch': 0, 'rec_loss': '8.0428'}
2025-02-25 11:18:07,641 - {'Epoch': 0, 'HR@5': '0.0239', 'NDCG@5': '0.0174', 'HR@10': '0.0440', 'NDCG@10': '0.0239', 'HR@20': '0.0633', 'NDCG@20': '0.0287'}
2025-02-25 11:18:07,642 - Validation score increased.  Saving model ...
2025-02-25 11:18:12,988 - {'epoch': 1, 'rec_loss': '7.7569'}
2025-02-25 11:18:13,685 - {'Epoch': 1, 'HR@5': '0.0229', 'NDCG@5': '0.0148', 'HR@10': '0.0367', 'NDCG@10': '0.0192', 'HR@20': '0.0596', 'NDCG@20': '0.0248'}
2025-02-25 11:18:13,686 - EarlyStopping counter: 1 out of 10
2025-02-25 11:18:18,742 - {'epoch': 2, 'rec_loss': '7.5400'}
2025-02-25 11:18:19,440 - {'Epoch': 2, 'HR@5': '0.0211', 'NDCG@5': '0.0148', 'HR@10': '0.0422', 'NDCG@10': '0.0215', 'HR@20': '0.0642', 'NDCG@20': '0.0271'}
2025-02-25 11:18:19,442 - EarlyStopping counter: 2 out of 10
2025-02-25 11:18:24,794 - {'epoch': 3, 'rec_loss': '7.3224'}
2025-02-25 11:18:25,501 - {'Epoch': 3, 'HR@5': '0.0284', 'NDCG@5': '0.0205', 'HR@10': '0.0404', 'NDCG@10': '0.0244', 'HR@20': '0.0716', 'NDCG@20': '0.0322'}
2025-02-25 11:18:25,502 - Validation score increased.  Saving model ...
2025-02-25 11:18:30,319 - {'epoch': 4, 'rec_loss': '7.1095'}
2025-02-25 11:18:30,979 - {'Epoch': 4, 'HR@5': '0.0312', 'NDCG@5': '0.0216', 'HR@10': '0.0514', 'NDCG@10': '0.0280', 'HR@20': '0.0771', 'NDCG@20': '0.0344'}
2025-02-25 11:18:30,980 - Validation score increased.  Saving model ...
2025-02-25 11:18:35,928 - {'epoch': 5, 'rec_loss': '6.9103'}
2025-02-25 11:18:36,609 - {'Epoch': 5, 'HR@5': '0.0367', 'NDCG@5': '0.0239', 'HR@10': '0.0560', 'NDCG@10': '0.0298', 'HR@20': '0.0835', 'NDCG@20': '0.0366'}
2025-02-25 11:18:36,610 - Validation score increased.  Saving model ...
2025-02-25 11:18:42,154 - {'epoch': 6, 'rec_loss': '6.7151'}
2025-02-25 11:18:42,891 - {'Epoch': 6, 'HR@5': '0.0450', 'NDCG@5': '0.0302', 'HR@10': '0.0651', 'NDCG@10': '0.0366', 'HR@20': '0.0954', 'NDCG@20': '0.0442'}
2025-02-25 11:18:42,892 - Validation score increased.  Saving model ...
2025-02-25 11:18:47,917 - {'epoch': 7, 'rec_loss': '6.5408'}
2025-02-25 11:18:48,626 - {'Epoch': 7, 'HR@5': '0.0422', 'NDCG@5': '0.0295', 'HR@10': '0.0716', 'NDCG@10': '0.0391', 'HR@20': '0.1028', 'NDCG@20': '0.0469'}
2025-02-25 11:18:48,627 - Validation score increased.  Saving model ...
2025-02-25 11:18:53,772 - {'epoch': 8, 'rec_loss': '6.3763'}
2025-02-25 11:18:54,404 - {'Epoch': 8, 'HR@5': '0.0486', 'NDCG@5': '0.0342', 'HR@10': '0.0761', 'NDCG@10': '0.0431', 'HR@20': '0.1018', 'NDCG@20': '0.0495'}
2025-02-25 11:18:54,405 - Validation score increased.  Saving model ...
2025-02-25 11:18:59,472 - {'epoch': 9, 'rec_loss': '6.2501'}
2025-02-25 11:19:00,160 - {'Epoch': 9, 'HR@5': '0.0468', 'NDCG@5': '0.0289', 'HR@10': '0.0697', 'NDCG@10': '0.0363', 'HR@20': '0.1101', 'NDCG@20': '0.0464'}
2025-02-25 11:19:00,161 - EarlyStopping counter: 1 out of 10
2025-02-25 11:19:05,283 - {'epoch': 10, 'rec_loss': '6.1260'}
2025-02-25 11:19:05,926 - {'Epoch': 10, 'HR@5': '0.0523', 'NDCG@5': '0.0315', 'HR@10': '0.0780', 'NDCG@10': '0.0397', 'HR@20': '0.1156', 'NDCG@20': '0.0490'}
2025-02-25 11:19:05,927 - EarlyStopping counter: 2 out of 10
2025-02-25 11:19:10,716 - {'epoch': 11, 'rec_loss': '6.0433'}
2025-02-25 11:19:11,485 - {'Epoch': 11, 'HR@5': '0.0505', 'NDCG@5': '0.0304', 'HR@10': '0.0780', 'NDCG@10': '0.0392', 'HR@20': '0.1193', 'NDCG@20': '0.0496'}
2025-02-25 11:19:11,486 - Validation score increased.  Saving model ...
2025-02-25 11:19:16,333 - {'epoch': 12, 'rec_loss': '5.9624'}
2025-02-25 11:19:16,937 - {'Epoch': 12, 'HR@5': '0.0495', 'NDCG@5': '0.0313', 'HR@10': '0.0734', 'NDCG@10': '0.0389', 'HR@20': '0.1183', 'NDCG@20': '0.0502'}
2025-02-25 11:19:16,939 - Validation score increased.  Saving model ...
2025-02-25 11:19:21,935 - {'epoch': 13, 'rec_loss': '5.8784'}
2025-02-25 11:19:22,570 - {'Epoch': 13, 'HR@5': '0.0459', 'NDCG@5': '0.0313', 'HR@10': '0.0798', 'NDCG@10': '0.0423', 'HR@20': '0.1183', 'NDCG@20': '0.0519'}
2025-02-25 11:19:22,571 - Validation score increased.  Saving model ...
2025-02-25 11:19:27,629 - {'epoch': 14, 'rec_loss': '5.8174'}
2025-02-25 11:19:28,318 - {'Epoch': 14, 'HR@5': '0.0532', 'NDCG@5': '0.0342', 'HR@10': '0.0826', 'NDCG@10': '0.0437', 'HR@20': '0.1266', 'NDCG@20': '0.0547'}
2025-02-25 11:19:28,319 - Validation score increased.  Saving model ...
2025-02-25 11:19:33,441 - {'epoch': 15, 'rec_loss': '5.7662'}
2025-02-25 11:19:34,149 - {'Epoch': 15, 'HR@5': '0.0560', 'NDCG@5': '0.0370', 'HR@10': '0.0817', 'NDCG@10': '0.0452', 'HR@20': '0.1239', 'NDCG@20': '0.0559'}
2025-02-25 11:19:34,150 - Validation score increased.  Saving model ...
2025-02-25 11:19:39,321 - {'epoch': 16, 'rec_loss': '5.7349'}
2025-02-25 11:19:39,969 - {'Epoch': 16, 'HR@5': '0.0486', 'NDCG@5': '0.0332', 'HR@10': '0.0917', 'NDCG@10': '0.0472', 'HR@20': '0.1275', 'NDCG@20': '0.0562'}
2025-02-25 11:19:39,971 - Validation score increased.  Saving model ...
2025-02-25 11:19:44,950 - {'epoch': 17, 'rec_loss': '5.6723'}
2025-02-25 11:19:45,670 - {'Epoch': 17, 'HR@5': '0.0560', 'NDCG@5': '0.0364', 'HR@10': '0.0927', 'NDCG@10': '0.0482', 'HR@20': '0.1275', 'NDCG@20': '0.0569'}
2025-02-25 11:19:45,671 - Validation score increased.  Saving model ...
2025-02-25 11:19:50,650 - {'epoch': 18, 'rec_loss': '5.6167'}
2025-02-25 11:19:51,275 - {'Epoch': 18, 'HR@5': '0.0578', 'NDCG@5': '0.0364', 'HR@10': '0.0927', 'NDCG@10': '0.0475', 'HR@20': '0.1248', 'NDCG@20': '0.0555'}
2025-02-25 11:19:51,277 - EarlyStopping counter: 1 out of 10
2025-02-25 11:19:56,334 - {'epoch': 19, 'rec_loss': '5.6085'}
2025-02-25 11:19:56,985 - {'Epoch': 19, 'HR@5': '0.0560', 'NDCG@5': '0.0365', 'HR@10': '0.0945', 'NDCG@10': '0.0489', 'HR@20': '0.1303', 'NDCG@20': '0.0579'}
2025-02-25 11:19:56,986 - Validation score increased.  Saving model ...
2025-02-25 11:20:01,984 - {'epoch': 20, 'rec_loss': '5.5840'}
2025-02-25 11:20:02,642 - {'Epoch': 20, 'HR@5': '0.0569', 'NDCG@5': '0.0374', 'HR@10': '0.0908', 'NDCG@10': '0.0485', 'HR@20': '0.1294', 'NDCG@20': '0.0582'}
2025-02-25 11:20:02,643 - Validation score increased.  Saving model ...
2025-02-25 11:20:07,395 - {'epoch': 21, 'rec_loss': '5.5616'}
2025-02-25 11:20:08,072 - {'Epoch': 21, 'HR@5': '0.0550', 'NDCG@5': '0.0353', 'HR@10': '0.0936', 'NDCG@10': '0.0477', 'HR@20': '0.1284', 'NDCG@20': '0.0566'}
2025-02-25 11:20:08,073 - EarlyStopping counter: 1 out of 10
2025-02-25 11:20:13,469 - {'epoch': 22, 'rec_loss': '5.5317'}
2025-02-25 11:20:14,139 - {'Epoch': 22, 'HR@5': '0.0550', 'NDCG@5': '0.0342', 'HR@10': '0.0908', 'NDCG@10': '0.0455', 'HR@20': '0.1266', 'NDCG@20': '0.0546'}
2025-02-25 11:20:14,140 - EarlyStopping counter: 2 out of 10
2025-02-25 11:20:19,638 - {'epoch': 23, 'rec_loss': '5.5146'}
2025-02-25 11:20:20,311 - {'Epoch': 23, 'HR@5': '0.0560', 'NDCG@5': '0.0348', 'HR@10': '0.0899', 'NDCG@10': '0.0458', 'HR@20': '0.1284', 'NDCG@20': '0.0554'}
2025-02-25 11:20:20,312 - EarlyStopping counter: 3 out of 10
2025-02-25 11:20:25,362 - {'epoch': 24, 'rec_loss': '5.4838'}
2025-02-25 11:20:26,013 - {'Epoch': 24, 'HR@5': '0.0514', 'NDCG@5': '0.0338', 'HR@10': '0.0862', 'NDCG@10': '0.0451', 'HR@20': '0.1330', 'NDCG@20': '0.0568'}
2025-02-25 11:20:26,014 - EarlyStopping counter: 4 out of 10
2025-02-25 11:20:31,189 - {'epoch': 25, 'rec_loss': '5.4677'}
2025-02-25 11:20:31,867 - {'Epoch': 25, 'HR@5': '0.0514', 'NDCG@5': '0.0347', 'HR@10': '0.0917', 'NDCG@10': '0.0478', 'HR@20': '0.1330', 'NDCG@20': '0.0581'}
2025-02-25 11:20:31,868 - EarlyStopping counter: 5 out of 10
2025-02-25 11:20:37,519 - {'epoch': 26, 'rec_loss': '5.4595'}
2025-02-25 11:20:38,209 - {'Epoch': 26, 'HR@5': '0.0560', 'NDCG@5': '0.0364', 'HR@10': '0.0963', 'NDCG@10': '0.0495', 'HR@20': '0.1239', 'NDCG@20': '0.0564'}
2025-02-25 11:20:38,211 - EarlyStopping counter: 6 out of 10
2025-02-25 11:20:43,400 - {'epoch': 27, 'rec_loss': '5.4367'}
2025-02-25 11:20:44,065 - {'Epoch': 27, 'HR@5': '0.0606', 'NDCG@5': '0.0381', 'HR@10': '0.0954', 'NDCG@10': '0.0494', 'HR@20': '0.1303', 'NDCG@20': '0.0581'}
2025-02-25 11:20:44,066 - EarlyStopping counter: 7 out of 10
2025-02-25 11:20:49,089 - {'epoch': 28, 'rec_loss': '5.4202'}
2025-02-25 11:20:49,705 - {'Epoch': 28, 'HR@5': '0.0615', 'NDCG@5': '0.0386', 'HR@10': '0.0890', 'NDCG@10': '0.0479', 'HR@20': '0.1330', 'NDCG@20': '0.0589'}
2025-02-25 11:20:49,706 - Validation score increased.  Saving model ...
2025-02-25 11:20:54,823 - {'epoch': 29, 'rec_loss': '5.4138'}
2025-02-25 11:20:55,460 - {'Epoch': 29, 'HR@5': '0.0596', 'NDCG@5': '0.0374', 'HR@10': '0.0890', 'NDCG@10': '0.0469', 'HR@20': '0.1275', 'NDCG@20': '0.0566'}
2025-02-25 11:20:55,461 - EarlyStopping counter: 1 out of 10
2025-02-25 11:21:00,498 - {'epoch': 30, 'rec_loss': '5.3914'}
2025-02-25 11:21:01,189 - {'Epoch': 30, 'HR@5': '0.0541', 'NDCG@5': '0.0359', 'HR@10': '0.0862', 'NDCG@10': '0.0463', 'HR@20': '0.1303', 'NDCG@20': '0.0573'}
2025-02-25 11:21:01,190 - EarlyStopping counter: 2 out of 10
2025-02-25 11:21:06,197 - {'epoch': 31, 'rec_loss': '5.4092'}
2025-02-25 11:21:06,829 - {'Epoch': 31, 'HR@5': '0.0596', 'NDCG@5': '0.0370', 'HR@10': '0.0835', 'NDCG@10': '0.0446', 'HR@20': '0.1312', 'NDCG@20': '0.0566'}
2025-02-25 11:21:06,830 - EarlyStopping counter: 3 out of 10
2025-02-25 11:21:11,860 - {'epoch': 32, 'rec_loss': '5.3805'}
2025-02-25 11:21:12,481 - {'Epoch': 32, 'HR@5': '0.0624', 'NDCG@5': '0.0399', 'HR@10': '0.0936', 'NDCG@10': '0.0499', 'HR@20': '0.1339', 'NDCG@20': '0.0598'}
2025-02-25 11:21:12,482 - Validation score increased.  Saving model ...
2025-02-25 11:21:17,460 - {'epoch': 33, 'rec_loss': '5.3573'}
2025-02-25 11:21:18,106 - {'Epoch': 33, 'HR@5': '0.0606', 'NDCG@5': '0.0375', 'HR@10': '0.0872', 'NDCG@10': '0.0463', 'HR@20': '0.1367', 'NDCG@20': '0.0587'}
2025-02-25 11:21:18,107 - EarlyStopping counter: 1 out of 10
2025-02-25 11:21:23,345 - {'epoch': 34, 'rec_loss': '5.3640'}
2025-02-25 11:21:24,002 - {'Epoch': 34, 'HR@5': '0.0560', 'NDCG@5': '0.0364', 'HR@10': '0.0908', 'NDCG@10': '0.0477', 'HR@20': '0.1339', 'NDCG@20': '0.0584'}
2025-02-25 11:21:24,003 - EarlyStopping counter: 2 out of 10
2025-02-25 11:21:29,326 - {'epoch': 35, 'rec_loss': '5.3315'}
2025-02-25 11:21:29,933 - {'Epoch': 35, 'HR@5': '0.0578', 'NDCG@5': '0.0367', 'HR@10': '0.0881', 'NDCG@10': '0.0466', 'HR@20': '0.1376', 'NDCG@20': '0.0592'}
2025-02-25 11:21:29,934 - EarlyStopping counter: 3 out of 10
2025-02-25 11:21:34,957 - {'epoch': 36, 'rec_loss': '5.3332'}
2025-02-25 11:21:35,570 - {'Epoch': 36, 'HR@5': '0.0606', 'NDCG@5': '0.0394', 'HR@10': '0.0936', 'NDCG@10': '0.0500', 'HR@20': '0.1303', 'NDCG@20': '0.0591'}
2025-02-25 11:21:35,571 - EarlyStopping counter: 4 out of 10
2025-02-25 11:21:40,852 - {'epoch': 37, 'rec_loss': '5.3167'}
2025-02-25 11:21:41,525 - {'Epoch': 37, 'HR@5': '0.0624', 'NDCG@5': '0.0399', 'HR@10': '0.0972', 'NDCG@10': '0.0510', 'HR@20': '0.1404', 'NDCG@20': '0.0617'}
2025-02-25 11:21:41,526 - Validation score increased.  Saving model ...
2025-02-25 11:21:46,973 - {'epoch': 38, 'rec_loss': '5.3162'}
2025-02-25 11:21:47,649 - {'Epoch': 38, 'HR@5': '0.0587', 'NDCG@5': '0.0385', 'HR@10': '0.0945', 'NDCG@10': '0.0500', 'HR@20': '0.1459', 'NDCG@20': '0.0625'}
2025-02-25 11:21:47,650 - Validation score increased.  Saving model ...
2025-02-25 11:21:52,657 - {'epoch': 39, 'rec_loss': '5.3095'}
2025-02-25 11:21:53,317 - {'Epoch': 39, 'HR@5': '0.0615', 'NDCG@5': '0.0395', 'HR@10': '0.0954', 'NDCG@10': '0.0504', 'HR@20': '0.1450', 'NDCG@20': '0.0626'}
2025-02-25 11:21:53,318 - Validation score increased.  Saving model ...
2025-02-25 11:21:58,344 - {'epoch': 40, 'rec_loss': '5.2845'}
2025-02-25 11:21:59,054 - {'Epoch': 40, 'HR@5': '0.0615', 'NDCG@5': '0.0405', 'HR@10': '0.0954', 'NDCG@10': '0.0515', 'HR@20': '0.1413', 'NDCG@20': '0.0627'}
2025-02-25 11:21:59,055 - Validation score increased.  Saving model ...
2025-02-25 11:22:04,159 - {'epoch': 41, 'rec_loss': '5.2933'}
2025-02-25 11:22:04,879 - {'Epoch': 41, 'HR@5': '0.0596', 'NDCG@5': '0.0387', 'HR@10': '0.0917', 'NDCG@10': '0.0491', 'HR@20': '0.1404', 'NDCG@20': '0.0613'}
2025-02-25 11:22:04,881 - EarlyStopping counter: 1 out of 10
2025-02-25 11:22:09,793 - {'epoch': 42, 'rec_loss': '5.2849'}
2025-02-25 11:22:10,434 - {'Epoch': 42, 'HR@5': '0.0642', 'NDCG@5': '0.0408', 'HR@10': '0.0945', 'NDCG@10': '0.0504', 'HR@20': '0.1404', 'NDCG@20': '0.0617'}
2025-02-25 11:22:10,435 - EarlyStopping counter: 2 out of 10
2025-02-25 11:22:15,392 - {'epoch': 43, 'rec_loss': '5.2769'}
2025-02-25 11:22:16,036 - {'Epoch': 43, 'HR@5': '0.0661', 'NDCG@5': '0.0422', 'HR@10': '0.0936', 'NDCG@10': '0.0511', 'HR@20': '0.1431', 'NDCG@20': '0.0635'}
2025-02-25 11:22:16,037 - Validation score increased.  Saving model ...
2025-02-25 11:22:21,557 - {'epoch': 44, 'rec_loss': '5.2610'}
2025-02-25 11:22:22,254 - {'Epoch': 44, 'HR@5': '0.0615', 'NDCG@5': '0.0397', 'HR@10': '0.0954', 'NDCG@10': '0.0506', 'HR@20': '0.1422', 'NDCG@20': '0.0621'}
2025-02-25 11:22:22,255 - EarlyStopping counter: 1 out of 10
2025-02-25 11:22:27,250 - {'epoch': 45, 'rec_loss': '5.2570'}
2025-02-25 11:22:27,933 - {'Epoch': 45, 'HR@5': '0.0633', 'NDCG@5': '0.0403', 'HR@10': '0.0908', 'NDCG@10': '0.0492', 'HR@20': '0.1367', 'NDCG@20': '0.0608'}
2025-02-25 11:22:27,934 - EarlyStopping counter: 2 out of 10
2025-02-25 11:22:32,904 - {'epoch': 46, 'rec_loss': '5.2462'}
2025-02-25 11:22:33,551 - {'Epoch': 46, 'HR@5': '0.0615', 'NDCG@5': '0.0386', 'HR@10': '0.0954', 'NDCG@10': '0.0496', 'HR@20': '0.1440', 'NDCG@20': '0.0618'}
2025-02-25 11:22:33,552 - EarlyStopping counter: 3 out of 10
2025-02-25 11:22:38,579 - {'epoch': 47, 'rec_loss': '5.2484'}
2025-02-25 11:22:39,271 - {'Epoch': 47, 'HR@5': '0.0642', 'NDCG@5': '0.0408', 'HR@10': '0.0945', 'NDCG@10': '0.0507', 'HR@20': '0.1505', 'NDCG@20': '0.0645'}
2025-02-25 11:22:39,272 - Validation score increased.  Saving model ...
2025-02-25 11:22:44,107 - {'epoch': 48, 'rec_loss': '5.2460'}
2025-02-25 11:22:44,741 - {'Epoch': 48, 'HR@5': '0.0615', 'NDCG@5': '0.0399', 'HR@10': '0.0936', 'NDCG@10': '0.0504', 'HR@20': '0.1486', 'NDCG@20': '0.0642'}
2025-02-25 11:22:44,742 - EarlyStopping counter: 1 out of 10
2025-02-25 11:22:49,547 - {'epoch': 49, 'rec_loss': '5.2361'}
2025-02-25 11:22:50,246 - {'Epoch': 49, 'HR@5': '0.0615', 'NDCG@5': '0.0404', 'HR@10': '0.0927', 'NDCG@10': '0.0505', 'HR@20': '0.1459', 'NDCG@20': '0.0636'}
2025-02-25 11:22:50,247 - EarlyStopping counter: 2 out of 10
2025-02-25 11:22:55,244 - {'epoch': 50, 'rec_loss': '5.2398'}
2025-02-25 11:22:55,903 - {'Epoch': 50, 'HR@5': '0.0606', 'NDCG@5': '0.0384', 'HR@10': '0.0927', 'NDCG@10': '0.0488', 'HR@20': '0.1431', 'NDCG@20': '0.0615'}
2025-02-25 11:22:55,904 - EarlyStopping counter: 3 out of 10
2025-02-25 11:23:00,960 - {'epoch': 51, 'rec_loss': '5.2105'}
2025-02-25 11:23:01,606 - {'Epoch': 51, 'HR@5': '0.0606', 'NDCG@5': '0.0391', 'HR@10': '0.0899', 'NDCG@10': '0.0487', 'HR@20': '0.1468', 'NDCG@20': '0.0628'}
2025-02-25 11:23:01,607 - EarlyStopping counter: 4 out of 10
2025-02-25 11:23:06,621 - {'epoch': 52, 'rec_loss': '5.2003'}
2025-02-25 11:23:07,258 - {'Epoch': 52, 'HR@5': '0.0651', 'NDCG@5': '0.0406', 'HR@10': '0.0954', 'NDCG@10': '0.0504', 'HR@20': '0.1413', 'NDCG@20': '0.0618'}
2025-02-25 11:23:07,259 - EarlyStopping counter: 5 out of 10
2025-02-25 11:23:12,059 - {'epoch': 53, 'rec_loss': '5.2116'}
2025-02-25 11:23:12,783 - {'Epoch': 53, 'HR@5': '0.0661', 'NDCG@5': '0.0413', 'HR@10': '0.0954', 'NDCG@10': '0.0508', 'HR@20': '0.1486', 'NDCG@20': '0.0639'}
2025-02-25 11:23:12,785 - EarlyStopping counter: 6 out of 10
2025-02-25 11:23:17,889 - {'epoch': 54, 'rec_loss': '5.2103'}
2025-02-25 11:23:18,555 - {'Epoch': 54, 'HR@5': '0.0642', 'NDCG@5': '0.0406', 'HR@10': '0.0927', 'NDCG@10': '0.0498', 'HR@20': '0.1422', 'NDCG@20': '0.0623'}
2025-02-25 11:23:18,556 - EarlyStopping counter: 7 out of 10
2025-02-25 11:23:23,502 - {'epoch': 55, 'rec_loss': '5.2062'}
2025-02-25 11:23:24,163 - {'Epoch': 55, 'HR@5': '0.0651', 'NDCG@5': '0.0419', 'HR@10': '0.0972', 'NDCG@10': '0.0522', 'HR@20': '0.1459', 'NDCG@20': '0.0643'}
2025-02-25 11:23:24,164 - EarlyStopping counter: 8 out of 10
2025-02-25 11:23:29,228 - {'epoch': 56, 'rec_loss': '5.2098'}
2025-02-25 11:23:29,922 - {'Epoch': 56, 'HR@5': '0.0569', 'NDCG@5': '0.0388', 'HR@10': '0.1018', 'NDCG@10': '0.0534', 'HR@20': '0.1468', 'NDCG@20': '0.0645'}
2025-02-25 11:23:29,924 - EarlyStopping counter: 9 out of 10
2025-02-25 11:23:35,048 - {'epoch': 57, 'rec_loss': '5.2065'}
2025-02-25 11:23:35,767 - {'Epoch': 57, 'HR@5': '0.0606', 'NDCG@5': '0.0388', 'HR@10': '0.0982', 'NDCG@10': '0.0514', 'HR@20': '0.1486', 'NDCG@20': '0.0639'}
2025-02-25 11:23:35,769 - EarlyStopping counter: 10 out of 10
2025-02-25 11:23:35,769 - Early stopping
2025-02-25 11:23:35,769 - ---------------Test Score---------------
2025-02-25 11:23:36,436 - {'Epoch': 0, 'HR@5': '0.0523', 'NDCG@5': '0.0348', 'HR@10': '0.0725', 'NDCG@10': '0.0413', 'HR@20': '0.0991', 'NDCG@20': '0.0480'}
2025-02-25 11:23:36,437 - Scale_LastFM
2025-02-25 11:23:36,437 - {'Epoch': 0, 'HR@5': '0.0523', 'NDCG@5': '0.0348', 'HR@10': '0.0725', 'NDCG@10': '0.0413', 'HR@20': '0.0991', 'NDCG@20': '0.0480'}
2025-02-25 11:27:16,228 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10, 5], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-25 11:27:19,005 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-25 11:27:19,009 - Total Parameters: 387025
2025-02-25 11:27:26,908 - {'epoch': 0, 'rec_loss': '8.0680'}
2025-02-25 11:27:27,582 - {'Epoch': 0, 'HR@5': '0.0275', 'NDCG@5': '0.0178', 'HR@10': '0.0413', 'NDCG@10': '0.0221', 'HR@20': '0.0624', 'NDCG@20': '0.0274'}
2025-02-25 11:27:27,584 - Validation score increased.  Saving model ...
2025-02-25 11:27:34,283 - {'epoch': 1, 'rec_loss': '7.7245'}
2025-02-25 11:27:34,990 - {'Epoch': 1, 'HR@5': '0.0165', 'NDCG@5': '0.0113', 'HR@10': '0.0321', 'NDCG@10': '0.0163', 'HR@20': '0.0532', 'NDCG@20': '0.0217'}
2025-02-25 11:27:34,992 - EarlyStopping counter: 1 out of 10
2025-02-25 11:27:41,760 - {'epoch': 2, 'rec_loss': '7.4742'}
2025-02-25 11:27:42,474 - {'Epoch': 2, 'HR@5': '0.0220', 'NDCG@5': '0.0160', 'HR@10': '0.0440', 'NDCG@10': '0.0227', 'HR@20': '0.0716', 'NDCG@20': '0.0297'}
2025-02-25 11:27:42,475 - Validation score increased.  Saving model ...
2025-02-25 11:27:49,213 - {'epoch': 3, 'rec_loss': '7.1890'}
2025-02-25 11:27:49,914 - {'Epoch': 3, 'HR@5': '0.0349', 'NDCG@5': '0.0223', 'HR@10': '0.0486', 'NDCG@10': '0.0267', 'HR@20': '0.0697', 'NDCG@20': '0.0320'}
2025-02-25 11:27:49,916 - Validation score increased.  Saving model ...
2025-02-25 11:27:56,656 - {'epoch': 4, 'rec_loss': '6.9080'}
2025-02-25 11:27:57,310 - {'Epoch': 4, 'HR@5': '0.0339', 'NDCG@5': '0.0250', 'HR@10': '0.0578', 'NDCG@10': '0.0326', 'HR@20': '0.0844', 'NDCG@20': '0.0392'}
2025-02-25 11:27:57,312 - Validation score increased.  Saving model ...
2025-02-25 11:28:03,542 - {'epoch': 5, 'rec_loss': '6.6604'}
2025-02-25 11:28:04,178 - {'Epoch': 5, 'HR@5': '0.0422', 'NDCG@5': '0.0277', 'HR@10': '0.0688', 'NDCG@10': '0.0360', 'HR@20': '0.0936', 'NDCG@20': '0.0422'}
2025-02-25 11:28:04,180 - Validation score increased.  Saving model ...
2025-02-25 11:28:10,613 - {'epoch': 6, 'rec_loss': '6.4441'}
2025-02-25 11:28:11,298 - {'Epoch': 6, 'HR@5': '0.0440', 'NDCG@5': '0.0298', 'HR@10': '0.0642', 'NDCG@10': '0.0361', 'HR@20': '0.1073', 'NDCG@20': '0.0469'}
2025-02-25 11:28:11,299 - Validation score increased.  Saving model ...
2025-02-25 11:28:17,212 - {'epoch': 7, 'rec_loss': '6.2704'}
2025-02-25 11:28:17,944 - {'Epoch': 7, 'HR@5': '0.0486', 'NDCG@5': '0.0346', 'HR@10': '0.0651', 'NDCG@10': '0.0398', 'HR@20': '0.1073', 'NDCG@20': '0.0506'}
2025-02-25 11:28:17,945 - Validation score increased.  Saving model ...
2025-02-25 11:28:24,498 - {'epoch': 8, 'rec_loss': '6.1230'}
2025-02-25 11:28:25,161 - {'Epoch': 8, 'HR@5': '0.0468', 'NDCG@5': '0.0315', 'HR@10': '0.0761', 'NDCG@10': '0.0407', 'HR@20': '0.1138', 'NDCG@20': '0.0502'}
2025-02-25 11:28:25,162 - EarlyStopping counter: 1 out of 10
2025-02-25 11:28:31,489 - {'epoch': 9, 'rec_loss': '5.9820'}
2025-02-25 11:28:32,153 - {'Epoch': 9, 'HR@5': '0.0514', 'NDCG@5': '0.0340', 'HR@10': '0.0780', 'NDCG@10': '0.0425', 'HR@20': '0.1110', 'NDCG@20': '0.0510'}
2025-02-25 11:28:32,154 - Validation score increased.  Saving model ...
2025-02-25 11:28:38,240 - {'epoch': 10, 'rec_loss': '5.8825'}
2025-02-25 11:28:38,981 - {'Epoch': 10, 'HR@5': '0.0615', 'NDCG@5': '0.0405', 'HR@10': '0.0853', 'NDCG@10': '0.0482', 'HR@20': '0.1220', 'NDCG@20': '0.0575'}
2025-02-25 11:28:38,983 - Validation score increased.  Saving model ...
2025-02-25 11:28:45,114 - {'epoch': 11, 'rec_loss': '5.8097'}
2025-02-25 11:28:45,801 - {'Epoch': 11, 'HR@5': '0.0541', 'NDCG@5': '0.0352', 'HR@10': '0.0917', 'NDCG@10': '0.0472', 'HR@20': '0.1257', 'NDCG@20': '0.0557'}
2025-02-25 11:28:45,802 - EarlyStopping counter: 1 out of 10
2025-02-25 11:28:52,310 - {'epoch': 12, 'rec_loss': '5.7245'}
2025-02-25 11:28:52,993 - {'Epoch': 12, 'HR@5': '0.0569', 'NDCG@5': '0.0367', 'HR@10': '0.0835', 'NDCG@10': '0.0453', 'HR@20': '0.1294', 'NDCG@20': '0.0568'}
2025-02-25 11:28:52,994 - EarlyStopping counter: 2 out of 10
2025-02-25 11:28:59,436 - {'epoch': 13, 'rec_loss': '5.6750'}
2025-02-25 11:29:00,129 - {'Epoch': 13, 'HR@5': '0.0569', 'NDCG@5': '0.0363', 'HR@10': '0.0890', 'NDCG@10': '0.0467', 'HR@20': '0.1321', 'NDCG@20': '0.0576'}
2025-02-25 11:29:00,130 - Validation score increased.  Saving model ...
2025-02-25 11:29:06,813 - {'epoch': 14, 'rec_loss': '5.6284'}
2025-02-25 11:29:07,479 - {'Epoch': 14, 'HR@5': '0.0495', 'NDCG@5': '0.0342', 'HR@10': '0.0853', 'NDCG@10': '0.0459', 'HR@20': '0.1220', 'NDCG@20': '0.0552'}
2025-02-25 11:29:07,480 - EarlyStopping counter: 1 out of 10
2025-02-25 11:29:13,826 - {'epoch': 15, 'rec_loss': '5.5797'}
2025-02-25 11:29:14,514 - {'Epoch': 15, 'HR@5': '0.0505', 'NDCG@5': '0.0310', 'HR@10': '0.0881', 'NDCG@10': '0.0433', 'HR@20': '0.1294', 'NDCG@20': '0.0538'}
2025-02-25 11:29:14,516 - EarlyStopping counter: 2 out of 10
2025-02-25 11:29:20,737 - {'epoch': 16, 'rec_loss': '5.5368'}
2025-02-25 11:29:21,501 - {'Epoch': 16, 'HR@5': '0.0532', 'NDCG@5': '0.0346', 'HR@10': '0.0908', 'NDCG@10': '0.0467', 'HR@20': '0.1294', 'NDCG@20': '0.0564'}
2025-02-25 11:29:21,503 - EarlyStopping counter: 3 out of 10
2025-02-25 11:29:27,788 - {'epoch': 17, 'rec_loss': '5.4991'}
2025-02-25 11:29:28,506 - {'Epoch': 17, 'HR@5': '0.0550', 'NDCG@5': '0.0338', 'HR@10': '0.0844', 'NDCG@10': '0.0435', 'HR@20': '0.1294', 'NDCG@20': '0.0550'}
2025-02-25 11:29:28,508 - EarlyStopping counter: 4 out of 10
2025-02-25 11:29:34,724 - {'epoch': 18, 'rec_loss': '5.4694'}
2025-02-25 11:29:35,402 - {'Epoch': 18, 'HR@5': '0.0532', 'NDCG@5': '0.0326', 'HR@10': '0.0881', 'NDCG@10': '0.0438', 'HR@20': '0.1312', 'NDCG@20': '0.0546'}
2025-02-25 11:29:35,403 - EarlyStopping counter: 5 out of 10
2025-02-25 11:29:42,083 - {'epoch': 19, 'rec_loss': '5.4404'}
2025-02-25 11:29:42,763 - {'Epoch': 19, 'HR@5': '0.0578', 'NDCG@5': '0.0382', 'HR@10': '0.0936', 'NDCG@10': '0.0498', 'HR@20': '0.1367', 'NDCG@20': '0.0607'}
2025-02-25 11:29:42,764 - Validation score increased.  Saving model ...
2025-02-25 11:29:49,782 - {'epoch': 20, 'rec_loss': '5.4395'}
2025-02-25 11:29:50,510 - {'Epoch': 20, 'HR@5': '0.0541', 'NDCG@5': '0.0353', 'HR@10': '0.0908', 'NDCG@10': '0.0470', 'HR@20': '0.1339', 'NDCG@20': '0.0578'}
2025-02-25 11:29:50,512 - EarlyStopping counter: 1 out of 10
2025-02-25 11:29:57,425 - {'epoch': 21, 'rec_loss': '5.4034'}
2025-02-25 11:29:58,202 - {'Epoch': 21, 'HR@5': '0.0560', 'NDCG@5': '0.0362', 'HR@10': '0.0945', 'NDCG@10': '0.0489', 'HR@20': '0.1376', 'NDCG@20': '0.0596'}
2025-02-25 11:29:58,204 - EarlyStopping counter: 2 out of 10
2025-02-25 11:30:04,910 - {'epoch': 22, 'rec_loss': '5.3788'}
2025-02-25 11:30:05,670 - {'Epoch': 22, 'HR@5': '0.0578', 'NDCG@5': '0.0371', 'HR@10': '0.0963', 'NDCG@10': '0.0496', 'HR@20': '0.1394', 'NDCG@20': '0.0603'}
2025-02-25 11:30:05,671 - EarlyStopping counter: 3 out of 10
2025-02-25 11:30:12,302 - {'epoch': 23, 'rec_loss': '5.3626'}
2025-02-25 11:30:12,984 - {'Epoch': 23, 'HR@5': '0.0523', 'NDCG@5': '0.0346', 'HR@10': '0.0927', 'NDCG@10': '0.0475', 'HR@20': '0.1367', 'NDCG@20': '0.0586'}
2025-02-25 11:30:12,986 - EarlyStopping counter: 4 out of 10
2025-02-25 11:30:19,866 - {'epoch': 24, 'rec_loss': '5.3334'}
2025-02-25 11:30:20,571 - {'Epoch': 24, 'HR@5': '0.0596', 'NDCG@5': '0.0374', 'HR@10': '0.0927', 'NDCG@10': '0.0481', 'HR@20': '0.1376', 'NDCG@20': '0.0594'}
2025-02-25 11:30:20,572 - EarlyStopping counter: 5 out of 10
2025-02-25 11:30:28,027 - {'epoch': 25, 'rec_loss': '5.3156'}
2025-02-25 11:30:28,704 - {'Epoch': 25, 'HR@5': '0.0569', 'NDCG@5': '0.0348', 'HR@10': '0.1018', 'NDCG@10': '0.0494', 'HR@20': '0.1358', 'NDCG@20': '0.0579'}
2025-02-25 11:30:28,705 - EarlyStopping counter: 6 out of 10
2025-02-25 11:30:35,444 - {'epoch': 26, 'rec_loss': '5.3119'}
2025-02-25 11:30:36,078 - {'Epoch': 26, 'HR@5': '0.0587', 'NDCG@5': '0.0368', 'HR@10': '0.0963', 'NDCG@10': '0.0489', 'HR@20': '0.1367', 'NDCG@20': '0.0590'}
2025-02-25 11:30:36,079 - EarlyStopping counter: 7 out of 10
2025-02-25 11:30:42,310 - {'epoch': 27, 'rec_loss': '5.2796'}
2025-02-25 11:30:43,081 - {'Epoch': 27, 'HR@5': '0.0578', 'NDCG@5': '0.0362', 'HR@10': '0.0936', 'NDCG@10': '0.0479', 'HR@20': '0.1440', 'NDCG@20': '0.0606'}
2025-02-25 11:30:43,082 - EarlyStopping counter: 8 out of 10
2025-02-25 11:30:50,286 - {'epoch': 28, 'rec_loss': '5.2862'}
2025-02-25 11:30:51,013 - {'Epoch': 28, 'HR@5': '0.0587', 'NDCG@5': '0.0359', 'HR@10': '0.0927', 'NDCG@10': '0.0472', 'HR@20': '0.1422', 'NDCG@20': '0.0595'}
2025-02-25 11:30:51,014 - EarlyStopping counter: 9 out of 10
2025-02-25 11:30:58,815 - {'epoch': 29, 'rec_loss': '5.2646'}
2025-02-25 11:30:59,516 - {'Epoch': 29, 'HR@5': '0.0560', 'NDCG@5': '0.0353', 'HR@10': '0.0927', 'NDCG@10': '0.0472', 'HR@20': '0.1514', 'NDCG@20': '0.0621'}
2025-02-25 11:30:59,517 - Validation score increased.  Saving model ...
2025-02-25 11:31:06,901 - {'epoch': 30, 'rec_loss': '5.2496'}
2025-02-25 11:31:07,613 - {'Epoch': 30, 'HR@5': '0.0578', 'NDCG@5': '0.0359', 'HR@10': '0.0945', 'NDCG@10': '0.0478', 'HR@20': '0.1486', 'NDCG@20': '0.0614'}
2025-02-25 11:31:07,615 - EarlyStopping counter: 1 out of 10
2025-02-25 11:31:13,845 - {'epoch': 31, 'rec_loss': '5.2350'}
2025-02-25 11:31:14,526 - {'Epoch': 31, 'HR@5': '0.0596', 'NDCG@5': '0.0362', 'HR@10': '0.0936', 'NDCG@10': '0.0472', 'HR@20': '0.1450', 'NDCG@20': '0.0601'}
2025-02-25 11:31:14,528 - EarlyStopping counter: 2 out of 10
2025-02-25 11:31:21,156 - {'epoch': 32, 'rec_loss': '5.2183'}
2025-02-25 11:31:21,870 - {'Epoch': 32, 'HR@5': '0.0596', 'NDCG@5': '0.0378', 'HR@10': '0.1000', 'NDCG@10': '0.0508', 'HR@20': '0.1440', 'NDCG@20': '0.0619'}
2025-02-25 11:31:21,871 - EarlyStopping counter: 3 out of 10
2025-02-25 11:31:28,565 - {'epoch': 33, 'rec_loss': '5.2283'}
2025-02-25 11:31:29,314 - {'Epoch': 33, 'HR@5': '0.0661', 'NDCG@5': '0.0396', 'HR@10': '0.0991', 'NDCG@10': '0.0501', 'HR@20': '0.1486', 'NDCG@20': '0.0625'}
2025-02-25 11:31:29,316 - Validation score increased.  Saving model ...
2025-02-25 11:31:35,952 - {'epoch': 34, 'rec_loss': '5.2026'}
2025-02-25 11:31:36,627 - {'Epoch': 34, 'HR@5': '0.0523', 'NDCG@5': '0.0329', 'HR@10': '0.0991', 'NDCG@10': '0.0481', 'HR@20': '0.1505', 'NDCG@20': '0.0611'}
2025-02-25 11:31:36,628 - EarlyStopping counter: 1 out of 10
2025-02-25 11:31:43,112 - {'epoch': 35, 'rec_loss': '5.1958'}
2025-02-25 11:31:43,830 - {'Epoch': 35, 'HR@5': '0.0606', 'NDCG@5': '0.0362', 'HR@10': '0.0982', 'NDCG@10': '0.0484', 'HR@20': '0.1532', 'NDCG@20': '0.0623'}
2025-02-25 11:31:43,831 - EarlyStopping counter: 2 out of 10
2025-02-25 11:31:50,126 - {'epoch': 36, 'rec_loss': '5.1881'}
2025-02-25 11:31:50,821 - {'Epoch': 36, 'HR@5': '0.0651', 'NDCG@5': '0.0396', 'HR@10': '0.1028', 'NDCG@10': '0.0517', 'HR@20': '0.1495', 'NDCG@20': '0.0635'}
2025-02-25 11:31:50,822 - Validation score increased.  Saving model ...
2025-02-25 11:31:57,375 - {'epoch': 37, 'rec_loss': '5.1745'}
2025-02-25 11:31:58,105 - {'Epoch': 37, 'HR@5': '0.0624', 'NDCG@5': '0.0371', 'HR@10': '0.1028', 'NDCG@10': '0.0501', 'HR@20': '0.1459', 'NDCG@20': '0.0610'}
2025-02-25 11:31:58,107 - EarlyStopping counter: 1 out of 10
2025-02-25 11:32:04,790 - {'epoch': 38, 'rec_loss': '5.1727'}
2025-02-25 11:32:05,451 - {'Epoch': 38, 'HR@5': '0.0651', 'NDCG@5': '0.0405', 'HR@10': '0.1046', 'NDCG@10': '0.0532', 'HR@20': '0.1495', 'NDCG@20': '0.0645'}
2025-02-25 11:32:05,452 - Validation score increased.  Saving model ...
2025-02-25 11:32:11,455 - {'epoch': 39, 'rec_loss': '5.1522'}
2025-02-25 11:32:12,188 - {'Epoch': 39, 'HR@5': '0.0651', 'NDCG@5': '0.0398', 'HR@10': '0.1073', 'NDCG@10': '0.0533', 'HR@20': '0.1468', 'NDCG@20': '0.0631'}
2025-02-25 11:32:12,189 - EarlyStopping counter: 1 out of 10
2025-02-25 11:32:18,083 - {'epoch': 40, 'rec_loss': '5.1478'}
2025-02-25 11:32:18,725 - {'Epoch': 40, 'HR@5': '0.0596', 'NDCG@5': '0.0371', 'HR@10': '0.1018', 'NDCG@10': '0.0506', 'HR@20': '0.1468', 'NDCG@20': '0.0617'}
2025-02-25 11:32:18,727 - EarlyStopping counter: 2 out of 10
2025-02-25 11:32:24,749 - {'epoch': 41, 'rec_loss': '5.1491'}
2025-02-25 11:32:25,504 - {'Epoch': 41, 'HR@5': '0.0615', 'NDCG@5': '0.0384', 'HR@10': '0.0991', 'NDCG@10': '0.0506', 'HR@20': '0.1477', 'NDCG@20': '0.0629'}
2025-02-25 11:32:25,505 - EarlyStopping counter: 3 out of 10
2025-02-25 11:32:31,843 - {'epoch': 42, 'rec_loss': '5.1154'}
2025-02-25 11:32:32,535 - {'Epoch': 42, 'HR@5': '0.0688', 'NDCG@5': '0.0422', 'HR@10': '0.1009', 'NDCG@10': '0.0526', 'HR@20': '0.1450', 'NDCG@20': '0.0638'}
2025-02-25 11:32:32,536 - EarlyStopping counter: 4 out of 10
2025-02-25 11:32:38,421 - {'epoch': 43, 'rec_loss': '5.1102'}
2025-02-25 11:32:39,125 - {'Epoch': 43, 'HR@5': '0.0651', 'NDCG@5': '0.0410', 'HR@10': '0.1046', 'NDCG@10': '0.0538', 'HR@20': '0.1477', 'NDCG@20': '0.0646'}
2025-02-25 11:32:39,127 - Validation score increased.  Saving model ...
2025-02-25 11:32:45,992 - {'epoch': 44, 'rec_loss': '5.1266'}
2025-02-25 11:32:46,684 - {'Epoch': 44, 'HR@5': '0.0642', 'NDCG@5': '0.0407', 'HR@10': '0.1073', 'NDCG@10': '0.0548', 'HR@20': '0.1523', 'NDCG@20': '0.0660'}
2025-02-25 11:32:46,685 - Validation score increased.  Saving model ...
2025-02-25 11:32:53,111 - {'epoch': 45, 'rec_loss': '5.0933'}
2025-02-25 11:32:53,794 - {'Epoch': 45, 'HR@5': '0.0624', 'NDCG@5': '0.0382', 'HR@10': '0.1037', 'NDCG@10': '0.0514', 'HR@20': '0.1541', 'NDCG@20': '0.0641'}
2025-02-25 11:32:53,796 - EarlyStopping counter: 1 out of 10
2025-02-25 11:33:00,741 - {'epoch': 46, 'rec_loss': '5.1342'}
2025-02-25 11:33:01,458 - {'Epoch': 46, 'HR@5': '0.0624', 'NDCG@5': '0.0365', 'HR@10': '0.0982', 'NDCG@10': '0.0482', 'HR@20': '0.1477', 'NDCG@20': '0.0606'}
2025-02-25 11:33:01,460 - EarlyStopping counter: 2 out of 10
2025-02-25 11:33:08,183 - {'epoch': 47, 'rec_loss': '5.0864'}
2025-02-25 11:33:08,860 - {'Epoch': 47, 'HR@5': '0.0642', 'NDCG@5': '0.0384', 'HR@10': '0.1000', 'NDCG@10': '0.0501', 'HR@20': '0.1514', 'NDCG@20': '0.0630'}
2025-02-25 11:33:08,861 - EarlyStopping counter: 3 out of 10
2025-02-25 11:33:15,161 - {'epoch': 48, 'rec_loss': '5.0989'}
2025-02-25 11:33:15,879 - {'Epoch': 48, 'HR@5': '0.0615', 'NDCG@5': '0.0378', 'HR@10': '0.1055', 'NDCG@10': '0.0520', 'HR@20': '0.1523', 'NDCG@20': '0.0638'}
2025-02-25 11:33:15,880 - EarlyStopping counter: 4 out of 10
2025-02-25 11:33:22,099 - {'epoch': 49, 'rec_loss': '5.0546'}
2025-02-25 11:33:22,831 - {'Epoch': 49, 'HR@5': '0.0596', 'NDCG@5': '0.0361', 'HR@10': '0.1028', 'NDCG@10': '0.0498', 'HR@20': '0.1541', 'NDCG@20': '0.0630'}
2025-02-25 11:33:22,832 - EarlyStopping counter: 5 out of 10
2025-02-25 11:33:29,130 - {'epoch': 50, 'rec_loss': '5.0700'}
2025-02-25 11:33:29,806 - {'Epoch': 50, 'HR@5': '0.0606', 'NDCG@5': '0.0385', 'HR@10': '0.1028', 'NDCG@10': '0.0519', 'HR@20': '0.1541', 'NDCG@20': '0.0648'}
2025-02-25 11:33:29,807 - EarlyStopping counter: 6 out of 10
2025-02-25 11:33:35,791 - {'epoch': 51, 'rec_loss': '5.0720'}
2025-02-25 11:33:36,503 - {'Epoch': 51, 'HR@5': '0.0587', 'NDCG@5': '0.0372', 'HR@10': '0.1009', 'NDCG@10': '0.0506', 'HR@20': '0.1532', 'NDCG@20': '0.0638'}
2025-02-25 11:33:36,505 - EarlyStopping counter: 7 out of 10
2025-02-25 11:33:42,459 - {'epoch': 52, 'rec_loss': '5.0514'}
2025-02-25 11:33:43,145 - {'Epoch': 52, 'HR@5': '0.0651', 'NDCG@5': '0.0408', 'HR@10': '0.1009', 'NDCG@10': '0.0523', 'HR@20': '0.1560', 'NDCG@20': '0.0662'}
2025-02-25 11:33:43,146 - Validation score increased.  Saving model ...
2025-02-25 11:33:49,566 - {'epoch': 53, 'rec_loss': '5.0392'}
2025-02-25 11:33:50,274 - {'Epoch': 53, 'HR@5': '0.0615', 'NDCG@5': '0.0395', 'HR@10': '0.1073', 'NDCG@10': '0.0541', 'HR@20': '0.1541', 'NDCG@20': '0.0658'}
2025-02-25 11:33:50,275 - EarlyStopping counter: 1 out of 10
2025-02-25 11:33:56,827 - {'epoch': 54, 'rec_loss': '5.0560'}
2025-02-25 11:33:57,474 - {'Epoch': 54, 'HR@5': '0.0651', 'NDCG@5': '0.0381', 'HR@10': '0.1000', 'NDCG@10': '0.0494', 'HR@20': '0.1541', 'NDCG@20': '0.0630'}
2025-02-25 11:33:57,475 - EarlyStopping counter: 2 out of 10
2025-02-25 11:34:03,461 - {'epoch': 55, 'rec_loss': '5.0480'}
2025-02-25 11:34:04,153 - {'Epoch': 55, 'HR@5': '0.0642', 'NDCG@5': '0.0397', 'HR@10': '0.1009', 'NDCG@10': '0.0514', 'HR@20': '0.1569', 'NDCG@20': '0.0655'}
2025-02-25 11:34:04,155 - EarlyStopping counter: 3 out of 10
2025-02-25 11:34:10,044 - {'epoch': 56, 'rec_loss': '5.0144'}
2025-02-25 11:34:10,730 - {'Epoch': 56, 'HR@5': '0.0670', 'NDCG@5': '0.0413', 'HR@10': '0.0982', 'NDCG@10': '0.0515', 'HR@20': '0.1541', 'NDCG@20': '0.0656'}
2025-02-25 11:34:10,731 - EarlyStopping counter: 4 out of 10
2025-02-25 11:34:16,858 - {'epoch': 57, 'rec_loss': '5.0095'}
2025-02-25 11:34:17,517 - {'Epoch': 57, 'HR@5': '0.0642', 'NDCG@5': '0.0388', 'HR@10': '0.1055', 'NDCG@10': '0.0519', 'HR@20': '0.1550', 'NDCG@20': '0.0644'}
2025-02-25 11:34:17,518 - EarlyStopping counter: 5 out of 10
2025-02-25 11:34:23,918 - {'epoch': 58, 'rec_loss': '5.0242'}
2025-02-25 11:34:24,590 - {'Epoch': 58, 'HR@5': '0.0651', 'NDCG@5': '0.0396', 'HR@10': '0.1009', 'NDCG@10': '0.0509', 'HR@20': '0.1523', 'NDCG@20': '0.0637'}
2025-02-25 11:34:24,591 - EarlyStopping counter: 6 out of 10
2025-02-25 11:34:30,974 - {'epoch': 59, 'rec_loss': '5.0213'}
2025-02-25 11:34:31,775 - {'Epoch': 59, 'HR@5': '0.0578', 'NDCG@5': '0.0358', 'HR@10': '0.0972', 'NDCG@10': '0.0488', 'HR@20': '0.1459', 'NDCG@20': '0.0611'}
2025-02-25 11:34:31,776 - EarlyStopping counter: 7 out of 10
2025-02-25 11:34:38,224 - {'epoch': 60, 'rec_loss': '4.9904'}
2025-02-25 11:34:39,036 - {'Epoch': 60, 'HR@5': '0.0651', 'NDCG@5': '0.0392', 'HR@10': '0.1028', 'NDCG@10': '0.0515', 'HR@20': '0.1541', 'NDCG@20': '0.0644'}
2025-02-25 11:34:39,037 - EarlyStopping counter: 8 out of 10
2025-02-25 11:34:45,441 - {'epoch': 61, 'rec_loss': '5.0091'}
2025-02-25 11:34:46,192 - {'Epoch': 61, 'HR@5': '0.0651', 'NDCG@5': '0.0403', 'HR@10': '0.1037', 'NDCG@10': '0.0526', 'HR@20': '0.1495', 'NDCG@20': '0.0642'}
2025-02-25 11:34:46,193 - EarlyStopping counter: 9 out of 10
2025-02-25 11:34:52,361 - {'epoch': 62, 'rec_loss': '4.9997'}
2025-02-25 11:34:53,044 - {'Epoch': 62, 'HR@5': '0.0615', 'NDCG@5': '0.0389', 'HR@10': '0.1055', 'NDCG@10': '0.0528', 'HR@20': '0.1532', 'NDCG@20': '0.0646'}
2025-02-25 11:34:53,045 - EarlyStopping counter: 10 out of 10
2025-02-25 11:34:53,045 - Early stopping
2025-02-25 11:34:53,045 - ---------------Test Score---------------
2025-02-25 11:34:53,820 - {'Epoch': 0, 'HR@5': '0.0486', 'NDCG@5': '0.0351', 'HR@10': '0.0697', 'NDCG@10': '0.0416', 'HR@20': '0.1064', 'NDCG@20': '0.0509'}
2025-02-25 11:34:53,821 - Scale_LastFM
2025-02-25 11:34:53,821 - {'Epoch': 0, 'HR@5': '0.0486', 'NDCG@5': '0.0351', 'HR@10': '0.0697', 'NDCG@10': '0.0416', 'HR@20': '0.1064', 'NDCG@20': '0.0509'}
2025-02-25 11:41:24,234 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25, 10], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-25 11:41:27,028 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-25 11:41:27,032 - Total Parameters: 387350
2025-02-25 11:41:34,657 - {'epoch': 0, 'rec_loss': '8.0680'}
2025-02-25 11:41:35,411 - {'Epoch': 0, 'HR@5': '0.0275', 'NDCG@5': '0.0190', 'HR@10': '0.0385', 'NDCG@10': '0.0224', 'HR@20': '0.0606', 'NDCG@20': '0.0280'}
2025-02-25 11:41:35,412 - Validation score increased.  Saving model ...
2025-02-25 11:41:42,849 - {'epoch': 1, 'rec_loss': '7.7389'}
2025-02-25 11:41:43,504 - {'Epoch': 1, 'HR@5': '0.0275', 'NDCG@5': '0.0169', 'HR@10': '0.0385', 'NDCG@10': '0.0205', 'HR@20': '0.0624', 'NDCG@20': '0.0264'}
2025-02-25 11:41:43,506 - EarlyStopping counter: 1 out of 10
2025-02-25 11:41:49,981 - {'epoch': 2, 'rec_loss': '7.5021'}
2025-02-25 11:41:50,737 - {'Epoch': 2, 'HR@5': '0.0266', 'NDCG@5': '0.0182', 'HR@10': '0.0376', 'NDCG@10': '0.0217', 'HR@20': '0.0633', 'NDCG@20': '0.0281'}
2025-02-25 11:41:50,739 - Validation score increased.  Saving model ...
2025-02-25 11:41:57,175 - {'epoch': 3, 'rec_loss': '7.2139'}
2025-02-25 11:41:57,836 - {'Epoch': 3, 'HR@5': '0.0303', 'NDCG@5': '0.0193', 'HR@10': '0.0450', 'NDCG@10': '0.0240', 'HR@20': '0.0752', 'NDCG@20': '0.0316'}
2025-02-25 11:41:57,837 - Validation score increased.  Saving model ...
2025-02-25 11:42:03,885 - {'epoch': 4, 'rec_loss': '6.9241'}
2025-02-25 11:42:04,608 - {'Epoch': 4, 'HR@5': '0.0376', 'NDCG@5': '0.0244', 'HR@10': '0.0560', 'NDCG@10': '0.0303', 'HR@20': '0.0881', 'NDCG@20': '0.0383'}
2025-02-25 11:42:04,609 - Validation score increased.  Saving model ...
2025-02-25 11:42:11,292 - {'epoch': 5, 'rec_loss': '6.6635'}
2025-02-25 11:42:12,007 - {'Epoch': 5, 'HR@5': '0.0404', 'NDCG@5': '0.0272', 'HR@10': '0.0642', 'NDCG@10': '0.0348', 'HR@20': '0.0936', 'NDCG@20': '0.0420'}
2025-02-25 11:42:12,009 - Validation score increased.  Saving model ...
2025-02-25 11:42:18,833 - {'epoch': 6, 'rec_loss': '6.4512'}
2025-02-25 11:42:19,611 - {'Epoch': 6, 'HR@5': '0.0422', 'NDCG@5': '0.0290', 'HR@10': '0.0633', 'NDCG@10': '0.0357', 'HR@20': '0.0982', 'NDCG@20': '0.0444'}
2025-02-25 11:42:19,613 - Validation score increased.  Saving model ...
2025-02-25 11:42:26,896 - {'epoch': 7, 'rec_loss': '6.2669'}
2025-02-25 11:42:27,659 - {'Epoch': 7, 'HR@5': '0.0450', 'NDCG@5': '0.0305', 'HR@10': '0.0670', 'NDCG@10': '0.0378', 'HR@20': '0.1018', 'NDCG@20': '0.0465'}
2025-02-25 11:42:27,660 - Validation score increased.  Saving model ...
2025-02-25 11:42:34,200 - {'epoch': 8, 'rec_loss': '6.1020'}
2025-02-25 11:42:34,967 - {'Epoch': 8, 'HR@5': '0.0514', 'NDCG@5': '0.0355', 'HR@10': '0.0743', 'NDCG@10': '0.0428', 'HR@20': '0.1165', 'NDCG@20': '0.0535'}
2025-02-25 11:42:34,968 - Validation score increased.  Saving model ...
2025-02-25 11:42:41,698 - {'epoch': 9, 'rec_loss': '5.9923'}
2025-02-25 11:42:42,429 - {'Epoch': 9, 'HR@5': '0.0569', 'NDCG@5': '0.0367', 'HR@10': '0.0798', 'NDCG@10': '0.0442', 'HR@20': '0.1248', 'NDCG@20': '0.0554'}
2025-02-25 11:42:42,431 - Validation score increased.  Saving model ...
2025-02-25 11:42:49,344 - {'epoch': 10, 'rec_loss': '5.8862'}
2025-02-25 11:42:50,101 - {'Epoch': 10, 'HR@5': '0.0606', 'NDCG@5': '0.0384', 'HR@10': '0.0807', 'NDCG@10': '0.0449', 'HR@20': '0.1303', 'NDCG@20': '0.0571'}
2025-02-25 11:42:50,102 - Validation score increased.  Saving model ...
2025-02-25 11:42:57,089 - {'epoch': 11, 'rec_loss': '5.7916'}
2025-02-25 11:42:57,779 - {'Epoch': 11, 'HR@5': '0.0541', 'NDCG@5': '0.0363', 'HR@10': '0.0798', 'NDCG@10': '0.0446', 'HR@20': '0.1349', 'NDCG@20': '0.0583'}
2025-02-25 11:42:57,780 - Validation score increased.  Saving model ...
2025-02-25 11:43:04,046 - {'epoch': 12, 'rec_loss': '5.7376'}
2025-02-25 11:43:04,812 - {'Epoch': 12, 'HR@5': '0.0569', 'NDCG@5': '0.0379', 'HR@10': '0.0890', 'NDCG@10': '0.0481', 'HR@20': '0.1339', 'NDCG@20': '0.0594'}
2025-02-25 11:43:04,814 - Validation score increased.  Saving model ...
2025-02-25 11:43:11,611 - {'epoch': 13, 'rec_loss': '5.6795'}
2025-02-25 11:43:12,324 - {'Epoch': 13, 'HR@5': '0.0560', 'NDCG@5': '0.0350', 'HR@10': '0.0872', 'NDCG@10': '0.0450', 'HR@20': '0.1330', 'NDCG@20': '0.0567'}
2025-02-25 11:43:12,326 - EarlyStopping counter: 1 out of 10
2025-02-25 11:43:19,751 - {'epoch': 14, 'rec_loss': '5.6352'}
2025-02-25 11:43:20,426 - {'Epoch': 14, 'HR@5': '0.0514', 'NDCG@5': '0.0317', 'HR@10': '0.0835', 'NDCG@10': '0.0420', 'HR@20': '0.1339', 'NDCG@20': '0.0548'}
2025-02-25 11:43:20,427 - EarlyStopping counter: 2 out of 10
2025-02-25 11:43:26,762 - {'epoch': 15, 'rec_loss': '5.5761'}
2025-02-25 11:43:27,478 - {'Epoch': 15, 'HR@5': '0.0587', 'NDCG@5': '0.0380', 'HR@10': '0.0927', 'NDCG@10': '0.0487', 'HR@20': '0.1385', 'NDCG@20': '0.0604'}
2025-02-25 11:43:27,479 - Validation score increased.  Saving model ...
2025-02-25 11:43:33,766 - {'epoch': 16, 'rec_loss': '5.5419'}
2025-02-25 11:43:34,477 - {'Epoch': 16, 'HR@5': '0.0550', 'NDCG@5': '0.0353', 'HR@10': '0.0954', 'NDCG@10': '0.0481', 'HR@20': '0.1339', 'NDCG@20': '0.0579'}
2025-02-25 11:43:34,479 - EarlyStopping counter: 1 out of 10
2025-02-25 11:43:40,500 - {'epoch': 17, 'rec_loss': '5.4916'}
2025-02-25 11:43:41,214 - {'Epoch': 17, 'HR@5': '0.0578', 'NDCG@5': '0.0351', 'HR@10': '0.0881', 'NDCG@10': '0.0449', 'HR@20': '0.1394', 'NDCG@20': '0.0579'}
2025-02-25 11:43:41,216 - EarlyStopping counter: 2 out of 10
2025-02-25 11:43:47,279 - {'epoch': 18, 'rec_loss': '5.4825'}
2025-02-25 11:43:48,006 - {'Epoch': 18, 'HR@5': '0.0596', 'NDCG@5': '0.0378', 'HR@10': '0.0945', 'NDCG@10': '0.0490', 'HR@20': '0.1477', 'NDCG@20': '0.0625'}
2025-02-25 11:43:48,007 - Validation score increased.  Saving model ...
2025-02-25 11:43:54,835 - {'epoch': 19, 'rec_loss': '5.4543'}
2025-02-25 11:43:55,609 - {'Epoch': 19, 'HR@5': '0.0569', 'NDCG@5': '0.0355', 'HR@10': '0.0991', 'NDCG@10': '0.0490', 'HR@20': '0.1468', 'NDCG@20': '0.0610'}
2025-02-25 11:43:55,610 - EarlyStopping counter: 1 out of 10
2025-02-25 11:44:02,295 - {'epoch': 20, 'rec_loss': '5.4242'}
2025-02-25 11:44:03,030 - {'Epoch': 20, 'HR@5': '0.0541', 'NDCG@5': '0.0352', 'HR@10': '0.0963', 'NDCG@10': '0.0487', 'HR@20': '0.1459', 'NDCG@20': '0.0611'}
2025-02-25 11:44:03,031 - EarlyStopping counter: 2 out of 10
2025-02-25 11:44:09,672 - {'epoch': 21, 'rec_loss': '5.4176'}
2025-02-25 11:44:10,432 - {'Epoch': 21, 'HR@5': '0.0624', 'NDCG@5': '0.0404', 'HR@10': '0.0881', 'NDCG@10': '0.0486', 'HR@20': '0.1477', 'NDCG@20': '0.0636'}
2025-02-25 11:44:10,433 - Validation score increased.  Saving model ...
2025-02-25 11:44:17,554 - {'epoch': 22, 'rec_loss': '5.3772'}
2025-02-25 11:44:18,254 - {'Epoch': 22, 'HR@5': '0.0578', 'NDCG@5': '0.0384', 'HR@10': '0.0963', 'NDCG@10': '0.0508', 'HR@20': '0.1532', 'NDCG@20': '0.0650'}
2025-02-25 11:44:18,255 - Validation score increased.  Saving model ...
2025-02-25 11:44:24,538 - {'epoch': 23, 'rec_loss': '5.3538'}
2025-02-25 11:44:25,284 - {'Epoch': 23, 'HR@5': '0.0550', 'NDCG@5': '0.0358', 'HR@10': '0.0963', 'NDCG@10': '0.0491', 'HR@20': '0.1459', 'NDCG@20': '0.0614'}
2025-02-25 11:44:25,285 - EarlyStopping counter: 1 out of 10
2025-02-25 11:44:31,838 - {'epoch': 24, 'rec_loss': '5.3237'}
2025-02-25 11:44:32,598 - {'Epoch': 24, 'HR@5': '0.0578', 'NDCG@5': '0.0365', 'HR@10': '0.0972', 'NDCG@10': '0.0492', 'HR@20': '0.1450', 'NDCG@20': '0.0611'}
2025-02-25 11:44:32,600 - EarlyStopping counter: 2 out of 10
2025-02-25 11:44:39,781 - {'epoch': 25, 'rec_loss': '5.3276'}
2025-02-25 11:44:40,514 - {'Epoch': 25, 'HR@5': '0.0587', 'NDCG@5': '0.0398', 'HR@10': '0.0927', 'NDCG@10': '0.0506', 'HR@20': '0.1459', 'NDCG@20': '0.0643'}
2025-02-25 11:44:40,515 - EarlyStopping counter: 3 out of 10
2025-02-25 11:44:48,534 - {'epoch': 26, 'rec_loss': '5.2914'}
2025-02-25 11:44:49,241 - {'Epoch': 26, 'HR@5': '0.0633', 'NDCG@5': '0.0391', 'HR@10': '0.0936', 'NDCG@10': '0.0485', 'HR@20': '0.1459', 'NDCG@20': '0.0617'}
2025-02-25 11:44:49,243 - EarlyStopping counter: 4 out of 10
2025-02-25 11:44:56,299 - {'epoch': 27, 'rec_loss': '5.2793'}
2025-02-25 11:44:57,101 - {'Epoch': 27, 'HR@5': '0.0578', 'NDCG@5': '0.0373', 'HR@10': '0.0945', 'NDCG@10': '0.0491', 'HR@20': '0.1523', 'NDCG@20': '0.0638'}
2025-02-25 11:44:57,102 - EarlyStopping counter: 5 out of 10
2025-02-25 11:45:04,475 - {'epoch': 28, 'rec_loss': '5.2634'}
2025-02-25 11:45:05,199 - {'Epoch': 28, 'HR@5': '0.0606', 'NDCG@5': '0.0378', 'HR@10': '0.0954', 'NDCG@10': '0.0490', 'HR@20': '0.1440', 'NDCG@20': '0.0613'}
2025-02-25 11:45:05,201 - EarlyStopping counter: 6 out of 10
2025-02-25 11:45:13,037 - {'epoch': 29, 'rec_loss': '5.2545'}
2025-02-25 11:45:13,764 - {'Epoch': 29, 'HR@5': '0.0606', 'NDCG@5': '0.0396', 'HR@10': '0.0908', 'NDCG@10': '0.0494', 'HR@20': '0.1450', 'NDCG@20': '0.0630'}
2025-02-25 11:45:13,765 - EarlyStopping counter: 7 out of 10
2025-02-25 11:45:21,254 - {'epoch': 30, 'rec_loss': '5.2429'}
2025-02-25 11:45:21,998 - {'Epoch': 30, 'HR@5': '0.0615', 'NDCG@5': '0.0384', 'HR@10': '0.0954', 'NDCG@10': '0.0494', 'HR@20': '0.1505', 'NDCG@20': '0.0631'}
2025-02-25 11:45:21,999 - EarlyStopping counter: 8 out of 10
2025-02-25 11:45:29,309 - {'epoch': 31, 'rec_loss': '5.2381'}
2025-02-25 11:45:29,977 - {'Epoch': 31, 'HR@5': '0.0624', 'NDCG@5': '0.0386', 'HR@10': '0.1000', 'NDCG@10': '0.0507', 'HR@20': '0.1477', 'NDCG@20': '0.0626'}
2025-02-25 11:45:29,978 - EarlyStopping counter: 9 out of 10
2025-02-25 11:45:36,227 - {'epoch': 32, 'rec_loss': '5.2127'}
2025-02-25 11:45:36,913 - {'Epoch': 32, 'HR@5': '0.0615', 'NDCG@5': '0.0386', 'HR@10': '0.0972', 'NDCG@10': '0.0501', 'HR@20': '0.1550', 'NDCG@20': '0.0645'}
2025-02-25 11:45:36,914 - EarlyStopping counter: 10 out of 10
2025-02-25 11:45:36,914 - Early stopping
2025-02-25 11:45:36,914 - ---------------Test Score---------------
2025-02-25 11:45:37,665 - {'Epoch': 0, 'HR@5': '0.0505', 'NDCG@5': '0.0360', 'HR@10': '0.0761', 'NDCG@10': '0.0441', 'HR@20': '0.1028', 'NDCG@20': '0.0508'}
2025-02-25 11:45:37,666 - Scale_LastFM
2025-02-25 11:45:37,666 - {'Epoch': 0, 'HR@5': '0.0505', 'NDCG@5': '0.0360', 'HR@10': '0.0761', 'NDCG@10': '0.0441', 'HR@20': '0.1028', 'NDCG@20': '0.0508'}
2025-02-25 11:53:31,616 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[4, 8, 12], start_prob=0.1, end_prob=0.6, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-25 11:53:34,474 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-25 11:53:34,479 - Total Parameters: 387350
2025-02-25 11:53:40,339 - {'epoch': 0, 'rec_loss': '8.0389'}
2025-02-25 11:53:41,092 - {'Epoch': 0, 'HR@5': '0.0211', 'NDCG@5': '0.0145', 'HR@10': '0.0367', 'NDCG@10': '0.0194', 'HR@20': '0.0633', 'NDCG@20': '0.0260'}
2025-02-25 11:53:41,093 - Validation score increased.  Saving model ...
2025-02-25 11:53:45,999 - {'epoch': 1, 'rec_loss': '7.7546'}
2025-02-25 11:53:46,762 - {'Epoch': 1, 'HR@5': '0.0220', 'NDCG@5': '0.0148', 'HR@10': '0.0367', 'NDCG@10': '0.0195', 'HR@20': '0.0587', 'NDCG@20': '0.0251'}
2025-02-25 11:53:46,763 - EarlyStopping counter: 1 out of 10
2025-02-25 11:53:51,664 - {'epoch': 2, 'rec_loss': '7.5428'}
2025-02-25 11:53:52,395 - {'Epoch': 2, 'HR@5': '0.0284', 'NDCG@5': '0.0189', 'HR@10': '0.0477', 'NDCG@10': '0.0253', 'HR@20': '0.0688', 'NDCG@20': '0.0306'}
2025-02-25 11:53:52,396 - Validation score increased.  Saving model ...
2025-02-25 11:53:57,119 - {'epoch': 3, 'rec_loss': '7.3177'}
2025-02-25 11:53:57,867 - {'Epoch': 3, 'HR@5': '0.0330', 'NDCG@5': '0.0230', 'HR@10': '0.0495', 'NDCG@10': '0.0284', 'HR@20': '0.0706', 'NDCG@20': '0.0336'}
2025-02-25 11:53:57,868 - Validation score increased.  Saving model ...
2025-02-25 11:54:02,566 - {'epoch': 4, 'rec_loss': '7.1064'}
2025-02-25 11:54:03,296 - {'Epoch': 4, 'HR@5': '0.0349', 'NDCG@5': '0.0244', 'HR@10': '0.0550', 'NDCG@10': '0.0308', 'HR@20': '0.0844', 'NDCG@20': '0.0384'}
2025-02-25 11:54:03,297 - Validation score increased.  Saving model ...
2025-02-25 11:54:08,213 - {'epoch': 5, 'rec_loss': '6.8907'}
2025-02-25 11:54:08,957 - {'Epoch': 5, 'HR@5': '0.0367', 'NDCG@5': '0.0250', 'HR@10': '0.0569', 'NDCG@10': '0.0315', 'HR@20': '0.0899', 'NDCG@20': '0.0397'}
2025-02-25 11:54:08,958 - Validation score increased.  Saving model ...
2025-02-25 11:54:13,843 - {'epoch': 6, 'rec_loss': '6.6883'}
2025-02-25 11:54:14,585 - {'Epoch': 6, 'HR@5': '0.0440', 'NDCG@5': '0.0258', 'HR@10': '0.0679', 'NDCG@10': '0.0336', 'HR@20': '0.0982', 'NDCG@20': '0.0412'}
2025-02-25 11:54:14,587 - Validation score increased.  Saving model ...
2025-02-25 11:54:19,733 - {'epoch': 7, 'rec_loss': '6.5095'}
2025-02-25 11:54:20,486 - {'Epoch': 7, 'HR@5': '0.0450', 'NDCG@5': '0.0280', 'HR@10': '0.0679', 'NDCG@10': '0.0354', 'HR@20': '0.1037', 'NDCG@20': '0.0443'}
2025-02-25 11:54:20,487 - Validation score increased.  Saving model ...
2025-02-25 11:54:25,350 - {'epoch': 8, 'rec_loss': '6.3465'}
2025-02-25 11:54:26,122 - {'Epoch': 8, 'HR@5': '0.0422', 'NDCG@5': '0.0274', 'HR@10': '0.0697', 'NDCG@10': '0.0361', 'HR@20': '0.1110', 'NDCG@20': '0.0466'}
2025-02-25 11:54:26,123 - Validation score increased.  Saving model ...
2025-02-25 11:54:30,832 - {'epoch': 9, 'rec_loss': '6.2271'}
2025-02-25 11:54:31,571 - {'Epoch': 9, 'HR@5': '0.0486', 'NDCG@5': '0.0296', 'HR@10': '0.0752', 'NDCG@10': '0.0379', 'HR@20': '0.1138', 'NDCG@20': '0.0478'}
2025-02-25 11:54:31,572 - Validation score increased.  Saving model ...
2025-02-25 11:54:36,476 - {'epoch': 10, 'rec_loss': '6.0857'}
2025-02-25 11:54:37,265 - {'Epoch': 10, 'HR@5': '0.0459', 'NDCG@5': '0.0293', 'HR@10': '0.0743', 'NDCG@10': '0.0383', 'HR@20': '0.1119', 'NDCG@20': '0.0478'}
2025-02-25 11:54:37,266 - Validation score increased.  Saving model ...
2025-02-25 11:54:42,078 - {'epoch': 11, 'rec_loss': '6.0174'}
2025-02-25 11:54:42,818 - {'Epoch': 11, 'HR@5': '0.0459', 'NDCG@5': '0.0320', 'HR@10': '0.0734', 'NDCG@10': '0.0409', 'HR@20': '0.1174', 'NDCG@20': '0.0520'}
2025-02-25 11:54:42,820 - Validation score increased.  Saving model ...
2025-02-25 11:54:47,543 - {'epoch': 12, 'rec_loss': '5.9238'}
2025-02-25 11:54:48,300 - {'Epoch': 12, 'HR@5': '0.0440', 'NDCG@5': '0.0311', 'HR@10': '0.0771', 'NDCG@10': '0.0415', 'HR@20': '0.1202', 'NDCG@20': '0.0525'}
2025-02-25 11:54:48,301 - Validation score increased.  Saving model ...
2025-02-25 11:54:53,021 - {'epoch': 13, 'rec_loss': '5.8408'}
2025-02-25 11:54:53,742 - {'Epoch': 13, 'HR@5': '0.0486', 'NDCG@5': '0.0313', 'HR@10': '0.0780', 'NDCG@10': '0.0406', 'HR@20': '0.1248', 'NDCG@20': '0.0525'}
2025-02-25 11:54:53,743 - EarlyStopping counter: 1 out of 10
2025-02-25 11:54:58,575 - {'epoch': 14, 'rec_loss': '5.7789'}
2025-02-25 11:54:59,314 - {'Epoch': 14, 'HR@5': '0.0486', 'NDCG@5': '0.0313', 'HR@10': '0.0798', 'NDCG@10': '0.0414', 'HR@20': '0.1239', 'NDCG@20': '0.0525'}
2025-02-25 11:54:59,315 - EarlyStopping counter: 2 out of 10
2025-02-25 11:55:04,068 - {'epoch': 15, 'rec_loss': '5.7403'}
2025-02-25 11:55:04,821 - {'Epoch': 15, 'HR@5': '0.0550', 'NDCG@5': '0.0345', 'HR@10': '0.0771', 'NDCG@10': '0.0418', 'HR@20': '0.1257', 'NDCG@20': '0.0540'}
2025-02-25 11:55:04,822 - Validation score increased.  Saving model ...
2025-02-25 11:55:09,652 - {'epoch': 16, 'rec_loss': '5.6980'}
2025-02-25 11:55:10,443 - {'Epoch': 16, 'HR@5': '0.0514', 'NDCG@5': '0.0332', 'HR@10': '0.0789', 'NDCG@10': '0.0420', 'HR@20': '0.1193', 'NDCG@20': '0.0522'}
2025-02-25 11:55:10,444 - EarlyStopping counter: 1 out of 10
2025-02-25 11:55:15,141 - {'epoch': 17, 'rec_loss': '5.6566'}
2025-02-25 11:55:15,894 - {'Epoch': 17, 'HR@5': '0.0505', 'NDCG@5': '0.0325', 'HR@10': '0.0835', 'NDCG@10': '0.0433', 'HR@20': '0.1294', 'NDCG@20': '0.0547'}
2025-02-25 11:55:15,895 - Validation score increased.  Saving model ...
2025-02-25 11:55:21,029 - {'epoch': 18, 'rec_loss': '5.6035'}
2025-02-25 11:55:21,833 - {'Epoch': 18, 'HR@5': '0.0505', 'NDCG@5': '0.0316', 'HR@10': '0.0817', 'NDCG@10': '0.0417', 'HR@20': '0.1294', 'NDCG@20': '0.0537'}
2025-02-25 11:55:21,834 - EarlyStopping counter: 1 out of 10
2025-02-25 11:55:26,557 - {'epoch': 19, 'rec_loss': '5.5687'}
2025-02-25 11:55:27,279 - {'Epoch': 19, 'HR@5': '0.0505', 'NDCG@5': '0.0322', 'HR@10': '0.0927', 'NDCG@10': '0.0459', 'HR@20': '0.1294', 'NDCG@20': '0.0550'}
2025-02-25 11:55:27,280 - Validation score increased.  Saving model ...
2025-02-25 11:55:32,001 - {'epoch': 20, 'rec_loss': '5.5470'}
2025-02-25 11:55:32,694 - {'Epoch': 20, 'HR@5': '0.0468', 'NDCG@5': '0.0308', 'HR@10': '0.0862', 'NDCG@10': '0.0434', 'HR@20': '0.1358', 'NDCG@20': '0.0557'}
2025-02-25 11:55:32,695 - Validation score increased.  Saving model ...
2025-02-25 11:55:37,394 - {'epoch': 21, 'rec_loss': '5.5110'}
2025-02-25 11:55:38,165 - {'Epoch': 21, 'HR@5': '0.0532', 'NDCG@5': '0.0349', 'HR@10': '0.0890', 'NDCG@10': '0.0463', 'HR@20': '0.1321', 'NDCG@20': '0.0572'}
2025-02-25 11:55:38,166 - Validation score increased.  Saving model ...
2025-02-25 11:55:43,191 - {'epoch': 22, 'rec_loss': '5.5000'}
2025-02-25 11:55:44,001 - {'Epoch': 22, 'HR@5': '0.0541', 'NDCG@5': '0.0350', 'HR@10': '0.0844', 'NDCG@10': '0.0449', 'HR@20': '0.1394', 'NDCG@20': '0.0586'}
2025-02-25 11:55:44,002 - Validation score increased.  Saving model ...
2025-02-25 11:55:48,682 - {'epoch': 23, 'rec_loss': '5.4932'}
2025-02-25 11:55:49,460 - {'Epoch': 23, 'HR@5': '0.0578', 'NDCG@5': '0.0365', 'HR@10': '0.0890', 'NDCG@10': '0.0467', 'HR@20': '0.1376', 'NDCG@20': '0.0590'}
2025-02-25 11:55:49,462 - Validation score increased.  Saving model ...
2025-02-25 11:55:54,601 - {'epoch': 24, 'rec_loss': '5.4570'}
2025-02-25 11:55:55,316 - {'Epoch': 24, 'HR@5': '0.0587', 'NDCG@5': '0.0377', 'HR@10': '0.0927', 'NDCG@10': '0.0487', 'HR@20': '0.1312', 'NDCG@20': '0.0584'}
2025-02-25 11:55:55,317 - EarlyStopping counter: 1 out of 10
2025-02-25 11:56:00,078 - {'epoch': 25, 'rec_loss': '5.4237'}
2025-02-25 11:56:00,831 - {'Epoch': 25, 'HR@5': '0.0541', 'NDCG@5': '0.0353', 'HR@10': '0.0890', 'NDCG@10': '0.0465', 'HR@20': '0.1339', 'NDCG@20': '0.0578'}
2025-02-25 11:56:00,832 - EarlyStopping counter: 2 out of 10
2025-02-25 11:56:05,526 - {'epoch': 26, 'rec_loss': '5.4263'}
2025-02-25 11:56:06,290 - {'Epoch': 26, 'HR@5': '0.0560', 'NDCG@5': '0.0360', 'HR@10': '0.0872', 'NDCG@10': '0.0460', 'HR@20': '0.1339', 'NDCG@20': '0.0578'}
2025-02-25 11:56:06,291 - EarlyStopping counter: 3 out of 10
2025-02-25 11:56:11,540 - {'epoch': 27, 'rec_loss': '5.4160'}
2025-02-25 11:56:12,246 - {'Epoch': 27, 'HR@5': '0.0569', 'NDCG@5': '0.0367', 'HR@10': '0.0908', 'NDCG@10': '0.0477', 'HR@20': '0.1367', 'NDCG@20': '0.0591'}
2025-02-25 11:56:12,247 - Validation score increased.  Saving model ...
2025-02-25 11:56:16,971 - {'epoch': 28, 'rec_loss': '5.3877'}
2025-02-25 11:56:17,746 - {'Epoch': 28, 'HR@5': '0.0596', 'NDCG@5': '0.0386', 'HR@10': '0.0945', 'NDCG@10': '0.0498', 'HR@20': '0.1367', 'NDCG@20': '0.0605'}
2025-02-25 11:56:17,747 - Validation score increased.  Saving model ...
2025-02-25 11:56:22,450 - {'epoch': 29, 'rec_loss': '5.3756'}
2025-02-25 11:56:23,202 - {'Epoch': 29, 'HR@5': '0.0587', 'NDCG@5': '0.0396', 'HR@10': '0.0945', 'NDCG@10': '0.0511', 'HR@20': '0.1385', 'NDCG@20': '0.0622'}
2025-02-25 11:56:23,203 - Validation score increased.  Saving model ...
2025-02-25 11:56:27,963 - {'epoch': 30, 'rec_loss': '5.3620'}
2025-02-25 11:56:28,664 - {'Epoch': 30, 'HR@5': '0.0596', 'NDCG@5': '0.0393', 'HR@10': '0.0936', 'NDCG@10': '0.0501', 'HR@20': '0.1422', 'NDCG@20': '0.0623'}
2025-02-25 11:56:28,666 - Validation score increased.  Saving model ...
2025-02-25 11:56:33,392 - {'epoch': 31, 'rec_loss': '5.3512'}
2025-02-25 11:56:34,130 - {'Epoch': 31, 'HR@5': '0.0615', 'NDCG@5': '0.0401', 'HR@10': '0.0982', 'NDCG@10': '0.0519', 'HR@20': '0.1422', 'NDCG@20': '0.0629'}
2025-02-25 11:56:34,131 - Validation score increased.  Saving model ...
2025-02-25 11:56:38,896 - {'epoch': 32, 'rec_loss': '5.3457'}
2025-02-25 11:56:39,618 - {'Epoch': 32, 'HR@5': '0.0642', 'NDCG@5': '0.0394', 'HR@10': '0.1000', 'NDCG@10': '0.0506', 'HR@20': '0.1422', 'NDCG@20': '0.0612'}
2025-02-25 11:56:39,619 - EarlyStopping counter: 1 out of 10
2025-02-25 11:56:44,614 - {'epoch': 33, 'rec_loss': '5.3133'}
2025-02-25 11:56:45,352 - {'Epoch': 33, 'HR@5': '0.0624', 'NDCG@5': '0.0389', 'HR@10': '0.0982', 'NDCG@10': '0.0502', 'HR@20': '0.1477', 'NDCG@20': '0.0626'}
2025-02-25 11:56:45,353 - EarlyStopping counter: 2 out of 10
2025-02-25 11:56:50,103 - {'epoch': 34, 'rec_loss': '5.3093'}
2025-02-25 11:56:50,826 - {'Epoch': 34, 'HR@5': '0.0615', 'NDCG@5': '0.0384', 'HR@10': '0.0972', 'NDCG@10': '0.0501', 'HR@20': '0.1404', 'NDCG@20': '0.0612'}
2025-02-25 11:56:50,827 - EarlyStopping counter: 3 out of 10
2025-02-25 11:56:55,648 - {'epoch': 35, 'rec_loss': '5.2802'}
2025-02-25 11:56:56,401 - {'Epoch': 35, 'HR@5': '0.0661', 'NDCG@5': '0.0422', 'HR@10': '0.0972', 'NDCG@10': '0.0522', 'HR@20': '0.1431', 'NDCG@20': '0.0638'}
2025-02-25 11:56:56,402 - Validation score increased.  Saving model ...
2025-02-25 11:57:01,199 - {'epoch': 36, 'rec_loss': '5.2751'}
2025-02-25 11:57:01,980 - {'Epoch': 36, 'HR@5': '0.0661', 'NDCG@5': '0.0411', 'HR@10': '0.1000', 'NDCG@10': '0.0518', 'HR@20': '0.1495', 'NDCG@20': '0.0642'}
2025-02-25 11:57:01,982 - Validation score increased.  Saving model ...
2025-02-25 11:57:07,071 - {'epoch': 37, 'rec_loss': '5.2847'}
2025-02-25 11:57:07,840 - {'Epoch': 37, 'HR@5': '0.0578', 'NDCG@5': '0.0382', 'HR@10': '0.0954', 'NDCG@10': '0.0503', 'HR@20': '0.1505', 'NDCG@20': '0.0642'}
2025-02-25 11:57:07,842 - Validation score increased.  Saving model ...
2025-02-25 11:57:12,527 - {'epoch': 38, 'rec_loss': '5.2784'}
2025-02-25 11:57:13,264 - {'Epoch': 38, 'HR@5': '0.0606', 'NDCG@5': '0.0400', 'HR@10': '0.0927', 'NDCG@10': '0.0504', 'HR@20': '0.1450', 'NDCG@20': '0.0637'}
2025-02-25 11:57:13,265 - EarlyStopping counter: 1 out of 10
2025-02-25 11:57:17,988 - {'epoch': 39, 'rec_loss': '5.2727'}
2025-02-25 11:57:18,736 - {'Epoch': 39, 'HR@5': '0.0633', 'NDCG@5': '0.0390', 'HR@10': '0.0972', 'NDCG@10': '0.0496', 'HR@20': '0.1413', 'NDCG@20': '0.0609'}
2025-02-25 11:57:18,737 - EarlyStopping counter: 2 out of 10
2025-02-25 11:57:23,428 - {'epoch': 40, 'rec_loss': '5.2240'}
2025-02-25 11:57:24,154 - {'Epoch': 40, 'HR@5': '0.0633', 'NDCG@5': '0.0409', 'HR@10': '0.0945', 'NDCG@10': '0.0510', 'HR@20': '0.1468', 'NDCG@20': '0.0641'}
2025-02-25 11:57:24,156 - EarlyStopping counter: 3 out of 10
2025-02-25 11:57:28,923 - {'epoch': 41, 'rec_loss': '5.2434'}
2025-02-25 11:57:29,617 - {'Epoch': 41, 'HR@5': '0.0624', 'NDCG@5': '0.0404', 'HR@10': '0.0963', 'NDCG@10': '0.0514', 'HR@20': '0.1440', 'NDCG@20': '0.0634'}
2025-02-25 11:57:29,618 - EarlyStopping counter: 4 out of 10
2025-02-25 11:57:34,570 - {'epoch': 42, 'rec_loss': '5.2389'}
2025-02-25 11:57:35,276 - {'Epoch': 42, 'HR@5': '0.0624', 'NDCG@5': '0.0405', 'HR@10': '0.0963', 'NDCG@10': '0.0515', 'HR@20': '0.1468', 'NDCG@20': '0.0642'}
2025-02-25 11:57:35,277 - EarlyStopping counter: 5 out of 10
2025-02-25 11:57:40,340 - {'epoch': 43, 'rec_loss': '5.2063'}
2025-02-25 11:57:41,079 - {'Epoch': 43, 'HR@5': '0.0651', 'NDCG@5': '0.0416', 'HR@10': '0.1028', 'NDCG@10': '0.0536', 'HR@20': '0.1477', 'NDCG@20': '0.0648'}
2025-02-25 11:57:41,080 - Validation score increased.  Saving model ...
2025-02-25 11:57:45,907 - {'epoch': 44, 'rec_loss': '5.2206'}
2025-02-25 11:57:46,676 - {'Epoch': 44, 'HR@5': '0.0606', 'NDCG@5': '0.0402', 'HR@10': '0.0972', 'NDCG@10': '0.0519', 'HR@20': '0.1413', 'NDCG@20': '0.0628'}
2025-02-25 11:57:46,677 - EarlyStopping counter: 1 out of 10
2025-02-25 11:57:51,374 - {'epoch': 45, 'rec_loss': '5.2086'}
2025-02-25 11:57:52,109 - {'Epoch': 45, 'HR@5': '0.0624', 'NDCG@5': '0.0402', 'HR@10': '0.0945', 'NDCG@10': '0.0505', 'HR@20': '0.1404', 'NDCG@20': '0.0622'}
2025-02-25 11:57:52,110 - EarlyStopping counter: 2 out of 10
2025-02-25 11:57:57,269 - {'epoch': 46, 'rec_loss': '5.1897'}
2025-02-25 11:57:57,971 - {'Epoch': 46, 'HR@5': '0.0642', 'NDCG@5': '0.0399', 'HR@10': '0.0963', 'NDCG@10': '0.0505', 'HR@20': '0.1459', 'NDCG@20': '0.0629'}
2025-02-25 11:57:57,973 - EarlyStopping counter: 3 out of 10
2025-02-25 11:58:03,040 - {'epoch': 47, 'rec_loss': '5.1879'}
2025-02-25 11:58:03,792 - {'Epoch': 47, 'HR@5': '0.0633', 'NDCG@5': '0.0396', 'HR@10': '0.0945', 'NDCG@10': '0.0499', 'HR@20': '0.1459', 'NDCG@20': '0.0630'}
2025-02-25 11:58:03,793 - EarlyStopping counter: 4 out of 10
2025-02-25 11:58:08,516 - {'epoch': 48, 'rec_loss': '5.1973'}
2025-02-25 11:58:09,284 - {'Epoch': 48, 'HR@5': '0.0642', 'NDCG@5': '0.0395', 'HR@10': '0.0991', 'NDCG@10': '0.0505', 'HR@20': '0.1514', 'NDCG@20': '0.0636'}
2025-02-25 11:58:09,285 - EarlyStopping counter: 5 out of 10
2025-02-25 11:58:14,196 - {'epoch': 49, 'rec_loss': '5.1791'}
2025-02-25 11:58:14,921 - {'Epoch': 49, 'HR@5': '0.0624', 'NDCG@5': '0.0393', 'HR@10': '0.1000', 'NDCG@10': '0.0512', 'HR@20': '0.1495', 'NDCG@20': '0.0636'}
2025-02-25 11:58:14,922 - EarlyStopping counter: 6 out of 10
2025-02-25 11:58:19,914 - {'epoch': 50, 'rec_loss': '5.1757'}
2025-02-25 11:58:20,670 - {'Epoch': 50, 'HR@5': '0.0606', 'NDCG@5': '0.0369', 'HR@10': '0.0963', 'NDCG@10': '0.0485', 'HR@20': '0.1477', 'NDCG@20': '0.0616'}
2025-02-25 11:58:20,671 - EarlyStopping counter: 7 out of 10
2025-02-25 11:58:25,435 - {'epoch': 51, 'rec_loss': '5.1612'}
2025-02-25 11:58:26,184 - {'Epoch': 51, 'HR@5': '0.0633', 'NDCG@5': '0.0388', 'HR@10': '0.0972', 'NDCG@10': '0.0498', 'HR@20': '0.1477', 'NDCG@20': '0.0625'}
2025-02-25 11:58:26,185 - EarlyStopping counter: 8 out of 10
2025-02-25 11:58:31,282 - {'epoch': 52, 'rec_loss': '5.1495'}
2025-02-25 11:58:32,020 - {'Epoch': 52, 'HR@5': '0.0633', 'NDCG@5': '0.0376', 'HR@10': '0.1000', 'NDCG@10': '0.0494', 'HR@20': '0.1495', 'NDCG@20': '0.0619'}
2025-02-25 11:58:32,021 - EarlyStopping counter: 9 out of 10
2025-02-25 11:58:36,708 - {'epoch': 53, 'rec_loss': '5.1569'}
2025-02-25 11:58:37,466 - {'Epoch': 53, 'HR@5': '0.0688', 'NDCG@5': '0.0415', 'HR@10': '0.0991', 'NDCG@10': '0.0511', 'HR@20': '0.1514', 'NDCG@20': '0.0643'}
2025-02-25 11:58:37,467 - EarlyStopping counter: 10 out of 10
2025-02-25 11:58:37,467 - Early stopping
2025-02-25 11:58:37,467 - ---------------Test Score---------------
2025-02-25 11:58:38,254 - {'Epoch': 0, 'HR@5': '0.0532', 'NDCG@5': '0.0344', 'HR@10': '0.0725', 'NDCG@10': '0.0406', 'HR@20': '0.1046', 'NDCG@20': '0.0485'}
2025-02-25 11:58:38,255 - Scale_LastFM
2025-02-25 11:58:38,255 - {'Epoch': 0, 'HR@5': '0.0532', 'NDCG@5': '0.0344', 'HR@10': '0.0725', 'NDCG@10': '0.0406', 'HR@20': '0.1046', 'NDCG@20': '0.0485'}
2025-02-27 11:00:29,435 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 4, 8], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-27 11:00:32,425 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-27 11:00:32,429 - Total Parameters: 387350
2025-02-27 11:00:38,871 - {'epoch': 0, 'rec_loss': '8.0389'}
2025-02-27 11:00:39,757 - {'Epoch': 0, 'HR@5': '0.0202', 'NDCG@5': '0.0143', 'HR@10': '0.0358', 'NDCG@10': '0.0194', 'HR@20': '0.0642', 'NDCG@20': '0.0264'}
2025-02-27 11:00:39,758 - Validation score increased.  Saving model ...
2025-02-27 11:00:44,916 - {'epoch': 1, 'rec_loss': '7.7573'}
2025-02-27 11:00:45,771 - {'Epoch': 1, 'HR@5': '0.0229', 'NDCG@5': '0.0152', 'HR@10': '0.0358', 'NDCG@10': '0.0194', 'HR@20': '0.0615', 'NDCG@20': '0.0258'}
2025-02-27 11:00:45,772 - EarlyStopping counter: 1 out of 10
2025-02-27 11:00:50,668 - {'epoch': 2, 'rec_loss': '7.5492'}
2025-02-27 11:00:51,524 - {'Epoch': 2, 'HR@5': '0.0303', 'NDCG@5': '0.0207', 'HR@10': '0.0486', 'NDCG@10': '0.0267', 'HR@20': '0.0725', 'NDCG@20': '0.0326'}
2025-02-27 11:00:51,525 - Validation score increased.  Saving model ...
2025-02-27 11:00:56,809 - {'epoch': 3, 'rec_loss': '7.3258'}
2025-02-27 11:00:57,659 - {'Epoch': 3, 'HR@5': '0.0330', 'NDCG@5': '0.0220', 'HR@10': '0.0468', 'NDCG@10': '0.0264', 'HR@20': '0.0706', 'NDCG@20': '0.0324'}
2025-02-27 11:00:57,661 - EarlyStopping counter: 1 out of 10
2025-02-27 11:01:02,583 - {'epoch': 4, 'rec_loss': '7.1145'}
2025-02-27 11:01:03,420 - {'Epoch': 4, 'HR@5': '0.0358', 'NDCG@5': '0.0242', 'HR@10': '0.0532', 'NDCG@10': '0.0297', 'HR@20': '0.0853', 'NDCG@20': '0.0380'}
2025-02-27 11:01:03,421 - Validation score increased.  Saving model ...
2025-02-27 11:01:08,649 - {'epoch': 5, 'rec_loss': '6.9062'}
2025-02-27 11:01:09,487 - {'Epoch': 5, 'HR@5': '0.0358', 'NDCG@5': '0.0242', 'HR@10': '0.0569', 'NDCG@10': '0.0311', 'HR@20': '0.0945', 'NDCG@20': '0.0403'}
2025-02-27 11:01:09,488 - Validation score increased.  Saving model ...
2025-02-27 11:01:14,525 - {'epoch': 6, 'rec_loss': '6.7087'}
2025-02-27 11:01:15,391 - {'Epoch': 6, 'HR@5': '0.0422', 'NDCG@5': '0.0244', 'HR@10': '0.0651', 'NDCG@10': '0.0319', 'HR@20': '0.0972', 'NDCG@20': '0.0401'}
2025-02-27 11:01:15,392 - EarlyStopping counter: 1 out of 10
2025-02-27 11:01:20,394 - {'epoch': 7, 'rec_loss': '6.5293'}
2025-02-27 11:01:21,242 - {'Epoch': 7, 'HR@5': '0.0450', 'NDCG@5': '0.0274', 'HR@10': '0.0661', 'NDCG@10': '0.0341', 'HR@20': '0.1018', 'NDCG@20': '0.0431'}
2025-02-27 11:01:21,243 - Validation score increased.  Saving model ...
2025-02-27 11:01:26,385 - {'epoch': 8, 'rec_loss': '6.3641'}
2025-02-27 11:01:27,209 - {'Epoch': 8, 'HR@5': '0.0404', 'NDCG@5': '0.0261', 'HR@10': '0.0697', 'NDCG@10': '0.0356', 'HR@20': '0.1083', 'NDCG@20': '0.0454'}
2025-02-27 11:01:27,211 - Validation score increased.  Saving model ...
2025-02-27 11:01:32,576 - {'epoch': 9, 'rec_loss': '6.2502'}
2025-02-27 11:01:33,436 - {'Epoch': 9, 'HR@5': '0.0486', 'NDCG@5': '0.0303', 'HR@10': '0.0752', 'NDCG@10': '0.0388', 'HR@20': '0.1128', 'NDCG@20': '0.0484'}
2025-02-27 11:01:33,437 - Validation score increased.  Saving model ...
2025-02-27 11:01:38,839 - {'epoch': 10, 'rec_loss': '6.1097'}
2025-02-27 11:01:39,672 - {'Epoch': 10, 'HR@5': '0.0477', 'NDCG@5': '0.0309', 'HR@10': '0.0697', 'NDCG@10': '0.0380', 'HR@20': '0.1128', 'NDCG@20': '0.0490'}
2025-02-27 11:01:39,673 - Validation score increased.  Saving model ...
2025-02-27 11:01:44,746 - {'epoch': 11, 'rec_loss': '6.0368'}
2025-02-27 11:01:45,552 - {'Epoch': 11, 'HR@5': '0.0468', 'NDCG@5': '0.0316', 'HR@10': '0.0734', 'NDCG@10': '0.0400', 'HR@20': '0.1183', 'NDCG@20': '0.0514'}
2025-02-27 11:01:45,553 - Validation score increased.  Saving model ...
2025-02-27 11:01:50,431 - {'epoch': 12, 'rec_loss': '5.9480'}
2025-02-27 11:01:51,263 - {'Epoch': 12, 'HR@5': '0.0422', 'NDCG@5': '0.0281', 'HR@10': '0.0807', 'NDCG@10': '0.0404', 'HR@20': '0.1266', 'NDCG@20': '0.0520'}
2025-02-27 11:01:51,264 - Validation score increased.  Saving model ...
2025-02-27 11:01:56,354 - {'epoch': 13, 'rec_loss': '5.8674'}
2025-02-27 11:01:57,179 - {'Epoch': 13, 'HR@5': '0.0431', 'NDCG@5': '0.0293', 'HR@10': '0.0780', 'NDCG@10': '0.0404', 'HR@20': '0.1257', 'NDCG@20': '0.0526'}
2025-02-27 11:01:57,180 - Validation score increased.  Saving model ...
2025-02-27 11:02:02,359 - {'epoch': 14, 'rec_loss': '5.7982'}
2025-02-27 11:02:03,194 - {'Epoch': 14, 'HR@5': '0.0459', 'NDCG@5': '0.0312', 'HR@10': '0.0807', 'NDCG@10': '0.0426', 'HR@20': '0.1266', 'NDCG@20': '0.0541'}
2025-02-27 11:02:03,196 - Validation score increased.  Saving model ...
2025-02-27 11:02:08,276 - {'epoch': 15, 'rec_loss': '5.7562'}
2025-02-27 11:02:09,079 - {'Epoch': 15, 'HR@5': '0.0541', 'NDCG@5': '0.0347', 'HR@10': '0.0807', 'NDCG@10': '0.0434', 'HR@20': '0.1294', 'NDCG@20': '0.0555'}
2025-02-27 11:02:09,081 - Validation score increased.  Saving model ...
2025-02-27 11:02:14,232 - {'epoch': 16, 'rec_loss': '5.7243'}
2025-02-27 11:02:15,023 - {'Epoch': 16, 'HR@5': '0.0495', 'NDCG@5': '0.0334', 'HR@10': '0.0752', 'NDCG@10': '0.0418', 'HR@20': '0.1257', 'NDCG@20': '0.0545'}
2025-02-27 11:02:15,024 - EarlyStopping counter: 1 out of 10
2025-02-27 11:02:22,279 - {'epoch': 17, 'rec_loss': '5.6744'}
2025-02-27 11:02:23,500 - {'Epoch': 17, 'HR@5': '0.0514', 'NDCG@5': '0.0328', 'HR@10': '0.0798', 'NDCG@10': '0.0421', 'HR@20': '0.1367', 'NDCG@20': '0.0564'}
2025-02-27 11:02:23,502 - Validation score increased.  Saving model ...
2025-02-27 11:02:34,455 - {'epoch': 18, 'rec_loss': '5.6234'}
2025-02-27 11:02:35,447 - {'Epoch': 18, 'HR@5': '0.0505', 'NDCG@5': '0.0317', 'HR@10': '0.0853', 'NDCG@10': '0.0428', 'HR@20': '0.1339', 'NDCG@20': '0.0549'}
2025-02-27 11:02:35,448 - EarlyStopping counter: 1 out of 10
2025-02-27 11:02:45,727 - {'epoch': 19, 'rec_loss': '5.5908'}
2025-02-27 11:02:46,771 - {'Epoch': 19, 'HR@5': '0.0541', 'NDCG@5': '0.0324', 'HR@10': '0.0881', 'NDCG@10': '0.0435', 'HR@20': '0.1358', 'NDCG@20': '0.0555'}
2025-02-27 11:02:46,773 - EarlyStopping counter: 2 out of 10
2025-02-27 11:02:53,826 - {'epoch': 20, 'rec_loss': '5.5731'}
2025-02-27 11:02:54,953 - {'Epoch': 20, 'HR@5': '0.0468', 'NDCG@5': '0.0312', 'HR@10': '0.0862', 'NDCG@10': '0.0438', 'HR@20': '0.1358', 'NDCG@20': '0.0563'}
2025-02-27 11:02:54,954 - EarlyStopping counter: 3 out of 10
2025-02-27 11:03:05,100 - {'epoch': 21, 'rec_loss': '5.5350'}
2025-02-27 11:03:06,046 - {'Epoch': 21, 'HR@5': '0.0550', 'NDCG@5': '0.0356', 'HR@10': '0.0908', 'NDCG@10': '0.0468', 'HR@20': '0.1339', 'NDCG@20': '0.0577'}
2025-02-27 11:03:06,048 - Validation score increased.  Saving model ...
2025-02-27 11:03:14,473 - {'epoch': 22, 'rec_loss': '5.5272'}
2025-02-27 11:03:15,445 - {'Epoch': 22, 'HR@5': '0.0550', 'NDCG@5': '0.0348', 'HR@10': '0.0890', 'NDCG@10': '0.0456', 'HR@20': '0.1358', 'NDCG@20': '0.0574'}
2025-02-27 11:03:15,446 - EarlyStopping counter: 1 out of 10
2025-02-27 11:03:25,674 - {'epoch': 23, 'rec_loss': '5.5183'}
2025-02-27 11:03:26,783 - {'Epoch': 23, 'HR@5': '0.0514', 'NDCG@5': '0.0344', 'HR@10': '0.0908', 'NDCG@10': '0.0472', 'HR@20': '0.1431', 'NDCG@20': '0.0605'}
2025-02-27 11:03:26,784 - Validation score increased.  Saving model ...
2025-02-27 11:03:36,822 - {'epoch': 24, 'rec_loss': '5.4777'}
2025-02-27 11:03:37,863 - {'Epoch': 24, 'HR@5': '0.0550', 'NDCG@5': '0.0358', 'HR@10': '0.0945', 'NDCG@10': '0.0484', 'HR@20': '0.1349', 'NDCG@20': '0.0586'}
2025-02-27 11:03:37,865 - EarlyStopping counter: 1 out of 10
2025-02-27 11:03:47,400 - {'epoch': 25, 'rec_loss': '5.4470'}
2025-02-27 11:03:48,378 - {'Epoch': 25, 'HR@5': '0.0578', 'NDCG@5': '0.0357', 'HR@10': '0.0908', 'NDCG@10': '0.0462', 'HR@20': '0.1404', 'NDCG@20': '0.0587'}
2025-02-27 11:03:48,380 - EarlyStopping counter: 2 out of 10
2025-02-27 11:03:56,296 - {'epoch': 26, 'rec_loss': '5.4522'}
2025-02-27 11:03:57,200 - {'Epoch': 26, 'HR@5': '0.0532', 'NDCG@5': '0.0340', 'HR@10': '0.0908', 'NDCG@10': '0.0462', 'HR@20': '0.1422', 'NDCG@20': '0.0590'}
2025-02-27 11:03:57,201 - EarlyStopping counter: 3 out of 10
2025-02-27 11:04:04,890 - {'epoch': 27, 'rec_loss': '5.4389'}
2025-02-27 11:04:05,781 - {'Epoch': 27, 'HR@5': '0.0560', 'NDCG@5': '0.0359', 'HR@10': '0.0872', 'NDCG@10': '0.0460', 'HR@20': '0.1394', 'NDCG@20': '0.0593'}
2025-02-27 11:04:05,782 - EarlyStopping counter: 4 out of 10
2025-02-27 11:04:13,827 - {'epoch': 28, 'rec_loss': '5.4189'}
2025-02-27 11:04:14,767 - {'Epoch': 28, 'HR@5': '0.0587', 'NDCG@5': '0.0378', 'HR@10': '0.0917', 'NDCG@10': '0.0481', 'HR@20': '0.1477', 'NDCG@20': '0.0621'}
2025-02-27 11:04:14,769 - Validation score increased.  Saving model ...
2025-02-27 11:04:22,325 - {'epoch': 29, 'rec_loss': '5.4065'}
2025-02-27 11:04:23,319 - {'Epoch': 29, 'HR@5': '0.0569', 'NDCG@5': '0.0380', 'HR@10': '0.0853', 'NDCG@10': '0.0471', 'HR@20': '0.1431', 'NDCG@20': '0.0618'}
2025-02-27 11:04:23,321 - EarlyStopping counter: 1 out of 10
2025-02-27 11:04:34,548 - {'epoch': 30, 'rec_loss': '5.3962'}
2025-02-27 11:04:35,706 - {'Epoch': 30, 'HR@5': '0.0560', 'NDCG@5': '0.0377', 'HR@10': '0.0881', 'NDCG@10': '0.0478', 'HR@20': '0.1440', 'NDCG@20': '0.0618'}
2025-02-27 11:04:35,707 - EarlyStopping counter: 2 out of 10
2025-02-27 11:04:46,864 - {'epoch': 31, 'rec_loss': '5.3887'}
2025-02-27 11:04:47,897 - {'Epoch': 31, 'HR@5': '0.0633', 'NDCG@5': '0.0405', 'HR@10': '0.1000', 'NDCG@10': '0.0521', 'HR@20': '0.1468', 'NDCG@20': '0.0638'}
2025-02-27 11:04:47,899 - Validation score increased.  Saving model ...
2025-02-27 11:04:57,169 - {'epoch': 32, 'rec_loss': '5.3784'}
2025-02-27 11:04:58,295 - {'Epoch': 32, 'HR@5': '0.0615', 'NDCG@5': '0.0369', 'HR@10': '0.0917', 'NDCG@10': '0.0465', 'HR@20': '0.1459', 'NDCG@20': '0.0601'}
2025-02-27 11:04:58,296 - EarlyStopping counter: 1 out of 10
2025-02-27 11:05:07,516 - {'epoch': 33, 'rec_loss': '5.3589'}
2025-02-27 11:05:08,546 - {'Epoch': 33, 'HR@5': '0.0633', 'NDCG@5': '0.0396', 'HR@10': '0.0899', 'NDCG@10': '0.0482', 'HR@20': '0.1514', 'NDCG@20': '0.0639'}
2025-02-27 11:05:08,548 - Validation score increased.  Saving model ...
2025-02-27 11:05:17,757 - {'epoch': 34, 'rec_loss': '5.3465'}
2025-02-27 11:05:18,786 - {'Epoch': 34, 'HR@5': '0.0642', 'NDCG@5': '0.0403', 'HR@10': '0.0991', 'NDCG@10': '0.0513', 'HR@20': '0.1514', 'NDCG@20': '0.0643'}
2025-02-27 11:05:18,787 - Validation score increased.  Saving model ...
2025-02-27 11:05:26,289 - {'epoch': 35, 'rec_loss': '5.3164'}
2025-02-27 11:05:27,164 - {'Epoch': 35, 'HR@5': '0.0688', 'NDCG@5': '0.0425', 'HR@10': '0.1028', 'NDCG@10': '0.0531', 'HR@20': '0.1477', 'NDCG@20': '0.0644'}
2025-02-27 11:05:27,165 - Validation score increased.  Saving model ...
2025-02-27 11:05:34,768 - {'epoch': 36, 'rec_loss': '5.3148'}
2025-02-27 11:05:35,655 - {'Epoch': 36, 'HR@5': '0.0596', 'NDCG@5': '0.0376', 'HR@10': '0.0936', 'NDCG@10': '0.0485', 'HR@20': '0.1486', 'NDCG@20': '0.0625'}
2025-02-27 11:05:35,656 - EarlyStopping counter: 1 out of 10
2025-02-27 11:05:43,497 - {'epoch': 37, 'rec_loss': '5.3116'}
2025-02-27 11:05:44,441 - {'Epoch': 37, 'HR@5': '0.0596', 'NDCG@5': '0.0376', 'HR@10': '0.0936', 'NDCG@10': '0.0486', 'HR@20': '0.1477', 'NDCG@20': '0.0623'}
2025-02-27 11:05:44,442 - EarlyStopping counter: 2 out of 10
2025-02-27 11:05:52,633 - {'epoch': 38, 'rec_loss': '5.3146'}
2025-02-27 11:05:53,673 - {'Epoch': 38, 'HR@5': '0.0587', 'NDCG@5': '0.0389', 'HR@10': '0.0917', 'NDCG@10': '0.0497', 'HR@20': '0.1486', 'NDCG@20': '0.0642'}
2025-02-27 11:05:53,674 - EarlyStopping counter: 3 out of 10
2025-02-27 11:06:02,148 - {'epoch': 39, 'rec_loss': '5.3093'}
2025-02-27 11:06:03,148 - {'Epoch': 39, 'HR@5': '0.0596', 'NDCG@5': '0.0374', 'HR@10': '0.1028', 'NDCG@10': '0.0511', 'HR@20': '0.1440', 'NDCG@20': '0.0616'}
2025-02-27 11:06:03,150 - EarlyStopping counter: 4 out of 10
2025-02-27 11:06:14,866 - {'epoch': 40, 'rec_loss': '5.2666'}
2025-02-27 11:06:15,842 - {'Epoch': 40, 'HR@5': '0.0615', 'NDCG@5': '0.0392', 'HR@10': '0.0991', 'NDCG@10': '0.0516', 'HR@20': '0.1440', 'NDCG@20': '0.0630'}
2025-02-27 11:06:15,843 - EarlyStopping counter: 5 out of 10
2025-02-27 11:06:26,050 - {'epoch': 41, 'rec_loss': '5.2827'}
2025-02-27 11:06:27,090 - {'Epoch': 41, 'HR@5': '0.0633', 'NDCG@5': '0.0417', 'HR@10': '0.1000', 'NDCG@10': '0.0536', 'HR@20': '0.1450', 'NDCG@20': '0.0649'}
2025-02-27 11:06:27,091 - Validation score increased.  Saving model ...
2025-02-27 11:06:38,322 - {'epoch': 42, 'rec_loss': '5.2821'}
2025-02-27 11:06:39,503 - {'Epoch': 42, 'HR@5': '0.0661', 'NDCG@5': '0.0426', 'HR@10': '0.1000', 'NDCG@10': '0.0534', 'HR@20': '0.1459', 'NDCG@20': '0.0648'}
2025-02-27 11:06:39,505 - EarlyStopping counter: 1 out of 10
2025-02-27 11:06:49,946 - {'epoch': 43, 'rec_loss': '5.2525'}
2025-02-27 11:06:50,915 - {'Epoch': 43, 'HR@5': '0.0633', 'NDCG@5': '0.0409', 'HR@10': '0.0972', 'NDCG@10': '0.0519', 'HR@20': '0.1495', 'NDCG@20': '0.0651'}
2025-02-27 11:06:50,916 - Validation score increased.  Saving model ...
2025-02-27 11:06:58,342 - {'epoch': 44, 'rec_loss': '5.2572'}
2025-02-27 11:06:59,222 - {'Epoch': 44, 'HR@5': '0.0624', 'NDCG@5': '0.0414', 'HR@10': '0.0991', 'NDCG@10': '0.0533', 'HR@20': '0.1404', 'NDCG@20': '0.0637'}
2025-02-27 11:06:59,223 - EarlyStopping counter: 1 out of 10
2025-02-27 11:07:07,164 - {'epoch': 45, 'rec_loss': '5.2531'}
2025-02-27 11:07:08,117 - {'Epoch': 45, 'HR@5': '0.0624', 'NDCG@5': '0.0405', 'HR@10': '0.0963', 'NDCG@10': '0.0516', 'HR@20': '0.1486', 'NDCG@20': '0.0646'}
2025-02-27 11:07:08,118 - EarlyStopping counter: 2 out of 10
2025-02-27 11:07:16,432 - {'epoch': 46, 'rec_loss': '5.2369'}
2025-02-27 11:07:17,316 - {'Epoch': 46, 'HR@5': '0.0697', 'NDCG@5': '0.0418', 'HR@10': '0.1009', 'NDCG@10': '0.0519', 'HR@20': '0.1532', 'NDCG@20': '0.0651'}
2025-02-27 11:07:17,317 - Validation score increased.  Saving model ...
2025-02-27 11:07:25,107 - {'epoch': 47, 'rec_loss': '5.2333'}
2025-02-27 11:07:26,318 - {'Epoch': 47, 'HR@5': '0.0688', 'NDCG@5': '0.0420', 'HR@10': '0.0982', 'NDCG@10': '0.0515', 'HR@20': '0.1532', 'NDCG@20': '0.0652'}
2025-02-27 11:07:26,319 - Validation score increased.  Saving model ...
2025-02-27 11:07:36,440 - {'epoch': 48, 'rec_loss': '5.2432'}
2025-02-27 11:07:37,704 - {'Epoch': 48, 'HR@5': '0.0661', 'NDCG@5': '0.0411', 'HR@10': '0.1046', 'NDCG@10': '0.0537', 'HR@20': '0.1560', 'NDCG@20': '0.0665'}
2025-02-27 11:07:37,705 - Validation score increased.  Saving model ...
2025-02-27 11:07:46,334 - {'epoch': 49, 'rec_loss': '5.2242'}
2025-02-27 11:07:47,320 - {'Epoch': 49, 'HR@5': '0.0587', 'NDCG@5': '0.0382', 'HR@10': '0.1000', 'NDCG@10': '0.0516', 'HR@20': '0.1560', 'NDCG@20': '0.0657'}
2025-02-27 11:07:47,321 - EarlyStopping counter: 1 out of 10
2025-02-27 11:07:58,543 - {'epoch': 50, 'rec_loss': '5.2250'}
2025-02-27 11:07:59,504 - {'Epoch': 50, 'HR@5': '0.0615', 'NDCG@5': '0.0382', 'HR@10': '0.1000', 'NDCG@10': '0.0507', 'HR@20': '0.1532', 'NDCG@20': '0.0641'}
2025-02-27 11:07:59,506 - EarlyStopping counter: 2 out of 10
2025-02-27 11:08:10,718 - {'epoch': 51, 'rec_loss': '5.2084'}
2025-02-27 11:08:11,725 - {'Epoch': 51, 'HR@5': '0.0670', 'NDCG@5': '0.0414', 'HR@10': '0.1018', 'NDCG@10': '0.0524', 'HR@20': '0.1532', 'NDCG@20': '0.0652'}
2025-02-27 11:08:11,726 - EarlyStopping counter: 3 out of 10
2025-02-27 11:08:20,165 - {'epoch': 52, 'rec_loss': '5.2037'}
2025-02-27 11:08:21,166 - {'Epoch': 52, 'HR@5': '0.0651', 'NDCG@5': '0.0398', 'HR@10': '0.1055', 'NDCG@10': '0.0527', 'HR@20': '0.1486', 'NDCG@20': '0.0634'}
2025-02-27 11:08:21,168 - EarlyStopping counter: 4 out of 10
2025-02-27 11:08:29,161 - {'epoch': 53, 'rec_loss': '5.2076'}
2025-02-27 11:08:30,060 - {'Epoch': 53, 'HR@5': '0.0661', 'NDCG@5': '0.0441', 'HR@10': '0.1009', 'NDCG@10': '0.0552', 'HR@20': '0.1523', 'NDCG@20': '0.0684'}
2025-02-27 11:08:30,062 - Validation score increased.  Saving model ...
2025-02-27 11:08:37,732 - {'epoch': 54, 'rec_loss': '5.1867'}
2025-02-27 11:08:38,670 - {'Epoch': 54, 'HR@5': '0.0716', 'NDCG@5': '0.0449', 'HR@10': '0.1055', 'NDCG@10': '0.0555', 'HR@20': '0.1495', 'NDCG@20': '0.0666'}
2025-02-27 11:08:38,672 - EarlyStopping counter: 1 out of 10
2025-02-27 11:08:46,306 - {'epoch': 55, 'rec_loss': '5.1770'}
2025-02-27 11:08:47,190 - {'Epoch': 55, 'HR@5': '0.0633', 'NDCG@5': '0.0421', 'HR@10': '0.1083', 'NDCG@10': '0.0568', 'HR@20': '0.1495', 'NDCG@20': '0.0671'}
2025-02-27 11:08:47,191 - EarlyStopping counter: 2 out of 10
2025-02-27 11:08:54,770 - {'epoch': 56, 'rec_loss': '5.1831'}
2025-02-27 11:08:55,718 - {'Epoch': 56, 'HR@5': '0.0661', 'NDCG@5': '0.0420', 'HR@10': '0.1037', 'NDCG@10': '0.0540', 'HR@20': '0.1514', 'NDCG@20': '0.0661'}
2025-02-27 11:08:55,719 - EarlyStopping counter: 3 out of 10
2025-02-27 11:09:05,565 - {'epoch': 57, 'rec_loss': '5.2064'}
2025-02-27 11:09:06,661 - {'Epoch': 57, 'HR@5': '0.0624', 'NDCG@5': '0.0409', 'HR@10': '0.1064', 'NDCG@10': '0.0550', 'HR@20': '0.1523', 'NDCG@20': '0.0665'}
2025-02-27 11:09:06,662 - EarlyStopping counter: 4 out of 10
2025-02-27 11:09:14,232 - {'epoch': 58, 'rec_loss': '5.2065'}
2025-02-27 11:09:15,299 - {'Epoch': 58, 'HR@5': '0.0651', 'NDCG@5': '0.0430', 'HR@10': '0.1009', 'NDCG@10': '0.0546', 'HR@20': '0.1431', 'NDCG@20': '0.0652'}
2025-02-27 11:09:15,300 - EarlyStopping counter: 5 out of 10
2025-02-27 11:09:24,540 - {'epoch': 59, 'rec_loss': '5.1863'}
2025-02-27 11:09:25,493 - {'Epoch': 59, 'HR@5': '0.0651', 'NDCG@5': '0.0431', 'HR@10': '0.1064', 'NDCG@10': '0.0564', 'HR@20': '0.1450', 'NDCG@20': '0.0660'}
2025-02-27 11:09:25,494 - EarlyStopping counter: 6 out of 10
2025-02-27 11:09:34,931 - {'epoch': 60, 'rec_loss': '5.1595'}
2025-02-27 11:09:35,972 - {'Epoch': 60, 'HR@5': '0.0633', 'NDCG@5': '0.0411', 'HR@10': '0.1064', 'NDCG@10': '0.0549', 'HR@20': '0.1477', 'NDCG@20': '0.0652'}
2025-02-27 11:09:35,973 - EarlyStopping counter: 7 out of 10
2025-02-27 11:09:43,963 - {'epoch': 61, 'rec_loss': '5.1613'}
2025-02-27 11:09:44,914 - {'Epoch': 61, 'HR@5': '0.0642', 'NDCG@5': '0.0430', 'HR@10': '0.1037', 'NDCG@10': '0.0557', 'HR@20': '0.1477', 'NDCG@20': '0.0668'}
2025-02-27 11:09:44,915 - EarlyStopping counter: 8 out of 10
2025-02-27 11:09:52,580 - {'epoch': 62, 'rec_loss': '5.1731'}
2025-02-27 11:09:53,587 - {'Epoch': 62, 'HR@5': '0.0651', 'NDCG@5': '0.0419', 'HR@10': '0.1028', 'NDCG@10': '0.0540', 'HR@20': '0.1532', 'NDCG@20': '0.0666'}
2025-02-27 11:09:53,588 - EarlyStopping counter: 9 out of 10
2025-02-27 11:10:01,872 - {'epoch': 63, 'rec_loss': '5.1677'}
2025-02-27 11:10:02,751 - {'Epoch': 63, 'HR@5': '0.0661', 'NDCG@5': '0.0420', 'HR@10': '0.1055', 'NDCG@10': '0.0547', 'HR@20': '0.1486', 'NDCG@20': '0.0655'}
2025-02-27 11:10:02,752 - EarlyStopping counter: 10 out of 10
2025-02-27 11:10:02,753 - Early stopping
2025-02-27 11:10:02,753 - ---------------Test Score---------------
2025-02-27 11:10:03,632 - {'Epoch': 0, 'HR@5': '0.0578', 'NDCG@5': '0.0382', 'HR@10': '0.0771', 'NDCG@10': '0.0443', 'HR@20': '0.1101', 'NDCG@20': '0.0524'}
2025-02-27 11:10:03,633 - Scale_LastFM
2025-02-27 11:10:03,633 - {'Epoch': 0, 'HR@5': '0.0578', 'NDCG@5': '0.0382', 'HR@10': '0.0771', 'NDCG@10': '0.0443', 'HR@20': '0.1101', 'NDCG@20': '0.0524'}
2025-02-27 11:11:57,678 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 4, 8, 12], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-27 11:12:04,251 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=4, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=4, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-27 11:12:04,261 - Total Parameters: 387354
2025-02-27 11:12:13,871 - {'epoch': 0, 'rec_loss': '8.0362'}
2025-02-27 11:12:14,862 - {'Epoch': 0, 'HR@5': '0.0220', 'NDCG@5': '0.0156', 'HR@10': '0.0339', 'NDCG@10': '0.0195', 'HR@20': '0.0560', 'NDCG@20': '0.0251'}
2025-02-27 11:12:14,863 - Validation score increased.  Saving model ...
2025-02-27 11:12:23,433 - {'epoch': 1, 'rec_loss': '7.7341'}
2025-02-27 11:12:24,364 - {'Epoch': 1, 'HR@5': '0.0193', 'NDCG@5': '0.0120', 'HR@10': '0.0358', 'NDCG@10': '0.0174', 'HR@20': '0.0523', 'NDCG@20': '0.0216'}
2025-02-27 11:12:24,366 - EarlyStopping counter: 1 out of 10
2025-02-27 11:12:32,146 - {'epoch': 2, 'rec_loss': '7.5205'}
2025-02-27 11:12:32,949 - {'Epoch': 2, 'HR@5': '0.0239', 'NDCG@5': '0.0179', 'HR@10': '0.0422', 'NDCG@10': '0.0238', 'HR@20': '0.0633', 'NDCG@20': '0.0292'}
2025-02-27 11:12:32,951 - Validation score increased.  Saving model ...
2025-02-27 11:12:40,265 - {'epoch': 3, 'rec_loss': '7.3043'}
2025-02-27 11:12:41,085 - {'Epoch': 3, 'HR@5': '0.0330', 'NDCG@5': '0.0214', 'HR@10': '0.0495', 'NDCG@10': '0.0266', 'HR@20': '0.0752', 'NDCG@20': '0.0330'}
2025-02-27 11:12:41,086 - Validation score increased.  Saving model ...
2025-02-27 11:12:48,874 - {'epoch': 4, 'rec_loss': '7.0913'}
2025-02-27 11:12:49,815 - {'Epoch': 4, 'HR@5': '0.0330', 'NDCG@5': '0.0234', 'HR@10': '0.0578', 'NDCG@10': '0.0313', 'HR@20': '0.0862', 'NDCG@20': '0.0384'}
2025-02-27 11:12:49,816 - Validation score increased.  Saving model ...
2025-02-27 11:12:57,416 - {'epoch': 5, 'rec_loss': '6.8900'}
2025-02-27 11:12:58,249 - {'Epoch': 5, 'HR@5': '0.0376', 'NDCG@5': '0.0250', 'HR@10': '0.0550', 'NDCG@10': '0.0308', 'HR@20': '0.0908', 'NDCG@20': '0.0398'}
2025-02-27 11:12:58,250 - Validation score increased.  Saving model ...
2025-02-27 11:13:06,467 - {'epoch': 6, 'rec_loss': '6.6927'}
2025-02-27 11:13:07,348 - {'Epoch': 6, 'HR@5': '0.0404', 'NDCG@5': '0.0260', 'HR@10': '0.0578', 'NDCG@10': '0.0316', 'HR@20': '0.0899', 'NDCG@20': '0.0399'}
2025-02-27 11:13:07,349 - Validation score increased.  Saving model ...
2025-02-27 11:13:15,879 - {'epoch': 7, 'rec_loss': '6.5235'}
2025-02-27 11:13:16,806 - {'Epoch': 7, 'HR@5': '0.0431', 'NDCG@5': '0.0277', 'HR@10': '0.0642', 'NDCG@10': '0.0345', 'HR@20': '0.0954', 'NDCG@20': '0.0423'}
2025-02-27 11:13:16,807 - Validation score increased.  Saving model ...
2025-02-27 11:13:25,508 - {'epoch': 8, 'rec_loss': '6.3545'}
2025-02-27 11:13:26,544 - {'Epoch': 8, 'HR@5': '0.0440', 'NDCG@5': '0.0283', 'HR@10': '0.0633', 'NDCG@10': '0.0344', 'HR@20': '0.1018', 'NDCG@20': '0.0442'}
2025-02-27 11:13:26,546 - Validation score increased.  Saving model ...
2025-02-27 11:13:36,981 - {'epoch': 9, 'rec_loss': '6.2374'}
2025-02-27 11:13:37,948 - {'Epoch': 9, 'HR@5': '0.0459', 'NDCG@5': '0.0297', 'HR@10': '0.0688', 'NDCG@10': '0.0370', 'HR@20': '0.1046', 'NDCG@20': '0.0460'}
2025-02-27 11:13:37,949 - Validation score increased.  Saving model ...
2025-02-27 11:13:43,965 - {'epoch': 10, 'rec_loss': '6.1010'}
2025-02-27 11:13:44,763 - {'Epoch': 10, 'HR@5': '0.0459', 'NDCG@5': '0.0323', 'HR@10': '0.0743', 'NDCG@10': '0.0413', 'HR@20': '0.1119', 'NDCG@20': '0.0508'}
2025-02-27 11:13:44,764 - Validation score increased.  Saving model ...
2025-02-27 11:13:50,795 - {'epoch': 11, 'rec_loss': '6.0329'}
2025-02-27 11:13:51,656 - {'Epoch': 11, 'HR@5': '0.0450', 'NDCG@5': '0.0305', 'HR@10': '0.0752', 'NDCG@10': '0.0401', 'HR@20': '0.1138', 'NDCG@20': '0.0499'}
2025-02-27 11:13:51,657 - EarlyStopping counter: 1 out of 10
2025-02-27 11:13:58,993 - {'epoch': 12, 'rec_loss': '5.9523'}
2025-02-27 11:13:59,852 - {'Epoch': 12, 'HR@5': '0.0523', 'NDCG@5': '0.0338', 'HR@10': '0.0771', 'NDCG@10': '0.0417', 'HR@20': '0.1211', 'NDCG@20': '0.0526'}
2025-02-27 11:13:59,853 - Validation score increased.  Saving model ...
2025-02-27 11:14:07,303 - {'epoch': 13, 'rec_loss': '5.8457'}
2025-02-27 11:14:08,140 - {'Epoch': 13, 'HR@5': '0.0550', 'NDCG@5': '0.0348', 'HR@10': '0.0743', 'NDCG@10': '0.0410', 'HR@20': '0.1193', 'NDCG@20': '0.0524'}
2025-02-27 11:14:08,141 - EarlyStopping counter: 1 out of 10
2025-02-27 11:14:15,740 - {'epoch': 14, 'rec_loss': '5.8131'}
2025-02-27 11:14:16,645 - {'Epoch': 14, 'HR@5': '0.0541', 'NDCG@5': '0.0348', 'HR@10': '0.0771', 'NDCG@10': '0.0421', 'HR@20': '0.1220', 'NDCG@20': '0.0534'}
2025-02-27 11:14:16,646 - Validation score increased.  Saving model ...
2025-02-27 11:14:24,355 - {'epoch': 15, 'rec_loss': '5.7446'}
2025-02-27 11:14:25,157 - {'Epoch': 15, 'HR@5': '0.0550', 'NDCG@5': '0.0357', 'HR@10': '0.0807', 'NDCG@10': '0.0439', 'HR@20': '0.1257', 'NDCG@20': '0.0550'}
2025-02-27 11:14:25,158 - Validation score increased.  Saving model ...
2025-02-27 11:14:32,484 - {'epoch': 16, 'rec_loss': '5.7150'}
2025-02-27 11:14:33,325 - {'Epoch': 16, 'HR@5': '0.0541', 'NDCG@5': '0.0349', 'HR@10': '0.0844', 'NDCG@10': '0.0446', 'HR@20': '0.1303', 'NDCG@20': '0.0561'}
2025-02-27 11:14:33,327 - Validation score increased.  Saving model ...
2025-02-27 11:14:40,849 - {'epoch': 17, 'rec_loss': '5.6663'}
2025-02-27 11:14:41,713 - {'Epoch': 17, 'HR@5': '0.0560', 'NDCG@5': '0.0360', 'HR@10': '0.0817', 'NDCG@10': '0.0443', 'HR@20': '0.1284', 'NDCG@20': '0.0561'}
2025-02-27 11:14:41,715 - EarlyStopping counter: 1 out of 10
2025-02-27 11:14:48,874 - {'epoch': 18, 'rec_loss': '5.6164'}
2025-02-27 11:14:49,716 - {'Epoch': 18, 'HR@5': '0.0550', 'NDCG@5': '0.0357', 'HR@10': '0.0899', 'NDCG@10': '0.0468', 'HR@20': '0.1330', 'NDCG@20': '0.0577'}
2025-02-27 11:14:49,717 - Validation score increased.  Saving model ...
2025-02-27 11:14:57,407 - {'epoch': 19, 'rec_loss': '5.6096'}
2025-02-27 11:14:58,273 - {'Epoch': 19, 'HR@5': '0.0615', 'NDCG@5': '0.0396', 'HR@10': '0.0936', 'NDCG@10': '0.0501', 'HR@20': '0.1358', 'NDCG@20': '0.0606'}
2025-02-27 11:14:58,274 - Validation score increased.  Saving model ...
2025-02-27 11:15:06,077 - {'epoch': 20, 'rec_loss': '5.5736'}
2025-02-27 11:15:06,912 - {'Epoch': 20, 'HR@5': '0.0505', 'NDCG@5': '0.0339', 'HR@10': '0.0881', 'NDCG@10': '0.0459', 'HR@20': '0.1358', 'NDCG@20': '0.0579'}
2025-02-27 11:15:06,913 - EarlyStopping counter: 1 out of 10
2025-02-27 11:15:14,532 - {'epoch': 21, 'rec_loss': '5.5231'}
2025-02-27 11:15:15,367 - {'Epoch': 21, 'HR@5': '0.0596', 'NDCG@5': '0.0388', 'HR@10': '0.0927', 'NDCG@10': '0.0493', 'HR@20': '0.1468', 'NDCG@20': '0.0629'}
2025-02-27 11:15:15,368 - Validation score increased.  Saving model ...
2025-02-27 11:15:22,497 - {'epoch': 22, 'rec_loss': '5.5208'}
2025-02-27 11:15:23,302 - {'Epoch': 22, 'HR@5': '0.0532', 'NDCG@5': '0.0366', 'HR@10': '0.0881', 'NDCG@10': '0.0479', 'HR@20': '0.1367', 'NDCG@20': '0.0601'}
2025-02-27 11:15:23,303 - EarlyStopping counter: 1 out of 10
2025-02-27 11:15:30,514 - {'epoch': 23, 'rec_loss': '5.5160'}
2025-02-27 11:15:31,243 - {'Epoch': 23, 'HR@5': '0.0569', 'NDCG@5': '0.0362', 'HR@10': '0.0853', 'NDCG@10': '0.0454', 'HR@20': '0.1367', 'NDCG@20': '0.0583'}
2025-02-27 11:15:31,244 - EarlyStopping counter: 2 out of 10
2025-02-27 11:15:38,531 - {'epoch': 24, 'rec_loss': '5.4823'}
2025-02-27 11:15:39,426 - {'Epoch': 24, 'HR@5': '0.0569', 'NDCG@5': '0.0367', 'HR@10': '0.0908', 'NDCG@10': '0.0478', 'HR@20': '0.1404', 'NDCG@20': '0.0603'}
2025-02-27 11:15:39,427 - EarlyStopping counter: 3 out of 10
2025-02-27 11:15:46,950 - {'epoch': 25, 'rec_loss': '5.4618'}
2025-02-27 11:15:47,810 - {'Epoch': 25, 'HR@5': '0.0550', 'NDCG@5': '0.0351', 'HR@10': '0.0872', 'NDCG@10': '0.0456', 'HR@20': '0.1385', 'NDCG@20': '0.0585'}
2025-02-27 11:15:47,812 - EarlyStopping counter: 4 out of 10
2025-02-27 11:15:55,193 - {'epoch': 26, 'rec_loss': '5.4625'}
2025-02-27 11:15:56,028 - {'Epoch': 26, 'HR@5': '0.0569', 'NDCG@5': '0.0366', 'HR@10': '0.0844', 'NDCG@10': '0.0454', 'HR@20': '0.1413', 'NDCG@20': '0.0599'}
2025-02-27 11:15:56,029 - EarlyStopping counter: 5 out of 10
2025-02-27 11:16:03,276 - {'epoch': 27, 'rec_loss': '5.4273'}
2025-02-27 11:16:04,078 - {'Epoch': 27, 'HR@5': '0.0578', 'NDCG@5': '0.0359', 'HR@10': '0.0972', 'NDCG@10': '0.0484', 'HR@20': '0.1404', 'NDCG@20': '0.0592'}
2025-02-27 11:16:04,079 - EarlyStopping counter: 6 out of 10
2025-02-27 11:16:11,638 - {'epoch': 28, 'rec_loss': '5.4182'}
2025-02-27 11:16:12,446 - {'Epoch': 28, 'HR@5': '0.0615', 'NDCG@5': '0.0400', 'HR@10': '0.0927', 'NDCG@10': '0.0500', 'HR@20': '0.1450', 'NDCG@20': '0.0630'}
2025-02-27 11:16:12,447 - Validation score increased.  Saving model ...
2025-02-27 11:16:19,804 - {'epoch': 29, 'rec_loss': '5.4028'}
2025-02-27 11:16:20,672 - {'Epoch': 29, 'HR@5': '0.0560', 'NDCG@5': '0.0365', 'HR@10': '0.0936', 'NDCG@10': '0.0484', 'HR@20': '0.1450', 'NDCG@20': '0.0613'}
2025-02-27 11:16:20,673 - EarlyStopping counter: 1 out of 10
2025-02-27 11:16:28,010 - {'epoch': 30, 'rec_loss': '5.3936'}
2025-02-27 11:16:28,871 - {'Epoch': 30, 'HR@5': '0.0596', 'NDCG@5': '0.0387', 'HR@10': '0.0927', 'NDCG@10': '0.0491', 'HR@20': '0.1422', 'NDCG@20': '0.0615'}
2025-02-27 11:16:28,872 - EarlyStopping counter: 2 out of 10
2025-02-27 11:16:36,671 - {'epoch': 31, 'rec_loss': '5.3926'}
2025-02-27 11:16:37,541 - {'Epoch': 31, 'HR@5': '0.0569', 'NDCG@5': '0.0357', 'HR@10': '0.0972', 'NDCG@10': '0.0488', 'HR@20': '0.1505', 'NDCG@20': '0.0622'}
2025-02-27 11:16:37,542 - EarlyStopping counter: 3 out of 10
2025-02-27 11:16:44,827 - {'epoch': 32, 'rec_loss': '5.3718'}
2025-02-27 11:16:45,649 - {'Epoch': 32, 'HR@5': '0.0532', 'NDCG@5': '0.0355', 'HR@10': '0.0927', 'NDCG@10': '0.0483', 'HR@20': '0.1459', 'NDCG@20': '0.0617'}
2025-02-27 11:16:45,650 - EarlyStopping counter: 4 out of 10
2025-02-27 11:16:52,888 - {'epoch': 33, 'rec_loss': '5.3503'}
2025-02-27 11:16:53,750 - {'Epoch': 33, 'HR@5': '0.0587', 'NDCG@5': '0.0375', 'HR@10': '0.0982', 'NDCG@10': '0.0501', 'HR@20': '0.1505', 'NDCG@20': '0.0631'}
2025-02-27 11:16:53,751 - Validation score increased.  Saving model ...
2025-02-27 11:17:00,767 - {'epoch': 34, 'rec_loss': '5.3570'}
2025-02-27 11:17:01,616 - {'Epoch': 34, 'HR@5': '0.0596', 'NDCG@5': '0.0378', 'HR@10': '0.0927', 'NDCG@10': '0.0485', 'HR@20': '0.1431', 'NDCG@20': '0.0612'}
2025-02-27 11:17:01,617 - EarlyStopping counter: 1 out of 10
2025-02-27 11:17:08,791 - {'epoch': 35, 'rec_loss': '5.3265'}
2025-02-27 11:17:09,645 - {'Epoch': 35, 'HR@5': '0.0560', 'NDCG@5': '0.0364', 'HR@10': '0.0945', 'NDCG@10': '0.0484', 'HR@20': '0.1404', 'NDCG@20': '0.0599'}
2025-02-27 11:17:09,646 - EarlyStopping counter: 2 out of 10
2025-02-27 11:17:16,828 - {'epoch': 36, 'rec_loss': '5.3233'}
2025-02-27 11:17:17,654 - {'Epoch': 36, 'HR@5': '0.0624', 'NDCG@5': '0.0381', 'HR@10': '0.0963', 'NDCG@10': '0.0488', 'HR@20': '0.1385', 'NDCG@20': '0.0595'}
2025-02-27 11:17:17,655 - EarlyStopping counter: 3 out of 10
2025-02-27 11:17:24,937 - {'epoch': 37, 'rec_loss': '5.3102'}
2025-02-27 11:17:25,744 - {'Epoch': 37, 'HR@5': '0.0560', 'NDCG@5': '0.0367', 'HR@10': '0.0908', 'NDCG@10': '0.0478', 'HR@20': '0.1422', 'NDCG@20': '0.0609'}
2025-02-27 11:17:25,745 - EarlyStopping counter: 4 out of 10
2025-02-27 11:17:33,393 - {'epoch': 38, 'rec_loss': '5.3020'}
2025-02-27 11:17:34,164 - {'Epoch': 38, 'HR@5': '0.0523', 'NDCG@5': '0.0351', 'HR@10': '0.0917', 'NDCG@10': '0.0477', 'HR@20': '0.1477', 'NDCG@20': '0.0618'}
2025-02-27 11:17:34,165 - EarlyStopping counter: 5 out of 10
2025-02-27 11:17:41,753 - {'epoch': 39, 'rec_loss': '5.3086'}
2025-02-27 11:17:42,596 - {'Epoch': 39, 'HR@5': '0.0596', 'NDCG@5': '0.0382', 'HR@10': '0.0936', 'NDCG@10': '0.0492', 'HR@20': '0.1413', 'NDCG@20': '0.0612'}
2025-02-27 11:17:42,597 - EarlyStopping counter: 6 out of 10
2025-02-27 11:17:49,697 - {'epoch': 40, 'rec_loss': '5.2766'}
2025-02-27 11:17:50,595 - {'Epoch': 40, 'HR@5': '0.0578', 'NDCG@5': '0.0373', 'HR@10': '0.0963', 'NDCG@10': '0.0498', 'HR@20': '0.1505', 'NDCG@20': '0.0634'}
2025-02-27 11:17:50,596 - Validation score increased.  Saving model ...
2025-02-27 11:17:58,088 - {'epoch': 41, 'rec_loss': '5.2869'}
2025-02-27 11:17:58,930 - {'Epoch': 41, 'HR@5': '0.0596', 'NDCG@5': '0.0377', 'HR@10': '0.0936', 'NDCG@10': '0.0487', 'HR@20': '0.1440', 'NDCG@20': '0.0616'}
2025-02-27 11:17:58,931 - EarlyStopping counter: 1 out of 10
2025-02-27 11:18:06,673 - {'epoch': 42, 'rec_loss': '5.2649'}
2025-02-27 11:18:07,576 - {'Epoch': 42, 'HR@5': '0.0587', 'NDCG@5': '0.0382', 'HR@10': '0.0991', 'NDCG@10': '0.0512', 'HR@20': '0.1468', 'NDCG@20': '0.0631'}
2025-02-27 11:18:07,577 - EarlyStopping counter: 2 out of 10
2025-02-27 11:18:14,594 - {'epoch': 43, 'rec_loss': '5.2552'}
2025-02-27 11:18:15,343 - {'Epoch': 43, 'HR@5': '0.0578', 'NDCG@5': '0.0378', 'HR@10': '0.0982', 'NDCG@10': '0.0506', 'HR@20': '0.1495', 'NDCG@20': '0.0635'}
2025-02-27 11:18:15,344 - Validation score increased.  Saving model ...
2025-02-27 11:18:22,629 - {'epoch': 44, 'rec_loss': '5.2525'}
2025-02-27 11:18:23,474 - {'Epoch': 44, 'HR@5': '0.0633', 'NDCG@5': '0.0421', 'HR@10': '0.1000', 'NDCG@10': '0.0538', 'HR@20': '0.1477', 'NDCG@20': '0.0660'}
2025-02-27 11:18:23,475 - Validation score increased.  Saving model ...
2025-02-27 11:18:30,698 - {'epoch': 45, 'rec_loss': '5.2619'}
2025-02-27 11:18:31,540 - {'Epoch': 45, 'HR@5': '0.0624', 'NDCG@5': '0.0394', 'HR@10': '0.0982', 'NDCG@10': '0.0509', 'HR@20': '0.1495', 'NDCG@20': '0.0637'}
2025-02-27 11:18:31,541 - EarlyStopping counter: 1 out of 10
2025-02-27 11:18:38,802 - {'epoch': 46, 'rec_loss': '5.2332'}
2025-02-27 11:18:39,607 - {'Epoch': 46, 'HR@5': '0.0615', 'NDCG@5': '0.0387', 'HR@10': '0.1009', 'NDCG@10': '0.0514', 'HR@20': '0.1523', 'NDCG@20': '0.0642'}
2025-02-27 11:18:39,608 - EarlyStopping counter: 2 out of 10
2025-02-27 11:18:47,004 - {'epoch': 47, 'rec_loss': '5.2442'}
2025-02-27 11:18:47,897 - {'Epoch': 47, 'HR@5': '0.0670', 'NDCG@5': '0.0415', 'HR@10': '0.1037', 'NDCG@10': '0.0534', 'HR@20': '0.1495', 'NDCG@20': '0.0649'}
2025-02-27 11:18:47,898 - EarlyStopping counter: 3 out of 10
2025-02-27 11:18:55,191 - {'epoch': 48, 'rec_loss': '5.2309'}
2025-02-27 11:18:56,030 - {'Epoch': 48, 'HR@5': '0.0633', 'NDCG@5': '0.0403', 'HR@10': '0.1000', 'NDCG@10': '0.0520', 'HR@20': '0.1495', 'NDCG@20': '0.0646'}
2025-02-27 11:18:56,031 - EarlyStopping counter: 4 out of 10
2025-02-27 11:19:03,331 - {'epoch': 49, 'rec_loss': '5.2335'}
2025-02-27 11:19:04,193 - {'Epoch': 49, 'HR@5': '0.0706', 'NDCG@5': '0.0441', 'HR@10': '0.1073', 'NDCG@10': '0.0558', 'HR@20': '0.1468', 'NDCG@20': '0.0655'}
2025-02-27 11:19:04,194 - EarlyStopping counter: 5 out of 10
2025-02-27 11:19:11,580 - {'epoch': 50, 'rec_loss': '5.2193'}
2025-02-27 11:19:12,395 - {'Epoch': 50, 'HR@5': '0.0633', 'NDCG@5': '0.0388', 'HR@10': '0.1000', 'NDCG@10': '0.0508', 'HR@20': '0.1514', 'NDCG@20': '0.0639'}
2025-02-27 11:19:12,396 - EarlyStopping counter: 6 out of 10
2025-02-27 11:19:19,457 - {'epoch': 51, 'rec_loss': '5.2063'}
2025-02-27 11:19:20,296 - {'Epoch': 51, 'HR@5': '0.0633', 'NDCG@5': '0.0396', 'HR@10': '0.1037', 'NDCG@10': '0.0524', 'HR@20': '0.1550', 'NDCG@20': '0.0652'}
2025-02-27 11:19:20,297 - EarlyStopping counter: 7 out of 10
2025-02-27 11:19:27,664 - {'epoch': 52, 'rec_loss': '5.1894'}
2025-02-27 11:19:28,545 - {'Epoch': 52, 'HR@5': '0.0606', 'NDCG@5': '0.0373', 'HR@10': '0.0991', 'NDCG@10': '0.0497', 'HR@20': '0.1486', 'NDCG@20': '0.0621'}
2025-02-27 11:19:28,547 - EarlyStopping counter: 8 out of 10
2025-02-27 11:19:36,056 - {'epoch': 53, 'rec_loss': '5.1969'}
2025-02-27 11:19:36,981 - {'Epoch': 53, 'HR@5': '0.0606', 'NDCG@5': '0.0381', 'HR@10': '0.1018', 'NDCG@10': '0.0514', 'HR@20': '0.1486', 'NDCG@20': '0.0630'}
2025-02-27 11:19:36,982 - EarlyStopping counter: 9 out of 10
2025-02-27 11:19:44,661 - {'epoch': 54, 'rec_loss': '5.2006'}
2025-02-27 11:19:45,476 - {'Epoch': 54, 'HR@5': '0.0642', 'NDCG@5': '0.0406', 'HR@10': '0.1000', 'NDCG@10': '0.0520', 'HR@20': '0.1541', 'NDCG@20': '0.0654'}
2025-02-27 11:19:45,477 - EarlyStopping counter: 10 out of 10
2025-02-27 11:19:45,477 - Early stopping
2025-02-27 11:19:45,477 - ---------------Test Score---------------
2025-02-27 11:19:46,442 - {'Epoch': 0, 'HR@5': '0.0541', 'NDCG@5': '0.0357', 'HR@10': '0.0752', 'NDCG@10': '0.0424', 'HR@20': '0.1018', 'NDCG@20': '0.0492'}
2025-02-27 11:19:46,444 - Scale_LastFM
2025-02-27 11:19:46,444 - {'Epoch': 0, 'HR@5': '0.0541', 'NDCG@5': '0.0357', 'HR@10': '0.0752', 'NDCG@10': '0.0424', 'HR@20': '0.1018', 'NDCG@20': '0.0492'}
2025-02-27 11:22:47,366 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[4, 8, 12, 24], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-27 11:22:54,155 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=4, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=4, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-27 11:22:54,232 - Total Parameters: 387354
2025-02-27 11:23:03,105 - {'epoch': 0, 'rec_loss': '8.0358'}
2025-02-27 11:23:03,995 - {'Epoch': 0, 'HR@5': '0.0220', 'NDCG@5': '0.0156', 'HR@10': '0.0339', 'NDCG@10': '0.0194', 'HR@20': '0.0550', 'NDCG@20': '0.0248'}
2025-02-27 11:23:03,997 - Validation score increased.  Saving model ...
2025-02-27 11:23:11,871 - {'epoch': 1, 'rec_loss': '7.7344'}
2025-02-27 11:23:12,734 - {'Epoch': 1, 'HR@5': '0.0202', 'NDCG@5': '0.0120', 'HR@10': '0.0349', 'NDCG@10': '0.0168', 'HR@20': '0.0541', 'NDCG@20': '0.0216'}
2025-02-27 11:23:12,736 - EarlyStopping counter: 1 out of 10
2025-02-27 11:23:20,308 - {'epoch': 2, 'rec_loss': '7.5205'}
2025-02-27 11:23:21,165 - {'Epoch': 2, 'HR@5': '0.0239', 'NDCG@5': '0.0177', 'HR@10': '0.0422', 'NDCG@10': '0.0236', 'HR@20': '0.0633', 'NDCG@20': '0.0290'}
2025-02-27 11:23:21,167 - Validation score increased.  Saving model ...
2025-02-27 11:23:28,652 - {'epoch': 3, 'rec_loss': '7.3042'}
2025-02-27 11:23:29,533 - {'Epoch': 3, 'HR@5': '0.0321', 'NDCG@5': '0.0211', 'HR@10': '0.0486', 'NDCG@10': '0.0263', 'HR@20': '0.0752', 'NDCG@20': '0.0329'}
2025-02-27 11:23:29,534 - Validation score increased.  Saving model ...
2025-02-27 11:23:36,916 - {'epoch': 4, 'rec_loss': '7.0933'}
2025-02-27 11:23:37,809 - {'Epoch': 4, 'HR@5': '0.0349', 'NDCG@5': '0.0234', 'HR@10': '0.0569', 'NDCG@10': '0.0303', 'HR@20': '0.0881', 'NDCG@20': '0.0380'}
2025-02-27 11:23:37,810 - Validation score increased.  Saving model ...
2025-02-27 11:23:45,225 - {'epoch': 5, 'rec_loss': '6.8922'}
2025-02-27 11:23:46,042 - {'Epoch': 5, 'HR@5': '0.0367', 'NDCG@5': '0.0253', 'HR@10': '0.0569', 'NDCG@10': '0.0319', 'HR@20': '0.0899', 'NDCG@20': '0.0402'}
2025-02-27 11:23:46,043 - Validation score increased.  Saving model ...
2025-02-27 11:23:53,444 - {'epoch': 6, 'rec_loss': '6.6958'}
2025-02-27 11:23:54,257 - {'Epoch': 6, 'HR@5': '0.0404', 'NDCG@5': '0.0261', 'HR@10': '0.0596', 'NDCG@10': '0.0322', 'HR@20': '0.0936', 'NDCG@20': '0.0408'}
2025-02-27 11:23:54,258 - Validation score increased.  Saving model ...
2025-02-27 11:24:02,072 - {'epoch': 7, 'rec_loss': '6.5270'}
2025-02-27 11:24:02,924 - {'Epoch': 7, 'HR@5': '0.0431', 'NDCG@5': '0.0279', 'HR@10': '0.0651', 'NDCG@10': '0.0349', 'HR@20': '0.0945', 'NDCG@20': '0.0423'}
2025-02-27 11:24:02,926 - Validation score increased.  Saving model ...
2025-02-27 11:24:10,744 - {'epoch': 8, 'rec_loss': '6.3591'}
2025-02-27 11:24:11,625 - {'Epoch': 8, 'HR@5': '0.0431', 'NDCG@5': '0.0277', 'HR@10': '0.0624', 'NDCG@10': '0.0339', 'HR@20': '0.1046', 'NDCG@20': '0.0445'}
2025-02-27 11:24:11,627 - Validation score increased.  Saving model ...
2025-02-27 11:24:18,641 - {'epoch': 9, 'rec_loss': '6.2426'}
2025-02-27 11:24:19,495 - {'Epoch': 9, 'HR@5': '0.0468', 'NDCG@5': '0.0301', 'HR@10': '0.0670', 'NDCG@10': '0.0365', 'HR@20': '0.1028', 'NDCG@20': '0.0455'}
2025-02-27 11:24:19,496 - Validation score increased.  Saving model ...
2025-02-27 11:24:27,293 - {'epoch': 10, 'rec_loss': '6.1056'}
2025-02-27 11:24:28,130 - {'Epoch': 10, 'HR@5': '0.0495', 'NDCG@5': '0.0339', 'HR@10': '0.0725', 'NDCG@10': '0.0411', 'HR@20': '0.1101', 'NDCG@20': '0.0505'}
2025-02-27 11:24:28,131 - Validation score increased.  Saving model ...
2025-02-27 11:24:35,883 - {'epoch': 11, 'rec_loss': '6.0376'}
2025-02-27 11:24:36,748 - {'Epoch': 11, 'HR@5': '0.0468', 'NDCG@5': '0.0313', 'HR@10': '0.0752', 'NDCG@10': '0.0404', 'HR@20': '0.1138', 'NDCG@20': '0.0502'}
2025-02-27 11:24:36,749 - EarlyStopping counter: 1 out of 10
2025-02-27 11:24:44,185 - {'epoch': 12, 'rec_loss': '5.9575'}
2025-02-27 11:24:44,968 - {'Epoch': 12, 'HR@5': '0.0495', 'NDCG@5': '0.0330', 'HR@10': '0.0780', 'NDCG@10': '0.0423', 'HR@20': '0.1193', 'NDCG@20': '0.0524'}
2025-02-27 11:24:44,969 - Validation score increased.  Saving model ...
2025-02-27 11:24:52,426 - {'epoch': 13, 'rec_loss': '5.8503'}
2025-02-27 11:24:53,229 - {'Epoch': 13, 'HR@5': '0.0505', 'NDCG@5': '0.0329', 'HR@10': '0.0743', 'NDCG@10': '0.0407', 'HR@20': '0.1193', 'NDCG@20': '0.0521'}
2025-02-27 11:24:53,230 - EarlyStopping counter: 1 out of 10
2025-02-27 11:25:00,614 - {'epoch': 14, 'rec_loss': '5.8188'}
2025-02-27 11:25:01,363 - {'Epoch': 14, 'HR@5': '0.0532', 'NDCG@5': '0.0342', 'HR@10': '0.0761', 'NDCG@10': '0.0416', 'HR@20': '0.1183', 'NDCG@20': '0.0522'}
2025-02-27 11:25:01,364 - EarlyStopping counter: 2 out of 10
2025-02-27 11:25:08,886 - {'epoch': 15, 'rec_loss': '5.7491'}
2025-02-27 11:25:09,707 - {'Epoch': 15, 'HR@5': '0.0541', 'NDCG@5': '0.0351', 'HR@10': '0.0780', 'NDCG@10': '0.0428', 'HR@20': '0.1220', 'NDCG@20': '0.0539'}
2025-02-27 11:25:09,708 - Validation score increased.  Saving model ...
2025-02-27 11:25:17,329 - {'epoch': 16, 'rec_loss': '5.7207'}
2025-02-27 11:25:18,156 - {'Epoch': 16, 'HR@5': '0.0541', 'NDCG@5': '0.0346', 'HR@10': '0.0826', 'NDCG@10': '0.0437', 'HR@20': '0.1284', 'NDCG@20': '0.0552'}
2025-02-27 11:25:18,157 - Validation score increased.  Saving model ...
2025-02-27 11:25:26,185 - {'epoch': 17, 'rec_loss': '5.6704'}
2025-02-27 11:25:27,081 - {'Epoch': 17, 'HR@5': '0.0578', 'NDCG@5': '0.0373', 'HR@10': '0.0798', 'NDCG@10': '0.0443', 'HR@20': '0.1257', 'NDCG@20': '0.0558'}
2025-02-27 11:25:27,082 - Validation score increased.  Saving model ...
2025-02-27 11:25:35,028 - {'epoch': 18, 'rec_loss': '5.6218'}
2025-02-27 11:25:35,857 - {'Epoch': 18, 'HR@5': '0.0569', 'NDCG@5': '0.0369', 'HR@10': '0.0890', 'NDCG@10': '0.0472', 'HR@20': '0.1312', 'NDCG@20': '0.0579'}
2025-02-27 11:25:35,858 - Validation score increased.  Saving model ...
2025-02-27 11:25:43,501 - {'epoch': 19, 'rec_loss': '5.6141'}
2025-02-27 11:25:44,362 - {'Epoch': 19, 'HR@5': '0.0587', 'NDCG@5': '0.0390', 'HR@10': '0.0917', 'NDCG@10': '0.0498', 'HR@20': '0.1339', 'NDCG@20': '0.0603'}
2025-02-27 11:25:44,363 - Validation score increased.  Saving model ...
2025-02-27 11:25:51,363 - {'epoch': 20, 'rec_loss': '5.5783'}
2025-02-27 11:25:52,207 - {'Epoch': 20, 'HR@5': '0.0486', 'NDCG@5': '0.0334', 'HR@10': '0.0844', 'NDCG@10': '0.0450', 'HR@20': '0.1385', 'NDCG@20': '0.0586'}
2025-02-27 11:25:52,208 - EarlyStopping counter: 1 out of 10
2025-02-27 11:25:59,597 - {'epoch': 21, 'rec_loss': '5.5289'}
2025-02-27 11:26:00,469 - {'Epoch': 21, 'HR@5': '0.0596', 'NDCG@5': '0.0379', 'HR@10': '0.0899', 'NDCG@10': '0.0476', 'HR@20': '0.1450', 'NDCG@20': '0.0615'}
2025-02-27 11:26:00,471 - Validation score increased.  Saving model ...
2025-02-27 11:26:08,012 - {'epoch': 22, 'rec_loss': '5.5248'}
2025-02-27 11:26:08,865 - {'Epoch': 22, 'HR@5': '0.0495', 'NDCG@5': '0.0348', 'HR@10': '0.0881', 'NDCG@10': '0.0474', 'HR@20': '0.1349', 'NDCG@20': '0.0592'}
2025-02-27 11:26:08,866 - EarlyStopping counter: 1 out of 10
2025-02-27 11:26:16,613 - {'epoch': 23, 'rec_loss': '5.5201'}
2025-02-27 11:26:17,411 - {'Epoch': 23, 'HR@5': '0.0569', 'NDCG@5': '0.0368', 'HR@10': '0.0853', 'NDCG@10': '0.0459', 'HR@20': '0.1358', 'NDCG@20': '0.0587'}
2025-02-27 11:26:17,412 - EarlyStopping counter: 2 out of 10
2025-02-27 11:26:24,637 - {'epoch': 24, 'rec_loss': '5.4868'}
2025-02-27 11:26:25,450 - {'Epoch': 24, 'HR@5': '0.0541', 'NDCG@5': '0.0362', 'HR@10': '0.0927', 'NDCG@10': '0.0487', 'HR@20': '0.1358', 'NDCG@20': '0.0596'}
2025-02-27 11:26:25,452 - EarlyStopping counter: 3 out of 10
2025-02-27 11:26:32,797 - {'epoch': 25, 'rec_loss': '5.4656'}
2025-02-27 11:26:33,662 - {'Epoch': 25, 'HR@5': '0.0514', 'NDCG@5': '0.0337', 'HR@10': '0.0890', 'NDCG@10': '0.0459', 'HR@20': '0.1367', 'NDCG@20': '0.0579'}
2025-02-27 11:26:33,663 - EarlyStopping counter: 4 out of 10
2025-02-27 11:26:41,135 - {'epoch': 26, 'rec_loss': '5.4665'}
2025-02-27 11:26:41,971 - {'Epoch': 26, 'HR@5': '0.0560', 'NDCG@5': '0.0363', 'HR@10': '0.0844', 'NDCG@10': '0.0453', 'HR@20': '0.1349', 'NDCG@20': '0.0583'}
2025-02-27 11:26:41,972 - EarlyStopping counter: 5 out of 10
2025-02-27 11:26:49,269 - {'epoch': 27, 'rec_loss': '5.4324'}
2025-02-27 11:26:50,090 - {'Epoch': 27, 'HR@5': '0.0560', 'NDCG@5': '0.0349', 'HR@10': '0.0936', 'NDCG@10': '0.0469', 'HR@20': '0.1413', 'NDCG@20': '0.0590'}
2025-02-27 11:26:50,092 - EarlyStopping counter: 6 out of 10
2025-02-27 11:26:57,714 - {'epoch': 28, 'rec_loss': '5.4231'}
2025-02-27 11:26:58,512 - {'Epoch': 28, 'HR@5': '0.0596', 'NDCG@5': '0.0393', 'HR@10': '0.0927', 'NDCG@10': '0.0500', 'HR@20': '0.1422', 'NDCG@20': '0.0624'}
2025-02-27 11:26:58,514 - Validation score increased.  Saving model ...
2025-02-27 11:27:06,100 - {'epoch': 29, 'rec_loss': '5.4082'}
2025-02-27 11:27:06,915 - {'Epoch': 29, 'HR@5': '0.0541', 'NDCG@5': '0.0360', 'HR@10': '0.0917', 'NDCG@10': '0.0482', 'HR@20': '0.1413', 'NDCG@20': '0.0606'}
2025-02-27 11:27:06,916 - EarlyStopping counter: 1 out of 10
2025-02-27 11:27:14,492 - {'epoch': 30, 'rec_loss': '5.3969'}
2025-02-27 11:27:15,294 - {'Epoch': 30, 'HR@5': '0.0569', 'NDCG@5': '0.0377', 'HR@10': '0.0936', 'NDCG@10': '0.0494', 'HR@20': '0.1422', 'NDCG@20': '0.0615'}
2025-02-27 11:27:15,295 - EarlyStopping counter: 2 out of 10
2025-02-27 11:27:22,782 - {'epoch': 31, 'rec_loss': '5.3965'}
2025-02-27 11:27:23,657 - {'Epoch': 31, 'HR@5': '0.0560', 'NDCG@5': '0.0357', 'HR@10': '0.1000', 'NDCG@10': '0.0500', 'HR@20': '0.1468', 'NDCG@20': '0.0617'}
2025-02-27 11:27:23,659 - EarlyStopping counter: 3 out of 10
2025-02-27 11:27:30,959 - {'epoch': 32, 'rec_loss': '5.3764'}
2025-02-27 11:27:31,820 - {'Epoch': 32, 'HR@5': '0.0523', 'NDCG@5': '0.0354', 'HR@10': '0.0963', 'NDCG@10': '0.0495', 'HR@20': '0.1459', 'NDCG@20': '0.0618'}
2025-02-27 11:27:31,821 - EarlyStopping counter: 4 out of 10
2025-02-27 11:27:39,287 - {'epoch': 33, 'rec_loss': '5.3528'}
2025-02-27 11:27:40,166 - {'Epoch': 33, 'HR@5': '0.0569', 'NDCG@5': '0.0372', 'HR@10': '0.0991', 'NDCG@10': '0.0507', 'HR@20': '0.1477', 'NDCG@20': '0.0629'}
2025-02-27 11:27:40,167 - Validation score increased.  Saving model ...
2025-02-27 11:27:47,541 - {'epoch': 34, 'rec_loss': '5.3602'}
2025-02-27 11:27:48,335 - {'Epoch': 34, 'HR@5': '0.0633', 'NDCG@5': '0.0395', 'HR@10': '0.0945', 'NDCG@10': '0.0493', 'HR@20': '0.1459', 'NDCG@20': '0.0621'}
2025-02-27 11:27:48,336 - EarlyStopping counter: 1 out of 10
2025-02-27 11:27:55,584 - {'epoch': 35, 'rec_loss': '5.3293'}
2025-02-27 11:27:56,331 - {'Epoch': 35, 'HR@5': '0.0550', 'NDCG@5': '0.0373', 'HR@10': '0.0927', 'NDCG@10': '0.0491', 'HR@20': '0.1431', 'NDCG@20': '0.0617'}
2025-02-27 11:27:56,332 - EarlyStopping counter: 2 out of 10
2025-02-27 11:28:03,718 - {'epoch': 36, 'rec_loss': '5.3269'}
2025-02-27 11:28:04,550 - {'Epoch': 36, 'HR@5': '0.0596', 'NDCG@5': '0.0370', 'HR@10': '0.0963', 'NDCG@10': '0.0486', 'HR@20': '0.1459', 'NDCG@20': '0.0610'}
2025-02-27 11:28:04,551 - EarlyStopping counter: 3 out of 10
2025-02-27 11:28:11,933 - {'epoch': 37, 'rec_loss': '5.3134'}
2025-02-27 11:28:12,690 - {'Epoch': 37, 'HR@5': '0.0532', 'NDCG@5': '0.0361', 'HR@10': '0.0908', 'NDCG@10': '0.0480', 'HR@20': '0.1431', 'NDCG@20': '0.0613'}
2025-02-27 11:28:12,691 - EarlyStopping counter: 4 out of 10
2025-02-27 11:28:19,976 - {'epoch': 38, 'rec_loss': '5.3049'}
2025-02-27 11:28:20,872 - {'Epoch': 38, 'HR@5': '0.0532', 'NDCG@5': '0.0353', 'HR@10': '0.0899', 'NDCG@10': '0.0472', 'HR@20': '0.1477', 'NDCG@20': '0.0618'}
2025-02-27 11:28:20,874 - EarlyStopping counter: 5 out of 10
2025-02-27 11:28:28,101 - {'epoch': 39, 'rec_loss': '5.3121'}
2025-02-27 11:28:28,989 - {'Epoch': 39, 'HR@5': '0.0587', 'NDCG@5': '0.0379', 'HR@10': '0.0927', 'NDCG@10': '0.0489', 'HR@20': '0.1459', 'NDCG@20': '0.0624'}
2025-02-27 11:28:28,991 - EarlyStopping counter: 6 out of 10
2025-02-27 11:28:36,475 - {'epoch': 40, 'rec_loss': '5.2804'}
2025-02-27 11:28:37,306 - {'Epoch': 40, 'HR@5': '0.0578', 'NDCG@5': '0.0376', 'HR@10': '0.0954', 'NDCG@10': '0.0497', 'HR@20': '0.1468', 'NDCG@20': '0.0625'}
2025-02-27 11:28:37,307 - EarlyStopping counter: 7 out of 10
2025-02-27 11:28:44,937 - {'epoch': 41, 'rec_loss': '5.2884'}
2025-02-27 11:28:45,804 - {'Epoch': 41, 'HR@5': '0.0596', 'NDCG@5': '0.0381', 'HR@10': '0.0954', 'NDCG@10': '0.0495', 'HR@20': '0.1450', 'NDCG@20': '0.0621'}
2025-02-27 11:28:45,805 - EarlyStopping counter: 8 out of 10
2025-02-27 11:28:53,043 - {'epoch': 42, 'rec_loss': '5.2679'}
2025-02-27 11:28:53,939 - {'Epoch': 42, 'HR@5': '0.0578', 'NDCG@5': '0.0384', 'HR@10': '0.1018', 'NDCG@10': '0.0525', 'HR@20': '0.1486', 'NDCG@20': '0.0641'}
2025-02-27 11:28:53,941 - Validation score increased.  Saving model ...
2025-02-27 11:29:01,602 - {'epoch': 43, 'rec_loss': '5.2590'}
2025-02-27 11:29:02,475 - {'Epoch': 43, 'HR@5': '0.0587', 'NDCG@5': '0.0383', 'HR@10': '0.0982', 'NDCG@10': '0.0508', 'HR@20': '0.1505', 'NDCG@20': '0.0641'}
2025-02-27 11:29:02,477 - EarlyStopping counter: 1 out of 10
2025-02-27 11:29:10,362 - {'epoch': 44, 'rec_loss': '5.2560'}
2025-02-27 11:29:11,268 - {'Epoch': 44, 'HR@5': '0.0624', 'NDCG@5': '0.0416', 'HR@10': '0.1037', 'NDCG@10': '0.0547', 'HR@20': '0.1532', 'NDCG@20': '0.0672'}
2025-02-27 11:29:11,270 - Validation score increased.  Saving model ...
2025-02-27 11:29:19,182 - {'epoch': 45, 'rec_loss': '5.2638'}
2025-02-27 11:29:20,027 - {'Epoch': 45, 'HR@5': '0.0615', 'NDCG@5': '0.0401', 'HR@10': '0.0954', 'NDCG@10': '0.0512', 'HR@20': '0.1505', 'NDCG@20': '0.0651'}
2025-02-27 11:29:20,028 - EarlyStopping counter: 1 out of 10
2025-02-27 11:29:27,649 - {'epoch': 46, 'rec_loss': '5.2371'}
2025-02-27 11:29:28,510 - {'Epoch': 46, 'HR@5': '0.0606', 'NDCG@5': '0.0383', 'HR@10': '0.1028', 'NDCG@10': '0.0520', 'HR@20': '0.1450', 'NDCG@20': '0.0627'}
2025-02-27 11:29:28,512 - EarlyStopping counter: 2 out of 10
2025-02-27 11:29:35,587 - {'epoch': 47, 'rec_loss': '5.2481'}
2025-02-27 11:29:36,349 - {'Epoch': 47, 'HR@5': '0.0670', 'NDCG@5': '0.0405', 'HR@10': '0.1055', 'NDCG@10': '0.0528', 'HR@20': '0.1514', 'NDCG@20': '0.0642'}
2025-02-27 11:29:36,350 - EarlyStopping counter: 3 out of 10
2025-02-27 11:29:43,731 - {'epoch': 48, 'rec_loss': '5.2344'}
2025-02-27 11:29:44,525 - {'Epoch': 48, 'HR@5': '0.0606', 'NDCG@5': '0.0386', 'HR@10': '0.1018', 'NDCG@10': '0.0518', 'HR@20': '0.1495', 'NDCG@20': '0.0640'}
2025-02-27 11:29:44,526 - EarlyStopping counter: 4 out of 10
2025-02-27 11:29:52,007 - {'epoch': 49, 'rec_loss': '5.2347'}
2025-02-27 11:29:52,878 - {'Epoch': 49, 'HR@5': '0.0679', 'NDCG@5': '0.0428', 'HR@10': '0.1083', 'NDCG@10': '0.0557', 'HR@20': '0.1468', 'NDCG@20': '0.0652'}
2025-02-27 11:29:52,879 - EarlyStopping counter: 5 out of 10
2025-02-27 11:30:00,523 - {'epoch': 50, 'rec_loss': '5.2214'}
2025-02-27 11:30:01,335 - {'Epoch': 50, 'HR@5': '0.0606', 'NDCG@5': '0.0373', 'HR@10': '0.1046', 'NDCG@10': '0.0517', 'HR@20': '0.1486', 'NDCG@20': '0.0629'}
2025-02-27 11:30:01,336 - EarlyStopping counter: 6 out of 10
2025-02-27 11:30:08,786 - {'epoch': 51, 'rec_loss': '5.2095'}
2025-02-27 11:30:09,613 - {'Epoch': 51, 'HR@5': '0.0624', 'NDCG@5': '0.0389', 'HR@10': '0.1028', 'NDCG@10': '0.0518', 'HR@20': '0.1523', 'NDCG@20': '0.0642'}
2025-02-27 11:30:09,614 - EarlyStopping counter: 7 out of 10
2025-02-27 11:30:17,431 - {'epoch': 52, 'rec_loss': '5.1934'}
2025-02-27 11:30:18,239 - {'Epoch': 52, 'HR@5': '0.0624', 'NDCG@5': '0.0377', 'HR@10': '0.0991', 'NDCG@10': '0.0495', 'HR@20': '0.1495', 'NDCG@20': '0.0621'}
2025-02-27 11:30:18,240 - EarlyStopping counter: 8 out of 10
2025-02-27 11:30:25,468 - {'epoch': 53, 'rec_loss': '5.1982'}
2025-02-27 11:30:26,362 - {'Epoch': 53, 'HR@5': '0.0606', 'NDCG@5': '0.0385', 'HR@10': '0.1028', 'NDCG@10': '0.0522', 'HR@20': '0.1450', 'NDCG@20': '0.0628'}
2025-02-27 11:30:26,363 - EarlyStopping counter: 9 out of 10
2025-02-27 11:30:33,695 - {'epoch': 54, 'rec_loss': '5.2005'}
2025-02-27 11:30:34,567 - {'Epoch': 54, 'HR@5': '0.0596', 'NDCG@5': '0.0386', 'HR@10': '0.0991', 'NDCG@10': '0.0515', 'HR@20': '0.1560', 'NDCG@20': '0.0657'}
2025-02-27 11:30:34,568 - EarlyStopping counter: 10 out of 10
2025-02-27 11:30:34,569 - Early stopping
2025-02-27 11:30:34,569 - ---------------Test Score---------------
2025-02-27 11:30:35,361 - {'Epoch': 0, 'HR@5': '0.0560', 'NDCG@5': '0.0364', 'HR@10': '0.0725', 'NDCG@10': '0.0417', 'HR@20': '0.1009', 'NDCG@20': '0.0489'}
2025-02-27 11:30:35,363 - Scale_LastFM
2025-02-27 11:30:35,363 - {'Epoch': 0, 'HR@5': '0.0560', 'NDCG@5': '0.0364', 'HR@10': '0.0725', 'NDCG@10': '0.0417', 'HR@20': '0.1009', 'NDCG@20': '0.0489'}
2025-02-27 11:33:11,895 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[8, 12, 24], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-27 11:33:18,175 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-27 11:33:18,179 - Total Parameters: 387350
2025-02-27 11:33:26,495 - {'epoch': 0, 'rec_loss': '8.0389'}
2025-02-27 11:33:27,369 - {'Epoch': 0, 'HR@5': '0.0202', 'NDCG@5': '0.0143', 'HR@10': '0.0358', 'NDCG@10': '0.0194', 'HR@20': '0.0642', 'NDCG@20': '0.0265'}
2025-02-27 11:33:27,370 - Validation score increased.  Saving model ...
2025-02-27 11:33:34,724 - {'epoch': 1, 'rec_loss': '7.7567'}
2025-02-27 11:33:35,626 - {'Epoch': 1, 'HR@5': '0.0220', 'NDCG@5': '0.0149', 'HR@10': '0.0349', 'NDCG@10': '0.0191', 'HR@20': '0.0642', 'NDCG@20': '0.0265'}
2025-02-27 11:33:35,627 - EarlyStopping counter: 1 out of 10
2025-02-27 11:33:42,954 - {'epoch': 2, 'rec_loss': '7.5496'}
2025-02-27 11:33:43,735 - {'Epoch': 2, 'HR@5': '0.0303', 'NDCG@5': '0.0202', 'HR@10': '0.0459', 'NDCG@10': '0.0252', 'HR@20': '0.0706', 'NDCG@20': '0.0314'}
2025-02-27 11:33:43,737 - Validation score increased.  Saving model ...
2025-02-27 11:33:50,671 - {'epoch': 3, 'rec_loss': '7.3258'}
2025-02-27 11:33:51,436 - {'Epoch': 3, 'HR@5': '0.0330', 'NDCG@5': '0.0219', 'HR@10': '0.0468', 'NDCG@10': '0.0262', 'HR@20': '0.0716', 'NDCG@20': '0.0324'}
2025-02-27 11:33:51,438 - Validation score increased.  Saving model ...
2025-02-27 11:33:58,603 - {'epoch': 4, 'rec_loss': '7.1172'}
2025-02-27 11:33:59,382 - {'Epoch': 4, 'HR@5': '0.0367', 'NDCG@5': '0.0244', 'HR@10': '0.0569', 'NDCG@10': '0.0308', 'HR@20': '0.0881', 'NDCG@20': '0.0387'}
2025-02-27 11:33:59,383 - Validation score increased.  Saving model ...
2025-02-27 11:34:06,889 - {'epoch': 5, 'rec_loss': '6.9101'}
2025-02-27 11:34:07,680 - {'Epoch': 5, 'HR@5': '0.0358', 'NDCG@5': '0.0246', 'HR@10': '0.0550', 'NDCG@10': '0.0309', 'HR@20': '0.0908', 'NDCG@20': '0.0398'}
2025-02-27 11:34:07,681 - Validation score increased.  Saving model ...
2025-02-27 11:34:14,990 - {'epoch': 6, 'rec_loss': '6.7145'}
2025-02-27 11:34:15,735 - {'Epoch': 6, 'HR@5': '0.0440', 'NDCG@5': '0.0249', 'HR@10': '0.0651', 'NDCG@10': '0.0318', 'HR@20': '0.0954', 'NDCG@20': '0.0394'}
2025-02-27 11:34:15,736 - EarlyStopping counter: 1 out of 10
2025-02-27 11:34:23,342 - {'epoch': 7, 'rec_loss': '6.5370'}
2025-02-27 11:34:24,103 - {'Epoch': 7, 'HR@5': '0.0450', 'NDCG@5': '0.0273', 'HR@10': '0.0679', 'NDCG@10': '0.0346', 'HR@20': '0.0991', 'NDCG@20': '0.0424'}
2025-02-27 11:34:24,104 - Validation score increased.  Saving model ...
2025-02-27 11:34:31,405 - {'epoch': 8, 'rec_loss': '6.3739'}
2025-02-27 11:34:32,145 - {'Epoch': 8, 'HR@5': '0.0440', 'NDCG@5': '0.0266', 'HR@10': '0.0688', 'NDCG@10': '0.0346', 'HR@20': '0.1073', 'NDCG@20': '0.0443'}
2025-02-27 11:34:32,146 - Validation score increased.  Saving model ...
2025-02-27 11:34:39,326 - {'epoch': 9, 'rec_loss': '6.2585'}
2025-02-27 11:34:40,154 - {'Epoch': 9, 'HR@5': '0.0468', 'NDCG@5': '0.0289', 'HR@10': '0.0761', 'NDCG@10': '0.0383', 'HR@20': '0.1138', 'NDCG@20': '0.0477'}
2025-02-27 11:34:40,155 - Validation score increased.  Saving model ...
2025-02-27 11:34:47,671 - {'epoch': 10, 'rec_loss': '6.1200'}
2025-02-27 11:34:48,457 - {'Epoch': 10, 'HR@5': '0.0450', 'NDCG@5': '0.0290', 'HR@10': '0.0734', 'NDCG@10': '0.0382', 'HR@20': '0.1110', 'NDCG@20': '0.0476'}
2025-02-27 11:34:48,458 - EarlyStopping counter: 1 out of 10
2025-02-27 11:34:56,132 - {'epoch': 11, 'rec_loss': '6.0476'}
2025-02-27 11:34:56,854 - {'Epoch': 11, 'HR@5': '0.0468', 'NDCG@5': '0.0314', 'HR@10': '0.0725', 'NDCG@10': '0.0395', 'HR@20': '0.1165', 'NDCG@20': '0.0506'}
2025-02-27 11:34:56,855 - Validation score increased.  Saving model ...
2025-02-27 11:35:04,186 - {'epoch': 12, 'rec_loss': '5.9592'}
2025-02-27 11:35:04,975 - {'Epoch': 12, 'HR@5': '0.0422', 'NDCG@5': '0.0298', 'HR@10': '0.0743', 'NDCG@10': '0.0400', 'HR@20': '0.1229', 'NDCG@20': '0.0524'}
2025-02-27 11:35:04,976 - Validation score increased.  Saving model ...
2025-02-27 11:35:12,341 - {'epoch': 13, 'rec_loss': '5.8776'}
2025-02-27 11:35:13,244 - {'Epoch': 13, 'HR@5': '0.0413', 'NDCG@5': '0.0292', 'HR@10': '0.0789', 'NDCG@10': '0.0411', 'HR@20': '0.1211', 'NDCG@20': '0.0519'}
2025-02-27 11:35:13,245 - EarlyStopping counter: 1 out of 10
2025-02-27 11:35:20,208 - {'epoch': 14, 'rec_loss': '5.8102'}
2025-02-27 11:35:20,966 - {'Epoch': 14, 'HR@5': '0.0450', 'NDCG@5': '0.0300', 'HR@10': '0.0780', 'NDCG@10': '0.0406', 'HR@20': '0.1239', 'NDCG@20': '0.0522'}
2025-02-27 11:35:20,967 - EarlyStopping counter: 2 out of 10
2025-02-27 11:35:28,264 - {'epoch': 15, 'rec_loss': '5.7684'}
2025-02-27 11:35:29,022 - {'Epoch': 15, 'HR@5': '0.0523', 'NDCG@5': '0.0348', 'HR@10': '0.0798', 'NDCG@10': '0.0437', 'HR@20': '0.1211', 'NDCG@20': '0.0541'}
2025-02-27 11:35:29,023 - Validation score increased.  Saving model ...
2025-02-27 11:35:36,180 - {'epoch': 16, 'rec_loss': '5.7330'}
2025-02-27 11:35:36,917 - {'Epoch': 16, 'HR@5': '0.0495', 'NDCG@5': '0.0341', 'HR@10': '0.0725', 'NDCG@10': '0.0415', 'HR@20': '0.1229', 'NDCG@20': '0.0544'}
2025-02-27 11:35:36,918 - Validation score increased.  Saving model ...
2025-02-27 11:35:44,049 - {'epoch': 17, 'rec_loss': '5.6846'}
2025-02-27 11:35:44,768 - {'Epoch': 17, 'HR@5': '0.0495', 'NDCG@5': '0.0332', 'HR@10': '0.0807', 'NDCG@10': '0.0432', 'HR@20': '0.1275', 'NDCG@20': '0.0550'}
2025-02-27 11:35:44,769 - Validation score increased.  Saving model ...
2025-02-27 11:35:52,300 - {'epoch': 18, 'rec_loss': '5.6359'}
2025-02-27 11:35:53,056 - {'Epoch': 18, 'HR@5': '0.0514', 'NDCG@5': '0.0322', 'HR@10': '0.0807', 'NDCG@10': '0.0416', 'HR@20': '0.1330', 'NDCG@20': '0.0547'}
2025-02-27 11:35:53,057 - EarlyStopping counter: 1 out of 10
2025-02-27 11:36:00,159 - {'epoch': 19, 'rec_loss': '5.6026'}
2025-02-27 11:36:00,845 - {'Epoch': 19, 'HR@5': '0.0541', 'NDCG@5': '0.0329', 'HR@10': '0.0890', 'NDCG@10': '0.0441', 'HR@20': '0.1330', 'NDCG@20': '0.0551'}
2025-02-27 11:36:00,847 - Validation score increased.  Saving model ...
2025-02-27 11:36:07,867 - {'epoch': 20, 'rec_loss': '5.5855'}
2025-02-27 11:36:08,632 - {'Epoch': 20, 'HR@5': '0.0468', 'NDCG@5': '0.0320', 'HR@10': '0.0835', 'NDCG@10': '0.0438', 'HR@20': '0.1367', 'NDCG@20': '0.0571'}
2025-02-27 11:36:08,633 - Validation score increased.  Saving model ...
2025-02-27 11:36:16,084 - {'epoch': 21, 'rec_loss': '5.5469'}
2025-02-27 11:36:16,904 - {'Epoch': 21, 'HR@5': '0.0550', 'NDCG@5': '0.0352', 'HR@10': '0.0881', 'NDCG@10': '0.0457', 'HR@20': '0.1339', 'NDCG@20': '0.0572'}
2025-02-27 11:36:16,906 - Validation score increased.  Saving model ...
2025-02-27 11:36:24,211 - {'epoch': 22, 'rec_loss': '5.5392'}
2025-02-27 11:36:25,044 - {'Epoch': 22, 'HR@5': '0.0569', 'NDCG@5': '0.0374', 'HR@10': '0.0826', 'NDCG@10': '0.0456', 'HR@20': '0.1321', 'NDCG@20': '0.0582'}
2025-02-27 11:36:25,046 - Validation score increased.  Saving model ...
2025-02-27 11:36:32,065 - {'epoch': 23, 'rec_loss': '5.5293'}
2025-02-27 11:36:32,854 - {'Epoch': 23, 'HR@5': '0.0532', 'NDCG@5': '0.0346', 'HR@10': '0.0872', 'NDCG@10': '0.0456', 'HR@20': '0.1339', 'NDCG@20': '0.0576'}
2025-02-27 11:36:32,855 - EarlyStopping counter: 1 out of 10
2025-02-27 11:36:40,514 - {'epoch': 24, 'rec_loss': '5.4907'}
2025-02-27 11:36:41,465 - {'Epoch': 24, 'HR@5': '0.0541', 'NDCG@5': '0.0360', 'HR@10': '0.0899', 'NDCG@10': '0.0474', 'HR@20': '0.1339', 'NDCG@20': '0.0585'}
2025-02-27 11:36:41,466 - Validation score increased.  Saving model ...
2025-02-27 11:36:48,734 - {'epoch': 25, 'rec_loss': '5.4623'}
2025-02-27 11:36:49,420 - {'Epoch': 25, 'HR@5': '0.0523', 'NDCG@5': '0.0347', 'HR@10': '0.0881', 'NDCG@10': '0.0461', 'HR@20': '0.1376', 'NDCG@20': '0.0588'}
2025-02-27 11:36:49,421 - Validation score increased.  Saving model ...
2025-02-27 11:36:56,577 - {'epoch': 26, 'rec_loss': '5.4634'}
2025-02-27 11:36:57,384 - {'Epoch': 26, 'HR@5': '0.0532', 'NDCG@5': '0.0349', 'HR@10': '0.0862', 'NDCG@10': '0.0457', 'HR@20': '0.1404', 'NDCG@20': '0.0592'}
2025-02-27 11:36:57,385 - Validation score increased.  Saving model ...
2025-02-27 11:37:04,414 - {'epoch': 27, 'rec_loss': '5.4508'}
2025-02-27 11:37:05,267 - {'Epoch': 27, 'HR@5': '0.0541', 'NDCG@5': '0.0364', 'HR@10': '0.0862', 'NDCG@10': '0.0466', 'HR@20': '0.1358', 'NDCG@20': '0.0591'}
2025-02-27 11:37:05,268 - EarlyStopping counter: 1 out of 10
2025-02-27 11:37:12,987 - {'epoch': 28, 'rec_loss': '5.4310'}
2025-02-27 11:37:13,728 - {'Epoch': 28, 'HR@5': '0.0596', 'NDCG@5': '0.0385', 'HR@10': '0.0862', 'NDCG@10': '0.0469', 'HR@20': '0.1440', 'NDCG@20': '0.0614'}
2025-02-27 11:37:13,729 - Validation score increased.  Saving model ...
2025-02-27 11:37:20,993 - {'epoch': 29, 'rec_loss': '5.4182'}
2025-02-27 11:37:21,766 - {'Epoch': 29, 'HR@5': '0.0587', 'NDCG@5': '0.0392', 'HR@10': '0.0872', 'NDCG@10': '0.0482', 'HR@20': '0.1404', 'NDCG@20': '0.0615'}
2025-02-27 11:37:21,768 - Validation score increased.  Saving model ...
2025-02-27 11:37:28,698 - {'epoch': 30, 'rec_loss': '5.4082'}
2025-02-27 11:37:29,448 - {'Epoch': 30, 'HR@5': '0.0560', 'NDCG@5': '0.0379', 'HR@10': '0.0853', 'NDCG@10': '0.0473', 'HR@20': '0.1404', 'NDCG@20': '0.0611'}
2025-02-27 11:37:29,449 - EarlyStopping counter: 1 out of 10
2025-02-27 11:37:36,538 - {'epoch': 31, 'rec_loss': '5.4003'}
2025-02-27 11:37:37,269 - {'Epoch': 31, 'HR@5': '0.0587', 'NDCG@5': '0.0387', 'HR@10': '0.0936', 'NDCG@10': '0.0500', 'HR@20': '0.1440', 'NDCG@20': '0.0627'}
2025-02-27 11:37:37,270 - Validation score increased.  Saving model ...
2025-02-27 11:37:44,238 - {'epoch': 32, 'rec_loss': '5.3889'}
2025-02-27 11:37:45,122 - {'Epoch': 32, 'HR@5': '0.0587', 'NDCG@5': '0.0363', 'HR@10': '0.0881', 'NDCG@10': '0.0458', 'HR@20': '0.1404', 'NDCG@20': '0.0590'}
2025-02-27 11:37:45,124 - EarlyStopping counter: 1 out of 10
2025-02-27 11:37:52,383 - {'epoch': 33, 'rec_loss': '5.3678'}
2025-02-27 11:37:53,269 - {'Epoch': 33, 'HR@5': '0.0624', 'NDCG@5': '0.0377', 'HR@10': '0.0945', 'NDCG@10': '0.0482', 'HR@20': '0.1413', 'NDCG@20': '0.0599'}
2025-02-27 11:37:53,271 - EarlyStopping counter: 2 out of 10
2025-02-27 11:38:00,635 - {'epoch': 34, 'rec_loss': '5.3590'}
2025-02-27 11:38:01,444 - {'Epoch': 34, 'HR@5': '0.0661', 'NDCG@5': '0.0405', 'HR@10': '0.0927', 'NDCG@10': '0.0491', 'HR@20': '0.1431', 'NDCG@20': '0.0618'}
2025-02-27 11:38:01,446 - EarlyStopping counter: 3 out of 10
2025-02-27 11:38:09,036 - {'epoch': 35, 'rec_loss': '5.3270'}
2025-02-27 11:38:09,902 - {'Epoch': 35, 'HR@5': '0.0679', 'NDCG@5': '0.0420', 'HR@10': '0.0972', 'NDCG@10': '0.0514', 'HR@20': '0.1431', 'NDCG@20': '0.0629'}
2025-02-27 11:38:09,903 - Validation score increased.  Saving model ...
2025-02-27 11:38:17,426 - {'epoch': 36, 'rec_loss': '5.3234'}
2025-02-27 11:38:18,200 - {'Epoch': 36, 'HR@5': '0.0651', 'NDCG@5': '0.0398', 'HR@10': '0.0881', 'NDCG@10': '0.0473', 'HR@20': '0.1431', 'NDCG@20': '0.0613'}
2025-02-27 11:38:18,201 - EarlyStopping counter: 1 out of 10
2025-02-27 11:38:25,847 - {'epoch': 37, 'rec_loss': '5.3225'}
2025-02-27 11:38:26,677 - {'Epoch': 37, 'HR@5': '0.0606', 'NDCG@5': '0.0380', 'HR@10': '0.0908', 'NDCG@10': '0.0478', 'HR@20': '0.1440', 'NDCG@20': '0.0612'}
2025-02-27 11:38:26,678 - EarlyStopping counter: 2 out of 10
2025-02-27 11:38:33,712 - {'epoch': 38, 'rec_loss': '5.3277'}
2025-02-27 11:38:34,563 - {'Epoch': 38, 'HR@5': '0.0606', 'NDCG@5': '0.0392', 'HR@10': '0.0917', 'NDCG@10': '0.0493', 'HR@20': '0.1450', 'NDCG@20': '0.0627'}
2025-02-27 11:38:34,564 - EarlyStopping counter: 3 out of 10
2025-02-27 11:38:41,935 - {'epoch': 39, 'rec_loss': '5.3190'}
2025-02-27 11:38:42,781 - {'Epoch': 39, 'HR@5': '0.0606', 'NDCG@5': '0.0379', 'HR@10': '0.0954', 'NDCG@10': '0.0492', 'HR@20': '0.1459', 'NDCG@20': '0.0618'}
2025-02-27 11:38:42,783 - EarlyStopping counter: 4 out of 10
2025-02-27 11:38:50,194 - {'epoch': 40, 'rec_loss': '5.2790'}
2025-02-27 11:38:51,021 - {'Epoch': 40, 'HR@5': '0.0633', 'NDCG@5': '0.0413', 'HR@10': '0.0991', 'NDCG@10': '0.0527', 'HR@20': '0.1422', 'NDCG@20': '0.0636'}
2025-02-27 11:38:51,022 - Validation score increased.  Saving model ...
2025-02-27 11:38:58,535 - {'epoch': 41, 'rec_loss': '5.2943'}
2025-02-27 11:38:59,452 - {'Epoch': 41, 'HR@5': '0.0615', 'NDCG@5': '0.0410', 'HR@10': '0.0927', 'NDCG@10': '0.0512', 'HR@20': '0.1450', 'NDCG@20': '0.0643'}
2025-02-27 11:38:59,454 - Validation score increased.  Saving model ...
2025-02-27 11:39:06,673 - {'epoch': 42, 'rec_loss': '5.2943'}
2025-02-27 11:39:07,443 - {'Epoch': 42, 'HR@5': '0.0651', 'NDCG@5': '0.0420', 'HR@10': '0.0963', 'NDCG@10': '0.0520', 'HR@20': '0.1431', 'NDCG@20': '0.0638'}
2025-02-27 11:39:07,444 - EarlyStopping counter: 1 out of 10
2025-02-27 11:39:14,552 - {'epoch': 43, 'rec_loss': '5.2619'}
2025-02-27 11:39:15,316 - {'Epoch': 43, 'HR@5': '0.0624', 'NDCG@5': '0.0394', 'HR@10': '0.0917', 'NDCG@10': '0.0489', 'HR@20': '0.1477', 'NDCG@20': '0.0631'}
2025-02-27 11:39:15,317 - EarlyStopping counter: 2 out of 10
2025-02-27 11:39:22,408 - {'epoch': 44, 'rec_loss': '5.2700'}
2025-02-27 11:39:23,215 - {'Epoch': 44, 'HR@5': '0.0587', 'NDCG@5': '0.0408', 'HR@10': '0.0963', 'NDCG@10': '0.0530', 'HR@20': '0.1358', 'NDCG@20': '0.0628'}
2025-02-27 11:39:23,216 - EarlyStopping counter: 3 out of 10
2025-02-27 11:39:30,490 - {'epoch': 45, 'rec_loss': '5.2636'}
2025-02-27 11:39:31,418 - {'Epoch': 45, 'HR@5': '0.0615', 'NDCG@5': '0.0417', 'HR@10': '0.0927', 'NDCG@10': '0.0518', 'HR@20': '0.1422', 'NDCG@20': '0.0642'}
2025-02-27 11:39:31,420 - EarlyStopping counter: 4 out of 10
2025-02-27 11:39:38,703 - {'epoch': 46, 'rec_loss': '5.2488'}
2025-02-27 11:39:39,553 - {'Epoch': 46, 'HR@5': '0.0670', 'NDCG@5': '0.0425', 'HR@10': '0.0963', 'NDCG@10': '0.0520', 'HR@20': '0.1440', 'NDCG@20': '0.0639'}
2025-02-27 11:39:39,554 - EarlyStopping counter: 5 out of 10
2025-02-27 11:39:47,193 - {'epoch': 47, 'rec_loss': '5.2453'}
2025-02-27 11:39:48,067 - {'Epoch': 47, 'HR@5': '0.0661', 'NDCG@5': '0.0413', 'HR@10': '0.0936', 'NDCG@10': '0.0501', 'HR@20': '0.1413', 'NDCG@20': '0.0621'}
2025-02-27 11:39:48,068 - EarlyStopping counter: 6 out of 10
2025-02-27 11:39:55,851 - {'epoch': 48, 'rec_loss': '5.2545'}
2025-02-27 11:39:56,701 - {'Epoch': 48, 'HR@5': '0.0661', 'NDCG@5': '0.0418', 'HR@10': '0.0936', 'NDCG@10': '0.0508', 'HR@20': '0.1477', 'NDCG@20': '0.0645'}
2025-02-27 11:39:56,702 - Validation score increased.  Saving model ...
2025-02-27 11:40:04,144 - {'epoch': 49, 'rec_loss': '5.2391'}
2025-02-27 11:40:05,004 - {'Epoch': 49, 'HR@5': '0.0624', 'NDCG@5': '0.0394', 'HR@10': '0.0963', 'NDCG@10': '0.0503', 'HR@20': '0.1477', 'NDCG@20': '0.0632'}
2025-02-27 11:40:05,005 - EarlyStopping counter: 1 out of 10
2025-02-27 11:40:12,759 - {'epoch': 50, 'rec_loss': '5.2342'}
2025-02-27 11:40:13,560 - {'Epoch': 50, 'HR@5': '0.0606', 'NDCG@5': '0.0372', 'HR@10': '0.0991', 'NDCG@10': '0.0498', 'HR@20': '0.1422', 'NDCG@20': '0.0606'}
2025-02-27 11:40:13,562 - EarlyStopping counter: 2 out of 10
2025-02-27 11:40:21,276 - {'epoch': 51, 'rec_loss': '5.2212'}
2025-02-27 11:40:22,148 - {'Epoch': 51, 'HR@5': '0.0651', 'NDCG@5': '0.0405', 'HR@10': '0.0954', 'NDCG@10': '0.0502', 'HR@20': '0.1440', 'NDCG@20': '0.0625'}
2025-02-27 11:40:22,150 - EarlyStopping counter: 3 out of 10
2025-02-27 11:40:29,653 - {'epoch': 52, 'rec_loss': '5.2113'}
2025-02-27 11:40:30,467 - {'Epoch': 52, 'HR@5': '0.0661', 'NDCG@5': '0.0399', 'HR@10': '0.0982', 'NDCG@10': '0.0503', 'HR@20': '0.1422', 'NDCG@20': '0.0613'}
2025-02-27 11:40:30,468 - EarlyStopping counter: 4 out of 10
2025-02-27 11:40:37,694 - {'epoch': 53, 'rec_loss': '5.2211'}
2025-02-27 11:40:38,469 - {'Epoch': 53, 'HR@5': '0.0679', 'NDCG@5': '0.0425', 'HR@10': '0.0982', 'NDCG@10': '0.0523', 'HR@20': '0.1495', 'NDCG@20': '0.0652'}
2025-02-27 11:40:38,470 - Validation score increased.  Saving model ...
2025-02-27 11:40:45,907 - {'epoch': 54, 'rec_loss': '5.1973'}
2025-02-27 11:40:46,732 - {'Epoch': 54, 'HR@5': '0.0633', 'NDCG@5': '0.0406', 'HR@10': '0.0991', 'NDCG@10': '0.0523', 'HR@20': '0.1431', 'NDCG@20': '0.0635'}
2025-02-27 11:40:46,733 - EarlyStopping counter: 1 out of 10
2025-02-27 11:40:54,027 - {'epoch': 55, 'rec_loss': '5.1863'}
2025-02-27 11:40:54,855 - {'Epoch': 55, 'HR@5': '0.0651', 'NDCG@5': '0.0428', 'HR@10': '0.1018', 'NDCG@10': '0.0545', 'HR@20': '0.1440', 'NDCG@20': '0.0651'}
2025-02-27 11:40:54,856 - EarlyStopping counter: 2 out of 10
2025-02-27 11:41:02,372 - {'epoch': 56, 'rec_loss': '5.1937'}
2025-02-27 11:41:03,243 - {'Epoch': 56, 'HR@5': '0.0651', 'NDCG@5': '0.0420', 'HR@10': '0.0963', 'NDCG@10': '0.0519', 'HR@20': '0.1440', 'NDCG@20': '0.0641'}
2025-02-27 11:41:03,245 - EarlyStopping counter: 3 out of 10
2025-02-27 11:41:11,065 - {'epoch': 57, 'rec_loss': '5.2197'}
2025-02-27 11:41:11,942 - {'Epoch': 57, 'HR@5': '0.0596', 'NDCG@5': '0.0391', 'HR@10': '0.1000', 'NDCG@10': '0.0519', 'HR@20': '0.1505', 'NDCG@20': '0.0645'}
2025-02-27 11:41:11,943 - EarlyStopping counter: 4 out of 10
2025-02-27 11:41:19,279 - {'epoch': 58, 'rec_loss': '5.2125'}
2025-02-27 11:41:20,123 - {'Epoch': 58, 'HR@5': '0.0642', 'NDCG@5': '0.0414', 'HR@10': '0.1009', 'NDCG@10': '0.0531', 'HR@20': '0.1394', 'NDCG@20': '0.0628'}
2025-02-27 11:41:20,124 - EarlyStopping counter: 5 out of 10
2025-02-27 11:41:27,618 - {'epoch': 59, 'rec_loss': '5.1973'}
2025-02-27 11:41:28,483 - {'Epoch': 59, 'HR@5': '0.0642', 'NDCG@5': '0.0421', 'HR@10': '0.1037', 'NDCG@10': '0.0548', 'HR@20': '0.1477', 'NDCG@20': '0.0658'}
2025-02-27 11:41:28,484 - Validation score increased.  Saving model ...
2025-02-27 11:41:35,914 - {'epoch': 60, 'rec_loss': '5.1719'}
2025-02-27 11:41:36,792 - {'Epoch': 60, 'HR@5': '0.0615', 'NDCG@5': '0.0396', 'HR@10': '0.1037', 'NDCG@10': '0.0531', 'HR@20': '0.1422', 'NDCG@20': '0.0628'}
2025-02-27 11:41:36,793 - EarlyStopping counter: 1 out of 10
2025-02-27 11:41:44,332 - {'epoch': 61, 'rec_loss': '5.1676'}
2025-02-27 11:41:45,205 - {'Epoch': 61, 'HR@5': '0.0642', 'NDCG@5': '0.0427', 'HR@10': '0.1009', 'NDCG@10': '0.0543', 'HR@20': '0.1422', 'NDCG@20': '0.0648'}
2025-02-27 11:41:45,206 - EarlyStopping counter: 2 out of 10
2025-02-27 11:41:52,885 - {'epoch': 62, 'rec_loss': '5.1823'}
2025-02-27 11:41:53,741 - {'Epoch': 62, 'HR@5': '0.0688', 'NDCG@5': '0.0439', 'HR@10': '0.1046', 'NDCG@10': '0.0553', 'HR@20': '0.1450', 'NDCG@20': '0.0653'}
2025-02-27 11:41:53,742 - EarlyStopping counter: 3 out of 10
2025-02-27 11:42:01,470 - {'epoch': 63, 'rec_loss': '5.1744'}
2025-02-27 11:42:02,275 - {'Epoch': 63, 'HR@5': '0.0615', 'NDCG@5': '0.0404', 'HR@10': '0.1018', 'NDCG@10': '0.0535', 'HR@20': '0.1459', 'NDCG@20': '0.0646'}
2025-02-27 11:42:02,276 - EarlyStopping counter: 4 out of 10
2025-02-27 11:42:09,718 - {'epoch': 64, 'rec_loss': '5.1643'}
2025-02-27 11:42:10,600 - {'Epoch': 64, 'HR@5': '0.0697', 'NDCG@5': '0.0452', 'HR@10': '0.0972', 'NDCG@10': '0.0541', 'HR@20': '0.1431', 'NDCG@20': '0.0656'}
2025-02-27 11:42:10,601 - EarlyStopping counter: 5 out of 10
2025-02-27 11:42:17,684 - {'epoch': 65, 'rec_loss': '5.1770'}
2025-02-27 11:42:18,569 - {'Epoch': 65, 'HR@5': '0.0615', 'NDCG@5': '0.0411', 'HR@10': '0.1000', 'NDCG@10': '0.0535', 'HR@20': '0.1413', 'NDCG@20': '0.0641'}
2025-02-27 11:42:18,570 - EarlyStopping counter: 6 out of 10
2025-02-27 11:42:26,302 - {'epoch': 66, 'rec_loss': '5.1508'}
2025-02-27 11:42:27,135 - {'Epoch': 66, 'HR@5': '0.0606', 'NDCG@5': '0.0404', 'HR@10': '0.1028', 'NDCG@10': '0.0540', 'HR@20': '0.1404', 'NDCG@20': '0.0634'}
2025-02-27 11:42:27,136 - EarlyStopping counter: 7 out of 10
2025-02-27 11:42:34,461 - {'epoch': 67, 'rec_loss': '5.1649'}
2025-02-27 11:42:35,311 - {'Epoch': 67, 'HR@5': '0.0661', 'NDCG@5': '0.0412', 'HR@10': '0.0982', 'NDCG@10': '0.0515', 'HR@20': '0.1450', 'NDCG@20': '0.0634'}
2025-02-27 11:42:35,312 - EarlyStopping counter: 8 out of 10
2025-02-27 11:42:42,402 - {'epoch': 68, 'rec_loss': '5.1633'}
2025-02-27 11:42:43,212 - {'Epoch': 68, 'HR@5': '0.0651', 'NDCG@5': '0.0421', 'HR@10': '0.1073', 'NDCG@10': '0.0557', 'HR@20': '0.1440', 'NDCG@20': '0.0650'}
2025-02-27 11:42:43,214 - EarlyStopping counter: 9 out of 10
2025-02-27 11:42:50,859 - {'epoch': 69, 'rec_loss': '5.1522'}
2025-02-27 11:42:51,669 - {'Epoch': 69, 'HR@5': '0.0716', 'NDCG@5': '0.0453', 'HR@10': '0.1073', 'NDCG@10': '0.0567', 'HR@20': '0.1440', 'NDCG@20': '0.0660'}
2025-02-27 11:42:51,670 - Validation score increased.  Saving model ...
2025-02-27 11:42:59,180 - {'epoch': 70, 'rec_loss': '5.1412'}
2025-02-27 11:43:00,069 - {'Epoch': 70, 'HR@5': '0.0679', 'NDCG@5': '0.0456', 'HR@10': '0.1046', 'NDCG@10': '0.0574', 'HR@20': '0.1505', 'NDCG@20': '0.0690'}
2025-02-27 11:43:00,070 - Validation score increased.  Saving model ...
2025-02-27 11:43:07,259 - {'epoch': 71, 'rec_loss': '5.1316'}
2025-02-27 11:43:08,130 - {'Epoch': 71, 'HR@5': '0.0670', 'NDCG@5': '0.0440', 'HR@10': '0.1037', 'NDCG@10': '0.0559', 'HR@20': '0.1486', 'NDCG@20': '0.0673'}
2025-02-27 11:43:08,132 - EarlyStopping counter: 1 out of 10
2025-02-27 11:43:15,567 - {'epoch': 72, 'rec_loss': '5.1141'}
2025-02-27 11:43:16,489 - {'Epoch': 72, 'HR@5': '0.0661', 'NDCG@5': '0.0432', 'HR@10': '0.1037', 'NDCG@10': '0.0554', 'HR@20': '0.1440', 'NDCG@20': '0.0655'}
2025-02-27 11:43:16,491 - EarlyStopping counter: 2 out of 10
2025-02-27 11:43:23,900 - {'epoch': 73, 'rec_loss': '5.1320'}
2025-02-27 11:43:24,770 - {'Epoch': 73, 'HR@5': '0.0670', 'NDCG@5': '0.0428', 'HR@10': '0.0982', 'NDCG@10': '0.0529', 'HR@20': '0.1440', 'NDCG@20': '0.0645'}
2025-02-27 11:43:24,771 - EarlyStopping counter: 3 out of 10
2025-02-27 11:43:32,432 - {'epoch': 74, 'rec_loss': '5.1190'}
2025-02-27 11:43:33,284 - {'Epoch': 74, 'HR@5': '0.0697', 'NDCG@5': '0.0479', 'HR@10': '0.1000', 'NDCG@10': '0.0575', 'HR@20': '0.1532', 'NDCG@20': '0.0708'}
2025-02-27 11:43:33,286 - Validation score increased.  Saving model ...
2025-02-27 11:43:40,676 - {'epoch': 75, 'rec_loss': '5.1568'}
2025-02-27 11:43:41,389 - {'Epoch': 75, 'HR@5': '0.0651', 'NDCG@5': '0.0399', 'HR@10': '0.1009', 'NDCG@10': '0.0511', 'HR@20': '0.1505', 'NDCG@20': '0.0636'}
2025-02-27 11:43:41,391 - EarlyStopping counter: 1 out of 10
2025-02-27 11:43:48,769 - {'epoch': 76, 'rec_loss': '5.1034'}
2025-02-27 11:43:49,543 - {'Epoch': 76, 'HR@5': '0.0615', 'NDCG@5': '0.0411', 'HR@10': '0.1037', 'NDCG@10': '0.0544', 'HR@20': '0.1440', 'NDCG@20': '0.0646'}
2025-02-27 11:43:49,544 - EarlyStopping counter: 2 out of 10
2025-02-27 11:43:56,721 - {'epoch': 77, 'rec_loss': '5.1045'}
2025-02-27 11:43:57,478 - {'Epoch': 77, 'HR@5': '0.0670', 'NDCG@5': '0.0431', 'HR@10': '0.1037', 'NDCG@10': '0.0547', 'HR@20': '0.1495', 'NDCG@20': '0.0664'}
2025-02-27 11:43:57,479 - EarlyStopping counter: 3 out of 10
2025-02-27 11:44:05,184 - {'epoch': 78, 'rec_loss': '5.1027'}
2025-02-27 11:44:06,049 - {'Epoch': 78, 'HR@5': '0.0642', 'NDCG@5': '0.0441', 'HR@10': '0.1055', 'NDCG@10': '0.0573', 'HR@20': '0.1514', 'NDCG@20': '0.0687'}
2025-02-27 11:44:06,050 - EarlyStopping counter: 4 out of 10
2025-02-27 11:44:13,106 - {'epoch': 79, 'rec_loss': '5.0958'}
2025-02-27 11:44:13,801 - {'Epoch': 79, 'HR@5': '0.0706', 'NDCG@5': '0.0449', 'HR@10': '0.0991', 'NDCG@10': '0.0541', 'HR@20': '0.1486', 'NDCG@20': '0.0665'}
2025-02-27 11:44:13,802 - EarlyStopping counter: 5 out of 10
2025-02-27 11:44:20,829 - {'epoch': 80, 'rec_loss': '5.0980'}
2025-02-27 11:44:21,590 - {'Epoch': 80, 'HR@5': '0.0642', 'NDCG@5': '0.0421', 'HR@10': '0.1055', 'NDCG@10': '0.0553', 'HR@20': '0.1440', 'NDCG@20': '0.0650'}
2025-02-27 11:44:21,592 - EarlyStopping counter: 6 out of 10
2025-02-27 11:44:28,832 - {'epoch': 81, 'rec_loss': '5.0987'}
2025-02-27 11:44:29,606 - {'Epoch': 81, 'HR@5': '0.0587', 'NDCG@5': '0.0376', 'HR@10': '0.0991', 'NDCG@10': '0.0506', 'HR@20': '0.1450', 'NDCG@20': '0.0623'}
2025-02-27 11:44:29,608 - EarlyStopping counter: 7 out of 10
2025-02-27 11:44:36,700 - {'epoch': 82, 'rec_loss': '5.1034'}
2025-02-27 11:44:37,429 - {'Epoch': 82, 'HR@5': '0.0606', 'NDCG@5': '0.0402', 'HR@10': '0.1000', 'NDCG@10': '0.0529', 'HR@20': '0.1468', 'NDCG@20': '0.0645'}
2025-02-27 11:44:37,431 - EarlyStopping counter: 8 out of 10
2025-02-27 11:44:44,094 - {'epoch': 83, 'rec_loss': '5.0628'}
2025-02-27 11:44:44,909 - {'Epoch': 83, 'HR@5': '0.0624', 'NDCG@5': '0.0401', 'HR@10': '0.1000', 'NDCG@10': '0.0524', 'HR@20': '0.1431', 'NDCG@20': '0.0633'}
2025-02-27 11:44:44,910 - EarlyStopping counter: 9 out of 10
2025-02-27 11:44:52,381 - {'epoch': 84, 'rec_loss': '5.0978'}
2025-02-27 11:44:53,077 - {'Epoch': 84, 'HR@5': '0.0651', 'NDCG@5': '0.0424', 'HR@10': '0.1046', 'NDCG@10': '0.0551', 'HR@20': '0.1459', 'NDCG@20': '0.0654'}
2025-02-27 11:44:53,078 - EarlyStopping counter: 10 out of 10
2025-02-27 11:44:53,079 - Early stopping
2025-02-27 11:44:53,079 - ---------------Test Score---------------
2025-02-27 11:44:53,896 - {'Epoch': 0, 'HR@5': '0.0560', 'NDCG@5': '0.0343', 'HR@10': '0.0798', 'NDCG@10': '0.0417', 'HR@20': '0.1028', 'NDCG@20': '0.0474'}
2025-02-27 11:44:53,897 - Scale_LastFM
2025-02-27 11:44:53,898 - {'Epoch': 0, 'HR@5': '0.0560', 'NDCG@5': '0.0343', 'HR@10': '0.0798', 'NDCG@10': '0.0417', 'HR@20': '0.1028', 'NDCG@20': '0.0474'}
2025-02-27 11:46:14,096 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 4, 6], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-27 11:46:20,331 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-27 11:46:20,336 - Total Parameters: 387350
2025-02-27 11:46:28,881 - {'epoch': 0, 'rec_loss': '8.0390'}
2025-02-27 11:46:29,717 - {'Epoch': 0, 'HR@5': '0.0202', 'NDCG@5': '0.0143', 'HR@10': '0.0358', 'NDCG@10': '0.0193', 'HR@20': '0.0642', 'NDCG@20': '0.0264'}
2025-02-27 11:46:29,719 - Validation score increased.  Saving model ...
2025-02-27 11:46:36,854 - {'epoch': 1, 'rec_loss': '7.7576'}
2025-02-27 11:46:37,737 - {'Epoch': 1, 'HR@5': '0.0229', 'NDCG@5': '0.0152', 'HR@10': '0.0358', 'NDCG@10': '0.0194', 'HR@20': '0.0615', 'NDCG@20': '0.0258'}
2025-02-27 11:46:37,738 - EarlyStopping counter: 1 out of 10
2025-02-27 11:46:44,777 - {'epoch': 2, 'rec_loss': '7.5494'}
2025-02-27 11:46:45,672 - {'Epoch': 2, 'HR@5': '0.0312', 'NDCG@5': '0.0210', 'HR@10': '0.0486', 'NDCG@10': '0.0267', 'HR@20': '0.0725', 'NDCG@20': '0.0326'}
2025-02-27 11:46:45,673 - Validation score increased.  Saving model ...
2025-02-27 11:46:53,125 - {'epoch': 3, 'rec_loss': '7.3262'}
2025-02-27 11:46:53,968 - {'Epoch': 3, 'HR@5': '0.0330', 'NDCG@5': '0.0219', 'HR@10': '0.0468', 'NDCG@10': '0.0263', 'HR@20': '0.0706', 'NDCG@20': '0.0322'}
2025-02-27 11:46:53,969 - EarlyStopping counter: 1 out of 10
2025-02-27 11:47:01,196 - {'epoch': 4, 'rec_loss': '7.1146'}
2025-02-27 11:47:02,026 - {'Epoch': 4, 'HR@5': '0.0358', 'NDCG@5': '0.0242', 'HR@10': '0.0550', 'NDCG@10': '0.0302', 'HR@20': '0.0872', 'NDCG@20': '0.0384'}
2025-02-27 11:47:02,027 - Validation score increased.  Saving model ...
2025-02-27 11:47:09,235 - {'epoch': 5, 'rec_loss': '6.9063'}
2025-02-27 11:47:10,067 - {'Epoch': 5, 'HR@5': '0.0358', 'NDCG@5': '0.0242', 'HR@10': '0.0569', 'NDCG@10': '0.0311', 'HR@20': '0.0936', 'NDCG@20': '0.0401'}
2025-02-27 11:47:10,068 - Validation score increased.  Saving model ...
2025-02-27 11:47:17,338 - {'epoch': 6, 'rec_loss': '6.7088'}
2025-02-27 11:47:18,163 - {'Epoch': 6, 'HR@5': '0.0404', 'NDCG@5': '0.0237', 'HR@10': '0.0661', 'NDCG@10': '0.0322', 'HR@20': '0.0963', 'NDCG@20': '0.0399'}
2025-02-27 11:47:18,165 - EarlyStopping counter: 1 out of 10
2025-02-27 11:47:25,390 - {'epoch': 7, 'rec_loss': '6.5294'}
2025-02-27 11:47:26,247 - {'Epoch': 7, 'HR@5': '0.0450', 'NDCG@5': '0.0272', 'HR@10': '0.0670', 'NDCG@10': '0.0342', 'HR@20': '0.1018', 'NDCG@20': '0.0430'}
2025-02-27 11:47:26,248 - Validation score increased.  Saving model ...
2025-02-27 11:47:33,372 - {'epoch': 8, 'rec_loss': '6.3638'}
2025-02-27 11:47:34,249 - {'Epoch': 8, 'HR@5': '0.0394', 'NDCG@5': '0.0257', 'HR@10': '0.0688', 'NDCG@10': '0.0352', 'HR@20': '0.1092', 'NDCG@20': '0.0454'}
2025-02-27 11:47:34,250 - Validation score increased.  Saving model ...
2025-02-27 11:47:41,376 - {'epoch': 9, 'rec_loss': '6.2503'}
2025-02-27 11:47:42,179 - {'Epoch': 9, 'HR@5': '0.0486', 'NDCG@5': '0.0300', 'HR@10': '0.0771', 'NDCG@10': '0.0390', 'HR@20': '0.1119', 'NDCG@20': '0.0478'}
2025-02-27 11:47:42,181 - Validation score increased.  Saving model ...
2025-02-27 11:47:49,518 - {'epoch': 10, 'rec_loss': '6.1099'}
2025-02-27 11:47:50,318 - {'Epoch': 10, 'HR@5': '0.0477', 'NDCG@5': '0.0313', 'HR@10': '0.0688', 'NDCG@10': '0.0382', 'HR@20': '0.1138', 'NDCG@20': '0.0495'}
2025-02-27 11:47:50,319 - Validation score increased.  Saving model ...
2025-02-27 11:47:57,558 - {'epoch': 11, 'rec_loss': '6.0368'}
2025-02-27 11:47:58,334 - {'Epoch': 11, 'HR@5': '0.0468', 'NDCG@5': '0.0315', 'HR@10': '0.0743', 'NDCG@10': '0.0401', 'HR@20': '0.1193', 'NDCG@20': '0.0514'}
2025-02-27 11:47:58,335 - Validation score increased.  Saving model ...
2025-02-27 11:48:05,447 - {'epoch': 12, 'rec_loss': '5.9479'}
2025-02-27 11:48:06,287 - {'Epoch': 12, 'HR@5': '0.0431', 'NDCG@5': '0.0298', 'HR@10': '0.0807', 'NDCG@10': '0.0418', 'HR@20': '0.1266', 'NDCG@20': '0.0533'}
2025-02-27 11:48:06,288 - Validation score increased.  Saving model ...
2025-02-27 11:48:13,549 - {'epoch': 13, 'rec_loss': '5.8672'}
2025-02-27 11:48:14,431 - {'Epoch': 13, 'HR@5': '0.0431', 'NDCG@5': '0.0294', 'HR@10': '0.0780', 'NDCG@10': '0.0405', 'HR@20': '0.1257', 'NDCG@20': '0.0527'}
2025-02-27 11:48:14,433 - EarlyStopping counter: 1 out of 10
2025-02-27 11:48:21,787 - {'epoch': 14, 'rec_loss': '5.7979'}
2025-02-27 11:48:22,698 - {'Epoch': 14, 'HR@5': '0.0468', 'NDCG@5': '0.0317', 'HR@10': '0.0807', 'NDCG@10': '0.0427', 'HR@20': '0.1257', 'NDCG@20': '0.0540'}
2025-02-27 11:48:22,699 - Validation score increased.  Saving model ...
2025-02-27 11:48:29,875 - {'epoch': 15, 'rec_loss': '5.7557'}
2025-02-27 11:48:30,712 - {'Epoch': 15, 'HR@5': '0.0541', 'NDCG@5': '0.0347', 'HR@10': '0.0817', 'NDCG@10': '0.0436', 'HR@20': '0.1284', 'NDCG@20': '0.0553'}
2025-02-27 11:48:30,713 - Validation score increased.  Saving model ...
2025-02-27 11:48:38,205 - {'epoch': 16, 'rec_loss': '5.7245'}
2025-02-27 11:48:39,093 - {'Epoch': 16, 'HR@5': '0.0505', 'NDCG@5': '0.0336', 'HR@10': '0.0761', 'NDCG@10': '0.0420', 'HR@20': '0.1257', 'NDCG@20': '0.0545'}
2025-02-27 11:48:39,095 - EarlyStopping counter: 1 out of 10
2025-02-27 11:48:46,216 - {'epoch': 17, 'rec_loss': '5.6744'}
2025-02-27 11:48:47,084 - {'Epoch': 17, 'HR@5': '0.0532', 'NDCG@5': '0.0336', 'HR@10': '0.0817', 'NDCG@10': '0.0428', 'HR@20': '0.1358', 'NDCG@20': '0.0564'}
2025-02-27 11:48:47,085 - Validation score increased.  Saving model ...
2025-02-27 11:48:54,563 - {'epoch': 18, 'rec_loss': '5.6230'}
2025-02-27 11:48:55,446 - {'Epoch': 18, 'HR@5': '0.0505', 'NDCG@5': '0.0317', 'HR@10': '0.0853', 'NDCG@10': '0.0427', 'HR@20': '0.1367', 'NDCG@20': '0.0555'}
2025-02-27 11:48:55,447 - EarlyStopping counter: 1 out of 10
2025-02-27 11:49:02,973 - {'epoch': 19, 'rec_loss': '5.5911'}
2025-02-27 11:49:03,829 - {'Epoch': 19, 'HR@5': '0.0532', 'NDCG@5': '0.0320', 'HR@10': '0.0890', 'NDCG@10': '0.0437', 'HR@20': '0.1339', 'NDCG@20': '0.0551'}
2025-02-27 11:49:03,830 - EarlyStopping counter: 2 out of 10
2025-02-27 11:49:11,129 - {'epoch': 20, 'rec_loss': '5.5729'}
2025-02-27 11:49:11,933 - {'Epoch': 20, 'HR@5': '0.0468', 'NDCG@5': '0.0310', 'HR@10': '0.0872', 'NDCG@10': '0.0440', 'HR@20': '0.1349', 'NDCG@20': '0.0559'}
2025-02-27 11:49:11,934 - EarlyStopping counter: 3 out of 10
2025-02-27 11:49:18,905 - {'epoch': 21, 'rec_loss': '5.5348'}
2025-02-27 11:49:19,812 - {'Epoch': 21, 'HR@5': '0.0550', 'NDCG@5': '0.0356', 'HR@10': '0.0881', 'NDCG@10': '0.0460', 'HR@20': '0.1339', 'NDCG@20': '0.0577'}
2025-02-27 11:49:19,813 - Validation score increased.  Saving model ...
2025-02-27 11:49:27,098 - {'epoch': 22, 'rec_loss': '5.5271'}
2025-02-27 11:49:28,015 - {'Epoch': 22, 'HR@5': '0.0541', 'NDCG@5': '0.0348', 'HR@10': '0.0881', 'NDCG@10': '0.0456', 'HR@20': '0.1349', 'NDCG@20': '0.0575'}
2025-02-27 11:49:28,016 - EarlyStopping counter: 1 out of 10
2025-02-27 11:49:35,097 - {'epoch': 23, 'rec_loss': '5.5184'}
2025-02-27 11:49:35,966 - {'Epoch': 23, 'HR@5': '0.0514', 'NDCG@5': '0.0345', 'HR@10': '0.0908', 'NDCG@10': '0.0473', 'HR@20': '0.1422', 'NDCG@20': '0.0605'}
2025-02-27 11:49:35,967 - Validation score increased.  Saving model ...
2025-02-27 11:49:43,266 - {'epoch': 24, 'rec_loss': '5.4779'}
2025-02-27 11:49:44,098 - {'Epoch': 24, 'HR@5': '0.0560', 'NDCG@5': '0.0367', 'HR@10': '0.0936', 'NDCG@10': '0.0486', 'HR@20': '0.1330', 'NDCG@20': '0.0587'}
2025-02-27 11:49:44,099 - EarlyStopping counter: 1 out of 10
2025-02-27 11:49:51,418 - {'epoch': 25, 'rec_loss': '5.4467'}
2025-02-27 11:49:52,273 - {'Epoch': 25, 'HR@5': '0.0578', 'NDCG@5': '0.0358', 'HR@10': '0.0908', 'NDCG@10': '0.0462', 'HR@20': '0.1404', 'NDCG@20': '0.0587'}
2025-02-27 11:49:52,275 - EarlyStopping counter: 2 out of 10
2025-02-27 11:49:59,582 - {'epoch': 26, 'rec_loss': '5.4522'}
2025-02-27 11:50:00,449 - {'Epoch': 26, 'HR@5': '0.0514', 'NDCG@5': '0.0333', 'HR@10': '0.0908', 'NDCG@10': '0.0461', 'HR@20': '0.1404', 'NDCG@20': '0.0585'}
2025-02-27 11:50:00,450 - EarlyStopping counter: 3 out of 10
2025-02-27 11:50:07,683 - {'epoch': 27, 'rec_loss': '5.4387'}
2025-02-27 11:50:08,485 - {'Epoch': 27, 'HR@5': '0.0569', 'NDCG@5': '0.0362', 'HR@10': '0.0844', 'NDCG@10': '0.0451', 'HR@20': '0.1394', 'NDCG@20': '0.0592'}
2025-02-27 11:50:08,487 - EarlyStopping counter: 4 out of 10
2025-02-27 11:50:15,490 - {'epoch': 28, 'rec_loss': '5.4187'}
2025-02-27 11:50:16,397 - {'Epoch': 28, 'HR@5': '0.0587', 'NDCG@5': '0.0381', 'HR@10': '0.0908', 'NDCG@10': '0.0481', 'HR@20': '0.1468', 'NDCG@20': '0.0621'}
2025-02-27 11:50:16,399 - Validation score increased.  Saving model ...
2025-02-27 11:50:23,570 - {'epoch': 29, 'rec_loss': '5.4066'}
2025-02-27 11:50:24,400 - {'Epoch': 29, 'HR@5': '0.0569', 'NDCG@5': '0.0381', 'HR@10': '0.0844', 'NDCG@10': '0.0469', 'HR@20': '0.1440', 'NDCG@20': '0.0620'}
2025-02-27 11:50:24,401 - EarlyStopping counter: 1 out of 10
2025-02-27 11:50:31,895 - {'epoch': 30, 'rec_loss': '5.3962'}
2025-02-27 11:50:32,742 - {'Epoch': 30, 'HR@5': '0.0560', 'NDCG@5': '0.0378', 'HR@10': '0.0872', 'NDCG@10': '0.0477', 'HR@20': '0.1450', 'NDCG@20': '0.0622'}
2025-02-27 11:50:32,743 - Validation score increased.  Saving model ...
2025-02-27 11:50:40,484 - {'epoch': 31, 'rec_loss': '5.3884'}
2025-02-27 11:50:41,313 - {'Epoch': 31, 'HR@5': '0.0633', 'NDCG@5': '0.0406', 'HR@10': '0.0991', 'NDCG@10': '0.0519', 'HR@20': '0.1477', 'NDCG@20': '0.0640'}
2025-02-27 11:50:41,315 - Validation score increased.  Saving model ...
2025-02-27 11:50:48,287 - {'epoch': 32, 'rec_loss': '5.3783'}
2025-02-27 11:50:49,070 - {'Epoch': 32, 'HR@5': '0.0606', 'NDCG@5': '0.0372', 'HR@10': '0.0908', 'NDCG@10': '0.0469', 'HR@20': '0.1459', 'NDCG@20': '0.0608'}
2025-02-27 11:50:49,071 - EarlyStopping counter: 1 out of 10
2025-02-27 11:50:56,189 - {'epoch': 33, 'rec_loss': '5.3590'}
2025-02-27 11:50:57,073 - {'Epoch': 33, 'HR@5': '0.0633', 'NDCG@5': '0.0397', 'HR@10': '0.0881', 'NDCG@10': '0.0478', 'HR@20': '0.1514', 'NDCG@20': '0.0641'}
2025-02-27 11:50:57,074 - Validation score increased.  Saving model ...
2025-02-27 11:51:04,222 - {'epoch': 34, 'rec_loss': '5.3464'}
2025-02-27 11:51:05,014 - {'Epoch': 34, 'HR@5': '0.0642', 'NDCG@5': '0.0405', 'HR@10': '0.0991', 'NDCG@10': '0.0515', 'HR@20': '0.1523', 'NDCG@20': '0.0646'}
2025-02-27 11:51:05,015 - Validation score increased.  Saving model ...
2025-02-27 11:51:12,150 - {'epoch': 35, 'rec_loss': '5.3164'}
2025-02-27 11:51:13,033 - {'Epoch': 35, 'HR@5': '0.0679', 'NDCG@5': '0.0422', 'HR@10': '0.1037', 'NDCG@10': '0.0534', 'HR@20': '0.1486', 'NDCG@20': '0.0648'}
2025-02-27 11:51:13,034 - Validation score increased.  Saving model ...
2025-02-27 11:51:19,969 - {'epoch': 36, 'rec_loss': '5.3148'}
2025-02-27 11:51:20,851 - {'Epoch': 36, 'HR@5': '0.0596', 'NDCG@5': '0.0377', 'HR@10': '0.0936', 'NDCG@10': '0.0486', 'HR@20': '0.1477', 'NDCG@20': '0.0624'}
2025-02-27 11:51:20,853 - EarlyStopping counter: 1 out of 10
2025-02-27 11:51:27,939 - {'epoch': 37, 'rec_loss': '5.3116'}
2025-02-27 11:51:28,782 - {'Epoch': 37, 'HR@5': '0.0587', 'NDCG@5': '0.0376', 'HR@10': '0.0936', 'NDCG@10': '0.0490', 'HR@20': '0.1486', 'NDCG@20': '0.0629'}
2025-02-27 11:51:28,783 - EarlyStopping counter: 2 out of 10
2025-02-27 11:51:35,813 - {'epoch': 38, 'rec_loss': '5.3141'}
2025-02-27 11:51:36,719 - {'Epoch': 38, 'HR@5': '0.0587', 'NDCG@5': '0.0389', 'HR@10': '0.0936', 'NDCG@10': '0.0503', 'HR@20': '0.1486', 'NDCG@20': '0.0643'}
2025-02-27 11:51:36,720 - EarlyStopping counter: 3 out of 10
2025-02-27 11:51:43,677 - {'epoch': 39, 'rec_loss': '5.3093'}
2025-02-27 11:51:44,523 - {'Epoch': 39, 'HR@5': '0.0596', 'NDCG@5': '0.0374', 'HR@10': '0.1028', 'NDCG@10': '0.0511', 'HR@20': '0.1450', 'NDCG@20': '0.0619'}
2025-02-27 11:51:44,524 - EarlyStopping counter: 4 out of 10
2025-02-27 11:51:51,862 - {'epoch': 40, 'rec_loss': '5.2668'}
2025-02-27 11:51:52,660 - {'Epoch': 40, 'HR@5': '0.0624', 'NDCG@5': '0.0399', 'HR@10': '0.0982', 'NDCG@10': '0.0516', 'HR@20': '0.1440', 'NDCG@20': '0.0634'}
2025-02-27 11:51:52,661 - EarlyStopping counter: 5 out of 10
2025-02-27 11:52:00,252 - {'epoch': 41, 'rec_loss': '5.2826'}
2025-02-27 11:52:01,084 - {'Epoch': 41, 'HR@5': '0.0642', 'NDCG@5': '0.0417', 'HR@10': '0.1000', 'NDCG@10': '0.0533', 'HR@20': '0.1440', 'NDCG@20': '0.0644'}
2025-02-27 11:52:01,085 - EarlyStopping counter: 6 out of 10
2025-02-27 11:52:08,664 - {'epoch': 42, 'rec_loss': '5.2824'}
2025-02-27 11:52:09,554 - {'Epoch': 42, 'HR@5': '0.0670', 'NDCG@5': '0.0433', 'HR@10': '0.1009', 'NDCG@10': '0.0542', 'HR@20': '0.1468', 'NDCG@20': '0.0656'}
2025-02-27 11:52:09,556 - Validation score increased.  Saving model ...
2025-02-27 11:52:16,453 - {'epoch': 43, 'rec_loss': '5.2524'}
2025-02-27 11:52:17,285 - {'Epoch': 43, 'HR@5': '0.0642', 'NDCG@5': '0.0408', 'HR@10': '0.0972', 'NDCG@10': '0.0515', 'HR@20': '0.1477', 'NDCG@20': '0.0643'}
2025-02-27 11:52:17,287 - EarlyStopping counter: 1 out of 10
2025-02-27 11:52:24,216 - {'epoch': 44, 'rec_loss': '5.2570'}
2025-02-27 11:52:25,117 - {'Epoch': 44, 'HR@5': '0.0624', 'NDCG@5': '0.0414', 'HR@10': '0.0991', 'NDCG@10': '0.0533', 'HR@20': '0.1422', 'NDCG@20': '0.0642'}
2025-02-27 11:52:25,118 - EarlyStopping counter: 2 out of 10
2025-02-27 11:52:32,133 - {'epoch': 45, 'rec_loss': '5.2532'}
2025-02-27 11:52:32,973 - {'Epoch': 45, 'HR@5': '0.0633', 'NDCG@5': '0.0414', 'HR@10': '0.0963', 'NDCG@10': '0.0521', 'HR@20': '0.1477', 'NDCG@20': '0.0650'}
2025-02-27 11:52:32,974 - EarlyStopping counter: 3 out of 10
2025-02-27 11:52:40,280 - {'epoch': 46, 'rec_loss': '5.2368'}
2025-02-27 11:52:41,224 - {'Epoch': 46, 'HR@5': '0.0706', 'NDCG@5': '0.0426', 'HR@10': '0.1028', 'NDCG@10': '0.0529', 'HR@20': '0.1532', 'NDCG@20': '0.0656'}
2025-02-27 11:52:41,225 - EarlyStopping counter: 4 out of 10
2025-02-27 11:52:48,124 - {'epoch': 47, 'rec_loss': '5.2334'}
2025-02-27 11:52:48,927 - {'Epoch': 47, 'HR@5': '0.0688', 'NDCG@5': '0.0422', 'HR@10': '0.0991', 'NDCG@10': '0.0519', 'HR@20': '0.1532', 'NDCG@20': '0.0653'}
2025-02-27 11:52:48,928 - EarlyStopping counter: 5 out of 10
2025-02-27 11:52:56,189 - {'epoch': 48, 'rec_loss': '5.2434'}
2025-02-27 11:52:57,025 - {'Epoch': 48, 'HR@5': '0.0651', 'NDCG@5': '0.0408', 'HR@10': '0.1046', 'NDCG@10': '0.0537', 'HR@20': '0.1578', 'NDCG@20': '0.0669'}
2025-02-27 11:52:57,026 - Validation score increased.  Saving model ...
2025-02-27 11:53:04,262 - {'epoch': 49, 'rec_loss': '5.2244'}
2025-02-27 11:53:05,133 - {'Epoch': 49, 'HR@5': '0.0596', 'NDCG@5': '0.0386', 'HR@10': '0.1009', 'NDCG@10': '0.0520', 'HR@20': '0.1560', 'NDCG@20': '0.0658'}
2025-02-27 11:53:05,134 - EarlyStopping counter: 1 out of 10
2025-02-27 11:53:12,432 - {'epoch': 50, 'rec_loss': '5.2251'}
2025-02-27 11:53:13,249 - {'Epoch': 50, 'HR@5': '0.0615', 'NDCG@5': '0.0382', 'HR@10': '0.1000', 'NDCG@10': '0.0507', 'HR@20': '0.1523', 'NDCG@20': '0.0640'}
2025-02-27 11:53:13,250 - EarlyStopping counter: 2 out of 10
2025-02-27 11:53:20,541 - {'epoch': 51, 'rec_loss': '5.2081'}
2025-02-27 11:53:21,394 - {'Epoch': 51, 'HR@5': '0.0679', 'NDCG@5': '0.0418', 'HR@10': '0.1028', 'NDCG@10': '0.0527', 'HR@20': '0.1550', 'NDCG@20': '0.0657'}
2025-02-27 11:53:21,395 - EarlyStopping counter: 3 out of 10
2025-02-27 11:53:28,726 - {'epoch': 52, 'rec_loss': '5.2037'}
2025-02-27 11:53:29,563 - {'Epoch': 52, 'HR@5': '0.0633', 'NDCG@5': '0.0392', 'HR@10': '0.1046', 'NDCG@10': '0.0525', 'HR@20': '0.1486', 'NDCG@20': '0.0636'}
2025-02-27 11:53:29,565 - EarlyStopping counter: 4 out of 10
2025-02-27 11:53:36,914 - {'epoch': 53, 'rec_loss': '5.2076'}
2025-02-27 11:53:37,728 - {'Epoch': 53, 'HR@5': '0.0661', 'NDCG@5': '0.0438', 'HR@10': '0.0991', 'NDCG@10': '0.0544', 'HR@20': '0.1514', 'NDCG@20': '0.0679'}
2025-02-27 11:53:37,730 - Validation score increased.  Saving model ...
2025-02-27 11:53:45,294 - {'epoch': 54, 'rec_loss': '5.1864'}
2025-02-27 11:53:46,152 - {'Epoch': 54, 'HR@5': '0.0716', 'NDCG@5': '0.0447', 'HR@10': '0.1055', 'NDCG@10': '0.0554', 'HR@20': '0.1505', 'NDCG@20': '0.0667'}
2025-02-27 11:53:46,153 - EarlyStopping counter: 1 out of 10
2025-02-27 11:53:53,164 - {'epoch': 55, 'rec_loss': '5.1772'}
2025-02-27 11:53:54,000 - {'Epoch': 55, 'HR@5': '0.0624', 'NDCG@5': '0.0421', 'HR@10': '0.1083', 'NDCG@10': '0.0570', 'HR@20': '0.1505', 'NDCG@20': '0.0675'}
2025-02-27 11:53:54,002 - EarlyStopping counter: 2 out of 10
2025-02-27 11:54:01,349 - {'epoch': 56, 'rec_loss': '5.1833'}
2025-02-27 11:54:02,314 - {'Epoch': 56, 'HR@5': '0.0661', 'NDCG@5': '0.0424', 'HR@10': '0.1037', 'NDCG@10': '0.0544', 'HR@20': '0.1532', 'NDCG@20': '0.0670'}
2025-02-27 11:54:02,316 - EarlyStopping counter: 3 out of 10
2025-02-27 11:54:09,572 - {'epoch': 57, 'rec_loss': '5.2060'}
2025-02-27 11:54:10,449 - {'Epoch': 57, 'HR@5': '0.0624', 'NDCG@5': '0.0406', 'HR@10': '0.1055', 'NDCG@10': '0.0543', 'HR@20': '0.1523', 'NDCG@20': '0.0661'}
2025-02-27 11:54:10,450 - EarlyStopping counter: 4 out of 10
2025-02-27 11:54:17,566 - {'epoch': 58, 'rec_loss': '5.2066'}
2025-02-27 11:54:18,332 - {'Epoch': 58, 'HR@5': '0.0642', 'NDCG@5': '0.0425', 'HR@10': '0.1018', 'NDCG@10': '0.0546', 'HR@20': '0.1431', 'NDCG@20': '0.0650'}
2025-02-27 11:54:18,333 - EarlyStopping counter: 5 out of 10
2025-02-27 11:54:25,539 - {'epoch': 59, 'rec_loss': '5.1861'}
2025-02-27 11:54:26,375 - {'Epoch': 59, 'HR@5': '0.0633', 'NDCG@5': '0.0417', 'HR@10': '0.1064', 'NDCG@10': '0.0557', 'HR@20': '0.1431', 'NDCG@20': '0.0649'}
2025-02-27 11:54:26,377 - EarlyStopping counter: 6 out of 10
2025-02-27 11:54:33,905 - {'epoch': 60, 'rec_loss': '5.1596'}
2025-02-27 11:54:34,731 - {'Epoch': 60, 'HR@5': '0.0651', 'NDCG@5': '0.0416', 'HR@10': '0.1073', 'NDCG@10': '0.0550', 'HR@20': '0.1468', 'NDCG@20': '0.0649'}
2025-02-27 11:54:34,732 - EarlyStopping counter: 7 out of 10
2025-02-27 11:54:42,268 - {'epoch': 61, 'rec_loss': '5.1612'}
2025-02-27 11:54:43,101 - {'Epoch': 61, 'HR@5': '0.0633', 'NDCG@5': '0.0427', 'HR@10': '0.1037', 'NDCG@10': '0.0557', 'HR@20': '0.1486', 'NDCG@20': '0.0671'}
2025-02-27 11:54:43,102 - EarlyStopping counter: 8 out of 10
2025-02-27 11:54:50,342 - {'epoch': 62, 'rec_loss': '5.1732'}
2025-02-27 11:54:51,157 - {'Epoch': 62, 'HR@5': '0.0651', 'NDCG@5': '0.0419', 'HR@10': '0.1037', 'NDCG@10': '0.0543', 'HR@20': '0.1523', 'NDCG@20': '0.0664'}
2025-02-27 11:54:51,158 - EarlyStopping counter: 9 out of 10
2025-02-27 11:54:58,478 - {'epoch': 63, 'rec_loss': '5.1674'}
2025-02-27 11:54:59,304 - {'Epoch': 63, 'HR@5': '0.0670', 'NDCG@5': '0.0422', 'HR@10': '0.1055', 'NDCG@10': '0.0546', 'HR@20': '0.1486', 'NDCG@20': '0.0654'}
2025-02-27 11:54:59,305 - EarlyStopping counter: 10 out of 10
2025-02-27 11:54:59,305 - Early stopping
2025-02-27 11:54:59,305 - ---------------Test Score---------------
2025-02-27 11:55:00,147 - {'Epoch': 0, 'HR@5': '0.0587', 'NDCG@5': '0.0389', 'HR@10': '0.0771', 'NDCG@10': '0.0446', 'HR@20': '0.1101', 'NDCG@20': '0.0528'}
2025-02-27 11:55:00,148 - Scale_LastFM
2025-02-27 11:55:00,148 - {'Epoch': 0, 'HR@5': '0.0587', 'NDCG@5': '0.0389', 'HR@10': '0.0771', 'NDCG@10': '0.0446', 'HR@20': '0.1101', 'NDCG@20': '0.0528'}
2025-02-27 11:57:34,244 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 4, 6, 8], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-27 11:57:40,640 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=4, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=4, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-27 11:57:40,648 - Total Parameters: 387354
2025-02-27 11:57:48,887 - {'epoch': 0, 'rec_loss': '8.0363'}
2025-02-27 11:57:49,694 - {'Epoch': 0, 'HR@5': '0.0229', 'NDCG@5': '0.0161', 'HR@10': '0.0349', 'NDCG@10': '0.0199', 'HR@20': '0.0560', 'NDCG@20': '0.0252'}
2025-02-27 11:57:49,696 - Validation score increased.  Saving model ...
2025-02-27 11:57:56,713 - {'epoch': 1, 'rec_loss': '7.7343'}
2025-02-27 11:57:57,491 - {'Epoch': 1, 'HR@5': '0.0193', 'NDCG@5': '0.0120', 'HR@10': '0.0358', 'NDCG@10': '0.0174', 'HR@20': '0.0523', 'NDCG@20': '0.0216'}
2025-02-27 11:57:57,492 - EarlyStopping counter: 1 out of 10
2025-02-27 11:58:04,907 - {'epoch': 2, 'rec_loss': '7.5207'}
2025-02-27 11:58:05,637 - {'Epoch': 2, 'HR@5': '0.0239', 'NDCG@5': '0.0179', 'HR@10': '0.0422', 'NDCG@10': '0.0238', 'HR@20': '0.0642', 'NDCG@20': '0.0294'}
2025-02-27 11:58:05,638 - Validation score increased.  Saving model ...
2025-02-27 11:58:12,816 - {'epoch': 3, 'rec_loss': '7.3046'}
2025-02-27 11:58:13,627 - {'Epoch': 3, 'HR@5': '0.0330', 'NDCG@5': '0.0214', 'HR@10': '0.0505', 'NDCG@10': '0.0269', 'HR@20': '0.0752', 'NDCG@20': '0.0331'}
2025-02-27 11:58:13,628 - Validation score increased.  Saving model ...
2025-02-27 11:58:21,107 - {'epoch': 4, 'rec_loss': '7.0911'}
2025-02-27 11:58:21,876 - {'Epoch': 4, 'HR@5': '0.0330', 'NDCG@5': '0.0234', 'HR@10': '0.0578', 'NDCG@10': '0.0313', 'HR@20': '0.0862', 'NDCG@20': '0.0385'}
2025-02-27 11:58:21,877 - Validation score increased.  Saving model ...
2025-02-27 11:58:28,749 - {'epoch': 5, 'rec_loss': '6.8898'}
2025-02-27 11:58:29,537 - {'Epoch': 5, 'HR@5': '0.0358', 'NDCG@5': '0.0244', 'HR@10': '0.0550', 'NDCG@10': '0.0308', 'HR@20': '0.0908', 'NDCG@20': '0.0397'}
2025-02-27 11:58:29,538 - Validation score increased.  Saving model ...
2025-02-27 11:58:36,600 - {'epoch': 6, 'rec_loss': '6.6924'}
2025-02-27 11:58:37,374 - {'Epoch': 6, 'HR@5': '0.0422', 'NDCG@5': '0.0268', 'HR@10': '0.0578', 'NDCG@10': '0.0317', 'HR@20': '0.0890', 'NDCG@20': '0.0398'}
2025-02-27 11:58:37,376 - Validation score increased.  Saving model ...
2025-02-27 11:58:44,758 - {'epoch': 7, 'rec_loss': '6.5230'}
2025-02-27 11:58:45,551 - {'Epoch': 7, 'HR@5': '0.0431', 'NDCG@5': '0.0280', 'HR@10': '0.0642', 'NDCG@10': '0.0348', 'HR@20': '0.0982', 'NDCG@20': '0.0432'}
2025-02-27 11:58:45,552 - Validation score increased.  Saving model ...
2025-02-27 11:58:53,076 - {'epoch': 8, 'rec_loss': '6.3537'}
2025-02-27 11:58:53,867 - {'Epoch': 8, 'HR@5': '0.0450', 'NDCG@5': '0.0287', 'HR@10': '0.0624', 'NDCG@10': '0.0342', 'HR@20': '0.1028', 'NDCG@20': '0.0445'}
2025-02-27 11:58:53,868 - Validation score increased.  Saving model ...
2025-02-27 11:59:01,511 - {'epoch': 9, 'rec_loss': '6.2366'}
2025-02-27 11:59:02,302 - {'Epoch': 9, 'HR@5': '0.0459', 'NDCG@5': '0.0297', 'HR@10': '0.0688', 'NDCG@10': '0.0370', 'HR@20': '0.1037', 'NDCG@20': '0.0457'}
2025-02-27 11:59:02,303 - Validation score increased.  Saving model ...
2025-02-27 11:59:09,361 - {'epoch': 10, 'rec_loss': '6.1001'}
2025-02-27 11:59:10,155 - {'Epoch': 10, 'HR@5': '0.0459', 'NDCG@5': '0.0322', 'HR@10': '0.0752', 'NDCG@10': '0.0414', 'HR@20': '0.1138', 'NDCG@20': '0.0510'}
2025-02-27 11:59:10,157 - Validation score increased.  Saving model ...
2025-02-27 11:59:17,418 - {'epoch': 11, 'rec_loss': '6.0322'}
2025-02-27 11:59:18,218 - {'Epoch': 11, 'HR@5': '0.0450', 'NDCG@5': '0.0305', 'HR@10': '0.0771', 'NDCG@10': '0.0407', 'HR@20': '0.1147', 'NDCG@20': '0.0502'}
2025-02-27 11:59:18,219 - EarlyStopping counter: 1 out of 10
2025-02-27 11:59:25,827 - {'epoch': 12, 'rec_loss': '5.9515'}
2025-02-27 11:59:26,553 - {'Epoch': 12, 'HR@5': '0.0505', 'NDCG@5': '0.0330', 'HR@10': '0.0780', 'NDCG@10': '0.0418', 'HR@20': '0.1220', 'NDCG@20': '0.0527'}
2025-02-27 11:59:26,554 - Validation score increased.  Saving model ...
2025-02-27 11:59:33,503 - {'epoch': 13, 'rec_loss': '5.8446'}
2025-02-27 11:59:34,292 - {'Epoch': 13, 'HR@5': '0.0560', 'NDCG@5': '0.0351', 'HR@10': '0.0752', 'NDCG@10': '0.0413', 'HR@20': '0.1183', 'NDCG@20': '0.0523'}
2025-02-27 11:59:34,293 - EarlyStopping counter: 1 out of 10
2025-02-27 11:59:41,196 - {'epoch': 14, 'rec_loss': '5.8123'}
2025-02-27 11:59:41,963 - {'Epoch': 14, 'HR@5': '0.0541', 'NDCG@5': '0.0348', 'HR@10': '0.0771', 'NDCG@10': '0.0421', 'HR@20': '0.1202', 'NDCG@20': '0.0530'}
2025-02-27 11:59:41,964 - Validation score increased.  Saving model ...
2025-02-27 11:59:49,255 - {'epoch': 15, 'rec_loss': '5.7435'}
2025-02-27 11:59:50,002 - {'Epoch': 15, 'HR@5': '0.0550', 'NDCG@5': '0.0356', 'HR@10': '0.0798', 'NDCG@10': '0.0434', 'HR@20': '0.1248', 'NDCG@20': '0.0547'}
2025-02-27 11:59:50,004 - Validation score increased.  Saving model ...
2025-02-27 11:59:56,914 - {'epoch': 16, 'rec_loss': '5.7143'}
2025-02-27 11:59:57,613 - {'Epoch': 16, 'HR@5': '0.0541', 'NDCG@5': '0.0351', 'HR@10': '0.0835', 'NDCG@10': '0.0446', 'HR@20': '0.1294', 'NDCG@20': '0.0561'}
2025-02-27 11:59:57,614 - Validation score increased.  Saving model ...
2025-02-27 12:00:05,356 - {'epoch': 17, 'rec_loss': '5.6651'}
2025-02-27 12:00:06,101 - {'Epoch': 17, 'HR@5': '0.0541', 'NDCG@5': '0.0351', 'HR@10': '0.0826', 'NDCG@10': '0.0444', 'HR@20': '0.1294', 'NDCG@20': '0.0561'}
2025-02-27 12:00:06,103 - EarlyStopping counter: 1 out of 10
2025-02-27 12:00:13,350 - {'epoch': 18, 'rec_loss': '5.6153'}
2025-02-27 12:00:14,142 - {'Epoch': 18, 'HR@5': '0.0532', 'NDCG@5': '0.0349', 'HR@10': '0.0890', 'NDCG@10': '0.0465', 'HR@20': '0.1339', 'NDCG@20': '0.0579'}
2025-02-27 12:00:14,143 - Validation score increased.  Saving model ...
2025-02-27 12:00:21,770 - {'epoch': 19, 'rec_loss': '5.6086'}
2025-02-27 12:00:22,677 - {'Epoch': 19, 'HR@5': '0.0606', 'NDCG@5': '0.0395', 'HR@10': '0.0927', 'NDCG@10': '0.0500', 'HR@20': '0.1358', 'NDCG@20': '0.0608'}
2025-02-27 12:00:22,678 - Validation score increased.  Saving model ...
2025-02-27 12:00:29,955 - {'epoch': 20, 'rec_loss': '5.5730'}
2025-02-27 12:00:30,761 - {'Epoch': 20, 'HR@5': '0.0514', 'NDCG@5': '0.0347', 'HR@10': '0.0908', 'NDCG@10': '0.0471', 'HR@20': '0.1349', 'NDCG@20': '0.0582'}
2025-02-27 12:00:30,762 - EarlyStopping counter: 1 out of 10
2025-02-27 12:00:37,945 - {'epoch': 21, 'rec_loss': '5.5223'}
2025-02-27 12:00:38,686 - {'Epoch': 21, 'HR@5': '0.0578', 'NDCG@5': '0.0384', 'HR@10': '0.0927', 'NDCG@10': '0.0496', 'HR@20': '0.1468', 'NDCG@20': '0.0632'}
2025-02-27 12:00:38,687 - Validation score increased.  Saving model ...
2025-02-27 12:00:46,102 - {'epoch': 22, 'rec_loss': '5.5198'}
2025-02-27 12:00:46,896 - {'Epoch': 22, 'HR@5': '0.0550', 'NDCG@5': '0.0370', 'HR@10': '0.0872', 'NDCG@10': '0.0474', 'HR@20': '0.1367', 'NDCG@20': '0.0599'}
2025-02-27 12:00:46,898 - EarlyStopping counter: 1 out of 10
2025-02-27 12:00:54,472 - {'epoch': 23, 'rec_loss': '5.5154'}
2025-02-27 12:00:55,305 - {'Epoch': 23, 'HR@5': '0.0560', 'NDCG@5': '0.0363', 'HR@10': '0.0890', 'NDCG@10': '0.0468', 'HR@20': '0.1367', 'NDCG@20': '0.0588'}
2025-02-27 12:00:55,307 - EarlyStopping counter: 2 out of 10
2025-02-27 12:01:02,475 - {'epoch': 24, 'rec_loss': '5.4816'}
2025-02-27 12:01:03,255 - {'Epoch': 24, 'HR@5': '0.0578', 'NDCG@5': '0.0370', 'HR@10': '0.0908', 'NDCG@10': '0.0477', 'HR@20': '0.1394', 'NDCG@20': '0.0600'}
2025-02-27 12:01:03,257 - EarlyStopping counter: 3 out of 10
2025-02-27 12:01:10,175 - {'epoch': 25, 'rec_loss': '5.4614'}
2025-02-27 12:01:10,941 - {'Epoch': 25, 'HR@5': '0.0550', 'NDCG@5': '0.0351', 'HR@10': '0.0881', 'NDCG@10': '0.0458', 'HR@20': '0.1358', 'NDCG@20': '0.0578'}
2025-02-27 12:01:10,942 - EarlyStopping counter: 4 out of 10
2025-02-27 12:01:18,190 - {'epoch': 26, 'rec_loss': '5.4620'}
2025-02-27 12:01:18,866 - {'Epoch': 26, 'HR@5': '0.0560', 'NDCG@5': '0.0362', 'HR@10': '0.0862', 'NDCG@10': '0.0458', 'HR@20': '0.1404', 'NDCG@20': '0.0596'}
2025-02-27 12:01:18,867 - EarlyStopping counter: 5 out of 10
2025-02-27 12:01:25,957 - {'epoch': 27, 'rec_loss': '5.4265'}
2025-02-27 12:01:26,735 - {'Epoch': 27, 'HR@5': '0.0569', 'NDCG@5': '0.0355', 'HR@10': '0.0972', 'NDCG@10': '0.0483', 'HR@20': '0.1431', 'NDCG@20': '0.0598'}
2025-02-27 12:01:26,736 - EarlyStopping counter: 6 out of 10
2025-02-27 12:01:33,930 - {'epoch': 28, 'rec_loss': '5.4175'}
2025-02-27 12:01:34,722 - {'Epoch': 28, 'HR@5': '0.0633', 'NDCG@5': '0.0408', 'HR@10': '0.0927', 'NDCG@10': '0.0502', 'HR@20': '0.1459', 'NDCG@20': '0.0634'}
2025-02-27 12:01:34,723 - Validation score increased.  Saving model ...
2025-02-27 12:01:42,637 - {'epoch': 29, 'rec_loss': '5.4021'}
2025-02-27 12:01:43,407 - {'Epoch': 29, 'HR@5': '0.0560', 'NDCG@5': '0.0364', 'HR@10': '0.0927', 'NDCG@10': '0.0482', 'HR@20': '0.1459', 'NDCG@20': '0.0615'}
2025-02-27 12:01:43,408 - EarlyStopping counter: 1 out of 10
2025-02-27 12:01:51,072 - {'epoch': 30, 'rec_loss': '5.3932'}
2025-02-27 12:01:51,835 - {'Epoch': 30, 'HR@5': '0.0578', 'NDCG@5': '0.0380', 'HR@10': '0.0917', 'NDCG@10': '0.0488', 'HR@20': '0.1422', 'NDCG@20': '0.0615'}
2025-02-27 12:01:51,836 - EarlyStopping counter: 2 out of 10
2025-02-27 12:01:58,969 - {'epoch': 31, 'rec_loss': '5.3919'}
2025-02-27 12:01:59,769 - {'Epoch': 31, 'HR@5': '0.0569', 'NDCG@5': '0.0360', 'HR@10': '0.0982', 'NDCG@10': '0.0494', 'HR@20': '0.1495', 'NDCG@20': '0.0622'}
2025-02-27 12:01:59,770 - EarlyStopping counter: 3 out of 10
2025-02-27 12:02:06,811 - {'epoch': 32, 'rec_loss': '5.3709'}
2025-02-27 12:02:07,650 - {'Epoch': 32, 'HR@5': '0.0541', 'NDCG@5': '0.0355', 'HR@10': '0.0945', 'NDCG@10': '0.0487', 'HR@20': '0.1468', 'NDCG@20': '0.0618'}
2025-02-27 12:02:07,651 - EarlyStopping counter: 4 out of 10
2025-02-27 12:02:14,793 - {'epoch': 33, 'rec_loss': '5.3498'}
2025-02-27 12:02:15,545 - {'Epoch': 33, 'HR@5': '0.0596', 'NDCG@5': '0.0374', 'HR@10': '0.0972', 'NDCG@10': '0.0495', 'HR@20': '0.1495', 'NDCG@20': '0.0626'}
2025-02-27 12:02:15,547 - EarlyStopping counter: 5 out of 10
2025-02-27 12:02:22,695 - {'epoch': 34, 'rec_loss': '5.3566'}
2025-02-27 12:02:23,475 - {'Epoch': 34, 'HR@5': '0.0587', 'NDCG@5': '0.0375', 'HR@10': '0.0908', 'NDCG@10': '0.0480', 'HR@20': '0.1431', 'NDCG@20': '0.0613'}
2025-02-27 12:02:23,476 - EarlyStopping counter: 6 out of 10
2025-02-27 12:02:30,612 - {'epoch': 35, 'rec_loss': '5.3257'}
2025-02-27 12:02:31,373 - {'Epoch': 35, 'HR@5': '0.0560', 'NDCG@5': '0.0364', 'HR@10': '0.0936', 'NDCG@10': '0.0482', 'HR@20': '0.1404', 'NDCG@20': '0.0600'}
2025-02-27 12:02:31,375 - EarlyStopping counter: 7 out of 10
2025-02-27 12:02:38,667 - {'epoch': 36, 'rec_loss': '5.3228'}
2025-02-27 12:02:39,446 - {'Epoch': 36, 'HR@5': '0.0615', 'NDCG@5': '0.0380', 'HR@10': '0.0972', 'NDCG@10': '0.0493', 'HR@20': '0.1404', 'NDCG@20': '0.0601'}
2025-02-27 12:02:39,447 - EarlyStopping counter: 8 out of 10
2025-02-27 12:02:47,129 - {'epoch': 37, 'rec_loss': '5.3097'}
2025-02-27 12:02:47,905 - {'Epoch': 37, 'HR@5': '0.0569', 'NDCG@5': '0.0371', 'HR@10': '0.0908', 'NDCG@10': '0.0480', 'HR@20': '0.1450', 'NDCG@20': '0.0617'}
2025-02-27 12:02:47,906 - EarlyStopping counter: 9 out of 10
2025-02-27 12:02:55,437 - {'epoch': 38, 'rec_loss': '5.3016'}
2025-02-27 12:02:56,274 - {'Epoch': 38, 'HR@5': '0.0523', 'NDCG@5': '0.0343', 'HR@10': '0.0908', 'NDCG@10': '0.0468', 'HR@20': '0.1477', 'NDCG@20': '0.0611'}
2025-02-27 12:02:56,275 - EarlyStopping counter: 10 out of 10
2025-02-27 12:02:56,275 - Early stopping
2025-02-27 12:02:56,275 - ---------------Test Score---------------
2025-02-27 12:02:57,243 - {'Epoch': 0, 'HR@5': '0.0560', 'NDCG@5': '0.0372', 'HR@10': '0.0771', 'NDCG@10': '0.0440', 'HR@20': '0.1046', 'NDCG@20': '0.0508'}
2025-02-27 12:02:57,244 - Scale_LastFM
2025-02-27 12:02:57,244 - {'Epoch': 0, 'HR@5': '0.0560', 'NDCG@5': '0.0372', 'HR@10': '0.0771', 'NDCG@10': '0.0440', 'HR@20': '0.1046', 'NDCG@20': '0.0508'}
2025-02-27 12:03:19,984 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 4, 6, 8], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-27 12:03:26,041 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=4, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=4, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-27 12:03:26,049 - Total Parameters: 387354
2025-02-27 12:03:34,787 - {'epoch': 0, 'rec_loss': '8.0363'}
2025-02-27 12:03:35,564 - {'Epoch': 0, 'HR@5': '0.0229', 'NDCG@5': '0.0161', 'HR@10': '0.0349', 'NDCG@10': '0.0199', 'HR@20': '0.0560', 'NDCG@20': '0.0252'}
2025-02-27 12:03:35,565 - Validation score increased.  Saving model ...
2025-02-27 12:03:42,690 - {'epoch': 1, 'rec_loss': '7.7343'}
2025-02-27 12:03:43,534 - {'Epoch': 1, 'HR@5': '0.0193', 'NDCG@5': '0.0120', 'HR@10': '0.0358', 'NDCG@10': '0.0174', 'HR@20': '0.0523', 'NDCG@20': '0.0216'}
2025-02-27 12:03:43,535 - EarlyStopping counter: 1 out of 10
2025-02-27 12:03:51,127 - {'epoch': 2, 'rec_loss': '7.5207'}
2025-02-27 12:03:52,007 - {'Epoch': 2, 'HR@5': '0.0239', 'NDCG@5': '0.0179', 'HR@10': '0.0422', 'NDCG@10': '0.0238', 'HR@20': '0.0642', 'NDCG@20': '0.0294'}
2025-02-27 12:03:52,008 - Validation score increased.  Saving model ...
2025-02-27 12:03:59,382 - {'epoch': 3, 'rec_loss': '7.3046'}
2025-02-27 12:04:00,236 - {'Epoch': 3, 'HR@5': '0.0330', 'NDCG@5': '0.0214', 'HR@10': '0.0505', 'NDCG@10': '0.0269', 'HR@20': '0.0752', 'NDCG@20': '0.0331'}
2025-02-27 12:04:00,238 - Validation score increased.  Saving model ...
2025-02-27 12:04:07,515 - {'epoch': 4, 'rec_loss': '7.0911'}
2025-02-27 12:04:08,232 - {'Epoch': 4, 'HR@5': '0.0330', 'NDCG@5': '0.0234', 'HR@10': '0.0578', 'NDCG@10': '0.0313', 'HR@20': '0.0862', 'NDCG@20': '0.0385'}
2025-02-27 12:04:08,233 - Validation score increased.  Saving model ...
2025-02-27 12:04:15,781 - {'epoch': 5, 'rec_loss': '6.8898'}
2025-02-27 12:04:16,655 - {'Epoch': 5, 'HR@5': '0.0358', 'NDCG@5': '0.0244', 'HR@10': '0.0550', 'NDCG@10': '0.0308', 'HR@20': '0.0908', 'NDCG@20': '0.0397'}
2025-02-27 12:04:16,656 - Validation score increased.  Saving model ...
2025-02-27 12:04:23,934 - {'epoch': 6, 'rec_loss': '6.6924'}
2025-02-27 12:04:24,802 - {'Epoch': 6, 'HR@5': '0.0422', 'NDCG@5': '0.0268', 'HR@10': '0.0578', 'NDCG@10': '0.0317', 'HR@20': '0.0890', 'NDCG@20': '0.0398'}
2025-02-27 12:04:24,803 - Validation score increased.  Saving model ...
2025-02-27 12:04:32,552 - {'epoch': 7, 'rec_loss': '6.5230'}
2025-02-27 12:04:33,462 - {'Epoch': 7, 'HR@5': '0.0431', 'NDCG@5': '0.0280', 'HR@10': '0.0642', 'NDCG@10': '0.0348', 'HR@20': '0.0982', 'NDCG@20': '0.0432'}
2025-02-27 12:04:33,464 - Validation score increased.  Saving model ...
2025-02-27 12:04:41,140 - {'epoch': 8, 'rec_loss': '6.3537'}
2025-02-27 12:04:41,992 - {'Epoch': 8, 'HR@5': '0.0450', 'NDCG@5': '0.0287', 'HR@10': '0.0624', 'NDCG@10': '0.0342', 'HR@20': '0.1028', 'NDCG@20': '0.0445'}
2025-02-27 12:04:41,993 - Validation score increased.  Saving model ...
2025-02-27 12:04:49,044 - {'epoch': 9, 'rec_loss': '6.2366'}
2025-02-27 12:04:49,828 - {'Epoch': 9, 'HR@5': '0.0459', 'NDCG@5': '0.0297', 'HR@10': '0.0688', 'NDCG@10': '0.0370', 'HR@20': '0.1037', 'NDCG@20': '0.0457'}
2025-02-27 12:04:49,830 - Validation score increased.  Saving model ...
2025-02-27 12:05:41,691 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 4, 6, 8], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-27 12:05:48,528 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=4, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=4, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-27 12:05:48,578 - Total Parameters: 387354
2025-02-27 12:05:57,775 - {'epoch': 0, 'rec_loss': '8.0363'}
2025-02-27 12:05:58,624 - {'Epoch': 0, 'HR@5': '0.0229', 'NDCG@5': '0.0161', 'HR@10': '0.0349', 'NDCG@10': '0.0199', 'HR@20': '0.0560', 'NDCG@20': '0.0252'}
2025-02-27 12:05:58,625 - Validation score increased.  Saving model ...
2025-02-27 12:06:06,211 - {'epoch': 1, 'rec_loss': '7.7343'}
2025-02-27 12:06:06,964 - {'Epoch': 1, 'HR@5': '0.0193', 'NDCG@5': '0.0120', 'HR@10': '0.0358', 'NDCG@10': '0.0174', 'HR@20': '0.0523', 'NDCG@20': '0.0216'}
2025-02-27 12:06:06,966 - EarlyStopping counter: 1 out of 10
2025-02-27 12:06:14,027 - {'epoch': 2, 'rec_loss': '7.5207'}
2025-02-27 12:06:14,771 - {'Epoch': 2, 'HR@5': '0.0239', 'NDCG@5': '0.0179', 'HR@10': '0.0422', 'NDCG@10': '0.0238', 'HR@20': '0.0642', 'NDCG@20': '0.0294'}
2025-02-27 12:06:14,772 - Validation score increased.  Saving model ...
2025-02-27 12:06:21,858 - {'epoch': 3, 'rec_loss': '7.3046'}
2025-02-27 12:06:22,577 - {'Epoch': 3, 'HR@5': '0.0330', 'NDCG@5': '0.0214', 'HR@10': '0.0505', 'NDCG@10': '0.0269', 'HR@20': '0.0752', 'NDCG@20': '0.0331'}
2025-02-27 12:06:22,579 - Validation score increased.  Saving model ...
2025-02-27 12:06:29,718 - {'epoch': 4, 'rec_loss': '7.0911'}
2025-02-27 12:06:30,468 - {'Epoch': 4, 'HR@5': '0.0330', 'NDCG@5': '0.0234', 'HR@10': '0.0578', 'NDCG@10': '0.0313', 'HR@20': '0.0862', 'NDCG@20': '0.0385'}
2025-02-27 12:06:30,469 - Validation score increased.  Saving model ...
2025-02-27 12:06:37,760 - {'epoch': 5, 'rec_loss': '6.8898'}
2025-02-27 12:06:38,574 - {'Epoch': 5, 'HR@5': '0.0358', 'NDCG@5': '0.0244', 'HR@10': '0.0550', 'NDCG@10': '0.0308', 'HR@20': '0.0908', 'NDCG@20': '0.0397'}
2025-02-27 12:06:38,575 - Validation score increased.  Saving model ...
2025-02-27 12:06:45,636 - {'epoch': 6, 'rec_loss': '6.6924'}
2025-02-27 12:06:46,395 - {'Epoch': 6, 'HR@5': '0.0422', 'NDCG@5': '0.0268', 'HR@10': '0.0578', 'NDCG@10': '0.0317', 'HR@20': '0.0890', 'NDCG@20': '0.0398'}
2025-02-27 12:06:46,396 - Validation score increased.  Saving model ...
2025-02-27 12:06:54,089 - {'epoch': 7, 'rec_loss': '6.5230'}
2025-02-27 12:06:54,916 - {'Epoch': 7, 'HR@5': '0.0431', 'NDCG@5': '0.0280', 'HR@10': '0.0642', 'NDCG@10': '0.0348', 'HR@20': '0.0982', 'NDCG@20': '0.0432'}
2025-02-27 12:06:54,917 - Validation score increased.  Saving model ...
2025-02-27 12:07:02,270 - {'epoch': 8, 'rec_loss': '6.3537'}
2025-02-27 12:07:03,024 - {'Epoch': 8, 'HR@5': '0.0450', 'NDCG@5': '0.0287', 'HR@10': '0.0624', 'NDCG@10': '0.0342', 'HR@20': '0.1028', 'NDCG@20': '0.0445'}
2025-02-27 12:07:03,025 - Validation score increased.  Saving model ...
2025-02-27 12:07:10,147 - {'epoch': 9, 'rec_loss': '6.2366'}
2025-02-27 12:07:10,893 - {'Epoch': 9, 'HR@5': '0.0459', 'NDCG@5': '0.0297', 'HR@10': '0.0688', 'NDCG@10': '0.0370', 'HR@20': '0.1037', 'NDCG@20': '0.0457'}
2025-02-27 12:07:10,894 - Validation score increased.  Saving model ...
2025-02-27 12:07:18,351 - {'epoch': 10, 'rec_loss': '6.1001'}
2025-02-27 12:07:19,138 - {'Epoch': 10, 'HR@5': '0.0459', 'NDCG@5': '0.0322', 'HR@10': '0.0752', 'NDCG@10': '0.0414', 'HR@20': '0.1138', 'NDCG@20': '0.0510'}
2025-02-27 12:07:19,139 - Validation score increased.  Saving model ...
2025-02-27 12:07:26,483 - {'epoch': 11, 'rec_loss': '6.0322'}
2025-02-27 12:07:27,273 - {'Epoch': 11, 'HR@5': '0.0450', 'NDCG@5': '0.0305', 'HR@10': '0.0771', 'NDCG@10': '0.0407', 'HR@20': '0.1147', 'NDCG@20': '0.0502'}
2025-02-27 12:07:27,274 - EarlyStopping counter: 1 out of 10
2025-02-27 12:07:34,690 - {'epoch': 12, 'rec_loss': '5.9515'}
2025-02-27 12:07:35,472 - {'Epoch': 12, 'HR@5': '0.0505', 'NDCG@5': '0.0330', 'HR@10': '0.0780', 'NDCG@10': '0.0418', 'HR@20': '0.1220', 'NDCG@20': '0.0527'}
2025-02-27 12:07:35,473 - Validation score increased.  Saving model ...
2025-02-27 12:07:42,714 - {'epoch': 13, 'rec_loss': '5.8446'}
2025-02-27 12:07:43,413 - {'Epoch': 13, 'HR@5': '0.0560', 'NDCG@5': '0.0351', 'HR@10': '0.0752', 'NDCG@10': '0.0413', 'HR@20': '0.1183', 'NDCG@20': '0.0523'}
2025-02-27 12:07:43,414 - EarlyStopping counter: 1 out of 10
2025-02-27 12:07:50,678 - {'epoch': 14, 'rec_loss': '5.8123'}
2025-02-27 12:07:51,433 - {'Epoch': 14, 'HR@5': '0.0541', 'NDCG@5': '0.0348', 'HR@10': '0.0771', 'NDCG@10': '0.0421', 'HR@20': '0.1202', 'NDCG@20': '0.0530'}
2025-02-27 12:07:51,434 - Validation score increased.  Saving model ...
2025-02-27 12:07:58,630 - {'epoch': 15, 'rec_loss': '5.7435'}
2025-02-27 12:07:59,393 - {'Epoch': 15, 'HR@5': '0.0550', 'NDCG@5': '0.0356', 'HR@10': '0.0798', 'NDCG@10': '0.0434', 'HR@20': '0.1248', 'NDCG@20': '0.0547'}
2025-02-27 12:07:59,394 - Validation score increased.  Saving model ...
2025-02-27 12:08:06,596 - {'epoch': 16, 'rec_loss': '5.7143'}
2025-02-27 12:08:07,349 - {'Epoch': 16, 'HR@5': '0.0541', 'NDCG@5': '0.0351', 'HR@10': '0.0835', 'NDCG@10': '0.0446', 'HR@20': '0.1294', 'NDCG@20': '0.0561'}
2025-02-27 12:08:07,350 - Validation score increased.  Saving model ...
2025-02-27 12:08:14,362 - {'epoch': 17, 'rec_loss': '5.6651'}
2025-02-27 12:08:15,140 - {'Epoch': 17, 'HR@5': '0.0541', 'NDCG@5': '0.0351', 'HR@10': '0.0826', 'NDCG@10': '0.0444', 'HR@20': '0.1294', 'NDCG@20': '0.0561'}
2025-02-27 12:08:15,141 - EarlyStopping counter: 1 out of 10
2025-02-27 12:08:22,457 - {'epoch': 18, 'rec_loss': '5.6153'}
2025-02-27 12:08:23,122 - {'Epoch': 18, 'HR@5': '0.0532', 'NDCG@5': '0.0349', 'HR@10': '0.0890', 'NDCG@10': '0.0465', 'HR@20': '0.1339', 'NDCG@20': '0.0579'}
2025-02-27 12:08:23,123 - Validation score increased.  Saving model ...
2025-02-27 12:08:25,197 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 4, 6, 8], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-27 12:08:28,940 - {'epoch': 19, 'rec_loss': '5.6086'}
2025-02-27 12:08:29,369 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=4, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=4, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-27 12:08:29,376 - Total Parameters: 387354
2025-02-27 12:08:29,623 - {'Epoch': 19, 'HR@5': '0.0606', 'NDCG@5': '0.0395', 'HR@10': '0.0927', 'NDCG@10': '0.0500', 'HR@20': '0.1358', 'NDCG@20': '0.0608'}
2025-02-27 12:08:29,624 - Validation score increased.  Saving model ...
2025-02-27 12:08:35,074 - {'epoch': 20, 'rec_loss': '5.5730'}
2025-02-27 12:08:35,912 - {'Epoch': 20, 'HR@5': '0.0514', 'NDCG@5': '0.0347', 'HR@10': '0.0908', 'NDCG@10': '0.0471', 'HR@20': '0.1349', 'NDCG@20': '0.0582'}
2025-02-27 12:08:35,914 - EarlyStopping counter: 1 out of 10
2025-02-27 12:08:36,172 - {'epoch': 0, 'rec_loss': '8.0363'}
2025-02-27 12:08:36,934 - {'Epoch': 0, 'HR@5': '0.0229', 'NDCG@5': '0.0161', 'HR@10': '0.0349', 'NDCG@10': '0.0199', 'HR@20': '0.0560', 'NDCG@20': '0.0252'}
2025-02-27 12:08:36,935 - Validation score increased.  Saving model ...
2025-02-27 12:08:41,256 - {'epoch': 21, 'rec_loss': '5.5223'}
2025-02-27 12:08:42,123 - {'Epoch': 21, 'HR@5': '0.0578', 'NDCG@5': '0.0384', 'HR@10': '0.0927', 'NDCG@10': '0.0496', 'HR@20': '0.1468', 'NDCG@20': '0.0632'}
2025-02-27 12:08:42,125 - Validation score increased.  Saving model ...
2025-02-27 12:08:42,595 - {'epoch': 1, 'rec_loss': '7.7343'}
2025-02-27 12:08:43,479 - {'Epoch': 1, 'HR@5': '0.0193', 'NDCG@5': '0.0120', 'HR@10': '0.0358', 'NDCG@10': '0.0174', 'HR@20': '0.0523', 'NDCG@20': '0.0216'}
2025-02-27 12:08:43,480 - EarlyStopping counter: 1 out of 10
2025-02-27 12:08:48,814 - {'epoch': 22, 'rec_loss': '5.5198'}
2025-02-27 12:08:48,830 - {'epoch': 2, 'rec_loss': '7.5207'}
2025-02-27 12:08:49,584 - {'Epoch': 22, 'HR@5': '0.0550', 'NDCG@5': '0.0370', 'HR@10': '0.0872', 'NDCG@10': '0.0474', 'HR@20': '0.1367', 'NDCG@20': '0.0599'}
2025-02-27 12:08:49,585 - EarlyStopping counter: 1 out of 10
2025-02-27 12:08:49,587 - {'Epoch': 2, 'HR@5': '0.0239', 'NDCG@5': '0.0179', 'HR@10': '0.0422', 'NDCG@10': '0.0238', 'HR@20': '0.0642', 'NDCG@20': '0.0294'}
2025-02-27 12:08:49,588 - Validation score increased.  Saving model ...
2025-02-27 12:08:56,291 - {'epoch': 23, 'rec_loss': '5.5154'}
2025-02-27 12:08:56,454 - {'epoch': 3, 'rec_loss': '7.3046'}
2025-02-27 12:08:57,153 - {'Epoch': 23, 'HR@5': '0.0560', 'NDCG@5': '0.0363', 'HR@10': '0.0890', 'NDCG@10': '0.0468', 'HR@20': '0.1367', 'NDCG@20': '0.0588'}
2025-02-27 12:08:57,154 - EarlyStopping counter: 2 out of 10
2025-02-27 12:08:57,190 - {'Epoch': 3, 'HR@5': '0.0330', 'NDCG@5': '0.0214', 'HR@10': '0.0505', 'NDCG@10': '0.0269', 'HR@20': '0.0752', 'NDCG@20': '0.0331'}
2025-02-27 12:08:57,191 - Validation score increased.  Saving model ...
2025-02-27 12:09:02,752 - {'epoch': 4, 'rec_loss': '7.0911'}
2025-02-27 12:09:02,868 - {'epoch': 24, 'rec_loss': '5.4816'}
2025-02-27 12:09:03,585 - {'Epoch': 4, 'HR@5': '0.0330', 'NDCG@5': '0.0234', 'HR@10': '0.0578', 'NDCG@10': '0.0313', 'HR@20': '0.0862', 'NDCG@20': '0.0385'}
2025-02-27 12:09:03,587 - Validation score increased.  Saving model ...
2025-02-27 12:09:03,649 - {'Epoch': 24, 'HR@5': '0.0578', 'NDCG@5': '0.0370', 'HR@10': '0.0908', 'NDCG@10': '0.0477', 'HR@20': '0.1394', 'NDCG@20': '0.0600'}
2025-02-27 12:09:03,650 - EarlyStopping counter: 3 out of 10
2025-02-27 12:09:09,114 - {'epoch': 25, 'rec_loss': '5.4614'}
2025-02-27 12:09:09,950 - {'Epoch': 25, 'HR@5': '0.0550', 'NDCG@5': '0.0351', 'HR@10': '0.0881', 'NDCG@10': '0.0458', 'HR@20': '0.1358', 'NDCG@20': '0.0578'}
2025-02-27 12:09:09,951 - EarlyStopping counter: 4 out of 10
2025-02-27 12:09:10,464 - {'epoch': 5, 'rec_loss': '6.8898'}
2025-02-27 12:09:11,377 - {'Epoch': 5, 'HR@5': '0.0358', 'NDCG@5': '0.0244', 'HR@10': '0.0550', 'NDCG@10': '0.0308', 'HR@20': '0.0908', 'NDCG@20': '0.0397'}
2025-02-27 12:09:11,378 - Validation score increased.  Saving model ...
2025-02-27 12:09:15,876 - {'epoch': 26, 'rec_loss': '5.4620'}
2025-02-27 12:09:16,737 - {'Epoch': 26, 'HR@5': '0.0560', 'NDCG@5': '0.0362', 'HR@10': '0.0862', 'NDCG@10': '0.0458', 'HR@20': '0.1404', 'NDCG@20': '0.0596'}
2025-02-27 12:09:16,738 - EarlyStopping counter: 5 out of 10
2025-02-27 12:09:17,372 - {'epoch': 6, 'rec_loss': '6.6924'}
2025-02-27 12:09:18,281 - {'Epoch': 6, 'HR@5': '0.0422', 'NDCG@5': '0.0268', 'HR@10': '0.0578', 'NDCG@10': '0.0317', 'HR@20': '0.0890', 'NDCG@20': '0.0398'}
2025-02-27 12:09:18,282 - Validation score increased.  Saving model ...
2025-02-27 12:09:22,367 - {'epoch': 27, 'rec_loss': '5.4265'}
2025-02-27 12:09:23,176 - {'Epoch': 27, 'HR@5': '0.0569', 'NDCG@5': '0.0355', 'HR@10': '0.0972', 'NDCG@10': '0.0483', 'HR@20': '0.1431', 'NDCG@20': '0.0598'}
2025-02-27 12:09:23,177 - EarlyStopping counter: 6 out of 10
2025-02-27 12:09:24,467 - {'epoch': 7, 'rec_loss': '6.5230'}
2025-02-27 12:09:25,372 - {'Epoch': 7, 'HR@5': '0.0431', 'NDCG@5': '0.0280', 'HR@10': '0.0642', 'NDCG@10': '0.0348', 'HR@20': '0.0982', 'NDCG@20': '0.0432'}
2025-02-27 12:09:25,373 - Validation score increased.  Saving model ...
2025-02-27 12:09:28,988 - {'epoch': 28, 'rec_loss': '5.4175'}
2025-02-27 12:09:29,785 - {'Epoch': 28, 'HR@5': '0.0633', 'NDCG@5': '0.0408', 'HR@10': '0.0927', 'NDCG@10': '0.0502', 'HR@20': '0.1459', 'NDCG@20': '0.0634'}
2025-02-27 12:09:29,787 - Validation score increased.  Saving model ...
2025-02-27 12:09:31,143 - {'epoch': 8, 'rec_loss': '6.3537'}
2025-02-27 12:09:32,031 - {'Epoch': 8, 'HR@5': '0.0450', 'NDCG@5': '0.0287', 'HR@10': '0.0624', 'NDCG@10': '0.0342', 'HR@20': '0.1028', 'NDCG@20': '0.0445'}
2025-02-27 12:09:32,032 - Validation score increased.  Saving model ...
2025-02-27 12:09:37,306 - {'epoch': 9, 'rec_loss': '6.2366'}
2025-02-27 12:09:37,944 - {'Epoch': 9, 'HR@5': '0.0459', 'NDCG@5': '0.0297', 'HR@10': '0.0688', 'NDCG@10': '0.0370', 'HR@20': '0.1037', 'NDCG@20': '0.0457'}
2025-02-27 12:09:37,945 - Validation score increased.  Saving model ...
2025-02-27 12:09:42,864 - {'epoch': 10, 'rec_loss': '6.1001'}
2025-02-27 12:09:43,539 - {'Epoch': 10, 'HR@5': '0.0459', 'NDCG@5': '0.0322', 'HR@10': '0.0752', 'NDCG@10': '0.0414', 'HR@20': '0.1138', 'NDCG@20': '0.0510'}
2025-02-27 12:09:43,540 - Validation score increased.  Saving model ...
2025-02-27 12:09:48,454 - {'epoch': 11, 'rec_loss': '6.0322'}
2025-02-27 12:09:49,161 - {'Epoch': 11, 'HR@5': '0.0450', 'NDCG@5': '0.0305', 'HR@10': '0.0771', 'NDCG@10': '0.0407', 'HR@20': '0.1147', 'NDCG@20': '0.0502'}
2025-02-27 12:09:49,162 - EarlyStopping counter: 1 out of 10
2025-02-27 12:09:54,026 - {'epoch': 12, 'rec_loss': '5.9515'}
2025-02-27 12:09:54,704 - {'Epoch': 12, 'HR@5': '0.0505', 'NDCG@5': '0.0330', 'HR@10': '0.0780', 'NDCG@10': '0.0418', 'HR@20': '0.1220', 'NDCG@20': '0.0527'}
2025-02-27 12:09:54,705 - Validation score increased.  Saving model ...
2025-02-27 12:09:59,660 - {'epoch': 13, 'rec_loss': '5.8446'}
2025-02-27 12:10:00,324 - {'Epoch': 13, 'HR@5': '0.0560', 'NDCG@5': '0.0351', 'HR@10': '0.0752', 'NDCG@10': '0.0413', 'HR@20': '0.1183', 'NDCG@20': '0.0523'}
2025-02-27 12:10:00,325 - EarlyStopping counter: 1 out of 10
2025-02-27 12:10:05,513 - {'epoch': 14, 'rec_loss': '5.8123'}
2025-02-27 12:10:06,242 - {'Epoch': 14, 'HR@5': '0.0541', 'NDCG@5': '0.0348', 'HR@10': '0.0771', 'NDCG@10': '0.0421', 'HR@20': '0.1202', 'NDCG@20': '0.0530'}
2025-02-27 12:10:06,243 - Validation score increased.  Saving model ...
2025-02-27 12:10:11,482 - {'epoch': 15, 'rec_loss': '5.7435'}
2025-02-27 12:10:12,244 - {'Epoch': 15, 'HR@5': '0.0550', 'NDCG@5': '0.0356', 'HR@10': '0.0798', 'NDCG@10': '0.0434', 'HR@20': '0.1248', 'NDCG@20': '0.0547'}
2025-02-27 12:10:12,246 - Validation score increased.  Saving model ...
2025-02-27 12:10:17,616 - {'epoch': 16, 'rec_loss': '5.7143'}
2025-02-27 12:10:18,247 - {'Epoch': 16, 'HR@5': '0.0541', 'NDCG@5': '0.0351', 'HR@10': '0.0835', 'NDCG@10': '0.0446', 'HR@20': '0.1294', 'NDCG@20': '0.0561'}
2025-02-27 12:10:18,248 - Validation score increased.  Saving model ...
2025-02-27 12:10:23,216 - {'epoch': 17, 'rec_loss': '5.6651'}
2025-02-27 12:10:23,943 - {'Epoch': 17, 'HR@5': '0.0541', 'NDCG@5': '0.0351', 'HR@10': '0.0826', 'NDCG@10': '0.0444', 'HR@20': '0.1294', 'NDCG@20': '0.0561'}
2025-02-27 12:10:23,944 - EarlyStopping counter: 1 out of 10
2025-02-27 12:10:28,904 - {'epoch': 18, 'rec_loss': '5.6153'}
2025-02-27 12:10:29,635 - {'Epoch': 18, 'HR@5': '0.0532', 'NDCG@5': '0.0349', 'HR@10': '0.0890', 'NDCG@10': '0.0465', 'HR@20': '0.1339', 'NDCG@20': '0.0579'}
2025-02-27 12:10:29,636 - Validation score increased.  Saving model ...
2025-02-27 12:10:34,611 - {'epoch': 19, 'rec_loss': '5.6086'}
2025-02-27 12:10:35,296 - {'Epoch': 19, 'HR@5': '0.0606', 'NDCG@5': '0.0395', 'HR@10': '0.0927', 'NDCG@10': '0.0500', 'HR@20': '0.1358', 'NDCG@20': '0.0608'}
2025-02-27 12:10:35,297 - Validation score increased.  Saving model ...
2025-02-27 12:10:40,332 - {'epoch': 20, 'rec_loss': '5.5730'}
2025-02-27 12:10:41,031 - {'Epoch': 20, 'HR@5': '0.0514', 'NDCG@5': '0.0347', 'HR@10': '0.0908', 'NDCG@10': '0.0471', 'HR@20': '0.1349', 'NDCG@20': '0.0582'}
2025-02-27 12:10:41,032 - EarlyStopping counter: 1 out of 10
2025-02-27 12:10:46,355 - {'epoch': 21, 'rec_loss': '5.5223'}
2025-02-27 12:10:47,093 - {'Epoch': 21, 'HR@5': '0.0578', 'NDCG@5': '0.0384', 'HR@10': '0.0927', 'NDCG@10': '0.0496', 'HR@20': '0.1468', 'NDCG@20': '0.0632'}
2025-02-27 12:10:47,094 - Validation score increased.  Saving model ...
2025-02-27 12:10:52,400 - {'epoch': 22, 'rec_loss': '5.5198'}
2025-02-27 12:10:53,112 - {'Epoch': 22, 'HR@5': '0.0550', 'NDCG@5': '0.0370', 'HR@10': '0.0872', 'NDCG@10': '0.0474', 'HR@20': '0.1367', 'NDCG@20': '0.0599'}
2025-02-27 12:10:53,113 - EarlyStopping counter: 1 out of 10
2025-02-27 12:10:58,251 - {'epoch': 23, 'rec_loss': '5.5154'}
2025-02-27 12:10:58,943 - {'Epoch': 23, 'HR@5': '0.0560', 'NDCG@5': '0.0363', 'HR@10': '0.0890', 'NDCG@10': '0.0468', 'HR@20': '0.1367', 'NDCG@20': '0.0588'}
2025-02-27 12:10:58,945 - EarlyStopping counter: 2 out of 10
2025-02-27 12:11:04,381 - {'epoch': 24, 'rec_loss': '5.4816'}
2025-02-27 12:11:05,096 - {'Epoch': 24, 'HR@5': '0.0578', 'NDCG@5': '0.0370', 'HR@10': '0.0908', 'NDCG@10': '0.0477', 'HR@20': '0.1394', 'NDCG@20': '0.0600'}
2025-02-27 12:11:05,097 - EarlyStopping counter: 3 out of 10
2025-02-27 12:11:10,239 - {'epoch': 25, 'rec_loss': '5.4614'}
2025-02-27 12:11:10,921 - {'Epoch': 25, 'HR@5': '0.0550', 'NDCG@5': '0.0351', 'HR@10': '0.0881', 'NDCG@10': '0.0458', 'HR@20': '0.1358', 'NDCG@20': '0.0578'}
2025-02-27 12:11:10,923 - EarlyStopping counter: 4 out of 10
2025-02-27 12:11:16,002 - {'epoch': 26, 'rec_loss': '5.4620'}
2025-02-27 12:11:16,733 - {'Epoch': 26, 'HR@5': '0.0560', 'NDCG@5': '0.0362', 'HR@10': '0.0862', 'NDCG@10': '0.0458', 'HR@20': '0.1404', 'NDCG@20': '0.0596'}
2025-02-27 12:11:16,735 - EarlyStopping counter: 5 out of 10
2025-02-27 12:11:21,714 - {'epoch': 27, 'rec_loss': '5.4265'}
2025-02-27 12:11:22,398 - {'Epoch': 27, 'HR@5': '0.0569', 'NDCG@5': '0.0355', 'HR@10': '0.0972', 'NDCG@10': '0.0483', 'HR@20': '0.1431', 'NDCG@20': '0.0598'}
2025-02-27 12:11:22,399 - EarlyStopping counter: 6 out of 10
2025-02-27 12:11:27,728 - {'epoch': 28, 'rec_loss': '5.4175'}
2025-02-27 12:11:28,443 - {'Epoch': 28, 'HR@5': '0.0633', 'NDCG@5': '0.0408', 'HR@10': '0.0927', 'NDCG@10': '0.0502', 'HR@20': '0.1459', 'NDCG@20': '0.0634'}
2025-02-27 12:11:28,444 - Validation score increased.  Saving model ...
2025-02-27 12:11:33,347 - {'epoch': 29, 'rec_loss': '5.4021'}
2025-02-27 12:11:34,037 - {'Epoch': 29, 'HR@5': '0.0560', 'NDCG@5': '0.0364', 'HR@10': '0.0927', 'NDCG@10': '0.0482', 'HR@20': '0.1459', 'NDCG@20': '0.0615'}
2025-02-27 12:11:34,038 - EarlyStopping counter: 1 out of 10
2025-02-27 12:11:39,595 - {'epoch': 30, 'rec_loss': '5.3932'}
2025-02-27 12:11:40,223 - {'Epoch': 30, 'HR@5': '0.0578', 'NDCG@5': '0.0380', 'HR@10': '0.0917', 'NDCG@10': '0.0488', 'HR@20': '0.1422', 'NDCG@20': '0.0615'}
2025-02-27 12:11:40,224 - EarlyStopping counter: 2 out of 10
2025-02-27 12:11:45,133 - {'epoch': 31, 'rec_loss': '5.3919'}
2025-02-27 12:11:45,846 - {'Epoch': 31, 'HR@5': '0.0569', 'NDCG@5': '0.0360', 'HR@10': '0.0982', 'NDCG@10': '0.0494', 'HR@20': '0.1495', 'NDCG@20': '0.0622'}
2025-02-27 12:11:45,848 - EarlyStopping counter: 3 out of 10
2025-02-27 12:11:50,703 - {'epoch': 32, 'rec_loss': '5.3709'}
2025-02-27 12:11:51,394 - {'Epoch': 32, 'HR@5': '0.0541', 'NDCG@5': '0.0355', 'HR@10': '0.0945', 'NDCG@10': '0.0487', 'HR@20': '0.1468', 'NDCG@20': '0.0618'}
2025-02-27 12:11:51,396 - EarlyStopping counter: 4 out of 10
2025-02-27 12:11:56,327 - {'epoch': 33, 'rec_loss': '5.3498'}
2025-02-27 12:11:57,027 - {'Epoch': 33, 'HR@5': '0.0596', 'NDCG@5': '0.0374', 'HR@10': '0.0972', 'NDCG@10': '0.0495', 'HR@20': '0.1495', 'NDCG@20': '0.0626'}
2025-02-27 12:11:57,029 - EarlyStopping counter: 5 out of 10
2025-02-27 12:12:01,913 - {'epoch': 34, 'rec_loss': '5.3566'}
2025-02-27 12:12:02,615 - {'Epoch': 34, 'HR@5': '0.0587', 'NDCG@5': '0.0375', 'HR@10': '0.0908', 'NDCG@10': '0.0480', 'HR@20': '0.1431', 'NDCG@20': '0.0613'}
2025-02-27 12:12:02,617 - EarlyStopping counter: 6 out of 10
2025-02-27 12:12:07,770 - {'epoch': 35, 'rec_loss': '5.3257'}
2025-02-27 12:12:08,512 - {'Epoch': 35, 'HR@5': '0.0560', 'NDCG@5': '0.0364', 'HR@10': '0.0936', 'NDCG@10': '0.0482', 'HR@20': '0.1404', 'NDCG@20': '0.0600'}
2025-02-27 12:12:08,513 - EarlyStopping counter: 7 out of 10
2025-02-27 12:12:13,641 - {'epoch': 36, 'rec_loss': '5.3228'}
2025-02-27 12:12:14,308 - {'Epoch': 36, 'HR@5': '0.0615', 'NDCG@5': '0.0380', 'HR@10': '0.0972', 'NDCG@10': '0.0493', 'HR@20': '0.1404', 'NDCG@20': '0.0601'}
2025-02-27 12:12:14,309 - EarlyStopping counter: 8 out of 10
2025-02-27 12:12:19,860 - {'epoch': 37, 'rec_loss': '5.3097'}
2025-02-27 12:12:20,643 - {'Epoch': 37, 'HR@5': '0.0569', 'NDCG@5': '0.0371', 'HR@10': '0.0908', 'NDCG@10': '0.0480', 'HR@20': '0.1450', 'NDCG@20': '0.0617'}
2025-02-27 12:12:20,644 - EarlyStopping counter: 9 out of 10
2025-02-27 12:12:27,537 - {'epoch': 38, 'rec_loss': '5.3016'}
2025-02-27 12:12:28,219 - {'Epoch': 38, 'HR@5': '0.0523', 'NDCG@5': '0.0343', 'HR@10': '0.0908', 'NDCG@10': '0.0468', 'HR@20': '0.1477', 'NDCG@20': '0.0611'}
2025-02-27 12:12:28,220 - EarlyStopping counter: 10 out of 10
2025-02-27 12:12:28,220 - Early stopping
2025-02-27 12:12:28,220 - ---------------Test Score---------------
2025-02-27 12:12:28,943 - {'Epoch': 0, 'HR@5': '0.0560', 'NDCG@5': '0.0372', 'HR@10': '0.0771', 'NDCG@10': '0.0440', 'HR@20': '0.1046', 'NDCG@20': '0.0508'}
2025-02-27 12:12:28,944 - Scale_LastFM
2025-02-27 12:12:28,944 - {'Epoch': 0, 'HR@5': '0.0560', 'NDCG@5': '0.0372', 'HR@10': '0.0771', 'NDCG@10': '0.0440', 'HR@20': '0.1046', 'NDCG@20': '0.0508'}
2025-02-27 12:16:22,312 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 4, 6, 12], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-27 12:16:28,881 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=4, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=4, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-27 12:16:28,937 - Total Parameters: 387354
2025-02-27 12:16:37,520 - {'epoch': 0, 'rec_loss': '8.0362'}
2025-02-27 12:16:38,249 - {'Epoch': 0, 'HR@5': '0.0220', 'NDCG@5': '0.0156', 'HR@10': '0.0349', 'NDCG@10': '0.0197', 'HR@20': '0.0560', 'NDCG@20': '0.0251'}
2025-02-27 12:16:38,250 - Validation score increased.  Saving model ...
2025-02-27 12:16:45,301 - {'epoch': 1, 'rec_loss': '7.7341'}
2025-02-27 12:16:46,049 - {'Epoch': 1, 'HR@5': '0.0193', 'NDCG@5': '0.0120', 'HR@10': '0.0358', 'NDCG@10': '0.0174', 'HR@20': '0.0523', 'NDCG@20': '0.0215'}
2025-02-27 12:16:46,051 - EarlyStopping counter: 1 out of 10
2025-02-27 12:16:52,990 - {'epoch': 2, 'rec_loss': '7.5205'}
2025-02-27 12:16:53,777 - {'Epoch': 2, 'HR@5': '0.0239', 'NDCG@5': '0.0179', 'HR@10': '0.0422', 'NDCG@10': '0.0238', 'HR@20': '0.0633', 'NDCG@20': '0.0292'}
2025-02-27 12:16:53,778 - Validation score increased.  Saving model ...
2025-02-27 12:17:00,714 - {'epoch': 3, 'rec_loss': '7.3044'}
2025-02-27 12:17:01,461 - {'Epoch': 3, 'HR@5': '0.0330', 'NDCG@5': '0.0214', 'HR@10': '0.0495', 'NDCG@10': '0.0266', 'HR@20': '0.0752', 'NDCG@20': '0.0331'}
2025-02-27 12:17:01,462 - Validation score increased.  Saving model ...
2025-02-27 12:17:08,741 - {'epoch': 4, 'rec_loss': '7.0912'}
2025-02-27 12:17:09,497 - {'Epoch': 4, 'HR@5': '0.0330', 'NDCG@5': '0.0234', 'HR@10': '0.0578', 'NDCG@10': '0.0313', 'HR@20': '0.0862', 'NDCG@20': '0.0384'}
2025-02-27 12:17:09,498 - Validation score increased.  Saving model ...
2025-02-27 12:17:17,350 - {'epoch': 5, 'rec_loss': '6.8899'}
2025-02-27 12:17:18,094 - {'Epoch': 5, 'HR@5': '0.0376', 'NDCG@5': '0.0250', 'HR@10': '0.0550', 'NDCG@10': '0.0308', 'HR@20': '0.0908', 'NDCG@20': '0.0398'}
2025-02-27 12:17:18,095 - Validation score increased.  Saving model ...
2025-02-27 12:17:25,553 - {'epoch': 6, 'rec_loss': '6.6926'}
2025-02-27 12:17:26,290 - {'Epoch': 6, 'HR@5': '0.0404', 'NDCG@5': '0.0260', 'HR@10': '0.0587', 'NDCG@10': '0.0320', 'HR@20': '0.0908', 'NDCG@20': '0.0402'}
2025-02-27 12:17:26,291 - Validation score increased.  Saving model ...
2025-02-27 12:17:33,231 - {'epoch': 7, 'rec_loss': '6.5235'}
2025-02-27 12:17:33,953 - {'Epoch': 7, 'HR@5': '0.0431', 'NDCG@5': '0.0277', 'HR@10': '0.0642', 'NDCG@10': '0.0344', 'HR@20': '0.0954', 'NDCG@20': '0.0423'}
2025-02-27 12:17:33,954 - Validation score increased.  Saving model ...
2025-02-27 12:17:40,749 - {'epoch': 8, 'rec_loss': '6.3544'}
2025-02-27 12:17:41,480 - {'Epoch': 8, 'HR@5': '0.0440', 'NDCG@5': '0.0283', 'HR@10': '0.0633', 'NDCG@10': '0.0344', 'HR@20': '0.1028', 'NDCG@20': '0.0444'}
2025-02-27 12:17:41,481 - Validation score increased.  Saving model ...
2025-02-27 12:17:48,411 - {'epoch': 9, 'rec_loss': '6.2373'}
2025-02-27 12:17:49,096 - {'Epoch': 9, 'HR@5': '0.0459', 'NDCG@5': '0.0297', 'HR@10': '0.0688', 'NDCG@10': '0.0369', 'HR@20': '0.1046', 'NDCG@20': '0.0459'}
2025-02-27 12:17:49,097 - Validation score increased.  Saving model ...
2025-02-27 12:17:56,037 - {'epoch': 10, 'rec_loss': '6.1009'}
2025-02-27 12:17:56,694 - {'Epoch': 10, 'HR@5': '0.0459', 'NDCG@5': '0.0327', 'HR@10': '0.0743', 'NDCG@10': '0.0417', 'HR@20': '0.1128', 'NDCG@20': '0.0513'}
2025-02-27 12:17:56,695 - Validation score increased.  Saving model ...
2025-02-27 12:18:04,005 - {'epoch': 11, 'rec_loss': '6.0328'}
2025-02-27 12:18:04,756 - {'Epoch': 11, 'HR@5': '0.0450', 'NDCG@5': '0.0305', 'HR@10': '0.0752', 'NDCG@10': '0.0401', 'HR@20': '0.1138', 'NDCG@20': '0.0499'}
2025-02-27 12:18:04,757 - EarlyStopping counter: 1 out of 10
2025-02-27 12:18:11,629 - {'epoch': 12, 'rec_loss': '5.9522'}
2025-02-27 12:18:12,405 - {'Epoch': 12, 'HR@5': '0.0523', 'NDCG@5': '0.0338', 'HR@10': '0.0761', 'NDCG@10': '0.0415', 'HR@20': '0.1193', 'NDCG@20': '0.0522'}
2025-02-27 12:18:12,406 - Validation score increased.  Saving model ...
2025-02-27 12:18:19,529 - {'epoch': 13, 'rec_loss': '5.8456'}
2025-02-27 12:18:20,367 - {'Epoch': 13, 'HR@5': '0.0550', 'NDCG@5': '0.0347', 'HR@10': '0.0743', 'NDCG@10': '0.0410', 'HR@20': '0.1193', 'NDCG@20': '0.0524'}
2025-02-27 12:18:20,368 - Validation score increased.  Saving model ...
2025-02-27 12:18:27,461 - {'epoch': 14, 'rec_loss': '5.8130'}
2025-02-27 12:18:28,186 - {'Epoch': 14, 'HR@5': '0.0541', 'NDCG@5': '0.0348', 'HR@10': '0.0771', 'NDCG@10': '0.0421', 'HR@20': '0.1220', 'NDCG@20': '0.0534'}
2025-02-27 12:18:28,187 - Validation score increased.  Saving model ...
2025-02-27 12:18:34,568 - {'epoch': 15, 'rec_loss': '5.7444'}
2025-02-27 12:18:35,369 - {'Epoch': 15, 'HR@5': '0.0550', 'NDCG@5': '0.0358', 'HR@10': '0.0807', 'NDCG@10': '0.0439', 'HR@20': '0.1257', 'NDCG@20': '0.0551'}
2025-02-27 12:18:35,371 - Validation score increased.  Saving model ...
2025-02-27 12:18:42,206 - {'epoch': 16, 'rec_loss': '5.7149'}
2025-02-27 12:18:42,969 - {'Epoch': 16, 'HR@5': '0.0541', 'NDCG@5': '0.0349', 'HR@10': '0.0844', 'NDCG@10': '0.0447', 'HR@20': '0.1303', 'NDCG@20': '0.0561'}
2025-02-27 12:18:42,970 - Validation score increased.  Saving model ...
2025-02-27 12:18:50,643 - {'epoch': 17, 'rec_loss': '5.6661'}
2025-02-27 12:18:51,401 - {'Epoch': 17, 'HR@5': '0.0550', 'NDCG@5': '0.0356', 'HR@10': '0.0807', 'NDCG@10': '0.0440', 'HR@20': '0.1275', 'NDCG@20': '0.0558'}
2025-02-27 12:18:51,402 - EarlyStopping counter: 1 out of 10
2025-02-27 12:18:59,036 - {'epoch': 18, 'rec_loss': '5.6163'}
2025-02-27 12:18:59,843 - {'Epoch': 18, 'HR@5': '0.0550', 'NDCG@5': '0.0357', 'HR@10': '0.0908', 'NDCG@10': '0.0471', 'HR@20': '0.1339', 'NDCG@20': '0.0579'}
2025-02-27 12:18:59,845 - Validation score increased.  Saving model ...
2025-02-27 12:19:06,843 - {'epoch': 19, 'rec_loss': '5.6096'}
2025-02-27 12:19:07,599 - {'Epoch': 19, 'HR@5': '0.0615', 'NDCG@5': '0.0396', 'HR@10': '0.0927', 'NDCG@10': '0.0498', 'HR@20': '0.1367', 'NDCG@20': '0.0608'}
2025-02-27 12:19:07,600 - Validation score increased.  Saving model ...
2025-02-27 12:19:14,668 - {'epoch': 20, 'rec_loss': '5.5736'}
2025-02-27 12:19:15,367 - {'Epoch': 20, 'HR@5': '0.0505', 'NDCG@5': '0.0342', 'HR@10': '0.0890', 'NDCG@10': '0.0465', 'HR@20': '0.1358', 'NDCG@20': '0.0583'}
2025-02-27 12:19:15,368 - EarlyStopping counter: 1 out of 10
2025-02-27 12:19:22,678 - {'epoch': 21, 'rec_loss': '5.5230'}
2025-02-27 12:19:23,450 - {'Epoch': 21, 'HR@5': '0.0587', 'NDCG@5': '0.0386', 'HR@10': '0.0927', 'NDCG@10': '0.0494', 'HR@20': '0.1468', 'NDCG@20': '0.0630'}
2025-02-27 12:19:23,451 - Validation score increased.  Saving model ...
2025-02-27 12:19:30,350 - {'epoch': 22, 'rec_loss': '5.5207'}
2025-02-27 12:19:31,078 - {'Epoch': 22, 'HR@5': '0.0532', 'NDCG@5': '0.0365', 'HR@10': '0.0881', 'NDCG@10': '0.0478', 'HR@20': '0.1367', 'NDCG@20': '0.0600'}
2025-02-27 12:19:31,079 - EarlyStopping counter: 1 out of 10
2025-02-27 12:19:38,367 - {'epoch': 23, 'rec_loss': '5.5159'}
2025-02-27 12:19:39,055 - {'Epoch': 23, 'HR@5': '0.0560', 'NDCG@5': '0.0358', 'HR@10': '0.0862', 'NDCG@10': '0.0456', 'HR@20': '0.1367', 'NDCG@20': '0.0583'}
2025-02-27 12:19:39,056 - EarlyStopping counter: 2 out of 10
2025-02-27 12:19:46,455 - {'epoch': 24, 'rec_loss': '5.4821'}
2025-02-27 12:19:47,160 - {'Epoch': 24, 'HR@5': '0.0578', 'NDCG@5': '0.0371', 'HR@10': '0.0899', 'NDCG@10': '0.0476', 'HR@20': '0.1394', 'NDCG@20': '0.0601'}
2025-02-27 12:19:47,161 - EarlyStopping counter: 3 out of 10
2025-02-27 12:19:54,288 - {'epoch': 25, 'rec_loss': '5.4617'}
2025-02-27 12:19:55,048 - {'Epoch': 25, 'HR@5': '0.0550', 'NDCG@5': '0.0351', 'HR@10': '0.0881', 'NDCG@10': '0.0459', 'HR@20': '0.1385', 'NDCG@20': '0.0585'}
2025-02-27 12:19:55,049 - EarlyStopping counter: 4 out of 10
2025-02-27 12:20:02,117 - {'epoch': 26, 'rec_loss': '5.4625'}
2025-02-27 12:20:02,823 - {'Epoch': 26, 'HR@5': '0.0569', 'NDCG@5': '0.0366', 'HR@10': '0.0844', 'NDCG@10': '0.0455', 'HR@20': '0.1413', 'NDCG@20': '0.0599'}
2025-02-27 12:20:02,824 - EarlyStopping counter: 5 out of 10
2025-02-27 12:20:09,833 - {'epoch': 27, 'rec_loss': '5.4271'}
2025-02-27 12:20:10,567 - {'Epoch': 27, 'HR@5': '0.0569', 'NDCG@5': '0.0355', 'HR@10': '0.0972', 'NDCG@10': '0.0484', 'HR@20': '0.1404', 'NDCG@20': '0.0592'}
2025-02-27 12:20:10,569 - EarlyStopping counter: 6 out of 10
2025-02-27 12:20:17,409 - {'epoch': 28, 'rec_loss': '5.4180'}
2025-02-27 12:20:18,107 - {'Epoch': 28, 'HR@5': '0.0615', 'NDCG@5': '0.0398', 'HR@10': '0.0927', 'NDCG@10': '0.0499', 'HR@20': '0.1450', 'NDCG@20': '0.0629'}
2025-02-27 12:20:18,108 - EarlyStopping counter: 7 out of 10
2025-02-27 12:20:25,129 - {'epoch': 29, 'rec_loss': '5.4026'}
2025-02-27 12:20:25,820 - {'Epoch': 29, 'HR@5': '0.0560', 'NDCG@5': '0.0364', 'HR@10': '0.0927', 'NDCG@10': '0.0481', 'HR@20': '0.1459', 'NDCG@20': '0.0615'}
2025-02-27 12:20:25,822 - EarlyStopping counter: 8 out of 10
2025-02-27 12:20:33,285 - {'epoch': 30, 'rec_loss': '5.3936'}
2025-02-27 12:20:34,004 - {'Epoch': 30, 'HR@5': '0.0587', 'NDCG@5': '0.0383', 'HR@10': '0.0908', 'NDCG@10': '0.0485', 'HR@20': '0.1422', 'NDCG@20': '0.0614'}
2025-02-27 12:20:34,005 - EarlyStopping counter: 9 out of 10
2025-02-27 12:20:41,606 - {'epoch': 31, 'rec_loss': '5.3925'}
2025-02-27 12:20:42,366 - {'Epoch': 31, 'HR@5': '0.0569', 'NDCG@5': '0.0357', 'HR@10': '0.0972', 'NDCG@10': '0.0488', 'HR@20': '0.1505', 'NDCG@20': '0.0622'}
2025-02-27 12:20:42,367 - EarlyStopping counter: 10 out of 10
2025-02-27 12:20:42,367 - Early stopping
2025-02-27 12:20:42,367 - ---------------Test Score---------------
2025-02-27 12:20:43,216 - {'Epoch': 0, 'HR@5': '0.0523', 'NDCG@5': '0.0364', 'HR@10': '0.0725', 'NDCG@10': '0.0429', 'HR@20': '0.0963', 'NDCG@20': '0.0489'}
2025-02-27 12:20:43,217 - Scale_LastFM
2025-02-27 12:20:43,217 - {'Epoch': 0, 'HR@5': '0.0523', 'NDCG@5': '0.0364', 'HR@10': '0.0725', 'NDCG@10': '0.0429', 'HR@20': '0.0963', 'NDCG@20': '0.0489'}
2025-02-27 12:23:04,004 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-27 12:23:10,519 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-27 12:23:10,627 - Total Parameters: 387350
2025-02-27 12:23:18,995 - {'epoch': 0, 'rec_loss': '8.0394'}
2025-02-27 12:23:19,746 - {'Epoch': 0, 'HR@5': '0.0202', 'NDCG@5': '0.0144', 'HR@10': '0.0349', 'NDCG@10': '0.0191', 'HR@20': '0.0642', 'NDCG@20': '0.0264'}
2025-02-27 12:23:19,747 - Validation score increased.  Saving model ...
2025-02-27 12:23:26,937 - {'epoch': 1, 'rec_loss': '7.7583'}
2025-02-27 12:23:27,691 - {'Epoch': 1, 'HR@5': '0.0239', 'NDCG@5': '0.0156', 'HR@10': '0.0358', 'NDCG@10': '0.0194', 'HR@20': '0.0624', 'NDCG@20': '0.0260'}
2025-02-27 12:23:27,692 - EarlyStopping counter: 1 out of 10
2025-02-27 12:23:34,074 - {'epoch': 2, 'rec_loss': '7.5500'}
2025-02-27 12:23:34,789 - {'Epoch': 2, 'HR@5': '0.0303', 'NDCG@5': '0.0205', 'HR@10': '0.0495', 'NDCG@10': '0.0267', 'HR@20': '0.0725', 'NDCG@20': '0.0324'}
2025-02-27 12:23:34,790 - Validation score increased.  Saving model ...
2025-02-27 12:23:41,487 - {'epoch': 3, 'rec_loss': '7.3264'}
2025-02-27 12:23:42,254 - {'Epoch': 3, 'HR@5': '0.0339', 'NDCG@5': '0.0223', 'HR@10': '0.0486', 'NDCG@10': '0.0269', 'HR@20': '0.0716', 'NDCG@20': '0.0326'}
2025-02-27 12:23:42,255 - Validation score increased.  Saving model ...
2025-02-27 12:23:49,112 - {'epoch': 4, 'rec_loss': '7.1150'}
2025-02-27 12:23:49,901 - {'Epoch': 4, 'HR@5': '0.0376', 'NDCG@5': '0.0249', 'HR@10': '0.0514', 'NDCG@10': '0.0292', 'HR@20': '0.0835', 'NDCG@20': '0.0376'}
2025-02-27 12:23:49,903 - Validation score increased.  Saving model ...
2025-02-27 12:23:56,882 - {'epoch': 5, 'rec_loss': '6.9071'}
2025-02-27 12:23:57,621 - {'Epoch': 5, 'HR@5': '0.0358', 'NDCG@5': '0.0241', 'HR@10': '0.0578', 'NDCG@10': '0.0312', 'HR@20': '0.0936', 'NDCG@20': '0.0400'}
2025-02-27 12:23:57,622 - Validation score increased.  Saving model ...
2025-02-27 12:24:04,077 - {'epoch': 6, 'rec_loss': '6.7098'}
2025-02-27 12:24:04,843 - {'Epoch': 6, 'HR@5': '0.0422', 'NDCG@5': '0.0245', 'HR@10': '0.0661', 'NDCG@10': '0.0322', 'HR@20': '0.0963', 'NDCG@20': '0.0399'}
2025-02-27 12:24:04,844 - EarlyStopping counter: 1 out of 10
2025-02-27 12:24:11,279 - {'epoch': 7, 'rec_loss': '6.5301'}
2025-02-27 12:24:12,037 - {'Epoch': 7, 'HR@5': '0.0450', 'NDCG@5': '0.0273', 'HR@10': '0.0670', 'NDCG@10': '0.0343', 'HR@20': '0.1000', 'NDCG@20': '0.0426'}
2025-02-27 12:24:12,038 - Validation score increased.  Saving model ...
2025-02-27 12:24:18,723 - {'epoch': 8, 'rec_loss': '6.3649'}
2025-02-27 12:24:19,451 - {'Epoch': 8, 'HR@5': '0.0404', 'NDCG@5': '0.0263', 'HR@10': '0.0688', 'NDCG@10': '0.0356', 'HR@20': '0.1073', 'NDCG@20': '0.0453'}
2025-02-27 12:24:19,452 - Validation score increased.  Saving model ...
2025-02-27 12:24:27,132 - {'epoch': 9, 'rec_loss': '6.2518'}
2025-02-27 12:24:27,880 - {'Epoch': 9, 'HR@5': '0.0495', 'NDCG@5': '0.0306', 'HR@10': '0.0761', 'NDCG@10': '0.0391', 'HR@20': '0.1147', 'NDCG@20': '0.0488'}
2025-02-27 12:24:27,881 - Validation score increased.  Saving model ...
2025-02-27 12:24:34,334 - {'epoch': 10, 'rec_loss': '6.1107'}
2025-02-27 12:24:35,070 - {'Epoch': 10, 'HR@5': '0.0477', 'NDCG@5': '0.0311', 'HR@10': '0.0697', 'NDCG@10': '0.0382', 'HR@20': '0.1156', 'NDCG@20': '0.0498'}
2025-02-27 12:24:35,071 - Validation score increased.  Saving model ...
2025-02-27 12:24:42,148 - {'epoch': 11, 'rec_loss': '6.0370'}
2025-02-27 12:24:42,861 - {'Epoch': 11, 'HR@5': '0.0468', 'NDCG@5': '0.0311', 'HR@10': '0.0725', 'NDCG@10': '0.0391', 'HR@20': '0.1193', 'NDCG@20': '0.0510'}
2025-02-27 12:24:42,863 - Validation score increased.  Saving model ...
2025-02-27 12:24:49,092 - {'epoch': 12, 'rec_loss': '5.9484'}
2025-02-27 12:24:49,808 - {'Epoch': 12, 'HR@5': '0.0450', 'NDCG@5': '0.0300', 'HR@10': '0.0817', 'NDCG@10': '0.0416', 'HR@20': '0.1284', 'NDCG@20': '0.0534'}
2025-02-27 12:24:49,809 - Validation score increased.  Saving model ...
2025-02-27 12:24:56,157 - {'epoch': 13, 'rec_loss': '5.8676'}
2025-02-27 12:24:56,875 - {'Epoch': 13, 'HR@5': '0.0440', 'NDCG@5': '0.0294', 'HR@10': '0.0789', 'NDCG@10': '0.0405', 'HR@20': '0.1275', 'NDCG@20': '0.0529'}
2025-02-27 12:24:56,876 - EarlyStopping counter: 1 out of 10
2025-02-27 12:25:03,737 - {'epoch': 14, 'rec_loss': '5.7982'}
2025-02-27 12:25:04,538 - {'Epoch': 14, 'HR@5': '0.0468', 'NDCG@5': '0.0309', 'HR@10': '0.0817', 'NDCG@10': '0.0423', 'HR@20': '0.1284', 'NDCG@20': '0.0539'}
2025-02-27 12:25:04,539 - Validation score increased.  Saving model ...
2025-02-27 12:25:11,863 - {'epoch': 15, 'rec_loss': '5.7559'}
2025-02-27 12:25:12,638 - {'Epoch': 15, 'HR@5': '0.0532', 'NDCG@5': '0.0343', 'HR@10': '0.0826', 'NDCG@10': '0.0438', 'HR@20': '0.1284', 'NDCG@20': '0.0553'}
2025-02-27 12:25:12,639 - Validation score increased.  Saving model ...
2025-02-27 12:25:19,345 - {'epoch': 16, 'rec_loss': '5.7246'}
2025-02-27 12:25:20,179 - {'Epoch': 16, 'HR@5': '0.0523', 'NDCG@5': '0.0335', 'HR@10': '0.0752', 'NDCG@10': '0.0409', 'HR@20': '0.1239', 'NDCG@20': '0.0532'}
2025-02-27 12:25:20,181 - EarlyStopping counter: 1 out of 10
2025-02-27 12:25:27,775 - {'epoch': 17, 'rec_loss': '5.6753'}
2025-02-27 12:25:28,649 - {'Epoch': 17, 'HR@5': '0.0523', 'NDCG@5': '0.0336', 'HR@10': '0.0817', 'NDCG@10': '0.0431', 'HR@20': '0.1330', 'NDCG@20': '0.0561'}
2025-02-27 12:25:28,650 - Validation score increased.  Saving model ...
2025-02-27 12:25:36,413 - {'epoch': 18, 'rec_loss': '5.6228'}
2025-02-27 12:25:37,163 - {'Epoch': 18, 'HR@5': '0.0514', 'NDCG@5': '0.0320', 'HR@10': '0.0872', 'NDCG@10': '0.0434', 'HR@20': '0.1339', 'NDCG@20': '0.0550'}
2025-02-27 12:25:37,164 - EarlyStopping counter: 1 out of 10
2025-02-27 12:25:44,085 - {'epoch': 19, 'rec_loss': '5.5916'}
2025-02-27 12:25:44,813 - {'Epoch': 19, 'HR@5': '0.0550', 'NDCG@5': '0.0327', 'HR@10': '0.0881', 'NDCG@10': '0.0434', 'HR@20': '0.1376', 'NDCG@20': '0.0559'}
2025-02-27 12:25:44,814 - EarlyStopping counter: 2 out of 10
2025-02-27 12:25:51,461 - {'epoch': 20, 'rec_loss': '5.5729'}
2025-02-27 12:25:52,230 - {'Epoch': 20, 'HR@5': '0.0459', 'NDCG@5': '0.0309', 'HR@10': '0.0872', 'NDCG@10': '0.0442', 'HR@20': '0.1349', 'NDCG@20': '0.0562'}
2025-02-27 12:25:52,231 - Validation score increased.  Saving model ...
2025-02-27 12:25:59,439 - {'epoch': 21, 'rec_loss': '5.5349'}
2025-02-27 12:26:00,125 - {'Epoch': 21, 'HR@5': '0.0550', 'NDCG@5': '0.0357', 'HR@10': '0.0881', 'NDCG@10': '0.0462', 'HR@20': '0.1358', 'NDCG@20': '0.0584'}
2025-02-27 12:26:00,126 - Validation score increased.  Saving model ...
2025-02-27 12:26:06,528 - {'epoch': 22, 'rec_loss': '5.5280'}
2025-02-27 12:26:07,229 - {'Epoch': 22, 'HR@5': '0.0532', 'NDCG@5': '0.0344', 'HR@10': '0.0908', 'NDCG@10': '0.0463', 'HR@20': '0.1349', 'NDCG@20': '0.0574'}
2025-02-27 12:26:07,230 - EarlyStopping counter: 1 out of 10
2025-02-27 12:26:14,159 - {'epoch': 23, 'rec_loss': '5.5191'}
2025-02-27 12:26:14,916 - {'Epoch': 23, 'HR@5': '0.0514', 'NDCG@5': '0.0345', 'HR@10': '0.0890', 'NDCG@10': '0.0467', 'HR@20': '0.1431', 'NDCG@20': '0.0606'}
2025-02-27 12:26:14,918 - Validation score increased.  Saving model ...
2025-02-27 12:26:21,892 - {'epoch': 24, 'rec_loss': '5.4782'}
2025-02-27 12:26:22,646 - {'Epoch': 24, 'HR@5': '0.0560', 'NDCG@5': '0.0370', 'HR@10': '0.0945', 'NDCG@10': '0.0493', 'HR@20': '0.1367', 'NDCG@20': '0.0600'}
2025-02-27 12:26:22,647 - EarlyStopping counter: 1 out of 10
2025-02-27 12:26:30,116 - {'epoch': 25, 'rec_loss': '5.4475'}
2025-02-27 12:26:30,877 - {'Epoch': 25, 'HR@5': '0.0578', 'NDCG@5': '0.0361', 'HR@10': '0.0927', 'NDCG@10': '0.0471', 'HR@20': '0.1459', 'NDCG@20': '0.0604'}
2025-02-27 12:26:30,878 - EarlyStopping counter: 2 out of 10
2025-02-27 12:26:38,151 - {'epoch': 26, 'rec_loss': '5.4527'}
2025-02-27 12:26:38,872 - {'Epoch': 26, 'HR@5': '0.0514', 'NDCG@5': '0.0335', 'HR@10': '0.0908', 'NDCG@10': '0.0463', 'HR@20': '0.1431', 'NDCG@20': '0.0593'}
2025-02-27 12:26:38,873 - EarlyStopping counter: 3 out of 10
2025-02-27 12:26:46,024 - {'epoch': 27, 'rec_loss': '5.4389'}
2025-02-27 12:26:46,812 - {'Epoch': 27, 'HR@5': '0.0569', 'NDCG@5': '0.0362', 'HR@10': '0.0881', 'NDCG@10': '0.0461', 'HR@20': '0.1394', 'NDCG@20': '0.0592'}
2025-02-27 12:26:46,814 - EarlyStopping counter: 4 out of 10
2025-02-27 12:26:53,802 - {'epoch': 28, 'rec_loss': '5.4193'}
2025-02-27 12:26:54,515 - {'Epoch': 28, 'HR@5': '0.0578', 'NDCG@5': '0.0379', 'HR@10': '0.0890', 'NDCG@10': '0.0477', 'HR@20': '0.1495', 'NDCG@20': '0.0629'}
2025-02-27 12:26:54,516 - Validation score increased.  Saving model ...
2025-02-27 12:27:01,991 - {'epoch': 29, 'rec_loss': '5.4069'}
2025-02-27 12:27:02,703 - {'Epoch': 29, 'HR@5': '0.0569', 'NDCG@5': '0.0381', 'HR@10': '0.0853', 'NDCG@10': '0.0473', 'HR@20': '0.1440', 'NDCG@20': '0.0622'}
2025-02-27 12:27:02,704 - EarlyStopping counter: 1 out of 10
2025-02-27 12:27:10,452 - {'epoch': 30, 'rec_loss': '5.3962'}
2025-02-27 12:27:11,249 - {'Epoch': 30, 'HR@5': '0.0550', 'NDCG@5': '0.0372', 'HR@10': '0.0872', 'NDCG@10': '0.0474', 'HR@20': '0.1440', 'NDCG@20': '0.0617'}
2025-02-27 12:27:11,250 - EarlyStopping counter: 2 out of 10
2025-02-27 12:27:17,761 - {'epoch': 31, 'rec_loss': '5.3886'}
2025-02-27 12:27:18,463 - {'Epoch': 31, 'HR@5': '0.0615', 'NDCG@5': '0.0398', 'HR@10': '0.0954', 'NDCG@10': '0.0506', 'HR@20': '0.1495', 'NDCG@20': '0.0643'}
2025-02-27 12:27:18,464 - Validation score increased.  Saving model ...
2025-02-27 12:27:26,150 - {'epoch': 32, 'rec_loss': '5.3786'}
2025-02-27 12:27:26,838 - {'Epoch': 32, 'HR@5': '0.0606', 'NDCG@5': '0.0368', 'HR@10': '0.0908', 'NDCG@10': '0.0465', 'HR@20': '0.1459', 'NDCG@20': '0.0604'}
2025-02-27 12:27:26,839 - EarlyStopping counter: 1 out of 10
2025-02-27 12:27:33,979 - {'epoch': 33, 'rec_loss': '5.3604'}
2025-02-27 12:27:34,801 - {'Epoch': 33, 'HR@5': '0.0642', 'NDCG@5': '0.0396', 'HR@10': '0.0890', 'NDCG@10': '0.0475', 'HR@20': '0.1505', 'NDCG@20': '0.0633'}
2025-02-27 12:27:34,802 - EarlyStopping counter: 2 out of 10
2025-02-27 12:27:41,850 - {'epoch': 34, 'rec_loss': '5.3470'}
2025-02-27 12:27:42,587 - {'Epoch': 34, 'HR@5': '0.0633', 'NDCG@5': '0.0401', 'HR@10': '0.0982', 'NDCG@10': '0.0511', 'HR@20': '0.1541', 'NDCG@20': '0.0650'}
2025-02-27 12:27:42,588 - Validation score increased.  Saving model ...
2025-02-27 12:27:49,786 - {'epoch': 35, 'rec_loss': '5.3172'}
2025-02-27 12:27:50,504 - {'Epoch': 35, 'HR@5': '0.0688', 'NDCG@5': '0.0424', 'HR@10': '0.1037', 'NDCG@10': '0.0533', 'HR@20': '0.1486', 'NDCG@20': '0.0647'}
2025-02-27 12:27:50,505 - EarlyStopping counter: 1 out of 10
2025-02-27 12:27:57,191 - {'epoch': 36, 'rec_loss': '5.3147'}
2025-02-27 12:27:57,930 - {'Epoch': 36, 'HR@5': '0.0596', 'NDCG@5': '0.0378', 'HR@10': '0.0936', 'NDCG@10': '0.0487', 'HR@20': '0.1477', 'NDCG@20': '0.0624'}
2025-02-27 12:27:57,931 - EarlyStopping counter: 2 out of 10
2025-02-27 12:28:05,044 - {'epoch': 37, 'rec_loss': '5.3117'}
2025-02-27 12:28:05,784 - {'Epoch': 37, 'HR@5': '0.0569', 'NDCG@5': '0.0369', 'HR@10': '0.0927', 'NDCG@10': '0.0486', 'HR@20': '0.1495', 'NDCG@20': '0.0630'}
2025-02-27 12:28:05,785 - EarlyStopping counter: 3 out of 10
2025-02-27 12:28:12,662 - {'epoch': 38, 'rec_loss': '5.3143'}
2025-02-27 12:28:13,343 - {'Epoch': 38, 'HR@5': '0.0587', 'NDCG@5': '0.0391', 'HR@10': '0.0963', 'NDCG@10': '0.0513', 'HR@20': '0.1477', 'NDCG@20': '0.0644'}
2025-02-27 12:28:13,344 - EarlyStopping counter: 4 out of 10
2025-02-27 12:28:20,386 - {'epoch': 39, 'rec_loss': '5.3102'}
2025-02-27 12:28:21,156 - {'Epoch': 39, 'HR@5': '0.0587', 'NDCG@5': '0.0369', 'HR@10': '0.1009', 'NDCG@10': '0.0504', 'HR@20': '0.1440', 'NDCG@20': '0.0614'}
2025-02-27 12:28:21,157 - EarlyStopping counter: 5 out of 10
2025-02-27 12:28:28,431 - {'epoch': 40, 'rec_loss': '5.2671'}
2025-02-27 12:28:29,178 - {'Epoch': 40, 'HR@5': '0.0624', 'NDCG@5': '0.0399', 'HR@10': '0.1000', 'NDCG@10': '0.0522', 'HR@20': '0.1459', 'NDCG@20': '0.0637'}
2025-02-27 12:28:29,180 - EarlyStopping counter: 6 out of 10
2025-02-27 12:28:36,876 - {'epoch': 41, 'rec_loss': '5.2837'}
2025-02-27 12:28:37,583 - {'Epoch': 41, 'HR@5': '0.0642', 'NDCG@5': '0.0415', 'HR@10': '0.1018', 'NDCG@10': '0.0535', 'HR@20': '0.1422', 'NDCG@20': '0.0638'}
2025-02-27 12:28:37,584 - EarlyStopping counter: 7 out of 10
2025-02-27 12:28:44,955 - {'epoch': 42, 'rec_loss': '5.2834'}
2025-02-27 12:28:45,662 - {'Epoch': 42, 'HR@5': '0.0679', 'NDCG@5': '0.0433', 'HR@10': '0.1018', 'NDCG@10': '0.0541', 'HR@20': '0.1450', 'NDCG@20': '0.0649'}
2025-02-27 12:28:45,663 - EarlyStopping counter: 8 out of 10
2025-02-27 12:28:52,370 - {'epoch': 43, 'rec_loss': '5.2531'}
2025-02-27 12:28:53,076 - {'Epoch': 43, 'HR@5': '0.0624', 'NDCG@5': '0.0401', 'HR@10': '0.0945', 'NDCG@10': '0.0506', 'HR@20': '0.1486', 'NDCG@20': '0.0643'}
2025-02-27 12:28:53,077 - EarlyStopping counter: 9 out of 10
2025-02-27 12:29:00,221 - {'epoch': 44, 'rec_loss': '5.2579'}
2025-02-27 12:29:00,972 - {'Epoch': 44, 'HR@5': '0.0624', 'NDCG@5': '0.0415', 'HR@10': '0.0972', 'NDCG@10': '0.0528', 'HR@20': '0.1450', 'NDCG@20': '0.0648'}
2025-02-27 12:29:00,974 - EarlyStopping counter: 10 out of 10
2025-02-27 12:29:00,974 - Early stopping
2025-02-27 12:29:00,974 - ---------------Test Score---------------
2025-02-27 12:29:01,759 - {'Epoch': 0, 'HR@5': '0.0596', 'NDCG@5': '0.0402', 'HR@10': '0.0761', 'NDCG@10': '0.0455', 'HR@20': '0.1092', 'NDCG@20': '0.0537'}
2025-02-27 12:29:01,760 - Scale_LastFM
2025-02-27 12:29:01,760 - {'Epoch': 0, 'HR@5': '0.0596', 'NDCG@5': '0.0402', 'HR@10': '0.0761', 'NDCG@10': '0.0455', 'HR@20': '0.1092', 'NDCG@20': '0.0537'}
2025-02-27 13:16:55,088 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4, 5], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-02-27 13:16:58,283 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=4, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=4, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-27 13:16:58,290 - Total Parameters: 387354
2025-02-27 13:17:04,506 - {'epoch': 0, 'rec_loss': '8.0366'}
2025-02-27 13:17:05,318 - {'Epoch': 0, 'HR@5': '0.0239', 'NDCG@5': '0.0165', 'HR@10': '0.0349', 'NDCG@10': '0.0199', 'HR@20': '0.0560', 'NDCG@20': '0.0253'}
2025-02-27 13:17:05,320 - Validation score increased.  Saving model ...
2025-02-27 13:17:10,262 - {'epoch': 1, 'rec_loss': '7.7342'}
2025-02-27 13:17:10,981 - {'Epoch': 1, 'HR@5': '0.0193', 'NDCG@5': '0.0120', 'HR@10': '0.0358', 'NDCG@10': '0.0174', 'HR@20': '0.0523', 'NDCG@20': '0.0216'}
2025-02-27 13:17:10,982 - EarlyStopping counter: 1 out of 10
2025-02-27 13:17:15,827 - {'epoch': 2, 'rec_loss': '7.5211'}
2025-02-27 13:17:16,639 - {'Epoch': 2, 'HR@5': '0.0239', 'NDCG@5': '0.0179', 'HR@10': '0.0440', 'NDCG@10': '0.0243', 'HR@20': '0.0642', 'NDCG@20': '0.0294'}
2025-02-27 13:17:16,640 - Validation score increased.  Saving model ...
2025-02-27 13:17:21,714 - {'epoch': 3, 'rec_loss': '7.3054'}
2025-02-27 13:17:22,469 - {'Epoch': 3, 'HR@5': '0.0330', 'NDCG@5': '0.0217', 'HR@10': '0.0505', 'NDCG@10': '0.0272', 'HR@20': '0.0771', 'NDCG@20': '0.0338'}
2025-02-27 13:17:22,470 - Validation score increased.  Saving model ...
2025-02-27 13:17:27,456 - {'epoch': 4, 'rec_loss': '7.0920'}
2025-02-27 13:17:28,264 - {'Epoch': 4, 'HR@5': '0.0312', 'NDCG@5': '0.0227', 'HR@10': '0.0569', 'NDCG@10': '0.0310', 'HR@20': '0.0844', 'NDCG@20': '0.0380'}
2025-02-27 13:17:28,265 - Validation score increased.  Saving model ...
2025-02-27 13:17:33,312 - {'epoch': 5, 'rec_loss': '6.8908'}
2025-02-27 13:17:34,101 - {'Epoch': 5, 'HR@5': '0.0358', 'NDCG@5': '0.0244', 'HR@10': '0.0560', 'NDCG@10': '0.0310', 'HR@20': '0.0908', 'NDCG@20': '0.0397'}
2025-02-27 13:17:34,103 - Validation score increased.  Saving model ...
2025-02-27 13:17:39,007 - {'epoch': 6, 'rec_loss': '6.6934'}
2025-02-27 13:17:39,816 - {'Epoch': 6, 'HR@5': '0.0404', 'NDCG@5': '0.0260', 'HR@10': '0.0596', 'NDCG@10': '0.0322', 'HR@20': '0.0890', 'NDCG@20': '0.0397'}
2025-02-27 13:17:39,817 - Validation score increased.  Saving model ...
2025-02-27 13:17:44,757 - {'epoch': 7, 'rec_loss': '6.5238'}
2025-02-27 13:17:45,561 - {'Epoch': 7, 'HR@5': '0.0431', 'NDCG@5': '0.0278', 'HR@10': '0.0642', 'NDCG@10': '0.0346', 'HR@20': '0.0954', 'NDCG@20': '0.0424'}
2025-02-27 13:17:45,562 - Validation score increased.  Saving model ...
2025-02-27 13:17:50,612 - {'epoch': 8, 'rec_loss': '6.3545'}
2025-02-27 13:17:51,403 - {'Epoch': 8, 'HR@5': '0.0440', 'NDCG@5': '0.0281', 'HR@10': '0.0624', 'NDCG@10': '0.0339', 'HR@20': '0.1028', 'NDCG@20': '0.0441'}
2025-02-27 13:17:51,404 - Validation score increased.  Saving model ...
2025-02-27 13:17:56,491 - {'epoch': 9, 'rec_loss': '6.2374'}
2025-02-27 13:17:57,260 - {'Epoch': 9, 'HR@5': '0.0459', 'NDCG@5': '0.0302', 'HR@10': '0.0688', 'NDCG@10': '0.0374', 'HR@20': '0.1018', 'NDCG@20': '0.0458'}
2025-02-27 13:17:57,261 - Validation score increased.  Saving model ...
2025-02-27 13:18:02,331 - {'epoch': 10, 'rec_loss': '6.1010'}
2025-02-27 13:18:03,118 - {'Epoch': 10, 'HR@5': '0.0468', 'NDCG@5': '0.0325', 'HR@10': '0.0771', 'NDCG@10': '0.0420', 'HR@20': '0.1138', 'NDCG@20': '0.0511'}
2025-02-27 13:18:03,119 - Validation score increased.  Saving model ...
2025-02-27 13:18:08,157 - {'epoch': 11, 'rec_loss': '6.0325'}
2025-02-27 13:18:08,946 - {'Epoch': 11, 'HR@5': '0.0431', 'NDCG@5': '0.0295', 'HR@10': '0.0752', 'NDCG@10': '0.0398', 'HR@20': '0.1156', 'NDCG@20': '0.0499'}
2025-02-27 13:18:08,947 - EarlyStopping counter: 1 out of 10
2025-02-27 13:18:13,955 - {'epoch': 12, 'rec_loss': '5.9519'}
2025-02-27 13:18:14,728 - {'Epoch': 12, 'HR@5': '0.0486', 'NDCG@5': '0.0324', 'HR@10': '0.0780', 'NDCG@10': '0.0419', 'HR@20': '0.1211', 'NDCG@20': '0.0526'}
2025-02-27 13:18:14,729 - Validation score increased.  Saving model ...
2025-02-27 13:18:19,697 - {'epoch': 13, 'rec_loss': '5.8453'}
2025-02-27 13:18:20,537 - {'Epoch': 13, 'HR@5': '0.0541', 'NDCG@5': '0.0347', 'HR@10': '0.0761', 'NDCG@10': '0.0419', 'HR@20': '0.1183', 'NDCG@20': '0.0525'}
2025-02-27 13:18:20,538 - EarlyStopping counter: 1 out of 10
2025-02-27 13:18:25,754 - {'epoch': 14, 'rec_loss': '5.8130'}
2025-02-27 13:18:26,531 - {'Epoch': 14, 'HR@5': '0.0532', 'NDCG@5': '0.0345', 'HR@10': '0.0771', 'NDCG@10': '0.0421', 'HR@20': '0.1211', 'NDCG@20': '0.0533'}
2025-02-27 13:18:26,532 - Validation score increased.  Saving model ...
2025-02-27 13:18:31,462 - {'epoch': 15, 'rec_loss': '5.7439'}
2025-02-27 13:18:32,281 - {'Epoch': 15, 'HR@5': '0.0560', 'NDCG@5': '0.0362', 'HR@10': '0.0817', 'NDCG@10': '0.0442', 'HR@20': '0.1220', 'NDCG@20': '0.0543'}
2025-02-27 13:18:32,283 - Validation score increased.  Saving model ...
2025-02-27 13:18:37,264 - {'epoch': 16, 'rec_loss': '5.7144'}
2025-02-27 13:18:38,033 - {'Epoch': 16, 'HR@5': '0.0532', 'NDCG@5': '0.0346', 'HR@10': '0.0835', 'NDCG@10': '0.0444', 'HR@20': '0.1294', 'NDCG@20': '0.0559'}
2025-02-27 13:18:38,034 - Validation score increased.  Saving model ...
2025-02-27 13:18:42,908 - {'epoch': 17, 'rec_loss': '5.6652'}
2025-02-27 13:18:43,733 - {'Epoch': 17, 'HR@5': '0.0523', 'NDCG@5': '0.0350', 'HR@10': '0.0835', 'NDCG@10': '0.0452', 'HR@20': '0.1303', 'NDCG@20': '0.0568'}
2025-02-27 13:18:43,735 - Validation score increased.  Saving model ...
2025-02-27 13:18:48,690 - {'epoch': 18, 'rec_loss': '5.6161'}
2025-02-27 13:18:49,458 - {'Epoch': 18, 'HR@5': '0.0523', 'NDCG@5': '0.0342', 'HR@10': '0.0899', 'NDCG@10': '0.0463', 'HR@20': '0.1339', 'NDCG@20': '0.0575'}
2025-02-27 13:18:49,460 - Validation score increased.  Saving model ...
2025-02-27 13:18:54,357 - {'epoch': 19, 'rec_loss': '5.6093'}
2025-02-27 13:18:55,121 - {'Epoch': 19, 'HR@5': '0.0606', 'NDCG@5': '0.0395', 'HR@10': '0.0954', 'NDCG@10': '0.0508', 'HR@20': '0.1330', 'NDCG@20': '0.0602'}
2025-02-27 13:18:55,122 - Validation score increased.  Saving model ...
2025-02-27 13:19:00,129 - {'epoch': 20, 'rec_loss': '5.5733'}
2025-02-27 13:19:00,906 - {'Epoch': 20, 'HR@5': '0.0514', 'NDCG@5': '0.0339', 'HR@10': '0.0899', 'NDCG@10': '0.0461', 'HR@20': '0.1349', 'NDCG@20': '0.0575'}
2025-02-27 13:19:00,908 - EarlyStopping counter: 1 out of 10
2025-02-27 13:19:05,956 - {'epoch': 21, 'rec_loss': '5.5225'}
2025-02-27 13:19:06,755 - {'Epoch': 21, 'HR@5': '0.0596', 'NDCG@5': '0.0387', 'HR@10': '0.0936', 'NDCG@10': '0.0495', 'HR@20': '0.1459', 'NDCG@20': '0.0627'}
2025-02-27 13:19:06,757 - Validation score increased.  Saving model ...
2025-02-27 13:19:11,810 - {'epoch': 22, 'rec_loss': '5.5206'}
2025-02-27 13:19:12,591 - {'Epoch': 22, 'HR@5': '0.0550', 'NDCG@5': '0.0374', 'HR@10': '0.0917', 'NDCG@10': '0.0491', 'HR@20': '0.1385', 'NDCG@20': '0.0608'}
2025-02-27 13:19:12,593 - EarlyStopping counter: 1 out of 10
2025-02-27 13:19:17,643 - {'epoch': 23, 'rec_loss': '5.5161'}
2025-02-27 13:19:18,420 - {'Epoch': 23, 'HR@5': '0.0560', 'NDCG@5': '0.0362', 'HR@10': '0.0881', 'NDCG@10': '0.0465', 'HR@20': '0.1385', 'NDCG@20': '0.0592'}
2025-02-27 13:19:18,422 - EarlyStopping counter: 2 out of 10
2025-02-27 13:19:23,433 - {'epoch': 24, 'rec_loss': '5.4816'}
2025-02-27 13:19:24,179 - {'Epoch': 24, 'HR@5': '0.0569', 'NDCG@5': '0.0369', 'HR@10': '0.0908', 'NDCG@10': '0.0480', 'HR@20': '0.1404', 'NDCG@20': '0.0605'}
2025-02-27 13:19:24,181 - EarlyStopping counter: 3 out of 10
2025-02-27 13:19:29,161 - {'epoch': 25, 'rec_loss': '5.4619'}
2025-02-27 13:19:29,983 - {'Epoch': 25, 'HR@5': '0.0560', 'NDCG@5': '0.0353', 'HR@10': '0.0881', 'NDCG@10': '0.0456', 'HR@20': '0.1339', 'NDCG@20': '0.0573'}
2025-02-27 13:19:29,985 - EarlyStopping counter: 4 out of 10
2025-02-27 13:19:35,038 - {'epoch': 26, 'rec_loss': '5.4626'}
2025-02-27 13:19:35,827 - {'Epoch': 26, 'HR@5': '0.0550', 'NDCG@5': '0.0358', 'HR@10': '0.0862', 'NDCG@10': '0.0458', 'HR@20': '0.1404', 'NDCG@20': '0.0596'}
2025-02-27 13:19:35,828 - EarlyStopping counter: 5 out of 10
2025-02-27 13:19:40,754 - {'epoch': 27, 'rec_loss': '5.4266'}
2025-02-27 13:19:41,559 - {'Epoch': 27, 'HR@5': '0.0578', 'NDCG@5': '0.0359', 'HR@10': '0.0972', 'NDCG@10': '0.0484', 'HR@20': '0.1431', 'NDCG@20': '0.0599'}
2025-02-27 13:19:41,560 - EarlyStopping counter: 6 out of 10
2025-02-27 13:19:46,659 - {'epoch': 28, 'rec_loss': '5.4182'}
2025-02-27 13:19:47,413 - {'Epoch': 28, 'HR@5': '0.0615', 'NDCG@5': '0.0397', 'HR@10': '0.0908', 'NDCG@10': '0.0493', 'HR@20': '0.1440', 'NDCG@20': '0.0627'}
2025-02-27 13:19:47,414 - Validation score increased.  Saving model ...
2025-02-27 13:19:52,351 - {'epoch': 29, 'rec_loss': '5.4017'}
2025-02-27 13:19:53,202 - {'Epoch': 29, 'HR@5': '0.0514', 'NDCG@5': '0.0340', 'HR@10': '0.0936', 'NDCG@10': '0.0477', 'HR@20': '0.1468', 'NDCG@20': '0.0611'}
2025-02-27 13:19:53,204 - EarlyStopping counter: 1 out of 10
2025-02-27 13:19:58,331 - {'epoch': 30, 'rec_loss': '5.3943'}
2025-02-27 13:19:59,127 - {'Epoch': 30, 'HR@5': '0.0587', 'NDCG@5': '0.0385', 'HR@10': '0.0954', 'NDCG@10': '0.0500', 'HR@20': '0.1413', 'NDCG@20': '0.0615'}
2025-02-27 13:19:59,128 - EarlyStopping counter: 2 out of 10
2025-02-27 13:20:04,003 - {'epoch': 31, 'rec_loss': '5.3926'}
2025-02-27 13:20:04,807 - {'Epoch': 31, 'HR@5': '0.0569', 'NDCG@5': '0.0360', 'HR@10': '0.0991', 'NDCG@10': '0.0496', 'HR@20': '0.1514', 'NDCG@20': '0.0628'}
2025-02-27 13:20:04,808 - Validation score increased.  Saving model ...
2025-02-27 13:20:09,862 - {'epoch': 32, 'rec_loss': '5.3710'}
2025-02-27 13:20:10,695 - {'Epoch': 32, 'HR@5': '0.0560', 'NDCG@5': '0.0359', 'HR@10': '0.0917', 'NDCG@10': '0.0476', 'HR@20': '0.1468', 'NDCG@20': '0.0615'}
2025-02-27 13:20:10,696 - EarlyStopping counter: 1 out of 10
2025-02-27 13:20:15,662 - {'epoch': 33, 'rec_loss': '5.3509'}
2025-02-27 13:20:16,451 - {'Epoch': 33, 'HR@5': '0.0606', 'NDCG@5': '0.0381', 'HR@10': '0.0972', 'NDCG@10': '0.0499', 'HR@20': '0.1495', 'NDCG@20': '0.0630'}
2025-02-27 13:20:16,453 - Validation score increased.  Saving model ...
2025-02-27 13:20:21,470 - {'epoch': 34, 'rec_loss': '5.3575'}
2025-02-27 13:20:22,253 - {'Epoch': 34, 'HR@5': '0.0606', 'NDCG@5': '0.0374', 'HR@10': '0.0908', 'NDCG@10': '0.0472', 'HR@20': '0.1459', 'NDCG@20': '0.0611'}
2025-02-27 13:20:22,254 - EarlyStopping counter: 1 out of 10
2025-02-27 13:20:27,239 - {'epoch': 35, 'rec_loss': '5.3261'}
2025-02-27 13:20:28,040 - {'Epoch': 35, 'HR@5': '0.0560', 'NDCG@5': '0.0363', 'HR@10': '0.0927', 'NDCG@10': '0.0478', 'HR@20': '0.1413', 'NDCG@20': '0.0601'}
2025-02-27 13:20:28,041 - EarlyStopping counter: 2 out of 10
2025-02-27 13:20:33,189 - {'epoch': 36, 'rec_loss': '5.3233'}
2025-02-27 13:20:33,974 - {'Epoch': 36, 'HR@5': '0.0606', 'NDCG@5': '0.0373', 'HR@10': '0.0991', 'NDCG@10': '0.0495', 'HR@20': '0.1413', 'NDCG@20': '0.0601'}
2025-02-27 13:20:33,975 - EarlyStopping counter: 3 out of 10
2025-02-27 13:20:39,010 - {'epoch': 37, 'rec_loss': '5.3103'}
2025-02-27 13:20:39,781 - {'Epoch': 37, 'HR@5': '0.0569', 'NDCG@5': '0.0369', 'HR@10': '0.0908', 'NDCG@10': '0.0478', 'HR@20': '0.1459', 'NDCG@20': '0.0618'}
2025-02-27 13:20:39,783 - EarlyStopping counter: 4 out of 10
2025-02-27 13:20:44,846 - {'epoch': 38, 'rec_loss': '5.3021'}
2025-02-27 13:20:45,644 - {'Epoch': 38, 'HR@5': '0.0505', 'NDCG@5': '0.0338', 'HR@10': '0.0881', 'NDCG@10': '0.0461', 'HR@20': '0.1450', 'NDCG@20': '0.0605'}
2025-02-27 13:20:45,645 - EarlyStopping counter: 5 out of 10
2025-02-27 13:20:50,573 - {'epoch': 39, 'rec_loss': '5.3087'}
2025-02-27 13:20:51,332 - {'Epoch': 39, 'HR@5': '0.0615', 'NDCG@5': '0.0388', 'HR@10': '0.0917', 'NDCG@10': '0.0485', 'HR@20': '0.1422', 'NDCG@20': '0.0614'}
2025-02-27 13:20:51,333 - EarlyStopping counter: 6 out of 10
2025-02-27 13:20:56,555 - {'epoch': 40, 'rec_loss': '5.2759'}
2025-02-27 13:20:57,342 - {'Epoch': 40, 'HR@5': '0.0569', 'NDCG@5': '0.0366', 'HR@10': '0.0945', 'NDCG@10': '0.0488', 'HR@20': '0.1514', 'NDCG@20': '0.0632'}
2025-02-27 13:20:57,343 - Validation score increased.  Saving model ...
2025-02-27 13:21:02,308 - {'epoch': 41, 'rec_loss': '5.2866'}
2025-02-27 13:21:03,053 - {'Epoch': 41, 'HR@5': '0.0587', 'NDCG@5': '0.0372', 'HR@10': '0.0954', 'NDCG@10': '0.0491', 'HR@20': '0.1486', 'NDCG@20': '0.0626'}
2025-02-27 13:21:03,054 - EarlyStopping counter: 1 out of 10
2025-02-27 13:21:07,948 - {'epoch': 42, 'rec_loss': '5.2649'}
2025-02-27 13:21:08,723 - {'Epoch': 42, 'HR@5': '0.0615', 'NDCG@5': '0.0392', 'HR@10': '0.0991', 'NDCG@10': '0.0514', 'HR@20': '0.1477', 'NDCG@20': '0.0635'}
2025-02-27 13:21:08,724 - Validation score increased.  Saving model ...
2025-02-27 13:21:13,629 - {'epoch': 43, 'rec_loss': '5.2551'}
2025-02-27 13:21:14,430 - {'Epoch': 43, 'HR@5': '0.0578', 'NDCG@5': '0.0377', 'HR@10': '0.0982', 'NDCG@10': '0.0504', 'HR@20': '0.1541', 'NDCG@20': '0.0645'}
2025-02-27 13:21:14,431 - Validation score increased.  Saving model ...
2025-02-27 13:21:19,276 - {'epoch': 44, 'rec_loss': '5.2531'}
2025-02-27 13:21:20,042 - {'Epoch': 44, 'HR@5': '0.0642', 'NDCG@5': '0.0425', 'HR@10': '0.1000', 'NDCG@10': '0.0539', 'HR@20': '0.1495', 'NDCG@20': '0.0665'}
2025-02-27 13:21:20,043 - Validation score increased.  Saving model ...
2025-02-27 13:21:25,118 - {'epoch': 45, 'rec_loss': '5.2627'}
2025-02-27 13:21:25,959 - {'Epoch': 45, 'HR@5': '0.0624', 'NDCG@5': '0.0394', 'HR@10': '0.0982', 'NDCG@10': '0.0509', 'HR@20': '0.1505', 'NDCG@20': '0.0639'}
2025-02-27 13:21:25,960 - EarlyStopping counter: 1 out of 10
2025-02-27 13:21:30,980 - {'epoch': 46, 'rec_loss': '5.2331'}
2025-02-27 13:21:31,791 - {'Epoch': 46, 'HR@5': '0.0587', 'NDCG@5': '0.0380', 'HR@10': '0.1009', 'NDCG@10': '0.0517', 'HR@20': '0.1495', 'NDCG@20': '0.0639'}
2025-02-27 13:21:31,793 - EarlyStopping counter: 2 out of 10
2025-02-27 13:21:36,751 - {'epoch': 47, 'rec_loss': '5.2437'}
2025-02-27 13:21:37,529 - {'Epoch': 47, 'HR@5': '0.0642', 'NDCG@5': '0.0404', 'HR@10': '0.1037', 'NDCG@10': '0.0532', 'HR@20': '0.1532', 'NDCG@20': '0.0656'}
2025-02-27 13:21:37,531 - EarlyStopping counter: 3 out of 10
2025-02-27 13:21:42,412 - {'epoch': 48, 'rec_loss': '5.2300'}
2025-02-27 13:21:43,184 - {'Epoch': 48, 'HR@5': '0.0596', 'NDCG@5': '0.0386', 'HR@10': '0.1028', 'NDCG@10': '0.0524', 'HR@20': '0.1514', 'NDCG@20': '0.0646'}
2025-02-27 13:21:43,185 - EarlyStopping counter: 4 out of 10
2025-02-27 13:21:48,156 - {'epoch': 49, 'rec_loss': '5.2341'}
2025-02-27 13:21:48,971 - {'Epoch': 49, 'HR@5': '0.0661', 'NDCG@5': '0.0419', 'HR@10': '0.1073', 'NDCG@10': '0.0554', 'HR@20': '0.1486', 'NDCG@20': '0.0656'}
2025-02-27 13:21:48,972 - EarlyStopping counter: 5 out of 10
2025-02-27 13:21:54,383 - {'epoch': 50, 'rec_loss': '5.2197'}
2025-02-27 13:21:55,165 - {'Epoch': 50, 'HR@5': '0.0642', 'NDCG@5': '0.0394', 'HR@10': '0.1037', 'NDCG@10': '0.0522', 'HR@20': '0.1495', 'NDCG@20': '0.0638'}
2025-02-27 13:21:55,166 - EarlyStopping counter: 6 out of 10
2025-02-27 13:22:00,063 - {'epoch': 51, 'rec_loss': '5.2061'}
2025-02-27 13:22:00,786 - {'Epoch': 51, 'HR@5': '0.0615', 'NDCG@5': '0.0386', 'HR@10': '0.1037', 'NDCG@10': '0.0521', 'HR@20': '0.1532', 'NDCG@20': '0.0645'}
2025-02-27 13:22:00,787 - EarlyStopping counter: 7 out of 10
2025-02-27 13:22:05,754 - {'epoch': 52, 'rec_loss': '5.1901'}
2025-02-27 13:22:06,539 - {'Epoch': 52, 'HR@5': '0.0624', 'NDCG@5': '0.0374', 'HR@10': '0.0991', 'NDCG@10': '0.0492', 'HR@20': '0.1505', 'NDCG@20': '0.0620'}
2025-02-27 13:22:06,540 - EarlyStopping counter: 8 out of 10
2025-02-27 13:22:11,461 - {'epoch': 53, 'rec_loss': '5.1965'}
2025-02-27 13:22:12,217 - {'Epoch': 53, 'HR@5': '0.0596', 'NDCG@5': '0.0371', 'HR@10': '0.1037', 'NDCG@10': '0.0514', 'HR@20': '0.1450', 'NDCG@20': '0.0616'}
2025-02-27 13:22:12,218 - EarlyStopping counter: 9 out of 10
2025-02-27 13:22:17,116 - {'epoch': 54, 'rec_loss': '5.2011'}
2025-02-27 13:22:17,910 - {'Epoch': 54, 'HR@5': '0.0633', 'NDCG@5': '0.0406', 'HR@10': '0.0982', 'NDCG@10': '0.0518', 'HR@20': '0.1541', 'NDCG@20': '0.0657'}
2025-02-27 13:22:17,911 - EarlyStopping counter: 10 out of 10
2025-02-27 13:22:17,911 - Early stopping
2025-02-27 13:22:17,911 - ---------------Test Score---------------
2025-02-27 13:22:18,720 - {'Epoch': 0, 'HR@5': '0.0532', 'NDCG@5': '0.0354', 'HR@10': '0.0771', 'NDCG@10': '0.0430', 'HR@20': '0.1009', 'NDCG@20': '0.0491'}
2025-02-27 13:22:18,721 - Scale_LastFM
2025-02-27 13:22:18,721 - {'Epoch': 0, 'HR@5': '0.0532', 'NDCG@5': '0.0354', 'HR@10': '0.0771', 'NDCG@10': '0.0430', 'HR@20': '0.1009', 'NDCG@20': '0.0491'}
2025-03-02 16:30:38,927 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[4, 8, 24], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-03-02 16:30:41,793 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-02 16:30:41,797 - Total Parameters: 387350
2025-03-02 16:30:48,406 - {'epoch': 0, 'rec_loss': '8.0388'}
2025-03-02 16:30:49,180 - {'Epoch': 0, 'HR@5': '0.0202', 'NDCG@5': '0.0143', 'HR@10': '0.0358', 'NDCG@10': '0.0194', 'HR@20': '0.0642', 'NDCG@20': '0.0264'}
2025-03-02 16:30:49,181 - Validation score increased.  Saving model ...
2025-03-02 16:30:54,625 - {'epoch': 1, 'rec_loss': '7.7565'}
2025-03-02 16:30:55,384 - {'Epoch': 1, 'HR@5': '0.0220', 'NDCG@5': '0.0149', 'HR@10': '0.0349', 'NDCG@10': '0.0191', 'HR@20': '0.0633', 'NDCG@20': '0.0263'}
2025-03-02 16:30:55,385 - EarlyStopping counter: 1 out of 10
2025-03-02 16:31:00,412 - {'epoch': 2, 'rec_loss': '7.5487'}
2025-03-02 16:31:01,102 - {'Epoch': 2, 'HR@5': '0.0303', 'NDCG@5': '0.0205', 'HR@10': '0.0486', 'NDCG@10': '0.0263', 'HR@20': '0.0706', 'NDCG@20': '0.0318'}
2025-03-02 16:31:01,103 - Validation score increased.  Saving model ...
2025-03-02 16:31:06,956 - {'epoch': 3, 'rec_loss': '7.3251'}
2025-03-02 16:31:07,664 - {'Epoch': 3, 'HR@5': '0.0330', 'NDCG@5': '0.0220', 'HR@10': '0.0468', 'NDCG@10': '0.0263', 'HR@20': '0.0716', 'NDCG@20': '0.0325'}
2025-03-02 16:31:07,665 - Validation score increased.  Saving model ...
2025-03-02 16:31:13,443 - {'epoch': 4, 'rec_loss': '7.1155'}
2025-03-02 16:31:14,182 - {'Epoch': 4, 'HR@5': '0.0367', 'NDCG@5': '0.0243', 'HR@10': '0.0560', 'NDCG@10': '0.0304', 'HR@20': '0.0862', 'NDCG@20': '0.0382'}
2025-03-02 16:31:14,183 - Validation score increased.  Saving model ...
2025-03-02 16:31:19,408 - {'epoch': 5, 'rec_loss': '6.9078'}
2025-03-02 16:31:20,168 - {'Epoch': 5, 'HR@5': '0.0367', 'NDCG@5': '0.0246', 'HR@10': '0.0550', 'NDCG@10': '0.0307', 'HR@20': '0.0927', 'NDCG@20': '0.0400'}
2025-03-02 16:31:20,169 - Validation score increased.  Saving model ...
2025-03-02 16:31:26,383 - {'epoch': 6, 'rec_loss': '6.7116'}
2025-03-02 16:31:27,147 - {'Epoch': 6, 'HR@5': '0.0450', 'NDCG@5': '0.0254', 'HR@10': '0.0642', 'NDCG@10': '0.0317', 'HR@20': '0.0954', 'NDCG@20': '0.0395'}
2025-03-02 16:31:27,148 - EarlyStopping counter: 1 out of 10
2025-03-02 16:31:32,756 - {'epoch': 7, 'rec_loss': '6.5332'}
2025-03-02 16:31:33,508 - {'Epoch': 7, 'HR@5': '0.0422', 'NDCG@5': '0.0264', 'HR@10': '0.0679', 'NDCG@10': '0.0346', 'HR@20': '0.1000', 'NDCG@20': '0.0426'}
2025-03-02 16:31:33,509 - Validation score increased.  Saving model ...
2025-03-02 16:31:38,850 - {'epoch': 8, 'rec_loss': '6.3697'}
2025-03-02 16:31:39,600 - {'Epoch': 8, 'HR@5': '0.0422', 'NDCG@5': '0.0267', 'HR@10': '0.0697', 'NDCG@10': '0.0355', 'HR@20': '0.1101', 'NDCG@20': '0.0456'}
2025-03-02 16:31:39,601 - Validation score increased.  Saving model ...
2025-03-02 16:31:44,684 - {'epoch': 9, 'rec_loss': '6.2549'}
2025-03-02 16:31:45,472 - {'Epoch': 9, 'HR@5': '0.0495', 'NDCG@5': '0.0301', 'HR@10': '0.0780', 'NDCG@10': '0.0390', 'HR@20': '0.1156', 'NDCG@20': '0.0484'}
2025-03-02 16:31:45,473 - Validation score increased.  Saving model ...
2025-03-02 16:31:50,876 - {'epoch': 10, 'rec_loss': '6.1151'}
2025-03-02 16:31:51,658 - {'Epoch': 10, 'HR@5': '0.0459', 'NDCG@5': '0.0297', 'HR@10': '0.0725', 'NDCG@10': '0.0383', 'HR@20': '0.1128', 'NDCG@20': '0.0484'}
2025-03-02 16:31:51,659 - EarlyStopping counter: 1 out of 10
2025-03-02 16:31:57,414 - {'epoch': 11, 'rec_loss': '6.0432'}
2025-03-02 16:31:58,236 - {'Epoch': 11, 'HR@5': '0.0468', 'NDCG@5': '0.0306', 'HR@10': '0.0716', 'NDCG@10': '0.0384', 'HR@20': '0.1193', 'NDCG@20': '0.0504'}
2025-03-02 16:31:58,237 - Validation score increased.  Saving model ...
2025-03-02 16:32:04,345 - {'epoch': 12, 'rec_loss': '5.9544'}
2025-03-02 16:32:05,086 - {'Epoch': 12, 'HR@5': '0.0422', 'NDCG@5': '0.0288', 'HR@10': '0.0734', 'NDCG@10': '0.0389', 'HR@20': '0.1239', 'NDCG@20': '0.0518'}
2025-03-02 16:32:05,088 - Validation score increased.  Saving model ...
2025-03-02 16:32:10,163 - {'epoch': 13, 'rec_loss': '5.8730'}
2025-03-02 16:32:10,949 - {'Epoch': 13, 'HR@5': '0.0431', 'NDCG@5': '0.0297', 'HR@10': '0.0798', 'NDCG@10': '0.0412', 'HR@20': '0.1239', 'NDCG@20': '0.0524'}
2025-03-02 16:32:10,950 - Validation score increased.  Saving model ...
2025-03-02 16:32:16,346 - {'epoch': 14, 'rec_loss': '5.8044'}
2025-03-02 16:32:17,118 - {'Epoch': 14, 'HR@5': '0.0450', 'NDCG@5': '0.0302', 'HR@10': '0.0817', 'NDCG@10': '0.0419', 'HR@20': '0.1239', 'NDCG@20': '0.0525'}
2025-03-02 16:32:17,119 - Validation score increased.  Saving model ...
2025-03-02 16:32:22,661 - {'epoch': 15, 'rec_loss': '5.7623'}
2025-03-02 16:32:23,551 - {'Epoch': 15, 'HR@5': '0.0523', 'NDCG@5': '0.0343', 'HR@10': '0.0807', 'NDCG@10': '0.0435', 'HR@20': '0.1239', 'NDCG@20': '0.0543'}
2025-03-02 16:32:23,552 - Validation score increased.  Saving model ...
2025-03-02 16:32:28,732 - {'epoch': 16, 'rec_loss': '5.7291'}
2025-03-02 16:32:29,544 - {'Epoch': 16, 'HR@5': '0.0495', 'NDCG@5': '0.0335', 'HR@10': '0.0725', 'NDCG@10': '0.0410', 'HR@20': '0.1239', 'NDCG@20': '0.0540'}
2025-03-02 16:32:29,545 - EarlyStopping counter: 1 out of 10
2025-03-02 16:32:34,673 - {'epoch': 17, 'rec_loss': '5.6803'}
2025-03-02 16:32:35,536 - {'Epoch': 17, 'HR@5': '0.0505', 'NDCG@5': '0.0326', 'HR@10': '0.0807', 'NDCG@10': '0.0424', 'HR@20': '0.1330', 'NDCG@20': '0.0555'}
2025-03-02 16:32:35,538 - Validation score increased.  Saving model ...
2025-03-02 16:32:41,208 - {'epoch': 18, 'rec_loss': '5.6300'}
2025-03-02 16:32:42,016 - {'Epoch': 18, 'HR@5': '0.0505', 'NDCG@5': '0.0315', 'HR@10': '0.0835', 'NDCG@10': '0.0419', 'HR@20': '0.1367', 'NDCG@20': '0.0552'}
2025-03-02 16:32:42,018 - EarlyStopping counter: 1 out of 10
2025-03-02 16:32:47,652 - {'epoch': 19, 'rec_loss': '5.5959'}
2025-03-02 16:32:48,427 - {'Epoch': 19, 'HR@5': '0.0541', 'NDCG@5': '0.0326', 'HR@10': '0.0881', 'NDCG@10': '0.0437', 'HR@20': '0.1358', 'NDCG@20': '0.0556'}
2025-03-02 16:32:48,428 - Validation score increased.  Saving model ...
2025-03-02 16:32:53,838 - {'epoch': 20, 'rec_loss': '5.5796'}
2025-03-02 16:32:54,654 - {'Epoch': 20, 'HR@5': '0.0468', 'NDCG@5': '0.0315', 'HR@10': '0.0789', 'NDCG@10': '0.0420', 'HR@20': '0.1385', 'NDCG@20': '0.0571'}
2025-03-02 16:32:54,656 - Validation score increased.  Saving model ...
2025-03-02 16:33:00,054 - {'epoch': 21, 'rec_loss': '5.5412'}
2025-03-02 16:33:00,823 - {'Epoch': 21, 'HR@5': '0.0550', 'NDCG@5': '0.0357', 'HR@10': '0.0881', 'NDCG@10': '0.0461', 'HR@20': '0.1339', 'NDCG@20': '0.0578'}
2025-03-02 16:33:00,824 - Validation score increased.  Saving model ...
2025-03-02 16:33:05,959 - {'epoch': 22, 'rec_loss': '5.5325'}
2025-03-02 16:33:06,786 - {'Epoch': 22, 'HR@5': '0.0578', 'NDCG@5': '0.0366', 'HR@10': '0.0844', 'NDCG@10': '0.0450', 'HR@20': '0.1349', 'NDCG@20': '0.0578'}
2025-03-02 16:33:06,788 - Validation score increased.  Saving model ...
2025-03-02 16:33:12,069 - {'epoch': 23, 'rec_loss': '5.5239'}
2025-03-02 16:33:12,855 - {'Epoch': 23, 'HR@5': '0.0514', 'NDCG@5': '0.0341', 'HR@10': '0.0899', 'NDCG@10': '0.0466', 'HR@20': '0.1413', 'NDCG@20': '0.0597'}
2025-03-02 16:33:12,856 - Validation score increased.  Saving model ...
2025-03-02 16:33:18,460 - {'epoch': 24, 'rec_loss': '5.4854'}
2025-03-02 16:33:19,342 - {'Epoch': 24, 'HR@5': '0.0550', 'NDCG@5': '0.0362', 'HR@10': '0.0908', 'NDCG@10': '0.0477', 'HR@20': '0.1367', 'NDCG@20': '0.0593'}
2025-03-02 16:33:19,344 - EarlyStopping counter: 1 out of 10
2025-03-02 16:33:24,850 - {'epoch': 25, 'rec_loss': '5.4547'}
2025-03-02 16:33:25,598 - {'Epoch': 25, 'HR@5': '0.0560', 'NDCG@5': '0.0354', 'HR@10': '0.0862', 'NDCG@10': '0.0450', 'HR@20': '0.1413', 'NDCG@20': '0.0591'}
2025-03-02 16:33:25,599 - EarlyStopping counter: 2 out of 10
2025-03-02 16:33:31,544 - {'epoch': 26, 'rec_loss': '5.4580'}
2025-03-02 16:33:32,393 - {'Epoch': 26, 'HR@5': '0.0541', 'NDCG@5': '0.0352', 'HR@10': '0.0890', 'NDCG@10': '0.0464', 'HR@20': '0.1431', 'NDCG@20': '0.0599'}
2025-03-02 16:33:32,394 - Validation score increased.  Saving model ...
2025-03-02 16:33:38,451 - {'epoch': 27, 'rec_loss': '5.4440'}
2025-03-02 16:33:39,326 - {'Epoch': 27, 'HR@5': '0.0541', 'NDCG@5': '0.0367', 'HR@10': '0.0899', 'NDCG@10': '0.0481', 'HR@20': '0.1376', 'NDCG@20': '0.0602'}
2025-03-02 16:33:39,327 - Validation score increased.  Saving model ...
2025-03-02 16:33:44,337 - {'epoch': 28, 'rec_loss': '5.4247'}
2025-03-02 16:33:45,155 - {'Epoch': 28, 'HR@5': '0.0596', 'NDCG@5': '0.0381', 'HR@10': '0.0881', 'NDCG@10': '0.0472', 'HR@20': '0.1422', 'NDCG@20': '0.0609'}
2025-03-02 16:33:45,156 - Validation score increased.  Saving model ...
2025-03-02 16:33:50,653 - {'epoch': 29, 'rec_loss': '5.4111'}
2025-03-02 16:33:51,668 - {'Epoch': 29, 'HR@5': '0.0569', 'NDCG@5': '0.0378', 'HR@10': '0.0881', 'NDCG@10': '0.0478', 'HR@20': '0.1413', 'NDCG@20': '0.0612'}
2025-03-02 16:33:51,669 - Validation score increased.  Saving model ...
2025-03-02 16:33:56,943 - {'epoch': 30, 'rec_loss': '5.4014'}
2025-03-02 16:33:57,854 - {'Epoch': 30, 'HR@5': '0.0541', 'NDCG@5': '0.0369', 'HR@10': '0.0862', 'NDCG@10': '0.0472', 'HR@20': '0.1413', 'NDCG@20': '0.0611'}
2025-03-02 16:33:57,855 - EarlyStopping counter: 1 out of 10
2025-03-02 16:34:03,007 - {'epoch': 31, 'rec_loss': '5.3948'}
2025-03-02 16:34:03,835 - {'Epoch': 31, 'HR@5': '0.0606', 'NDCG@5': '0.0387', 'HR@10': '0.0982', 'NDCG@10': '0.0507', 'HR@20': '0.1450', 'NDCG@20': '0.0624'}
2025-03-02 16:34:03,836 - Validation score increased.  Saving model ...
2025-03-02 16:34:09,368 - {'epoch': 32, 'rec_loss': '5.3834'}
2025-03-02 16:34:10,334 - {'Epoch': 32, 'HR@5': '0.0606', 'NDCG@5': '0.0371', 'HR@10': '0.0890', 'NDCG@10': '0.0461', 'HR@20': '0.1431', 'NDCG@20': '0.0599'}
2025-03-02 16:34:10,335 - EarlyStopping counter: 1 out of 10
2025-03-02 16:34:15,816 - {'epoch': 33, 'rec_loss': '5.3622'}
2025-03-02 16:34:16,588 - {'Epoch': 33, 'HR@5': '0.0642', 'NDCG@5': '0.0397', 'HR@10': '0.0936', 'NDCG@10': '0.0491', 'HR@20': '0.1440', 'NDCG@20': '0.0620'}
2025-03-02 16:34:16,589 - EarlyStopping counter: 2 out of 10
2025-03-02 16:34:21,892 - {'epoch': 34, 'rec_loss': '5.3515'}
2025-03-02 16:34:22,744 - {'Epoch': 34, 'HR@5': '0.0651', 'NDCG@5': '0.0400', 'HR@10': '0.0991', 'NDCG@10': '0.0507', 'HR@20': '0.1486', 'NDCG@20': '0.0630'}
2025-03-02 16:34:22,745 - Validation score increased.  Saving model ...
2025-03-02 16:34:27,890 - {'epoch': 35, 'rec_loss': '5.3211'}
2025-03-02 16:34:28,698 - {'Epoch': 35, 'HR@5': '0.0670', 'NDCG@5': '0.0415', 'HR@10': '0.1009', 'NDCG@10': '0.0522', 'HR@20': '0.1459', 'NDCG@20': '0.0635'}
2025-03-02 16:34:28,699 - Validation score increased.  Saving model ...
2025-03-02 16:34:33,809 - {'epoch': 36, 'rec_loss': '5.3191'}
2025-03-02 16:34:34,587 - {'Epoch': 36, 'HR@5': '0.0642', 'NDCG@5': '0.0391', 'HR@10': '0.0908', 'NDCG@10': '0.0476', 'HR@20': '0.1495', 'NDCG@20': '0.0625'}
2025-03-02 16:34:34,589 - EarlyStopping counter: 1 out of 10
2025-03-02 16:34:40,001 - {'epoch': 37, 'rec_loss': '5.3165'}
2025-03-02 16:34:40,802 - {'Epoch': 37, 'HR@5': '0.0587', 'NDCG@5': '0.0372', 'HR@10': '0.0908', 'NDCG@10': '0.0477', 'HR@20': '0.1486', 'NDCG@20': '0.0623'}
2025-03-02 16:34:40,803 - EarlyStopping counter: 2 out of 10
2025-03-02 16:34:46,120 - {'epoch': 38, 'rec_loss': '5.3211'}
2025-03-02 16:34:46,945 - {'Epoch': 38, 'HR@5': '0.0606', 'NDCG@5': '0.0400', 'HR@10': '0.0890', 'NDCG@10': '0.0493', 'HR@20': '0.1468', 'NDCG@20': '0.0641'}
2025-03-02 16:34:46,946 - Validation score increased.  Saving model ...
2025-03-02 16:34:52,148 - {'epoch': 39, 'rec_loss': '5.3137'}
2025-03-02 16:34:52,910 - {'Epoch': 39, 'HR@5': '0.0587', 'NDCG@5': '0.0370', 'HR@10': '0.0982', 'NDCG@10': '0.0497', 'HR@20': '0.1440', 'NDCG@20': '0.0614'}
2025-03-02 16:34:52,911 - EarlyStopping counter: 1 out of 10
2025-03-02 16:34:58,318 - {'epoch': 40, 'rec_loss': '5.2717'}
2025-03-02 16:34:59,123 - {'Epoch': 40, 'HR@5': '0.0615', 'NDCG@5': '0.0394', 'HR@10': '0.0982', 'NDCG@10': '0.0513', 'HR@20': '0.1459', 'NDCG@20': '0.0633'}
2025-03-02 16:34:59,124 - EarlyStopping counter: 2 out of 10
2025-03-02 16:35:04,195 - {'epoch': 41, 'rec_loss': '5.2875'}
2025-03-02 16:35:05,028 - {'Epoch': 41, 'HR@5': '0.0624', 'NDCG@5': '0.0415', 'HR@10': '0.0963', 'NDCG@10': '0.0525', 'HR@20': '0.1431', 'NDCG@20': '0.0643'}
2025-03-02 16:35:05,030 - Validation score increased.  Saving model ...
2025-03-02 16:35:10,175 - {'epoch': 42, 'rec_loss': '5.2878'}
2025-03-02 16:35:10,965 - {'Epoch': 42, 'HR@5': '0.0688', 'NDCG@5': '0.0438', 'HR@10': '0.0954', 'NDCG@10': '0.0524', 'HR@20': '0.1394', 'NDCG@20': '0.0635'}
2025-03-02 16:35:10,966 - EarlyStopping counter: 1 out of 10
2025-03-02 16:35:16,045 - {'epoch': 43, 'rec_loss': '5.2555'}
2025-03-02 16:35:16,848 - {'Epoch': 43, 'HR@5': '0.0606', 'NDCG@5': '0.0391', 'HR@10': '0.0954', 'NDCG@10': '0.0505', 'HR@20': '0.1422', 'NDCG@20': '0.0624'}
2025-03-02 16:35:16,849 - EarlyStopping counter: 2 out of 10
2025-03-02 16:35:22,156 - {'epoch': 44, 'rec_loss': '5.2632'}
2025-03-02 16:35:22,966 - {'Epoch': 44, 'HR@5': '0.0624', 'NDCG@5': '0.0419', 'HR@10': '0.0963', 'NDCG@10': '0.0529', 'HR@20': '0.1385', 'NDCG@20': '0.0635'}
2025-03-02 16:35:22,968 - EarlyStopping counter: 3 out of 10
2025-03-02 16:35:27,952 - {'epoch': 45, 'rec_loss': '5.2584'}
2025-03-02 16:35:28,698 - {'Epoch': 45, 'HR@5': '0.0615', 'NDCG@5': '0.0416', 'HR@10': '0.0954', 'NDCG@10': '0.0527', 'HR@20': '0.1440', 'NDCG@20': '0.0650'}
2025-03-02 16:35:28,699 - Validation score increased.  Saving model ...
2025-03-02 16:35:33,893 - {'epoch': 46, 'rec_loss': '5.2421'}
2025-03-02 16:35:34,763 - {'Epoch': 46, 'HR@5': '0.0706', 'NDCG@5': '0.0429', 'HR@10': '0.0963', 'NDCG@10': '0.0511', 'HR@20': '0.1477', 'NDCG@20': '0.0641'}
2025-03-02 16:35:34,764 - EarlyStopping counter: 1 out of 10
2025-03-02 16:35:40,049 - {'epoch': 47, 'rec_loss': '5.2388'}
2025-03-02 16:35:40,837 - {'Epoch': 47, 'HR@5': '0.0670', 'NDCG@5': '0.0420', 'HR@10': '0.0954', 'NDCG@10': '0.0512', 'HR@20': '0.1422', 'NDCG@20': '0.0630'}
2025-03-02 16:35:40,838 - EarlyStopping counter: 2 out of 10
2025-03-02 16:35:45,812 - {'epoch': 48, 'rec_loss': '5.2473'}
2025-03-02 16:35:46,649 - {'Epoch': 48, 'HR@5': '0.0670', 'NDCG@5': '0.0419', 'HR@10': '0.0972', 'NDCG@10': '0.0518', 'HR@20': '0.1541', 'NDCG@20': '0.0661'}
2025-03-02 16:35:46,650 - Validation score increased.  Saving model ...
2025-03-02 16:35:51,794 - {'epoch': 49, 'rec_loss': '5.2297'}
2025-03-02 16:35:52,581 - {'Epoch': 49, 'HR@5': '0.0606', 'NDCG@5': '0.0384', 'HR@10': '0.0991', 'NDCG@10': '0.0509', 'HR@20': '0.1523', 'NDCG@20': '0.0641'}
2025-03-02 16:35:52,582 - EarlyStopping counter: 1 out of 10
2025-03-02 16:35:57,494 - {'epoch': 50, 'rec_loss': '5.2281'}
2025-03-02 16:35:58,242 - {'Epoch': 50, 'HR@5': '0.0642', 'NDCG@5': '0.0394', 'HR@10': '0.1000', 'NDCG@10': '0.0509', 'HR@20': '0.1495', 'NDCG@20': '0.0633'}
2025-03-02 16:35:58,243 - EarlyStopping counter: 2 out of 10
2025-03-02 16:36:03,264 - {'epoch': 51, 'rec_loss': '5.2135'}
2025-03-02 16:36:04,047 - {'Epoch': 51, 'HR@5': '0.0661', 'NDCG@5': '0.0404', 'HR@10': '0.0982', 'NDCG@10': '0.0506', 'HR@20': '0.1523', 'NDCG@20': '0.0641'}
2025-03-02 16:36:04,048 - EarlyStopping counter: 3 out of 10
2025-03-02 16:36:09,155 - {'epoch': 52, 'rec_loss': '5.2062'}
2025-03-02 16:36:09,890 - {'Epoch': 52, 'HR@5': '0.0670', 'NDCG@5': '0.0399', 'HR@10': '0.1009', 'NDCG@10': '0.0507', 'HR@20': '0.1459', 'NDCG@20': '0.0621'}
2025-03-02 16:36:09,891 - EarlyStopping counter: 4 out of 10
2025-03-02 16:36:14,788 - {'epoch': 53, 'rec_loss': '5.2119'}
2025-03-02 16:36:15,548 - {'Epoch': 53, 'HR@5': '0.0679', 'NDCG@5': '0.0432', 'HR@10': '0.1028', 'NDCG@10': '0.0543', 'HR@20': '0.1523', 'NDCG@20': '0.0668'}
2025-03-02 16:36:15,549 - Validation score increased.  Saving model ...
2025-03-02 16:36:20,781 - {'epoch': 54, 'rec_loss': '5.1906'}
2025-03-02 16:36:21,543 - {'Epoch': 54, 'HR@5': '0.0670', 'NDCG@5': '0.0418', 'HR@10': '0.1073', 'NDCG@10': '0.0545', 'HR@20': '0.1477', 'NDCG@20': '0.0647'}
2025-03-02 16:36:21,544 - EarlyStopping counter: 1 out of 10
2025-03-02 16:36:26,502 - {'epoch': 55, 'rec_loss': '5.1810'}
2025-03-02 16:36:27,391 - {'Epoch': 55, 'HR@5': '0.0651', 'NDCG@5': '0.0429', 'HR@10': '0.1092', 'NDCG@10': '0.0570', 'HR@20': '0.1431', 'NDCG@20': '0.0655'}
2025-03-02 16:36:27,392 - EarlyStopping counter: 2 out of 10
2025-03-02 16:36:32,389 - {'epoch': 56, 'rec_loss': '5.1885'}
2025-03-02 16:36:33,175 - {'Epoch': 56, 'HR@5': '0.0624', 'NDCG@5': '0.0404', 'HR@10': '0.1018', 'NDCG@10': '0.0530', 'HR@20': '0.1486', 'NDCG@20': '0.0648'}
2025-03-02 16:36:33,177 - EarlyStopping counter: 3 out of 10
2025-03-02 16:36:38,397 - {'epoch': 57, 'rec_loss': '5.2121'}
2025-03-02 16:36:39,139 - {'Epoch': 57, 'HR@5': '0.0596', 'NDCG@5': '0.0399', 'HR@10': '0.1028', 'NDCG@10': '0.0535', 'HR@20': '0.1495', 'NDCG@20': '0.0655'}
2025-03-02 16:36:39,141 - EarlyStopping counter: 4 out of 10
2025-03-02 16:36:44,178 - {'epoch': 58, 'rec_loss': '5.2085'}
2025-03-02 16:36:44,915 - {'Epoch': 58, 'HR@5': '0.0661', 'NDCG@5': '0.0429', 'HR@10': '0.1009', 'NDCG@10': '0.0541', 'HR@20': '0.1459', 'NDCG@20': '0.0653'}
2025-03-02 16:36:44,916 - EarlyStopping counter: 5 out of 10
2025-03-02 16:36:49,873 - {'epoch': 59, 'rec_loss': '5.1902'}
2025-03-02 16:36:50,703 - {'Epoch': 59, 'HR@5': '0.0633', 'NDCG@5': '0.0428', 'HR@10': '0.1055', 'NDCG@10': '0.0563', 'HR@20': '0.1422', 'NDCG@20': '0.0656'}
2025-03-02 16:36:50,705 - EarlyStopping counter: 6 out of 10
2025-03-02 16:36:55,886 - {'epoch': 60, 'rec_loss': '5.1632'}
2025-03-02 16:36:56,663 - {'Epoch': 60, 'HR@5': '0.0596', 'NDCG@5': '0.0398', 'HR@10': '0.1037', 'NDCG@10': '0.0540', 'HR@20': '0.1422', 'NDCG@20': '0.0638'}
2025-03-02 16:36:56,664 - EarlyStopping counter: 7 out of 10
2025-03-02 16:37:02,156 - {'epoch': 61, 'rec_loss': '5.1630'}
2025-03-02 16:37:03,015 - {'Epoch': 61, 'HR@5': '0.0651', 'NDCG@5': '0.0444', 'HR@10': '0.0982', 'NDCG@10': '0.0550', 'HR@20': '0.1450', 'NDCG@20': '0.0670'}
2025-03-02 16:37:03,016 - Validation score increased.  Saving model ...
2025-03-02 16:37:08,297 - {'epoch': 62, 'rec_loss': '5.1757'}
2025-03-02 16:37:09,097 - {'Epoch': 62, 'HR@5': '0.0688', 'NDCG@5': '0.0435', 'HR@10': '0.1000', 'NDCG@10': '0.0535', 'HR@20': '0.1505', 'NDCG@20': '0.0663'}
2025-03-02 16:37:09,098 - EarlyStopping counter: 1 out of 10
2025-03-02 16:37:14,161 - {'epoch': 63, 'rec_loss': '5.1689'}
2025-03-02 16:37:14,904 - {'Epoch': 63, 'HR@5': '0.0615', 'NDCG@5': '0.0410', 'HR@10': '0.1037', 'NDCG@10': '0.0548', 'HR@20': '0.1495', 'NDCG@20': '0.0663'}
2025-03-02 16:37:14,905 - EarlyStopping counter: 2 out of 10
2025-03-02 16:37:20,104 - {'epoch': 64, 'rec_loss': '5.1572'}
2025-03-02 16:37:20,944 - {'Epoch': 64, 'HR@5': '0.0670', 'NDCG@5': '0.0442', 'HR@10': '0.1055', 'NDCG@10': '0.0565', 'HR@20': '0.1468', 'NDCG@20': '0.0668'}
2025-03-02 16:37:20,945 - EarlyStopping counter: 3 out of 10
2025-03-02 16:37:26,111 - {'epoch': 65, 'rec_loss': '5.1716'}
2025-03-02 16:37:26,859 - {'Epoch': 65, 'HR@5': '0.0633', 'NDCG@5': '0.0422', 'HR@10': '0.1064', 'NDCG@10': '0.0558', 'HR@20': '0.1468', 'NDCG@20': '0.0659'}
2025-03-02 16:37:26,860 - EarlyStopping counter: 4 out of 10
2025-03-02 16:37:32,285 - {'epoch': 66, 'rec_loss': '5.1430'}
2025-03-02 16:37:33,017 - {'Epoch': 66, 'HR@5': '0.0578', 'NDCG@5': '0.0391', 'HR@10': '0.1046', 'NDCG@10': '0.0542', 'HR@20': '0.1385', 'NDCG@20': '0.0627'}
2025-03-02 16:37:33,018 - EarlyStopping counter: 5 out of 10
2025-03-02 16:37:38,559 - {'epoch': 67, 'rec_loss': '5.1590'}
2025-03-02 16:37:39,258 - {'Epoch': 67, 'HR@5': '0.0670', 'NDCG@5': '0.0430', 'HR@10': '0.1064', 'NDCG@10': '0.0555', 'HR@20': '0.1431', 'NDCG@20': '0.0648'}
2025-03-02 16:37:39,259 - EarlyStopping counter: 6 out of 10
2025-03-02 16:37:44,419 - {'epoch': 68, 'rec_loss': '5.1584'}
2025-03-02 16:37:45,207 - {'Epoch': 68, 'HR@5': '0.0697', 'NDCG@5': '0.0451', 'HR@10': '0.1110', 'NDCG@10': '0.0583', 'HR@20': '0.1431', 'NDCG@20': '0.0664'}
2025-03-02 16:37:45,208 - EarlyStopping counter: 7 out of 10
2025-03-02 16:37:50,268 - {'epoch': 69, 'rec_loss': '5.1486'}
2025-03-02 16:37:51,000 - {'Epoch': 69, 'HR@5': '0.0725', 'NDCG@5': '0.0456', 'HR@10': '0.1092', 'NDCG@10': '0.0574', 'HR@20': '0.1468', 'NDCG@20': '0.0669'}
2025-03-02 16:37:51,001 - EarlyStopping counter: 8 out of 10
2025-03-02 16:37:55,929 - {'epoch': 70, 'rec_loss': '5.1363'}
2025-03-02 16:37:56,676 - {'Epoch': 70, 'HR@5': '0.0706', 'NDCG@5': '0.0463', 'HR@10': '0.1046', 'NDCG@10': '0.0573', 'HR@20': '0.1495', 'NDCG@20': '0.0686'}
2025-03-02 16:37:56,677 - Validation score increased.  Saving model ...
2025-03-02 16:38:01,922 - {'epoch': 71, 'rec_loss': '5.1269'}
2025-03-02 16:38:02,676 - {'Epoch': 71, 'HR@5': '0.0679', 'NDCG@5': '0.0448', 'HR@10': '0.1055', 'NDCG@10': '0.0572', 'HR@20': '0.1514', 'NDCG@20': '0.0688'}
2025-03-02 16:38:02,677 - Validation score increased.  Saving model ...
2025-03-02 16:38:07,964 - {'epoch': 72, 'rec_loss': '5.1098'}
2025-03-02 16:38:08,701 - {'Epoch': 72, 'HR@5': '0.0725', 'NDCG@5': '0.0453', 'HR@10': '0.1046', 'NDCG@10': '0.0555', 'HR@20': '0.1459', 'NDCG@20': '0.0660'}
2025-03-02 16:38:08,702 - EarlyStopping counter: 1 out of 10
2025-03-02 16:38:13,769 - {'epoch': 73, 'rec_loss': '5.1246'}
2025-03-02 16:38:14,549 - {'Epoch': 73, 'HR@5': '0.0706', 'NDCG@5': '0.0444', 'HR@10': '0.1037', 'NDCG@10': '0.0549', 'HR@20': '0.1477', 'NDCG@20': '0.0660'}
2025-03-02 16:38:14,550 - EarlyStopping counter: 2 out of 10
2025-03-02 16:38:19,631 - {'epoch': 74, 'rec_loss': '5.1123'}
2025-03-02 16:38:20,387 - {'Epoch': 74, 'HR@5': '0.0670', 'NDCG@5': '0.0446', 'HR@10': '0.1028', 'NDCG@10': '0.0561', 'HR@20': '0.1523', 'NDCG@20': '0.0687'}
2025-03-02 16:38:20,388 - EarlyStopping counter: 3 out of 10
2025-03-02 16:38:25,378 - {'epoch': 75, 'rec_loss': '5.1510'}
2025-03-02 16:38:26,205 - {'Epoch': 75, 'HR@5': '0.0624', 'NDCG@5': '0.0393', 'HR@10': '0.1055', 'NDCG@10': '0.0530', 'HR@20': '0.1532', 'NDCG@20': '0.0650'}
2025-03-02 16:38:26,206 - EarlyStopping counter: 4 out of 10
2025-03-02 16:38:31,633 - {'epoch': 76, 'rec_loss': '5.0971'}
2025-03-02 16:38:32,367 - {'Epoch': 76, 'HR@5': '0.0624', 'NDCG@5': '0.0420', 'HR@10': '0.1073', 'NDCG@10': '0.0563', 'HR@20': '0.1523', 'NDCG@20': '0.0677'}
2025-03-02 16:38:32,368 - EarlyStopping counter: 5 out of 10
2025-03-02 16:38:37,638 - {'epoch': 77, 'rec_loss': '5.0988'}
2025-03-02 16:38:38,417 - {'Epoch': 77, 'HR@5': '0.0688', 'NDCG@5': '0.0435', 'HR@10': '0.1028', 'NDCG@10': '0.0544', 'HR@20': '0.1523', 'NDCG@20': '0.0670'}
2025-03-02 16:38:38,418 - EarlyStopping counter: 6 out of 10
2025-03-02 16:38:43,941 - {'epoch': 78, 'rec_loss': '5.0990'}
2025-03-02 16:38:44,745 - {'Epoch': 78, 'HR@5': '0.0624', 'NDCG@5': '0.0415', 'HR@10': '0.1046', 'NDCG@10': '0.0554', 'HR@20': '0.1505', 'NDCG@20': '0.0669'}
2025-03-02 16:38:44,746 - EarlyStopping counter: 7 out of 10
2025-03-02 16:38:49,924 - {'epoch': 79, 'rec_loss': '5.0922'}
2025-03-02 16:38:50,698 - {'Epoch': 79, 'HR@5': '0.0697', 'NDCG@5': '0.0432', 'HR@10': '0.1046', 'NDCG@10': '0.0543', 'HR@20': '0.1532', 'NDCG@20': '0.0664'}
2025-03-02 16:38:50,699 - EarlyStopping counter: 8 out of 10
2025-03-02 16:38:55,658 - {'epoch': 80, 'rec_loss': '5.0936'}
2025-03-02 16:38:56,520 - {'Epoch': 80, 'HR@5': '0.0651', 'NDCG@5': '0.0425', 'HR@10': '0.1101', 'NDCG@10': '0.0569', 'HR@20': '0.1495', 'NDCG@20': '0.0668'}
2025-03-02 16:38:56,521 - EarlyStopping counter: 9 out of 10
2025-03-02 16:39:01,741 - {'epoch': 81, 'rec_loss': '5.0906'}
2025-03-02 16:39:02,520 - {'Epoch': 81, 'HR@5': '0.0615', 'NDCG@5': '0.0391', 'HR@10': '0.1018', 'NDCG@10': '0.0521', 'HR@20': '0.1459', 'NDCG@20': '0.0634'}
2025-03-02 16:39:02,521 - EarlyStopping counter: 10 out of 10
2025-03-02 16:39:02,521 - Early stopping
2025-03-02 16:39:02,521 - ---------------Test Score---------------
2025-03-02 16:39:03,439 - {'Epoch': 0, 'HR@5': '0.0505', 'NDCG@5': '0.0323', 'HR@10': '0.0780', 'NDCG@10': '0.0414', 'HR@20': '0.1055', 'NDCG@20': '0.0483'}
2025-03-02 16:39:03,440 - Scale_LastFM
2025-03-02 16:39:03,440 - {'Epoch': 0, 'HR@5': '0.0505', 'NDCG@5': '0.0323', 'HR@10': '0.0780', 'NDCG@10': '0.0414', 'HR@20': '0.1055', 'NDCG@20': '0.0483'}
2025-03-02 16:46:29,133 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[8, 24, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-03-02 16:46:44,463 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-02 16:46:44,477 - Total Parameters: 387350
2025-03-02 16:46:53,963 - {'epoch': 0, 'rec_loss': '8.0390'}
2025-03-02 16:46:54,705 - {'Epoch': 0, 'HR@5': '0.0202', 'NDCG@5': '0.0143', 'HR@10': '0.0358', 'NDCG@10': '0.0194', 'HR@20': '0.0642', 'NDCG@20': '0.0265'}
2025-03-02 16:46:54,706 - Validation score increased.  Saving model ...
2025-03-02 16:47:00,020 - {'epoch': 1, 'rec_loss': '7.7575'}
2025-03-02 16:47:00,677 - {'Epoch': 1, 'HR@5': '0.0211', 'NDCG@5': '0.0147', 'HR@10': '0.0358', 'NDCG@10': '0.0194', 'HR@20': '0.0642', 'NDCG@20': '0.0265'}
2025-03-02 16:47:00,679 - Validation score increased.  Saving model ...
2025-03-02 16:47:05,581 - {'epoch': 2, 'rec_loss': '7.5509'}
2025-03-02 16:47:06,240 - {'Epoch': 2, 'HR@5': '0.0303', 'NDCG@5': '0.0204', 'HR@10': '0.0477', 'NDCG@10': '0.0259', 'HR@20': '0.0688', 'NDCG@20': '0.0312'}
2025-03-02 16:47:06,242 - Validation score increased.  Saving model ...
2025-03-02 16:47:11,774 - {'epoch': 3, 'rec_loss': '7.3268'}
2025-03-02 16:47:12,436 - {'Epoch': 3, 'HR@5': '0.0330', 'NDCG@5': '0.0212', 'HR@10': '0.0477', 'NDCG@10': '0.0258', 'HR@20': '0.0725', 'NDCG@20': '0.0320'}
2025-03-02 16:47:12,437 - Validation score increased.  Saving model ...
2025-03-02 16:47:17,260 - {'epoch': 4, 'rec_loss': '7.1194'}
2025-03-02 16:47:18,132 - {'Epoch': 4, 'HR@5': '0.0358', 'NDCG@5': '0.0240', 'HR@10': '0.0569', 'NDCG@10': '0.0306', 'HR@20': '0.0899', 'NDCG@20': '0.0389'}
2025-03-02 16:47:18,134 - Validation score increased.  Saving model ...
2025-03-02 16:47:23,343 - {'epoch': 5, 'rec_loss': '6.9129'}
2025-03-02 16:47:23,938 - {'Epoch': 5, 'HR@5': '0.0358', 'NDCG@5': '0.0256', 'HR@10': '0.0560', 'NDCG@10': '0.0321', 'HR@20': '0.0927', 'NDCG@20': '0.0413'}
2025-03-02 16:47:23,940 - Validation score increased.  Saving model ...
2025-03-02 16:47:28,983 - {'epoch': 6, 'rec_loss': '6.7176'}
2025-03-02 16:47:29,556 - {'Epoch': 6, 'HR@5': '0.0450', 'NDCG@5': '0.0253', 'HR@10': '0.0651', 'NDCG@10': '0.0320', 'HR@20': '0.0936', 'NDCG@20': '0.0391'}
2025-03-02 16:47:29,558 - EarlyStopping counter: 1 out of 10
2025-03-02 16:47:34,445 - {'epoch': 7, 'rec_loss': '6.5408'}
2025-03-02 16:47:35,012 - {'Epoch': 7, 'HR@5': '0.0440', 'NDCG@5': '0.0273', 'HR@10': '0.0670', 'NDCG@10': '0.0347', 'HR@20': '0.1000', 'NDCG@20': '0.0429'}
2025-03-02 16:47:35,014 - Validation score increased.  Saving model ...
2025-03-02 16:47:39,991 - {'epoch': 8, 'rec_loss': '6.3783'}
2025-03-02 16:47:40,686 - {'Epoch': 8, 'HR@5': '0.0440', 'NDCG@5': '0.0279', 'HR@10': '0.0688', 'NDCG@10': '0.0358', 'HR@20': '0.1055', 'NDCG@20': '0.0451'}
2025-03-02 16:47:40,688 - Validation score increased.  Saving model ...
2025-03-02 16:47:45,772 - {'epoch': 9, 'rec_loss': '6.2631'}
2025-03-02 16:47:46,386 - {'Epoch': 9, 'HR@5': '0.0468', 'NDCG@5': '0.0289', 'HR@10': '0.0761', 'NDCG@10': '0.0383', 'HR@20': '0.1147', 'NDCG@20': '0.0480'}
2025-03-02 16:47:46,387 - Validation score increased.  Saving model ...
2025-03-02 16:47:51,555 - {'epoch': 10, 'rec_loss': '6.1251'}
2025-03-02 16:47:52,257 - {'Epoch': 10, 'HR@5': '0.0450', 'NDCG@5': '0.0291', 'HR@10': '0.0725', 'NDCG@10': '0.0380', 'HR@20': '0.1119', 'NDCG@20': '0.0479'}
2025-03-02 16:47:52,259 - EarlyStopping counter: 1 out of 10
2025-03-02 16:47:57,342 - {'epoch': 11, 'rec_loss': '6.0525'}
2025-03-02 16:47:57,975 - {'Epoch': 11, 'HR@5': '0.0495', 'NDCG@5': '0.0321', 'HR@10': '0.0743', 'NDCG@10': '0.0399', 'HR@20': '0.1174', 'NDCG@20': '0.0506'}
2025-03-02 16:47:57,976 - Validation score increased.  Saving model ...
2025-03-02 16:48:03,034 - {'epoch': 12, 'rec_loss': '5.9642'}
2025-03-02 16:48:03,683 - {'Epoch': 12, 'HR@5': '0.0431', 'NDCG@5': '0.0298', 'HR@10': '0.0743', 'NDCG@10': '0.0398', 'HR@20': '0.1257', 'NDCG@20': '0.0528'}
2025-03-02 16:48:03,685 - Validation score increased.  Saving model ...
2025-03-02 16:48:08,499 - {'epoch': 13, 'rec_loss': '5.8807'}
2025-03-02 16:48:09,130 - {'Epoch': 13, 'HR@5': '0.0422', 'NDCG@5': '0.0290', 'HR@10': '0.0771', 'NDCG@10': '0.0400', 'HR@20': '0.1211', 'NDCG@20': '0.0513'}
2025-03-02 16:48:09,131 - EarlyStopping counter: 1 out of 10
2025-03-02 16:48:13,852 - {'epoch': 14, 'rec_loss': '5.8143'}
2025-03-02 16:48:14,406 - {'Epoch': 14, 'HR@5': '0.0450', 'NDCG@5': '0.0294', 'HR@10': '0.0780', 'NDCG@10': '0.0400', 'HR@20': '0.1248', 'NDCG@20': '0.0518'}
2025-03-02 16:48:14,407 - EarlyStopping counter: 2 out of 10
2025-03-02 16:48:19,370 - {'epoch': 15, 'rec_loss': '5.7712'}
2025-03-02 16:48:19,966 - {'Epoch': 15, 'HR@5': '0.0532', 'NDCG@5': '0.0352', 'HR@10': '0.0826', 'NDCG@10': '0.0444', 'HR@20': '0.1266', 'NDCG@20': '0.0554'}
2025-03-02 16:48:19,967 - Validation score increased.  Saving model ...
2025-03-02 16:48:24,773 - {'epoch': 16, 'rec_loss': '5.7360'}
2025-03-02 16:48:25,338 - {'Epoch': 16, 'HR@5': '0.0495', 'NDCG@5': '0.0337', 'HR@10': '0.0716', 'NDCG@10': '0.0408', 'HR@20': '0.1248', 'NDCG@20': '0.0544'}
2025-03-02 16:48:25,339 - EarlyStopping counter: 1 out of 10
2025-03-02 16:48:30,344 - {'epoch': 17, 'rec_loss': '5.6877'}
2025-03-02 16:48:30,923 - {'Epoch': 17, 'HR@5': '0.0514', 'NDCG@5': '0.0341', 'HR@10': '0.0789', 'NDCG@10': '0.0429', 'HR@20': '0.1312', 'NDCG@20': '0.0561'}
2025-03-02 16:48:30,925 - Validation score increased.  Saving model ...
2025-03-02 16:48:35,857 - {'epoch': 18, 'rec_loss': '5.6393'}
2025-03-02 16:48:36,458 - {'Epoch': 18, 'HR@5': '0.0505', 'NDCG@5': '0.0324', 'HR@10': '0.0835', 'NDCG@10': '0.0428', 'HR@20': '0.1349', 'NDCG@20': '0.0556'}
2025-03-02 16:48:36,459 - EarlyStopping counter: 1 out of 10
2025-03-02 16:48:41,258 - {'epoch': 19, 'rec_loss': '5.6054'}
2025-03-02 16:48:41,824 - {'Epoch': 19, 'HR@5': '0.0541', 'NDCG@5': '0.0327', 'HR@10': '0.0881', 'NDCG@10': '0.0437', 'HR@20': '0.1367', 'NDCG@20': '0.0560'}
2025-03-02 16:48:41,826 - EarlyStopping counter: 2 out of 10
2025-03-02 16:48:46,960 - {'epoch': 20, 'rec_loss': '5.5876'}
2025-03-02 16:48:47,580 - {'Epoch': 20, 'HR@5': '0.0477', 'NDCG@5': '0.0319', 'HR@10': '0.0817', 'NDCG@10': '0.0429', 'HR@20': '0.1349', 'NDCG@20': '0.0563'}
2025-03-02 16:48:47,581 - Validation score increased.  Saving model ...
2025-03-02 16:48:52,280 - {'epoch': 21, 'rec_loss': '5.5492'}
2025-03-02 16:48:52,921 - {'Epoch': 21, 'HR@5': '0.0532', 'NDCG@5': '0.0342', 'HR@10': '0.0890', 'NDCG@10': '0.0455', 'HR@20': '0.1330', 'NDCG@20': '0.0566'}
2025-03-02 16:48:52,923 - Validation score increased.  Saving model ...
2025-03-02 16:48:58,130 - {'epoch': 22, 'rec_loss': '5.5414'}
2025-03-02 16:48:58,726 - {'Epoch': 22, 'HR@5': '0.0550', 'NDCG@5': '0.0368', 'HR@10': '0.0826', 'NDCG@10': '0.0456', 'HR@20': '0.1321', 'NDCG@20': '0.0583'}
2025-03-02 16:48:58,727 - Validation score increased.  Saving model ...
2025-03-02 16:49:03,900 - {'epoch': 23, 'rec_loss': '5.5314'}
2025-03-02 16:49:04,485 - {'Epoch': 23, 'HR@5': '0.0514', 'NDCG@5': '0.0337', 'HR@10': '0.0908', 'NDCG@10': '0.0465', 'HR@20': '0.1385', 'NDCG@20': '0.0585'}
2025-03-02 16:49:04,486 - Validation score increased.  Saving model ...
2025-03-02 16:49:09,676 - {'epoch': 24, 'rec_loss': '5.4923'}
2025-03-02 16:49:10,334 - {'Epoch': 24, 'HR@5': '0.0532', 'NDCG@5': '0.0351', 'HR@10': '0.0872', 'NDCG@10': '0.0460', 'HR@20': '0.1367', 'NDCG@20': '0.0586'}
2025-03-02 16:49:10,335 - Validation score increased.  Saving model ...
2025-03-02 16:49:15,453 - {'epoch': 25, 'rec_loss': '5.4649'}
2025-03-02 16:49:16,127 - {'Epoch': 25, 'HR@5': '0.0550', 'NDCG@5': '0.0352', 'HR@10': '0.0917', 'NDCG@10': '0.0468', 'HR@20': '0.1413', 'NDCG@20': '0.0593'}
2025-03-02 16:49:16,128 - Validation score increased.  Saving model ...
2025-03-02 16:49:21,608 - {'epoch': 26, 'rec_loss': '5.4663'}
2025-03-02 16:49:22,173 - {'Epoch': 26, 'HR@5': '0.0532', 'NDCG@5': '0.0345', 'HR@10': '0.0862', 'NDCG@10': '0.0452', 'HR@20': '0.1413', 'NDCG@20': '0.0590'}
2025-03-02 16:49:22,174 - EarlyStopping counter: 1 out of 10
2025-03-02 16:49:27,563 - {'epoch': 27, 'rec_loss': '5.4512'}
2025-03-02 16:49:28,169 - {'Epoch': 27, 'HR@5': '0.0532', 'NDCG@5': '0.0361', 'HR@10': '0.0908', 'NDCG@10': '0.0479', 'HR@20': '0.1339', 'NDCG@20': '0.0588'}
2025-03-02 16:49:28,170 - EarlyStopping counter: 2 out of 10
2025-03-02 16:49:33,547 - {'epoch': 28, 'rec_loss': '5.4335'}
2025-03-02 16:49:34,099 - {'Epoch': 28, 'HR@5': '0.0550', 'NDCG@5': '0.0367', 'HR@10': '0.0881', 'NDCG@10': '0.0472', 'HR@20': '0.1422', 'NDCG@20': '0.0608'}
2025-03-02 16:49:34,100 - Validation score increased.  Saving model ...
2025-03-02 16:49:39,286 - {'epoch': 29, 'rec_loss': '5.4195'}
2025-03-02 16:49:39,900 - {'Epoch': 29, 'HR@5': '0.0578', 'NDCG@5': '0.0388', 'HR@10': '0.0853', 'NDCG@10': '0.0476', 'HR@20': '0.1367', 'NDCG@20': '0.0606'}
2025-03-02 16:49:39,901 - EarlyStopping counter: 1 out of 10
2025-03-02 16:49:45,059 - {'epoch': 30, 'rec_loss': '5.4100'}
2025-03-02 16:49:45,677 - {'Epoch': 30, 'HR@5': '0.0541', 'NDCG@5': '0.0366', 'HR@10': '0.0853', 'NDCG@10': '0.0466', 'HR@20': '0.1394', 'NDCG@20': '0.0602'}
2025-03-02 16:49:45,678 - EarlyStopping counter: 2 out of 10
2025-03-02 16:49:50,931 - {'epoch': 31, 'rec_loss': '5.3999'}
2025-03-02 16:49:51,568 - {'Epoch': 31, 'HR@5': '0.0587', 'NDCG@5': '0.0382', 'HR@10': '0.0963', 'NDCG@10': '0.0503', 'HR@20': '0.1422', 'NDCG@20': '0.0618'}
2025-03-02 16:49:51,569 - Validation score increased.  Saving model ...
2025-03-02 16:49:56,346 - {'epoch': 32, 'rec_loss': '5.3895'}
2025-03-02 16:49:56,906 - {'Epoch': 32, 'HR@5': '0.0596', 'NDCG@5': '0.0363', 'HR@10': '0.0908', 'NDCG@10': '0.0464', 'HR@20': '0.1404', 'NDCG@20': '0.0588'}
2025-03-02 16:49:56,908 - EarlyStopping counter: 1 out of 10
2025-03-02 16:50:01,949 - {'epoch': 33, 'rec_loss': '5.3691'}
2025-03-02 16:50:02,605 - {'Epoch': 33, 'HR@5': '0.0642', 'NDCG@5': '0.0394', 'HR@10': '0.0917', 'NDCG@10': '0.0484', 'HR@20': '0.1468', 'NDCG@20': '0.0622'}
2025-03-02 16:50:02,607 - Validation score increased.  Saving model ...
2025-03-02 16:50:07,536 - {'epoch': 34, 'rec_loss': '5.3604'}
2025-03-02 16:50:08,143 - {'Epoch': 34, 'HR@5': '0.0642', 'NDCG@5': '0.0394', 'HR@10': '0.0963', 'NDCG@10': '0.0499', 'HR@20': '0.1422', 'NDCG@20': '0.0614'}
2025-03-02 16:50:08,144 - EarlyStopping counter: 1 out of 10
2025-03-02 16:50:13,311 - {'epoch': 35, 'rec_loss': '5.3279'}
2025-03-02 16:50:13,953 - {'Epoch': 35, 'HR@5': '0.0651', 'NDCG@5': '0.0400', 'HR@10': '0.0954', 'NDCG@10': '0.0498', 'HR@20': '0.1468', 'NDCG@20': '0.0627'}
2025-03-02 16:50:13,954 - Validation score increased.  Saving model ...
2025-03-02 16:50:18,819 - {'epoch': 36, 'rec_loss': '5.3250'}
2025-03-02 16:50:19,480 - {'Epoch': 36, 'HR@5': '0.0624', 'NDCG@5': '0.0382', 'HR@10': '0.0908', 'NDCG@10': '0.0475', 'HR@20': '0.1440', 'NDCG@20': '0.0611'}
2025-03-02 16:50:19,481 - EarlyStopping counter: 1 out of 10
2025-03-02 16:50:24,477 - {'epoch': 37, 'rec_loss': '5.3228'}
2025-03-02 16:50:25,147 - {'Epoch': 37, 'HR@5': '0.0606', 'NDCG@5': '0.0382', 'HR@10': '0.0927', 'NDCG@10': '0.0485', 'HR@20': '0.1486', 'NDCG@20': '0.0625'}
2025-03-02 16:50:25,148 - EarlyStopping counter: 2 out of 10
2025-03-02 16:50:30,496 - {'epoch': 38, 'rec_loss': '5.3282'}
2025-03-02 16:50:31,174 - {'Epoch': 38, 'HR@5': '0.0606', 'NDCG@5': '0.0393', 'HR@10': '0.0917', 'NDCG@10': '0.0493', 'HR@20': '0.1486', 'NDCG@20': '0.0636'}
2025-03-02 16:50:31,175 - Validation score increased.  Saving model ...
2025-03-02 16:50:37,033 - {'epoch': 39, 'rec_loss': '5.3195'}
2025-03-02 16:50:37,647 - {'Epoch': 39, 'HR@5': '0.0606', 'NDCG@5': '0.0381', 'HR@10': '0.0963', 'NDCG@10': '0.0496', 'HR@20': '0.1477', 'NDCG@20': '0.0624'}
2025-03-02 16:50:37,648 - EarlyStopping counter: 1 out of 10
2025-03-02 16:50:42,360 - {'epoch': 40, 'rec_loss': '5.2803'}
2025-03-02 16:50:43,001 - {'Epoch': 40, 'HR@5': '0.0615', 'NDCG@5': '0.0402', 'HR@10': '0.0972', 'NDCG@10': '0.0517', 'HR@20': '0.1459', 'NDCG@20': '0.0640'}
2025-03-02 16:50:43,002 - Validation score increased.  Saving model ...
2025-03-02 16:50:48,167 - {'epoch': 41, 'rec_loss': '5.2947'}
2025-03-02 16:50:48,783 - {'Epoch': 41, 'HR@5': '0.0596', 'NDCG@5': '0.0403', 'HR@10': '0.0963', 'NDCG@10': '0.0521', 'HR@20': '0.1431', 'NDCG@20': '0.0638'}
2025-03-02 16:50:48,784 - EarlyStopping counter: 1 out of 10
2025-03-02 16:50:54,977 - {'epoch': 42, 'rec_loss': '5.2962'}
2025-03-02 16:50:55,563 - {'Epoch': 42, 'HR@5': '0.0642', 'NDCG@5': '0.0406', 'HR@10': '0.0963', 'NDCG@10': '0.0509', 'HR@20': '0.1477', 'NDCG@20': '0.0636'}
2025-03-02 16:50:55,564 - EarlyStopping counter: 2 out of 10
2025-03-02 16:51:00,611 - {'epoch': 43, 'rec_loss': '5.2617'}
2025-03-02 16:51:01,175 - {'Epoch': 43, 'HR@5': '0.0606', 'NDCG@5': '0.0394', 'HR@10': '0.0954', 'NDCG@10': '0.0505', 'HR@20': '0.1450', 'NDCG@20': '0.0631'}
2025-03-02 16:51:01,176 - EarlyStopping counter: 3 out of 10
2025-03-02 16:51:05,827 - {'epoch': 44, 'rec_loss': '5.2703'}
2025-03-02 16:51:06,455 - {'Epoch': 44, 'HR@5': '0.0578', 'NDCG@5': '0.0399', 'HR@10': '0.0982', 'NDCG@10': '0.0530', 'HR@20': '0.1376', 'NDCG@20': '0.0629'}
2025-03-02 16:51:06,456 - EarlyStopping counter: 4 out of 10
2025-03-02 16:51:11,838 - {'epoch': 45, 'rec_loss': '5.2643'}
2025-03-02 16:51:12,445 - {'Epoch': 45, 'HR@5': '0.0596', 'NDCG@5': '0.0407', 'HR@10': '0.0908', 'NDCG@10': '0.0509', 'HR@20': '0.1376', 'NDCG@20': '0.0629'}
2025-03-02 16:51:12,446 - EarlyStopping counter: 5 out of 10
2025-03-02 16:51:18,188 - {'epoch': 46, 'rec_loss': '5.2487'}
2025-03-02 16:51:18,848 - {'Epoch': 46, 'HR@5': '0.0670', 'NDCG@5': '0.0421', 'HR@10': '0.0963', 'NDCG@10': '0.0517', 'HR@20': '0.1422', 'NDCG@20': '0.0632'}
2025-03-02 16:51:18,849 - EarlyStopping counter: 6 out of 10
2025-03-02 16:51:23,820 - {'epoch': 47, 'rec_loss': '5.2457'}
2025-03-02 16:51:24,466 - {'Epoch': 47, 'HR@5': '0.0661', 'NDCG@5': '0.0418', 'HR@10': '0.0936', 'NDCG@10': '0.0506', 'HR@20': '0.1413', 'NDCG@20': '0.0627'}
2025-03-02 16:51:24,468 - EarlyStopping counter: 7 out of 10
2025-03-02 16:51:29,618 - {'epoch': 48, 'rec_loss': '5.2551'}
2025-03-02 16:51:30,254 - {'Epoch': 48, 'HR@5': '0.0688', 'NDCG@5': '0.0421', 'HR@10': '0.0972', 'NDCG@10': '0.0512', 'HR@20': '0.1459', 'NDCG@20': '0.0635'}
2025-03-02 16:51:30,256 - EarlyStopping counter: 8 out of 10
2025-03-02 16:51:35,526 - {'epoch': 49, 'rec_loss': '5.2396'}
2025-03-02 16:51:36,170 - {'Epoch': 49, 'HR@5': '0.0615', 'NDCG@5': '0.0398', 'HR@10': '0.1009', 'NDCG@10': '0.0522', 'HR@20': '0.1450', 'NDCG@20': '0.0632'}
2025-03-02 16:51:36,171 - EarlyStopping counter: 9 out of 10
2025-03-02 16:51:41,397 - {'epoch': 50, 'rec_loss': '5.2364'}
2025-03-02 16:51:42,036 - {'Epoch': 50, 'HR@5': '0.0606', 'NDCG@5': '0.0371', 'HR@10': '0.1000', 'NDCG@10': '0.0500', 'HR@20': '0.1440', 'NDCG@20': '0.0610'}
2025-03-02 16:51:42,037 - EarlyStopping counter: 10 out of 10
2025-03-02 16:51:42,037 - Early stopping
2025-03-02 16:51:42,038 - ---------------Test Score---------------
2025-03-02 16:51:42,662 - {'Epoch': 0, 'HR@5': '0.0606', 'NDCG@5': '0.0374', 'HR@10': '0.0743', 'NDCG@10': '0.0418', 'HR@20': '0.1037', 'NDCG@20': '0.0492'}
2025-03-02 16:51:42,663 - Scale_LastFM
2025-03-02 16:51:42,663 - {'Epoch': 0, 'HR@5': '0.0606', 'NDCG@5': '0.0374', 'HR@10': '0.0743', 'NDCG@10': '0.0418', 'HR@20': '0.1037', 'NDCG@20': '0.0492'}
2025-03-02 17:14:26,336 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[8, 12, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-03-02 17:14:29,358 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-02 17:14:29,361 - Total Parameters: 387350
2025-03-02 17:14:34,929 - {'epoch': 0, 'rec_loss': '8.0389'}
2025-03-02 17:14:35,470 - {'Epoch': 0, 'HR@5': '0.0202', 'NDCG@5': '0.0143', 'HR@10': '0.0358', 'NDCG@10': '0.0194', 'HR@20': '0.0642', 'NDCG@20': '0.0265'}
2025-03-02 17:14:35,471 - Validation score increased.  Saving model ...
2025-03-02 17:14:40,187 - {'epoch': 1, 'rec_loss': '7.7570'}
2025-03-02 17:14:40,789 - {'Epoch': 1, 'HR@5': '0.0211', 'NDCG@5': '0.0147', 'HR@10': '0.0349', 'NDCG@10': '0.0192', 'HR@20': '0.0642', 'NDCG@20': '0.0265'}
2025-03-02 17:14:40,791 - Validation score increased.  Saving model ...
2025-03-02 17:14:45,794 - {'epoch': 2, 'rec_loss': '7.5502'}
2025-03-02 17:14:46,364 - {'Epoch': 2, 'HR@5': '0.0303', 'NDCG@5': '0.0203', 'HR@10': '0.0477', 'NDCG@10': '0.0258', 'HR@20': '0.0706', 'NDCG@20': '0.0315'}
2025-03-02 17:14:46,365 - Validation score increased.  Saving model ...
2025-03-02 17:14:51,693 - {'epoch': 3, 'rec_loss': '7.3262'}
2025-03-02 17:14:52,317 - {'Epoch': 3, 'HR@5': '0.0330', 'NDCG@5': '0.0218', 'HR@10': '0.0468', 'NDCG@10': '0.0262', 'HR@20': '0.0725', 'NDCG@20': '0.0326'}
2025-03-02 17:14:52,318 - Validation score increased.  Saving model ...
2025-03-02 17:14:57,301 - {'epoch': 4, 'rec_loss': '7.1179'}
2025-03-02 17:14:57,907 - {'Epoch': 4, 'HR@5': '0.0358', 'NDCG@5': '0.0240', 'HR@10': '0.0569', 'NDCG@10': '0.0307', 'HR@20': '0.0881', 'NDCG@20': '0.0386'}
2025-03-02 17:14:57,908 - Validation score increased.  Saving model ...
2025-03-02 17:15:02,563 - {'epoch': 5, 'rec_loss': '6.9111'}
2025-03-02 17:15:03,123 - {'Epoch': 5, 'HR@5': '0.0358', 'NDCG@5': '0.0246', 'HR@10': '0.0578', 'NDCG@10': '0.0317', 'HR@20': '0.0908', 'NDCG@20': '0.0398'}
2025-03-02 17:15:03,124 - Validation score increased.  Saving model ...
2025-03-02 17:15:08,142 - {'epoch': 6, 'rec_loss': '6.7156'}
2025-03-02 17:15:08,711 - {'Epoch': 6, 'HR@5': '0.0450', 'NDCG@5': '0.0253', 'HR@10': '0.0661', 'NDCG@10': '0.0322', 'HR@20': '0.0954', 'NDCG@20': '0.0395'}
2025-03-02 17:15:08,712 - EarlyStopping counter: 1 out of 10
2025-03-02 17:15:13,358 - {'epoch': 7, 'rec_loss': '6.5385'}
2025-03-02 17:15:13,908 - {'Epoch': 7, 'HR@5': '0.0450', 'NDCG@5': '0.0275', 'HR@10': '0.0670', 'NDCG@10': '0.0345', 'HR@20': '0.1000', 'NDCG@20': '0.0428'}
2025-03-02 17:15:13,910 - Validation score increased.  Saving model ...
2025-03-02 17:15:18,522 - {'epoch': 8, 'rec_loss': '6.3755'}
2025-03-02 17:15:19,124 - {'Epoch': 8, 'HR@5': '0.0450', 'NDCG@5': '0.0270', 'HR@10': '0.0679', 'NDCG@10': '0.0343', 'HR@20': '0.1073', 'NDCG@20': '0.0443'}
2025-03-02 17:15:19,125 - Validation score increased.  Saving model ...
2025-03-02 17:15:23,618 - {'epoch': 9, 'rec_loss': '6.2602'}
2025-03-02 17:15:24,243 - {'Epoch': 9, 'HR@5': '0.0486', 'NDCG@5': '0.0298', 'HR@10': '0.0761', 'NDCG@10': '0.0386', 'HR@20': '0.1156', 'NDCG@20': '0.0485'}
2025-03-02 17:15:24,245 - Validation score increased.  Saving model ...
2025-03-02 17:15:28,902 - {'epoch': 10, 'rec_loss': '6.1219'}
2025-03-02 17:15:29,424 - {'Epoch': 10, 'HR@5': '0.0440', 'NDCG@5': '0.0288', 'HR@10': '0.0734', 'NDCG@10': '0.0383', 'HR@20': '0.1110', 'NDCG@20': '0.0477'}
2025-03-02 17:15:29,425 - EarlyStopping counter: 1 out of 10
2025-03-02 17:15:36,071 - {'epoch': 11, 'rec_loss': '6.0494'}
2025-03-02 17:15:36,656 - {'Epoch': 11, 'HR@5': '0.0477', 'NDCG@5': '0.0314', 'HR@10': '0.0725', 'NDCG@10': '0.0393', 'HR@20': '0.1165', 'NDCG@20': '0.0504'}
2025-03-02 17:15:36,657 - Validation score increased.  Saving model ...
2025-03-02 17:15:41,864 - {'epoch': 12, 'rec_loss': '5.9611'}
2025-03-02 17:15:42,420 - {'Epoch': 12, 'HR@5': '0.0422', 'NDCG@5': '0.0295', 'HR@10': '0.0752', 'NDCG@10': '0.0400', 'HR@20': '0.1248', 'NDCG@20': '0.0525'}
2025-03-02 17:15:42,421 - Validation score increased.  Saving model ...
2025-03-02 17:15:47,420 - {'epoch': 13, 'rec_loss': '5.8788'}
2025-03-02 17:15:47,998 - {'Epoch': 13, 'HR@5': '0.0422', 'NDCG@5': '0.0295', 'HR@10': '0.0780', 'NDCG@10': '0.0407', 'HR@20': '0.1220', 'NDCG@20': '0.0520'}
2025-03-02 17:15:47,999 - EarlyStopping counter: 1 out of 10
2025-03-02 17:15:53,044 - {'epoch': 14, 'rec_loss': '5.8118'}
2025-03-02 17:15:53,682 - {'Epoch': 14, 'HR@5': '0.0459', 'NDCG@5': '0.0297', 'HR@10': '0.0798', 'NDCG@10': '0.0406', 'HR@20': '0.1248', 'NDCG@20': '0.0519'}
2025-03-02 17:15:53,683 - EarlyStopping counter: 2 out of 10
2025-03-02 17:15:59,520 - {'epoch': 15, 'rec_loss': '5.7696'}
2025-03-02 17:16:00,156 - {'Epoch': 15, 'HR@5': '0.0523', 'NDCG@5': '0.0347', 'HR@10': '0.0817', 'NDCG@10': '0.0441', 'HR@20': '0.1220', 'NDCG@20': '0.0542'}
2025-03-02 17:16:00,158 - Validation score increased.  Saving model ...
2025-03-02 17:16:05,151 - {'epoch': 16, 'rec_loss': '5.7341'}
2025-03-02 17:16:05,721 - {'Epoch': 16, 'HR@5': '0.0505', 'NDCG@5': '0.0346', 'HR@10': '0.0716', 'NDCG@10': '0.0414', 'HR@20': '0.1248', 'NDCG@20': '0.0550'}
2025-03-02 17:16:05,722 - Validation score increased.  Saving model ...
2025-03-02 17:16:10,804 - {'epoch': 17, 'rec_loss': '5.6856'}
2025-03-02 17:16:11,419 - {'Epoch': 17, 'HR@5': '0.0505', 'NDCG@5': '0.0336', 'HR@10': '0.0798', 'NDCG@10': '0.0430', 'HR@20': '0.1303', 'NDCG@20': '0.0557'}
2025-03-02 17:16:11,420 - Validation score increased.  Saving model ...
2025-03-02 17:16:16,356 - {'epoch': 18, 'rec_loss': '5.6372'}
2025-03-02 17:16:16,991 - {'Epoch': 18, 'HR@5': '0.0514', 'NDCG@5': '0.0322', 'HR@10': '0.0817', 'NDCG@10': '0.0420', 'HR@20': '0.1330', 'NDCG@20': '0.0549'}
2025-03-02 17:16:16,993 - EarlyStopping counter: 1 out of 10
2025-03-02 17:16:21,989 - {'epoch': 19, 'rec_loss': '5.6038'}
2025-03-02 17:16:22,586 - {'Epoch': 19, 'HR@5': '0.0550', 'NDCG@5': '0.0331', 'HR@10': '0.0881', 'NDCG@10': '0.0438', 'HR@20': '0.1367', 'NDCG@20': '0.0559'}
2025-03-02 17:16:22,588 - Validation score increased.  Saving model ...
2025-03-02 17:16:27,494 - {'epoch': 20, 'rec_loss': '5.5865'}
2025-03-02 17:16:28,073 - {'Epoch': 20, 'HR@5': '0.0468', 'NDCG@5': '0.0320', 'HR@10': '0.0844', 'NDCG@10': '0.0442', 'HR@20': '0.1367', 'NDCG@20': '0.0572'}
2025-03-02 17:16:28,075 - Validation score increased.  Saving model ...
2025-03-02 17:16:33,449 - {'epoch': 21, 'rec_loss': '5.5480'}
2025-03-02 17:16:33,987 - {'Epoch': 21, 'HR@5': '0.0560', 'NDCG@5': '0.0354', 'HR@10': '0.0881', 'NDCG@10': '0.0456', 'HR@20': '0.1339', 'NDCG@20': '0.0571'}
2025-03-02 17:16:33,989 - EarlyStopping counter: 1 out of 10
2025-03-02 17:16:39,194 - {'epoch': 22, 'rec_loss': '5.5400'}
2025-03-02 17:16:39,801 - {'Epoch': 22, 'HR@5': '0.0569', 'NDCG@5': '0.0371', 'HR@10': '0.0817', 'NDCG@10': '0.0450', 'HR@20': '0.1321', 'NDCG@20': '0.0579'}
2025-03-02 17:16:39,803 - Validation score increased.  Saving model ...
2025-03-02 17:16:44,893 - {'epoch': 23, 'rec_loss': '5.5303'}
2025-03-02 17:16:45,455 - {'Epoch': 23, 'HR@5': '0.0523', 'NDCG@5': '0.0346', 'HR@10': '0.0872', 'NDCG@10': '0.0460', 'HR@20': '0.1367', 'NDCG@20': '0.0586'}
2025-03-02 17:16:45,456 - Validation score increased.  Saving model ...
2025-03-02 17:16:50,410 - {'epoch': 24, 'rec_loss': '5.4914'}
2025-03-02 17:16:50,973 - {'Epoch': 24, 'HR@5': '0.0550', 'NDCG@5': '0.0363', 'HR@10': '0.0890', 'NDCG@10': '0.0472', 'HR@20': '0.1321', 'NDCG@20': '0.0582'}
2025-03-02 17:16:50,974 - EarlyStopping counter: 1 out of 10
2025-03-02 17:16:56,724 - {'epoch': 25, 'rec_loss': '5.4633'}
2025-03-02 17:16:57,280 - {'Epoch': 25, 'HR@5': '0.0541', 'NDCG@5': '0.0350', 'HR@10': '0.0881', 'NDCG@10': '0.0458', 'HR@20': '0.1385', 'NDCG@20': '0.0587'}
2025-03-02 17:16:57,281 - Validation score increased.  Saving model ...
2025-03-02 17:17:02,842 - {'epoch': 26, 'rec_loss': '5.4643'}
2025-03-02 17:17:03,360 - {'Epoch': 26, 'HR@5': '0.0541', 'NDCG@5': '0.0352', 'HR@10': '0.0872', 'NDCG@10': '0.0460', 'HR@20': '0.1394', 'NDCG@20': '0.0591'}
2025-03-02 17:17:03,361 - Validation score increased.  Saving model ...
2025-03-02 17:17:08,703 - {'epoch': 27, 'rec_loss': '5.4512'}
2025-03-02 17:17:09,286 - {'Epoch': 27, 'HR@5': '0.0541', 'NDCG@5': '0.0364', 'HR@10': '0.0881', 'NDCG@10': '0.0472', 'HR@20': '0.1367', 'NDCG@20': '0.0595'}
2025-03-02 17:17:09,287 - Validation score increased.  Saving model ...
2025-03-02 17:17:14,387 - {'epoch': 28, 'rec_loss': '5.4318'}
2025-03-02 17:17:15,049 - {'Epoch': 28, 'HR@5': '0.0596', 'NDCG@5': '0.0388', 'HR@10': '0.0881', 'NDCG@10': '0.0478', 'HR@20': '0.1422', 'NDCG@20': '0.0613'}
2025-03-02 17:17:15,050 - Validation score increased.  Saving model ...
2025-03-02 17:17:19,757 - {'epoch': 29, 'rec_loss': '5.4187'}
2025-03-02 17:17:20,384 - {'Epoch': 29, 'HR@5': '0.0569', 'NDCG@5': '0.0385', 'HR@10': '0.0862', 'NDCG@10': '0.0479', 'HR@20': '0.1394', 'NDCG@20': '0.0613'}
2025-03-02 17:17:20,385 - EarlyStopping counter: 1 out of 10
2025-03-02 17:17:25,442 - {'epoch': 30, 'rec_loss': '5.4090'}
2025-03-02 17:17:26,060 - {'Epoch': 30, 'HR@5': '0.0560', 'NDCG@5': '0.0377', 'HR@10': '0.0853', 'NDCG@10': '0.0470', 'HR@20': '0.1404', 'NDCG@20': '0.0609'}
2025-03-02 17:17:26,061 - EarlyStopping counter: 2 out of 10
2025-03-02 17:17:32,548 - {'epoch': 31, 'rec_loss': '5.4003'}
2025-03-02 17:17:33,167 - {'Epoch': 31, 'HR@5': '0.0606', 'NDCG@5': '0.0399', 'HR@10': '0.0954', 'NDCG@10': '0.0511', 'HR@20': '0.1422', 'NDCG@20': '0.0629'}
2025-03-02 17:17:33,168 - Validation score increased.  Saving model ...
2025-03-02 17:17:39,995 - {'epoch': 32, 'rec_loss': '5.3893'}
2025-03-02 17:17:40,572 - {'Epoch': 32, 'HR@5': '0.0578', 'NDCG@5': '0.0361', 'HR@10': '0.0899', 'NDCG@10': '0.0463', 'HR@20': '0.1413', 'NDCG@20': '0.0592'}
2025-03-02 17:17:40,574 - EarlyStopping counter: 1 out of 10
2025-03-02 17:17:45,670 - {'epoch': 33, 'rec_loss': '5.3682'}
2025-03-02 17:17:46,246 - {'Epoch': 33, 'HR@5': '0.0633', 'NDCG@5': '0.0384', 'HR@10': '0.0936', 'NDCG@10': '0.0483', 'HR@20': '0.1440', 'NDCG@20': '0.0610'}
2025-03-02 17:17:46,247 - EarlyStopping counter: 2 out of 10
2025-03-02 17:17:51,012 - {'epoch': 34, 'rec_loss': '5.3597'}
2025-03-02 17:17:51,551 - {'Epoch': 34, 'HR@5': '0.0661', 'NDCG@5': '0.0405', 'HR@10': '0.0972', 'NDCG@10': '0.0505', 'HR@20': '0.1440', 'NDCG@20': '0.0621'}
2025-03-02 17:17:51,552 - EarlyStopping counter: 3 out of 10
2025-03-02 17:17:56,532 - {'epoch': 35, 'rec_loss': '5.3272'}
2025-03-02 17:17:57,080 - {'Epoch': 35, 'HR@5': '0.0679', 'NDCG@5': '0.0419', 'HR@10': '0.0972', 'NDCG@10': '0.0512', 'HR@20': '0.1459', 'NDCG@20': '0.0634'}
2025-03-02 17:17:57,081 - Validation score increased.  Saving model ...
2025-03-02 17:18:02,060 - {'epoch': 36, 'rec_loss': '5.3236'}
2025-03-02 17:18:02,635 - {'Epoch': 36, 'HR@5': '0.0651', 'NDCG@5': '0.0396', 'HR@10': '0.0890', 'NDCG@10': '0.0473', 'HR@20': '0.1422', 'NDCG@20': '0.0609'}
2025-03-02 17:18:02,636 - EarlyStopping counter: 1 out of 10
2025-03-02 17:18:08,258 - {'epoch': 37, 'rec_loss': '5.3226'}
2025-03-02 17:18:08,872 - {'Epoch': 37, 'HR@5': '0.0606', 'NDCG@5': '0.0381', 'HR@10': '0.0917', 'NDCG@10': '0.0482', 'HR@20': '0.1431', 'NDCG@20': '0.0611'}
2025-03-02 17:18:08,873 - EarlyStopping counter: 2 out of 10
2025-03-02 17:18:13,852 - {'epoch': 38, 'rec_loss': '5.3281'}
2025-03-02 17:18:14,446 - {'Epoch': 38, 'HR@5': '0.0624', 'NDCG@5': '0.0400', 'HR@10': '0.0917', 'NDCG@10': '0.0495', 'HR@20': '0.1459', 'NDCG@20': '0.0631'}
2025-03-02 17:18:14,448 - EarlyStopping counter: 3 out of 10
2025-03-02 17:18:19,349 - {'epoch': 39, 'rec_loss': '5.3192'}
2025-03-02 17:18:19,880 - {'Epoch': 39, 'HR@5': '0.0606', 'NDCG@5': '0.0380', 'HR@10': '0.0945', 'NDCG@10': '0.0489', 'HR@20': '0.1468', 'NDCG@20': '0.0621'}
2025-03-02 17:18:19,881 - EarlyStopping counter: 4 out of 10
2025-03-02 17:18:25,017 - {'epoch': 40, 'rec_loss': '5.2792'}
2025-03-02 17:18:25,545 - {'Epoch': 40, 'HR@5': '0.0633', 'NDCG@5': '0.0412', 'HR@10': '0.0991', 'NDCG@10': '0.0526', 'HR@20': '0.1422', 'NDCG@20': '0.0635'}
2025-03-02 17:18:25,546 - Validation score increased.  Saving model ...
2025-03-02 17:18:30,278 - {'epoch': 41, 'rec_loss': '5.2948'}
2025-03-02 17:18:30,817 - {'Epoch': 41, 'HR@5': '0.0606', 'NDCG@5': '0.0407', 'HR@10': '0.0936', 'NDCG@10': '0.0515', 'HR@20': '0.1431', 'NDCG@20': '0.0640'}
2025-03-02 17:18:30,819 - Validation score increased.  Saving model ...
2025-03-02 17:18:36,016 - {'epoch': 42, 'rec_loss': '5.2947'}
2025-03-02 17:18:36,680 - {'Epoch': 42, 'HR@5': '0.0633', 'NDCG@5': '0.0410', 'HR@10': '0.0963', 'NDCG@10': '0.0517', 'HR@20': '0.1459', 'NDCG@20': '0.0640'}
2025-03-02 17:18:36,682 - EarlyStopping counter: 1 out of 10
2025-03-02 17:18:42,214 - {'epoch': 43, 'rec_loss': '5.2620'}
2025-03-02 17:18:42,842 - {'Epoch': 43, 'HR@5': '0.0624', 'NDCG@5': '0.0393', 'HR@10': '0.0945', 'NDCG@10': '0.0496', 'HR@20': '0.1468', 'NDCG@20': '0.0628'}
2025-03-02 17:18:42,843 - EarlyStopping counter: 2 out of 10
2025-03-02 17:18:47,527 - {'epoch': 44, 'rec_loss': '5.2702'}
2025-03-02 17:18:48,100 - {'Epoch': 44, 'HR@5': '0.0578', 'NDCG@5': '0.0406', 'HR@10': '0.0972', 'NDCG@10': '0.0534', 'HR@20': '0.1358', 'NDCG@20': '0.0630'}
2025-03-02 17:18:48,101 - EarlyStopping counter: 3 out of 10
2025-03-02 17:18:53,395 - {'epoch': 45, 'rec_loss': '5.2639'}
2025-03-02 17:18:53,947 - {'Epoch': 45, 'HR@5': '0.0615', 'NDCG@5': '0.0417', 'HR@10': '0.0927', 'NDCG@10': '0.0519', 'HR@20': '0.1404', 'NDCG@20': '0.0639'}
2025-03-02 17:18:53,948 - EarlyStopping counter: 4 out of 10
2025-03-02 17:18:58,574 - {'epoch': 46, 'rec_loss': '5.2491'}
2025-03-02 17:18:59,166 - {'Epoch': 46, 'HR@5': '0.0661', 'NDCG@5': '0.0422', 'HR@10': '0.0963', 'NDCG@10': '0.0520', 'HR@20': '0.1440', 'NDCG@20': '0.0639'}
2025-03-02 17:18:59,167 - EarlyStopping counter: 5 out of 10
2025-03-02 17:19:03,926 - {'epoch': 47, 'rec_loss': '5.2453'}
2025-03-02 17:19:04,449 - {'Epoch': 47, 'HR@5': '0.0661', 'NDCG@5': '0.0412', 'HR@10': '0.0936', 'NDCG@10': '0.0501', 'HR@20': '0.1422', 'NDCG@20': '0.0622'}
2025-03-02 17:19:04,450 - EarlyStopping counter: 6 out of 10
2025-03-02 17:19:09,523 - {'epoch': 48, 'rec_loss': '5.2547'}
2025-03-02 17:19:10,110 - {'Epoch': 48, 'HR@5': '0.0661', 'NDCG@5': '0.0417', 'HR@10': '0.0936', 'NDCG@10': '0.0507', 'HR@20': '0.1495', 'NDCG@20': '0.0648'}
2025-03-02 17:19:10,111 - Validation score increased.  Saving model ...
2025-03-02 17:19:15,742 - {'epoch': 49, 'rec_loss': '5.2394'}
2025-03-02 17:19:16,351 - {'Epoch': 49, 'HR@5': '0.0615', 'NDCG@5': '0.0389', 'HR@10': '0.0972', 'NDCG@10': '0.0502', 'HR@20': '0.1440', 'NDCG@20': '0.0621'}
2025-03-02 17:19:16,352 - EarlyStopping counter: 1 out of 10
2025-03-02 17:19:20,997 - {'epoch': 50, 'rec_loss': '5.2352'}
2025-03-02 17:19:21,614 - {'Epoch': 50, 'HR@5': '0.0596', 'NDCG@5': '0.0372', 'HR@10': '0.0982', 'NDCG@10': '0.0498', 'HR@20': '0.1404', 'NDCG@20': '0.0604'}
2025-03-02 17:19:21,615 - EarlyStopping counter: 2 out of 10
2025-03-02 17:19:26,213 - {'epoch': 51, 'rec_loss': '5.2214'}
2025-03-02 17:19:26,769 - {'Epoch': 51, 'HR@5': '0.0670', 'NDCG@5': '0.0409', 'HR@10': '0.0972', 'NDCG@10': '0.0505', 'HR@20': '0.1450', 'NDCG@20': '0.0625'}
2025-03-02 17:19:26,771 - EarlyStopping counter: 3 out of 10
2025-03-02 17:19:31,529 - {'epoch': 52, 'rec_loss': '5.2114'}
2025-03-02 17:19:32,116 - {'Epoch': 52, 'HR@5': '0.0642', 'NDCG@5': '0.0394', 'HR@10': '0.0982', 'NDCG@10': '0.0505', 'HR@20': '0.1404', 'NDCG@20': '0.0611'}
2025-03-02 17:19:32,117 - EarlyStopping counter: 4 out of 10
2025-03-02 17:19:38,418 - {'epoch': 53, 'rec_loss': '5.2219'}
2025-03-02 17:19:39,117 - {'Epoch': 53, 'HR@5': '0.0697', 'NDCG@5': '0.0431', 'HR@10': '0.0972', 'NDCG@10': '0.0520', 'HR@20': '0.1486', 'NDCG@20': '0.0649'}
2025-03-02 17:19:39,119 - Validation score increased.  Saving model ...
2025-03-02 17:19:46,107 - {'epoch': 54, 'rec_loss': '5.1978'}
2025-03-02 17:19:46,680 - {'Epoch': 54, 'HR@5': '0.0615', 'NDCG@5': '0.0398', 'HR@10': '0.0972', 'NDCG@10': '0.0515', 'HR@20': '0.1431', 'NDCG@20': '0.0633'}
2025-03-02 17:19:46,681 - EarlyStopping counter: 1 out of 10
2025-03-02 17:19:51,698 - {'epoch': 55, 'rec_loss': '5.1866'}
2025-03-02 17:19:52,332 - {'Epoch': 55, 'HR@5': '0.0651', 'NDCG@5': '0.0430', 'HR@10': '0.1018', 'NDCG@10': '0.0547', 'HR@20': '0.1440', 'NDCG@20': '0.0654'}
2025-03-02 17:19:52,334 - Validation score increased.  Saving model ...
2025-03-02 17:19:57,160 - {'epoch': 56, 'rec_loss': '5.1937'}
2025-03-02 17:19:57,665 - {'Epoch': 56, 'HR@5': '0.0633', 'NDCG@5': '0.0414', 'HR@10': '0.0972', 'NDCG@10': '0.0523', 'HR@20': '0.1486', 'NDCG@20': '0.0653'}
2025-03-02 17:19:57,667 - EarlyStopping counter: 1 out of 10
2025-03-02 17:20:02,704 - {'epoch': 57, 'rec_loss': '5.2207'}
2025-03-02 17:20:03,320 - {'Epoch': 57, 'HR@5': '0.0569', 'NDCG@5': '0.0379', 'HR@10': '0.0982', 'NDCG@10': '0.0511', 'HR@20': '0.1486', 'NDCG@20': '0.0640'}
2025-03-02 17:20:03,321 - EarlyStopping counter: 2 out of 10
2025-03-02 17:20:08,187 - {'epoch': 58, 'rec_loss': '5.2129'}
2025-03-02 17:20:08,810 - {'Epoch': 58, 'HR@5': '0.0642', 'NDCG@5': '0.0411', 'HR@10': '0.1009', 'NDCG@10': '0.0528', 'HR@20': '0.1413', 'NDCG@20': '0.0628'}
2025-03-02 17:20:08,811 - EarlyStopping counter: 3 out of 10
2025-03-02 17:20:14,473 - {'epoch': 59, 'rec_loss': '5.1975'}
2025-03-02 17:20:15,085 - {'Epoch': 59, 'HR@5': '0.0624', 'NDCG@5': '0.0410', 'HR@10': '0.1046', 'NDCG@10': '0.0546', 'HR@20': '0.1468', 'NDCG@20': '0.0652'}
2025-03-02 17:20:15,086 - EarlyStopping counter: 4 out of 10
2025-03-02 17:20:19,916 - {'epoch': 60, 'rec_loss': '5.1722'}
2025-03-02 17:20:20,538 - {'Epoch': 60, 'HR@5': '0.0615', 'NDCG@5': '0.0399', 'HR@10': '0.1037', 'NDCG@10': '0.0532', 'HR@20': '0.1422', 'NDCG@20': '0.0629'}
2025-03-02 17:20:20,539 - EarlyStopping counter: 5 out of 10
2025-03-02 17:20:25,432 - {'epoch': 61, 'rec_loss': '5.1684'}
2025-03-02 17:20:26,076 - {'Epoch': 61, 'HR@5': '0.0651', 'NDCG@5': '0.0430', 'HR@10': '0.1000', 'NDCG@10': '0.0541', 'HR@20': '0.1440', 'NDCG@20': '0.0652'}
2025-03-02 17:20:26,078 - EarlyStopping counter: 6 out of 10
2025-03-02 17:20:30,938 - {'epoch': 62, 'rec_loss': '5.1827'}
2025-03-02 17:20:31,550 - {'Epoch': 62, 'HR@5': '0.0697', 'NDCG@5': '0.0440', 'HR@10': '0.1037', 'NDCG@10': '0.0548', 'HR@20': '0.1450', 'NDCG@20': '0.0651'}
2025-03-02 17:20:31,551 - EarlyStopping counter: 7 out of 10
2025-03-02 17:20:36,187 - {'epoch': 63, 'rec_loss': '5.1745'}
2025-03-02 17:20:36,793 - {'Epoch': 63, 'HR@5': '0.0624', 'NDCG@5': '0.0407', 'HR@10': '0.1009', 'NDCG@10': '0.0533', 'HR@20': '0.1450', 'NDCG@20': '0.0644'}
2025-03-02 17:20:36,794 - EarlyStopping counter: 8 out of 10
2025-03-02 17:20:42,103 - {'epoch': 64, 'rec_loss': '5.1647'}
2025-03-02 17:20:42,732 - {'Epoch': 64, 'HR@5': '0.0706', 'NDCG@5': '0.0454', 'HR@10': '0.0982', 'NDCG@10': '0.0542', 'HR@20': '0.1440', 'NDCG@20': '0.0657'}
2025-03-02 17:20:42,733 - Validation score increased.  Saving model ...
2025-03-02 17:20:47,562 - {'epoch': 65, 'rec_loss': '5.1773'}
2025-03-02 17:20:48,143 - {'Epoch': 65, 'HR@5': '0.0615', 'NDCG@5': '0.0410', 'HR@10': '0.1000', 'NDCG@10': '0.0535', 'HR@20': '0.1431', 'NDCG@20': '0.0645'}
2025-03-02 17:20:48,144 - EarlyStopping counter: 1 out of 10
2025-03-02 17:20:53,089 - {'epoch': 66, 'rec_loss': '5.1512'}
2025-03-02 17:20:53,688 - {'Epoch': 66, 'HR@5': '0.0606', 'NDCG@5': '0.0399', 'HR@10': '0.1018', 'NDCG@10': '0.0533', 'HR@20': '0.1385', 'NDCG@20': '0.0624'}
2025-03-02 17:20:53,690 - EarlyStopping counter: 2 out of 10
2025-03-02 17:20:58,340 - {'epoch': 67, 'rec_loss': '5.1649'}
2025-03-02 17:20:58,928 - {'Epoch': 67, 'HR@5': '0.0661', 'NDCG@5': '0.0414', 'HR@10': '0.1018', 'NDCG@10': '0.0528', 'HR@20': '0.1440', 'NDCG@20': '0.0634'}
2025-03-02 17:20:58,929 - EarlyStopping counter: 3 out of 10
2025-03-02 17:21:03,556 - {'epoch': 68, 'rec_loss': '5.1635'}
2025-03-02 17:21:04,205 - {'Epoch': 68, 'HR@5': '0.0661', 'NDCG@5': '0.0427', 'HR@10': '0.1083', 'NDCG@10': '0.0562', 'HR@20': '0.1440', 'NDCG@20': '0.0653'}
2025-03-02 17:21:04,207 - EarlyStopping counter: 4 out of 10
2025-03-02 17:21:09,542 - {'epoch': 69, 'rec_loss': '5.1521'}
2025-03-02 17:21:10,077 - {'Epoch': 69, 'HR@5': '0.0706', 'NDCG@5': '0.0449', 'HR@10': '0.1073', 'NDCG@10': '0.0566', 'HR@20': '0.1431', 'NDCG@20': '0.0657'}
2025-03-02 17:21:10,079 - EarlyStopping counter: 5 out of 10
2025-03-02 17:21:14,822 - {'epoch': 70, 'rec_loss': '5.1407'}
2025-03-02 17:21:15,471 - {'Epoch': 70, 'HR@5': '0.0679', 'NDCG@5': '0.0463', 'HR@10': '0.1064', 'NDCG@10': '0.0588', 'HR@20': '0.1523', 'NDCG@20': '0.0703'}
2025-03-02 17:21:15,472 - Validation score increased.  Saving model ...
2025-03-02 17:21:20,456 - {'epoch': 71, 'rec_loss': '5.1319'}
2025-03-02 17:21:21,031 - {'Epoch': 71, 'HR@5': '0.0679', 'NDCG@5': '0.0444', 'HR@10': '0.1055', 'NDCG@10': '0.0566', 'HR@20': '0.1468', 'NDCG@20': '0.0670'}
2025-03-02 17:21:21,033 - EarlyStopping counter: 1 out of 10
2025-03-02 17:21:26,225 - {'epoch': 72, 'rec_loss': '5.1145'}
2025-03-02 17:21:26,747 - {'Epoch': 72, 'HR@5': '0.0661', 'NDCG@5': '0.0430', 'HR@10': '0.1009', 'NDCG@10': '0.0544', 'HR@20': '0.1450', 'NDCG@20': '0.0655'}
2025-03-02 17:21:26,748 - EarlyStopping counter: 2 out of 10
2025-03-02 17:21:31,973 - {'epoch': 73, 'rec_loss': '5.1319'}
2025-03-02 17:21:32,519 - {'Epoch': 73, 'HR@5': '0.0661', 'NDCG@5': '0.0427', 'HR@10': '0.0991', 'NDCG@10': '0.0534', 'HR@20': '0.1431', 'NDCG@20': '0.0646'}
2025-03-02 17:21:32,520 - EarlyStopping counter: 3 out of 10
2025-03-02 17:21:37,495 - {'epoch': 74, 'rec_loss': '5.1185'}
2025-03-02 17:21:38,119 - {'Epoch': 74, 'HR@5': '0.0697', 'NDCG@5': '0.0474', 'HR@10': '0.0991', 'NDCG@10': '0.0567', 'HR@20': '0.1523', 'NDCG@20': '0.0700'}
2025-03-02 17:21:38,120 - EarlyStopping counter: 4 out of 10
2025-03-02 17:21:42,867 - {'epoch': 75, 'rec_loss': '5.1572'}
2025-03-02 17:21:43,415 - {'Epoch': 75, 'HR@5': '0.0661', 'NDCG@5': '0.0403', 'HR@10': '0.1018', 'NDCG@10': '0.0514', 'HR@20': '0.1486', 'NDCG@20': '0.0633'}
2025-03-02 17:21:43,417 - EarlyStopping counter: 5 out of 10
2025-03-02 17:21:50,410 - {'epoch': 76, 'rec_loss': '5.1037'}
2025-03-02 17:21:51,118 - {'Epoch': 76, 'HR@5': '0.0587', 'NDCG@5': '0.0398', 'HR@10': '0.1037', 'NDCG@10': '0.0541', 'HR@20': '0.1468', 'NDCG@20': '0.0649'}
2025-03-02 17:21:51,120 - EarlyStopping counter: 6 out of 10
2025-03-02 17:21:58,648 - {'epoch': 77, 'rec_loss': '5.1047'}
2025-03-02 17:21:59,275 - {'Epoch': 77, 'HR@5': '0.0670', 'NDCG@5': '0.0430', 'HR@10': '0.1018', 'NDCG@10': '0.0541', 'HR@20': '0.1477', 'NDCG@20': '0.0658'}
2025-03-02 17:21:59,276 - EarlyStopping counter: 7 out of 10
2025-03-02 17:22:06,352 - {'epoch': 78, 'rec_loss': '5.1025'}
2025-03-02 17:22:07,013 - {'Epoch': 78, 'HR@5': '0.0642', 'NDCG@5': '0.0435', 'HR@10': '0.1037', 'NDCG@10': '0.0562', 'HR@20': '0.1495', 'NDCG@20': '0.0677'}
2025-03-02 17:22:07,015 - EarlyStopping counter: 8 out of 10
2025-03-02 17:22:13,712 - {'epoch': 79, 'rec_loss': '5.0955'}
2025-03-02 17:22:14,301 - {'Epoch': 79, 'HR@5': '0.0697', 'NDCG@5': '0.0443', 'HR@10': '0.0991', 'NDCG@10': '0.0538', 'HR@20': '0.1514', 'NDCG@20': '0.0668'}
2025-03-02 17:22:14,303 - EarlyStopping counter: 9 out of 10
2025-03-02 17:22:20,162 - {'epoch': 80, 'rec_loss': '5.0985'}
2025-03-02 17:22:20,781 - {'Epoch': 80, 'HR@5': '0.0642', 'NDCG@5': '0.0420', 'HR@10': '0.1046', 'NDCG@10': '0.0549', 'HR@20': '0.1440', 'NDCG@20': '0.0649'}
2025-03-02 17:22:20,782 - EarlyStopping counter: 10 out of 10
2025-03-02 17:22:20,783 - Early stopping
2025-03-02 17:22:20,783 - ---------------Test Score---------------
2025-03-02 17:22:21,443 - {'Epoch': 0, 'HR@5': '0.0569', 'NDCG@5': '0.0360', 'HR@10': '0.0743', 'NDCG@10': '0.0418', 'HR@20': '0.1028', 'NDCG@20': '0.0488'}
2025-03-02 17:22:21,445 - Scale_LastFM
2025-03-02 17:22:21,445 - {'Epoch': 0, 'HR@5': '0.0569', 'NDCG@5': '0.0360', 'HR@10': '0.0743', 'NDCG@10': '0.0418', 'HR@20': '0.1028', 'NDCG@20': '0.0488'}
2025-03-02 17:26:08,357 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[12, 24, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-03-02 17:26:11,182 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-02 17:26:11,186 - Total Parameters: 387350
2025-03-02 17:26:17,656 - {'epoch': 0, 'rec_loss': '8.0391'}
2025-03-02 17:26:18,224 - {'Epoch': 0, 'HR@5': '0.0202', 'NDCG@5': '0.0143', 'HR@10': '0.0358', 'NDCG@10': '0.0194', 'HR@20': '0.0642', 'NDCG@20': '0.0265'}
2025-03-02 17:26:18,225 - Validation score increased.  Saving model ...
2025-03-02 17:26:23,554 - {'epoch': 1, 'rec_loss': '7.7577'}
2025-03-02 17:26:24,096 - {'Epoch': 1, 'HR@5': '0.0211', 'NDCG@5': '0.0147', 'HR@10': '0.0367', 'NDCG@10': '0.0198', 'HR@20': '0.0642', 'NDCG@20': '0.0266'}
2025-03-02 17:26:24,098 - Validation score increased.  Saving model ...
2025-03-02 17:26:29,346 - {'epoch': 2, 'rec_loss': '7.5515'}
2025-03-02 17:26:29,908 - {'Epoch': 2, 'HR@5': '0.0303', 'NDCG@5': '0.0202', 'HR@10': '0.0468', 'NDCG@10': '0.0254', 'HR@20': '0.0679', 'NDCG@20': '0.0307'}
2025-03-02 17:26:29,910 - Validation score increased.  Saving model ...
2025-03-02 17:26:34,842 - {'epoch': 3, 'rec_loss': '7.3275'}
2025-03-02 17:26:35,404 - {'Epoch': 3, 'HR@5': '0.0330', 'NDCG@5': '0.0212', 'HR@10': '0.0486', 'NDCG@10': '0.0261', 'HR@20': '0.0734', 'NDCG@20': '0.0322'}
2025-03-02 17:26:35,405 - Validation score increased.  Saving model ...
2025-03-02 17:26:40,240 - {'epoch': 4, 'rec_loss': '7.1203'}
2025-03-02 17:26:40,886 - {'Epoch': 4, 'HR@5': '0.0349', 'NDCG@5': '0.0236', 'HR@10': '0.0578', 'NDCG@10': '0.0307', 'HR@20': '0.0881', 'NDCG@20': '0.0383'}
2025-03-02 17:26:40,888 - Validation score increased.  Saving model ...
2025-03-02 17:26:46,335 - {'epoch': 5, 'rec_loss': '6.9144'}
2025-03-02 17:26:46,964 - {'Epoch': 5, 'HR@5': '0.0358', 'NDCG@5': '0.0252', 'HR@10': '0.0523', 'NDCG@10': '0.0306', 'HR@20': '0.0908', 'NDCG@20': '0.0403'}
2025-03-02 17:26:46,965 - Validation score increased.  Saving model ...
2025-03-02 17:26:51,493 - {'epoch': 6, 'rec_loss': '6.7195'}
2025-03-02 17:26:52,081 - {'Epoch': 6, 'HR@5': '0.0450', 'NDCG@5': '0.0257', 'HR@10': '0.0651', 'NDCG@10': '0.0323', 'HR@20': '0.0936', 'NDCG@20': '0.0394'}
2025-03-02 17:26:52,083 - EarlyStopping counter: 1 out of 10
2025-03-02 17:26:56,950 - {'epoch': 7, 'rec_loss': '6.5430'}
2025-03-02 17:26:57,523 - {'Epoch': 7, 'HR@5': '0.0431', 'NDCG@5': '0.0271', 'HR@10': '0.0679', 'NDCG@10': '0.0350', 'HR@20': '0.0991', 'NDCG@20': '0.0427'}
2025-03-02 17:26:57,525 - Validation score increased.  Saving model ...
2025-03-02 17:27:02,258 - {'epoch': 8, 'rec_loss': '6.3809'}
2025-03-02 17:27:02,847 - {'Epoch': 8, 'HR@5': '0.0440', 'NDCG@5': '0.0275', 'HR@10': '0.0679', 'NDCG@10': '0.0351', 'HR@20': '0.1064', 'NDCG@20': '0.0448'}
2025-03-02 17:27:02,848 - Validation score increased.  Saving model ...
2025-03-02 17:27:07,746 - {'epoch': 9, 'rec_loss': '6.2658'}
2025-03-02 17:27:08,278 - {'Epoch': 9, 'HR@5': '0.0468', 'NDCG@5': '0.0291', 'HR@10': '0.0752', 'NDCG@10': '0.0381', 'HR@20': '0.1138', 'NDCG@20': '0.0477'}
2025-03-02 17:27:08,280 - Validation score increased.  Saving model ...
2025-03-02 17:27:13,033 - {'epoch': 10, 'rec_loss': '6.1287'}
2025-03-02 17:27:13,555 - {'Epoch': 10, 'HR@5': '0.0450', 'NDCG@5': '0.0294', 'HR@10': '0.0734', 'NDCG@10': '0.0386', 'HR@20': '0.1119', 'NDCG@20': '0.0484'}
2025-03-02 17:27:13,556 - Validation score increased.  Saving model ...
2025-03-02 17:27:18,243 - {'epoch': 11, 'rec_loss': '6.0565'}
2025-03-02 17:27:18,821 - {'Epoch': 11, 'HR@5': '0.0505', 'NDCG@5': '0.0325', 'HR@10': '0.0734', 'NDCG@10': '0.0397', 'HR@20': '0.1156', 'NDCG@20': '0.0502'}
2025-03-02 17:27:18,822 - Validation score increased.  Saving model ...
2025-03-02 17:27:23,475 - {'epoch': 12, 'rec_loss': '5.9678'}
2025-03-02 17:27:23,989 - {'Epoch': 12, 'HR@5': '0.0450', 'NDCG@5': '0.0309', 'HR@10': '0.0761', 'NDCG@10': '0.0408', 'HR@20': '0.1229', 'NDCG@20': '0.0526'}
2025-03-02 17:27:23,990 - Validation score increased.  Saving model ...
2025-03-02 17:27:28,880 - {'epoch': 13, 'rec_loss': '5.8840'}
2025-03-02 17:27:29,438 - {'Epoch': 13, 'HR@5': '0.0422', 'NDCG@5': '0.0289', 'HR@10': '0.0789', 'NDCG@10': '0.0404', 'HR@20': '0.1193', 'NDCG@20': '0.0508'}
2025-03-02 17:27:29,439 - EarlyStopping counter: 1 out of 10
2025-03-02 17:27:34,478 - {'epoch': 14, 'rec_loss': '5.8177'}
2025-03-02 17:27:35,014 - {'Epoch': 14, 'HR@5': '0.0450', 'NDCG@5': '0.0296', 'HR@10': '0.0780', 'NDCG@10': '0.0401', 'HR@20': '0.1229', 'NDCG@20': '0.0514'}
2025-03-02 17:27:35,015 - EarlyStopping counter: 2 out of 10
2025-03-02 17:27:39,727 - {'epoch': 15, 'rec_loss': '5.7750'}
2025-03-02 17:27:40,318 - {'Epoch': 15, 'HR@5': '0.0541', 'NDCG@5': '0.0354', 'HR@10': '0.0835', 'NDCG@10': '0.0446', 'HR@20': '0.1239', 'NDCG@20': '0.0547'}
2025-03-02 17:27:40,319 - Validation score increased.  Saving model ...
2025-03-02 17:27:45,002 - {'epoch': 16, 'rec_loss': '5.7397'}
2025-03-02 17:27:45,591 - {'Epoch': 16, 'HR@5': '0.0495', 'NDCG@5': '0.0337', 'HR@10': '0.0752', 'NDCG@10': '0.0419', 'HR@20': '0.1257', 'NDCG@20': '0.0547'}
2025-03-02 17:27:45,592 - Validation score increased.  Saving model ...
2025-03-02 17:27:50,260 - {'epoch': 17, 'rec_loss': '5.6910'}
2025-03-02 17:27:50,803 - {'Epoch': 17, 'HR@5': '0.0514', 'NDCG@5': '0.0342', 'HR@10': '0.0807', 'NDCG@10': '0.0435', 'HR@20': '0.1284', 'NDCG@20': '0.0555'}
2025-03-02 17:27:50,805 - Validation score increased.  Saving model ...
2025-03-02 17:27:56,185 - {'epoch': 18, 'rec_loss': '5.6428'}
2025-03-02 17:27:56,764 - {'Epoch': 18, 'HR@5': '0.0514', 'NDCG@5': '0.0327', 'HR@10': '0.0798', 'NDCG@10': '0.0418', 'HR@20': '0.1339', 'NDCG@20': '0.0554'}
2025-03-02 17:27:56,765 - EarlyStopping counter: 1 out of 10
2025-03-02 17:28:01,821 - {'epoch': 19, 'rec_loss': '5.6090'}
2025-03-02 17:28:02,399 - {'Epoch': 19, 'HR@5': '0.0550', 'NDCG@5': '0.0333', 'HR@10': '0.0872', 'NDCG@10': '0.0437', 'HR@20': '0.1339', 'NDCG@20': '0.0555'}
2025-03-02 17:28:02,400 - Validation score increased.  Saving model ...
2025-03-02 17:28:07,773 - {'epoch': 20, 'rec_loss': '5.5922'}
2025-03-02 17:28:08,328 - {'Epoch': 20, 'HR@5': '0.0514', 'NDCG@5': '0.0332', 'HR@10': '0.0862', 'NDCG@10': '0.0443', 'HR@20': '0.1339', 'NDCG@20': '0.0562'}
2025-03-02 17:28:08,329 - Validation score increased.  Saving model ...
2025-03-02 17:28:13,024 - {'epoch': 21, 'rec_loss': '5.5538'}
2025-03-02 17:28:13,650 - {'Epoch': 21, 'HR@5': '0.0541', 'NDCG@5': '0.0352', 'HR@10': '0.0853', 'NDCG@10': '0.0453', 'HR@20': '0.1303', 'NDCG@20': '0.0568'}
2025-03-02 17:28:13,652 - Validation score increased.  Saving model ...
2025-03-02 17:28:18,368 - {'epoch': 22, 'rec_loss': '5.5456'}
2025-03-02 17:28:18,906 - {'Epoch': 22, 'HR@5': '0.0541', 'NDCG@5': '0.0363', 'HR@10': '0.0844', 'NDCG@10': '0.0462', 'HR@20': '0.1284', 'NDCG@20': '0.0574'}
2025-03-02 17:28:18,907 - Validation score increased.  Saving model ...
2025-03-02 17:28:23,634 - {'epoch': 23, 'rec_loss': '5.5348'}
2025-03-02 17:28:24,160 - {'Epoch': 23, 'HR@5': '0.0523', 'NDCG@5': '0.0340', 'HR@10': '0.0881', 'NDCG@10': '0.0457', 'HR@20': '0.1367', 'NDCG@20': '0.0580'}
2025-03-02 17:28:24,161 - Validation score increased.  Saving model ...
2025-03-02 17:28:29,284 - {'epoch': 24, 'rec_loss': '5.4964'}
2025-03-02 17:28:29,885 - {'Epoch': 24, 'HR@5': '0.0532', 'NDCG@5': '0.0349', 'HR@10': '0.0835', 'NDCG@10': '0.0448', 'HR@20': '0.1339', 'NDCG@20': '0.0577'}
2025-03-02 17:28:29,887 - EarlyStopping counter: 1 out of 10
2025-03-02 17:28:34,759 - {'epoch': 25, 'rec_loss': '5.4689'}
2025-03-02 17:28:35,337 - {'Epoch': 25, 'HR@5': '0.0523', 'NDCG@5': '0.0343', 'HR@10': '0.0927', 'NDCG@10': '0.0472', 'HR@20': '0.1385', 'NDCG@20': '0.0588'}
2025-03-02 17:28:35,338 - Validation score increased.  Saving model ...
2025-03-02 17:28:41,572 - {'epoch': 26, 'rec_loss': '5.4693'}
2025-03-02 17:28:42,204 - {'Epoch': 26, 'HR@5': '0.0532', 'NDCG@5': '0.0348', 'HR@10': '0.0826', 'NDCG@10': '0.0444', 'HR@20': '0.1394', 'NDCG@20': '0.0588'}
2025-03-02 17:28:42,205 - Validation score increased.  Saving model ...
2025-03-02 17:28:50,124 - {'epoch': 27, 'rec_loss': '5.4556'}
2025-03-02 17:28:50,752 - {'Epoch': 27, 'HR@5': '0.0532', 'NDCG@5': '0.0360', 'HR@10': '0.0862', 'NDCG@10': '0.0465', 'HR@20': '0.1330', 'NDCG@20': '0.0584'}
2025-03-02 17:28:50,753 - EarlyStopping counter: 1 out of 10
2025-03-02 17:28:56,391 - {'epoch': 28, 'rec_loss': '5.4376'}
2025-03-02 17:28:56,903 - {'Epoch': 28, 'HR@5': '0.0560', 'NDCG@5': '0.0371', 'HR@10': '0.0872', 'NDCG@10': '0.0470', 'HR@20': '0.1404', 'NDCG@20': '0.0604'}
2025-03-02 17:28:56,904 - Validation score increased.  Saving model ...
2025-03-02 17:29:03,685 - {'epoch': 29, 'rec_loss': '5.4238'}
2025-03-02 17:29:04,321 - {'Epoch': 29, 'HR@5': '0.0569', 'NDCG@5': '0.0384', 'HR@10': '0.0853', 'NDCG@10': '0.0475', 'HR@20': '0.1394', 'NDCG@20': '0.0611'}
2025-03-02 17:29:04,322 - Validation score increased.  Saving model ...
2025-03-02 17:29:11,481 - {'epoch': 30, 'rec_loss': '5.4149'}
2025-03-02 17:29:12,066 - {'Epoch': 30, 'HR@5': '0.0541', 'NDCG@5': '0.0371', 'HR@10': '0.0853', 'NDCG@10': '0.0471', 'HR@20': '0.1404', 'NDCG@20': '0.0609'}
2025-03-02 17:29:12,067 - EarlyStopping counter: 1 out of 10
2025-03-02 17:29:16,812 - {'epoch': 31, 'rec_loss': '5.4042'}
2025-03-02 17:29:17,351 - {'Epoch': 31, 'HR@5': '0.0615', 'NDCG@5': '0.0392', 'HR@10': '0.0936', 'NDCG@10': '0.0495', 'HR@20': '0.1431', 'NDCG@20': '0.0619'}
2025-03-02 17:29:17,352 - Validation score increased.  Saving model ...
2025-03-02 17:29:22,438 - {'epoch': 32, 'rec_loss': '5.3931'}
2025-03-02 17:29:23,028 - {'Epoch': 32, 'HR@5': '0.0596', 'NDCG@5': '0.0377', 'HR@10': '0.0917', 'NDCG@10': '0.0480', 'HR@20': '0.1422', 'NDCG@20': '0.0606'}
2025-03-02 17:29:23,029 - EarlyStopping counter: 1 out of 10
2025-03-02 17:29:27,878 - {'epoch': 33, 'rec_loss': '5.3743'}
2025-03-02 17:29:28,472 - {'Epoch': 33, 'HR@5': '0.0615', 'NDCG@5': '0.0383', 'HR@10': '0.0927', 'NDCG@10': '0.0484', 'HR@20': '0.1431', 'NDCG@20': '0.0611'}
2025-03-02 17:29:28,473 - EarlyStopping counter: 2 out of 10
2025-03-02 17:29:33,408 - {'epoch': 34, 'rec_loss': '5.3650'}
2025-03-02 17:29:34,003 - {'Epoch': 34, 'HR@5': '0.0642', 'NDCG@5': '0.0394', 'HR@10': '0.0945', 'NDCG@10': '0.0492', 'HR@20': '0.1394', 'NDCG@20': '0.0607'}
2025-03-02 17:29:34,004 - EarlyStopping counter: 3 out of 10
2025-03-02 17:29:39,169 - {'epoch': 35, 'rec_loss': '5.3322'}
2025-03-02 17:29:39,702 - {'Epoch': 35, 'HR@5': '0.0633', 'NDCG@5': '0.0402', 'HR@10': '0.0954', 'NDCG@10': '0.0505', 'HR@20': '0.1477', 'NDCG@20': '0.0636'}
2025-03-02 17:29:39,703 - Validation score increased.  Saving model ...
2025-03-02 17:29:44,841 - {'epoch': 36, 'rec_loss': '5.3285'}
2025-03-02 17:29:45,448 - {'Epoch': 36, 'HR@5': '0.0606', 'NDCG@5': '0.0373', 'HR@10': '0.0917', 'NDCG@10': '0.0475', 'HR@20': '0.1404', 'NDCG@20': '0.0599'}
2025-03-02 17:29:45,449 - EarlyStopping counter: 1 out of 10
2025-03-02 17:29:50,803 - {'epoch': 37, 'rec_loss': '5.3264'}
2025-03-02 17:29:51,343 - {'Epoch': 37, 'HR@5': '0.0596', 'NDCG@5': '0.0381', 'HR@10': '0.0899', 'NDCG@10': '0.0479', 'HR@20': '0.1450', 'NDCG@20': '0.0618'}
2025-03-02 17:29:51,344 - EarlyStopping counter: 2 out of 10
2025-03-02 17:29:56,252 - {'epoch': 38, 'rec_loss': '5.3321'}
2025-03-02 17:29:56,792 - {'Epoch': 38, 'HR@5': '0.0578', 'NDCG@5': '0.0381', 'HR@10': '0.0936', 'NDCG@10': '0.0496', 'HR@20': '0.1431', 'NDCG@20': '0.0620'}
2025-03-02 17:29:56,794 - EarlyStopping counter: 3 out of 10
2025-03-02 17:30:01,763 - {'epoch': 39, 'rec_loss': '5.3224'}
2025-03-02 17:30:02,322 - {'Epoch': 39, 'HR@5': '0.0624', 'NDCG@5': '0.0383', 'HR@10': '0.0945', 'NDCG@10': '0.0485', 'HR@20': '0.1450', 'NDCG@20': '0.0612'}
2025-03-02 17:30:02,323 - EarlyStopping counter: 4 out of 10
2025-03-02 17:30:07,127 - {'epoch': 40, 'rec_loss': '5.2844'}
2025-03-02 17:30:07,652 - {'Epoch': 40, 'HR@5': '0.0606', 'NDCG@5': '0.0405', 'HR@10': '0.0954', 'NDCG@10': '0.0517', 'HR@20': '0.1431', 'NDCG@20': '0.0637'}
2025-03-02 17:30:07,653 - Validation score increased.  Saving model ...
2025-03-02 17:30:12,883 - {'epoch': 41, 'rec_loss': '5.2983'}
2025-03-02 17:30:13,409 - {'Epoch': 41, 'HR@5': '0.0578', 'NDCG@5': '0.0400', 'HR@10': '0.0945', 'NDCG@10': '0.0521', 'HR@20': '0.1422', 'NDCG@20': '0.0640'}
2025-03-02 17:30:13,410 - Validation score increased.  Saving model ...
2025-03-02 17:30:18,137 - {'epoch': 42, 'rec_loss': '5.3006'}
2025-03-02 17:30:18,688 - {'Epoch': 42, 'HR@5': '0.0624', 'NDCG@5': '0.0416', 'HR@10': '0.0917', 'NDCG@10': '0.0511', 'HR@20': '0.1440', 'NDCG@20': '0.0643'}
2025-03-02 17:30:18,689 - Validation score increased.  Saving model ...
2025-03-02 17:30:23,586 - {'epoch': 43, 'rec_loss': '5.2667'}
2025-03-02 17:30:24,106 - {'Epoch': 43, 'HR@5': '0.0615', 'NDCG@5': '0.0395', 'HR@10': '0.0927', 'NDCG@10': '0.0495', 'HR@20': '0.1450', 'NDCG@20': '0.0627'}
2025-03-02 17:30:24,108 - EarlyStopping counter: 1 out of 10
2025-03-02 17:30:28,968 - {'epoch': 44, 'rec_loss': '5.2743'}
2025-03-02 17:30:29,481 - {'Epoch': 44, 'HR@5': '0.0587', 'NDCG@5': '0.0405', 'HR@10': '0.0945', 'NDCG@10': '0.0522', 'HR@20': '0.1413', 'NDCG@20': '0.0639'}
2025-03-02 17:30:29,483 - EarlyStopping counter: 2 out of 10
2025-03-02 17:30:34,094 - {'epoch': 45, 'rec_loss': '5.2688'}
2025-03-02 17:30:34,623 - {'Epoch': 45, 'HR@5': '0.0578', 'NDCG@5': '0.0398', 'HR@10': '0.0917', 'NDCG@10': '0.0510', 'HR@20': '0.1385', 'NDCG@20': '0.0629'}
2025-03-02 17:30:34,625 - EarlyStopping counter: 3 out of 10
2025-03-02 17:30:39,583 - {'epoch': 46, 'rec_loss': '5.2529'}
2025-03-02 17:30:40,109 - {'Epoch': 46, 'HR@5': '0.0651', 'NDCG@5': '0.0410', 'HR@10': '0.0963', 'NDCG@10': '0.0512', 'HR@20': '0.1422', 'NDCG@20': '0.0627'}
2025-03-02 17:30:40,110 - EarlyStopping counter: 4 out of 10
2025-03-02 17:30:45,060 - {'epoch': 47, 'rec_loss': '5.2497'}
2025-03-02 17:30:45,635 - {'Epoch': 47, 'HR@5': '0.0642', 'NDCG@5': '0.0414', 'HR@10': '0.0908', 'NDCG@10': '0.0500', 'HR@20': '0.1440', 'NDCG@20': '0.0635'}
2025-03-02 17:30:45,636 - EarlyStopping counter: 5 out of 10
2025-03-02 17:30:50,533 - {'epoch': 48, 'rec_loss': '5.2600'}
2025-03-02 17:30:51,135 - {'Epoch': 48, 'HR@5': '0.0615', 'NDCG@5': '0.0397', 'HR@10': '0.0972', 'NDCG@10': '0.0514', 'HR@20': '0.1459', 'NDCG@20': '0.0637'}
2025-03-02 17:30:51,136 - EarlyStopping counter: 6 out of 10
2025-03-02 17:30:55,794 - {'epoch': 49, 'rec_loss': '5.2444'}
2025-03-02 17:30:56,361 - {'Epoch': 49, 'HR@5': '0.0615', 'NDCG@5': '0.0397', 'HR@10': '0.0991', 'NDCG@10': '0.0515', 'HR@20': '0.1459', 'NDCG@20': '0.0632'}
2025-03-02 17:30:56,362 - EarlyStopping counter: 7 out of 10
2025-03-02 17:31:01,167 - {'epoch': 50, 'rec_loss': '5.2417'}
2025-03-02 17:31:01,694 - {'Epoch': 50, 'HR@5': '0.0624', 'NDCG@5': '0.0383', 'HR@10': '0.0982', 'NDCG@10': '0.0499', 'HR@20': '0.1404', 'NDCG@20': '0.0606'}
2025-03-02 17:31:01,695 - EarlyStopping counter: 8 out of 10
2025-03-02 17:31:07,088 - {'epoch': 51, 'rec_loss': '5.2279'}
2025-03-02 17:31:07,629 - {'Epoch': 51, 'HR@5': '0.0661', 'NDCG@5': '0.0413', 'HR@10': '0.0954', 'NDCG@10': '0.0508', 'HR@20': '0.1450', 'NDCG@20': '0.0633'}
2025-03-02 17:31:07,630 - EarlyStopping counter: 9 out of 10
2025-03-02 17:31:12,220 - {'epoch': 52, 'rec_loss': '5.2156'}
2025-03-02 17:31:12,811 - {'Epoch': 52, 'HR@5': '0.0642', 'NDCG@5': '0.0396', 'HR@10': '0.0982', 'NDCG@10': '0.0506', 'HR@20': '0.1450', 'NDCG@20': '0.0622'}
2025-03-02 17:31:12,813 - EarlyStopping counter: 10 out of 10
2025-03-02 17:31:12,813 - Early stopping
2025-03-02 17:31:12,813 - ---------------Test Score---------------
2025-03-02 17:31:13,326 - {'Epoch': 0, 'HR@5': '0.0550', 'NDCG@5': '0.0376', 'HR@10': '0.0761', 'NDCG@10': '0.0443', 'HR@20': '0.1101', 'NDCG@20': '0.0527'}
2025-03-02 17:31:13,327 - Scale_LastFM
2025-03-02 17:31:13,327 - {'Epoch': 0, 'HR@5': '0.0550', 'NDCG@5': '0.0376', 'HR@10': '0.0761', 'NDCG@10': '0.0443', 'HR@20': '0.1101', 'NDCG@20': '0.0527'}
2025-03-05 16:49:45,650 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50], kernels=[2, 3, 4], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-03-05 16:49:50,274 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=50, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-05 16:49:50,282 - Total Parameters: 389950
2025-03-05 16:49:56,683 - {'epoch': 0, 'rec_loss': '8.0659'}
2025-03-05 16:49:57,649 - {'Epoch': 0, 'HR@5': '0.0229', 'NDCG@5': '0.0165', 'HR@10': '0.0358', 'NDCG@10': '0.0207', 'HR@20': '0.0624', 'NDCG@20': '0.0274'}
2025-03-05 16:49:57,650 - Validation score increased.  Saving model ...
2025-03-05 16:50:03,255 - {'epoch': 1, 'rec_loss': '7.8203'}
2025-03-05 16:50:04,222 - {'Epoch': 1, 'HR@5': '0.0229', 'NDCG@5': '0.0179', 'HR@10': '0.0404', 'NDCG@10': '0.0236', 'HR@20': '0.0642', 'NDCG@20': '0.0295'}
2025-03-05 16:50:04,223 - Validation score increased.  Saving model ...
2025-03-05 16:50:10,349 - {'epoch': 2, 'rec_loss': '7.7045'}
2025-03-05 16:50:11,387 - {'Epoch': 2, 'HR@5': '0.0248', 'NDCG@5': '0.0178', 'HR@10': '0.0367', 'NDCG@10': '0.0218', 'HR@20': '0.0606', 'NDCG@20': '0.0278'}
2025-03-05 16:50:11,388 - EarlyStopping counter: 1 out of 10
2025-03-05 16:50:16,840 - {'epoch': 3, 'rec_loss': '7.5789'}
2025-03-05 16:50:17,750 - {'Epoch': 3, 'HR@5': '0.0275', 'NDCG@5': '0.0180', 'HR@10': '0.0404', 'NDCG@10': '0.0219', 'HR@20': '0.0651', 'NDCG@20': '0.0281'}
2025-03-05 16:50:17,751 - EarlyStopping counter: 2 out of 10
2025-03-05 16:50:23,830 - {'epoch': 4, 'rec_loss': '7.4596'}
2025-03-05 16:50:24,873 - {'Epoch': 4, 'HR@5': '0.0257', 'NDCG@5': '0.0176', 'HR@10': '0.0431', 'NDCG@10': '0.0233', 'HR@20': '0.0633', 'NDCG@20': '0.0282'}
2025-03-05 16:50:24,874 - EarlyStopping counter: 3 out of 10
2025-03-05 16:50:30,051 - {'epoch': 5, 'rec_loss': '7.3350'}
2025-03-05 16:50:31,054 - {'Epoch': 5, 'HR@5': '0.0312', 'NDCG@5': '0.0199', 'HR@10': '0.0440', 'NDCG@10': '0.0240', 'HR@20': '0.0661', 'NDCG@20': '0.0294'}
2025-03-05 16:50:31,055 - EarlyStopping counter: 4 out of 10
2025-03-05 16:50:36,726 - {'epoch': 6, 'rec_loss': '7.2213'}
2025-03-05 16:50:37,723 - {'Epoch': 6, 'HR@5': '0.0330', 'NDCG@5': '0.0218', 'HR@10': '0.0477', 'NDCG@10': '0.0264', 'HR@20': '0.0752', 'NDCG@20': '0.0332'}
2025-03-05 16:50:37,725 - Validation score increased.  Saving model ...
2025-03-05 16:50:42,611 - {'epoch': 7, 'rec_loss': '7.1044'}
2025-03-05 16:50:43,642 - {'Epoch': 7, 'HR@5': '0.0339', 'NDCG@5': '0.0229', 'HR@10': '0.0495', 'NDCG@10': '0.0279', 'HR@20': '0.0817', 'NDCG@20': '0.0360'}
2025-03-05 16:50:43,643 - Validation score increased.  Saving model ...
2025-03-05 16:50:48,414 - {'epoch': 8, 'rec_loss': '6.9912'}
2025-03-05 16:50:49,312 - {'Epoch': 8, 'HR@5': '0.0376', 'NDCG@5': '0.0232', 'HR@10': '0.0532', 'NDCG@10': '0.0282', 'HR@20': '0.0908', 'NDCG@20': '0.0377'}
2025-03-05 16:50:49,313 - Validation score increased.  Saving model ...
2025-03-05 16:50:53,736 - {'epoch': 9, 'rec_loss': '6.8712'}
2025-03-05 16:50:54,657 - {'Epoch': 9, 'HR@5': '0.0422', 'NDCG@5': '0.0253', 'HR@10': '0.0606', 'NDCG@10': '0.0310', 'HR@20': '0.0917', 'NDCG@20': '0.0389'}
2025-03-05 16:50:54,659 - Validation score increased.  Saving model ...
2025-03-05 16:50:58,725 - {'epoch': 10, 'rec_loss': '6.7580'}
2025-03-05 16:50:59,522 - {'Epoch': 10, 'HR@5': '0.0450', 'NDCG@5': '0.0273', 'HR@10': '0.0633', 'NDCG@10': '0.0331', 'HR@20': '0.0972', 'NDCG@20': '0.0417'}
2025-03-05 16:50:59,523 - Validation score increased.  Saving model ...
2025-03-05 16:51:03,467 - {'epoch': 11, 'rec_loss': '6.6529'}
2025-03-05 16:51:04,218 - {'Epoch': 11, 'HR@5': '0.0495', 'NDCG@5': '0.0280', 'HR@10': '0.0661', 'NDCG@10': '0.0332', 'HR@20': '0.1018', 'NDCG@20': '0.0422'}
2025-03-05 16:51:04,219 - Validation score increased.  Saving model ...
2025-03-05 16:51:08,315 - {'epoch': 12, 'rec_loss': '6.5636'}
2025-03-05 16:51:09,106 - {'Epoch': 12, 'HR@5': '0.0459', 'NDCG@5': '0.0289', 'HR@10': '0.0624', 'NDCG@10': '0.0343', 'HR@20': '0.1046', 'NDCG@20': '0.0449'}
2025-03-05 16:51:09,107 - Validation score increased.  Saving model ...
2025-03-05 16:51:13,231 - {'epoch': 13, 'rec_loss': '6.4794'}
2025-03-05 16:51:14,102 - {'Epoch': 13, 'HR@5': '0.0486', 'NDCG@5': '0.0310', 'HR@10': '0.0651', 'NDCG@10': '0.0365', 'HR@20': '0.1083', 'NDCG@20': '0.0473'}
2025-03-05 16:51:14,105 - Validation score increased.  Saving model ...
2025-03-05 16:51:18,786 - {'epoch': 14, 'rec_loss': '6.3871'}
2025-03-05 16:51:19,672 - {'Epoch': 14, 'HR@5': '0.0486', 'NDCG@5': '0.0315', 'HR@10': '0.0743', 'NDCG@10': '0.0398', 'HR@20': '0.1110', 'NDCG@20': '0.0490'}
2025-03-05 16:51:19,674 - Validation score increased.  Saving model ...
2025-03-05 16:51:23,984 - {'epoch': 15, 'rec_loss': '6.3071'}
2025-03-05 16:51:24,747 - {'Epoch': 15, 'HR@5': '0.0440', 'NDCG@5': '0.0301', 'HR@10': '0.0771', 'NDCG@10': '0.0406', 'HR@20': '0.1211', 'NDCG@20': '0.0514'}
2025-03-05 16:51:24,748 - Validation score increased.  Saving model ...
2025-03-05 16:51:29,083 - {'epoch': 16, 'rec_loss': '6.2557'}
2025-03-05 16:51:29,955 - {'Epoch': 16, 'HR@5': '0.0468', 'NDCG@5': '0.0298', 'HR@10': '0.0734', 'NDCG@10': '0.0384', 'HR@20': '0.1183', 'NDCG@20': '0.0497'}
2025-03-05 16:51:29,956 - EarlyStopping counter: 1 out of 10
2025-03-05 16:51:33,912 - {'epoch': 17, 'rec_loss': '6.1615'}
2025-03-05 16:51:34,725 - {'Epoch': 17, 'HR@5': '0.0468', 'NDCG@5': '0.0319', 'HR@10': '0.0716', 'NDCG@10': '0.0400', 'HR@20': '0.1174', 'NDCG@20': '0.0516'}
2025-03-05 16:51:34,726 - Validation score increased.  Saving model ...
2025-03-05 16:51:38,713 - {'epoch': 18, 'rec_loss': '6.1012'}
2025-03-05 16:51:39,501 - {'Epoch': 18, 'HR@5': '0.0514', 'NDCG@5': '0.0339', 'HR@10': '0.0725', 'NDCG@10': '0.0405', 'HR@20': '0.1147', 'NDCG@20': '0.0514'}
2025-03-05 16:51:39,502 - EarlyStopping counter: 1 out of 10
2025-03-05 16:51:43,379 - {'epoch': 19, 'rec_loss': '6.0773'}
2025-03-05 16:51:44,110 - {'Epoch': 19, 'HR@5': '0.0459', 'NDCG@5': '0.0306', 'HR@10': '0.0780', 'NDCG@10': '0.0410', 'HR@20': '0.1220', 'NDCG@20': '0.0521'}
2025-03-05 16:51:44,111 - Validation score increased.  Saving model ...
2025-03-05 16:51:47,883 - {'epoch': 20, 'rec_loss': '6.0285'}
2025-03-05 16:51:48,713 - {'Epoch': 20, 'HR@5': '0.0495', 'NDCG@5': '0.0323', 'HR@10': '0.0817', 'NDCG@10': '0.0427', 'HR@20': '0.1211', 'NDCG@20': '0.0524'}
2025-03-05 16:51:48,715 - Validation score increased.  Saving model ...
2025-03-05 16:51:53,169 - {'epoch': 21, 'rec_loss': '5.9880'}
2025-03-05 16:51:53,866 - {'Epoch': 21, 'HR@5': '0.0514', 'NDCG@5': '0.0334', 'HR@10': '0.0771', 'NDCG@10': '0.0416', 'HR@20': '0.1202', 'NDCG@20': '0.0525'}
2025-03-05 16:51:53,868 - Validation score increased.  Saving model ...
2025-03-05 16:51:57,711 - {'epoch': 22, 'rec_loss': '5.9507'}
2025-03-05 16:51:58,496 - {'Epoch': 22, 'HR@5': '0.0514', 'NDCG@5': '0.0343', 'HR@10': '0.0798', 'NDCG@10': '0.0434', 'HR@20': '0.1257', 'NDCG@20': '0.0549'}
2025-03-05 16:51:58,497 - Validation score increased.  Saving model ...
2025-03-05 16:52:04,599 - {'epoch': 23, 'rec_loss': '5.9088'}
2025-03-05 16:52:05,570 - {'Epoch': 23, 'HR@5': '0.0514', 'NDCG@5': '0.0346', 'HR@10': '0.0798', 'NDCG@10': '0.0438', 'HR@20': '0.1275', 'NDCG@20': '0.0557'}
2025-03-05 16:52:05,573 - Validation score increased.  Saving model ...
2025-03-05 16:52:10,497 - {'epoch': 24, 'rec_loss': '5.9044'}
2025-03-05 16:52:11,444 - {'Epoch': 24, 'HR@5': '0.0514', 'NDCG@5': '0.0349', 'HR@10': '0.0817', 'NDCG@10': '0.0447', 'HR@20': '0.1239', 'NDCG@20': '0.0554'}
2025-03-05 16:52:11,446 - EarlyStopping counter: 1 out of 10
2025-03-05 16:52:16,592 - {'epoch': 25, 'rec_loss': '5.8440'}
2025-03-05 16:52:17,634 - {'Epoch': 25, 'HR@5': '0.0560', 'NDCG@5': '0.0379', 'HR@10': '0.0826', 'NDCG@10': '0.0464', 'HR@20': '0.1257', 'NDCG@20': '0.0570'}
2025-03-05 16:52:17,635 - Validation score increased.  Saving model ...
2025-03-05 16:52:22,870 - {'epoch': 26, 'rec_loss': '5.8136'}
2025-03-05 16:52:23,808 - {'Epoch': 26, 'HR@5': '0.0541', 'NDCG@5': '0.0368', 'HR@10': '0.0890', 'NDCG@10': '0.0480', 'HR@20': '0.1257', 'NDCG@20': '0.0574'}
2025-03-05 16:52:23,809 - Validation score increased.  Saving model ...
2025-03-05 16:52:29,124 - {'epoch': 27, 'rec_loss': '5.7855'}
2025-03-05 16:52:30,068 - {'Epoch': 27, 'HR@5': '0.0560', 'NDCG@5': '0.0359', 'HR@10': '0.0899', 'NDCG@10': '0.0469', 'HR@20': '0.1266', 'NDCG@20': '0.0561'}
2025-03-05 16:52:30,069 - EarlyStopping counter: 1 out of 10
2025-03-05 16:52:35,483 - {'epoch': 28, 'rec_loss': '5.7783'}
2025-03-05 16:52:36,429 - {'Epoch': 28, 'HR@5': '0.0569', 'NDCG@5': '0.0371', 'HR@10': '0.0853', 'NDCG@10': '0.0462', 'HR@20': '0.1303', 'NDCG@20': '0.0575'}
2025-03-05 16:52:36,430 - Validation score increased.  Saving model ...
2025-03-05 16:52:42,101 - {'epoch': 29, 'rec_loss': '5.7662'}
2025-03-05 16:52:43,055 - {'Epoch': 29, 'HR@5': '0.0550', 'NDCG@5': '0.0356', 'HR@10': '0.0890', 'NDCG@10': '0.0465', 'HR@20': '0.1294', 'NDCG@20': '0.0566'}
2025-03-05 16:52:43,057 - EarlyStopping counter: 1 out of 10
2025-03-05 16:52:49,143 - {'epoch': 30, 'rec_loss': '5.7562'}
2025-03-05 16:52:50,160 - {'Epoch': 30, 'HR@5': '0.0560', 'NDCG@5': '0.0363', 'HR@10': '0.0862', 'NDCG@10': '0.0460', 'HR@20': '0.1321', 'NDCG@20': '0.0576'}
2025-03-05 16:52:50,161 - Validation score increased.  Saving model ...
2025-03-05 16:52:55,018 - {'epoch': 31, 'rec_loss': '5.7118'}
2025-03-05 16:52:56,033 - {'Epoch': 31, 'HR@5': '0.0569', 'NDCG@5': '0.0370', 'HR@10': '0.0853', 'NDCG@10': '0.0462', 'HR@20': '0.1339', 'NDCG@20': '0.0585'}
2025-03-05 16:52:56,034 - Validation score increased.  Saving model ...
2025-03-05 16:53:01,334 - {'epoch': 32, 'rec_loss': '5.7225'}
2025-03-05 16:53:02,253 - {'Epoch': 32, 'HR@5': '0.0578', 'NDCG@5': '0.0374', 'HR@10': '0.0881', 'NDCG@10': '0.0469', 'HR@20': '0.1385', 'NDCG@20': '0.0596'}
2025-03-05 16:53:02,255 - Validation score increased.  Saving model ...
2025-03-05 16:53:07,812 - {'epoch': 33, 'rec_loss': '5.6807'}
2025-03-05 16:53:08,896 - {'Epoch': 33, 'HR@5': '0.0578', 'NDCG@5': '0.0382', 'HR@10': '0.0862', 'NDCG@10': '0.0470', 'HR@20': '0.1349', 'NDCG@20': '0.0591'}
2025-03-05 16:53:08,897 - EarlyStopping counter: 1 out of 10
2025-03-05 16:53:14,924 - {'epoch': 34, 'rec_loss': '5.6655'}
2025-03-05 16:53:15,930 - {'Epoch': 34, 'HR@5': '0.0587', 'NDCG@5': '0.0381', 'HR@10': '0.0872', 'NDCG@10': '0.0475', 'HR@20': '0.1358', 'NDCG@20': '0.0597'}
2025-03-05 16:53:15,933 - Validation score increased.  Saving model ...
2025-03-05 16:53:21,832 - {'epoch': 35, 'rec_loss': '5.6863'}
2025-03-05 16:53:22,861 - {'Epoch': 35, 'HR@5': '0.0578', 'NDCG@5': '0.0380', 'HR@10': '0.0890', 'NDCG@10': '0.0481', 'HR@20': '0.1367', 'NDCG@20': '0.0603'}
2025-03-05 16:53:22,862 - Validation score increased.  Saving model ...
2025-03-05 16:53:28,289 - {'epoch': 36, 'rec_loss': '5.6721'}
2025-03-05 16:53:29,328 - {'Epoch': 36, 'HR@5': '0.0578', 'NDCG@5': '0.0389', 'HR@10': '0.0927', 'NDCG@10': '0.0502', 'HR@20': '0.1394', 'NDCG@20': '0.0619'}
2025-03-05 16:53:29,330 - Validation score increased.  Saving model ...
2025-03-05 16:53:34,362 - {'epoch': 37, 'rec_loss': '5.6436'}
2025-03-05 16:53:35,130 - {'Epoch': 37, 'HR@5': '0.0578', 'NDCG@5': '0.0383', 'HR@10': '0.0908', 'NDCG@10': '0.0489', 'HR@20': '0.1330', 'NDCG@20': '0.0595'}
2025-03-05 16:53:35,131 - EarlyStopping counter: 1 out of 10
2025-03-05 16:53:39,343 - {'epoch': 38, 'rec_loss': '5.6483'}
2025-03-05 16:53:40,111 - {'Epoch': 38, 'HR@5': '0.0587', 'NDCG@5': '0.0372', 'HR@10': '0.0899', 'NDCG@10': '0.0472', 'HR@20': '0.1376', 'NDCG@20': '0.0591'}
2025-03-05 16:53:40,113 - EarlyStopping counter: 2 out of 10
2025-03-05 16:53:44,072 - {'epoch': 39, 'rec_loss': '5.6261'}
2025-03-05 16:53:44,964 - {'Epoch': 39, 'HR@5': '0.0596', 'NDCG@5': '0.0392', 'HR@10': '0.0917', 'NDCG@10': '0.0492', 'HR@20': '0.1385', 'NDCG@20': '0.0611'}
2025-03-05 16:53:44,966 - EarlyStopping counter: 3 out of 10
2025-03-05 16:53:48,836 - {'epoch': 40, 'rec_loss': '5.6321'}
2025-03-05 16:53:49,739 - {'Epoch': 40, 'HR@5': '0.0624', 'NDCG@5': '0.0395', 'HR@10': '0.0899', 'NDCG@10': '0.0483', 'HR@20': '0.1339', 'NDCG@20': '0.0594'}
2025-03-05 16:53:49,740 - EarlyStopping counter: 4 out of 10
2025-03-05 16:53:53,179 - {'epoch': 41, 'rec_loss': '5.5982'}
2025-03-05 16:53:53,987 - {'Epoch': 41, 'HR@5': '0.0633', 'NDCG@5': '0.0411', 'HR@10': '0.0917', 'NDCG@10': '0.0502', 'HR@20': '0.1394', 'NDCG@20': '0.0622'}
2025-03-05 16:53:53,988 - Validation score increased.  Saving model ...
2025-03-05 16:53:58,096 - {'epoch': 42, 'rec_loss': '5.6056'}
2025-03-05 16:53:58,929 - {'Epoch': 42, 'HR@5': '0.0633', 'NDCG@5': '0.0401', 'HR@10': '0.0945', 'NDCG@10': '0.0499', 'HR@20': '0.1422', 'NDCG@20': '0.0620'}
2025-03-05 16:53:58,930 - EarlyStopping counter: 1 out of 10
2025-03-05 16:54:02,861 - {'epoch': 43, 'rec_loss': '5.5897'}
2025-03-05 16:54:03,719 - {'Epoch': 43, 'HR@5': '0.0651', 'NDCG@5': '0.0408', 'HR@10': '0.0936', 'NDCG@10': '0.0499', 'HR@20': '0.1367', 'NDCG@20': '0.0607'}
2025-03-05 16:54:03,722 - EarlyStopping counter: 2 out of 10
2025-03-05 16:54:07,614 - {'epoch': 44, 'rec_loss': '5.5973'}
2025-03-05 16:54:08,385 - {'Epoch': 44, 'HR@5': '0.0633', 'NDCG@5': '0.0396', 'HR@10': '0.0945', 'NDCG@10': '0.0496', 'HR@20': '0.1486', 'NDCG@20': '0.0631'}
2025-03-05 16:54:08,386 - Validation score increased.  Saving model ...
2025-03-05 16:54:12,429 - {'epoch': 45, 'rec_loss': '5.5716'}
2025-03-05 16:54:13,261 - {'Epoch': 45, 'HR@5': '0.0615', 'NDCG@5': '0.0399', 'HR@10': '0.0963', 'NDCG@10': '0.0512', 'HR@20': '0.1385', 'NDCG@20': '0.0618'}
2025-03-05 16:54:13,263 - EarlyStopping counter: 1 out of 10
2025-03-05 16:54:17,565 - {'epoch': 46, 'rec_loss': '5.5598'}
2025-03-05 16:54:18,502 - {'Epoch': 46, 'HR@5': '0.0615', 'NDCG@5': '0.0393', 'HR@10': '0.0954', 'NDCG@10': '0.0501', 'HR@20': '0.1440', 'NDCG@20': '0.0622'}
2025-03-05 16:54:18,506 - EarlyStopping counter: 2 out of 10
2025-03-05 16:54:22,963 - {'epoch': 47, 'rec_loss': '5.5471'}
2025-03-05 16:54:23,729 - {'Epoch': 47, 'HR@5': '0.0606', 'NDCG@5': '0.0401', 'HR@10': '0.0982', 'NDCG@10': '0.0521', 'HR@20': '0.1459', 'NDCG@20': '0.0641'}
2025-03-05 16:54:23,730 - Validation score increased.  Saving model ...
2025-03-05 16:54:28,112 - {'epoch': 48, 'rec_loss': '5.5513'}
2025-03-05 16:54:28,967 - {'Epoch': 48, 'HR@5': '0.0606', 'NDCG@5': '0.0390', 'HR@10': '0.1018', 'NDCG@10': '0.0524', 'HR@20': '0.1394', 'NDCG@20': '0.0619'}
2025-03-05 16:54:28,969 - EarlyStopping counter: 1 out of 10
2025-03-05 16:54:33,485 - {'epoch': 49, 'rec_loss': '5.5428'}
2025-03-05 16:54:34,297 - {'Epoch': 49, 'HR@5': '0.0642', 'NDCG@5': '0.0415', 'HR@10': '0.1018', 'NDCG@10': '0.0536', 'HR@20': '0.1394', 'NDCG@20': '0.0629'}
2025-03-05 16:54:34,299 - EarlyStopping counter: 2 out of 10
2025-03-05 16:54:38,852 - {'epoch': 50, 'rec_loss': '5.5549'}
2025-03-05 16:54:39,643 - {'Epoch': 50, 'HR@5': '0.0642', 'NDCG@5': '0.0406', 'HR@10': '0.1000', 'NDCG@10': '0.0520', 'HR@20': '0.1431', 'NDCG@20': '0.0628'}
2025-03-05 16:54:39,645 - EarlyStopping counter: 3 out of 10
2025-03-05 16:54:44,473 - {'epoch': 51, 'rec_loss': '5.5378'}
2025-03-05 16:54:45,440 - {'Epoch': 51, 'HR@5': '0.0615', 'NDCG@5': '0.0386', 'HR@10': '0.0982', 'NDCG@10': '0.0503', 'HR@20': '0.1413', 'NDCG@20': '0.0611'}
2025-03-05 16:54:45,441 - EarlyStopping counter: 4 out of 10
2025-03-05 16:54:50,859 - {'epoch': 52, 'rec_loss': '5.5411'}
2025-03-05 16:54:51,862 - {'Epoch': 52, 'HR@5': '0.0606', 'NDCG@5': '0.0390', 'HR@10': '0.0963', 'NDCG@10': '0.0506', 'HR@20': '0.1422', 'NDCG@20': '0.0622'}
2025-03-05 16:54:51,864 - EarlyStopping counter: 5 out of 10
2025-03-05 16:54:57,042 - {'epoch': 53, 'rec_loss': '5.5219'}
2025-03-05 16:54:58,036 - {'Epoch': 53, 'HR@5': '0.0642', 'NDCG@5': '0.0408', 'HR@10': '0.0945', 'NDCG@10': '0.0505', 'HR@20': '0.1385', 'NDCG@20': '0.0617'}
2025-03-05 16:54:58,038 - EarlyStopping counter: 6 out of 10
2025-03-05 16:55:03,524 - {'epoch': 54, 'rec_loss': '5.5373'}
2025-03-05 16:55:04,573 - {'Epoch': 54, 'HR@5': '0.0596', 'NDCG@5': '0.0391', 'HR@10': '0.0963', 'NDCG@10': '0.0508', 'HR@20': '0.1422', 'NDCG@20': '0.0625'}
2025-03-05 16:55:04,574 - EarlyStopping counter: 7 out of 10
2025-03-05 16:55:09,637 - {'epoch': 55, 'rec_loss': '5.5005'}
2025-03-05 16:55:10,560 - {'Epoch': 55, 'HR@5': '0.0624', 'NDCG@5': '0.0410', 'HR@10': '0.0936', 'NDCG@10': '0.0511', 'HR@20': '0.1431', 'NDCG@20': '0.0636'}
2025-03-05 16:55:10,563 - EarlyStopping counter: 8 out of 10
2025-03-05 16:55:16,304 - {'epoch': 56, 'rec_loss': '5.5185'}
2025-03-05 16:55:17,252 - {'Epoch': 56, 'HR@5': '0.0606', 'NDCG@5': '0.0405', 'HR@10': '0.0927', 'NDCG@10': '0.0509', 'HR@20': '0.1394', 'NDCG@20': '0.0629'}
2025-03-05 16:55:17,253 - EarlyStopping counter: 9 out of 10
2025-03-05 16:55:22,692 - {'epoch': 57, 'rec_loss': '5.5047'}
2025-03-05 16:55:23,779 - {'Epoch': 57, 'HR@5': '0.0633', 'NDCG@5': '0.0390', 'HR@10': '0.0982', 'NDCG@10': '0.0503', 'HR@20': '0.1394', 'NDCG@20': '0.0606'}
2025-03-05 16:55:23,781 - EarlyStopping counter: 10 out of 10
2025-03-05 16:55:23,781 - Early stopping
2025-03-05 16:55:23,781 - ---------------Test Score---------------
2025-03-05 16:55:24,740 - {'Epoch': 0, 'HR@5': '0.0459', 'NDCG@5': '0.0341', 'HR@10': '0.0661', 'NDCG@10': '0.0405', 'HR@20': '0.1018', 'NDCG@20': '0.0495'}
2025-03-05 16:55:24,742 - Scale_LastFM
2025-03-05 16:55:24,742 - {'Epoch': 0, 'HR@5': '0.0459', 'NDCG@5': '0.0341', 'HR@10': '0.0661', 'NDCG@10': '0.0405', 'HR@20': '0.1018', 'NDCG@20': '0.0495'}
2025-03-05 21:49:49,228 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-03-05 21:49:52,341 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-05 21:49:52,345 - Total Parameters: 387350
2025-03-05 21:49:57,966 - {'epoch': 0, 'rec_loss': '8.0475'}
2025-03-05 21:49:58,718 - {'Epoch': 0, 'HR@5': '0.0193', 'NDCG@5': '0.0141', 'HR@10': '0.0330', 'NDCG@10': '0.0186', 'HR@20': '0.0624', 'NDCG@20': '0.0261'}
2025-03-05 21:49:58,719 - Validation score increased.  Saving model ...
2025-03-05 21:50:03,565 - {'epoch': 1, 'rec_loss': '7.7710'}
2025-03-05 21:50:04,364 - {'Epoch': 1, 'HR@5': '0.0220', 'NDCG@5': '0.0146', 'HR@10': '0.0358', 'NDCG@10': '0.0189', 'HR@20': '0.0596', 'NDCG@20': '0.0249'}
2025-03-05 21:50:04,365 - EarlyStopping counter: 1 out of 10
2025-03-05 21:50:09,053 - {'epoch': 2, 'rec_loss': '7.5795'}
2025-03-05 21:50:09,806 - {'Epoch': 2, 'HR@5': '0.0294', 'NDCG@5': '0.0178', 'HR@10': '0.0459', 'NDCG@10': '0.0230', 'HR@20': '0.0651', 'NDCG@20': '0.0277'}
2025-03-05 21:50:09,807 - Validation score increased.  Saving model ...
2025-03-05 21:50:14,537 - {'epoch': 3, 'rec_loss': '7.3763'}
2025-03-05 21:50:15,343 - {'Epoch': 3, 'HR@5': '0.0266', 'NDCG@5': '0.0181', 'HR@10': '0.0450', 'NDCG@10': '0.0241', 'HR@20': '0.0651', 'NDCG@20': '0.0293'}
2025-03-05 21:50:15,345 - Validation score increased.  Saving model ...
2025-03-05 21:50:20,039 - {'epoch': 4, 'rec_loss': '7.1935'}
2025-03-05 21:50:20,800 - {'Epoch': 4, 'HR@5': '0.0339', 'NDCG@5': '0.0223', 'HR@10': '0.0459', 'NDCG@10': '0.0260', 'HR@20': '0.0780', 'NDCG@20': '0.0342'}
2025-03-05 21:50:20,802 - Validation score increased.  Saving model ...
2025-03-05 21:50:25,482 - {'epoch': 5, 'rec_loss': '7.0113'}
2025-03-05 21:50:26,257 - {'Epoch': 5, 'HR@5': '0.0312', 'NDCG@5': '0.0225', 'HR@10': '0.0505', 'NDCG@10': '0.0286', 'HR@20': '0.0817', 'NDCG@20': '0.0364'}
2025-03-05 21:50:26,258 - Validation score increased.  Saving model ...
2025-03-05 21:50:30,943 - {'epoch': 6, 'rec_loss': '6.8280'}
2025-03-05 21:50:31,972 - {'Epoch': 6, 'HR@5': '0.0349', 'NDCG@5': '0.0250', 'HR@10': '0.0560', 'NDCG@10': '0.0318', 'HR@20': '0.0890', 'NDCG@20': '0.0401'}
2025-03-05 21:50:31,974 - Validation score increased.  Saving model ...
2025-03-05 21:50:36,861 - {'epoch': 7, 'rec_loss': '6.6663'}
2025-03-05 21:50:37,643 - {'Epoch': 7, 'HR@5': '0.0367', 'NDCG@5': '0.0243', 'HR@10': '0.0550', 'NDCG@10': '0.0303', 'HR@20': '0.0927', 'NDCG@20': '0.0399'}
2025-03-05 21:50:37,645 - EarlyStopping counter: 1 out of 10
2025-03-05 21:50:42,375 - {'epoch': 8, 'rec_loss': '6.5122'}
2025-03-05 21:50:43,129 - {'Epoch': 8, 'HR@5': '0.0385', 'NDCG@5': '0.0244', 'HR@10': '0.0615', 'NDCG@10': '0.0318', 'HR@20': '0.0954', 'NDCG@20': '0.0405'}
2025-03-05 21:50:43,130 - Validation score increased.  Saving model ...
2025-03-05 21:50:47,885 - {'epoch': 9, 'rec_loss': '6.3948'}
2025-03-05 21:50:48,647 - {'Epoch': 9, 'HR@5': '0.0440', 'NDCG@5': '0.0287', 'HR@10': '0.0679', 'NDCG@10': '0.0362', 'HR@20': '0.1092', 'NDCG@20': '0.0467'}
2025-03-05 21:50:48,648 - Validation score increased.  Saving model ...
2025-03-05 21:50:53,255 - {'epoch': 10, 'rec_loss': '6.2497'}
2025-03-05 21:50:54,022 - {'Epoch': 10, 'HR@5': '0.0394', 'NDCG@5': '0.0259', 'HR@10': '0.0697', 'NDCG@10': '0.0355', 'HR@20': '0.1046', 'NDCG@20': '0.0443'}
2025-03-05 21:50:54,023 - EarlyStopping counter: 1 out of 10
2025-03-05 21:50:58,676 - {'epoch': 11, 'rec_loss': '6.1706'}
2025-03-05 21:50:59,487 - {'Epoch': 11, 'HR@5': '0.0394', 'NDCG@5': '0.0259', 'HR@10': '0.0697', 'NDCG@10': '0.0358', 'HR@20': '0.1073', 'NDCG@20': '0.0454'}
2025-03-05 21:50:59,488 - EarlyStopping counter: 2 out of 10
2025-03-05 21:51:04,478 - {'epoch': 12, 'rec_loss': '6.0815'}
2025-03-05 21:51:05,300 - {'Epoch': 12, 'HR@5': '0.0440', 'NDCG@5': '0.0280', 'HR@10': '0.0789', 'NDCG@10': '0.0392', 'HR@20': '0.1055', 'NDCG@20': '0.0460'}
2025-03-05 21:51:05,302 - EarlyStopping counter: 3 out of 10
2025-03-05 21:51:10,027 - {'epoch': 13, 'rec_loss': '5.9901'}
2025-03-05 21:51:10,857 - {'Epoch': 13, 'HR@5': '0.0404', 'NDCG@5': '0.0263', 'HR@10': '0.0752', 'NDCG@10': '0.0376', 'HR@20': '0.1110', 'NDCG@20': '0.0467'}
2025-03-05 21:51:10,858 - Validation score increased.  Saving model ...
2025-03-05 21:51:15,788 - {'epoch': 14, 'rec_loss': '5.9194'}
2025-03-05 21:51:16,592 - {'Epoch': 14, 'HR@5': '0.0514', 'NDCG@5': '0.0300', 'HR@10': '0.0780', 'NDCG@10': '0.0384', 'HR@20': '0.1110', 'NDCG@20': '0.0466'}
2025-03-05 21:51:16,593 - EarlyStopping counter: 1 out of 10
2025-03-05 21:51:21,543 - {'epoch': 15, 'rec_loss': '5.8691'}
2025-03-05 21:51:22,354 - {'Epoch': 15, 'HR@5': '0.0514', 'NDCG@5': '0.0314', 'HR@10': '0.0807', 'NDCG@10': '0.0409', 'HR@20': '0.1193', 'NDCG@20': '0.0504'}
2025-03-05 21:51:22,355 - Validation score increased.  Saving model ...
2025-03-05 21:51:27,073 - {'epoch': 16, 'rec_loss': '5.8336'}
2025-03-05 21:51:27,837 - {'Epoch': 16, 'HR@5': '0.0468', 'NDCG@5': '0.0301', 'HR@10': '0.0743', 'NDCG@10': '0.0391', 'HR@20': '0.1193', 'NDCG@20': '0.0503'}
2025-03-05 21:51:27,838 - EarlyStopping counter: 1 out of 10
2025-03-05 21:51:32,501 - {'epoch': 17, 'rec_loss': '5.7779'}
2025-03-05 21:51:33,276 - {'Epoch': 17, 'HR@5': '0.0450', 'NDCG@5': '0.0300', 'HR@10': '0.0771', 'NDCG@10': '0.0405', 'HR@20': '0.1239', 'NDCG@20': '0.0524'}
2025-03-05 21:51:33,279 - Validation score increased.  Saving model ...
2025-03-05 21:51:38,150 - {'epoch': 18, 'rec_loss': '5.7243'}
2025-03-05 21:51:38,913 - {'Epoch': 18, 'HR@5': '0.0459', 'NDCG@5': '0.0289', 'HR@10': '0.0817', 'NDCG@10': '0.0404', 'HR@20': '0.1275', 'NDCG@20': '0.0516'}
2025-03-05 21:51:38,915 - EarlyStopping counter: 1 out of 10
2025-03-05 21:51:43,779 - {'epoch': 19, 'rec_loss': '5.6960'}
2025-03-05 21:51:44,590 - {'Epoch': 19, 'HR@5': '0.0486', 'NDCG@5': '0.0291', 'HR@10': '0.0817', 'NDCG@10': '0.0399', 'HR@20': '0.1330', 'NDCG@20': '0.0528'}
2025-03-05 21:51:44,591 - Validation score increased.  Saving model ...
2025-03-05 21:51:49,314 - {'epoch': 20, 'rec_loss': '5.6679'}
2025-03-05 21:51:50,092 - {'Epoch': 20, 'HR@5': '0.0459', 'NDCG@5': '0.0295', 'HR@10': '0.0835', 'NDCG@10': '0.0418', 'HR@20': '0.1266', 'NDCG@20': '0.0525'}
2025-03-05 21:51:50,093 - EarlyStopping counter: 1 out of 10
2025-03-05 21:51:55,081 - {'epoch': 21, 'rec_loss': '5.6298'}
2025-03-05 21:51:55,835 - {'Epoch': 21, 'HR@5': '0.0550', 'NDCG@5': '0.0337', 'HR@10': '0.0890', 'NDCG@10': '0.0447', 'HR@20': '0.1257', 'NDCG@20': '0.0538'}
2025-03-05 21:51:55,837 - Validation score increased.  Saving model ...
2025-03-05 21:52:00,527 - {'epoch': 22, 'rec_loss': '5.6192'}
2025-03-05 21:52:01,319 - {'Epoch': 22, 'HR@5': '0.0523', 'NDCG@5': '0.0326', 'HR@10': '0.0853', 'NDCG@10': '0.0433', 'HR@20': '0.1266', 'NDCG@20': '0.0535'}
2025-03-05 21:52:01,322 - EarlyStopping counter: 1 out of 10
2025-03-05 21:52:06,036 - {'epoch': 23, 'rec_loss': '5.6062'}
2025-03-05 21:52:06,794 - {'Epoch': 23, 'HR@5': '0.0523', 'NDCG@5': '0.0327', 'HR@10': '0.0881', 'NDCG@10': '0.0443', 'HR@20': '0.1303', 'NDCG@20': '0.0548'}
2025-03-05 21:52:06,796 - Validation score increased.  Saving model ...
2025-03-05 21:52:11,572 - {'epoch': 24, 'rec_loss': '5.5723'}
2025-03-05 21:52:12,347 - {'Epoch': 24, 'HR@5': '0.0532', 'NDCG@5': '0.0344', 'HR@10': '0.0908', 'NDCG@10': '0.0465', 'HR@20': '0.1294', 'NDCG@20': '0.0561'}
2025-03-05 21:52:12,348 - Validation score increased.  Saving model ...
2025-03-05 21:52:17,133 - {'epoch': 25, 'rec_loss': '5.5361'}
2025-03-05 21:52:17,904 - {'Epoch': 25, 'HR@5': '0.0523', 'NDCG@5': '0.0323', 'HR@10': '0.0917', 'NDCG@10': '0.0449', 'HR@20': '0.1349', 'NDCG@20': '0.0555'}
2025-03-05 21:52:17,905 - EarlyStopping counter: 1 out of 10
2025-03-05 21:52:22,564 - {'epoch': 26, 'rec_loss': '5.5405'}
2025-03-05 21:52:23,318 - {'Epoch': 26, 'HR@5': '0.0569', 'NDCG@5': '0.0360', 'HR@10': '0.0862', 'NDCG@10': '0.0453', 'HR@20': '0.1339', 'NDCG@20': '0.0573'}
2025-03-05 21:52:23,319 - Validation score increased.  Saving model ...
2025-03-05 21:52:28,091 - {'epoch': 27, 'rec_loss': '5.5261'}
2025-03-05 21:52:28,943 - {'Epoch': 27, 'HR@5': '0.0541', 'NDCG@5': '0.0348', 'HR@10': '0.0890', 'NDCG@10': '0.0461', 'HR@20': '0.1284', 'NDCG@20': '0.0559'}
2025-03-05 21:52:28,945 - EarlyStopping counter: 1 out of 10
2025-03-05 21:52:33,983 - {'epoch': 28, 'rec_loss': '5.5066'}
2025-03-05 21:52:34,727 - {'Epoch': 28, 'HR@5': '0.0560', 'NDCG@5': '0.0362', 'HR@10': '0.0862', 'NDCG@10': '0.0458', 'HR@20': '0.1358', 'NDCG@20': '0.0583'}
2025-03-05 21:52:34,728 - Validation score increased.  Saving model ...
2025-03-05 21:52:39,457 - {'epoch': 29, 'rec_loss': '5.4951'}
2025-03-05 21:52:40,201 - {'Epoch': 29, 'HR@5': '0.0578', 'NDCG@5': '0.0374', 'HR@10': '0.0872', 'NDCG@10': '0.0467', 'HR@20': '0.1367', 'NDCG@20': '0.0592'}
2025-03-05 21:52:40,202 - Validation score increased.  Saving model ...
2025-03-05 21:52:45,016 - {'epoch': 30, 'rec_loss': '5.4842'}
2025-03-05 21:52:45,787 - {'Epoch': 30, 'HR@5': '0.0550', 'NDCG@5': '0.0361', 'HR@10': '0.0835', 'NDCG@10': '0.0453', 'HR@20': '0.1376', 'NDCG@20': '0.0588'}
2025-03-05 21:52:45,788 - EarlyStopping counter: 1 out of 10
2025-03-05 21:52:50,613 - {'epoch': 31, 'rec_loss': '5.4792'}
2025-03-05 21:52:51,391 - {'Epoch': 31, 'HR@5': '0.0550', 'NDCG@5': '0.0363', 'HR@10': '0.0972', 'NDCG@10': '0.0498', 'HR@20': '0.1376', 'NDCG@20': '0.0599'}
2025-03-05 21:52:51,392 - Validation score increased.  Saving model ...
2025-03-05 21:52:56,410 - {'epoch': 32, 'rec_loss': '5.4632'}
2025-03-05 21:52:57,236 - {'Epoch': 32, 'HR@5': '0.0569', 'NDCG@5': '0.0352', 'HR@10': '0.0936', 'NDCG@10': '0.0470', 'HR@20': '0.1358', 'NDCG@20': '0.0575'}
2025-03-05 21:52:57,238 - EarlyStopping counter: 1 out of 10
2025-03-05 21:53:02,220 - {'epoch': 33, 'rec_loss': '5.4465'}
2025-03-05 21:53:02,980 - {'Epoch': 33, 'HR@5': '0.0587', 'NDCG@5': '0.0369', 'HR@10': '0.0936', 'NDCG@10': '0.0484', 'HR@20': '0.1394', 'NDCG@20': '0.0600'}
2025-03-05 21:53:02,981 - Validation score increased.  Saving model ...
2025-03-05 21:53:07,738 - {'epoch': 34, 'rec_loss': '5.4273'}
2025-03-05 21:53:08,523 - {'Epoch': 34, 'HR@5': '0.0642', 'NDCG@5': '0.0399', 'HR@10': '0.0982', 'NDCG@10': '0.0509', 'HR@20': '0.1367', 'NDCG@20': '0.0605'}
2025-03-05 21:53:08,525 - Validation score increased.  Saving model ...
2025-03-05 21:53:13,255 - {'epoch': 35, 'rec_loss': '5.4017'}
2025-03-05 21:53:14,126 - {'Epoch': 35, 'HR@5': '0.0651', 'NDCG@5': '0.0403', 'HR@10': '0.1018', 'NDCG@10': '0.0521', 'HR@20': '0.1376', 'NDCG@20': '0.0610'}
2025-03-05 21:53:14,127 - Validation score increased.  Saving model ...
2025-03-05 21:53:18,842 - {'epoch': 36, 'rec_loss': '5.4009'}
2025-03-05 21:53:19,708 - {'Epoch': 36, 'HR@5': '0.0606', 'NDCG@5': '0.0366', 'HR@10': '0.0982', 'NDCG@10': '0.0489', 'HR@20': '0.1431', 'NDCG@20': '0.0602'}
2025-03-05 21:53:19,709 - EarlyStopping counter: 1 out of 10
2025-03-05 21:53:24,582 - {'epoch': 37, 'rec_loss': '5.3932'}
2025-03-05 21:53:25,369 - {'Epoch': 37, 'HR@5': '0.0505', 'NDCG@5': '0.0323', 'HR@10': '0.0954', 'NDCG@10': '0.0469', 'HR@20': '0.1459', 'NDCG@20': '0.0594'}
2025-03-05 21:53:25,371 - EarlyStopping counter: 2 out of 10
2025-03-05 21:53:30,182 - {'epoch': 38, 'rec_loss': '5.3947'}
2025-03-05 21:53:30,957 - {'Epoch': 38, 'HR@5': '0.0578', 'NDCG@5': '0.0361', 'HR@10': '0.0972', 'NDCG@10': '0.0486', 'HR@20': '0.1422', 'NDCG@20': '0.0598'}
2025-03-05 21:53:30,958 - EarlyStopping counter: 3 out of 10
2025-03-05 21:53:35,700 - {'epoch': 39, 'rec_loss': '5.3947'}
2025-03-05 21:53:36,492 - {'Epoch': 39, 'HR@5': '0.0541', 'NDCG@5': '0.0340', 'HR@10': '0.0936', 'NDCG@10': '0.0468', 'HR@20': '0.1376', 'NDCG@20': '0.0580'}
2025-03-05 21:53:36,495 - EarlyStopping counter: 4 out of 10
2025-03-05 21:53:41,475 - {'epoch': 40, 'rec_loss': '5.3553'}
2025-03-05 21:53:42,339 - {'Epoch': 40, 'HR@5': '0.0569', 'NDCG@5': '0.0355', 'HR@10': '0.0963', 'NDCG@10': '0.0483', 'HR@20': '0.1477', 'NDCG@20': '0.0612'}
2025-03-05 21:53:42,341 - Validation score increased.  Saving model ...
2025-03-05 21:53:47,272 - {'epoch': 41, 'rec_loss': '5.3692'}
2025-03-05 21:53:48,067 - {'Epoch': 41, 'HR@5': '0.0578', 'NDCG@5': '0.0371', 'HR@10': '0.0963', 'NDCG@10': '0.0497', 'HR@20': '0.1459', 'NDCG@20': '0.0620'}
2025-03-05 21:53:48,068 - Validation score increased.  Saving model ...
2025-03-05 21:53:52,970 - {'epoch': 42, 'rec_loss': '5.3678'}
2025-03-05 21:53:53,730 - {'Epoch': 42, 'HR@5': '0.0615', 'NDCG@5': '0.0392', 'HR@10': '0.0936', 'NDCG@10': '0.0498', 'HR@20': '0.1431', 'NDCG@20': '0.0622'}
2025-03-05 21:53:53,731 - Validation score increased.  Saving model ...
2025-03-05 21:53:58,387 - {'epoch': 43, 'rec_loss': '5.3398'}
2025-03-05 21:53:59,148 - {'Epoch': 43, 'HR@5': '0.0587', 'NDCG@5': '0.0366', 'HR@10': '0.0963', 'NDCG@10': '0.0487', 'HR@20': '0.1394', 'NDCG@20': '0.0595'}
2025-03-05 21:53:59,150 - EarlyStopping counter: 1 out of 10
2025-03-05 21:54:03,918 - {'epoch': 44, 'rec_loss': '5.3383'}
2025-03-05 21:54:04,647 - {'Epoch': 44, 'HR@5': '0.0578', 'NDCG@5': '0.0374', 'HR@10': '0.0927', 'NDCG@10': '0.0489', 'HR@20': '0.1459', 'NDCG@20': '0.0621'}
2025-03-05 21:54:04,648 - EarlyStopping counter: 2 out of 10
2025-03-05 21:54:09,384 - {'epoch': 45, 'rec_loss': '5.3339'}
2025-03-05 21:54:10,160 - {'Epoch': 45, 'HR@5': '0.0624', 'NDCG@5': '0.0399', 'HR@10': '0.1000', 'NDCG@10': '0.0522', 'HR@20': '0.1413', 'NDCG@20': '0.0624'}
2025-03-05 21:54:10,161 - Validation score increased.  Saving model ...
2025-03-05 21:54:14,917 - {'epoch': 46, 'rec_loss': '5.3280'}
2025-03-05 21:54:15,678 - {'Epoch': 46, 'HR@5': '0.0651', 'NDCG@5': '0.0394', 'HR@10': '0.1037', 'NDCG@10': '0.0518', 'HR@20': '0.1431', 'NDCG@20': '0.0616'}
2025-03-05 21:54:15,680 - EarlyStopping counter: 1 out of 10
2025-03-05 21:54:20,352 - {'epoch': 47, 'rec_loss': '5.3151'}
2025-03-05 21:54:21,159 - {'Epoch': 47, 'HR@5': '0.0624', 'NDCG@5': '0.0377', 'HR@10': '0.1009', 'NDCG@10': '0.0503', 'HR@20': '0.1358', 'NDCG@20': '0.0591'}
2025-03-05 21:54:21,160 - EarlyStopping counter: 2 out of 10
2025-03-05 21:54:25,911 - {'epoch': 48, 'rec_loss': '5.3309'}
2025-03-05 21:54:26,676 - {'Epoch': 48, 'HR@5': '0.0615', 'NDCG@5': '0.0377', 'HR@10': '0.1018', 'NDCG@10': '0.0508', 'HR@20': '0.1440', 'NDCG@20': '0.0614'}
2025-03-05 21:54:26,677 - EarlyStopping counter: 3 out of 10
2025-03-05 21:54:31,402 - {'epoch': 49, 'rec_loss': '5.3083'}
2025-03-05 21:54:32,177 - {'Epoch': 49, 'HR@5': '0.0587', 'NDCG@5': '0.0374', 'HR@10': '0.1028', 'NDCG@10': '0.0515', 'HR@20': '0.1404', 'NDCG@20': '0.0609'}
2025-03-05 21:54:32,178 - EarlyStopping counter: 4 out of 10
2025-03-05 21:54:36,879 - {'epoch': 50, 'rec_loss': '5.3093'}
2025-03-05 21:54:37,624 - {'Epoch': 50, 'HR@5': '0.0550', 'NDCG@5': '0.0340', 'HR@10': '0.0991', 'NDCG@10': '0.0483', 'HR@20': '0.1404', 'NDCG@20': '0.0587'}
2025-03-05 21:54:37,625 - EarlyStopping counter: 5 out of 10
2025-03-05 21:54:42,347 - {'epoch': 51, 'rec_loss': '5.2921'}
2025-03-05 21:54:43,116 - {'Epoch': 51, 'HR@5': '0.0606', 'NDCG@5': '0.0375', 'HR@10': '0.0991', 'NDCG@10': '0.0501', 'HR@20': '0.1431', 'NDCG@20': '0.0611'}
2025-03-05 21:54:43,118 - EarlyStopping counter: 6 out of 10
2025-03-05 21:54:47,924 - {'epoch': 52, 'rec_loss': '5.2842'}
2025-03-05 21:54:48,703 - {'Epoch': 52, 'HR@5': '0.0670', 'NDCG@5': '0.0389', 'HR@10': '0.1009', 'NDCG@10': '0.0499', 'HR@20': '0.1394', 'NDCG@20': '0.0595'}
2025-03-05 21:54:48,704 - EarlyStopping counter: 7 out of 10
2025-03-05 21:54:53,502 - {'epoch': 53, 'rec_loss': '5.2907'}
2025-03-05 21:54:54,231 - {'Epoch': 53, 'HR@5': '0.0661', 'NDCG@5': '0.0404', 'HR@10': '0.1037', 'NDCG@10': '0.0528', 'HR@20': '0.1404', 'NDCG@20': '0.0620'}
2025-03-05 21:54:54,232 - EarlyStopping counter: 8 out of 10
2025-03-05 21:54:58,932 - {'epoch': 54, 'rec_loss': '5.2657'}
2025-03-05 21:54:59,679 - {'Epoch': 54, 'HR@5': '0.0633', 'NDCG@5': '0.0390', 'HR@10': '0.1018', 'NDCG@10': '0.0515', 'HR@20': '0.1394', 'NDCG@20': '0.0610'}
2025-03-05 21:54:59,681 - EarlyStopping counter: 9 out of 10
2025-03-05 21:55:04,429 - {'epoch': 55, 'rec_loss': '5.2627'}
2025-03-05 21:55:05,169 - {'Epoch': 55, 'HR@5': '0.0615', 'NDCG@5': '0.0391', 'HR@10': '0.0982', 'NDCG@10': '0.0513', 'HR@20': '0.1394', 'NDCG@20': '0.0617'}
2025-03-05 21:55:05,170 - EarlyStopping counter: 10 out of 10
2025-03-05 21:55:05,170 - Early stopping
2025-03-05 21:55:05,170 - ---------------Test Score---------------
2025-03-05 21:55:05,952 - {'Epoch': 0, 'HR@5': '0.0541', 'NDCG@5': '0.0356', 'HR@10': '0.0706', 'NDCG@10': '0.0408', 'HR@20': '0.0991', 'NDCG@20': '0.0480'}
2025-03-05 21:55:05,954 - Scale_LastFM
2025-03-05 21:55:05,954 - {'Epoch': 0, 'HR@5': '0.0541', 'NDCG@5': '0.0356', 'HR@10': '0.0706', 'NDCG@10': '0.0408', 'HR@20': '0.0991', 'NDCG@20': '0.0480'}
2025-03-06 16:18:51,176 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-03-06 16:18:54,647 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-06 16:18:54,652 - Total Parameters: 387350
2025-03-06 16:19:00,484 - {'epoch': 0, 'rec_loss': '8.0417'}
2025-03-06 16:19:01,322 - {'Epoch': 0, 'HR@5': '0.0220', 'NDCG@5': '0.0152', 'HR@10': '0.0349', 'NDCG@10': '0.0192', 'HR@20': '0.0633', 'NDCG@20': '0.0263'}
2025-03-06 16:19:01,323 - Validation score increased.  Saving model ...
2025-03-06 16:19:06,785 - {'epoch': 1, 'rec_loss': '7.7654'}
2025-03-06 16:19:07,587 - {'Epoch': 1, 'HR@5': '0.0239', 'NDCG@5': '0.0149', 'HR@10': '0.0358', 'NDCG@10': '0.0187', 'HR@20': '0.0615', 'NDCG@20': '0.0251'}
2025-03-06 16:19:07,588 - EarlyStopping counter: 1 out of 10
2025-03-06 16:19:12,655 - {'epoch': 2, 'rec_loss': '7.5574'}
2025-03-06 16:19:13,444 - {'Epoch': 2, 'HR@5': '0.0303', 'NDCG@5': '0.0203', 'HR@10': '0.0486', 'NDCG@10': '0.0262', 'HR@20': '0.0725', 'NDCG@20': '0.0321'}
2025-03-06 16:19:13,445 - Validation score increased.  Saving model ...
2025-03-06 16:19:18,793 - {'epoch': 3, 'rec_loss': '7.3333'}
2025-03-06 16:19:19,607 - {'Epoch': 3, 'HR@5': '0.0321', 'NDCG@5': '0.0217', 'HR@10': '0.0477', 'NDCG@10': '0.0265', 'HR@20': '0.0688', 'NDCG@20': '0.0319'}
2025-03-06 16:19:19,608 - EarlyStopping counter: 1 out of 10
2025-03-06 16:19:25,237 - {'epoch': 4, 'rec_loss': '7.1229'}
2025-03-06 16:19:26,117 - {'Epoch': 4, 'HR@5': '0.0367', 'NDCG@5': '0.0239', 'HR@10': '0.0505', 'NDCG@10': '0.0283', 'HR@20': '0.0872', 'NDCG@20': '0.0376'}
2025-03-06 16:19:26,118 - Validation score increased.  Saving model ...
2025-03-06 16:19:31,188 - {'epoch': 5, 'rec_loss': '6.9174'}
2025-03-06 16:19:32,039 - {'Epoch': 5, 'HR@5': '0.0349', 'NDCG@5': '0.0240', 'HR@10': '0.0532', 'NDCG@10': '0.0300', 'HR@20': '0.0954', 'NDCG@20': '0.0405'}
2025-03-06 16:19:32,040 - Validation score increased.  Saving model ...
2025-03-06 16:19:37,375 - {'epoch': 6, 'rec_loss': '6.7188'}
2025-03-06 16:19:38,241 - {'Epoch': 6, 'HR@5': '0.0394', 'NDCG@5': '0.0237', 'HR@10': '0.0679', 'NDCG@10': '0.0332', 'HR@20': '0.0972', 'NDCG@20': '0.0405'}
2025-03-06 16:19:38,243 - Validation score increased.  Saving model ...
2025-03-06 16:19:43,844 - {'epoch': 7, 'rec_loss': '6.5407'}
2025-03-06 16:19:44,699 - {'Epoch': 7, 'HR@5': '0.0450', 'NDCG@5': '0.0273', 'HR@10': '0.0679', 'NDCG@10': '0.0346', 'HR@20': '0.0982', 'NDCG@20': '0.0423'}
2025-03-06 16:19:44,700 - Validation score increased.  Saving model ...
2025-03-06 16:19:50,043 - {'epoch': 8, 'rec_loss': '6.3776'}
2025-03-06 16:19:50,909 - {'Epoch': 8, 'HR@5': '0.0404', 'NDCG@5': '0.0262', 'HR@10': '0.0679', 'NDCG@10': '0.0350', 'HR@20': '0.1092', 'NDCG@20': '0.0456'}
2025-03-06 16:19:50,911 - Validation score increased.  Saving model ...
2025-03-06 16:19:55,897 - {'epoch': 9, 'rec_loss': '6.2627'}
2025-03-06 16:19:56,757 - {'Epoch': 9, 'HR@5': '0.0486', 'NDCG@5': '0.0308', 'HR@10': '0.0743', 'NDCG@10': '0.0390', 'HR@20': '0.1147', 'NDCG@20': '0.0492'}
2025-03-06 16:19:56,759 - Validation score increased.  Saving model ...
2025-03-06 16:20:02,104 - {'epoch': 10, 'rec_loss': '6.1214'}
2025-03-06 16:20:02,981 - {'Epoch': 10, 'HR@5': '0.0450', 'NDCG@5': '0.0292', 'HR@10': '0.0706', 'NDCG@10': '0.0375', 'HR@20': '0.1193', 'NDCG@20': '0.0497'}
2025-03-06 16:20:02,982 - Validation score increased.  Saving model ...
2025-03-06 16:20:08,745 - {'epoch': 11, 'rec_loss': '6.0476'}
2025-03-06 16:20:09,562 - {'Epoch': 11, 'HR@5': '0.0459', 'NDCG@5': '0.0304', 'HR@10': '0.0752', 'NDCG@10': '0.0396', 'HR@20': '0.1211', 'NDCG@20': '0.0512'}
2025-03-06 16:20:09,563 - Validation score increased.  Saving model ...
2025-03-06 16:20:14,821 - {'epoch': 12, 'rec_loss': '5.9572'}
2025-03-06 16:20:15,719 - {'Epoch': 12, 'HR@5': '0.0486', 'NDCG@5': '0.0307', 'HR@10': '0.0761', 'NDCG@10': '0.0394', 'HR@20': '0.1321', 'NDCG@20': '0.0535'}
2025-03-06 16:20:15,720 - Validation score increased.  Saving model ...
2025-03-06 16:20:21,132 - {'epoch': 13, 'rec_loss': '5.8748'}
2025-03-06 16:20:21,962 - {'Epoch': 13, 'HR@5': '0.0450', 'NDCG@5': '0.0301', 'HR@10': '0.0807', 'NDCG@10': '0.0415', 'HR@20': '0.1239', 'NDCG@20': '0.0525'}
2025-03-06 16:20:21,963 - EarlyStopping counter: 1 out of 10
2025-03-06 16:20:27,600 - {'epoch': 14, 'rec_loss': '5.8085'}
2025-03-06 16:20:28,462 - {'Epoch': 14, 'HR@5': '0.0477', 'NDCG@5': '0.0313', 'HR@10': '0.0789', 'NDCG@10': '0.0416', 'HR@20': '0.1275', 'NDCG@20': '0.0539'}
2025-03-06 16:20:28,464 - Validation score increased.  Saving model ...
2025-03-06 16:20:34,203 - {'epoch': 15, 'rec_loss': '5.7617'}
2025-03-06 16:20:35,040 - {'Epoch': 15, 'HR@5': '0.0514', 'NDCG@5': '0.0339', 'HR@10': '0.0817', 'NDCG@10': '0.0438', 'HR@20': '0.1303', 'NDCG@20': '0.0560'}
2025-03-06 16:20:35,041 - Validation score increased.  Saving model ...
2025-03-06 16:20:40,521 - {'epoch': 16, 'rec_loss': '5.7299'}
2025-03-06 16:20:41,441 - {'Epoch': 16, 'HR@5': '0.0477', 'NDCG@5': '0.0317', 'HR@10': '0.0780', 'NDCG@10': '0.0416', 'HR@20': '0.1248', 'NDCG@20': '0.0534'}
2025-03-06 16:20:41,442 - EarlyStopping counter: 1 out of 10
2025-03-06 16:20:47,354 - {'epoch': 17, 'rec_loss': '5.6833'}
2025-03-06 16:20:48,264 - {'Epoch': 17, 'HR@5': '0.0514', 'NDCG@5': '0.0329', 'HR@10': '0.0817', 'NDCG@10': '0.0428', 'HR@20': '0.1312', 'NDCG@20': '0.0553'}
2025-03-06 16:20:48,265 - EarlyStopping counter: 2 out of 10
2025-03-06 16:20:53,660 - {'epoch': 18, 'rec_loss': '5.6307'}
2025-03-06 16:20:54,463 - {'Epoch': 18, 'HR@5': '0.0495', 'NDCG@5': '0.0310', 'HR@10': '0.0835', 'NDCG@10': '0.0419', 'HR@20': '0.1358', 'NDCG@20': '0.0551'}
2025-03-06 16:20:54,465 - EarlyStopping counter: 3 out of 10
2025-03-06 16:20:59,127 - {'epoch': 19, 'rec_loss': '5.5999'}
2025-03-06 16:20:59,955 - {'Epoch': 19, 'HR@5': '0.0532', 'NDCG@5': '0.0322', 'HR@10': '0.0899', 'NDCG@10': '0.0440', 'HR@20': '0.1413', 'NDCG@20': '0.0568'}
2025-03-06 16:20:59,958 - Validation score increased.  Saving model ...
2025-03-06 16:21:04,326 - {'epoch': 20, 'rec_loss': '5.5795'}
2025-03-06 16:21:05,116 - {'Epoch': 20, 'HR@5': '0.0486', 'NDCG@5': '0.0326', 'HR@10': '0.0844', 'NDCG@10': '0.0441', 'HR@20': '0.1376', 'NDCG@20': '0.0575'}
2025-03-06 16:21:05,117 - Validation score increased.  Saving model ...
2025-03-06 16:21:09,554 - {'epoch': 21, 'rec_loss': '5.5415'}
2025-03-06 16:21:10,357 - {'Epoch': 21, 'HR@5': '0.0532', 'NDCG@5': '0.0347', 'HR@10': '0.0862', 'NDCG@10': '0.0452', 'HR@20': '0.1358', 'NDCG@20': '0.0577'}
2025-03-06 16:21:10,358 - Validation score increased.  Saving model ...
2025-03-06 16:21:15,195 - {'epoch': 22, 'rec_loss': '5.5359'}
2025-03-06 16:21:16,010 - {'Epoch': 22, 'HR@5': '0.0550', 'NDCG@5': '0.0362', 'HR@10': '0.0835', 'NDCG@10': '0.0453', 'HR@20': '0.1367', 'NDCG@20': '0.0588'}
2025-03-06 16:21:16,011 - Validation score increased.  Saving model ...
2025-03-06 16:21:20,875 - {'epoch': 23, 'rec_loss': '5.5266'}
2025-03-06 16:21:21,707 - {'Epoch': 23, 'HR@5': '0.0550', 'NDCG@5': '0.0361', 'HR@10': '0.0917', 'NDCG@10': '0.0476', 'HR@20': '0.1459', 'NDCG@20': '0.0613'}
2025-03-06 16:21:21,708 - Validation score increased.  Saving model ...
2025-03-06 16:21:26,467 - {'epoch': 24, 'rec_loss': '5.4846'}
2025-03-06 16:21:27,262 - {'Epoch': 24, 'HR@5': '0.0550', 'NDCG@5': '0.0350', 'HR@10': '0.0954', 'NDCG@10': '0.0478', 'HR@20': '0.1376', 'NDCG@20': '0.0584'}
2025-03-06 16:21:27,263 - EarlyStopping counter: 1 out of 10
2025-03-06 16:21:32,137 - {'epoch': 25, 'rec_loss': '5.4534'}
2025-03-06 16:21:32,935 - {'Epoch': 25, 'HR@5': '0.0569', 'NDCG@5': '0.0355', 'HR@10': '0.0844', 'NDCG@10': '0.0443', 'HR@20': '0.1450', 'NDCG@20': '0.0597'}
2025-03-06 16:21:32,936 - EarlyStopping counter: 2 out of 10
2025-03-06 16:21:37,629 - {'epoch': 26, 'rec_loss': '5.4607'}
2025-03-06 16:21:38,431 - {'Epoch': 26, 'HR@5': '0.0505', 'NDCG@5': '0.0322', 'HR@10': '0.0927', 'NDCG@10': '0.0457', 'HR@20': '0.1477', 'NDCG@20': '0.0594'}
2025-03-06 16:21:38,432 - EarlyStopping counter: 3 out of 10
2025-03-06 16:21:43,077 - {'epoch': 27, 'rec_loss': '5.4435'}
2025-03-06 16:21:43,857 - {'Epoch': 27, 'HR@5': '0.0560', 'NDCG@5': '0.0369', 'HR@10': '0.0872', 'NDCG@10': '0.0467', 'HR@20': '0.1349', 'NDCG@20': '0.0590'}
2025-03-06 16:21:43,859 - EarlyStopping counter: 4 out of 10
2025-03-06 16:21:48,512 - {'epoch': 28, 'rec_loss': '5.4263'}
2025-03-06 16:21:49,333 - {'Epoch': 28, 'HR@5': '0.0587', 'NDCG@5': '0.0382', 'HR@10': '0.0890', 'NDCG@10': '0.0477', 'HR@20': '0.1450', 'NDCG@20': '0.0617'}
2025-03-06 16:21:49,334 - Validation score increased.  Saving model ...
2025-03-06 16:21:54,543 - {'epoch': 29, 'rec_loss': '5.4130'}
2025-03-06 16:21:55,325 - {'Epoch': 29, 'HR@5': '0.0560', 'NDCG@5': '0.0380', 'HR@10': '0.0844', 'NDCG@10': '0.0472', 'HR@20': '0.1431', 'NDCG@20': '0.0620'}
2025-03-06 16:21:55,326 - Validation score increased.  Saving model ...
2025-03-06 16:22:00,199 - {'epoch': 30, 'rec_loss': '5.4015'}
2025-03-06 16:22:01,013 - {'Epoch': 30, 'HR@5': '0.0560', 'NDCG@5': '0.0369', 'HR@10': '0.0844', 'NDCG@10': '0.0459', 'HR@20': '0.1422', 'NDCG@20': '0.0605'}
2025-03-06 16:22:01,015 - EarlyStopping counter: 1 out of 10
2025-03-06 16:22:05,633 - {'epoch': 31, 'rec_loss': '5.3934'}
2025-03-06 16:22:06,465 - {'Epoch': 31, 'HR@5': '0.0606', 'NDCG@5': '0.0384', 'HR@10': '0.0954', 'NDCG@10': '0.0496', 'HR@20': '0.1468', 'NDCG@20': '0.0625'}
2025-03-06 16:22:06,467 - Validation score increased.  Saving model ...
2025-03-06 16:22:12,307 - {'epoch': 32, 'rec_loss': '5.3853'}
2025-03-06 16:22:13,224 - {'Epoch': 32, 'HR@5': '0.0596', 'NDCG@5': '0.0370', 'HR@10': '0.0945', 'NDCG@10': '0.0482', 'HR@20': '0.1459', 'NDCG@20': '0.0611'}
2025-03-06 16:22:13,226 - EarlyStopping counter: 1 out of 10
2025-03-06 16:22:18,823 - {'epoch': 33, 'rec_loss': '5.3680'}
2025-03-06 16:22:19,667 - {'Epoch': 33, 'HR@5': '0.0587', 'NDCG@5': '0.0373', 'HR@10': '0.0982', 'NDCG@10': '0.0500', 'HR@20': '0.1468', 'NDCG@20': '0.0623'}
2025-03-06 16:22:19,668 - EarlyStopping counter: 2 out of 10
2025-03-06 16:22:25,026 - {'epoch': 34, 'rec_loss': '5.3558'}
2025-03-06 16:22:25,865 - {'Epoch': 34, 'HR@5': '0.0624', 'NDCG@5': '0.0396', 'HR@10': '0.1000', 'NDCG@10': '0.0516', 'HR@20': '0.1486', 'NDCG@20': '0.0639'}
2025-03-06 16:22:25,866 - Validation score increased.  Saving model ...
2025-03-06 16:22:31,317 - {'epoch': 35, 'rec_loss': '5.3258'}
2025-03-06 16:22:32,208 - {'Epoch': 35, 'HR@5': '0.0661', 'NDCG@5': '0.0417', 'HR@10': '0.1055', 'NDCG@10': '0.0543', 'HR@20': '0.1477', 'NDCG@20': '0.0649'}
2025-03-06 16:22:32,210 - Validation score increased.  Saving model ...
2025-03-06 16:22:37,988 - {'epoch': 36, 'rec_loss': '5.3172'}
2025-03-06 16:22:38,852 - {'Epoch': 36, 'HR@5': '0.0615', 'NDCG@5': '0.0393', 'HR@10': '0.0945', 'NDCG@10': '0.0498', 'HR@20': '0.1495', 'NDCG@20': '0.0638'}
2025-03-06 16:22:38,854 - EarlyStopping counter: 1 out of 10
2025-03-06 16:22:44,240 - {'epoch': 37, 'rec_loss': '5.3168'}
2025-03-06 16:22:45,100 - {'Epoch': 37, 'HR@5': '0.0624', 'NDCG@5': '0.0391', 'HR@10': '0.0954', 'NDCG@10': '0.0497', 'HR@20': '0.1495', 'NDCG@20': '0.0636'}
2025-03-06 16:22:45,101 - EarlyStopping counter: 2 out of 10
2025-03-06 16:22:50,401 - {'epoch': 38, 'rec_loss': '5.3217'}
2025-03-06 16:22:51,235 - {'Epoch': 38, 'HR@5': '0.0606', 'NDCG@5': '0.0396', 'HR@10': '0.0991', 'NDCG@10': '0.0520', 'HR@20': '0.1486', 'NDCG@20': '0.0645'}
2025-03-06 16:22:51,236 - EarlyStopping counter: 3 out of 10
2025-03-06 16:22:56,574 - {'epoch': 39, 'rec_loss': '5.3166'}
2025-03-06 16:22:57,473 - {'Epoch': 39, 'HR@5': '0.0569', 'NDCG@5': '0.0358', 'HR@10': '0.0954', 'NDCG@10': '0.0483', 'HR@20': '0.1477', 'NDCG@20': '0.0616'}
2025-03-06 16:22:57,475 - EarlyStopping counter: 4 out of 10
2025-03-06 16:23:02,729 - {'epoch': 40, 'rec_loss': '5.2726'}
2025-03-06 16:23:03,577 - {'Epoch': 40, 'HR@5': '0.0670', 'NDCG@5': '0.0412', 'HR@10': '0.1000', 'NDCG@10': '0.0519', 'HR@20': '0.1486', 'NDCG@20': '0.0641'}
2025-03-06 16:23:03,578 - EarlyStopping counter: 5 out of 10
2025-03-06 16:23:09,327 - {'epoch': 41, 'rec_loss': '5.2911'}
2025-03-06 16:23:10,201 - {'Epoch': 41, 'HR@5': '0.0651', 'NDCG@5': '0.0417', 'HR@10': '0.1000', 'NDCG@10': '0.0530', 'HR@20': '0.1431', 'NDCG@20': '0.0638'}
2025-03-06 16:23:10,203 - EarlyStopping counter: 6 out of 10
2025-03-06 16:23:15,305 - {'epoch': 42, 'rec_loss': '5.2887'}
2025-03-06 16:23:16,198 - {'Epoch': 42, 'HR@5': '0.0679', 'NDCG@5': '0.0422', 'HR@10': '0.0991', 'NDCG@10': '0.0522', 'HR@20': '0.1468', 'NDCG@20': '0.0641'}
2025-03-06 16:23:16,199 - EarlyStopping counter: 7 out of 10
2025-03-06 16:23:21,833 - {'epoch': 43, 'rec_loss': '5.2586'}
2025-03-06 16:23:22,812 - {'Epoch': 43, 'HR@5': '0.0633', 'NDCG@5': '0.0404', 'HR@10': '0.0954', 'NDCG@10': '0.0507', 'HR@20': '0.1459', 'NDCG@20': '0.0636'}
2025-03-06 16:23:22,814 - EarlyStopping counter: 8 out of 10
2025-03-06 16:23:28,294 - {'epoch': 44, 'rec_loss': '5.2665'}
2025-03-06 16:23:29,116 - {'Epoch': 44, 'HR@5': '0.0633', 'NDCG@5': '0.0401', 'HR@10': '0.1000', 'NDCG@10': '0.0519', 'HR@20': '0.1477', 'NDCG@20': '0.0638'}
2025-03-06 16:23:29,117 - EarlyStopping counter: 9 out of 10
2025-03-06 16:23:34,407 - {'epoch': 45, 'rec_loss': '5.2555'}
2025-03-06 16:23:35,271 - {'Epoch': 45, 'HR@5': '0.0642', 'NDCG@5': '0.0419', 'HR@10': '0.0963', 'NDCG@10': '0.0522', 'HR@20': '0.1532', 'NDCG@20': '0.0664'}
2025-03-06 16:23:35,273 - Validation score increased.  Saving model ...
2025-03-06 16:23:40,798 - {'epoch': 46, 'rec_loss': '5.2416'}
2025-03-06 16:23:41,555 - {'Epoch': 46, 'HR@5': '0.0716', 'NDCG@5': '0.0436', 'HR@10': '0.1009', 'NDCG@10': '0.0531', 'HR@20': '0.1550', 'NDCG@20': '0.0667'}
2025-03-06 16:23:41,556 - Validation score increased.  Saving model ...
2025-03-06 16:23:46,620 - {'epoch': 47, 'rec_loss': '5.2427'}
2025-03-06 16:23:47,407 - {'Epoch': 47, 'HR@5': '0.0670', 'NDCG@5': '0.0409', 'HR@10': '0.1000', 'NDCG@10': '0.0515', 'HR@20': '0.1532', 'NDCG@20': '0.0648'}
2025-03-06 16:23:47,408 - EarlyStopping counter: 1 out of 10
2025-03-06 16:23:52,208 - {'epoch': 48, 'rec_loss': '5.2541'}
2025-03-06 16:23:53,053 - {'Epoch': 48, 'HR@5': '0.0670', 'NDCG@5': '0.0410', 'HR@10': '0.1037', 'NDCG@10': '0.0529', 'HR@20': '0.1514', 'NDCG@20': '0.0649'}
2025-03-06 16:23:53,055 - EarlyStopping counter: 2 out of 10
2025-03-06 16:23:57,497 - {'epoch': 49, 'rec_loss': '5.2324'}
2025-03-06 16:23:58,273 - {'Epoch': 49, 'HR@5': '0.0624', 'NDCG@5': '0.0387', 'HR@10': '0.1000', 'NDCG@10': '0.0509', 'HR@20': '0.1569', 'NDCG@20': '0.0651'}
2025-03-06 16:23:58,275 - EarlyStopping counter: 3 out of 10
2025-03-06 16:24:02,750 - {'epoch': 50, 'rec_loss': '5.2349'}
2025-03-06 16:24:03,596 - {'Epoch': 50, 'HR@5': '0.0624', 'NDCG@5': '0.0396', 'HR@10': '0.1046', 'NDCG@10': '0.0532', 'HR@20': '0.1532', 'NDCG@20': '0.0654'}
2025-03-06 16:24:03,598 - EarlyStopping counter: 4 out of 10
2025-03-06 16:24:08,395 - {'epoch': 51, 'rec_loss': '5.2169'}
2025-03-06 16:24:09,181 - {'Epoch': 51, 'HR@5': '0.0679', 'NDCG@5': '0.0421', 'HR@10': '0.0991', 'NDCG@10': '0.0522', 'HR@20': '0.1532', 'NDCG@20': '0.0657'}
2025-03-06 16:24:09,182 - EarlyStopping counter: 5 out of 10
2025-03-06 16:24:14,057 - {'epoch': 52, 'rec_loss': '5.2105'}
2025-03-06 16:24:14,839 - {'Epoch': 52, 'HR@5': '0.0661', 'NDCG@5': '0.0412', 'HR@10': '0.1064', 'NDCG@10': '0.0542', 'HR@20': '0.1532', 'NDCG@20': '0.0658'}
2025-03-06 16:24:14,840 - EarlyStopping counter: 6 out of 10
2025-03-06 16:24:19,567 - {'epoch': 53, 'rec_loss': '5.2175'}
2025-03-06 16:24:20,351 - {'Epoch': 53, 'HR@5': '0.0651', 'NDCG@5': '0.0425', 'HR@10': '0.1018', 'NDCG@10': '0.0543', 'HR@20': '0.1532', 'NDCG@20': '0.0672'}
2025-03-06 16:24:20,352 - Validation score increased.  Saving model ...
2025-03-06 16:24:25,142 - {'epoch': 54, 'rec_loss': '5.1911'}
2025-03-06 16:24:25,938 - {'Epoch': 54, 'HR@5': '0.0679', 'NDCG@5': '0.0425', 'HR@10': '0.1009', 'NDCG@10': '0.0532', 'HR@20': '0.1505', 'NDCG@20': '0.0658'}
2025-03-06 16:24:25,939 - EarlyStopping counter: 1 out of 10
2025-03-06 16:24:30,859 - {'epoch': 55, 'rec_loss': '5.1864'}
2025-03-06 16:24:31,655 - {'Epoch': 55, 'HR@5': '0.0661', 'NDCG@5': '0.0423', 'HR@10': '0.1037', 'NDCG@10': '0.0545', 'HR@20': '0.1477', 'NDCG@20': '0.0655'}
2025-03-06 16:24:31,657 - EarlyStopping counter: 2 out of 10
2025-03-06 16:24:36,584 - {'epoch': 56, 'rec_loss': '5.1903'}
2025-03-06 16:24:37,375 - {'Epoch': 56, 'HR@5': '0.0679', 'NDCG@5': '0.0424', 'HR@10': '0.1018', 'NDCG@10': '0.0531', 'HR@20': '0.1495', 'NDCG@20': '0.0652'}
2025-03-06 16:24:37,376 - EarlyStopping counter: 3 out of 10
2025-03-06 16:24:42,249 - {'epoch': 57, 'rec_loss': '5.2178'}
2025-03-06 16:24:43,064 - {'Epoch': 57, 'HR@5': '0.0615', 'NDCG@5': '0.0386', 'HR@10': '0.1000', 'NDCG@10': '0.0510', 'HR@20': '0.1505', 'NDCG@20': '0.0638'}
2025-03-06 16:24:43,065 - EarlyStopping counter: 4 out of 10
2025-03-06 16:24:47,893 - {'epoch': 58, 'rec_loss': '5.2168'}
2025-03-06 16:24:48,716 - {'Epoch': 58, 'HR@5': '0.0670', 'NDCG@5': '0.0424', 'HR@10': '0.0982', 'NDCG@10': '0.0525', 'HR@20': '0.1450', 'NDCG@20': '0.0642'}
2025-03-06 16:24:48,717 - EarlyStopping counter: 5 out of 10
2025-03-06 16:24:53,727 - {'epoch': 59, 'rec_loss': '5.1947'}
2025-03-06 16:24:54,540 - {'Epoch': 59, 'HR@5': '0.0624', 'NDCG@5': '0.0418', 'HR@10': '0.1028', 'NDCG@10': '0.0549', 'HR@20': '0.1459', 'NDCG@20': '0.0657'}
2025-03-06 16:24:54,541 - EarlyStopping counter: 6 out of 10
2025-03-06 16:24:59,860 - {'epoch': 60, 'rec_loss': '5.1733'}
2025-03-06 16:25:00,687 - {'Epoch': 60, 'HR@5': '0.0633', 'NDCG@5': '0.0404', 'HR@10': '0.1064', 'NDCG@10': '0.0544', 'HR@20': '0.1450', 'NDCG@20': '0.0640'}
2025-03-06 16:25:00,688 - EarlyStopping counter: 7 out of 10
2025-03-06 16:25:06,427 - {'epoch': 61, 'rec_loss': '5.1695'}
2025-03-06 16:25:07,373 - {'Epoch': 61, 'HR@5': '0.0688', 'NDCG@5': '0.0445', 'HR@10': '0.1018', 'NDCG@10': '0.0551', 'HR@20': '0.1505', 'NDCG@20': '0.0671'}
2025-03-06 16:25:07,375 - EarlyStopping counter: 8 out of 10
2025-03-06 16:25:12,775 - {'epoch': 62, 'rec_loss': '5.1815'}
2025-03-06 16:25:13,612 - {'Epoch': 62, 'HR@5': '0.0697', 'NDCG@5': '0.0463', 'HR@10': '0.1009', 'NDCG@10': '0.0565', 'HR@20': '0.1505', 'NDCG@20': '0.0688'}
2025-03-06 16:25:13,613 - Validation score increased.  Saving model ...
2025-03-06 16:25:19,350 - {'epoch': 63, 'rec_loss': '5.1763'}
2025-03-06 16:25:20,213 - {'Epoch': 63, 'HR@5': '0.0670', 'NDCG@5': '0.0439', 'HR@10': '0.1009', 'NDCG@10': '0.0547', 'HR@20': '0.1523', 'NDCG@20': '0.0676'}
2025-03-06 16:25:20,214 - EarlyStopping counter: 1 out of 10
2025-03-06 16:25:26,260 - {'epoch': 64, 'rec_loss': '5.1638'}
2025-03-06 16:25:27,141 - {'Epoch': 64, 'HR@5': '0.0642', 'NDCG@5': '0.0435', 'HR@10': '0.1000', 'NDCG@10': '0.0552', 'HR@20': '0.1413', 'NDCG@20': '0.0656'}
2025-03-06 16:25:27,142 - EarlyStopping counter: 2 out of 10
2025-03-06 16:25:32,701 - {'epoch': 65, 'rec_loss': '5.1787'}
2025-03-06 16:25:33,584 - {'Epoch': 65, 'HR@5': '0.0679', 'NDCG@5': '0.0440', 'HR@10': '0.1037', 'NDCG@10': '0.0555', 'HR@20': '0.1486', 'NDCG@20': '0.0667'}
2025-03-06 16:25:33,586 - EarlyStopping counter: 3 out of 10
2025-03-06 16:25:39,328 - {'epoch': 66, 'rec_loss': '5.1502'}
2025-03-06 16:25:40,193 - {'Epoch': 66, 'HR@5': '0.0596', 'NDCG@5': '0.0395', 'HR@10': '0.1037', 'NDCG@10': '0.0537', 'HR@20': '0.1394', 'NDCG@20': '0.0627'}
2025-03-06 16:25:40,195 - EarlyStopping counter: 4 out of 10
2025-03-06 16:25:45,869 - {'epoch': 67, 'rec_loss': '5.1611'}
2025-03-06 16:25:46,697 - {'Epoch': 67, 'HR@5': '0.0651', 'NDCG@5': '0.0408', 'HR@10': '0.0991', 'NDCG@10': '0.0519', 'HR@20': '0.1431', 'NDCG@20': '0.0631'}
2025-03-06 16:25:46,698 - EarlyStopping counter: 5 out of 10
2025-03-06 16:25:52,326 - {'epoch': 68, 'rec_loss': '5.1674'}
2025-03-06 16:25:53,134 - {'Epoch': 68, 'HR@5': '0.0706', 'NDCG@5': '0.0449', 'HR@10': '0.1055', 'NDCG@10': '0.0560', 'HR@20': '0.1468', 'NDCG@20': '0.0664'}
2025-03-06 16:25:53,136 - EarlyStopping counter: 6 out of 10
2025-03-06 16:25:58,383 - {'epoch': 69, 'rec_loss': '5.1545'}
2025-03-06 16:25:59,347 - {'Epoch': 69, 'HR@5': '0.0679', 'NDCG@5': '0.0440', 'HR@10': '0.1046', 'NDCG@10': '0.0559', 'HR@20': '0.1523', 'NDCG@20': '0.0679'}
2025-03-06 16:25:59,349 - EarlyStopping counter: 7 out of 10
2025-03-06 16:26:04,878 - {'epoch': 70, 'rec_loss': '5.1435'}
2025-03-06 16:26:05,822 - {'Epoch': 70, 'HR@5': '0.0725', 'NDCG@5': '0.0467', 'HR@10': '0.1073', 'NDCG@10': '0.0579', 'HR@20': '0.1468', 'NDCG@20': '0.0677'}
2025-03-06 16:26:05,823 - EarlyStopping counter: 8 out of 10
2025-03-06 16:26:11,339 - {'epoch': 71, 'rec_loss': '5.1327'}
2025-03-06 16:26:12,206 - {'Epoch': 71, 'HR@5': '0.0661', 'NDCG@5': '0.0424', 'HR@10': '0.1064', 'NDCG@10': '0.0555', 'HR@20': '0.1468', 'NDCG@20': '0.0657'}
2025-03-06 16:26:12,207 - EarlyStopping counter: 9 out of 10
2025-03-06 16:26:17,509 - {'epoch': 72, 'rec_loss': '5.1191'}
2025-03-06 16:26:18,350 - {'Epoch': 72, 'HR@5': '0.0688', 'NDCG@5': '0.0447', 'HR@10': '0.1083', 'NDCG@10': '0.0574', 'HR@20': '0.1514', 'NDCG@20': '0.0681'}
2025-03-06 16:26:18,351 - EarlyStopping counter: 10 out of 10
2025-03-06 16:26:18,351 - Early stopping
2025-03-06 16:26:18,351 - ---------------Test Score---------------
2025-03-06 16:26:19,197 - {'Epoch': 0, 'HR@5': '0.0532', 'NDCG@5': '0.0344', 'HR@10': '0.0761', 'NDCG@10': '0.0417', 'HR@20': '0.1064', 'NDCG@20': '0.0491'}
2025-03-06 16:26:19,198 - Scale_LastFM
2025-03-06 16:26:19,198 - {'Epoch': 0, 'HR@5': '0.0532', 'NDCG@5': '0.0344', 'HR@10': '0.0761', 'NDCG@10': '0.0417', 'HR@20': '0.1064', 'NDCG@20': '0.0491'}
2025-03-06 21:37:20,610 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-03-06 21:37:24,587 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-06 21:37:24,601 - Total Parameters: 387350
2025-03-06 21:37:32,165 - {'epoch': 0, 'rec_loss': '8.0464'}
2025-03-06 21:37:33,101 - {'Epoch': 0, 'HR@5': '0.0211', 'NDCG@5': '0.0144', 'HR@10': '0.0394', 'NDCG@10': '0.0200', 'HR@20': '0.0596', 'NDCG@20': '0.0251'}
2025-03-06 21:37:33,102 - Validation score increased.  Saving model ...
2025-03-06 21:37:40,311 - {'epoch': 1, 'rec_loss': '7.6900'}
2025-03-06 21:37:41,289 - {'Epoch': 1, 'HR@5': '0.0183', 'NDCG@5': '0.0130', 'HR@10': '0.0339', 'NDCG@10': '0.0182', 'HR@20': '0.0560', 'NDCG@20': '0.0238'}
2025-03-06 21:37:41,291 - EarlyStopping counter: 1 out of 10
2025-03-06 21:37:46,815 - {'epoch': 2, 'rec_loss': '7.3852'}
2025-03-06 21:37:47,832 - {'Epoch': 2, 'HR@5': '0.0339', 'NDCG@5': '0.0220', 'HR@10': '0.0486', 'NDCG@10': '0.0267', 'HR@20': '0.0697', 'NDCG@20': '0.0320'}
2025-03-06 21:37:47,834 - Validation score increased.  Saving model ...
2025-03-06 21:37:52,900 - {'epoch': 3, 'rec_loss': '7.0469'}
2025-03-06 21:37:53,915 - {'Epoch': 3, 'HR@5': '0.0339', 'NDCG@5': '0.0228', 'HR@10': '0.0514', 'NDCG@10': '0.0283', 'HR@20': '0.0817', 'NDCG@20': '0.0360'}
2025-03-06 21:37:53,917 - Validation score increased.  Saving model ...
2025-03-06 21:37:59,200 - {'epoch': 4, 'rec_loss': '6.7405'}
2025-03-06 21:38:00,066 - {'Epoch': 4, 'HR@5': '0.0450', 'NDCG@5': '0.0280', 'HR@10': '0.0688', 'NDCG@10': '0.0357', 'HR@20': '0.0945', 'NDCG@20': '0.0421'}
2025-03-06 21:38:00,067 - Validation score increased.  Saving model ...
2025-03-06 21:38:05,852 - {'epoch': 5, 'rec_loss': '6.4756'}
2025-03-06 21:38:06,789 - {'Epoch': 5, 'HR@5': '0.0486', 'NDCG@5': '0.0311', 'HR@10': '0.0688', 'NDCG@10': '0.0375', 'HR@20': '0.1046', 'NDCG@20': '0.0465'}
2025-03-06 21:38:06,790 - Validation score increased.  Saving model ...
2025-03-06 21:38:12,403 - {'epoch': 6, 'rec_loss': '6.2437'}
2025-03-06 21:38:13,261 - {'Epoch': 6, 'HR@5': '0.0477', 'NDCG@5': '0.0300', 'HR@10': '0.0716', 'NDCG@10': '0.0379', 'HR@20': '0.1101', 'NDCG@20': '0.0476'}
2025-03-06 21:38:13,262 - Validation score increased.  Saving model ...
2025-03-06 21:38:18,824 - {'epoch': 7, 'rec_loss': '6.0540'}
2025-03-06 21:38:19,642 - {'Epoch': 7, 'HR@5': '0.0440', 'NDCG@5': '0.0287', 'HR@10': '0.0789', 'NDCG@10': '0.0399', 'HR@20': '0.1083', 'NDCG@20': '0.0472'}
2025-03-06 21:38:19,643 - EarlyStopping counter: 1 out of 10
2025-03-06 21:38:25,449 - {'epoch': 8, 'rec_loss': '5.9051'}
2025-03-06 21:38:26,306 - {'Epoch': 8, 'HR@5': '0.0468', 'NDCG@5': '0.0300', 'HR@10': '0.0807', 'NDCG@10': '0.0408', 'HR@20': '0.1174', 'NDCG@20': '0.0501'}
2025-03-06 21:38:26,307 - Validation score increased.  Saving model ...
2025-03-06 21:38:31,596 - {'epoch': 9, 'rec_loss': '5.7746'}
2025-03-06 21:38:32,376 - {'Epoch': 9, 'HR@5': '0.0514', 'NDCG@5': '0.0334', 'HR@10': '0.0780', 'NDCG@10': '0.0419', 'HR@20': '0.1257', 'NDCG@20': '0.0539'}
2025-03-06 21:38:32,377 - Validation score increased.  Saving model ...
2025-03-06 21:38:37,666 - {'epoch': 10, 'rec_loss': '5.6768'}
2025-03-06 21:38:38,529 - {'Epoch': 10, 'HR@5': '0.0459', 'NDCG@5': '0.0295', 'HR@10': '0.0789', 'NDCG@10': '0.0403', 'HR@20': '0.1220', 'NDCG@20': '0.0513'}
2025-03-06 21:38:38,531 - EarlyStopping counter: 1 out of 10
2025-03-06 21:38:43,609 - {'epoch': 11, 'rec_loss': '5.5980'}
2025-03-06 21:38:44,579 - {'Epoch': 11, 'HR@5': '0.0486', 'NDCG@5': '0.0318', 'HR@10': '0.0835', 'NDCG@10': '0.0429', 'HR@20': '0.1257', 'NDCG@20': '0.0533'}
2025-03-06 21:38:44,582 - EarlyStopping counter: 2 out of 10
2025-03-06 21:38:50,519 - {'epoch': 12, 'rec_loss': '5.5420'}
2025-03-06 21:38:51,437 - {'Epoch': 12, 'HR@5': '0.0569', 'NDCG@5': '0.0361', 'HR@10': '0.0890', 'NDCG@10': '0.0464', 'HR@20': '0.1312', 'NDCG@20': '0.0570'}
2025-03-06 21:38:51,439 - Validation score increased.  Saving model ...
2025-03-06 21:38:56,953 - {'epoch': 13, 'rec_loss': '5.4758'}
2025-03-06 21:38:57,798 - {'Epoch': 13, 'HR@5': '0.0587', 'NDCG@5': '0.0358', 'HR@10': '0.0872', 'NDCG@10': '0.0451', 'HR@20': '0.1339', 'NDCG@20': '0.0570'}
2025-03-06 21:38:57,799 - EarlyStopping counter: 1 out of 10
2025-03-06 21:39:03,127 - {'epoch': 14, 'rec_loss': '5.4331'}
2025-03-06 21:39:03,957 - {'Epoch': 14, 'HR@5': '0.0541', 'NDCG@5': '0.0351', 'HR@10': '0.0908', 'NDCG@10': '0.0470', 'HR@20': '0.1349', 'NDCG@20': '0.0580'}
2025-03-06 21:39:03,958 - Validation score increased.  Saving model ...
2025-03-06 21:39:09,218 - {'epoch': 15, 'rec_loss': '5.3882'}
2025-03-06 21:39:10,154 - {'Epoch': 15, 'HR@5': '0.0661', 'NDCG@5': '0.0391', 'HR@10': '0.0917', 'NDCG@10': '0.0476', 'HR@20': '0.1394', 'NDCG@20': '0.0594'}
2025-03-06 21:39:10,155 - Validation score increased.  Saving model ...
2025-03-06 21:39:15,725 - {'epoch': 16, 'rec_loss': '5.3633'}
2025-03-06 21:39:16,694 - {'Epoch': 16, 'HR@5': '0.0505', 'NDCG@5': '0.0333', 'HR@10': '0.0917', 'NDCG@10': '0.0468', 'HR@20': '0.1431', 'NDCG@20': '0.0598'}
2025-03-06 21:39:16,695 - Validation score increased.  Saving model ...
2025-03-06 21:39:22,639 - {'epoch': 17, 'rec_loss': '5.3215'}
2025-03-06 21:39:23,570 - {'Epoch': 17, 'HR@5': '0.0523', 'NDCG@5': '0.0342', 'HR@10': '0.0945', 'NDCG@10': '0.0478', 'HR@20': '0.1459', 'NDCG@20': '0.0608'}
2025-03-06 21:39:23,572 - Validation score increased.  Saving model ...
2025-03-06 21:39:29,711 - {'epoch': 18, 'rec_loss': '5.2832'}
2025-03-06 21:39:30,584 - {'Epoch': 18, 'HR@5': '0.0486', 'NDCG@5': '0.0315', 'HR@10': '0.0991', 'NDCG@10': '0.0478', 'HR@20': '0.1413', 'NDCG@20': '0.0584'}
2025-03-06 21:39:30,586 - EarlyStopping counter: 1 out of 10
2025-03-06 21:39:36,189 - {'epoch': 19, 'rec_loss': '5.2598'}
2025-03-06 21:39:37,210 - {'Epoch': 19, 'HR@5': '0.0615', 'NDCG@5': '0.0376', 'HR@10': '0.0945', 'NDCG@10': '0.0482', 'HR@20': '0.1459', 'NDCG@20': '0.0612'}
2025-03-06 21:39:37,211 - Validation score increased.  Saving model ...
2025-03-06 21:39:42,913 - {'epoch': 20, 'rec_loss': '5.2449'}
2025-03-06 21:39:43,787 - {'Epoch': 20, 'HR@5': '0.0606', 'NDCG@5': '0.0382', 'HR@10': '0.0899', 'NDCG@10': '0.0477', 'HR@20': '0.1450', 'NDCG@20': '0.0617'}
2025-03-06 21:39:43,788 - Validation score increased.  Saving model ...
2025-03-06 21:39:49,459 - {'epoch': 21, 'rec_loss': '5.2240'}
2025-03-06 21:39:50,399 - {'Epoch': 21, 'HR@5': '0.0578', 'NDCG@5': '0.0354', 'HR@10': '0.0991', 'NDCG@10': '0.0487', 'HR@20': '0.1486', 'NDCG@20': '0.0612'}
2025-03-06 21:39:50,401 - EarlyStopping counter: 1 out of 10
2025-03-06 21:39:55,755 - {'epoch': 22, 'rec_loss': '5.1945'}
2025-03-06 21:39:56,729 - {'Epoch': 22, 'HR@5': '0.0578', 'NDCG@5': '0.0380', 'HR@10': '0.1009', 'NDCG@10': '0.0518', 'HR@20': '0.1468', 'NDCG@20': '0.0636'}
2025-03-06 21:39:56,730 - Validation score increased.  Saving model ...
2025-03-06 21:40:02,849 - {'epoch': 23, 'rec_loss': '5.1863'}
2025-03-06 21:40:03,816 - {'Epoch': 23, 'HR@5': '0.0606', 'NDCG@5': '0.0376', 'HR@10': '0.0991', 'NDCG@10': '0.0500', 'HR@20': '0.1514', 'NDCG@20': '0.0633'}
2025-03-06 21:40:03,818 - EarlyStopping counter: 1 out of 10
2025-03-06 21:40:09,665 - {'epoch': 24, 'rec_loss': '5.1599'}
2025-03-06 21:40:10,615 - {'Epoch': 24, 'HR@5': '0.0633', 'NDCG@5': '0.0395', 'HR@10': '0.0936', 'NDCG@10': '0.0494', 'HR@20': '0.1560', 'NDCG@20': '0.0652'}
2025-03-06 21:40:10,616 - Validation score increased.  Saving model ...
2025-03-06 21:40:16,701 - {'epoch': 25, 'rec_loss': '5.1458'}
2025-03-06 21:40:17,634 - {'Epoch': 25, 'HR@5': '0.0606', 'NDCG@5': '0.0372', 'HR@10': '0.1018', 'NDCG@10': '0.0505', 'HR@20': '0.1523', 'NDCG@20': '0.0632'}
2025-03-06 21:40:17,635 - EarlyStopping counter: 1 out of 10
2025-03-06 21:40:23,436 - {'epoch': 26, 'rec_loss': '5.1155'}
2025-03-06 21:40:24,302 - {'Epoch': 26, 'HR@5': '0.0624', 'NDCG@5': '0.0391', 'HR@10': '0.0954', 'NDCG@10': '0.0500', 'HR@20': '0.1450', 'NDCG@20': '0.0625'}
2025-03-06 21:40:24,304 - EarlyStopping counter: 2 out of 10
2025-03-06 21:40:30,568 - {'epoch': 27, 'rec_loss': '5.1216'}
2025-03-06 21:40:31,445 - {'Epoch': 27, 'HR@5': '0.0596', 'NDCG@5': '0.0372', 'HR@10': '0.1009', 'NDCG@10': '0.0506', 'HR@20': '0.1532', 'NDCG@20': '0.0636'}
2025-03-06 21:40:31,446 - EarlyStopping counter: 3 out of 10
2025-03-06 21:40:37,434 - {'epoch': 28, 'rec_loss': '5.0978'}
2025-03-06 21:40:38,326 - {'Epoch': 28, 'HR@5': '0.0624', 'NDCG@5': '0.0381', 'HR@10': '0.1009', 'NDCG@10': '0.0505', 'HR@20': '0.1431', 'NDCG@20': '0.0612'}
2025-03-06 21:40:38,328 - EarlyStopping counter: 4 out of 10
2025-03-06 21:40:44,524 - {'epoch': 29, 'rec_loss': '5.0889'}
2025-03-06 21:40:45,321 - {'Epoch': 29, 'HR@5': '0.0624', 'NDCG@5': '0.0395', 'HR@10': '0.0954', 'NDCG@10': '0.0502', 'HR@20': '0.1477', 'NDCG@20': '0.0635'}
2025-03-06 21:40:45,323 - EarlyStopping counter: 5 out of 10
2025-03-06 21:40:51,194 - {'epoch': 30, 'rec_loss': '5.0696'}
2025-03-06 21:40:52,059 - {'Epoch': 30, 'HR@5': '0.0578', 'NDCG@5': '0.0375', 'HR@10': '0.1018', 'NDCG@10': '0.0516', 'HR@20': '0.1505', 'NDCG@20': '0.0637'}
2025-03-06 21:40:52,060 - EarlyStopping counter: 6 out of 10
2025-03-06 21:40:57,041 - {'epoch': 31, 'rec_loss': '5.0642'}
2025-03-06 21:40:57,889 - {'Epoch': 31, 'HR@5': '0.0615', 'NDCG@5': '0.0388', 'HR@10': '0.0982', 'NDCG@10': '0.0507', 'HR@20': '0.1477', 'NDCG@20': '0.0632'}
2025-03-06 21:40:57,890 - EarlyStopping counter: 7 out of 10
2025-03-06 21:41:03,140 - {'epoch': 32, 'rec_loss': '5.0485'}
2025-03-06 21:41:03,950 - {'Epoch': 32, 'HR@5': '0.0615', 'NDCG@5': '0.0371', 'HR@10': '0.1009', 'NDCG@10': '0.0500', 'HR@20': '0.1560', 'NDCG@20': '0.0637'}
2025-03-06 21:41:03,951 - EarlyStopping counter: 8 out of 10
2025-03-06 21:41:09,298 - {'epoch': 33, 'rec_loss': '5.0388'}
2025-03-06 21:41:10,168 - {'Epoch': 33, 'HR@5': '0.0633', 'NDCG@5': '0.0387', 'HR@10': '0.0963', 'NDCG@10': '0.0494', 'HR@20': '0.1532', 'NDCG@20': '0.0637'}
2025-03-06 21:41:10,170 - EarlyStopping counter: 9 out of 10
2025-03-06 21:41:15,501 - {'epoch': 34, 'rec_loss': '5.0171'}
2025-03-06 21:41:16,403 - {'Epoch': 34, 'HR@5': '0.0624', 'NDCG@5': '0.0376', 'HR@10': '0.1009', 'NDCG@10': '0.0502', 'HR@20': '0.1550', 'NDCG@20': '0.0640'}
2025-03-06 21:41:16,405 - EarlyStopping counter: 10 out of 10
2025-03-06 21:41:16,405 - Early stopping
2025-03-06 21:41:16,405 - ---------------Test Score---------------
2025-03-06 21:41:17,249 - {'Epoch': 0, 'HR@5': '0.0541', 'NDCG@5': '0.0363', 'HR@10': '0.0697', 'NDCG@10': '0.0412', 'HR@20': '0.0991', 'NDCG@20': '0.0485'}
2025-03-06 21:41:17,250 - Scale_LastFM
2025-03-06 21:41:17,250 - {'Epoch': 0, 'HR@5': '0.0541', 'NDCG@5': '0.0363', 'HR@10': '0.0697', 'NDCG@10': '0.0412', 'HR@20': '0.0991', 'NDCG@20': '0.0485'}
2025-03-07 11:31:55,184 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-03-07 11:31:59,382 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-07 11:31:59,391 - Total Parameters: 387350
2025-03-07 11:32:05,446 - {'epoch': 0, 'rec_loss': '8.0367'}
2025-03-07 11:32:06,381 - {'Epoch': 0, 'HR@5': '0.0266', 'NDCG@5': '0.0173', 'HR@10': '0.0376', 'NDCG@10': '0.0206', 'HR@20': '0.0651', 'NDCG@20': '0.0274'}
2025-03-07 11:32:06,382 - Validation score increased.  Saving model ...
2025-03-07 11:32:10,416 - {'epoch': 1, 'rec_loss': '7.7949'}
2025-03-07 11:32:11,521 - {'Epoch': 1, 'HR@5': '0.0211', 'NDCG@5': '0.0147', 'HR@10': '0.0358', 'NDCG@10': '0.0195', 'HR@20': '0.0587', 'NDCG@20': '0.0252'}
2025-03-07 11:32:11,527 - EarlyStopping counter: 1 out of 10
2025-03-07 11:32:15,993 - {'epoch': 2, 'rec_loss': '7.6474'}
2025-03-07 11:32:17,000 - {'Epoch': 2, 'HR@5': '0.0284', 'NDCG@5': '0.0186', 'HR@10': '0.0422', 'NDCG@10': '0.0230', 'HR@20': '0.0642', 'NDCG@20': '0.0284'}
2025-03-07 11:32:17,002 - Validation score increased.  Saving model ...
2025-03-07 11:32:21,288 - {'epoch': 3, 'rec_loss': '7.4914'}
2025-03-07 11:32:22,257 - {'Epoch': 3, 'HR@5': '0.0266', 'NDCG@5': '0.0185', 'HR@10': '0.0450', 'NDCG@10': '0.0244', 'HR@20': '0.0670', 'NDCG@20': '0.0300'}
2025-03-07 11:32:22,259 - Validation score increased.  Saving model ...
2025-03-07 11:32:26,154 - {'epoch': 4, 'rec_loss': '7.3299'}
2025-03-07 11:32:27,109 - {'Epoch': 4, 'HR@5': '0.0376', 'NDCG@5': '0.0246', 'HR@10': '0.0532', 'NDCG@10': '0.0296', 'HR@20': '0.0752', 'NDCG@20': '0.0351'}
2025-03-07 11:32:27,110 - Validation score increased.  Saving model ...
2025-03-07 11:32:31,369 - {'epoch': 5, 'rec_loss': '7.1699'}
2025-03-07 11:32:32,319 - {'Epoch': 5, 'HR@5': '0.0422', 'NDCG@5': '0.0277', 'HR@10': '0.0596', 'NDCG@10': '0.0333', 'HR@20': '0.0835', 'NDCG@20': '0.0393'}
2025-03-07 11:32:32,320 - Validation score increased.  Saving model ...
2025-03-07 11:32:36,869 - {'epoch': 6, 'rec_loss': '7.0161'}
2025-03-07 11:32:37,829 - {'Epoch': 6, 'HR@5': '0.0358', 'NDCG@5': '0.0241', 'HR@10': '0.0670', 'NDCG@10': '0.0340', 'HR@20': '0.0954', 'NDCG@20': '0.0409'}
2025-03-07 11:32:37,831 - Validation score increased.  Saving model ...
2025-03-07 11:32:42,011 - {'epoch': 7, 'rec_loss': '6.8674'}
2025-03-07 11:32:43,023 - {'Epoch': 7, 'HR@5': '0.0385', 'NDCG@5': '0.0255', 'HR@10': '0.0624', 'NDCG@10': '0.0331', 'HR@20': '0.0982', 'NDCG@20': '0.0421'}
2025-03-07 11:32:43,024 - Validation score increased.  Saving model ...
2025-03-07 11:32:47,368 - {'epoch': 8, 'rec_loss': '6.7440'}
2025-03-07 11:32:48,272 - {'Epoch': 8, 'HR@5': '0.0404', 'NDCG@5': '0.0278', 'HR@10': '0.0688', 'NDCG@10': '0.0370', 'HR@20': '0.1055', 'NDCG@20': '0.0464'}
2025-03-07 11:32:48,273 - Validation score increased.  Saving model ...
2025-03-07 11:32:52,582 - {'epoch': 9, 'rec_loss': '6.6071'}
2025-03-07 11:32:53,547 - {'Epoch': 9, 'HR@5': '0.0431', 'NDCG@5': '0.0289', 'HR@10': '0.0716', 'NDCG@10': '0.0380', 'HR@20': '0.1138', 'NDCG@20': '0.0487'}
2025-03-07 11:32:53,549 - Validation score increased.  Saving model ...
2025-03-07 11:32:57,563 - {'epoch': 10, 'rec_loss': '6.4927'}
2025-03-07 11:32:58,481 - {'Epoch': 10, 'HR@5': '0.0486', 'NDCG@5': '0.0306', 'HR@10': '0.0743', 'NDCG@10': '0.0388', 'HR@20': '0.1110', 'NDCG@20': '0.0481'}
2025-03-07 11:32:58,482 - EarlyStopping counter: 1 out of 10
2025-03-07 11:33:02,391 - {'epoch': 11, 'rec_loss': '6.3918'}
2025-03-07 11:33:03,327 - {'Epoch': 11, 'HR@5': '0.0495', 'NDCG@5': '0.0315', 'HR@10': '0.0761', 'NDCG@10': '0.0398', 'HR@20': '0.1165', 'NDCG@20': '0.0499'}
2025-03-07 11:33:03,328 - Validation score increased.  Saving model ...
2025-03-07 11:33:07,451 - {'epoch': 12, 'rec_loss': '6.2832'}
2025-03-07 11:33:08,428 - {'Epoch': 12, 'HR@5': '0.0495', 'NDCG@5': '0.0317', 'HR@10': '0.0817', 'NDCG@10': '0.0418', 'HR@20': '0.1138', 'NDCG@20': '0.0500'}
2025-03-07 11:33:08,430 - Validation score increased.  Saving model ...
2025-03-07 11:33:12,565 - {'epoch': 13, 'rec_loss': '6.1885'}
2025-03-07 11:33:13,502 - {'Epoch': 13, 'HR@5': '0.0468', 'NDCG@5': '0.0307', 'HR@10': '0.0761', 'NDCG@10': '0.0401', 'HR@20': '0.1156', 'NDCG@20': '0.0501'}
2025-03-07 11:33:13,503 - Validation score increased.  Saving model ...
2025-03-07 11:33:17,778 - {'epoch': 14, 'rec_loss': '6.1100'}
2025-03-07 11:33:18,717 - {'Epoch': 14, 'HR@5': '0.0523', 'NDCG@5': '0.0338', 'HR@10': '0.0752', 'NDCG@10': '0.0412', 'HR@20': '0.1183', 'NDCG@20': '0.0522'}
2025-03-07 11:33:18,718 - Validation score increased.  Saving model ...
2025-03-07 11:33:22,702 - {'epoch': 15, 'rec_loss': '6.0268'}
2025-03-07 11:33:23,655 - {'Epoch': 15, 'HR@5': '0.0560', 'NDCG@5': '0.0359', 'HR@10': '0.0835', 'NDCG@10': '0.0446', 'HR@20': '0.1193', 'NDCG@20': '0.0535'}
2025-03-07 11:33:23,657 - Validation score increased.  Saving model ...
2025-03-07 11:33:27,922 - {'epoch': 16, 'rec_loss': '5.9638'}
2025-03-07 11:33:28,849 - {'Epoch': 16, 'HR@5': '0.0523', 'NDCG@5': '0.0340', 'HR@10': '0.0789', 'NDCG@10': '0.0424', 'HR@20': '0.1275', 'NDCG@20': '0.0545'}
2025-03-07 11:33:28,851 - Validation score increased.  Saving model ...
2025-03-07 11:33:33,165 - {'epoch': 17, 'rec_loss': '5.9069'}
2025-03-07 11:33:34,093 - {'Epoch': 17, 'HR@5': '0.0587', 'NDCG@5': '0.0361', 'HR@10': '0.0798', 'NDCG@10': '0.0429', 'HR@20': '0.1266', 'NDCG@20': '0.0547'}
2025-03-07 11:33:34,095 - Validation score increased.  Saving model ...
2025-03-07 11:33:37,721 - {'epoch': 18, 'rec_loss': '5.8444'}
2025-03-07 11:33:38,572 - {'Epoch': 18, 'HR@5': '0.0523', 'NDCG@5': '0.0324', 'HR@10': '0.0771', 'NDCG@10': '0.0402', 'HR@20': '0.1239', 'NDCG@20': '0.0520'}
2025-03-07 11:33:38,573 - EarlyStopping counter: 1 out of 10
2025-03-07 11:33:42,396 - {'epoch': 19, 'rec_loss': '5.8098'}
2025-03-07 11:33:43,382 - {'Epoch': 19, 'HR@5': '0.0550', 'NDCG@5': '0.0328', 'HR@10': '0.0853', 'NDCG@10': '0.0425', 'HR@20': '0.1248', 'NDCG@20': '0.0523'}
2025-03-07 11:33:43,384 - EarlyStopping counter: 2 out of 10
2025-03-07 11:33:46,981 - {'epoch': 20, 'rec_loss': '5.7680'}
2025-03-07 11:33:47,855 - {'Epoch': 20, 'HR@5': '0.0514', 'NDCG@5': '0.0322', 'HR@10': '0.0862', 'NDCG@10': '0.0431', 'HR@20': '0.1275', 'NDCG@20': '0.0535'}
2025-03-07 11:33:47,857 - EarlyStopping counter: 3 out of 10
2025-03-07 11:33:51,618 - {'epoch': 21, 'rec_loss': '5.7163'}
2025-03-07 11:33:52,551 - {'Epoch': 21, 'HR@5': '0.0514', 'NDCG@5': '0.0326', 'HR@10': '0.0862', 'NDCG@10': '0.0439', 'HR@20': '0.1330', 'NDCG@20': '0.0556'}
2025-03-07 11:33:52,554 - Validation score increased.  Saving model ...
2025-03-07 11:33:56,679 - {'epoch': 22, 'rec_loss': '5.6908'}
2025-03-07 11:33:57,740 - {'Epoch': 22, 'HR@5': '0.0523', 'NDCG@5': '0.0336', 'HR@10': '0.0881', 'NDCG@10': '0.0450', 'HR@20': '0.1321', 'NDCG@20': '0.0561'}
2025-03-07 11:33:57,742 - Validation score increased.  Saving model ...
2025-03-07 11:34:02,788 - {'epoch': 23, 'rec_loss': '5.6502'}
2025-03-07 11:34:03,790 - {'Epoch': 23, 'HR@5': '0.0514', 'NDCG@5': '0.0338', 'HR@10': '0.0844', 'NDCG@10': '0.0444', 'HR@20': '0.1330', 'NDCG@20': '0.0567'}
2025-03-07 11:34:03,791 - Validation score increased.  Saving model ...
2025-03-07 11:34:08,570 - {'epoch': 24, 'rec_loss': '5.6291'}
2025-03-07 11:34:09,624 - {'Epoch': 24, 'HR@5': '0.0477', 'NDCG@5': '0.0315', 'HR@10': '0.0826', 'NDCG@10': '0.0425', 'HR@20': '0.1358', 'NDCG@20': '0.0560'}
2025-03-07 11:34:09,625 - EarlyStopping counter: 1 out of 10
2025-03-07 11:34:14,793 - {'epoch': 25, 'rec_loss': '5.6055'}
2025-03-07 11:34:15,753 - {'Epoch': 25, 'HR@5': '0.0459', 'NDCG@5': '0.0322', 'HR@10': '0.0826', 'NDCG@10': '0.0442', 'HR@20': '0.1367', 'NDCG@20': '0.0580'}
2025-03-07 11:34:15,754 - Validation score increased.  Saving model ...
2025-03-07 11:34:20,747 - {'epoch': 26, 'rec_loss': '5.5727'}
2025-03-07 11:34:21,761 - {'Epoch': 26, 'HR@5': '0.0477', 'NDCG@5': '0.0325', 'HR@10': '0.0881', 'NDCG@10': '0.0455', 'HR@20': '0.1312', 'NDCG@20': '0.0563'}
2025-03-07 11:34:21,762 - EarlyStopping counter: 1 out of 10
2025-03-07 11:34:26,485 - {'epoch': 27, 'rec_loss': '5.5495'}
2025-03-07 11:34:27,451 - {'Epoch': 27, 'HR@5': '0.0486', 'NDCG@5': '0.0315', 'HR@10': '0.0862', 'NDCG@10': '0.0436', 'HR@20': '0.1312', 'NDCG@20': '0.0549'}
2025-03-07 11:34:27,452 - EarlyStopping counter: 2 out of 10
2025-03-07 11:34:31,900 - {'epoch': 28, 'rec_loss': '5.5309'}
2025-03-07 11:34:32,879 - {'Epoch': 28, 'HR@5': '0.0477', 'NDCG@5': '0.0329', 'HR@10': '0.0881', 'NDCG@10': '0.0458', 'HR@20': '0.1349', 'NDCG@20': '0.0576'}
2025-03-07 11:34:32,881 - EarlyStopping counter: 3 out of 10
2025-03-07 11:34:37,745 - {'epoch': 29, 'rec_loss': '5.5036'}
2025-03-07 11:34:38,863 - {'Epoch': 29, 'HR@5': '0.0550', 'NDCG@5': '0.0356', 'HR@10': '0.0954', 'NDCG@10': '0.0485', 'HR@20': '0.1312', 'NDCG@20': '0.0574'}
2025-03-07 11:34:38,864 - EarlyStopping counter: 4 out of 10
2025-03-07 11:34:43,910 - {'epoch': 30, 'rec_loss': '5.4763'}
2025-03-07 11:34:44,960 - {'Epoch': 30, 'HR@5': '0.0459', 'NDCG@5': '0.0324', 'HR@10': '0.0835', 'NDCG@10': '0.0445', 'HR@20': '0.1349', 'NDCG@20': '0.0576'}
2025-03-07 11:34:44,961 - EarlyStopping counter: 5 out of 10
2025-03-07 11:34:49,802 - {'epoch': 31, 'rec_loss': '5.4863'}
2025-03-07 11:34:50,908 - {'Epoch': 31, 'HR@5': '0.0550', 'NDCG@5': '0.0351', 'HR@10': '0.0872', 'NDCG@10': '0.0453', 'HR@20': '0.1422', 'NDCG@20': '0.0592'}
2025-03-07 11:34:50,909 - Validation score increased.  Saving model ...
2025-03-07 11:34:55,785 - {'epoch': 32, 'rec_loss': '5.4591'}
2025-03-07 11:34:56,826 - {'Epoch': 32, 'HR@5': '0.0477', 'NDCG@5': '0.0324', 'HR@10': '0.0881', 'NDCG@10': '0.0456', 'HR@20': '0.1404', 'NDCG@20': '0.0589'}
2025-03-07 11:34:56,828 - EarlyStopping counter: 1 out of 10
2025-03-07 11:35:01,643 - {'epoch': 33, 'rec_loss': '5.4596'}
2025-03-07 11:35:02,702 - {'Epoch': 33, 'HR@5': '0.0505', 'NDCG@5': '0.0335', 'HR@10': '0.0908', 'NDCG@10': '0.0464', 'HR@20': '0.1459', 'NDCG@20': '0.0600'}
2025-03-07 11:35:02,704 - Validation score increased.  Saving model ...
2025-03-07 11:35:08,086 - {'epoch': 34, 'rec_loss': '5.4232'}
2025-03-07 11:35:09,256 - {'Epoch': 34, 'HR@5': '0.0550', 'NDCG@5': '0.0346', 'HR@10': '0.0862', 'NDCG@10': '0.0445', 'HR@20': '0.1413', 'NDCG@20': '0.0586'}
2025-03-07 11:35:09,265 - EarlyStopping counter: 1 out of 10
2025-03-07 11:35:14,641 - {'epoch': 35, 'rec_loss': '5.4501'}
2025-03-07 11:35:15,696 - {'Epoch': 35, 'HR@5': '0.0505', 'NDCG@5': '0.0348', 'HR@10': '0.0936', 'NDCG@10': '0.0487', 'HR@20': '0.1385', 'NDCG@20': '0.0601'}
2025-03-07 11:35:15,698 - Validation score increased.  Saving model ...
2025-03-07 11:35:21,192 - {'epoch': 36, 'rec_loss': '5.4143'}
2025-03-07 11:35:22,364 - {'Epoch': 36, 'HR@5': '0.0550', 'NDCG@5': '0.0349', 'HR@10': '0.0917', 'NDCG@10': '0.0465', 'HR@20': '0.1358', 'NDCG@20': '0.0577'}
2025-03-07 11:35:22,366 - EarlyStopping counter: 1 out of 10
2025-03-07 11:35:28,339 - {'epoch': 37, 'rec_loss': '5.4040'}
2025-03-07 11:35:29,335 - {'Epoch': 37, 'HR@5': '0.0532', 'NDCG@5': '0.0333', 'HR@10': '0.0881', 'NDCG@10': '0.0445', 'HR@20': '0.1376', 'NDCG@20': '0.0569'}
2025-03-07 11:35:29,337 - EarlyStopping counter: 2 out of 10
2025-03-07 11:35:34,608 - {'epoch': 38, 'rec_loss': '5.4149'}
2025-03-07 11:35:35,610 - {'Epoch': 38, 'HR@5': '0.0523', 'NDCG@5': '0.0330', 'HR@10': '0.0844', 'NDCG@10': '0.0432', 'HR@20': '0.1404', 'NDCG@20': '0.0573'}
2025-03-07 11:35:35,611 - EarlyStopping counter: 3 out of 10
2025-03-07 11:35:40,014 - {'epoch': 39, 'rec_loss': '5.3853'}
2025-03-07 11:35:41,028 - {'Epoch': 39, 'HR@5': '0.0532', 'NDCG@5': '0.0346', 'HR@10': '0.0835', 'NDCG@10': '0.0443', 'HR@20': '0.1394', 'NDCG@20': '0.0585'}
2025-03-07 11:35:41,029 - EarlyStopping counter: 4 out of 10
2025-03-07 11:35:45,078 - {'epoch': 40, 'rec_loss': '5.4059'}
2025-03-07 11:35:46,071 - {'Epoch': 40, 'HR@5': '0.0578', 'NDCG@5': '0.0365', 'HR@10': '0.0890', 'NDCG@10': '0.0464', 'HR@20': '0.1376', 'NDCG@20': '0.0586'}
2025-03-07 11:35:46,072 - EarlyStopping counter: 5 out of 10
2025-03-07 11:35:49,908 - {'epoch': 41, 'rec_loss': '5.3772'}
2025-03-07 11:35:50,900 - {'Epoch': 41, 'HR@5': '0.0550', 'NDCG@5': '0.0347', 'HR@10': '0.0899', 'NDCG@10': '0.0458', 'HR@20': '0.1349', 'NDCG@20': '0.0573'}
2025-03-07 11:35:50,901 - EarlyStopping counter: 6 out of 10
2025-03-07 11:35:55,189 - {'epoch': 42, 'rec_loss': '5.3953'}
2025-03-07 11:35:56,160 - {'Epoch': 42, 'HR@5': '0.0550', 'NDCG@5': '0.0370', 'HR@10': '0.0936', 'NDCG@10': '0.0491', 'HR@20': '0.1404', 'NDCG@20': '0.0609'}
2025-03-07 11:35:56,161 - Validation score increased.  Saving model ...
2025-03-07 11:36:00,313 - {'epoch': 43, 'rec_loss': '5.3739'}
2025-03-07 11:36:01,313 - {'Epoch': 43, 'HR@5': '0.0550', 'NDCG@5': '0.0346', 'HR@10': '0.0936', 'NDCG@10': '0.0469', 'HR@20': '0.1440', 'NDCG@20': '0.0596'}
2025-03-07 11:36:01,315 - EarlyStopping counter: 1 out of 10
2025-03-07 11:36:05,265 - {'epoch': 44, 'rec_loss': '5.3523'}
2025-03-07 11:36:06,234 - {'Epoch': 44, 'HR@5': '0.0550', 'NDCG@5': '0.0359', 'HR@10': '0.0872', 'NDCG@10': '0.0461', 'HR@20': '0.1459', 'NDCG@20': '0.0607'}
2025-03-07 11:36:06,237 - EarlyStopping counter: 2 out of 10
2025-03-07 11:36:10,440 - {'epoch': 45, 'rec_loss': '5.3815'}
2025-03-07 11:36:11,341 - {'Epoch': 45, 'HR@5': '0.0532', 'NDCG@5': '0.0345', 'HR@10': '0.0954', 'NDCG@10': '0.0478', 'HR@20': '0.1422', 'NDCG@20': '0.0595'}
2025-03-07 11:36:11,343 - EarlyStopping counter: 3 out of 10
2025-03-07 11:36:15,383 - {'epoch': 46, 'rec_loss': '5.3471'}
2025-03-07 11:36:16,339 - {'Epoch': 46, 'HR@5': '0.0505', 'NDCG@5': '0.0333', 'HR@10': '0.0945', 'NDCG@10': '0.0473', 'HR@20': '0.1404', 'NDCG@20': '0.0590'}
2025-03-07 11:36:16,340 - EarlyStopping counter: 4 out of 10
2025-03-07 11:36:20,747 - {'epoch': 47, 'rec_loss': '5.3443'}
2025-03-07 11:36:21,831 - {'Epoch': 47, 'HR@5': '0.0569', 'NDCG@5': '0.0364', 'HR@10': '0.0927', 'NDCG@10': '0.0476', 'HR@20': '0.1422', 'NDCG@20': '0.0601'}
2025-03-07 11:36:21,832 - EarlyStopping counter: 5 out of 10
2025-03-07 11:36:25,626 - {'epoch': 48, 'rec_loss': '5.3491'}
2025-03-07 11:36:26,542 - {'Epoch': 48, 'HR@5': '0.0514', 'NDCG@5': '0.0334', 'HR@10': '0.0972', 'NDCG@10': '0.0480', 'HR@20': '0.1450', 'NDCG@20': '0.0600'}
2025-03-07 11:36:26,543 - EarlyStopping counter: 6 out of 10
2025-03-07 11:36:30,480 - {'epoch': 49, 'rec_loss': '5.3347'}
2025-03-07 11:36:31,438 - {'Epoch': 49, 'HR@5': '0.0523', 'NDCG@5': '0.0339', 'HR@10': '0.0945', 'NDCG@10': '0.0473', 'HR@20': '0.1450', 'NDCG@20': '0.0600'}
2025-03-07 11:36:31,439 - EarlyStopping counter: 7 out of 10
2025-03-07 11:36:35,203 - {'epoch': 50, 'rec_loss': '5.3284'}
2025-03-07 11:36:36,256 - {'Epoch': 50, 'HR@5': '0.0505', 'NDCG@5': '0.0329', 'HR@10': '0.0899', 'NDCG@10': '0.0455', 'HR@20': '0.1413', 'NDCG@20': '0.0583'}
2025-03-07 11:36:36,257 - EarlyStopping counter: 8 out of 10
2025-03-07 11:36:40,159 - {'epoch': 51, 'rec_loss': '5.3308'}
2025-03-07 11:36:41,078 - {'Epoch': 51, 'HR@5': '0.0569', 'NDCG@5': '0.0363', 'HR@10': '0.0936', 'NDCG@10': '0.0482', 'HR@20': '0.1394', 'NDCG@20': '0.0596'}
2025-03-07 11:36:41,078 - EarlyStopping counter: 9 out of 10
2025-03-07 11:36:44,802 - {'epoch': 52, 'rec_loss': '5.3118'}
2025-03-07 11:36:45,690 - {'Epoch': 52, 'HR@5': '0.0514', 'NDCG@5': '0.0351', 'HR@10': '0.0927', 'NDCG@10': '0.0482', 'HR@20': '0.1450', 'NDCG@20': '0.0613'}
2025-03-07 11:36:45,691 - Validation score increased.  Saving model ...
2025-03-07 11:36:49,342 - {'epoch': 53, 'rec_loss': '5.3264'}
2025-03-07 11:36:50,292 - {'Epoch': 53, 'HR@5': '0.0578', 'NDCG@5': '0.0376', 'HR@10': '0.0917', 'NDCG@10': '0.0484', 'HR@20': '0.1459', 'NDCG@20': '0.0622'}
2025-03-07 11:36:50,293 - Validation score increased.  Saving model ...
2025-03-07 11:36:54,126 - {'epoch': 54, 'rec_loss': '5.3168'}
2025-03-07 11:36:54,960 - {'Epoch': 54, 'HR@5': '0.0569', 'NDCG@5': '0.0348', 'HR@10': '0.0927', 'NDCG@10': '0.0463', 'HR@20': '0.1440', 'NDCG@20': '0.0595'}
2025-03-07 11:36:54,961 - EarlyStopping counter: 1 out of 10
2025-03-07 11:36:58,875 - {'epoch': 55, 'rec_loss': '5.2955'}
2025-03-07 11:36:59,821 - {'Epoch': 55, 'HR@5': '0.0578', 'NDCG@5': '0.0385', 'HR@10': '0.0972', 'NDCG@10': '0.0512', 'HR@20': '0.1459', 'NDCG@20': '0.0635'}
2025-03-07 11:36:59,822 - Validation score increased.  Saving model ...
2025-03-07 11:37:03,603 - {'epoch': 56, 'rec_loss': '5.2988'}
2025-03-07 11:37:04,495 - {'Epoch': 56, 'HR@5': '0.0569', 'NDCG@5': '0.0364', 'HR@10': '0.0963', 'NDCG@10': '0.0492', 'HR@20': '0.1431', 'NDCG@20': '0.0611'}
2025-03-07 11:37:04,497 - EarlyStopping counter: 1 out of 10
2025-03-07 11:37:08,404 - {'epoch': 57, 'rec_loss': '5.2939'}
2025-03-07 11:37:09,345 - {'Epoch': 57, 'HR@5': '0.0550', 'NDCG@5': '0.0354', 'HR@10': '0.0972', 'NDCG@10': '0.0491', 'HR@20': '0.1450', 'NDCG@20': '0.0611'}
2025-03-07 11:37:09,346 - EarlyStopping counter: 2 out of 10
2025-03-07 11:37:13,626 - {'epoch': 58, 'rec_loss': '5.2858'}
2025-03-07 11:37:14,580 - {'Epoch': 58, 'HR@5': '0.0560', 'NDCG@5': '0.0359', 'HR@10': '0.0936', 'NDCG@10': '0.0481', 'HR@20': '0.1495', 'NDCG@20': '0.0621'}
2025-03-07 11:37:14,582 - EarlyStopping counter: 3 out of 10
2025-03-07 11:37:18,554 - {'epoch': 59, 'rec_loss': '5.2709'}
2025-03-07 11:37:19,579 - {'Epoch': 59, 'HR@5': '0.0596', 'NDCG@5': '0.0372', 'HR@10': '0.1000', 'NDCG@10': '0.0501', 'HR@20': '0.1468', 'NDCG@20': '0.0618'}
2025-03-07 11:37:19,580 - EarlyStopping counter: 4 out of 10
2025-03-07 11:37:23,595 - {'epoch': 60, 'rec_loss': '5.2811'}
2025-03-07 11:37:24,572 - {'Epoch': 60, 'HR@5': '0.0615', 'NDCG@5': '0.0382', 'HR@10': '0.1018', 'NDCG@10': '0.0510', 'HR@20': '0.1477', 'NDCG@20': '0.0625'}
2025-03-07 11:37:24,573 - EarlyStopping counter: 5 out of 10
2025-03-07 11:37:28,637 - {'epoch': 61, 'rec_loss': '5.2817'}
2025-03-07 11:37:29,537 - {'Epoch': 61, 'HR@5': '0.0596', 'NDCG@5': '0.0364', 'HR@10': '0.0972', 'NDCG@10': '0.0485', 'HR@20': '0.1468', 'NDCG@20': '0.0612'}
2025-03-07 11:37:29,538 - EarlyStopping counter: 6 out of 10
2025-03-07 11:37:33,507 - {'epoch': 62, 'rec_loss': '5.2849'}
2025-03-07 11:37:34,507 - {'Epoch': 62, 'HR@5': '0.0606', 'NDCG@5': '0.0383', 'HR@10': '0.0936', 'NDCG@10': '0.0486', 'HR@20': '0.1505', 'NDCG@20': '0.0632'}
2025-03-07 11:37:34,508 - EarlyStopping counter: 7 out of 10
2025-03-07 11:37:39,577 - {'epoch': 63, 'rec_loss': '5.2712'}
2025-03-07 11:37:40,584 - {'Epoch': 63, 'HR@5': '0.0569', 'NDCG@5': '0.0366', 'HR@10': '0.1028', 'NDCG@10': '0.0513', 'HR@20': '0.1550', 'NDCG@20': '0.0645'}
2025-03-07 11:37:40,586 - Validation score increased.  Saving model ...
2025-03-07 11:37:45,384 - {'epoch': 64, 'rec_loss': '5.2592'}
2025-03-07 11:37:46,439 - {'Epoch': 64, 'HR@5': '0.0642', 'NDCG@5': '0.0414', 'HR@10': '0.0982', 'NDCG@10': '0.0523', 'HR@20': '0.1486', 'NDCG@20': '0.0651'}
2025-03-07 11:37:46,440 - Validation score increased.  Saving model ...
2025-03-07 11:37:51,502 - {'epoch': 65, 'rec_loss': '5.2529'}
2025-03-07 11:37:52,587 - {'Epoch': 65, 'HR@5': '0.0615', 'NDCG@5': '0.0387', 'HR@10': '0.0927', 'NDCG@10': '0.0488', 'HR@20': '0.1468', 'NDCG@20': '0.0625'}
2025-03-07 11:37:52,588 - EarlyStopping counter: 1 out of 10
2025-03-07 11:37:57,068 - {'epoch': 66, 'rec_loss': '5.2499'}
2025-03-07 11:37:58,128 - {'Epoch': 66, 'HR@5': '0.0587', 'NDCG@5': '0.0374', 'HR@10': '0.0963', 'NDCG@10': '0.0496', 'HR@20': '0.1495', 'NDCG@20': '0.0631'}
2025-03-07 11:37:58,129 - EarlyStopping counter: 2 out of 10
2025-03-07 11:38:03,021 - {'epoch': 67, 'rec_loss': '5.2670'}
2025-03-07 11:38:04,113 - {'Epoch': 67, 'HR@5': '0.0560', 'NDCG@5': '0.0360', 'HR@10': '0.1028', 'NDCG@10': '0.0511', 'HR@20': '0.1477', 'NDCG@20': '0.0624'}
2025-03-07 11:38:04,114 - EarlyStopping counter: 3 out of 10
2025-03-07 11:38:09,299 - {'epoch': 68, 'rec_loss': '5.2553'}
2025-03-07 11:38:10,407 - {'Epoch': 68, 'HR@5': '0.0587', 'NDCG@5': '0.0362', 'HR@10': '0.0954', 'NDCG@10': '0.0483', 'HR@20': '0.1468', 'NDCG@20': '0.0613'}
2025-03-07 11:38:10,408 - EarlyStopping counter: 4 out of 10
2025-03-07 11:38:15,912 - {'epoch': 69, 'rec_loss': '5.2425'}
2025-03-07 11:38:17,057 - {'Epoch': 69, 'HR@5': '0.0615', 'NDCG@5': '0.0396', 'HR@10': '0.1000', 'NDCG@10': '0.0519', 'HR@20': '0.1450', 'NDCG@20': '0.0632'}
2025-03-07 11:38:17,058 - EarlyStopping counter: 5 out of 10
2025-03-07 11:38:22,583 - {'epoch': 70, 'rec_loss': '5.2364'}
2025-03-07 11:38:23,618 - {'Epoch': 70, 'HR@5': '0.0606', 'NDCG@5': '0.0387', 'HR@10': '0.0991', 'NDCG@10': '0.0513', 'HR@20': '0.1477', 'NDCG@20': '0.0636'}
2025-03-07 11:38:23,619 - EarlyStopping counter: 6 out of 10
2025-03-07 11:38:29,417 - {'epoch': 71, 'rec_loss': '5.2277'}
2025-03-07 11:38:30,468 - {'Epoch': 71, 'HR@5': '0.0606', 'NDCG@5': '0.0371', 'HR@10': '0.1018', 'NDCG@10': '0.0502', 'HR@20': '0.1505', 'NDCG@20': '0.0624'}
2025-03-07 11:38:30,469 - EarlyStopping counter: 7 out of 10
2025-03-07 11:38:36,316 - {'epoch': 72, 'rec_loss': '5.2280'}
2025-03-07 11:38:37,388 - {'Epoch': 72, 'HR@5': '0.0596', 'NDCG@5': '0.0379', 'HR@10': '0.1000', 'NDCG@10': '0.0509', 'HR@20': '0.1459', 'NDCG@20': '0.0625'}
2025-03-07 11:38:37,389 - EarlyStopping counter: 8 out of 10
2025-03-07 11:38:42,751 - {'epoch': 73, 'rec_loss': '5.2553'}
2025-03-07 11:38:43,886 - {'Epoch': 73, 'HR@5': '0.0596', 'NDCG@5': '0.0380', 'HR@10': '0.1018', 'NDCG@10': '0.0514', 'HR@20': '0.1459', 'NDCG@20': '0.0625'}
2025-03-07 11:38:43,888 - EarlyStopping counter: 9 out of 10
2025-03-07 11:38:48,745 - {'epoch': 74, 'rec_loss': '5.2451'}
2025-03-07 11:38:49,737 - {'Epoch': 74, 'HR@5': '0.0633', 'NDCG@5': '0.0393', 'HR@10': '0.1046', 'NDCG@10': '0.0526', 'HR@20': '0.1468', 'NDCG@20': '0.0632'}
2025-03-07 11:38:49,739 - EarlyStopping counter: 10 out of 10
2025-03-07 11:38:49,739 - Early stopping
2025-03-07 11:38:49,739 - ---------------Test Score---------------
2025-03-07 11:38:50,738 - {'Epoch': 0, 'HR@5': '0.0486', 'NDCG@5': '0.0327', 'HR@10': '0.0688', 'NDCG@10': '0.0392', 'HR@20': '0.1018', 'NDCG@20': '0.0476'}
2025-03-07 11:38:50,739 - Scale_LastFM
2025-03-07 11:38:50,740 - {'Epoch': 0, 'HR@5': '0.0486', 'NDCG@5': '0.0327', 'HR@10': '0.0688', 'NDCG@10': '0.0392', 'HR@20': '0.1018', 'NDCG@20': '0.0476'}
2025-03-07 11:40:11,297 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Scale_LastFM', num_items=10, num_users=1091, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Scale_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2025-03-07 11:40:15,482 - ScaleRecModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-07 11:40:15,495 - Total Parameters: 387350
2025-03-07 11:40:21,893 - {'epoch': 0, 'rec_loss': '8.0558'}
2025-03-07 11:40:22,869 - {'Epoch': 0, 'HR@5': '0.0220', 'NDCG@5': '0.0144', 'HR@10': '0.0367', 'NDCG@10': '0.0191', 'HR@20': '0.0615', 'NDCG@20': '0.0254'}
2025-03-07 11:40:22,871 - Validation score increased.  Saving model ...
2025-03-07 11:40:27,900 - {'epoch': 1, 'rec_loss': '7.8042'}
2025-03-07 11:40:29,051 - {'Epoch': 1, 'HR@5': '0.0220', 'NDCG@5': '0.0145', 'HR@10': '0.0339', 'NDCG@10': '0.0183', 'HR@20': '0.0615', 'NDCG@20': '0.0252'}
2025-03-07 11:40:29,052 - EarlyStopping counter: 1 out of 10
2025-03-07 11:40:34,674 - {'epoch': 2, 'rec_loss': '7.6583'}
2025-03-07 11:40:35,755 - {'Epoch': 2, 'HR@5': '0.0303', 'NDCG@5': '0.0195', 'HR@10': '0.0394', 'NDCG@10': '0.0224', 'HR@20': '0.0651', 'NDCG@20': '0.0287'}
2025-03-07 11:40:35,756 - Validation score increased.  Saving model ...
2025-03-07 11:40:41,811 - {'epoch': 3, 'rec_loss': '7.5225'}
2025-03-07 11:40:42,944 - {'Epoch': 3, 'HR@5': '0.0202', 'NDCG@5': '0.0140', 'HR@10': '0.0404', 'NDCG@10': '0.0205', 'HR@20': '0.0606', 'NDCG@20': '0.0256'}
2025-03-07 11:40:42,946 - EarlyStopping counter: 1 out of 10
2025-03-07 11:40:48,782 - {'epoch': 4, 'rec_loss': '7.3868'}
2025-03-07 11:40:49,835 - {'Epoch': 4, 'HR@5': '0.0275', 'NDCG@5': '0.0179', 'HR@10': '0.0413', 'NDCG@10': '0.0222', 'HR@20': '0.0670', 'NDCG@20': '0.0287'}
2025-03-07 11:40:49,837 - EarlyStopping counter: 2 out of 10
2025-03-07 11:40:56,084 - {'epoch': 5, 'rec_loss': '7.2768'}
2025-03-07 11:40:57,445 - {'Epoch': 5, 'HR@5': '0.0294', 'NDCG@5': '0.0199', 'HR@10': '0.0431', 'NDCG@10': '0.0245', 'HR@20': '0.0697', 'NDCG@20': '0.0311'}
2025-03-07 11:40:57,451 - Validation score increased.  Saving model ...
2025-03-07 11:41:03,365 - {'epoch': 6, 'rec_loss': '7.1441'}
2025-03-07 11:41:04,555 - {'Epoch': 6, 'HR@5': '0.0330', 'NDCG@5': '0.0213', 'HR@10': '0.0440', 'NDCG@10': '0.0250', 'HR@20': '0.0725', 'NDCG@20': '0.0322'}
2025-03-07 11:41:04,559 - Validation score increased.  Saving model ...
2025-03-07 11:41:10,048 - {'epoch': 7, 'rec_loss': '7.0080'}
2025-03-07 11:41:11,150 - {'Epoch': 7, 'HR@5': '0.0339', 'NDCG@5': '0.0233', 'HR@10': '0.0505', 'NDCG@10': '0.0287', 'HR@20': '0.0826', 'NDCG@20': '0.0368'}
2025-03-07 11:41:11,151 - Validation score increased.  Saving model ...
2025-03-07 11:41:16,272 - {'epoch': 8, 'rec_loss': '6.8918'}
2025-03-07 11:41:17,279 - {'Epoch': 8, 'HR@5': '0.0349', 'NDCG@5': '0.0239', 'HR@10': '0.0550', 'NDCG@10': '0.0306', 'HR@20': '0.0853', 'NDCG@20': '0.0383'}
2025-03-07 11:41:17,281 - Validation score increased.  Saving model ...
2025-03-07 11:41:22,411 - {'epoch': 9, 'rec_loss': '6.7584'}
2025-03-07 11:41:23,471 - {'Epoch': 9, 'HR@5': '0.0385', 'NDCG@5': '0.0254', 'HR@10': '0.0606', 'NDCG@10': '0.0325', 'HR@20': '0.0963', 'NDCG@20': '0.0414'}
2025-03-07 11:41:23,472 - Validation score increased.  Saving model ...
2025-03-07 11:41:28,495 - {'epoch': 10, 'rec_loss': '6.6499'}
2025-03-07 11:41:29,587 - {'Epoch': 10, 'HR@5': '0.0404', 'NDCG@5': '0.0265', 'HR@10': '0.0642', 'NDCG@10': '0.0344', 'HR@20': '0.0963', 'NDCG@20': '0.0424'}
2025-03-07 11:41:29,589 - Validation score increased.  Saving model ...
2025-03-07 11:41:34,869 - {'epoch': 11, 'rec_loss': '6.5489'}
2025-03-07 11:41:35,902 - {'Epoch': 11, 'HR@5': '0.0376', 'NDCG@5': '0.0243', 'HR@10': '0.0670', 'NDCG@10': '0.0338', 'HR@20': '0.1000', 'NDCG@20': '0.0421'}
2025-03-07 11:41:35,904 - EarlyStopping counter: 1 out of 10
2025-03-07 11:41:41,126 - {'epoch': 12, 'rec_loss': '6.4399'}
2025-03-07 11:41:42,168 - {'Epoch': 12, 'HR@5': '0.0404', 'NDCG@5': '0.0258', 'HR@10': '0.0706', 'NDCG@10': '0.0355', 'HR@20': '0.1046', 'NDCG@20': '0.0441'}
2025-03-07 11:41:42,170 - Validation score increased.  Saving model ...
2025-03-07 11:41:47,248 - {'epoch': 13, 'rec_loss': '6.3328'}
2025-03-07 11:41:48,206 - {'Epoch': 13, 'HR@5': '0.0450', 'NDCG@5': '0.0280', 'HR@10': '0.0716', 'NDCG@10': '0.0364', 'HR@20': '0.1128', 'NDCG@20': '0.0469'}
2025-03-07 11:41:48,207 - Validation score increased.  Saving model ...
2025-03-07 11:41:54,024 - {'epoch': 14, 'rec_loss': '6.2561'}
2025-03-07 11:41:55,222 - {'Epoch': 14, 'HR@5': '0.0440', 'NDCG@5': '0.0271', 'HR@10': '0.0761', 'NDCG@10': '0.0372', 'HR@20': '0.1110', 'NDCG@20': '0.0460'}
2025-03-07 11:41:55,224 - EarlyStopping counter: 1 out of 10
2025-03-07 11:42:00,800 - {'epoch': 15, 'rec_loss': '6.1829'}
2025-03-07 11:42:01,802 - {'Epoch': 15, 'HR@5': '0.0468', 'NDCG@5': '0.0297', 'HR@10': '0.0761', 'NDCG@10': '0.0390', 'HR@20': '0.1119', 'NDCG@20': '0.0480'}
2025-03-07 11:42:01,803 - Validation score increased.  Saving model ...
2025-03-07 11:42:07,323 - {'epoch': 16, 'rec_loss': '6.1121'}
2025-03-07 11:42:08,379 - {'Epoch': 16, 'HR@5': '0.0440', 'NDCG@5': '0.0278', 'HR@10': '0.0761', 'NDCG@10': '0.0384', 'HR@20': '0.1110', 'NDCG@20': '0.0471'}
2025-03-07 11:42:08,383 - EarlyStopping counter: 1 out of 10
2025-03-07 11:42:13,956 - {'epoch': 17, 'rec_loss': '6.0463'}
2025-03-07 11:42:14,997 - {'Epoch': 17, 'HR@5': '0.0532', 'NDCG@5': '0.0329', 'HR@10': '0.0789', 'NDCG@10': '0.0411', 'HR@20': '0.1174', 'NDCG@20': '0.0508'}
2025-03-07 11:42:14,999 - Validation score increased.  Saving model ...
2025-03-07 11:42:19,352 - {'epoch': 18, 'rec_loss': '5.9889'}
2025-03-07 11:42:20,237 - {'Epoch': 18, 'HR@5': '0.0523', 'NDCG@5': '0.0323', 'HR@10': '0.0761', 'NDCG@10': '0.0400', 'HR@20': '0.1183', 'NDCG@20': '0.0509'}
2025-03-07 11:42:20,238 - Validation score increased.  Saving model ...
2025-03-07 11:42:25,091 - {'epoch': 19, 'rec_loss': '5.9377'}
2025-03-07 11:42:26,002 - {'Epoch': 19, 'HR@5': '0.0532', 'NDCG@5': '0.0326', 'HR@10': '0.0835', 'NDCG@10': '0.0423', 'HR@20': '0.1138', 'NDCG@20': '0.0499'}
2025-03-07 11:42:26,003 - EarlyStopping counter: 1 out of 10
2025-03-07 11:42:30,469 - {'epoch': 20, 'rec_loss': '5.8893'}
2025-03-07 11:42:31,417 - {'Epoch': 20, 'HR@5': '0.0560', 'NDCG@5': '0.0354', 'HR@10': '0.0761', 'NDCG@10': '0.0418', 'HR@20': '0.1183', 'NDCG@20': '0.0525'}
2025-03-07 11:42:31,418 - Validation score increased.  Saving model ...
2025-03-07 11:42:36,041 - {'epoch': 21, 'rec_loss': '5.8485'}
2025-03-07 11:42:36,887 - {'Epoch': 21, 'HR@5': '0.0541', 'NDCG@5': '0.0353', 'HR@10': '0.0817', 'NDCG@10': '0.0440', 'HR@20': '0.1220', 'NDCG@20': '0.0540'}
2025-03-07 11:42:36,889 - Validation score increased.  Saving model ...
2025-03-07 11:42:40,914 - {'epoch': 22, 'rec_loss': '5.8041'}
2025-03-07 11:42:41,802 - {'Epoch': 22, 'HR@5': '0.0486', 'NDCG@5': '0.0337', 'HR@10': '0.0835', 'NDCG@10': '0.0449', 'HR@20': '0.1266', 'NDCG@20': '0.0557'}
2025-03-07 11:42:41,803 - Validation score increased.  Saving model ...
2025-03-07 11:42:46,160 - {'epoch': 23, 'rec_loss': '5.7680'}
2025-03-07 11:42:47,046 - {'Epoch': 23, 'HR@5': '0.0495', 'NDCG@5': '0.0338', 'HR@10': '0.0826', 'NDCG@10': '0.0444', 'HR@20': '0.1248', 'NDCG@20': '0.0552'}
2025-03-07 11:42:47,047 - EarlyStopping counter: 1 out of 10
2025-03-07 11:42:51,679 - {'epoch': 24, 'rec_loss': '5.7278'}
2025-03-07 11:42:52,591 - {'Epoch': 24, 'HR@5': '0.0532', 'NDCG@5': '0.0335', 'HR@10': '0.0853', 'NDCG@10': '0.0437', 'HR@20': '0.1266', 'NDCG@20': '0.0541'}
2025-03-07 11:42:52,593 - EarlyStopping counter: 2 out of 10
2025-03-07 11:42:57,041 - {'epoch': 25, 'rec_loss': '5.7044'}
2025-03-07 11:42:57,943 - {'Epoch': 25, 'HR@5': '0.0486', 'NDCG@5': '0.0320', 'HR@10': '0.0872', 'NDCG@10': '0.0445', 'HR@20': '0.1303', 'NDCG@20': '0.0553'}
2025-03-07 11:42:57,944 - EarlyStopping counter: 3 out of 10
2025-03-07 11:43:02,670 - {'epoch': 26, 'rec_loss': '5.6831'}
2025-03-07 11:43:03,666 - {'Epoch': 26, 'HR@5': '0.0550', 'NDCG@5': '0.0355', 'HR@10': '0.0844', 'NDCG@10': '0.0445', 'HR@20': '0.1312', 'NDCG@20': '0.0562'}
2025-03-07 11:43:03,667 - Validation score increased.  Saving model ...
2025-03-07 11:43:08,658 - {'epoch': 27, 'rec_loss': '5.6613'}
2025-03-07 11:43:09,767 - {'Epoch': 27, 'HR@5': '0.0514', 'NDCG@5': '0.0344', 'HR@10': '0.0798', 'NDCG@10': '0.0437', 'HR@20': '0.1220', 'NDCG@20': '0.0545'}
2025-03-07 11:43:09,769 - EarlyStopping counter: 1 out of 10
2025-03-07 11:43:14,407 - {'epoch': 28, 'rec_loss': '5.6259'}
2025-03-07 11:43:15,413 - {'Epoch': 28, 'HR@5': '0.0523', 'NDCG@5': '0.0332', 'HR@10': '0.0798', 'NDCG@10': '0.0419', 'HR@20': '0.1239', 'NDCG@20': '0.0532'}
2025-03-07 11:43:15,415 - EarlyStopping counter: 2 out of 10
2025-03-07 11:43:20,268 - {'epoch': 29, 'rec_loss': '5.6175'}
2025-03-07 11:43:21,296 - {'Epoch': 29, 'HR@5': '0.0532', 'NDCG@5': '0.0355', 'HR@10': '0.0789', 'NDCG@10': '0.0435', 'HR@20': '0.1266', 'NDCG@20': '0.0556'}
2025-03-07 11:43:21,298 - EarlyStopping counter: 3 out of 10
2025-03-07 11:43:25,868 - {'epoch': 30, 'rec_loss': '5.5945'}
2025-03-07 11:43:26,783 - {'Epoch': 30, 'HR@5': '0.0486', 'NDCG@5': '0.0332', 'HR@10': '0.0807', 'NDCG@10': '0.0435', 'HR@20': '0.1284', 'NDCG@20': '0.0556'}
2025-03-07 11:43:26,785 - EarlyStopping counter: 4 out of 10
2025-03-07 11:43:31,957 - {'epoch': 31, 'rec_loss': '5.5868'}
2025-03-07 11:43:32,910 - {'Epoch': 31, 'HR@5': '0.0541', 'NDCG@5': '0.0357', 'HR@10': '0.0835', 'NDCG@10': '0.0450', 'HR@20': '0.1257', 'NDCG@20': '0.0556'}
2025-03-07 11:43:32,912 - EarlyStopping counter: 5 out of 10
2025-03-07 11:43:37,549 - {'epoch': 32, 'rec_loss': '5.5618'}
2025-03-07 11:43:38,532 - {'Epoch': 32, 'HR@5': '0.0514', 'NDCG@5': '0.0327', 'HR@10': '0.0862', 'NDCG@10': '0.0439', 'HR@20': '0.1248', 'NDCG@20': '0.0535'}
2025-03-07 11:43:38,534 - EarlyStopping counter: 6 out of 10
2025-03-07 11:43:42,886 - {'epoch': 33, 'rec_loss': '5.5440'}
2025-03-07 11:43:43,873 - {'Epoch': 33, 'HR@5': '0.0541', 'NDCG@5': '0.0354', 'HR@10': '0.0807', 'NDCG@10': '0.0441', 'HR@20': '0.1303', 'NDCG@20': '0.0566'}
2025-03-07 11:43:43,874 - Validation score increased.  Saving model ...
2025-03-07 11:43:48,596 - {'epoch': 34, 'rec_loss': '5.5505'}
2025-03-07 11:43:49,529 - {'Epoch': 34, 'HR@5': '0.0560', 'NDCG@5': '0.0355', 'HR@10': '0.0826', 'NDCG@10': '0.0441', 'HR@20': '0.1330', 'NDCG@20': '0.0568'}
2025-03-07 11:43:49,531 - Validation score increased.  Saving model ...
2025-03-07 11:43:54,291 - {'epoch': 35, 'rec_loss': '5.5133'}
2025-03-07 11:43:55,332 - {'Epoch': 35, 'HR@5': '0.0606', 'NDCG@5': '0.0384', 'HR@10': '0.0853', 'NDCG@10': '0.0462', 'HR@20': '0.1312', 'NDCG@20': '0.0578'}
2025-03-07 11:43:55,333 - Validation score increased.  Saving model ...
2025-03-07 11:44:00,153 - {'epoch': 36, 'rec_loss': '5.5197'}
2025-03-07 11:44:01,228 - {'Epoch': 36, 'HR@5': '0.0532', 'NDCG@5': '0.0353', 'HR@10': '0.0890', 'NDCG@10': '0.0466', 'HR@20': '0.1312', 'NDCG@20': '0.0573'}
2025-03-07 11:44:01,230 - EarlyStopping counter: 1 out of 10
2025-03-07 11:44:06,059 - {'epoch': 37, 'rec_loss': '5.4910'}
2025-03-07 11:44:07,035 - {'Epoch': 37, 'HR@5': '0.0578', 'NDCG@5': '0.0364', 'HR@10': '0.0927', 'NDCG@10': '0.0473', 'HR@20': '0.1266', 'NDCG@20': '0.0559'}
2025-03-07 11:44:07,037 - EarlyStopping counter: 2 out of 10
2025-03-07 11:44:12,232 - {'epoch': 38, 'rec_loss': '5.4782'}
2025-03-07 11:44:13,281 - {'Epoch': 38, 'HR@5': '0.0578', 'NDCG@5': '0.0360', 'HR@10': '0.0890', 'NDCG@10': '0.0460', 'HR@20': '0.1330', 'NDCG@20': '0.0571'}
2025-03-07 11:44:13,282 - EarlyStopping counter: 3 out of 10
2025-03-07 11:44:19,500 - {'epoch': 39, 'rec_loss': '5.4865'}
2025-03-07 11:44:20,504 - {'Epoch': 39, 'HR@5': '0.0587', 'NDCG@5': '0.0364', 'HR@10': '0.0917', 'NDCG@10': '0.0468', 'HR@20': '0.1284', 'NDCG@20': '0.0562'}
2025-03-07 11:44:20,505 - EarlyStopping counter: 4 out of 10
2025-03-07 11:44:26,060 - {'epoch': 40, 'rec_loss': '5.4804'}
2025-03-07 11:44:27,154 - {'Epoch': 40, 'HR@5': '0.0541', 'NDCG@5': '0.0351', 'HR@10': '0.0927', 'NDCG@10': '0.0474', 'HR@20': '0.1257', 'NDCG@20': '0.0558'}
2025-03-07 11:44:27,156 - EarlyStopping counter: 5 out of 10
2025-03-07 11:44:32,028 - {'epoch': 41, 'rec_loss': '5.4724'}
2025-03-07 11:44:33,093 - {'Epoch': 41, 'HR@5': '0.0532', 'NDCG@5': '0.0359', 'HR@10': '0.0872', 'NDCG@10': '0.0467', 'HR@20': '0.1321', 'NDCG@20': '0.0582'}
2025-03-07 11:44:33,095 - Validation score increased.  Saving model ...
2025-03-07 11:44:38,488 - {'epoch': 42, 'rec_loss': '5.4745'}
2025-03-07 11:44:39,523 - {'Epoch': 42, 'HR@5': '0.0541', 'NDCG@5': '0.0359', 'HR@10': '0.0899', 'NDCG@10': '0.0472', 'HR@20': '0.1349', 'NDCG@20': '0.0584'}
2025-03-07 11:44:39,525 - Validation score increased.  Saving model ...
2025-03-07 11:44:45,442 - {'epoch': 43, 'rec_loss': '5.4630'}
2025-03-07 11:44:46,462 - {'Epoch': 43, 'HR@5': '0.0587', 'NDCG@5': '0.0383', 'HR@10': '0.0881', 'NDCG@10': '0.0476', 'HR@20': '0.1349', 'NDCG@20': '0.0594'}
2025-03-07 11:44:46,464 - Validation score increased.  Saving model ...
2025-03-07 11:44:51,249 - {'epoch': 44, 'rec_loss': '5.4466'}
2025-03-07 11:44:52,348 - {'Epoch': 44, 'HR@5': '0.0569', 'NDCG@5': '0.0367', 'HR@10': '0.0872', 'NDCG@10': '0.0463', 'HR@20': '0.1275', 'NDCG@20': '0.0565'}
2025-03-07 11:44:52,349 - EarlyStopping counter: 1 out of 10
2025-03-07 11:44:57,592 - {'epoch': 45, 'rec_loss': '5.4419'}
2025-03-07 11:44:58,679 - {'Epoch': 45, 'HR@5': '0.0560', 'NDCG@5': '0.0373', 'HR@10': '0.0872', 'NDCG@10': '0.0473', 'HR@20': '0.1312', 'NDCG@20': '0.0585'}
2025-03-07 11:44:58,680 - EarlyStopping counter: 2 out of 10
2025-03-07 11:45:04,330 - {'epoch': 46, 'rec_loss': '5.4391'}
2025-03-07 11:45:05,348 - {'Epoch': 46, 'HR@5': '0.0550', 'NDCG@5': '0.0370', 'HR@10': '0.0908', 'NDCG@10': '0.0485', 'HR@20': '0.1321', 'NDCG@20': '0.0590'}
2025-03-07 11:45:05,350 - EarlyStopping counter: 3 out of 10
2025-03-07 11:45:10,715 - {'epoch': 47, 'rec_loss': '5.4334'}
2025-03-07 11:45:11,660 - {'Epoch': 47, 'HR@5': '0.0569', 'NDCG@5': '0.0361', 'HR@10': '0.0936', 'NDCG@10': '0.0480', 'HR@20': '0.1321', 'NDCG@20': '0.0575'}
2025-03-07 11:45:11,662 - EarlyStopping counter: 4 out of 10
2025-03-07 11:45:16,928 - {'epoch': 48, 'rec_loss': '5.4236'}
2025-03-07 11:45:17,977 - {'Epoch': 48, 'HR@5': '0.0569', 'NDCG@5': '0.0370', 'HR@10': '0.0899', 'NDCG@10': '0.0479', 'HR@20': '0.1321', 'NDCG@20': '0.0584'}
2025-03-07 11:45:17,978 - EarlyStopping counter: 5 out of 10
2025-03-07 11:45:23,498 - {'epoch': 49, 'rec_loss': '5.4026'}
2025-03-07 11:45:24,507 - {'Epoch': 49, 'HR@5': '0.0569', 'NDCG@5': '0.0370', 'HR@10': '0.0890', 'NDCG@10': '0.0473', 'HR@20': '0.1294', 'NDCG@20': '0.0576'}
2025-03-07 11:45:24,509 - EarlyStopping counter: 6 out of 10
2025-03-07 11:45:29,474 - {'epoch': 50, 'rec_loss': '5.3953'}
2025-03-07 11:45:30,539 - {'Epoch': 50, 'HR@5': '0.0615', 'NDCG@5': '0.0391', 'HR@10': '0.0890', 'NDCG@10': '0.0480', 'HR@20': '0.1312', 'NDCG@20': '0.0586'}
2025-03-07 11:45:30,540 - EarlyStopping counter: 7 out of 10
2025-03-07 11:45:35,435 - {'epoch': 51, 'rec_loss': '5.3928'}
2025-03-07 11:45:36,503 - {'Epoch': 51, 'HR@5': '0.0606', 'NDCG@5': '0.0392', 'HR@10': '0.0954', 'NDCG@10': '0.0501', 'HR@20': '0.1321', 'NDCG@20': '0.0594'}
2025-03-07 11:45:36,504 - EarlyStopping counter: 8 out of 10
2025-03-07 11:45:41,453 - {'epoch': 52, 'rec_loss': '5.3998'}
2025-03-07 11:45:42,400 - {'Epoch': 52, 'HR@5': '0.0587', 'NDCG@5': '0.0370', 'HR@10': '0.0936', 'NDCG@10': '0.0483', 'HR@20': '0.1339', 'NDCG@20': '0.0584'}
2025-03-07 11:45:42,401 - EarlyStopping counter: 9 out of 10
2025-03-07 11:45:46,713 - {'epoch': 53, 'rec_loss': '5.3848'}
2025-03-07 11:45:47,601 - {'Epoch': 53, 'HR@5': '0.0633', 'NDCG@5': '0.0403', 'HR@10': '0.0936', 'NDCG@10': '0.0500', 'HR@20': '0.1284', 'NDCG@20': '0.0589'}
2025-03-07 11:45:47,602 - EarlyStopping counter: 10 out of 10
2025-03-07 11:45:47,602 - Early stopping
2025-03-07 11:45:47,603 - ---------------Test Score---------------
2025-03-07 11:45:48,630 - {'Epoch': 0, 'HR@5': '0.0450', 'NDCG@5': '0.0315', 'HR@10': '0.0661', 'NDCG@10': '0.0383', 'HR@20': '0.0954', 'NDCG@20': '0.0456'}
2025-03-07 11:45:48,631 - Scale_LastFM
2025-03-07 11:45:48,631 - {'Epoch': 0, 'HR@5': '0.0450', 'NDCG@5': '0.0315', 'HR@10': '0.0661', 'NDCG@10': '0.0383', 'HR@20': '0.0954', 'NDCG@20': '0.0456'}
