2025-02-16 14:38:07,050 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-02-16 14:38:09,836 - HyperRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-16 14:38:09,841 - Total Parameters: 1437093
2025-02-16 14:38:55,883 - {'epoch': 0, 'rec_loss': '9.5374'}
2025-02-16 14:39:11,604 - {'Epoch': 0, 'HR@5': '0.0087', 'NDCG@5': '0.0057', 'HR@10': '0.0144', 'NDCG@10': '0.0075', 'HR@20': '0.0250', 'NDCG@20': '0.0101'}
2025-02-16 14:39:11,605 - Validation score increased.  Saving model ...
2025-02-16 14:39:54,160 - {'epoch': 1, 'rec_loss': '8.8868'}
2025-02-16 14:40:10,664 - {'Epoch': 1, 'HR@5': '0.0148', 'NDCG@5': '0.0093', 'HR@10': '0.0252', 'NDCG@10': '0.0127', 'HR@20': '0.0404', 'NDCG@20': '0.0165'}
2025-02-16 14:40:10,666 - Validation score increased.  Saving model ...
2025-02-16 14:40:53,684 - {'epoch': 2, 'rec_loss': '8.4309'}
2025-02-16 14:41:07,975 - {'Epoch': 2, 'HR@5': '0.0188', 'NDCG@5': '0.0115', 'HR@10': '0.0333', 'NDCG@10': '0.0162', 'HR@20': '0.0550', 'NDCG@20': '0.0216'}
2025-02-16 14:41:07,980 - Validation score increased.  Saving model ...
2025-02-16 14:41:52,751 - {'epoch': 3, 'rec_loss': '8.1480'}
2025-02-16 14:42:07,081 - {'Epoch': 3, 'HR@5': '0.0212', 'NDCG@5': '0.0131', 'HR@10': '0.0377', 'NDCG@10': '0.0184', 'HR@20': '0.0612', 'NDCG@20': '0.0243'}
2025-02-16 14:42:07,083 - Validation score increased.  Saving model ...
2025-02-16 14:42:53,262 - {'epoch': 4, 'rec_loss': '7.9690'}
2025-02-16 14:43:08,092 - {'Epoch': 4, 'HR@5': '0.0243', 'NDCG@5': '0.0152', 'HR@10': '0.0409', 'NDCG@10': '0.0206', 'HR@20': '0.0680', 'NDCG@20': '0.0273'}
2025-02-16 14:43:08,094 - Validation score increased.  Saving model ...
2025-02-16 14:43:50,671 - {'epoch': 5, 'rec_loss': '7.8367'}
2025-02-16 14:44:07,027 - {'Epoch': 5, 'HR@5': '0.0260', 'NDCG@5': '0.0162', 'HR@10': '0.0435', 'NDCG@10': '0.0219', 'HR@20': '0.0706', 'NDCG@20': '0.0287'}
2025-02-16 14:44:07,028 - Validation score increased.  Saving model ...
2025-02-16 14:44:48,531 - {'epoch': 6, 'rec_loss': '7.7352'}
2025-02-16 14:45:03,642 - {'Epoch': 6, 'HR@5': '0.0265', 'NDCG@5': '0.0164', 'HR@10': '0.0450', 'NDCG@10': '0.0223', 'HR@20': '0.0733', 'NDCG@20': '0.0294'}
2025-02-16 14:45:03,647 - Validation score increased.  Saving model ...
2025-02-16 14:45:44,851 - {'epoch': 7, 'rec_loss': '7.6551'}
2025-02-16 14:46:01,867 - {'Epoch': 7, 'HR@5': '0.0262', 'NDCG@5': '0.0164', 'HR@10': '0.0444', 'NDCG@10': '0.0222', 'HR@20': '0.0738', 'NDCG@20': '0.0296'}
2025-02-16 14:46:01,869 - Validation score increased.  Saving model ...
2025-02-16 14:46:42,915 - {'epoch': 8, 'rec_loss': '7.5909'}
2025-02-16 14:46:59,920 - {'Epoch': 8, 'HR@5': '0.0269', 'NDCG@5': '0.0167', 'HR@10': '0.0456', 'NDCG@10': '0.0226', 'HR@20': '0.0747', 'NDCG@20': '0.0300'}
2025-02-16 14:46:59,922 - Validation score increased.  Saving model ...
2025-02-16 14:47:41,055 - {'epoch': 9, 'rec_loss': '7.5397'}
2025-02-16 14:47:57,106 - {'Epoch': 9, 'HR@5': '0.0281', 'NDCG@5': '0.0173', 'HR@10': '0.0476', 'NDCG@10': '0.0235', 'HR@20': '0.0755', 'NDCG@20': '0.0305'}
2025-02-16 14:47:57,111 - Validation score increased.  Saving model ...
2025-02-16 14:48:38,632 - {'epoch': 10, 'rec_loss': '7.4951'}
2025-02-16 14:48:55,691 - {'Epoch': 10, 'HR@5': '0.0271', 'NDCG@5': '0.0172', 'HR@10': '0.0475', 'NDCG@10': '0.0237', 'HR@20': '0.0772', 'NDCG@20': '0.0312'}
2025-02-16 14:48:55,693 - Validation score increased.  Saving model ...
2025-02-16 14:49:36,755 - {'epoch': 11, 'rec_loss': '7.4509'}
2025-02-16 14:49:53,615 - {'Epoch': 11, 'HR@5': '0.0282', 'NDCG@5': '0.0172', 'HR@10': '0.0479', 'NDCG@10': '0.0235', 'HR@20': '0.0775', 'NDCG@20': '0.0310'}
2025-02-16 14:49:53,617 - EarlyStopping counter: 1 out of 10
2025-02-16 14:50:34,921 - {'epoch': 12, 'rec_loss': '7.4218'}
2025-02-16 14:50:49,775 - {'Epoch': 12, 'HR@5': '0.0285', 'NDCG@5': '0.0182', 'HR@10': '0.0489', 'NDCG@10': '0.0247', 'HR@20': '0.0776', 'NDCG@20': '0.0319'}
2025-02-16 14:50:49,777 - Validation score increased.  Saving model ...
2025-02-16 14:51:34,846 - {'epoch': 13, 'rec_loss': '7.3863'}
2025-02-16 14:51:49,808 - {'Epoch': 13, 'HR@5': '0.0283', 'NDCG@5': '0.0177', 'HR@10': '0.0484', 'NDCG@10': '0.0242', 'HR@20': '0.0768', 'NDCG@20': '0.0313'}
2025-02-16 14:51:49,810 - EarlyStopping counter: 1 out of 10
2025-02-16 14:52:30,922 - {'epoch': 14, 'rec_loss': '7.3606'}
2025-02-16 14:52:45,927 - {'Epoch': 14, 'HR@5': '0.0285', 'NDCG@5': '0.0179', 'HR@10': '0.0477', 'NDCG@10': '0.0240', 'HR@20': '0.0787', 'NDCG@20': '0.0318'}
2025-02-16 14:52:45,929 - EarlyStopping counter: 2 out of 10
2025-02-16 14:53:27,801 - {'epoch': 15, 'rec_loss': '7.3407'}
2025-02-16 14:53:43,693 - {'Epoch': 15, 'HR@5': '0.0291', 'NDCG@5': '0.0180', 'HR@10': '0.0490', 'NDCG@10': '0.0243', 'HR@20': '0.0790', 'NDCG@20': '0.0319'}
2025-02-16 14:53:43,695 - EarlyStopping counter: 3 out of 10
2025-02-16 14:54:24,992 - {'epoch': 16, 'rec_loss': '7.3121'}
2025-02-16 14:54:41,836 - {'Epoch': 16, 'HR@5': '0.0287', 'NDCG@5': '0.0181', 'HR@10': '0.0474', 'NDCG@10': '0.0241', 'HR@20': '0.0802', 'NDCG@20': '0.0324'}
2025-02-16 14:54:41,838 - Validation score increased.  Saving model ...
2025-02-16 14:55:23,043 - {'epoch': 17, 'rec_loss': '7.2920'}
2025-02-16 14:55:39,201 - {'Epoch': 17, 'HR@5': '0.0289', 'NDCG@5': '0.0179', 'HR@10': '0.0487', 'NDCG@10': '0.0243', 'HR@20': '0.0782', 'NDCG@20': '0.0317'}
2025-02-16 14:55:39,203 - EarlyStopping counter: 1 out of 10
2025-02-16 14:56:20,302 - {'epoch': 18, 'rec_loss': '7.2735'}
2025-02-16 14:56:36,967 - {'Epoch': 18, 'HR@5': '0.0291', 'NDCG@5': '0.0182', 'HR@10': '0.0480', 'NDCG@10': '0.0242', 'HR@20': '0.0791', 'NDCG@20': '0.0320'}
2025-02-16 14:56:36,968 - EarlyStopping counter: 2 out of 10
2025-02-16 14:57:18,088 - {'epoch': 19, 'rec_loss': '7.2555'}
2025-02-16 14:57:35,174 - {'Epoch': 19, 'HR@5': '0.0299', 'NDCG@5': '0.0188', 'HR@10': '0.0498', 'NDCG@10': '0.0252', 'HR@20': '0.0802', 'NDCG@20': '0.0328'}
2025-02-16 14:57:35,178 - Validation score increased.  Saving model ...
2025-02-16 14:58:16,316 - {'epoch': 20, 'rec_loss': '7.2408'}
2025-02-16 14:58:33,282 - {'Epoch': 20, 'HR@5': '0.0290', 'NDCG@5': '0.0185', 'HR@10': '0.0483', 'NDCG@10': '0.0246', 'HR@20': '0.0801', 'NDCG@20': '0.0326'}
2025-02-16 14:58:33,286 - EarlyStopping counter: 1 out of 10
2025-02-16 14:59:14,381 - {'epoch': 21, 'rec_loss': '7.2237'}
2025-02-16 14:59:31,023 - {'Epoch': 21, 'HR@5': '0.0295', 'NDCG@5': '0.0187', 'HR@10': '0.0496', 'NDCG@10': '0.0251', 'HR@20': '0.0808', 'NDCG@20': '0.0330'}
2025-02-16 14:59:31,025 - Validation score increased.  Saving model ...
2025-02-16 15:00:12,305 - {'epoch': 22, 'rec_loss': '7.2156'}
2025-02-16 15:00:27,423 - {'Epoch': 22, 'HR@5': '0.0293', 'NDCG@5': '0.0183', 'HR@10': '0.0489', 'NDCG@10': '0.0246', 'HR@20': '0.0798', 'NDCG@20': '0.0323'}
2025-02-16 15:00:27,427 - EarlyStopping counter: 1 out of 10
2025-02-16 15:01:09,124 - {'epoch': 23, 'rec_loss': '7.1957'}
2025-02-16 15:01:26,237 - {'Epoch': 23, 'HR@5': '0.0293', 'NDCG@5': '0.0184', 'HR@10': '0.0501', 'NDCG@10': '0.0251', 'HR@20': '0.0809', 'NDCG@20': '0.0329'}
2025-02-16 15:01:26,239 - EarlyStopping counter: 2 out of 10
2025-02-16 15:02:08,323 - {'epoch': 24, 'rec_loss': '7.1861'}
2025-02-16 15:02:23,163 - {'Epoch': 24, 'HR@5': '0.0296', 'NDCG@5': '0.0188', 'HR@10': '0.0505', 'NDCG@10': '0.0255', 'HR@20': '0.0814', 'NDCG@20': '0.0332'}
2025-02-16 15:02:23,164 - Validation score increased.  Saving model ...
2025-02-16 15:03:07,832 - {'epoch': 25, 'rec_loss': '7.1723'}
2025-02-16 15:03:24,603 - {'Epoch': 25, 'HR@5': '0.0296', 'NDCG@5': '0.0186', 'HR@10': '0.0505', 'NDCG@10': '0.0253', 'HR@20': '0.0817', 'NDCG@20': '0.0332'}
2025-02-16 15:03:24,604 - EarlyStopping counter: 1 out of 10
2025-02-16 15:04:06,830 - {'epoch': 26, 'rec_loss': '7.1655'}
2025-02-16 15:04:23,568 - {'Epoch': 26, 'HR@5': '0.0304', 'NDCG@5': '0.0189', 'HR@10': '0.0503', 'NDCG@10': '0.0253', 'HR@20': '0.0811', 'NDCG@20': '0.0330'}
2025-02-16 15:04:23,569 - EarlyStopping counter: 2 out of 10
2025-02-16 15:05:05,149 - {'epoch': 27, 'rec_loss': '7.1532'}
2025-02-16 15:05:22,349 - {'Epoch': 27, 'HR@5': '0.0301', 'NDCG@5': '0.0190', 'HR@10': '0.0513', 'NDCG@10': '0.0258', 'HR@20': '0.0823', 'NDCG@20': '0.0336'}
2025-02-16 15:05:22,350 - Validation score increased.  Saving model ...
2025-02-16 15:06:04,561 - {'epoch': 28, 'rec_loss': '7.1460'}
2025-02-16 15:06:21,739 - {'Epoch': 28, 'HR@5': '0.0296', 'NDCG@5': '0.0187', 'HR@10': '0.0499', 'NDCG@10': '0.0252', 'HR@20': '0.0805', 'NDCG@20': '0.0329'}
2025-02-16 15:06:21,740 - EarlyStopping counter: 1 out of 10
2025-02-16 15:07:03,230 - {'epoch': 29, 'rec_loss': '7.1339'}
2025-02-16 15:07:20,309 - {'Epoch': 29, 'HR@5': '0.0304', 'NDCG@5': '0.0187', 'HR@10': '0.0508', 'NDCG@10': '0.0252', 'HR@20': '0.0801', 'NDCG@20': '0.0326'}
2025-02-16 15:07:20,314 - EarlyStopping counter: 2 out of 10
2025-02-16 15:08:01,704 - {'epoch': 30, 'rec_loss': '7.1264'}
2025-02-16 15:08:16,596 - {'Epoch': 30, 'HR@5': '0.0305', 'NDCG@5': '0.0193', 'HR@10': '0.0506', 'NDCG@10': '0.0257', 'HR@20': '0.0805', 'NDCG@20': '0.0333'}
2025-02-16 15:08:16,599 - EarlyStopping counter: 3 out of 10
2025-02-16 15:08:57,984 - {'epoch': 31, 'rec_loss': '7.1186'}
2025-02-16 15:09:12,957 - {'Epoch': 31, 'HR@5': '0.0291', 'NDCG@5': '0.0182', 'HR@10': '0.0496', 'NDCG@10': '0.0247', 'HR@20': '0.0811', 'NDCG@20': '0.0327'}
2025-02-16 15:09:12,958 - EarlyStopping counter: 4 out of 10
2025-02-16 15:09:57,974 - {'epoch': 32, 'rec_loss': '7.1109'}
2025-02-16 15:10:13,303 - {'Epoch': 32, 'HR@5': '0.0287', 'NDCG@5': '0.0181', 'HR@10': '0.0499', 'NDCG@10': '0.0249', 'HR@20': '0.0797', 'NDCG@20': '0.0324'}
2025-02-16 15:10:13,305 - EarlyStopping counter: 5 out of 10
2025-02-16 15:10:58,385 - {'epoch': 33, 'rec_loss': '7.1032'}
2025-02-16 15:11:13,589 - {'Epoch': 33, 'HR@5': '0.0308', 'NDCG@5': '0.0191', 'HR@10': '0.0507', 'NDCG@10': '0.0255', 'HR@20': '0.0814', 'NDCG@20': '0.0332'}
2025-02-16 15:11:13,591 - EarlyStopping counter: 6 out of 10
2025-02-16 15:11:58,420 - {'epoch': 34, 'rec_loss': '7.0966'}
2025-02-16 15:12:13,777 - {'Epoch': 34, 'HR@5': '0.0296', 'NDCG@5': '0.0186', 'HR@10': '0.0514', 'NDCG@10': '0.0256', 'HR@20': '0.0823', 'NDCG@20': '0.0333'}
2025-02-16 15:12:13,779 - EarlyStopping counter: 7 out of 10
2025-02-16 15:12:59,113 - {'epoch': 35, 'rec_loss': '7.0905'}
2025-02-16 15:13:14,076 - {'Epoch': 35, 'HR@5': '0.0295', 'NDCG@5': '0.0179', 'HR@10': '0.0491', 'NDCG@10': '0.0242', 'HR@20': '0.0795', 'NDCG@20': '0.0319'}
2025-02-16 15:13:14,077 - EarlyStopping counter: 8 out of 10
2025-02-16 15:14:00,363 - {'epoch': 36, 'rec_loss': '7.0820'}
2025-02-16 15:14:15,196 - {'Epoch': 36, 'HR@5': '0.0296', 'NDCG@5': '0.0182', 'HR@10': '0.0498', 'NDCG@10': '0.0247', 'HR@20': '0.0801', 'NDCG@20': '0.0323'}
2025-02-16 15:14:15,198 - EarlyStopping counter: 9 out of 10
2025-02-16 15:14:56,860 - {'epoch': 37, 'rec_loss': '7.0758'}
2025-02-16 15:15:12,368 - {'Epoch': 37, 'HR@5': '0.0293', 'NDCG@5': '0.0184', 'HR@10': '0.0495', 'NDCG@10': '0.0249', 'HR@20': '0.0815', 'NDCG@20': '0.0329'}
2025-02-16 15:15:12,370 - EarlyStopping counter: 10 out of 10
2025-02-16 15:15:12,370 - Early stopping
2025-02-16 15:15:12,370 - ---------------Test Score---------------
2025-02-16 15:15:28,738 - {'Epoch': 0, 'HR@5': '0.0283', 'NDCG@5': '0.0174', 'HR@10': '0.0468', 'NDCG@10': '0.0233', 'HR@20': '0.0753', 'NDCG@20': '0.0304'}
2025-02-16 15:15:28,740 - Scale_Yelp
2025-02-16 15:15:28,741 - {'Epoch': 0, 'HR@5': '0.0283', 'NDCG@5': '0.0174', 'HR@10': '0.0468', 'NDCG@10': '0.0233', 'HR@20': '0.0753', 'NDCG@20': '0.0304'}
2025-02-18 12:19:15,466 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-02-18 12:19:18,656 - HyperRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-18 12:19:18,660 - Total Parameters: 1437093
2025-02-18 12:20:06,305 - {'epoch': 0, 'rec_loss': '9.5431'}
2025-02-18 12:20:21,874 - {'Epoch': 0, 'HR@5': '0.0086', 'NDCG@5': '0.0056', 'HR@10': '0.0143', 'NDCG@10': '0.0074', 'HR@20': '0.0251', 'NDCG@20': '0.0101'}
2025-02-18 12:20:21,876 - Validation score increased.  Saving model ...
2025-02-18 12:21:09,228 - {'epoch': 1, 'rec_loss': '8.9168'}
2025-02-18 12:21:23,844 - {'Epoch': 1, 'HR@5': '0.0138', 'NDCG@5': '0.0086', 'HR@10': '0.0240', 'NDCG@10': '0.0119', 'HR@20': '0.0399', 'NDCG@20': '0.0159'}
2025-02-18 12:21:23,848 - Validation score increased.  Saving model ...
2025-02-18 12:22:09,413 - {'epoch': 2, 'rec_loss': '8.4758'}
2025-02-18 12:22:24,545 - {'Epoch': 2, 'HR@5': '0.0183', 'NDCG@5': '0.0112', 'HR@10': '0.0327', 'NDCG@10': '0.0159', 'HR@20': '0.0548', 'NDCG@20': '0.0214'}
2025-02-18 12:22:24,547 - Validation score increased.  Saving model ...
2025-02-18 12:23:09,957 - {'epoch': 3, 'rec_loss': '8.1912'}
2025-02-18 12:23:24,362 - {'Epoch': 3, 'HR@5': '0.0205', 'NDCG@5': '0.0127', 'HR@10': '0.0371', 'NDCG@10': '0.0180', 'HR@20': '0.0603', 'NDCG@20': '0.0238'}
2025-02-18 12:23:24,364 - Validation score increased.  Saving model ...
2025-02-18 12:24:11,323 - {'epoch': 4, 'rec_loss': '8.0161'}
2025-02-18 12:24:25,931 - {'Epoch': 4, 'HR@5': '0.0227', 'NDCG@5': '0.0143', 'HR@10': '0.0399', 'NDCG@10': '0.0198', 'HR@20': '0.0676', 'NDCG@20': '0.0268'}
2025-02-18 12:24:25,933 - Validation score increased.  Saving model ...
2025-02-18 12:25:12,826 - {'epoch': 5, 'rec_loss': '7.8868'}
2025-02-18 12:25:27,242 - {'Epoch': 5, 'HR@5': '0.0250', 'NDCG@5': '0.0157', 'HR@10': '0.0430', 'NDCG@10': '0.0214', 'HR@20': '0.0697', 'NDCG@20': '0.0282'}
2025-02-18 12:25:27,247 - Validation score increased.  Saving model ...
2025-02-18 12:26:13,327 - {'epoch': 6, 'rec_loss': '7.7890'}
2025-02-18 12:26:28,070 - {'Epoch': 6, 'HR@5': '0.0267', 'NDCG@5': '0.0164', 'HR@10': '0.0450', 'NDCG@10': '0.0222', 'HR@20': '0.0729', 'NDCG@20': '0.0292'}
2025-02-18 12:26:28,071 - Validation score increased.  Saving model ...
2025-02-18 12:27:15,333 - {'epoch': 7, 'rec_loss': '7.7105'}
2025-02-18 12:27:30,199 - {'Epoch': 7, 'HR@5': '0.0265', 'NDCG@5': '0.0164', 'HR@10': '0.0454', 'NDCG@10': '0.0224', 'HR@20': '0.0749', 'NDCG@20': '0.0298'}
2025-02-18 12:27:30,200 - Validation score increased.  Saving model ...
2025-02-18 12:28:16,719 - {'epoch': 8, 'rec_loss': '7.6462'}
2025-02-18 12:28:31,763 - {'Epoch': 8, 'HR@5': '0.0272', 'NDCG@5': '0.0168', 'HR@10': '0.0465', 'NDCG@10': '0.0230', 'HR@20': '0.0749', 'NDCG@20': '0.0301'}
2025-02-18 12:28:31,765 - Validation score increased.  Saving model ...
2025-02-18 12:29:19,241 - {'epoch': 9, 'rec_loss': '7.5942'}
2025-02-18 12:29:34,192 - {'Epoch': 9, 'HR@5': '0.0280', 'NDCG@5': '0.0174', 'HR@10': '0.0478', 'NDCG@10': '0.0238', 'HR@20': '0.0773', 'NDCG@20': '0.0312'}
2025-02-18 12:29:34,197 - Validation score increased.  Saving model ...
2025-02-18 12:30:20,744 - {'epoch': 10, 'rec_loss': '7.5487'}
2025-02-18 12:30:36,304 - {'Epoch': 10, 'HR@5': '0.0276', 'NDCG@5': '0.0176', 'HR@10': '0.0481', 'NDCG@10': '0.0241', 'HR@20': '0.0774', 'NDCG@20': '0.0315'}
2025-02-18 12:30:36,307 - Validation score increased.  Saving model ...
2025-02-18 12:31:22,956 - {'epoch': 11, 'rec_loss': '7.5023'}
2025-02-18 12:31:37,834 - {'Epoch': 11, 'HR@5': '0.0296', 'NDCG@5': '0.0180', 'HR@10': '0.0482', 'NDCG@10': '0.0239', 'HR@20': '0.0788', 'NDCG@20': '0.0316'}
2025-02-18 12:31:37,836 - Validation score increased.  Saving model ...
2025-02-18 12:32:23,832 - {'epoch': 12, 'rec_loss': '7.4684'}
2025-02-18 12:32:38,830 - {'Epoch': 12, 'HR@5': '0.0294', 'NDCG@5': '0.0182', 'HR@10': '0.0495', 'NDCG@10': '0.0246', 'HR@20': '0.0785', 'NDCG@20': '0.0319'}
2025-02-18 12:32:38,831 - Validation score increased.  Saving model ...
2025-02-18 12:33:24,922 - {'epoch': 13, 'rec_loss': '7.4339'}
2025-02-18 12:33:39,904 - {'Epoch': 13, 'HR@5': '0.0293', 'NDCG@5': '0.0181', 'HR@10': '0.0488', 'NDCG@10': '0.0243', 'HR@20': '0.0779', 'NDCG@20': '0.0317'}
2025-02-18 12:33:39,905 - EarlyStopping counter: 1 out of 10
2025-02-18 12:34:26,710 - {'epoch': 14, 'rec_loss': '7.4093'}
2025-02-18 12:34:41,672 - {'Epoch': 14, 'HR@5': '0.0295', 'NDCG@5': '0.0183', 'HR@10': '0.0487', 'NDCG@10': '0.0245', 'HR@20': '0.0778', 'NDCG@20': '0.0318'}
2025-02-18 12:34:41,674 - EarlyStopping counter: 2 out of 10
2025-02-18 12:35:30,705 - {'epoch': 15, 'rec_loss': '7.3850'}
2025-02-18 12:35:45,553 - {'Epoch': 15, 'HR@5': '0.0290', 'NDCG@5': '0.0181', 'HR@10': '0.0494', 'NDCG@10': '0.0247', 'HR@20': '0.0797', 'NDCG@20': '0.0323'}
2025-02-18 12:35:45,555 - Validation score increased.  Saving model ...
2025-02-18 12:36:33,431 - {'epoch': 16, 'rec_loss': '7.3587'}
2025-02-18 12:36:48,902 - {'Epoch': 16, 'HR@5': '0.0294', 'NDCG@5': '0.0183', 'HR@10': '0.0490', 'NDCG@10': '0.0246', 'HR@20': '0.0806', 'NDCG@20': '0.0326'}
2025-02-18 12:36:48,903 - Validation score increased.  Saving model ...
2025-02-18 12:37:36,544 - {'epoch': 17, 'rec_loss': '7.3369'}
2025-02-18 12:37:51,687 - {'Epoch': 17, 'HR@5': '0.0300', 'NDCG@5': '0.0187', 'HR@10': '0.0500', 'NDCG@10': '0.0251', 'HR@20': '0.0812', 'NDCG@20': '0.0329'}
2025-02-18 12:37:51,688 - Validation score increased.  Saving model ...
2025-02-18 12:38:41,805 - {'epoch': 18, 'rec_loss': '7.3191'}
2025-02-18 12:38:57,301 - {'Epoch': 18, 'HR@5': '0.0290', 'NDCG@5': '0.0184', 'HR@10': '0.0495', 'NDCG@10': '0.0249', 'HR@20': '0.0803', 'NDCG@20': '0.0327'}
2025-02-18 12:38:57,305 - EarlyStopping counter: 1 out of 10
2025-02-18 12:39:45,374 - {'epoch': 19, 'rec_loss': '7.2994'}
2025-02-18 12:40:00,374 - {'Epoch': 19, 'HR@5': '0.0304', 'NDCG@5': '0.0190', 'HR@10': '0.0502', 'NDCG@10': '0.0254', 'HR@20': '0.0812', 'NDCG@20': '0.0332'}
2025-02-18 12:40:00,376 - Validation score increased.  Saving model ...
2025-02-18 12:40:46,122 - {'epoch': 20, 'rec_loss': '7.2859'}
2025-02-18 12:41:01,096 - {'Epoch': 20, 'HR@5': '0.0299', 'NDCG@5': '0.0189', 'HR@10': '0.0494', 'NDCG@10': '0.0251', 'HR@20': '0.0803', 'NDCG@20': '0.0329'}
2025-02-18 12:41:01,100 - EarlyStopping counter: 1 out of 10
2025-02-18 12:41:46,648 - {'epoch': 21, 'rec_loss': '7.2724'}
2025-02-18 12:42:01,650 - {'Epoch': 21, 'HR@5': '0.0302', 'NDCG@5': '0.0189', 'HR@10': '0.0505', 'NDCG@10': '0.0254', 'HR@20': '0.0807', 'NDCG@20': '0.0330'}
2025-02-18 12:42:01,652 - EarlyStopping counter: 2 out of 10
2025-02-18 12:42:48,859 - {'epoch': 22, 'rec_loss': '7.2606'}
2025-02-18 12:43:03,753 - {'Epoch': 22, 'HR@5': '0.0297', 'NDCG@5': '0.0187', 'HR@10': '0.0501', 'NDCG@10': '0.0252', 'HR@20': '0.0806', 'NDCG@20': '0.0329'}
2025-02-18 12:43:03,755 - EarlyStopping counter: 3 out of 10
2025-02-18 12:43:49,057 - {'epoch': 23, 'rec_loss': '7.2411'}
2025-02-18 12:44:04,000 - {'Epoch': 23, 'HR@5': '0.0299', 'NDCG@5': '0.0187', 'HR@10': '0.0501', 'NDCG@10': '0.0252', 'HR@20': '0.0831', 'NDCG@20': '0.0335'}
2025-02-18 12:44:04,004 - Validation score increased.  Saving model ...
2025-02-18 12:44:50,218 - {'epoch': 24, 'rec_loss': '7.2302'}
2025-02-18 12:45:05,200 - {'Epoch': 24, 'HR@5': '0.0300', 'NDCG@5': '0.0190', 'HR@10': '0.0504', 'NDCG@10': '0.0255', 'HR@20': '0.0813', 'NDCG@20': '0.0333'}
2025-02-18 12:45:05,202 - EarlyStopping counter: 1 out of 10
2025-02-18 12:45:51,964 - {'epoch': 25, 'rec_loss': '7.2167'}
2025-02-18 12:46:06,980 - {'Epoch': 25, 'HR@5': '0.0301', 'NDCG@5': '0.0190', 'HR@10': '0.0502', 'NDCG@10': '0.0255', 'HR@20': '0.0826', 'NDCG@20': '0.0336'}
2025-02-18 12:46:06,982 - Validation score increased.  Saving model ...
2025-02-18 12:46:56,359 - {'epoch': 26, 'rec_loss': '7.2070'}
2025-02-18 12:47:11,164 - {'Epoch': 26, 'HR@5': '0.0302', 'NDCG@5': '0.0190', 'HR@10': '0.0507', 'NDCG@10': '0.0255', 'HR@20': '0.0822', 'NDCG@20': '0.0334'}
2025-02-18 12:47:11,169 - EarlyStopping counter: 1 out of 10
2025-02-18 12:47:56,765 - {'epoch': 27, 'rec_loss': '7.1954'}
2025-02-18 12:48:11,739 - {'Epoch': 27, 'HR@5': '0.0304', 'NDCG@5': '0.0191', 'HR@10': '0.0508', 'NDCG@10': '0.0256', 'HR@20': '0.0823', 'NDCG@20': '0.0335'}
2025-02-18 12:48:11,744 - EarlyStopping counter: 2 out of 10
2025-02-18 12:48:56,620 - {'epoch': 28, 'rec_loss': '7.1861'}
2025-02-18 12:49:11,627 - {'Epoch': 28, 'HR@5': '0.0311', 'NDCG@5': '0.0194', 'HR@10': '0.0506', 'NDCG@10': '0.0256', 'HR@20': '0.0819', 'NDCG@20': '0.0334'}
2025-02-18 12:49:11,628 - EarlyStopping counter: 3 out of 10
2025-02-18 12:49:56,702 - {'epoch': 29, 'rec_loss': '7.1755'}
2025-02-18 12:50:11,755 - {'Epoch': 29, 'HR@5': '0.0296', 'NDCG@5': '0.0185', 'HR@10': '0.0499', 'NDCG@10': '0.0251', 'HR@20': '0.0817', 'NDCG@20': '0.0331'}
2025-02-18 12:50:11,756 - EarlyStopping counter: 4 out of 10
2025-02-18 12:50:57,117 - {'epoch': 30, 'rec_loss': '7.1661'}
2025-02-18 12:51:12,613 - {'Epoch': 30, 'HR@5': '0.0295', 'NDCG@5': '0.0185', 'HR@10': '0.0509', 'NDCG@10': '0.0254', 'HR@20': '0.0817', 'NDCG@20': '0.0331'}
2025-02-18 12:51:12,615 - EarlyStopping counter: 5 out of 10
2025-02-18 12:51:58,713 - {'epoch': 31, 'rec_loss': '7.1569'}
2025-02-18 12:52:13,733 - {'Epoch': 31, 'HR@5': '0.0291', 'NDCG@5': '0.0181', 'HR@10': '0.0505', 'NDCG@10': '0.0249', 'HR@20': '0.0832', 'NDCG@20': '0.0331'}
2025-02-18 12:52:13,734 - EarlyStopping counter: 6 out of 10
2025-02-18 12:53:01,205 - {'epoch': 32, 'rec_loss': '7.1456'}
2025-02-18 12:53:16,936 - {'Epoch': 32, 'HR@5': '0.0288', 'NDCG@5': '0.0182', 'HR@10': '0.0500', 'NDCG@10': '0.0250', 'HR@20': '0.0818', 'NDCG@20': '0.0330'}
2025-02-18 12:53:16,938 - EarlyStopping counter: 7 out of 10
2025-02-18 12:54:03,619 - {'epoch': 33, 'rec_loss': '7.1415'}
2025-02-18 12:54:19,058 - {'Epoch': 33, 'HR@5': '0.0306', 'NDCG@5': '0.0193', 'HR@10': '0.0512', 'NDCG@10': '0.0259', 'HR@20': '0.0831', 'NDCG@20': '0.0339'}
2025-02-18 12:54:19,060 - Validation score increased.  Saving model ...
2025-02-18 12:55:04,529 - {'epoch': 34, 'rec_loss': '7.1336'}
2025-02-18 12:55:19,413 - {'Epoch': 34, 'HR@5': '0.0299', 'NDCG@5': '0.0186', 'HR@10': '0.0512', 'NDCG@10': '0.0254', 'HR@20': '0.0830', 'NDCG@20': '0.0334'}
2025-02-18 12:55:19,414 - EarlyStopping counter: 1 out of 10
2025-02-18 12:56:05,597 - {'epoch': 35, 'rec_loss': '7.1284'}
2025-02-18 12:56:20,592 - {'Epoch': 35, 'HR@5': '0.0293', 'NDCG@5': '0.0180', 'HR@10': '0.0495', 'NDCG@10': '0.0244', 'HR@20': '0.0793', 'NDCG@20': '0.0319'}
2025-02-18 12:56:20,595 - EarlyStopping counter: 2 out of 10
2025-02-18 12:57:06,688 - {'epoch': 36, 'rec_loss': '7.1198'}
2025-02-18 12:57:21,928 - {'Epoch': 36, 'HR@5': '0.0287', 'NDCG@5': '0.0183', 'HR@10': '0.0498', 'NDCG@10': '0.0251', 'HR@20': '0.0819', 'NDCG@20': '0.0332'}
2025-02-18 12:57:21,929 - EarlyStopping counter: 3 out of 10
2025-02-18 12:58:07,700 - {'epoch': 37, 'rec_loss': '7.1153'}
2025-02-18 12:58:22,702 - {'Epoch': 37, 'HR@5': '0.0293', 'NDCG@5': '0.0190', 'HR@10': '0.0499', 'NDCG@10': '0.0256', 'HR@20': '0.0815', 'NDCG@20': '0.0335'}
2025-02-18 12:58:22,706 - EarlyStopping counter: 4 out of 10
2025-02-18 12:59:08,874 - {'epoch': 38, 'rec_loss': '7.1043'}
2025-02-18 12:59:23,938 - {'Epoch': 38, 'HR@5': '0.0298', 'NDCG@5': '0.0188', 'HR@10': '0.0492', 'NDCG@10': '0.0250', 'HR@20': '0.0812', 'NDCG@20': '0.0330'}
2025-02-18 12:59:23,941 - EarlyStopping counter: 5 out of 10
2025-02-18 13:00:10,091 - {'epoch': 39, 'rec_loss': '7.0961'}
2025-02-18 13:00:25,306 - {'Epoch': 39, 'HR@5': '0.0298', 'NDCG@5': '0.0189', 'HR@10': '0.0484', 'NDCG@10': '0.0249', 'HR@20': '0.0798', 'NDCG@20': '0.0327'}
2025-02-18 13:00:25,307 - EarlyStopping counter: 6 out of 10
2025-02-18 13:01:13,994 - {'epoch': 40, 'rec_loss': '7.0952'}
2025-02-18 13:01:29,136 - {'Epoch': 40, 'HR@5': '0.0291', 'NDCG@5': '0.0187', 'HR@10': '0.0496', 'NDCG@10': '0.0253', 'HR@20': '0.0806', 'NDCG@20': '0.0330'}
2025-02-18 13:01:29,138 - EarlyStopping counter: 7 out of 10
2025-02-18 13:02:16,048 - {'epoch': 41, 'rec_loss': '7.0865'}
2025-02-18 13:02:30,982 - {'Epoch': 41, 'HR@5': '0.0293', 'NDCG@5': '0.0187', 'HR@10': '0.0496', 'NDCG@10': '0.0252', 'HR@20': '0.0808', 'NDCG@20': '0.0330'}
2025-02-18 13:02:30,986 - EarlyStopping counter: 8 out of 10
2025-02-18 13:03:18,315 - {'epoch': 42, 'rec_loss': '7.0815'}
2025-02-18 13:03:33,577 - {'Epoch': 42, 'HR@5': '0.0298', 'NDCG@5': '0.0188', 'HR@10': '0.0490', 'NDCG@10': '0.0250', 'HR@20': '0.0800', 'NDCG@20': '0.0328'}
2025-02-18 13:03:33,579 - EarlyStopping counter: 9 out of 10
2025-02-18 13:04:19,852 - {'epoch': 43, 'rec_loss': '7.0802'}
2025-02-18 13:04:34,860 - {'Epoch': 43, 'HR@5': '0.0303', 'NDCG@5': '0.0190', 'HR@10': '0.0495', 'NDCG@10': '0.0252', 'HR@20': '0.0815', 'NDCG@20': '0.0332'}
2025-02-18 13:04:34,861 - EarlyStopping counter: 10 out of 10
2025-02-18 13:04:34,861 - Early stopping
2025-02-18 13:04:34,861 - ---------------Test Score---------------
2025-02-18 13:04:50,111 - {'Epoch': 0, 'HR@5': '0.0283', 'NDCG@5': '0.0174', 'HR@10': '0.0478', 'NDCG@10': '0.0237', 'HR@20': '0.0768', 'NDCG@20': '0.0309'}
2025-02-18 13:04:50,112 - Scale_Yelp
2025-02-18 13:04:50,112 - {'Epoch': 0, 'HR@5': '0.0283', 'NDCG@5': '0.0174', 'HR@10': '0.0478', 'NDCG@10': '0.0237', 'HR@20': '0.0768', 'NDCG@20': '0.0309'}
2025-02-18 13:31:04,298 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-02-18 13:31:07,082 - HyperRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-18 13:31:07,087 - Total Parameters: 1437093
2025-02-18 13:31:54,036 - {'epoch': 0, 'rec_loss': '9.5354'}
2025-02-18 13:32:09,693 - {'Epoch': 0, 'HR@5': '0.0080', 'NDCG@5': '0.0053', 'HR@10': '0.0144', 'NDCG@10': '0.0074', 'HR@20': '0.0247', 'NDCG@20': '0.0100'}
2025-02-18 13:32:09,698 - Validation score increased.  Saving model ...
2025-02-18 13:32:55,240 - {'epoch': 1, 'rec_loss': '8.8578'}
2025-02-18 13:33:09,525 - {'Epoch': 1, 'HR@5': '0.0150', 'NDCG@5': '0.0093', 'HR@10': '0.0259', 'NDCG@10': '0.0128', 'HR@20': '0.0421', 'NDCG@20': '0.0168'}
2025-02-18 13:33:09,527 - Validation score increased.  Saving model ...
2025-02-18 13:33:55,102 - {'epoch': 2, 'rec_loss': '8.3936'}
2025-02-18 13:34:09,214 - {'Epoch': 2, 'HR@5': '0.0193', 'NDCG@5': '0.0119', 'HR@10': '0.0342', 'NDCG@10': '0.0166', 'HR@20': '0.0559', 'NDCG@20': '0.0221'}
2025-02-18 13:34:09,215 - Validation score increased.  Saving model ...
2025-02-18 13:34:54,055 - {'epoch': 3, 'rec_loss': '8.1065'}
2025-02-18 13:35:08,413 - {'Epoch': 3, 'HR@5': '0.0223', 'NDCG@5': '0.0136', 'HR@10': '0.0374', 'NDCG@10': '0.0184', 'HR@20': '0.0625', 'NDCG@20': '0.0247'}
2025-02-18 13:35:08,414 - Validation score increased.  Saving model ...
2025-02-18 13:35:55,754 - {'epoch': 4, 'rec_loss': '7.9252'}
2025-02-18 13:36:10,450 - {'Epoch': 4, 'HR@5': '0.0251', 'NDCG@5': '0.0158', 'HR@10': '0.0404', 'NDCG@10': '0.0207', 'HR@20': '0.0685', 'NDCG@20': '0.0277'}
2025-02-18 13:36:10,452 - Validation score increased.  Saving model ...
2025-02-18 13:36:54,991 - {'epoch': 5, 'rec_loss': '7.7889'}
2025-02-18 13:37:09,716 - {'Epoch': 5, 'HR@5': '0.0264', 'NDCG@5': '0.0166', 'HR@10': '0.0436', 'NDCG@10': '0.0221', 'HR@20': '0.0704', 'NDCG@20': '0.0288'}
2025-02-18 13:37:09,717 - Validation score increased.  Saving model ...
2025-02-18 13:37:56,067 - {'epoch': 6, 'rec_loss': '7.6841'}
2025-02-18 13:38:10,827 - {'Epoch': 6, 'HR@5': '0.0266', 'NDCG@5': '0.0166', 'HR@10': '0.0457', 'NDCG@10': '0.0228', 'HR@20': '0.0727', 'NDCG@20': '0.0296'}
2025-02-18 13:38:10,830 - Validation score increased.  Saving model ...
2025-02-18 13:38:56,451 - {'epoch': 7, 'rec_loss': '7.6033'}
2025-02-18 13:39:11,313 - {'Epoch': 7, 'HR@5': '0.0269', 'NDCG@5': '0.0167', 'HR@10': '0.0460', 'NDCG@10': '0.0227', 'HR@20': '0.0747', 'NDCG@20': '0.0299'}
2025-02-18 13:39:11,317 - Validation score increased.  Saving model ...
2025-02-18 13:39:57,807 - {'epoch': 8, 'rec_loss': '7.5389'}
2025-02-18 13:40:12,624 - {'Epoch': 8, 'HR@5': '0.0269', 'NDCG@5': '0.0169', 'HR@10': '0.0456', 'NDCG@10': '0.0229', 'HR@20': '0.0756', 'NDCG@20': '0.0305'}
2025-02-18 13:40:12,627 - Validation score increased.  Saving model ...
2025-02-18 13:40:58,967 - {'epoch': 9, 'rec_loss': '7.4874'}
2025-02-18 13:41:13,733 - {'Epoch': 9, 'HR@5': '0.0282', 'NDCG@5': '0.0174', 'HR@10': '0.0478', 'NDCG@10': '0.0236', 'HR@20': '0.0759', 'NDCG@20': '0.0307'}
2025-02-18 13:41:13,735 - Validation score increased.  Saving model ...
2025-02-18 13:42:01,291 - {'epoch': 10, 'rec_loss': '7.4438'}
2025-02-18 13:42:16,239 - {'Epoch': 10, 'HR@5': '0.0273', 'NDCG@5': '0.0174', 'HR@10': '0.0466', 'NDCG@10': '0.0235', 'HR@20': '0.0766', 'NDCG@20': '0.0310'}
2025-02-18 13:42:16,244 - Validation score increased.  Saving model ...
2025-02-18 13:43:02,001 - {'epoch': 11, 'rec_loss': '7.4024'}
2025-02-18 13:43:17,251 - {'Epoch': 11, 'HR@5': '0.0274', 'NDCG@5': '0.0170', 'HR@10': '0.0479', 'NDCG@10': '0.0235', 'HR@20': '0.0777', 'NDCG@20': '0.0311'}
2025-02-18 13:43:17,253 - Validation score increased.  Saving model ...
2025-02-18 13:44:05,087 - {'epoch': 12, 'rec_loss': '7.3728'}
2025-02-18 13:44:20,311 - {'Epoch': 12, 'HR@5': '0.0281', 'NDCG@5': '0.0178', 'HR@10': '0.0477', 'NDCG@10': '0.0241', 'HR@20': '0.0777', 'NDCG@20': '0.0316'}
2025-02-18 13:44:20,314 - Validation score increased.  Saving model ...
2025-02-18 13:45:06,336 - {'epoch': 13, 'rec_loss': '7.3414'}
2025-02-18 13:45:21,221 - {'Epoch': 13, 'HR@5': '0.0280', 'NDCG@5': '0.0171', 'HR@10': '0.0478', 'NDCG@10': '0.0234', 'HR@20': '0.0761', 'NDCG@20': '0.0305'}
2025-02-18 13:45:21,226 - EarlyStopping counter: 1 out of 10
2025-02-18 13:46:07,439 - {'epoch': 14, 'rec_loss': '7.3186'}
2025-02-18 13:46:22,308 - {'Epoch': 14, 'HR@5': '0.0280', 'NDCG@5': '0.0175', 'HR@10': '0.0463', 'NDCG@10': '0.0234', 'HR@20': '0.0763', 'NDCG@20': '0.0309'}
2025-02-18 13:46:22,310 - EarlyStopping counter: 2 out of 10
2025-02-18 13:47:06,857 - {'epoch': 15, 'rec_loss': '7.2993'}
2025-02-18 13:47:21,516 - {'Epoch': 15, 'HR@5': '0.0297', 'NDCG@5': '0.0181', 'HR@10': '0.0492', 'NDCG@10': '0.0243', 'HR@20': '0.0788', 'NDCG@20': '0.0318'}
2025-02-18 13:47:21,518 - Validation score increased.  Saving model ...
2025-02-18 13:48:07,697 - {'epoch': 16, 'rec_loss': '7.2730'}
2025-02-18 13:48:22,419 - {'Epoch': 16, 'HR@5': '0.0285', 'NDCG@5': '0.0178', 'HR@10': '0.0479', 'NDCG@10': '0.0240', 'HR@20': '0.0802', 'NDCG@20': '0.0321'}
2025-02-18 13:48:22,421 - Validation score increased.  Saving model ...
2025-02-18 13:49:09,227 - {'epoch': 17, 'rec_loss': '7.2507'}
2025-02-18 13:49:24,074 - {'Epoch': 17, 'HR@5': '0.0289', 'NDCG@5': '0.0180', 'HR@10': '0.0483', 'NDCG@10': '0.0242', 'HR@20': '0.0791', 'NDCG@20': '0.0319'}
2025-02-18 13:49:24,075 - EarlyStopping counter: 1 out of 10
2025-02-18 13:50:10,330 - {'epoch': 18, 'rec_loss': '7.2313'}
2025-02-18 13:50:25,310 - {'Epoch': 18, 'HR@5': '0.0288', 'NDCG@5': '0.0178', 'HR@10': '0.0480', 'NDCG@10': '0.0239', 'HR@20': '0.0800', 'NDCG@20': '0.0320'}
2025-02-18 13:50:25,311 - EarlyStopping counter: 2 out of 10
2025-02-18 13:51:11,633 - {'epoch': 19, 'rec_loss': '7.2155'}
2025-02-18 13:51:26,599 - {'Epoch': 19, 'HR@5': '0.0289', 'NDCG@5': '0.0182', 'HR@10': '0.0490', 'NDCG@10': '0.0247', 'HR@20': '0.0805', 'NDCG@20': '0.0326'}
2025-02-18 13:51:26,601 - Validation score increased.  Saving model ...
2025-02-18 13:52:13,982 - {'epoch': 20, 'rec_loss': '7.1987'}
2025-02-18 13:52:28,767 - {'Epoch': 20, 'HR@5': '0.0290', 'NDCG@5': '0.0183', 'HR@10': '0.0483', 'NDCG@10': '0.0244', 'HR@20': '0.0802', 'NDCG@20': '0.0324'}
2025-02-18 13:52:28,770 - EarlyStopping counter: 1 out of 10
2025-02-18 13:53:15,445 - {'epoch': 21, 'rec_loss': '7.1831'}
2025-02-18 13:53:30,175 - {'Epoch': 21, 'HR@5': '0.0291', 'NDCG@5': '0.0184', 'HR@10': '0.0493', 'NDCG@10': '0.0248', 'HR@20': '0.0813', 'NDCG@20': '0.0328'}
2025-02-18 13:53:30,177 - Validation score increased.  Saving model ...
2025-02-18 13:54:14,066 - {'epoch': 22, 'rec_loss': '7.1733'}
2025-02-18 13:54:28,901 - {'Epoch': 22, 'HR@5': '0.0291', 'NDCG@5': '0.0181', 'HR@10': '0.0492', 'NDCG@10': '0.0245', 'HR@20': '0.0806', 'NDCG@20': '0.0324'}
2025-02-18 13:54:28,902 - EarlyStopping counter: 1 out of 10
2025-02-18 13:55:14,437 - {'epoch': 23, 'rec_loss': '7.1558'}
2025-02-18 13:55:29,357 - {'Epoch': 23, 'HR@5': '0.0294', 'NDCG@5': '0.0187', 'HR@10': '0.0497', 'NDCG@10': '0.0253', 'HR@20': '0.0821', 'NDCG@20': '0.0334'}
2025-02-18 13:55:29,359 - Validation score increased.  Saving model ...
2025-02-18 13:56:16,238 - {'epoch': 24, 'rec_loss': '7.1468'}
2025-02-18 13:56:30,971 - {'Epoch': 24, 'HR@5': '0.0293', 'NDCG@5': '0.0187', 'HR@10': '0.0494', 'NDCG@10': '0.0252', 'HR@20': '0.0810', 'NDCG@20': '0.0331'}
2025-02-18 13:56:30,973 - EarlyStopping counter: 1 out of 10
2025-02-18 13:57:17,165 - {'epoch': 25, 'rec_loss': '7.1333'}
2025-02-18 13:57:32,092 - {'Epoch': 25, 'HR@5': '0.0289', 'NDCG@5': '0.0182', 'HR@10': '0.0484', 'NDCG@10': '0.0245', 'HR@20': '0.0803', 'NDCG@20': '0.0325'}
2025-02-18 13:57:32,094 - EarlyStopping counter: 2 out of 10
2025-02-18 13:58:18,366 - {'epoch': 26, 'rec_loss': '7.1235'}
2025-02-18 13:58:33,104 - {'Epoch': 26, 'HR@5': '0.0307', 'NDCG@5': '0.0191', 'HR@10': '0.0489', 'NDCG@10': '0.0249', 'HR@20': '0.0793', 'NDCG@20': '0.0326'}
2025-02-18 13:58:33,105 - EarlyStopping counter: 3 out of 10
2025-02-18 13:59:20,782 - {'epoch': 27, 'rec_loss': '7.1123'}
2025-02-18 13:59:35,658 - {'Epoch': 27, 'HR@5': '0.0297', 'NDCG@5': '0.0186', 'HR@10': '0.0494', 'NDCG@10': '0.0249', 'HR@20': '0.0805', 'NDCG@20': '0.0327'}
2025-02-18 13:59:35,663 - EarlyStopping counter: 4 out of 10
2025-02-18 14:00:21,997 - {'epoch': 28, 'rec_loss': '7.1043'}
2025-02-18 14:00:36,928 - {'Epoch': 28, 'HR@5': '0.0296', 'NDCG@5': '0.0187', 'HR@10': '0.0491', 'NDCG@10': '0.0250', 'HR@20': '0.0797', 'NDCG@20': '0.0327'}
2025-02-18 14:00:36,930 - EarlyStopping counter: 5 out of 10
2025-02-18 14:01:23,222 - {'epoch': 29, 'rec_loss': '7.0919'}
2025-02-18 14:01:37,995 - {'Epoch': 29, 'HR@5': '0.0298', 'NDCG@5': '0.0185', 'HR@10': '0.0501', 'NDCG@10': '0.0250', 'HR@20': '0.0809', 'NDCG@20': '0.0327'}
2025-02-18 14:01:37,996 - EarlyStopping counter: 6 out of 10
2025-02-18 14:02:22,975 - {'epoch': 30, 'rec_loss': '7.0793'}
2025-02-18 14:02:37,945 - {'Epoch': 30, 'HR@5': '0.0292', 'NDCG@5': '0.0184', 'HR@10': '0.0501', 'NDCG@10': '0.0251', 'HR@20': '0.0800', 'NDCG@20': '0.0326'}
2025-02-18 14:02:37,946 - EarlyStopping counter: 7 out of 10
2025-02-18 14:03:27,913 - {'epoch': 31, 'rec_loss': '7.0717'}
2025-02-18 14:03:42,904 - {'Epoch': 31, 'HR@5': '0.0296', 'NDCG@5': '0.0184', 'HR@10': '0.0491', 'NDCG@10': '0.0247', 'HR@20': '0.0818', 'NDCG@20': '0.0329'}
2025-02-18 14:03:42,905 - EarlyStopping counter: 8 out of 10
2025-02-18 14:04:31,708 - {'epoch': 32, 'rec_loss': '7.0662'}
2025-02-18 14:04:46,448 - {'Epoch': 32, 'HR@5': '0.0293', 'NDCG@5': '0.0181', 'HR@10': '0.0494', 'NDCG@10': '0.0245', 'HR@20': '0.0807', 'NDCG@20': '0.0323'}
2025-02-18 14:04:46,453 - EarlyStopping counter: 9 out of 10
2025-02-18 14:05:33,125 - {'epoch': 33, 'rec_loss': '7.0581'}
2025-02-18 14:05:48,247 - {'Epoch': 33, 'HR@5': '0.0302', 'NDCG@5': '0.0190', 'HR@10': '0.0506', 'NDCG@10': '0.0255', 'HR@20': '0.0819', 'NDCG@20': '0.0334'}
2025-02-18 14:05:48,249 - EarlyStopping counter: 10 out of 10
2025-02-18 14:05:48,249 - Early stopping
2025-02-18 14:05:48,249 - ---------------Test Score---------------
2025-02-18 14:06:03,354 - {'Epoch': 0, 'HR@5': '0.0260', 'NDCG@5': '0.0165', 'HR@10': '0.0440', 'NDCG@10': '0.0222', 'HR@20': '0.0734', 'NDCG@20': '0.0296'}
2025-02-18 14:06:03,356 - Scale_Yelp
2025-02-18 14:06:03,356 - {'Epoch': 0, 'HR@5': '0.0260', 'NDCG@5': '0.0165', 'HR@10': '0.0440', 'NDCG@10': '0.0222', 'HR@20': '0.0734', 'NDCG@20': '0.0296'}
2025-02-18 14:07:16,363 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-02-18 14:07:19,128 - HyperRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-18 14:07:19,133 - Total Parameters: 1437093
2025-02-18 14:08:06,133 - {'epoch': 0, 'rec_loss': '9.5545'}
2025-02-18 14:08:21,800 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0055', 'HR@10': '0.0133', 'NDCG@10': '0.0071', 'HR@20': '0.0249', 'NDCG@20': '0.0100'}
2025-02-18 14:08:21,801 - Validation score increased.  Saving model ...
2025-02-18 14:09:06,743 - {'epoch': 1, 'rec_loss': '8.9691'}
2025-02-18 14:09:20,865 - {'Epoch': 1, 'HR@5': '0.0129', 'NDCG@5': '0.0081', 'HR@10': '0.0213', 'NDCG@10': '0.0108', 'HR@20': '0.0370', 'NDCG@20': '0.0147'}
2025-02-18 14:09:20,867 - Validation score increased.  Saving model ...
2025-02-18 14:10:05,566 - {'epoch': 2, 'rec_loss': '8.5640'}
2025-02-18 14:10:20,182 - {'Epoch': 2, 'HR@5': '0.0176', 'NDCG@5': '0.0108', 'HR@10': '0.0306', 'NDCG@10': '0.0150', 'HR@20': '0.0513', 'NDCG@20': '0.0202'}
2025-02-18 14:10:20,184 - Validation score increased.  Saving model ...
2025-02-18 14:11:05,368 - {'epoch': 3, 'rec_loss': '8.2796'}
2025-02-18 14:11:19,724 - {'Epoch': 3, 'HR@5': '0.0208', 'NDCG@5': '0.0125', 'HR@10': '0.0352', 'NDCG@10': '0.0171', 'HR@20': '0.0578', 'NDCG@20': '0.0228'}
2025-02-18 14:11:19,725 - Validation score increased.  Saving model ...
2025-02-18 14:12:05,805 - {'epoch': 4, 'rec_loss': '8.1003'}
2025-02-18 14:12:20,278 - {'Epoch': 4, 'HR@5': '0.0219', 'NDCG@5': '0.0139', 'HR@10': '0.0376', 'NDCG@10': '0.0190', 'HR@20': '0.0656', 'NDCG@20': '0.0260'}
2025-02-18 14:12:20,279 - Validation score increased.  Saving model ...
2025-02-18 14:13:04,811 - {'epoch': 5, 'rec_loss': '7.9673'}
2025-02-18 14:13:19,358 - {'Epoch': 5, 'HR@5': '0.0247', 'NDCG@5': '0.0153', 'HR@10': '0.0426', 'NDCG@10': '0.0211', 'HR@20': '0.0686', 'NDCG@20': '0.0276'}
2025-02-18 14:13:19,360 - Validation score increased.  Saving model ...
2025-02-18 14:14:04,379 - {'epoch': 6, 'rec_loss': '7.8677'}
2025-02-18 14:14:19,065 - {'Epoch': 6, 'HR@5': '0.0257', 'NDCG@5': '0.0160', 'HR@10': '0.0436', 'NDCG@10': '0.0218', 'HR@20': '0.0728', 'NDCG@20': '0.0291'}
2025-02-18 14:14:19,066 - Validation score increased.  Saving model ...
2025-02-18 14:15:03,371 - {'epoch': 7, 'rec_loss': '7.7890'}
2025-02-18 14:15:18,138 - {'Epoch': 7, 'HR@5': '0.0252', 'NDCG@5': '0.0157', 'HR@10': '0.0448', 'NDCG@10': '0.0219', 'HR@20': '0.0745', 'NDCG@20': '0.0294'}
2025-02-18 14:15:18,142 - Validation score increased.  Saving model ...
2025-02-18 14:16:03,183 - {'epoch': 8, 'rec_loss': '7.7205'}
2025-02-18 14:16:18,004 - {'Epoch': 8, 'HR@5': '0.0275', 'NDCG@5': '0.0169', 'HR@10': '0.0457', 'NDCG@10': '0.0228', 'HR@20': '0.0745', 'NDCG@20': '0.0300'}
2025-02-18 14:16:18,010 - Validation score increased.  Saving model ...
2025-02-18 14:17:01,503 - {'epoch': 9, 'rec_loss': '7.6718'}
2025-02-18 14:17:16,289 - {'Epoch': 9, 'HR@5': '0.0283', 'NDCG@5': '0.0176', 'HR@10': '0.0472', 'NDCG@10': '0.0236', 'HR@20': '0.0772', 'NDCG@20': '0.0311'}
2025-02-18 14:17:16,291 - Validation score increased.  Saving model ...
2025-02-18 14:18:01,837 - {'epoch': 10, 'rec_loss': '7.6237'}
2025-02-18 14:18:16,792 - {'Epoch': 10, 'HR@5': '0.0277', 'NDCG@5': '0.0176', 'HR@10': '0.0470', 'NDCG@10': '0.0238', 'HR@20': '0.0791', 'NDCG@20': '0.0319'}
2025-02-18 14:18:16,793 - Validation score increased.  Saving model ...
2025-02-18 14:19:02,484 - {'epoch': 11, 'rec_loss': '7.5854'}
2025-02-18 14:19:17,333 - {'Epoch': 11, 'HR@5': '0.0289', 'NDCG@5': '0.0179', 'HR@10': '0.0497', 'NDCG@10': '0.0245', 'HR@20': '0.0798', 'NDCG@20': '0.0321'}
2025-02-18 14:19:17,337 - Validation score increased.  Saving model ...
2025-02-18 14:20:02,848 - {'epoch': 12, 'rec_loss': '7.5537'}
2025-02-18 14:20:17,961 - {'Epoch': 12, 'HR@5': '0.0300', 'NDCG@5': '0.0186', 'HR@10': '0.0497', 'NDCG@10': '0.0249', 'HR@20': '0.0790', 'NDCG@20': '0.0323'}
2025-02-18 14:20:17,963 - Validation score increased.  Saving model ...
2025-02-18 14:21:02,185 - {'epoch': 13, 'rec_loss': '7.5215'}
2025-02-18 14:21:16,960 - {'Epoch': 13, 'HR@5': '0.0294', 'NDCG@5': '0.0182', 'HR@10': '0.0501', 'NDCG@10': '0.0249', 'HR@20': '0.0793', 'NDCG@20': '0.0322'}
2025-02-18 14:21:16,961 - EarlyStopping counter: 1 out of 10
2025-02-18 14:22:01,687 - {'epoch': 14, 'rec_loss': '7.4955'}
2025-02-18 14:22:16,586 - {'Epoch': 14, 'HR@5': '0.0295', 'NDCG@5': '0.0186', 'HR@10': '0.0490', 'NDCG@10': '0.0248', 'HR@20': '0.0802', 'NDCG@20': '0.0326'}
2025-02-18 14:22:16,588 - Validation score increased.  Saving model ...
2025-02-18 14:23:02,053 - {'epoch': 15, 'rec_loss': '7.4719'}
2025-02-18 14:23:16,836 - {'Epoch': 15, 'HR@5': '0.0308', 'NDCG@5': '0.0187', 'HR@10': '0.0501', 'NDCG@10': '0.0250', 'HR@20': '0.0806', 'NDCG@20': '0.0326'}
2025-02-18 14:23:16,840 - EarlyStopping counter: 1 out of 10
2025-02-18 14:24:01,147 - {'epoch': 16, 'rec_loss': '7.4481'}
2025-02-18 14:24:16,099 - {'Epoch': 16, 'HR@5': '0.0302', 'NDCG@5': '0.0186', 'HR@10': '0.0502', 'NDCG@10': '0.0250', 'HR@20': '0.0810', 'NDCG@20': '0.0328'}
2025-02-18 14:24:16,100 - Validation score increased.  Saving model ...
2025-02-18 14:25:00,620 - {'epoch': 17, 'rec_loss': '7.4266'}
2025-02-18 14:25:15,610 - {'Epoch': 17, 'HR@5': '0.0311', 'NDCG@5': '0.0193', 'HR@10': '0.0500', 'NDCG@10': '0.0254', 'HR@20': '0.0819', 'NDCG@20': '0.0334'}
2025-02-18 14:25:15,612 - Validation score increased.  Saving model ...
2025-02-18 14:26:00,045 - {'epoch': 18, 'rec_loss': '7.4032'}
2025-02-18 14:26:14,940 - {'Epoch': 18, 'HR@5': '0.0304', 'NDCG@5': '0.0191', 'HR@10': '0.0503', 'NDCG@10': '0.0255', 'HR@20': '0.0819', 'NDCG@20': '0.0334'}
2025-02-18 14:26:14,944 - Validation score increased.  Saving model ...
2025-02-18 14:27:00,181 - {'epoch': 19, 'rec_loss': '7.3885'}
2025-02-18 14:27:15,227 - {'Epoch': 19, 'HR@5': '0.0306', 'NDCG@5': '0.0190', 'HR@10': '0.0509', 'NDCG@10': '0.0256', 'HR@20': '0.0818', 'NDCG@20': '0.0333'}
2025-02-18 14:27:15,229 - EarlyStopping counter: 1 out of 10
2025-02-18 14:27:59,441 - {'epoch': 20, 'rec_loss': '7.3726'}
2025-02-18 14:28:14,530 - {'Epoch': 20, 'HR@5': '0.0302', 'NDCG@5': '0.0189', 'HR@10': '0.0503', 'NDCG@10': '0.0254', 'HR@20': '0.0819', 'NDCG@20': '0.0333'}
2025-02-18 14:28:14,532 - EarlyStopping counter: 2 out of 10
2025-02-18 14:29:00,271 - {'epoch': 21, 'rec_loss': '7.3625'}
2025-02-18 14:29:15,338 - {'Epoch': 21, 'HR@5': '0.0299', 'NDCG@5': '0.0189', 'HR@10': '0.0517', 'NDCG@10': '0.0259', 'HR@20': '0.0821', 'NDCG@20': '0.0336'}
2025-02-18 14:29:15,339 - Validation score increased.  Saving model ...
2025-02-18 14:30:00,295 - {'epoch': 22, 'rec_loss': '7.3468'}
2025-02-18 14:30:15,170 - {'Epoch': 22, 'HR@5': '0.0296', 'NDCG@5': '0.0183', 'HR@10': '0.0507', 'NDCG@10': '0.0251', 'HR@20': '0.0824', 'NDCG@20': '0.0331'}
2025-02-18 14:30:15,171 - EarlyStopping counter: 1 out of 10
2025-02-18 14:31:00,338 - {'epoch': 23, 'rec_loss': '7.3271'}
2025-02-18 14:31:15,664 - {'Epoch': 23, 'HR@5': '0.0310', 'NDCG@5': '0.0191', 'HR@10': '0.0514', 'NDCG@10': '0.0257', 'HR@20': '0.0839', 'NDCG@20': '0.0338'}
2025-02-18 14:31:15,665 - Validation score increased.  Saving model ...
2025-02-18 14:31:58,925 - {'epoch': 24, 'rec_loss': '7.3177'}
2025-02-18 14:32:13,865 - {'Epoch': 24, 'HR@5': '0.0318', 'NDCG@5': '0.0197', 'HR@10': '0.0520', 'NDCG@10': '0.0262', 'HR@20': '0.0822', 'NDCG@20': '0.0338'}
2025-02-18 14:32:13,867 - EarlyStopping counter: 1 out of 10
2025-02-18 14:32:58,616 - {'epoch': 25, 'rec_loss': '7.3038'}
2025-02-18 14:33:14,399 - {'Epoch': 25, 'HR@5': '0.0306', 'NDCG@5': '0.0194', 'HR@10': '0.0508', 'NDCG@10': '0.0259', 'HR@20': '0.0831', 'NDCG@20': '0.0341'}
2025-02-18 14:33:14,401 - Validation score increased.  Saving model ...
2025-02-18 14:34:00,087 - {'epoch': 26, 'rec_loss': '7.2950'}
2025-02-18 14:34:15,313 - {'Epoch': 26, 'HR@5': '0.0310', 'NDCG@5': '0.0194', 'HR@10': '0.0516', 'NDCG@10': '0.0260', 'HR@20': '0.0822', 'NDCG@20': '0.0337'}
2025-02-18 14:34:15,315 - EarlyStopping counter: 1 out of 10
2025-02-18 14:35:00,095 - {'epoch': 27, 'rec_loss': '7.2849'}
2025-02-18 14:35:15,052 - {'Epoch': 27, 'HR@5': '0.0317', 'NDCG@5': '0.0199', 'HR@10': '0.0518', 'NDCG@10': '0.0263', 'HR@20': '0.0825', 'NDCG@20': '0.0340'}
2025-02-18 14:35:15,053 - EarlyStopping counter: 2 out of 10
2025-02-18 14:35:59,506 - {'epoch': 28, 'rec_loss': '7.2748'}
2025-02-18 14:36:14,453 - {'Epoch': 28, 'HR@5': '0.0315', 'NDCG@5': '0.0197', 'HR@10': '0.0519', 'NDCG@10': '0.0263', 'HR@20': '0.0817', 'NDCG@20': '0.0337'}
2025-02-18 14:36:14,455 - EarlyStopping counter: 3 out of 10
2025-02-18 14:36:59,738 - {'epoch': 29, 'rec_loss': '7.2656'}
2025-02-18 14:37:14,693 - {'Epoch': 29, 'HR@5': '0.0307', 'NDCG@5': '0.0193', 'HR@10': '0.0508', 'NDCG@10': '0.0258', 'HR@20': '0.0819', 'NDCG@20': '0.0335'}
2025-02-18 14:37:14,695 - EarlyStopping counter: 4 out of 10
2025-02-18 14:38:00,124 - {'epoch': 30, 'rec_loss': '7.2561'}
2025-02-18 14:38:15,051 - {'Epoch': 30, 'HR@5': '0.0317', 'NDCG@5': '0.0202', 'HR@10': '0.0517', 'NDCG@10': '0.0266', 'HR@20': '0.0826', 'NDCG@20': '0.0344'}
2025-02-18 14:38:15,056 - Validation score increased.  Saving model ...
2025-02-18 14:38:58,530 - {'epoch': 31, 'rec_loss': '7.2464'}
2025-02-18 14:39:13,619 - {'Epoch': 31, 'HR@5': '0.0313', 'NDCG@5': '0.0195', 'HR@10': '0.0516', 'NDCG@10': '0.0260', 'HR@20': '0.0829', 'NDCG@20': '0.0339'}
2025-02-18 14:39:13,621 - EarlyStopping counter: 1 out of 10
2025-02-18 14:39:58,579 - {'epoch': 32, 'rec_loss': '7.2395'}
2025-02-18 14:40:13,967 - {'Epoch': 32, 'HR@5': '0.0306', 'NDCG@5': '0.0191', 'HR@10': '0.0521', 'NDCG@10': '0.0259', 'HR@20': '0.0825', 'NDCG@20': '0.0336'}
2025-02-18 14:40:13,968 - EarlyStopping counter: 2 out of 10
2025-02-18 14:40:59,269 - {'epoch': 33, 'rec_loss': '7.2333'}
2025-02-18 14:41:14,311 - {'Epoch': 33, 'HR@5': '0.0322', 'NDCG@5': '0.0202', 'HR@10': '0.0529', 'NDCG@10': '0.0268', 'HR@20': '0.0847', 'NDCG@20': '0.0348'}
2025-02-18 14:41:14,312 - Validation score increased.  Saving model ...
2025-02-18 14:41:58,987 - {'epoch': 34, 'rec_loss': '7.2259'}
2025-02-18 14:42:15,878 - {'Epoch': 34, 'HR@5': '0.0318', 'NDCG@5': '0.0196', 'HR@10': '0.0528', 'NDCG@10': '0.0263', 'HR@20': '0.0832', 'NDCG@20': '0.0339'}
2025-02-18 14:42:15,879 - EarlyStopping counter: 1 out of 10
2025-02-18 14:43:00,346 - {'epoch': 35, 'rec_loss': '7.2212'}
2025-02-18 14:43:15,861 - {'Epoch': 35, 'HR@5': '0.0299', 'NDCG@5': '0.0185', 'HR@10': '0.0502', 'NDCG@10': '0.0251', 'HR@20': '0.0815', 'NDCG@20': '0.0329'}
2025-02-18 14:43:15,862 - EarlyStopping counter: 2 out of 10
2025-02-18 14:44:01,040 - {'epoch': 36, 'rec_loss': '7.2140'}
2025-02-18 14:44:16,090 - {'Epoch': 36, 'HR@5': '0.0309', 'NDCG@5': '0.0193', 'HR@10': '0.0513', 'NDCG@10': '0.0258', 'HR@20': '0.0819', 'NDCG@20': '0.0335'}
2025-02-18 14:44:16,092 - EarlyStopping counter: 3 out of 10
2025-02-18 14:45:02,238 - {'epoch': 37, 'rec_loss': '7.2065'}
2025-02-18 14:45:17,138 - {'Epoch': 37, 'HR@5': '0.0315', 'NDCG@5': '0.0201', 'HR@10': '0.0514', 'NDCG@10': '0.0264', 'HR@20': '0.0821', 'NDCG@20': '0.0341'}
2025-02-18 14:45:17,139 - EarlyStopping counter: 4 out of 10
2025-02-18 14:46:00,835 - {'epoch': 38, 'rec_loss': '7.1950'}
2025-02-18 14:46:15,660 - {'Epoch': 38, 'HR@5': '0.0317', 'NDCG@5': '0.0200', 'HR@10': '0.0514', 'NDCG@10': '0.0263', 'HR@20': '0.0830', 'NDCG@20': '0.0342'}
2025-02-18 14:46:15,661 - EarlyStopping counter: 5 out of 10
2025-02-18 14:47:00,915 - {'epoch': 39, 'rec_loss': '7.1877'}
2025-02-18 14:47:15,696 - {'Epoch': 39, 'HR@5': '0.0318', 'NDCG@5': '0.0200', 'HR@10': '0.0503', 'NDCG@10': '0.0259', 'HR@20': '0.0832', 'NDCG@20': '0.0342'}
2025-02-18 14:47:15,703 - EarlyStopping counter: 6 out of 10
2025-02-18 14:48:02,991 - {'epoch': 40, 'rec_loss': '7.1918'}
2025-02-18 14:48:19,002 - {'Epoch': 40, 'HR@5': '0.0309', 'NDCG@5': '0.0193', 'HR@10': '0.0510', 'NDCG@10': '0.0258', 'HR@20': '0.0818', 'NDCG@20': '0.0335'}
2025-02-18 14:48:19,004 - EarlyStopping counter: 7 out of 10
2025-02-18 14:49:18,558 - {'epoch': 41, 'rec_loss': '7.1815'}
2025-02-18 14:49:36,797 - {'Epoch': 41, 'HR@5': '0.0313', 'NDCG@5': '0.0195', 'HR@10': '0.0509', 'NDCG@10': '0.0258', 'HR@20': '0.0831', 'NDCG@20': '0.0339'}
2025-02-18 14:49:36,799 - EarlyStopping counter: 8 out of 10
2025-02-18 14:50:36,318 - {'epoch': 42, 'rec_loss': '7.1767'}
2025-02-18 14:50:53,053 - {'Epoch': 42, 'HR@5': '0.0312', 'NDCG@5': '0.0199', 'HR@10': '0.0497', 'NDCG@10': '0.0258', 'HR@20': '0.0816', 'NDCG@20': '0.0338'}
2025-02-18 14:50:53,059 - EarlyStopping counter: 9 out of 10
2025-02-18 14:51:53,827 - {'epoch': 43, 'rec_loss': '7.1727'}
2025-02-18 14:52:11,277 - {'Epoch': 43, 'HR@5': '0.0308', 'NDCG@5': '0.0191', 'HR@10': '0.0509', 'NDCG@10': '0.0256', 'HR@20': '0.0818', 'NDCG@20': '0.0333'}
2025-02-18 14:52:11,286 - EarlyStopping counter: 10 out of 10
2025-02-18 14:52:11,286 - Early stopping
2025-02-18 14:52:11,286 - ---------------Test Score---------------
2025-02-18 14:52:27,798 - {'Epoch': 0, 'HR@5': '0.0285', 'NDCG@5': '0.0177', 'HR@10': '0.0493', 'NDCG@10': '0.0244', 'HR@20': '0.0777', 'NDCG@20': '0.0315'}
2025-02-18 14:52:27,800 - Scale_Yelp
2025-02-18 14:52:27,800 - {'Epoch': 0, 'HR@5': '0.0285', 'NDCG@5': '0.0177', 'HR@10': '0.0493', 'NDCG@10': '0.0244', 'HR@20': '0.0777', 'NDCG@20': '0.0315'}
2025-02-25 12:19:23,217 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-02-25 12:19:25,987 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-25 12:19:25,992 - Total Parameters: 1436118
2025-02-25 12:20:12,624 - {'epoch': 0, 'rec_loss': '9.5372'}
2025-02-25 12:20:27,888 - {'Epoch': 0, 'HR@5': '0.0099', 'NDCG@5': '0.0061', 'HR@10': '0.0152', 'NDCG@10': '0.0078', 'HR@20': '0.0259', 'NDCG@20': '0.0105'}
2025-02-25 12:20:27,890 - Validation score increased.  Saving model ...
2025-02-25 12:21:11,676 - {'epoch': 1, 'rec_loss': '8.8643'}
2025-02-25 12:21:29,181 - {'Epoch': 1, 'HR@5': '0.0154', 'NDCG@5': '0.0096', 'HR@10': '0.0261', 'NDCG@10': '0.0130', 'HR@20': '0.0432', 'NDCG@20': '0.0173'}
2025-02-25 12:21:29,185 - Validation score increased.  Saving model ...
2025-02-25 12:22:18,750 - {'epoch': 2, 'rec_loss': '8.4039'}
2025-02-25 12:22:35,446 - {'Epoch': 2, 'HR@5': '0.0205', 'NDCG@5': '0.0126', 'HR@10': '0.0352', 'NDCG@10': '0.0173', 'HR@20': '0.0572', 'NDCG@20': '0.0228'}
2025-02-25 12:22:35,450 - Validation score increased.  Saving model ...
2025-02-25 12:23:17,739 - {'epoch': 3, 'rec_loss': '8.1426'}
2025-02-25 12:23:32,476 - {'Epoch': 3, 'HR@5': '0.0238', 'NDCG@5': '0.0148', 'HR@10': '0.0401', 'NDCG@10': '0.0200', 'HR@20': '0.0646', 'NDCG@20': '0.0261'}
2025-02-25 12:23:32,480 - Validation score increased.  Saving model ...
2025-02-25 12:24:20,368 - {'epoch': 4, 'rec_loss': '7.9665'}
2025-02-25 12:24:38,101 - {'Epoch': 4, 'HR@5': '0.0237', 'NDCG@5': '0.0149', 'HR@10': '0.0408', 'NDCG@10': '0.0204', 'HR@20': '0.0666', 'NDCG@20': '0.0269'}
2025-02-25 12:24:38,105 - Validation score increased.  Saving model ...
2025-02-25 12:25:22,858 - {'epoch': 5, 'rec_loss': '7.8420'}
2025-02-25 12:25:37,607 - {'Epoch': 5, 'HR@5': '0.0263', 'NDCG@5': '0.0166', 'HR@10': '0.0430', 'NDCG@10': '0.0219', 'HR@20': '0.0707', 'NDCG@20': '0.0289'}
2025-02-25 12:25:37,611 - Validation score increased.  Saving model ...
2025-02-25 12:26:23,672 - {'epoch': 6, 'rec_loss': '7.7450'}
2025-02-25 12:26:40,215 - {'Epoch': 6, 'HR@5': '0.0256', 'NDCG@5': '0.0158', 'HR@10': '0.0444', 'NDCG@10': '0.0218', 'HR@20': '0.0717', 'NDCG@20': '0.0287'}
2025-02-25 12:26:40,217 - EarlyStopping counter: 1 out of 10
2025-02-25 12:27:23,055 - {'epoch': 7, 'rec_loss': '7.6673'}
2025-02-25 12:27:38,091 - {'Epoch': 7, 'HR@5': '0.0269', 'NDCG@5': '0.0167', 'HR@10': '0.0440', 'NDCG@10': '0.0221', 'HR@20': '0.0727', 'NDCG@20': '0.0294'}
2025-02-25 12:27:38,094 - Validation score increased.  Saving model ...
2025-02-25 12:28:23,804 - {'epoch': 8, 'rec_loss': '7.6042'}
2025-02-25 12:28:38,931 - {'Epoch': 8, 'HR@5': '0.0271', 'NDCG@5': '0.0171', 'HR@10': '0.0461', 'NDCG@10': '0.0232', 'HR@20': '0.0747', 'NDCG@20': '0.0304'}
2025-02-25 12:28:38,935 - Validation score increased.  Saving model ...
2025-02-25 12:29:24,623 - {'epoch': 9, 'rec_loss': '7.5527'}
2025-02-25 12:29:40,608 - {'Epoch': 9, 'HR@5': '0.0267', 'NDCG@5': '0.0168', 'HR@10': '0.0462', 'NDCG@10': '0.0231', 'HR@20': '0.0748', 'NDCG@20': '0.0303'}
2025-02-25 12:29:40,612 - EarlyStopping counter: 1 out of 10
2025-02-25 12:30:24,169 - {'epoch': 10, 'rec_loss': '7.5122'}
2025-02-25 12:30:39,187 - {'Epoch': 10, 'HR@5': '0.0289', 'NDCG@5': '0.0185', 'HR@10': '0.0486', 'NDCG@10': '0.0248', 'HR@20': '0.0760', 'NDCG@20': '0.0317'}
2025-02-25 12:30:39,191 - Validation score increased.  Saving model ...
2025-02-25 12:31:23,112 - {'epoch': 11, 'rec_loss': '7.4672'}
2025-02-25 12:31:38,401 - {'Epoch': 11, 'HR@5': '0.0281', 'NDCG@5': '0.0176', 'HR@10': '0.0476', 'NDCG@10': '0.0239', 'HR@20': '0.0752', 'NDCG@20': '0.0308'}
2025-02-25 12:31:38,405 - EarlyStopping counter: 1 out of 10
2025-02-25 12:32:20,701 - {'epoch': 12, 'rec_loss': '7.4362'}
2025-02-25 12:32:36,793 - {'Epoch': 12, 'HR@5': '0.0283', 'NDCG@5': '0.0178', 'HR@10': '0.0478', 'NDCG@10': '0.0241', 'HR@20': '0.0773', 'NDCG@20': '0.0315'}
2025-02-25 12:32:36,798 - EarlyStopping counter: 2 out of 10
2025-02-25 12:33:19,770 - {'epoch': 13, 'rec_loss': '7.4092'}
2025-02-25 12:33:36,881 - {'Epoch': 13, 'HR@5': '0.0292', 'NDCG@5': '0.0185', 'HR@10': '0.0481', 'NDCG@10': '0.0245', 'HR@20': '0.0779', 'NDCG@20': '0.0320'}
2025-02-25 12:33:36,886 - Validation score increased.  Saving model ...
2025-02-25 12:34:18,339 - {'epoch': 14, 'rec_loss': '7.3734'}
2025-02-25 12:34:35,808 - {'Epoch': 14, 'HR@5': '0.0278', 'NDCG@5': '0.0175', 'HR@10': '0.0477', 'NDCG@10': '0.0239', 'HR@20': '0.0772', 'NDCG@20': '0.0313'}
2025-02-25 12:34:35,812 - EarlyStopping counter: 1 out of 10
2025-02-25 12:35:17,282 - {'epoch': 15, 'rec_loss': '7.3520'}
2025-02-25 12:35:33,440 - {'Epoch': 15, 'HR@5': '0.0290', 'NDCG@5': '0.0179', 'HR@10': '0.0488', 'NDCG@10': '0.0243', 'HR@20': '0.0782', 'NDCG@20': '0.0316'}
2025-02-25 12:35:33,444 - EarlyStopping counter: 2 out of 10
2025-02-25 12:36:15,519 - {'epoch': 16, 'rec_loss': '7.3285'}
2025-02-25 12:36:31,670 - {'Epoch': 16, 'HR@5': '0.0298', 'NDCG@5': '0.0187', 'HR@10': '0.0488', 'NDCG@10': '0.0248', 'HR@20': '0.0778', 'NDCG@20': '0.0321'}
2025-02-25 12:36:31,675 - Validation score increased.  Saving model ...
2025-02-25 12:37:13,082 - {'epoch': 17, 'rec_loss': '7.3092'}
2025-02-25 12:37:30,640 - {'Epoch': 17, 'HR@5': '0.0298', 'NDCG@5': '0.0187', 'HR@10': '0.0477', 'NDCG@10': '0.0245', 'HR@20': '0.0798', 'NDCG@20': '0.0325'}
2025-02-25 12:37:30,641 - Validation score increased.  Saving model ...
2025-02-25 12:38:13,740 - {'epoch': 18, 'rec_loss': '7.2894'}
2025-02-25 12:38:31,447 - {'Epoch': 18, 'HR@5': '0.0294', 'NDCG@5': '0.0189', 'HR@10': '0.0492', 'NDCG@10': '0.0253', 'HR@20': '0.0781', 'NDCG@20': '0.0326'}
2025-02-25 12:38:31,451 - Validation score increased.  Saving model ...
2025-02-25 12:39:13,818 - {'epoch': 19, 'rec_loss': '7.2692'}
2025-02-25 12:39:29,150 - {'Epoch': 19, 'HR@5': '0.0297', 'NDCG@5': '0.0188', 'HR@10': '0.0489', 'NDCG@10': '0.0250', 'HR@20': '0.0790', 'NDCG@20': '0.0325'}
2025-02-25 12:39:29,154 - EarlyStopping counter: 1 out of 10
2025-02-25 12:40:14,033 - {'epoch': 20, 'rec_loss': '7.2504'}
2025-02-25 12:40:29,223 - {'Epoch': 20, 'HR@5': '0.0306', 'NDCG@5': '0.0194', 'HR@10': '0.0506', 'NDCG@10': '0.0259', 'HR@20': '0.0801', 'NDCG@20': '0.0332'}
2025-02-25 12:40:29,225 - Validation score increased.  Saving model ...
2025-02-25 12:41:13,684 - {'epoch': 21, 'rec_loss': '7.2340'}
2025-02-25 12:41:29,260 - {'Epoch': 21, 'HR@5': '0.0292', 'NDCG@5': '0.0187', 'HR@10': '0.0498', 'NDCG@10': '0.0253', 'HR@20': '0.0786', 'NDCG@20': '0.0325'}
2025-02-25 12:41:29,264 - EarlyStopping counter: 1 out of 10
2025-02-25 12:42:10,693 - {'epoch': 22, 'rec_loss': '7.2171'}
2025-02-25 12:42:28,206 - {'Epoch': 22, 'HR@5': '0.0301', 'NDCG@5': '0.0190', 'HR@10': '0.0495', 'NDCG@10': '0.0253', 'HR@20': '0.0793', 'NDCG@20': '0.0327'}
2025-02-25 12:42:28,208 - EarlyStopping counter: 2 out of 10
2025-02-25 12:43:09,589 - {'epoch': 23, 'rec_loss': '7.2059'}
2025-02-25 12:43:27,259 - {'Epoch': 23, 'HR@5': '0.0290', 'NDCG@5': '0.0183', 'HR@10': '0.0482', 'NDCG@10': '0.0245', 'HR@20': '0.0790', 'NDCG@20': '0.0322'}
2025-02-25 12:43:27,263 - EarlyStopping counter: 3 out of 10
2025-02-25 12:44:08,967 - {'epoch': 24, 'rec_loss': '7.1917'}
2025-02-25 12:44:26,672 - {'Epoch': 24, 'HR@5': '0.0300', 'NDCG@5': '0.0191', 'HR@10': '0.0500', 'NDCG@10': '0.0255', 'HR@20': '0.0817', 'NDCG@20': '0.0334'}
2025-02-25 12:44:26,676 - Validation score increased.  Saving model ...
2025-02-25 12:45:09,235 - {'epoch': 25, 'rec_loss': '7.1792'}
2025-02-25 12:45:24,777 - {'Epoch': 25, 'HR@5': '0.0295', 'NDCG@5': '0.0186', 'HR@10': '0.0504', 'NDCG@10': '0.0253', 'HR@20': '0.0800', 'NDCG@20': '0.0328'}
2025-02-25 12:45:24,779 - EarlyStopping counter: 1 out of 10
2025-02-25 12:46:06,967 - {'epoch': 26, 'rec_loss': '7.1730'}
2025-02-25 12:46:25,123 - {'Epoch': 26, 'HR@5': '0.0300', 'NDCG@5': '0.0191', 'HR@10': '0.0501', 'NDCG@10': '0.0256', 'HR@20': '0.0802', 'NDCG@20': '0.0332'}
2025-02-25 12:46:25,128 - EarlyStopping counter: 2 out of 10
2025-02-25 12:47:07,632 - {'epoch': 27, 'rec_loss': '7.1627'}
2025-02-25 12:47:22,915 - {'Epoch': 27, 'HR@5': '0.0301', 'NDCG@5': '0.0189', 'HR@10': '0.0503', 'NDCG@10': '0.0254', 'HR@20': '0.0801', 'NDCG@20': '0.0328'}
2025-02-25 12:47:22,916 - EarlyStopping counter: 3 out of 10
2025-02-25 12:48:06,614 - {'epoch': 28, 'rec_loss': '7.1478'}
2025-02-25 12:48:24,389 - {'Epoch': 28, 'HR@5': '0.0298', 'NDCG@5': '0.0188', 'HR@10': '0.0489', 'NDCG@10': '0.0250', 'HR@20': '0.0793', 'NDCG@20': '0.0326'}
2025-02-25 12:48:24,393 - EarlyStopping counter: 4 out of 10
2025-02-25 12:49:07,367 - {'epoch': 29, 'rec_loss': '7.1406'}
2025-02-25 12:49:24,354 - {'Epoch': 29, 'HR@5': '0.0306', 'NDCG@5': '0.0193', 'HR@10': '0.0488', 'NDCG@10': '0.0251', 'HR@20': '0.0806', 'NDCG@20': '0.0331'}
2025-02-25 12:49:24,359 - EarlyStopping counter: 5 out of 10
2025-02-25 12:50:07,379 - {'epoch': 30, 'rec_loss': '7.1307'}
2025-02-25 12:50:25,061 - {'Epoch': 30, 'HR@5': '0.0302', 'NDCG@5': '0.0193', 'HR@10': '0.0508', 'NDCG@10': '0.0259', 'HR@20': '0.0815', 'NDCG@20': '0.0336'}
2025-02-25 12:50:25,065 - Validation score increased.  Saving model ...
2025-02-25 12:51:06,554 - {'epoch': 31, 'rec_loss': '7.1200'}
2025-02-25 12:51:24,026 - {'Epoch': 31, 'HR@5': '0.0289', 'NDCG@5': '0.0187', 'HR@10': '0.0494', 'NDCG@10': '0.0253', 'HR@20': '0.0798', 'NDCG@20': '0.0330'}
2025-02-25 12:51:24,031 - EarlyStopping counter: 1 out of 10
2025-02-25 12:52:06,592 - {'epoch': 32, 'rec_loss': '7.1140'}
2025-02-25 12:52:22,701 - {'Epoch': 32, 'HR@5': '0.0296', 'NDCG@5': '0.0188', 'HR@10': '0.0488', 'NDCG@10': '0.0249', 'HR@20': '0.0767', 'NDCG@20': '0.0320'}
2025-02-25 12:52:22,705 - EarlyStopping counter: 2 out of 10
2025-02-25 12:53:04,773 - {'epoch': 33, 'rec_loss': '7.1074'}
2025-02-25 12:53:20,127 - {'Epoch': 33, 'HR@5': '0.0304', 'NDCG@5': '0.0190', 'HR@10': '0.0495', 'NDCG@10': '0.0251', 'HR@20': '0.0795', 'NDCG@20': '0.0327'}
2025-02-25 12:53:20,128 - EarlyStopping counter: 3 out of 10
2025-02-25 12:54:01,697 - {'epoch': 34, 'rec_loss': '7.0946'}
2025-02-25 12:54:20,163 - {'Epoch': 34, 'HR@5': '0.0298', 'NDCG@5': '0.0189', 'HR@10': '0.0495', 'NDCG@10': '0.0253', 'HR@20': '0.0788', 'NDCG@20': '0.0326'}
2025-02-25 12:54:20,168 - EarlyStopping counter: 4 out of 10
2025-02-25 12:55:02,983 - {'epoch': 35, 'rec_loss': '7.0904'}
2025-02-25 12:55:19,377 - {'Epoch': 35, 'HR@5': '0.0296', 'NDCG@5': '0.0187', 'HR@10': '0.0500', 'NDCG@10': '0.0252', 'HR@20': '0.0794', 'NDCG@20': '0.0326'}
2025-02-25 12:55:19,382 - EarlyStopping counter: 5 out of 10
2025-02-25 12:56:00,852 - {'epoch': 36, 'rec_loss': '7.0854'}
2025-02-25 12:56:18,445 - {'Epoch': 36, 'HR@5': '0.0301', 'NDCG@5': '0.0190', 'HR@10': '0.0493', 'NDCG@10': '0.0252', 'HR@20': '0.0802', 'NDCG@20': '0.0329'}
2025-02-25 12:56:18,450 - EarlyStopping counter: 6 out of 10
2025-02-25 12:57:01,161 - {'epoch': 37, 'rec_loss': '7.0749'}
2025-02-25 12:57:18,920 - {'Epoch': 37, 'HR@5': '0.0303', 'NDCG@5': '0.0189', 'HR@10': '0.0503', 'NDCG@10': '0.0253', 'HR@20': '0.0786', 'NDCG@20': '0.0324'}
2025-02-25 12:57:18,921 - EarlyStopping counter: 7 out of 10
2025-02-25 12:58:00,865 - {'epoch': 38, 'rec_loss': '7.0683'}
2025-02-25 12:58:16,305 - {'Epoch': 38, 'HR@5': '0.0290', 'NDCG@5': '0.0185', 'HR@10': '0.0485', 'NDCG@10': '0.0248', 'HR@20': '0.0783', 'NDCG@20': '0.0323'}
2025-02-25 12:58:16,309 - EarlyStopping counter: 8 out of 10
2025-02-25 12:58:58,315 - {'epoch': 39, 'rec_loss': '7.0683'}
2025-02-25 12:59:13,609 - {'Epoch': 39, 'HR@5': '0.0300', 'NDCG@5': '0.0189', 'HR@10': '0.0483', 'NDCG@10': '0.0248', 'HR@20': '0.0778', 'NDCG@20': '0.0322'}
2025-02-25 12:59:13,613 - EarlyStopping counter: 9 out of 10
2025-02-25 12:59:57,890 - {'epoch': 40, 'rec_loss': '7.0564'}
2025-02-25 13:00:15,121 - {'Epoch': 40, 'HR@5': '0.0299', 'NDCG@5': '0.0185', 'HR@10': '0.0487', 'NDCG@10': '0.0245', 'HR@20': '0.0796', 'NDCG@20': '0.0322'}
2025-02-25 13:00:15,126 - EarlyStopping counter: 10 out of 10
2025-02-25 13:00:15,126 - Early stopping
2025-02-25 13:00:15,126 - ---------------Test Score---------------
2025-02-25 13:00:32,764 - {'Epoch': 0, 'HR@5': '0.0279', 'NDCG@5': '0.0178', 'HR@10': '0.0456', 'NDCG@10': '0.0235', 'HR@20': '0.0724', 'NDCG@20': '0.0302'}
2025-02-25 13:00:32,768 - Scale_Yelp
2025-02-25 13:00:32,768 - {'Epoch': 0, 'HR@5': '0.0279', 'NDCG@5': '0.0178', 'HR@10': '0.0456', 'NDCG@10': '0.0235', 'HR@20': '0.0724', 'NDCG@20': '0.0302'}
2025-02-25 13:23:47,102 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-02-25 13:23:49,878 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-25 13:23:49,883 - Total Parameters: 1437093
2025-02-25 13:24:36,201 - {'epoch': 0, 'rec_loss': '9.5374'}
2025-02-25 13:24:51,915 - {'Epoch': 0, 'HR@5': '0.0087', 'NDCG@5': '0.0057', 'HR@10': '0.0144', 'NDCG@10': '0.0075', 'HR@20': '0.0250', 'NDCG@20': '0.0101'}
2025-02-25 13:24:51,917 - Validation score increased.  Saving model ...
2025-02-25 13:25:37,112 - {'epoch': 1, 'rec_loss': '8.8868'}
2025-02-25 13:25:52,408 - {'Epoch': 1, 'HR@5': '0.0148', 'NDCG@5': '0.0093', 'HR@10': '0.0252', 'NDCG@10': '0.0127', 'HR@20': '0.0404', 'NDCG@20': '0.0165'}
2025-02-25 13:25:52,412 - Validation score increased.  Saving model ...
2025-02-25 13:26:37,988 - {'epoch': 2, 'rec_loss': '8.4309'}
2025-02-25 13:26:52,519 - {'Epoch': 2, 'HR@5': '0.0188', 'NDCG@5': '0.0115', 'HR@10': '0.0333', 'NDCG@10': '0.0162', 'HR@20': '0.0550', 'NDCG@20': '0.0216'}
2025-02-25 13:26:52,520 - Validation score increased.  Saving model ...
2025-02-25 13:27:37,785 - {'epoch': 3, 'rec_loss': '8.1480'}
2025-02-25 13:27:52,244 - {'Epoch': 3, 'HR@5': '0.0212', 'NDCG@5': '0.0131', 'HR@10': '0.0377', 'NDCG@10': '0.0184', 'HR@20': '0.0612', 'NDCG@20': '0.0243'}
2025-02-25 13:27:52,246 - Validation score increased.  Saving model ...
2025-02-25 13:28:38,823 - {'epoch': 4, 'rec_loss': '7.9690'}
2025-02-25 13:28:54,087 - {'Epoch': 4, 'HR@5': '0.0243', 'NDCG@5': '0.0152', 'HR@10': '0.0409', 'NDCG@10': '0.0206', 'HR@20': '0.0680', 'NDCG@20': '0.0273'}
2025-02-25 13:28:54,093 - Validation score increased.  Saving model ...
2025-02-25 13:29:38,763 - {'epoch': 5, 'rec_loss': '7.8367'}
2025-02-25 13:29:53,325 - {'Epoch': 5, 'HR@5': '0.0260', 'NDCG@5': '0.0162', 'HR@10': '0.0435', 'NDCG@10': '0.0219', 'HR@20': '0.0706', 'NDCG@20': '0.0287'}
2025-02-25 13:29:53,326 - Validation score increased.  Saving model ...
2025-02-25 13:30:39,517 - {'epoch': 6, 'rec_loss': '7.7352'}
2025-02-25 13:30:54,682 - {'Epoch': 6, 'HR@5': '0.0265', 'NDCG@5': '0.0164', 'HR@10': '0.0450', 'NDCG@10': '0.0223', 'HR@20': '0.0733', 'NDCG@20': '0.0294'}
2025-02-25 13:30:54,684 - Validation score increased.  Saving model ...
2025-02-25 13:31:41,574 - {'epoch': 7, 'rec_loss': '7.6551'}
2025-02-25 13:31:56,637 - {'Epoch': 7, 'HR@5': '0.0262', 'NDCG@5': '0.0164', 'HR@10': '0.0444', 'NDCG@10': '0.0222', 'HR@20': '0.0738', 'NDCG@20': '0.0296'}
2025-02-25 13:31:56,638 - Validation score increased.  Saving model ...
2025-02-25 13:32:41,749 - {'epoch': 8, 'rec_loss': '7.5909'}
2025-02-25 13:32:56,512 - {'Epoch': 8, 'HR@5': '0.0269', 'NDCG@5': '0.0167', 'HR@10': '0.0456', 'NDCG@10': '0.0226', 'HR@20': '0.0747', 'NDCG@20': '0.0300'}
2025-02-25 13:32:56,515 - Validation score increased.  Saving model ...
2025-02-25 13:33:41,556 - {'epoch': 9, 'rec_loss': '7.5397'}
2025-02-25 13:33:56,824 - {'Epoch': 9, 'HR@5': '0.0281', 'NDCG@5': '0.0173', 'HR@10': '0.0476', 'NDCG@10': '0.0235', 'HR@20': '0.0755', 'NDCG@20': '0.0305'}
2025-02-25 13:33:56,828 - Validation score increased.  Saving model ...
2025-02-25 13:34:42,224 - {'epoch': 10, 'rec_loss': '7.4951'}
2025-02-25 13:34:57,253 - {'Epoch': 10, 'HR@5': '0.0271', 'NDCG@5': '0.0172', 'HR@10': '0.0475', 'NDCG@10': '0.0237', 'HR@20': '0.0772', 'NDCG@20': '0.0312'}
2025-02-25 13:34:57,254 - Validation score increased.  Saving model ...
2025-02-25 13:35:42,436 - {'epoch': 11, 'rec_loss': '7.4509'}
2025-02-25 13:35:57,220 - {'Epoch': 11, 'HR@5': '0.0282', 'NDCG@5': '0.0172', 'HR@10': '0.0479', 'NDCG@10': '0.0235', 'HR@20': '0.0775', 'NDCG@20': '0.0310'}
2025-02-25 13:35:57,222 - EarlyStopping counter: 1 out of 10
2025-02-25 13:36:42,949 - {'epoch': 12, 'rec_loss': '7.4218'}
2025-02-25 13:36:58,337 - {'Epoch': 12, 'HR@5': '0.0285', 'NDCG@5': '0.0182', 'HR@10': '0.0489', 'NDCG@10': '0.0247', 'HR@20': '0.0776', 'NDCG@20': '0.0319'}
2025-02-25 13:36:58,340 - Validation score increased.  Saving model ...
2025-02-25 13:37:44,152 - {'epoch': 13, 'rec_loss': '7.3863'}
2025-02-25 13:38:01,114 - {'Epoch': 13, 'HR@5': '0.0283', 'NDCG@5': '0.0177', 'HR@10': '0.0484', 'NDCG@10': '0.0242', 'HR@20': '0.0768', 'NDCG@20': '0.0313'}
2025-02-25 13:38:01,116 - EarlyStopping counter: 1 out of 10
2025-02-25 13:38:47,276 - {'epoch': 14, 'rec_loss': '7.3606'}
2025-02-25 13:39:02,669 - {'Epoch': 14, 'HR@5': '0.0285', 'NDCG@5': '0.0179', 'HR@10': '0.0477', 'NDCG@10': '0.0240', 'HR@20': '0.0787', 'NDCG@20': '0.0318'}
2025-02-25 13:39:02,671 - EarlyStopping counter: 2 out of 10
2025-02-25 13:39:53,910 - {'epoch': 15, 'rec_loss': '7.3407'}
2025-02-25 13:40:08,933 - {'Epoch': 15, 'HR@5': '0.0291', 'NDCG@5': '0.0180', 'HR@10': '0.0490', 'NDCG@10': '0.0243', 'HR@20': '0.0790', 'NDCG@20': '0.0319'}
2025-02-25 13:40:08,936 - EarlyStopping counter: 3 out of 10
2025-02-25 13:40:53,393 - {'epoch': 16, 'rec_loss': '7.3121'}
2025-02-25 13:41:08,320 - {'Epoch': 16, 'HR@5': '0.0287', 'NDCG@5': '0.0181', 'HR@10': '0.0474', 'NDCG@10': '0.0241', 'HR@20': '0.0802', 'NDCG@20': '0.0324'}
2025-02-25 13:41:08,321 - Validation score increased.  Saving model ...
2025-02-25 13:41:53,505 - {'epoch': 17, 'rec_loss': '7.2920'}
2025-02-25 13:42:08,953 - {'Epoch': 17, 'HR@5': '0.0289', 'NDCG@5': '0.0179', 'HR@10': '0.0487', 'NDCG@10': '0.0243', 'HR@20': '0.0782', 'NDCG@20': '0.0317'}
2025-02-25 13:42:08,954 - EarlyStopping counter: 1 out of 10
2025-02-25 13:42:54,007 - {'epoch': 18, 'rec_loss': '7.2735'}
2025-02-25 13:43:09,069 - {'Epoch': 18, 'HR@5': '0.0291', 'NDCG@5': '0.0182', 'HR@10': '0.0480', 'NDCG@10': '0.0242', 'HR@20': '0.0791', 'NDCG@20': '0.0320'}
2025-02-25 13:43:09,071 - EarlyStopping counter: 2 out of 10
2025-02-25 13:43:54,660 - {'epoch': 19, 'rec_loss': '7.2555'}
2025-02-25 13:44:09,949 - {'Epoch': 19, 'HR@5': '0.0299', 'NDCG@5': '0.0188', 'HR@10': '0.0498', 'NDCG@10': '0.0252', 'HR@20': '0.0802', 'NDCG@20': '0.0328'}
2025-02-25 13:44:09,950 - Validation score increased.  Saving model ...
2025-02-25 13:44:55,460 - {'epoch': 20, 'rec_loss': '7.2408'}
2025-02-25 13:45:10,424 - {'Epoch': 20, 'HR@5': '0.0290', 'NDCG@5': '0.0185', 'HR@10': '0.0483', 'NDCG@10': '0.0246', 'HR@20': '0.0801', 'NDCG@20': '0.0326'}
2025-02-25 13:45:10,426 - EarlyStopping counter: 1 out of 10
2025-02-25 13:45:55,609 - {'epoch': 21, 'rec_loss': '7.2237'}
2025-02-25 13:46:10,735 - {'Epoch': 21, 'HR@5': '0.0295', 'NDCG@5': '0.0187', 'HR@10': '0.0496', 'NDCG@10': '0.0251', 'HR@20': '0.0808', 'NDCG@20': '0.0330'}
2025-02-25 13:46:10,736 - Validation score increased.  Saving model ...
2025-02-25 13:46:57,266 - {'epoch': 22, 'rec_loss': '7.2156'}
2025-02-25 13:47:12,307 - {'Epoch': 22, 'HR@5': '0.0293', 'NDCG@5': '0.0183', 'HR@10': '0.0489', 'NDCG@10': '0.0246', 'HR@20': '0.0798', 'NDCG@20': '0.0323'}
2025-02-25 13:47:12,309 - EarlyStopping counter: 1 out of 10
2025-02-25 13:47:57,790 - {'epoch': 23, 'rec_loss': '7.1957'}
2025-02-25 13:48:12,940 - {'Epoch': 23, 'HR@5': '0.0293', 'NDCG@5': '0.0184', 'HR@10': '0.0501', 'NDCG@10': '0.0251', 'HR@20': '0.0809', 'NDCG@20': '0.0329'}
2025-02-25 13:48:12,941 - EarlyStopping counter: 2 out of 10
2025-02-25 13:49:00,060 - {'epoch': 24, 'rec_loss': '7.1861'}
2025-02-25 13:49:15,438 - {'Epoch': 24, 'HR@5': '0.0296', 'NDCG@5': '0.0188', 'HR@10': '0.0505', 'NDCG@10': '0.0255', 'HR@20': '0.0814', 'NDCG@20': '0.0332'}
2025-02-25 13:49:15,439 - Validation score increased.  Saving model ...
2025-02-25 13:50:01,921 - {'epoch': 25, 'rec_loss': '7.1723'}
2025-02-25 13:50:16,964 - {'Epoch': 25, 'HR@5': '0.0296', 'NDCG@5': '0.0186', 'HR@10': '0.0505', 'NDCG@10': '0.0253', 'HR@20': '0.0817', 'NDCG@20': '0.0332'}
2025-02-25 13:50:16,968 - EarlyStopping counter: 1 out of 10
2025-02-25 13:51:03,213 - {'epoch': 26, 'rec_loss': '7.1655'}
2025-02-25 13:51:18,277 - {'Epoch': 26, 'HR@5': '0.0304', 'NDCG@5': '0.0189', 'HR@10': '0.0503', 'NDCG@10': '0.0253', 'HR@20': '0.0811', 'NDCG@20': '0.0330'}
2025-02-25 13:51:18,279 - EarlyStopping counter: 2 out of 10
2025-02-25 13:52:03,471 - {'epoch': 27, 'rec_loss': '7.1532'}
2025-02-25 13:52:18,581 - {'Epoch': 27, 'HR@5': '0.0301', 'NDCG@5': '0.0190', 'HR@10': '0.0513', 'NDCG@10': '0.0258', 'HR@20': '0.0823', 'NDCG@20': '0.0336'}
2025-02-25 13:52:18,582 - Validation score increased.  Saving model ...
2025-02-25 13:53:05,910 - {'epoch': 28, 'rec_loss': '7.1460'}
2025-02-25 13:53:21,291 - {'Epoch': 28, 'HR@5': '0.0296', 'NDCG@5': '0.0187', 'HR@10': '0.0499', 'NDCG@10': '0.0252', 'HR@20': '0.0805', 'NDCG@20': '0.0329'}
2025-02-25 13:53:21,292 - EarlyStopping counter: 1 out of 10
2025-02-25 13:54:08,346 - {'epoch': 29, 'rec_loss': '7.1339'}
2025-02-25 13:54:23,678 - {'Epoch': 29, 'HR@5': '0.0304', 'NDCG@5': '0.0187', 'HR@10': '0.0508', 'NDCG@10': '0.0252', 'HR@20': '0.0801', 'NDCG@20': '0.0326'}
2025-02-25 13:54:23,679 - EarlyStopping counter: 2 out of 10
2025-02-25 13:55:12,997 - {'epoch': 30, 'rec_loss': '7.1264'}
2025-02-25 13:55:27,980 - {'Epoch': 30, 'HR@5': '0.0305', 'NDCG@5': '0.0193', 'HR@10': '0.0506', 'NDCG@10': '0.0257', 'HR@20': '0.0805', 'NDCG@20': '0.0333'}
2025-02-25 13:55:27,982 - EarlyStopping counter: 3 out of 10
2025-02-25 13:56:14,906 - {'epoch': 31, 'rec_loss': '7.1186'}
2025-02-25 13:56:30,650 - {'Epoch': 31, 'HR@5': '0.0291', 'NDCG@5': '0.0182', 'HR@10': '0.0496', 'NDCG@10': '0.0247', 'HR@20': '0.0811', 'NDCG@20': '0.0327'}
2025-02-25 13:56:30,651 - EarlyStopping counter: 4 out of 10
2025-02-25 13:57:16,594 - {'epoch': 32, 'rec_loss': '7.1109'}
2025-02-25 13:57:31,901 - {'Epoch': 32, 'HR@5': '0.0287', 'NDCG@5': '0.0181', 'HR@10': '0.0499', 'NDCG@10': '0.0249', 'HR@20': '0.0797', 'NDCG@20': '0.0324'}
2025-02-25 13:57:31,903 - EarlyStopping counter: 5 out of 10
2025-02-25 13:58:17,051 - {'epoch': 33, 'rec_loss': '7.1032'}
2025-02-25 13:58:32,545 - {'Epoch': 33, 'HR@5': '0.0308', 'NDCG@5': '0.0191', 'HR@10': '0.0507', 'NDCG@10': '0.0255', 'HR@20': '0.0814', 'NDCG@20': '0.0332'}
2025-02-25 13:58:32,549 - EarlyStopping counter: 6 out of 10
2025-02-25 13:59:21,194 - {'epoch': 34, 'rec_loss': '7.0966'}
2025-02-25 13:59:35,945 - {'Epoch': 34, 'HR@5': '0.0296', 'NDCG@5': '0.0186', 'HR@10': '0.0514', 'NDCG@10': '0.0256', 'HR@20': '0.0823', 'NDCG@20': '0.0333'}
2025-02-25 13:59:35,949 - EarlyStopping counter: 7 out of 10
2025-02-25 14:00:24,385 - {'epoch': 35, 'rec_loss': '7.0905'}
2025-02-25 14:00:39,080 - {'Epoch': 35, 'HR@5': '0.0295', 'NDCG@5': '0.0179', 'HR@10': '0.0491', 'NDCG@10': '0.0242', 'HR@20': '0.0795', 'NDCG@20': '0.0319'}
2025-02-25 14:00:39,082 - EarlyStopping counter: 8 out of 10
2025-02-25 14:01:23,699 - {'epoch': 36, 'rec_loss': '7.0820'}
2025-02-25 14:01:38,721 - {'Epoch': 36, 'HR@5': '0.0296', 'NDCG@5': '0.0182', 'HR@10': '0.0498', 'NDCG@10': '0.0247', 'HR@20': '0.0801', 'NDCG@20': '0.0323'}
2025-02-25 14:01:38,725 - EarlyStopping counter: 9 out of 10
2025-02-25 14:02:25,162 - {'epoch': 37, 'rec_loss': '7.0758'}
2025-02-25 14:02:40,400 - {'Epoch': 37, 'HR@5': '0.0293', 'NDCG@5': '0.0184', 'HR@10': '0.0495', 'NDCG@10': '0.0249', 'HR@20': '0.0815', 'NDCG@20': '0.0329'}
2025-02-25 14:02:40,404 - EarlyStopping counter: 10 out of 10
2025-02-25 14:02:40,404 - Early stopping
2025-02-25 14:02:40,404 - ---------------Test Score---------------
2025-02-25 14:02:55,435 - {'Epoch': 0, 'HR@5': '0.0283', 'NDCG@5': '0.0174', 'HR@10': '0.0468', 'NDCG@10': '0.0233', 'HR@20': '0.0753', 'NDCG@20': '0.0304'}
2025-02-25 14:02:55,439 - Scale_Yelp
2025-02-25 14:02:55,439 - {'Epoch': 0, 'HR@5': '0.0283', 'NDCG@5': '0.0174', 'HR@10': '0.0468', 'NDCG@10': '0.0233', 'HR@20': '0.0753', 'NDCG@20': '0.0304'}
2025-02-25 14:04:38,447 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-02-25 14:04:41,327 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-25 14:04:41,332 - Total Parameters: 1437093
2025-02-25 14:05:25,863 - {'epoch': 0, 'rec_loss': '9.5431'}
2025-02-25 14:05:43,848 - {'Epoch': 0, 'HR@5': '0.0086', 'NDCG@5': '0.0056', 'HR@10': '0.0143', 'NDCG@10': '0.0074', 'HR@20': '0.0251', 'NDCG@20': '0.0101'}
2025-02-25 14:05:43,854 - Validation score increased.  Saving model ...
2025-02-25 14:06:24,943 - {'epoch': 1, 'rec_loss': '8.9168'}
2025-02-25 14:06:41,951 - {'Epoch': 1, 'HR@5': '0.0138', 'NDCG@5': '0.0086', 'HR@10': '0.0240', 'NDCG@10': '0.0119', 'HR@20': '0.0399', 'NDCG@20': '0.0159'}
2025-02-25 14:06:41,955 - Validation score increased.  Saving model ...
2025-02-25 14:07:22,822 - {'epoch': 2, 'rec_loss': '8.4758'}
2025-02-25 14:07:37,422 - {'Epoch': 2, 'HR@5': '0.0183', 'NDCG@5': '0.0112', 'HR@10': '0.0327', 'NDCG@10': '0.0159', 'HR@20': '0.0548', 'NDCG@20': '0.0214'}
2025-02-25 14:07:37,427 - Validation score increased.  Saving model ...
2025-02-25 14:08:21,301 - {'epoch': 3, 'rec_loss': '8.1912'}
2025-02-25 14:08:35,724 - {'Epoch': 3, 'HR@5': '0.0205', 'NDCG@5': '0.0127', 'HR@10': '0.0371', 'NDCG@10': '0.0180', 'HR@20': '0.0603', 'NDCG@20': '0.0238'}
2025-02-25 14:08:35,726 - Validation score increased.  Saving model ...
2025-02-25 14:09:16,824 - {'epoch': 4, 'rec_loss': '8.0161'}
2025-02-25 14:09:33,624 - {'Epoch': 4, 'HR@5': '0.0227', 'NDCG@5': '0.0143', 'HR@10': '0.0399', 'NDCG@10': '0.0198', 'HR@20': '0.0676', 'NDCG@20': '0.0268'}
2025-02-25 14:09:33,626 - Validation score increased.  Saving model ...
2025-02-25 14:10:15,101 - {'epoch': 5, 'rec_loss': '7.8868'}
2025-02-25 14:10:30,403 - {'Epoch': 5, 'HR@5': '0.0250', 'NDCG@5': '0.0157', 'HR@10': '0.0430', 'NDCG@10': '0.0214', 'HR@20': '0.0697', 'NDCG@20': '0.0282'}
2025-02-25 14:10:30,408 - Validation score increased.  Saving model ...
2025-02-25 14:11:11,250 - {'epoch': 6, 'rec_loss': '7.7890'}
2025-02-25 14:11:28,292 - {'Epoch': 6, 'HR@5': '0.0267', 'NDCG@5': '0.0164', 'HR@10': '0.0450', 'NDCG@10': '0.0222', 'HR@20': '0.0729', 'NDCG@20': '0.0292'}
2025-02-25 14:11:28,296 - Validation score increased.  Saving model ...
2025-02-25 14:12:10,538 - {'epoch': 7, 'rec_loss': '7.7105'}
2025-02-25 14:12:26,022 - {'Epoch': 7, 'HR@5': '0.0265', 'NDCG@5': '0.0164', 'HR@10': '0.0454', 'NDCG@10': '0.0224', 'HR@20': '0.0749', 'NDCG@20': '0.0298'}
2025-02-25 14:12:26,025 - Validation score increased.  Saving model ...
2025-02-25 14:13:06,915 - {'epoch': 8, 'rec_loss': '7.6462'}
2025-02-25 14:13:24,037 - {'Epoch': 8, 'HR@5': '0.0272', 'NDCG@5': '0.0168', 'HR@10': '0.0465', 'NDCG@10': '0.0230', 'HR@20': '0.0749', 'NDCG@20': '0.0301'}
2025-02-25 14:13:24,041 - Validation score increased.  Saving model ...
2025-02-25 14:14:04,880 - {'epoch': 9, 'rec_loss': '7.5942'}
2025-02-25 14:14:22,172 - {'Epoch': 9, 'HR@5': '0.0280', 'NDCG@5': '0.0174', 'HR@10': '0.0478', 'NDCG@10': '0.0238', 'HR@20': '0.0773', 'NDCG@20': '0.0312'}
2025-02-25 14:14:22,177 - Validation score increased.  Saving model ...
2025-02-25 14:15:04,155 - {'epoch': 10, 'rec_loss': '7.5487'}
2025-02-25 14:15:19,331 - {'Epoch': 10, 'HR@5': '0.0276', 'NDCG@5': '0.0176', 'HR@10': '0.0481', 'NDCG@10': '0.0241', 'HR@20': '0.0774', 'NDCG@20': '0.0315'}
2025-02-25 14:15:19,336 - Validation score increased.  Saving model ...
2025-02-25 14:16:04,091 - {'epoch': 11, 'rec_loss': '7.5023'}
2025-02-25 14:16:21,076 - {'Epoch': 11, 'HR@5': '0.0296', 'NDCG@5': '0.0180', 'HR@10': '0.0482', 'NDCG@10': '0.0239', 'HR@20': '0.0788', 'NDCG@20': '0.0316'}
2025-02-25 14:16:21,078 - Validation score increased.  Saving model ...
2025-02-25 14:17:02,196 - {'epoch': 12, 'rec_loss': '7.4684'}
2025-02-25 14:17:17,466 - {'Epoch': 12, 'HR@5': '0.0294', 'NDCG@5': '0.0182', 'HR@10': '0.0495', 'NDCG@10': '0.0246', 'HR@20': '0.0785', 'NDCG@20': '0.0319'}
2025-02-25 14:17:17,471 - Validation score increased.  Saving model ...
2025-02-25 14:17:58,324 - {'epoch': 13, 'rec_loss': '7.4339'}
2025-02-25 14:18:15,877 - {'Epoch': 13, 'HR@5': '0.0293', 'NDCG@5': '0.0181', 'HR@10': '0.0488', 'NDCG@10': '0.0243', 'HR@20': '0.0779', 'NDCG@20': '0.0317'}
2025-02-25 14:18:15,883 - EarlyStopping counter: 1 out of 10
2025-02-25 14:18:57,212 - {'epoch': 14, 'rec_loss': '7.4093'}
2025-02-25 14:19:14,397 - {'Epoch': 14, 'HR@5': '0.0295', 'NDCG@5': '0.0183', 'HR@10': '0.0487', 'NDCG@10': '0.0245', 'HR@20': '0.0778', 'NDCG@20': '0.0318'}
2025-02-25 14:19:14,399 - EarlyStopping counter: 2 out of 10
2025-02-25 14:19:55,391 - {'epoch': 15, 'rec_loss': '7.3850'}
2025-02-25 14:20:12,247 - {'Epoch': 15, 'HR@5': '0.0290', 'NDCG@5': '0.0181', 'HR@10': '0.0494', 'NDCG@10': '0.0247', 'HR@20': '0.0797', 'NDCG@20': '0.0323'}
2025-02-25 14:20:12,250 - Validation score increased.  Saving model ...
2025-02-25 14:20:56,619 - {'epoch': 16, 'rec_loss': '7.3587'}
2025-02-25 14:21:12,075 - {'Epoch': 16, 'HR@5': '0.0294', 'NDCG@5': '0.0183', 'HR@10': '0.0490', 'NDCG@10': '0.0246', 'HR@20': '0.0806', 'NDCG@20': '0.0326'}
2025-02-25 14:21:12,080 - Validation score increased.  Saving model ...
2025-02-25 14:21:52,953 - {'epoch': 17, 'rec_loss': '7.3369'}
2025-02-25 14:22:08,128 - {'Epoch': 17, 'HR@5': '0.0300', 'NDCG@5': '0.0187', 'HR@10': '0.0500', 'NDCG@10': '0.0251', 'HR@20': '0.0812', 'NDCG@20': '0.0329'}
2025-02-25 14:22:08,133 - Validation score increased.  Saving model ...
2025-02-25 14:22:51,071 - {'epoch': 18, 'rec_loss': '7.3191'}
2025-02-25 14:23:06,065 - {'Epoch': 18, 'HR@5': '0.0290', 'NDCG@5': '0.0184', 'HR@10': '0.0495', 'NDCG@10': '0.0249', 'HR@20': '0.0803', 'NDCG@20': '0.0327'}
2025-02-25 14:23:06,066 - EarlyStopping counter: 1 out of 10
2025-02-25 14:23:47,611 - {'epoch': 19, 'rec_loss': '7.2994'}
2025-02-25 14:24:04,006 - {'Epoch': 19, 'HR@5': '0.0304', 'NDCG@5': '0.0190', 'HR@10': '0.0502', 'NDCG@10': '0.0254', 'HR@20': '0.0812', 'NDCG@20': '0.0332'}
2025-02-25 14:24:04,010 - Validation score increased.  Saving model ...
2025-02-25 14:24:46,219 - {'epoch': 20, 'rec_loss': '7.2859'}
2025-02-25 14:25:01,364 - {'Epoch': 20, 'HR@5': '0.0299', 'NDCG@5': '0.0189', 'HR@10': '0.0494', 'NDCG@10': '0.0251', 'HR@20': '0.0803', 'NDCG@20': '0.0329'}
2025-02-25 14:25:01,368 - EarlyStopping counter: 1 out of 10
2025-02-25 14:25:42,506 - {'epoch': 21, 'rec_loss': '7.2724'}
2025-02-25 14:25:57,429 - {'Epoch': 21, 'HR@5': '0.0302', 'NDCG@5': '0.0189', 'HR@10': '0.0505', 'NDCG@10': '0.0254', 'HR@20': '0.0807', 'NDCG@20': '0.0330'}
2025-02-25 14:25:57,437 - EarlyStopping counter: 2 out of 10
2025-02-25 14:26:39,962 - {'epoch': 22, 'rec_loss': '7.2606'}
2025-02-25 14:26:56,918 - {'Epoch': 22, 'HR@5': '0.0297', 'NDCG@5': '0.0187', 'HR@10': '0.0501', 'NDCG@10': '0.0252', 'HR@20': '0.0806', 'NDCG@20': '0.0329'}
2025-02-25 14:26:56,923 - EarlyStopping counter: 3 out of 10
2025-02-25 14:27:38,677 - {'epoch': 23, 'rec_loss': '7.2411'}
2025-02-25 14:27:54,797 - {'Epoch': 23, 'HR@5': '0.0299', 'NDCG@5': '0.0187', 'HR@10': '0.0501', 'NDCG@10': '0.0252', 'HR@20': '0.0831', 'NDCG@20': '0.0335'}
2025-02-25 14:27:54,798 - Validation score increased.  Saving model ...
2025-02-25 14:28:37,449 - {'epoch': 24, 'rec_loss': '7.2302'}
2025-02-25 14:28:54,582 - {'Epoch': 24, 'HR@5': '0.0300', 'NDCG@5': '0.0190', 'HR@10': '0.0504', 'NDCG@10': '0.0255', 'HR@20': '0.0813', 'NDCG@20': '0.0333'}
2025-02-25 14:28:54,583 - EarlyStopping counter: 1 out of 10
2025-02-25 14:29:35,471 - {'epoch': 25, 'rec_loss': '7.2167'}
2025-02-25 14:29:52,064 - {'Epoch': 25, 'HR@5': '0.0301', 'NDCG@5': '0.0190', 'HR@10': '0.0502', 'NDCG@10': '0.0255', 'HR@20': '0.0826', 'NDCG@20': '0.0336'}
2025-02-25 14:29:52,068 - Validation score increased.  Saving model ...
2025-02-25 14:30:33,114 - {'epoch': 26, 'rec_loss': '7.2070'}
2025-02-25 14:30:48,300 - {'Epoch': 26, 'HR@5': '0.0302', 'NDCG@5': '0.0190', 'HR@10': '0.0507', 'NDCG@10': '0.0255', 'HR@20': '0.0822', 'NDCG@20': '0.0334'}
2025-02-25 14:30:48,305 - EarlyStopping counter: 1 out of 10
2025-02-25 14:31:30,193 - {'epoch': 27, 'rec_loss': '7.1954'}
2025-02-25 14:31:48,714 - {'Epoch': 27, 'HR@5': '0.0304', 'NDCG@5': '0.0191', 'HR@10': '0.0508', 'NDCG@10': '0.0256', 'HR@20': '0.0823', 'NDCG@20': '0.0335'}
2025-02-25 14:31:48,715 - EarlyStopping counter: 2 out of 10
2025-02-25 14:32:29,526 - {'epoch': 28, 'rec_loss': '7.1861'}
2025-02-25 14:32:46,875 - {'Epoch': 28, 'HR@5': '0.0311', 'NDCG@5': '0.0194', 'HR@10': '0.0506', 'NDCG@10': '0.0256', 'HR@20': '0.0819', 'NDCG@20': '0.0334'}
2025-02-25 14:32:46,879 - EarlyStopping counter: 3 out of 10
2025-02-25 14:33:27,888 - {'epoch': 29, 'rec_loss': '7.1755'}
2025-02-25 14:33:45,222 - {'Epoch': 29, 'HR@5': '0.0296', 'NDCG@5': '0.0185', 'HR@10': '0.0499', 'NDCG@10': '0.0251', 'HR@20': '0.0817', 'NDCG@20': '0.0331'}
2025-02-25 14:33:45,224 - EarlyStopping counter: 4 out of 10
2025-02-25 14:34:27,565 - {'epoch': 30, 'rec_loss': '7.1661'}
2025-02-25 14:34:42,667 - {'Epoch': 30, 'HR@5': '0.0295', 'NDCG@5': '0.0185', 'HR@10': '0.0509', 'NDCG@10': '0.0254', 'HR@20': '0.0817', 'NDCG@20': '0.0331'}
2025-02-25 14:34:42,671 - EarlyStopping counter: 5 out of 10
2025-02-25 14:35:24,026 - {'epoch': 31, 'rec_loss': '7.1569'}
2025-02-25 14:35:40,154 - {'Epoch': 31, 'HR@5': '0.0291', 'NDCG@5': '0.0181', 'HR@10': '0.0505', 'NDCG@10': '0.0249', 'HR@20': '0.0832', 'NDCG@20': '0.0331'}
2025-02-25 14:35:40,160 - EarlyStopping counter: 6 out of 10
2025-02-25 14:36:24,670 - {'epoch': 32, 'rec_loss': '7.1456'}
2025-02-25 14:36:39,835 - {'Epoch': 32, 'HR@5': '0.0288', 'NDCG@5': '0.0182', 'HR@10': '0.0500', 'NDCG@10': '0.0250', 'HR@20': '0.0818', 'NDCG@20': '0.0330'}
2025-02-25 14:36:39,841 - EarlyStopping counter: 7 out of 10
2025-02-25 14:37:22,775 - {'epoch': 33, 'rec_loss': '7.1415'}
2025-02-25 14:37:39,674 - {'Epoch': 33, 'HR@5': '0.0306', 'NDCG@5': '0.0193', 'HR@10': '0.0512', 'NDCG@10': '0.0259', 'HR@20': '0.0831', 'NDCG@20': '0.0339'}
2025-02-25 14:37:39,679 - Validation score increased.  Saving model ...
2025-02-25 14:38:23,285 - {'epoch': 34, 'rec_loss': '7.1336'}
2025-02-25 14:38:40,515 - {'Epoch': 34, 'HR@5': '0.0299', 'NDCG@5': '0.0186', 'HR@10': '0.0512', 'NDCG@10': '0.0254', 'HR@20': '0.0830', 'NDCG@20': '0.0334'}
2025-02-25 14:38:40,519 - EarlyStopping counter: 1 out of 10
2025-02-25 14:39:22,555 - {'epoch': 35, 'rec_loss': '7.1284'}
2025-02-25 14:39:40,700 - {'Epoch': 35, 'HR@5': '0.0293', 'NDCG@5': '0.0180', 'HR@10': '0.0495', 'NDCG@10': '0.0244', 'HR@20': '0.0793', 'NDCG@20': '0.0319'}
2025-02-25 14:39:40,706 - EarlyStopping counter: 2 out of 10
2025-02-25 14:40:22,104 - {'epoch': 36, 'rec_loss': '7.1198'}
2025-02-25 14:40:39,199 - {'Epoch': 36, 'HR@5': '0.0287', 'NDCG@5': '0.0183', 'HR@10': '0.0498', 'NDCG@10': '0.0251', 'HR@20': '0.0819', 'NDCG@20': '0.0332'}
2025-02-25 14:40:39,200 - EarlyStopping counter: 3 out of 10
2025-02-25 14:41:21,178 - {'epoch': 37, 'rec_loss': '7.1153'}
2025-02-25 14:41:39,030 - {'Epoch': 37, 'HR@5': '0.0293', 'NDCG@5': '0.0190', 'HR@10': '0.0499', 'NDCG@10': '0.0256', 'HR@20': '0.0815', 'NDCG@20': '0.0335'}
2025-02-25 14:41:39,032 - EarlyStopping counter: 4 out of 10
2025-02-25 14:42:20,181 - {'epoch': 38, 'rec_loss': '7.1043'}
2025-02-25 14:42:38,149 - {'Epoch': 38, 'HR@5': '0.0298', 'NDCG@5': '0.0188', 'HR@10': '0.0492', 'NDCG@10': '0.0250', 'HR@20': '0.0812', 'NDCG@20': '0.0330'}
2025-02-25 14:42:38,153 - EarlyStopping counter: 5 out of 10
2025-02-25 14:43:19,402 - {'epoch': 39, 'rec_loss': '7.0961'}
2025-02-25 14:43:36,882 - {'Epoch': 39, 'HR@5': '0.0298', 'NDCG@5': '0.0189', 'HR@10': '0.0484', 'NDCG@10': '0.0249', 'HR@20': '0.0798', 'NDCG@20': '0.0327'}
2025-02-25 14:43:36,886 - EarlyStopping counter: 6 out of 10
2025-02-25 14:44:17,724 - {'epoch': 40, 'rec_loss': '7.0952'}
2025-02-25 14:44:32,882 - {'Epoch': 40, 'HR@5': '0.0291', 'NDCG@5': '0.0187', 'HR@10': '0.0496', 'NDCG@10': '0.0253', 'HR@20': '0.0806', 'NDCG@20': '0.0330'}
2025-02-25 14:44:32,887 - EarlyStopping counter: 7 out of 10
2025-02-25 14:45:14,239 - {'epoch': 41, 'rec_loss': '7.0865'}
2025-02-25 14:45:29,278 - {'Epoch': 41, 'HR@5': '0.0293', 'NDCG@5': '0.0187', 'HR@10': '0.0496', 'NDCG@10': '0.0252', 'HR@20': '0.0808', 'NDCG@20': '0.0330'}
2025-02-25 14:45:29,284 - EarlyStopping counter: 8 out of 10
2025-02-25 14:46:10,313 - {'epoch': 42, 'rec_loss': '7.0815'}
2025-02-25 14:46:28,050 - {'Epoch': 42, 'HR@5': '0.0298', 'NDCG@5': '0.0188', 'HR@10': '0.0490', 'NDCG@10': '0.0250', 'HR@20': '0.0800', 'NDCG@20': '0.0328'}
2025-02-25 14:46:28,056 - EarlyStopping counter: 9 out of 10
2025-02-25 14:47:08,874 - {'epoch': 43, 'rec_loss': '7.0802'}
2025-02-25 14:47:24,919 - {'Epoch': 43, 'HR@5': '0.0303', 'NDCG@5': '0.0190', 'HR@10': '0.0495', 'NDCG@10': '0.0252', 'HR@20': '0.0815', 'NDCG@20': '0.0332'}
2025-02-25 14:47:24,923 - EarlyStopping counter: 10 out of 10
2025-02-25 14:47:24,923 - Early stopping
2025-02-25 14:47:24,924 - ---------------Test Score---------------
2025-02-25 14:47:43,262 - {'Epoch': 0, 'HR@5': '0.0283', 'NDCG@5': '0.0174', 'HR@10': '0.0478', 'NDCG@10': '0.0237', 'HR@20': '0.0768', 'NDCG@20': '0.0309'}
2025-02-25 14:47:43,266 - Scale_Yelp
2025-02-25 14:47:43,266 - {'Epoch': 0, 'HR@5': '0.0283', 'NDCG@5': '0.0174', 'HR@10': '0.0478', 'NDCG@10': '0.0237', 'HR@20': '0.0768', 'NDCG@20': '0.0309'}
2025-02-25 15:10:17,624 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 12], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-02-25 15:10:20,388 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-25 15:10:20,394 - Total Parameters: 1437093
2025-02-25 15:11:07,207 - {'epoch': 0, 'rec_loss': '9.5545'}
2025-02-25 15:11:22,877 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0055', 'HR@10': '0.0133', 'NDCG@10': '0.0071', 'HR@20': '0.0249', 'NDCG@20': '0.0100'}
2025-02-25 15:11:22,878 - Validation score increased.  Saving model ...
2025-02-25 15:12:05,582 - {'epoch': 1, 'rec_loss': '8.9691'}
2025-02-25 15:12:20,509 - {'Epoch': 1, 'HR@5': '0.0129', 'NDCG@5': '0.0081', 'HR@10': '0.0213', 'NDCG@10': '0.0108', 'HR@20': '0.0370', 'NDCG@20': '0.0147'}
2025-02-25 15:12:20,514 - Validation score increased.  Saving model ...
2025-02-25 15:13:02,035 - {'epoch': 2, 'rec_loss': '8.5640'}
2025-02-25 15:13:18,803 - {'Epoch': 2, 'HR@5': '0.0176', 'NDCG@5': '0.0108', 'HR@10': '0.0306', 'NDCG@10': '0.0150', 'HR@20': '0.0513', 'NDCG@20': '0.0202'}
2025-02-25 15:13:18,807 - Validation score increased.  Saving model ...
2025-02-25 15:14:01,119 - {'epoch': 3, 'rec_loss': '8.2796'}
2025-02-25 15:14:16,818 - {'Epoch': 3, 'HR@5': '0.0208', 'NDCG@5': '0.0125', 'HR@10': '0.0352', 'NDCG@10': '0.0171', 'HR@20': '0.0578', 'NDCG@20': '0.0228'}
2025-02-25 15:14:16,820 - Validation score increased.  Saving model ...
2025-02-25 15:14:58,063 - {'epoch': 4, 'rec_loss': '8.1003'}
2025-02-25 15:15:14,887 - {'Epoch': 4, 'HR@5': '0.0219', 'NDCG@5': '0.0139', 'HR@10': '0.0376', 'NDCG@10': '0.0190', 'HR@20': '0.0656', 'NDCG@20': '0.0260'}
2025-02-25 15:15:14,891 - Validation score increased.  Saving model ...
2025-02-25 15:15:56,276 - {'epoch': 5, 'rec_loss': '7.9673'}
2025-02-25 15:16:13,209 - {'Epoch': 5, 'HR@5': '0.0247', 'NDCG@5': '0.0153', 'HR@10': '0.0426', 'NDCG@10': '0.0211', 'HR@20': '0.0686', 'NDCG@20': '0.0276'}
2025-02-25 15:16:13,213 - Validation score increased.  Saving model ...
2025-02-25 15:16:55,464 - {'epoch': 6, 'rec_loss': '7.8677'}
2025-02-25 15:17:12,697 - {'Epoch': 6, 'HR@5': '0.0257', 'NDCG@5': '0.0160', 'HR@10': '0.0436', 'NDCG@10': '0.0218', 'HR@20': '0.0728', 'NDCG@20': '0.0291'}
2025-02-25 15:17:12,701 - Validation score increased.  Saving model ...
2025-02-25 15:17:54,828 - {'epoch': 7, 'rec_loss': '7.7890'}
2025-02-25 15:18:12,835 - {'Epoch': 7, 'HR@5': '0.0252', 'NDCG@5': '0.0157', 'HR@10': '0.0448', 'NDCG@10': '0.0219', 'HR@20': '0.0745', 'NDCG@20': '0.0294'}
2025-02-25 15:18:12,837 - Validation score increased.  Saving model ...
2025-02-25 15:18:54,101 - {'epoch': 8, 'rec_loss': '7.7205'}
2025-02-25 15:19:10,529 - {'Epoch': 8, 'HR@5': '0.0275', 'NDCG@5': '0.0169', 'HR@10': '0.0457', 'NDCG@10': '0.0228', 'HR@20': '0.0745', 'NDCG@20': '0.0300'}
2025-02-25 15:19:10,533 - Validation score increased.  Saving model ...
2025-02-25 15:19:52,342 - {'epoch': 9, 'rec_loss': '7.6718'}
2025-02-25 15:20:09,305 - {'Epoch': 9, 'HR@5': '0.0283', 'NDCG@5': '0.0176', 'HR@10': '0.0472', 'NDCG@10': '0.0236', 'HR@20': '0.0772', 'NDCG@20': '0.0311'}
2025-02-25 15:20:09,307 - Validation score increased.  Saving model ...
2025-02-25 15:20:50,823 - {'epoch': 10, 'rec_loss': '7.6237'}
2025-02-25 15:21:07,576 - {'Epoch': 10, 'HR@5': '0.0277', 'NDCG@5': '0.0176', 'HR@10': '0.0470', 'NDCG@10': '0.0238', 'HR@20': '0.0791', 'NDCG@20': '0.0319'}
2025-02-25 15:21:07,577 - Validation score increased.  Saving model ...
2025-02-25 15:21:49,574 - {'epoch': 11, 'rec_loss': '7.5854'}
2025-02-25 15:22:06,934 - {'Epoch': 11, 'HR@5': '0.0289', 'NDCG@5': '0.0179', 'HR@10': '0.0497', 'NDCG@10': '0.0245', 'HR@20': '0.0798', 'NDCG@20': '0.0321'}
2025-02-25 15:22:06,938 - Validation score increased.  Saving model ...
2025-02-25 15:22:48,410 - {'epoch': 12, 'rec_loss': '7.5537'}
2025-02-25 15:23:03,684 - {'Epoch': 12, 'HR@5': '0.0300', 'NDCG@5': '0.0186', 'HR@10': '0.0497', 'NDCG@10': '0.0249', 'HR@20': '0.0790', 'NDCG@20': '0.0323'}
2025-02-25 15:23:03,687 - Validation score increased.  Saving model ...
2025-02-25 15:23:45,950 - {'epoch': 13, 'rec_loss': '7.5215'}
2025-02-25 15:24:01,099 - {'Epoch': 13, 'HR@5': '0.0294', 'NDCG@5': '0.0182', 'HR@10': '0.0501', 'NDCG@10': '0.0249', 'HR@20': '0.0793', 'NDCG@20': '0.0322'}
2025-02-25 15:24:01,103 - EarlyStopping counter: 1 out of 10
2025-02-25 15:24:44,456 - {'epoch': 14, 'rec_loss': '7.4955'}
2025-02-25 15:24:59,491 - {'Epoch': 14, 'HR@5': '0.0295', 'NDCG@5': '0.0186', 'HR@10': '0.0490', 'NDCG@10': '0.0248', 'HR@20': '0.0802', 'NDCG@20': '0.0326'}
2025-02-25 15:24:59,494 - Validation score increased.  Saving model ...
2025-02-25 15:25:41,277 - {'epoch': 15, 'rec_loss': '7.4719'}
2025-02-25 15:25:58,535 - {'Epoch': 15, 'HR@5': '0.0308', 'NDCG@5': '0.0187', 'HR@10': '0.0501', 'NDCG@10': '0.0250', 'HR@20': '0.0806', 'NDCG@20': '0.0326'}
2025-02-25 15:25:58,539 - EarlyStopping counter: 1 out of 10
2025-02-25 15:26:42,101 - {'epoch': 16, 'rec_loss': '7.4481'}
2025-02-25 15:26:57,251 - {'Epoch': 16, 'HR@5': '0.0302', 'NDCG@5': '0.0186', 'HR@10': '0.0502', 'NDCG@10': '0.0250', 'HR@20': '0.0810', 'NDCG@20': '0.0328'}
2025-02-25 15:26:57,257 - Validation score increased.  Saving model ...
2025-02-25 15:27:40,108 - {'epoch': 17, 'rec_loss': '7.4266'}
2025-02-25 15:27:57,622 - {'Epoch': 17, 'HR@5': '0.0311', 'NDCG@5': '0.0193', 'HR@10': '0.0500', 'NDCG@10': '0.0254', 'HR@20': '0.0819', 'NDCG@20': '0.0334'}
2025-02-25 15:27:57,628 - Validation score increased.  Saving model ...
2025-02-25 15:28:38,847 - {'epoch': 18, 'rec_loss': '7.4032'}
2025-02-25 15:28:56,136 - {'Epoch': 18, 'HR@5': '0.0304', 'NDCG@5': '0.0191', 'HR@10': '0.0503', 'NDCG@10': '0.0255', 'HR@20': '0.0819', 'NDCG@20': '0.0334'}
2025-02-25 15:28:56,140 - Validation score increased.  Saving model ...
2025-02-25 15:29:37,572 - {'epoch': 19, 'rec_loss': '7.3885'}
2025-02-25 15:29:52,909 - {'Epoch': 19, 'HR@5': '0.0306', 'NDCG@5': '0.0190', 'HR@10': '0.0509', 'NDCG@10': '0.0256', 'HR@20': '0.0818', 'NDCG@20': '0.0333'}
2025-02-25 15:29:52,914 - EarlyStopping counter: 1 out of 10
2025-02-25 15:30:35,541 - {'epoch': 20, 'rec_loss': '7.3726'}
2025-02-25 15:30:50,663 - {'Epoch': 20, 'HR@5': '0.0302', 'NDCG@5': '0.0189', 'HR@10': '0.0503', 'NDCG@10': '0.0254', 'HR@20': '0.0819', 'NDCG@20': '0.0333'}
2025-02-25 15:30:50,664 - EarlyStopping counter: 2 out of 10
2025-02-25 15:31:33,157 - {'epoch': 21, 'rec_loss': '7.3625'}
2025-02-25 15:31:50,384 - {'Epoch': 21, 'HR@5': '0.0299', 'NDCG@5': '0.0189', 'HR@10': '0.0517', 'NDCG@10': '0.0259', 'HR@20': '0.0821', 'NDCG@20': '0.0336'}
2025-02-25 15:31:50,386 - Validation score increased.  Saving model ...
2025-02-25 15:32:33,020 - {'epoch': 22, 'rec_loss': '7.3468'}
2025-02-25 15:32:48,334 - {'Epoch': 22, 'HR@5': '0.0296', 'NDCG@5': '0.0183', 'HR@10': '0.0507', 'NDCG@10': '0.0251', 'HR@20': '0.0824', 'NDCG@20': '0.0331'}
2025-02-25 15:32:48,338 - EarlyStopping counter: 1 out of 10
2025-02-25 15:33:30,326 - {'epoch': 23, 'rec_loss': '7.3271'}
2025-02-25 15:33:47,961 - {'Epoch': 23, 'HR@5': '0.0310', 'NDCG@5': '0.0191', 'HR@10': '0.0514', 'NDCG@10': '0.0257', 'HR@20': '0.0839', 'NDCG@20': '0.0338'}
2025-02-25 15:33:47,965 - Validation score increased.  Saving model ...
2025-02-25 15:34:30,039 - {'epoch': 24, 'rec_loss': '7.3177'}
2025-02-25 15:34:47,558 - {'Epoch': 24, 'HR@5': '0.0318', 'NDCG@5': '0.0197', 'HR@10': '0.0520', 'NDCG@10': '0.0262', 'HR@20': '0.0822', 'NDCG@20': '0.0338'}
2025-02-25 15:34:47,562 - EarlyStopping counter: 1 out of 10
2025-02-25 15:35:30,607 - {'epoch': 25, 'rec_loss': '7.3038'}
2025-02-25 15:35:48,097 - {'Epoch': 25, 'HR@5': '0.0306', 'NDCG@5': '0.0194', 'HR@10': '0.0508', 'NDCG@10': '0.0259', 'HR@20': '0.0831', 'NDCG@20': '0.0341'}
2025-02-25 15:35:48,102 - Validation score increased.  Saving model ...
2025-02-25 15:36:30,735 - {'epoch': 26, 'rec_loss': '7.2950'}
2025-02-25 15:36:46,111 - {'Epoch': 26, 'HR@5': '0.0310', 'NDCG@5': '0.0194', 'HR@10': '0.0516', 'NDCG@10': '0.0260', 'HR@20': '0.0822', 'NDCG@20': '0.0337'}
2025-02-25 15:36:46,115 - EarlyStopping counter: 1 out of 10
2025-02-25 15:37:28,015 - {'epoch': 27, 'rec_loss': '7.2849'}
2025-02-25 15:37:45,125 - {'Epoch': 27, 'HR@5': '0.0317', 'NDCG@5': '0.0199', 'HR@10': '0.0518', 'NDCG@10': '0.0263', 'HR@20': '0.0825', 'NDCG@20': '0.0340'}
2025-02-25 15:37:45,127 - EarlyStopping counter: 2 out of 10
2025-02-25 15:38:26,598 - {'epoch': 28, 'rec_loss': '7.2748'}
2025-02-25 15:38:41,876 - {'Epoch': 28, 'HR@5': '0.0315', 'NDCG@5': '0.0197', 'HR@10': '0.0519', 'NDCG@10': '0.0263', 'HR@20': '0.0817', 'NDCG@20': '0.0337'}
2025-02-25 15:38:41,880 - EarlyStopping counter: 3 out of 10
2025-02-25 15:39:25,361 - {'epoch': 29, 'rec_loss': '7.2656'}
2025-02-25 15:39:40,634 - {'Epoch': 29, 'HR@5': '0.0307', 'NDCG@5': '0.0193', 'HR@10': '0.0508', 'NDCG@10': '0.0258', 'HR@20': '0.0819', 'NDCG@20': '0.0335'}
2025-02-25 15:39:40,638 - EarlyStopping counter: 4 out of 10
2025-02-25 15:40:22,538 - {'epoch': 30, 'rec_loss': '7.2561'}
2025-02-25 15:40:40,161 - {'Epoch': 30, 'HR@5': '0.0317', 'NDCG@5': '0.0202', 'HR@10': '0.0517', 'NDCG@10': '0.0266', 'HR@20': '0.0826', 'NDCG@20': '0.0344'}
2025-02-25 15:40:40,165 - Validation score increased.  Saving model ...
2025-02-25 15:41:21,463 - {'epoch': 31, 'rec_loss': '7.2464'}
2025-02-25 15:41:38,287 - {'Epoch': 31, 'HR@5': '0.0313', 'NDCG@5': '0.0195', 'HR@10': '0.0516', 'NDCG@10': '0.0260', 'HR@20': '0.0829', 'NDCG@20': '0.0339'}
2025-02-25 15:41:38,291 - EarlyStopping counter: 1 out of 10
2025-02-25 15:42:21,253 - {'epoch': 32, 'rec_loss': '7.2395'}
2025-02-25 15:42:37,456 - {'Epoch': 32, 'HR@5': '0.0306', 'NDCG@5': '0.0191', 'HR@10': '0.0521', 'NDCG@10': '0.0259', 'HR@20': '0.0825', 'NDCG@20': '0.0336'}
2025-02-25 15:42:37,458 - EarlyStopping counter: 2 out of 10
2025-02-25 15:43:21,497 - {'epoch': 33, 'rec_loss': '7.2333'}
2025-02-25 15:43:36,937 - {'Epoch': 33, 'HR@5': '0.0322', 'NDCG@5': '0.0202', 'HR@10': '0.0529', 'NDCG@10': '0.0268', 'HR@20': '0.0847', 'NDCG@20': '0.0348'}
2025-02-25 15:43:36,940 - Validation score increased.  Saving model ...
2025-02-25 15:44:20,337 - {'epoch': 34, 'rec_loss': '7.2259'}
2025-02-25 15:44:37,673 - {'Epoch': 34, 'HR@5': '0.0318', 'NDCG@5': '0.0196', 'HR@10': '0.0528', 'NDCG@10': '0.0263', 'HR@20': '0.0832', 'NDCG@20': '0.0339'}
2025-02-25 15:44:37,677 - EarlyStopping counter: 1 out of 10
2025-02-25 15:45:19,814 - {'epoch': 35, 'rec_loss': '7.2212'}
2025-02-25 15:45:37,345 - {'Epoch': 35, 'HR@5': '0.0299', 'NDCG@5': '0.0185', 'HR@10': '0.0502', 'NDCG@10': '0.0251', 'HR@20': '0.0815', 'NDCG@20': '0.0329'}
2025-02-25 15:45:37,349 - EarlyStopping counter: 2 out of 10
2025-02-25 15:46:18,803 - {'epoch': 36, 'rec_loss': '7.2140'}
2025-02-25 15:46:36,212 - {'Epoch': 36, 'HR@5': '0.0309', 'NDCG@5': '0.0193', 'HR@10': '0.0513', 'NDCG@10': '0.0258', 'HR@20': '0.0819', 'NDCG@20': '0.0335'}
2025-02-25 15:46:36,216 - EarlyStopping counter: 3 out of 10
2025-02-25 15:47:17,631 - {'epoch': 37, 'rec_loss': '7.2065'}
2025-02-25 15:47:32,928 - {'Epoch': 37, 'HR@5': '0.0315', 'NDCG@5': '0.0201', 'HR@10': '0.0514', 'NDCG@10': '0.0264', 'HR@20': '0.0821', 'NDCG@20': '0.0341'}
2025-02-25 15:47:32,932 - EarlyStopping counter: 4 out of 10
2025-02-25 15:48:15,085 - {'epoch': 38, 'rec_loss': '7.1950'}
2025-02-25 15:48:32,616 - {'Epoch': 38, 'HR@5': '0.0317', 'NDCG@5': '0.0200', 'HR@10': '0.0514', 'NDCG@10': '0.0263', 'HR@20': '0.0830', 'NDCG@20': '0.0342'}
2025-02-25 15:48:32,620 - EarlyStopping counter: 5 out of 10
2025-02-25 15:49:14,697 - {'epoch': 39, 'rec_loss': '7.1877'}
2025-02-25 15:49:29,958 - {'Epoch': 39, 'HR@5': '0.0318', 'NDCG@5': '0.0200', 'HR@10': '0.0503', 'NDCG@10': '0.0259', 'HR@20': '0.0832', 'NDCG@20': '0.0342'}
2025-02-25 15:49:29,960 - EarlyStopping counter: 6 out of 10
2025-02-25 15:50:11,862 - {'epoch': 40, 'rec_loss': '7.1918'}
2025-02-25 15:50:28,306 - {'Epoch': 40, 'HR@5': '0.0309', 'NDCG@5': '0.0193', 'HR@10': '0.0510', 'NDCG@10': '0.0258', 'HR@20': '0.0818', 'NDCG@20': '0.0335'}
2025-02-25 15:50:28,310 - EarlyStopping counter: 7 out of 10
2025-02-25 15:51:10,840 - {'epoch': 41, 'rec_loss': '7.1815'}
2025-02-25 15:51:26,179 - {'Epoch': 41, 'HR@5': '0.0313', 'NDCG@5': '0.0195', 'HR@10': '0.0509', 'NDCG@10': '0.0258', 'HR@20': '0.0831', 'NDCG@20': '0.0339'}
2025-02-25 15:51:26,182 - EarlyStopping counter: 8 out of 10
2025-02-25 15:52:08,295 - {'epoch': 42, 'rec_loss': '7.1767'}
2025-02-25 15:52:25,903 - {'Epoch': 42, 'HR@5': '0.0312', 'NDCG@5': '0.0199', 'HR@10': '0.0497', 'NDCG@10': '0.0258', 'HR@20': '0.0816', 'NDCG@20': '0.0338'}
2025-02-25 15:52:25,904 - EarlyStopping counter: 9 out of 10
2025-02-25 15:53:08,340 - {'epoch': 43, 'rec_loss': '7.1727'}
2025-02-25 15:53:25,933 - {'Epoch': 43, 'HR@5': '0.0308', 'NDCG@5': '0.0191', 'HR@10': '0.0509', 'NDCG@10': '0.0256', 'HR@20': '0.0818', 'NDCG@20': '0.0333'}
2025-02-25 15:53:25,935 - EarlyStopping counter: 10 out of 10
2025-02-25 15:53:25,935 - Early stopping
2025-02-25 15:53:25,935 - ---------------Test Score---------------
2025-02-25 15:53:41,269 - {'Epoch': 0, 'HR@5': '0.0285', 'NDCG@5': '0.0177', 'HR@10': '0.0493', 'NDCG@10': '0.0244', 'HR@20': '0.0777', 'NDCG@20': '0.0315'}
2025-02-25 15:53:41,273 - Scale_Yelp
2025-02-25 15:53:41,273 - {'Epoch': 0, 'HR@5': '0.0285', 'NDCG@5': '0.0177', 'HR@10': '0.0493', 'NDCG@10': '0.0244', 'HR@20': '0.0777', 'NDCG@20': '0.0315'}
2025-02-25 16:10:52,417 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25, 10], kernels=[4, 8, 12], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-02-25 16:10:55,175 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-25 16:10:55,180 - Total Parameters: 1436118
2025-02-25 16:11:52,967 - {'epoch': 0, 'rec_loss': '9.5490'}
2025-02-25 16:12:10,088 - {'Epoch': 0, 'HR@5': '0.0074', 'NDCG@5': '0.0045', 'HR@10': '0.0157', 'NDCG@10': '0.0072', 'HR@20': '0.0256', 'NDCG@20': '0.0097'}
2025-02-25 16:12:10,090 - Validation score increased.  Saving model ...
2025-02-25 16:13:09,078 - {'epoch': 1, 'rec_loss': '8.8510'}
2025-02-25 16:13:24,574 - {'Epoch': 1, 'HR@5': '0.0152', 'NDCG@5': '0.0093', 'HR@10': '0.0268', 'NDCG@10': '0.0130', 'HR@20': '0.0447', 'NDCG@20': '0.0175'}
2025-02-25 16:13:24,575 - Validation score increased.  Saving model ...
2025-02-25 16:14:22,265 - {'epoch': 2, 'rec_loss': '8.3729'}
2025-02-25 16:14:37,609 - {'Epoch': 2, 'HR@5': '0.0183', 'NDCG@5': '0.0113', 'HR@10': '0.0321', 'NDCG@10': '0.0157', 'HR@20': '0.0543', 'NDCG@20': '0.0213'}
2025-02-25 16:14:37,611 - Validation score increased.  Saving model ...
2025-02-25 16:15:35,268 - {'epoch': 3, 'rec_loss': '8.1106'}
2025-02-25 16:15:50,724 - {'Epoch': 3, 'HR@5': '0.0216', 'NDCG@5': '0.0132', 'HR@10': '0.0383', 'NDCG@10': '0.0186', 'HR@20': '0.0636', 'NDCG@20': '0.0249'}
2025-02-25 16:15:50,729 - Validation score increased.  Saving model ...
2025-02-25 16:16:57,196 - {'epoch': 4, 'rec_loss': '7.9352'}
2025-02-25 16:17:12,985 - {'Epoch': 4, 'HR@5': '0.0230', 'NDCG@5': '0.0144', 'HR@10': '0.0400', 'NDCG@10': '0.0198', 'HR@20': '0.0673', 'NDCG@20': '0.0267'}
2025-02-25 16:17:12,986 - Validation score increased.  Saving model ...
2025-02-25 16:18:08,721 - {'epoch': 5, 'rec_loss': '7.8116'}
2025-02-25 16:18:24,677 - {'Epoch': 5, 'HR@5': '0.0249', 'NDCG@5': '0.0157', 'HR@10': '0.0439', 'NDCG@10': '0.0218', 'HR@20': '0.0711', 'NDCG@20': '0.0286'}
2025-02-25 16:18:24,680 - Validation score increased.  Saving model ...
2025-02-25 16:19:22,497 - {'epoch': 6, 'rec_loss': '7.7162'}
2025-02-25 16:19:37,889 - {'Epoch': 6, 'HR@5': '0.0265', 'NDCG@5': '0.0167', 'HR@10': '0.0442', 'NDCG@10': '0.0223', 'HR@20': '0.0734', 'NDCG@20': '0.0297'}
2025-02-25 16:19:37,891 - Validation score increased.  Saving model ...
2025-02-25 16:20:38,983 - {'epoch': 7, 'rec_loss': '7.6447'}
2025-02-25 16:20:54,487 - {'Epoch': 7, 'HR@5': '0.0275', 'NDCG@5': '0.0172', 'HR@10': '0.0468', 'NDCG@10': '0.0234', 'HR@20': '0.0755', 'NDCG@20': '0.0306'}
2025-02-25 16:20:54,488 - Validation score increased.  Saving model ...
2025-02-25 16:21:57,751 - {'epoch': 8, 'rec_loss': '7.5833'}
2025-02-25 16:22:13,579 - {'Epoch': 8, 'HR@5': '0.0270', 'NDCG@5': '0.0170', 'HR@10': '0.0460', 'NDCG@10': '0.0231', 'HR@20': '0.0735', 'NDCG@20': '0.0300'}
2025-02-25 16:22:13,581 - EarlyStopping counter: 1 out of 10
2025-02-25 16:23:19,042 - {'epoch': 9, 'rec_loss': '7.5329'}
2025-02-25 16:23:34,692 - {'Epoch': 9, 'HR@5': '0.0278', 'NDCG@5': '0.0173', 'HR@10': '0.0479', 'NDCG@10': '0.0237', 'HR@20': '0.0775', 'NDCG@20': '0.0312'}
2025-02-25 16:23:34,694 - Validation score increased.  Saving model ...
2025-02-25 16:24:31,164 - {'epoch': 10, 'rec_loss': '7.4849'}
2025-02-25 16:24:48,973 - {'Epoch': 10, 'HR@5': '0.0279', 'NDCG@5': '0.0174', 'HR@10': '0.0468', 'NDCG@10': '0.0235', 'HR@20': '0.0775', 'NDCG@20': '0.0312'}
2025-02-25 16:24:48,977 - Validation score increased.  Saving model ...
2025-02-25 16:25:51,704 - {'epoch': 11, 'rec_loss': '7.4493'}
2025-02-25 16:26:07,491 - {'Epoch': 11, 'HR@5': '0.0286', 'NDCG@5': '0.0177', 'HR@10': '0.0491', 'NDCG@10': '0.0243', 'HR@20': '0.0796', 'NDCG@20': '0.0320'}
2025-02-25 16:26:07,492 - Validation score increased.  Saving model ...
2025-02-25 16:27:05,269 - {'epoch': 12, 'rec_loss': '7.4112'}
2025-02-25 16:27:20,862 - {'Epoch': 12, 'HR@5': '0.0290', 'NDCG@5': '0.0183', 'HR@10': '0.0484', 'NDCG@10': '0.0246', 'HR@20': '0.0775', 'NDCG@20': '0.0318'}
2025-02-25 16:27:20,867 - EarlyStopping counter: 1 out of 10
2025-02-25 16:28:16,584 - {'epoch': 13, 'rec_loss': '7.3850'}
2025-02-25 16:28:32,461 - {'Epoch': 13, 'HR@5': '0.0290', 'NDCG@5': '0.0180', 'HR@10': '0.0481', 'NDCG@10': '0.0241', 'HR@20': '0.0801', 'NDCG@20': '0.0321'}
2025-02-25 16:28:32,462 - Validation score increased.  Saving model ...
2025-02-25 16:29:32,010 - {'epoch': 14, 'rec_loss': '7.3582'}
2025-02-25 16:29:50,111 - {'Epoch': 14, 'HR@5': '0.0286', 'NDCG@5': '0.0179', 'HR@10': '0.0486', 'NDCG@10': '0.0243', 'HR@20': '0.0780', 'NDCG@20': '0.0317'}
2025-02-25 16:29:50,113 - EarlyStopping counter: 1 out of 10
2025-02-25 16:30:46,592 - {'epoch': 15, 'rec_loss': '7.3328'}
2025-02-25 16:31:02,245 - {'Epoch': 15, 'HR@5': '0.0290', 'NDCG@5': '0.0181', 'HR@10': '0.0479', 'NDCG@10': '0.0242', 'HR@20': '0.0782', 'NDCG@20': '0.0318'}
2025-02-25 16:31:02,247 - EarlyStopping counter: 2 out of 10
2025-02-25 16:32:00,497 - {'epoch': 16, 'rec_loss': '7.3089'}
2025-02-25 16:32:17,120 - {'Epoch': 16, 'HR@5': '0.0291', 'NDCG@5': '0.0183', 'HR@10': '0.0500', 'NDCG@10': '0.0250', 'HR@20': '0.0811', 'NDCG@20': '0.0328'}
2025-02-25 16:32:17,124 - Validation score increased.  Saving model ...
2025-02-25 16:33:17,774 - {'epoch': 17, 'rec_loss': '7.2874'}
2025-02-25 16:33:33,712 - {'Epoch': 17, 'HR@5': '0.0290', 'NDCG@5': '0.0182', 'HR@10': '0.0490', 'NDCG@10': '0.0246', 'HR@20': '0.0801', 'NDCG@20': '0.0324'}
2025-02-25 16:33:33,715 - EarlyStopping counter: 1 out of 10
2025-02-25 16:34:31,517 - {'epoch': 18, 'rec_loss': '7.2708'}
2025-02-25 16:34:47,311 - {'Epoch': 18, 'HR@5': '0.0292', 'NDCG@5': '0.0184', 'HR@10': '0.0499', 'NDCG@10': '0.0250', 'HR@20': '0.0796', 'NDCG@20': '0.0325'}
2025-02-25 16:34:47,316 - EarlyStopping counter: 2 out of 10
2025-02-25 16:35:45,576 - {'epoch': 19, 'rec_loss': '7.2507'}
2025-02-25 16:36:01,497 - {'Epoch': 19, 'HR@5': '0.0308', 'NDCG@5': '0.0194', 'HR@10': '0.0506', 'NDCG@10': '0.0258', 'HR@20': '0.0814', 'NDCG@20': '0.0335'}
2025-02-25 16:36:01,499 - Validation score increased.  Saving model ...
2025-02-25 16:37:00,031 - {'epoch': 20, 'rec_loss': '7.2359'}
2025-02-25 16:37:15,832 - {'Epoch': 20, 'HR@5': '0.0300', 'NDCG@5': '0.0187', 'HR@10': '0.0499', 'NDCG@10': '0.0251', 'HR@20': '0.0799', 'NDCG@20': '0.0326'}
2025-02-25 16:37:15,833 - EarlyStopping counter: 1 out of 10
2025-02-25 16:38:14,525 - {'epoch': 21, 'rec_loss': '7.2195'}
2025-02-25 16:38:30,425 - {'Epoch': 21, 'HR@5': '0.0290', 'NDCG@5': '0.0181', 'HR@10': '0.0500', 'NDCG@10': '0.0248', 'HR@20': '0.0804', 'NDCG@20': '0.0325'}
2025-02-25 16:38:30,427 - EarlyStopping counter: 2 out of 10
2025-02-25 16:39:30,089 - {'epoch': 22, 'rec_loss': '7.2022'}
2025-02-25 16:39:45,816 - {'Epoch': 22, 'HR@5': '0.0313', 'NDCG@5': '0.0193', 'HR@10': '0.0518', 'NDCG@10': '0.0258', 'HR@20': '0.0808', 'NDCG@20': '0.0331'}
2025-02-25 16:39:45,818 - EarlyStopping counter: 3 out of 10
2025-02-25 16:40:44,874 - {'epoch': 23, 'rec_loss': '7.1908'}
2025-02-25 16:41:01,217 - {'Epoch': 23, 'HR@5': '0.0292', 'NDCG@5': '0.0185', 'HR@10': '0.0491', 'NDCG@10': '0.0249', 'HR@20': '0.0800', 'NDCG@20': '0.0326'}
2025-02-25 16:41:01,218 - EarlyStopping counter: 4 out of 10
2025-02-25 16:42:03,551 - {'epoch': 24, 'rec_loss': '7.1779'}
2025-02-25 16:42:19,325 - {'Epoch': 24, 'HR@5': '0.0300', 'NDCG@5': '0.0186', 'HR@10': '0.0512', 'NDCG@10': '0.0254', 'HR@20': '0.0813', 'NDCG@20': '0.0330'}
2025-02-25 16:42:19,327 - EarlyStopping counter: 5 out of 10
2025-02-25 16:43:17,349 - {'epoch': 25, 'rec_loss': '7.1685'}
2025-02-25 16:43:33,163 - {'Epoch': 25, 'HR@5': '0.0298', 'NDCG@5': '0.0187', 'HR@10': '0.0495', 'NDCG@10': '0.0250', 'HR@20': '0.0798', 'NDCG@20': '0.0325'}
2025-02-25 16:43:33,165 - EarlyStopping counter: 6 out of 10
2025-02-25 16:44:27,522 - {'epoch': 26, 'rec_loss': '7.1541'}
2025-02-25 16:44:43,399 - {'Epoch': 26, 'HR@5': '0.0300', 'NDCG@5': '0.0186', 'HR@10': '0.0493', 'NDCG@10': '0.0247', 'HR@20': '0.0796', 'NDCG@20': '0.0323'}
2025-02-25 16:44:43,401 - EarlyStopping counter: 7 out of 10
2025-02-25 16:45:41,890 - {'epoch': 27, 'rec_loss': '7.1467'}
2025-02-25 16:45:57,698 - {'Epoch': 27, 'HR@5': '0.0298', 'NDCG@5': '0.0186', 'HR@10': '0.0479', 'NDCG@10': '0.0244', 'HR@20': '0.0792', 'NDCG@20': '0.0323'}
2025-02-25 16:45:57,699 - EarlyStopping counter: 8 out of 10
2025-02-25 16:46:53,242 - {'epoch': 28, 'rec_loss': '7.1375'}
2025-02-25 16:47:09,945 - {'Epoch': 28, 'HR@5': '0.0293', 'NDCG@5': '0.0183', 'HR@10': '0.0498', 'NDCG@10': '0.0249', 'HR@20': '0.0780', 'NDCG@20': '0.0319'}
2025-02-25 16:47:09,947 - EarlyStopping counter: 9 out of 10
2025-02-25 16:48:11,915 - {'epoch': 29, 'rec_loss': '7.1266'}
2025-02-25 16:48:27,956 - {'Epoch': 29, 'HR@5': '0.0294', 'NDCG@5': '0.0188', 'HR@10': '0.0487', 'NDCG@10': '0.0250', 'HR@20': '0.0787', 'NDCG@20': '0.0325'}
2025-02-25 16:48:27,958 - EarlyStopping counter: 10 out of 10
2025-02-25 16:48:27,958 - Early stopping
2025-02-25 16:48:27,959 - ---------------Test Score---------------
2025-02-25 16:48:43,654 - {'Epoch': 0, 'HR@5': '0.0276', 'NDCG@5': '0.0172', 'HR@10': '0.0460', 'NDCG@10': '0.0231', 'HR@20': '0.0750', 'NDCG@20': '0.0304'}
2025-02-25 16:48:43,658 - Scale_Yelp
2025-02-25 16:48:43,659 - {'Epoch': 0, 'HR@5': '0.0276', 'NDCG@5': '0.0172', 'HR@10': '0.0460', 'NDCG@10': '0.0231', 'HR@20': '0.0750', 'NDCG@20': '0.0304'}
2025-02-25 16:51:59,541 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 5], kernels=[4, 8, 12], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-02-25 16:52:02,320 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-25 16:52:02,326 - Total Parameters: 1435793
2025-02-25 16:52:49,896 - {'epoch': 0, 'rec_loss': '9.5491'}
2025-02-25 16:53:05,581 - {'Epoch': 0, 'HR@5': '0.0073', 'NDCG@5': '0.0047', 'HR@10': '0.0131', 'NDCG@10': '0.0066', 'HR@20': '0.0243', 'NDCG@20': '0.0094'}
2025-02-25 16:53:05,586 - Validation score increased.  Saving model ...
2025-02-25 16:53:49,305 - {'epoch': 1, 'rec_loss': '8.9440'}
2025-02-25 16:54:04,521 - {'Epoch': 1, 'HR@5': '0.0132', 'NDCG@5': '0.0081', 'HR@10': '0.0239', 'NDCG@10': '0.0115', 'HR@20': '0.0415', 'NDCG@20': '0.0159'}
2025-02-25 16:54:04,527 - Validation score increased.  Saving model ...
2025-02-25 16:54:49,050 - {'epoch': 2, 'rec_loss': '8.5157'}
2025-02-25 16:55:03,820 - {'Epoch': 2, 'HR@5': '0.0190', 'NDCG@5': '0.0120', 'HR@10': '0.0321', 'NDCG@10': '0.0162', 'HR@20': '0.0527', 'NDCG@20': '0.0214'}
2025-02-25 16:55:03,821 - Validation score increased.  Saving model ...
2025-02-25 16:55:44,929 - {'epoch': 3, 'rec_loss': '8.2509'}
2025-02-25 16:55:59,526 - {'Epoch': 3, 'HR@5': '0.0218', 'NDCG@5': '0.0134', 'HR@10': '0.0379', 'NDCG@10': '0.0185', 'HR@20': '0.0605', 'NDCG@20': '0.0242'}
2025-02-25 16:55:59,527 - Validation score increased.  Saving model ...
2025-02-25 16:56:40,543 - {'epoch': 4, 'rec_loss': '8.0803'}
2025-02-25 16:56:55,374 - {'Epoch': 4, 'HR@5': '0.0218', 'NDCG@5': '0.0140', 'HR@10': '0.0391', 'NDCG@10': '0.0196', 'HR@20': '0.0666', 'NDCG@20': '0.0265'}
2025-02-25 16:56:55,376 - Validation score increased.  Saving model ...
2025-02-25 16:57:38,303 - {'epoch': 5, 'rec_loss': '7.9556'}
2025-02-25 16:57:55,467 - {'Epoch': 5, 'HR@5': '0.0233', 'NDCG@5': '0.0143', 'HR@10': '0.0411', 'NDCG@10': '0.0200', 'HR@20': '0.0698', 'NDCG@20': '0.0272'}
2025-02-25 16:57:55,469 - Validation score increased.  Saving model ...
2025-02-25 16:58:36,602 - {'epoch': 6, 'rec_loss': '7.8559'}
2025-02-25 16:58:51,808 - {'Epoch': 6, 'HR@5': '0.0253', 'NDCG@5': '0.0159', 'HR@10': '0.0440', 'NDCG@10': '0.0218', 'HR@20': '0.0730', 'NDCG@20': '0.0291'}
2025-02-25 16:58:51,810 - Validation score increased.  Saving model ...
2025-02-25 16:59:33,017 - {'epoch': 7, 'rec_loss': '7.7870'}
2025-02-25 16:59:49,794 - {'Epoch': 7, 'HR@5': '0.0256', 'NDCG@5': '0.0158', 'HR@10': '0.0446', 'NDCG@10': '0.0219', 'HR@20': '0.0729', 'NDCG@20': '0.0290'}
2025-02-25 16:59:49,795 - EarlyStopping counter: 1 out of 10
2025-02-25 17:00:30,788 - {'epoch': 8, 'rec_loss': '7.7231'}
2025-02-25 17:00:48,093 - {'Epoch': 8, 'HR@5': '0.0268', 'NDCG@5': '0.0167', 'HR@10': '0.0463', 'NDCG@10': '0.0230', 'HR@20': '0.0747', 'NDCG@20': '0.0301'}
2025-02-25 17:00:48,094 - Validation score increased.  Saving model ...
2025-02-25 17:01:30,062 - {'epoch': 9, 'rec_loss': '7.6716'}
2025-02-25 17:01:45,365 - {'Epoch': 9, 'HR@5': '0.0270', 'NDCG@5': '0.0169', 'HR@10': '0.0475', 'NDCG@10': '0.0235', 'HR@20': '0.0771', 'NDCG@20': '0.0309'}
2025-02-25 17:01:45,366 - Validation score increased.  Saving model ...
2025-02-25 17:02:28,376 - {'epoch': 10, 'rec_loss': '7.6300'}
2025-02-25 17:02:44,414 - {'Epoch': 10, 'HR@5': '0.0275', 'NDCG@5': '0.0172', 'HR@10': '0.0469', 'NDCG@10': '0.0235', 'HR@20': '0.0778', 'NDCG@20': '0.0312'}
2025-02-25 17:02:44,416 - Validation score increased.  Saving model ...
2025-02-25 17:03:26,014 - {'epoch': 11, 'rec_loss': '7.5877'}
2025-02-25 17:03:41,184 - {'Epoch': 11, 'HR@5': '0.0280', 'NDCG@5': '0.0175', 'HR@10': '0.0479', 'NDCG@10': '0.0239', 'HR@20': '0.0771', 'NDCG@20': '0.0312'}
2025-02-25 17:03:41,186 - Validation score increased.  Saving model ...
2025-02-25 17:04:22,213 - {'epoch': 12, 'rec_loss': '7.5614'}
2025-02-25 17:04:37,450 - {'Epoch': 12, 'HR@5': '0.0300', 'NDCG@5': '0.0187', 'HR@10': '0.0483', 'NDCG@10': '0.0246', 'HR@20': '0.0780', 'NDCG@20': '0.0320'}
2025-02-25 17:04:37,452 - Validation score increased.  Saving model ...
2025-02-25 17:05:19,436 - {'epoch': 13, 'rec_loss': '7.5244'}
2025-02-25 17:05:37,100 - {'Epoch': 13, 'HR@5': '0.0300', 'NDCG@5': '0.0188', 'HR@10': '0.0501', 'NDCG@10': '0.0253', 'HR@20': '0.0787', 'NDCG@20': '0.0325'}
2025-02-25 17:05:37,101 - Validation score increased.  Saving model ...
2025-02-25 17:06:18,724 - {'epoch': 14, 'rec_loss': '7.4996'}
2025-02-25 17:06:36,930 - {'Epoch': 14, 'HR@5': '0.0286', 'NDCG@5': '0.0182', 'HR@10': '0.0493', 'NDCG@10': '0.0248', 'HR@20': '0.0800', 'NDCG@20': '0.0325'}
2025-02-25 17:06:36,932 - Validation score increased.  Saving model ...
2025-02-25 17:07:17,931 - {'epoch': 15, 'rec_loss': '7.4725'}
2025-02-25 17:07:33,636 - {'Epoch': 15, 'HR@5': '0.0298', 'NDCG@5': '0.0186', 'HR@10': '0.0488', 'NDCG@10': '0.0247', 'HR@20': '0.0794', 'NDCG@20': '0.0323'}
2025-02-25 17:07:33,638 - EarlyStopping counter: 1 out of 10
2025-02-25 17:08:15,335 - {'epoch': 16, 'rec_loss': '7.4527'}
2025-02-25 17:08:30,763 - {'Epoch': 16, 'HR@5': '0.0296', 'NDCG@5': '0.0186', 'HR@10': '0.0496', 'NDCG@10': '0.0251', 'HR@20': '0.0803', 'NDCG@20': '0.0328'}
2025-02-25 17:08:30,765 - Validation score increased.  Saving model ...
2025-02-25 17:09:11,731 - {'epoch': 17, 'rec_loss': '7.4276'}
2025-02-25 17:09:29,232 - {'Epoch': 17, 'HR@5': '0.0311', 'NDCG@5': '0.0194', 'HR@10': '0.0505', 'NDCG@10': '0.0256', 'HR@20': '0.0792', 'NDCG@20': '0.0328'}
2025-02-25 17:09:29,234 - Validation score increased.  Saving model ...
2025-02-25 17:10:10,644 - {'epoch': 18, 'rec_loss': '7.4084'}
2025-02-25 17:10:28,112 - {'Epoch': 18, 'HR@5': '0.0293', 'NDCG@5': '0.0185', 'HR@10': '0.0489', 'NDCG@10': '0.0248', 'HR@20': '0.0812', 'NDCG@20': '0.0329'}
2025-02-25 17:10:28,114 - Validation score increased.  Saving model ...
2025-02-25 17:11:10,512 - {'epoch': 19, 'rec_loss': '7.3937'}
2025-02-25 17:11:25,640 - {'Epoch': 19, 'HR@5': '0.0296', 'NDCG@5': '0.0186', 'HR@10': '0.0499', 'NDCG@10': '0.0251', 'HR@20': '0.0798', 'NDCG@20': '0.0326'}
2025-02-25 17:11:25,646 - EarlyStopping counter: 1 out of 10
2025-02-25 17:12:07,530 - {'epoch': 20, 'rec_loss': '7.3761'}
2025-02-25 17:12:22,859 - {'Epoch': 20, 'HR@5': '0.0294', 'NDCG@5': '0.0186', 'HR@10': '0.0501', 'NDCG@10': '0.0252', 'HR@20': '0.0805', 'NDCG@20': '0.0329'}
2025-02-25 17:12:22,861 - EarlyStopping counter: 2 out of 10
2025-02-25 17:13:06,399 - {'epoch': 21, 'rec_loss': '7.3668'}
2025-02-25 17:13:21,618 - {'Epoch': 21, 'HR@5': '0.0301', 'NDCG@5': '0.0189', 'HR@10': '0.0507', 'NDCG@10': '0.0256', 'HR@20': '0.0808', 'NDCG@20': '0.0331'}
2025-02-25 17:13:21,619 - Validation score increased.  Saving model ...
2025-02-25 17:14:03,582 - {'epoch': 22, 'rec_loss': '7.3558'}
2025-02-25 17:14:21,083 - {'Epoch': 22, 'HR@5': '0.0286', 'NDCG@5': '0.0179', 'HR@10': '0.0499', 'NDCG@10': '0.0247', 'HR@20': '0.0796', 'NDCG@20': '0.0322'}
2025-02-25 17:14:21,085 - EarlyStopping counter: 1 out of 10
2025-02-25 17:15:01,962 - {'epoch': 23, 'rec_loss': '7.3335'}
2025-02-25 17:15:19,354 - {'Epoch': 23, 'HR@5': '0.0293', 'NDCG@5': '0.0186', 'HR@10': '0.0497', 'NDCG@10': '0.0252', 'HR@20': '0.0804', 'NDCG@20': '0.0329'}
2025-02-25 17:15:19,356 - EarlyStopping counter: 2 out of 10
2025-02-25 17:16:01,118 - {'epoch': 24, 'rec_loss': '7.3280'}
2025-02-25 17:16:18,643 - {'Epoch': 24, 'HR@5': '0.0290', 'NDCG@5': '0.0181', 'HR@10': '0.0482', 'NDCG@10': '0.0243', 'HR@20': '0.0809', 'NDCG@20': '0.0325'}
2025-02-25 17:16:18,649 - EarlyStopping counter: 3 out of 10
2025-02-25 17:16:59,633 - {'epoch': 25, 'rec_loss': '7.3146'}
2025-02-25 17:17:16,843 - {'Epoch': 25, 'HR@5': '0.0308', 'NDCG@5': '0.0190', 'HR@10': '0.0499', 'NDCG@10': '0.0252', 'HR@20': '0.0797', 'NDCG@20': '0.0327'}
2025-02-25 17:17:16,848 - EarlyStopping counter: 4 out of 10
2025-02-25 17:17:58,101 - {'epoch': 26, 'rec_loss': '7.3039'}
2025-02-25 17:18:13,262 - {'Epoch': 26, 'HR@5': '0.0308', 'NDCG@5': '0.0195', 'HR@10': '0.0508', 'NDCG@10': '0.0259', 'HR@20': '0.0815', 'NDCG@20': '0.0336'}
2025-02-25 17:18:13,268 - Validation score increased.  Saving model ...
2025-02-25 17:18:55,439 - {'epoch': 27, 'rec_loss': '7.2949'}
2025-02-25 17:19:12,695 - {'Epoch': 27, 'HR@5': '0.0303', 'NDCG@5': '0.0190', 'HR@10': '0.0505', 'NDCG@10': '0.0255', 'HR@20': '0.0806', 'NDCG@20': '0.0331'}
2025-02-25 17:19:12,697 - EarlyStopping counter: 1 out of 10
2025-02-25 17:19:55,758 - {'epoch': 28, 'rec_loss': '7.2799'}
2025-02-25 17:20:13,038 - {'Epoch': 28, 'HR@5': '0.0299', 'NDCG@5': '0.0191', 'HR@10': '0.0498', 'NDCG@10': '0.0255', 'HR@20': '0.0796', 'NDCG@20': '0.0330'}
2025-02-25 17:20:13,044 - EarlyStopping counter: 2 out of 10
2025-02-25 17:20:54,599 - {'epoch': 29, 'rec_loss': '7.2716'}
2025-02-25 17:21:09,729 - {'Epoch': 29, 'HR@5': '0.0301', 'NDCG@5': '0.0190', 'HR@10': '0.0487', 'NDCG@10': '0.0250', 'HR@20': '0.0793', 'NDCG@20': '0.0327'}
2025-02-25 17:21:09,731 - EarlyStopping counter: 3 out of 10
2025-02-25 17:21:54,221 - {'epoch': 30, 'rec_loss': '7.2680'}
2025-02-25 17:22:11,759 - {'Epoch': 30, 'HR@5': '0.0303', 'NDCG@5': '0.0191', 'HR@10': '0.0497', 'NDCG@10': '0.0253', 'HR@20': '0.0820', 'NDCG@20': '0.0334'}
2025-02-25 17:22:11,760 - EarlyStopping counter: 4 out of 10
2025-02-25 17:22:53,758 - {'epoch': 31, 'rec_loss': '7.2612'}
2025-02-25 17:23:08,909 - {'Epoch': 31, 'HR@5': '0.0297', 'NDCG@5': '0.0193', 'HR@10': '0.0504', 'NDCG@10': '0.0260', 'HR@20': '0.0818', 'NDCG@20': '0.0338'}
2025-02-25 17:23:08,910 - Validation score increased.  Saving model ...
2025-02-25 17:23:50,817 - {'epoch': 32, 'rec_loss': '7.2499'}
2025-02-25 17:24:05,874 - {'Epoch': 32, 'HR@5': '0.0308', 'NDCG@5': '0.0194', 'HR@10': '0.0506', 'NDCG@10': '0.0257', 'HR@20': '0.0807', 'NDCG@20': '0.0333'}
2025-02-25 17:24:05,879 - EarlyStopping counter: 1 out of 10
2025-02-25 17:24:48,135 - {'epoch': 33, 'rec_loss': '7.2428'}
2025-02-25 17:25:03,212 - {'Epoch': 33, 'HR@5': '0.0311', 'NDCG@5': '0.0197', 'HR@10': '0.0506', 'NDCG@10': '0.0260', 'HR@20': '0.0824', 'NDCG@20': '0.0339'}
2025-02-25 17:25:03,214 - Validation score increased.  Saving model ...
2025-02-25 17:25:45,307 - {'epoch': 34, 'rec_loss': '7.2325'}
2025-02-25 17:26:03,659 - {'Epoch': 34, 'HR@5': '0.0294', 'NDCG@5': '0.0190', 'HR@10': '0.0509', 'NDCG@10': '0.0259', 'HR@20': '0.0815', 'NDCG@20': '0.0336'}
2025-02-25 17:26:03,660 - EarlyStopping counter: 1 out of 10
2025-02-25 17:26:45,385 - {'epoch': 35, 'rec_loss': '7.2281'}
2025-02-25 17:27:02,703 - {'Epoch': 35, 'HR@5': '0.0304', 'NDCG@5': '0.0194', 'HR@10': '0.0504', 'NDCG@10': '0.0258', 'HR@20': '0.0811', 'NDCG@20': '0.0335'}
2025-02-25 17:27:02,704 - EarlyStopping counter: 2 out of 10
2025-02-25 17:27:44,201 - {'epoch': 36, 'rec_loss': '7.2212'}
2025-02-25 17:27:59,424 - {'Epoch': 36, 'HR@5': '0.0305', 'NDCG@5': '0.0192', 'HR@10': '0.0499', 'NDCG@10': '0.0254', 'HR@20': '0.0803', 'NDCG@20': '0.0330'}
2025-02-25 17:27:59,429 - EarlyStopping counter: 3 out of 10
2025-02-25 17:28:40,572 - {'epoch': 37, 'rec_loss': '7.2099'}
2025-02-25 17:28:55,582 - {'Epoch': 37, 'HR@5': '0.0293', 'NDCG@5': '0.0191', 'HR@10': '0.0495', 'NDCG@10': '0.0255', 'HR@20': '0.0807', 'NDCG@20': '0.0333'}
2025-02-25 17:28:55,583 - EarlyStopping counter: 4 out of 10
2025-02-25 17:29:37,927 - {'epoch': 38, 'rec_loss': '7.2032'}
2025-02-25 17:29:53,186 - {'Epoch': 38, 'HR@5': '0.0300', 'NDCG@5': '0.0190', 'HR@10': '0.0502', 'NDCG@10': '0.0255', 'HR@20': '0.0805', 'NDCG@20': '0.0331'}
2025-02-25 17:29:53,192 - EarlyStopping counter: 5 out of 10
2025-02-25 17:30:35,161 - {'epoch': 39, 'rec_loss': '7.1979'}
2025-02-25 17:30:50,467 - {'Epoch': 39, 'HR@5': '0.0308', 'NDCG@5': '0.0194', 'HR@10': '0.0501', 'NDCG@10': '0.0255', 'HR@20': '0.0808', 'NDCG@20': '0.0333'}
2025-02-25 17:30:50,469 - EarlyStopping counter: 6 out of 10
2025-02-25 17:31:32,284 - {'epoch': 40, 'rec_loss': '7.1936'}
2025-02-25 17:31:49,727 - {'Epoch': 40, 'HR@5': '0.0309', 'NDCG@5': '0.0198', 'HR@10': '0.0506', 'NDCG@10': '0.0260', 'HR@20': '0.0817', 'NDCG@20': '0.0339'}
2025-02-25 17:31:49,732 - EarlyStopping counter: 7 out of 10
2025-02-25 17:32:31,725 - {'epoch': 41, 'rec_loss': '7.1905'}
2025-02-25 17:32:48,989 - {'Epoch': 41, 'HR@5': '0.0311', 'NDCG@5': '0.0197', 'HR@10': '0.0522', 'NDCG@10': '0.0265', 'HR@20': '0.0824', 'NDCG@20': '0.0340'}
2025-02-25 17:32:48,991 - Validation score increased.  Saving model ...
2025-02-25 17:33:30,764 - {'epoch': 42, 'rec_loss': '7.1783'}
2025-02-25 17:33:45,954 - {'Epoch': 42, 'HR@5': '0.0313', 'NDCG@5': '0.0197', 'HR@10': '0.0521', 'NDCG@10': '0.0264', 'HR@20': '0.0824', 'NDCG@20': '0.0341'}
2025-02-25 17:33:45,956 - Validation score increased.  Saving model ...
2025-02-25 17:34:28,338 - {'epoch': 43, 'rec_loss': '7.1847'}
2025-02-25 17:34:43,441 - {'Epoch': 43, 'HR@5': '0.0312', 'NDCG@5': '0.0198', 'HR@10': '0.0513', 'NDCG@10': '0.0262', 'HR@20': '0.0826', 'NDCG@20': '0.0341'}
2025-02-25 17:34:43,448 - Validation score increased.  Saving model ...
2025-02-25 17:35:24,409 - {'epoch': 44, 'rec_loss': '7.1729'}
2025-02-25 17:35:41,804 - {'Epoch': 44, 'HR@5': '0.0315', 'NDCG@5': '0.0206', 'HR@10': '0.0521', 'NDCG@10': '0.0271', 'HR@20': '0.0830', 'NDCG@20': '0.0349'}
2025-02-25 17:35:41,805 - Validation score increased.  Saving model ...
2025-02-25 17:36:23,159 - {'epoch': 45, 'rec_loss': '7.1674'}
2025-02-25 17:36:38,321 - {'Epoch': 45, 'HR@5': '0.0310', 'NDCG@5': '0.0197', 'HR@10': '0.0511', 'NDCG@10': '0.0262', 'HR@20': '0.0803', 'NDCG@20': '0.0335'}
2025-02-25 17:36:38,324 - EarlyStopping counter: 1 out of 10
2025-02-25 17:37:19,495 - {'epoch': 46, 'rec_loss': '7.1633'}
2025-02-25 17:37:34,879 - {'Epoch': 46, 'HR@5': '0.0311', 'NDCG@5': '0.0193', 'HR@10': '0.0506', 'NDCG@10': '0.0256', 'HR@20': '0.0821', 'NDCG@20': '0.0335'}
2025-02-25 17:37:34,880 - EarlyStopping counter: 2 out of 10
2025-02-25 17:38:16,914 - {'epoch': 47, 'rec_loss': '7.1635'}
2025-02-25 17:38:31,953 - {'Epoch': 47, 'HR@5': '0.0314', 'NDCG@5': '0.0199', 'HR@10': '0.0519', 'NDCG@10': '0.0265', 'HR@20': '0.0812', 'NDCG@20': '0.0338'}
2025-02-25 17:38:31,957 - EarlyStopping counter: 3 out of 10
2025-02-25 17:39:13,214 - {'epoch': 48, 'rec_loss': '7.1513'}
2025-02-25 17:39:30,578 - {'Epoch': 48, 'HR@5': '0.0317', 'NDCG@5': '0.0201', 'HR@10': '0.0508', 'NDCG@10': '0.0262', 'HR@20': '0.0816', 'NDCG@20': '0.0340'}
2025-02-25 17:39:30,584 - EarlyStopping counter: 4 out of 10
2025-02-25 17:40:11,598 - {'epoch': 49, 'rec_loss': '7.1543'}
2025-02-25 17:40:28,134 - {'Epoch': 49, 'HR@5': '0.0313', 'NDCG@5': '0.0197', 'HR@10': '0.0509', 'NDCG@10': '0.0261', 'HR@20': '0.0806', 'NDCG@20': '0.0335'}
2025-02-25 17:40:28,140 - EarlyStopping counter: 5 out of 10
2025-02-25 17:41:09,495 - {'epoch': 50, 'rec_loss': '7.1453'}
2025-02-25 17:41:24,906 - {'Epoch': 50, 'HR@5': '0.0314', 'NDCG@5': '0.0199', 'HR@10': '0.0526', 'NDCG@10': '0.0266', 'HR@20': '0.0807', 'NDCG@20': '0.0337'}
2025-02-25 17:41:24,908 - EarlyStopping counter: 6 out of 10
2025-02-25 17:42:05,899 - {'epoch': 51, 'rec_loss': '7.1412'}
2025-02-25 17:42:23,371 - {'Epoch': 51, 'HR@5': '0.0308', 'NDCG@5': '0.0197', 'HR@10': '0.0512', 'NDCG@10': '0.0262', 'HR@20': '0.0817', 'NDCG@20': '0.0339'}
2025-02-25 17:42:23,373 - EarlyStopping counter: 7 out of 10
2025-02-25 17:43:05,413 - {'epoch': 52, 'rec_loss': '7.1397'}
2025-02-25 17:43:20,738 - {'Epoch': 52, 'HR@5': '0.0301', 'NDCG@5': '0.0190', 'HR@10': '0.0501', 'NDCG@10': '0.0254', 'HR@20': '0.0803', 'NDCG@20': '0.0330'}
2025-02-25 17:43:20,739 - EarlyStopping counter: 8 out of 10
2025-02-25 17:44:05,754 - {'epoch': 53, 'rec_loss': '7.1291'}
2025-02-25 17:44:20,902 - {'Epoch': 53, 'HR@5': '0.0304', 'NDCG@5': '0.0193', 'HR@10': '0.0498', 'NDCG@10': '0.0255', 'HR@20': '0.0816', 'NDCG@20': '0.0335'}
2025-02-25 17:44:20,908 - EarlyStopping counter: 9 out of 10
2025-02-25 17:45:01,972 - {'epoch': 54, 'rec_loss': '7.1342'}
2025-02-25 17:45:19,332 - {'Epoch': 54, 'HR@5': '0.0308', 'NDCG@5': '0.0197', 'HR@10': '0.0510', 'NDCG@10': '0.0262', 'HR@20': '0.0809', 'NDCG@20': '0.0337'}
2025-02-25 17:45:19,333 - EarlyStopping counter: 10 out of 10
2025-02-25 17:45:19,334 - Early stopping
2025-02-25 17:45:19,334 - ---------------Test Score---------------
2025-02-25 17:45:34,513 - {'Epoch': 0, 'HR@5': '0.0291', 'NDCG@5': '0.0181', 'HR@10': '0.0478', 'NDCG@10': '0.0241', 'HR@20': '0.0756', 'NDCG@20': '0.0311'}
2025-02-25 17:45:34,517 - Scale_Yelp
2025-02-25 17:45:34,517 - {'Epoch': 0, 'HR@5': '0.0291', 'NDCG@5': '0.0181', 'HR@10': '0.0478', 'NDCG@10': '0.0241', 'HR@20': '0.0756', 'NDCG@20': '0.0311'}
2025-02-25 18:11:43,955 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 10], kernels=[4, 8, 12], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-02-25 18:11:46,730 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-25 18:11:46,737 - Total Parameters: 1436118
2025-02-25 18:12:34,162 - {'epoch': 0, 'rec_loss': '9.5648'}
2025-02-25 18:12:52,319 - {'Epoch': 0, 'HR@5': '0.0088', 'NDCG@5': '0.0055', 'HR@10': '0.0151', 'NDCG@10': '0.0076', 'HR@20': '0.0253', 'NDCG@20': '0.0101'}
2025-02-25 18:12:52,321 - Validation score increased.  Saving model ...
2025-02-25 18:13:38,297 - {'epoch': 1, 'rec_loss': '8.9581'}
2025-02-25 18:13:52,659 - {'Epoch': 1, 'HR@5': '0.0125', 'NDCG@5': '0.0077', 'HR@10': '0.0239', 'NDCG@10': '0.0113', 'HR@20': '0.0395', 'NDCG@20': '0.0153'}
2025-02-25 18:13:52,661 - Validation score increased.  Saving model ...
2025-02-25 18:14:37,482 - {'epoch': 2, 'rec_loss': '8.5238'}
2025-02-25 18:14:52,325 - {'Epoch': 2, 'HR@5': '0.0168', 'NDCG@5': '0.0104', 'HR@10': '0.0292', 'NDCG@10': '0.0144', 'HR@20': '0.0495', 'NDCG@20': '0.0195'}
2025-02-25 18:14:52,328 - Validation score increased.  Saving model ...
2025-02-25 18:15:41,176 - {'epoch': 3, 'rec_loss': '8.2789'}
2025-02-25 18:15:55,604 - {'Epoch': 3, 'HR@5': '0.0190', 'NDCG@5': '0.0118', 'HR@10': '0.0335', 'NDCG@10': '0.0164', 'HR@20': '0.0567', 'NDCG@20': '0.0222'}
2025-02-25 18:15:55,608 - Validation score increased.  Saving model ...
2025-02-25 18:16:40,484 - {'epoch': 4, 'rec_loss': '8.1110'}
2025-02-25 18:16:55,517 - {'Epoch': 4, 'HR@5': '0.0211', 'NDCG@5': '0.0132', 'HR@10': '0.0379', 'NDCG@10': '0.0186', 'HR@20': '0.0632', 'NDCG@20': '0.0249'}
2025-02-25 18:16:55,518 - Validation score increased.  Saving model ...
2025-02-25 18:17:38,605 - {'epoch': 5, 'rec_loss': '7.9728'}
2025-02-25 18:17:53,474 - {'Epoch': 5, 'HR@5': '0.0241', 'NDCG@5': '0.0147', 'HR@10': '0.0420', 'NDCG@10': '0.0205', 'HR@20': '0.0675', 'NDCG@20': '0.0268'}
2025-02-25 18:17:53,476 - Validation score increased.  Saving model ...
2025-02-25 18:18:42,131 - {'epoch': 6, 'rec_loss': '7.8710'}
2025-02-25 18:18:56,542 - {'Epoch': 6, 'HR@5': '0.0252', 'NDCG@5': '0.0155', 'HR@10': '0.0441', 'NDCG@10': '0.0216', 'HR@20': '0.0699', 'NDCG@20': '0.0280'}
2025-02-25 18:18:56,544 - Validation score increased.  Saving model ...
2025-02-25 18:19:41,903 - {'epoch': 7, 'rec_loss': '7.7900'}
2025-02-25 18:19:56,561 - {'Epoch': 7, 'HR@5': '0.0277', 'NDCG@5': '0.0171', 'HR@10': '0.0443', 'NDCG@10': '0.0224', 'HR@20': '0.0713', 'NDCG@20': '0.0292'}
2025-02-25 18:19:56,562 - Validation score increased.  Saving model ...
2025-02-25 18:20:43,318 - {'epoch': 8, 'rec_loss': '7.7247'}
2025-02-25 18:20:58,145 - {'Epoch': 8, 'HR@5': '0.0276', 'NDCG@5': '0.0174', 'HR@10': '0.0467', 'NDCG@10': '0.0235', 'HR@20': '0.0746', 'NDCG@20': '0.0305'}
2025-02-25 18:20:58,147 - Validation score increased.  Saving model ...
2025-02-25 18:21:43,423 - {'epoch': 9, 'rec_loss': '7.6726'}
2025-02-25 18:21:58,298 - {'Epoch': 9, 'HR@5': '0.0284', 'NDCG@5': '0.0176', 'HR@10': '0.0475', 'NDCG@10': '0.0237', 'HR@20': '0.0753', 'NDCG@20': '0.0307'}
2025-02-25 18:21:58,301 - Validation score increased.  Saving model ...
2025-02-25 18:22:45,595 - {'epoch': 10, 'rec_loss': '7.6259'}
2025-02-25 18:23:00,395 - {'Epoch': 10, 'HR@5': '0.0279', 'NDCG@5': '0.0175', 'HR@10': '0.0478', 'NDCG@10': '0.0239', 'HR@20': '0.0769', 'NDCG@20': '0.0312'}
2025-02-25 18:23:00,396 - Validation score increased.  Saving model ...
2025-02-25 18:23:44,434 - {'epoch': 11, 'rec_loss': '7.5847'}
2025-02-25 18:23:59,270 - {'Epoch': 11, 'HR@5': '0.0285', 'NDCG@5': '0.0178', 'HR@10': '0.0487', 'NDCG@10': '0.0243', 'HR@20': '0.0778', 'NDCG@20': '0.0316'}
2025-02-25 18:23:59,274 - Validation score increased.  Saving model ...
2025-02-25 18:24:44,636 - {'epoch': 12, 'rec_loss': '7.5558'}
2025-02-25 18:25:00,124 - {'Epoch': 12, 'HR@5': '0.0298', 'NDCG@5': '0.0188', 'HR@10': '0.0476', 'NDCG@10': '0.0245', 'HR@20': '0.0759', 'NDCG@20': '0.0316'}
2025-02-25 18:25:00,125 - Validation score increased.  Saving model ...
2025-02-25 18:25:51,686 - {'epoch': 13, 'rec_loss': '7.5196'}
2025-02-25 18:26:06,541 - {'Epoch': 13, 'HR@5': '0.0298', 'NDCG@5': '0.0188', 'HR@10': '0.0498', 'NDCG@10': '0.0252', 'HR@20': '0.0798', 'NDCG@20': '0.0327'}
2025-02-25 18:26:06,546 - Validation score increased.  Saving model ...
2025-02-25 18:26:52,022 - {'epoch': 14, 'rec_loss': '7.4972'}
2025-02-25 18:27:08,219 - {'Epoch': 14, 'HR@5': '0.0303', 'NDCG@5': '0.0190', 'HR@10': '0.0489', 'NDCG@10': '0.0249', 'HR@20': '0.0789', 'NDCG@20': '0.0325'}
2025-02-25 18:27:08,224 - EarlyStopping counter: 1 out of 10
2025-02-25 18:27:53,811 - {'epoch': 15, 'rec_loss': '7.4664'}
2025-02-25 18:28:08,449 - {'Epoch': 15, 'HR@5': '0.0291', 'NDCG@5': '0.0186', 'HR@10': '0.0496', 'NDCG@10': '0.0252', 'HR@20': '0.0788', 'NDCG@20': '0.0326'}
2025-02-25 18:28:08,451 - EarlyStopping counter: 2 out of 10
2025-02-25 18:28:53,182 - {'epoch': 16, 'rec_loss': '7.4497'}
2025-02-25 18:29:08,261 - {'Epoch': 16, 'HR@5': '0.0300', 'NDCG@5': '0.0190', 'HR@10': '0.0508', 'NDCG@10': '0.0257', 'HR@20': '0.0810', 'NDCG@20': '0.0333'}
2025-02-25 18:29:08,266 - Validation score increased.  Saving model ...
2025-02-25 18:29:54,876 - {'epoch': 17, 'rec_loss': '7.4222'}
2025-02-25 18:30:09,705 - {'Epoch': 17, 'HR@5': '0.0304', 'NDCG@5': '0.0193', 'HR@10': '0.0493', 'NDCG@10': '0.0254', 'HR@20': '0.0796', 'NDCG@20': '0.0330'}
2025-02-25 18:30:09,706 - EarlyStopping counter: 1 out of 10
2025-02-25 18:30:55,491 - {'epoch': 18, 'rec_loss': '7.4009'}
2025-02-25 18:31:10,782 - {'Epoch': 18, 'HR@5': '0.0300', 'NDCG@5': '0.0190', 'HR@10': '0.0500', 'NDCG@10': '0.0254', 'HR@20': '0.0810', 'NDCG@20': '0.0332'}
2025-02-25 18:31:10,784 - EarlyStopping counter: 2 out of 10
2025-02-25 18:31:55,868 - {'epoch': 19, 'rec_loss': '7.3877'}
2025-02-25 18:32:10,852 - {'Epoch': 19, 'HR@5': '0.0315', 'NDCG@5': '0.0200', 'HR@10': '0.0504', 'NDCG@10': '0.0260', 'HR@20': '0.0805', 'NDCG@20': '0.0336'}
2025-02-25 18:32:10,858 - Validation score increased.  Saving model ...
2025-02-25 18:32:56,146 - {'epoch': 20, 'rec_loss': '7.3716'}
2025-02-25 18:33:11,215 - {'Epoch': 20, 'HR@5': '0.0294', 'NDCG@5': '0.0188', 'HR@10': '0.0497', 'NDCG@10': '0.0253', 'HR@20': '0.0817', 'NDCG@20': '0.0334'}
2025-02-25 18:33:11,220 - EarlyStopping counter: 1 out of 10
2025-02-25 18:33:55,644 - {'epoch': 21, 'rec_loss': '7.3593'}
2025-02-25 18:34:10,431 - {'Epoch': 21, 'HR@5': '0.0313', 'NDCG@5': '0.0195', 'HR@10': '0.0514', 'NDCG@10': '0.0260', 'HR@20': '0.0807', 'NDCG@20': '0.0333'}
2025-02-25 18:34:10,435 - EarlyStopping counter: 2 out of 10
2025-02-25 18:34:54,500 - {'epoch': 22, 'rec_loss': '7.3498'}
2025-02-25 18:35:09,161 - {'Epoch': 22, 'HR@5': '0.0304', 'NDCG@5': '0.0191', 'HR@10': '0.0502', 'NDCG@10': '0.0255', 'HR@20': '0.0815', 'NDCG@20': '0.0333'}
2025-02-25 18:35:09,165 - EarlyStopping counter: 3 out of 10
2025-02-25 18:35:54,517 - {'epoch': 23, 'rec_loss': '7.3304'}
2025-02-25 18:36:09,334 - {'Epoch': 23, 'HR@5': '0.0304', 'NDCG@5': '0.0192', 'HR@10': '0.0504', 'NDCG@10': '0.0256', 'HR@20': '0.0810', 'NDCG@20': '0.0333'}
2025-02-25 18:36:09,335 - EarlyStopping counter: 4 out of 10
2025-02-25 18:36:54,811 - {'epoch': 24, 'rec_loss': '7.3166'}
2025-02-25 18:37:09,706 - {'Epoch': 24, 'HR@5': '0.0308', 'NDCG@5': '0.0193', 'HR@10': '0.0502', 'NDCG@10': '0.0255', 'HR@20': '0.0815', 'NDCG@20': '0.0334'}
2025-02-25 18:37:09,708 - EarlyStopping counter: 5 out of 10
2025-02-25 18:37:55,445 - {'epoch': 25, 'rec_loss': '7.3037'}
2025-02-25 18:38:10,469 - {'Epoch': 25, 'HR@5': '0.0304', 'NDCG@5': '0.0190', 'HR@10': '0.0512', 'NDCG@10': '0.0257', 'HR@20': '0.0814', 'NDCG@20': '0.0332'}
2025-02-25 18:38:10,471 - EarlyStopping counter: 6 out of 10
2025-02-25 18:38:55,593 - {'epoch': 26, 'rec_loss': '7.2933'}
2025-02-25 18:39:10,693 - {'Epoch': 26, 'HR@5': '0.0308', 'NDCG@5': '0.0194', 'HR@10': '0.0518', 'NDCG@10': '0.0262', 'HR@20': '0.0823', 'NDCG@20': '0.0339'}
2025-02-25 18:39:10,694 - Validation score increased.  Saving model ...
2025-02-25 18:39:56,118 - {'epoch': 27, 'rec_loss': '7.2841'}
2025-02-25 18:40:11,172 - {'Epoch': 27, 'HR@5': '0.0303', 'NDCG@5': '0.0194', 'HR@10': '0.0495', 'NDCG@10': '0.0255', 'HR@20': '0.0822', 'NDCG@20': '0.0337'}
2025-02-25 18:40:11,173 - EarlyStopping counter: 1 out of 10
2025-02-25 18:41:00,307 - {'epoch': 28, 'rec_loss': '7.2760'}
2025-02-25 18:41:15,215 - {'Epoch': 28, 'HR@5': '0.0301', 'NDCG@5': '0.0188', 'HR@10': '0.0495', 'NDCG@10': '0.0250', 'HR@20': '0.0795', 'NDCG@20': '0.0326'}
2025-02-25 18:41:15,216 - EarlyStopping counter: 2 out of 10
2025-02-25 18:42:01,141 - {'epoch': 29, 'rec_loss': '7.2617'}
2025-02-25 18:42:15,967 - {'Epoch': 29, 'HR@5': '0.0301', 'NDCG@5': '0.0189', 'HR@10': '0.0514', 'NDCG@10': '0.0258', 'HR@20': '0.0810', 'NDCG@20': '0.0332'}
2025-02-25 18:42:15,968 - EarlyStopping counter: 3 out of 10
2025-02-25 18:43:01,818 - {'epoch': 30, 'rec_loss': '7.2556'}
2025-02-25 18:43:16,642 - {'Epoch': 30, 'HR@5': '0.0300', 'NDCG@5': '0.0187', 'HR@10': '0.0490', 'NDCG@10': '0.0248', 'HR@20': '0.0782', 'NDCG@20': '0.0321'}
2025-02-25 18:43:16,643 - EarlyStopping counter: 4 out of 10
2025-02-25 18:44:02,182 - {'epoch': 31, 'rec_loss': '7.2512'}
2025-02-25 18:44:17,508 - {'Epoch': 31, 'HR@5': '0.0300', 'NDCG@5': '0.0189', 'HR@10': '0.0519', 'NDCG@10': '0.0260', 'HR@20': '0.0799', 'NDCG@20': '0.0330'}
2025-02-25 18:44:17,510 - EarlyStopping counter: 5 out of 10
2025-02-25 18:45:04,464 - {'epoch': 32, 'rec_loss': '7.2454'}
2025-02-25 18:45:19,496 - {'Epoch': 32, 'HR@5': '0.0315', 'NDCG@5': '0.0197', 'HR@10': '0.0521', 'NDCG@10': '0.0263', 'HR@20': '0.0819', 'NDCG@20': '0.0338'}
2025-02-25 18:45:19,498 - EarlyStopping counter: 6 out of 10
2025-02-25 18:46:05,864 - {'epoch': 33, 'rec_loss': '7.2336'}
2025-02-25 18:46:22,659 - {'Epoch': 33, 'HR@5': '0.0310', 'NDCG@5': '0.0197', 'HR@10': '0.0500', 'NDCG@10': '0.0259', 'HR@20': '0.0814', 'NDCG@20': '0.0337'}
2025-02-25 18:46:22,661 - EarlyStopping counter: 7 out of 10
2025-02-25 18:47:11,065 - {'epoch': 34, 'rec_loss': '7.2283'}
2025-02-25 18:47:26,555 - {'Epoch': 34, 'HR@5': '0.0312', 'NDCG@5': '0.0196', 'HR@10': '0.0516', 'NDCG@10': '0.0261', 'HR@20': '0.0821', 'NDCG@20': '0.0338'}
2025-02-25 18:47:26,557 - EarlyStopping counter: 8 out of 10
2025-02-25 18:48:11,076 - {'epoch': 35, 'rec_loss': '7.2180'}
2025-02-25 18:48:26,184 - {'Epoch': 35, 'HR@5': '0.0310', 'NDCG@5': '0.0195', 'HR@10': '0.0508', 'NDCG@10': '0.0258', 'HR@20': '0.0824', 'NDCG@20': '0.0338'}
2025-02-25 18:48:26,185 - EarlyStopping counter: 9 out of 10
2025-02-25 18:49:11,957 - {'epoch': 36, 'rec_loss': '7.2110'}
2025-02-25 18:49:26,786 - {'Epoch': 36, 'HR@5': '0.0302', 'NDCG@5': '0.0190', 'HR@10': '0.0491', 'NDCG@10': '0.0250', 'HR@20': '0.0802', 'NDCG@20': '0.0328'}
2025-02-25 18:49:26,788 - EarlyStopping counter: 10 out of 10
2025-02-25 18:49:26,788 - Early stopping
2025-02-25 18:49:26,788 - ---------------Test Score---------------
2025-02-25 18:49:41,809 - {'Epoch': 0, 'HR@5': '0.0290', 'NDCG@5': '0.0183', 'HR@10': '0.0475', 'NDCG@10': '0.0243', 'HR@20': '0.0760', 'NDCG@20': '0.0314'}
2025-02-25 18:49:41,811 - Scale_Yelp
2025-02-25 18:49:41,811 - {'Epoch': 0, 'HR@5': '0.0290', 'NDCG@5': '0.0183', 'HR@10': '0.0475', 'NDCG@10': '0.0243', 'HR@20': '0.0760', 'NDCG@20': '0.0314'}
2025-02-25 18:53:33,882 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[4, 8, 12], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-02-25 18:53:36,630 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-25 18:53:36,636 - Total Parameters: 1436118
2025-02-25 18:54:21,357 - {'epoch': 0, 'rec_loss': '9.5478'}
2025-02-25 18:54:39,396 - {'Epoch': 0, 'HR@5': '0.0099', 'NDCG@5': '0.0059', 'HR@10': '0.0153', 'NDCG@10': '0.0077', 'HR@20': '0.0255', 'NDCG@20': '0.0103'}
2025-02-25 18:54:39,398 - Validation score increased.  Saving model ...
2025-02-25 18:55:21,174 - {'epoch': 1, 'rec_loss': '8.9254'}
2025-02-25 18:55:37,835 - {'Epoch': 1, 'HR@5': '0.0156', 'NDCG@5': '0.0098', 'HR@10': '0.0260', 'NDCG@10': '0.0131', 'HR@20': '0.0420', 'NDCG@20': '0.0171'}
2025-02-25 18:55:37,836 - Validation score increased.  Saving model ...
2025-02-25 18:56:19,498 - {'epoch': 2, 'rec_loss': '8.4977'}
2025-02-25 18:56:35,468 - {'Epoch': 2, 'HR@5': '0.0186', 'NDCG@5': '0.0115', 'HR@10': '0.0319', 'NDCG@10': '0.0157', 'HR@20': '0.0526', 'NDCG@20': '0.0209'}
2025-02-25 18:56:35,475 - Validation score increased.  Saving model ...
2025-02-25 18:57:16,909 - {'epoch': 3, 'rec_loss': '8.2623'}
2025-02-25 18:57:33,416 - {'Epoch': 3, 'HR@5': '0.0221', 'NDCG@5': '0.0137', 'HR@10': '0.0374', 'NDCG@10': '0.0187', 'HR@20': '0.0613', 'NDCG@20': '0.0247'}
2025-02-25 18:57:33,422 - Validation score increased.  Saving model ...
2025-02-25 18:58:15,481 - {'epoch': 4, 'rec_loss': '8.0884'}
2025-02-25 18:58:30,098 - {'Epoch': 4, 'HR@5': '0.0228', 'NDCG@5': '0.0140', 'HR@10': '0.0393', 'NDCG@10': '0.0192', 'HR@20': '0.0641', 'NDCG@20': '0.0255'}
2025-02-25 18:58:30,100 - Validation score increased.  Saving model ...
2025-02-25 18:59:11,439 - {'epoch': 5, 'rec_loss': '7.9643'}
2025-02-25 18:59:26,055 - {'Epoch': 5, 'HR@5': '0.0252', 'NDCG@5': '0.0157', 'HR@10': '0.0426', 'NDCG@10': '0.0212', 'HR@20': '0.0685', 'NDCG@20': '0.0277'}
2025-02-25 18:59:26,062 - Validation score increased.  Saving model ...
2025-02-25 19:00:09,641 - {'epoch': 6, 'rec_loss': '7.8731'}
2025-02-25 19:00:26,415 - {'Epoch': 6, 'HR@5': '0.0257', 'NDCG@5': '0.0161', 'HR@10': '0.0452', 'NDCG@10': '0.0224', 'HR@20': '0.0712', 'NDCG@20': '0.0289'}
2025-02-25 19:00:26,416 - Validation score increased.  Saving model ...
2025-02-25 19:01:10,638 - {'epoch': 7, 'rec_loss': '7.7950'}
2025-02-25 19:01:27,213 - {'Epoch': 7, 'HR@5': '0.0265', 'NDCG@5': '0.0166', 'HR@10': '0.0445', 'NDCG@10': '0.0224', 'HR@20': '0.0726', 'NDCG@20': '0.0294'}
2025-02-25 19:01:27,215 - Validation score increased.  Saving model ...
2025-02-25 19:02:09,059 - {'epoch': 8, 'rec_loss': '7.7343'}
2025-02-25 19:02:26,253 - {'Epoch': 8, 'HR@5': '0.0275', 'NDCG@5': '0.0175', 'HR@10': '0.0459', 'NDCG@10': '0.0233', 'HR@20': '0.0731', 'NDCG@20': '0.0302'}
2025-02-25 19:02:26,258 - Validation score increased.  Saving model ...
2025-02-25 19:03:08,580 - {'epoch': 9, 'rec_loss': '7.6804'}
2025-02-25 19:03:23,787 - {'Epoch': 9, 'HR@5': '0.0281', 'NDCG@5': '0.0176', 'HR@10': '0.0463', 'NDCG@10': '0.0234', 'HR@20': '0.0755', 'NDCG@20': '0.0307'}
2025-02-25 19:03:23,791 - Validation score increased.  Saving model ...
2025-02-25 19:04:05,453 - {'epoch': 10, 'rec_loss': '7.6394'}
2025-02-25 19:04:22,589 - {'Epoch': 10, 'HR@5': '0.0289', 'NDCG@5': '0.0185', 'HR@10': '0.0487', 'NDCG@10': '0.0248', 'HR@20': '0.0777', 'NDCG@20': '0.0321'}
2025-02-25 19:04:22,591 - Validation score increased.  Saving model ...
2025-02-25 19:05:04,922 - {'epoch': 11, 'rec_loss': '7.5939'}
2025-02-25 19:05:19,927 - {'Epoch': 11, 'HR@5': '0.0287', 'NDCG@5': '0.0177', 'HR@10': '0.0484', 'NDCG@10': '0.0240', 'HR@20': '0.0769', 'NDCG@20': '0.0312'}
2025-02-25 19:05:19,929 - EarlyStopping counter: 1 out of 10
2025-02-25 19:06:02,131 - {'epoch': 12, 'rec_loss': '7.5631'}
2025-02-25 19:06:18,955 - {'Epoch': 12, 'HR@5': '0.0292', 'NDCG@5': '0.0186', 'HR@10': '0.0484', 'NDCG@10': '0.0247', 'HR@20': '0.0778', 'NDCG@20': '0.0321'}
2025-02-25 19:06:18,960 - EarlyStopping counter: 2 out of 10
2025-02-25 19:07:00,389 - {'epoch': 13, 'rec_loss': '7.5336'}
2025-02-25 19:07:15,372 - {'Epoch': 13, 'HR@5': '0.0292', 'NDCG@5': '0.0185', 'HR@10': '0.0491', 'NDCG@10': '0.0249', 'HR@20': '0.0786', 'NDCG@20': '0.0323'}
2025-02-25 19:07:15,373 - Validation score increased.  Saving model ...
2025-02-25 19:07:58,947 - {'epoch': 14, 'rec_loss': '7.4963'}
2025-02-25 19:08:16,111 - {'Epoch': 14, 'HR@5': '0.0298', 'NDCG@5': '0.0186', 'HR@10': '0.0494', 'NDCG@10': '0.0249', 'HR@20': '0.0788', 'NDCG@20': '0.0323'}
2025-02-25 19:08:16,116 - EarlyStopping counter: 1 out of 10
2025-02-25 19:09:01,812 - {'epoch': 15, 'rec_loss': '7.4771'}
2025-02-25 19:09:17,078 - {'Epoch': 15, 'HR@5': '0.0297', 'NDCG@5': '0.0189', 'HR@10': '0.0494', 'NDCG@10': '0.0253', 'HR@20': '0.0794', 'NDCG@20': '0.0328'}
2025-02-25 19:09:17,084 - Validation score increased.  Saving model ...
2025-02-25 19:09:58,442 - {'epoch': 16, 'rec_loss': '7.4531'}
2025-02-25 19:10:15,769 - {'Epoch': 16, 'HR@5': '0.0300', 'NDCG@5': '0.0187', 'HR@10': '0.0505', 'NDCG@10': '0.0252', 'HR@20': '0.0791', 'NDCG@20': '0.0324'}
2025-02-25 19:10:15,776 - EarlyStopping counter: 1 out of 10
2025-02-25 19:10:59,487 - {'epoch': 17, 'rec_loss': '7.4302'}
2025-02-25 19:11:14,685 - {'Epoch': 17, 'HR@5': '0.0299', 'NDCG@5': '0.0184', 'HR@10': '0.0508', 'NDCG@10': '0.0252', 'HR@20': '0.0809', 'NDCG@20': '0.0327'}
2025-02-25 19:11:14,687 - EarlyStopping counter: 2 out of 10
2025-02-25 19:11:56,006 - {'epoch': 18, 'rec_loss': '7.4119'}
2025-02-25 19:12:12,241 - {'Epoch': 18, 'HR@5': '0.0313', 'NDCG@5': '0.0195', 'HR@10': '0.0497', 'NDCG@10': '0.0254', 'HR@20': '0.0804', 'NDCG@20': '0.0332'}
2025-02-25 19:12:12,243 - Validation score increased.  Saving model ...
2025-02-25 19:12:54,469 - {'epoch': 19, 'rec_loss': '7.3911'}
2025-02-25 19:13:11,802 - {'Epoch': 19, 'HR@5': '0.0308', 'NDCG@5': '0.0195', 'HR@10': '0.0503', 'NDCG@10': '0.0257', 'HR@20': '0.0800', 'NDCG@20': '0.0332'}
2025-02-25 19:13:11,803 - Validation score increased.  Saving model ...
2025-02-25 19:13:53,485 - {'epoch': 20, 'rec_loss': '7.3720'}
2025-02-25 19:14:09,248 - {'Epoch': 20, 'HR@5': '0.0312', 'NDCG@5': '0.0196', 'HR@10': '0.0507', 'NDCG@10': '0.0259', 'HR@20': '0.0806', 'NDCG@20': '0.0334'}
2025-02-25 19:14:09,252 - Validation score increased.  Saving model ...
2025-02-25 19:14:51,254 - {'epoch': 21, 'rec_loss': '7.3569'}
2025-02-25 19:15:06,252 - {'Epoch': 21, 'HR@5': '0.0305', 'NDCG@5': '0.0195', 'HR@10': '0.0515', 'NDCG@10': '0.0262', 'HR@20': '0.0795', 'NDCG@20': '0.0332'}
2025-02-25 19:15:06,254 - EarlyStopping counter: 1 out of 10
2025-02-25 19:15:48,053 - {'epoch': 22, 'rec_loss': '7.3416'}
2025-02-25 19:16:05,309 - {'Epoch': 22, 'HR@5': '0.0313', 'NDCG@5': '0.0198', 'HR@10': '0.0512', 'NDCG@10': '0.0262', 'HR@20': '0.0808', 'NDCG@20': '0.0336'}
2025-02-25 19:16:05,311 - Validation score increased.  Saving model ...
2025-02-25 19:16:46,980 - {'epoch': 23, 'rec_loss': '7.3290'}
2025-02-25 19:17:01,667 - {'Epoch': 23, 'HR@5': '0.0300', 'NDCG@5': '0.0191', 'HR@10': '0.0502', 'NDCG@10': '0.0256', 'HR@20': '0.0812', 'NDCG@20': '0.0334'}
2025-02-25 19:17:01,672 - EarlyStopping counter: 1 out of 10
2025-02-25 19:17:45,237 - {'epoch': 24, 'rec_loss': '7.3202'}
2025-02-25 19:18:02,554 - {'Epoch': 24, 'HR@5': '0.0319', 'NDCG@5': '0.0202', 'HR@10': '0.0518', 'NDCG@10': '0.0265', 'HR@20': '0.0821', 'NDCG@20': '0.0341'}
2025-02-25 19:18:02,556 - Validation score increased.  Saving model ...
2025-02-25 19:18:44,685 - {'epoch': 25, 'rec_loss': '7.3072'}
2025-02-25 19:19:01,035 - {'Epoch': 25, 'HR@5': '0.0309', 'NDCG@5': '0.0194', 'HR@10': '0.0517', 'NDCG@10': '0.0260', 'HR@20': '0.0826', 'NDCG@20': '0.0338'}
2025-02-25 19:19:01,038 - EarlyStopping counter: 1 out of 10
2025-02-25 19:19:46,435 - {'epoch': 26, 'rec_loss': '7.2974'}
2025-02-25 19:20:01,713 - {'Epoch': 26, 'HR@5': '0.0321', 'NDCG@5': '0.0201', 'HR@10': '0.0513', 'NDCG@10': '0.0263', 'HR@20': '0.0823', 'NDCG@20': '0.0341'}
2025-02-25 19:20:01,718 - EarlyStopping counter: 2 out of 10
2025-02-25 19:20:45,753 - {'epoch': 27, 'rec_loss': '7.2860'}
2025-02-25 19:21:02,968 - {'Epoch': 27, 'HR@5': '0.0320', 'NDCG@5': '0.0203', 'HR@10': '0.0510', 'NDCG@10': '0.0265', 'HR@20': '0.0807', 'NDCG@20': '0.0339'}
2025-02-25 19:21:02,971 - EarlyStopping counter: 3 out of 10
2025-02-25 19:21:44,423 - {'epoch': 28, 'rec_loss': '7.2735'}
2025-02-25 19:22:01,381 - {'Epoch': 28, 'HR@5': '0.0308', 'NDCG@5': '0.0195', 'HR@10': '0.0508', 'NDCG@10': '0.0259', 'HR@20': '0.0818', 'NDCG@20': '0.0337'}
2025-02-25 19:22:01,389 - EarlyStopping counter: 4 out of 10
2025-02-25 19:22:43,653 - {'epoch': 29, 'rec_loss': '7.2688'}
2025-02-25 19:22:58,861 - {'Epoch': 29, 'HR@5': '0.0317', 'NDCG@5': '0.0199', 'HR@10': '0.0513', 'NDCG@10': '0.0261', 'HR@20': '0.0830', 'NDCG@20': '0.0341'}
2025-02-25 19:22:58,862 - EarlyStopping counter: 5 out of 10
2025-02-25 19:23:40,384 - {'epoch': 30, 'rec_loss': '7.2574'}
2025-02-25 19:23:57,737 - {'Epoch': 30, 'HR@5': '0.0308', 'NDCG@5': '0.0195', 'HR@10': '0.0511', 'NDCG@10': '0.0260', 'HR@20': '0.0824', 'NDCG@20': '0.0339'}
2025-02-25 19:23:57,739 - EarlyStopping counter: 6 out of 10
2025-02-25 19:24:39,745 - {'epoch': 31, 'rec_loss': '7.2476'}
2025-02-25 19:24:55,102 - {'Epoch': 31, 'HR@5': '0.0319', 'NDCG@5': '0.0201', 'HR@10': '0.0512', 'NDCG@10': '0.0262', 'HR@20': '0.0835', 'NDCG@20': '0.0343'}
2025-02-25 19:24:55,106 - Validation score increased.  Saving model ...
2025-02-25 19:25:36,495 - {'epoch': 32, 'rec_loss': '7.2413'}
2025-02-25 19:25:51,578 - {'Epoch': 32, 'HR@5': '0.0310', 'NDCG@5': '0.0196', 'HR@10': '0.0506', 'NDCG@10': '0.0259', 'HR@20': '0.0807', 'NDCG@20': '0.0335'}
2025-02-25 19:25:51,585 - EarlyStopping counter: 1 out of 10
2025-02-25 19:26:33,581 - {'epoch': 33, 'rec_loss': '7.2392'}
2025-02-25 19:26:48,771 - {'Epoch': 33, 'HR@5': '0.0303', 'NDCG@5': '0.0190', 'HR@10': '0.0504', 'NDCG@10': '0.0255', 'HR@20': '0.0819', 'NDCG@20': '0.0334'}
2025-02-25 19:26:48,772 - EarlyStopping counter: 2 out of 10
2025-02-25 19:27:31,164 - {'epoch': 34, 'rec_loss': '7.2236'}
2025-02-25 19:27:47,992 - {'Epoch': 34, 'HR@5': '0.0297', 'NDCG@5': '0.0187', 'HR@10': '0.0513', 'NDCG@10': '0.0256', 'HR@20': '0.0830', 'NDCG@20': '0.0336'}
2025-02-25 19:27:47,993 - EarlyStopping counter: 3 out of 10
2025-02-25 19:28:30,546 - {'epoch': 35, 'rec_loss': '7.2171'}
2025-02-25 19:28:45,659 - {'Epoch': 35, 'HR@5': '0.0312', 'NDCG@5': '0.0197', 'HR@10': '0.0499', 'NDCG@10': '0.0257', 'HR@20': '0.0820', 'NDCG@20': '0.0337'}
2025-02-25 19:28:45,660 - EarlyStopping counter: 4 out of 10
2025-02-25 19:29:29,531 - {'epoch': 36, 'rec_loss': '7.2134'}
2025-02-25 19:29:46,227 - {'Epoch': 36, 'HR@5': '0.0313', 'NDCG@5': '0.0196', 'HR@10': '0.0509', 'NDCG@10': '0.0259', 'HR@20': '0.0829', 'NDCG@20': '0.0339'}
2025-02-25 19:29:46,228 - EarlyStopping counter: 5 out of 10
2025-02-25 19:30:27,694 - {'epoch': 37, 'rec_loss': '7.2055'}
2025-02-25 19:30:45,520 - {'Epoch': 37, 'HR@5': '0.0311', 'NDCG@5': '0.0197', 'HR@10': '0.0507', 'NDCG@10': '0.0259', 'HR@20': '0.0810', 'NDCG@20': '0.0335'}
2025-02-25 19:30:45,525 - EarlyStopping counter: 6 out of 10
2025-02-25 19:31:27,793 - {'epoch': 38, 'rec_loss': '7.1959'}
2025-02-25 19:31:43,092 - {'Epoch': 38, 'HR@5': '0.0286', 'NDCG@5': '0.0185', 'HR@10': '0.0486', 'NDCG@10': '0.0249', 'HR@20': '0.0827', 'NDCG@20': '0.0335'}
2025-02-25 19:31:43,093 - EarlyStopping counter: 7 out of 10
2025-02-25 19:32:24,514 - {'epoch': 39, 'rec_loss': '7.1931'}
2025-02-25 19:32:41,573 - {'Epoch': 39, 'HR@5': '0.0294', 'NDCG@5': '0.0190', 'HR@10': '0.0506', 'NDCG@10': '0.0258', 'HR@20': '0.0812', 'NDCG@20': '0.0335'}
2025-02-25 19:32:41,580 - EarlyStopping counter: 8 out of 10
2025-02-25 19:33:23,402 - {'epoch': 40, 'rec_loss': '7.1823'}
2025-02-25 19:33:40,619 - {'Epoch': 40, 'HR@5': '0.0295', 'NDCG@5': '0.0188', 'HR@10': '0.0507', 'NDCG@10': '0.0256', 'HR@20': '0.0819', 'NDCG@20': '0.0334'}
2025-02-25 19:33:40,628 - EarlyStopping counter: 9 out of 10
2025-02-25 19:34:24,925 - {'epoch': 41, 'rec_loss': '7.1776'}
2025-02-25 19:34:39,851 - {'Epoch': 41, 'HR@5': '0.0306', 'NDCG@5': '0.0192', 'HR@10': '0.0492', 'NDCG@10': '0.0252', 'HR@20': '0.0815', 'NDCG@20': '0.0333'}
2025-02-25 19:34:39,853 - EarlyStopping counter: 10 out of 10
2025-02-25 19:34:39,854 - Early stopping
2025-02-25 19:34:39,854 - ---------------Test Score---------------
2025-02-25 19:34:55,764 - {'Epoch': 0, 'HR@5': '0.0271', 'NDCG@5': '0.0172', 'HR@10': '0.0462', 'NDCG@10': '0.0233', 'HR@20': '0.0755', 'NDCG@20': '0.0307'}
2025-02-25 19:34:55,767 - Scale_Yelp
2025-02-25 19:34:55,767 - {'Epoch': 0, 'HR@5': '0.0271', 'NDCG@5': '0.0172', 'HR@10': '0.0462', 'NDCG@10': '0.0233', 'HR@20': '0.0755', 'NDCG@20': '0.0307'}
2025-02-25 19:38:43,776 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25, 5], kernels=[4, 8, 12], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-02-25 19:38:46,566 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-25 19:38:46,572 - Total Parameters: 1435793
2025-02-25 19:39:45,545 - {'epoch': 0, 'rec_loss': '9.5542'}
2025-02-25 19:40:02,154 - {'Epoch': 0, 'HR@5': '0.0088', 'NDCG@5': '0.0051', 'HR@10': '0.0162', 'NDCG@10': '0.0075', 'HR@20': '0.0258', 'NDCG@20': '0.0099'}
2025-02-25 19:40:02,158 - Validation score increased.  Saving model ...
2025-02-25 19:40:58,861 - {'epoch': 1, 'rec_loss': '8.8334'}
2025-02-25 19:41:14,083 - {'Epoch': 1, 'HR@5': '0.0159', 'NDCG@5': '0.0097', 'HR@10': '0.0279', 'NDCG@10': '0.0135', 'HR@20': '0.0456', 'NDCG@20': '0.0179'}
2025-02-25 19:41:14,085 - Validation score increased.  Saving model ...
2025-02-25 19:42:14,221 - {'epoch': 2, 'rec_loss': '8.3372'}
2025-02-25 19:42:31,570 - {'Epoch': 2, 'HR@5': '0.0204', 'NDCG@5': '0.0125', 'HR@10': '0.0367', 'NDCG@10': '0.0177', 'HR@20': '0.0573', 'NDCG@20': '0.0229'}
2025-02-25 19:42:31,571 - Validation score increased.  Saving model ...
2025-02-25 19:43:32,164 - {'epoch': 3, 'rec_loss': '8.0936'}
2025-02-25 19:43:49,772 - {'Epoch': 3, 'HR@5': '0.0217', 'NDCG@5': '0.0133', 'HR@10': '0.0372', 'NDCG@10': '0.0183', 'HR@20': '0.0624', 'NDCG@20': '0.0246'}
2025-02-25 19:43:49,776 - Validation score increased.  Saving model ...
2025-02-25 19:44:51,643 - {'epoch': 4, 'rec_loss': '7.9341'}
2025-02-25 19:45:06,990 - {'Epoch': 4, 'HR@5': '0.0243', 'NDCG@5': '0.0152', 'HR@10': '0.0410', 'NDCG@10': '0.0205', 'HR@20': '0.0667', 'NDCG@20': '0.0269'}
2025-02-25 19:45:06,994 - Validation score increased.  Saving model ...
2025-02-25 19:46:04,918 - {'epoch': 5, 'rec_loss': '7.8159'}
2025-02-25 19:46:20,399 - {'Epoch': 5, 'HR@5': '0.0272', 'NDCG@5': '0.0169', 'HR@10': '0.0438', 'NDCG@10': '0.0222', 'HR@20': '0.0716', 'NDCG@20': '0.0292'}
2025-02-25 19:46:20,401 - Validation score increased.  Saving model ...
2025-02-25 19:47:18,584 - {'epoch': 6, 'rec_loss': '7.7229'}
2025-02-25 19:47:34,077 - {'Epoch': 6, 'HR@5': '0.0253', 'NDCG@5': '0.0159', 'HR@10': '0.0440', 'NDCG@10': '0.0219', 'HR@20': '0.0697', 'NDCG@20': '0.0284'}
2025-02-25 19:47:34,081 - EarlyStopping counter: 1 out of 10
2025-02-25 19:48:37,046 - {'epoch': 7, 'rec_loss': '7.6502'}
2025-02-25 19:48:52,624 - {'Epoch': 7, 'HR@5': '0.0272', 'NDCG@5': '0.0170', 'HR@10': '0.0460', 'NDCG@10': '0.0231', 'HR@20': '0.0751', 'NDCG@20': '0.0304'}
2025-02-25 19:48:52,625 - Validation score increased.  Saving model ...
2025-02-25 19:49:49,466 - {'epoch': 8, 'rec_loss': '7.5866'}
2025-02-25 19:50:05,076 - {'Epoch': 8, 'HR@5': '0.0265', 'NDCG@5': '0.0167', 'HR@10': '0.0452', 'NDCG@10': '0.0227', 'HR@20': '0.0749', 'NDCG@20': '0.0301'}
2025-02-25 19:50:05,080 - EarlyStopping counter: 1 out of 10
2025-02-25 19:51:02,890 - {'epoch': 9, 'rec_loss': '7.5353'}
2025-02-25 19:51:19,708 - {'Epoch': 9, 'HR@5': '0.0271', 'NDCG@5': '0.0170', 'HR@10': '0.0470', 'NDCG@10': '0.0234', 'HR@20': '0.0754', 'NDCG@20': '0.0305'}
2025-02-25 19:51:19,712 - Validation score increased.  Saving model ...
2025-02-25 19:52:18,379 - {'epoch': 10, 'rec_loss': '7.4885'}
2025-02-25 19:52:35,552 - {'Epoch': 10, 'HR@5': '0.0277', 'NDCG@5': '0.0172', 'HR@10': '0.0476', 'NDCG@10': '0.0235', 'HR@20': '0.0764', 'NDCG@20': '0.0307'}
2025-02-25 19:52:35,556 - Validation score increased.  Saving model ...
2025-02-25 19:53:34,627 - {'epoch': 11, 'rec_loss': '7.4547'}
2025-02-25 19:53:52,356 - {'Epoch': 11, 'HR@5': '0.0286', 'NDCG@5': '0.0178', 'HR@10': '0.0479', 'NDCG@10': '0.0240', 'HR@20': '0.0784', 'NDCG@20': '0.0317'}
2025-02-25 19:53:52,358 - Validation score increased.  Saving model ...
2025-02-25 19:54:50,353 - {'epoch': 12, 'rec_loss': '7.4156'}
2025-02-25 19:55:09,430 - {'Epoch': 12, 'HR@5': '0.0287', 'NDCG@5': '0.0178', 'HR@10': '0.0488', 'NDCG@10': '0.0242', 'HR@20': '0.0775', 'NDCG@20': '0.0314'}
2025-02-25 19:55:09,432 - EarlyStopping counter: 1 out of 10
2025-02-25 19:56:06,978 - {'epoch': 13, 'rec_loss': '7.3828'}
2025-02-25 19:56:22,947 - {'Epoch': 13, 'HR@5': '0.0292', 'NDCG@5': '0.0181', 'HR@10': '0.0495', 'NDCG@10': '0.0246', 'HR@20': '0.0801', 'NDCG@20': '0.0323'}
2025-02-25 19:56:22,949 - Validation score increased.  Saving model ...
2025-02-25 19:57:22,983 - {'epoch': 14, 'rec_loss': '7.3596'}
2025-02-25 19:57:38,874 - {'Epoch': 14, 'HR@5': '0.0272', 'NDCG@5': '0.0174', 'HR@10': '0.0469', 'NDCG@10': '0.0237', 'HR@20': '0.0776', 'NDCG@20': '0.0314'}
2025-02-25 19:57:38,876 - EarlyStopping counter: 1 out of 10
2025-02-25 19:58:42,441 - {'epoch': 15, 'rec_loss': '7.3313'}
2025-02-25 19:58:58,884 - {'Epoch': 15, 'HR@5': '0.0289', 'NDCG@5': '0.0180', 'HR@10': '0.0483', 'NDCG@10': '0.0242', 'HR@20': '0.0788', 'NDCG@20': '0.0318'}
2025-02-25 19:58:58,887 - EarlyStopping counter: 2 out of 10
2025-02-25 19:59:55,854 - {'epoch': 16, 'rec_loss': '7.3122'}
2025-02-25 20:00:14,438 - {'Epoch': 16, 'HR@5': '0.0284', 'NDCG@5': '0.0177', 'HR@10': '0.0482', 'NDCG@10': '0.0240', 'HR@20': '0.0786', 'NDCG@20': '0.0317'}
2025-02-25 20:00:14,440 - EarlyStopping counter: 3 out of 10
2025-02-25 20:01:11,727 - {'epoch': 17, 'rec_loss': '7.2914'}
2025-02-25 20:01:30,151 - {'Epoch': 17, 'HR@5': '0.0295', 'NDCG@5': '0.0184', 'HR@10': '0.0487', 'NDCG@10': '0.0246', 'HR@20': '0.0792', 'NDCG@20': '0.0322'}
2025-02-25 20:01:30,153 - EarlyStopping counter: 4 out of 10
2025-02-25 20:02:27,642 - {'epoch': 18, 'rec_loss': '7.2691'}
2025-02-25 20:02:45,533 - {'Epoch': 18, 'HR@5': '0.0291', 'NDCG@5': '0.0187', 'HR@10': '0.0486', 'NDCG@10': '0.0250', 'HR@20': '0.0780', 'NDCG@20': '0.0324'}
2025-02-25 20:02:45,534 - Validation score increased.  Saving model ...
2025-02-25 20:03:42,300 - {'epoch': 19, 'rec_loss': '7.2566'}
2025-02-25 20:03:58,377 - {'Epoch': 19, 'HR@5': '0.0294', 'NDCG@5': '0.0186', 'HR@10': '0.0487', 'NDCG@10': '0.0249', 'HR@20': '0.0791', 'NDCG@20': '0.0325'}
2025-02-25 20:03:58,381 - Validation score increased.  Saving model ...
2025-02-25 20:04:56,322 - {'epoch': 20, 'rec_loss': '7.2385'}
2025-02-25 20:05:13,307 - {'Epoch': 20, 'HR@5': '0.0295', 'NDCG@5': '0.0187', 'HR@10': '0.0492', 'NDCG@10': '0.0250', 'HR@20': '0.0804', 'NDCG@20': '0.0329'}
2025-02-25 20:05:13,317 - Validation score increased.  Saving model ...
2025-02-25 20:06:10,070 - {'epoch': 21, 'rec_loss': '7.2219'}
2025-02-25 20:06:28,028 - {'Epoch': 21, 'HR@5': '0.0286', 'NDCG@5': '0.0178', 'HR@10': '0.0479', 'NDCG@10': '0.0241', 'HR@20': '0.0777', 'NDCG@20': '0.0316'}
2025-02-25 20:06:28,030 - EarlyStopping counter: 1 out of 10
2025-02-25 20:07:24,780 - {'epoch': 22, 'rec_loss': '7.2069'}
2025-02-25 20:07:43,179 - {'Epoch': 22, 'HR@5': '0.0292', 'NDCG@5': '0.0183', 'HR@10': '0.0502', 'NDCG@10': '0.0250', 'HR@20': '0.0789', 'NDCG@20': '0.0322'}
2025-02-25 20:07:43,180 - EarlyStopping counter: 2 out of 10
2025-02-25 20:08:40,000 - {'epoch': 23, 'rec_loss': '7.1960'}
2025-02-25 20:08:57,343 - {'Epoch': 23, 'HR@5': '0.0308', 'NDCG@5': '0.0192', 'HR@10': '0.0500', 'NDCG@10': '0.0253', 'HR@20': '0.0806', 'NDCG@20': '0.0330'}
2025-02-25 20:08:57,347 - Validation score increased.  Saving model ...
2025-02-25 20:09:55,363 - {'epoch': 24, 'rec_loss': '7.1813'}
2025-02-25 20:10:12,102 - {'Epoch': 24, 'HR@5': '0.0303', 'NDCG@5': '0.0189', 'HR@10': '0.0504', 'NDCG@10': '0.0253', 'HR@20': '0.0805', 'NDCG@20': '0.0329'}
2025-02-25 20:10:12,107 - EarlyStopping counter: 1 out of 10
2025-02-25 20:11:10,162 - {'epoch': 25, 'rec_loss': '7.1739'}
2025-02-25 20:11:26,261 - {'Epoch': 25, 'HR@5': '0.0296', 'NDCG@5': '0.0185', 'HR@10': '0.0482', 'NDCG@10': '0.0245', 'HR@20': '0.0785', 'NDCG@20': '0.0321'}
2025-02-25 20:11:26,263 - EarlyStopping counter: 2 out of 10
2025-02-25 20:12:23,145 - {'epoch': 26, 'rec_loss': '7.1618'}
2025-02-25 20:12:41,864 - {'Epoch': 26, 'HR@5': '0.0304', 'NDCG@5': '0.0195', 'HR@10': '0.0496', 'NDCG@10': '0.0256', 'HR@20': '0.0789', 'NDCG@20': '0.0330'}
2025-02-25 20:12:41,866 - Validation score increased.  Saving model ...
2025-02-25 20:13:39,259 - {'epoch': 27, 'rec_loss': '7.1478'}
2025-02-25 20:13:55,430 - {'Epoch': 27, 'HR@5': '0.0303', 'NDCG@5': '0.0194', 'HR@10': '0.0496', 'NDCG@10': '0.0256', 'HR@20': '0.0799', 'NDCG@20': '0.0332'}
2025-02-25 20:13:55,432 - Validation score increased.  Saving model ...
2025-02-25 20:14:53,604 - {'epoch': 28, 'rec_loss': '7.1371'}
2025-02-25 20:15:09,942 - {'Epoch': 28, 'HR@5': '0.0305', 'NDCG@5': '0.0190', 'HR@10': '0.0487', 'NDCG@10': '0.0248', 'HR@20': '0.0785', 'NDCG@20': '0.0323'}
2025-02-25 20:15:09,944 - EarlyStopping counter: 1 out of 10
2025-02-25 20:16:06,728 - {'epoch': 29, 'rec_loss': '7.1276'}
2025-02-25 20:16:25,332 - {'Epoch': 29, 'HR@5': '0.0310', 'NDCG@5': '0.0197', 'HR@10': '0.0503', 'NDCG@10': '0.0259', 'HR@20': '0.0800', 'NDCG@20': '0.0333'}
2025-02-25 20:16:25,334 - Validation score increased.  Saving model ...
2025-02-25 20:17:23,385 - {'epoch': 30, 'rec_loss': '7.1217'}
2025-02-25 20:17:40,117 - {'Epoch': 30, 'HR@5': '0.0310', 'NDCG@5': '0.0194', 'HR@10': '0.0498', 'NDCG@10': '0.0254', 'HR@20': '0.0797', 'NDCG@20': '0.0329'}
2025-02-25 20:17:40,119 - EarlyStopping counter: 1 out of 10
2025-02-25 20:18:43,803 - {'epoch': 31, 'rec_loss': '7.1139'}
2025-02-25 20:19:01,775 - {'Epoch': 31, 'HR@5': '0.0314', 'NDCG@5': '0.0197', 'HR@10': '0.0500', 'NDCG@10': '0.0256', 'HR@20': '0.0797', 'NDCG@20': '0.0331'}
2025-02-25 20:19:01,778 - EarlyStopping counter: 2 out of 10
2025-02-25 20:19:59,081 - {'epoch': 32, 'rec_loss': '7.1040'}
2025-02-25 20:20:16,919 - {'Epoch': 32, 'HR@5': '0.0290', 'NDCG@5': '0.0183', 'HR@10': '0.0495', 'NDCG@10': '0.0248', 'HR@20': '0.0805', 'NDCG@20': '0.0327'}
2025-02-25 20:20:16,924 - EarlyStopping counter: 3 out of 10
2025-02-25 20:21:14,667 - {'epoch': 33, 'rec_loss': '7.0938'}
2025-02-25 20:21:33,491 - {'Epoch': 33, 'HR@5': '0.0301', 'NDCG@5': '0.0191', 'HR@10': '0.0488', 'NDCG@10': '0.0251', 'HR@20': '0.0800', 'NDCG@20': '0.0329'}
2025-02-25 20:21:33,493 - EarlyStopping counter: 4 out of 10
2025-02-25 20:22:30,557 - {'epoch': 34, 'rec_loss': '7.0880'}
2025-02-25 20:22:47,560 - {'Epoch': 34, 'HR@5': '0.0288', 'NDCG@5': '0.0184', 'HR@10': '0.0480', 'NDCG@10': '0.0246', 'HR@20': '0.0794', 'NDCG@20': '0.0325'}
2025-02-25 20:22:47,562 - EarlyStopping counter: 5 out of 10
2025-02-25 20:23:44,610 - {'epoch': 35, 'rec_loss': '7.0786'}
2025-02-25 20:24:02,921 - {'Epoch': 35, 'HR@5': '0.0297', 'NDCG@5': '0.0189', 'HR@10': '0.0496', 'NDCG@10': '0.0252', 'HR@20': '0.0800', 'NDCG@20': '0.0329'}
2025-02-25 20:24:02,925 - EarlyStopping counter: 6 out of 10
2025-02-25 20:25:01,025 - {'epoch': 36, 'rec_loss': '7.0744'}
2025-02-25 20:25:16,855 - {'Epoch': 36, 'HR@5': '0.0291', 'NDCG@5': '0.0180', 'HR@10': '0.0484', 'NDCG@10': '0.0242', 'HR@20': '0.0796', 'NDCG@20': '0.0321'}
2025-02-25 20:25:16,857 - EarlyStopping counter: 7 out of 10
2025-02-25 20:26:14,793 - {'epoch': 37, 'rec_loss': '7.0642'}
2025-02-25 20:26:31,144 - {'Epoch': 37, 'HR@5': '0.0303', 'NDCG@5': '0.0193', 'HR@10': '0.0488', 'NDCG@10': '0.0252', 'HR@20': '0.0796', 'NDCG@20': '0.0330'}
2025-02-25 20:26:31,147 - EarlyStopping counter: 8 out of 10
2025-02-25 20:27:28,172 - {'epoch': 38, 'rec_loss': '7.0624'}
2025-02-25 20:27:46,808 - {'Epoch': 38, 'HR@5': '0.0304', 'NDCG@5': '0.0192', 'HR@10': '0.0506', 'NDCG@10': '0.0256', 'HR@20': '0.0812', 'NDCG@20': '0.0333'}
2025-02-25 20:27:46,810 - EarlyStopping counter: 9 out of 10
2025-02-25 20:28:43,716 - {'epoch': 39, 'rec_loss': '7.0552'}
2025-02-25 20:28:59,782 - {'Epoch': 39, 'HR@5': '0.0302', 'NDCG@5': '0.0189', 'HR@10': '0.0493', 'NDCG@10': '0.0251', 'HR@20': '0.0800', 'NDCG@20': '0.0328'}
2025-02-25 20:28:59,786 - EarlyStopping counter: 10 out of 10
2025-02-25 20:28:59,786 - Early stopping
2025-02-25 20:28:59,786 - ---------------Test Score---------------
2025-02-25 20:29:18,328 - {'Epoch': 0, 'HR@5': '0.0268', 'NDCG@5': '0.0164', 'HR@10': '0.0458', 'NDCG@10': '0.0225', 'HR@20': '0.0748', 'NDCG@20': '0.0298'}
2025-02-25 20:29:18,334 - Scale_Yelp
2025-02-25 20:29:18,334 - {'Epoch': 0, 'HR@5': '0.0268', 'NDCG@5': '0.0164', 'HR@10': '0.0458', 'NDCG@10': '0.0225', 'HR@20': '0.0748', 'NDCG@20': '0.0298'}
2025-02-25 20:42:49,558 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 5], kernels=[4, 8, 12], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-02-25 20:42:52,303 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-25 20:42:52,309 - Total Parameters: 1435793
2025-02-25 20:43:39,212 - {'epoch': 0, 'rec_loss': '9.5491'}
2025-02-25 20:43:54,805 - {'Epoch': 0, 'HR@5': '0.0073', 'NDCG@5': '0.0047', 'HR@10': '0.0131', 'NDCG@10': '0.0066', 'HR@20': '0.0243', 'NDCG@20': '0.0094'}
2025-02-25 20:43:54,806 - Validation score increased.  Saving model ...
2025-02-25 20:44:37,640 - {'epoch': 1, 'rec_loss': '8.9440'}
2025-02-25 20:44:52,368 - {'Epoch': 1, 'HR@5': '0.0132', 'NDCG@5': '0.0081', 'HR@10': '0.0239', 'NDCG@10': '0.0115', 'HR@20': '0.0415', 'NDCG@20': '0.0159'}
2025-02-25 20:44:52,370 - Validation score increased.  Saving model ...
2025-02-25 20:45:36,838 - {'epoch': 2, 'rec_loss': '8.5157'}
2025-02-25 20:45:51,480 - {'Epoch': 2, 'HR@5': '0.0190', 'NDCG@5': '0.0120', 'HR@10': '0.0321', 'NDCG@10': '0.0162', 'HR@20': '0.0527', 'NDCG@20': '0.0214'}
2025-02-25 20:45:51,482 - Validation score increased.  Saving model ...
2025-02-25 20:46:36,477 - {'epoch': 3, 'rec_loss': '8.2509'}
2025-02-25 20:46:50,916 - {'Epoch': 3, 'HR@5': '0.0218', 'NDCG@5': '0.0134', 'HR@10': '0.0379', 'NDCG@10': '0.0185', 'HR@20': '0.0605', 'NDCG@20': '0.0242'}
2025-02-25 20:46:50,917 - Validation score increased.  Saving model ...
2025-02-25 20:47:35,681 - {'epoch': 4, 'rec_loss': '8.0803'}
2025-02-25 20:47:51,267 - {'Epoch': 4, 'HR@5': '0.0218', 'NDCG@5': '0.0140', 'HR@10': '0.0391', 'NDCG@10': '0.0196', 'HR@20': '0.0666', 'NDCG@20': '0.0265'}
2025-02-25 20:47:51,269 - Validation score increased.  Saving model ...
2025-02-25 20:48:34,516 - {'epoch': 5, 'rec_loss': '7.9556'}
2025-02-25 20:48:49,361 - {'Epoch': 5, 'HR@5': '0.0233', 'NDCG@5': '0.0143', 'HR@10': '0.0411', 'NDCG@10': '0.0200', 'HR@20': '0.0698', 'NDCG@20': '0.0272'}
2025-02-25 20:48:49,363 - Validation score increased.  Saving model ...
2025-02-25 20:49:33,071 - {'epoch': 6, 'rec_loss': '7.8559'}
2025-02-25 20:49:47,900 - {'Epoch': 6, 'HR@5': '0.0253', 'NDCG@5': '0.0159', 'HR@10': '0.0440', 'NDCG@10': '0.0218', 'HR@20': '0.0730', 'NDCG@20': '0.0291'}
2025-02-25 20:49:47,901 - Validation score increased.  Saving model ...
2025-02-25 20:50:33,090 - {'epoch': 7, 'rec_loss': '7.7870'}
2025-02-25 20:50:48,635 - {'Epoch': 7, 'HR@5': '0.0256', 'NDCG@5': '0.0158', 'HR@10': '0.0446', 'NDCG@10': '0.0219', 'HR@20': '0.0729', 'NDCG@20': '0.0290'}
2025-02-25 20:50:48,637 - EarlyStopping counter: 1 out of 10
2025-02-25 20:51:36,276 - {'epoch': 8, 'rec_loss': '7.7231'}
2025-02-25 20:51:51,300 - {'Epoch': 8, 'HR@5': '0.0268', 'NDCG@5': '0.0167', 'HR@10': '0.0463', 'NDCG@10': '0.0230', 'HR@20': '0.0747', 'NDCG@20': '0.0301'}
2025-02-25 20:51:51,302 - Validation score increased.  Saving model ...
2025-02-25 20:52:36,070 - {'epoch': 9, 'rec_loss': '7.6716'}
2025-02-25 20:52:54,355 - {'Epoch': 9, 'HR@5': '0.0270', 'NDCG@5': '0.0169', 'HR@10': '0.0475', 'NDCG@10': '0.0235', 'HR@20': '0.0771', 'NDCG@20': '0.0309'}
2025-02-25 20:52:54,357 - Validation score increased.  Saving model ...
2025-02-25 20:53:42,447 - {'epoch': 10, 'rec_loss': '7.6300'}
2025-02-25 20:53:58,123 - {'Epoch': 10, 'HR@5': '0.0275', 'NDCG@5': '0.0172', 'HR@10': '0.0469', 'NDCG@10': '0.0235', 'HR@20': '0.0778', 'NDCG@20': '0.0312'}
2025-02-25 20:53:58,125 - Validation score increased.  Saving model ...
2025-02-25 20:54:43,124 - {'epoch': 11, 'rec_loss': '7.5877'}
2025-02-25 20:54:59,941 - {'Epoch': 11, 'HR@5': '0.0280', 'NDCG@5': '0.0175', 'HR@10': '0.0479', 'NDCG@10': '0.0239', 'HR@20': '0.0771', 'NDCG@20': '0.0312'}
2025-02-25 20:54:59,943 - Validation score increased.  Saving model ...
2025-02-25 20:55:44,290 - {'epoch': 12, 'rec_loss': '7.5614'}
2025-02-25 20:56:01,433 - {'Epoch': 12, 'HR@5': '0.0300', 'NDCG@5': '0.0187', 'HR@10': '0.0483', 'NDCG@10': '0.0246', 'HR@20': '0.0780', 'NDCG@20': '0.0320'}
2025-02-25 20:56:01,434 - Validation score increased.  Saving model ...
2025-02-25 20:56:43,210 - {'epoch': 13, 'rec_loss': '7.5244'}
2025-02-25 20:56:59,438 - {'Epoch': 13, 'HR@5': '0.0300', 'NDCG@5': '0.0188', 'HR@10': '0.0501', 'NDCG@10': '0.0253', 'HR@20': '0.0787', 'NDCG@20': '0.0325'}
2025-02-25 20:56:59,443 - Validation score increased.  Saving model ...
2025-02-25 20:57:44,469 - {'epoch': 14, 'rec_loss': '7.4996'}
2025-02-25 20:58:00,648 - {'Epoch': 14, 'HR@5': '0.0286', 'NDCG@5': '0.0182', 'HR@10': '0.0493', 'NDCG@10': '0.0248', 'HR@20': '0.0800', 'NDCG@20': '0.0325'}
2025-02-25 20:58:00,650 - Validation score increased.  Saving model ...
2025-02-25 20:58:43,521 - {'epoch': 15, 'rec_loss': '7.4725'}
2025-02-25 20:58:58,925 - {'Epoch': 15, 'HR@5': '0.0298', 'NDCG@5': '0.0186', 'HR@10': '0.0488', 'NDCG@10': '0.0247', 'HR@20': '0.0794', 'NDCG@20': '0.0323'}
2025-02-25 20:58:58,926 - EarlyStopping counter: 1 out of 10
2025-02-25 20:59:40,351 - {'epoch': 16, 'rec_loss': '7.4527'}
2025-02-25 20:59:56,193 - {'Epoch': 16, 'HR@5': '0.0296', 'NDCG@5': '0.0186', 'HR@10': '0.0496', 'NDCG@10': '0.0251', 'HR@20': '0.0803', 'NDCG@20': '0.0328'}
2025-02-25 20:59:56,194 - Validation score increased.  Saving model ...
2025-02-25 21:00:37,139 - {'epoch': 17, 'rec_loss': '7.4276'}
2025-02-25 21:00:53,991 - {'Epoch': 17, 'HR@5': '0.0311', 'NDCG@5': '0.0194', 'HR@10': '0.0505', 'NDCG@10': '0.0256', 'HR@20': '0.0792', 'NDCG@20': '0.0328'}
2025-02-25 21:00:53,993 - Validation score increased.  Saving model ...
2025-02-25 21:01:34,909 - {'epoch': 18, 'rec_loss': '7.4084'}
2025-02-25 21:01:52,379 - {'Epoch': 18, 'HR@5': '0.0293', 'NDCG@5': '0.0185', 'HR@10': '0.0489', 'NDCG@10': '0.0248', 'HR@20': '0.0812', 'NDCG@20': '0.0329'}
2025-02-25 21:01:52,381 - Validation score increased.  Saving model ...
2025-02-25 21:02:33,158 - {'epoch': 19, 'rec_loss': '7.3937'}
2025-02-25 21:02:50,060 - {'Epoch': 19, 'HR@5': '0.0296', 'NDCG@5': '0.0186', 'HR@10': '0.0499', 'NDCG@10': '0.0251', 'HR@20': '0.0798', 'NDCG@20': '0.0326'}
2025-02-25 21:02:50,062 - EarlyStopping counter: 1 out of 10
2025-02-25 21:03:30,940 - {'epoch': 20, 'rec_loss': '7.3761'}
2025-02-25 21:03:46,354 - {'Epoch': 20, 'HR@5': '0.0294', 'NDCG@5': '0.0186', 'HR@10': '0.0501', 'NDCG@10': '0.0252', 'HR@20': '0.0805', 'NDCG@20': '0.0329'}
2025-02-25 21:03:46,356 - EarlyStopping counter: 2 out of 10
2025-02-25 21:04:27,151 - {'epoch': 21, 'rec_loss': '7.3668'}
2025-02-25 21:04:45,516 - {'Epoch': 21, 'HR@5': '0.0301', 'NDCG@5': '0.0189', 'HR@10': '0.0507', 'NDCG@10': '0.0256', 'HR@20': '0.0808', 'NDCG@20': '0.0331'}
2025-02-25 21:04:45,518 - Validation score increased.  Saving model ...
2025-02-25 21:05:26,449 - {'epoch': 22, 'rec_loss': '7.3558'}
2025-02-25 21:05:41,564 - {'Epoch': 22, 'HR@5': '0.0286', 'NDCG@5': '0.0179', 'HR@10': '0.0499', 'NDCG@10': '0.0247', 'HR@20': '0.0796', 'NDCG@20': '0.0322'}
2025-02-25 21:05:41,566 - EarlyStopping counter: 1 out of 10
2025-02-25 21:06:22,474 - {'epoch': 23, 'rec_loss': '7.3335'}
2025-02-25 21:06:39,885 - {'Epoch': 23, 'HR@5': '0.0293', 'NDCG@5': '0.0186', 'HR@10': '0.0497', 'NDCG@10': '0.0252', 'HR@20': '0.0804', 'NDCG@20': '0.0329'}
2025-02-25 21:06:39,887 - EarlyStopping counter: 2 out of 10
2025-02-25 21:07:20,649 - {'epoch': 24, 'rec_loss': '7.3280'}
2025-02-25 21:07:35,822 - {'Epoch': 24, 'HR@5': '0.0290', 'NDCG@5': '0.0181', 'HR@10': '0.0482', 'NDCG@10': '0.0243', 'HR@20': '0.0809', 'NDCG@20': '0.0325'}
2025-02-25 21:07:35,824 - EarlyStopping counter: 3 out of 10
2025-02-25 21:08:16,731 - {'epoch': 25, 'rec_loss': '7.3146'}
2025-02-25 21:08:33,893 - {'Epoch': 25, 'HR@5': '0.0308', 'NDCG@5': '0.0190', 'HR@10': '0.0499', 'NDCG@10': '0.0252', 'HR@20': '0.0797', 'NDCG@20': '0.0327'}
2025-02-25 21:08:33,895 - EarlyStopping counter: 4 out of 10
2025-02-25 21:09:14,981 - {'epoch': 26, 'rec_loss': '7.3039'}
2025-02-25 21:09:30,186 - {'Epoch': 26, 'HR@5': '0.0308', 'NDCG@5': '0.0195', 'HR@10': '0.0508', 'NDCG@10': '0.0259', 'HR@20': '0.0815', 'NDCG@20': '0.0336'}
2025-02-25 21:09:30,188 - Validation score increased.  Saving model ...
2025-02-25 21:10:13,549 - {'epoch': 27, 'rec_loss': '7.2949'}
2025-02-25 21:10:31,006 - {'Epoch': 27, 'HR@5': '0.0303', 'NDCG@5': '0.0190', 'HR@10': '0.0505', 'NDCG@10': '0.0255', 'HR@20': '0.0806', 'NDCG@20': '0.0331'}
2025-02-25 21:10:31,007 - EarlyStopping counter: 1 out of 10
2025-02-25 21:11:12,467 - {'epoch': 28, 'rec_loss': '7.2799'}
2025-02-25 21:11:30,199 - {'Epoch': 28, 'HR@5': '0.0299', 'NDCG@5': '0.0191', 'HR@10': '0.0498', 'NDCG@10': '0.0255', 'HR@20': '0.0796', 'NDCG@20': '0.0330'}
2025-02-25 21:11:30,201 - EarlyStopping counter: 2 out of 10
2025-02-25 21:12:11,830 - {'epoch': 29, 'rec_loss': '7.2716'}
2025-02-25 21:12:27,064 - {'Epoch': 29, 'HR@5': '0.0301', 'NDCG@5': '0.0190', 'HR@10': '0.0487', 'NDCG@10': '0.0250', 'HR@20': '0.0793', 'NDCG@20': '0.0327'}
2025-02-25 21:12:27,065 - EarlyStopping counter: 3 out of 10
2025-02-25 21:13:07,775 - {'epoch': 30, 'rec_loss': '7.2680'}
2025-02-25 21:13:23,398 - {'Epoch': 30, 'HR@5': '0.0303', 'NDCG@5': '0.0191', 'HR@10': '0.0497', 'NDCG@10': '0.0253', 'HR@20': '0.0820', 'NDCG@20': '0.0334'}
2025-02-25 21:13:23,400 - EarlyStopping counter: 4 out of 10
2025-02-25 21:14:04,921 - {'epoch': 31, 'rec_loss': '7.2612'}
2025-02-25 21:14:22,335 - {'Epoch': 31, 'HR@5': '0.0297', 'NDCG@5': '0.0193', 'HR@10': '0.0504', 'NDCG@10': '0.0260', 'HR@20': '0.0818', 'NDCG@20': '0.0338'}
2025-02-25 21:14:22,336 - Validation score increased.  Saving model ...
2025-02-25 21:15:03,300 - {'epoch': 32, 'rec_loss': '7.2499'}
2025-02-25 21:15:18,504 - {'Epoch': 32, 'HR@5': '0.0308', 'NDCG@5': '0.0194', 'HR@10': '0.0506', 'NDCG@10': '0.0257', 'HR@20': '0.0807', 'NDCG@20': '0.0333'}
2025-02-25 21:15:18,506 - EarlyStopping counter: 1 out of 10
2025-02-25 21:15:59,589 - {'epoch': 33, 'rec_loss': '7.2428'}
2025-02-25 21:16:14,993 - {'Epoch': 33, 'HR@5': '0.0311', 'NDCG@5': '0.0197', 'HR@10': '0.0506', 'NDCG@10': '0.0260', 'HR@20': '0.0824', 'NDCG@20': '0.0339'}
2025-02-25 21:16:14,995 - Validation score increased.  Saving model ...
2025-02-25 21:16:56,527 - {'epoch': 34, 'rec_loss': '7.2325'}
2025-02-25 21:17:14,921 - {'Epoch': 34, 'HR@5': '0.0294', 'NDCG@5': '0.0190', 'HR@10': '0.0509', 'NDCG@10': '0.0259', 'HR@20': '0.0815', 'NDCG@20': '0.0336'}
2025-02-25 21:17:14,923 - EarlyStopping counter: 1 out of 10
2025-02-25 21:17:56,182 - {'epoch': 35, 'rec_loss': '7.2281'}
2025-02-25 21:18:11,369 - {'Epoch': 35, 'HR@5': '0.0304', 'NDCG@5': '0.0194', 'HR@10': '0.0504', 'NDCG@10': '0.0258', 'HR@20': '0.0811', 'NDCG@20': '0.0335'}
2025-02-25 21:18:11,370 - EarlyStopping counter: 2 out of 10
2025-02-25 21:18:53,853 - {'epoch': 36, 'rec_loss': '7.2212'}
2025-02-25 21:19:09,039 - {'Epoch': 36, 'HR@5': '0.0305', 'NDCG@5': '0.0192', 'HR@10': '0.0499', 'NDCG@10': '0.0254', 'HR@20': '0.0803', 'NDCG@20': '0.0330'}
2025-02-25 21:19:09,041 - EarlyStopping counter: 3 out of 10
2025-02-25 21:19:49,917 - {'epoch': 37, 'rec_loss': '7.2099'}
2025-02-25 21:20:07,382 - {'Epoch': 37, 'HR@5': '0.0293', 'NDCG@5': '0.0191', 'HR@10': '0.0495', 'NDCG@10': '0.0255', 'HR@20': '0.0807', 'NDCG@20': '0.0333'}
2025-02-25 21:20:07,384 - EarlyStopping counter: 4 out of 10
2025-02-25 21:20:49,406 - {'epoch': 38, 'rec_loss': '7.2032'}
2025-02-25 21:21:06,892 - {'Epoch': 38, 'HR@5': '0.0300', 'NDCG@5': '0.0190', 'HR@10': '0.0502', 'NDCG@10': '0.0255', 'HR@20': '0.0805', 'NDCG@20': '0.0331'}
2025-02-25 21:21:06,894 - EarlyStopping counter: 5 out of 10
2025-02-25 21:21:47,672 - {'epoch': 39, 'rec_loss': '7.1979'}
2025-02-25 21:22:02,981 - {'Epoch': 39, 'HR@5': '0.0308', 'NDCG@5': '0.0194', 'HR@10': '0.0501', 'NDCG@10': '0.0255', 'HR@20': '0.0808', 'NDCG@20': '0.0333'}
2025-02-25 21:22:02,983 - EarlyStopping counter: 6 out of 10
2025-02-25 21:22:45,256 - {'epoch': 40, 'rec_loss': '7.1936'}
2025-02-25 21:23:00,468 - {'Epoch': 40, 'HR@5': '0.0309', 'NDCG@5': '0.0198', 'HR@10': '0.0506', 'NDCG@10': '0.0260', 'HR@20': '0.0817', 'NDCG@20': '0.0339'}
2025-02-25 21:23:00,470 - EarlyStopping counter: 7 out of 10
2025-02-25 21:23:42,029 - {'epoch': 41, 'rec_loss': '7.1905'}
2025-02-25 21:23:59,579 - {'Epoch': 41, 'HR@5': '0.0311', 'NDCG@5': '0.0197', 'HR@10': '0.0522', 'NDCG@10': '0.0265', 'HR@20': '0.0824', 'NDCG@20': '0.0340'}
2025-02-25 21:23:59,581 - Validation score increased.  Saving model ...
2025-02-25 21:24:40,383 - {'epoch': 42, 'rec_loss': '7.1783'}
2025-02-25 21:24:55,657 - {'Epoch': 42, 'HR@5': '0.0313', 'NDCG@5': '0.0197', 'HR@10': '0.0521', 'NDCG@10': '0.0264', 'HR@20': '0.0824', 'NDCG@20': '0.0341'}
2025-02-25 21:24:55,659 - Validation score increased.  Saving model ...
2025-02-25 21:25:36,536 - {'epoch': 43, 'rec_loss': '7.1847'}
2025-02-25 21:25:51,687 - {'Epoch': 43, 'HR@5': '0.0312', 'NDCG@5': '0.0198', 'HR@10': '0.0513', 'NDCG@10': '0.0262', 'HR@20': '0.0826', 'NDCG@20': '0.0341'}
2025-02-25 21:25:51,689 - Validation score increased.  Saving model ...
2025-02-25 21:26:32,915 - {'epoch': 44, 'rec_loss': '7.1729'}
2025-02-25 21:26:49,956 - {'Epoch': 44, 'HR@5': '0.0315', 'NDCG@5': '0.0206', 'HR@10': '0.0521', 'NDCG@10': '0.0271', 'HR@20': '0.0830', 'NDCG@20': '0.0349'}
2025-02-25 21:26:49,958 - Validation score increased.  Saving model ...
2025-02-25 21:27:32,945 - {'epoch': 45, 'rec_loss': '7.1674'}
2025-02-25 21:27:50,292 - {'Epoch': 45, 'HR@5': '0.0310', 'NDCG@5': '0.0197', 'HR@10': '0.0511', 'NDCG@10': '0.0262', 'HR@20': '0.0803', 'NDCG@20': '0.0335'}
2025-02-25 21:27:50,297 - EarlyStopping counter: 1 out of 10
2025-02-25 21:28:31,188 - {'epoch': 46, 'rec_loss': '7.1633'}
2025-02-25 21:28:48,438 - {'Epoch': 46, 'HR@5': '0.0311', 'NDCG@5': '0.0193', 'HR@10': '0.0506', 'NDCG@10': '0.0256', 'HR@20': '0.0821', 'NDCG@20': '0.0335'}
2025-02-25 21:28:48,439 - EarlyStopping counter: 2 out of 10
2025-02-25 21:29:30,753 - {'epoch': 47, 'rec_loss': '7.1635'}
2025-02-25 21:29:48,241 - {'Epoch': 47, 'HR@5': '0.0314', 'NDCG@5': '0.0199', 'HR@10': '0.0519', 'NDCG@10': '0.0265', 'HR@20': '0.0812', 'NDCG@20': '0.0338'}
2025-02-25 21:29:48,243 - EarlyStopping counter: 3 out of 10
2025-02-25 21:30:29,364 - {'epoch': 48, 'rec_loss': '7.1513'}
2025-02-25 21:30:44,560 - {'Epoch': 48, 'HR@5': '0.0317', 'NDCG@5': '0.0201', 'HR@10': '0.0508', 'NDCG@10': '0.0262', 'HR@20': '0.0816', 'NDCG@20': '0.0340'}
2025-02-25 21:30:44,561 - EarlyStopping counter: 4 out of 10
2025-02-25 21:31:27,384 - {'epoch': 49, 'rec_loss': '7.1543'}
2025-02-25 21:31:44,416 - {'Epoch': 49, 'HR@5': '0.0313', 'NDCG@5': '0.0197', 'HR@10': '0.0509', 'NDCG@10': '0.0261', 'HR@20': '0.0806', 'NDCG@20': '0.0335'}
2025-02-25 21:31:44,418 - EarlyStopping counter: 5 out of 10
2025-02-25 21:32:25,189 - {'epoch': 50, 'rec_loss': '7.1453'}
2025-02-25 21:32:40,513 - {'Epoch': 50, 'HR@5': '0.0314', 'NDCG@5': '0.0199', 'HR@10': '0.0526', 'NDCG@10': '0.0266', 'HR@20': '0.0807', 'NDCG@20': '0.0337'}
2025-02-25 21:32:40,515 - EarlyStopping counter: 6 out of 10
2025-02-25 21:33:22,897 - {'epoch': 51, 'rec_loss': '7.1412'}
2025-02-25 21:33:40,291 - {'Epoch': 51, 'HR@5': '0.0308', 'NDCG@5': '0.0197', 'HR@10': '0.0512', 'NDCG@10': '0.0262', 'HR@20': '0.0817', 'NDCG@20': '0.0339'}
2025-02-25 21:33:40,292 - EarlyStopping counter: 7 out of 10
2025-02-25 21:34:21,107 - {'epoch': 52, 'rec_loss': '7.1397'}
2025-02-25 21:34:39,331 - {'Epoch': 52, 'HR@5': '0.0301', 'NDCG@5': '0.0190', 'HR@10': '0.0501', 'NDCG@10': '0.0254', 'HR@20': '0.0803', 'NDCG@20': '0.0330'}
2025-02-25 21:34:39,333 - EarlyStopping counter: 8 out of 10
2025-02-25 21:35:22,621 - {'epoch': 53, 'rec_loss': '7.1291'}
2025-02-25 21:35:38,972 - {'Epoch': 53, 'HR@5': '0.0304', 'NDCG@5': '0.0193', 'HR@10': '0.0498', 'NDCG@10': '0.0255', 'HR@20': '0.0816', 'NDCG@20': '0.0335'}
2025-02-25 21:35:38,974 - EarlyStopping counter: 9 out of 10
2025-02-25 21:36:22,296 - {'epoch': 54, 'rec_loss': '7.1342'}
2025-02-25 21:36:39,865 - {'Epoch': 54, 'HR@5': '0.0308', 'NDCG@5': '0.0197', 'HR@10': '0.0510', 'NDCG@10': '0.0262', 'HR@20': '0.0809', 'NDCG@20': '0.0337'}
2025-02-25 21:36:39,867 - EarlyStopping counter: 10 out of 10
2025-02-25 21:36:39,867 - Early stopping
2025-02-25 21:36:39,867 - ---------------Test Score---------------
2025-02-25 21:36:57,407 - {'Epoch': 0, 'HR@5': '0.0291', 'NDCG@5': '0.0181', 'HR@10': '0.0478', 'NDCG@10': '0.0241', 'HR@20': '0.0756', 'NDCG@20': '0.0311'}
2025-02-25 21:36:57,409 - Scale_Yelp
2025-02-25 21:36:57,409 - {'Epoch': 0, 'HR@5': '0.0291', 'NDCG@5': '0.0181', 'HR@10': '0.0478', 'NDCG@10': '0.0241', 'HR@20': '0.0756', 'NDCG@20': '0.0311'}
2025-02-25 21:40:59,149 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 5], kernels=[4, 8, 12], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-02-25 21:41:01,933 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-25 21:41:01,939 - Total Parameters: 1435793
2025-02-25 21:41:47,547 - {'epoch': 0, 'rec_loss': '9.5458'}
2025-02-25 21:42:03,928 - {'Epoch': 0, 'HR@5': '0.0094', 'NDCG@5': '0.0059', 'HR@10': '0.0159', 'NDCG@10': '0.0080', 'HR@20': '0.0254', 'NDCG@20': '0.0103'}
2025-02-25 21:42:03,930 - Validation score increased.  Saving model ...
2025-02-25 21:42:48,154 - {'epoch': 1, 'rec_loss': '8.9302'}
2025-02-25 21:43:02,564 - {'Epoch': 1, 'HR@5': '0.0148', 'NDCG@5': '0.0089', 'HR@10': '0.0248', 'NDCG@10': '0.0122', 'HR@20': '0.0406', 'NDCG@20': '0.0162'}
2025-02-25 21:43:02,566 - Validation score increased.  Saving model ...
2025-02-25 21:43:46,580 - {'epoch': 2, 'rec_loss': '8.4955'}
2025-02-25 21:44:03,390 - {'Epoch': 2, 'HR@5': '0.0177', 'NDCG@5': '0.0113', 'HR@10': '0.0318', 'NDCG@10': '0.0158', 'HR@20': '0.0549', 'NDCG@20': '0.0216'}
2025-02-25 21:44:03,392 - Validation score increased.  Saving model ...
2025-02-25 21:44:44,885 - {'epoch': 3, 'rec_loss': '8.2426'}
2025-02-25 21:44:59,189 - {'Epoch': 3, 'HR@5': '0.0212', 'NDCG@5': '0.0134', 'HR@10': '0.0357', 'NDCG@10': '0.0180', 'HR@20': '0.0597', 'NDCG@20': '0.0240'}
2025-02-25 21:44:59,191 - Validation score increased.  Saving model ...
2025-02-25 21:45:41,950 - {'epoch': 4, 'rec_loss': '8.0754'}
2025-02-25 21:45:58,563 - {'Epoch': 4, 'HR@5': '0.0235', 'NDCG@5': '0.0147', 'HR@10': '0.0389', 'NDCG@10': '0.0197', 'HR@20': '0.0641', 'NDCG@20': '0.0260'}
2025-02-25 21:45:58,564 - Validation score increased.  Saving model ...
2025-02-25 21:46:40,110 - {'epoch': 5, 'rec_loss': '7.9552'}
2025-02-25 21:46:57,098 - {'Epoch': 5, 'HR@5': '0.0240', 'NDCG@5': '0.0151', 'HR@10': '0.0419', 'NDCG@10': '0.0208', 'HR@20': '0.0680', 'NDCG@20': '0.0273'}
2025-02-25 21:46:57,100 - Validation score increased.  Saving model ...
2025-02-25 21:47:41,451 - {'epoch': 6, 'rec_loss': '7.8618'}
2025-02-25 21:47:56,528 - {'Epoch': 6, 'HR@5': '0.0261', 'NDCG@5': '0.0165', 'HR@10': '0.0433', 'NDCG@10': '0.0220', 'HR@20': '0.0718', 'NDCG@20': '0.0292'}
2025-02-25 21:47:56,530 - Validation score increased.  Saving model ...
2025-02-25 21:48:38,635 - {'epoch': 7, 'rec_loss': '7.7891'}
2025-02-25 21:48:53,563 - {'Epoch': 7, 'HR@5': '0.0258', 'NDCG@5': '0.0166', 'HR@10': '0.0442', 'NDCG@10': '0.0225', 'HR@20': '0.0730', 'NDCG@20': '0.0298'}
2025-02-25 21:48:53,564 - Validation score increased.  Saving model ...
2025-02-25 21:49:36,711 - {'epoch': 8, 'rec_loss': '7.7308'}
2025-02-25 21:49:52,167 - {'Epoch': 8, 'HR@5': '0.0272', 'NDCG@5': '0.0174', 'HR@10': '0.0457', 'NDCG@10': '0.0233', 'HR@20': '0.0739', 'NDCG@20': '0.0304'}
2025-02-25 21:49:52,168 - Validation score increased.  Saving model ...
2025-02-25 21:50:34,138 - {'epoch': 9, 'rec_loss': '7.6743'}
2025-02-25 21:50:50,757 - {'Epoch': 9, 'HR@5': '0.0281', 'NDCG@5': '0.0177', 'HR@10': '0.0473', 'NDCG@10': '0.0239', 'HR@20': '0.0770', 'NDCG@20': '0.0313'}
2025-02-25 21:50:50,759 - Validation score increased.  Saving model ...
2025-02-25 21:51:34,004 - {'epoch': 10, 'rec_loss': '7.6371'}
2025-02-25 21:51:51,239 - {'Epoch': 10, 'HR@5': '0.0288', 'NDCG@5': '0.0182', 'HR@10': '0.0465', 'NDCG@10': '0.0238', 'HR@20': '0.0759', 'NDCG@20': '0.0312'}
2025-02-25 21:51:51,241 - EarlyStopping counter: 1 out of 10
2025-02-25 21:52:32,764 - {'epoch': 11, 'rec_loss': '7.5963'}
2025-02-25 21:52:47,675 - {'Epoch': 11, 'HR@5': '0.0288', 'NDCG@5': '0.0180', 'HR@10': '0.0478', 'NDCG@10': '0.0241', 'HR@20': '0.0773', 'NDCG@20': '0.0315'}
2025-02-25 21:52:47,677 - Validation score increased.  Saving model ...
2025-02-25 21:53:29,195 - {'epoch': 12, 'rec_loss': '7.5636'}
2025-02-25 21:53:45,417 - {'Epoch': 12, 'HR@5': '0.0281', 'NDCG@5': '0.0176', 'HR@10': '0.0475', 'NDCG@10': '0.0238', 'HR@20': '0.0773', 'NDCG@20': '0.0313'}
2025-02-25 21:53:45,418 - EarlyStopping counter: 1 out of 10
2025-02-25 21:54:27,271 - {'epoch': 13, 'rec_loss': '7.5301'}
2025-02-25 21:54:43,962 - {'Epoch': 13, 'HR@5': '0.0292', 'NDCG@5': '0.0182', 'HR@10': '0.0501', 'NDCG@10': '0.0249', 'HR@20': '0.0811', 'NDCG@20': '0.0327'}
2025-02-25 21:54:43,964 - Validation score increased.  Saving model ...
2025-02-25 21:55:25,667 - {'epoch': 14, 'rec_loss': '7.5017'}
2025-02-25 21:55:42,646 - {'Epoch': 14, 'HR@5': '0.0298', 'NDCG@5': '0.0189', 'HR@10': '0.0514', 'NDCG@10': '0.0258', 'HR@20': '0.0815', 'NDCG@20': '0.0334'}
2025-02-25 21:55:42,648 - Validation score increased.  Saving model ...
2025-02-25 21:56:25,195 - {'epoch': 15, 'rec_loss': '7.4731'}
2025-02-25 21:56:42,550 - {'Epoch': 15, 'HR@5': '0.0312', 'NDCG@5': '0.0198', 'HR@10': '0.0501', 'NDCG@10': '0.0258', 'HR@20': '0.0798', 'NDCG@20': '0.0333'}
2025-02-25 21:56:42,552 - EarlyStopping counter: 1 out of 10
2025-02-25 21:57:26,510 - {'epoch': 16, 'rec_loss': '7.4562'}
2025-02-25 21:57:41,599 - {'Epoch': 16, 'HR@5': '0.0301', 'NDCG@5': '0.0191', 'HR@10': '0.0504', 'NDCG@10': '0.0256', 'HR@20': '0.0813', 'NDCG@20': '0.0333'}
2025-02-25 21:57:41,600 - EarlyStopping counter: 2 out of 10
2025-02-25 21:58:24,968 - {'epoch': 17, 'rec_loss': '7.4308'}
2025-02-25 21:58:40,925 - {'Epoch': 17, 'HR@5': '0.0316', 'NDCG@5': '0.0201', 'HR@10': '0.0512', 'NDCG@10': '0.0263', 'HR@20': '0.0809', 'NDCG@20': '0.0338'}
2025-02-25 21:58:40,927 - Validation score increased.  Saving model ...
2025-02-25 21:59:22,545 - {'epoch': 18, 'rec_loss': '7.4170'}
2025-02-25 21:59:37,629 - {'Epoch': 18, 'HR@5': '0.0297', 'NDCG@5': '0.0187', 'HR@10': '0.0501', 'NDCG@10': '0.0253', 'HR@20': '0.0824', 'NDCG@20': '0.0334'}
2025-02-25 21:59:37,630 - EarlyStopping counter: 1 out of 10
2025-02-25 22:00:21,622 - {'epoch': 19, 'rec_loss': '7.3976'}
2025-02-25 22:00:38,785 - {'Epoch': 19, 'HR@5': '0.0297', 'NDCG@5': '0.0189', 'HR@10': '0.0505', 'NDCG@10': '0.0256', 'HR@20': '0.0808', 'NDCG@20': '0.0332'}
2025-02-25 22:00:38,787 - EarlyStopping counter: 2 out of 10
2025-02-25 22:01:22,237 - {'epoch': 20, 'rec_loss': '7.3798'}
2025-02-25 22:01:37,487 - {'Epoch': 20, 'HR@5': '0.0303', 'NDCG@5': '0.0191', 'HR@10': '0.0503', 'NDCG@10': '0.0255', 'HR@20': '0.0814', 'NDCG@20': '0.0333'}
2025-02-25 22:01:37,489 - EarlyStopping counter: 3 out of 10
2025-02-25 22:02:21,617 - {'epoch': 21, 'rec_loss': '7.3636'}
2025-02-25 22:02:38,952 - {'Epoch': 21, 'HR@5': '0.0308', 'NDCG@5': '0.0192', 'HR@10': '0.0509', 'NDCG@10': '0.0257', 'HR@20': '0.0818', 'NDCG@20': '0.0335'}
2025-02-25 22:02:38,953 - EarlyStopping counter: 4 out of 10
2025-02-25 22:03:20,568 - {'epoch': 22, 'rec_loss': '7.3454'}
2025-02-25 22:03:37,503 - {'Epoch': 22, 'HR@5': '0.0300', 'NDCG@5': '0.0190', 'HR@10': '0.0515', 'NDCG@10': '0.0259', 'HR@20': '0.0821', 'NDCG@20': '0.0336'}
2025-02-25 22:03:37,504 - EarlyStopping counter: 5 out of 10
2025-02-25 22:04:18,917 - {'epoch': 23, 'rec_loss': '7.3362'}
2025-02-25 22:04:37,075 - {'Epoch': 23, 'HR@5': '0.0305', 'NDCG@5': '0.0197', 'HR@10': '0.0510', 'NDCG@10': '0.0263', 'HR@20': '0.0816', 'NDCG@20': '0.0339'}
2025-02-25 22:04:37,077 - Validation score increased.  Saving model ...
2025-02-25 22:05:18,524 - {'epoch': 24, 'rec_loss': '7.3242'}
2025-02-25 22:05:36,068 - {'Epoch': 24, 'HR@5': '0.0307', 'NDCG@5': '0.0198', 'HR@10': '0.0525', 'NDCG@10': '0.0268', 'HR@20': '0.0847', 'NDCG@20': '0.0348'}
2025-02-25 22:05:36,070 - Validation score increased.  Saving model ...
2025-02-25 22:06:17,462 - {'epoch': 25, 'rec_loss': '7.3152'}
2025-02-25 22:06:32,735 - {'Epoch': 25, 'HR@5': '0.0306', 'NDCG@5': '0.0194', 'HR@10': '0.0515', 'NDCG@10': '0.0261', 'HR@20': '0.0828', 'NDCG@20': '0.0340'}
2025-02-25 22:06:32,737 - EarlyStopping counter: 1 out of 10
2025-02-25 22:07:18,304 - {'epoch': 26, 'rec_loss': '7.2973'}
2025-02-25 22:07:35,886 - {'Epoch': 26, 'HR@5': '0.0307', 'NDCG@5': '0.0192', 'HR@10': '0.0525', 'NDCG@10': '0.0262', 'HR@20': '0.0837', 'NDCG@20': '0.0341'}
2025-02-25 22:07:35,887 - EarlyStopping counter: 2 out of 10
2025-02-25 22:08:17,989 - {'epoch': 27, 'rec_loss': '7.2939'}
2025-02-25 22:08:33,174 - {'Epoch': 27, 'HR@5': '0.0307', 'NDCG@5': '0.0196', 'HR@10': '0.0514', 'NDCG@10': '0.0262', 'HR@20': '0.0824', 'NDCG@20': '0.0340'}
2025-02-25 22:08:33,175 - EarlyStopping counter: 3 out of 10
2025-02-25 22:09:14,950 - {'epoch': 28, 'rec_loss': '7.2784'}
2025-02-25 22:09:31,715 - {'Epoch': 28, 'HR@5': '0.0308', 'NDCG@5': '0.0192', 'HR@10': '0.0511', 'NDCG@10': '0.0257', 'HR@20': '0.0824', 'NDCG@20': '0.0335'}
2025-02-25 22:09:31,716 - EarlyStopping counter: 4 out of 10
2025-02-25 22:10:13,159 - {'epoch': 29, 'rec_loss': '7.2754'}
2025-02-25 22:10:30,327 - {'Epoch': 29, 'HR@5': '0.0308', 'NDCG@5': '0.0196', 'HR@10': '0.0503', 'NDCG@10': '0.0258', 'HR@20': '0.0811', 'NDCG@20': '0.0335'}
2025-02-25 22:10:30,329 - EarlyStopping counter: 5 out of 10
2025-02-25 22:11:11,770 - {'epoch': 30, 'rec_loss': '7.2591'}
2025-02-25 22:11:29,391 - {'Epoch': 30, 'HR@5': '0.0300', 'NDCG@5': '0.0191', 'HR@10': '0.0499', 'NDCG@10': '0.0255', 'HR@20': '0.0799', 'NDCG@20': '0.0330'}
2025-02-25 22:11:29,393 - EarlyStopping counter: 6 out of 10
2025-02-25 22:12:10,869 - {'epoch': 31, 'rec_loss': '7.2552'}
2025-02-25 22:12:28,385 - {'Epoch': 31, 'HR@5': '0.0308', 'NDCG@5': '0.0195', 'HR@10': '0.0507', 'NDCG@10': '0.0259', 'HR@20': '0.0816', 'NDCG@20': '0.0337'}
2025-02-25 22:12:28,387 - EarlyStopping counter: 7 out of 10
2025-02-25 22:13:09,835 - {'epoch': 32, 'rec_loss': '7.2493'}
2025-02-25 22:13:27,344 - {'Epoch': 32, 'HR@5': '0.0307', 'NDCG@5': '0.0193', 'HR@10': '0.0521', 'NDCG@10': '0.0261', 'HR@20': '0.0811', 'NDCG@20': '0.0334'}
2025-02-25 22:13:27,345 - EarlyStopping counter: 8 out of 10
2025-02-25 22:14:09,924 - {'epoch': 33, 'rec_loss': '7.2443'}
2025-02-25 22:14:25,117 - {'Epoch': 33, 'HR@5': '0.0313', 'NDCG@5': '0.0197', 'HR@10': '0.0514', 'NDCG@10': '0.0262', 'HR@20': '0.0811', 'NDCG@20': '0.0336'}
2025-02-25 22:14:25,119 - EarlyStopping counter: 9 out of 10
2025-02-25 22:15:06,593 - {'epoch': 34, 'rec_loss': '7.2276'}
2025-02-25 22:15:21,821 - {'Epoch': 34, 'HR@5': '0.0311', 'NDCG@5': '0.0197', 'HR@10': '0.0512', 'NDCG@10': '0.0261', 'HR@20': '0.0820', 'NDCG@20': '0.0339'}
2025-02-25 22:15:21,823 - EarlyStopping counter: 10 out of 10
2025-02-25 22:15:21,823 - Early stopping
2025-02-25 22:15:21,823 - ---------------Test Score---------------
2025-02-25 22:15:37,008 - {'Epoch': 0, 'HR@5': '0.0280', 'NDCG@5': '0.0177', 'HR@10': '0.0465', 'NDCG@10': '0.0236', 'HR@20': '0.0745', 'NDCG@20': '0.0307'}
2025-02-25 22:15:37,010 - Scale_Yelp
2025-02-25 22:15:37,010 - {'Epoch': 0, 'HR@5': '0.0280', 'NDCG@5': '0.0177', 'HR@10': '0.0465', 'NDCG@10': '0.0236', 'HR@20': '0.0745', 'NDCG@20': '0.0307'}
2025-02-25 22:22:20,955 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[10, 5], kernels=[4, 8, 12], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-02-25 22:22:23,724 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-25 22:22:23,730 - Total Parameters: 1435793
2025-02-25 22:23:08,540 - {'epoch': 0, 'rec_loss': '9.5437'}
2025-02-25 22:23:24,239 - {'Epoch': 0, 'HR@5': '0.0086', 'NDCG@5': '0.0050', 'HR@10': '0.0151', 'NDCG@10': '0.0071', 'HR@20': '0.0262', 'NDCG@20': '0.0099'}
2025-02-25 22:23:24,240 - Validation score increased.  Saving model ...
2025-02-25 22:24:09,663 - {'epoch': 1, 'rec_loss': '8.9357'}
2025-02-25 22:24:24,729 - {'Epoch': 1, 'HR@5': '0.0148', 'NDCG@5': '0.0093', 'HR@10': '0.0262', 'NDCG@10': '0.0130', 'HR@20': '0.0437', 'NDCG@20': '0.0173'}
2025-02-25 22:24:24,733 - Validation score increased.  Saving model ...
2025-02-25 22:25:10,137 - {'epoch': 2, 'rec_loss': '8.4886'}
2025-02-25 22:25:24,934 - {'Epoch': 2, 'HR@5': '0.0176', 'NDCG@5': '0.0109', 'HR@10': '0.0315', 'NDCG@10': '0.0154', 'HR@20': '0.0540', 'NDCG@20': '0.0210'}
2025-02-25 22:25:24,935 - Validation score increased.  Saving model ...
2025-02-25 22:26:10,807 - {'epoch': 3, 'rec_loss': '8.2392'}
2025-02-25 22:26:25,558 - {'Epoch': 3, 'HR@5': '0.0200', 'NDCG@5': '0.0128', 'HR@10': '0.0351', 'NDCG@10': '0.0176', 'HR@20': '0.0596', 'NDCG@20': '0.0237'}
2025-02-25 22:26:25,562 - Validation score increased.  Saving model ...
2025-02-25 22:27:12,241 - {'epoch': 4, 'rec_loss': '8.0726'}
2025-02-25 22:27:27,396 - {'Epoch': 4, 'HR@5': '0.0230', 'NDCG@5': '0.0145', 'HR@10': '0.0407', 'NDCG@10': '0.0201', 'HR@20': '0.0668', 'NDCG@20': '0.0266'}
2025-02-25 22:27:27,400 - Validation score increased.  Saving model ...
2025-02-25 22:28:14,014 - {'epoch': 5, 'rec_loss': '7.9537'}
2025-02-25 22:28:28,775 - {'Epoch': 5, 'HR@5': '0.0253', 'NDCG@5': '0.0161', 'HR@10': '0.0428', 'NDCG@10': '0.0217', 'HR@20': '0.0681', 'NDCG@20': '0.0281'}
2025-02-25 22:28:28,778 - Validation score increased.  Saving model ...
2025-02-25 22:29:13,902 - {'epoch': 6, 'rec_loss': '7.8581'}
2025-02-25 22:29:28,863 - {'Epoch': 6, 'HR@5': '0.0249', 'NDCG@5': '0.0156', 'HR@10': '0.0433', 'NDCG@10': '0.0215', 'HR@20': '0.0719', 'NDCG@20': '0.0287'}
2025-02-25 22:29:28,867 - Validation score increased.  Saving model ...
2025-02-25 22:30:14,769 - {'epoch': 7, 'rec_loss': '7.7901'}
2025-02-25 22:30:29,812 - {'Epoch': 7, 'HR@5': '0.0254', 'NDCG@5': '0.0159', 'HR@10': '0.0432', 'NDCG@10': '0.0216', 'HR@20': '0.0728', 'NDCG@20': '0.0290'}
2025-02-25 22:30:29,813 - Validation score increased.  Saving model ...
2025-02-25 22:31:15,100 - {'epoch': 8, 'rec_loss': '7.7251'}
2025-02-25 22:31:30,236 - {'Epoch': 8, 'HR@5': '0.0268', 'NDCG@5': '0.0168', 'HR@10': '0.0463', 'NDCG@10': '0.0231', 'HR@20': '0.0766', 'NDCG@20': '0.0307'}
2025-02-25 22:31:30,237 - Validation score increased.  Saving model ...
2025-02-25 22:32:15,371 - {'epoch': 9, 'rec_loss': '7.6754'}
2025-02-25 22:32:30,400 - {'Epoch': 9, 'HR@5': '0.0280', 'NDCG@5': '0.0177', 'HR@10': '0.0473', 'NDCG@10': '0.0239', 'HR@20': '0.0765', 'NDCG@20': '0.0312'}
2025-02-25 22:32:30,402 - Validation score increased.  Saving model ...
2025-02-25 22:33:16,774 - {'epoch': 10, 'rec_loss': '7.6329'}
2025-02-25 22:33:31,641 - {'Epoch': 10, 'HR@5': '0.0279', 'NDCG@5': '0.0174', 'HR@10': '0.0472', 'NDCG@10': '0.0236', 'HR@20': '0.0772', 'NDCG@20': '0.0311'}
2025-02-25 22:33:31,645 - EarlyStopping counter: 1 out of 10
2025-02-25 22:34:21,421 - {'epoch': 11, 'rec_loss': '7.5948'}
2025-02-25 22:34:36,644 - {'Epoch': 11, 'HR@5': '0.0276', 'NDCG@5': '0.0176', 'HR@10': '0.0474', 'NDCG@10': '0.0239', 'HR@20': '0.0787', 'NDCG@20': '0.0318'}
2025-02-25 22:34:36,648 - Validation score increased.  Saving model ...
2025-02-25 22:35:22,463 - {'epoch': 12, 'rec_loss': '7.5666'}
2025-02-25 22:35:37,646 - {'Epoch': 12, 'HR@5': '0.0286', 'NDCG@5': '0.0177', 'HR@10': '0.0484', 'NDCG@10': '0.0240', 'HR@20': '0.0777', 'NDCG@20': '0.0314'}
2025-02-25 22:35:37,648 - EarlyStopping counter: 1 out of 10
2025-02-25 22:36:28,538 - {'epoch': 13, 'rec_loss': '7.5319'}
2025-02-25 22:36:44,564 - {'Epoch': 13, 'HR@5': '0.0287', 'NDCG@5': '0.0183', 'HR@10': '0.0490', 'NDCG@10': '0.0247', 'HR@20': '0.0788', 'NDCG@20': '0.0322'}
2025-02-25 22:36:44,565 - Validation score increased.  Saving model ...
2025-02-25 22:37:30,793 - {'epoch': 14, 'rec_loss': '7.5037'}
2025-02-25 22:37:46,103 - {'Epoch': 14, 'HR@5': '0.0290', 'NDCG@5': '0.0182', 'HR@10': '0.0497', 'NDCG@10': '0.0249', 'HR@20': '0.0797', 'NDCG@20': '0.0324'}
2025-02-25 22:37:46,104 - Validation score increased.  Saving model ...
2025-02-25 22:38:30,856 - {'epoch': 15, 'rec_loss': '7.4856'}
2025-02-25 22:38:45,967 - {'Epoch': 15, 'HR@5': '0.0293', 'NDCG@5': '0.0186', 'HR@10': '0.0495', 'NDCG@10': '0.0252', 'HR@20': '0.0795', 'NDCG@20': '0.0327'}
2025-02-25 22:38:45,969 - Validation score increased.  Saving model ...
2025-02-25 22:39:35,484 - {'epoch': 16, 'rec_loss': '7.4563'}
2025-02-25 22:39:50,689 - {'Epoch': 16, 'HR@5': '0.0297', 'NDCG@5': '0.0189', 'HR@10': '0.0504', 'NDCG@10': '0.0255', 'HR@20': '0.0808', 'NDCG@20': '0.0331'}
2025-02-25 22:39:50,692 - Validation score increased.  Saving model ...
2025-02-25 22:40:36,531 - {'epoch': 17, 'rec_loss': '7.4345'}
2025-02-25 22:40:51,568 - {'Epoch': 17, 'HR@5': '0.0312', 'NDCG@5': '0.0196', 'HR@10': '0.0511', 'NDCG@10': '0.0260', 'HR@20': '0.0804', 'NDCG@20': '0.0334'}
2025-02-25 22:40:51,572 - Validation score increased.  Saving model ...
2025-02-25 22:41:36,520 - {'epoch': 18, 'rec_loss': '7.4169'}
2025-02-25 22:41:51,568 - {'Epoch': 18, 'HR@5': '0.0302', 'NDCG@5': '0.0192', 'HR@10': '0.0514', 'NDCG@10': '0.0260', 'HR@20': '0.0831', 'NDCG@20': '0.0339'}
2025-02-25 22:41:51,570 - Validation score increased.  Saving model ...
2025-02-25 22:42:36,980 - {'epoch': 19, 'rec_loss': '7.3973'}
2025-02-25 22:42:51,920 - {'Epoch': 19, 'HR@5': '0.0310', 'NDCG@5': '0.0196', 'HR@10': '0.0511', 'NDCG@10': '0.0260', 'HR@20': '0.0802', 'NDCG@20': '0.0334'}
2025-02-25 22:42:51,922 - EarlyStopping counter: 1 out of 10
2025-02-25 22:43:35,272 - {'epoch': 20, 'rec_loss': '7.3809'}
2025-02-25 22:43:50,466 - {'Epoch': 20, 'HR@5': '0.0310', 'NDCG@5': '0.0193', 'HR@10': '0.0511', 'NDCG@10': '0.0257', 'HR@20': '0.0814', 'NDCG@20': '0.0334'}
2025-02-25 22:43:50,468 - EarlyStopping counter: 2 out of 10
2025-02-25 22:44:36,374 - {'epoch': 21, 'rec_loss': '7.3621'}
2025-02-25 22:44:51,607 - {'Epoch': 21, 'HR@5': '0.0307', 'NDCG@5': '0.0194', 'HR@10': '0.0517', 'NDCG@10': '0.0261', 'HR@20': '0.0810', 'NDCG@20': '0.0334'}
2025-02-25 22:44:51,611 - EarlyStopping counter: 3 out of 10
2025-02-25 22:45:36,176 - {'epoch': 22, 'rec_loss': '7.3521'}
2025-02-25 22:45:51,163 - {'Epoch': 22, 'HR@5': '0.0320', 'NDCG@5': '0.0201', 'HR@10': '0.0513', 'NDCG@10': '0.0264', 'HR@20': '0.0814', 'NDCG@20': '0.0339'}
2025-02-25 22:45:51,164 - EarlyStopping counter: 4 out of 10
2025-02-25 22:46:37,113 - {'epoch': 23, 'rec_loss': '7.3368'}
2025-02-25 22:46:52,293 - {'Epoch': 23, 'HR@5': '0.0305', 'NDCG@5': '0.0192', 'HR@10': '0.0510', 'NDCG@10': '0.0258', 'HR@20': '0.0808', 'NDCG@20': '0.0333'}
2025-02-25 22:46:52,296 - EarlyStopping counter: 5 out of 10
2025-02-25 22:47:36,957 - {'epoch': 24, 'rec_loss': '7.3251'}
2025-02-25 22:47:51,896 - {'Epoch': 24, 'HR@5': '0.0322', 'NDCG@5': '0.0205', 'HR@10': '0.0518', 'NDCG@10': '0.0268', 'HR@20': '0.0808', 'NDCG@20': '0.0341'}
2025-02-25 22:47:51,900 - Validation score increased.  Saving model ...
2025-02-25 22:48:37,640 - {'epoch': 25, 'rec_loss': '7.3125'}
2025-02-25 22:48:52,484 - {'Epoch': 25, 'HR@5': '0.0320', 'NDCG@5': '0.0199', 'HR@10': '0.0507', 'NDCG@10': '0.0260', 'HR@20': '0.0819', 'NDCG@20': '0.0338'}
2025-02-25 22:48:52,485 - EarlyStopping counter: 1 out of 10
2025-02-25 22:49:37,517 - {'epoch': 26, 'rec_loss': '7.3012'}
2025-02-25 22:49:52,922 - {'Epoch': 26, 'HR@5': '0.0304', 'NDCG@5': '0.0192', 'HR@10': '0.0497', 'NDCG@10': '0.0254', 'HR@20': '0.0820', 'NDCG@20': '0.0335'}
2025-02-25 22:49:52,924 - EarlyStopping counter: 2 out of 10
2025-02-25 22:50:38,190 - {'epoch': 27, 'rec_loss': '7.2904'}
2025-02-25 22:50:53,634 - {'Epoch': 27, 'HR@5': '0.0308', 'NDCG@5': '0.0197', 'HR@10': '0.0521', 'NDCG@10': '0.0265', 'HR@20': '0.0818', 'NDCG@20': '0.0340'}
2025-02-25 22:50:53,635 - EarlyStopping counter: 3 out of 10
2025-02-25 22:51:38,652 - {'epoch': 28, 'rec_loss': '7.2818'}
2025-02-25 22:51:54,124 - {'Epoch': 28, 'HR@5': '0.0317', 'NDCG@5': '0.0198', 'HR@10': '0.0518', 'NDCG@10': '0.0262', 'HR@20': '0.0818', 'NDCG@20': '0.0338'}
2025-02-25 22:51:54,126 - EarlyStopping counter: 4 out of 10
2025-02-25 22:52:39,591 - {'epoch': 29, 'rec_loss': '7.2764'}
2025-02-25 22:52:54,749 - {'Epoch': 29, 'HR@5': '0.0323', 'NDCG@5': '0.0208', 'HR@10': '0.0518', 'NDCG@10': '0.0271', 'HR@20': '0.0819', 'NDCG@20': '0.0346'}
2025-02-25 22:52:54,753 - Validation score increased.  Saving model ...
2025-02-25 22:53:40,947 - {'epoch': 30, 'rec_loss': '7.2603'}
2025-02-25 22:53:56,200 - {'Epoch': 30, 'HR@5': '0.0314', 'NDCG@5': '0.0198', 'HR@10': '0.0521', 'NDCG@10': '0.0264', 'HR@20': '0.0810', 'NDCG@20': '0.0337'}
2025-02-25 22:53:56,202 - EarlyStopping counter: 1 out of 10
2025-02-25 22:54:45,644 - {'epoch': 31, 'rec_loss': '7.2529'}
2025-02-25 22:55:01,345 - {'Epoch': 31, 'HR@5': '0.0312', 'NDCG@5': '0.0194', 'HR@10': '0.0506', 'NDCG@10': '0.0257', 'HR@20': '0.0801', 'NDCG@20': '0.0331'}
2025-02-25 22:55:01,347 - EarlyStopping counter: 2 out of 10
2025-02-25 22:55:50,368 - {'epoch': 32, 'rec_loss': '7.2482'}
2025-02-25 22:56:05,721 - {'Epoch': 32, 'HR@5': '0.0309', 'NDCG@5': '0.0195', 'HR@10': '0.0508', 'NDCG@10': '0.0259', 'HR@20': '0.0810', 'NDCG@20': '0.0335'}
2025-02-25 22:56:05,725 - EarlyStopping counter: 3 out of 10
2025-02-25 22:56:51,076 - {'epoch': 33, 'rec_loss': '7.2372'}
2025-02-25 22:57:07,866 - {'Epoch': 33, 'HR@5': '0.0311', 'NDCG@5': '0.0198', 'HR@10': '0.0506', 'NDCG@10': '0.0261', 'HR@20': '0.0800', 'NDCG@20': '0.0334'}
2025-02-25 22:57:07,867 - EarlyStopping counter: 4 out of 10
2025-02-25 22:57:53,000 - {'epoch': 34, 'rec_loss': '7.2318'}
2025-02-25 22:58:08,371 - {'Epoch': 34, 'HR@5': '0.0307', 'NDCG@5': '0.0197', 'HR@10': '0.0509', 'NDCG@10': '0.0261', 'HR@20': '0.0818', 'NDCG@20': '0.0339'}
2025-02-25 22:58:08,372 - EarlyStopping counter: 5 out of 10
2025-02-25 22:58:54,550 - {'epoch': 35, 'rec_loss': '7.2253'}
2025-02-25 22:59:11,783 - {'Epoch': 35, 'HR@5': '0.0313', 'NDCG@5': '0.0199', 'HR@10': '0.0507', 'NDCG@10': '0.0261', 'HR@20': '0.0810', 'NDCG@20': '0.0337'}
2025-02-25 22:59:11,787 - EarlyStopping counter: 6 out of 10
2025-02-25 22:59:59,910 - {'epoch': 36, 'rec_loss': '7.2183'}
2025-02-25 23:00:16,295 - {'Epoch': 36, 'HR@5': '0.0300', 'NDCG@5': '0.0193', 'HR@10': '0.0508', 'NDCG@10': '0.0259', 'HR@20': '0.0809', 'NDCG@20': '0.0335'}
2025-02-25 23:00:16,298 - EarlyStopping counter: 7 out of 10
2025-02-25 23:01:02,588 - {'epoch': 37, 'rec_loss': '7.2080'}
2025-02-25 23:01:17,811 - {'Epoch': 37, 'HR@5': '0.0309', 'NDCG@5': '0.0195', 'HR@10': '0.0511', 'NDCG@10': '0.0260', 'HR@20': '0.0810', 'NDCG@20': '0.0335'}
2025-02-25 23:01:17,813 - EarlyStopping counter: 8 out of 10
2025-02-25 23:02:03,064 - {'epoch': 38, 'rec_loss': '7.2024'}
2025-02-25 23:02:18,484 - {'Epoch': 38, 'HR@5': '0.0307', 'NDCG@5': '0.0197', 'HR@10': '0.0499', 'NDCG@10': '0.0258', 'HR@20': '0.0799', 'NDCG@20': '0.0333'}
2025-02-25 23:02:18,488 - EarlyStopping counter: 9 out of 10
2025-02-25 23:03:03,872 - {'epoch': 39, 'rec_loss': '7.2006'}
2025-02-25 23:03:19,014 - {'Epoch': 39, 'HR@5': '0.0316', 'NDCG@5': '0.0202', 'HR@10': '0.0506', 'NDCG@10': '0.0263', 'HR@20': '0.0808', 'NDCG@20': '0.0338'}
2025-02-25 23:03:19,016 - EarlyStopping counter: 10 out of 10
2025-02-25 23:03:19,016 - Early stopping
2025-02-25 23:03:19,016 - ---------------Test Score---------------
2025-02-25 23:03:34,284 - {'Epoch': 0, 'HR@5': '0.0284', 'NDCG@5': '0.0178', 'HR@10': '0.0475', 'NDCG@10': '0.0240', 'HR@20': '0.0759', 'NDCG@20': '0.0311'}
2025-02-25 23:03:34,286 - Scale_Yelp
2025-02-25 23:03:34,286 - {'Epoch': 0, 'HR@5': '0.0284', 'NDCG@5': '0.0178', 'HR@10': '0.0475', 'NDCG@10': '0.0240', 'HR@20': '0.0759', 'NDCG@20': '0.0311'}
2025-02-27 22:45:27,247 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 5], kernels=[4, 8, 12], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-02-27 22:45:30,097 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-27 22:45:30,104 - Total Parameters: 1435793
2025-02-27 22:46:14,498 - {'epoch': 0, 'rec_loss': '9.5458'}
2025-02-27 22:46:30,504 - {'Epoch': 0, 'HR@5': '0.0094', 'NDCG@5': '0.0059', 'HR@10': '0.0159', 'NDCG@10': '0.0080', 'HR@20': '0.0254', 'NDCG@20': '0.0103'}
2025-02-27 22:46:30,509 - Validation score increased.  Saving model ...
2025-02-27 22:47:15,925 - {'epoch': 1, 'rec_loss': '8.9302'}
2025-02-27 22:47:30,037 - {'Epoch': 1, 'HR@5': '0.0148', 'NDCG@5': '0.0089', 'HR@10': '0.0248', 'NDCG@10': '0.0122', 'HR@20': '0.0406', 'NDCG@20': '0.0162'}
2025-02-27 22:47:30,042 - Validation score increased.  Saving model ...
2025-02-27 22:48:15,337 - {'epoch': 2, 'rec_loss': '8.4955'}
2025-02-27 22:48:30,239 - {'Epoch': 2, 'HR@5': '0.0177', 'NDCG@5': '0.0113', 'HR@10': '0.0318', 'NDCG@10': '0.0158', 'HR@20': '0.0549', 'NDCG@20': '0.0216'}
2025-02-27 22:48:30,245 - Validation score increased.  Saving model ...
2025-02-27 22:49:15,580 - {'epoch': 3, 'rec_loss': '8.2426'}
2025-02-27 22:49:30,295 - {'Epoch': 3, 'HR@5': '0.0212', 'NDCG@5': '0.0134', 'HR@10': '0.0357', 'NDCG@10': '0.0180', 'HR@20': '0.0597', 'NDCG@20': '0.0240'}
2025-02-27 22:49:30,297 - Validation score increased.  Saving model ...
2025-02-27 22:50:16,942 - {'epoch': 4, 'rec_loss': '8.0754'}
2025-02-27 22:50:32,057 - {'Epoch': 4, 'HR@5': '0.0235', 'NDCG@5': '0.0147', 'HR@10': '0.0389', 'NDCG@10': '0.0197', 'HR@20': '0.0641', 'NDCG@20': '0.0260'}
2025-02-27 22:50:32,059 - Validation score increased.  Saving model ...
2025-02-27 22:51:21,577 - {'epoch': 5, 'rec_loss': '7.9552'}
2025-02-27 22:51:36,577 - {'Epoch': 5, 'HR@5': '0.0240', 'NDCG@5': '0.0151', 'HR@10': '0.0419', 'NDCG@10': '0.0208', 'HR@20': '0.0680', 'NDCG@20': '0.0273'}
2025-02-27 22:51:36,582 - Validation score increased.  Saving model ...
2025-02-27 22:52:22,002 - {'epoch': 6, 'rec_loss': '7.8618'}
2025-02-27 22:52:36,744 - {'Epoch': 6, 'HR@5': '0.0261', 'NDCG@5': '0.0165', 'HR@10': '0.0433', 'NDCG@10': '0.0220', 'HR@20': '0.0718', 'NDCG@20': '0.0292'}
2025-02-27 22:52:36,747 - Validation score increased.  Saving model ...
2025-02-27 22:53:23,758 - {'epoch': 7, 'rec_loss': '7.7891'}
2025-02-27 22:53:38,670 - {'Epoch': 7, 'HR@5': '0.0258', 'NDCG@5': '0.0166', 'HR@10': '0.0442', 'NDCG@10': '0.0225', 'HR@20': '0.0730', 'NDCG@20': '0.0298'}
2025-02-27 22:53:38,674 - Validation score increased.  Saving model ...
2025-02-27 22:54:26,690 - {'epoch': 8, 'rec_loss': '7.7308'}
2025-02-27 22:54:41,734 - {'Epoch': 8, 'HR@5': '0.0272', 'NDCG@5': '0.0174', 'HR@10': '0.0457', 'NDCG@10': '0.0233', 'HR@20': '0.0739', 'NDCG@20': '0.0304'}
2025-02-27 22:54:41,738 - Validation score increased.  Saving model ...
2025-02-27 22:55:29,615 - {'epoch': 9, 'rec_loss': '7.6743'}
2025-02-27 22:55:44,794 - {'Epoch': 9, 'HR@5': '0.0281', 'NDCG@5': '0.0177', 'HR@10': '0.0473', 'NDCG@10': '0.0239', 'HR@20': '0.0770', 'NDCG@20': '0.0313'}
2025-02-27 22:55:44,795 - Validation score increased.  Saving model ...
2025-02-27 22:56:29,663 - {'epoch': 10, 'rec_loss': '7.6371'}
2025-02-27 22:56:44,843 - {'Epoch': 10, 'HR@5': '0.0288', 'NDCG@5': '0.0182', 'HR@10': '0.0465', 'NDCG@10': '0.0238', 'HR@20': '0.0759', 'NDCG@20': '0.0312'}
2025-02-27 22:56:44,849 - EarlyStopping counter: 1 out of 10
2025-02-27 22:57:32,989 - {'epoch': 11, 'rec_loss': '7.5963'}
2025-02-27 22:57:48,410 - {'Epoch': 11, 'HR@5': '0.0288', 'NDCG@5': '0.0180', 'HR@10': '0.0478', 'NDCG@10': '0.0241', 'HR@20': '0.0773', 'NDCG@20': '0.0315'}
2025-02-27 22:57:48,414 - Validation score increased.  Saving model ...
2025-02-27 22:58:35,404 - {'epoch': 12, 'rec_loss': '7.5636'}
2025-02-27 22:58:50,459 - {'Epoch': 12, 'HR@5': '0.0281', 'NDCG@5': '0.0176', 'HR@10': '0.0475', 'NDCG@10': '0.0238', 'HR@20': '0.0773', 'NDCG@20': '0.0313'}
2025-02-27 22:58:50,463 - EarlyStopping counter: 1 out of 10
2025-02-27 22:59:36,677 - {'epoch': 13, 'rec_loss': '7.5301'}
2025-02-27 22:59:51,864 - {'Epoch': 13, 'HR@5': '0.0292', 'NDCG@5': '0.0182', 'HR@10': '0.0501', 'NDCG@10': '0.0249', 'HR@20': '0.0811', 'NDCG@20': '0.0327'}
2025-02-27 22:59:51,865 - Validation score increased.  Saving model ...
2025-02-27 23:00:37,310 - {'epoch': 14, 'rec_loss': '7.5017'}
2025-02-27 23:00:52,468 - {'Epoch': 14, 'HR@5': '0.0298', 'NDCG@5': '0.0189', 'HR@10': '0.0514', 'NDCG@10': '0.0258', 'HR@20': '0.0815', 'NDCG@20': '0.0334'}
2025-02-27 23:00:52,473 - Validation score increased.  Saving model ...
2025-02-27 23:01:37,380 - {'epoch': 15, 'rec_loss': '7.4731'}
2025-02-27 23:01:52,446 - {'Epoch': 15, 'HR@5': '0.0312', 'NDCG@5': '0.0198', 'HR@10': '0.0501', 'NDCG@10': '0.0258', 'HR@20': '0.0798', 'NDCG@20': '0.0333'}
2025-02-27 23:01:52,450 - EarlyStopping counter: 1 out of 10
2025-02-27 23:02:37,952 - {'epoch': 16, 'rec_loss': '7.4562'}
2025-02-27 23:02:53,791 - {'Epoch': 16, 'HR@5': '0.0301', 'NDCG@5': '0.0191', 'HR@10': '0.0504', 'NDCG@10': '0.0256', 'HR@20': '0.0813', 'NDCG@20': '0.0333'}
2025-02-27 23:02:53,795 - EarlyStopping counter: 2 out of 10
2025-02-27 23:03:38,798 - {'epoch': 17, 'rec_loss': '7.4308'}
2025-02-27 23:03:53,883 - {'Epoch': 17, 'HR@5': '0.0316', 'NDCG@5': '0.0201', 'HR@10': '0.0512', 'NDCG@10': '0.0263', 'HR@20': '0.0809', 'NDCG@20': '0.0338'}
2025-02-27 23:03:53,886 - Validation score increased.  Saving model ...
2025-02-27 23:04:38,659 - {'epoch': 18, 'rec_loss': '7.4170'}
2025-02-27 23:04:53,969 - {'Epoch': 18, 'HR@5': '0.0297', 'NDCG@5': '0.0187', 'HR@10': '0.0501', 'NDCG@10': '0.0253', 'HR@20': '0.0824', 'NDCG@20': '0.0334'}
2025-02-27 23:04:53,975 - EarlyStopping counter: 1 out of 10
2025-02-27 23:05:39,747 - {'epoch': 19, 'rec_loss': '7.3976'}
2025-02-27 23:05:54,688 - {'Epoch': 19, 'HR@5': '0.0297', 'NDCG@5': '0.0189', 'HR@10': '0.0505', 'NDCG@10': '0.0256', 'HR@20': '0.0808', 'NDCG@20': '0.0332'}
2025-02-27 23:05:54,692 - EarlyStopping counter: 2 out of 10
2025-02-27 23:06:39,303 - {'epoch': 20, 'rec_loss': '7.3798'}
2025-02-27 23:06:54,582 - {'Epoch': 20, 'HR@5': '0.0303', 'NDCG@5': '0.0191', 'HR@10': '0.0503', 'NDCG@10': '0.0255', 'HR@20': '0.0814', 'NDCG@20': '0.0333'}
2025-02-27 23:06:54,583 - EarlyStopping counter: 3 out of 10
2025-02-27 23:07:41,890 - {'epoch': 21, 'rec_loss': '7.3636'}
2025-02-27 23:08:01,198 - {'Epoch': 21, 'HR@5': '0.0308', 'NDCG@5': '0.0192', 'HR@10': '0.0509', 'NDCG@10': '0.0257', 'HR@20': '0.0818', 'NDCG@20': '0.0335'}
2025-02-27 23:08:01,203 - EarlyStopping counter: 4 out of 10
2025-02-27 23:08:51,128 - {'epoch': 22, 'rec_loss': '7.3454'}
2025-02-27 23:09:10,092 - {'Epoch': 22, 'HR@5': '0.0300', 'NDCG@5': '0.0190', 'HR@10': '0.0515', 'NDCG@10': '0.0259', 'HR@20': '0.0821', 'NDCG@20': '0.0336'}
2025-02-27 23:09:10,098 - EarlyStopping counter: 5 out of 10
2025-02-27 23:10:00,281 - {'epoch': 23, 'rec_loss': '7.3362'}
2025-02-27 23:10:20,250 - {'Epoch': 23, 'HR@5': '0.0305', 'NDCG@5': '0.0197', 'HR@10': '0.0510', 'NDCG@10': '0.0263', 'HR@20': '0.0816', 'NDCG@20': '0.0339'}
2025-02-27 23:10:20,257 - Validation score increased.  Saving model ...
2025-02-27 23:11:09,884 - {'epoch': 24, 'rec_loss': '7.3242'}
2025-02-27 23:11:29,196 - {'Epoch': 24, 'HR@5': '0.0307', 'NDCG@5': '0.0198', 'HR@10': '0.0525', 'NDCG@10': '0.0268', 'HR@20': '0.0847', 'NDCG@20': '0.0348'}
2025-02-27 23:11:29,201 - Validation score increased.  Saving model ...
2025-02-27 23:12:19,622 - {'epoch': 25, 'rec_loss': '7.3152'}
2025-02-27 23:12:38,281 - {'Epoch': 25, 'HR@5': '0.0306', 'NDCG@5': '0.0194', 'HR@10': '0.0515', 'NDCG@10': '0.0261', 'HR@20': '0.0828', 'NDCG@20': '0.0340'}
2025-02-27 23:12:38,287 - EarlyStopping counter: 1 out of 10
2025-02-27 23:13:28,187 - {'epoch': 26, 'rec_loss': '7.2973'}
2025-02-27 23:13:47,695 - {'Epoch': 26, 'HR@5': '0.0307', 'NDCG@5': '0.0192', 'HR@10': '0.0525', 'NDCG@10': '0.0262', 'HR@20': '0.0837', 'NDCG@20': '0.0341'}
2025-02-27 23:13:47,702 - EarlyStopping counter: 2 out of 10
2025-02-27 23:14:38,108 - {'epoch': 27, 'rec_loss': '7.2939'}
2025-02-27 23:14:57,653 - {'Epoch': 27, 'HR@5': '0.0307', 'NDCG@5': '0.0196', 'HR@10': '0.0514', 'NDCG@10': '0.0262', 'HR@20': '0.0824', 'NDCG@20': '0.0340'}
2025-02-27 23:14:57,660 - EarlyStopping counter: 3 out of 10
2025-02-27 23:15:48,311 - {'epoch': 28, 'rec_loss': '7.2784'}
2025-02-27 23:16:07,144 - {'Epoch': 28, 'HR@5': '0.0308', 'NDCG@5': '0.0192', 'HR@10': '0.0511', 'NDCG@10': '0.0257', 'HR@20': '0.0824', 'NDCG@20': '0.0335'}
2025-02-27 23:16:07,146 - EarlyStopping counter: 4 out of 10
2025-02-27 23:16:56,999 - {'epoch': 29, 'rec_loss': '7.2754'}
2025-02-27 23:17:16,207 - {'Epoch': 29, 'HR@5': '0.0308', 'NDCG@5': '0.0196', 'HR@10': '0.0503', 'NDCG@10': '0.0258', 'HR@20': '0.0811', 'NDCG@20': '0.0335'}
2025-02-27 23:17:16,213 - EarlyStopping counter: 5 out of 10
2025-02-27 23:18:06,336 - {'epoch': 30, 'rec_loss': '7.2591'}
2025-02-27 23:18:25,568 - {'Epoch': 30, 'HR@5': '0.0300', 'NDCG@5': '0.0191', 'HR@10': '0.0499', 'NDCG@10': '0.0255', 'HR@20': '0.0799', 'NDCG@20': '0.0330'}
2025-02-27 23:18:25,574 - EarlyStopping counter: 6 out of 10
2025-02-27 23:19:15,279 - {'epoch': 31, 'rec_loss': '7.2552'}
2025-02-27 23:19:33,874 - {'Epoch': 31, 'HR@5': '0.0308', 'NDCG@5': '0.0195', 'HR@10': '0.0507', 'NDCG@10': '0.0259', 'HR@20': '0.0816', 'NDCG@20': '0.0337'}
2025-02-27 23:19:33,879 - EarlyStopping counter: 7 out of 10
2025-02-27 23:20:23,264 - {'epoch': 32, 'rec_loss': '7.2493'}
2025-02-27 23:20:42,454 - {'Epoch': 32, 'HR@5': '0.0307', 'NDCG@5': '0.0193', 'HR@10': '0.0521', 'NDCG@10': '0.0261', 'HR@20': '0.0811', 'NDCG@20': '0.0334'}
2025-02-27 23:20:42,459 - EarlyStopping counter: 8 out of 10
2025-02-27 23:21:31,218 - {'epoch': 33, 'rec_loss': '7.2443'}
2025-02-27 23:21:50,761 - {'Epoch': 33, 'HR@5': '0.0313', 'NDCG@5': '0.0197', 'HR@10': '0.0514', 'NDCG@10': '0.0262', 'HR@20': '0.0811', 'NDCG@20': '0.0336'}
2025-02-27 23:21:50,768 - EarlyStopping counter: 9 out of 10
2025-02-27 23:22:41,727 - {'epoch': 34, 'rec_loss': '7.2276'}
2025-02-27 23:23:00,650 - {'Epoch': 34, 'HR@5': '0.0311', 'NDCG@5': '0.0197', 'HR@10': '0.0512', 'NDCG@10': '0.0261', 'HR@20': '0.0820', 'NDCG@20': '0.0339'}
2025-02-27 23:23:00,656 - EarlyStopping counter: 10 out of 10
2025-02-27 23:23:00,656 - Early stopping
2025-02-27 23:23:00,656 - ---------------Test Score---------------
2025-02-27 23:23:19,815 - {'Epoch': 0, 'HR@5': '0.0280', 'NDCG@5': '0.0177', 'HR@10': '0.0465', 'NDCG@10': '0.0236', 'HR@20': '0.0745', 'NDCG@20': '0.0307'}
2025-02-27 23:23:19,822 - Scale_Yelp
2025-02-27 23:23:19,822 - {'Epoch': 0, 'HR@5': '0.0280', 'NDCG@5': '0.0177', 'HR@10': '0.0465', 'NDCG@10': '0.0236', 'HR@20': '0.0745', 'NDCG@20': '0.0307'}
2025-02-27 23:39:38,714 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[2, 4, 6], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-02-27 23:39:42,024 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-27 23:39:42,039 - Total Parameters: 1437093
2025-02-27 23:40:30,488 - {'epoch': 0, 'rec_loss': '9.5518'}
2025-02-27 23:40:50,659 - {'Epoch': 0, 'HR@5': '0.0081', 'NDCG@5': '0.0054', 'HR@10': '0.0137', 'NDCG@10': '0.0072', 'HR@20': '0.0249', 'NDCG@20': '0.0100'}
2025-02-27 23:40:50,661 - Validation score increased.  Saving model ...
2025-02-27 23:41:38,949 - {'epoch': 1, 'rec_loss': '8.9621'}
2025-02-27 23:41:58,025 - {'Epoch': 1, 'HR@5': '0.0133', 'NDCG@5': '0.0083', 'HR@10': '0.0217', 'NDCG@10': '0.0110', 'HR@20': '0.0372', 'NDCG@20': '0.0149'}
2025-02-27 23:41:58,028 - Validation score increased.  Saving model ...
2025-02-27 23:42:46,556 - {'epoch': 2, 'rec_loss': '8.5538'}
2025-02-27 23:43:04,937 - {'Epoch': 2, 'HR@5': '0.0183', 'NDCG@5': '0.0112', 'HR@10': '0.0308', 'NDCG@10': '0.0152', 'HR@20': '0.0515', 'NDCG@20': '0.0204'}
2025-02-27 23:43:04,939 - Validation score increased.  Saving model ...
2025-02-27 23:43:53,207 - {'epoch': 3, 'rec_loss': '8.2734'}
2025-02-27 23:44:11,482 - {'Epoch': 3, 'HR@5': '0.0209', 'NDCG@5': '0.0127', 'HR@10': '0.0360', 'NDCG@10': '0.0176', 'HR@20': '0.0583', 'NDCG@20': '0.0232'}
2025-02-27 23:44:11,484 - Validation score increased.  Saving model ...
2025-02-27 23:44:59,659 - {'epoch': 4, 'rec_loss': '8.0945'}
2025-02-27 23:45:17,545 - {'Epoch': 4, 'HR@5': '0.0224', 'NDCG@5': '0.0140', 'HR@10': '0.0386', 'NDCG@10': '0.0192', 'HR@20': '0.0658', 'NDCG@20': '0.0260'}
2025-02-27 23:45:17,554 - Validation score increased.  Saving model ...
2025-02-27 23:46:05,579 - {'epoch': 5, 'rec_loss': '7.9617'}
2025-02-27 23:46:23,630 - {'Epoch': 5, 'HR@5': '0.0249', 'NDCG@5': '0.0156', 'HR@10': '0.0425', 'NDCG@10': '0.0213', 'HR@20': '0.0683', 'NDCG@20': '0.0278'}
2025-02-27 23:46:23,634 - Validation score increased.  Saving model ...
2025-02-27 23:47:11,194 - {'epoch': 6, 'rec_loss': '7.8626'}
2025-02-27 23:47:29,888 - {'Epoch': 6, 'HR@5': '0.0256', 'NDCG@5': '0.0161', 'HR@10': '0.0442', 'NDCG@10': '0.0221', 'HR@20': '0.0732', 'NDCG@20': '0.0293'}
2025-02-27 23:47:29,890 - Validation score increased.  Saving model ...
2025-02-27 23:48:17,142 - {'epoch': 7, 'rec_loss': '7.7853'}
2025-02-27 23:48:36,430 - {'Epoch': 7, 'HR@5': '0.0252', 'NDCG@5': '0.0157', 'HR@10': '0.0449', 'NDCG@10': '0.0220', 'HR@20': '0.0744', 'NDCG@20': '0.0294'}
2025-02-27 23:48:36,432 - Validation score increased.  Saving model ...
2025-02-27 23:49:24,918 - {'epoch': 8, 'rec_loss': '7.7168'}
2025-02-27 23:49:43,418 - {'Epoch': 8, 'HR@5': '0.0279', 'NDCG@5': '0.0173', 'HR@10': '0.0458', 'NDCG@10': '0.0231', 'HR@20': '0.0740', 'NDCG@20': '0.0301'}
2025-02-27 23:49:43,426 - Validation score increased.  Saving model ...
2025-02-27 23:50:30,296 - {'epoch': 9, 'rec_loss': '7.6676'}
2025-02-27 23:50:49,040 - {'Epoch': 9, 'HR@5': '0.0281', 'NDCG@5': '0.0174', 'HR@10': '0.0472', 'NDCG@10': '0.0236', 'HR@20': '0.0768', 'NDCG@20': '0.0310'}
2025-02-27 23:50:49,045 - Validation score increased.  Saving model ...
2025-02-27 23:51:36,649 - {'epoch': 10, 'rec_loss': '7.6209'}
2025-02-27 23:51:55,171 - {'Epoch': 10, 'HR@5': '0.0274', 'NDCG@5': '0.0173', 'HR@10': '0.0480', 'NDCG@10': '0.0240', 'HR@20': '0.0783', 'NDCG@20': '0.0316'}
2025-02-27 23:51:55,179 - Validation score increased.  Saving model ...
2025-02-27 23:52:42,907 - {'epoch': 11, 'rec_loss': '7.5819'}
2025-02-27 23:53:01,191 - {'Epoch': 11, 'HR@5': '0.0283', 'NDCG@5': '0.0176', 'HR@10': '0.0500', 'NDCG@10': '0.0245', 'HR@20': '0.0786', 'NDCG@20': '0.0317'}
2025-02-27 23:53:01,199 - Validation score increased.  Saving model ...
2025-02-27 23:53:49,465 - {'epoch': 12, 'rec_loss': '7.5509'}
2025-02-27 23:54:08,098 - {'Epoch': 12, 'HR@5': '0.0289', 'NDCG@5': '0.0183', 'HR@10': '0.0488', 'NDCG@10': '0.0247', 'HR@20': '0.0794', 'NDCG@20': '0.0324'}
2025-02-27 23:54:08,111 - Validation score increased.  Saving model ...
2025-02-27 23:54:56,470 - {'epoch': 13, 'rec_loss': '7.5197'}
2025-02-27 23:55:15,723 - {'Epoch': 13, 'HR@5': '0.0297', 'NDCG@5': '0.0184', 'HR@10': '0.0495', 'NDCG@10': '0.0247', 'HR@20': '0.0780', 'NDCG@20': '0.0319'}
2025-02-27 23:55:15,726 - EarlyStopping counter: 1 out of 10
2025-02-27 23:56:03,355 - {'epoch': 14, 'rec_loss': '7.4962'}
2025-02-27 23:56:22,209 - {'Epoch': 14, 'HR@5': '0.0298', 'NDCG@5': '0.0189', 'HR@10': '0.0492', 'NDCG@10': '0.0251', 'HR@20': '0.0783', 'NDCG@20': '0.0324'}
2025-02-27 23:56:22,215 - Validation score increased.  Saving model ...
2025-02-27 23:57:10,573 - {'epoch': 15, 'rec_loss': '7.4747'}
2025-02-27 23:57:29,506 - {'Epoch': 15, 'HR@5': '0.0304', 'NDCG@5': '0.0186', 'HR@10': '0.0499', 'NDCG@10': '0.0249', 'HR@20': '0.0798', 'NDCG@20': '0.0323'}
2025-02-27 23:57:29,512 - EarlyStopping counter: 1 out of 10
2025-02-27 23:58:16,986 - {'epoch': 16, 'rec_loss': '7.4527'}
2025-02-27 23:58:36,127 - {'Epoch': 16, 'HR@5': '0.0307', 'NDCG@5': '0.0189', 'HR@10': '0.0501', 'NDCG@10': '0.0251', 'HR@20': '0.0808', 'NDCG@20': '0.0328'}
2025-02-27 23:58:36,128 - Validation score increased.  Saving model ...
2025-02-27 23:59:26,393 - {'epoch': 17, 'rec_loss': '7.4319'}
2025-02-27 23:59:44,982 - {'Epoch': 17, 'HR@5': '0.0307', 'NDCG@5': '0.0190', 'HR@10': '0.0510', 'NDCG@10': '0.0255', 'HR@20': '0.0814', 'NDCG@20': '0.0331'}
2025-02-27 23:59:44,988 - Validation score increased.  Saving model ...
2025-02-28 00:00:31,717 - {'epoch': 18, 'rec_loss': '7.4091'}
2025-02-28 00:00:50,581 - {'Epoch': 18, 'HR@5': '0.0297', 'NDCG@5': '0.0186', 'HR@10': '0.0490', 'NDCG@10': '0.0248', 'HR@20': '0.0817', 'NDCG@20': '0.0330'}
2025-02-28 00:00:50,583 - EarlyStopping counter: 1 out of 10
2025-02-28 00:01:37,078 - {'epoch': 19, 'rec_loss': '7.3943'}
2025-02-28 00:01:55,787 - {'Epoch': 19, 'HR@5': '0.0302', 'NDCG@5': '0.0188', 'HR@10': '0.0507', 'NDCG@10': '0.0254', 'HR@20': '0.0822', 'NDCG@20': '0.0332'}
2025-02-28 00:01:55,789 - Validation score increased.  Saving model ...
2025-02-28 00:02:43,259 - {'epoch': 20, 'rec_loss': '7.3772'}
2025-02-28 00:03:01,834 - {'Epoch': 20, 'HR@5': '0.0296', 'NDCG@5': '0.0186', 'HR@10': '0.0506', 'NDCG@10': '0.0253', 'HR@20': '0.0818', 'NDCG@20': '0.0332'}
2025-02-28 00:03:01,836 - EarlyStopping counter: 1 out of 10
2025-02-28 00:03:48,904 - {'epoch': 21, 'rec_loss': '7.3686'}
2025-02-28 00:04:07,646 - {'Epoch': 21, 'HR@5': '0.0306', 'NDCG@5': '0.0191', 'HR@10': '0.0515', 'NDCG@10': '0.0258', 'HR@20': '0.0813', 'NDCG@20': '0.0333'}
2025-02-28 00:04:07,650 - Validation score increased.  Saving model ...
2025-02-28 00:04:54,834 - {'epoch': 22, 'rec_loss': '7.3531'}
2025-02-28 00:05:13,549 - {'Epoch': 22, 'HR@5': '0.0308', 'NDCG@5': '0.0188', 'HR@10': '0.0505', 'NDCG@10': '0.0251', 'HR@20': '0.0813', 'NDCG@20': '0.0328'}
2025-02-28 00:05:13,552 - EarlyStopping counter: 1 out of 10
2025-02-28 00:06:02,525 - {'epoch': 23, 'rec_loss': '7.3320'}
2025-02-28 00:06:21,180 - {'Epoch': 23, 'HR@5': '0.0306', 'NDCG@5': '0.0189', 'HR@10': '0.0506', 'NDCG@10': '0.0253', 'HR@20': '0.0832', 'NDCG@20': '0.0335'}
2025-02-28 00:06:21,182 - Validation score increased.  Saving model ...
2025-02-28 00:07:08,042 - {'epoch': 24, 'rec_loss': '7.3214'}
2025-02-28 00:07:26,974 - {'Epoch': 24, 'HR@5': '0.0313', 'NDCG@5': '0.0196', 'HR@10': '0.0513', 'NDCG@10': '0.0260', 'HR@20': '0.0823', 'NDCG@20': '0.0338'}
2025-02-28 00:07:26,978 - Validation score increased.  Saving model ...
2025-02-28 00:08:14,310 - {'epoch': 25, 'rec_loss': '7.3082'}
2025-02-28 00:08:33,085 - {'Epoch': 25, 'HR@5': '0.0304', 'NDCG@5': '0.0192', 'HR@10': '0.0501', 'NDCG@10': '0.0255', 'HR@20': '0.0822', 'NDCG@20': '0.0336'}
2025-02-28 00:08:33,091 - EarlyStopping counter: 1 out of 10
2025-02-28 00:09:22,385 - {'epoch': 26, 'rec_loss': '7.2988'}
2025-02-28 00:09:41,382 - {'Epoch': 26, 'HR@5': '0.0303', 'NDCG@5': '0.0189', 'HR@10': '0.0507', 'NDCG@10': '0.0254', 'HR@20': '0.0811', 'NDCG@20': '0.0331'}
2025-02-28 00:09:41,384 - EarlyStopping counter: 2 out of 10
2025-02-28 00:10:29,714 - {'epoch': 27, 'rec_loss': '7.2892'}
2025-02-28 00:10:48,949 - {'Epoch': 27, 'HR@5': '0.0320', 'NDCG@5': '0.0199', 'HR@10': '0.0508', 'NDCG@10': '0.0259', 'HR@20': '0.0820', 'NDCG@20': '0.0337'}
2025-02-28 00:10:48,951 - EarlyStopping counter: 3 out of 10
2025-02-28 00:11:37,574 - {'epoch': 28, 'rec_loss': '7.2784'}
2025-02-28 00:11:56,051 - {'Epoch': 28, 'HR@5': '0.0305', 'NDCG@5': '0.0192', 'HR@10': '0.0512', 'NDCG@10': '0.0258', 'HR@20': '0.0826', 'NDCG@20': '0.0337'}
2025-02-28 00:11:56,058 - EarlyStopping counter: 4 out of 10
2025-02-28 00:12:44,349 - {'epoch': 29, 'rec_loss': '7.2687'}
2025-02-28 00:12:59,808 - {'Epoch': 29, 'HR@5': '0.0307', 'NDCG@5': '0.0193', 'HR@10': '0.0500', 'NDCG@10': '0.0255', 'HR@20': '0.0813', 'NDCG@20': '0.0333'}
2025-02-28 00:12:59,810 - EarlyStopping counter: 5 out of 10
2025-02-28 00:13:44,807 - {'epoch': 30, 'rec_loss': '7.2592'}
2025-02-28 00:14:00,632 - {'Epoch': 30, 'HR@5': '0.0312', 'NDCG@5': '0.0198', 'HR@10': '0.0518', 'NDCG@10': '0.0264', 'HR@20': '0.0832', 'NDCG@20': '0.0343'}
2025-02-28 00:14:00,636 - Validation score increased.  Saving model ...
2025-02-28 00:14:49,952 - {'epoch': 31, 'rec_loss': '7.2493'}
2025-02-28 00:15:04,991 - {'Epoch': 31, 'HR@5': '0.0309', 'NDCG@5': '0.0191', 'HR@10': '0.0512', 'NDCG@10': '0.0256', 'HR@20': '0.0823', 'NDCG@20': '0.0334'}
2025-02-28 00:15:04,995 - EarlyStopping counter: 1 out of 10
2025-02-28 00:15:52,547 - {'epoch': 32, 'rec_loss': '7.2419'}
2025-02-28 00:16:07,699 - {'Epoch': 32, 'HR@5': '0.0303', 'NDCG@5': '0.0186', 'HR@10': '0.0516', 'NDCG@10': '0.0254', 'HR@20': '0.0825', 'NDCG@20': '0.0332'}
2025-02-28 00:16:07,704 - EarlyStopping counter: 2 out of 10
2025-02-28 00:16:55,032 - {'epoch': 33, 'rec_loss': '7.2366'}
2025-02-28 00:17:11,280 - {'Epoch': 33, 'HR@5': '0.0314', 'NDCG@5': '0.0197', 'HR@10': '0.0519', 'NDCG@10': '0.0263', 'HR@20': '0.0848', 'NDCG@20': '0.0346'}
2025-02-28 00:17:11,285 - Validation score increased.  Saving model ...
2025-02-28 00:18:00,026 - {'epoch': 34, 'rec_loss': '7.2295'}
2025-02-28 00:18:19,030 - {'Epoch': 34, 'HR@5': '0.0312', 'NDCG@5': '0.0194', 'HR@10': '0.0519', 'NDCG@10': '0.0260', 'HR@20': '0.0826', 'NDCG@20': '0.0337'}
2025-02-28 00:18:19,032 - EarlyStopping counter: 1 out of 10
2025-02-28 00:19:10,248 - {'epoch': 35, 'rec_loss': '7.2258'}
2025-02-28 00:19:29,431 - {'Epoch': 35, 'HR@5': '0.0299', 'NDCG@5': '0.0183', 'HR@10': '0.0501', 'NDCG@10': '0.0248', 'HR@20': '0.0805', 'NDCG@20': '0.0325'}
2025-02-28 00:19:29,436 - EarlyStopping counter: 2 out of 10
2025-02-28 00:20:19,897 - {'epoch': 36, 'rec_loss': '7.2171'}
2025-02-28 00:20:38,467 - {'Epoch': 36, 'HR@5': '0.0299', 'NDCG@5': '0.0189', 'HR@10': '0.0502', 'NDCG@10': '0.0254', 'HR@20': '0.0815', 'NDCG@20': '0.0332'}
2025-02-28 00:20:38,469 - EarlyStopping counter: 3 out of 10
2025-02-28 00:21:28,157 - {'epoch': 37, 'rec_loss': '7.2088'}
2025-02-28 00:21:46,946 - {'Epoch': 37, 'HR@5': '0.0307', 'NDCG@5': '0.0197', 'HR@10': '0.0516', 'NDCG@10': '0.0264', 'HR@20': '0.0820', 'NDCG@20': '0.0341'}
2025-02-28 00:21:46,948 - EarlyStopping counter: 4 out of 10
2025-02-28 00:22:37,339 - {'epoch': 38, 'rec_loss': '7.1975'}
2025-02-28 00:22:56,423 - {'Epoch': 38, 'HR@5': '0.0303', 'NDCG@5': '0.0195', 'HR@10': '0.0514', 'NDCG@10': '0.0263', 'HR@20': '0.0817', 'NDCG@20': '0.0339'}
2025-02-28 00:22:56,431 - EarlyStopping counter: 5 out of 10
2025-02-28 00:23:48,062 - {'epoch': 39, 'rec_loss': '7.1893'}
2025-02-28 00:24:07,041 - {'Epoch': 39, 'HR@5': '0.0317', 'NDCG@5': '0.0198', 'HR@10': '0.0498', 'NDCG@10': '0.0256', 'HR@20': '0.0825', 'NDCG@20': '0.0338'}
2025-02-28 00:24:07,046 - EarlyStopping counter: 6 out of 10
2025-02-28 00:24:55,777 - {'epoch': 40, 'rec_loss': '7.1957'}
2025-02-28 00:25:15,077 - {'Epoch': 40, 'HR@5': '0.0296', 'NDCG@5': '0.0189', 'HR@10': '0.0505', 'NDCG@10': '0.0256', 'HR@20': '0.0828', 'NDCG@20': '0.0338'}
2025-02-28 00:25:15,083 - EarlyStopping counter: 7 out of 10
2025-02-28 00:26:03,464 - {'epoch': 41, 'rec_loss': '7.1829'}
2025-02-28 00:26:22,812 - {'Epoch': 41, 'HR@5': '0.0311', 'NDCG@5': '0.0195', 'HR@10': '0.0517', 'NDCG@10': '0.0261', 'HR@20': '0.0826', 'NDCG@20': '0.0339'}
2025-02-28 00:26:22,814 - EarlyStopping counter: 8 out of 10
2025-02-28 00:27:12,541 - {'epoch': 42, 'rec_loss': '7.1792'}
2025-02-28 00:27:31,490 - {'Epoch': 42, 'HR@5': '0.0312', 'NDCG@5': '0.0196', 'HR@10': '0.0500', 'NDCG@10': '0.0256', 'HR@20': '0.0814', 'NDCG@20': '0.0335'}
2025-02-28 00:27:31,492 - EarlyStopping counter: 9 out of 10
2025-02-28 00:28:21,667 - {'epoch': 43, 'rec_loss': '7.1764'}
2025-02-28 00:28:40,849 - {'Epoch': 43, 'HR@5': '0.0303', 'NDCG@5': '0.0191', 'HR@10': '0.0517', 'NDCG@10': '0.0259', 'HR@20': '0.0819', 'NDCG@20': '0.0335'}
2025-02-28 00:28:40,853 - EarlyStopping counter: 10 out of 10
2025-02-28 00:28:40,853 - Early stopping
2025-02-28 00:28:40,853 - ---------------Test Score---------------
2025-02-28 00:29:00,077 - {'Epoch': 0, 'HR@5': '0.0282', 'NDCG@5': '0.0178', 'HR@10': '0.0480', 'NDCG@10': '0.0242', 'HR@20': '0.0777', 'NDCG@20': '0.0317'}
2025-02-28 00:29:00,078 - Scale_Yelp
2025-02-28 00:29:00,079 - {'Epoch': 0, 'HR@5': '0.0282', 'NDCG@5': '0.0178', 'HR@10': '0.0480', 'NDCG@10': '0.0242', 'HR@20': '0.0777', 'NDCG@20': '0.0317'}
2025-02-28 00:37:05,869 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-02-28 00:37:09,313 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-28 00:37:09,325 - Total Parameters: 1437093
2025-02-28 00:37:59,063 - {'epoch': 0, 'rec_loss': '9.5519'}
2025-02-28 00:38:19,105 - {'Epoch': 0, 'HR@5': '0.0083', 'NDCG@5': '0.0055', 'HR@10': '0.0140', 'NDCG@10': '0.0073', 'HR@20': '0.0250', 'NDCG@20': '0.0100'}
2025-02-28 00:38:19,111 - Validation score increased.  Saving model ...
2025-02-28 00:39:07,373 - {'epoch': 1, 'rec_loss': '8.9628'}
2025-02-28 00:39:25,717 - {'Epoch': 1, 'HR@5': '0.0133', 'NDCG@5': '0.0083', 'HR@10': '0.0220', 'NDCG@10': '0.0111', 'HR@20': '0.0374', 'NDCG@20': '0.0150'}
2025-02-28 00:39:25,724 - Validation score increased.  Saving model ...
2025-02-28 00:40:16,625 - {'epoch': 2, 'rec_loss': '8.5541'}
2025-02-28 00:40:34,841 - {'Epoch': 2, 'HR@5': '0.0182', 'NDCG@5': '0.0111', 'HR@10': '0.0309', 'NDCG@10': '0.0152', 'HR@20': '0.0513', 'NDCG@20': '0.0204'}
2025-02-28 00:40:34,844 - Validation score increased.  Saving model ...
2025-02-28 00:41:23,798 - {'epoch': 3, 'rec_loss': '8.2749'}
2025-02-28 00:41:42,603 - {'Epoch': 3, 'HR@5': '0.0208', 'NDCG@5': '0.0126', 'HR@10': '0.0361', 'NDCG@10': '0.0175', 'HR@20': '0.0585', 'NDCG@20': '0.0231'}
2025-02-28 00:41:42,612 - Validation score increased.  Saving model ...
2025-02-28 00:42:29,930 - {'epoch': 4, 'rec_loss': '8.0957'}
2025-02-28 00:42:48,068 - {'Epoch': 4, 'HR@5': '0.0224', 'NDCG@5': '0.0141', 'HR@10': '0.0386', 'NDCG@10': '0.0192', 'HR@20': '0.0661', 'NDCG@20': '0.0261'}
2025-02-28 00:42:48,070 - Validation score increased.  Saving model ...
2025-02-28 00:43:36,196 - {'epoch': 5, 'rec_loss': '7.9627'}
2025-02-28 00:43:53,790 - {'Epoch': 5, 'HR@5': '0.0248', 'NDCG@5': '0.0157', 'HR@10': '0.0429', 'NDCG@10': '0.0215', 'HR@20': '0.0686', 'NDCG@20': '0.0280'}
2025-02-28 00:43:53,792 - Validation score increased.  Saving model ...
2025-02-28 00:44:41,800 - {'epoch': 6, 'rec_loss': '7.8639'}
2025-02-28 00:45:00,269 - {'Epoch': 6, 'HR@5': '0.0255', 'NDCG@5': '0.0161', 'HR@10': '0.0443', 'NDCG@10': '0.0221', 'HR@20': '0.0725', 'NDCG@20': '0.0291'}
2025-02-28 00:45:00,278 - Validation score increased.  Saving model ...
2025-02-28 00:45:48,297 - {'epoch': 7, 'rec_loss': '7.7865'}
2025-02-28 00:46:06,738 - {'Epoch': 7, 'HR@5': '0.0253', 'NDCG@5': '0.0158', 'HR@10': '0.0451', 'NDCG@10': '0.0221', 'HR@20': '0.0746', 'NDCG@20': '0.0295'}
2025-02-28 00:46:06,740 - Validation score increased.  Saving model ...
2025-02-28 00:46:54,828 - {'epoch': 8, 'rec_loss': '7.7185'}
2025-02-28 00:47:12,609 - {'Epoch': 8, 'HR@5': '0.0278', 'NDCG@5': '0.0173', 'HR@10': '0.0457', 'NDCG@10': '0.0231', 'HR@20': '0.0744', 'NDCG@20': '0.0303'}
2025-02-28 00:47:12,617 - Validation score increased.  Saving model ...
2025-02-28 00:48:01,018 - {'epoch': 9, 'rec_loss': '7.6690'}
2025-02-28 00:48:20,047 - {'Epoch': 9, 'HR@5': '0.0284', 'NDCG@5': '0.0176', 'HR@10': '0.0474', 'NDCG@10': '0.0237', 'HR@20': '0.0764', 'NDCG@20': '0.0310'}
2025-02-28 00:48:20,049 - Validation score increased.  Saving model ...
2025-02-28 00:49:07,956 - {'epoch': 10, 'rec_loss': '7.6220'}
2025-02-28 00:49:26,531 - {'Epoch': 10, 'HR@5': '0.0271', 'NDCG@5': '0.0173', 'HR@10': '0.0480', 'NDCG@10': '0.0240', 'HR@20': '0.0772', 'NDCG@20': '0.0313'}
2025-02-28 00:49:26,533 - Validation score increased.  Saving model ...
2025-02-28 00:50:14,084 - {'epoch': 11, 'rec_loss': '7.5829'}
2025-02-28 00:50:32,570 - {'Epoch': 11, 'HR@5': '0.0285', 'NDCG@5': '0.0177', 'HR@10': '0.0495', 'NDCG@10': '0.0244', 'HR@20': '0.0792', 'NDCG@20': '0.0319'}
2025-02-28 00:50:32,583 - Validation score increased.  Saving model ...
2025-02-28 00:51:21,078 - {'epoch': 12, 'rec_loss': '7.5513'}
2025-02-28 00:51:40,024 - {'Epoch': 12, 'HR@5': '0.0296', 'NDCG@5': '0.0186', 'HR@10': '0.0488', 'NDCG@10': '0.0248', 'HR@20': '0.0807', 'NDCG@20': '0.0328'}
2025-02-28 00:51:40,026 - Validation score increased.  Saving model ...
2025-02-28 00:52:26,956 - {'epoch': 13, 'rec_loss': '7.5200'}
2025-02-28 00:52:46,184 - {'Epoch': 13, 'HR@5': '0.0299', 'NDCG@5': '0.0184', 'HR@10': '0.0500', 'NDCG@10': '0.0249', 'HR@20': '0.0786', 'NDCG@20': '0.0321'}
2025-02-28 00:52:46,186 - EarlyStopping counter: 1 out of 10
2025-02-28 00:53:32,657 - {'epoch': 14, 'rec_loss': '7.4964'}
2025-02-28 00:53:51,911 - {'Epoch': 14, 'HR@5': '0.0296', 'NDCG@5': '0.0187', 'HR@10': '0.0495', 'NDCG@10': '0.0251', 'HR@20': '0.0788', 'NDCG@20': '0.0324'}
2025-02-28 00:53:51,918 - EarlyStopping counter: 2 out of 10
2025-02-28 00:54:38,319 - {'epoch': 15, 'rec_loss': '7.4751'}
2025-02-28 00:54:57,180 - {'Epoch': 15, 'HR@5': '0.0302', 'NDCG@5': '0.0185', 'HR@10': '0.0499', 'NDCG@10': '0.0248', 'HR@20': '0.0787', 'NDCG@20': '0.0320'}
2025-02-28 00:54:57,183 - EarlyStopping counter: 3 out of 10
2025-02-28 00:55:44,346 - {'epoch': 16, 'rec_loss': '7.4527'}
2025-02-28 00:56:02,975 - {'Epoch': 16, 'HR@5': '0.0305', 'NDCG@5': '0.0185', 'HR@10': '0.0508', 'NDCG@10': '0.0250', 'HR@20': '0.0808', 'NDCG@20': '0.0326'}
2025-02-28 00:56:02,985 - EarlyStopping counter: 4 out of 10
2025-02-28 00:56:50,096 - {'epoch': 17, 'rec_loss': '7.4328'}
2025-02-28 00:57:08,920 - {'Epoch': 17, 'HR@5': '0.0302', 'NDCG@5': '0.0187', 'HR@10': '0.0507', 'NDCG@10': '0.0252', 'HR@20': '0.0809', 'NDCG@20': '0.0328'}
2025-02-28 00:57:08,928 - Validation score increased.  Saving model ...
2025-02-28 00:57:57,050 - {'epoch': 18, 'rec_loss': '7.4104'}
2025-02-28 00:58:15,759 - {'Epoch': 18, 'HR@5': '0.0296', 'NDCG@5': '0.0187', 'HR@10': '0.0491', 'NDCG@10': '0.0250', 'HR@20': '0.0815', 'NDCG@20': '0.0331'}
2025-02-28 00:58:15,768 - Validation score increased.  Saving model ...
2025-02-28 00:59:04,149 - {'epoch': 19, 'rec_loss': '7.3950'}
2025-02-28 00:59:23,571 - {'Epoch': 19, 'HR@5': '0.0305', 'NDCG@5': '0.0189', 'HR@10': '0.0506', 'NDCG@10': '0.0253', 'HR@20': '0.0828', 'NDCG@20': '0.0334'}
2025-02-28 00:59:23,573 - Validation score increased.  Saving model ...
2025-02-28 01:00:11,667 - {'epoch': 20, 'rec_loss': '7.3780'}
2025-02-28 01:00:31,370 - {'Epoch': 20, 'HR@5': '0.0296', 'NDCG@5': '0.0186', 'HR@10': '0.0512', 'NDCG@10': '0.0255', 'HR@20': '0.0815', 'NDCG@20': '0.0331'}
2025-02-28 01:00:31,372 - EarlyStopping counter: 1 out of 10
2025-02-28 01:01:24,531 - {'epoch': 21, 'rec_loss': '7.3687'}
2025-02-28 01:01:44,319 - {'Epoch': 21, 'HR@5': '0.0302', 'NDCG@5': '0.0190', 'HR@10': '0.0519', 'NDCG@10': '0.0260', 'HR@20': '0.0812', 'NDCG@20': '0.0333'}
2025-02-28 01:01:44,322 - EarlyStopping counter: 2 out of 10
2025-02-28 01:02:35,293 - {'epoch': 22, 'rec_loss': '7.3533'}
2025-02-28 01:02:54,233 - {'Epoch': 22, 'HR@5': '0.0300', 'NDCG@5': '0.0185', 'HR@10': '0.0501', 'NDCG@10': '0.0250', 'HR@20': '0.0811', 'NDCG@20': '0.0328'}
2025-02-28 01:02:54,235 - EarlyStopping counter: 3 out of 10
2025-02-28 01:03:44,957 - {'epoch': 23, 'rec_loss': '7.3329'}
2025-02-28 01:04:04,261 - {'Epoch': 23, 'HR@5': '0.0308', 'NDCG@5': '0.0189', 'HR@10': '0.0504', 'NDCG@10': '0.0252', 'HR@20': '0.0826', 'NDCG@20': '0.0333'}
2025-02-28 01:04:04,264 - EarlyStopping counter: 4 out of 10
2025-02-28 01:04:55,957 - {'epoch': 24, 'rec_loss': '7.3222'}
2025-02-28 01:05:14,358 - {'Epoch': 24, 'HR@5': '0.0316', 'NDCG@5': '0.0198', 'HR@10': '0.0515', 'NDCG@10': '0.0261', 'HR@20': '0.0824', 'NDCG@20': '0.0338'}
2025-02-28 01:05:14,367 - Validation score increased.  Saving model ...
2025-02-28 01:06:05,045 - {'epoch': 25, 'rec_loss': '7.3091'}
2025-02-28 01:06:23,676 - {'Epoch': 25, 'HR@5': '0.0302', 'NDCG@5': '0.0193', 'HR@10': '0.0508', 'NDCG@10': '0.0258', 'HR@20': '0.0819', 'NDCG@20': '0.0336'}
2025-02-28 01:06:23,678 - EarlyStopping counter: 1 out of 10
2025-02-28 01:07:12,740 - {'epoch': 26, 'rec_loss': '7.3000'}
2025-02-28 01:07:31,304 - {'Epoch': 26, 'HR@5': '0.0302', 'NDCG@5': '0.0190', 'HR@10': '0.0511', 'NDCG@10': '0.0257', 'HR@20': '0.0815', 'NDCG@20': '0.0333'}
2025-02-28 01:07:31,313 - EarlyStopping counter: 2 out of 10
2025-02-28 01:08:19,216 - {'epoch': 27, 'rec_loss': '7.2904'}
2025-02-28 01:08:38,004 - {'Epoch': 27, 'HR@5': '0.0315', 'NDCG@5': '0.0196', 'HR@10': '0.0513', 'NDCG@10': '0.0260', 'HR@20': '0.0822', 'NDCG@20': '0.0337'}
2025-02-28 01:08:38,006 - EarlyStopping counter: 3 out of 10
2025-02-28 01:09:25,955 - {'epoch': 28, 'rec_loss': '7.2793'}
2025-02-28 01:09:45,056 - {'Epoch': 28, 'HR@5': '0.0312', 'NDCG@5': '0.0197', 'HR@10': '0.0510', 'NDCG@10': '0.0260', 'HR@20': '0.0822', 'NDCG@20': '0.0338'}
2025-02-28 01:09:45,079 - EarlyStopping counter: 4 out of 10
2025-02-28 01:10:32,345 - {'epoch': 29, 'rec_loss': '7.2698'}
2025-02-28 01:10:51,424 - {'Epoch': 29, 'HR@5': '0.0304', 'NDCG@5': '0.0192', 'HR@10': '0.0504', 'NDCG@10': '0.0256', 'HR@20': '0.0804', 'NDCG@20': '0.0331'}
2025-02-28 01:10:51,426 - EarlyStopping counter: 5 out of 10
2025-02-28 01:11:40,323 - {'epoch': 30, 'rec_loss': '7.2602'}
2025-02-28 01:11:59,778 - {'Epoch': 30, 'HR@5': '0.0316', 'NDCG@5': '0.0199', 'HR@10': '0.0515', 'NDCG@10': '0.0263', 'HR@20': '0.0830', 'NDCG@20': '0.0342'}
2025-02-28 01:11:59,789 - Validation score increased.  Saving model ...
2025-02-28 01:12:47,157 - {'epoch': 31, 'rec_loss': '7.2501'}
2025-02-28 01:13:05,935 - {'Epoch': 31, 'HR@5': '0.0313', 'NDCG@5': '0.0194', 'HR@10': '0.0510', 'NDCG@10': '0.0257', 'HR@20': '0.0835', 'NDCG@20': '0.0338'}
2025-02-28 01:13:05,938 - EarlyStopping counter: 1 out of 10
2025-02-28 01:13:54,525 - {'epoch': 32, 'rec_loss': '7.2427'}
2025-02-28 01:14:13,888 - {'Epoch': 32, 'HR@5': '0.0302', 'NDCG@5': '0.0188', 'HR@10': '0.0510', 'NDCG@10': '0.0254', 'HR@20': '0.0825', 'NDCG@20': '0.0334'}
2025-02-28 01:14:13,897 - EarlyStopping counter: 2 out of 10
2025-02-28 01:15:02,563 - {'epoch': 33, 'rec_loss': '7.2376'}
2025-02-28 01:15:21,595 - {'Epoch': 33, 'HR@5': '0.0315', 'NDCG@5': '0.0198', 'HR@10': '0.0522', 'NDCG@10': '0.0264', 'HR@20': '0.0847', 'NDCG@20': '0.0346'}
2025-02-28 01:15:21,597 - Validation score increased.  Saving model ...
2025-02-28 01:16:10,656 - {'epoch': 34, 'rec_loss': '7.2305'}
2025-02-28 01:16:29,661 - {'Epoch': 34, 'HR@5': '0.0311', 'NDCG@5': '0.0194', 'HR@10': '0.0517', 'NDCG@10': '0.0260', 'HR@20': '0.0818', 'NDCG@20': '0.0336'}
2025-02-28 01:16:29,663 - EarlyStopping counter: 1 out of 10
2025-02-28 01:17:18,126 - {'epoch': 35, 'rec_loss': '7.2270'}
2025-02-28 01:17:37,324 - {'Epoch': 35, 'HR@5': '0.0298', 'NDCG@5': '0.0184', 'HR@10': '0.0503', 'NDCG@10': '0.0250', 'HR@20': '0.0803', 'NDCG@20': '0.0325'}
2025-02-28 01:17:37,327 - EarlyStopping counter: 2 out of 10
2025-02-28 01:18:24,550 - {'epoch': 36, 'rec_loss': '7.2184'}
2025-02-28 01:18:43,376 - {'Epoch': 36, 'HR@5': '0.0306', 'NDCG@5': '0.0193', 'HR@10': '0.0510', 'NDCG@10': '0.0258', 'HR@20': '0.0815', 'NDCG@20': '0.0334'}
2025-02-28 01:18:43,379 - EarlyStopping counter: 3 out of 10
2025-02-28 01:19:30,437 - {'epoch': 37, 'rec_loss': '7.2103'}
2025-02-28 01:19:49,499 - {'Epoch': 37, 'HR@5': '0.0307', 'NDCG@5': '0.0197', 'HR@10': '0.0513', 'NDCG@10': '0.0263', 'HR@20': '0.0824', 'NDCG@20': '0.0341'}
2025-02-28 01:19:49,501 - EarlyStopping counter: 4 out of 10
2025-02-28 01:20:36,934 - {'epoch': 38, 'rec_loss': '7.1983'}
2025-02-28 01:20:56,385 - {'Epoch': 38, 'HR@5': '0.0312', 'NDCG@5': '0.0198', 'HR@10': '0.0521', 'NDCG@10': '0.0265', 'HR@20': '0.0809', 'NDCG@20': '0.0337'}
2025-02-28 01:20:56,386 - EarlyStopping counter: 5 out of 10
2025-02-28 01:21:45,160 - {'epoch': 39, 'rec_loss': '7.1911'}
2025-02-28 01:22:03,724 - {'Epoch': 39, 'HR@5': '0.0312', 'NDCG@5': '0.0196', 'HR@10': '0.0499', 'NDCG@10': '0.0256', 'HR@20': '0.0819', 'NDCG@20': '0.0336'}
2025-02-28 01:22:03,726 - EarlyStopping counter: 6 out of 10
2025-02-28 01:22:51,877 - {'epoch': 40, 'rec_loss': '7.1961'}
2025-02-28 01:23:09,179 - {'Epoch': 40, 'HR@5': '0.0301', 'NDCG@5': '0.0191', 'HR@10': '0.0504', 'NDCG@10': '0.0256', 'HR@20': '0.0823', 'NDCG@20': '0.0336'}
2025-02-28 01:23:09,180 - EarlyStopping counter: 7 out of 10
2025-02-28 01:23:53,379 - {'epoch': 41, 'rec_loss': '7.1841'}
2025-02-28 01:24:08,439 - {'Epoch': 41, 'HR@5': '0.0307', 'NDCG@5': '0.0192', 'HR@10': '0.0518', 'NDCG@10': '0.0260', 'HR@20': '0.0823', 'NDCG@20': '0.0336'}
2025-02-28 01:24:08,441 - EarlyStopping counter: 8 out of 10
2025-02-28 01:24:53,348 - {'epoch': 42, 'rec_loss': '7.1807'}
2025-02-28 01:25:08,460 - {'Epoch': 42, 'HR@5': '0.0310', 'NDCG@5': '0.0195', 'HR@10': '0.0502', 'NDCG@10': '0.0257', 'HR@20': '0.0816', 'NDCG@20': '0.0335'}
2025-02-28 01:25:08,461 - EarlyStopping counter: 9 out of 10
2025-02-28 01:25:52,988 - {'epoch': 43, 'rec_loss': '7.1782'}
2025-02-28 01:26:07,914 - {'Epoch': 43, 'HR@5': '0.0307', 'NDCG@5': '0.0190', 'HR@10': '0.0513', 'NDCG@10': '0.0256', 'HR@20': '0.0830', 'NDCG@20': '0.0335'}
2025-02-28 01:26:07,916 - EarlyStopping counter: 10 out of 10
2025-02-28 01:26:07,916 - Early stopping
2025-02-28 01:26:07,916 - ---------------Test Score---------------
2025-02-28 01:26:23,134 - {'Epoch': 0, 'HR@5': '0.0287', 'NDCG@5': '0.0180', 'HR@10': '0.0480', 'NDCG@10': '0.0242', 'HR@20': '0.0779', 'NDCG@20': '0.0317'}
2025-02-28 01:26:23,136 - Scale_Yelp
2025-02-28 01:26:23,136 - {'Epoch': 0, 'HR@5': '0.0287', 'NDCG@5': '0.0180', 'HR@10': '0.0480', 'NDCG@10': '0.0242', 'HR@20': '0.0779', 'NDCG@20': '0.0317'}
2025-02-28 10:53:43,087 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 16], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-02-28 10:53:45,892 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-28 10:53:45,897 - Total Parameters: 1437093
2025-02-28 10:54:32,249 - {'epoch': 0, 'rec_loss': '9.5554'}
2025-02-28 10:54:47,886 - {'Epoch': 0, 'HR@5': '0.0083', 'NDCG@5': '0.0055', 'HR@10': '0.0133', 'NDCG@10': '0.0071', 'HR@20': '0.0245', 'NDCG@20': '0.0100'}
2025-02-28 10:54:47,888 - Validation score increased.  Saving model ...
2025-02-28 10:55:33,484 - {'epoch': 1, 'rec_loss': '8.9715'}
2025-02-28 10:55:48,296 - {'Epoch': 1, 'HR@5': '0.0131', 'NDCG@5': '0.0082', 'HR@10': '0.0215', 'NDCG@10': '0.0109', 'HR@20': '0.0370', 'NDCG@20': '0.0148'}
2025-02-28 10:55:48,301 - Validation score increased.  Saving model ...
2025-02-28 10:56:33,162 - {'epoch': 2, 'rec_loss': '8.5631'}
2025-02-28 10:56:47,986 - {'Epoch': 2, 'HR@5': '0.0179', 'NDCG@5': '0.0110', 'HR@10': '0.0304', 'NDCG@10': '0.0150', 'HR@20': '0.0513', 'NDCG@20': '0.0202'}
2025-02-28 10:56:47,987 - Validation score increased.  Saving model ...
2025-02-28 10:57:33,281 - {'epoch': 3, 'rec_loss': '8.2799'}
2025-02-28 10:57:47,582 - {'Epoch': 3, 'HR@5': '0.0207', 'NDCG@5': '0.0124', 'HR@10': '0.0354', 'NDCG@10': '0.0171', 'HR@20': '0.0576', 'NDCG@20': '0.0227'}
2025-02-28 10:57:47,583 - Validation score increased.  Saving model ...
2025-02-28 10:58:39,566 - {'epoch': 4, 'rec_loss': '8.1008'}
2025-02-28 10:58:53,929 - {'Epoch': 4, 'HR@5': '0.0220', 'NDCG@5': '0.0139', 'HR@10': '0.0383', 'NDCG@10': '0.0191', 'HR@20': '0.0651', 'NDCG@20': '0.0259'}
2025-02-28 10:58:53,933 - Validation score increased.  Saving model ...
2025-02-28 10:59:38,818 - {'epoch': 5, 'rec_loss': '7.9679'}
2025-02-28 10:59:53,400 - {'Epoch': 5, 'HR@5': '0.0247', 'NDCG@5': '0.0154', 'HR@10': '0.0425', 'NDCG@10': '0.0211', 'HR@20': '0.0689', 'NDCG@20': '0.0277'}
2025-02-28 10:59:53,402 - Validation score increased.  Saving model ...
2025-02-28 11:00:37,888 - {'epoch': 6, 'rec_loss': '7.8688'}
2025-02-28 11:00:52,606 - {'Epoch': 6, 'HR@5': '0.0248', 'NDCG@5': '0.0156', 'HR@10': '0.0439', 'NDCG@10': '0.0218', 'HR@20': '0.0729', 'NDCG@20': '0.0290'}
2025-02-28 11:00:52,607 - Validation score increased.  Saving model ...
2025-02-28 11:01:36,768 - {'epoch': 7, 'rec_loss': '7.7904'}
2025-02-28 11:01:51,584 - {'Epoch': 7, 'HR@5': '0.0246', 'NDCG@5': '0.0154', 'HR@10': '0.0449', 'NDCG@10': '0.0219', 'HR@20': '0.0751', 'NDCG@20': '0.0295'}
2025-02-28 11:01:51,586 - Validation score increased.  Saving model ...
2025-02-28 11:02:37,138 - {'epoch': 8, 'rec_loss': '7.7215'}
2025-02-28 11:02:51,981 - {'Epoch': 8, 'HR@5': '0.0273', 'NDCG@5': '0.0170', 'HR@10': '0.0460', 'NDCG@10': '0.0230', 'HR@20': '0.0746', 'NDCG@20': '0.0301'}
2025-02-28 11:02:51,982 - Validation score increased.  Saving model ...
2025-02-28 11:03:36,052 - {'epoch': 9, 'rec_loss': '7.6725'}
2025-02-28 11:03:51,906 - {'Epoch': 9, 'HR@5': '0.0281', 'NDCG@5': '0.0174', 'HR@10': '0.0472', 'NDCG@10': '0.0235', 'HR@20': '0.0765', 'NDCG@20': '0.0309'}
2025-02-28 11:03:51,908 - Validation score increased.  Saving model ...
2025-02-28 11:04:37,386 - {'epoch': 10, 'rec_loss': '7.6242'}
2025-02-28 11:04:52,290 - {'Epoch': 10, 'HR@5': '0.0278', 'NDCG@5': '0.0177', 'HR@10': '0.0471', 'NDCG@10': '0.0239', 'HR@20': '0.0787', 'NDCG@20': '0.0319'}
2025-02-28 11:04:52,295 - Validation score increased.  Saving model ...
2025-02-28 11:05:38,510 - {'epoch': 11, 'rec_loss': '7.5857'}
2025-02-28 11:05:53,388 - {'Epoch': 11, 'HR@5': '0.0287', 'NDCG@5': '0.0178', 'HR@10': '0.0494', 'NDCG@10': '0.0245', 'HR@20': '0.0796', 'NDCG@20': '0.0320'}
2025-02-28 11:05:53,392 - Validation score increased.  Saving model ...
2025-02-28 11:06:40,934 - {'epoch': 12, 'rec_loss': '7.5531'}
2025-02-28 11:06:55,855 - {'Epoch': 12, 'HR@5': '0.0296', 'NDCG@5': '0.0185', 'HR@10': '0.0496', 'NDCG@10': '0.0249', 'HR@20': '0.0788', 'NDCG@20': '0.0323'}
2025-02-28 11:06:55,860 - Validation score increased.  Saving model ...
2025-02-28 11:07:41,101 - {'epoch': 13, 'rec_loss': '7.5199'}
2025-02-28 11:07:55,993 - {'Epoch': 13, 'HR@5': '0.0298', 'NDCG@5': '0.0186', 'HR@10': '0.0499', 'NDCG@10': '0.0251', 'HR@20': '0.0791', 'NDCG@20': '0.0324'}
2025-02-28 11:07:55,994 - Validation score increased.  Saving model ...
2025-02-28 11:08:44,187 - {'epoch': 14, 'rec_loss': '7.4924'}
2025-02-28 11:09:00,086 - {'Epoch': 14, 'HR@5': '0.0290', 'NDCG@5': '0.0185', 'HR@10': '0.0489', 'NDCG@10': '0.0249', 'HR@20': '0.0807', 'NDCG@20': '0.0329'}
2025-02-28 11:09:00,087 - Validation score increased.  Saving model ...
2025-02-28 11:09:46,224 - {'epoch': 15, 'rec_loss': '7.4684'}
2025-02-28 11:10:01,222 - {'Epoch': 15, 'HR@5': '0.0305', 'NDCG@5': '0.0187', 'HR@10': '0.0498', 'NDCG@10': '0.0249', 'HR@20': '0.0807', 'NDCG@20': '0.0326'}
2025-02-28 11:10:01,224 - EarlyStopping counter: 1 out of 10
2025-02-28 11:10:48,283 - {'epoch': 16, 'rec_loss': '7.4452'}
2025-02-28 11:11:03,264 - {'Epoch': 16, 'HR@5': '0.0307', 'NDCG@5': '0.0188', 'HR@10': '0.0506', 'NDCG@10': '0.0251', 'HR@20': '0.0816', 'NDCG@20': '0.0329'}
2025-02-28 11:11:03,266 - EarlyStopping counter: 2 out of 10
2025-02-28 11:11:50,441 - {'epoch': 17, 'rec_loss': '7.4239'}
2025-02-28 11:12:05,529 - {'Epoch': 17, 'HR@5': '0.0313', 'NDCG@5': '0.0194', 'HR@10': '0.0509', 'NDCG@10': '0.0257', 'HR@20': '0.0816', 'NDCG@20': '0.0334'}
2025-02-28 11:12:05,531 - Validation score increased.  Saving model ...
2025-02-28 11:12:54,203 - {'epoch': 18, 'rec_loss': '7.4007'}
2025-02-28 11:13:09,270 - {'Epoch': 18, 'HR@5': '0.0301', 'NDCG@5': '0.0190', 'HR@10': '0.0498', 'NDCG@10': '0.0253', 'HR@20': '0.0818', 'NDCG@20': '0.0334'}
2025-02-28 11:13:09,271 - EarlyStopping counter: 1 out of 10
2025-02-28 11:13:55,014 - {'epoch': 19, 'rec_loss': '7.3854'}
2025-02-28 11:14:09,922 - {'Epoch': 19, 'HR@5': '0.0308', 'NDCG@5': '0.0192', 'HR@10': '0.0508', 'NDCG@10': '0.0256', 'HR@20': '0.0825', 'NDCG@20': '0.0336'}
2025-02-28 11:14:09,923 - Validation score increased.  Saving model ...
2025-02-28 11:14:55,491 - {'epoch': 20, 'rec_loss': '7.3698'}
2025-02-28 11:15:10,425 - {'Epoch': 20, 'HR@5': '0.0304', 'NDCG@5': '0.0191', 'HR@10': '0.0508', 'NDCG@10': '0.0256', 'HR@20': '0.0822', 'NDCG@20': '0.0335'}
2025-02-28 11:15:10,427 - EarlyStopping counter: 1 out of 10
2025-02-28 11:15:56,085 - {'epoch': 21, 'rec_loss': '7.3600'}
2025-02-28 11:16:11,238 - {'Epoch': 21, 'HR@5': '0.0300', 'NDCG@5': '0.0190', 'HR@10': '0.0514', 'NDCG@10': '0.0258', 'HR@20': '0.0831', 'NDCG@20': '0.0338'}
2025-02-28 11:16:11,242 - Validation score increased.  Saving model ...
2025-02-28 11:16:55,624 - {'epoch': 22, 'rec_loss': '7.3448'}
2025-02-28 11:17:10,572 - {'Epoch': 22, 'HR@5': '0.0302', 'NDCG@5': '0.0187', 'HR@10': '0.0509', 'NDCG@10': '0.0253', 'HR@20': '0.0824', 'NDCG@20': '0.0332'}
2025-02-28 11:17:10,574 - EarlyStopping counter: 1 out of 10
2025-02-28 11:17:55,180 - {'epoch': 23, 'rec_loss': '7.3248'}
2025-02-28 11:18:10,311 - {'Epoch': 23, 'HR@5': '0.0316', 'NDCG@5': '0.0194', 'HR@10': '0.0515', 'NDCG@10': '0.0258', 'HR@20': '0.0845', 'NDCG@20': '0.0340'}
2025-02-28 11:18:10,313 - Validation score increased.  Saving model ...
2025-02-28 11:18:54,334 - {'epoch': 24, 'rec_loss': '7.3160'}
2025-02-28 11:19:09,449 - {'Epoch': 24, 'HR@5': '0.0317', 'NDCG@5': '0.0198', 'HR@10': '0.0522', 'NDCG@10': '0.0263', 'HR@20': '0.0828', 'NDCG@20': '0.0340'}
2025-02-28 11:19:09,451 - EarlyStopping counter: 1 out of 10
2025-02-28 11:19:57,821 - {'epoch': 25, 'rec_loss': '7.3021'}
2025-02-28 11:20:12,742 - {'Epoch': 25, 'HR@5': '0.0308', 'NDCG@5': '0.0195', 'HR@10': '0.0509', 'NDCG@10': '0.0260', 'HR@20': '0.0826', 'NDCG@20': '0.0339'}
2025-02-28 11:20:12,745 - EarlyStopping counter: 2 out of 10
2025-02-28 11:20:58,145 - {'epoch': 26, 'rec_loss': '7.2933'}
2025-02-28 11:21:13,126 - {'Epoch': 26, 'HR@5': '0.0309', 'NDCG@5': '0.0194', 'HR@10': '0.0511', 'NDCG@10': '0.0259', 'HR@20': '0.0827', 'NDCG@20': '0.0338'}
2025-02-28 11:21:13,127 - EarlyStopping counter: 3 out of 10
2025-02-28 11:22:01,363 - {'epoch': 27, 'rec_loss': '7.2831'}
2025-02-28 11:22:16,398 - {'Epoch': 27, 'HR@5': '0.0310', 'NDCG@5': '0.0194', 'HR@10': '0.0514', 'NDCG@10': '0.0260', 'HR@20': '0.0818', 'NDCG@20': '0.0336'}
2025-02-28 11:22:16,403 - EarlyStopping counter: 4 out of 10
2025-02-28 11:23:01,379 - {'epoch': 28, 'rec_loss': '7.2725'}
2025-02-28 11:23:16,517 - {'Epoch': 28, 'HR@5': '0.0318', 'NDCG@5': '0.0199', 'HR@10': '0.0509', 'NDCG@10': '0.0260', 'HR@20': '0.0821', 'NDCG@20': '0.0339'}
2025-02-28 11:23:16,519 - EarlyStopping counter: 5 out of 10
2025-02-28 11:24:03,654 - {'epoch': 29, 'rec_loss': '7.2638'}
2025-02-28 11:24:18,859 - {'Epoch': 29, 'HR@5': '0.0309', 'NDCG@5': '0.0195', 'HR@10': '0.0508', 'NDCG@10': '0.0259', 'HR@20': '0.0816', 'NDCG@20': '0.0336'}
2025-02-28 11:24:18,860 - EarlyStopping counter: 6 out of 10
2025-02-28 11:25:05,054 - {'epoch': 30, 'rec_loss': '7.2544'}
2025-02-28 11:25:20,096 - {'Epoch': 30, 'HR@5': '0.0318', 'NDCG@5': '0.0203', 'HR@10': '0.0521', 'NDCG@10': '0.0268', 'HR@20': '0.0828', 'NDCG@20': '0.0345'}
2025-02-28 11:25:20,098 - Validation score increased.  Saving model ...
2025-02-28 11:26:06,960 - {'epoch': 31, 'rec_loss': '7.2439'}
2025-02-28 11:26:22,088 - {'Epoch': 31, 'HR@5': '0.0308', 'NDCG@5': '0.0194', 'HR@10': '0.0510', 'NDCG@10': '0.0259', 'HR@20': '0.0836', 'NDCG@20': '0.0341'}
2025-02-28 11:26:22,090 - EarlyStopping counter: 1 out of 10
2025-02-28 11:27:07,552 - {'epoch': 32, 'rec_loss': '7.2368'}
2025-02-28 11:27:22,746 - {'Epoch': 32, 'HR@5': '0.0303', 'NDCG@5': '0.0189', 'HR@10': '0.0522', 'NDCG@10': '0.0259', 'HR@20': '0.0822', 'NDCG@20': '0.0335'}
2025-02-28 11:27:22,751 - EarlyStopping counter: 2 out of 10
2025-02-28 11:28:09,679 - {'epoch': 33, 'rec_loss': '7.2315'}
2025-02-28 11:28:25,762 - {'Epoch': 33, 'HR@5': '0.0324', 'NDCG@5': '0.0203', 'HR@10': '0.0531', 'NDCG@10': '0.0269', 'HR@20': '0.0845', 'NDCG@20': '0.0348'}
2025-02-28 11:28:25,763 - Validation score increased.  Saving model ...
2025-02-28 11:29:14,646 - {'epoch': 34, 'rec_loss': '7.2248'}
2025-02-28 11:29:29,715 - {'Epoch': 34, 'HR@5': '0.0317', 'NDCG@5': '0.0195', 'HR@10': '0.0517', 'NDCG@10': '0.0259', 'HR@20': '0.0826', 'NDCG@20': '0.0337'}
2025-02-28 11:29:29,716 - EarlyStopping counter: 1 out of 10
2025-02-28 11:30:19,265 - {'epoch': 35, 'rec_loss': '7.2189'}
2025-02-28 11:30:34,353 - {'Epoch': 35, 'HR@5': '0.0302', 'NDCG@5': '0.0186', 'HR@10': '0.0500', 'NDCG@10': '0.0250', 'HR@20': '0.0814', 'NDCG@20': '0.0329'}
2025-02-28 11:30:34,354 - EarlyStopping counter: 2 out of 10
2025-02-28 11:31:20,475 - {'epoch': 36, 'rec_loss': '7.2118'}
2025-02-28 11:31:35,705 - {'Epoch': 36, 'HR@5': '0.0306', 'NDCG@5': '0.0191', 'HR@10': '0.0511', 'NDCG@10': '0.0257', 'HR@20': '0.0819', 'NDCG@20': '0.0334'}
2025-02-28 11:31:35,707 - EarlyStopping counter: 3 out of 10
2025-02-28 11:32:20,284 - {'epoch': 37, 'rec_loss': '7.2048'}
2025-02-28 11:32:35,394 - {'Epoch': 37, 'HR@5': '0.0310', 'NDCG@5': '0.0198', 'HR@10': '0.0516', 'NDCG@10': '0.0263', 'HR@20': '0.0825', 'NDCG@20': '0.0341'}
2025-02-28 11:32:35,396 - EarlyStopping counter: 4 out of 10
2025-02-28 11:33:19,827 - {'epoch': 38, 'rec_loss': '7.1923'}
2025-02-28 11:33:34,879 - {'Epoch': 38, 'HR@5': '0.0314', 'NDCG@5': '0.0198', 'HR@10': '0.0508', 'NDCG@10': '0.0260', 'HR@20': '0.0821', 'NDCG@20': '0.0339'}
2025-02-28 11:33:34,880 - EarlyStopping counter: 5 out of 10
2025-02-28 11:34:19,886 - {'epoch': 39, 'rec_loss': '7.1851'}
2025-02-28 11:34:34,739 - {'Epoch': 39, 'HR@5': '0.0312', 'NDCG@5': '0.0199', 'HR@10': '0.0503', 'NDCG@10': '0.0261', 'HR@20': '0.0828', 'NDCG@20': '0.0342'}
2025-02-28 11:34:34,741 - EarlyStopping counter: 6 out of 10
2025-02-28 11:35:20,106 - {'epoch': 40, 'rec_loss': '7.1886'}
2025-02-28 11:35:35,205 - {'Epoch': 40, 'HR@5': '0.0302', 'NDCG@5': '0.0190', 'HR@10': '0.0507', 'NDCG@10': '0.0256', 'HR@20': '0.0818', 'NDCG@20': '0.0334'}
2025-02-28 11:35:35,210 - EarlyStopping counter: 7 out of 10
2025-02-28 11:36:20,682 - {'epoch': 41, 'rec_loss': '7.1777'}
2025-02-28 11:36:35,722 - {'Epoch': 41, 'HR@5': '0.0309', 'NDCG@5': '0.0193', 'HR@10': '0.0506', 'NDCG@10': '0.0256', 'HR@20': '0.0825', 'NDCG@20': '0.0336'}
2025-02-28 11:36:35,724 - EarlyStopping counter: 8 out of 10
2025-02-28 11:37:20,842 - {'epoch': 42, 'rec_loss': '7.1735'}
2025-02-28 11:37:36,015 - {'Epoch': 42, 'HR@5': '0.0308', 'NDCG@5': '0.0197', 'HR@10': '0.0499', 'NDCG@10': '0.0259', 'HR@20': '0.0809', 'NDCG@20': '0.0336'}
2025-02-28 11:37:36,016 - EarlyStopping counter: 9 out of 10
2025-02-28 11:38:20,162 - {'epoch': 43, 'rec_loss': '7.1699'}
2025-02-28 11:38:35,334 - {'Epoch': 43, 'HR@5': '0.0307', 'NDCG@5': '0.0193', 'HR@10': '0.0513', 'NDCG@10': '0.0259', 'HR@20': '0.0826', 'NDCG@20': '0.0337'}
2025-02-28 11:38:35,339 - EarlyStopping counter: 10 out of 10
2025-02-28 11:38:35,339 - Early stopping
2025-02-28 11:38:35,339 - ---------------Test Score---------------
2025-02-28 11:38:50,354 - {'Epoch': 0, 'HR@5': '0.0288', 'NDCG@5': '0.0179', 'HR@10': '0.0490', 'NDCG@10': '0.0244', 'HR@20': '0.0785', 'NDCG@20': '0.0318'}
2025-02-28 11:38:50,359 - Scale_Yelp
2025-02-28 11:38:50,359 - {'Epoch': 0, 'HR@5': '0.0288', 'NDCG@5': '0.0179', 'HR@10': '0.0490', 'NDCG@10': '0.0244', 'HR@20': '0.0785', 'NDCG@20': '0.0318'}
2025-02-28 13:16:26,524 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 24], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-02-28 13:16:29,353 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-28 13:16:29,360 - Total Parameters: 1437093
2025-02-28 13:17:15,827 - {'epoch': 0, 'rec_loss': '9.5560'}
2025-02-28 13:17:31,652 - {'Epoch': 0, 'HR@5': '0.0081', 'NDCG@5': '0.0054', 'HR@10': '0.0131', 'NDCG@10': '0.0070', 'HR@20': '0.0250', 'NDCG@20': '0.0100'}
2025-02-28 13:17:31,654 - Validation score increased.  Saving model ...
2025-02-28 13:18:16,090 - {'epoch': 1, 'rec_loss': '8.9719'}
2025-02-28 13:18:30,935 - {'Epoch': 1, 'HR@5': '0.0130', 'NDCG@5': '0.0081', 'HR@10': '0.0218', 'NDCG@10': '0.0110', 'HR@20': '0.0375', 'NDCG@20': '0.0149'}
2025-02-28 13:18:30,937 - Validation score increased.  Saving model ...
2025-02-28 13:19:16,549 - {'epoch': 2, 'rec_loss': '8.5604'}
2025-02-28 13:19:31,017 - {'Epoch': 2, 'HR@5': '0.0178', 'NDCG@5': '0.0109', 'HR@10': '0.0305', 'NDCG@10': '0.0150', 'HR@20': '0.0514', 'NDCG@20': '0.0203'}
2025-02-28 13:19:31,019 - Validation score increased.  Saving model ...
2025-02-28 13:20:18,518 - {'epoch': 3, 'rec_loss': '8.2777'}
2025-02-28 13:20:33,142 - {'Epoch': 3, 'HR@5': '0.0209', 'NDCG@5': '0.0125', 'HR@10': '0.0354', 'NDCG@10': '0.0171', 'HR@20': '0.0580', 'NDCG@20': '0.0228'}
2025-02-28 13:20:33,143 - Validation score increased.  Saving model ...
2025-02-28 13:21:22,841 - {'epoch': 4, 'rec_loss': '8.0991'}
2025-02-28 13:21:36,310 - {'Epoch': 4, 'HR@5': '0.0222', 'NDCG@5': '0.0139', 'HR@10': '0.0385', 'NDCG@10': '0.0192', 'HR@20': '0.0662', 'NDCG@20': '0.0261'}
2025-02-28 13:21:36,317 - Validation score increased.  Saving model ...
2025-02-28 13:22:21,997 - {'epoch': 5, 'rec_loss': '7.9667'}
2025-02-28 13:22:37,079 - {'Epoch': 5, 'HR@5': '0.0247', 'NDCG@5': '0.0155', 'HR@10': '0.0424', 'NDCG@10': '0.0211', 'HR@20': '0.0691', 'NDCG@20': '0.0278'}
2025-02-28 13:22:37,082 - Validation score increased.  Saving model ...
2025-02-28 13:23:26,707 - {'epoch': 6, 'rec_loss': '7.8675'}
2025-02-28 13:23:41,427 - {'Epoch': 6, 'HR@5': '0.0251', 'NDCG@5': '0.0158', 'HR@10': '0.0434', 'NDCG@10': '0.0217', 'HR@20': '0.0729', 'NDCG@20': '0.0291'}
2025-02-28 13:23:41,429 - Validation score increased.  Saving model ...
2025-02-28 13:24:27,088 - {'epoch': 7, 'rec_loss': '7.7894'}
2025-02-28 13:24:41,787 - {'Epoch': 7, 'HR@5': '0.0253', 'NDCG@5': '0.0158', 'HR@10': '0.0445', 'NDCG@10': '0.0219', 'HR@20': '0.0747', 'NDCG@20': '0.0295'}
2025-02-28 13:24:41,788 - Validation score increased.  Saving model ...
2025-02-28 13:25:28,537 - {'epoch': 8, 'rec_loss': '7.7212'}
2025-02-28 13:25:43,615 - {'Epoch': 8, 'HR@5': '0.0274', 'NDCG@5': '0.0169', 'HR@10': '0.0458', 'NDCG@10': '0.0229', 'HR@20': '0.0746', 'NDCG@20': '0.0301'}
2025-02-28 13:25:43,619 - Validation score increased.  Saving model ...
2025-02-28 13:26:29,609 - {'epoch': 9, 'rec_loss': '7.6723'}
2025-02-28 13:26:44,469 - {'Epoch': 9, 'HR@5': '0.0284', 'NDCG@5': '0.0174', 'HR@10': '0.0476', 'NDCG@10': '0.0236', 'HR@20': '0.0765', 'NDCG@20': '0.0309'}
2025-02-28 13:26:44,476 - Validation score increased.  Saving model ...
2025-02-28 13:27:30,828 - {'epoch': 10, 'rec_loss': '7.6244'}
2025-02-28 13:27:45,537 - {'Epoch': 10, 'HR@5': '0.0275', 'NDCG@5': '0.0175', 'HR@10': '0.0471', 'NDCG@10': '0.0238', 'HR@20': '0.0784', 'NDCG@20': '0.0317'}
2025-02-28 13:27:45,541 - Validation score increased.  Saving model ...
2025-02-28 13:28:32,092 - {'epoch': 11, 'rec_loss': '7.5861'}
2025-02-28 13:28:46,845 - {'Epoch': 11, 'HR@5': '0.0290', 'NDCG@5': '0.0179', 'HR@10': '0.0496', 'NDCG@10': '0.0245', 'HR@20': '0.0793', 'NDCG@20': '0.0319'}
2025-02-28 13:28:46,850 - Validation score increased.  Saving model ...
2025-02-28 13:29:32,662 - {'epoch': 12, 'rec_loss': '7.5543'}
2025-02-28 13:29:47,562 - {'Epoch': 12, 'HR@5': '0.0300', 'NDCG@5': '0.0186', 'HR@10': '0.0494', 'NDCG@10': '0.0248', 'HR@20': '0.0794', 'NDCG@20': '0.0323'}
2025-02-28 13:29:47,563 - Validation score increased.  Saving model ...
2025-02-28 13:30:33,064 - {'epoch': 13, 'rec_loss': '7.5227'}
2025-02-28 13:30:47,274 - {'Epoch': 13, 'HR@5': '0.0296', 'NDCG@5': '0.0184', 'HR@10': '0.0503', 'NDCG@10': '0.0251', 'HR@20': '0.0790', 'NDCG@20': '0.0323'}
2025-02-28 13:30:47,281 - EarlyStopping counter: 1 out of 10
2025-02-28 13:31:32,035 - {'epoch': 14, 'rec_loss': '7.4959'}
2025-02-28 13:31:46,873 - {'Epoch': 14, 'HR@5': '0.0294', 'NDCG@5': '0.0186', 'HR@10': '0.0489', 'NDCG@10': '0.0249', 'HR@20': '0.0804', 'NDCG@20': '0.0328'}
2025-02-28 13:31:46,875 - Validation score increased.  Saving model ...
2025-02-28 13:32:35,893 - {'epoch': 15, 'rec_loss': '7.4724'}
2025-02-28 13:32:51,332 - {'Epoch': 15, 'HR@5': '0.0304', 'NDCG@5': '0.0185', 'HR@10': '0.0499', 'NDCG@10': '0.0248', 'HR@20': '0.0802', 'NDCG@20': '0.0324'}
2025-02-28 13:32:51,337 - EarlyStopping counter: 1 out of 10
2025-02-28 13:33:36,860 - {'epoch': 16, 'rec_loss': '7.4487'}
2025-02-28 13:33:51,642 - {'Epoch': 16, 'HR@5': '0.0306', 'NDCG@5': '0.0188', 'HR@10': '0.0501', 'NDCG@10': '0.0251', 'HR@20': '0.0812', 'NDCG@20': '0.0329'}
2025-02-28 13:33:51,648 - Validation score increased.  Saving model ...
2025-02-28 13:34:37,470 - {'epoch': 17, 'rec_loss': '7.4273'}
2025-02-28 13:34:52,384 - {'Epoch': 17, 'HR@5': '0.0310', 'NDCG@5': '0.0193', 'HR@10': '0.0508', 'NDCG@10': '0.0256', 'HR@20': '0.0821', 'NDCG@20': '0.0335'}
2025-02-28 13:34:52,385 - Validation score increased.  Saving model ...
2025-02-28 13:35:37,589 - {'epoch': 18, 'rec_loss': '7.4036'}
2025-02-28 13:35:52,185 - {'Epoch': 18, 'HR@5': '0.0300', 'NDCG@5': '0.0190', 'HR@10': '0.0500', 'NDCG@10': '0.0254', 'HR@20': '0.0817', 'NDCG@20': '0.0334'}
2025-02-28 13:35:52,190 - EarlyStopping counter: 1 out of 10
2025-02-28 13:36:37,950 - {'epoch': 19, 'rec_loss': '7.3881'}
2025-02-28 13:36:52,914 - {'Epoch': 19, 'HR@5': '0.0304', 'NDCG@5': '0.0190', 'HR@10': '0.0508', 'NDCG@10': '0.0255', 'HR@20': '0.0823', 'NDCG@20': '0.0334'}
2025-02-28 13:36:52,916 - EarlyStopping counter: 2 out of 10
2025-02-28 13:37:39,648 - {'epoch': 20, 'rec_loss': '7.3718'}
2025-02-28 13:37:54,777 - {'Epoch': 20, 'HR@5': '0.0301', 'NDCG@5': '0.0190', 'HR@10': '0.0506', 'NDCG@10': '0.0256', 'HR@20': '0.0824', 'NDCG@20': '0.0336'}
2025-02-28 13:37:54,778 - Validation score increased.  Saving model ...
2025-02-28 13:38:43,625 - {'epoch': 21, 'rec_loss': '7.3619'}
2025-02-28 13:38:58,633 - {'Epoch': 21, 'HR@5': '0.0298', 'NDCG@5': '0.0190', 'HR@10': '0.0514', 'NDCG@10': '0.0259', 'HR@20': '0.0821', 'NDCG@20': '0.0336'}
2025-02-28 13:38:58,638 - Validation score increased.  Saving model ...
2025-02-28 13:39:44,415 - {'epoch': 22, 'rec_loss': '7.3466'}
2025-02-28 13:39:59,149 - {'Epoch': 22, 'HR@5': '0.0296', 'NDCG@5': '0.0184', 'HR@10': '0.0511', 'NDCG@10': '0.0253', 'HR@20': '0.0825', 'NDCG@20': '0.0332'}
2025-02-28 13:39:59,150 - EarlyStopping counter: 1 out of 10
2025-02-28 13:40:44,533 - {'epoch': 23, 'rec_loss': '7.3271'}
2025-02-28 13:40:59,602 - {'Epoch': 23, 'HR@5': '0.0316', 'NDCG@5': '0.0194', 'HR@10': '0.0516', 'NDCG@10': '0.0258', 'HR@20': '0.0843', 'NDCG@20': '0.0339'}
2025-02-28 13:40:59,606 - Validation score increased.  Saving model ...
2025-02-28 13:41:44,494 - {'epoch': 24, 'rec_loss': '7.3175'}
2025-02-28 13:41:59,198 - {'Epoch': 24, 'HR@5': '0.0320', 'NDCG@5': '0.0200', 'HR@10': '0.0520', 'NDCG@10': '0.0264', 'HR@20': '0.0829', 'NDCG@20': '0.0342'}
2025-02-28 13:41:59,199 - Validation score increased.  Saving model ...
2025-02-28 13:42:44,973 - {'epoch': 25, 'rec_loss': '7.3038'}
2025-02-28 13:43:00,171 - {'Epoch': 25, 'HR@5': '0.0307', 'NDCG@5': '0.0194', 'HR@10': '0.0504', 'NDCG@10': '0.0258', 'HR@20': '0.0826', 'NDCG@20': '0.0339'}
2025-02-28 13:43:00,173 - EarlyStopping counter: 1 out of 10
2025-02-28 13:43:48,288 - {'epoch': 26, 'rec_loss': '7.2953'}
2025-02-28 13:44:02,526 - {'Epoch': 26, 'HR@5': '0.0305', 'NDCG@5': '0.0193', 'HR@10': '0.0518', 'NDCG@10': '0.0261', 'HR@20': '0.0815', 'NDCG@20': '0.0336'}
2025-02-28 13:44:02,534 - EarlyStopping counter: 2 out of 10
2025-02-28 13:44:48,191 - {'epoch': 27, 'rec_loss': '7.2839'}
2025-02-28 13:45:03,277 - {'Epoch': 27, 'HR@5': '0.0313', 'NDCG@5': '0.0196', 'HR@10': '0.0521', 'NDCG@10': '0.0263', 'HR@20': '0.0825', 'NDCG@20': '0.0339'}
2025-02-28 13:45:03,279 - EarlyStopping counter: 3 out of 10
2025-02-28 13:45:48,362 - {'epoch': 28, 'rec_loss': '7.2747'}
2025-02-28 13:46:03,849 - {'Epoch': 28, 'HR@5': '0.0318', 'NDCG@5': '0.0199', 'HR@10': '0.0510', 'NDCG@10': '0.0260', 'HR@20': '0.0823', 'NDCG@20': '0.0339'}
2025-02-28 13:46:03,851 - EarlyStopping counter: 4 out of 10
2025-02-28 13:46:52,112 - {'epoch': 29, 'rec_loss': '7.2656'}
2025-02-28 13:47:07,585 - {'Epoch': 29, 'HR@5': '0.0309', 'NDCG@5': '0.0194', 'HR@10': '0.0513', 'NDCG@10': '0.0259', 'HR@20': '0.0814', 'NDCG@20': '0.0335'}
2025-02-28 13:47:07,586 - EarlyStopping counter: 5 out of 10
2025-02-28 13:47:53,619 - {'epoch': 30, 'rec_loss': '7.2559'}
2025-02-28 13:48:08,762 - {'Epoch': 30, 'HR@5': '0.0319', 'NDCG@5': '0.0203', 'HR@10': '0.0519', 'NDCG@10': '0.0266', 'HR@20': '0.0830', 'NDCG@20': '0.0345'}
2025-02-28 13:48:08,763 - Validation score increased.  Saving model ...
2025-02-28 13:48:55,289 - {'epoch': 31, 'rec_loss': '7.2461'}
2025-02-28 13:49:09,720 - {'Epoch': 31, 'HR@5': '0.0308', 'NDCG@5': '0.0193', 'HR@10': '0.0518', 'NDCG@10': '0.0261', 'HR@20': '0.0835', 'NDCG@20': '0.0341'}
2025-02-28 13:49:09,729 - EarlyStopping counter: 1 out of 10
2025-02-28 13:50:00,395 - {'epoch': 32, 'rec_loss': '7.2394'}
2025-02-28 13:50:16,109 - {'Epoch': 32, 'HR@5': '0.0304', 'NDCG@5': '0.0190', 'HR@10': '0.0522', 'NDCG@10': '0.0260', 'HR@20': '0.0826', 'NDCG@20': '0.0336'}
2025-02-28 13:50:16,110 - EarlyStopping counter: 2 out of 10
2025-02-28 13:51:01,843 - {'epoch': 33, 'rec_loss': '7.2331'}
2025-02-28 13:51:16,784 - {'Epoch': 33, 'HR@5': '0.0318', 'NDCG@5': '0.0200', 'HR@10': '0.0530', 'NDCG@10': '0.0269', 'HR@20': '0.0851', 'NDCG@20': '0.0349'}
2025-02-28 13:51:16,786 - Validation score increased.  Saving model ...
2025-02-28 13:52:03,805 - {'epoch': 34, 'rec_loss': '7.2256'}
2025-02-28 13:52:19,569 - {'Epoch': 34, 'HR@5': '0.0318', 'NDCG@5': '0.0196', 'HR@10': '0.0517', 'NDCG@10': '0.0260', 'HR@20': '0.0831', 'NDCG@20': '0.0339'}
2025-02-28 13:52:19,571 - EarlyStopping counter: 1 out of 10
2025-02-28 13:53:05,017 - {'epoch': 35, 'rec_loss': '7.2216'}
2025-02-28 13:53:19,995 - {'Epoch': 35, 'HR@5': '0.0303', 'NDCG@5': '0.0187', 'HR@10': '0.0511', 'NDCG@10': '0.0253', 'HR@20': '0.0814', 'NDCG@20': '0.0329'}
2025-02-28 13:53:19,996 - EarlyStopping counter: 2 out of 10
2025-02-28 13:54:04,289 - {'epoch': 36, 'rec_loss': '7.2136'}
2025-02-28 13:54:19,668 - {'Epoch': 36, 'HR@5': '0.0308', 'NDCG@5': '0.0192', 'HR@10': '0.0518', 'NDCG@10': '0.0259', 'HR@20': '0.0813', 'NDCG@20': '0.0333'}
2025-02-28 13:54:19,674 - EarlyStopping counter: 3 out of 10
2025-02-28 13:55:11,615 - {'epoch': 37, 'rec_loss': '7.2062'}
2025-02-28 13:55:26,835 - {'Epoch': 37, 'HR@5': '0.0305', 'NDCG@5': '0.0194', 'HR@10': '0.0515', 'NDCG@10': '0.0262', 'HR@20': '0.0828', 'NDCG@20': '0.0340'}
2025-02-28 13:55:26,840 - EarlyStopping counter: 4 out of 10
2025-02-28 13:56:12,505 - {'epoch': 38, 'rec_loss': '7.1945'}
2025-02-28 13:56:27,309 - {'Epoch': 38, 'HR@5': '0.0315', 'NDCG@5': '0.0200', 'HR@10': '0.0517', 'NDCG@10': '0.0265', 'HR@20': '0.0824', 'NDCG@20': '0.0341'}
2025-02-28 13:56:27,313 - EarlyStopping counter: 5 out of 10
2025-02-28 13:57:11,873 - {'epoch': 39, 'rec_loss': '7.1874'}
2025-02-28 13:57:26,765 - {'Epoch': 39, 'HR@5': '0.0308', 'NDCG@5': '0.0196', 'HR@10': '0.0504', 'NDCG@10': '0.0259', 'HR@20': '0.0830', 'NDCG@20': '0.0340'}
2025-02-28 13:57:26,766 - EarlyStopping counter: 6 out of 10
2025-02-28 13:58:12,089 - {'epoch': 40, 'rec_loss': '7.1919'}
2025-02-28 13:58:27,072 - {'Epoch': 40, 'HR@5': '0.0304', 'NDCG@5': '0.0193', 'HR@10': '0.0514', 'NDCG@10': '0.0260', 'HR@20': '0.0828', 'NDCG@20': '0.0338'}
2025-02-28 13:58:27,074 - EarlyStopping counter: 7 out of 10
2025-02-28 13:59:11,952 - {'epoch': 41, 'rec_loss': '7.1809'}
2025-02-28 13:59:27,006 - {'Epoch': 41, 'HR@5': '0.0315', 'NDCG@5': '0.0195', 'HR@10': '0.0518', 'NDCG@10': '0.0260', 'HR@20': '0.0833', 'NDCG@20': '0.0339'}
2025-02-28 13:59:27,009 - EarlyStopping counter: 8 out of 10
2025-02-28 14:00:12,502 - {'epoch': 42, 'rec_loss': '7.1764'}
2025-02-28 14:00:27,926 - {'Epoch': 42, 'HR@5': '0.0309', 'NDCG@5': '0.0197', 'HR@10': '0.0506', 'NDCG@10': '0.0260', 'HR@20': '0.0811', 'NDCG@20': '0.0336'}
2025-02-28 14:00:27,928 - EarlyStopping counter: 9 out of 10
2025-02-28 14:01:17,234 - {'epoch': 43, 'rec_loss': '7.1733'}
2025-02-28 14:01:32,250 - {'Epoch': 43, 'HR@5': '0.0307', 'NDCG@5': '0.0193', 'HR@10': '0.0509', 'NDCG@10': '0.0258', 'HR@20': '0.0824', 'NDCG@20': '0.0337'}
2025-02-28 14:01:32,255 - EarlyStopping counter: 10 out of 10
2025-02-28 14:01:32,256 - Early stopping
2025-02-28 14:01:32,256 - ---------------Test Score---------------
2025-02-28 14:01:47,234 - {'Epoch': 0, 'HR@5': '0.0290', 'NDCG@5': '0.0180', 'HR@10': '0.0497', 'NDCG@10': '0.0246', 'HR@20': '0.0779', 'NDCG@20': '0.0316'}
2025-02-28 14:01:47,238 - Scale_Yelp
2025-02-28 14:01:47,238 - {'Epoch': 0, 'HR@5': '0.0290', 'NDCG@5': '0.0180', 'HR@10': '0.0497', 'NDCG@10': '0.0246', 'HR@20': '0.0779', 'NDCG@20': '0.0316'}
2025-02-28 15:03:49,576 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 12, 24], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-02-28 15:03:52,376 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-28 15:03:52,381 - Total Parameters: 1437093
2025-02-28 15:04:40,302 - {'epoch': 0, 'rec_loss': '9.5641'}
2025-02-28 15:04:57,347 - {'Epoch': 0, 'HR@5': '0.0081', 'NDCG@5': '0.0053', 'HR@10': '0.0137', 'NDCG@10': '0.0071', 'HR@20': '0.0244', 'NDCG@20': '0.0098'}
2025-02-28 15:04:57,349 - Validation score increased.  Saving model ...
2025-02-28 15:05:43,190 - {'epoch': 1, 'rec_loss': '8.9924'}
2025-02-28 15:05:58,563 - {'Epoch': 1, 'HR@5': '0.0126', 'NDCG@5': '0.0079', 'HR@10': '0.0210', 'NDCG@10': '0.0106', 'HR@20': '0.0359', 'NDCG@20': '0.0144'}
2025-02-28 15:05:58,568 - Validation score increased.  Saving model ...
2025-02-28 15:06:44,697 - {'epoch': 2, 'rec_loss': '8.5723'}
2025-02-28 15:07:01,731 - {'Epoch': 2, 'HR@5': '0.0178', 'NDCG@5': '0.0110', 'HR@10': '0.0303', 'NDCG@10': '0.0150', 'HR@20': '0.0514', 'NDCG@20': '0.0203'}
2025-02-28 15:07:01,732 - Validation score increased.  Saving model ...
2025-02-28 15:07:49,966 - {'epoch': 3, 'rec_loss': '8.2842'}
2025-02-28 15:08:06,424 - {'Epoch': 3, 'HR@5': '0.0207', 'NDCG@5': '0.0124', 'HR@10': '0.0353', 'NDCG@10': '0.0171', 'HR@20': '0.0573', 'NDCG@20': '0.0227'}
2025-02-28 15:08:06,431 - Validation score increased.  Saving model ...
2025-02-28 15:08:50,463 - {'epoch': 4, 'rec_loss': '8.1049'}
2025-02-28 15:09:05,601 - {'Epoch': 4, 'HR@5': '0.0221', 'NDCG@5': '0.0139', 'HR@10': '0.0379', 'NDCG@10': '0.0189', 'HR@20': '0.0648', 'NDCG@20': '0.0257'}
2025-02-28 15:09:05,606 - Validation score increased.  Saving model ...
2025-02-28 15:09:50,340 - {'epoch': 5, 'rec_loss': '7.9707'}
2025-02-28 15:10:06,262 - {'Epoch': 5, 'HR@5': '0.0248', 'NDCG@5': '0.0155', 'HR@10': '0.0419', 'NDCG@10': '0.0210', 'HR@20': '0.0684', 'NDCG@20': '0.0276'}
2025-02-28 15:10:06,266 - Validation score increased.  Saving model ...
2025-02-28 15:10:53,542 - {'epoch': 6, 'rec_loss': '7.8705'}
2025-02-28 15:11:08,477 - {'Epoch': 6, 'HR@5': '0.0250', 'NDCG@5': '0.0157', 'HR@10': '0.0438', 'NDCG@10': '0.0217', 'HR@20': '0.0731', 'NDCG@20': '0.0290'}
2025-02-28 15:11:08,482 - Validation score increased.  Saving model ...
2025-02-28 15:11:54,533 - {'epoch': 7, 'rec_loss': '7.7919'}
2025-02-28 15:12:10,641 - {'Epoch': 7, 'HR@5': '0.0251', 'NDCG@5': '0.0156', 'HR@10': '0.0446', 'NDCG@10': '0.0219', 'HR@20': '0.0737', 'NDCG@20': '0.0292'}
2025-02-28 15:12:10,643 - Validation score increased.  Saving model ...
2025-02-28 15:13:00,248 - {'epoch': 8, 'rec_loss': '7.7249'}
2025-02-28 15:13:15,428 - {'Epoch': 8, 'HR@5': '0.0276', 'NDCG@5': '0.0169', 'HR@10': '0.0456', 'NDCG@10': '0.0227', 'HR@20': '0.0731', 'NDCG@20': '0.0296'}
2025-02-28 15:13:15,430 - Validation score increased.  Saving model ...
2025-02-28 15:14:00,377 - {'epoch': 9, 'rec_loss': '7.6760'}
2025-02-28 15:14:18,315 - {'Epoch': 9, 'HR@5': '0.0275', 'NDCG@5': '0.0171', 'HR@10': '0.0468', 'NDCG@10': '0.0233', 'HR@20': '0.0758', 'NDCG@20': '0.0306'}
2025-02-28 15:14:18,320 - Validation score increased.  Saving model ...
2025-02-28 15:15:06,016 - {'epoch': 10, 'rec_loss': '7.6272'}
2025-02-28 15:15:21,352 - {'Epoch': 10, 'HR@5': '0.0274', 'NDCG@5': '0.0174', 'HR@10': '0.0464', 'NDCG@10': '0.0235', 'HR@20': '0.0782', 'NDCG@20': '0.0315'}
2025-02-28 15:15:21,357 - Validation score increased.  Saving model ...
2025-02-28 15:16:06,670 - {'epoch': 11, 'rec_loss': '7.5872'}
2025-02-28 15:16:23,289 - {'Epoch': 11, 'HR@5': '0.0291', 'NDCG@5': '0.0179', 'HR@10': '0.0484', 'NDCG@10': '0.0241', 'HR@20': '0.0789', 'NDCG@20': '0.0317'}
2025-02-28 15:16:23,293 - Validation score increased.  Saving model ...
2025-02-28 15:17:08,122 - {'epoch': 12, 'rec_loss': '7.5522'}
2025-02-28 15:17:23,349 - {'Epoch': 12, 'HR@5': '0.0297', 'NDCG@5': '0.0187', 'HR@10': '0.0486', 'NDCG@10': '0.0248', 'HR@20': '0.0776', 'NDCG@20': '0.0321'}
2025-02-28 15:17:23,359 - Validation score increased.  Saving model ...
2025-02-28 15:18:08,388 - {'epoch': 13, 'rec_loss': '7.5154'}
2025-02-28 15:18:24,351 - {'Epoch': 13, 'HR@5': '0.0298', 'NDCG@5': '0.0184', 'HR@10': '0.0502', 'NDCG@10': '0.0250', 'HR@20': '0.0792', 'NDCG@20': '0.0323'}
2025-02-28 15:18:24,356 - Validation score increased.  Saving model ...
2025-02-28 15:19:08,389 - {'epoch': 14, 'rec_loss': '7.4865'}
2025-02-28 15:19:23,727 - {'Epoch': 14, 'HR@5': '0.0292', 'NDCG@5': '0.0184', 'HR@10': '0.0492', 'NDCG@10': '0.0248', 'HR@20': '0.0797', 'NDCG@20': '0.0325'}
2025-02-28 15:19:23,732 - Validation score increased.  Saving model ...
2025-02-28 15:20:08,808 - {'epoch': 15, 'rec_loss': '7.4638'}
2025-02-28 15:20:24,209 - {'Epoch': 15, 'HR@5': '0.0313', 'NDCG@5': '0.0188', 'HR@10': '0.0507', 'NDCG@10': '0.0250', 'HR@20': '0.0805', 'NDCG@20': '0.0325'}
2025-02-28 15:20:24,211 - Validation score increased.  Saving model ...
2025-02-28 15:21:09,004 - {'epoch': 16, 'rec_loss': '7.4395'}
2025-02-28 15:21:24,197 - {'Epoch': 16, 'HR@5': '0.0304', 'NDCG@5': '0.0187', 'HR@10': '0.0506', 'NDCG@10': '0.0252', 'HR@20': '0.0814', 'NDCG@20': '0.0329'}
2025-02-28 15:21:24,202 - Validation score increased.  Saving model ...
2025-02-28 15:22:08,299 - {'epoch': 17, 'rec_loss': '7.4178'}
2025-02-28 15:22:26,051 - {'Epoch': 17, 'HR@5': '0.0311', 'NDCG@5': '0.0192', 'HR@10': '0.0511', 'NDCG@10': '0.0256', 'HR@20': '0.0813', 'NDCG@20': '0.0332'}
2025-02-28 15:22:26,058 - Validation score increased.  Saving model ...
2025-02-28 15:23:11,547 - {'epoch': 18, 'rec_loss': '7.3933'}
2025-02-28 15:23:28,662 - {'Epoch': 18, 'HR@5': '0.0301', 'NDCG@5': '0.0189', 'HR@10': '0.0505', 'NDCG@10': '0.0255', 'HR@20': '0.0816', 'NDCG@20': '0.0333'}
2025-02-28 15:23:28,664 - Validation score increased.  Saving model ...
2025-02-28 15:24:15,602 - {'epoch': 19, 'rec_loss': '7.3786'}
2025-02-28 15:24:30,840 - {'Epoch': 19, 'HR@5': '0.0305', 'NDCG@5': '0.0190', 'HR@10': '0.0510', 'NDCG@10': '0.0255', 'HR@20': '0.0822', 'NDCG@20': '0.0333'}
2025-02-28 15:24:30,841 - Validation score increased.  Saving model ...
2025-02-28 15:25:15,893 - {'epoch': 20, 'rec_loss': '7.3627'}
2025-02-28 15:25:31,147 - {'Epoch': 20, 'HR@5': '0.0296', 'NDCG@5': '0.0186', 'HR@10': '0.0514', 'NDCG@10': '0.0256', 'HR@20': '0.0821', 'NDCG@20': '0.0333'}
2025-02-28 15:25:31,151 - EarlyStopping counter: 1 out of 10
2025-02-28 15:26:17,075 - {'epoch': 21, 'rec_loss': '7.3529'}
2025-02-28 15:26:33,003 - {'Epoch': 21, 'HR@5': '0.0303', 'NDCG@5': '0.0191', 'HR@10': '0.0510', 'NDCG@10': '0.0257', 'HR@20': '0.0814', 'NDCG@20': '0.0334'}
2025-02-28 15:26:33,010 - Validation score increased.  Saving model ...
2025-02-28 15:27:19,623 - {'epoch': 22, 'rec_loss': '7.3362'}
2025-02-28 15:27:35,514 - {'Epoch': 22, 'HR@5': '0.0304', 'NDCG@5': '0.0189', 'HR@10': '0.0507', 'NDCG@10': '0.0254', 'HR@20': '0.0820', 'NDCG@20': '0.0333'}
2025-02-28 15:27:35,519 - EarlyStopping counter: 1 out of 10
2025-02-28 15:28:23,670 - {'epoch': 23, 'rec_loss': '7.3183'}
2025-02-28 15:28:39,444 - {'Epoch': 23, 'HR@5': '0.0309', 'NDCG@5': '0.0192', 'HR@10': '0.0510', 'NDCG@10': '0.0256', 'HR@20': '0.0832', 'NDCG@20': '0.0337'}
2025-02-28 15:28:39,448 - Validation score increased.  Saving model ...
2025-02-28 15:29:25,623 - {'epoch': 24, 'rec_loss': '7.3097'}
2025-02-28 15:29:41,486 - {'Epoch': 24, 'HR@5': '0.0317', 'NDCG@5': '0.0199', 'HR@10': '0.0519', 'NDCG@10': '0.0263', 'HR@20': '0.0825', 'NDCG@20': '0.0340'}
2025-02-28 15:29:41,487 - Validation score increased.  Saving model ...
2025-02-28 15:30:31,113 - {'epoch': 25, 'rec_loss': '7.2951'}
2025-02-28 15:30:47,496 - {'Epoch': 25, 'HR@5': '0.0309', 'NDCG@5': '0.0194', 'HR@10': '0.0514', 'NDCG@10': '0.0259', 'HR@20': '0.0823', 'NDCG@20': '0.0337'}
2025-02-28 15:30:47,504 - EarlyStopping counter: 1 out of 10
2025-02-28 15:31:36,091 - {'epoch': 26, 'rec_loss': '7.2872'}
2025-02-28 15:31:53,445 - {'Epoch': 26, 'HR@5': '0.0313', 'NDCG@5': '0.0195', 'HR@10': '0.0514', 'NDCG@10': '0.0259', 'HR@20': '0.0818', 'NDCG@20': '0.0336'}
2025-02-28 15:31:53,453 - EarlyStopping counter: 2 out of 10
2025-02-28 15:32:38,549 - {'epoch': 27, 'rec_loss': '7.2754'}
2025-02-28 15:32:55,356 - {'Epoch': 27, 'HR@5': '0.0322', 'NDCG@5': '0.0202', 'HR@10': '0.0518', 'NDCG@10': '0.0264', 'HR@20': '0.0814', 'NDCG@20': '0.0339'}
2025-02-28 15:32:55,362 - EarlyStopping counter: 3 out of 10
2025-02-28 15:33:43,416 - {'epoch': 28, 'rec_loss': '7.2651'}
2025-02-28 15:34:00,057 - {'Epoch': 28, 'HR@5': '0.0320', 'NDCG@5': '0.0201', 'HR@10': '0.0502', 'NDCG@10': '0.0259', 'HR@20': '0.0816', 'NDCG@20': '0.0338'}
2025-02-28 15:34:00,059 - EarlyStopping counter: 4 out of 10
2025-02-28 15:34:46,096 - {'epoch': 29, 'rec_loss': '7.2558'}
2025-02-28 15:35:03,615 - {'Epoch': 29, 'HR@5': '0.0309', 'NDCG@5': '0.0193', 'HR@10': '0.0507', 'NDCG@10': '0.0257', 'HR@20': '0.0815', 'NDCG@20': '0.0334'}
2025-02-28 15:35:03,617 - EarlyStopping counter: 5 out of 10
2025-02-28 15:35:54,993 - {'epoch': 30, 'rec_loss': '7.2472'}
2025-02-28 15:36:12,003 - {'Epoch': 30, 'HR@5': '0.0316', 'NDCG@5': '0.0201', 'HR@10': '0.0513', 'NDCG@10': '0.0264', 'HR@20': '0.0823', 'NDCG@20': '0.0342'}
2025-02-28 15:36:12,009 - Validation score increased.  Saving model ...
2025-02-28 15:37:00,057 - {'epoch': 31, 'rec_loss': '7.2380'}
2025-02-28 15:37:16,518 - {'Epoch': 31, 'HR@5': '0.0311', 'NDCG@5': '0.0195', 'HR@10': '0.0513', 'NDCG@10': '0.0259', 'HR@20': '0.0830', 'NDCG@20': '0.0339'}
2025-02-28 15:37:16,523 - EarlyStopping counter: 1 out of 10
2025-02-28 15:38:05,186 - {'epoch': 32, 'rec_loss': '7.2313'}
2025-02-28 15:38:21,476 - {'Epoch': 32, 'HR@5': '0.0304', 'NDCG@5': '0.0189', 'HR@10': '0.0512', 'NDCG@10': '0.0256', 'HR@20': '0.0816', 'NDCG@20': '0.0332'}
2025-02-28 15:38:21,479 - EarlyStopping counter: 2 out of 10
2025-02-28 15:39:10,010 - {'epoch': 33, 'rec_loss': '7.2256'}
2025-02-28 15:39:27,766 - {'Epoch': 33, 'HR@5': '0.0319', 'NDCG@5': '0.0201', 'HR@10': '0.0525', 'NDCG@10': '0.0267', 'HR@20': '0.0839', 'NDCG@20': '0.0346'}
2025-02-28 15:39:27,773 - Validation score increased.  Saving model ...
2025-02-28 15:40:13,177 - {'epoch': 34, 'rec_loss': '7.2186'}
2025-02-28 15:40:29,800 - {'Epoch': 34, 'HR@5': '0.0311', 'NDCG@5': '0.0195', 'HR@10': '0.0510', 'NDCG@10': '0.0259', 'HR@20': '0.0834', 'NDCG@20': '0.0340'}
2025-02-28 15:40:29,807 - EarlyStopping counter: 1 out of 10
2025-02-28 15:41:19,814 - {'epoch': 35, 'rec_loss': '7.2120'}
2025-02-28 15:41:36,297 - {'Epoch': 35, 'HR@5': '0.0302', 'NDCG@5': '0.0189', 'HR@10': '0.0497', 'NDCG@10': '0.0251', 'HR@20': '0.0814', 'NDCG@20': '0.0330'}
2025-02-28 15:41:36,303 - EarlyStopping counter: 2 out of 10
2025-02-28 15:42:24,297 - {'epoch': 36, 'rec_loss': '7.2049'}
2025-02-28 15:42:41,817 - {'Epoch': 36, 'HR@5': '0.0305', 'NDCG@5': '0.0191', 'HR@10': '0.0509', 'NDCG@10': '0.0256', 'HR@20': '0.0812', 'NDCG@20': '0.0332'}
2025-02-28 15:42:41,822 - EarlyStopping counter: 3 out of 10
2025-02-28 15:43:28,273 - {'epoch': 37, 'rec_loss': '7.1989'}
2025-02-28 15:43:44,772 - {'Epoch': 37, 'HR@5': '0.0305', 'NDCG@5': '0.0193', 'HR@10': '0.0510', 'NDCG@10': '0.0259', 'HR@20': '0.0822', 'NDCG@20': '0.0337'}
2025-02-28 15:43:44,773 - EarlyStopping counter: 4 out of 10
2025-02-28 15:44:30,259 - {'epoch': 38, 'rec_loss': '7.1853'}
2025-02-28 15:44:45,885 - {'Epoch': 38, 'HR@5': '0.0309', 'NDCG@5': '0.0194', 'HR@10': '0.0504', 'NDCG@10': '0.0257', 'HR@20': '0.0820', 'NDCG@20': '0.0336'}
2025-02-28 15:44:45,891 - EarlyStopping counter: 5 out of 10
2025-02-28 15:45:31,033 - {'epoch': 39, 'rec_loss': '7.1792'}
2025-02-28 15:45:46,420 - {'Epoch': 39, 'HR@5': '0.0317', 'NDCG@5': '0.0199', 'HR@10': '0.0492', 'NDCG@10': '0.0255', 'HR@20': '0.0818', 'NDCG@20': '0.0337'}
2025-02-28 15:45:46,427 - EarlyStopping counter: 6 out of 10
2025-02-28 15:46:34,311 - {'epoch': 40, 'rec_loss': '7.1834'}
2025-02-28 15:46:50,592 - {'Epoch': 40, 'HR@5': '0.0301', 'NDCG@5': '0.0190', 'HR@10': '0.0503', 'NDCG@10': '0.0254', 'HR@20': '0.0815', 'NDCG@20': '0.0333'}
2025-02-28 15:46:50,598 - EarlyStopping counter: 7 out of 10
2025-02-28 15:47:38,278 - {'epoch': 41, 'rec_loss': '7.1723'}
2025-02-28 15:47:54,374 - {'Epoch': 41, 'HR@5': '0.0299', 'NDCG@5': '0.0188', 'HR@10': '0.0507', 'NDCG@10': '0.0255', 'HR@20': '0.0817', 'NDCG@20': '0.0333'}
2025-02-28 15:47:54,376 - EarlyStopping counter: 8 out of 10
2025-02-28 15:48:39,350 - {'epoch': 42, 'rec_loss': '7.1703'}
2025-02-28 15:48:55,362 - {'Epoch': 42, 'HR@5': '0.0311', 'NDCG@5': '0.0197', 'HR@10': '0.0491', 'NDCG@10': '0.0255', 'HR@20': '0.0807', 'NDCG@20': '0.0334'}
2025-02-28 15:48:55,368 - EarlyStopping counter: 9 out of 10
2025-02-28 15:49:41,494 - {'epoch': 43, 'rec_loss': '7.1666'}
2025-02-28 15:49:58,501 - {'Epoch': 43, 'HR@5': '0.0304', 'NDCG@5': '0.0193', 'HR@10': '0.0496', 'NDCG@10': '0.0255', 'HR@20': '0.0809', 'NDCG@20': '0.0333'}
2025-02-28 15:49:58,506 - EarlyStopping counter: 10 out of 10
2025-02-28 15:49:58,506 - Early stopping
2025-02-28 15:49:58,506 - ---------------Test Score---------------
2025-02-28 15:50:13,713 - {'Epoch': 0, 'HR@5': '0.0292', 'NDCG@5': '0.0181', 'HR@10': '0.0495', 'NDCG@10': '0.0246', 'HR@20': '0.0777', 'NDCG@20': '0.0317'}
2025-02-28 15:50:13,718 - Scale_Yelp
2025-02-28 15:50:13,719 - {'Epoch': 0, 'HR@5': '0.0292', 'NDCG@5': '0.0181', 'HR@10': '0.0495', 'NDCG@10': '0.0246', 'HR@20': '0.0777', 'NDCG@20': '0.0317'}
2025-03-03 09:43:05,771 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 12, 32], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-03 09:43:08,665 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-03 09:43:08,672 - Total Parameters: 1437093
2025-03-03 09:43:56,225 - {'epoch': 0, 'rec_loss': '9.5648'}
2025-03-03 09:44:12,110 - {'Epoch': 0, 'HR@5': '0.0084', 'NDCG@5': '0.0054', 'HR@10': '0.0142', 'NDCG@10': '0.0072', 'HR@20': '0.0247', 'NDCG@20': '0.0099'}
2025-03-03 09:44:12,117 - Validation score increased.  Saving model ...
2025-03-03 09:44:57,801 - {'epoch': 1, 'rec_loss': '8.9950'}
2025-03-03 09:45:12,762 - {'Epoch': 1, 'HR@5': '0.0126', 'NDCG@5': '0.0079', 'HR@10': '0.0212', 'NDCG@10': '0.0107', 'HR@20': '0.0365', 'NDCG@20': '0.0146'}
2025-03-03 09:45:12,764 - Validation score increased.  Saving model ...
2025-03-03 09:45:58,349 - {'epoch': 2, 'rec_loss': '8.5732'}
2025-03-03 09:46:12,988 - {'Epoch': 2, 'HR@5': '0.0176', 'NDCG@5': '0.0109', 'HR@10': '0.0303', 'NDCG@10': '0.0150', 'HR@20': '0.0513', 'NDCG@20': '0.0202'}
2025-03-03 09:46:12,992 - Validation score increased.  Saving model ...
2025-03-03 09:46:58,521 - {'epoch': 3, 'rec_loss': '8.2835'}
2025-03-03 09:47:13,005 - {'Epoch': 3, 'HR@5': '0.0206', 'NDCG@5': '0.0125', 'HR@10': '0.0355', 'NDCG@10': '0.0173', 'HR@20': '0.0575', 'NDCG@20': '0.0229'}
2025-03-03 09:47:13,007 - Validation score increased.  Saving model ...
2025-03-03 09:47:59,694 - {'epoch': 4, 'rec_loss': '8.1046'}
2025-03-03 09:48:14,592 - {'Epoch': 4, 'HR@5': '0.0218', 'NDCG@5': '0.0138', 'HR@10': '0.0374', 'NDCG@10': '0.0188', 'HR@20': '0.0652', 'NDCG@20': '0.0257'}
2025-03-03 09:48:14,594 - Validation score increased.  Saving model ...
2025-03-03 09:49:05,276 - {'epoch': 5, 'rec_loss': '7.9710'}
2025-03-03 09:49:20,089 - {'Epoch': 5, 'HR@5': '0.0247', 'NDCG@5': '0.0156', 'HR@10': '0.0416', 'NDCG@10': '0.0210', 'HR@20': '0.0683', 'NDCG@20': '0.0277'}
2025-03-03 09:49:20,090 - Validation score increased.  Saving model ...
2025-03-03 09:50:09,155 - {'epoch': 6, 'rec_loss': '7.8707'}
2025-03-03 09:50:23,847 - {'Epoch': 6, 'HR@5': '0.0250', 'NDCG@5': '0.0157', 'HR@10': '0.0435', 'NDCG@10': '0.0216', 'HR@20': '0.0726', 'NDCG@20': '0.0289'}
2025-03-03 09:50:23,849 - Validation score increased.  Saving model ...
2025-03-03 09:51:11,220 - {'epoch': 7, 'rec_loss': '7.7919'}
2025-03-03 09:51:26,971 - {'Epoch': 7, 'HR@5': '0.0251', 'NDCG@5': '0.0156', 'HR@10': '0.0450', 'NDCG@10': '0.0220', 'HR@20': '0.0733', 'NDCG@20': '0.0291'}
2025-03-03 09:51:26,972 - Validation score increased.  Saving model ...
2025-03-03 09:52:17,170 - {'epoch': 8, 'rec_loss': '7.7250'}
2025-03-03 09:52:31,854 - {'Epoch': 8, 'HR@5': '0.0271', 'NDCG@5': '0.0165', 'HR@10': '0.0459', 'NDCG@10': '0.0226', 'HR@20': '0.0732', 'NDCG@20': '0.0294'}
2025-03-03 09:52:31,857 - Validation score increased.  Saving model ...
2025-03-03 09:53:22,238 - {'epoch': 9, 'rec_loss': '7.6761'}
2025-03-03 09:53:37,295 - {'Epoch': 9, 'HR@5': '0.0277', 'NDCG@5': '0.0173', 'HR@10': '0.0474', 'NDCG@10': '0.0236', 'HR@20': '0.0755', 'NDCG@20': '0.0307'}
2025-03-03 09:53:37,297 - Validation score increased.  Saving model ...
2025-03-03 09:54:23,584 - {'epoch': 10, 'rec_loss': '7.6281'}
2025-03-03 09:54:38,408 - {'Epoch': 10, 'HR@5': '0.0273', 'NDCG@5': '0.0173', 'HR@10': '0.0461', 'NDCG@10': '0.0233', 'HR@20': '0.0777', 'NDCG@20': '0.0313'}
2025-03-03 09:54:38,409 - Validation score increased.  Saving model ...
2025-03-03 09:55:25,357 - {'epoch': 11, 'rec_loss': '7.5891'}
2025-03-03 09:55:40,212 - {'Epoch': 11, 'HR@5': '0.0290', 'NDCG@5': '0.0177', 'HR@10': '0.0479', 'NDCG@10': '0.0237', 'HR@20': '0.0793', 'NDCG@20': '0.0316'}
2025-03-03 09:55:40,215 - Validation score increased.  Saving model ...
2025-03-03 09:56:27,218 - {'epoch': 12, 'rec_loss': '7.5557'}
2025-03-03 09:56:42,287 - {'Epoch': 12, 'HR@5': '0.0296', 'NDCG@5': '0.0184', 'HR@10': '0.0487', 'NDCG@10': '0.0245', 'HR@20': '0.0776', 'NDCG@20': '0.0318'}
2025-03-03 09:56:42,288 - Validation score increased.  Saving model ...
2025-03-03 09:57:27,979 - {'epoch': 13, 'rec_loss': '7.5189'}
2025-03-03 09:57:42,993 - {'Epoch': 13, 'HR@5': '0.0296', 'NDCG@5': '0.0183', 'HR@10': '0.0497', 'NDCG@10': '0.0247', 'HR@20': '0.0789', 'NDCG@20': '0.0320'}
2025-03-03 09:57:42,998 - Validation score increased.  Saving model ...
2025-03-03 09:58:32,131 - {'epoch': 14, 'rec_loss': '7.4908'}
2025-03-03 09:58:46,894 - {'Epoch': 14, 'HR@5': '0.0291', 'NDCG@5': '0.0183', 'HR@10': '0.0488', 'NDCG@10': '0.0246', 'HR@20': '0.0796', 'NDCG@20': '0.0323'}
2025-03-03 09:58:46,896 - Validation score increased.  Saving model ...
2025-03-03 09:59:37,618 - {'epoch': 15, 'rec_loss': '7.4677'}
2025-03-03 09:59:52,913 - {'Epoch': 15, 'HR@5': '0.0309', 'NDCG@5': '0.0188', 'HR@10': '0.0509', 'NDCG@10': '0.0252', 'HR@20': '0.0804', 'NDCG@20': '0.0326'}
2025-03-03 09:59:52,914 - Validation score increased.  Saving model ...
2025-03-03 10:00:40,563 - {'epoch': 16, 'rec_loss': '7.4438'}
2025-03-03 10:00:55,807 - {'Epoch': 16, 'HR@5': '0.0305', 'NDCG@5': '0.0187', 'HR@10': '0.0501', 'NDCG@10': '0.0250', 'HR@20': '0.0806', 'NDCG@20': '0.0326'}
2025-03-03 10:00:55,808 - Validation score increased.  Saving model ...
2025-03-03 10:01:45,739 - {'epoch': 17, 'rec_loss': '7.4217'}
2025-03-03 10:02:01,721 - {'Epoch': 17, 'HR@5': '0.0313', 'NDCG@5': '0.0192', 'HR@10': '0.0510', 'NDCG@10': '0.0255', 'HR@20': '0.0821', 'NDCG@20': '0.0333'}
2025-03-03 10:02:01,723 - Validation score increased.  Saving model ...
2025-03-03 10:02:49,861 - {'epoch': 18, 'rec_loss': '7.3968'}
2025-03-03 10:03:04,849 - {'Epoch': 18, 'HR@5': '0.0300', 'NDCG@5': '0.0186', 'HR@10': '0.0505', 'NDCG@10': '0.0252', 'HR@20': '0.0813', 'NDCG@20': '0.0330'}
2025-03-03 10:03:04,851 - EarlyStopping counter: 1 out of 10
2025-03-03 10:03:50,900 - {'epoch': 19, 'rec_loss': '7.3819'}
2025-03-03 10:04:06,121 - {'Epoch': 19, 'HR@5': '0.0301', 'NDCG@5': '0.0188', 'HR@10': '0.0505', 'NDCG@10': '0.0254', 'HR@20': '0.0819', 'NDCG@20': '0.0332'}
2025-03-03 10:04:06,122 - EarlyStopping counter: 2 out of 10
2025-03-03 10:04:51,812 - {'epoch': 20, 'rec_loss': '7.3658'}
2025-03-03 10:05:06,663 - {'Epoch': 20, 'HR@5': '0.0297', 'NDCG@5': '0.0187', 'HR@10': '0.0512', 'NDCG@10': '0.0256', 'HR@20': '0.0815', 'NDCG@20': '0.0332'}
2025-03-03 10:05:06,664 - EarlyStopping counter: 3 out of 10
2025-03-03 10:05:54,713 - {'epoch': 21, 'rec_loss': '7.3559'}
2025-03-03 10:06:10,277 - {'Epoch': 21, 'HR@5': '0.0303', 'NDCG@5': '0.0190', 'HR@10': '0.0508', 'NDCG@10': '0.0256', 'HR@20': '0.0815', 'NDCG@20': '0.0333'}
2025-03-03 10:06:10,279 - Validation score increased.  Saving model ...
2025-03-03 10:06:59,171 - {'epoch': 22, 'rec_loss': '7.3386'}
2025-03-03 10:07:19,506 - {'Epoch': 22, 'HR@5': '0.0301', 'NDCG@5': '0.0188', 'HR@10': '0.0503', 'NDCG@10': '0.0253', 'HR@20': '0.0813', 'NDCG@20': '0.0331'}
2025-03-03 10:07:19,511 - EarlyStopping counter: 1 out of 10
2025-03-03 10:08:22,486 - {'epoch': 23, 'rec_loss': '7.3203'}
2025-03-03 10:08:38,274 - {'Epoch': 23, 'HR@5': '0.0312', 'NDCG@5': '0.0194', 'HR@10': '0.0511', 'NDCG@10': '0.0257', 'HR@20': '0.0829', 'NDCG@20': '0.0337'}
2025-03-03 10:08:38,275 - Validation score increased.  Saving model ...
2025-03-03 10:09:25,345 - {'epoch': 24, 'rec_loss': '7.3107'}
2025-03-03 10:09:40,913 - {'Epoch': 24, 'HR@5': '0.0313', 'NDCG@5': '0.0197', 'HR@10': '0.0515', 'NDCG@10': '0.0261', 'HR@20': '0.0818', 'NDCG@20': '0.0338'}
2025-03-03 10:09:40,915 - Validation score increased.  Saving model ...
2025-03-03 10:10:26,650 - {'epoch': 25, 'rec_loss': '7.2963'}
2025-03-03 10:10:41,655 - {'Epoch': 25, 'HR@5': '0.0308', 'NDCG@5': '0.0193', 'HR@10': '0.0509', 'NDCG@10': '0.0257', 'HR@20': '0.0821', 'NDCG@20': '0.0336'}
2025-03-03 10:10:41,657 - EarlyStopping counter: 1 out of 10
2025-03-03 10:11:27,519 - {'epoch': 26, 'rec_loss': '7.2880'}
2025-03-03 10:11:43,238 - {'Epoch': 26, 'HR@5': '0.0309', 'NDCG@5': '0.0192', 'HR@10': '0.0508', 'NDCG@10': '0.0257', 'HR@20': '0.0825', 'NDCG@20': '0.0336'}
2025-03-03 10:11:43,245 - EarlyStopping counter: 2 out of 10
2025-03-03 10:12:34,143 - {'epoch': 27, 'rec_loss': '7.2770'}
2025-03-03 10:12:54,753 - {'Epoch': 27, 'HR@5': '0.0322', 'NDCG@5': '0.0201', 'HR@10': '0.0519', 'NDCG@10': '0.0264', 'HR@20': '0.0814', 'NDCG@20': '0.0337'}
2025-03-03 10:12:54,755 - EarlyStopping counter: 3 out of 10
2025-03-03 10:14:01,022 - {'epoch': 28, 'rec_loss': '7.2657'}
2025-03-03 10:14:25,769 - {'Epoch': 28, 'HR@5': '0.0318', 'NDCG@5': '0.0200', 'HR@10': '0.0503', 'NDCG@10': '0.0259', 'HR@20': '0.0812', 'NDCG@20': '0.0337'}
2025-03-03 10:14:25,777 - EarlyStopping counter: 4 out of 10
2025-03-03 10:15:57,518 - {'epoch': 29, 'rec_loss': '7.2564'}
2025-03-03 10:16:21,228 - {'Epoch': 29, 'HR@5': '0.0307', 'NDCG@5': '0.0192', 'HR@10': '0.0507', 'NDCG@10': '0.0256', 'HR@20': '0.0824', 'NDCG@20': '0.0336'}
2025-03-03 10:16:21,231 - EarlyStopping counter: 5 out of 10
2025-03-03 10:17:54,403 - {'epoch': 30, 'rec_loss': '7.2475'}
2025-03-03 10:18:19,131 - {'Epoch': 30, 'HR@5': '0.0313', 'NDCG@5': '0.0197', 'HR@10': '0.0517', 'NDCG@10': '0.0263', 'HR@20': '0.0824', 'NDCG@20': '0.0340'}
2025-03-03 10:18:19,134 - Validation score increased.  Saving model ...
2025-03-03 10:19:47,804 - {'epoch': 31, 'rec_loss': '7.2378'}
2025-03-03 10:20:11,217 - {'Epoch': 31, 'HR@5': '0.0312', 'NDCG@5': '0.0194', 'HR@10': '0.0516', 'NDCG@10': '0.0259', 'HR@20': '0.0825', 'NDCG@20': '0.0337'}
2025-03-03 10:20:11,223 - EarlyStopping counter: 1 out of 10
2025-03-03 10:21:41,254 - {'epoch': 32, 'rec_loss': '7.2315'}
2025-03-03 10:22:04,347 - {'Epoch': 32, 'HR@5': '0.0307', 'NDCG@5': '0.0190', 'HR@10': '0.0510', 'NDCG@10': '0.0255', 'HR@20': '0.0816', 'NDCG@20': '0.0332'}
2025-03-03 10:22:04,352 - EarlyStopping counter: 2 out of 10
2025-03-03 10:23:40,432 - {'epoch': 33, 'rec_loss': '7.2255'}
2025-03-03 10:24:04,646 - {'Epoch': 33, 'HR@5': '0.0318', 'NDCG@5': '0.0201', 'HR@10': '0.0528', 'NDCG@10': '0.0268', 'HR@20': '0.0838', 'NDCG@20': '0.0346'}
2025-03-03 10:24:04,648 - Validation score increased.  Saving model ...
2025-03-03 10:25:33,444 - {'epoch': 34, 'rec_loss': '7.2180'}
2025-03-03 10:25:57,800 - {'Epoch': 34, 'HR@5': '0.0315', 'NDCG@5': '0.0196', 'HR@10': '0.0511', 'NDCG@10': '0.0259', 'HR@20': '0.0829', 'NDCG@20': '0.0339'}
2025-03-03 10:25:57,810 - EarlyStopping counter: 1 out of 10
2025-03-03 10:27:21,988 - {'epoch': 35, 'rec_loss': '7.2113'}
2025-03-03 10:27:46,591 - {'Epoch': 35, 'HR@5': '0.0304', 'NDCG@5': '0.0187', 'HR@10': '0.0499', 'NDCG@10': '0.0250', 'HR@20': '0.0802', 'NDCG@20': '0.0326'}
2025-03-03 10:27:46,594 - EarlyStopping counter: 2 out of 10
2025-03-03 10:29:18,748 - {'epoch': 36, 'rec_loss': '7.2041'}
2025-03-03 10:29:42,905 - {'Epoch': 36, 'HR@5': '0.0298', 'NDCG@5': '0.0188', 'HR@10': '0.0509', 'NDCG@10': '0.0256', 'HR@20': '0.0808', 'NDCG@20': '0.0331'}
2025-03-03 10:29:42,909 - EarlyStopping counter: 3 out of 10
2025-03-03 10:31:05,222 - {'epoch': 37, 'rec_loss': '7.1982'}
2025-03-03 10:31:21,533 - {'Epoch': 37, 'HR@5': '0.0305', 'NDCG@5': '0.0193', 'HR@10': '0.0516', 'NDCG@10': '0.0261', 'HR@20': '0.0828', 'NDCG@20': '0.0339'}
2025-03-03 10:31:21,535 - EarlyStopping counter: 4 out of 10
2025-03-03 10:32:07,069 - {'epoch': 38, 'rec_loss': '7.1843'}
2025-03-03 10:32:22,323 - {'Epoch': 38, 'HR@5': '0.0310', 'NDCG@5': '0.0194', 'HR@10': '0.0509', 'NDCG@10': '0.0258', 'HR@20': '0.0810', 'NDCG@20': '0.0333'}
2025-03-03 10:32:22,324 - EarlyStopping counter: 5 out of 10
2025-03-03 10:33:04,409 - {'epoch': 39, 'rec_loss': '7.1782'}
2025-03-03 10:33:19,413 - {'Epoch': 39, 'HR@5': '0.0318', 'NDCG@5': '0.0201', 'HR@10': '0.0497', 'NDCG@10': '0.0258', 'HR@20': '0.0809', 'NDCG@20': '0.0336'}
2025-03-03 10:33:19,415 - EarlyStopping counter: 6 out of 10
2025-03-03 10:34:01,519 - {'epoch': 40, 'rec_loss': '7.1821'}
2025-03-03 10:34:18,996 - {'Epoch': 40, 'HR@5': '0.0304', 'NDCG@5': '0.0192', 'HR@10': '0.0508', 'NDCG@10': '0.0257', 'HR@20': '0.0818', 'NDCG@20': '0.0335'}
2025-03-03 10:34:18,998 - EarlyStopping counter: 7 out of 10
2025-03-03 10:35:04,653 - {'epoch': 41, 'rec_loss': '7.1708'}
2025-03-03 10:35:21,761 - {'Epoch': 41, 'HR@5': '0.0293', 'NDCG@5': '0.0187', 'HR@10': '0.0503', 'NDCG@10': '0.0255', 'HR@20': '0.0815', 'NDCG@20': '0.0333'}
2025-03-03 10:35:21,766 - EarlyStopping counter: 8 out of 10
2025-03-03 10:36:04,851 - {'epoch': 42, 'rec_loss': '7.1690'}
2025-03-03 10:36:19,943 - {'Epoch': 42, 'HR@5': '0.0307', 'NDCG@5': '0.0198', 'HR@10': '0.0493', 'NDCG@10': '0.0257', 'HR@20': '0.0813', 'NDCG@20': '0.0338'}
2025-03-03 10:36:19,944 - EarlyStopping counter: 9 out of 10
2025-03-03 10:37:02,164 - {'epoch': 43, 'rec_loss': '7.1645'}
2025-03-03 10:37:19,862 - {'Epoch': 43, 'HR@5': '0.0307', 'NDCG@5': '0.0194', 'HR@10': '0.0503', 'NDCG@10': '0.0257', 'HR@20': '0.0810', 'NDCG@20': '0.0333'}
2025-03-03 10:37:19,866 - EarlyStopping counter: 10 out of 10
2025-03-03 10:37:19,866 - Early stopping
2025-03-03 10:37:19,866 - ---------------Test Score---------------
2025-03-03 10:37:37,412 - {'Epoch': 0, 'HR@5': '0.0290', 'NDCG@5': '0.0179', 'HR@10': '0.0487', 'NDCG@10': '0.0242', 'HR@20': '0.0778', 'NDCG@20': '0.0315'}
2025-03-03 10:37:37,417 - Scale_Yelp
2025-03-03 10:37:37,417 - {'Epoch': 0, 'HR@5': '0.0290', 'NDCG@5': '0.0179', 'HR@10': '0.0487', 'NDCG@10': '0.0242', 'HR@20': '0.0778', 'NDCG@20': '0.0315'}
2025-03-03 12:36:49,778 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 12, 32], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-03 12:36:52,602 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-03 12:36:52,607 - Total Parameters: 1437093
2025-03-03 12:37:40,138 - {'epoch': 0, 'rec_loss': '9.5648'}
2025-03-03 12:37:59,397 - {'Epoch': 0, 'HR@5': '0.0084', 'NDCG@5': '0.0054', 'HR@10': '0.0142', 'NDCG@10': '0.0072', 'HR@20': '0.0247', 'NDCG@20': '0.0099'}
2025-03-03 12:37:59,405 - Validation score increased.  Saving model ...
2025-03-03 12:39:06,322 - {'epoch': 1, 'rec_loss': '8.9950'}
2025-03-03 12:39:24,705 - {'Epoch': 1, 'HR@5': '0.0126', 'NDCG@5': '0.0079', 'HR@10': '0.0212', 'NDCG@10': '0.0107', 'HR@20': '0.0365', 'NDCG@20': '0.0146'}
2025-03-03 12:39:24,713 - Validation score increased.  Saving model ...
2025-03-03 12:40:08,637 - {'epoch': 2, 'rec_loss': '8.5732'}
2025-03-03 12:40:25,633 - {'Epoch': 2, 'HR@5': '0.0176', 'NDCG@5': '0.0109', 'HR@10': '0.0303', 'NDCG@10': '0.0150', 'HR@20': '0.0513', 'NDCG@20': '0.0202'}
2025-03-03 12:40:25,640 - Validation score increased.  Saving model ...
2025-03-03 12:41:33,045 - {'epoch': 3, 'rec_loss': '8.2835'}
2025-03-03 12:41:50,804 - {'Epoch': 3, 'HR@5': '0.0206', 'NDCG@5': '0.0125', 'HR@10': '0.0355', 'NDCG@10': '0.0173', 'HR@20': '0.0575', 'NDCG@20': '0.0229'}
2025-03-03 12:41:50,807 - Validation score increased.  Saving model ...
2025-03-03 12:42:42,551 - {'epoch': 4, 'rec_loss': '8.1046'}
2025-03-03 12:42:57,946 - {'Epoch': 4, 'HR@5': '0.0218', 'NDCG@5': '0.0138', 'HR@10': '0.0374', 'NDCG@10': '0.0188', 'HR@20': '0.0652', 'NDCG@20': '0.0257'}
2025-03-03 12:42:57,953 - Validation score increased.  Saving model ...
2025-03-03 12:43:57,638 - {'epoch': 5, 'rec_loss': '7.9710'}
2025-03-03 12:44:16,338 - {'Epoch': 5, 'HR@5': '0.0247', 'NDCG@5': '0.0156', 'HR@10': '0.0416', 'NDCG@10': '0.0210', 'HR@20': '0.0683', 'NDCG@20': '0.0277'}
2025-03-03 12:44:16,340 - Validation score increased.  Saving model ...
2025-03-03 12:45:15,974 - {'epoch': 6, 'rec_loss': '7.8707'}
2025-03-03 12:45:33,286 - {'Epoch': 6, 'HR@5': '0.0250', 'NDCG@5': '0.0157', 'HR@10': '0.0435', 'NDCG@10': '0.0216', 'HR@20': '0.0726', 'NDCG@20': '0.0289'}
2025-03-03 12:45:33,287 - Validation score increased.  Saving model ...
2025-03-03 12:46:25,576 - {'epoch': 7, 'rec_loss': '7.7919'}
2025-03-03 12:46:44,310 - {'Epoch': 7, 'HR@5': '0.0251', 'NDCG@5': '0.0156', 'HR@10': '0.0450', 'NDCG@10': '0.0220', 'HR@20': '0.0733', 'NDCG@20': '0.0291'}
2025-03-03 12:46:44,312 - Validation score increased.  Saving model ...
2025-03-03 12:47:49,904 - {'epoch': 8, 'rec_loss': '7.7250'}
2025-03-03 12:48:04,788 - {'Epoch': 8, 'HR@5': '0.0271', 'NDCG@5': '0.0165', 'HR@10': '0.0459', 'NDCG@10': '0.0226', 'HR@20': '0.0732', 'NDCG@20': '0.0294'}
2025-03-03 12:48:04,790 - Validation score increased.  Saving model ...
2025-03-03 12:48:48,758 - {'epoch': 9, 'rec_loss': '7.6761'}
2025-03-03 12:49:06,326 - {'Epoch': 9, 'HR@5': '0.0277', 'NDCG@5': '0.0173', 'HR@10': '0.0474', 'NDCG@10': '0.0236', 'HR@20': '0.0755', 'NDCG@20': '0.0307'}
2025-03-03 12:49:06,328 - Validation score increased.  Saving model ...
2025-03-03 12:50:13,672 - {'epoch': 10, 'rec_loss': '7.6281'}
2025-03-03 12:50:32,086 - {'Epoch': 10, 'HR@5': '0.0273', 'NDCG@5': '0.0173', 'HR@10': '0.0461', 'NDCG@10': '0.0233', 'HR@20': '0.0777', 'NDCG@20': '0.0313'}
2025-03-03 12:50:32,092 - Validation score increased.  Saving model ...
2025-03-03 12:51:20,654 - {'epoch': 11, 'rec_loss': '7.5891'}
2025-03-03 12:51:37,598 - {'Epoch': 11, 'HR@5': '0.0290', 'NDCG@5': '0.0177', 'HR@10': '0.0479', 'NDCG@10': '0.0237', 'HR@20': '0.0793', 'NDCG@20': '0.0316'}
2025-03-03 12:51:37,599 - Validation score increased.  Saving model ...
2025-03-03 12:52:36,943 - {'epoch': 12, 'rec_loss': '7.5557'}
2025-03-03 12:52:55,808 - {'Epoch': 12, 'HR@5': '0.0296', 'NDCG@5': '0.0184', 'HR@10': '0.0487', 'NDCG@10': '0.0245', 'HR@20': '0.0776', 'NDCG@20': '0.0318'}
2025-03-03 12:52:55,815 - Validation score increased.  Saving model ...
2025-03-03 12:53:54,707 - {'epoch': 13, 'rec_loss': '7.5189'}
2025-03-03 12:54:11,058 - {'Epoch': 13, 'HR@5': '0.0296', 'NDCG@5': '0.0183', 'HR@10': '0.0497', 'NDCG@10': '0.0247', 'HR@20': '0.0789', 'NDCG@20': '0.0320'}
2025-03-03 12:54:11,059 - Validation score increased.  Saving model ...
2025-03-03 12:54:58,001 - {'epoch': 14, 'rec_loss': '7.4908'}
2025-03-03 12:55:16,619 - {'Epoch': 14, 'HR@5': '0.0291', 'NDCG@5': '0.0183', 'HR@10': '0.0488', 'NDCG@10': '0.0246', 'HR@20': '0.0796', 'NDCG@20': '0.0323'}
2025-03-03 12:55:16,622 - Validation score increased.  Saving model ...
2025-03-03 12:56:23,180 - {'epoch': 15, 'rec_loss': '7.4677'}
2025-03-03 12:56:41,314 - {'Epoch': 15, 'HR@5': '0.0309', 'NDCG@5': '0.0188', 'HR@10': '0.0509', 'NDCG@10': '0.0252', 'HR@20': '0.0804', 'NDCG@20': '0.0326'}
2025-03-03 12:56:41,317 - Validation score increased.  Saving model ...
2025-03-03 12:57:27,509 - {'epoch': 16, 'rec_loss': '7.4438'}
2025-03-03 12:57:42,584 - {'Epoch': 16, 'HR@5': '0.0305', 'NDCG@5': '0.0187', 'HR@10': '0.0501', 'NDCG@10': '0.0250', 'HR@20': '0.0806', 'NDCG@20': '0.0326'}
2025-03-03 12:57:42,589 - Validation score increased.  Saving model ...
2025-03-03 12:58:45,946 - {'epoch': 17, 'rec_loss': '7.4217'}
2025-03-03 12:59:04,108 - {'Epoch': 17, 'HR@5': '0.0313', 'NDCG@5': '0.0192', 'HR@10': '0.0510', 'NDCG@10': '0.0255', 'HR@20': '0.0821', 'NDCG@20': '0.0333'}
2025-03-03 12:59:04,114 - Validation score increased.  Saving model ...
2025-03-03 13:00:00,167 - {'epoch': 18, 'rec_loss': '7.3968'}
2025-03-03 13:00:17,869 - {'Epoch': 18, 'HR@5': '0.0300', 'NDCG@5': '0.0186', 'HR@10': '0.0505', 'NDCG@10': '0.0252', 'HR@20': '0.0813', 'NDCG@20': '0.0330'}
2025-03-03 13:00:17,870 - EarlyStopping counter: 1 out of 10
2025-03-03 13:01:15,673 - {'epoch': 19, 'rec_loss': '7.3819'}
2025-03-03 13:01:33,797 - {'Epoch': 19, 'HR@5': '0.0301', 'NDCG@5': '0.0188', 'HR@10': '0.0505', 'NDCG@10': '0.0254', 'HR@20': '0.0819', 'NDCG@20': '0.0332'}
2025-03-03 13:01:33,799 - EarlyStopping counter: 2 out of 10
2025-03-03 13:02:38,186 - {'epoch': 20, 'rec_loss': '7.3658'}
2025-03-03 13:02:54,793 - {'Epoch': 20, 'HR@5': '0.0297', 'NDCG@5': '0.0187', 'HR@10': '0.0512', 'NDCG@10': '0.0256', 'HR@20': '0.0815', 'NDCG@20': '0.0332'}
2025-03-03 13:02:54,798 - EarlyStopping counter: 3 out of 10
2025-03-03 13:03:42,839 - {'epoch': 21, 'rec_loss': '7.3559'}
2025-03-03 13:04:01,139 - {'Epoch': 21, 'HR@5': '0.0303', 'NDCG@5': '0.0190', 'HR@10': '0.0508', 'NDCG@10': '0.0256', 'HR@20': '0.0815', 'NDCG@20': '0.0333'}
2025-03-03 13:04:01,153 - Validation score increased.  Saving model ...
2025-03-03 13:05:07,807 - {'epoch': 22, 'rec_loss': '7.3386'}
2025-03-03 13:05:26,125 - {'Epoch': 22, 'HR@5': '0.0301', 'NDCG@5': '0.0188', 'HR@10': '0.0503', 'NDCG@10': '0.0253', 'HR@20': '0.0813', 'NDCG@20': '0.0331'}
2025-03-03 13:05:26,134 - EarlyStopping counter: 1 out of 10
2025-03-03 13:06:12,511 - {'epoch': 23, 'rec_loss': '7.3203'}
2025-03-03 13:06:30,477 - {'Epoch': 23, 'HR@5': '0.0312', 'NDCG@5': '0.0194', 'HR@10': '0.0511', 'NDCG@10': '0.0257', 'HR@20': '0.0829', 'NDCG@20': '0.0337'}
2025-03-03 13:06:30,479 - Validation score increased.  Saving model ...
2025-03-03 13:07:37,025 - {'epoch': 24, 'rec_loss': '7.3107'}
2025-03-03 13:07:55,466 - {'Epoch': 24, 'HR@5': '0.0313', 'NDCG@5': '0.0197', 'HR@10': '0.0515', 'NDCG@10': '0.0261', 'HR@20': '0.0818', 'NDCG@20': '0.0338'}
2025-03-03 13:07:55,477 - Validation score increased.  Saving model ...
2025-03-03 13:08:46,156 - {'epoch': 25, 'rec_loss': '7.2963'}
2025-03-03 13:09:02,561 - {'Epoch': 25, 'HR@5': '0.0308', 'NDCG@5': '0.0193', 'HR@10': '0.0509', 'NDCG@10': '0.0257', 'HR@20': '0.0821', 'NDCG@20': '0.0336'}
2025-03-03 13:09:02,567 - EarlyStopping counter: 1 out of 10
2025-03-03 13:10:03,379 - {'epoch': 26, 'rec_loss': '7.2880'}
2025-03-03 13:10:22,097 - {'Epoch': 26, 'HR@5': '0.0309', 'NDCG@5': '0.0192', 'HR@10': '0.0508', 'NDCG@10': '0.0257', 'HR@20': '0.0825', 'NDCG@20': '0.0336'}
2025-03-03 13:10:22,098 - EarlyStopping counter: 2 out of 10
2025-03-03 13:11:21,124 - {'epoch': 27, 'rec_loss': '7.2770'}
2025-03-03 13:11:39,370 - {'Epoch': 27, 'HR@5': '0.0322', 'NDCG@5': '0.0201', 'HR@10': '0.0519', 'NDCG@10': '0.0264', 'HR@20': '0.0814', 'NDCG@20': '0.0337'}
2025-03-03 13:11:39,376 - EarlyStopping counter: 3 out of 10
2025-03-03 13:12:34,796 - {'epoch': 28, 'rec_loss': '7.2657'}
2025-03-03 13:12:53,444 - {'Epoch': 28, 'HR@5': '0.0318', 'NDCG@5': '0.0200', 'HR@10': '0.0503', 'NDCG@10': '0.0259', 'HR@20': '0.0812', 'NDCG@20': '0.0337'}
2025-03-03 13:12:53,451 - EarlyStopping counter: 4 out of 10
2025-03-03 13:13:57,268 - {'epoch': 29, 'rec_loss': '7.2564'}
2025-03-03 13:14:15,448 - {'Epoch': 29, 'HR@5': '0.0307', 'NDCG@5': '0.0192', 'HR@10': '0.0507', 'NDCG@10': '0.0256', 'HR@20': '0.0824', 'NDCG@20': '0.0336'}
2025-03-03 13:14:15,452 - EarlyStopping counter: 5 out of 10
2025-03-03 13:15:07,995 - {'epoch': 30, 'rec_loss': '7.2475'}
2025-03-03 13:15:26,855 - {'Epoch': 30, 'HR@5': '0.0313', 'NDCG@5': '0.0197', 'HR@10': '0.0517', 'NDCG@10': '0.0263', 'HR@20': '0.0824', 'NDCG@20': '0.0340'}
2025-03-03 13:15:26,857 - Validation score increased.  Saving model ...
2025-03-03 13:16:33,974 - {'epoch': 31, 'rec_loss': '7.2378'}
2025-03-03 13:16:50,064 - {'Epoch': 31, 'HR@5': '0.0312', 'NDCG@5': '0.0194', 'HR@10': '0.0516', 'NDCG@10': '0.0259', 'HR@20': '0.0825', 'NDCG@20': '0.0337'}
2025-03-03 13:16:50,071 - EarlyStopping counter: 1 out of 10
2025-03-03 13:17:38,378 - {'epoch': 32, 'rec_loss': '7.2315'}
2025-03-03 13:17:54,665 - {'Epoch': 32, 'HR@5': '0.0307', 'NDCG@5': '0.0190', 'HR@10': '0.0510', 'NDCG@10': '0.0255', 'HR@20': '0.0816', 'NDCG@20': '0.0332'}
2025-03-03 13:17:54,671 - EarlyStopping counter: 2 out of 10
2025-03-03 13:19:01,415 - {'epoch': 33, 'rec_loss': '7.2255'}
2025-03-03 13:19:20,671 - {'Epoch': 33, 'HR@5': '0.0318', 'NDCG@5': '0.0201', 'HR@10': '0.0528', 'NDCG@10': '0.0268', 'HR@20': '0.0838', 'NDCG@20': '0.0346'}
2025-03-03 13:19:20,676 - Validation score increased.  Saving model ...
2025-03-03 13:20:10,190 - {'epoch': 34, 'rec_loss': '7.2180'}
2025-03-03 13:20:27,341 - {'Epoch': 34, 'HR@5': '0.0315', 'NDCG@5': '0.0196', 'HR@10': '0.0511', 'NDCG@10': '0.0259', 'HR@20': '0.0829', 'NDCG@20': '0.0339'}
2025-03-03 13:20:27,343 - EarlyStopping counter: 1 out of 10
2025-03-03 13:21:30,380 - {'epoch': 35, 'rec_loss': '7.2113'}
2025-03-03 13:21:49,823 - {'Epoch': 35, 'HR@5': '0.0304', 'NDCG@5': '0.0187', 'HR@10': '0.0499', 'NDCG@10': '0.0250', 'HR@20': '0.0802', 'NDCG@20': '0.0326'}
2025-03-03 13:21:49,831 - EarlyStopping counter: 2 out of 10
2025-03-03 13:22:46,007 - {'epoch': 36, 'rec_loss': '7.2041'}
2025-03-03 13:23:04,227 - {'Epoch': 36, 'HR@5': '0.0298', 'NDCG@5': '0.0188', 'HR@10': '0.0509', 'NDCG@10': '0.0256', 'HR@20': '0.0808', 'NDCG@20': '0.0331'}
2025-03-03 13:23:04,231 - EarlyStopping counter: 3 out of 10
2025-03-03 13:24:03,276 - {'epoch': 37, 'rec_loss': '7.1982'}
2025-03-03 13:24:22,427 - {'Epoch': 37, 'HR@5': '0.0305', 'NDCG@5': '0.0193', 'HR@10': '0.0516', 'NDCG@10': '0.0261', 'HR@20': '0.0828', 'NDCG@20': '0.0339'}
2025-03-03 13:24:22,436 - EarlyStopping counter: 4 out of 10
2025-03-03 13:25:23,061 - {'epoch': 38, 'rec_loss': '7.1843'}
2025-03-03 13:25:40,080 - {'Epoch': 38, 'HR@5': '0.0310', 'NDCG@5': '0.0194', 'HR@10': '0.0509', 'NDCG@10': '0.0258', 'HR@20': '0.0810', 'NDCG@20': '0.0333'}
2025-03-03 13:25:40,081 - EarlyStopping counter: 5 out of 10
2025-03-03 13:26:32,691 - {'epoch': 39, 'rec_loss': '7.1782'}
2025-03-03 13:26:51,878 - {'Epoch': 39, 'HR@5': '0.0318', 'NDCG@5': '0.0201', 'HR@10': '0.0497', 'NDCG@10': '0.0258', 'HR@20': '0.0809', 'NDCG@20': '0.0336'}
2025-03-03 13:26:51,880 - EarlyStopping counter: 6 out of 10
2025-03-03 13:27:58,178 - {'epoch': 40, 'rec_loss': '7.1821'}
2025-03-03 13:28:14,604 - {'Epoch': 40, 'HR@5': '0.0304', 'NDCG@5': '0.0192', 'HR@10': '0.0508', 'NDCG@10': '0.0257', 'HR@20': '0.0818', 'NDCG@20': '0.0335'}
2025-03-03 13:28:14,606 - EarlyStopping counter: 7 out of 10
2025-03-03 13:29:04,041 - {'epoch': 41, 'rec_loss': '7.1708'}
2025-03-03 13:29:23,233 - {'Epoch': 41, 'HR@5': '0.0293', 'NDCG@5': '0.0187', 'HR@10': '0.0503', 'NDCG@10': '0.0255', 'HR@20': '0.0815', 'NDCG@20': '0.0333'}
2025-03-03 13:29:23,239 - EarlyStopping counter: 8 out of 10
2025-03-03 13:30:31,210 - {'epoch': 42, 'rec_loss': '7.1690'}
2025-03-03 13:30:50,693 - {'Epoch': 42, 'HR@5': '0.0307', 'NDCG@5': '0.0198', 'HR@10': '0.0493', 'NDCG@10': '0.0257', 'HR@20': '0.0813', 'NDCG@20': '0.0338'}
2025-03-03 13:30:50,695 - EarlyStopping counter: 9 out of 10
2025-03-03 13:31:34,560 - {'epoch': 43, 'rec_loss': '7.1645'}
2025-03-03 13:31:51,574 - {'Epoch': 43, 'HR@5': '0.0307', 'NDCG@5': '0.0194', 'HR@10': '0.0503', 'NDCG@10': '0.0257', 'HR@20': '0.0810', 'NDCG@20': '0.0333'}
2025-03-03 13:31:51,583 - EarlyStopping counter: 10 out of 10
2025-03-03 13:31:51,583 - Early stopping
2025-03-03 13:31:51,583 - ---------------Test Score---------------
2025-03-03 13:32:11,067 - {'Epoch': 0, 'HR@5': '0.0290', 'NDCG@5': '0.0179', 'HR@10': '0.0487', 'NDCG@10': '0.0242', 'HR@20': '0.0778', 'NDCG@20': '0.0315'}
2025-03-03 13:32:11,071 - Scale_Yelp
2025-03-03 13:32:11,071 - {'Epoch': 0, 'HR@5': '0.0290', 'NDCG@5': '0.0179', 'HR@10': '0.0487', 'NDCG@10': '0.0242', 'HR@20': '0.0778', 'NDCG@20': '0.0315'}
2025-03-04 14:21:57,290 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 12, 24], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-04 14:22:00,170 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-04 14:22:00,175 - Total Parameters: 1437093
2025-03-04 14:22:45,736 - {'epoch': 0, 'rec_loss': '9.5566'}
2025-03-04 14:23:01,656 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0055', 'HR@10': '0.0132', 'NDCG@10': '0.0071', 'HR@20': '0.0244', 'NDCG@20': '0.0099'}
2025-03-04 14:23:01,657 - Validation score increased.  Saving model ...
2025-03-04 14:23:45,216 - {'epoch': 1, 'rec_loss': '8.9747'}
2025-03-04 14:24:00,158 - {'Epoch': 1, 'HR@5': '0.0129', 'NDCG@5': '0.0081', 'HR@10': '0.0210', 'NDCG@10': '0.0107', 'HR@20': '0.0366', 'NDCG@20': '0.0146'}
2025-03-04 14:24:00,162 - Validation score increased.  Saving model ...
2025-03-04 14:24:46,066 - {'epoch': 2, 'rec_loss': '8.5645'}
2025-03-04 14:25:01,231 - {'Epoch': 2, 'HR@5': '0.0179', 'NDCG@5': '0.0110', 'HR@10': '0.0305', 'NDCG@10': '0.0150', 'HR@20': '0.0514', 'NDCG@20': '0.0203'}
2025-03-04 14:25:01,232 - Validation score increased.  Saving model ...
2025-03-04 14:25:46,148 - {'epoch': 3, 'rec_loss': '8.2800'}
2025-03-04 14:26:00,576 - {'Epoch': 3, 'HR@5': '0.0204', 'NDCG@5': '0.0123', 'HR@10': '0.0354', 'NDCG@10': '0.0171', 'HR@20': '0.0578', 'NDCG@20': '0.0227'}
2025-03-04 14:26:00,580 - Validation score increased.  Saving model ...
2025-03-04 14:26:45,746 - {'epoch': 4, 'rec_loss': '8.1011'}
2025-03-04 14:27:00,158 - {'Epoch': 4, 'HR@5': '0.0220', 'NDCG@5': '0.0139', 'HR@10': '0.0381', 'NDCG@10': '0.0190', 'HR@20': '0.0657', 'NDCG@20': '0.0259'}
2025-03-04 14:27:00,159 - Validation score increased.  Saving model ...
2025-03-04 14:27:45,656 - {'epoch': 5, 'rec_loss': '7.9678'}
2025-03-04 14:28:00,551 - {'Epoch': 5, 'HR@5': '0.0248', 'NDCG@5': '0.0154', 'HR@10': '0.0425', 'NDCG@10': '0.0211', 'HR@20': '0.0690', 'NDCG@20': '0.0277'}
2025-03-04 14:28:00,556 - Validation score increased.  Saving model ...
2025-03-04 14:28:45,603 - {'epoch': 6, 'rec_loss': '7.8683'}
2025-03-04 14:29:00,377 - {'Epoch': 6, 'HR@5': '0.0254', 'NDCG@5': '0.0158', 'HR@10': '0.0437', 'NDCG@10': '0.0217', 'HR@20': '0.0725', 'NDCG@20': '0.0289'}
2025-03-04 14:29:00,378 - Validation score increased.  Saving model ...
2025-03-04 14:29:45,621 - {'epoch': 7, 'rec_loss': '7.7898'}
2025-03-04 14:30:00,761 - {'Epoch': 7, 'HR@5': '0.0251', 'NDCG@5': '0.0157', 'HR@10': '0.0445', 'NDCG@10': '0.0219', 'HR@20': '0.0747', 'NDCG@20': '0.0295'}
2025-03-04 14:30:00,762 - Validation score increased.  Saving model ...
2025-03-04 14:30:46,698 - {'epoch': 8, 'rec_loss': '7.7213'}
2025-03-04 14:31:01,336 - {'Epoch': 8, 'HR@5': '0.0274', 'NDCG@5': '0.0170', 'HR@10': '0.0459', 'NDCG@10': '0.0229', 'HR@20': '0.0746', 'NDCG@20': '0.0301'}
2025-03-04 14:31:01,340 - Validation score increased.  Saving model ...
2025-03-04 14:31:45,770 - {'epoch': 9, 'rec_loss': '7.6723'}
2025-03-04 14:32:00,881 - {'Epoch': 9, 'HR@5': '0.0282', 'NDCG@5': '0.0175', 'HR@10': '0.0471', 'NDCG@10': '0.0236', 'HR@20': '0.0764', 'NDCG@20': '0.0309'}
2025-03-04 14:32:00,883 - Validation score increased.  Saving model ...
2025-03-04 14:32:46,405 - {'epoch': 10, 'rec_loss': '7.6240'}
2025-03-04 14:33:01,462 - {'Epoch': 10, 'HR@5': '0.0278', 'NDCG@5': '0.0177', 'HR@10': '0.0477', 'NDCG@10': '0.0241', 'HR@20': '0.0795', 'NDCG@20': '0.0320'}
2025-03-04 14:33:01,464 - Validation score increased.  Saving model ...
2025-03-04 14:33:47,509 - {'epoch': 11, 'rec_loss': '7.5860'}
2025-03-04 14:34:02,530 - {'Epoch': 11, 'HR@5': '0.0288', 'NDCG@5': '0.0178', 'HR@10': '0.0497', 'NDCG@10': '0.0244', 'HR@20': '0.0801', 'NDCG@20': '0.0320'}
2025-03-04 14:34:02,532 - EarlyStopping counter: 1 out of 10
2025-03-04 14:34:46,070 - {'epoch': 12, 'rec_loss': '7.5539'}
2025-03-04 14:35:01,080 - {'Epoch': 12, 'HR@5': '0.0300', 'NDCG@5': '0.0187', 'HR@10': '0.0494', 'NDCG@10': '0.0249', 'HR@20': '0.0784', 'NDCG@20': '0.0322'}
2025-03-04 14:35:01,082 - Validation score increased.  Saving model ...
2025-03-04 14:35:44,825 - {'epoch': 13, 'rec_loss': '7.5219'}
2025-03-04 14:35:59,945 - {'Epoch': 13, 'HR@5': '0.0291', 'NDCG@5': '0.0182', 'HR@10': '0.0498', 'NDCG@10': '0.0248', 'HR@20': '0.0782', 'NDCG@20': '0.0320'}
2025-03-04 14:35:59,949 - EarlyStopping counter: 1 out of 10
2025-03-04 14:36:44,778 - {'epoch': 14, 'rec_loss': '7.4956'}
2025-03-04 14:36:59,880 - {'Epoch': 14, 'HR@5': '0.0293', 'NDCG@5': '0.0186', 'HR@10': '0.0485', 'NDCG@10': '0.0248', 'HR@20': '0.0803', 'NDCG@20': '0.0328'}
2025-03-04 14:36:59,884 - Validation score increased.  Saving model ...
2025-03-04 14:37:45,254 - {'epoch': 15, 'rec_loss': '7.4721'}
2025-03-04 14:38:00,523 - {'Epoch': 15, 'HR@5': '0.0304', 'NDCG@5': '0.0185', 'HR@10': '0.0495', 'NDCG@10': '0.0247', 'HR@20': '0.0806', 'NDCG@20': '0.0325'}
2025-03-04 14:38:00,528 - EarlyStopping counter: 1 out of 10
2025-03-04 14:38:46,314 - {'epoch': 16, 'rec_loss': '7.4483'}
2025-03-04 14:39:01,101 - {'Epoch': 16, 'HR@5': '0.0305', 'NDCG@5': '0.0188', 'HR@10': '0.0499', 'NDCG@10': '0.0251', 'HR@20': '0.0814', 'NDCG@20': '0.0330'}
2025-03-04 14:39:01,105 - Validation score increased.  Saving model ...
2025-03-04 14:39:45,963 - {'epoch': 17, 'rec_loss': '7.4268'}
2025-03-04 14:40:01,295 - {'Epoch': 17, 'HR@5': '0.0312', 'NDCG@5': '0.0194', 'HR@10': '0.0506', 'NDCG@10': '0.0256', 'HR@20': '0.0812', 'NDCG@20': '0.0333'}
2025-03-04 14:40:01,298 - Validation score increased.  Saving model ...
2025-03-04 14:40:47,133 - {'epoch': 18, 'rec_loss': '7.4035'}
2025-03-04 14:41:02,183 - {'Epoch': 18, 'HR@5': '0.0303', 'NDCG@5': '0.0191', 'HR@10': '0.0505', 'NDCG@10': '0.0255', 'HR@20': '0.0819', 'NDCG@20': '0.0334'}
2025-03-04 14:41:02,187 - Validation score increased.  Saving model ...
2025-03-04 14:41:47,848 - {'epoch': 19, 'rec_loss': '7.3882'}
2025-03-04 14:42:02,840 - {'Epoch': 19, 'HR@5': '0.0310', 'NDCG@5': '0.0193', 'HR@10': '0.0507', 'NDCG@10': '0.0256', 'HR@20': '0.0821', 'NDCG@20': '0.0335'}
2025-03-04 14:42:02,843 - Validation score increased.  Saving model ...
2025-03-04 14:42:47,927 - {'epoch': 20, 'rec_loss': '7.3726'}
2025-03-04 14:43:02,932 - {'Epoch': 20, 'HR@5': '0.0304', 'NDCG@5': '0.0189', 'HR@10': '0.0508', 'NDCG@10': '0.0254', 'HR@20': '0.0822', 'NDCG@20': '0.0333'}
2025-03-04 14:43:02,937 - EarlyStopping counter: 1 out of 10
2025-03-04 14:43:48,204 - {'epoch': 21, 'rec_loss': '7.3626'}
2025-03-04 14:44:03,190 - {'Epoch': 21, 'HR@5': '0.0303', 'NDCG@5': '0.0191', 'HR@10': '0.0515', 'NDCG@10': '0.0259', 'HR@20': '0.0825', 'NDCG@20': '0.0336'}
2025-03-04 14:44:03,194 - Validation score increased.  Saving model ...
2025-03-04 14:44:48,194 - {'epoch': 22, 'rec_loss': '7.3468'}
2025-03-04 14:45:03,119 - {'Epoch': 22, 'HR@5': '0.0299', 'NDCG@5': '0.0187', 'HR@10': '0.0509', 'NDCG@10': '0.0254', 'HR@20': '0.0824', 'NDCG@20': '0.0334'}
2025-03-04 14:45:03,123 - EarlyStopping counter: 1 out of 10
2025-03-04 14:45:48,988 - {'epoch': 23, 'rec_loss': '7.3266'}
2025-03-04 14:46:04,085 - {'Epoch': 23, 'HR@5': '0.0312', 'NDCG@5': '0.0193', 'HR@10': '0.0512', 'NDCG@10': '0.0257', 'HR@20': '0.0844', 'NDCG@20': '0.0340'}
2025-03-04 14:46:04,086 - Validation score increased.  Saving model ...
2025-03-04 14:46:52,179 - {'epoch': 24, 'rec_loss': '7.3174'}
2025-03-04 14:47:07,154 - {'Epoch': 24, 'HR@5': '0.0319', 'NDCG@5': '0.0200', 'HR@10': '0.0525', 'NDCG@10': '0.0265', 'HR@20': '0.0822', 'NDCG@20': '0.0340'}
2025-03-04 14:47:07,155 - EarlyStopping counter: 1 out of 10
2025-03-04 14:47:52,579 - {'epoch': 25, 'rec_loss': '7.3038'}
2025-03-04 14:48:07,468 - {'Epoch': 25, 'HR@5': '0.0303', 'NDCG@5': '0.0193', 'HR@10': '0.0512', 'NDCG@10': '0.0260', 'HR@20': '0.0830', 'NDCG@20': '0.0340'}
2025-03-04 14:48:07,471 - EarlyStopping counter: 2 out of 10
2025-03-04 14:48:52,455 - {'epoch': 26, 'rec_loss': '7.2948'}
2025-03-04 14:49:07,524 - {'Epoch': 26, 'HR@5': '0.0311', 'NDCG@5': '0.0196', 'HR@10': '0.0513', 'NDCG@10': '0.0260', 'HR@20': '0.0819', 'NDCG@20': '0.0337'}
2025-03-04 14:49:07,531 - EarlyStopping counter: 3 out of 10
2025-03-04 14:49:53,149 - {'epoch': 27, 'rec_loss': '7.2844'}
2025-03-04 14:50:08,226 - {'Epoch': 27, 'HR@5': '0.0315', 'NDCG@5': '0.0197', 'HR@10': '0.0517', 'NDCG@10': '0.0262', 'HR@20': '0.0820', 'NDCG@20': '0.0337'}
2025-03-04 14:50:08,228 - EarlyStopping counter: 4 out of 10
2025-03-04 14:50:52,817 - {'epoch': 28, 'rec_loss': '7.2740'}
2025-03-04 14:51:08,097 - {'Epoch': 28, 'HR@5': '0.0316', 'NDCG@5': '0.0197', 'HR@10': '0.0506', 'NDCG@10': '0.0258', 'HR@20': '0.0819', 'NDCG@20': '0.0337'}
2025-03-04 14:51:08,100 - EarlyStopping counter: 5 out of 10
2025-03-04 14:51:52,394 - {'epoch': 29, 'rec_loss': '7.2647'}
2025-03-04 14:52:07,330 - {'Epoch': 29, 'HR@5': '0.0312', 'NDCG@5': '0.0194', 'HR@10': '0.0512', 'NDCG@10': '0.0258', 'HR@20': '0.0816', 'NDCG@20': '0.0335'}
2025-03-04 14:52:07,334 - EarlyStopping counter: 6 out of 10
2025-03-04 14:52:54,467 - {'epoch': 30, 'rec_loss': '7.2552'}
2025-03-04 14:53:09,616 - {'Epoch': 30, 'HR@5': '0.0320', 'NDCG@5': '0.0204', 'HR@10': '0.0517', 'NDCG@10': '0.0267', 'HR@20': '0.0821', 'NDCG@20': '0.0343'}
2025-03-04 14:53:09,619 - Validation score increased.  Saving model ...
2025-03-04 14:53:56,192 - {'epoch': 31, 'rec_loss': '7.2455'}
2025-03-04 14:54:11,274 - {'Epoch': 31, 'HR@5': '0.0312', 'NDCG@5': '0.0197', 'HR@10': '0.0511', 'NDCG@10': '0.0260', 'HR@20': '0.0833', 'NDCG@20': '0.0341'}
2025-03-04 14:54:11,279 - EarlyStopping counter: 1 out of 10
2025-03-04 14:54:55,598 - {'epoch': 32, 'rec_loss': '7.2390'}
2025-03-04 14:55:10,564 - {'Epoch': 32, 'HR@5': '0.0300', 'NDCG@5': '0.0188', 'HR@10': '0.0518', 'NDCG@10': '0.0257', 'HR@20': '0.0825', 'NDCG@20': '0.0335'}
2025-03-04 14:55:10,568 - EarlyStopping counter: 2 out of 10
2025-03-04 14:55:55,792 - {'epoch': 33, 'rec_loss': '7.2327'}
2025-03-04 14:56:10,868 - {'Epoch': 33, 'HR@5': '0.0322', 'NDCG@5': '0.0201', 'HR@10': '0.0530', 'NDCG@10': '0.0267', 'HR@20': '0.0849', 'NDCG@20': '0.0347'}
2025-03-04 14:56:10,872 - Validation score increased.  Saving model ...
2025-03-04 14:56:56,148 - {'epoch': 34, 'rec_loss': '7.2257'}
2025-03-04 14:57:11,200 - {'Epoch': 34, 'HR@5': '0.0316', 'NDCG@5': '0.0194', 'HR@10': '0.0518', 'NDCG@10': '0.0259', 'HR@20': '0.0839', 'NDCG@20': '0.0340'}
2025-03-04 14:57:11,204 - EarlyStopping counter: 1 out of 10
2025-03-04 14:57:56,758 - {'epoch': 35, 'rec_loss': '7.2205'}
2025-03-04 14:58:11,644 - {'Epoch': 35, 'HR@5': '0.0299', 'NDCG@5': '0.0185', 'HR@10': '0.0508', 'NDCG@10': '0.0252', 'HR@20': '0.0807', 'NDCG@20': '0.0327'}
2025-03-04 14:58:11,648 - EarlyStopping counter: 2 out of 10
2025-03-04 14:58:57,405 - {'epoch': 36, 'rec_loss': '7.2131'}
2025-03-04 14:59:12,350 - {'Epoch': 36, 'HR@5': '0.0305', 'NDCG@5': '0.0190', 'HR@10': '0.0512', 'NDCG@10': '0.0257', 'HR@20': '0.0819', 'NDCG@20': '0.0334'}
2025-03-04 14:59:12,354 - EarlyStopping counter: 3 out of 10
2025-03-04 14:59:56,911 - {'epoch': 37, 'rec_loss': '7.2058'}
2025-03-04 15:00:12,141 - {'Epoch': 37, 'HR@5': '0.0311', 'NDCG@5': '0.0196', 'HR@10': '0.0509', 'NDCG@10': '0.0259', 'HR@20': '0.0826', 'NDCG@20': '0.0339'}
2025-03-04 15:00:12,145 - EarlyStopping counter: 4 out of 10
2025-03-04 15:00:57,735 - {'epoch': 38, 'rec_loss': '7.1941'}
2025-03-04 15:01:12,489 - {'Epoch': 38, 'HR@5': '0.0307', 'NDCG@5': '0.0195', 'HR@10': '0.0515', 'NDCG@10': '0.0262', 'HR@20': '0.0816', 'NDCG@20': '0.0337'}
2025-03-04 15:01:12,495 - EarlyStopping counter: 5 out of 10
2025-03-04 15:01:57,265 - {'epoch': 39, 'rec_loss': '7.1869'}
2025-03-04 15:02:12,399 - {'Epoch': 39, 'HR@5': '0.0307', 'NDCG@5': '0.0196', 'HR@10': '0.0508', 'NDCG@10': '0.0260', 'HR@20': '0.0826', 'NDCG@20': '0.0340'}
2025-03-04 15:02:12,403 - EarlyStopping counter: 6 out of 10
2025-03-04 15:02:57,954 - {'epoch': 40, 'rec_loss': '7.1914'}
2025-03-04 15:03:12,990 - {'Epoch': 40, 'HR@5': '0.0297', 'NDCG@5': '0.0189', 'HR@10': '0.0511', 'NDCG@10': '0.0257', 'HR@20': '0.0818', 'NDCG@20': '0.0334'}
2025-03-04 15:03:12,994 - EarlyStopping counter: 7 out of 10
2025-03-04 15:03:58,270 - {'epoch': 41, 'rec_loss': '7.1800'}
2025-03-04 15:04:13,322 - {'Epoch': 41, 'HR@5': '0.0306', 'NDCG@5': '0.0194', 'HR@10': '0.0511', 'NDCG@10': '0.0260', 'HR@20': '0.0833', 'NDCG@20': '0.0341'}
2025-03-04 15:04:13,326 - EarlyStopping counter: 8 out of 10
2025-03-04 15:04:57,993 - {'epoch': 42, 'rec_loss': '7.1758'}
2025-03-04 15:05:13,053 - {'Epoch': 42, 'HR@5': '0.0312', 'NDCG@5': '0.0198', 'HR@10': '0.0499', 'NDCG@10': '0.0258', 'HR@20': '0.0814', 'NDCG@20': '0.0336'}
2025-03-04 15:05:13,057 - EarlyStopping counter: 9 out of 10
2025-03-04 15:05:59,216 - {'epoch': 43, 'rec_loss': '7.1721'}
2025-03-04 15:06:14,430 - {'Epoch': 43, 'HR@5': '0.0303', 'NDCG@5': '0.0191', 'HR@10': '0.0508', 'NDCG@10': '0.0257', 'HR@20': '0.0814', 'NDCG@20': '0.0334'}
2025-03-04 15:06:14,432 - EarlyStopping counter: 10 out of 10
2025-03-04 15:06:14,432 - Early stopping
2025-03-04 15:06:14,432 - ---------------Test Score---------------
2025-03-04 15:06:29,611 - {'Epoch': 0, 'HR@5': '0.0288', 'NDCG@5': '0.0178', 'HR@10': '0.0490', 'NDCG@10': '0.0243', 'HR@20': '0.0777', 'NDCG@20': '0.0315'}
2025-03-04 15:06:29,615 - Scale_Yelp
2025-03-04 15:06:29,615 - {'Epoch': 0, 'HR@5': '0.0288', 'NDCG@5': '0.0178', 'HR@10': '0.0490', 'NDCG@10': '0.0243', 'HR@20': '0.0777', 'NDCG@20': '0.0315'}
2025-03-04 15:14:49,113 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[2, 4, 8], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-04 15:14:51,975 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-04 15:14:51,979 - Total Parameters: 1437093
2025-03-04 15:15:38,303 - {'epoch': 0, 'rec_loss': '9.5519'}
2025-03-04 15:15:54,130 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0054', 'HR@10': '0.0137', 'NDCG@10': '0.0071', 'HR@20': '0.0249', 'NDCG@20': '0.0100'}
2025-03-04 15:15:54,132 - Validation score increased.  Saving model ...
2025-03-04 15:16:38,980 - {'epoch': 1, 'rec_loss': '8.9638'}
2025-03-04 15:16:53,582 - {'Epoch': 1, 'HR@5': '0.0130', 'NDCG@5': '0.0082', 'HR@10': '0.0215', 'NDCG@10': '0.0109', 'HR@20': '0.0367', 'NDCG@20': '0.0147'}
2025-03-04 15:16:53,584 - Validation score increased.  Saving model ...
2025-03-04 15:17:37,581 - {'epoch': 2, 'rec_loss': '8.5554'}
2025-03-04 15:17:52,052 - {'Epoch': 2, 'HR@5': '0.0182', 'NDCG@5': '0.0111', 'HR@10': '0.0307', 'NDCG@10': '0.0152', 'HR@20': '0.0513', 'NDCG@20': '0.0204'}
2025-03-04 15:17:52,054 - Validation score increased.  Saving model ...
2025-03-04 15:18:36,000 - {'epoch': 3, 'rec_loss': '8.2739'}
2025-03-04 15:18:50,225 - {'Epoch': 3, 'HR@5': '0.0207', 'NDCG@5': '0.0126', 'HR@10': '0.0361', 'NDCG@10': '0.0175', 'HR@20': '0.0584', 'NDCG@20': '0.0231'}
2025-03-04 15:18:50,227 - Validation score increased.  Saving model ...
2025-03-04 15:19:36,070 - {'epoch': 4, 'rec_loss': '8.0944'}
2025-03-04 15:19:50,300 - {'Epoch': 4, 'HR@5': '0.0225', 'NDCG@5': '0.0141', 'HR@10': '0.0388', 'NDCG@10': '0.0193', 'HR@20': '0.0659', 'NDCG@20': '0.0260'}
2025-03-04 15:19:50,302 - Validation score increased.  Saving model ...
2025-03-04 15:20:34,391 - {'epoch': 5, 'rec_loss': '7.9616'}
2025-03-04 15:20:48,885 - {'Epoch': 5, 'HR@5': '0.0248', 'NDCG@5': '0.0156', 'HR@10': '0.0428', 'NDCG@10': '0.0214', 'HR@20': '0.0684', 'NDCG@20': '0.0278'}
2025-03-04 15:20:48,887 - Validation score increased.  Saving model ...
2025-03-04 15:21:34,865 - {'epoch': 6, 'rec_loss': '7.8629'}
2025-03-04 15:21:49,484 - {'Epoch': 6, 'HR@5': '0.0256', 'NDCG@5': '0.0160', 'HR@10': '0.0436', 'NDCG@10': '0.0218', 'HR@20': '0.0735', 'NDCG@20': '0.0293'}
2025-03-04 15:21:49,485 - Validation score increased.  Saving model ...
2025-03-04 15:22:35,200 - {'epoch': 7, 'rec_loss': '7.7856'}
2025-03-04 15:22:49,900 - {'Epoch': 7, 'HR@5': '0.0258', 'NDCG@5': '0.0159', 'HR@10': '0.0454', 'NDCG@10': '0.0222', 'HR@20': '0.0748', 'NDCG@20': '0.0296'}
2025-03-04 15:22:49,901 - Validation score increased.  Saving model ...
2025-03-04 15:23:34,637 - {'epoch': 8, 'rec_loss': '7.7171'}
2025-03-04 15:23:49,461 - {'Epoch': 8, 'HR@5': '0.0280', 'NDCG@5': '0.0173', 'HR@10': '0.0465', 'NDCG@10': '0.0232', 'HR@20': '0.0743', 'NDCG@20': '0.0302'}
2025-03-04 15:23:49,462 - Validation score increased.  Saving model ...
2025-03-04 15:24:34,454 - {'epoch': 9, 'rec_loss': '7.6676'}
2025-03-04 15:24:49,248 - {'Epoch': 9, 'HR@5': '0.0279', 'NDCG@5': '0.0173', 'HR@10': '0.0476', 'NDCG@10': '0.0236', 'HR@20': '0.0766', 'NDCG@20': '0.0309'}
2025-03-04 15:24:49,250 - Validation score increased.  Saving model ...
2025-03-04 15:25:35,898 - {'epoch': 10, 'rec_loss': '7.6207'}
2025-03-04 15:25:50,810 - {'Epoch': 10, 'HR@5': '0.0279', 'NDCG@5': '0.0176', 'HR@10': '0.0479', 'NDCG@10': '0.0240', 'HR@20': '0.0775', 'NDCG@20': '0.0314'}
2025-03-04 15:25:50,811 - Validation score increased.  Saving model ...
2025-03-04 15:26:37,164 - {'epoch': 11, 'rec_loss': '7.5820'}
2025-03-04 15:26:51,914 - {'Epoch': 11, 'HR@5': '0.0287', 'NDCG@5': '0.0178', 'HR@10': '0.0497', 'NDCG@10': '0.0245', 'HR@20': '0.0792', 'NDCG@20': '0.0319'}
2025-03-04 15:26:51,915 - Validation score increased.  Saving model ...
2025-03-04 15:27:36,777 - {'epoch': 12, 'rec_loss': '7.5505'}
2025-03-04 15:27:51,658 - {'Epoch': 12, 'HR@5': '0.0293', 'NDCG@5': '0.0184', 'HR@10': '0.0487', 'NDCG@10': '0.0247', 'HR@20': '0.0803', 'NDCG@20': '0.0326'}
2025-03-04 15:27:51,659 - Validation score increased.  Saving model ...
2025-03-04 15:28:37,729 - {'epoch': 13, 'rec_loss': '7.5193'}
2025-03-04 15:28:52,584 - {'Epoch': 13, 'HR@5': '0.0295', 'NDCG@5': '0.0183', 'HR@10': '0.0494', 'NDCG@10': '0.0248', 'HR@20': '0.0781', 'NDCG@20': '0.0320'}
2025-03-04 15:28:52,585 - EarlyStopping counter: 1 out of 10
2025-03-04 15:29:38,444 - {'epoch': 14, 'rec_loss': '7.4949'}
2025-03-04 15:29:53,320 - {'Epoch': 14, 'HR@5': '0.0301', 'NDCG@5': '0.0189', 'HR@10': '0.0488', 'NDCG@10': '0.0249', 'HR@20': '0.0789', 'NDCG@20': '0.0325'}
2025-03-04 15:29:53,321 - EarlyStopping counter: 2 out of 10
2025-03-04 15:30:41,245 - {'epoch': 15, 'rec_loss': '7.4732'}
2025-03-04 15:30:56,325 - {'Epoch': 15, 'HR@5': '0.0307', 'NDCG@5': '0.0187', 'HR@10': '0.0497', 'NDCG@10': '0.0248', 'HR@20': '0.0801', 'NDCG@20': '0.0324'}
2025-03-04 15:30:56,326 - EarlyStopping counter: 3 out of 10
2025-03-04 15:31:41,881 - {'epoch': 16, 'rec_loss': '7.4497'}
2025-03-04 15:31:56,758 - {'Epoch': 16, 'HR@5': '0.0301', 'NDCG@5': '0.0186', 'HR@10': '0.0505', 'NDCG@10': '0.0251', 'HR@20': '0.0812', 'NDCG@20': '0.0328'}
2025-03-04 15:31:56,760 - Validation score increased.  Saving model ...
2025-03-04 15:32:43,271 - {'epoch': 17, 'rec_loss': '7.4287'}
2025-03-04 15:32:58,087 - {'Epoch': 17, 'HR@5': '0.0302', 'NDCG@5': '0.0186', 'HR@10': '0.0509', 'NDCG@10': '0.0253', 'HR@20': '0.0815', 'NDCG@20': '0.0330'}
2025-03-04 15:32:58,089 - Validation score increased.  Saving model ...
2025-03-04 15:33:48,283 - {'epoch': 18, 'rec_loss': '7.4060'}
2025-03-04 15:34:03,105 - {'Epoch': 18, 'HR@5': '0.0300', 'NDCG@5': '0.0188', 'HR@10': '0.0493', 'NDCG@10': '0.0250', 'HR@20': '0.0817', 'NDCG@20': '0.0332'}
2025-03-04 15:34:03,107 - Validation score increased.  Saving model ...
2025-03-04 15:34:48,855 - {'epoch': 19, 'rec_loss': '7.3908'}
2025-03-04 15:35:03,816 - {'Epoch': 19, 'HR@5': '0.0306', 'NDCG@5': '0.0190', 'HR@10': '0.0504', 'NDCG@10': '0.0253', 'HR@20': '0.0826', 'NDCG@20': '0.0334'}
2025-03-04 15:35:03,818 - Validation score increased.  Saving model ...
2025-03-04 15:35:48,400 - {'epoch': 20, 'rec_loss': '7.3742'}
2025-03-04 15:36:03,402 - {'Epoch': 20, 'HR@5': '0.0297', 'NDCG@5': '0.0186', 'HR@10': '0.0510', 'NDCG@10': '0.0255', 'HR@20': '0.0815', 'NDCG@20': '0.0331'}
2025-03-04 15:36:03,404 - EarlyStopping counter: 1 out of 10
2025-03-04 15:36:50,423 - {'epoch': 21, 'rec_loss': '7.3649'}
2025-03-04 15:37:05,284 - {'Epoch': 21, 'HR@5': '0.0307', 'NDCG@5': '0.0193', 'HR@10': '0.0515', 'NDCG@10': '0.0260', 'HR@20': '0.0817', 'NDCG@20': '0.0336'}
2025-03-04 15:37:05,285 - Validation score increased.  Saving model ...
2025-03-04 15:37:50,710 - {'epoch': 22, 'rec_loss': '7.3493'}
2025-03-04 15:38:05,587 - {'Epoch': 22, 'HR@5': '0.0303', 'NDCG@5': '0.0187', 'HR@10': '0.0499', 'NDCG@10': '0.0249', 'HR@20': '0.0817', 'NDCG@20': '0.0329'}
2025-03-04 15:38:05,589 - EarlyStopping counter: 1 out of 10
2025-03-04 15:38:50,222 - {'epoch': 23, 'rec_loss': '7.3296'}
2025-03-04 15:39:05,123 - {'Epoch': 23, 'HR@5': '0.0309', 'NDCG@5': '0.0190', 'HR@10': '0.0502', 'NDCG@10': '0.0252', 'HR@20': '0.0842', 'NDCG@20': '0.0337'}
2025-03-04 15:39:05,125 - Validation score increased.  Saving model ...
2025-03-04 15:39:54,002 - {'epoch': 24, 'rec_loss': '7.3194'}
2025-03-04 15:40:08,869 - {'Epoch': 24, 'HR@5': '0.0314', 'NDCG@5': '0.0196', 'HR@10': '0.0516', 'NDCG@10': '0.0261', 'HR@20': '0.0835', 'NDCG@20': '0.0341'}
2025-03-04 15:40:08,870 - Validation score increased.  Saving model ...
2025-03-04 15:40:52,965 - {'epoch': 25, 'rec_loss': '7.3061'}
2025-03-04 15:41:07,842 - {'Epoch': 25, 'HR@5': '0.0307', 'NDCG@5': '0.0194', 'HR@10': '0.0502', 'NDCG@10': '0.0257', 'HR@20': '0.0828', 'NDCG@20': '0.0338'}
2025-03-04 15:41:07,843 - EarlyStopping counter: 1 out of 10
2025-03-04 15:41:52,894 - {'epoch': 26, 'rec_loss': '7.2974'}
2025-03-04 15:42:07,839 - {'Epoch': 26, 'HR@5': '0.0303', 'NDCG@5': '0.0189', 'HR@10': '0.0513', 'NDCG@10': '0.0256', 'HR@20': '0.0825', 'NDCG@20': '0.0335'}
2025-03-04 15:42:07,840 - EarlyStopping counter: 2 out of 10
2025-03-04 15:42:53,152 - {'epoch': 27, 'rec_loss': '7.2880'}
2025-03-04 15:43:08,092 - {'Epoch': 27, 'HR@5': '0.0317', 'NDCG@5': '0.0198', 'HR@10': '0.0511', 'NDCG@10': '0.0260', 'HR@20': '0.0821', 'NDCG@20': '0.0338'}
2025-03-04 15:43:08,094 - EarlyStopping counter: 3 out of 10
2025-03-04 15:43:55,337 - {'epoch': 28, 'rec_loss': '7.2776'}
2025-03-04 15:44:10,256 - {'Epoch': 28, 'HR@5': '0.0314', 'NDCG@5': '0.0198', 'HR@10': '0.0507', 'NDCG@10': '0.0260', 'HR@20': '0.0824', 'NDCG@20': '0.0339'}
2025-03-04 15:44:10,258 - EarlyStopping counter: 4 out of 10
2025-03-04 15:44:58,040 - {'epoch': 29, 'rec_loss': '7.2677'}
2025-03-04 15:45:12,983 - {'Epoch': 29, 'HR@5': '0.0308', 'NDCG@5': '0.0192', 'HR@10': '0.0504', 'NDCG@10': '0.0255', 'HR@20': '0.0811', 'NDCG@20': '0.0332'}
2025-03-04 15:45:12,984 - EarlyStopping counter: 5 out of 10
2025-03-04 15:45:57,722 - {'epoch': 30, 'rec_loss': '7.2588'}
2025-03-04 15:46:12,807 - {'Epoch': 30, 'HR@5': '0.0313', 'NDCG@5': '0.0199', 'HR@10': '0.0524', 'NDCG@10': '0.0267', 'HR@20': '0.0823', 'NDCG@20': '0.0342'}
2025-03-04 15:46:12,809 - Validation score increased.  Saving model ...
2025-03-04 15:46:57,560 - {'epoch': 31, 'rec_loss': '7.2484'}
2025-03-04 15:47:12,612 - {'Epoch': 31, 'HR@5': '0.0308', 'NDCG@5': '0.0192', 'HR@10': '0.0518', 'NDCG@10': '0.0259', 'HR@20': '0.0834', 'NDCG@20': '0.0339'}
2025-03-04 15:47:12,614 - EarlyStopping counter: 1 out of 10
2025-03-04 15:47:59,405 - {'epoch': 32, 'rec_loss': '7.2408'}
2025-03-04 15:48:14,701 - {'Epoch': 32, 'HR@5': '0.0308', 'NDCG@5': '0.0190', 'HR@10': '0.0513', 'NDCG@10': '0.0256', 'HR@20': '0.0830', 'NDCG@20': '0.0335'}
2025-03-04 15:48:14,703 - EarlyStopping counter: 2 out of 10
2025-03-04 15:49:00,131 - {'epoch': 33, 'rec_loss': '7.2362'}
2025-03-04 15:49:15,142 - {'Epoch': 33, 'HR@5': '0.0321', 'NDCG@5': '0.0200', 'HR@10': '0.0522', 'NDCG@10': '0.0265', 'HR@20': '0.0848', 'NDCG@20': '0.0347'}
2025-03-04 15:49:15,143 - Validation score increased.  Saving model ...
2025-03-04 15:50:01,653 - {'epoch': 34, 'rec_loss': '7.2291'}
2025-03-04 15:50:17,647 - {'Epoch': 34, 'HR@5': '0.0312', 'NDCG@5': '0.0194', 'HR@10': '0.0518', 'NDCG@10': '0.0261', 'HR@20': '0.0830', 'NDCG@20': '0.0339'}
2025-03-04 15:50:17,649 - EarlyStopping counter: 1 out of 10
2025-03-04 15:51:03,284 - {'epoch': 35, 'rec_loss': '7.2255'}
2025-03-04 15:51:18,265 - {'Epoch': 35, 'HR@5': '0.0303', 'NDCG@5': '0.0184', 'HR@10': '0.0503', 'NDCG@10': '0.0248', 'HR@20': '0.0809', 'NDCG@20': '0.0325'}
2025-03-04 15:51:18,266 - EarlyStopping counter: 2 out of 10
2025-03-04 15:52:03,821 - {'epoch': 36, 'rec_loss': '7.2170'}
2025-03-04 15:52:18,741 - {'Epoch': 36, 'HR@5': '0.0305', 'NDCG@5': '0.0193', 'HR@10': '0.0507', 'NDCG@10': '0.0258', 'HR@20': '0.0812', 'NDCG@20': '0.0335'}
2025-03-04 15:52:18,743 - EarlyStopping counter: 3 out of 10
2025-03-04 15:53:04,143 - {'epoch': 37, 'rec_loss': '7.2090'}
2025-03-04 15:53:19,105 - {'Epoch': 37, 'HR@5': '0.0305', 'NDCG@5': '0.0198', 'HR@10': '0.0511', 'NDCG@10': '0.0264', 'HR@20': '0.0825', 'NDCG@20': '0.0343'}
2025-03-04 15:53:19,107 - EarlyStopping counter: 4 out of 10
2025-03-04 15:54:04,453 - {'epoch': 38, 'rec_loss': '7.1971'}
2025-03-04 15:54:19,679 - {'Epoch': 38, 'HR@5': '0.0310', 'NDCG@5': '0.0198', 'HR@10': '0.0523', 'NDCG@10': '0.0266', 'HR@20': '0.0817', 'NDCG@20': '0.0340'}
2025-03-04 15:54:19,681 - EarlyStopping counter: 5 out of 10
2025-03-04 15:55:06,858 - {'epoch': 39, 'rec_loss': '7.1898'}
2025-03-04 15:55:21,834 - {'Epoch': 39, 'HR@5': '0.0313', 'NDCG@5': '0.0197', 'HR@10': '0.0501', 'NDCG@10': '0.0258', 'HR@20': '0.0820', 'NDCG@20': '0.0338'}
2025-03-04 15:55:21,835 - EarlyStopping counter: 6 out of 10
2025-03-04 15:56:07,929 - {'epoch': 40, 'rec_loss': '7.1949'}
2025-03-04 15:56:22,836 - {'Epoch': 40, 'HR@5': '0.0307', 'NDCG@5': '0.0194', 'HR@10': '0.0516', 'NDCG@10': '0.0261', 'HR@20': '0.0825', 'NDCG@20': '0.0339'}
2025-03-04 15:56:22,837 - EarlyStopping counter: 7 out of 10
2025-03-04 15:57:08,153 - {'epoch': 41, 'rec_loss': '7.1834'}
2025-03-04 15:57:23,357 - {'Epoch': 41, 'HR@5': '0.0311', 'NDCG@5': '0.0196', 'HR@10': '0.0530', 'NDCG@10': '0.0265', 'HR@20': '0.0832', 'NDCG@20': '0.0341'}
2025-03-04 15:57:23,358 - EarlyStopping counter: 8 out of 10
2025-03-04 15:58:11,020 - {'epoch': 42, 'rec_loss': '7.1794'}
2025-03-04 15:58:26,607 - {'Epoch': 42, 'HR@5': '0.0313', 'NDCG@5': '0.0199', 'HR@10': '0.0507', 'NDCG@10': '0.0262', 'HR@20': '0.0819', 'NDCG@20': '0.0340'}
2025-03-04 15:58:26,609 - EarlyStopping counter: 9 out of 10
2025-03-04 15:59:12,559 - {'epoch': 43, 'rec_loss': '7.1767'}
2025-03-04 15:59:27,677 - {'Epoch': 43, 'HR@5': '0.0306', 'NDCG@5': '0.0192', 'HR@10': '0.0516', 'NDCG@10': '0.0260', 'HR@20': '0.0830', 'NDCG@20': '0.0338'}
2025-03-04 15:59:27,678 - EarlyStopping counter: 10 out of 10
2025-03-04 15:59:27,678 - Early stopping
2025-03-04 15:59:27,678 - ---------------Test Score---------------
2025-03-04 15:59:42,787 - {'Epoch': 0, 'HR@5': '0.0286', 'NDCG@5': '0.0180', 'HR@10': '0.0480', 'NDCG@10': '0.0243', 'HR@20': '0.0777', 'NDCG@20': '0.0317'}
2025-03-04 15:59:42,788 - Scale_Yelp
2025-03-04 15:59:42,788 - {'Epoch': 0, 'HR@5': '0.0286', 'NDCG@5': '0.0180', 'HR@10': '0.0480', 'NDCG@10': '0.0243', 'HR@20': '0.0777', 'NDCG@20': '0.0317'}
2025-03-04 16:03:56,862 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 32], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-04 16:03:59,680 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-04 16:03:59,685 - Total Parameters: 1437093
2025-03-04 16:04:47,448 - {'epoch': 0, 'rec_loss': '9.5556'}
2025-03-04 16:05:03,099 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0054', 'HR@10': '0.0132', 'NDCG@10': '0.0071', 'HR@20': '0.0249', 'NDCG@20': '0.0100'}
2025-03-04 16:05:03,101 - Validation score increased.  Saving model ...
2025-03-04 16:05:47,940 - {'epoch': 1, 'rec_loss': '8.9708'}
2025-03-04 16:06:04,254 - {'Epoch': 1, 'HR@5': '0.0128', 'NDCG@5': '0.0079', 'HR@10': '0.0216', 'NDCG@10': '0.0108', 'HR@20': '0.0363', 'NDCG@20': '0.0145'}
2025-03-04 16:06:04,262 - Validation score increased.  Saving model ...
2025-03-04 16:06:49,531 - {'epoch': 2, 'rec_loss': '8.5653'}
2025-03-04 16:07:05,690 - {'Epoch': 2, 'HR@5': '0.0178', 'NDCG@5': '0.0109', 'HR@10': '0.0306', 'NDCG@10': '0.0150', 'HR@20': '0.0514', 'NDCG@20': '0.0202'}
2025-03-04 16:07:05,691 - Validation score increased.  Saving model ...
2025-03-04 16:07:52,665 - {'epoch': 3, 'rec_loss': '8.2805'}
2025-03-04 16:08:06,914 - {'Epoch': 3, 'HR@5': '0.0204', 'NDCG@5': '0.0123', 'HR@10': '0.0353', 'NDCG@10': '0.0171', 'HR@20': '0.0577', 'NDCG@20': '0.0228'}
2025-03-04 16:08:06,918 - Validation score increased.  Saving model ...
2025-03-04 16:08:52,388 - {'epoch': 4, 'rec_loss': '8.1012'}
2025-03-04 16:09:06,798 - {'Epoch': 4, 'HR@5': '0.0217', 'NDCG@5': '0.0137', 'HR@10': '0.0380', 'NDCG@10': '0.0190', 'HR@20': '0.0657', 'NDCG@20': '0.0259'}
2025-03-04 16:09:06,800 - Validation score increased.  Saving model ...
2025-03-04 16:09:51,562 - {'epoch': 5, 'rec_loss': '7.9683'}
2025-03-04 16:10:07,016 - {'Epoch': 5, 'HR@5': '0.0250', 'NDCG@5': '0.0155', 'HR@10': '0.0427', 'NDCG@10': '0.0212', 'HR@20': '0.0689', 'NDCG@20': '0.0277'}
2025-03-04 16:10:07,017 - Validation score increased.  Saving model ...
2025-03-04 16:10:51,903 - {'epoch': 6, 'rec_loss': '7.8689'}
2025-03-04 16:11:07,225 - {'Epoch': 6, 'HR@5': '0.0252', 'NDCG@5': '0.0158', 'HR@10': '0.0437', 'NDCG@10': '0.0218', 'HR@20': '0.0729', 'NDCG@20': '0.0291'}
2025-03-04 16:11:07,227 - Validation score increased.  Saving model ...
2025-03-04 16:11:52,876 - {'epoch': 7, 'rec_loss': '7.7899'}
2025-03-04 16:12:09,950 - {'Epoch': 7, 'HR@5': '0.0253', 'NDCG@5': '0.0157', 'HR@10': '0.0446', 'NDCG@10': '0.0219', 'HR@20': '0.0743', 'NDCG@20': '0.0294'}
2025-03-04 16:12:09,952 - Validation score increased.  Saving model ...
2025-03-04 16:13:00,854 - {'epoch': 8, 'rec_loss': '7.7219'}
2025-03-04 16:13:18,316 - {'Epoch': 8, 'HR@5': '0.0274', 'NDCG@5': '0.0170', 'HR@10': '0.0460', 'NDCG@10': '0.0229', 'HR@20': '0.0743', 'NDCG@20': '0.0300'}
2025-03-04 16:13:18,318 - Validation score increased.  Saving model ...
2025-03-04 16:14:01,538 - {'epoch': 9, 'rec_loss': '7.6727'}
2025-03-04 16:14:16,373 - {'Epoch': 9, 'HR@5': '0.0283', 'NDCG@5': '0.0175', 'HR@10': '0.0471', 'NDCG@10': '0.0236', 'HR@20': '0.0765', 'NDCG@20': '0.0310'}
2025-03-04 16:14:16,375 - Validation score increased.  Saving model ...
2025-03-04 16:15:02,708 - {'epoch': 10, 'rec_loss': '7.6246'}
2025-03-04 16:15:17,570 - {'Epoch': 10, 'HR@5': '0.0273', 'NDCG@5': '0.0173', 'HR@10': '0.0476', 'NDCG@10': '0.0239', 'HR@20': '0.0792', 'NDCG@20': '0.0318'}
2025-03-04 16:15:17,575 - Validation score increased.  Saving model ...
2025-03-04 16:16:04,980 - {'epoch': 11, 'rec_loss': '7.5861'}
2025-03-04 16:16:19,825 - {'Epoch': 11, 'HR@5': '0.0290', 'NDCG@5': '0.0179', 'HR@10': '0.0490', 'NDCG@10': '0.0243', 'HR@20': '0.0792', 'NDCG@20': '0.0319'}
2025-03-04 16:16:19,826 - Validation score increased.  Saving model ...
2025-03-04 16:17:07,416 - {'epoch': 12, 'rec_loss': '7.5539'}
2025-03-04 16:17:22,684 - {'Epoch': 12, 'HR@5': '0.0301', 'NDCG@5': '0.0187', 'HR@10': '0.0491', 'NDCG@10': '0.0248', 'HR@20': '0.0795', 'NDCG@20': '0.0324'}
2025-03-04 16:17:22,685 - Validation score increased.  Saving model ...
2025-03-04 16:18:08,739 - {'epoch': 13, 'rec_loss': '7.5213'}
2025-03-04 16:18:23,609 - {'Epoch': 13, 'HR@5': '0.0297', 'NDCG@5': '0.0184', 'HR@10': '0.0502', 'NDCG@10': '0.0250', 'HR@20': '0.0784', 'NDCG@20': '0.0321'}
2025-03-04 16:18:23,610 - EarlyStopping counter: 1 out of 10
2025-03-04 16:19:09,298 - {'epoch': 14, 'rec_loss': '7.4939'}
2025-03-04 16:19:24,229 - {'Epoch': 14, 'HR@5': '0.0297', 'NDCG@5': '0.0188', 'HR@10': '0.0486', 'NDCG@10': '0.0249', 'HR@20': '0.0800', 'NDCG@20': '0.0328'}
2025-03-04 16:19:24,230 - Validation score increased.  Saving model ...
2025-03-04 16:20:10,050 - {'epoch': 15, 'rec_loss': '7.4700'}
2025-03-04 16:20:24,885 - {'Epoch': 15, 'HR@5': '0.0309', 'NDCG@5': '0.0188', 'HR@10': '0.0502', 'NDCG@10': '0.0250', 'HR@20': '0.0810', 'NDCG@20': '0.0327'}
2025-03-04 16:20:24,889 - EarlyStopping counter: 1 out of 10
2025-03-04 16:21:10,186 - {'epoch': 16, 'rec_loss': '7.4468'}
2025-03-04 16:21:25,150 - {'Epoch': 16, 'HR@5': '0.0304', 'NDCG@5': '0.0187', 'HR@10': '0.0502', 'NDCG@10': '0.0251', 'HR@20': '0.0815', 'NDCG@20': '0.0329'}
2025-03-04 16:21:25,151 - Validation score increased.  Saving model ...
2025-03-04 16:22:10,327 - {'epoch': 17, 'rec_loss': '7.4256'}
2025-03-04 16:22:25,432 - {'Epoch': 17, 'HR@5': '0.0313', 'NDCG@5': '0.0195', 'HR@10': '0.0513', 'NDCG@10': '0.0259', 'HR@20': '0.0816', 'NDCG@20': '0.0335'}
2025-03-04 16:22:25,433 - Validation score increased.  Saving model ...
2025-03-04 16:23:11,201 - {'epoch': 18, 'rec_loss': '7.4023'}
2025-03-04 16:23:26,197 - {'Epoch': 18, 'HR@5': '0.0305', 'NDCG@5': '0.0190', 'HR@10': '0.0504', 'NDCG@10': '0.0254', 'HR@20': '0.0815', 'NDCG@20': '0.0332'}
2025-03-04 16:23:26,198 - EarlyStopping counter: 1 out of 10
2025-03-04 16:24:11,793 - {'epoch': 19, 'rec_loss': '7.3872'}
2025-03-04 16:24:26,905 - {'Epoch': 19, 'HR@5': '0.0307', 'NDCG@5': '0.0192', 'HR@10': '0.0514', 'NDCG@10': '0.0258', 'HR@20': '0.0818', 'NDCG@20': '0.0334'}
2025-03-04 16:24:26,906 - EarlyStopping counter: 2 out of 10
2025-03-04 16:25:12,350 - {'epoch': 20, 'rec_loss': '7.3716'}
2025-03-04 16:25:27,117 - {'Epoch': 20, 'HR@5': '0.0304', 'NDCG@5': '0.0190', 'HR@10': '0.0501', 'NDCG@10': '0.0254', 'HR@20': '0.0821', 'NDCG@20': '0.0335'}
2025-03-04 16:25:27,118 - EarlyStopping counter: 3 out of 10
2025-03-04 16:26:12,105 - {'epoch': 21, 'rec_loss': '7.3614'}
2025-03-04 16:26:27,190 - {'Epoch': 21, 'HR@5': '0.0300', 'NDCG@5': '0.0191', 'HR@10': '0.0513', 'NDCG@10': '0.0260', 'HR@20': '0.0822', 'NDCG@20': '0.0337'}
2025-03-04 16:26:27,191 - Validation score increased.  Saving model ...
2025-03-04 16:27:13,010 - {'epoch': 22, 'rec_loss': '7.3459'}
2025-03-04 16:27:28,701 - {'Epoch': 22, 'HR@5': '0.0302', 'NDCG@5': '0.0187', 'HR@10': '0.0507', 'NDCG@10': '0.0253', 'HR@20': '0.0827', 'NDCG@20': '0.0333'}
2025-03-04 16:27:28,703 - EarlyStopping counter: 1 out of 10
2025-03-04 16:28:15,413 - {'epoch': 23, 'rec_loss': '7.3267'}
2025-03-04 16:28:30,849 - {'Epoch': 23, 'HR@5': '0.0314', 'NDCG@5': '0.0194', 'HR@10': '0.0514', 'NDCG@10': '0.0258', 'HR@20': '0.0840', 'NDCG@20': '0.0339'}
2025-03-04 16:28:30,850 - Validation score increased.  Saving model ...
2025-03-04 16:29:17,401 - {'epoch': 24, 'rec_loss': '7.3171'}
2025-03-04 16:29:32,763 - {'Epoch': 24, 'HR@5': '0.0319', 'NDCG@5': '0.0199', 'HR@10': '0.0521', 'NDCG@10': '0.0263', 'HR@20': '0.0825', 'NDCG@20': '0.0340'}
2025-03-04 16:29:32,764 - Validation score increased.  Saving model ...
2025-03-04 16:30:21,394 - {'epoch': 25, 'rec_loss': '7.3034'}
2025-03-04 16:30:38,592 - {'Epoch': 25, 'HR@5': '0.0308', 'NDCG@5': '0.0197', 'HR@10': '0.0521', 'NDCG@10': '0.0265', 'HR@20': '0.0833', 'NDCG@20': '0.0343'}
2025-03-04 16:30:38,594 - Validation score increased.  Saving model ...
2025-03-04 16:31:24,587 - {'epoch': 26, 'rec_loss': '7.2949'}
2025-03-04 16:31:39,720 - {'Epoch': 26, 'HR@5': '0.0306', 'NDCG@5': '0.0192', 'HR@10': '0.0517', 'NDCG@10': '0.0260', 'HR@20': '0.0818', 'NDCG@20': '0.0336'}
2025-03-04 16:31:39,721 - EarlyStopping counter: 1 out of 10
2025-03-04 16:32:24,240 - {'epoch': 27, 'rec_loss': '7.2850'}
2025-03-04 16:32:39,734 - {'Epoch': 27, 'HR@5': '0.0321', 'NDCG@5': '0.0201', 'HR@10': '0.0521', 'NDCG@10': '0.0265', 'HR@20': '0.0823', 'NDCG@20': '0.0340'}
2025-03-04 16:32:39,736 - EarlyStopping counter: 2 out of 10
2025-03-04 16:33:27,113 - {'epoch': 28, 'rec_loss': '7.2745'}
2025-03-04 16:33:44,766 - {'Epoch': 28, 'HR@5': '0.0319', 'NDCG@5': '0.0199', 'HR@10': '0.0512', 'NDCG@10': '0.0261', 'HR@20': '0.0833', 'NDCG@20': '0.0341'}
2025-03-04 16:33:44,767 - EarlyStopping counter: 3 out of 10
2025-03-04 16:34:32,273 - {'epoch': 29, 'rec_loss': '7.2652'}
2025-03-04 16:34:50,265 - {'Epoch': 29, 'HR@5': '0.0308', 'NDCG@5': '0.0195', 'HR@10': '0.0510', 'NDCG@10': '0.0259', 'HR@20': '0.0816', 'NDCG@20': '0.0336'}
2025-03-04 16:34:50,266 - EarlyStopping counter: 4 out of 10
2025-03-04 16:35:41,270 - {'epoch': 30, 'rec_loss': '7.2560'}
2025-03-04 16:35:59,596 - {'Epoch': 30, 'HR@5': '0.0318', 'NDCG@5': '0.0202', 'HR@10': '0.0518', 'NDCG@10': '0.0266', 'HR@20': '0.0835', 'NDCG@20': '0.0345'}
2025-03-04 16:35:59,598 - Validation score increased.  Saving model ...
2025-03-04 16:36:48,433 - {'epoch': 31, 'rec_loss': '7.2459'}
2025-03-04 16:37:06,081 - {'Epoch': 31, 'HR@5': '0.0314', 'NDCG@5': '0.0197', 'HR@10': '0.0518', 'NDCG@10': '0.0262', 'HR@20': '0.0838', 'NDCG@20': '0.0343'}
2025-03-04 16:37:06,083 - EarlyStopping counter: 1 out of 10
2025-03-04 16:37:49,675 - {'epoch': 32, 'rec_loss': '7.2390'}
2025-03-04 16:38:06,858 - {'Epoch': 32, 'HR@5': '0.0304', 'NDCG@5': '0.0191', 'HR@10': '0.0526', 'NDCG@10': '0.0262', 'HR@20': '0.0824', 'NDCG@20': '0.0337'}
2025-03-04 16:38:06,859 - EarlyStopping counter: 2 out of 10
2025-03-04 16:38:53,713 - {'epoch': 33, 'rec_loss': '7.2334'}
2025-03-04 16:39:09,949 - {'Epoch': 33, 'HR@5': '0.0322', 'NDCG@5': '0.0202', 'HR@10': '0.0534', 'NDCG@10': '0.0270', 'HR@20': '0.0843', 'NDCG@20': '0.0347'}
2025-03-04 16:39:09,950 - Validation score increased.  Saving model ...
2025-03-04 16:39:53,601 - {'epoch': 34, 'rec_loss': '7.2260'}
2025-03-04 16:40:11,213 - {'Epoch': 34, 'HR@5': '0.0319', 'NDCG@5': '0.0198', 'HR@10': '0.0522', 'NDCG@10': '0.0263', 'HR@20': '0.0832', 'NDCG@20': '0.0341'}
2025-03-04 16:40:11,215 - EarlyStopping counter: 1 out of 10
2025-03-04 16:40:55,179 - {'epoch': 35, 'rec_loss': '7.2209'}
2025-03-04 16:41:12,051 - {'Epoch': 35, 'HR@5': '0.0300', 'NDCG@5': '0.0186', 'HR@10': '0.0502', 'NDCG@10': '0.0250', 'HR@20': '0.0816', 'NDCG@20': '0.0329'}
2025-03-04 16:41:12,053 - EarlyStopping counter: 2 out of 10
2025-03-04 16:41:59,056 - {'epoch': 36, 'rec_loss': '7.2131'}
2025-03-04 16:42:16,412 - {'Epoch': 36, 'HR@5': '0.0314', 'NDCG@5': '0.0196', 'HR@10': '0.0520', 'NDCG@10': '0.0262', 'HR@20': '0.0816', 'NDCG@20': '0.0336'}
2025-03-04 16:42:16,413 - EarlyStopping counter: 3 out of 10
2025-03-04 16:43:01,547 - {'epoch': 37, 'rec_loss': '7.2065'}
2025-03-04 16:43:19,163 - {'Epoch': 37, 'HR@5': '0.0314', 'NDCG@5': '0.0201', 'HR@10': '0.0515', 'NDCG@10': '0.0266', 'HR@20': '0.0830', 'NDCG@20': '0.0345'}
2025-03-04 16:43:19,164 - EarlyStopping counter: 4 out of 10
2025-03-04 16:44:04,235 - {'epoch': 38, 'rec_loss': '7.1948'}
2025-03-04 16:44:22,171 - {'Epoch': 38, 'HR@5': '0.0318', 'NDCG@5': '0.0201', 'HR@10': '0.0511', 'NDCG@10': '0.0263', 'HR@20': '0.0824', 'NDCG@20': '0.0341'}
2025-03-04 16:44:22,173 - EarlyStopping counter: 5 out of 10
2025-03-04 16:45:11,970 - {'epoch': 39, 'rec_loss': '7.1879'}
2025-03-04 16:45:32,728 - {'Epoch': 39, 'HR@5': '0.0318', 'NDCG@5': '0.0202', 'HR@10': '0.0506', 'NDCG@10': '0.0262', 'HR@20': '0.0833', 'NDCG@20': '0.0344'}
2025-03-04 16:45:32,730 - EarlyStopping counter: 6 out of 10
2025-03-04 16:46:23,190 - {'epoch': 40, 'rec_loss': '7.1916'}
2025-03-04 16:46:45,599 - {'Epoch': 40, 'HR@5': '0.0309', 'NDCG@5': '0.0196', 'HR@10': '0.0516', 'NDCG@10': '0.0262', 'HR@20': '0.0818', 'NDCG@20': '0.0337'}
2025-03-04 16:46:45,838 - EarlyStopping counter: 7 out of 10
2025-03-04 16:47:34,311 - {'epoch': 41, 'rec_loss': '7.1812'}
2025-03-04 16:47:51,670 - {'Epoch': 41, 'HR@5': '0.0307', 'NDCG@5': '0.0193', 'HR@10': '0.0522', 'NDCG@10': '0.0262', 'HR@20': '0.0835', 'NDCG@20': '0.0340'}
2025-03-04 16:47:51,671 - EarlyStopping counter: 8 out of 10
2025-03-04 16:48:39,902 - {'epoch': 42, 'rec_loss': '7.1762'}
2025-03-04 16:48:55,260 - {'Epoch': 42, 'HR@5': '0.0314', 'NDCG@5': '0.0198', 'HR@10': '0.0505', 'NDCG@10': '0.0260', 'HR@20': '0.0822', 'NDCG@20': '0.0339'}
2025-03-04 16:48:55,265 - EarlyStopping counter: 9 out of 10
2025-03-04 16:49:44,111 - {'epoch': 43, 'rec_loss': '7.1731'}
2025-03-04 16:50:00,941 - {'Epoch': 43, 'HR@5': '0.0306', 'NDCG@5': '0.0193', 'HR@10': '0.0510', 'NDCG@10': '0.0259', 'HR@20': '0.0825', 'NDCG@20': '0.0338'}
2025-03-04 16:50:00,943 - EarlyStopping counter: 10 out of 10
2025-03-04 16:50:00,943 - Early stopping
2025-03-04 16:50:00,943 - ---------------Test Score---------------
2025-03-04 16:50:18,119 - {'Epoch': 0, 'HR@5': '0.0286', 'NDCG@5': '0.0179', 'HR@10': '0.0485', 'NDCG@10': '0.0243', 'HR@20': '0.0787', 'NDCG@20': '0.0319'}
2025-03-04 16:50:18,120 - Scale_Yelp
2025-03-04 16:50:18,121 - {'Epoch': 0, 'HR@5': '0.0286', 'NDCG@5': '0.0179', 'HR@10': '0.0485', 'NDCG@10': '0.0243', 'HR@20': '0.0787', 'NDCG@20': '0.0319'}
2025-03-04 17:06:11,741 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[2, 8, 12], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-04 17:06:18,216 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-04 17:06:18,224 - Total Parameters: 1437093
2025-03-04 17:07:05,731 - {'epoch': 0, 'rec_loss': '9.5530'}
2025-03-04 17:07:21,612 - {'Epoch': 0, 'HR@5': '0.0086', 'NDCG@5': '0.0056', 'HR@10': '0.0137', 'NDCG@10': '0.0072', 'HR@20': '0.0250', 'NDCG@20': '0.0101'}
2025-03-04 17:07:21,614 - Validation score increased.  Saving model ...
2025-03-04 17:08:06,575 - {'epoch': 1, 'rec_loss': '8.9667'}
2025-03-04 17:08:22,989 - {'Epoch': 1, 'HR@5': '0.0131', 'NDCG@5': '0.0082', 'HR@10': '0.0218', 'NDCG@10': '0.0110', 'HR@20': '0.0373', 'NDCG@20': '0.0149'}
2025-03-04 17:08:22,992 - Validation score increased.  Saving model ...
2025-03-04 17:09:08,451 - {'epoch': 2, 'rec_loss': '8.5567'}
2025-03-04 17:09:25,106 - {'Epoch': 2, 'HR@5': '0.0182', 'NDCG@5': '0.0112', 'HR@10': '0.0306', 'NDCG@10': '0.0152', 'HR@20': '0.0509', 'NDCG@20': '0.0203'}
2025-03-04 17:09:25,108 - Validation score increased.  Saving model ...
2025-03-04 17:10:11,702 - {'epoch': 3, 'rec_loss': '8.2744'}
2025-03-04 17:10:29,052 - {'Epoch': 3, 'HR@5': '0.0207', 'NDCG@5': '0.0126', 'HR@10': '0.0359', 'NDCG@10': '0.0175', 'HR@20': '0.0585', 'NDCG@20': '0.0231'}
2025-03-04 17:10:29,058 - Validation score increased.  Saving model ...
2025-03-04 17:11:13,543 - {'epoch': 4, 'rec_loss': '8.0955'}
2025-03-04 17:11:28,668 - {'Epoch': 4, 'HR@5': '0.0224', 'NDCG@5': '0.0141', 'HR@10': '0.0390', 'NDCG@10': '0.0194', 'HR@20': '0.0659', 'NDCG@20': '0.0261'}
2025-03-04 17:11:28,671 - Validation score increased.  Saving model ...
2025-03-04 17:12:11,738 - {'epoch': 5, 'rec_loss': '7.9628'}
2025-03-04 17:12:26,758 - {'Epoch': 5, 'HR@5': '0.0249', 'NDCG@5': '0.0157', 'HR@10': '0.0429', 'NDCG@10': '0.0215', 'HR@20': '0.0683', 'NDCG@20': '0.0279'}
2025-03-04 17:12:26,763 - Validation score increased.  Saving model ...
2025-03-04 17:13:11,710 - {'epoch': 6, 'rec_loss': '7.8633'}
2025-03-04 17:13:29,075 - {'Epoch': 6, 'HR@5': '0.0255', 'NDCG@5': '0.0160', 'HR@10': '0.0441', 'NDCG@10': '0.0220', 'HR@20': '0.0732', 'NDCG@20': '0.0293'}
2025-03-04 17:13:29,076 - Validation score increased.  Saving model ...
2025-03-04 17:14:12,745 - {'epoch': 7, 'rec_loss': '7.7859'}
2025-03-04 17:14:30,133 - {'Epoch': 7, 'HR@5': '0.0252', 'NDCG@5': '0.0156', 'HR@10': '0.0450', 'NDCG@10': '0.0220', 'HR@20': '0.0743', 'NDCG@20': '0.0294'}
2025-03-04 17:14:30,134 - Validation score increased.  Saving model ...
2025-03-04 17:15:13,313 - {'epoch': 8, 'rec_loss': '7.7175'}
2025-03-04 17:15:30,515 - {'Epoch': 8, 'HR@5': '0.0279', 'NDCG@5': '0.0173', 'HR@10': '0.0462', 'NDCG@10': '0.0232', 'HR@20': '0.0737', 'NDCG@20': '0.0301'}
2025-03-04 17:15:30,517 - Validation score increased.  Saving model ...
2025-03-04 17:16:15,879 - {'epoch': 9, 'rec_loss': '7.6679'}
2025-03-04 17:16:32,737 - {'Epoch': 9, 'HR@5': '0.0279', 'NDCG@5': '0.0172', 'HR@10': '0.0471', 'NDCG@10': '0.0234', 'HR@20': '0.0763', 'NDCG@20': '0.0307'}
2025-03-04 17:16:32,739 - Validation score increased.  Saving model ...
2025-03-04 17:17:15,475 - {'epoch': 10, 'rec_loss': '7.6213'}
2025-03-04 17:17:30,622 - {'Epoch': 10, 'HR@5': '0.0277', 'NDCG@5': '0.0175', 'HR@10': '0.0475', 'NDCG@10': '0.0238', 'HR@20': '0.0775', 'NDCG@20': '0.0314'}
2025-03-04 17:17:30,624 - Validation score increased.  Saving model ...
2025-03-04 17:18:13,772 - {'epoch': 11, 'rec_loss': '7.5825'}
2025-03-04 17:18:30,454 - {'Epoch': 11, 'HR@5': '0.0288', 'NDCG@5': '0.0179', 'HR@10': '0.0494', 'NDCG@10': '0.0245', 'HR@20': '0.0787', 'NDCG@20': '0.0318'}
2025-03-04 17:18:30,455 - Validation score increased.  Saving model ...
2025-03-04 17:19:17,616 - {'epoch': 12, 'rec_loss': '7.5512'}
2025-03-04 17:19:35,107 - {'Epoch': 12, 'HR@5': '0.0294', 'NDCG@5': '0.0185', 'HR@10': '0.0490', 'NDCG@10': '0.0248', 'HR@20': '0.0795', 'NDCG@20': '0.0325'}
2025-03-04 17:19:35,109 - Validation score increased.  Saving model ...
2025-03-04 17:20:18,430 - {'epoch': 13, 'rec_loss': '7.5203'}
2025-03-04 17:20:33,833 - {'Epoch': 13, 'HR@5': '0.0300', 'NDCG@5': '0.0186', 'HR@10': '0.0489', 'NDCG@10': '0.0247', 'HR@20': '0.0786', 'NDCG@20': '0.0322'}
2025-03-04 17:20:33,839 - EarlyStopping counter: 1 out of 10
2025-03-04 17:21:17,571 - {'epoch': 14, 'rec_loss': '7.4959'}
2025-03-04 17:21:35,131 - {'Epoch': 14, 'HR@5': '0.0298', 'NDCG@5': '0.0188', 'HR@10': '0.0494', 'NDCG@10': '0.0251', 'HR@20': '0.0789', 'NDCG@20': '0.0325'}
2025-03-04 17:21:35,134 - Validation score increased.  Saving model ...
2025-03-04 17:22:22,044 - {'epoch': 15, 'rec_loss': '7.4759'}
2025-03-04 17:22:38,452 - {'Epoch': 15, 'HR@5': '0.0306', 'NDCG@5': '0.0186', 'HR@10': '0.0495', 'NDCG@10': '0.0247', 'HR@20': '0.0801', 'NDCG@20': '0.0324'}
2025-03-04 17:22:38,454 - EarlyStopping counter: 1 out of 10
2025-03-04 17:23:24,001 - {'epoch': 16, 'rec_loss': '7.4537'}
2025-03-04 17:23:40,491 - {'Epoch': 16, 'HR@5': '0.0303', 'NDCG@5': '0.0185', 'HR@10': '0.0501', 'NDCG@10': '0.0248', 'HR@20': '0.0812', 'NDCG@20': '0.0326'}
2025-03-04 17:23:40,493 - Validation score increased.  Saving model ...
2025-03-04 17:24:27,719 - {'epoch': 17, 'rec_loss': '7.4330'}
2025-03-04 17:24:50,203 - {'Epoch': 17, 'HR@5': '0.0304', 'NDCG@5': '0.0187', 'HR@10': '0.0511', 'NDCG@10': '0.0253', 'HR@20': '0.0809', 'NDCG@20': '0.0328'}
2025-03-04 17:24:51,067 - Validation score increased.  Saving model ...
2025-03-04 17:43:03,051 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[2, 8, 12], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-04 17:43:18,720 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-04 17:43:18,734 - Total Parameters: 1437093
2025-03-04 17:44:11,114 - {'epoch': 0, 'rec_loss': '9.5530'}
2025-03-04 17:44:27,041 - {'Epoch': 0, 'HR@5': '0.0086', 'NDCG@5': '0.0056', 'HR@10': '0.0137', 'NDCG@10': '0.0072', 'HR@20': '0.0250', 'NDCG@20': '0.0101'}
2025-03-04 17:44:27,042 - Validation score increased.  Saving model ...
2025-03-04 17:45:12,841 - {'epoch': 1, 'rec_loss': '8.9667'}
2025-03-04 17:45:27,753 - {'Epoch': 1, 'HR@5': '0.0131', 'NDCG@5': '0.0082', 'HR@10': '0.0218', 'NDCG@10': '0.0110', 'HR@20': '0.0373', 'NDCG@20': '0.0149'}
2025-03-04 17:45:27,758 - Validation score increased.  Saving model ...
2025-03-04 17:46:17,963 - {'epoch': 2, 'rec_loss': '8.5567'}
2025-03-04 17:46:32,486 - {'Epoch': 2, 'HR@5': '0.0182', 'NDCG@5': '0.0112', 'HR@10': '0.0306', 'NDCG@10': '0.0152', 'HR@20': '0.0509', 'NDCG@20': '0.0203'}
2025-03-04 17:46:32,490 - Validation score increased.  Saving model ...
2025-03-04 17:47:17,219 - {'epoch': 3, 'rec_loss': '8.2744'}
2025-03-04 17:47:31,540 - {'Epoch': 3, 'HR@5': '0.0207', 'NDCG@5': '0.0126', 'HR@10': '0.0359', 'NDCG@10': '0.0175', 'HR@20': '0.0585', 'NDCG@20': '0.0231'}
2025-03-04 17:47:31,542 - Validation score increased.  Saving model ...
2025-03-04 17:48:19,393 - {'epoch': 4, 'rec_loss': '8.0955'}
2025-03-04 17:48:33,790 - {'Epoch': 4, 'HR@5': '0.0224', 'NDCG@5': '0.0141', 'HR@10': '0.0390', 'NDCG@10': '0.0194', 'HR@20': '0.0659', 'NDCG@20': '0.0261'}
2025-03-04 17:48:33,795 - Validation score increased.  Saving model ...
2025-03-04 17:49:17,075 - {'epoch': 5, 'rec_loss': '7.9628'}
2025-03-04 17:49:32,154 - {'Epoch': 5, 'HR@5': '0.0249', 'NDCG@5': '0.0157', 'HR@10': '0.0429', 'NDCG@10': '0.0215', 'HR@20': '0.0683', 'NDCG@20': '0.0279'}
2025-03-04 17:49:32,159 - Validation score increased.  Saving model ...
2025-03-04 17:50:16,077 - {'epoch': 6, 'rec_loss': '7.8633'}
2025-03-04 17:50:31,531 - {'Epoch': 6, 'HR@5': '0.0255', 'NDCG@5': '0.0160', 'HR@10': '0.0441', 'NDCG@10': '0.0220', 'HR@20': '0.0732', 'NDCG@20': '0.0293'}
2025-03-04 17:50:31,533 - Validation score increased.  Saving model ...
2025-03-04 17:51:16,783 - {'epoch': 7, 'rec_loss': '7.7859'}
2025-03-04 17:51:31,686 - {'Epoch': 7, 'HR@5': '0.0252', 'NDCG@5': '0.0156', 'HR@10': '0.0450', 'NDCG@10': '0.0220', 'HR@20': '0.0743', 'NDCG@20': '0.0294'}
2025-03-04 17:51:31,688 - Validation score increased.  Saving model ...
2025-03-04 17:52:15,796 - {'epoch': 8, 'rec_loss': '7.7175'}
2025-03-04 17:52:31,105 - {'Epoch': 8, 'HR@5': '0.0279', 'NDCG@5': '0.0173', 'HR@10': '0.0462', 'NDCG@10': '0.0232', 'HR@20': '0.0737', 'NDCG@20': '0.0301'}
2025-03-04 17:52:31,107 - Validation score increased.  Saving model ...
2025-03-04 17:53:15,740 - {'epoch': 9, 'rec_loss': '7.6679'}
2025-03-04 17:53:33,308 - {'Epoch': 9, 'HR@5': '0.0279', 'NDCG@5': '0.0172', 'HR@10': '0.0471', 'NDCG@10': '0.0234', 'HR@20': '0.0763', 'NDCG@20': '0.0307'}
2025-03-04 17:53:33,312 - Validation score increased.  Saving model ...
2025-03-04 17:54:20,090 - {'epoch': 10, 'rec_loss': '7.6213'}
2025-03-04 17:54:35,307 - {'Epoch': 10, 'HR@5': '0.0277', 'NDCG@5': '0.0175', 'HR@10': '0.0475', 'NDCG@10': '0.0238', 'HR@20': '0.0775', 'NDCG@20': '0.0314'}
2025-03-04 17:54:35,309 - Validation score increased.  Saving model ...
2025-03-04 17:55:19,922 - {'epoch': 11, 'rec_loss': '7.5825'}
2025-03-04 17:55:36,642 - {'Epoch': 11, 'HR@5': '0.0288', 'NDCG@5': '0.0179', 'HR@10': '0.0494', 'NDCG@10': '0.0245', 'HR@20': '0.0787', 'NDCG@20': '0.0318'}
2025-03-04 17:55:36,644 - Validation score increased.  Saving model ...
2025-03-04 17:56:20,044 - {'epoch': 12, 'rec_loss': '7.5512'}
2025-03-04 17:56:35,352 - {'Epoch': 12, 'HR@5': '0.0294', 'NDCG@5': '0.0185', 'HR@10': '0.0490', 'NDCG@10': '0.0248', 'HR@20': '0.0795', 'NDCG@20': '0.0325'}
2025-03-04 17:56:35,353 - Validation score increased.  Saving model ...
2025-03-04 17:57:19,515 - {'epoch': 13, 'rec_loss': '7.5203'}
2025-03-04 17:57:34,972 - {'Epoch': 13, 'HR@5': '0.0300', 'NDCG@5': '0.0186', 'HR@10': '0.0489', 'NDCG@10': '0.0247', 'HR@20': '0.0786', 'NDCG@20': '0.0322'}
2025-03-04 17:57:34,975 - EarlyStopping counter: 1 out of 10
2025-03-04 17:58:20,646 - {'epoch': 14, 'rec_loss': '7.4959'}
2025-03-04 17:58:37,448 - {'Epoch': 14, 'HR@5': '0.0298', 'NDCG@5': '0.0188', 'HR@10': '0.0494', 'NDCG@10': '0.0251', 'HR@20': '0.0789', 'NDCG@20': '0.0325'}
2025-03-04 17:58:37,449 - Validation score increased.  Saving model ...
2025-03-04 17:59:21,733 - {'epoch': 15, 'rec_loss': '7.4759'}
2025-03-04 17:59:38,905 - {'Epoch': 15, 'HR@5': '0.0306', 'NDCG@5': '0.0186', 'HR@10': '0.0495', 'NDCG@10': '0.0247', 'HR@20': '0.0801', 'NDCG@20': '0.0324'}
2025-03-04 17:59:38,906 - EarlyStopping counter: 1 out of 10
2025-03-04 18:00:24,912 - {'epoch': 16, 'rec_loss': '7.4537'}
2025-03-04 18:00:41,919 - {'Epoch': 16, 'HR@5': '0.0303', 'NDCG@5': '0.0185', 'HR@10': '0.0501', 'NDCG@10': '0.0248', 'HR@20': '0.0812', 'NDCG@20': '0.0326'}
2025-03-04 18:00:41,920 - Validation score increased.  Saving model ...
2025-03-04 18:01:28,331 - {'epoch': 17, 'rec_loss': '7.4330'}
2025-03-04 18:01:45,216 - {'Epoch': 17, 'HR@5': '0.0304', 'NDCG@5': '0.0187', 'HR@10': '0.0511', 'NDCG@10': '0.0253', 'HR@20': '0.0809', 'NDCG@20': '0.0328'}
2025-03-04 18:01:45,220 - Validation score increased.  Saving model ...
2025-03-04 18:02:30,257 - {'epoch': 18, 'rec_loss': '7.4103'}
2025-03-04 18:02:46,428 - {'Epoch': 18, 'HR@5': '0.0300', 'NDCG@5': '0.0189', 'HR@10': '0.0490', 'NDCG@10': '0.0250', 'HR@20': '0.0813', 'NDCG@20': '0.0331'}
2025-03-04 18:02:46,430 - Validation score increased.  Saving model ...
2025-03-04 18:03:29,891 - {'epoch': 19, 'rec_loss': '7.3954'}
2025-03-04 18:03:47,757 - {'Epoch': 19, 'HR@5': '0.0302', 'NDCG@5': '0.0188', 'HR@10': '0.0503', 'NDCG@10': '0.0252', 'HR@20': '0.0819', 'NDCG@20': '0.0332'}
2025-03-04 18:03:47,761 - Validation score increased.  Saving model ...
2025-03-04 18:04:33,276 - {'epoch': 20, 'rec_loss': '7.3790'}
2025-03-04 18:04:48,361 - {'Epoch': 20, 'HR@5': '0.0301', 'NDCG@5': '0.0189', 'HR@10': '0.0504', 'NDCG@10': '0.0254', 'HR@20': '0.0816', 'NDCG@20': '0.0332'}
2025-03-04 18:04:48,363 - Validation score increased.  Saving model ...
2025-03-04 18:05:32,471 - {'epoch': 21, 'rec_loss': '7.3699'}
2025-03-04 18:05:48,895 - {'Epoch': 21, 'HR@5': '0.0301', 'NDCG@5': '0.0190', 'HR@10': '0.0515', 'NDCG@10': '0.0259', 'HR@20': '0.0816', 'NDCG@20': '0.0334'}
2025-03-04 18:05:48,899 - Validation score increased.  Saving model ...
2025-03-04 18:06:33,650 - {'epoch': 22, 'rec_loss': '7.3541'}
2025-03-04 18:06:50,908 - {'Epoch': 22, 'HR@5': '0.0301', 'NDCG@5': '0.0188', 'HR@10': '0.0499', 'NDCG@10': '0.0251', 'HR@20': '0.0812', 'NDCG@20': '0.0329'}
2025-03-04 18:06:50,910 - EarlyStopping counter: 1 out of 10
2025-03-04 18:07:35,329 - {'epoch': 23, 'rec_loss': '7.3344'}
2025-03-04 18:07:53,049 - {'Epoch': 23, 'HR@5': '0.0306', 'NDCG@5': '0.0188', 'HR@10': '0.0503', 'NDCG@10': '0.0251', 'HR@20': '0.0827', 'NDCG@20': '0.0332'}
2025-03-04 18:07:53,053 - EarlyStopping counter: 2 out of 10
2025-03-04 18:08:36,494 - {'epoch': 24, 'rec_loss': '7.3226'}
2025-03-04 18:08:53,135 - {'Epoch': 24, 'HR@5': '0.0316', 'NDCG@5': '0.0197', 'HR@10': '0.0516', 'NDCG@10': '0.0261', 'HR@20': '0.0823', 'NDCG@20': '0.0339'}
2025-03-04 18:08:53,140 - Validation score increased.  Saving model ...
2025-03-04 18:09:40,568 - {'epoch': 25, 'rec_loss': '7.3095'}
2025-03-04 18:09:55,816 - {'Epoch': 25, 'HR@5': '0.0300', 'NDCG@5': '0.0191', 'HR@10': '0.0501', 'NDCG@10': '0.0255', 'HR@20': '0.0815', 'NDCG@20': '0.0334'}
2025-03-04 18:09:55,820 - EarlyStopping counter: 1 out of 10
2025-03-04 18:10:39,827 - {'epoch': 26, 'rec_loss': '7.3007'}
2025-03-04 18:10:54,855 - {'Epoch': 26, 'HR@5': '0.0303', 'NDCG@5': '0.0190', 'HR@10': '0.0508', 'NDCG@10': '0.0256', 'HR@20': '0.0820', 'NDCG@20': '0.0335'}
2025-03-04 18:10:54,857 - EarlyStopping counter: 2 out of 10
2025-03-04 18:11:40,536 - {'epoch': 27, 'rec_loss': '7.2910'}
2025-03-04 18:11:55,867 - {'Epoch': 27, 'HR@5': '0.0326', 'NDCG@5': '0.0200', 'HR@10': '0.0509', 'NDCG@10': '0.0259', 'HR@20': '0.0814', 'NDCG@20': '0.0335'}
2025-03-04 18:11:55,871 - EarlyStopping counter: 3 out of 10
2025-03-04 18:12:42,408 - {'epoch': 28, 'rec_loss': '7.2796'}
2025-03-04 18:12:58,485 - {'Epoch': 28, 'HR@5': '0.0308', 'NDCG@5': '0.0194', 'HR@10': '0.0509', 'NDCG@10': '0.0259', 'HR@20': '0.0823', 'NDCG@20': '0.0337'}
2025-03-04 18:12:58,488 - EarlyStopping counter: 4 out of 10
2025-03-04 18:13:45,586 - {'epoch': 29, 'rec_loss': '7.2704'}
2025-03-04 18:14:03,269 - {'Epoch': 29, 'HR@5': '0.0301', 'NDCG@5': '0.0190', 'HR@10': '0.0498', 'NDCG@10': '0.0253', 'HR@20': '0.0800', 'NDCG@20': '0.0329'}
2025-03-04 18:14:03,271 - EarlyStopping counter: 5 out of 10
2025-03-04 18:14:47,655 - {'epoch': 30, 'rec_loss': '7.2609'}
2025-03-04 18:15:04,221 - {'Epoch': 30, 'HR@5': '0.0316', 'NDCG@5': '0.0199', 'HR@10': '0.0525', 'NDCG@10': '0.0265', 'HR@20': '0.0825', 'NDCG@20': '0.0341'}
2025-03-04 18:15:04,222 - Validation score increased.  Saving model ...
2025-03-04 18:15:48,145 - {'epoch': 31, 'rec_loss': '7.2503'}
2025-03-04 18:16:03,423 - {'Epoch': 31, 'HR@5': '0.0309', 'NDCG@5': '0.0191', 'HR@10': '0.0512', 'NDCG@10': '0.0256', 'HR@20': '0.0832', 'NDCG@20': '0.0337'}
2025-03-04 18:16:03,424 - EarlyStopping counter: 1 out of 10
2025-03-04 18:16:48,083 - {'epoch': 32, 'rec_loss': '7.2430'}
2025-03-04 18:17:03,196 - {'Epoch': 32, 'HR@5': '0.0295', 'NDCG@5': '0.0184', 'HR@10': '0.0508', 'NDCG@10': '0.0252', 'HR@20': '0.0823', 'NDCG@20': '0.0332'}
2025-03-04 18:17:03,197 - EarlyStopping counter: 2 out of 10
2025-03-04 18:17:47,666 - {'epoch': 33, 'rec_loss': '7.2386'}
2025-03-04 18:18:03,955 - {'Epoch': 33, 'HR@5': '0.0319', 'NDCG@5': '0.0199', 'HR@10': '0.0522', 'NDCG@10': '0.0264', 'HR@20': '0.0843', 'NDCG@20': '0.0345'}
2025-03-04 18:18:03,958 - Validation score increased.  Saving model ...
2025-03-04 18:18:46,681 - {'epoch': 34, 'rec_loss': '7.2312'}
2025-03-04 18:19:03,187 - {'Epoch': 34, 'HR@5': '0.0316', 'NDCG@5': '0.0196', 'HR@10': '0.0513', 'NDCG@10': '0.0259', 'HR@20': '0.0819', 'NDCG@20': '0.0335'}
2025-03-04 18:19:03,188 - EarlyStopping counter: 1 out of 10
2025-03-04 18:19:50,477 - {'epoch': 35, 'rec_loss': '7.2269'}
2025-03-04 18:20:07,136 - {'Epoch': 35, 'HR@5': '0.0300', 'NDCG@5': '0.0184', 'HR@10': '0.0497', 'NDCG@10': '0.0247', 'HR@20': '0.0803', 'NDCG@20': '0.0324'}
2025-03-04 18:20:07,138 - EarlyStopping counter: 2 out of 10
2025-03-04 18:20:54,013 - {'epoch': 36, 'rec_loss': '7.2194'}
2025-03-04 18:21:09,741 - {'Epoch': 36, 'HR@5': '0.0310', 'NDCG@5': '0.0193', 'HR@10': '0.0508', 'NDCG@10': '0.0257', 'HR@20': '0.0810', 'NDCG@20': '0.0332'}
2025-03-04 18:21:09,743 - EarlyStopping counter: 3 out of 10
2025-03-04 18:21:57,869 - {'epoch': 37, 'rec_loss': '7.2109'}
2025-03-04 18:22:13,344 - {'Epoch': 37, 'HR@5': '0.0308', 'NDCG@5': '0.0196', 'HR@10': '0.0511', 'NDCG@10': '0.0261', 'HR@20': '0.0823', 'NDCG@20': '0.0339'}
2025-03-04 18:22:13,348 - EarlyStopping counter: 4 out of 10
2025-03-04 18:23:00,503 - {'epoch': 38, 'rec_loss': '7.1983'}
2025-03-04 18:23:16,638 - {'Epoch': 38, 'HR@5': '0.0313', 'NDCG@5': '0.0196', 'HR@10': '0.0517', 'NDCG@10': '0.0262', 'HR@20': '0.0812', 'NDCG@20': '0.0336'}
2025-03-04 18:23:16,639 - EarlyStopping counter: 5 out of 10
2025-03-04 18:23:59,312 - {'epoch': 39, 'rec_loss': '7.1913'}
2025-03-04 18:24:16,333 - {'Epoch': 39, 'HR@5': '0.0313', 'NDCG@5': '0.0197', 'HR@10': '0.0506', 'NDCG@10': '0.0258', 'HR@20': '0.0829', 'NDCG@20': '0.0339'}
2025-03-04 18:24:16,335 - EarlyStopping counter: 6 out of 10
2025-03-04 18:24:59,895 - {'epoch': 40, 'rec_loss': '7.1965'}
2025-03-04 18:25:15,032 - {'Epoch': 40, 'HR@5': '0.0305', 'NDCG@5': '0.0193', 'HR@10': '0.0503', 'NDCG@10': '0.0256', 'HR@20': '0.0817', 'NDCG@20': '0.0335'}
2025-03-04 18:25:15,036 - EarlyStopping counter: 7 out of 10
2025-03-04 18:26:03,609 - {'epoch': 41, 'rec_loss': '7.1840'}
2025-03-04 18:26:19,178 - {'Epoch': 41, 'HR@5': '0.0311', 'NDCG@5': '0.0195', 'HR@10': '0.0519', 'NDCG@10': '0.0262', 'HR@20': '0.0829', 'NDCG@20': '0.0340'}
2025-03-04 18:26:19,183 - EarlyStopping counter: 8 out of 10
2025-03-04 18:27:06,052 - {'epoch': 42, 'rec_loss': '7.1811'}
2025-03-04 18:27:21,306 - {'Epoch': 42, 'HR@5': '0.0313', 'NDCG@5': '0.0197', 'HR@10': '0.0499', 'NDCG@10': '0.0256', 'HR@20': '0.0812', 'NDCG@20': '0.0335'}
2025-03-04 18:27:21,308 - EarlyStopping counter: 9 out of 10
2025-03-04 18:28:05,586 - {'epoch': 43, 'rec_loss': '7.1776'}
2025-03-04 18:28:22,323 - {'Epoch': 43, 'HR@5': '0.0303', 'NDCG@5': '0.0190', 'HR@10': '0.0510', 'NDCG@10': '0.0257', 'HR@20': '0.0821', 'NDCG@20': '0.0335'}
2025-03-04 18:28:22,325 - EarlyStopping counter: 10 out of 10
2025-03-04 18:28:22,325 - Early stopping
2025-03-04 18:28:22,325 - ---------------Test Score---------------
2025-03-04 18:28:39,397 - {'Epoch': 0, 'HR@5': '0.0283', 'NDCG@5': '0.0179', 'HR@10': '0.0483', 'NDCG@10': '0.0243', 'HR@20': '0.0778', 'NDCG@20': '0.0317'}
2025-03-04 18:28:39,401 - Scale_Yelp
2025-03-04 18:28:39,402 - {'Epoch': 0, 'HR@5': '0.0283', 'NDCG@5': '0.0179', 'HR@10': '0.0483', 'NDCG@10': '0.0243', 'HR@20': '0.0778', 'NDCG@20': '0.0317'}
2025-03-04 19:41:33,973 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[2, 8, 12], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-04 19:41:37,593 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-04 19:41:37,602 - Total Parameters: 1437093
2025-03-04 19:42:29,186 - {'epoch': 0, 'rec_loss': '9.5530'}
2025-03-04 19:42:46,164 - {'Epoch': 0, 'HR@5': '0.0086', 'NDCG@5': '0.0056', 'HR@10': '0.0137', 'NDCG@10': '0.0072', 'HR@20': '0.0250', 'NDCG@20': '0.0101'}
2025-03-04 19:42:46,169 - Validation score increased.  Saving model ...
2025-03-04 19:43:35,785 - {'epoch': 1, 'rec_loss': '8.9667'}
2025-03-04 19:43:54,561 - {'Epoch': 1, 'HR@5': '0.0131', 'NDCG@5': '0.0082', 'HR@10': '0.0218', 'NDCG@10': '0.0110', 'HR@20': '0.0373', 'NDCG@20': '0.0149'}
2025-03-04 19:43:54,563 - Validation score increased.  Saving model ...
2025-03-04 19:44:42,177 - {'epoch': 2, 'rec_loss': '8.5567'}
2025-03-04 19:44:58,124 - {'Epoch': 2, 'HR@5': '0.0182', 'NDCG@5': '0.0112', 'HR@10': '0.0306', 'NDCG@10': '0.0152', 'HR@20': '0.0509', 'NDCG@20': '0.0203'}
2025-03-04 19:44:58,126 - Validation score increased.  Saving model ...
2025-03-04 19:45:43,983 - {'epoch': 3, 'rec_loss': '8.2744'}
2025-03-04 19:46:00,841 - {'Epoch': 3, 'HR@5': '0.0207', 'NDCG@5': '0.0126', 'HR@10': '0.0359', 'NDCG@10': '0.0175', 'HR@20': '0.0585', 'NDCG@20': '0.0231'}
2025-03-04 19:46:00,843 - Validation score increased.  Saving model ...
2025-03-04 19:46:48,428 - {'epoch': 4, 'rec_loss': '8.0955'}
2025-03-04 19:47:05,677 - {'Epoch': 4, 'HR@5': '0.0224', 'NDCG@5': '0.0141', 'HR@10': '0.0390', 'NDCG@10': '0.0194', 'HR@20': '0.0659', 'NDCG@20': '0.0261'}
2025-03-04 19:47:05,679 - Validation score increased.  Saving model ...
2025-03-04 19:47:52,108 - {'epoch': 5, 'rec_loss': '7.9628'}
2025-03-04 19:48:11,157 - {'Epoch': 5, 'HR@5': '0.0249', 'NDCG@5': '0.0157', 'HR@10': '0.0429', 'NDCG@10': '0.0215', 'HR@20': '0.0683', 'NDCG@20': '0.0279'}
2025-03-04 19:48:11,159 - Validation score increased.  Saving model ...
2025-03-04 19:48:58,098 - {'epoch': 6, 'rec_loss': '7.8633'}
2025-03-04 19:49:16,269 - {'Epoch': 6, 'HR@5': '0.0255', 'NDCG@5': '0.0160', 'HR@10': '0.0441', 'NDCG@10': '0.0220', 'HR@20': '0.0732', 'NDCG@20': '0.0293'}
2025-03-04 19:49:16,271 - Validation score increased.  Saving model ...
2025-03-04 19:50:03,066 - {'epoch': 7, 'rec_loss': '7.7859'}
2025-03-04 19:50:19,198 - {'Epoch': 7, 'HR@5': '0.0252', 'NDCG@5': '0.0156', 'HR@10': '0.0450', 'NDCG@10': '0.0220', 'HR@20': '0.0743', 'NDCG@20': '0.0294'}
2025-03-04 19:50:19,201 - Validation score increased.  Saving model ...
2025-03-04 19:51:08,316 - {'epoch': 8, 'rec_loss': '7.7175'}
2025-03-04 19:51:25,583 - {'Epoch': 8, 'HR@5': '0.0279', 'NDCG@5': '0.0173', 'HR@10': '0.0462', 'NDCG@10': '0.0232', 'HR@20': '0.0737', 'NDCG@20': '0.0301'}
2025-03-04 19:51:25,585 - Validation score increased.  Saving model ...
2025-03-04 19:52:11,620 - {'epoch': 9, 'rec_loss': '7.6679'}
2025-03-04 19:52:29,589 - {'Epoch': 9, 'HR@5': '0.0279', 'NDCG@5': '0.0172', 'HR@10': '0.0471', 'NDCG@10': '0.0234', 'HR@20': '0.0763', 'NDCG@20': '0.0307'}
2025-03-04 19:52:29,596 - Validation score increased.  Saving model ...
2025-03-04 19:53:15,141 - {'epoch': 10, 'rec_loss': '7.6213'}
2025-03-04 19:53:33,438 - {'Epoch': 10, 'HR@5': '0.0277', 'NDCG@5': '0.0175', 'HR@10': '0.0475', 'NDCG@10': '0.0238', 'HR@20': '0.0775', 'NDCG@20': '0.0314'}
2025-03-04 19:53:33,440 - Validation score increased.  Saving model ...
2025-03-04 19:54:20,742 - {'epoch': 11, 'rec_loss': '7.5825'}
2025-03-04 19:54:39,696 - {'Epoch': 11, 'HR@5': '0.0288', 'NDCG@5': '0.0179', 'HR@10': '0.0494', 'NDCG@10': '0.0245', 'HR@20': '0.0787', 'NDCG@20': '0.0318'}
2025-03-04 19:54:39,697 - Validation score increased.  Saving model ...
2025-03-04 19:55:28,883 - {'epoch': 12, 'rec_loss': '7.5512'}
2025-03-04 19:55:45,305 - {'Epoch': 12, 'HR@5': '0.0294', 'NDCG@5': '0.0185', 'HR@10': '0.0490', 'NDCG@10': '0.0248', 'HR@20': '0.0795', 'NDCG@20': '0.0325'}
2025-03-04 19:55:45,307 - Validation score increased.  Saving model ...
2025-03-04 19:56:30,187 - {'epoch': 13, 'rec_loss': '7.5203'}
2025-03-04 19:56:46,854 - {'Epoch': 13, 'HR@5': '0.0300', 'NDCG@5': '0.0186', 'HR@10': '0.0489', 'NDCG@10': '0.0247', 'HR@20': '0.0786', 'NDCG@20': '0.0322'}
2025-03-04 19:56:46,856 - EarlyStopping counter: 1 out of 10
2025-03-04 19:57:33,849 - {'epoch': 14, 'rec_loss': '7.4959'}
2025-03-04 19:57:52,707 - {'Epoch': 14, 'HR@5': '0.0298', 'NDCG@5': '0.0188', 'HR@10': '0.0494', 'NDCG@10': '0.0251', 'HR@20': '0.0789', 'NDCG@20': '0.0325'}
2025-03-04 19:57:52,711 - Validation score increased.  Saving model ...
2025-03-04 19:58:39,730 - {'epoch': 15, 'rec_loss': '7.4759'}
2025-03-04 19:58:58,364 - {'Epoch': 15, 'HR@5': '0.0306', 'NDCG@5': '0.0186', 'HR@10': '0.0495', 'NDCG@10': '0.0247', 'HR@20': '0.0801', 'NDCG@20': '0.0324'}
2025-03-04 19:58:58,372 - EarlyStopping counter: 1 out of 10
2025-03-04 19:59:43,749 - {'epoch': 16, 'rec_loss': '7.4537'}
2025-03-04 20:00:01,391 - {'Epoch': 16, 'HR@5': '0.0303', 'NDCG@5': '0.0185', 'HR@10': '0.0501', 'NDCG@10': '0.0248', 'HR@20': '0.0812', 'NDCG@20': '0.0326'}
2025-03-04 20:00:01,398 - Validation score increased.  Saving model ...
2025-03-04 20:00:48,192 - {'epoch': 17, 'rec_loss': '7.4330'}
2025-03-04 20:01:06,414 - {'Epoch': 17, 'HR@5': '0.0304', 'NDCG@5': '0.0187', 'HR@10': '0.0511', 'NDCG@10': '0.0253', 'HR@20': '0.0809', 'NDCG@20': '0.0328'}
2025-03-04 20:01:06,420 - Validation score increased.  Saving model ...
2025-03-04 20:01:50,727 - {'epoch': 18, 'rec_loss': '7.4103'}
2025-03-04 20:02:05,942 - {'Epoch': 18, 'HR@5': '0.0300', 'NDCG@5': '0.0189', 'HR@10': '0.0490', 'NDCG@10': '0.0250', 'HR@20': '0.0813', 'NDCG@20': '0.0331'}
2025-03-04 20:02:05,944 - Validation score increased.  Saving model ...
2025-03-04 20:02:50,465 - {'epoch': 19, 'rec_loss': '7.3954'}
2025-03-04 20:03:08,075 - {'Epoch': 19, 'HR@5': '0.0302', 'NDCG@5': '0.0188', 'HR@10': '0.0503', 'NDCG@10': '0.0252', 'HR@20': '0.0819', 'NDCG@20': '0.0332'}
2025-03-04 20:03:08,077 - Validation score increased.  Saving model ...
2025-03-04 20:03:56,641 - {'epoch': 20, 'rec_loss': '7.3790'}
2025-03-04 20:04:13,722 - {'Epoch': 20, 'HR@5': '0.0301', 'NDCG@5': '0.0189', 'HR@10': '0.0504', 'NDCG@10': '0.0254', 'HR@20': '0.0816', 'NDCG@20': '0.0332'}
2025-03-04 20:04:13,724 - Validation score increased.  Saving model ...
2025-03-04 20:05:00,185 - {'epoch': 21, 'rec_loss': '7.3699'}
2025-03-04 20:05:17,176 - {'Epoch': 21, 'HR@5': '0.0301', 'NDCG@5': '0.0190', 'HR@10': '0.0515', 'NDCG@10': '0.0259', 'HR@20': '0.0816', 'NDCG@20': '0.0334'}
2025-03-04 20:05:17,182 - Validation score increased.  Saving model ...
2025-03-04 20:06:01,949 - {'epoch': 22, 'rec_loss': '7.3541'}
2025-03-04 20:06:20,000 - {'Epoch': 22, 'HR@5': '0.0301', 'NDCG@5': '0.0188', 'HR@10': '0.0499', 'NDCG@10': '0.0251', 'HR@20': '0.0812', 'NDCG@20': '0.0329'}
2025-03-04 20:06:20,003 - EarlyStopping counter: 1 out of 10
2025-03-04 20:07:05,345 - {'epoch': 23, 'rec_loss': '7.3344'}
2025-03-04 20:07:23,089 - {'Epoch': 23, 'HR@5': '0.0306', 'NDCG@5': '0.0188', 'HR@10': '0.0503', 'NDCG@10': '0.0251', 'HR@20': '0.0827', 'NDCG@20': '0.0332'}
2025-03-04 20:07:23,094 - EarlyStopping counter: 2 out of 10
2025-03-04 20:08:08,698 - {'epoch': 24, 'rec_loss': '7.3226'}
2025-03-04 20:08:26,138 - {'Epoch': 24, 'HR@5': '0.0316', 'NDCG@5': '0.0197', 'HR@10': '0.0516', 'NDCG@10': '0.0261', 'HR@20': '0.0823', 'NDCG@20': '0.0339'}
2025-03-04 20:08:26,147 - Validation score increased.  Saving model ...
2025-03-04 20:09:12,185 - {'epoch': 25, 'rec_loss': '7.3095'}
2025-03-04 20:09:29,416 - {'Epoch': 25, 'HR@5': '0.0300', 'NDCG@5': '0.0191', 'HR@10': '0.0501', 'NDCG@10': '0.0255', 'HR@20': '0.0815', 'NDCG@20': '0.0334'}
2025-03-04 20:09:29,426 - EarlyStopping counter: 1 out of 10
2025-03-04 20:10:12,425 - {'epoch': 26, 'rec_loss': '7.3007'}
2025-03-04 20:10:33,877 - {'Epoch': 26, 'HR@5': '0.0303', 'NDCG@5': '0.0190', 'HR@10': '0.0508', 'NDCG@10': '0.0256', 'HR@20': '0.0820', 'NDCG@20': '0.0335'}
2025-03-04 20:10:33,892 - EarlyStopping counter: 2 out of 10
2025-03-04 20:11:17,909 - {'epoch': 27, 'rec_loss': '7.2910'}
2025-03-04 20:11:37,879 - {'Epoch': 27, 'HR@5': '0.0326', 'NDCG@5': '0.0200', 'HR@10': '0.0509', 'NDCG@10': '0.0259', 'HR@20': '0.0814', 'NDCG@20': '0.0335'}
2025-03-04 20:11:37,882 - EarlyStopping counter: 3 out of 10
2025-03-04 20:12:25,270 - {'epoch': 28, 'rec_loss': '7.2796'}
2025-03-04 20:12:42,449 - {'Epoch': 28, 'HR@5': '0.0308', 'NDCG@5': '0.0194', 'HR@10': '0.0509', 'NDCG@10': '0.0259', 'HR@20': '0.0823', 'NDCG@20': '0.0337'}
2025-03-04 20:12:42,456 - EarlyStopping counter: 4 out of 10
2025-03-04 20:13:28,872 - {'epoch': 29, 'rec_loss': '7.2704'}
2025-03-04 20:13:47,627 - {'Epoch': 29, 'HR@5': '0.0301', 'NDCG@5': '0.0190', 'HR@10': '0.0498', 'NDCG@10': '0.0253', 'HR@20': '0.0800', 'NDCG@20': '0.0329'}
2025-03-04 20:13:47,634 - EarlyStopping counter: 5 out of 10
2025-03-04 20:14:35,315 - {'epoch': 30, 'rec_loss': '7.2609'}
2025-03-04 20:14:59,101 - {'Epoch': 30, 'HR@5': '0.0316', 'NDCG@5': '0.0199', 'HR@10': '0.0525', 'NDCG@10': '0.0265', 'HR@20': '0.0825', 'NDCG@20': '0.0341'}
2025-03-04 20:14:59,104 - Validation score increased.  Saving model ...
2025-03-04 20:15:43,780 - {'epoch': 31, 'rec_loss': '7.2503'}
2025-03-04 20:15:59,173 - {'Epoch': 31, 'HR@5': '0.0309', 'NDCG@5': '0.0191', 'HR@10': '0.0512', 'NDCG@10': '0.0256', 'HR@20': '0.0832', 'NDCG@20': '0.0337'}
2025-03-04 20:15:59,174 - EarlyStopping counter: 1 out of 10
2025-03-04 20:16:42,466 - {'epoch': 32, 'rec_loss': '7.2430'}
2025-03-04 20:16:59,911 - {'Epoch': 32, 'HR@5': '0.0295', 'NDCG@5': '0.0184', 'HR@10': '0.0508', 'NDCG@10': '0.0252', 'HR@20': '0.0823', 'NDCG@20': '0.0332'}
2025-03-04 20:16:59,916 - EarlyStopping counter: 2 out of 10
2025-03-04 20:17:44,511 - {'epoch': 33, 'rec_loss': '7.2386'}
2025-03-04 20:18:01,637 - {'Epoch': 33, 'HR@5': '0.0319', 'NDCG@5': '0.0199', 'HR@10': '0.0522', 'NDCG@10': '0.0264', 'HR@20': '0.0843', 'NDCG@20': '0.0345'}
2025-03-04 20:18:01,639 - Validation score increased.  Saving model ...
2025-03-04 20:18:48,511 - {'epoch': 34, 'rec_loss': '7.2312'}
2025-03-04 20:19:07,123 - {'Epoch': 34, 'HR@5': '0.0316', 'NDCG@5': '0.0196', 'HR@10': '0.0513', 'NDCG@10': '0.0259', 'HR@20': '0.0819', 'NDCG@20': '0.0335'}
2025-03-04 20:19:07,130 - EarlyStopping counter: 1 out of 10
2025-03-04 20:19:53,376 - {'epoch': 35, 'rec_loss': '7.2269'}
2025-03-04 20:20:10,806 - {'Epoch': 35, 'HR@5': '0.0300', 'NDCG@5': '0.0184', 'HR@10': '0.0497', 'NDCG@10': '0.0247', 'HR@20': '0.0803', 'NDCG@20': '0.0324'}
2025-03-04 20:20:10,808 - EarlyStopping counter: 2 out of 10
2025-03-04 20:20:55,862 - {'epoch': 36, 'rec_loss': '7.2194'}
2025-03-04 20:21:13,005 - {'Epoch': 36, 'HR@5': '0.0310', 'NDCG@5': '0.0193', 'HR@10': '0.0508', 'NDCG@10': '0.0257', 'HR@20': '0.0810', 'NDCG@20': '0.0332'}
2025-03-04 20:21:13,011 - EarlyStopping counter: 3 out of 10
2025-03-04 20:21:57,705 - {'epoch': 37, 'rec_loss': '7.2109'}
2025-03-04 20:22:12,688 - {'Epoch': 37, 'HR@5': '0.0308', 'NDCG@5': '0.0196', 'HR@10': '0.0511', 'NDCG@10': '0.0261', 'HR@20': '0.0823', 'NDCG@20': '0.0339'}
2025-03-04 20:22:12,693 - EarlyStopping counter: 4 out of 10
2025-03-04 20:22:58,643 - {'epoch': 38, 'rec_loss': '7.1983'}
2025-03-04 20:23:15,120 - {'Epoch': 38, 'HR@5': '0.0313', 'NDCG@5': '0.0196', 'HR@10': '0.0517', 'NDCG@10': '0.0262', 'HR@20': '0.0812', 'NDCG@20': '0.0336'}
2025-03-04 20:23:15,122 - EarlyStopping counter: 5 out of 10
2025-03-04 20:24:00,215 - {'epoch': 39, 'rec_loss': '7.1913'}
2025-03-04 20:24:17,825 - {'Epoch': 39, 'HR@5': '0.0313', 'NDCG@5': '0.0197', 'HR@10': '0.0506', 'NDCG@10': '0.0258', 'HR@20': '0.0829', 'NDCG@20': '0.0339'}
2025-03-04 20:24:17,827 - EarlyStopping counter: 6 out of 10
2025-03-04 20:25:00,624 - {'epoch': 40, 'rec_loss': '7.1965'}
2025-03-04 20:25:17,968 - {'Epoch': 40, 'HR@5': '0.0305', 'NDCG@5': '0.0193', 'HR@10': '0.0503', 'NDCG@10': '0.0256', 'HR@20': '0.0817', 'NDCG@20': '0.0335'}
2025-03-04 20:25:17,970 - EarlyStopping counter: 7 out of 10
2025-03-04 20:26:06,131 - {'epoch': 41, 'rec_loss': '7.1840'}
2025-03-04 20:26:23,566 - {'Epoch': 41, 'HR@5': '0.0311', 'NDCG@5': '0.0195', 'HR@10': '0.0519', 'NDCG@10': '0.0262', 'HR@20': '0.0829', 'NDCG@20': '0.0340'}
2025-03-04 20:26:23,572 - EarlyStopping counter: 8 out of 10
2025-03-04 20:27:06,063 - {'epoch': 42, 'rec_loss': '7.1811'}
2025-03-04 20:27:21,190 - {'Epoch': 42, 'HR@5': '0.0313', 'NDCG@5': '0.0197', 'HR@10': '0.0499', 'NDCG@10': '0.0256', 'HR@20': '0.0812', 'NDCG@20': '0.0335'}
2025-03-04 20:27:21,192 - EarlyStopping counter: 9 out of 10
2025-03-04 20:28:09,345 - {'epoch': 43, 'rec_loss': '7.1776'}
2025-03-04 20:28:25,682 - {'Epoch': 43, 'HR@5': '0.0303', 'NDCG@5': '0.0190', 'HR@10': '0.0510', 'NDCG@10': '0.0257', 'HR@20': '0.0821', 'NDCG@20': '0.0335'}
2025-03-04 20:28:25,683 - EarlyStopping counter: 10 out of 10
2025-03-04 20:28:25,684 - Early stopping
2025-03-04 20:28:25,684 - ---------------Test Score---------------
2025-03-04 20:28:42,301 - {'Epoch': 0, 'HR@5': '0.0283', 'NDCG@5': '0.0179', 'HR@10': '0.0483', 'NDCG@10': '0.0243', 'HR@20': '0.0778', 'NDCG@20': '0.0317'}
2025-03-04 20:28:42,308 - Scale_Yelp
2025-03-04 20:28:42,309 - {'Epoch': 0, 'HR@5': '0.0283', 'NDCG@5': '0.0179', 'HR@10': '0.0483', 'NDCG@10': '0.0243', 'HR@20': '0.0778', 'NDCG@20': '0.0317'}
2025-03-04 21:18:42,412 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 24, 32], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-04 21:18:45,242 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-04 21:18:45,247 - Total Parameters: 1437093
2025-03-04 21:19:31,582 - {'epoch': 0, 'rec_loss': '9.5663'}
2025-03-04 21:19:47,181 - {'Epoch': 0, 'HR@5': '0.0084', 'NDCG@5': '0.0054', 'HR@10': '0.0144', 'NDCG@10': '0.0073', 'HR@20': '0.0251', 'NDCG@20': '0.0100'}
2025-03-04 21:19:47,182 - Validation score increased.  Saving model ...
2025-03-04 21:20:32,363 - {'epoch': 1, 'rec_loss': '8.9975'}
2025-03-04 21:20:47,749 - {'Epoch': 1, 'HR@5': '0.0130', 'NDCG@5': '0.0081', 'HR@10': '0.0218', 'NDCG@10': '0.0110', 'HR@20': '0.0370', 'NDCG@20': '0.0148'}
2025-03-04 21:20:47,751 - Validation score increased.  Saving model ...
2025-03-04 21:21:31,098 - {'epoch': 2, 'rec_loss': '8.5697'}
2025-03-04 21:21:47,032 - {'Epoch': 2, 'HR@5': '0.0177', 'NDCG@5': '0.0109', 'HR@10': '0.0303', 'NDCG@10': '0.0150', 'HR@20': '0.0515', 'NDCG@20': '0.0203'}
2025-03-04 21:21:47,033 - Validation score increased.  Saving model ...
2025-03-04 21:22:35,400 - {'epoch': 3, 'rec_loss': '8.2823'}
2025-03-04 21:22:50,435 - {'Epoch': 3, 'HR@5': '0.0207', 'NDCG@5': '0.0125', 'HR@10': '0.0351', 'NDCG@10': '0.0172', 'HR@20': '0.0572', 'NDCG@20': '0.0227'}
2025-03-04 21:22:50,436 - Validation score increased.  Saving model ...
2025-03-04 21:23:50,596 - {'epoch': 4, 'rec_loss': '8.1046'}
2025-03-04 21:24:09,089 - {'Epoch': 4, 'HR@5': '0.0220', 'NDCG@5': '0.0138', 'HR@10': '0.0378', 'NDCG@10': '0.0189', 'HR@20': '0.0650', 'NDCG@20': '0.0257'}
2025-03-04 21:24:09,091 - Validation score increased.  Saving model ...
2025-03-04 21:24:53,265 - {'epoch': 5, 'rec_loss': '7.9713'}
2025-03-04 21:25:10,533 - {'Epoch': 5, 'HR@5': '0.0245', 'NDCG@5': '0.0154', 'HR@10': '0.0418', 'NDCG@10': '0.0209', 'HR@20': '0.0688', 'NDCG@20': '0.0277'}
2025-03-04 21:25:10,535 - Validation score increased.  Saving model ...
2025-03-04 21:26:13,557 - {'epoch': 6, 'rec_loss': '7.8706'}
2025-03-04 21:26:30,981 - {'Epoch': 6, 'HR@5': '0.0250', 'NDCG@5': '0.0157', 'HR@10': '0.0439', 'NDCG@10': '0.0218', 'HR@20': '0.0725', 'NDCG@20': '0.0289'}
2025-03-04 21:26:30,983 - Validation score increased.  Saving model ...
2025-03-04 21:27:15,200 - {'epoch': 7, 'rec_loss': '7.7926'}
2025-03-04 21:27:30,258 - {'Epoch': 7, 'HR@5': '0.0247', 'NDCG@5': '0.0155', 'HR@10': '0.0444', 'NDCG@10': '0.0218', 'HR@20': '0.0737', 'NDCG@20': '0.0292'}
2025-03-04 21:27:30,261 - Validation score increased.  Saving model ...
2025-03-04 21:28:32,686 - {'epoch': 8, 'rec_loss': '7.7257'}
2025-03-04 21:28:50,635 - {'Epoch': 8, 'HR@5': '0.0276', 'NDCG@5': '0.0167', 'HR@10': '0.0462', 'NDCG@10': '0.0227', 'HR@20': '0.0732', 'NDCG@20': '0.0295'}
2025-03-04 21:28:50,637 - Validation score increased.  Saving model ...
2025-03-04 21:29:35,943 - {'epoch': 9, 'rec_loss': '7.6770'}
2025-03-04 21:29:54,690 - {'Epoch': 9, 'HR@5': '0.0277', 'NDCG@5': '0.0170', 'HR@10': '0.0474', 'NDCG@10': '0.0233', 'HR@20': '0.0753', 'NDCG@20': '0.0303'}
2025-03-04 21:29:54,692 - Validation score increased.  Saving model ...
2025-03-04 21:30:59,903 - {'epoch': 10, 'rec_loss': '7.6285'}
2025-03-04 21:31:16,952 - {'Epoch': 10, 'HR@5': '0.0275', 'NDCG@5': '0.0174', 'HR@10': '0.0461', 'NDCG@10': '0.0233', 'HR@20': '0.0775', 'NDCG@20': '0.0313'}
2025-03-04 21:31:16,954 - Validation score increased.  Saving model ...
2025-03-04 21:32:02,645 - {'epoch': 11, 'rec_loss': '7.5895'}
2025-03-04 21:32:22,068 - {'Epoch': 11, 'HR@5': '0.0294', 'NDCG@5': '0.0180', 'HR@10': '0.0482', 'NDCG@10': '0.0240', 'HR@20': '0.0784', 'NDCG@20': '0.0316'}
2025-03-04 21:32:22,071 - Validation score increased.  Saving model ...
2025-03-04 21:33:22,513 - {'epoch': 12, 'rec_loss': '7.5567'}
2025-03-04 21:33:41,123 - {'Epoch': 12, 'HR@5': '0.0300', 'NDCG@5': '0.0185', 'HR@10': '0.0490', 'NDCG@10': '0.0246', 'HR@20': '0.0779', 'NDCG@20': '0.0318'}
2025-03-04 21:33:41,125 - Validation score increased.  Saving model ...
2025-03-04 21:34:33,566 - {'epoch': 13, 'rec_loss': '7.5195'}
2025-03-04 21:34:53,482 - {'Epoch': 13, 'HR@5': '0.0299', 'NDCG@5': '0.0184', 'HR@10': '0.0494', 'NDCG@10': '0.0247', 'HR@20': '0.0781', 'NDCG@20': '0.0320'}
2025-03-04 21:34:53,486 - Validation score increased.  Saving model ...
2025-03-04 21:35:48,031 - {'epoch': 14, 'rec_loss': '7.4908'}
2025-03-04 21:36:04,886 - {'Epoch': 14, 'HR@5': '0.0284', 'NDCG@5': '0.0180', 'HR@10': '0.0491', 'NDCG@10': '0.0247', 'HR@20': '0.0787', 'NDCG@20': '0.0321'}
2025-03-04 21:36:04,887 - Validation score increased.  Saving model ...
2025-03-04 21:37:02,671 - {'epoch': 15, 'rec_loss': '7.4680'}
2025-03-04 21:37:22,156 - {'Epoch': 15, 'HR@5': '0.0304', 'NDCG@5': '0.0184', 'HR@10': '0.0497', 'NDCG@10': '0.0246', 'HR@20': '0.0806', 'NDCG@20': '0.0324'}
2025-03-04 21:37:22,158 - Validation score increased.  Saving model ...
2025-03-04 21:38:11,363 - {'epoch': 16, 'rec_loss': '7.4444'}
2025-03-04 21:38:26,826 - {'Epoch': 16, 'HR@5': '0.0303', 'NDCG@5': '0.0187', 'HR@10': '0.0497', 'NDCG@10': '0.0250', 'HR@20': '0.0813', 'NDCG@20': '0.0329'}
2025-03-04 21:38:26,828 - Validation score increased.  Saving model ...
2025-03-04 21:39:30,140 - {'epoch': 17, 'rec_loss': '7.4222'}
2025-03-04 21:39:49,791 - {'Epoch': 17, 'HR@5': '0.0307', 'NDCG@5': '0.0189', 'HR@10': '0.0507', 'NDCG@10': '0.0253', 'HR@20': '0.0821', 'NDCG@20': '0.0332'}
2025-03-04 21:39:49,792 - Validation score increased.  Saving model ...
2025-03-04 21:40:33,959 - {'epoch': 18, 'rec_loss': '7.3970'}
2025-03-04 21:40:52,854 - {'Epoch': 18, 'HR@5': '0.0301', 'NDCG@5': '0.0187', 'HR@10': '0.0503', 'NDCG@10': '0.0252', 'HR@20': '0.0811', 'NDCG@20': '0.0330'}
2025-03-04 21:40:52,856 - EarlyStopping counter: 1 out of 10
2025-03-04 21:41:58,353 - {'epoch': 19, 'rec_loss': '7.3828'}
2025-03-04 21:42:17,282 - {'Epoch': 19, 'HR@5': '0.0309', 'NDCG@5': '0.0191', 'HR@10': '0.0511', 'NDCG@10': '0.0256', 'HR@20': '0.0816', 'NDCG@20': '0.0332'}
2025-03-04 21:42:17,284 - EarlyStopping counter: 2 out of 10
2025-03-04 21:43:01,187 - {'epoch': 20, 'rec_loss': '7.3659'}
2025-03-04 21:43:18,613 - {'Epoch': 20, 'HR@5': '0.0297', 'NDCG@5': '0.0186', 'HR@10': '0.0505', 'NDCG@10': '0.0253', 'HR@20': '0.0816', 'NDCG@20': '0.0332'}
2025-03-04 21:43:18,615 - EarlyStopping counter: 3 out of 10
2025-03-04 21:44:24,353 - {'epoch': 21, 'rec_loss': '7.3562'}
2025-03-04 21:44:41,787 - {'Epoch': 21, 'HR@5': '0.0298', 'NDCG@5': '0.0189', 'HR@10': '0.0509', 'NDCG@10': '0.0257', 'HR@20': '0.0807', 'NDCG@20': '0.0332'}
2025-03-04 21:44:41,789 - Validation score increased.  Saving model ...
2025-03-04 21:45:26,847 - {'epoch': 22, 'rec_loss': '7.3391'}
2025-03-04 21:45:46,733 - {'Epoch': 22, 'HR@5': '0.0302', 'NDCG@5': '0.0188', 'HR@10': '0.0503', 'NDCG@10': '0.0252', 'HR@20': '0.0819', 'NDCG@20': '0.0331'}
2025-03-04 21:45:46,734 - EarlyStopping counter: 1 out of 10
2025-03-04 21:46:47,719 - {'epoch': 23, 'rec_loss': '7.3209'}
2025-03-04 21:47:05,151 - {'Epoch': 23, 'HR@5': '0.0310', 'NDCG@5': '0.0193', 'HR@10': '0.0507', 'NDCG@10': '0.0256', 'HR@20': '0.0833', 'NDCG@20': '0.0338'}
2025-03-04 21:47:05,153 - Validation score increased.  Saving model ...
2025-03-04 21:47:56,865 - {'epoch': 24, 'rec_loss': '7.3118'}
2025-03-04 21:48:16,356 - {'Epoch': 24, 'HR@5': '0.0311', 'NDCG@5': '0.0195', 'HR@10': '0.0523', 'NDCG@10': '0.0263', 'HR@20': '0.0835', 'NDCG@20': '0.0341'}
2025-03-04 21:48:16,358 - Validation score increased.  Saving model ...
2025-03-04 21:49:10,741 - {'epoch': 25, 'rec_loss': '7.2975'}
2025-03-04 21:49:28,312 - {'Epoch': 25, 'HR@5': '0.0305', 'NDCG@5': '0.0192', 'HR@10': '0.0504', 'NDCG@10': '0.0256', 'HR@20': '0.0830', 'NDCG@20': '0.0338'}
2025-03-04 21:49:28,314 - EarlyStopping counter: 1 out of 10
2025-03-04 21:50:25,669 - {'epoch': 26, 'rec_loss': '7.2887'}
2025-03-04 21:50:45,320 - {'Epoch': 26, 'HR@5': '0.0313', 'NDCG@5': '0.0195', 'HR@10': '0.0510', 'NDCG@10': '0.0258', 'HR@20': '0.0822', 'NDCG@20': '0.0336'}
2025-03-04 21:50:45,324 - EarlyStopping counter: 2 out of 10
2025-03-04 21:51:35,851 - {'epoch': 27, 'rec_loss': '7.2767'}
2025-03-04 21:51:53,377 - {'Epoch': 27, 'HR@5': '0.0319', 'NDCG@5': '0.0199', 'HR@10': '0.0519', 'NDCG@10': '0.0263', 'HR@20': '0.0810', 'NDCG@20': '0.0336'}
2025-03-04 21:51:53,379 - EarlyStopping counter: 3 out of 10
2025-03-04 21:52:52,187 - {'epoch': 28, 'rec_loss': '7.2665'}
2025-03-04 21:53:11,577 - {'Epoch': 28, 'HR@5': '0.0313', 'NDCG@5': '0.0199', 'HR@10': '0.0505', 'NDCG@10': '0.0260', 'HR@20': '0.0816', 'NDCG@20': '0.0338'}
2025-03-04 21:53:11,579 - EarlyStopping counter: 4 out of 10
2025-03-04 21:53:57,674 - {'epoch': 29, 'rec_loss': '7.2572'}
2025-03-04 21:54:12,778 - {'Epoch': 29, 'HR@5': '0.0305', 'NDCG@5': '0.0191', 'HR@10': '0.0502', 'NDCG@10': '0.0255', 'HR@20': '0.0810', 'NDCG@20': '0.0332'}
2025-03-04 21:54:12,780 - EarlyStopping counter: 5 out of 10
2025-03-04 21:54:58,659 - {'epoch': 30, 'rec_loss': '7.2489'}
2025-03-04 21:55:13,721 - {'Epoch': 30, 'HR@5': '0.0309', 'NDCG@5': '0.0197', 'HR@10': '0.0511', 'NDCG@10': '0.0262', 'HR@20': '0.0815', 'NDCG@20': '0.0338'}
2025-03-04 21:55:13,723 - EarlyStopping counter: 6 out of 10
2025-03-04 21:55:59,291 - {'epoch': 31, 'rec_loss': '7.2388'}
2025-03-04 21:56:14,886 - {'Epoch': 31, 'HR@5': '0.0309', 'NDCG@5': '0.0194', 'HR@10': '0.0513', 'NDCG@10': '0.0259', 'HR@20': '0.0826', 'NDCG@20': '0.0338'}
2025-03-04 21:56:14,888 - EarlyStopping counter: 7 out of 10
2025-03-04 21:57:01,015 - {'epoch': 32, 'rec_loss': '7.2325'}
2025-03-04 21:57:16,038 - {'Epoch': 32, 'HR@5': '0.0309', 'NDCG@5': '0.0191', 'HR@10': '0.0510', 'NDCG@10': '0.0255', 'HR@20': '0.0811', 'NDCG@20': '0.0331'}
2025-03-04 21:57:16,040 - EarlyStopping counter: 8 out of 10
2025-03-04 21:58:02,268 - {'epoch': 33, 'rec_loss': '7.2268'}
2025-03-04 21:58:17,487 - {'Epoch': 33, 'HR@5': '0.0319', 'NDCG@5': '0.0202', 'HR@10': '0.0517', 'NDCG@10': '0.0266', 'HR@20': '0.0841', 'NDCG@20': '0.0347'}
2025-03-04 21:58:17,489 - Validation score increased.  Saving model ...
2025-03-04 21:59:02,614 - {'epoch': 34, 'rec_loss': '7.2193'}
2025-03-04 21:59:18,062 - {'Epoch': 34, 'HR@5': '0.0309', 'NDCG@5': '0.0194', 'HR@10': '0.0509', 'NDCG@10': '0.0258', 'HR@20': '0.0829', 'NDCG@20': '0.0338'}
2025-03-04 21:59:18,064 - EarlyStopping counter: 1 out of 10
2025-03-04 22:00:02,521 - {'epoch': 35, 'rec_loss': '7.2123'}
2025-03-04 22:00:18,967 - {'Epoch': 35, 'HR@5': '0.0304', 'NDCG@5': '0.0187', 'HR@10': '0.0492', 'NDCG@10': '0.0247', 'HR@20': '0.0800', 'NDCG@20': '0.0324'}
2025-03-04 22:00:18,969 - EarlyStopping counter: 2 out of 10
2025-03-04 22:01:13,107 - {'epoch': 36, 'rec_loss': '7.2054'}
2025-03-04 22:01:33,659 - {'Epoch': 36, 'HR@5': '0.0302', 'NDCG@5': '0.0190', 'HR@10': '0.0504', 'NDCG@10': '0.0255', 'HR@20': '0.0802', 'NDCG@20': '0.0329'}
2025-03-04 22:01:33,661 - EarlyStopping counter: 3 out of 10
2025-03-04 22:02:23,414 - {'epoch': 37, 'rec_loss': '7.1993'}
2025-03-04 22:02:42,166 - {'Epoch': 37, 'HR@5': '0.0305', 'NDCG@5': '0.0193', 'HR@10': '0.0512', 'NDCG@10': '0.0259', 'HR@20': '0.0827', 'NDCG@20': '0.0338'}
2025-03-04 22:02:42,168 - EarlyStopping counter: 4 out of 10
2025-03-04 22:03:40,998 - {'epoch': 38, 'rec_loss': '7.1849'}
2025-03-04 22:04:01,029 - {'Epoch': 38, 'HR@5': '0.0309', 'NDCG@5': '0.0195', 'HR@10': '0.0507', 'NDCG@10': '0.0258', 'HR@20': '0.0823', 'NDCG@20': '0.0337'}
2025-03-04 22:04:01,033 - EarlyStopping counter: 5 out of 10
2025-03-04 22:04:50,153 - {'epoch': 39, 'rec_loss': '7.1787'}
2025-03-04 22:05:07,687 - {'Epoch': 39, 'HR@5': '0.0311', 'NDCG@5': '0.0197', 'HR@10': '0.0502', 'NDCG@10': '0.0258', 'HR@20': '0.0820', 'NDCG@20': '0.0337'}
2025-03-04 22:05:07,689 - EarlyStopping counter: 6 out of 10
2025-03-04 22:06:08,615 - {'epoch': 40, 'rec_loss': '7.1837'}
2025-03-04 22:06:28,154 - {'Epoch': 40, 'HR@5': '0.0299', 'NDCG@5': '0.0190', 'HR@10': '0.0501', 'NDCG@10': '0.0255', 'HR@20': '0.0826', 'NDCG@20': '0.0337'}
2025-03-04 22:06:28,156 - EarlyStopping counter: 7 out of 10
2025-03-04 22:07:13,698 - {'epoch': 41, 'rec_loss': '7.1722'}
2025-03-04 22:07:30,005 - {'Epoch': 41, 'HR@5': '0.0304', 'NDCG@5': '0.0190', 'HR@10': '0.0511', 'NDCG@10': '0.0256', 'HR@20': '0.0817', 'NDCG@20': '0.0333'}
2025-03-04 22:07:30,008 - EarlyStopping counter: 8 out of 10
2025-03-04 22:08:35,949 - {'epoch': 42, 'rec_loss': '7.1704'}
2025-03-04 22:08:54,192 - {'Epoch': 42, 'HR@5': '0.0313', 'NDCG@5': '0.0196', 'HR@10': '0.0494', 'NDCG@10': '0.0254', 'HR@20': '0.0812', 'NDCG@20': '0.0334'}
2025-03-04 22:08:54,194 - EarlyStopping counter: 9 out of 10
2025-03-04 22:09:37,253 - {'epoch': 43, 'rec_loss': '7.1663'}
2025-03-04 22:09:55,545 - {'Epoch': 43, 'HR@5': '0.0306', 'NDCG@5': '0.0191', 'HR@10': '0.0507', 'NDCG@10': '0.0256', 'HR@20': '0.0813', 'NDCG@20': '0.0332'}
2025-03-04 22:09:55,547 - EarlyStopping counter: 10 out of 10
2025-03-04 22:09:55,547 - Early stopping
2025-03-04 22:09:55,547 - ---------------Test Score---------------
2025-03-04 22:10:15,146 - {'Epoch': 0, 'HR@5': '0.0288', 'NDCG@5': '0.0179', 'HR@10': '0.0491', 'NDCG@10': '0.0244', 'HR@20': '0.0771', 'NDCG@20': '0.0314'}
2025-03-04 22:10:15,149 - Scale_Yelp
2025-03-04 22:10:15,149 - {'Epoch': 0, 'HR@5': '0.0288', 'NDCG@5': '0.0179', 'HR@10': '0.0491', 'NDCG@10': '0.0244', 'HR@20': '0.0771', 'NDCG@20': '0.0314'}
2025-03-05 13:56:05,687 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-05 13:56:08,633 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-05 13:56:08,640 - Total Parameters: 1436118
2025-03-05 13:57:03,650 - {'epoch': 0, 'rec_loss': '9.5429'}
2025-03-05 13:57:24,454 - {'Epoch': 0, 'HR@5': '0.0099', 'NDCG@5': '0.0060', 'HR@10': '0.0154', 'NDCG@10': '0.0078', 'HR@20': '0.0264', 'NDCG@20': '0.0106'}
2025-03-05 13:57:24,458 - Validation score increased.  Saving model ...
2025-03-05 13:58:18,573 - {'epoch': 1, 'rec_loss': '8.9233'}
2025-03-05 13:58:34,338 - {'Epoch': 1, 'HR@5': '0.0154', 'NDCG@5': '0.0096', 'HR@10': '0.0263', 'NDCG@10': '0.0131', 'HR@20': '0.0419', 'NDCG@20': '0.0170'}
2025-03-05 13:58:34,340 - Validation score increased.  Saving model ...
2025-03-05 13:59:33,928 - {'epoch': 2, 'rec_loss': '8.4956'}
2025-03-05 13:59:52,753 - {'Epoch': 2, 'HR@5': '0.0184', 'NDCG@5': '0.0113', 'HR@10': '0.0319', 'NDCG@10': '0.0157', 'HR@20': '0.0527', 'NDCG@20': '0.0209'}
2025-03-05 13:59:52,755 - Validation score increased.  Saving model ...
2025-03-05 14:00:40,887 - {'epoch': 3, 'rec_loss': '8.2601'}
2025-03-05 14:00:59,141 - {'Epoch': 3, 'HR@5': '0.0220', 'NDCG@5': '0.0137', 'HR@10': '0.0376', 'NDCG@10': '0.0187', 'HR@20': '0.0607', 'NDCG@20': '0.0245'}
2025-03-05 14:00:59,143 - Validation score increased.  Saving model ...
2025-03-05 14:02:03,965 - {'epoch': 4, 'rec_loss': '8.0860'}
2025-03-05 14:02:19,965 - {'Epoch': 4, 'HR@5': '0.0228', 'NDCG@5': '0.0139', 'HR@10': '0.0392', 'NDCG@10': '0.0192', 'HR@20': '0.0640', 'NDCG@20': '0.0254'}
2025-03-05 14:02:19,969 - Validation score increased.  Saving model ...
2025-03-05 14:03:03,527 - {'epoch': 5, 'rec_loss': '7.9631'}
2025-03-05 14:03:23,022 - {'Epoch': 5, 'HR@5': '0.0246', 'NDCG@5': '0.0156', 'HR@10': '0.0419', 'NDCG@10': '0.0212', 'HR@20': '0.0676', 'NDCG@20': '0.0276'}
2025-03-05 14:03:23,024 - Validation score increased.  Saving model ...
2025-03-05 14:04:24,537 - {'epoch': 6, 'rec_loss': '7.8714'}
2025-03-05 14:04:41,964 - {'Epoch': 6, 'HR@5': '0.0254', 'NDCG@5': '0.0159', 'HR@10': '0.0439', 'NDCG@10': '0.0218', 'HR@20': '0.0697', 'NDCG@20': '0.0283'}
2025-03-05 14:04:41,966 - Validation score increased.  Saving model ...
2025-03-05 14:05:34,116 - {'epoch': 7, 'rec_loss': '7.7935'}
2025-03-05 14:05:53,709 - {'Epoch': 7, 'HR@5': '0.0262', 'NDCG@5': '0.0163', 'HR@10': '0.0438', 'NDCG@10': '0.0220', 'HR@20': '0.0719', 'NDCG@20': '0.0290'}
2025-03-05 14:05:53,711 - Validation score increased.  Saving model ...
2025-03-05 14:06:47,453 - {'epoch': 8, 'rec_loss': '7.7326'}
2025-03-05 14:07:02,870 - {'Epoch': 8, 'HR@5': '0.0269', 'NDCG@5': '0.0169', 'HR@10': '0.0454', 'NDCG@10': '0.0228', 'HR@20': '0.0731', 'NDCG@20': '0.0298'}
2025-03-05 14:07:02,875 - Validation score increased.  Saving model ...
2025-03-05 14:07:55,065 - {'epoch': 9, 'rec_loss': '7.6795'}
2025-03-05 14:08:14,516 - {'Epoch': 9, 'HR@5': '0.0275', 'NDCG@5': '0.0171', 'HR@10': '0.0457', 'NDCG@10': '0.0230', 'HR@20': '0.0761', 'NDCG@20': '0.0306'}
2025-03-05 14:08:14,518 - Validation score increased.  Saving model ...
2025-03-05 14:09:09,722 - {'epoch': 10, 'rec_loss': '7.6388'}
2025-03-05 14:09:25,303 - {'Epoch': 10, 'HR@5': '0.0289', 'NDCG@5': '0.0184', 'HR@10': '0.0480', 'NDCG@10': '0.0245', 'HR@20': '0.0787', 'NDCG@20': '0.0322'}
2025-03-05 14:09:25,308 - Validation score increased.  Saving model ...
2025-03-05 14:10:26,533 - {'epoch': 11, 'rec_loss': '7.5944'}
2025-03-05 14:10:46,434 - {'Epoch': 11, 'HR@5': '0.0279', 'NDCG@5': '0.0175', 'HR@10': '0.0476', 'NDCG@10': '0.0238', 'HR@20': '0.0773', 'NDCG@20': '0.0313'}
2025-03-05 14:10:46,435 - EarlyStopping counter: 1 out of 10
2025-03-05 14:11:29,209 - {'epoch': 12, 'rec_loss': '7.5641'}
2025-03-05 14:11:47,275 - {'Epoch': 12, 'HR@5': '0.0295', 'NDCG@5': '0.0184', 'HR@10': '0.0479', 'NDCG@10': '0.0243', 'HR@20': '0.0771', 'NDCG@20': '0.0316'}
2025-03-05 14:11:47,279 - EarlyStopping counter: 2 out of 10
2025-03-05 14:12:52,338 - {'epoch': 13, 'rec_loss': '7.5344'}
2025-03-05 14:13:08,944 - {'Epoch': 13, 'HR@5': '0.0294', 'NDCG@5': '0.0187', 'HR@10': '0.0481', 'NDCG@10': '0.0247', 'HR@20': '0.0783', 'NDCG@20': '0.0322'}
2025-03-05 14:13:08,949 - EarlyStopping counter: 3 out of 10
2025-03-05 14:13:55,560 - {'epoch': 14, 'rec_loss': '7.4994'}
2025-03-05 14:14:15,530 - {'Epoch': 14, 'HR@5': '0.0291', 'NDCG@5': '0.0184', 'HR@10': '0.0480', 'NDCG@10': '0.0245', 'HR@20': '0.0780', 'NDCG@20': '0.0320'}
2025-03-05 14:14:15,533 - EarlyStopping counter: 4 out of 10
2025-03-05 14:15:15,474 - {'epoch': 15, 'rec_loss': '7.4824'}
2025-03-05 14:15:33,147 - {'Epoch': 15, 'HR@5': '0.0294', 'NDCG@5': '0.0189', 'HR@10': '0.0487', 'NDCG@10': '0.0251', 'HR@20': '0.0783', 'NDCG@20': '0.0325'}
2025-03-05 14:15:33,149 - Validation score increased.  Saving model ...
2025-03-05 14:16:23,761 - {'epoch': 16, 'rec_loss': '7.4580'}
2025-03-05 14:16:43,750 - {'Epoch': 16, 'HR@5': '0.0302', 'NDCG@5': '0.0188', 'HR@10': '0.0495', 'NDCG@10': '0.0250', 'HR@20': '0.0784', 'NDCG@20': '0.0322'}
2025-03-05 14:16:43,753 - EarlyStopping counter: 1 out of 10
2025-03-05 14:17:36,366 - {'epoch': 17, 'rec_loss': '7.4345'}
2025-03-05 14:17:53,150 - {'Epoch': 17, 'HR@5': '0.0298', 'NDCG@5': '0.0185', 'HR@10': '0.0502', 'NDCG@10': '0.0251', 'HR@20': '0.0796', 'NDCG@20': '0.0324'}
2025-03-05 14:17:53,152 - EarlyStopping counter: 2 out of 10
2025-03-05 14:18:47,127 - {'epoch': 18, 'rec_loss': '7.4175'}
2025-03-05 14:19:07,839 - {'Epoch': 18, 'HR@5': '0.0306', 'NDCG@5': '0.0192', 'HR@10': '0.0502', 'NDCG@10': '0.0255', 'HR@20': '0.0798', 'NDCG@20': '0.0329'}
2025-03-05 14:19:07,841 - Validation score increased.  Saving model ...
2025-03-05 14:19:55,911 - {'epoch': 19, 'rec_loss': '7.3953'}
2025-03-05 14:20:11,200 - {'Epoch': 19, 'HR@5': '0.0304', 'NDCG@5': '0.0193', 'HR@10': '0.0495', 'NDCG@10': '0.0254', 'HR@20': '0.0802', 'NDCG@20': '0.0332'}
2025-03-05 14:20:11,204 - Validation score increased.  Saving model ...
2025-03-05 14:21:12,159 - {'epoch': 20, 'rec_loss': '7.3765'}
2025-03-05 14:21:31,905 - {'Epoch': 20, 'HR@5': '0.0309', 'NDCG@5': '0.0194', 'HR@10': '0.0513', 'NDCG@10': '0.0260', 'HR@20': '0.0807', 'NDCG@20': '0.0334'}
2025-03-05 14:21:31,913 - Validation score increased.  Saving model ...
2025-03-05 14:22:14,905 - {'epoch': 21, 'rec_loss': '7.3603'}
2025-03-05 14:22:31,151 - {'Epoch': 21, 'HR@5': '0.0313', 'NDCG@5': '0.0200', 'HR@10': '0.0510', 'NDCG@10': '0.0263', 'HR@20': '0.0797', 'NDCG@20': '0.0335'}
2025-03-05 14:22:31,153 - Validation score increased.  Saving model ...
2025-03-05 14:23:34,720 - {'epoch': 22, 'rec_loss': '7.3453'}
2025-03-05 14:23:52,443 - {'Epoch': 22, 'HR@5': '0.0313', 'NDCG@5': '0.0196', 'HR@10': '0.0509', 'NDCG@10': '0.0260', 'HR@20': '0.0806', 'NDCG@20': '0.0334'}
2025-03-05 14:23:52,445 - EarlyStopping counter: 1 out of 10
2025-03-05 14:24:34,792 - {'epoch': 23, 'rec_loss': '7.3316'}
2025-03-05 14:24:53,493 - {'Epoch': 23, 'HR@5': '0.0303', 'NDCG@5': '0.0191', 'HR@10': '0.0505', 'NDCG@10': '0.0256', 'HR@20': '0.0805', 'NDCG@20': '0.0331'}
2025-03-05 14:24:53,495 - EarlyStopping counter: 2 out of 10
2025-03-05 14:25:56,923 - {'epoch': 24, 'rec_loss': '7.3226'}
2025-03-05 14:26:14,269 - {'Epoch': 24, 'HR@5': '0.0313', 'NDCG@5': '0.0197', 'HR@10': '0.0506', 'NDCG@10': '0.0259', 'HR@20': '0.0824', 'NDCG@20': '0.0339'}
2025-03-05 14:26:14,271 - Validation score increased.  Saving model ...
2025-03-05 14:27:02,959 - {'epoch': 25, 'rec_loss': '7.3111'}
2025-03-05 14:27:23,131 - {'Epoch': 25, 'HR@5': '0.0311', 'NDCG@5': '0.0195', 'HR@10': '0.0514', 'NDCG@10': '0.0260', 'HR@20': '0.0834', 'NDCG@20': '0.0341'}
2025-03-05 14:27:23,134 - Validation score increased.  Saving model ...
2025-03-05 14:28:20,174 - {'epoch': 26, 'rec_loss': '7.2998'}
2025-03-05 14:28:35,867 - {'Epoch': 26, 'HR@5': '0.0314', 'NDCG@5': '0.0202', 'HR@10': '0.0516', 'NDCG@10': '0.0267', 'HR@20': '0.0820', 'NDCG@20': '0.0343'}
2025-03-05 14:28:35,869 - Validation score increased.  Saving model ...
2025-03-05 14:29:21,331 - {'epoch': 27, 'rec_loss': '7.2898'}
2025-03-05 14:29:41,841 - {'Epoch': 27, 'HR@5': '0.0317', 'NDCG@5': '0.0201', 'HR@10': '0.0505', 'NDCG@10': '0.0261', 'HR@20': '0.0804', 'NDCG@20': '0.0336'}
2025-03-05 14:29:41,843 - EarlyStopping counter: 1 out of 10
2025-03-05 14:30:41,138 - {'epoch': 28, 'rec_loss': '7.2775'}
2025-03-05 14:30:58,802 - {'Epoch': 28, 'HR@5': '0.0300', 'NDCG@5': '0.0191', 'HR@10': '0.0505', 'NDCG@10': '0.0257', 'HR@20': '0.0803', 'NDCG@20': '0.0332'}
2025-03-05 14:30:58,807 - EarlyStopping counter: 2 out of 10
2025-03-05 14:31:52,478 - {'epoch': 29, 'rec_loss': '7.2711'}
2025-03-05 14:32:12,414 - {'Epoch': 29, 'HR@5': '0.0313', 'NDCG@5': '0.0196', 'HR@10': '0.0521', 'NDCG@10': '0.0263', 'HR@20': '0.0814', 'NDCG@20': '0.0336'}
2025-03-05 14:32:12,416 - EarlyStopping counter: 3 out of 10
2025-03-05 14:33:02,422 - {'epoch': 30, 'rec_loss': '7.2594'}
2025-03-05 14:33:20,129 - {'Epoch': 30, 'HR@5': '0.0307', 'NDCG@5': '0.0195', 'HR@10': '0.0503', 'NDCG@10': '0.0258', 'HR@20': '0.0816', 'NDCG@20': '0.0337'}
2025-03-05 14:33:20,131 - EarlyStopping counter: 4 out of 10
2025-03-05 14:34:06,488 - {'epoch': 31, 'rec_loss': '7.2504'}
2025-03-05 14:34:26,699 - {'Epoch': 31, 'HR@5': '0.0304', 'NDCG@5': '0.0194', 'HR@10': '0.0502', 'NDCG@10': '0.0257', 'HR@20': '0.0828', 'NDCG@20': '0.0339'}
2025-03-05 14:34:26,702 - EarlyStopping counter: 5 out of 10
2025-03-05 14:35:20,958 - {'epoch': 32, 'rec_loss': '7.2438'}
2025-03-05 14:35:38,578 - {'Epoch': 32, 'HR@5': '0.0302', 'NDCG@5': '0.0192', 'HR@10': '0.0498', 'NDCG@10': '0.0255', 'HR@20': '0.0809', 'NDCG@20': '0.0333'}
2025-03-05 14:35:38,580 - EarlyStopping counter: 6 out of 10
2025-03-05 14:36:30,412 - {'epoch': 33, 'rec_loss': '7.2408'}
2025-03-05 14:36:50,765 - {'Epoch': 33, 'HR@5': '0.0310', 'NDCG@5': '0.0193', 'HR@10': '0.0499', 'NDCG@10': '0.0253', 'HR@20': '0.0819', 'NDCG@20': '0.0334'}
2025-03-05 14:36:50,768 - EarlyStopping counter: 7 out of 10
2025-03-05 14:37:43,785 - {'epoch': 34, 'rec_loss': '7.2262'}
2025-03-05 14:38:01,561 - {'Epoch': 34, 'HR@5': '0.0306', 'NDCG@5': '0.0192', 'HR@10': '0.0514', 'NDCG@10': '0.0259', 'HR@20': '0.0826', 'NDCG@20': '0.0337'}
2025-03-05 14:38:01,562 - EarlyStopping counter: 8 out of 10
2025-03-05 14:38:56,600 - {'epoch': 35, 'rec_loss': '7.2186'}
2025-03-05 14:39:16,745 - {'Epoch': 35, 'HR@5': '0.0309', 'NDCG@5': '0.0196', 'HR@10': '0.0494', 'NDCG@10': '0.0255', 'HR@20': '0.0809', 'NDCG@20': '0.0334'}
2025-03-05 14:39:16,747 - EarlyStopping counter: 9 out of 10
2025-03-05 14:40:02,974 - {'epoch': 36, 'rec_loss': '7.2152'}
2025-03-05 14:40:19,895 - {'Epoch': 36, 'HR@5': '0.0309', 'NDCG@5': '0.0194', 'HR@10': '0.0512', 'NDCG@10': '0.0259', 'HR@20': '0.0826', 'NDCG@20': '0.0338'}
2025-03-05 14:40:19,900 - EarlyStopping counter: 10 out of 10
2025-03-05 14:40:19,900 - Early stopping
2025-03-05 14:40:19,900 - ---------------Test Score---------------
2025-03-05 14:40:38,201 - {'Epoch': 0, 'HR@5': '0.0278', 'NDCG@5': '0.0174', 'HR@10': '0.0461', 'NDCG@10': '0.0233', 'HR@20': '0.0744', 'NDCG@20': '0.0304'}
2025-03-05 14:40:38,210 - Scale_Yelp
2025-03-05 14:40:38,211 - {'Epoch': 0, 'HR@5': '0.0278', 'NDCG@5': '0.0174', 'HR@10': '0.0461', 'NDCG@10': '0.0233', 'HR@20': '0.0744', 'NDCG@20': '0.0304'}
2025-03-05 16:57:59,491 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50], kernels=[4, 8, 24], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-05 16:58:03,200 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=50, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-05 16:58:03,210 - Total Parameters: 1438718
2025-03-05 16:58:39,728 - {'epoch': 0, 'rec_loss': '9.5915'}
2025-03-05 16:58:57,417 - {'Epoch': 0, 'HR@5': '0.0078', 'NDCG@5': '0.0051', 'HR@10': '0.0134', 'NDCG@10': '0.0069', 'HR@20': '0.0218', 'NDCG@20': '0.0090'}
2025-03-05 16:58:57,419 - Validation score increased.  Saving model ...
2025-03-05 16:59:39,830 - {'epoch': 1, 'rec_loss': '9.2542'}
2025-03-05 17:00:01,801 - {'Epoch': 1, 'HR@5': '0.0103', 'NDCG@5': '0.0069', 'HR@10': '0.0182', 'NDCG@10': '0.0094', 'HR@20': '0.0309', 'NDCG@20': '0.0126'}
2025-03-05 17:00:01,803 - Validation score increased.  Saving model ...
2025-03-05 17:00:49,109 - {'epoch': 2, 'rec_loss': '8.9033'}
2025-03-05 17:01:06,452 - {'Epoch': 2, 'HR@5': '0.0133', 'NDCG@5': '0.0080', 'HR@10': '0.0220', 'NDCG@10': '0.0109', 'HR@20': '0.0372', 'NDCG@20': '0.0147'}
2025-03-05 17:01:06,453 - Validation score increased.  Saving model ...
2025-03-05 17:01:50,346 - {'epoch': 3, 'rec_loss': '8.6675'}
2025-03-05 17:02:08,770 - {'Epoch': 3, 'HR@5': '0.0160', 'NDCG@5': '0.0100', 'HR@10': '0.0295', 'NDCG@10': '0.0143', 'HR@20': '0.0483', 'NDCG@20': '0.0191'}
2025-03-05 17:02:08,771 - Validation score increased.  Saving model ...
2025-03-05 17:02:57,490 - {'epoch': 4, 'rec_loss': '8.4729'}
2025-03-05 17:03:18,708 - {'Epoch': 4, 'HR@5': '0.0178', 'NDCG@5': '0.0110', 'HR@10': '0.0316', 'NDCG@10': '0.0154', 'HR@20': '0.0540', 'NDCG@20': '0.0210'}
2025-03-05 17:03:18,710 - Validation score increased.  Saving model ...
2025-03-05 17:04:08,879 - {'epoch': 5, 'rec_loss': '8.3271'}
2025-03-05 17:04:26,028 - {'Epoch': 5, 'HR@5': '0.0195', 'NDCG@5': '0.0123', 'HR@10': '0.0343', 'NDCG@10': '0.0170', 'HR@20': '0.0587', 'NDCG@20': '0.0231'}
2025-03-05 17:04:26,029 - Validation score increased.  Saving model ...
2025-03-05 17:04:59,794 - {'epoch': 6, 'rec_loss': '8.2160'}
2025-03-05 17:05:17,047 - {'Epoch': 6, 'HR@5': '0.0220', 'NDCG@5': '0.0133', 'HR@10': '0.0382', 'NDCG@10': '0.0186', 'HR@20': '0.0626', 'NDCG@20': '0.0247'}
2025-03-05 17:05:17,049 - Validation score increased.  Saving model ...
2025-03-05 17:06:03,247 - {'epoch': 7, 'rec_loss': '8.1333'}
2025-03-05 17:06:23,437 - {'Epoch': 7, 'HR@5': '0.0234', 'NDCG@5': '0.0146', 'HR@10': '0.0394', 'NDCG@10': '0.0197', 'HR@20': '0.0665', 'NDCG@20': '0.0265'}
2025-03-05 17:06:23,439 - Validation score increased.  Saving model ...
2025-03-05 17:07:12,148 - {'epoch': 8, 'rec_loss': '8.0688'}
2025-03-05 17:07:31,784 - {'Epoch': 8, 'HR@5': '0.0252', 'NDCG@5': '0.0157', 'HR@10': '0.0426', 'NDCG@10': '0.0212', 'HR@20': '0.0692', 'NDCG@20': '0.0279'}
2025-03-05 17:07:31,792 - Validation score increased.  Saving model ...
2025-03-05 17:08:15,401 - {'epoch': 9, 'rec_loss': '8.0120'}
2025-03-05 17:08:33,359 - {'Epoch': 9, 'HR@5': '0.0251', 'NDCG@5': '0.0158', 'HR@10': '0.0426', 'NDCG@10': '0.0214', 'HR@20': '0.0717', 'NDCG@20': '0.0287'}
2025-03-05 17:08:33,361 - Validation score increased.  Saving model ...
2025-03-05 17:09:17,750 - {'epoch': 10, 'rec_loss': '7.9596'}
2025-03-05 17:09:38,154 - {'Epoch': 10, 'HR@5': '0.0258', 'NDCG@5': '0.0162', 'HR@10': '0.0432', 'NDCG@10': '0.0218', 'HR@20': '0.0728', 'NDCG@20': '0.0292'}
2025-03-05 17:09:38,156 - Validation score increased.  Saving model ...
2025-03-05 17:10:27,944 - {'epoch': 11, 'rec_loss': '7.9124'}
2025-03-05 17:10:45,956 - {'Epoch': 11, 'HR@5': '0.0272', 'NDCG@5': '0.0170', 'HR@10': '0.0465', 'NDCG@10': '0.0231', 'HR@20': '0.0765', 'NDCG@20': '0.0307'}
2025-03-05 17:10:45,957 - Validation score increased.  Saving model ...
2025-03-05 17:11:27,804 - {'epoch': 12, 'rec_loss': '7.8764'}
2025-03-05 17:11:45,489 - {'Epoch': 12, 'HR@5': '0.0285', 'NDCG@5': '0.0176', 'HR@10': '0.0473', 'NDCG@10': '0.0237', 'HR@20': '0.0757', 'NDCG@20': '0.0308'}
2025-03-05 17:11:45,493 - Validation score increased.  Saving model ...
2025-03-05 17:12:29,407 - {'epoch': 13, 'rec_loss': '7.8422'}
2025-03-05 17:12:50,276 - {'Epoch': 13, 'HR@5': '0.0283', 'NDCG@5': '0.0177', 'HR@10': '0.0478', 'NDCG@10': '0.0240', 'HR@20': '0.0789', 'NDCG@20': '0.0318'}
2025-03-05 17:12:50,278 - Validation score increased.  Saving model ...
2025-03-05 17:13:43,099 - {'epoch': 14, 'rec_loss': '7.8033'}
2025-03-05 17:14:02,420 - {'Epoch': 14, 'HR@5': '0.0298', 'NDCG@5': '0.0184', 'HR@10': '0.0487', 'NDCG@10': '0.0245', 'HR@20': '0.0792', 'NDCG@20': '0.0322'}
2025-03-05 17:14:02,421 - Validation score increased.  Saving model ...
2025-03-05 17:14:39,265 - {'epoch': 15, 'rec_loss': '7.7772'}
2025-03-05 17:14:56,790 - {'Epoch': 15, 'HR@5': '0.0292', 'NDCG@5': '0.0181', 'HR@10': '0.0491', 'NDCG@10': '0.0245', 'HR@20': '0.0793', 'NDCG@20': '0.0321'}
2025-03-05 17:14:56,791 - EarlyStopping counter: 1 out of 10
2025-03-05 17:15:42,079 - {'epoch': 16, 'rec_loss': '7.7553'}
2025-03-05 17:16:03,109 - {'Epoch': 16, 'HR@5': '0.0295', 'NDCG@5': '0.0185', 'HR@10': '0.0495', 'NDCG@10': '0.0249', 'HR@20': '0.0803', 'NDCG@20': '0.0327'}
2025-03-05 17:16:03,111 - Validation score increased.  Saving model ...
2025-03-05 17:16:54,599 - {'epoch': 17, 'rec_loss': '7.7394'}
2025-03-05 17:17:13,947 - {'Epoch': 17, 'HR@5': '0.0304', 'NDCG@5': '0.0190', 'HR@10': '0.0516', 'NDCG@10': '0.0258', 'HR@20': '0.0816', 'NDCG@20': '0.0333'}
2025-03-05 17:17:13,949 - Validation score increased.  Saving model ...
2025-03-05 17:17:55,130 - {'epoch': 18, 'rec_loss': '7.7141'}
2025-03-05 17:18:13,376 - {'Epoch': 18, 'HR@5': '0.0294', 'NDCG@5': '0.0188', 'HR@10': '0.0501', 'NDCG@10': '0.0254', 'HR@20': '0.0823', 'NDCG@20': '0.0335'}
2025-03-05 17:18:13,381 - Validation score increased.  Saving model ...
2025-03-05 17:18:50,728 - {'epoch': 19, 'rec_loss': '7.6997'}
2025-03-05 17:19:11,245 - {'Epoch': 19, 'HR@5': '0.0310', 'NDCG@5': '0.0193', 'HR@10': '0.0513', 'NDCG@10': '0.0258', 'HR@20': '0.0820', 'NDCG@20': '0.0335'}
2025-03-05 17:19:11,247 - Validation score increased.  Saving model ...
2025-03-05 17:20:02,146 - {'epoch': 20, 'rec_loss': '7.6820'}
2025-03-05 17:20:22,516 - {'Epoch': 20, 'HR@5': '0.0322', 'NDCG@5': '0.0201', 'HR@10': '0.0523', 'NDCG@10': '0.0265', 'HR@20': '0.0838', 'NDCG@20': '0.0344'}
2025-03-05 17:20:22,518 - Validation score increased.  Saving model ...
2025-03-05 17:20:55,292 - {'epoch': 21, 'rec_loss': '7.6702'}
2025-03-05 17:21:12,808 - {'Epoch': 21, 'HR@5': '0.0312', 'NDCG@5': '0.0197', 'HR@10': '0.0516', 'NDCG@10': '0.0262', 'HR@20': '0.0839', 'NDCG@20': '0.0343'}
2025-03-05 17:21:12,810 - EarlyStopping counter: 1 out of 10
2025-03-05 17:21:51,807 - {'epoch': 22, 'rec_loss': '7.6518'}
2025-03-05 17:22:13,015 - {'Epoch': 22, 'HR@5': '0.0313', 'NDCG@5': '0.0192', 'HR@10': '0.0513', 'NDCG@10': '0.0257', 'HR@20': '0.0833', 'NDCG@20': '0.0337'}
2025-03-05 17:22:13,018 - EarlyStopping counter: 2 out of 10
2025-03-05 17:23:01,861 - {'epoch': 23, 'rec_loss': '7.6434'}
2025-03-05 17:23:21,932 - {'Epoch': 23, 'HR@5': '0.0317', 'NDCG@5': '0.0197', 'HR@10': '0.0524', 'NDCG@10': '0.0264', 'HR@20': '0.0841', 'NDCG@20': '0.0343'}
2025-03-05 17:23:21,940 - EarlyStopping counter: 3 out of 10
2025-03-05 17:24:06,310 - {'epoch': 24, 'rec_loss': '7.6265'}
2025-03-05 17:24:23,889 - {'Epoch': 24, 'HR@5': '0.0311', 'NDCG@5': '0.0195', 'HR@10': '0.0514', 'NDCG@10': '0.0260', 'HR@20': '0.0825', 'NDCG@20': '0.0338'}
2025-03-05 17:24:23,891 - EarlyStopping counter: 4 out of 10
2025-03-05 17:25:00,350 - {'epoch': 25, 'rec_loss': '7.6199'}
2025-03-05 17:25:19,403 - {'Epoch': 25, 'HR@5': '0.0318', 'NDCG@5': '0.0198', 'HR@10': '0.0521', 'NDCG@10': '0.0263', 'HR@20': '0.0846', 'NDCG@20': '0.0345'}
2025-03-05 17:25:19,408 - Validation score increased.  Saving model ...
2025-03-05 17:26:09,083 - {'epoch': 26, 'rec_loss': '7.6011'}
2025-03-05 17:26:29,503 - {'Epoch': 26, 'HR@5': '0.0317', 'NDCG@5': '0.0198', 'HR@10': '0.0518', 'NDCG@10': '0.0263', 'HR@20': '0.0848', 'NDCG@20': '0.0346'}
2025-03-05 17:26:29,505 - Validation score increased.  Saving model ...
2025-03-05 17:27:12,469 - {'epoch': 27, 'rec_loss': '7.5956'}
2025-03-05 17:27:30,184 - {'Epoch': 27, 'HR@5': '0.0310', 'NDCG@5': '0.0195', 'HR@10': '0.0525', 'NDCG@10': '0.0264', 'HR@20': '0.0836', 'NDCG@20': '0.0342'}
2025-03-05 17:27:30,188 - EarlyStopping counter: 1 out of 10
2025-03-05 17:28:15,827 - {'epoch': 28, 'rec_loss': '7.5863'}
2025-03-05 17:28:36,301 - {'Epoch': 28, 'HR@5': '0.0321', 'NDCG@5': '0.0200', 'HR@10': '0.0525', 'NDCG@10': '0.0266', 'HR@20': '0.0829', 'NDCG@20': '0.0343'}
2025-03-05 17:28:36,303 - EarlyStopping counter: 2 out of 10
2025-03-05 17:29:26,743 - {'epoch': 29, 'rec_loss': '7.5703'}
2025-03-05 17:29:47,860 - {'Epoch': 29, 'HR@5': '0.0323', 'NDCG@5': '0.0203', 'HR@10': '0.0537', 'NDCG@10': '0.0272', 'HR@20': '0.0852', 'NDCG@20': '0.0351'}
2025-03-05 17:29:47,862 - Validation score increased.  Saving model ...
2025-03-05 17:30:29,974 - {'epoch': 30, 'rec_loss': '7.5729'}
2025-03-05 17:30:47,723 - {'Epoch': 30, 'HR@5': '0.0324', 'NDCG@5': '0.0199', 'HR@10': '0.0534', 'NDCG@10': '0.0267', 'HR@20': '0.0857', 'NDCG@20': '0.0348'}
2025-03-05 17:30:47,725 - EarlyStopping counter: 1 out of 10
2025-03-05 17:31:29,155 - {'epoch': 31, 'rec_loss': '7.5615'}
2025-03-05 17:31:50,373 - {'Epoch': 31, 'HR@5': '0.0327', 'NDCG@5': '0.0205', 'HR@10': '0.0543', 'NDCG@10': '0.0274', 'HR@20': '0.0870', 'NDCG@20': '0.0356'}
2025-03-05 17:31:50,375 - Validation score increased.  Saving model ...
2025-03-05 17:32:38,774 - {'epoch': 32, 'rec_loss': '7.5621'}
2025-03-05 17:32:58,529 - {'Epoch': 32, 'HR@5': '0.0317', 'NDCG@5': '0.0202', 'HR@10': '0.0539', 'NDCG@10': '0.0273', 'HR@20': '0.0859', 'NDCG@20': '0.0354'}
2025-03-05 17:32:58,531 - EarlyStopping counter: 1 out of 10
2025-03-05 17:33:42,345 - {'epoch': 33, 'rec_loss': '7.5429'}
2025-03-05 17:33:59,486 - {'Epoch': 33, 'HR@5': '0.0315', 'NDCG@5': '0.0198', 'HR@10': '0.0531', 'NDCG@10': '0.0267', 'HR@20': '0.0849', 'NDCG@20': '0.0348'}
2025-03-05 17:33:59,488 - EarlyStopping counter: 2 out of 10
2025-03-05 17:34:40,990 - {'epoch': 34, 'rec_loss': '7.5422'}
2025-03-05 17:35:01,752 - {'Epoch': 34, 'HR@5': '0.0328', 'NDCG@5': '0.0204', 'HR@10': '0.0538', 'NDCG@10': '0.0271', 'HR@20': '0.0847', 'NDCG@20': '0.0349'}
2025-03-05 17:35:01,753 - EarlyStopping counter: 3 out of 10
2025-03-05 17:35:53,545 - {'epoch': 35, 'rec_loss': '7.5340'}
2025-03-05 17:36:14,169 - {'Epoch': 35, 'HR@5': '0.0326', 'NDCG@5': '0.0206', 'HR@10': '0.0524', 'NDCG@10': '0.0270', 'HR@20': '0.0858', 'NDCG@20': '0.0354'}
2025-03-05 17:36:14,171 - EarlyStopping counter: 4 out of 10
2025-03-05 17:36:51,383 - {'epoch': 36, 'rec_loss': '7.5375'}
2025-03-05 17:37:08,534 - {'Epoch': 36, 'HR@5': '0.0325', 'NDCG@5': '0.0204', 'HR@10': '0.0530', 'NDCG@10': '0.0270', 'HR@20': '0.0851', 'NDCG@20': '0.0350'}
2025-03-05 17:37:08,535 - EarlyStopping counter: 5 out of 10
2025-03-05 17:37:50,455 - {'epoch': 37, 'rec_loss': '7.5252'}
2025-03-05 17:38:10,328 - {'Epoch': 37, 'HR@5': '0.0325', 'NDCG@5': '0.0203', 'HR@10': '0.0530', 'NDCG@10': '0.0269', 'HR@20': '0.0858', 'NDCG@20': '0.0351'}
2025-03-05 17:38:10,330 - EarlyStopping counter: 6 out of 10
2025-03-05 17:38:59,563 - {'epoch': 38, 'rec_loss': '7.5110'}
2025-03-05 17:39:20,364 - {'Epoch': 38, 'HR@5': '0.0331', 'NDCG@5': '0.0207', 'HR@10': '0.0543', 'NDCG@10': '0.0275', 'HR@20': '0.0858', 'NDCG@20': '0.0354'}
2025-03-05 17:39:20,366 - EarlyStopping counter: 7 out of 10
2025-03-05 17:40:06,101 - {'epoch': 39, 'rec_loss': '7.5139'}
2025-03-05 17:40:23,144 - {'Epoch': 39, 'HR@5': '0.0319', 'NDCG@5': '0.0204', 'HR@10': '0.0535', 'NDCG@10': '0.0273', 'HR@20': '0.0858', 'NDCG@20': '0.0354'}
2025-03-05 17:40:23,151 - EarlyStopping counter: 8 out of 10
2025-03-05 17:40:58,787 - {'epoch': 40, 'rec_loss': '7.5129'}
2025-03-05 17:41:17,434 - {'Epoch': 40, 'HR@5': '0.0322', 'NDCG@5': '0.0205', 'HR@10': '0.0551', 'NDCG@10': '0.0279', 'HR@20': '0.0861', 'NDCG@20': '0.0357'}
2025-03-05 17:41:17,443 - Validation score increased.  Saving model ...
2025-03-05 17:42:06,400 - {'epoch': 41, 'rec_loss': '7.5049'}
2025-03-05 17:42:27,817 - {'Epoch': 41, 'HR@5': '0.0313', 'NDCG@5': '0.0199', 'HR@10': '0.0535', 'NDCG@10': '0.0271', 'HR@20': '0.0855', 'NDCG@20': '0.0351'}
2025-03-05 17:42:27,819 - EarlyStopping counter: 1 out of 10
2025-03-05 17:43:14,314 - {'epoch': 42, 'rec_loss': '7.5004'}
2025-03-05 17:43:32,317 - {'Epoch': 42, 'HR@5': '0.0323', 'NDCG@5': '0.0204', 'HR@10': '0.0528', 'NDCG@10': '0.0269', 'HR@20': '0.0852', 'NDCG@20': '0.0351'}
2025-03-05 17:43:32,318 - EarlyStopping counter: 2 out of 10
2025-03-05 17:44:15,835 - {'epoch': 43, 'rec_loss': '7.4936'}
2025-03-05 17:44:36,593 - {'Epoch': 43, 'HR@5': '0.0318', 'NDCG@5': '0.0200', 'HR@10': '0.0530', 'NDCG@10': '0.0268', 'HR@20': '0.0841', 'NDCG@20': '0.0347'}
2025-03-05 17:44:36,601 - EarlyStopping counter: 3 out of 10
2025-03-05 17:45:28,830 - {'epoch': 44, 'rec_loss': '7.4907'}
2025-03-05 17:45:50,235 - {'Epoch': 44, 'HR@5': '0.0331', 'NDCG@5': '0.0212', 'HR@10': '0.0536', 'NDCG@10': '0.0278', 'HR@20': '0.0863', 'NDCG@20': '0.0360'}
2025-03-05 17:45:50,238 - Validation score increased.  Saving model ...
2025-03-05 17:46:33,916 - {'epoch': 45, 'rec_loss': '7.4875'}
2025-03-05 17:46:51,641 - {'Epoch': 45, 'HR@5': '0.0328', 'NDCG@5': '0.0209', 'HR@10': '0.0533', 'NDCG@10': '0.0275', 'HR@20': '0.0851', 'NDCG@20': '0.0355'}
2025-03-05 17:46:51,642 - EarlyStopping counter: 1 out of 10
2025-03-05 17:47:39,898 - {'epoch': 46, 'rec_loss': '7.4797'}
2025-03-05 17:48:00,874 - {'Epoch': 46, 'HR@5': '0.0329', 'NDCG@5': '0.0209', 'HR@10': '0.0528', 'NDCG@10': '0.0273', 'HR@20': '0.0857', 'NDCG@20': '0.0355'}
2025-03-05 17:48:00,875 - EarlyStopping counter: 2 out of 10
2025-03-05 17:48:48,764 - {'epoch': 47, 'rec_loss': '7.4818'}
2025-03-05 17:49:08,450 - {'Epoch': 47, 'HR@5': '0.0325', 'NDCG@5': '0.0203', 'HR@10': '0.0536', 'NDCG@10': '0.0270', 'HR@20': '0.0855', 'NDCG@20': '0.0350'}
2025-03-05 17:49:08,452 - EarlyStopping counter: 3 out of 10
2025-03-05 17:49:54,604 - {'epoch': 48, 'rec_loss': '7.4671'}
2025-03-05 17:50:12,757 - {'Epoch': 48, 'HR@5': '0.0326', 'NDCG@5': '0.0209', 'HR@10': '0.0540', 'NDCG@10': '0.0278', 'HR@20': '0.0876', 'NDCG@20': '0.0362'}
2025-03-05 17:50:12,759 - Validation score increased.  Saving model ...
2025-03-05 17:50:56,894 - {'epoch': 49, 'rec_loss': '7.4691'}
2025-03-05 17:51:17,763 - {'Epoch': 49, 'HR@5': '0.0323', 'NDCG@5': '0.0204', 'HR@10': '0.0550', 'NDCG@10': '0.0277', 'HR@20': '0.0867', 'NDCG@20': '0.0357'}
2025-03-05 17:51:17,764 - EarlyStopping counter: 1 out of 10
2025-03-05 17:52:15,076 - {'epoch': 50, 'rec_loss': '7.4704'}
2025-03-05 17:52:33,172 - {'Epoch': 50, 'HR@5': '0.0337', 'NDCG@5': '0.0213', 'HR@10': '0.0540', 'NDCG@10': '0.0278', 'HR@20': '0.0866', 'NDCG@20': '0.0359'}
2025-03-05 17:52:33,173 - EarlyStopping counter: 2 out of 10
2025-03-05 17:53:11,907 - {'epoch': 51, 'rec_loss': '7.4669'}
2025-03-05 17:53:29,377 - {'Epoch': 51, 'HR@5': '0.0319', 'NDCG@5': '0.0207', 'HR@10': '0.0539', 'NDCG@10': '0.0278', 'HR@20': '0.0870', 'NDCG@20': '0.0361'}
2025-03-05 17:53:29,379 - EarlyStopping counter: 3 out of 10
2025-03-05 17:54:12,731 - {'epoch': 52, 'rec_loss': '7.4546'}
2025-03-05 17:54:33,415 - {'Epoch': 52, 'HR@5': '0.0321', 'NDCG@5': '0.0204', 'HR@10': '0.0528', 'NDCG@10': '0.0270', 'HR@20': '0.0854', 'NDCG@20': '0.0352'}
2025-03-05 17:54:33,420 - EarlyStopping counter: 4 out of 10
2025-03-05 17:55:29,183 - {'epoch': 53, 'rec_loss': '7.4541'}
2025-03-05 17:55:50,065 - {'Epoch': 53, 'HR@5': '0.0328', 'NDCG@5': '0.0209', 'HR@10': '0.0539', 'NDCG@10': '0.0277', 'HR@20': '0.0857', 'NDCG@20': '0.0357'}
2025-03-05 17:55:50,067 - EarlyStopping counter: 5 out of 10
2025-03-05 17:56:33,004 - {'epoch': 54, 'rec_loss': '7.4519'}
2025-03-05 17:56:50,211 - {'Epoch': 54, 'HR@5': '0.0323', 'NDCG@5': '0.0209', 'HR@10': '0.0523', 'NDCG@10': '0.0273', 'HR@20': '0.0853', 'NDCG@20': '0.0356'}
2025-03-05 17:56:50,212 - EarlyStopping counter: 6 out of 10
2025-03-05 17:57:37,350 - {'epoch': 55, 'rec_loss': '7.4544'}
2025-03-05 17:57:57,893 - {'Epoch': 55, 'HR@5': '0.0329', 'NDCG@5': '0.0205', 'HR@10': '0.0532', 'NDCG@10': '0.0270', 'HR@20': '0.0859', 'NDCG@20': '0.0352'}
2025-03-05 17:57:57,896 - EarlyStopping counter: 7 out of 10
2025-03-05 17:58:43,845 - {'epoch': 56, 'rec_loss': '7.4445'}
2025-03-05 17:59:02,452 - {'Epoch': 56, 'HR@5': '0.0332', 'NDCG@5': '0.0208', 'HR@10': '0.0530', 'NDCG@10': '0.0271', 'HR@20': '0.0851', 'NDCG@20': '0.0352'}
2025-03-05 17:59:02,453 - EarlyStopping counter: 8 out of 10
2025-03-05 17:59:43,305 - {'epoch': 57, 'rec_loss': '7.4481'}
2025-03-05 18:00:00,434 - {'Epoch': 57, 'HR@5': '0.0323', 'NDCG@5': '0.0206', 'HR@10': '0.0534', 'NDCG@10': '0.0274', 'HR@20': '0.0859', 'NDCG@20': '0.0355'}
2025-03-05 18:00:00,435 - EarlyStopping counter: 9 out of 10
2025-03-05 18:00:45,116 - {'epoch': 58, 'rec_loss': '7.4428'}
2025-03-05 18:01:05,898 - {'Epoch': 58, 'HR@5': '0.0319', 'NDCG@5': '0.0206', 'HR@10': '0.0528', 'NDCG@10': '0.0273', 'HR@20': '0.0855', 'NDCG@20': '0.0355'}
2025-03-05 18:01:05,900 - EarlyStopping counter: 10 out of 10
2025-03-05 18:01:05,900 - Early stopping
2025-03-05 18:01:05,900 - ---------------Test Score---------------
2025-03-05 18:01:26,672 - {'Epoch': 0, 'HR@5': '0.0295', 'NDCG@5': '0.0185', 'HR@10': '0.0511', 'NDCG@10': '0.0255', 'HR@20': '0.0792', 'NDCG@20': '0.0325'}
2025-03-05 18:01:26,673 - Scale_Yelp
2025-03-05 18:01:26,674 - {'Epoch': 0, 'HR@5': '0.0295', 'NDCG@5': '0.0185', 'HR@10': '0.0511', 'NDCG@10': '0.0255', 'HR@20': '0.0792', 'NDCG@20': '0.0325'}
2025-03-05 22:37:40,312 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 24], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-05 22:37:44,322 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-05 22:37:44,335 - Total Parameters: 1437093
2025-03-05 22:38:31,622 - {'epoch': 0, 'rec_loss': '9.5701'}
2025-03-05 22:38:49,595 - {'Epoch': 0, 'HR@5': '0.0085', 'NDCG@5': '0.0053', 'HR@10': '0.0143', 'NDCG@10': '0.0072', 'HR@20': '0.0244', 'NDCG@20': '0.0097'}
2025-03-05 22:38:49,600 - Validation score increased.  Saving model ...
2025-03-05 22:39:34,263 - {'epoch': 1, 'rec_loss': '9.0454'}
2025-03-05 22:39:51,400 - {'Epoch': 1, 'HR@5': '0.0108', 'NDCG@5': '0.0071', 'HR@10': '0.0193', 'NDCG@10': '0.0098', 'HR@20': '0.0320', 'NDCG@20': '0.0130'}
2025-03-05 22:39:51,402 - Validation score increased.  Saving model ...
2025-03-05 22:40:34,599 - {'epoch': 2, 'rec_loss': '8.6734'}
2025-03-05 22:40:50,899 - {'Epoch': 2, 'HR@5': '0.0153', 'NDCG@5': '0.0095', 'HR@10': '0.0271', 'NDCG@10': '0.0132', 'HR@20': '0.0448', 'NDCG@20': '0.0177'}
2025-03-05 22:40:50,901 - Validation score increased.  Saving model ...
2025-03-05 22:41:36,420 - {'epoch': 3, 'rec_loss': '8.4165'}
2025-03-05 22:41:53,331 - {'Epoch': 3, 'HR@5': '0.0182', 'NDCG@5': '0.0110', 'HR@10': '0.0319', 'NDCG@10': '0.0154', 'HR@20': '0.0525', 'NDCG@20': '0.0206'}
2025-03-05 22:41:53,333 - Validation score increased.  Saving model ...
2025-03-05 22:42:40,742 - {'epoch': 4, 'rec_loss': '8.2174'}
2025-03-05 22:42:57,429 - {'Epoch': 4, 'HR@5': '0.0201', 'NDCG@5': '0.0125', 'HR@10': '0.0351', 'NDCG@10': '0.0174', 'HR@20': '0.0591', 'NDCG@20': '0.0234'}
2025-03-05 22:42:57,431 - Validation score increased.  Saving model ...
2025-03-05 22:43:44,429 - {'epoch': 5, 'rec_loss': '8.0716'}
2025-03-05 22:44:01,359 - {'Epoch': 5, 'HR@5': '0.0219', 'NDCG@5': '0.0138', 'HR@10': '0.0386', 'NDCG@10': '0.0192', 'HR@20': '0.0625', 'NDCG@20': '0.0252'}
2025-03-05 22:44:01,361 - Validation score increased.  Saving model ...
2025-03-05 22:44:46,443 - {'epoch': 6, 'rec_loss': '7.9716'}
2025-03-05 22:45:03,781 - {'Epoch': 6, 'HR@5': '0.0227', 'NDCG@5': '0.0141', 'HR@10': '0.0405', 'NDCG@10': '0.0199', 'HR@20': '0.0662', 'NDCG@20': '0.0263'}
2025-03-05 22:45:03,785 - Validation score increased.  Saving model ...
2025-03-05 22:45:49,512 - {'epoch': 7, 'rec_loss': '7.8896'}
2025-03-05 22:46:06,540 - {'Epoch': 7, 'HR@5': '0.0235', 'NDCG@5': '0.0146', 'HR@10': '0.0411', 'NDCG@10': '0.0202', 'HR@20': '0.0675', 'NDCG@20': '0.0268'}
2025-03-05 22:46:06,542 - Validation score increased.  Saving model ...
2025-03-05 22:46:49,445 - {'epoch': 8, 'rec_loss': '7.8186'}
2025-03-05 22:47:06,281 - {'Epoch': 8, 'HR@5': '0.0256', 'NDCG@5': '0.0157', 'HR@10': '0.0424', 'NDCG@10': '0.0211', 'HR@20': '0.0695', 'NDCG@20': '0.0280'}
2025-03-05 22:47:06,282 - Validation score increased.  Saving model ...
2025-03-05 22:47:50,385 - {'epoch': 9, 'rec_loss': '7.7680'}
2025-03-05 22:48:07,609 - {'Epoch': 9, 'HR@5': '0.0254', 'NDCG@5': '0.0161', 'HR@10': '0.0440', 'NDCG@10': '0.0221', 'HR@20': '0.0710', 'NDCG@20': '0.0289'}
2025-03-05 22:48:07,611 - Validation score increased.  Saving model ...
2025-03-05 22:48:51,457 - {'epoch': 10, 'rec_loss': '7.7178'}
2025-03-05 22:49:08,716 - {'Epoch': 10, 'HR@5': '0.0260', 'NDCG@5': '0.0162', 'HR@10': '0.0439', 'NDCG@10': '0.0219', 'HR@20': '0.0726', 'NDCG@20': '0.0291'}
2025-03-05 22:49:08,718 - Validation score increased.  Saving model ...
2025-03-05 22:49:52,581 - {'epoch': 11, 'rec_loss': '7.6806'}
2025-03-05 22:50:09,624 - {'Epoch': 11, 'HR@5': '0.0266', 'NDCG@5': '0.0165', 'HR@10': '0.0458', 'NDCG@10': '0.0226', 'HR@20': '0.0749', 'NDCG@20': '0.0300'}
2025-03-05 22:50:09,625 - Validation score increased.  Saving model ...
2025-03-05 22:50:55,468 - {'epoch': 12, 'rec_loss': '7.6489'}
2025-03-05 22:51:12,815 - {'Epoch': 12, 'HR@5': '0.0271', 'NDCG@5': '0.0173', 'HR@10': '0.0455', 'NDCG@10': '0.0232', 'HR@20': '0.0749', 'NDCG@20': '0.0306'}
2025-03-05 22:51:12,817 - Validation score increased.  Saving model ...
2025-03-05 22:51:58,405 - {'epoch': 13, 'rec_loss': '7.6166'}
2025-03-05 22:52:15,704 - {'Epoch': 13, 'HR@5': '0.0272', 'NDCG@5': '0.0169', 'HR@10': '0.0463', 'NDCG@10': '0.0231', 'HR@20': '0.0757', 'NDCG@20': '0.0304'}
2025-03-05 22:52:15,705 - EarlyStopping counter: 1 out of 10
2025-03-05 22:52:59,979 - {'epoch': 14, 'rec_loss': '7.5916'}
2025-03-05 22:53:17,428 - {'Epoch': 14, 'HR@5': '0.0274', 'NDCG@5': '0.0174', 'HR@10': '0.0466', 'NDCG@10': '0.0236', 'HR@20': '0.0753', 'NDCG@20': '0.0308'}
2025-03-05 22:53:17,430 - Validation score increased.  Saving model ...
2025-03-05 22:54:01,341 - {'epoch': 15, 'rec_loss': '7.5687'}
2025-03-05 22:54:18,965 - {'Epoch': 15, 'HR@5': '0.0293', 'NDCG@5': '0.0183', 'HR@10': '0.0479', 'NDCG@10': '0.0242', 'HR@20': '0.0765', 'NDCG@20': '0.0314'}
2025-03-05 22:54:18,967 - Validation score increased.  Saving model ...
2025-03-05 22:55:04,759 - {'epoch': 16, 'rec_loss': '7.5484'}
2025-03-05 22:55:21,897 - {'Epoch': 16, 'HR@5': '0.0285', 'NDCG@5': '0.0176', 'HR@10': '0.0482', 'NDCG@10': '0.0239', 'HR@20': '0.0787', 'NDCG@20': '0.0316'}
2025-03-05 22:55:21,898 - Validation score increased.  Saving model ...
2025-03-05 22:56:05,296 - {'epoch': 17, 'rec_loss': '7.5258'}
2025-03-05 22:56:22,111 - {'Epoch': 17, 'HR@5': '0.0284', 'NDCG@5': '0.0174', 'HR@10': '0.0485', 'NDCG@10': '0.0238', 'HR@20': '0.0777', 'NDCG@20': '0.0312'}
2025-03-05 22:56:22,113 - EarlyStopping counter: 1 out of 10
2025-03-05 22:57:06,683 - {'epoch': 18, 'rec_loss': '7.5054'}
2025-03-05 22:57:24,547 - {'Epoch': 18, 'HR@5': '0.0281', 'NDCG@5': '0.0176', 'HR@10': '0.0475', 'NDCG@10': '0.0238', 'HR@20': '0.0783', 'NDCG@20': '0.0315'}
2025-03-05 22:57:24,549 - EarlyStopping counter: 2 out of 10
2025-03-05 22:58:07,550 - {'epoch': 19, 'rec_loss': '7.4910'}
2025-03-05 22:58:25,158 - {'Epoch': 19, 'HR@5': '0.0297', 'NDCG@5': '0.0183', 'HR@10': '0.0478', 'NDCG@10': '0.0241', 'HR@20': '0.0790', 'NDCG@20': '0.0320'}
2025-03-05 22:58:25,163 - Validation score increased.  Saving model ...
2025-03-05 22:59:09,449 - {'epoch': 20, 'rec_loss': '7.4769'}
2025-03-05 22:59:26,941 - {'Epoch': 20, 'HR@5': '0.0284', 'NDCG@5': '0.0176', 'HR@10': '0.0484', 'NDCG@10': '0.0240', 'HR@20': '0.0788', 'NDCG@20': '0.0317'}
2025-03-05 22:59:26,943 - EarlyStopping counter: 1 out of 10
2025-03-05 23:00:11,307 - {'epoch': 21, 'rec_loss': '7.4730'}
2025-03-05 23:00:28,537 - {'Epoch': 21, 'HR@5': '0.0291', 'NDCG@5': '0.0180', 'HR@10': '0.0495', 'NDCG@10': '0.0246', 'HR@20': '0.0787', 'NDCG@20': '0.0319'}
2025-03-05 23:00:28,538 - EarlyStopping counter: 2 out of 10
2025-03-05 23:01:14,703 - {'epoch': 22, 'rec_loss': '7.4592'}
2025-03-05 23:01:32,172 - {'Epoch': 22, 'HR@5': '0.0293', 'NDCG@5': '0.0181', 'HR@10': '0.0492', 'NDCG@10': '0.0245', 'HR@20': '0.0788', 'NDCG@20': '0.0319'}
2025-03-05 23:01:32,174 - EarlyStopping counter: 3 out of 10
2025-03-05 23:02:17,534 - {'epoch': 23, 'rec_loss': '7.4381'}
2025-03-05 23:02:35,177 - {'Epoch': 23, 'HR@5': '0.0297', 'NDCG@5': '0.0186', 'HR@10': '0.0495', 'NDCG@10': '0.0250', 'HR@20': '0.0802', 'NDCG@20': '0.0327'}
2025-03-05 23:02:35,179 - Validation score increased.  Saving model ...
2025-03-05 23:03:19,977 - {'epoch': 24, 'rec_loss': '7.4299'}
2025-03-05 23:03:37,515 - {'Epoch': 24, 'HR@5': '0.0295', 'NDCG@5': '0.0186', 'HR@10': '0.0500', 'NDCG@10': '0.0252', 'HR@20': '0.0803', 'NDCG@20': '0.0328'}
2025-03-05 23:03:37,516 - Validation score increased.  Saving model ...
2025-03-05 23:04:21,732 - {'epoch': 25, 'rec_loss': '7.4199'}
2025-03-05 23:04:39,348 - {'Epoch': 25, 'HR@5': '0.0302', 'NDCG@5': '0.0183', 'HR@10': '0.0490', 'NDCG@10': '0.0243', 'HR@20': '0.0799', 'NDCG@20': '0.0320'}
2025-03-05 23:04:39,349 - EarlyStopping counter: 1 out of 10
2025-03-05 23:05:24,608 - {'epoch': 26, 'rec_loss': '7.4122'}
2025-03-05 23:05:41,906 - {'Epoch': 26, 'HR@5': '0.0299', 'NDCG@5': '0.0185', 'HR@10': '0.0499', 'NDCG@10': '0.0249', 'HR@20': '0.0811', 'NDCG@20': '0.0327'}
2025-03-05 23:05:41,908 - EarlyStopping counter: 2 out of 10
2025-03-05 23:06:27,103 - {'epoch': 27, 'rec_loss': '7.4004'}
2025-03-05 23:06:44,545 - {'Epoch': 27, 'HR@5': '0.0301', 'NDCG@5': '0.0187', 'HR@10': '0.0493', 'NDCG@10': '0.0249', 'HR@20': '0.0802', 'NDCG@20': '0.0327'}
2025-03-05 23:06:44,547 - EarlyStopping counter: 3 out of 10
2025-03-05 23:07:29,803 - {'epoch': 28, 'rec_loss': '7.3912'}
2025-03-05 23:07:47,481 - {'Epoch': 28, 'HR@5': '0.0292', 'NDCG@5': '0.0183', 'HR@10': '0.0496', 'NDCG@10': '0.0249', 'HR@20': '0.0811', 'NDCG@20': '0.0328'}
2025-03-05 23:07:47,483 - EarlyStopping counter: 4 out of 10
2025-03-05 23:08:32,055 - {'epoch': 29, 'rec_loss': '7.3829'}
2025-03-05 23:08:49,544 - {'Epoch': 29, 'HR@5': '0.0284', 'NDCG@5': '0.0179', 'HR@10': '0.0500', 'NDCG@10': '0.0248', 'HR@20': '0.0810', 'NDCG@20': '0.0326'}
2025-03-05 23:08:49,546 - EarlyStopping counter: 5 out of 10
2025-03-05 23:09:35,354 - {'epoch': 30, 'rec_loss': '7.3758'}
2025-03-05 23:09:53,013 - {'Epoch': 30, 'HR@5': '0.0304', 'NDCG@5': '0.0189', 'HR@10': '0.0499', 'NDCG@10': '0.0252', 'HR@20': '0.0804', 'NDCG@20': '0.0328'}
2025-03-05 23:09:53,014 - Validation score increased.  Saving model ...
2025-03-05 23:10:37,591 - {'epoch': 31, 'rec_loss': '7.3672'}
2025-03-05 23:10:55,568 - {'Epoch': 31, 'HR@5': '0.0300', 'NDCG@5': '0.0189', 'HR@10': '0.0501', 'NDCG@10': '0.0254', 'HR@20': '0.0810', 'NDCG@20': '0.0331'}
2025-03-05 23:10:55,570 - Validation score increased.  Saving model ...
2025-03-05 23:11:39,491 - {'epoch': 32, 'rec_loss': '7.3598'}
2025-03-05 23:11:56,921 - {'Epoch': 32, 'HR@5': '0.0290', 'NDCG@5': '0.0184', 'HR@10': '0.0493', 'NDCG@10': '0.0249', 'HR@20': '0.0812', 'NDCG@20': '0.0328'}
2025-03-05 23:11:56,926 - EarlyStopping counter: 1 out of 10
2025-03-05 23:12:41,181 - {'epoch': 33, 'rec_loss': '7.3541'}
2025-03-05 23:12:59,027 - {'Epoch': 33, 'HR@5': '0.0313', 'NDCG@5': '0.0196', 'HR@10': '0.0517', 'NDCG@10': '0.0261', 'HR@20': '0.0819', 'NDCG@20': '0.0337'}
2025-03-05 23:12:59,028 - Validation score increased.  Saving model ...
2025-03-05 23:13:42,032 - {'epoch': 34, 'rec_loss': '7.3488'}
2025-03-05 23:13:58,935 - {'Epoch': 34, 'HR@5': '0.0301', 'NDCG@5': '0.0189', 'HR@10': '0.0505', 'NDCG@10': '0.0254', 'HR@20': '0.0822', 'NDCG@20': '0.0334'}
2025-03-05 23:13:58,937 - EarlyStopping counter: 1 out of 10
2025-03-05 23:14:41,932 - {'epoch': 35, 'rec_loss': '7.3405'}
2025-03-05 23:14:59,400 - {'Epoch': 35, 'HR@5': '0.0294', 'NDCG@5': '0.0180', 'HR@10': '0.0495', 'NDCG@10': '0.0244', 'HR@20': '0.0793', 'NDCG@20': '0.0319'}
2025-03-05 23:14:59,402 - EarlyStopping counter: 2 out of 10
2025-03-05 23:15:45,460 - {'epoch': 36, 'rec_loss': '7.3364'}
2025-03-05 23:16:03,165 - {'Epoch': 36, 'HR@5': '0.0291', 'NDCG@5': '0.0181', 'HR@10': '0.0489', 'NDCG@10': '0.0245', 'HR@20': '0.0810', 'NDCG@20': '0.0325'}
2025-03-05 23:16:03,167 - EarlyStopping counter: 3 out of 10
2025-03-05 23:16:47,795 - {'epoch': 37, 'rec_loss': '7.3281'}
2025-03-05 23:17:05,058 - {'Epoch': 37, 'HR@5': '0.0301', 'NDCG@5': '0.0188', 'HR@10': '0.0504', 'NDCG@10': '0.0253', 'HR@20': '0.0805', 'NDCG@20': '0.0329'}
2025-03-05 23:17:05,060 - EarlyStopping counter: 4 out of 10
2025-03-05 23:17:48,327 - {'epoch': 38, 'rec_loss': '7.3155'}
2025-03-05 23:18:06,747 - {'Epoch': 38, 'HR@5': '0.0304', 'NDCG@5': '0.0188', 'HR@10': '0.0504', 'NDCG@10': '0.0253', 'HR@20': '0.0797', 'NDCG@20': '0.0327'}
2025-03-05 23:18:06,750 - EarlyStopping counter: 5 out of 10
2025-03-05 23:18:53,062 - {'epoch': 39, 'rec_loss': '7.3137'}
2025-03-05 23:19:10,916 - {'Epoch': 39, 'HR@5': '0.0295', 'NDCG@5': '0.0183', 'HR@10': '0.0501', 'NDCG@10': '0.0249', 'HR@20': '0.0806', 'NDCG@20': '0.0326'}
2025-03-05 23:19:10,918 - EarlyStopping counter: 6 out of 10
2025-03-05 23:19:55,962 - {'epoch': 40, 'rec_loss': '7.3137'}
2025-03-05 23:20:13,620 - {'Epoch': 40, 'HR@5': '0.0294', 'NDCG@5': '0.0182', 'HR@10': '0.0487', 'NDCG@10': '0.0244', 'HR@20': '0.0784', 'NDCG@20': '0.0319'}
2025-03-05 23:20:13,623 - EarlyStopping counter: 7 out of 10
2025-03-05 23:20:59,038 - {'epoch': 41, 'rec_loss': '7.3021'}
2025-03-05 23:21:16,802 - {'Epoch': 41, 'HR@5': '0.0290', 'NDCG@5': '0.0179', 'HR@10': '0.0496', 'NDCG@10': '0.0245', 'HR@20': '0.0799', 'NDCG@20': '0.0321'}
2025-03-05 23:21:16,803 - EarlyStopping counter: 8 out of 10
2025-03-05 23:22:01,419 - {'epoch': 42, 'rec_loss': '7.2975'}
2025-03-05 23:22:18,933 - {'Epoch': 42, 'HR@5': '0.0295', 'NDCG@5': '0.0184', 'HR@10': '0.0498', 'NDCG@10': '0.0249', 'HR@20': '0.0783', 'NDCG@20': '0.0321'}
2025-03-05 23:22:18,935 - EarlyStopping counter: 9 out of 10
2025-03-05 23:23:02,447 - {'epoch': 43, 'rec_loss': '7.2958'}
2025-03-05 23:23:19,538 - {'Epoch': 43, 'HR@5': '0.0291', 'NDCG@5': '0.0180', 'HR@10': '0.0514', 'NDCG@10': '0.0251', 'HR@20': '0.0806', 'NDCG@20': '0.0324'}
2025-03-05 23:23:19,539 - EarlyStopping counter: 10 out of 10
2025-03-05 23:23:19,540 - Early stopping
2025-03-05 23:23:19,540 - ---------------Test Score---------------
2025-03-05 23:23:36,764 - {'Epoch': 0, 'HR@5': '0.0271', 'NDCG@5': '0.0170', 'HR@10': '0.0454', 'NDCG@10': '0.0230', 'HR@20': '0.0724', 'NDCG@20': '0.0298'}
2025-03-05 23:23:36,766 - Scale_Yelp
2025-03-05 23:23:36,766 - {'Epoch': 0, 'HR@5': '0.0271', 'NDCG@5': '0.0170', 'HR@10': '0.0454', 'NDCG@10': '0.0230', 'HR@20': '0.0724', 'NDCG@20': '0.0298'}
2025-03-06 12:13:35,552 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 24], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-06 12:13:39,421 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-06 12:13:39,433 - Total Parameters: 1437093
2025-03-06 12:14:22,969 - {'epoch': 0, 'rec_loss': '9.5592'}
2025-03-06 12:14:41,128 - {'Epoch': 0, 'HR@5': '0.0083', 'NDCG@5': '0.0053', 'HR@10': '0.0148', 'NDCG@10': '0.0074', 'HR@20': '0.0253', 'NDCG@20': '0.0100'}
2025-03-06 12:14:41,129 - Validation score increased.  Saving model ...
2025-03-06 12:15:25,476 - {'epoch': 1, 'rec_loss': '8.9777'}
2025-03-06 12:15:44,032 - {'Epoch': 1, 'HR@5': '0.0132', 'NDCG@5': '0.0083', 'HR@10': '0.0234', 'NDCG@10': '0.0116', 'HR@20': '0.0399', 'NDCG@20': '0.0158'}
2025-03-06 12:15:44,034 - Validation score increased.  Saving model ...
2025-03-06 12:16:28,858 - {'epoch': 2, 'rec_loss': '8.5511'}
2025-03-06 12:16:45,478 - {'Epoch': 2, 'HR@5': '0.0171', 'NDCG@5': '0.0106', 'HR@10': '0.0308', 'NDCG@10': '0.0150', 'HR@20': '0.0513', 'NDCG@20': '0.0202'}
2025-03-06 12:16:45,484 - Validation score increased.  Saving model ...
2025-03-06 12:17:25,208 - {'epoch': 3, 'rec_loss': '8.2770'}
2025-03-06 12:17:42,316 - {'Epoch': 3, 'HR@5': '0.0203', 'NDCG@5': '0.0124', 'HR@10': '0.0357', 'NDCG@10': '0.0174', 'HR@20': '0.0571', 'NDCG@20': '0.0227'}
2025-03-06 12:17:42,318 - Validation score increased.  Saving model ...
2025-03-06 12:18:27,907 - {'epoch': 4, 'rec_loss': '8.0997'}
2025-03-06 12:18:46,314 - {'Epoch': 4, 'HR@5': '0.0226', 'NDCG@5': '0.0140', 'HR@10': '0.0382', 'NDCG@10': '0.0190', 'HR@20': '0.0655', 'NDCG@20': '0.0258'}
2025-03-06 12:18:46,316 - Validation score increased.  Saving model ...
2025-03-06 12:19:33,234 - {'epoch': 5, 'rec_loss': '7.9663'}
2025-03-06 12:19:51,273 - {'Epoch': 5, 'HR@5': '0.0249', 'NDCG@5': '0.0156', 'HR@10': '0.0426', 'NDCG@10': '0.0213', 'HR@20': '0.0689', 'NDCG@20': '0.0279'}
2025-03-06 12:19:51,275 - Validation score increased.  Saving model ...
2025-03-06 12:20:38,324 - {'epoch': 6, 'rec_loss': '7.8685'}
2025-03-06 12:20:57,012 - {'Epoch': 6, 'HR@5': '0.0256', 'NDCG@5': '0.0160', 'HR@10': '0.0438', 'NDCG@10': '0.0218', 'HR@20': '0.0737', 'NDCG@20': '0.0294'}
2025-03-06 12:20:57,015 - Validation score increased.  Saving model ...
2025-03-06 12:21:42,915 - {'epoch': 7, 'rec_loss': '7.7912'}
2025-03-06 12:21:59,775 - {'Epoch': 7, 'HR@5': '0.0250', 'NDCG@5': '0.0155', 'HR@10': '0.0453', 'NDCG@10': '0.0220', 'HR@20': '0.0740', 'NDCG@20': '0.0292'}
2025-03-06 12:21:59,782 - EarlyStopping counter: 1 out of 10
2025-03-06 12:22:43,330 - {'epoch': 8, 'rec_loss': '7.7216'}
2025-03-06 12:23:00,390 - {'Epoch': 8, 'HR@5': '0.0277', 'NDCG@5': '0.0172', 'HR@10': '0.0461', 'NDCG@10': '0.0231', 'HR@20': '0.0740', 'NDCG@20': '0.0301'}
2025-03-06 12:23:00,395 - Validation score increased.  Saving model ...
2025-03-06 12:23:47,648 - {'epoch': 9, 'rec_loss': '7.6737'}
2025-03-06 12:24:07,497 - {'Epoch': 9, 'HR@5': '0.0279', 'NDCG@5': '0.0175', 'HR@10': '0.0469', 'NDCG@10': '0.0236', 'HR@20': '0.0757', 'NDCG@20': '0.0308'}
2025-03-06 12:24:07,505 - Validation score increased.  Saving model ...
2025-03-06 12:24:52,166 - {'epoch': 10, 'rec_loss': '7.6273'}
2025-03-06 12:25:11,167 - {'Epoch': 10, 'HR@5': '0.0281', 'NDCG@5': '0.0177', 'HR@10': '0.0471', 'NDCG@10': '0.0238', 'HR@20': '0.0770', 'NDCG@20': '0.0313'}
2025-03-06 12:25:11,174 - Validation score increased.  Saving model ...
2025-03-06 12:25:58,078 - {'epoch': 11, 'rec_loss': '7.5898'}
2025-03-06 12:26:17,045 - {'Epoch': 11, 'HR@5': '0.0284', 'NDCG@5': '0.0177', 'HR@10': '0.0492', 'NDCG@10': '0.0244', 'HR@20': '0.0787', 'NDCG@20': '0.0318'}
2025-03-06 12:26:17,047 - Validation score increased.  Saving model ...
2025-03-06 12:27:03,482 - {'epoch': 12, 'rec_loss': '7.5587'}
2025-03-06 12:27:21,337 - {'Epoch': 12, 'HR@5': '0.0287', 'NDCG@5': '0.0182', 'HR@10': '0.0490', 'NDCG@10': '0.0247', 'HR@20': '0.0790', 'NDCG@20': '0.0322'}
2025-03-06 12:27:21,343 - Validation score increased.  Saving model ...
2025-03-06 12:28:02,781 - {'epoch': 13, 'rec_loss': '7.5260'}
2025-03-06 12:28:21,371 - {'Epoch': 13, 'HR@5': '0.0297', 'NDCG@5': '0.0184', 'HR@10': '0.0485', 'NDCG@10': '0.0244', 'HR@20': '0.0784', 'NDCG@20': '0.0319'}
2025-03-06 12:28:21,379 - EarlyStopping counter: 1 out of 10
2025-03-06 12:29:08,322 - {'epoch': 14, 'rec_loss': '7.5038'}
2025-03-06 12:29:27,300 - {'Epoch': 14, 'HR@5': '0.0295', 'NDCG@5': '0.0187', 'HR@10': '0.0482', 'NDCG@10': '0.0247', 'HR@20': '0.0785', 'NDCG@20': '0.0323'}
2025-03-06 12:29:27,311 - Validation score increased.  Saving model ...
2025-03-06 12:30:14,096 - {'epoch': 15, 'rec_loss': '7.4804'}
2025-03-06 12:30:33,002 - {'Epoch': 15, 'HR@5': '0.0292', 'NDCG@5': '0.0179', 'HR@10': '0.0490', 'NDCG@10': '0.0243', 'HR@20': '0.0800', 'NDCG@20': '0.0321'}
2025-03-06 12:30:33,005 - EarlyStopping counter: 1 out of 10
2025-03-06 12:31:18,551 - {'epoch': 16, 'rec_loss': '7.4591'}
2025-03-06 12:31:36,617 - {'Epoch': 16, 'HR@5': '0.0300', 'NDCG@5': '0.0187', 'HR@10': '0.0503', 'NDCG@10': '0.0252', 'HR@20': '0.0810', 'NDCG@20': '0.0329'}
2025-03-06 12:31:36,618 - Validation score increased.  Saving model ...
2025-03-06 12:32:19,600 - {'epoch': 17, 'rec_loss': '7.4402'}
2025-03-06 12:32:37,219 - {'Epoch': 17, 'HR@5': '0.0309', 'NDCG@5': '0.0192', 'HR@10': '0.0499', 'NDCG@10': '0.0253', 'HR@20': '0.0805', 'NDCG@20': '0.0330'}
2025-03-06 12:32:37,223 - Validation score increased.  Saving model ...
2025-03-06 12:33:18,857 - {'epoch': 18, 'rec_loss': '7.4161'}
2025-03-06 12:33:37,470 - {'Epoch': 18, 'HR@5': '0.0287', 'NDCG@5': '0.0180', 'HR@10': '0.0499', 'NDCG@10': '0.0248', 'HR@20': '0.0795', 'NDCG@20': '0.0322'}
2025-03-06 12:33:37,473 - EarlyStopping counter: 1 out of 10
2025-03-06 12:34:22,281 - {'epoch': 19, 'rec_loss': '7.4006'}
2025-03-06 12:34:41,564 - {'Epoch': 19, 'HR@5': '0.0298', 'NDCG@5': '0.0182', 'HR@10': '0.0514', 'NDCG@10': '0.0251', 'HR@20': '0.0822', 'NDCG@20': '0.0328'}
2025-03-06 12:34:41,571 - EarlyStopping counter: 2 out of 10
2025-03-06 12:35:24,651 - {'epoch': 20, 'rec_loss': '7.3848'}
2025-03-06 12:35:45,057 - {'Epoch': 20, 'HR@5': '0.0293', 'NDCG@5': '0.0183', 'HR@10': '0.0505', 'NDCG@10': '0.0251', 'HR@20': '0.0803', 'NDCG@20': '0.0326'}
2025-03-06 12:35:45,062 - EarlyStopping counter: 3 out of 10
2025-03-06 12:36:31,913 - {'epoch': 21, 'rec_loss': '7.3744'}
2025-03-06 12:36:48,560 - {'Epoch': 21, 'HR@5': '0.0304', 'NDCG@5': '0.0191', 'HR@10': '0.0518', 'NDCG@10': '0.0260', 'HR@20': '0.0815', 'NDCG@20': '0.0334'}
2025-03-06 12:36:48,568 - Validation score increased.  Saving model ...
2025-03-06 12:37:29,558 - {'epoch': 22, 'rec_loss': '7.3583'}
2025-03-06 12:37:47,316 - {'Epoch': 22, 'HR@5': '0.0304', 'NDCG@5': '0.0188', 'HR@10': '0.0505', 'NDCG@10': '0.0253', 'HR@20': '0.0801', 'NDCG@20': '0.0327'}
2025-03-06 12:37:47,318 - EarlyStopping counter: 1 out of 10
2025-03-06 12:38:32,588 - {'epoch': 23, 'rec_loss': '7.3391'}
2025-03-06 12:38:51,622 - {'Epoch': 23, 'HR@5': '0.0310', 'NDCG@5': '0.0191', 'HR@10': '0.0507', 'NDCG@10': '0.0254', 'HR@20': '0.0826', 'NDCG@20': '0.0334'}
2025-03-06 12:38:51,625 - EarlyStopping counter: 2 out of 10
2025-03-06 12:39:34,567 - {'epoch': 24, 'rec_loss': '7.3301'}
2025-03-06 12:39:53,691 - {'Epoch': 24, 'HR@5': '0.0318', 'NDCG@5': '0.0197', 'HR@10': '0.0519', 'NDCG@10': '0.0262', 'HR@20': '0.0817', 'NDCG@20': '0.0336'}
2025-03-06 12:39:53,697 - Validation score increased.  Saving model ...
2025-03-06 12:40:37,697 - {'epoch': 25, 'rec_loss': '7.3131'}
2025-03-06 12:40:56,939 - {'Epoch': 25, 'HR@5': '0.0304', 'NDCG@5': '0.0191', 'HR@10': '0.0506', 'NDCG@10': '0.0256', 'HR@20': '0.0816', 'NDCG@20': '0.0334'}
2025-03-06 12:40:56,945 - EarlyStopping counter: 1 out of 10
2025-03-06 12:41:40,191 - {'epoch': 26, 'rec_loss': '7.3042'}
2025-03-06 12:41:58,121 - {'Epoch': 26, 'HR@5': '0.0309', 'NDCG@5': '0.0191', 'HR@10': '0.0506', 'NDCG@10': '0.0254', 'HR@20': '0.0816', 'NDCG@20': '0.0332'}
2025-03-06 12:41:58,123 - EarlyStopping counter: 2 out of 10
2025-03-06 12:42:38,212 - {'epoch': 27, 'rec_loss': '7.2943'}
2025-03-06 12:42:56,845 - {'Epoch': 27, 'HR@5': '0.0314', 'NDCG@5': '0.0197', 'HR@10': '0.0517', 'NDCG@10': '0.0262', 'HR@20': '0.0821', 'NDCG@20': '0.0338'}
2025-03-06 12:42:56,848 - Validation score increased.  Saving model ...
2025-03-06 12:43:41,673 - {'epoch': 28, 'rec_loss': '7.2858'}
2025-03-06 12:44:00,444 - {'Epoch': 28, 'HR@5': '0.0303', 'NDCG@5': '0.0192', 'HR@10': '0.0505', 'NDCG@10': '0.0257', 'HR@20': '0.0822', 'NDCG@20': '0.0336'}
2025-03-06 12:44:00,446 - EarlyStopping counter: 1 out of 10
2025-03-06 12:44:46,847 - {'epoch': 29, 'rec_loss': '7.2762'}
2025-03-06 12:45:06,073 - {'Epoch': 29, 'HR@5': '0.0296', 'NDCG@5': '0.0185', 'HR@10': '0.0499', 'NDCG@10': '0.0251', 'HR@20': '0.0798', 'NDCG@20': '0.0326'}
2025-03-06 12:45:06,075 - EarlyStopping counter: 2 out of 10
2025-03-06 12:45:51,518 - {'epoch': 30, 'rec_loss': '7.2660'}
2025-03-06 12:46:10,786 - {'Epoch': 30, 'HR@5': '0.0305', 'NDCG@5': '0.0193', 'HR@10': '0.0513', 'NDCG@10': '0.0260', 'HR@20': '0.0821', 'NDCG@20': '0.0337'}
2025-03-06 12:46:10,789 - EarlyStopping counter: 3 out of 10
2025-03-06 12:46:52,272 - {'epoch': 31, 'rec_loss': '7.2553'}
2025-03-06 12:47:09,422 - {'Epoch': 31, 'HR@5': '0.0302', 'NDCG@5': '0.0190', 'HR@10': '0.0510', 'NDCG@10': '0.0257', 'HR@20': '0.0816', 'NDCG@20': '0.0334'}
2025-03-06 12:47:09,429 - EarlyStopping counter: 4 out of 10
2025-03-06 12:47:50,917 - {'epoch': 32, 'rec_loss': '7.2502'}
2025-03-06 12:48:10,579 - {'Epoch': 32, 'HR@5': '0.0295', 'NDCG@5': '0.0185', 'HR@10': '0.0503', 'NDCG@10': '0.0251', 'HR@20': '0.0814', 'NDCG@20': '0.0329'}
2025-03-06 12:48:10,581 - EarlyStopping counter: 5 out of 10
2025-03-06 12:48:58,065 - {'epoch': 33, 'rec_loss': '7.2432'}
2025-03-06 12:49:17,314 - {'Epoch': 33, 'HR@5': '0.0314', 'NDCG@5': '0.0197', 'HR@10': '0.0527', 'NDCG@10': '0.0265', 'HR@20': '0.0852', 'NDCG@20': '0.0347'}
2025-03-06 12:49:17,316 - Validation score increased.  Saving model ...
2025-03-06 12:50:02,787 - {'epoch': 34, 'rec_loss': '7.2391'}
2025-03-06 12:50:21,753 - {'Epoch': 34, 'HR@5': '0.0303', 'NDCG@5': '0.0189', 'HR@10': '0.0507', 'NDCG@10': '0.0254', 'HR@20': '0.0811', 'NDCG@20': '0.0330'}
2025-03-06 12:50:21,764 - EarlyStopping counter: 1 out of 10
2025-03-06 12:51:06,474 - {'epoch': 35, 'rec_loss': '7.2347'}
2025-03-06 12:51:24,006 - {'Epoch': 35, 'HR@5': '0.0296', 'NDCG@5': '0.0185', 'HR@10': '0.0497', 'NDCG@10': '0.0249', 'HR@20': '0.0808', 'NDCG@20': '0.0327'}
2025-03-06 12:51:24,008 - EarlyStopping counter: 2 out of 10
2025-03-06 12:52:04,653 - {'epoch': 36, 'rec_loss': '7.2240'}
2025-03-06 12:52:22,230 - {'Epoch': 36, 'HR@5': '0.0295', 'NDCG@5': '0.0189', 'HR@10': '0.0500', 'NDCG@10': '0.0255', 'HR@20': '0.0812', 'NDCG@20': '0.0333'}
2025-03-06 12:52:22,232 - EarlyStopping counter: 3 out of 10
2025-03-06 12:53:09,280 - {'epoch': 37, 'rec_loss': '7.2160'}
2025-03-06 12:53:28,186 - {'Epoch': 37, 'HR@5': '0.0300', 'NDCG@5': '0.0192', 'HR@10': '0.0501', 'NDCG@10': '0.0256', 'HR@20': '0.0814', 'NDCG@20': '0.0335'}
2025-03-06 12:53:28,188 - EarlyStopping counter: 4 out of 10
2025-03-06 12:54:13,903 - {'epoch': 38, 'rec_loss': '7.2063'}
2025-03-06 12:54:32,853 - {'Epoch': 38, 'HR@5': '0.0304', 'NDCG@5': '0.0194', 'HR@10': '0.0500', 'NDCG@10': '0.0257', 'HR@20': '0.0817', 'NDCG@20': '0.0336'}
2025-03-06 12:54:32,860 - EarlyStopping counter: 5 out of 10
2025-03-06 12:55:18,180 - {'epoch': 39, 'rec_loss': '7.1966'}
2025-03-06 12:55:36,926 - {'Epoch': 39, 'HR@5': '0.0311', 'NDCG@5': '0.0197', 'HR@10': '0.0501', 'NDCG@10': '0.0258', 'HR@20': '0.0815', 'NDCG@20': '0.0337'}
2025-03-06 12:55:36,936 - EarlyStopping counter: 6 out of 10
2025-03-06 12:56:19,909 - {'epoch': 40, 'rec_loss': '7.2011'}
2025-03-06 12:56:37,953 - {'Epoch': 40, 'HR@5': '0.0296', 'NDCG@5': '0.0187', 'HR@10': '0.0503', 'NDCG@10': '0.0253', 'HR@20': '0.0822', 'NDCG@20': '0.0333'}
2025-03-06 12:56:37,959 - EarlyStopping counter: 7 out of 10
2025-03-06 12:57:19,488 - {'epoch': 41, 'rec_loss': '7.1888'}
2025-03-06 12:57:37,993 - {'Epoch': 41, 'HR@5': '0.0299', 'NDCG@5': '0.0191', 'HR@10': '0.0494', 'NDCG@10': '0.0253', 'HR@20': '0.0812', 'NDCG@20': '0.0333'}
2025-03-06 12:57:37,998 - EarlyStopping counter: 8 out of 10
2025-03-06 12:58:23,095 - {'epoch': 42, 'rec_loss': '7.1867'}
2025-03-06 12:58:42,332 - {'Epoch': 42, 'HR@5': '0.0295', 'NDCG@5': '0.0190', 'HR@10': '0.0495', 'NDCG@10': '0.0254', 'HR@20': '0.0807', 'NDCG@20': '0.0332'}
2025-03-06 12:58:42,338 - EarlyStopping counter: 9 out of 10
2025-03-06 12:59:29,594 - {'epoch': 43, 'rec_loss': '7.1818'}
2025-03-06 12:59:49,075 - {'Epoch': 43, 'HR@5': '0.0295', 'NDCG@5': '0.0188', 'HR@10': '0.0503', 'NDCG@10': '0.0254', 'HR@20': '0.0811', 'NDCG@20': '0.0331'}
2025-03-06 12:59:49,085 - EarlyStopping counter: 10 out of 10
2025-03-06 12:59:49,085 - Early stopping
2025-03-06 12:59:49,085 - ---------------Test Score---------------
2025-03-06 13:00:07,697 - {'Epoch': 0, 'HR@5': '0.0284', 'NDCG@5': '0.0178', 'HR@10': '0.0471', 'NDCG@10': '0.0238', 'HR@20': '0.0764', 'NDCG@20': '0.0312'}
2025-03-06 13:00:07,703 - Scale_Yelp
2025-03-06 13:00:07,703 - {'Epoch': 0, 'HR@5': '0.0284', 'NDCG@5': '0.0178', 'HR@10': '0.0471', 'NDCG@10': '0.0238', 'HR@20': '0.0764', 'NDCG@20': '0.0312'}
2025-03-06 17:14:46,961 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50], kernels=[8, 12, 32], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-06 17:14:50,840 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=50, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-06 17:14:50,847 - Total Parameters: 1438718
2025-03-06 17:15:28,000 - {'epoch': 0, 'rec_loss': '9.5941'}
2025-03-06 17:15:45,816 - {'Epoch': 0, 'HR@5': '0.0078', 'NDCG@5': '0.0050', 'HR@10': '0.0129', 'NDCG@10': '0.0067', 'HR@20': '0.0215', 'NDCG@20': '0.0088'}
2025-03-06 17:15:45,817 - Validation score increased.  Saving model ...
2025-03-06 17:16:20,890 - {'epoch': 1, 'rec_loss': '9.2612'}
2025-03-06 17:16:38,517 - {'Epoch': 1, 'HR@5': '0.0102', 'NDCG@5': '0.0067', 'HR@10': '0.0177', 'NDCG@10': '0.0092', 'HR@20': '0.0304', 'NDCG@20': '0.0124'}
2025-03-06 17:16:38,518 - Validation score increased.  Saving model ...
2025-03-06 17:17:08,693 - {'epoch': 2, 'rec_loss': '8.9097'}
2025-03-06 17:17:25,407 - {'Epoch': 2, 'HR@5': '0.0130', 'NDCG@5': '0.0080', 'HR@10': '0.0221', 'NDCG@10': '0.0109', 'HR@20': '0.0371', 'NDCG@20': '0.0147'}
2025-03-06 17:17:25,411 - Validation score increased.  Saving model ...
2025-03-06 17:17:58,584 - {'epoch': 3, 'rec_loss': '8.6689'}
2025-03-06 17:18:16,369 - {'Epoch': 3, 'HR@5': '0.0161', 'NDCG@5': '0.0101', 'HR@10': '0.0291', 'NDCG@10': '0.0142', 'HR@20': '0.0478', 'NDCG@20': '0.0190'}
2025-03-06 17:18:16,374 - Validation score increased.  Saving model ...
2025-03-06 17:18:53,936 - {'epoch': 4, 'rec_loss': '8.4744'}
2025-03-06 17:19:11,484 - {'Epoch': 4, 'HR@5': '0.0181', 'NDCG@5': '0.0111', 'HR@10': '0.0315', 'NDCG@10': '0.0154', 'HR@20': '0.0541', 'NDCG@20': '0.0211'}
2025-03-06 17:19:11,486 - Validation score increased.  Saving model ...
2025-03-06 17:19:42,874 - {'epoch': 5, 'rec_loss': '8.3308'}
2025-03-06 17:19:59,307 - {'Epoch': 5, 'HR@5': '0.0192', 'NDCG@5': '0.0120', 'HR@10': '0.0338', 'NDCG@10': '0.0166', 'HR@20': '0.0584', 'NDCG@20': '0.0228'}
2025-03-06 17:19:59,309 - Validation score increased.  Saving model ...
2025-03-06 17:20:30,772 - {'epoch': 6, 'rec_loss': '8.2227'}
2025-03-06 17:20:47,813 - {'Epoch': 6, 'HR@5': '0.0216', 'NDCG@5': '0.0132', 'HR@10': '0.0377', 'NDCG@10': '0.0183', 'HR@20': '0.0612', 'NDCG@20': '0.0242'}
2025-03-06 17:20:47,815 - Validation score increased.  Saving model ...
2025-03-06 17:21:25,580 - {'epoch': 7, 'rec_loss': '8.1407'}
2025-03-06 17:21:43,306 - {'Epoch': 7, 'HR@5': '0.0232', 'NDCG@5': '0.0145', 'HR@10': '0.0391', 'NDCG@10': '0.0195', 'HR@20': '0.0648', 'NDCG@20': '0.0260'}
2025-03-06 17:21:43,319 - Validation score increased.  Saving model ...
2025-03-06 17:22:18,446 - {'epoch': 8, 'rec_loss': '8.0761'}
2025-03-06 17:22:35,213 - {'Epoch': 8, 'HR@5': '0.0252', 'NDCG@5': '0.0155', 'HR@10': '0.0418', 'NDCG@10': '0.0208', 'HR@20': '0.0674', 'NDCG@20': '0.0273'}
2025-03-06 17:22:35,223 - Validation score increased.  Saving model ...
2025-03-06 17:23:07,198 - {'epoch': 9, 'rec_loss': '8.0195'}
2025-03-06 17:23:23,651 - {'Epoch': 9, 'HR@5': '0.0240', 'NDCG@5': '0.0154', 'HR@10': '0.0422', 'NDCG@10': '0.0212', 'HR@20': '0.0710', 'NDCG@20': '0.0284'}
2025-03-06 17:23:23,657 - Validation score increased.  Saving model ...
2025-03-06 17:23:57,674 - {'epoch': 10, 'rec_loss': '7.9663'}
2025-03-06 17:24:15,969 - {'Epoch': 10, 'HR@5': '0.0246', 'NDCG@5': '0.0153', 'HR@10': '0.0425', 'NDCG@10': '0.0211', 'HR@20': '0.0710', 'NDCG@20': '0.0282'}
2025-03-06 17:24:15,971 - EarlyStopping counter: 1 out of 10
2025-03-06 17:24:52,357 - {'epoch': 11, 'rec_loss': '7.9185'}
2025-03-06 17:25:09,843 - {'Epoch': 11, 'HR@5': '0.0272', 'NDCG@5': '0.0169', 'HR@10': '0.0459', 'NDCG@10': '0.0229', 'HR@20': '0.0759', 'NDCG@20': '0.0304'}
2025-03-06 17:25:09,846 - Validation score increased.  Saving model ...
2025-03-06 17:25:41,050 - {'epoch': 12, 'rec_loss': '7.8809'}
2025-03-06 17:25:57,806 - {'Epoch': 12, 'HR@5': '0.0276', 'NDCG@5': '0.0172', 'HR@10': '0.0473', 'NDCG@10': '0.0236', 'HR@20': '0.0747', 'NDCG@20': '0.0305'}
2025-03-06 17:25:57,809 - Validation score increased.  Saving model ...
2025-03-06 17:26:30,164 - {'epoch': 13, 'rec_loss': '7.8458'}
2025-03-06 17:26:47,411 - {'Epoch': 13, 'HR@5': '0.0272', 'NDCG@5': '0.0172', 'HR@10': '0.0468', 'NDCG@10': '0.0235', 'HR@20': '0.0781', 'NDCG@20': '0.0313'}
2025-03-06 17:26:47,415 - Validation score increased.  Saving model ...
2025-03-06 17:27:23,839 - {'epoch': 14, 'rec_loss': '7.8061'}
2025-03-06 17:27:41,874 - {'Epoch': 14, 'HR@5': '0.0294', 'NDCG@5': '0.0181', 'HR@10': '0.0482', 'NDCG@10': '0.0241', 'HR@20': '0.0788', 'NDCG@20': '0.0318'}
2025-03-06 17:27:41,875 - Validation score increased.  Saving model ...
2025-03-06 17:28:16,589 - {'epoch': 15, 'rec_loss': '7.7780'}
2025-03-06 17:28:33,567 - {'Epoch': 15, 'HR@5': '0.0291', 'NDCG@5': '0.0179', 'HR@10': '0.0498', 'NDCG@10': '0.0245', 'HR@20': '0.0781', 'NDCG@20': '0.0317'}
2025-03-06 17:28:33,572 - EarlyStopping counter: 1 out of 10
2025-03-06 17:29:05,381 - {'epoch': 16, 'rec_loss': '7.7566'}
2025-03-06 17:29:21,898 - {'Epoch': 16, 'HR@5': '0.0295', 'NDCG@5': '0.0185', 'HR@10': '0.0499', 'NDCG@10': '0.0250', 'HR@20': '0.0796', 'NDCG@20': '0.0325'}
2025-03-06 17:29:21,905 - Validation score increased.  Saving model ...
2025-03-06 17:29:56,729 - {'epoch': 17, 'rec_loss': '7.7405'}
2025-03-06 17:30:14,721 - {'Epoch': 17, 'HR@5': '0.0306', 'NDCG@5': '0.0188', 'HR@10': '0.0513', 'NDCG@10': '0.0254', 'HR@20': '0.0821', 'NDCG@20': '0.0332'}
2025-03-06 17:30:14,727 - Validation score increased.  Saving model ...
2025-03-06 17:30:53,498 - {'epoch': 18, 'rec_loss': '7.7139'}
2025-03-06 17:31:11,108 - {'Epoch': 18, 'HR@5': '0.0294', 'NDCG@5': '0.0187', 'HR@10': '0.0493', 'NDCG@10': '0.0251', 'HR@20': '0.0822', 'NDCG@20': '0.0333'}
2025-03-06 17:31:11,112 - Validation score increased.  Saving model ...
2025-03-06 17:31:42,049 - {'epoch': 19, 'rec_loss': '7.6992'}
2025-03-06 17:31:59,428 - {'Epoch': 19, 'HR@5': '0.0309', 'NDCG@5': '0.0194', 'HR@10': '0.0515', 'NDCG@10': '0.0259', 'HR@20': '0.0821', 'NDCG@20': '0.0336'}
2025-03-06 17:31:59,432 - Validation score increased.  Saving model ...
2025-03-06 17:32:31,099 - {'epoch': 20, 'rec_loss': '7.6818'}
2025-03-06 17:32:49,002 - {'Epoch': 20, 'HR@5': '0.0317', 'NDCG@5': '0.0199', 'HR@10': '0.0521', 'NDCG@10': '0.0264', 'HR@20': '0.0830', 'NDCG@20': '0.0342'}
2025-03-06 17:32:49,004 - Validation score increased.  Saving model ...
2025-03-06 17:33:27,205 - {'epoch': 21, 'rec_loss': '7.6691'}
2025-03-06 17:33:44,911 - {'Epoch': 21, 'HR@5': '0.0311', 'NDCG@5': '0.0196', 'HR@10': '0.0516', 'NDCG@10': '0.0261', 'HR@20': '0.0850', 'NDCG@20': '0.0345'}
2025-03-06 17:33:44,913 - Validation score increased.  Saving model ...
2025-03-06 17:34:20,014 - {'epoch': 22, 'rec_loss': '7.6505'}
2025-03-06 17:34:36,718 - {'Epoch': 22, 'HR@5': '0.0314', 'NDCG@5': '0.0193', 'HR@10': '0.0513', 'NDCG@10': '0.0256', 'HR@20': '0.0820', 'NDCG@20': '0.0334'}
2025-03-06 17:34:36,726 - EarlyStopping counter: 1 out of 10
2025-03-06 17:35:08,727 - {'epoch': 23, 'rec_loss': '7.6405'}
2025-03-06 17:35:26,053 - {'Epoch': 23, 'HR@5': '0.0319', 'NDCG@5': '0.0198', 'HR@10': '0.0527', 'NDCG@10': '0.0264', 'HR@20': '0.0832', 'NDCG@20': '0.0341'}
2025-03-06 17:35:26,055 - EarlyStopping counter: 2 out of 10
2025-03-06 17:36:00,970 - {'epoch': 24, 'rec_loss': '7.6253'}
2025-03-06 17:36:18,912 - {'Epoch': 24, 'HR@5': '0.0316', 'NDCG@5': '0.0197', 'HR@10': '0.0511', 'NDCG@10': '0.0260', 'HR@20': '0.0835', 'NDCG@20': '0.0341'}
2025-03-06 17:36:18,917 - EarlyStopping counter: 3 out of 10
2025-03-06 17:36:54,053 - {'epoch': 25, 'rec_loss': '7.6179'}
2025-03-06 17:37:12,248 - {'Epoch': 25, 'HR@5': '0.0321', 'NDCG@5': '0.0200', 'HR@10': '0.0521', 'NDCG@10': '0.0264', 'HR@20': '0.0842', 'NDCG@20': '0.0344'}
2025-03-06 17:37:12,249 - EarlyStopping counter: 4 out of 10
2025-03-06 17:37:43,318 - {'epoch': 26, 'rec_loss': '7.5992'}
2025-03-06 17:38:00,093 - {'Epoch': 26, 'HR@5': '0.0320', 'NDCG@5': '0.0201', 'HR@10': '0.0513', 'NDCG@10': '0.0262', 'HR@20': '0.0847', 'NDCG@20': '0.0346'}
2025-03-06 17:38:00,099 - Validation score increased.  Saving model ...
2025-03-06 17:38:31,702 - {'epoch': 27, 'rec_loss': '7.5935'}
2025-03-06 17:38:48,887 - {'Epoch': 27, 'HR@5': '0.0313', 'NDCG@5': '0.0197', 'HR@10': '0.0532', 'NDCG@10': '0.0267', 'HR@20': '0.0841', 'NDCG@20': '0.0345'}
2025-03-06 17:38:48,892 - EarlyStopping counter: 1 out of 10
2025-03-06 17:39:23,000 - {'epoch': 28, 'rec_loss': '7.5847'}
2025-03-06 17:39:40,942 - {'Epoch': 28, 'HR@5': '0.0318', 'NDCG@5': '0.0198', 'HR@10': '0.0530', 'NDCG@10': '0.0265', 'HR@20': '0.0836', 'NDCG@20': '0.0342'}
2025-03-06 17:39:40,948 - EarlyStopping counter: 2 out of 10
2025-03-06 17:40:16,102 - {'epoch': 29, 'rec_loss': '7.5682'}
2025-03-06 17:40:32,620 - {'Epoch': 29, 'HR@5': '0.0322', 'NDCG@5': '0.0201', 'HR@10': '0.0539', 'NDCG@10': '0.0271', 'HR@20': '0.0853', 'NDCG@20': '0.0349'}
2025-03-06 17:40:32,622 - Validation score increased.  Saving model ...
2025-03-06 17:41:05,123 - {'epoch': 30, 'rec_loss': '7.5699'}
2025-03-06 17:41:22,159 - {'Epoch': 30, 'HR@5': '0.0318', 'NDCG@5': '0.0198', 'HR@10': '0.0532', 'NDCG@10': '0.0266', 'HR@20': '0.0850', 'NDCG@20': '0.0346'}
2025-03-06 17:41:22,167 - EarlyStopping counter: 1 out of 10
2025-03-06 17:41:56,339 - {'epoch': 31, 'rec_loss': '7.5591'}
2025-03-06 17:42:15,482 - {'Epoch': 31, 'HR@5': '0.0321', 'NDCG@5': '0.0202', 'HR@10': '0.0537', 'NDCG@10': '0.0272', 'HR@20': '0.0858', 'NDCG@20': '0.0352'}
2025-03-06 17:42:15,484 - Validation score increased.  Saving model ...
2025-03-06 17:42:51,058 - {'epoch': 32, 'rec_loss': '7.5608'}
2025-03-06 17:43:08,935 - {'Epoch': 32, 'HR@5': '0.0317', 'NDCG@5': '0.0199', 'HR@10': '0.0525', 'NDCG@10': '0.0266', 'HR@20': '0.0855', 'NDCG@20': '0.0348'}
2025-03-06 17:43:08,940 - EarlyStopping counter: 1 out of 10
2025-03-06 17:43:41,361 - {'epoch': 33, 'rec_loss': '7.5418'}
2025-03-06 17:43:58,533 - {'Epoch': 33, 'HR@5': '0.0318', 'NDCG@5': '0.0198', 'HR@10': '0.0530', 'NDCG@10': '0.0267', 'HR@20': '0.0847', 'NDCG@20': '0.0346'}
2025-03-06 17:43:58,534 - EarlyStopping counter: 2 out of 10
2025-03-06 17:44:30,385 - {'epoch': 34, 'rec_loss': '7.5393'}
2025-03-06 17:44:47,987 - {'Epoch': 34, 'HR@5': '0.0321', 'NDCG@5': '0.0206', 'HR@10': '0.0528', 'NDCG@10': '0.0272', 'HR@20': '0.0841', 'NDCG@20': '0.0351'}
2025-03-06 17:44:47,994 - EarlyStopping counter: 3 out of 10
2025-03-06 17:45:24,690 - {'epoch': 35, 'rec_loss': '7.5315'}
2025-03-06 17:45:42,560 - {'Epoch': 35, 'HR@5': '0.0322', 'NDCG@5': '0.0205', 'HR@10': '0.0532', 'NDCG@10': '0.0272', 'HR@20': '0.0849', 'NDCG@20': '0.0351'}
2025-03-06 17:45:42,561 - EarlyStopping counter: 4 out of 10
2025-03-06 17:46:18,166 - {'epoch': 36, 'rec_loss': '7.5334'}
2025-03-06 17:46:35,342 - {'Epoch': 36, 'HR@5': '0.0324', 'NDCG@5': '0.0204', 'HR@10': '0.0534', 'NDCG@10': '0.0271', 'HR@20': '0.0852', 'NDCG@20': '0.0351'}
2025-03-06 17:46:35,343 - EarlyStopping counter: 5 out of 10
2025-03-06 17:47:08,045 - {'epoch': 37, 'rec_loss': '7.5216'}
2025-03-06 17:47:25,785 - {'Epoch': 37, 'HR@5': '0.0317', 'NDCG@5': '0.0201', 'HR@10': '0.0524', 'NDCG@10': '0.0268', 'HR@20': '0.0832', 'NDCG@20': '0.0345'}
2025-03-06 17:47:25,792 - EarlyStopping counter: 6 out of 10
2025-03-06 17:47:59,770 - {'epoch': 38, 'rec_loss': '7.5091'}
2025-03-06 17:48:18,005 - {'Epoch': 38, 'HR@5': '0.0330', 'NDCG@5': '0.0209', 'HR@10': '0.0530', 'NDCG@10': '0.0273', 'HR@20': '0.0851', 'NDCG@20': '0.0354'}
2025-03-06 17:48:18,016 - Validation score increased.  Saving model ...
2025-03-06 17:48:53,656 - {'epoch': 39, 'rec_loss': '7.5115'}
2025-03-06 17:49:11,891 - {'Epoch': 39, 'HR@5': '0.0321', 'NDCG@5': '0.0204', 'HR@10': '0.0525', 'NDCG@10': '0.0269', 'HR@20': '0.0852', 'NDCG@20': '0.0351'}
2025-03-06 17:49:11,892 - EarlyStopping counter: 1 out of 10
2025-03-06 17:49:42,601 - {'epoch': 40, 'rec_loss': '7.5103'}
2025-03-06 17:49:59,564 - {'Epoch': 40, 'HR@5': '0.0318', 'NDCG@5': '0.0201', 'HR@10': '0.0545', 'NDCG@10': '0.0274', 'HR@20': '0.0858', 'NDCG@20': '0.0353'}
2025-03-06 17:49:59,569 - EarlyStopping counter: 2 out of 10
2025-03-06 17:50:32,635 - {'epoch': 41, 'rec_loss': '7.5019'}
2025-03-06 17:50:50,827 - {'Epoch': 41, 'HR@5': '0.0317', 'NDCG@5': '0.0199', 'HR@10': '0.0537', 'NDCG@10': '0.0269', 'HR@20': '0.0848', 'NDCG@20': '0.0347'}
2025-03-06 17:50:50,828 - EarlyStopping counter: 3 out of 10
2025-03-06 17:51:26,663 - {'epoch': 42, 'rec_loss': '7.4993'}
2025-03-06 17:51:45,152 - {'Epoch': 42, 'HR@5': '0.0320', 'NDCG@5': '0.0201', 'HR@10': '0.0526', 'NDCG@10': '0.0268', 'HR@20': '0.0857', 'NDCG@20': '0.0351'}
2025-03-06 17:51:45,155 - EarlyStopping counter: 4 out of 10
2025-03-06 17:52:19,597 - {'epoch': 43, 'rec_loss': '7.4915'}
2025-03-06 17:52:36,707 - {'Epoch': 43, 'HR@5': '0.0318', 'NDCG@5': '0.0200', 'HR@10': '0.0523', 'NDCG@10': '0.0266', 'HR@20': '0.0842', 'NDCG@20': '0.0346'}
2025-03-06 17:52:36,712 - EarlyStopping counter: 5 out of 10
2025-03-06 17:53:08,709 - {'epoch': 44, 'rec_loss': '7.4878'}
2025-03-06 17:53:25,528 - {'Epoch': 44, 'HR@5': '0.0329', 'NDCG@5': '0.0211', 'HR@10': '0.0526', 'NDCG@10': '0.0274', 'HR@20': '0.0851', 'NDCG@20': '0.0356'}
2025-03-06 17:53:25,529 - Validation score increased.  Saving model ...
2025-03-06 17:54:01,011 - {'epoch': 45, 'rec_loss': '7.4859'}
2025-03-06 17:54:19,227 - {'Epoch': 45, 'HR@5': '0.0326', 'NDCG@5': '0.0208', 'HR@10': '0.0526', 'NDCG@10': '0.0272', 'HR@20': '0.0851', 'NDCG@20': '0.0354'}
2025-03-06 17:54:19,228 - EarlyStopping counter: 1 out of 10
2025-03-06 17:54:55,199 - {'epoch': 46, 'rec_loss': '7.4769'}
2025-03-06 17:55:12,924 - {'Epoch': 46, 'HR@5': '0.0326', 'NDCG@5': '0.0209', 'HR@10': '0.0529', 'NDCG@10': '0.0274', 'HR@20': '0.0849', 'NDCG@20': '0.0355'}
2025-03-06 17:55:12,926 - EarlyStopping counter: 2 out of 10
2025-03-06 17:55:43,630 - {'epoch': 47, 'rec_loss': '7.4789'}
2025-03-06 17:56:00,689 - {'Epoch': 47, 'HR@5': '0.0325', 'NDCG@5': '0.0202', 'HR@10': '0.0530', 'NDCG@10': '0.0268', 'HR@20': '0.0850', 'NDCG@20': '0.0348'}
2025-03-06 17:56:00,693 - EarlyStopping counter: 3 out of 10
2025-03-06 17:56:32,953 - {'epoch': 48, 'rec_loss': '7.4646'}
2025-03-06 17:56:50,900 - {'Epoch': 48, 'HR@5': '0.0323', 'NDCG@5': '0.0208', 'HR@10': '0.0542', 'NDCG@10': '0.0278', 'HR@20': '0.0867', 'NDCG@20': '0.0360'}
2025-03-06 17:56:50,904 - Validation score increased.  Saving model ...
2025-03-06 17:57:27,543 - {'epoch': 49, 'rec_loss': '7.4671'}
2025-03-06 17:57:46,145 - {'Epoch': 49, 'HR@5': '0.0318', 'NDCG@5': '0.0203', 'HR@10': '0.0537', 'NDCG@10': '0.0273', 'HR@20': '0.0870', 'NDCG@20': '0.0357'}
2025-03-06 17:57:46,150 - EarlyStopping counter: 1 out of 10
2025-03-06 17:58:21,773 - {'epoch': 50, 'rec_loss': '7.4684'}
2025-03-06 17:58:38,579 - {'Epoch': 50, 'HR@5': '0.0328', 'NDCG@5': '0.0206', 'HR@10': '0.0540', 'NDCG@10': '0.0274', 'HR@20': '0.0849', 'NDCG@20': '0.0351'}
2025-03-06 17:58:38,583 - EarlyStopping counter: 2 out of 10
2025-03-06 17:59:10,168 - {'epoch': 51, 'rec_loss': '7.4654'}
2025-03-06 17:59:27,193 - {'Epoch': 51, 'HR@5': '0.0325', 'NDCG@5': '0.0206', 'HR@10': '0.0535', 'NDCG@10': '0.0273', 'HR@20': '0.0862', 'NDCG@20': '0.0355'}
2025-03-06 17:59:27,197 - EarlyStopping counter: 3 out of 10
2025-03-06 18:00:03,010 - {'epoch': 52, 'rec_loss': '7.4525'}
2025-03-06 18:00:20,699 - {'Epoch': 52, 'HR@5': '0.0323', 'NDCG@5': '0.0203', 'HR@10': '0.0532', 'NDCG@10': '0.0270', 'HR@20': '0.0855', 'NDCG@20': '0.0351'}
2025-03-06 18:00:20,703 - EarlyStopping counter: 4 out of 10
2025-03-06 18:00:57,021 - {'epoch': 53, 'rec_loss': '7.4529'}
2025-03-06 18:01:14,039 - {'Epoch': 53, 'HR@5': '0.0334', 'NDCG@5': '0.0210', 'HR@10': '0.0546', 'NDCG@10': '0.0278', 'HR@20': '0.0867', 'NDCG@20': '0.0358'}
2025-03-06 18:01:14,040 - EarlyStopping counter: 5 out of 10
2025-03-06 18:01:46,373 - {'epoch': 54, 'rec_loss': '7.4493'}
2025-03-06 18:02:03,333 - {'Epoch': 54, 'HR@5': '0.0326', 'NDCG@5': '0.0208', 'HR@10': '0.0528', 'NDCG@10': '0.0272', 'HR@20': '0.0851', 'NDCG@20': '0.0353'}
2025-03-06 18:02:03,338 - EarlyStopping counter: 6 out of 10
2025-03-06 18:02:35,327 - {'epoch': 55, 'rec_loss': '7.4510'}
2025-03-06 18:02:53,987 - {'Epoch': 55, 'HR@5': '0.0331', 'NDCG@5': '0.0205', 'HR@10': '0.0535', 'NDCG@10': '0.0271', 'HR@20': '0.0852', 'NDCG@20': '0.0351'}
2025-03-06 18:02:53,989 - EarlyStopping counter: 7 out of 10
2025-03-06 18:03:30,496 - {'epoch': 56, 'rec_loss': '7.4422'}
2025-03-06 18:03:48,582 - {'Epoch': 56, 'HR@5': '0.0328', 'NDCG@5': '0.0206', 'HR@10': '0.0525', 'NDCG@10': '0.0269', 'HR@20': '0.0854', 'NDCG@20': '0.0352'}
2025-03-06 18:03:48,587 - EarlyStopping counter: 8 out of 10
2025-03-06 18:04:21,917 - {'epoch': 57, 'rec_loss': '7.4454'}
2025-03-06 18:04:39,674 - {'Epoch': 57, 'HR@5': '0.0321', 'NDCG@5': '0.0202', 'HR@10': '0.0534', 'NDCG@10': '0.0271', 'HR@20': '0.0849', 'NDCG@20': '0.0350'}
2025-03-06 18:04:39,683 - EarlyStopping counter: 9 out of 10
2025-03-06 18:05:11,389 - {'epoch': 58, 'rec_loss': '7.4391'}
2025-03-06 18:05:28,429 - {'Epoch': 58, 'HR@5': '0.0325', 'NDCG@5': '0.0207', 'HR@10': '0.0532', 'NDCG@10': '0.0274', 'HR@20': '0.0858', 'NDCG@20': '0.0355'}
2025-03-06 18:05:28,432 - EarlyStopping counter: 10 out of 10
2025-03-06 18:05:28,432 - Early stopping
2025-03-06 18:05:28,432 - ---------------Test Score---------------
2025-03-06 18:05:46,306 - {'Epoch': 0, 'HR@5': '0.0298', 'NDCG@5': '0.0186', 'HR@10': '0.0503', 'NDCG@10': '0.0252', 'HR@20': '0.0790', 'NDCG@20': '0.0324'}
2025-03-06 18:05:46,308 - Scale_Yelp
2025-03-06 18:05:46,308 - {'Epoch': 0, 'HR@5': '0.0298', 'NDCG@5': '0.0186', 'HR@10': '0.0503', 'NDCG@10': '0.0252', 'HR@20': '0.0790', 'NDCG@20': '0.0324'}
2025-03-06 18:08:35,770 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50], kernels=[4, 8, 12], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-06 18:08:39,314 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=50, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-06 18:08:39,320 - Total Parameters: 1438718
2025-03-06 18:09:13,352 - {'epoch': 0, 'rec_loss': '9.5912'}
2025-03-06 18:09:30,964 - {'Epoch': 0, 'HR@5': '0.0079', 'NDCG@5': '0.0052', 'HR@10': '0.0133', 'NDCG@10': '0.0069', 'HR@20': '0.0220', 'NDCG@20': '0.0091'}
2025-03-06 18:09:30,971 - Validation score increased.  Saving model ...
2025-03-06 18:10:05,775 - {'epoch': 1, 'rec_loss': '9.2520'}
2025-03-06 18:10:23,716 - {'Epoch': 1, 'HR@5': '0.0102', 'NDCG@5': '0.0068', 'HR@10': '0.0182', 'NDCG@10': '0.0093', 'HR@20': '0.0310', 'NDCG@20': '0.0126'}
2025-03-06 18:10:23,718 - Validation score increased.  Saving model ...
2025-03-06 18:10:59,382 - {'epoch': 2, 'rec_loss': '8.9007'}
2025-03-06 18:11:17,053 - {'Epoch': 2, 'HR@5': '0.0131', 'NDCG@5': '0.0080', 'HR@10': '0.0220', 'NDCG@10': '0.0109', 'HR@20': '0.0372', 'NDCG@20': '0.0147'}
2025-03-06 18:11:17,055 - Validation score increased.  Saving model ...
2025-03-06 18:11:50,181 - {'epoch': 3, 'rec_loss': '8.6671'}
2025-03-06 18:12:07,511 - {'Epoch': 3, 'HR@5': '0.0161', 'NDCG@5': '0.0100', 'HR@10': '0.0291', 'NDCG@10': '0.0142', 'HR@20': '0.0482', 'NDCG@20': '0.0190'}
2025-03-06 18:12:07,513 - Validation score increased.  Saving model ...
2025-03-06 18:12:40,471 - {'epoch': 4, 'rec_loss': '8.4716'}
2025-03-06 18:12:57,884 - {'Epoch': 4, 'HR@5': '0.0179', 'NDCG@5': '0.0111', 'HR@10': '0.0313', 'NDCG@10': '0.0153', 'HR@20': '0.0543', 'NDCG@20': '0.0211'}
2025-03-06 18:12:57,886 - Validation score increased.  Saving model ...
2025-03-06 18:13:32,720 - {'epoch': 5, 'rec_loss': '8.3246'}
2025-03-06 18:13:51,104 - {'Epoch': 5, 'HR@5': '0.0197', 'NDCG@5': '0.0123', 'HR@10': '0.0345', 'NDCG@10': '0.0170', 'HR@20': '0.0591', 'NDCG@20': '0.0232'}
2025-03-06 18:13:51,108 - Validation score increased.  Saving model ...
2025-03-06 18:14:26,201 - {'epoch': 6, 'rec_loss': '8.2144'}
2025-03-06 18:14:43,827 - {'Epoch': 6, 'HR@5': '0.0219', 'NDCG@5': '0.0134', 'HR@10': '0.0382', 'NDCG@10': '0.0186', 'HR@20': '0.0623', 'NDCG@20': '0.0247'}
2025-03-06 18:14:43,830 - Validation score increased.  Saving model ...
2025-03-06 18:15:18,650 - {'epoch': 7, 'rec_loss': '8.1324'}
2025-03-06 18:15:35,825 - {'Epoch': 7, 'HR@5': '0.0234', 'NDCG@5': '0.0146', 'HR@10': '0.0393', 'NDCG@10': '0.0197', 'HR@20': '0.0665', 'NDCG@20': '0.0265'}
2025-03-06 18:15:35,827 - Validation score increased.  Saving model ...
2025-03-06 18:16:12,951 - {'epoch': 8, 'rec_loss': '8.0688'}
2025-03-06 18:16:31,070 - {'Epoch': 8, 'HR@5': '0.0253', 'NDCG@5': '0.0157', 'HR@10': '0.0421', 'NDCG@10': '0.0211', 'HR@20': '0.0688', 'NDCG@20': '0.0278'}
2025-03-06 18:16:31,074 - Validation score increased.  Saving model ...
2025-03-06 18:17:09,706 - {'epoch': 9, 'rec_loss': '8.0127'}
2025-03-06 18:17:27,173 - {'Epoch': 9, 'HR@5': '0.0250', 'NDCG@5': '0.0158', 'HR@10': '0.0422', 'NDCG@10': '0.0213', 'HR@20': '0.0715', 'NDCG@20': '0.0287'}
2025-03-06 18:17:27,174 - Validation score increased.  Saving model ...
2025-03-06 18:18:00,082 - {'epoch': 10, 'rec_loss': '7.9600'}
2025-03-06 18:18:17,054 - {'Epoch': 10, 'HR@5': '0.0259', 'NDCG@5': '0.0162', 'HR@10': '0.0433', 'NDCG@10': '0.0218', 'HR@20': '0.0717', 'NDCG@20': '0.0289'}
2025-03-06 18:18:17,061 - Validation score increased.  Saving model ...
2025-03-06 18:18:51,755 - {'epoch': 11, 'rec_loss': '7.9133'}
2025-03-06 18:19:09,630 - {'Epoch': 11, 'HR@5': '0.0272', 'NDCG@5': '0.0171', 'HR@10': '0.0466', 'NDCG@10': '0.0233', 'HR@20': '0.0763', 'NDCG@20': '0.0308'}
2025-03-06 18:19:09,632 - Validation score increased.  Saving model ...
2025-03-06 18:19:47,797 - {'epoch': 12, 'rec_loss': '7.8769'}
2025-03-06 18:20:05,694 - {'Epoch': 12, 'HR@5': '0.0288', 'NDCG@5': '0.0179', 'HR@10': '0.0478', 'NDCG@10': '0.0240', 'HR@20': '0.0759', 'NDCG@20': '0.0310'}
2025-03-06 18:20:05,698 - Validation score increased.  Saving model ...
2025-03-06 18:20:38,149 - {'epoch': 13, 'rec_loss': '7.8426'}
2025-03-06 18:20:55,017 - {'Epoch': 13, 'HR@5': '0.0286', 'NDCG@5': '0.0179', 'HR@10': '0.0473', 'NDCG@10': '0.0239', 'HR@20': '0.0791', 'NDCG@20': '0.0319'}
2025-03-06 18:20:55,018 - Validation score increased.  Saving model ...
2025-03-06 18:21:28,896 - {'epoch': 14, 'rec_loss': '7.8034'}
2025-03-06 18:21:46,759 - {'Epoch': 14, 'HR@5': '0.0299', 'NDCG@5': '0.0185', 'HR@10': '0.0485', 'NDCG@10': '0.0245', 'HR@20': '0.0788', 'NDCG@20': '0.0321'}
2025-03-06 18:21:46,764 - Validation score increased.  Saving model ...
2025-03-06 18:22:25,944 - {'epoch': 15, 'rec_loss': '7.7772'}
2025-03-06 18:22:44,224 - {'Epoch': 15, 'HR@5': '0.0297', 'NDCG@5': '0.0184', 'HR@10': '0.0495', 'NDCG@10': '0.0247', 'HR@20': '0.0797', 'NDCG@20': '0.0323'}
2025-03-06 18:22:44,228 - Validation score increased.  Saving model ...
2025-03-06 18:23:20,427 - {'epoch': 16, 'rec_loss': '7.7552'}
2025-03-06 18:23:37,264 - {'Epoch': 16, 'HR@5': '0.0295', 'NDCG@5': '0.0185', 'HR@10': '0.0489', 'NDCG@10': '0.0248', 'HR@20': '0.0803', 'NDCG@20': '0.0327'}
2025-03-06 18:23:37,265 - Validation score increased.  Saving model ...
2025-03-06 18:24:09,523 - {'epoch': 17, 'rec_loss': '7.7395'}
2025-03-06 18:24:26,589 - {'Epoch': 17, 'HR@5': '0.0299', 'NDCG@5': '0.0187', 'HR@10': '0.0522', 'NDCG@10': '0.0259', 'HR@20': '0.0823', 'NDCG@20': '0.0334'}
2025-03-06 18:24:26,592 - Validation score increased.  Saving model ...
2025-03-06 18:25:03,545 - {'epoch': 18, 'rec_loss': '7.7142'}
2025-03-06 18:25:21,532 - {'Epoch': 18, 'HR@5': '0.0296', 'NDCG@5': '0.0189', 'HR@10': '0.0501', 'NDCG@10': '0.0254', 'HR@20': '0.0821', 'NDCG@20': '0.0335'}
2025-03-06 18:25:21,533 - Validation score increased.  Saving model ...
2025-03-06 18:25:58,843 - {'epoch': 19, 'rec_loss': '7.6992'}
2025-03-06 18:26:16,240 - {'Epoch': 19, 'HR@5': '0.0302', 'NDCG@5': '0.0189', 'HR@10': '0.0510', 'NDCG@10': '0.0256', 'HR@20': '0.0826', 'NDCG@20': '0.0336'}
2025-03-06 18:26:16,242 - Validation score increased.  Saving model ...
2025-03-06 18:26:47,503 - {'epoch': 20, 'rec_loss': '7.6821'}
2025-03-06 18:27:04,540 - {'Epoch': 20, 'HR@5': '0.0317', 'NDCG@5': '0.0199', 'HR@10': '0.0521', 'NDCG@10': '0.0265', 'HR@20': '0.0833', 'NDCG@20': '0.0343'}
2025-03-06 18:27:04,542 - Validation score increased.  Saving model ...
2025-03-06 18:27:38,027 - {'epoch': 21, 'rec_loss': '7.6701'}
2025-03-06 18:27:56,308 - {'Epoch': 21, 'HR@5': '0.0310', 'NDCG@5': '0.0196', 'HR@10': '0.0518', 'NDCG@10': '0.0263', 'HR@20': '0.0841', 'NDCG@20': '0.0344'}
2025-03-06 18:27:56,311 - Validation score increased.  Saving model ...
2025-03-06 18:28:34,121 - {'epoch': 22, 'rec_loss': '7.6512'}
2025-03-06 18:28:52,038 - {'Epoch': 22, 'HR@5': '0.0315', 'NDCG@5': '0.0193', 'HR@10': '0.0513', 'NDCG@10': '0.0257', 'HR@20': '0.0839', 'NDCG@20': '0.0339'}
2025-03-06 18:28:52,041 - EarlyStopping counter: 1 out of 10
2025-03-06 18:29:27,632 - {'epoch': 23, 'rec_loss': '7.6432'}
2025-03-06 18:29:44,448 - {'Epoch': 23, 'HR@5': '0.0317', 'NDCG@5': '0.0198', 'HR@10': '0.0522', 'NDCG@10': '0.0264', 'HR@20': '0.0839', 'NDCG@20': '0.0344'}
2025-03-06 18:29:44,450 - EarlyStopping counter: 2 out of 10
2025-03-06 18:30:17,612 - {'epoch': 24, 'rec_loss': '7.6260'}
2025-03-06 18:30:35,358 - {'Epoch': 24, 'HR@5': '0.0314', 'NDCG@5': '0.0199', 'HR@10': '0.0515', 'NDCG@10': '0.0263', 'HR@20': '0.0843', 'NDCG@20': '0.0345'}
2025-03-06 18:30:35,362 - Validation score increased.  Saving model ...
2025-03-06 18:31:12,756 - {'epoch': 25, 'rec_loss': '7.6201'}
2025-03-06 18:31:30,816 - {'Epoch': 25, 'HR@5': '0.0316', 'NDCG@5': '0.0197', 'HR@10': '0.0514', 'NDCG@10': '0.0261', 'HR@20': '0.0846', 'NDCG@20': '0.0344'}
2025-03-06 18:31:30,817 - EarlyStopping counter: 1 out of 10
2025-03-06 18:32:06,668 - {'epoch': 26, 'rec_loss': '7.6013'}
2025-03-06 18:32:23,815 - {'Epoch': 26, 'HR@5': '0.0320', 'NDCG@5': '0.0201', 'HR@10': '0.0515', 'NDCG@10': '0.0264', 'HR@20': '0.0847', 'NDCG@20': '0.0347'}
2025-03-06 18:32:23,818 - Validation score increased.  Saving model ...
2025-03-06 18:32:56,306 - {'epoch': 27, 'rec_loss': '7.5952'}
2025-03-06 18:33:13,439 - {'Epoch': 27, 'HR@5': '0.0311', 'NDCG@5': '0.0196', 'HR@10': '0.0531', 'NDCG@10': '0.0267', 'HR@20': '0.0842', 'NDCG@20': '0.0345'}
2025-03-06 18:33:13,441 - EarlyStopping counter: 1 out of 10
2025-03-06 18:33:50,938 - {'epoch': 28, 'rec_loss': '7.5864'}
2025-03-06 18:34:09,506 - {'Epoch': 28, 'HR@5': '0.0322', 'NDCG@5': '0.0201', 'HR@10': '0.0529', 'NDCG@10': '0.0268', 'HR@20': '0.0831', 'NDCG@20': '0.0344'}
2025-03-06 18:34:09,507 - EarlyStopping counter: 2 out of 10
2025-03-06 18:34:47,921 - {'epoch': 29, 'rec_loss': '7.5696'}
2025-03-06 18:35:04,922 - {'Epoch': 29, 'HR@5': '0.0316', 'NDCG@5': '0.0200', 'HR@10': '0.0538', 'NDCG@10': '0.0271', 'HR@20': '0.0857', 'NDCG@20': '0.0351'}
2025-03-06 18:35:04,923 - Validation score increased.  Saving model ...
2025-03-06 18:35:38,202 - {'epoch': 30, 'rec_loss': '7.5722'}
2025-03-06 18:35:55,258 - {'Epoch': 30, 'HR@5': '0.0325', 'NDCG@5': '0.0203', 'HR@10': '0.0536', 'NDCG@10': '0.0271', 'HR@20': '0.0855', 'NDCG@20': '0.0351'}
2025-03-06 18:35:55,260 - EarlyStopping counter: 1 out of 10
2025-03-06 18:36:29,193 - {'epoch': 31, 'rec_loss': '7.5615'}
2025-03-06 18:36:47,481 - {'Epoch': 31, 'HR@5': '0.0323', 'NDCG@5': '0.0204', 'HR@10': '0.0541', 'NDCG@10': '0.0274', 'HR@20': '0.0861', 'NDCG@20': '0.0354'}
2025-03-06 18:36:47,485 - Validation score increased.  Saving model ...
2025-03-06 18:37:23,485 - {'epoch': 32, 'rec_loss': '7.5625'}
2025-03-06 18:37:41,298 - {'Epoch': 32, 'HR@5': '0.0320', 'NDCG@5': '0.0204', 'HR@10': '0.0530', 'NDCG@10': '0.0272', 'HR@20': '0.0856', 'NDCG@20': '0.0354'}
2025-03-06 18:37:41,300 - EarlyStopping counter: 1 out of 10
2025-03-06 18:38:14,110 - {'epoch': 33, 'rec_loss': '7.5433'}
2025-03-06 18:38:31,087 - {'Epoch': 33, 'HR@5': '0.0315', 'NDCG@5': '0.0198', 'HR@10': '0.0532', 'NDCG@10': '0.0268', 'HR@20': '0.0849', 'NDCG@20': '0.0348'}
2025-03-06 18:38:31,088 - EarlyStopping counter: 2 out of 10
2025-03-06 18:39:04,295 - {'epoch': 34, 'rec_loss': '7.5416'}
2025-03-06 18:39:21,033 - {'Epoch': 34, 'HR@5': '0.0321', 'NDCG@5': '0.0201', 'HR@10': '0.0533', 'NDCG@10': '0.0269', 'HR@20': '0.0846', 'NDCG@20': '0.0348'}
2025-03-06 18:39:21,034 - EarlyStopping counter: 3 out of 10
2025-03-06 18:39:58,629 - {'epoch': 35, 'rec_loss': '7.5339'}
2025-03-06 18:40:16,471 - {'Epoch': 35, 'HR@5': '0.0322', 'NDCG@5': '0.0205', 'HR@10': '0.0531', 'NDCG@10': '0.0272', 'HR@20': '0.0851', 'NDCG@20': '0.0352'}
2025-03-06 18:40:16,472 - EarlyStopping counter: 4 out of 10
2025-03-06 18:40:53,444 - {'epoch': 36, 'rec_loss': '7.5375'}
2025-03-06 18:41:10,238 - {'Epoch': 36, 'HR@5': '0.0322', 'NDCG@5': '0.0204', 'HR@10': '0.0527', 'NDCG@10': '0.0270', 'HR@20': '0.0861', 'NDCG@20': '0.0353'}
2025-03-06 18:41:10,240 - EarlyStopping counter: 5 out of 10
2025-03-06 18:41:42,488 - {'epoch': 37, 'rec_loss': '7.5241'}
2025-03-06 18:41:59,559 - {'Epoch': 37, 'HR@5': '0.0327', 'NDCG@5': '0.0206', 'HR@10': '0.0538', 'NDCG@10': '0.0273', 'HR@20': '0.0843', 'NDCG@20': '0.0350'}
2025-03-06 18:41:59,561 - EarlyStopping counter: 6 out of 10
2025-03-06 18:42:33,815 - {'epoch': 38, 'rec_loss': '7.5113'}
2025-03-06 18:42:51,854 - {'Epoch': 38, 'HR@5': '0.0335', 'NDCG@5': '0.0211', 'HR@10': '0.0530', 'NDCG@10': '0.0274', 'HR@20': '0.0859', 'NDCG@20': '0.0356'}
2025-03-06 18:42:51,858 - Validation score increased.  Saving model ...
2025-03-06 18:43:29,534 - {'epoch': 39, 'rec_loss': '7.5136'}
2025-03-06 18:43:47,624 - {'Epoch': 39, 'HR@5': '0.0317', 'NDCG@5': '0.0203', 'HR@10': '0.0537', 'NDCG@10': '0.0273', 'HR@20': '0.0857', 'NDCG@20': '0.0354'}
2025-03-06 18:43:47,626 - EarlyStopping counter: 1 out of 10
2025-03-06 18:44:19,419 - {'epoch': 40, 'rec_loss': '7.5129'}
2025-03-06 18:44:36,972 - {'Epoch': 40, 'HR@5': '0.0322', 'NDCG@5': '0.0206', 'HR@10': '0.0543', 'NDCG@10': '0.0277', 'HR@20': '0.0865', 'NDCG@20': '0.0358'}
2025-03-06 18:44:36,974 - Validation score increased.  Saving model ...
2025-03-06 18:45:09,790 - {'epoch': 41, 'rec_loss': '7.5046'}
2025-03-06 18:45:27,831 - {'Epoch': 41, 'HR@5': '0.0316', 'NDCG@5': '0.0201', 'HR@10': '0.0532', 'NDCG@10': '0.0270', 'HR@20': '0.0859', 'NDCG@20': '0.0352'}
2025-03-06 18:45:27,841 - EarlyStopping counter: 1 out of 10
2025-03-06 18:46:03,750 - {'epoch': 42, 'rec_loss': '7.5002'}
2025-03-06 18:46:21,607 - {'Epoch': 42, 'HR@5': '0.0317', 'NDCG@5': '0.0203', 'HR@10': '0.0531', 'NDCG@10': '0.0271', 'HR@20': '0.0848', 'NDCG@20': '0.0351'}
2025-03-06 18:46:21,609 - EarlyStopping counter: 2 out of 10
2025-03-06 18:46:56,497 - {'epoch': 43, 'rec_loss': '7.4934'}
2025-03-06 18:47:13,873 - {'Epoch': 43, 'HR@5': '0.0320', 'NDCG@5': '0.0201', 'HR@10': '0.0526', 'NDCG@10': '0.0267', 'HR@20': '0.0845', 'NDCG@20': '0.0347'}
2025-03-06 18:47:13,875 - EarlyStopping counter: 3 out of 10
2025-03-06 18:47:45,963 - {'epoch': 44, 'rec_loss': '7.4911'}
2025-03-06 18:48:03,134 - {'Epoch': 44, 'HR@5': '0.0328', 'NDCG@5': '0.0209', 'HR@10': '0.0532', 'NDCG@10': '0.0274', 'HR@20': '0.0854', 'NDCG@20': '0.0355'}
2025-03-06 18:48:03,135 - EarlyStopping counter: 4 out of 10
2025-03-06 18:48:39,860 - {'epoch': 45, 'rec_loss': '7.4878'}
2025-03-06 18:48:58,368 - {'Epoch': 45, 'HR@5': '0.0327', 'NDCG@5': '0.0208', 'HR@10': '0.0527', 'NDCG@10': '0.0273', 'HR@20': '0.0849', 'NDCG@20': '0.0353'}
2025-03-06 18:48:58,370 - EarlyStopping counter: 5 out of 10
2025-03-06 18:49:35,264 - {'epoch': 46, 'rec_loss': '7.4801'}
2025-03-06 18:49:53,127 - {'Epoch': 46, 'HR@5': '0.0323', 'NDCG@5': '0.0208', 'HR@10': '0.0534', 'NDCG@10': '0.0275', 'HR@20': '0.0851', 'NDCG@20': '0.0355'}
2025-03-06 18:49:53,128 - EarlyStopping counter: 6 out of 10
2025-03-06 18:50:25,399 - {'epoch': 47, 'rec_loss': '7.4817'}
2025-03-06 18:50:42,803 - {'Epoch': 47, 'HR@5': '0.0316', 'NDCG@5': '0.0198', 'HR@10': '0.0527', 'NDCG@10': '0.0266', 'HR@20': '0.0849', 'NDCG@20': '0.0347'}
2025-03-06 18:50:42,804 - EarlyStopping counter: 7 out of 10
2025-03-06 18:51:15,969 - {'epoch': 48, 'rec_loss': '7.4672'}
2025-03-06 18:51:33,911 - {'Epoch': 48, 'HR@5': '0.0317', 'NDCG@5': '0.0206', 'HR@10': '0.0541', 'NDCG@10': '0.0277', 'HR@20': '0.0863', 'NDCG@20': '0.0358'}
2025-03-06 18:51:33,912 - Validation score increased.  Saving model ...
2025-03-06 18:52:12,072 - {'epoch': 49, 'rec_loss': '7.4698'}
2025-03-06 18:52:30,411 - {'Epoch': 49, 'HR@5': '0.0330', 'NDCG@5': '0.0208', 'HR@10': '0.0542', 'NDCG@10': '0.0276', 'HR@20': '0.0870', 'NDCG@20': '0.0358'}
2025-03-06 18:52:30,413 - Validation score increased.  Saving model ...
2025-03-06 18:53:04,404 - {'epoch': 50, 'rec_loss': '7.4703'}
2025-03-06 18:53:21,230 - {'Epoch': 50, 'HR@5': '0.0332', 'NDCG@5': '0.0210', 'HR@10': '0.0539', 'NDCG@10': '0.0276', 'HR@20': '0.0856', 'NDCG@20': '0.0356'}
2025-03-06 18:53:21,232 - EarlyStopping counter: 1 out of 10
2025-03-06 18:53:54,334 - {'epoch': 51, 'rec_loss': '7.4667'}
2025-03-06 18:54:11,592 - {'Epoch': 51, 'HR@5': '0.0324', 'NDCG@5': '0.0209', 'HR@10': '0.0535', 'NDCG@10': '0.0277', 'HR@20': '0.0865', 'NDCG@20': '0.0360'}
2025-03-06 18:54:11,594 - Validation score increased.  Saving model ...
2025-03-06 18:54:49,161 - {'epoch': 52, 'rec_loss': '7.4544'}
2025-03-06 18:55:07,453 - {'Epoch': 52, 'HR@5': '0.0324', 'NDCG@5': '0.0204', 'HR@10': '0.0536', 'NDCG@10': '0.0273', 'HR@20': '0.0849', 'NDCG@20': '0.0351'}
2025-03-06 18:55:07,455 - EarlyStopping counter: 1 out of 10
2025-03-06 18:55:44,204 - {'epoch': 53, 'rec_loss': '7.4540'}
2025-03-06 18:56:01,163 - {'Epoch': 53, 'HR@5': '0.0331', 'NDCG@5': '0.0211', 'HR@10': '0.0540', 'NDCG@10': '0.0278', 'HR@20': '0.0862', 'NDCG@20': '0.0359'}
2025-03-06 18:56:01,164 - EarlyStopping counter: 2 out of 10
2025-03-06 18:56:33,554 - {'epoch': 54, 'rec_loss': '7.4524'}
2025-03-06 18:56:50,335 - {'Epoch': 54, 'HR@5': '0.0321', 'NDCG@5': '0.0210', 'HR@10': '0.0527', 'NDCG@10': '0.0276', 'HR@20': '0.0842', 'NDCG@20': '0.0355'}
2025-03-06 18:56:50,340 - EarlyStopping counter: 3 out of 10
2025-03-06 18:57:23,893 - {'epoch': 55, 'rec_loss': '7.4540'}
2025-03-06 18:57:41,808 - {'Epoch': 55, 'HR@5': '0.0326', 'NDCG@5': '0.0204', 'HR@10': '0.0533', 'NDCG@10': '0.0270', 'HR@20': '0.0849', 'NDCG@20': '0.0350'}
2025-03-06 18:57:41,810 - EarlyStopping counter: 4 out of 10
2025-03-06 18:58:18,310 - {'epoch': 56, 'rec_loss': '7.4452'}
2025-03-06 18:58:36,158 - {'Epoch': 56, 'HR@5': '0.0329', 'NDCG@5': '0.0206', 'HR@10': '0.0533', 'NDCG@10': '0.0271', 'HR@20': '0.0851', 'NDCG@20': '0.0351'}
2025-03-06 18:58:36,159 - EarlyStopping counter: 5 out of 10
2025-03-06 18:59:09,724 - {'epoch': 57, 'rec_loss': '7.4477'}
2025-03-06 18:59:26,843 - {'Epoch': 57, 'HR@5': '0.0322', 'NDCG@5': '0.0205', 'HR@10': '0.0529', 'NDCG@10': '0.0271', 'HR@20': '0.0847', 'NDCG@20': '0.0351'}
2025-03-06 18:59:26,844 - EarlyStopping counter: 6 out of 10
2025-03-06 19:00:00,801 - {'epoch': 58, 'rec_loss': '7.4438'}
2025-03-06 19:00:18,270 - {'Epoch': 58, 'HR@5': '0.0316', 'NDCG@5': '0.0205', 'HR@10': '0.0538', 'NDCG@10': '0.0276', 'HR@20': '0.0845', 'NDCG@20': '0.0353'}
2025-03-06 19:00:18,272 - EarlyStopping counter: 7 out of 10
2025-03-06 19:00:53,953 - {'epoch': 59, 'rec_loss': '7.4317'}
2025-03-06 19:01:12,190 - {'Epoch': 59, 'HR@5': '0.0328', 'NDCG@5': '0.0206', 'HR@10': '0.0540', 'NDCG@10': '0.0274', 'HR@20': '0.0855', 'NDCG@20': '0.0354'}
2025-03-06 19:01:12,192 - EarlyStopping counter: 8 out of 10
2025-03-06 19:01:48,190 - {'epoch': 60, 'rec_loss': '7.4382'}
2025-03-06 19:02:04,859 - {'Epoch': 60, 'HR@5': '0.0330', 'NDCG@5': '0.0212', 'HR@10': '0.0546', 'NDCG@10': '0.0281', 'HR@20': '0.0870', 'NDCG@20': '0.0362'}
2025-03-06 19:02:04,861 - Validation score increased.  Saving model ...
2025-03-06 19:02:37,254 - {'epoch': 61, 'rec_loss': '7.4348'}
2025-03-06 19:02:54,042 - {'Epoch': 61, 'HR@5': '0.0335', 'NDCG@5': '0.0211', 'HR@10': '0.0545', 'NDCG@10': '0.0279', 'HR@20': '0.0862', 'NDCG@20': '0.0358'}
2025-03-06 19:02:54,044 - EarlyStopping counter: 1 out of 10
2025-03-06 19:03:27,052 - {'epoch': 62, 'rec_loss': '7.4366'}
2025-03-06 19:03:44,663 - {'Epoch': 62, 'HR@5': '0.0316', 'NDCG@5': '0.0206', 'HR@10': '0.0540', 'NDCG@10': '0.0278', 'HR@20': '0.0856', 'NDCG@20': '0.0357'}
2025-03-06 19:03:44,664 - EarlyStopping counter: 2 out of 10
2025-03-06 19:04:20,218 - {'epoch': 63, 'rec_loss': '7.4357'}
2025-03-06 19:04:37,794 - {'Epoch': 63, 'HR@5': '0.0321', 'NDCG@5': '0.0207', 'HR@10': '0.0537', 'NDCG@10': '0.0276', 'HR@20': '0.0865', 'NDCG@20': '0.0358'}
2025-03-06 19:04:37,796 - EarlyStopping counter: 3 out of 10
2025-03-06 19:05:09,851 - {'epoch': 64, 'rec_loss': '7.4312'}
2025-03-06 19:05:27,097 - {'Epoch': 64, 'HR@5': '0.0328', 'NDCG@5': '0.0210', 'HR@10': '0.0539', 'NDCG@10': '0.0278', 'HR@20': '0.0864', 'NDCG@20': '0.0360'}
2025-03-06 19:05:27,102 - EarlyStopping counter: 4 out of 10
2025-03-06 19:06:00,211 - {'epoch': 65, 'rec_loss': '7.4292'}
2025-03-06 19:06:17,440 - {'Epoch': 65, 'HR@5': '0.0320', 'NDCG@5': '0.0204', 'HR@10': '0.0537', 'NDCG@10': '0.0274', 'HR@20': '0.0870', 'NDCG@20': '0.0358'}
2025-03-06 19:06:17,442 - EarlyStopping counter: 5 out of 10
2025-03-06 19:06:56,334 - {'epoch': 66, 'rec_loss': '7.4253'}
2025-03-06 19:07:14,828 - {'Epoch': 66, 'HR@5': '0.0325', 'NDCG@5': '0.0204', 'HR@10': '0.0534', 'NDCG@10': '0.0271', 'HR@20': '0.0852', 'NDCG@20': '0.0351'}
2025-03-06 19:07:14,831 - EarlyStopping counter: 6 out of 10
2025-03-06 19:07:51,425 - {'epoch': 67, 'rec_loss': '7.4250'}
2025-03-06 19:08:07,794 - {'Epoch': 67, 'HR@5': '0.0326', 'NDCG@5': '0.0206', 'HR@10': '0.0540', 'NDCG@10': '0.0275', 'HR@20': '0.0866', 'NDCG@20': '0.0357'}
2025-03-06 19:08:07,798 - EarlyStopping counter: 7 out of 10
2025-03-06 19:08:39,753 - {'epoch': 68, 'rec_loss': '7.4109'}
2025-03-06 19:08:56,926 - {'Epoch': 68, 'HR@5': '0.0321', 'NDCG@5': '0.0206', 'HR@10': '0.0539', 'NDCG@10': '0.0276', 'HR@20': '0.0860', 'NDCG@20': '0.0356'}
2025-03-06 19:08:56,930 - EarlyStopping counter: 8 out of 10
2025-03-06 19:09:32,734 - {'epoch': 69, 'rec_loss': '7.4137'}
2025-03-06 19:09:52,011 - {'Epoch': 69, 'HR@5': '0.0324', 'NDCG@5': '0.0206', 'HR@10': '0.0530', 'NDCG@10': '0.0271', 'HR@20': '0.0862', 'NDCG@20': '0.0355'}
2025-03-06 19:09:52,017 - EarlyStopping counter: 9 out of 10
2025-03-06 19:10:32,124 - {'epoch': 70, 'rec_loss': '7.4126'}
2025-03-06 19:10:50,489 - {'Epoch': 70, 'HR@5': '0.0323', 'NDCG@5': '0.0205', 'HR@10': '0.0539', 'NDCG@10': '0.0274', 'HR@20': '0.0859', 'NDCG@20': '0.0354'}
2025-03-06 19:10:50,494 - EarlyStopping counter: 10 out of 10
2025-03-06 19:10:50,494 - Early stopping
2025-03-06 19:10:50,494 - ---------------Test Score---------------
2025-03-06 19:11:07,483 - {'Epoch': 0, 'HR@5': '0.0306', 'NDCG@5': '0.0193', 'HR@10': '0.0515', 'NDCG@10': '0.0261', 'HR@20': '0.0806', 'NDCG@20': '0.0334'}
2025-03-06 19:11:07,484 - Scale_Yelp
2025-03-06 19:11:07,484 - {'Epoch': 0, 'HR@5': '0.0306', 'NDCG@5': '0.0193', 'HR@10': '0.0515', 'NDCG@10': '0.0261', 'HR@20': '0.0806', 'NDCG@20': '0.0334'}
2025-03-06 19:46:19,472 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 24], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-06 19:46:23,197 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-06 19:46:23,202 - Total Parameters: 1437093
2025-03-06 19:47:14,519 - {'epoch': 0, 'rec_loss': '9.5293'}
2025-03-06 19:47:33,228 - {'Epoch': 0, 'HR@5': '0.0095', 'NDCG@5': '0.0061', 'HR@10': '0.0150', 'NDCG@10': '0.0078', 'HR@20': '0.0261', 'NDCG@20': '0.0106'}
2025-03-06 19:47:33,230 - Validation score increased.  Saving model ...
2025-03-06 19:48:28,733 - {'epoch': 1, 'rec_loss': '8.7116'}
2025-03-06 19:48:48,514 - {'Epoch': 1, 'HR@5': '0.0161', 'NDCG@5': '0.0102', 'HR@10': '0.0286', 'NDCG@10': '0.0141', 'HR@20': '0.0467', 'NDCG@20': '0.0187'}
2025-03-06 19:48:48,516 - Validation score increased.  Saving model ...
2025-03-06 19:49:40,632 - {'epoch': 2, 'rec_loss': '8.1779'}
2025-03-06 19:49:57,802 - {'Epoch': 2, 'HR@5': '0.0207', 'NDCG@5': '0.0134', 'HR@10': '0.0351', 'NDCG@10': '0.0181', 'HR@20': '0.0598', 'NDCG@20': '0.0243'}
2025-03-06 19:49:57,810 - Validation score increased.  Saving model ...
2025-03-06 19:50:47,208 - {'epoch': 3, 'rec_loss': '7.8764'}
2025-03-06 19:51:05,535 - {'Epoch': 3, 'HR@5': '0.0223', 'NDCG@5': '0.0138', 'HR@10': '0.0390', 'NDCG@10': '0.0192', 'HR@20': '0.0646', 'NDCG@20': '0.0256'}
2025-03-06 19:51:05,541 - Validation score increased.  Saving model ...
2025-03-06 19:52:00,237 - {'epoch': 4, 'rec_loss': '7.6707'}
2025-03-06 19:52:19,703 - {'Epoch': 4, 'HR@5': '0.0245', 'NDCG@5': '0.0153', 'HR@10': '0.0426', 'NDCG@10': '0.0211', 'HR@20': '0.0689', 'NDCG@20': '0.0277'}
2025-03-06 19:52:19,710 - Validation score increased.  Saving model ...
2025-03-06 19:53:10,058 - {'epoch': 5, 'rec_loss': '7.5262'}
2025-03-06 19:53:28,021 - {'Epoch': 5, 'HR@5': '0.0260', 'NDCG@5': '0.0163', 'HR@10': '0.0426', 'NDCG@10': '0.0216', 'HR@20': '0.0693', 'NDCG@20': '0.0283'}
2025-03-06 19:53:28,028 - Validation score increased.  Saving model ...
2025-03-06 19:54:21,838 - {'epoch': 6, 'rec_loss': '7.4225'}
2025-03-06 19:54:41,274 - {'Epoch': 6, 'HR@5': '0.0253', 'NDCG@5': '0.0163', 'HR@10': '0.0451', 'NDCG@10': '0.0226', 'HR@20': '0.0711', 'NDCG@20': '0.0292'}
2025-03-06 19:54:41,280 - Validation score increased.  Saving model ...
2025-03-06 19:55:34,722 - {'epoch': 7, 'rec_loss': '7.3451'}
2025-03-06 19:55:52,581 - {'Epoch': 7, 'HR@5': '0.0270', 'NDCG@5': '0.0168', 'HR@10': '0.0458', 'NDCG@10': '0.0228', 'HR@20': '0.0738', 'NDCG@20': '0.0298'}
2025-03-06 19:55:52,589 - Validation score increased.  Saving model ...
2025-03-06 19:56:40,316 - {'epoch': 8, 'rec_loss': '7.2829'}
2025-03-06 19:56:58,598 - {'Epoch': 8, 'HR@5': '0.0262', 'NDCG@5': '0.0161', 'HR@10': '0.0435', 'NDCG@10': '0.0217', 'HR@20': '0.0712', 'NDCG@20': '0.0286'}
2025-03-06 19:56:58,600 - EarlyStopping counter: 1 out of 10
2025-03-06 19:57:49,139 - {'epoch': 9, 'rec_loss': '7.2361'}
2025-03-06 19:58:07,164 - {'Epoch': 9, 'HR@5': '0.0287', 'NDCG@5': '0.0177', 'HR@10': '0.0469', 'NDCG@10': '0.0236', 'HR@20': '0.0755', 'NDCG@20': '0.0308'}
2025-03-06 19:58:07,169 - Validation score increased.  Saving model ...
2025-03-06 19:58:54,571 - {'epoch': 10, 'rec_loss': '7.1902'}
2025-03-06 19:59:12,146 - {'Epoch': 10, 'HR@5': '0.0268', 'NDCG@5': '0.0168', 'HR@10': '0.0457', 'NDCG@10': '0.0229', 'HR@20': '0.0739', 'NDCG@20': '0.0300'}
2025-03-06 19:59:12,155 - EarlyStopping counter: 1 out of 10
2025-03-06 19:59:59,457 - {'epoch': 11, 'rec_loss': '7.1544'}
2025-03-06 20:00:17,481 - {'Epoch': 11, 'HR@5': '0.0275', 'NDCG@5': '0.0173', 'HR@10': '0.0463', 'NDCG@10': '0.0233', 'HR@20': '0.0763', 'NDCG@20': '0.0308'}
2025-03-06 20:00:17,483 - Validation score increased.  Saving model ...
2025-03-06 20:01:02,110 - {'epoch': 12, 'rec_loss': '7.1227'}
2025-03-06 20:01:20,184 - {'Epoch': 12, 'HR@5': '0.0289', 'NDCG@5': '0.0179', 'HR@10': '0.0462', 'NDCG@10': '0.0234', 'HR@20': '0.0756', 'NDCG@20': '0.0308'}
2025-03-06 20:01:20,186 - Validation score increased.  Saving model ...
2025-03-06 20:02:07,143 - {'epoch': 13, 'rec_loss': '7.0922'}
2025-03-06 20:02:24,920 - {'Epoch': 13, 'HR@5': '0.0268', 'NDCG@5': '0.0170', 'HR@10': '0.0457', 'NDCG@10': '0.0230', 'HR@20': '0.0754', 'NDCG@20': '0.0305'}
2025-03-06 20:02:24,924 - EarlyStopping counter: 1 out of 10
2025-03-06 20:03:09,417 - {'epoch': 14, 'rec_loss': '7.0652'}
2025-03-06 20:03:27,125 - {'Epoch': 14, 'HR@5': '0.0279', 'NDCG@5': '0.0178', 'HR@10': '0.0464', 'NDCG@10': '0.0237', 'HR@20': '0.0745', 'NDCG@20': '0.0308'}
2025-03-06 20:03:27,129 - EarlyStopping counter: 2 out of 10
2025-03-06 20:04:14,455 - {'epoch': 15, 'rec_loss': '7.0383'}
2025-03-06 20:04:32,014 - {'Epoch': 15, 'HR@5': '0.0273', 'NDCG@5': '0.0174', 'HR@10': '0.0461', 'NDCG@10': '0.0234', 'HR@20': '0.0754', 'NDCG@20': '0.0307'}
2025-03-06 20:04:32,023 - EarlyStopping counter: 3 out of 10
2025-03-06 20:05:19,406 - {'epoch': 16, 'rec_loss': '7.0137'}
2025-03-06 20:05:38,233 - {'Epoch': 16, 'HR@5': '0.0272', 'NDCG@5': '0.0173', 'HR@10': '0.0457', 'NDCG@10': '0.0232', 'HR@20': '0.0759', 'NDCG@20': '0.0308'}
2025-03-06 20:05:38,238 - Validation score increased.  Saving model ...
2025-03-06 20:06:27,435 - {'epoch': 17, 'rec_loss': '6.9957'}
2025-03-06 20:06:45,267 - {'Epoch': 17, 'HR@5': '0.0275', 'NDCG@5': '0.0170', 'HR@10': '0.0462', 'NDCG@10': '0.0230', 'HR@20': '0.0767', 'NDCG@20': '0.0306'}
2025-03-06 20:06:45,270 - EarlyStopping counter: 1 out of 10
2025-03-06 20:07:35,102 - {'epoch': 18, 'rec_loss': '6.9729'}
2025-03-06 20:07:54,250 - {'Epoch': 18, 'HR@5': '0.0275', 'NDCG@5': '0.0174', 'HR@10': '0.0464', 'NDCG@10': '0.0234', 'HR@20': '0.0751', 'NDCG@20': '0.0306'}
2025-03-06 20:07:54,256 - EarlyStopping counter: 2 out of 10
2025-03-06 20:08:45,088 - {'epoch': 19, 'rec_loss': '6.9572'}
2025-03-06 20:09:04,084 - {'Epoch': 19, 'HR@5': '0.0284', 'NDCG@5': '0.0177', 'HR@10': '0.0467', 'NDCG@10': '0.0235', 'HR@20': '0.0774', 'NDCG@20': '0.0313'}
2025-03-06 20:09:04,089 - Validation score increased.  Saving model ...
2025-03-06 20:09:55,189 - {'epoch': 20, 'rec_loss': '6.9381'}
2025-03-06 20:10:13,418 - {'Epoch': 20, 'HR@5': '0.0281', 'NDCG@5': '0.0175', 'HR@10': '0.0463', 'NDCG@10': '0.0233', 'HR@20': '0.0742', 'NDCG@20': '0.0303'}
2025-03-06 20:10:13,426 - EarlyStopping counter: 1 out of 10
2025-03-06 20:11:03,082 - {'epoch': 21, 'rec_loss': '6.9236'}
2025-03-06 20:11:21,558 - {'Epoch': 21, 'HR@5': '0.0276', 'NDCG@5': '0.0172', 'HR@10': '0.0460', 'NDCG@10': '0.0231', 'HR@20': '0.0739', 'NDCG@20': '0.0301'}
2025-03-06 20:11:21,560 - EarlyStopping counter: 2 out of 10
2025-03-06 20:12:11,147 - {'epoch': 22, 'rec_loss': '6.9091'}
2025-03-06 20:12:29,957 - {'Epoch': 22, 'HR@5': '0.0268', 'NDCG@5': '0.0167', 'HR@10': '0.0457', 'NDCG@10': '0.0228', 'HR@20': '0.0741', 'NDCG@20': '0.0299'}
2025-03-06 20:12:29,962 - EarlyStopping counter: 3 out of 10
2025-03-06 20:13:22,460 - {'epoch': 23, 'rec_loss': '6.8955'}
2025-03-06 20:13:41,133 - {'Epoch': 23, 'HR@5': '0.0269', 'NDCG@5': '0.0170', 'HR@10': '0.0457', 'NDCG@10': '0.0231', 'HR@20': '0.0747', 'NDCG@20': '0.0304'}
2025-03-06 20:13:41,140 - EarlyStopping counter: 4 out of 10
2025-03-06 20:14:31,784 - {'epoch': 24, 'rec_loss': '6.8772'}
2025-03-06 20:14:50,625 - {'Epoch': 24, 'HR@5': '0.0273', 'NDCG@5': '0.0170', 'HR@10': '0.0466', 'NDCG@10': '0.0231', 'HR@20': '0.0760', 'NDCG@20': '0.0305'}
2025-03-06 20:14:50,627 - EarlyStopping counter: 5 out of 10
2025-03-06 20:15:41,873 - {'epoch': 25, 'rec_loss': '6.8650'}
2025-03-06 20:16:00,594 - {'Epoch': 25, 'HR@5': '0.0267', 'NDCG@5': '0.0171', 'HR@10': '0.0456', 'NDCG@10': '0.0231', 'HR@20': '0.0748', 'NDCG@20': '0.0305'}
2025-03-06 20:16:00,596 - EarlyStopping counter: 6 out of 10
2025-03-06 20:16:51,218 - {'epoch': 26, 'rec_loss': '6.8535'}
2025-03-06 20:17:09,844 - {'Epoch': 26, 'HR@5': '0.0267', 'NDCG@5': '0.0167', 'HR@10': '0.0459', 'NDCG@10': '0.0228', 'HR@20': '0.0744', 'NDCG@20': '0.0300'}
2025-03-06 20:17:09,852 - EarlyStopping counter: 7 out of 10
2025-03-06 20:18:01,480 - {'epoch': 27, 'rec_loss': '6.8423'}
2025-03-06 20:18:20,272 - {'Epoch': 27, 'HR@5': '0.0268', 'NDCG@5': '0.0169', 'HR@10': '0.0453', 'NDCG@10': '0.0228', 'HR@20': '0.0750', 'NDCG@20': '0.0303'}
2025-03-06 20:18:20,278 - EarlyStopping counter: 8 out of 10
2025-03-06 20:19:10,536 - {'epoch': 28, 'rec_loss': '6.8325'}
2025-03-06 20:19:28,878 - {'Epoch': 28, 'HR@5': '0.0269', 'NDCG@5': '0.0172', 'HR@10': '0.0466', 'NDCG@10': '0.0235', 'HR@20': '0.0742', 'NDCG@20': '0.0305'}
2025-03-06 20:19:28,883 - EarlyStopping counter: 9 out of 10
2025-03-06 20:20:21,828 - {'epoch': 29, 'rec_loss': '6.8220'}
2025-03-06 20:20:40,648 - {'Epoch': 29, 'HR@5': '0.0273', 'NDCG@5': '0.0172', 'HR@10': '0.0461', 'NDCG@10': '0.0233', 'HR@20': '0.0757', 'NDCG@20': '0.0307'}
2025-03-06 20:20:40,652 - EarlyStopping counter: 10 out of 10
2025-03-06 20:20:40,652 - Early stopping
2025-03-06 20:20:40,652 - ---------------Test Score---------------
2025-03-06 20:20:58,772 - {'Epoch': 0, 'HR@5': '0.0264', 'NDCG@5': '0.0170', 'HR@10': '0.0436', 'NDCG@10': '0.0225', 'HR@20': '0.0706', 'NDCG@20': '0.0293'}
2025-03-06 20:20:58,774 - Scale_Yelp
2025-03-06 20:20:58,774 - {'Epoch': 0, 'HR@5': '0.0264', 'NDCG@5': '0.0170', 'HR@10': '0.0436', 'NDCG@10': '0.0225', 'HR@20': '0.0706', 'NDCG@20': '0.0293'}
2025-03-06 23:39:58,897 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 24], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-06 23:40:02,511 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-06 23:40:02,525 - Total Parameters: 1437093
2025-03-06 23:40:37,178 - {'epoch': 0, 'rec_loss': '9.6591'}
2025-03-06 23:40:55,330 - {'Epoch': 0, 'HR@5': '0.0054', 'NDCG@5': '0.0037', 'HR@10': '0.0095', 'NDCG@10': '0.0050', 'HR@20': '0.0174', 'NDCG@20': '0.0070'}
2025-03-06 23:40:55,336 - Validation score increased.  Saving model ...
2025-03-06 23:41:25,937 - {'epoch': 1, 'rec_loss': '9.5309'}
2025-03-06 23:41:44,407 - {'Epoch': 1, 'HR@5': '0.0083', 'NDCG@5': '0.0054', 'HR@10': '0.0144', 'NDCG@10': '0.0074', 'HR@20': '0.0246', 'NDCG@20': '0.0100'}
2025-03-06 23:41:44,408 - Validation score increased.  Saving model ...
2025-03-06 23:42:11,603 - {'epoch': 2, 'rec_loss': '9.0802'}
2025-03-06 23:42:27,116 - {'Epoch': 2, 'HR@5': '0.0130', 'NDCG@5': '0.0082', 'HR@10': '0.0238', 'NDCG@10': '0.0116', 'HR@20': '0.0410', 'NDCG@20': '0.0159'}
2025-03-06 23:42:27,124 - Validation score increased.  Saving model ...
2025-03-06 23:42:54,222 - {'epoch': 3, 'rec_loss': '8.5335'}
2025-03-06 23:43:11,920 - {'Epoch': 3, 'HR@5': '0.0186', 'NDCG@5': '0.0116', 'HR@10': '0.0324', 'NDCG@10': '0.0160', 'HR@20': '0.0538', 'NDCG@20': '0.0214'}
2025-03-06 23:43:11,921 - Validation score increased.  Saving model ...
2025-03-06 23:43:41,406 - {'epoch': 4, 'rec_loss': '8.2484'}
2025-03-06 23:43:58,577 - {'Epoch': 4, 'HR@5': '0.0206', 'NDCG@5': '0.0127', 'HR@10': '0.0360', 'NDCG@10': '0.0177', 'HR@20': '0.0599', 'NDCG@20': '0.0237'}
2025-03-06 23:43:58,578 - Validation score increased.  Saving model ...
2025-03-06 23:44:28,095 - {'epoch': 5, 'rec_loss': '8.0768'}
2025-03-06 23:44:44,612 - {'Epoch': 5, 'HR@5': '0.0226', 'NDCG@5': '0.0139', 'HR@10': '0.0401', 'NDCG@10': '0.0195', 'HR@20': '0.0650', 'NDCG@20': '0.0257'}
2025-03-06 23:44:44,613 - Validation score increased.  Saving model ...
2025-03-06 23:45:12,176 - {'epoch': 6, 'rec_loss': '7.9531'}
2025-03-06 23:45:29,038 - {'Epoch': 6, 'HR@5': '0.0239', 'NDCG@5': '0.0146', 'HR@10': '0.0403', 'NDCG@10': '0.0198', 'HR@20': '0.0693', 'NDCG@20': '0.0271'}
2025-03-06 23:45:29,039 - Validation score increased.  Saving model ...
2025-03-06 23:45:58,327 - {'epoch': 7, 'rec_loss': '7.8541'}
2025-03-06 23:46:16,025 - {'Epoch': 7, 'HR@5': '0.0237', 'NDCG@5': '0.0150', 'HR@10': '0.0427', 'NDCG@10': '0.0211', 'HR@20': '0.0691', 'NDCG@20': '0.0277'}
2025-03-06 23:46:16,027 - Validation score increased.  Saving model ...
2025-03-06 23:46:47,249 - {'epoch': 8, 'rec_loss': '7.7794'}
2025-03-06 23:47:04,529 - {'Epoch': 8, 'HR@5': '0.0258', 'NDCG@5': '0.0159', 'HR@10': '0.0433', 'NDCG@10': '0.0215', 'HR@20': '0.0719', 'NDCG@20': '0.0286'}
2025-03-06 23:47:04,530 - Validation score increased.  Saving model ...
2025-03-06 23:47:34,778 - {'epoch': 9, 'rec_loss': '7.7185'}
2025-03-06 23:47:50,276 - {'Epoch': 9, 'HR@5': '0.0267', 'NDCG@5': '0.0166', 'HR@10': '0.0443', 'NDCG@10': '0.0223', 'HR@20': '0.0738', 'NDCG@20': '0.0296'}
2025-03-06 23:47:50,278 - Validation score increased.  Saving model ...
2025-03-06 23:48:17,794 - {'epoch': 10, 'rec_loss': '7.6650'}
2025-03-06 23:48:35,211 - {'Epoch': 10, 'HR@5': '0.0269', 'NDCG@5': '0.0166', 'HR@10': '0.0454', 'NDCG@10': '0.0225', 'HR@20': '0.0747', 'NDCG@20': '0.0299'}
2025-03-06 23:48:35,213 - Validation score increased.  Saving model ...
2025-03-06 23:49:04,228 - {'epoch': 11, 'rec_loss': '7.6204'}
2025-03-06 23:49:22,617 - {'Epoch': 11, 'HR@5': '0.0269', 'NDCG@5': '0.0168', 'HR@10': '0.0471', 'NDCG@10': '0.0233', 'HR@20': '0.0750', 'NDCG@20': '0.0303'}
2025-03-06 23:49:22,623 - Validation score increased.  Saving model ...
2025-03-06 23:49:53,507 - {'epoch': 12, 'rec_loss': '7.5884'}
2025-03-06 23:50:11,241 - {'Epoch': 12, 'HR@5': '0.0276', 'NDCG@5': '0.0172', 'HR@10': '0.0469', 'NDCG@10': '0.0235', 'HR@20': '0.0756', 'NDCG@20': '0.0307'}
2025-03-06 23:50:11,243 - Validation score increased.  Saving model ...
2025-03-06 23:50:41,967 - {'epoch': 13, 'rec_loss': '7.5470'}
2025-03-06 23:50:58,761 - {'Epoch': 13, 'HR@5': '0.0278', 'NDCG@5': '0.0172', 'HR@10': '0.0479', 'NDCG@10': '0.0237', 'HR@20': '0.0770', 'NDCG@20': '0.0310'}
2025-03-06 23:50:58,762 - Validation score increased.  Saving model ...
2025-03-06 23:51:25,491 - {'epoch': 14, 'rec_loss': '7.5210'}
2025-03-06 23:51:41,914 - {'Epoch': 14, 'HR@5': '0.0275', 'NDCG@5': '0.0173', 'HR@10': '0.0481', 'NDCG@10': '0.0239', 'HR@20': '0.0765', 'NDCG@20': '0.0310'}
2025-03-06 23:51:41,924 - Validation score increased.  Saving model ...
2025-03-06 23:52:10,461 - {'epoch': 15, 'rec_loss': '7.4914'}
2025-03-06 23:52:28,341 - {'Epoch': 15, 'HR@5': '0.0281', 'NDCG@5': '0.0175', 'HR@10': '0.0485', 'NDCG@10': '0.0240', 'HR@20': '0.0776', 'NDCG@20': '0.0313'}
2025-03-06 23:52:28,344 - Validation score increased.  Saving model ...
2025-03-06 23:53:00,990 - {'epoch': 16, 'rec_loss': '7.4731'}
2025-03-06 23:53:18,919 - {'Epoch': 16, 'HR@5': '0.0281', 'NDCG@5': '0.0172', 'HR@10': '0.0492', 'NDCG@10': '0.0241', 'HR@20': '0.0780', 'NDCG@20': '0.0313'}
2025-03-06 23:53:18,921 - EarlyStopping counter: 1 out of 10
2025-03-06 23:53:52,375 - {'epoch': 17, 'rec_loss': '7.4507'}
2025-03-06 23:54:08,940 - {'Epoch': 17, 'HR@5': '0.0287', 'NDCG@5': '0.0179', 'HR@10': '0.0495', 'NDCG@10': '0.0246', 'HR@20': '0.0787', 'NDCG@20': '0.0319'}
2025-03-06 23:54:08,941 - Validation score increased.  Saving model ...
2025-03-06 23:54:36,848 - {'epoch': 18, 'rec_loss': '7.4290'}
2025-03-06 23:54:54,663 - {'Epoch': 18, 'HR@5': '0.0286', 'NDCG@5': '0.0182', 'HR@10': '0.0496', 'NDCG@10': '0.0249', 'HR@20': '0.0797', 'NDCG@20': '0.0325'}
2025-03-06 23:54:54,664 - Validation score increased.  Saving model ...
2025-03-06 23:55:22,075 - {'epoch': 19, 'rec_loss': '7.4153'}
2025-03-06 23:55:39,652 - {'Epoch': 19, 'HR@5': '0.0288', 'NDCG@5': '0.0182', 'HR@10': '0.0499', 'NDCG@10': '0.0249', 'HR@20': '0.0800', 'NDCG@20': '0.0325'}
2025-03-06 23:55:39,656 - Validation score increased.  Saving model ...
2025-03-06 23:56:11,015 - {'epoch': 20, 'rec_loss': '7.3978'}
2025-03-06 23:56:29,075 - {'Epoch': 20, 'HR@5': '0.0293', 'NDCG@5': '0.0184', 'HR@10': '0.0486', 'NDCG@10': '0.0246', 'HR@20': '0.0781', 'NDCG@20': '0.0320'}
2025-03-06 23:56:29,076 - EarlyStopping counter: 1 out of 10
2025-03-06 23:56:59,772 - {'epoch': 21, 'rec_loss': '7.3830'}
2025-03-06 23:57:17,123 - {'Epoch': 21, 'HR@5': '0.0295', 'NDCG@5': '0.0181', 'HR@10': '0.0500', 'NDCG@10': '0.0248', 'HR@20': '0.0788', 'NDCG@20': '0.0320'}
2025-03-06 23:57:17,124 - EarlyStopping counter: 2 out of 10
2025-03-06 23:57:44,482 - {'epoch': 22, 'rec_loss': '7.3659'}
2025-03-06 23:58:00,662 - {'Epoch': 22, 'HR@5': '0.0298', 'NDCG@5': '0.0184', 'HR@10': '0.0499', 'NDCG@10': '0.0248', 'HR@20': '0.0794', 'NDCG@20': '0.0322'}
2025-03-06 23:58:00,663 - EarlyStopping counter: 3 out of 10
2025-03-06 23:58:30,642 - {'epoch': 23, 'rec_loss': '7.3538'}
2025-03-06 23:58:48,489 - {'Epoch': 23, 'HR@5': '0.0301', 'NDCG@5': '0.0190', 'HR@10': '0.0499', 'NDCG@10': '0.0253', 'HR@20': '0.0787', 'NDCG@20': '0.0326'}
2025-03-06 23:58:48,490 - Validation score increased.  Saving model ...
2025-03-06 23:59:20,448 - {'epoch': 24, 'rec_loss': '7.3423'}
2025-03-06 23:59:39,031 - {'Epoch': 24, 'HR@5': '0.0298', 'NDCG@5': '0.0188', 'HR@10': '0.0482', 'NDCG@10': '0.0247', 'HR@20': '0.0783', 'NDCG@20': '0.0322'}
2025-03-06 23:59:39,035 - EarlyStopping counter: 1 out of 10
2025-03-07 00:00:07,892 - {'epoch': 25, 'rec_loss': '7.3296'}
2025-03-07 00:00:26,184 - {'Epoch': 25, 'HR@5': '0.0297', 'NDCG@5': '0.0184', 'HR@10': '0.0497', 'NDCG@10': '0.0248', 'HR@20': '0.0787', 'NDCG@20': '0.0321'}
2025-03-07 00:00:26,185 - EarlyStopping counter: 2 out of 10
2025-03-07 00:00:54,873 - {'epoch': 26, 'rec_loss': '7.3200'}
2025-03-07 00:01:12,126 - {'Epoch': 26, 'HR@5': '0.0300', 'NDCG@5': '0.0190', 'HR@10': '0.0498', 'NDCG@10': '0.0253', 'HR@20': '0.0799', 'NDCG@20': '0.0329'}
2025-03-07 00:01:12,127 - Validation score increased.  Saving model ...
2025-03-07 00:01:43,302 - {'epoch': 27, 'rec_loss': '7.3072'}
2025-03-07 00:02:01,371 - {'Epoch': 27, 'HR@5': '0.0302', 'NDCG@5': '0.0192', 'HR@10': '0.0499', 'NDCG@10': '0.0256', 'HR@20': '0.0799', 'NDCG@20': '0.0331'}
2025-03-07 00:02:01,372 - Validation score increased.  Saving model ...
2025-03-07 00:02:33,055 - {'epoch': 28, 'rec_loss': '7.2980'}
2025-03-07 00:02:51,528 - {'Epoch': 28, 'HR@5': '0.0300', 'NDCG@5': '0.0188', 'HR@10': '0.0493', 'NDCG@10': '0.0250', 'HR@20': '0.0801', 'NDCG@20': '0.0328'}
2025-03-07 00:02:51,530 - EarlyStopping counter: 1 out of 10
2025-03-07 00:03:18,834 - {'epoch': 29, 'rec_loss': '7.2904'}
2025-03-07 00:03:36,152 - {'Epoch': 29, 'HR@5': '0.0305', 'NDCG@5': '0.0188', 'HR@10': '0.0501', 'NDCG@10': '0.0251', 'HR@20': '0.0811', 'NDCG@20': '0.0329'}
2025-03-07 00:03:36,153 - EarlyStopping counter: 2 out of 10
2025-03-07 00:04:04,671 - {'epoch': 30, 'rec_loss': '7.2829'}
2025-03-07 00:04:22,412 - {'Epoch': 30, 'HR@5': '0.0303', 'NDCG@5': '0.0192', 'HR@10': '0.0512', 'NDCG@10': '0.0259', 'HR@20': '0.0802', 'NDCG@20': '0.0332'}
2025-03-07 00:04:22,413 - Validation score increased.  Saving model ...
2025-03-07 00:04:54,461 - {'epoch': 31, 'rec_loss': '7.2737'}
2025-03-07 00:05:12,956 - {'Epoch': 31, 'HR@5': '0.0298', 'NDCG@5': '0.0189', 'HR@10': '0.0493', 'NDCG@10': '0.0252', 'HR@20': '0.0795', 'NDCG@20': '0.0328'}
2025-03-07 00:05:12,957 - EarlyStopping counter: 1 out of 10
2025-03-07 00:05:45,158 - {'epoch': 32, 'rec_loss': '7.2635'}
2025-03-07 00:06:02,920 - {'Epoch': 32, 'HR@5': '0.0300', 'NDCG@5': '0.0190', 'HR@10': '0.0488', 'NDCG@10': '0.0251', 'HR@20': '0.0796', 'NDCG@20': '0.0328'}
2025-03-07 00:06:02,926 - EarlyStopping counter: 2 out of 10
2025-03-07 00:06:30,203 - {'epoch': 33, 'rec_loss': '7.2631'}
2025-03-07 00:06:47,753 - {'Epoch': 33, 'HR@5': '0.0313', 'NDCG@5': '0.0197', 'HR@10': '0.0506', 'NDCG@10': '0.0259', 'HR@20': '0.0814', 'NDCG@20': '0.0336'}
2025-03-07 00:06:47,754 - Validation score increased.  Saving model ...
2025-03-07 00:07:16,438 - {'epoch': 34, 'rec_loss': '7.2550'}
2025-03-07 00:07:34,355 - {'Epoch': 34, 'HR@5': '0.0296', 'NDCG@5': '0.0188', 'HR@10': '0.0506', 'NDCG@10': '0.0255', 'HR@20': '0.0806', 'NDCG@20': '0.0330'}
2025-03-07 00:07:34,362 - EarlyStopping counter: 1 out of 10
2025-03-07 00:08:04,420 - {'epoch': 35, 'rec_loss': '7.2455'}
2025-03-07 00:08:22,402 - {'Epoch': 35, 'HR@5': '0.0302', 'NDCG@5': '0.0187', 'HR@10': '0.0496', 'NDCG@10': '0.0249', 'HR@20': '0.0809', 'NDCG@20': '0.0328'}
2025-03-07 00:08:22,403 - EarlyStopping counter: 2 out of 10
2025-03-07 00:08:53,709 - {'epoch': 36, 'rec_loss': '7.2362'}
2025-03-07 00:09:11,031 - {'Epoch': 36, 'HR@5': '0.0311', 'NDCG@5': '0.0194', 'HR@10': '0.0509', 'NDCG@10': '0.0257', 'HR@20': '0.0808', 'NDCG@20': '0.0332'}
2025-03-07 00:09:11,032 - EarlyStopping counter: 3 out of 10
2025-03-07 00:09:38,110 - {'epoch': 37, 'rec_loss': '7.2320'}
2025-03-07 00:09:55,104 - {'Epoch': 37, 'HR@5': '0.0304', 'NDCG@5': '0.0193', 'HR@10': '0.0510', 'NDCG@10': '0.0259', 'HR@20': '0.0817', 'NDCG@20': '0.0336'}
2025-03-07 00:09:55,106 - EarlyStopping counter: 4 out of 10
2025-03-07 00:10:23,556 - {'epoch': 38, 'rec_loss': '7.2268'}
2025-03-07 00:10:41,115 - {'Epoch': 38, 'HR@5': '0.0291', 'NDCG@5': '0.0185', 'HR@10': '0.0500', 'NDCG@10': '0.0253', 'HR@20': '0.0798', 'NDCG@20': '0.0327'}
2025-03-07 00:10:41,116 - EarlyStopping counter: 5 out of 10
2025-03-07 00:11:11,992 - {'epoch': 39, 'rec_loss': '7.2187'}
2025-03-07 00:11:29,095 - {'Epoch': 39, 'HR@5': '0.0296', 'NDCG@5': '0.0184', 'HR@10': '0.0495', 'NDCG@10': '0.0248', 'HR@20': '0.0801', 'NDCG@20': '0.0325'}
2025-03-07 00:11:29,106 - EarlyStopping counter: 6 out of 10
2025-03-07 00:11:59,788 - {'epoch': 40, 'rec_loss': '7.2085'}
2025-03-07 00:12:17,374 - {'Epoch': 40, 'HR@5': '0.0294', 'NDCG@5': '0.0184', 'HR@10': '0.0486', 'NDCG@10': '0.0246', 'HR@20': '0.0798', 'NDCG@20': '0.0324'}
2025-03-07 00:12:17,376 - EarlyStopping counter: 7 out of 10
2025-03-07 00:12:45,195 - {'epoch': 41, 'rec_loss': '7.2103'}
2025-03-07 00:13:03,063 - {'Epoch': 41, 'HR@5': '0.0295', 'NDCG@5': '0.0184', 'HR@10': '0.0496', 'NDCG@10': '0.0248', 'HR@20': '0.0803', 'NDCG@20': '0.0326'}
2025-03-07 00:13:03,065 - EarlyStopping counter: 8 out of 10
2025-03-07 00:13:30,695 - {'epoch': 42, 'rec_loss': '7.2055'}
2025-03-07 00:13:48,905 - {'Epoch': 42, 'HR@5': '0.0294', 'NDCG@5': '0.0183', 'HR@10': '0.0497', 'NDCG@10': '0.0248', 'HR@20': '0.0800', 'NDCG@20': '0.0324'}
2025-03-07 00:13:48,907 - EarlyStopping counter: 9 out of 10
2025-03-07 00:14:20,036 - {'epoch': 43, 'rec_loss': '7.1963'}
2025-03-07 00:14:37,605 - {'Epoch': 43, 'HR@5': '0.0301', 'NDCG@5': '0.0188', 'HR@10': '0.0507', 'NDCG@10': '0.0254', 'HR@20': '0.0816', 'NDCG@20': '0.0331'}
2025-03-07 00:14:37,609 - EarlyStopping counter: 10 out of 10
2025-03-07 00:14:37,609 - Early stopping
2025-03-07 00:14:37,609 - ---------------Test Score---------------
2025-03-07 00:14:55,677 - {'Epoch': 0, 'HR@5': '0.0274', 'NDCG@5': '0.0171', 'HR@10': '0.0457', 'NDCG@10': '0.0230', 'HR@20': '0.0735', 'NDCG@20': '0.0300'}
2025-03-07 00:14:55,678 - Scale_Yelp
2025-03-07 00:14:55,678 - {'Epoch': 0, 'HR@5': '0.0274', 'NDCG@5': '0.0171', 'HR@10': '0.0457', 'NDCG@10': '0.0230', 'HR@20': '0.0735', 'NDCG@20': '0.0300'}
2025-03-07 00:19:49,829 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 24], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-07 00:19:53,188 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-07 00:19:53,197 - Total Parameters: 1437093
2025-03-07 00:20:22,693 - {'epoch': 0, 'rec_loss': '9.5597'}
2025-03-07 00:20:40,743 - {'Epoch': 0, 'HR@5': '0.0088', 'NDCG@5': '0.0055', 'HR@10': '0.0142', 'NDCG@10': '0.0072', 'HR@20': '0.0251', 'NDCG@20': '0.0099'}
2025-03-07 00:20:40,747 - Validation score increased.  Saving model ...
2025-03-07 00:21:13,062 - {'epoch': 1, 'rec_loss': '9.0207'}
2025-03-07 00:21:31,369 - {'Epoch': 1, 'HR@5': '0.0156', 'NDCG@5': '0.0099', 'HR@10': '0.0262', 'NDCG@10': '0.0133', 'HR@20': '0.0420', 'NDCG@20': '0.0173'}
2025-03-07 00:21:31,371 - Validation score increased.  Saving model ...
2025-03-07 00:22:05,425 - {'epoch': 2, 'rec_loss': '8.5714'}
2025-03-07 00:22:21,931 - {'Epoch': 2, 'HR@5': '0.0175', 'NDCG@5': '0.0112', 'HR@10': '0.0310', 'NDCG@10': '0.0155', 'HR@20': '0.0519', 'NDCG@20': '0.0207'}
2025-03-07 00:22:21,938 - Validation score increased.  Saving model ...
2025-03-07 00:22:48,876 - {'epoch': 3, 'rec_loss': '8.3111'}
2025-03-07 00:23:04,694 - {'Epoch': 3, 'HR@5': '0.0209', 'NDCG@5': '0.0129', 'HR@10': '0.0362', 'NDCG@10': '0.0179', 'HR@20': '0.0579', 'NDCG@20': '0.0233'}
2025-03-07 00:23:04,695 - Validation score increased.  Saving model ...
2025-03-07 00:23:32,529 - {'epoch': 4, 'rec_loss': '8.1350'}
2025-03-07 00:23:49,449 - {'Epoch': 4, 'HR@5': '0.0220', 'NDCG@5': '0.0142', 'HR@10': '0.0390', 'NDCG@10': '0.0196', 'HR@20': '0.0652', 'NDCG@20': '0.0262'}
2025-03-07 00:23:49,459 - Validation score increased.  Saving model ...
2025-03-07 00:24:21,051 - {'epoch': 5, 'rec_loss': '8.0119'}
2025-03-07 00:24:39,033 - {'Epoch': 5, 'HR@5': '0.0241', 'NDCG@5': '0.0153', 'HR@10': '0.0418', 'NDCG@10': '0.0209', 'HR@20': '0.0685', 'NDCG@20': '0.0276'}
2025-03-07 00:24:39,035 - Validation score increased.  Saving model ...
2025-03-07 00:25:10,926 - {'epoch': 6, 'rec_loss': '7.9094'}
2025-03-07 00:25:27,781 - {'Epoch': 6, 'HR@5': '0.0255', 'NDCG@5': '0.0160', 'HR@10': '0.0441', 'NDCG@10': '0.0220', 'HR@20': '0.0725', 'NDCG@20': '0.0291'}
2025-03-07 00:25:27,782 - Validation score increased.  Saving model ...
2025-03-07 00:25:55,210 - {'epoch': 7, 'rec_loss': '7.8254'}
2025-03-07 00:26:11,974 - {'Epoch': 7, 'HR@5': '0.0263', 'NDCG@5': '0.0165', 'HR@10': '0.0464', 'NDCG@10': '0.0229', 'HR@20': '0.0755', 'NDCG@20': '0.0302'}
2025-03-07 00:26:11,977 - Validation score increased.  Saving model ...
2025-03-07 00:26:38,873 - {'epoch': 8, 'rec_loss': '7.7547'}
2025-03-07 00:26:56,483 - {'Epoch': 8, 'HR@5': '0.0273', 'NDCG@5': '0.0172', 'HR@10': '0.0474', 'NDCG@10': '0.0237', 'HR@20': '0.0758', 'NDCG@20': '0.0309'}
2025-03-07 00:26:56,485 - Validation score increased.  Saving model ...
2025-03-07 00:27:29,759 - {'epoch': 9, 'rec_loss': '7.6920'}
2025-03-07 00:27:47,649 - {'Epoch': 9, 'HR@5': '0.0281', 'NDCG@5': '0.0179', 'HR@10': '0.0480', 'NDCG@10': '0.0244', 'HR@20': '0.0773', 'NDCG@20': '0.0317'}
2025-03-07 00:27:47,657 - Validation score increased.  Saving model ...
2025-03-07 00:28:19,978 - {'epoch': 10, 'rec_loss': '7.6378'}
2025-03-07 00:28:36,991 - {'Epoch': 10, 'HR@5': '0.0292', 'NDCG@5': '0.0184', 'HR@10': '0.0477', 'NDCG@10': '0.0243', 'HR@20': '0.0787', 'NDCG@20': '0.0320'}
2025-03-07 00:28:36,996 - Validation score increased.  Saving model ...
2025-03-07 00:29:04,355 - {'epoch': 11, 'rec_loss': '7.5909'}
2025-03-07 00:29:21,763 - {'Epoch': 11, 'HR@5': '0.0291', 'NDCG@5': '0.0186', 'HR@10': '0.0495', 'NDCG@10': '0.0252', 'HR@20': '0.0785', 'NDCG@20': '0.0325'}
2025-03-07 00:29:21,765 - Validation score increased.  Saving model ...
2025-03-07 00:29:49,932 - {'epoch': 12, 'rec_loss': '7.5542'}
2025-03-07 00:30:06,821 - {'Epoch': 12, 'HR@5': '0.0300', 'NDCG@5': '0.0190', 'HR@10': '0.0490', 'NDCG@10': '0.0251', 'HR@20': '0.0778', 'NDCG@20': '0.0323'}
2025-03-07 00:30:06,822 - EarlyStopping counter: 1 out of 10
2025-03-07 00:30:32,072 - {'epoch': 13, 'rec_loss': '7.5132'}
2025-03-07 00:30:48,836 - {'Epoch': 13, 'HR@5': '0.0301', 'NDCG@5': '0.0189', 'HR@10': '0.0492', 'NDCG@10': '0.0251', 'HR@20': '0.0794', 'NDCG@20': '0.0327'}
2025-03-07 00:30:48,840 - Validation score increased.  Saving model ...
2025-03-07 00:31:15,475 - {'epoch': 14, 'rec_loss': '7.4831'}
2025-03-07 00:31:32,242 - {'Epoch': 14, 'HR@5': '0.0285', 'NDCG@5': '0.0183', 'HR@10': '0.0484', 'NDCG@10': '0.0248', 'HR@20': '0.0788', 'NDCG@20': '0.0324'}
2025-03-07 00:31:32,243 - EarlyStopping counter: 1 out of 10
2025-03-07 00:31:58,739 - {'epoch': 15, 'rec_loss': '7.4530'}
2025-03-07 00:32:16,749 - {'Epoch': 15, 'HR@5': '0.0304', 'NDCG@5': '0.0192', 'HR@10': '0.0490', 'NDCG@10': '0.0251', 'HR@20': '0.0786', 'NDCG@20': '0.0326'}
2025-03-07 00:32:16,758 - EarlyStopping counter: 2 out of 10
2025-03-07 00:32:49,519 - {'epoch': 16, 'rec_loss': '7.4369'}
2025-03-07 00:33:06,391 - {'Epoch': 16, 'HR@5': '0.0303', 'NDCG@5': '0.0193', 'HR@10': '0.0503', 'NDCG@10': '0.0257', 'HR@20': '0.0804', 'NDCG@20': '0.0333'}
2025-03-07 00:33:06,398 - Validation score increased.  Saving model ...
2025-03-07 00:33:36,219 - {'epoch': 17, 'rec_loss': '7.4139'}
2025-03-07 00:33:54,928 - {'Epoch': 17, 'HR@5': '0.0305', 'NDCG@5': '0.0188', 'HR@10': '0.0503', 'NDCG@10': '0.0252', 'HR@20': '0.0805', 'NDCG@20': '0.0328'}
2025-03-07 00:33:54,936 - EarlyStopping counter: 1 out of 10
2025-03-07 00:34:27,324 - {'epoch': 18, 'rec_loss': '7.3901'}
2025-03-07 00:34:46,791 - {'Epoch': 18, 'HR@5': '0.0301', 'NDCG@5': '0.0191', 'HR@10': '0.0510', 'NDCG@10': '0.0258', 'HR@20': '0.0802', 'NDCG@20': '0.0332'}
2025-03-07 00:34:46,795 - EarlyStopping counter: 2 out of 10
2025-03-07 00:35:18,827 - {'epoch': 19, 'rec_loss': '7.3752'}
2025-03-07 00:35:37,816 - {'Epoch': 19, 'HR@5': '0.0295', 'NDCG@5': '0.0188', 'HR@10': '0.0490', 'NDCG@10': '0.0250', 'HR@20': '0.0801', 'NDCG@20': '0.0328'}
2025-03-07 00:35:37,819 - EarlyStopping counter: 3 out of 10
2025-03-07 00:36:08,312 - {'epoch': 20, 'rec_loss': '7.3603'}
2025-03-07 00:36:26,772 - {'Epoch': 20, 'HR@5': '0.0307', 'NDCG@5': '0.0195', 'HR@10': '0.0502', 'NDCG@10': '0.0258', 'HR@20': '0.0812', 'NDCG@20': '0.0336'}
2025-03-07 00:36:26,779 - Validation score increased.  Saving model ...
2025-03-07 00:36:53,594 - {'epoch': 21, 'rec_loss': '7.3465'}
2025-03-07 00:37:11,021 - {'Epoch': 21, 'HR@5': '0.0304', 'NDCG@5': '0.0190', 'HR@10': '0.0513', 'NDCG@10': '0.0256', 'HR@20': '0.0810', 'NDCG@20': '0.0331'}
2025-03-07 00:37:11,022 - EarlyStopping counter: 1 out of 10
2025-03-07 00:37:39,357 - {'epoch': 22, 'rec_loss': '7.3272'}
2025-03-07 00:37:56,593 - {'Epoch': 22, 'HR@5': '0.0297', 'NDCG@5': '0.0188', 'HR@10': '0.0513', 'NDCG@10': '0.0257', 'HR@20': '0.0817', 'NDCG@20': '0.0334'}
2025-03-07 00:37:56,597 - EarlyStopping counter: 2 out of 10
2025-03-07 00:38:25,562 - {'epoch': 23, 'rec_loss': '7.3206'}
2025-03-07 00:38:44,001 - {'Epoch': 23, 'HR@5': '0.0302', 'NDCG@5': '0.0191', 'HR@10': '0.0518', 'NDCG@10': '0.0260', 'HR@20': '0.0824', 'NDCG@20': '0.0337'}
2025-03-07 00:38:44,003 - Validation score increased.  Saving model ...
2025-03-07 00:39:15,114 - {'epoch': 24, 'rec_loss': '7.3034'}
2025-03-07 00:39:34,107 - {'Epoch': 24, 'HR@5': '0.0299', 'NDCG@5': '0.0192', 'HR@10': '0.0507', 'NDCG@10': '0.0259', 'HR@20': '0.0800', 'NDCG@20': '0.0332'}
2025-03-07 00:39:34,118 - EarlyStopping counter: 1 out of 10
2025-03-07 00:40:04,011 - {'epoch': 25, 'rec_loss': '7.2985'}
2025-03-07 00:40:22,832 - {'Epoch': 25, 'HR@5': '0.0304', 'NDCG@5': '0.0192', 'HR@10': '0.0498', 'NDCG@10': '0.0254', 'HR@20': '0.0816', 'NDCG@20': '0.0334'}
2025-03-07 00:40:22,841 - EarlyStopping counter: 2 out of 10
2025-03-07 00:40:53,611 - {'epoch': 26, 'rec_loss': '7.2877'}
2025-03-07 00:41:11,799 - {'Epoch': 26, 'HR@5': '0.0300', 'NDCG@5': '0.0188', 'HR@10': '0.0502', 'NDCG@10': '0.0253', 'HR@20': '0.0801', 'NDCG@20': '0.0328'}
2025-03-07 00:41:11,801 - EarlyStopping counter: 3 out of 10
2025-03-07 00:41:39,943 - {'epoch': 27, 'rec_loss': '7.2772'}
2025-03-07 00:41:57,366 - {'Epoch': 27, 'HR@5': '0.0306', 'NDCG@5': '0.0192', 'HR@10': '0.0509', 'NDCG@10': '0.0257', 'HR@20': '0.0811', 'NDCG@20': '0.0333'}
2025-03-07 00:41:57,372 - EarlyStopping counter: 4 out of 10
2025-03-07 00:42:24,113 - {'epoch': 28, 'rec_loss': '7.2629'}
2025-03-07 00:42:42,287 - {'Epoch': 28, 'HR@5': '0.0303', 'NDCG@5': '0.0193', 'HR@10': '0.0509', 'NDCG@10': '0.0260', 'HR@20': '0.0816', 'NDCG@20': '0.0337'}
2025-03-07 00:42:42,293 - EarlyStopping counter: 5 out of 10
2025-03-07 00:43:11,974 - {'epoch': 29, 'rec_loss': '7.2597'}
2025-03-07 00:43:30,446 - {'Epoch': 29, 'HR@5': '0.0304', 'NDCG@5': '0.0193', 'HR@10': '0.0499', 'NDCG@10': '0.0256', 'HR@20': '0.0811', 'NDCG@20': '0.0335'}
2025-03-07 00:43:30,452 - EarlyStopping counter: 6 out of 10
2025-03-07 00:44:00,990 - {'epoch': 30, 'rec_loss': '7.2480'}
2025-03-07 00:44:19,855 - {'Epoch': 30, 'HR@5': '0.0303', 'NDCG@5': '0.0194', 'HR@10': '0.0515', 'NDCG@10': '0.0263', 'HR@20': '0.0820', 'NDCG@20': '0.0339'}
2025-03-07 00:44:19,857 - Validation score increased.  Saving model ...
2025-03-07 00:44:51,107 - {'epoch': 31, 'rec_loss': '7.2421'}
2025-03-07 00:45:09,861 - {'Epoch': 31, 'HR@5': '0.0310', 'NDCG@5': '0.0195', 'HR@10': '0.0511', 'NDCG@10': '0.0259', 'HR@20': '0.0817', 'NDCG@20': '0.0336'}
2025-03-07 00:45:09,869 - EarlyStopping counter: 1 out of 10
2025-03-07 00:45:40,463 - {'epoch': 32, 'rec_loss': '7.2335'}
2025-03-07 00:45:58,889 - {'Epoch': 32, 'HR@5': '0.0300', 'NDCG@5': '0.0190', 'HR@10': '0.0499', 'NDCG@10': '0.0254', 'HR@20': '0.0800', 'NDCG@20': '0.0330'}
2025-03-07 00:45:58,896 - EarlyStopping counter: 2 out of 10
2025-03-07 00:46:28,195 - {'epoch': 33, 'rec_loss': '7.2266'}
2025-03-07 00:46:45,479 - {'Epoch': 33, 'HR@5': '0.0311', 'NDCG@5': '0.0197', 'HR@10': '0.0507', 'NDCG@10': '0.0260', 'HR@20': '0.0827', 'NDCG@20': '0.0341'}
2025-03-07 00:46:45,485 - Validation score increased.  Saving model ...
2025-03-07 00:47:13,413 - {'epoch': 34, 'rec_loss': '7.2274'}
2025-03-07 00:47:31,133 - {'Epoch': 34, 'HR@5': '0.0294', 'NDCG@5': '0.0192', 'HR@10': '0.0509', 'NDCG@10': '0.0261', 'HR@20': '0.0825', 'NDCG@20': '0.0340'}
2025-03-07 00:47:31,139 - EarlyStopping counter: 1 out of 10
2025-03-07 00:47:58,019 - {'epoch': 35, 'rec_loss': '7.2170'}
2025-03-07 00:48:16,712 - {'Epoch': 35, 'HR@5': '0.0302', 'NDCG@5': '0.0192', 'HR@10': '0.0504', 'NDCG@10': '0.0257', 'HR@20': '0.0825', 'NDCG@20': '0.0337'}
2025-03-07 00:48:16,716 - EarlyStopping counter: 2 out of 10
2025-03-07 00:48:48,030 - {'epoch': 36, 'rec_loss': '7.2092'}
2025-03-07 00:49:07,355 - {'Epoch': 36, 'HR@5': '0.0306', 'NDCG@5': '0.0196', 'HR@10': '0.0513', 'NDCG@10': '0.0262', 'HR@20': '0.0819', 'NDCG@20': '0.0339'}
2025-03-07 00:49:07,356 - EarlyStopping counter: 3 out of 10
2025-03-07 00:49:38,318 - {'epoch': 37, 'rec_loss': '7.2076'}
2025-03-07 00:49:56,878 - {'Epoch': 37, 'HR@5': '0.0307', 'NDCG@5': '0.0197', 'HR@10': '0.0509', 'NDCG@10': '0.0262', 'HR@20': '0.0821', 'NDCG@20': '0.0340'}
2025-03-07 00:49:56,880 - EarlyStopping counter: 4 out of 10
2025-03-07 00:50:26,427 - {'epoch': 38, 'rec_loss': '7.2011'}
2025-03-07 00:50:45,102 - {'Epoch': 38, 'HR@5': '0.0304', 'NDCG@5': '0.0196', 'HR@10': '0.0513', 'NDCG@10': '0.0264', 'HR@20': '0.0823', 'NDCG@20': '0.0342'}
2025-03-07 00:50:45,107 - Validation score increased.  Saving model ...
2025-03-07 00:51:17,576 - {'epoch': 39, 'rec_loss': '7.1896'}
2025-03-07 00:51:34,740 - {'Epoch': 39, 'HR@5': '0.0302', 'NDCG@5': '0.0195', 'HR@10': '0.0507', 'NDCG@10': '0.0261', 'HR@20': '0.0818', 'NDCG@20': '0.0339'}
2025-03-07 00:51:34,746 - EarlyStopping counter: 1 out of 10
2025-03-07 00:52:02,665 - {'epoch': 40, 'rec_loss': '7.1892'}
2025-03-07 00:52:20,251 - {'Epoch': 40, 'HR@5': '0.0311', 'NDCG@5': '0.0198', 'HR@10': '0.0506', 'NDCG@10': '0.0261', 'HR@20': '0.0822', 'NDCG@20': '0.0340'}
2025-03-07 00:52:20,252 - EarlyStopping counter: 2 out of 10
2025-03-07 00:52:49,417 - {'epoch': 41, 'rec_loss': '7.1841'}
2025-03-07 00:53:08,290 - {'Epoch': 41, 'HR@5': '0.0303', 'NDCG@5': '0.0192', 'HR@10': '0.0508', 'NDCG@10': '0.0258', 'HR@20': '0.0807', 'NDCG@20': '0.0333'}
2025-03-07 00:53:08,299 - EarlyStopping counter: 3 out of 10
2025-03-07 00:53:38,274 - {'epoch': 42, 'rec_loss': '7.1805'}
2025-03-07 00:53:56,802 - {'Epoch': 42, 'HR@5': '0.0301', 'NDCG@5': '0.0191', 'HR@10': '0.0513', 'NDCG@10': '0.0259', 'HR@20': '0.0817', 'NDCG@20': '0.0335'}
2025-03-07 00:53:56,804 - EarlyStopping counter: 4 out of 10
2025-03-07 00:54:28,644 - {'epoch': 43, 'rec_loss': '7.1748'}
2025-03-07 00:54:47,297 - {'Epoch': 43, 'HR@5': '0.0305', 'NDCG@5': '0.0192', 'HR@10': '0.0519', 'NDCG@10': '0.0261', 'HR@20': '0.0821', 'NDCG@20': '0.0337'}
2025-03-07 00:54:47,298 - EarlyStopping counter: 5 out of 10
2025-03-07 00:55:16,834 - {'epoch': 44, 'rec_loss': '7.1726'}
2025-03-07 00:55:36,667 - {'Epoch': 44, 'HR@5': '0.0308', 'NDCG@5': '0.0194', 'HR@10': '0.0508', 'NDCG@10': '0.0258', 'HR@20': '0.0809', 'NDCG@20': '0.0334'}
2025-03-07 00:55:36,671 - EarlyStopping counter: 6 out of 10
2025-03-07 00:56:10,109 - {'epoch': 45, 'rec_loss': '7.1696'}
2025-03-07 00:56:28,287 - {'Epoch': 45, 'HR@5': '0.0315', 'NDCG@5': '0.0200', 'HR@10': '0.0513', 'NDCG@10': '0.0263', 'HR@20': '0.0819', 'NDCG@20': '0.0340'}
2025-03-07 00:56:28,290 - EarlyStopping counter: 7 out of 10
2025-03-07 00:56:54,356 - {'epoch': 46, 'rec_loss': '7.1628'}
2025-03-07 00:57:12,242 - {'Epoch': 46, 'HR@5': '0.0311', 'NDCG@5': '0.0198', 'HR@10': '0.0514', 'NDCG@10': '0.0263', 'HR@20': '0.0822', 'NDCG@20': '0.0340'}
2025-03-07 00:57:12,250 - EarlyStopping counter: 8 out of 10
2025-03-07 00:57:40,752 - {'epoch': 47, 'rec_loss': '7.1562'}
2025-03-07 00:57:58,980 - {'Epoch': 47, 'HR@5': '0.0305', 'NDCG@5': '0.0191', 'HR@10': '0.0512', 'NDCG@10': '0.0257', 'HR@20': '0.0834', 'NDCG@20': '0.0338'}
2025-03-07 00:57:58,988 - EarlyStopping counter: 9 out of 10
2025-03-07 00:58:29,977 - {'epoch': 48, 'rec_loss': '7.1533'}
2025-03-07 00:58:49,026 - {'Epoch': 48, 'HR@5': '0.0303', 'NDCG@5': '0.0195', 'HR@10': '0.0508', 'NDCG@10': '0.0260', 'HR@20': '0.0826', 'NDCG@20': '0.0340'}
2025-03-07 00:58:49,028 - EarlyStopping counter: 10 out of 10
2025-03-07 00:58:49,029 - Early stopping
2025-03-07 00:58:49,029 - ---------------Test Score---------------
2025-03-07 00:59:07,870 - {'Epoch': 0, 'HR@5': '0.0286', 'NDCG@5': '0.0178', 'HR@10': '0.0458', 'NDCG@10': '0.0234', 'HR@20': '0.0750', 'NDCG@20': '0.0307'}
2025-03-07 00:59:07,871 - Scale_Yelp
2025-03-07 00:59:07,872 - {'Epoch': 0, 'HR@5': '0.0286', 'NDCG@5': '0.0178', 'HR@10': '0.0458', 'NDCG@10': '0.0234', 'HR@20': '0.0750', 'NDCG@20': '0.0307'}
2025-03-07 10:22:49,757 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 24], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-07 10:22:53,997 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-07 10:22:54,003 - Total Parameters: 1437093
2025-03-07 15:21:28,817 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 5], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-07 15:21:32,529 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-07 15:21:32,537 - Total Parameters: 1435793
2025-03-07 15:22:41,869 - {'epoch': 0, 'rec_loss': '9.5489'}
2025-03-07 15:23:04,535 - {'Epoch': 0, 'HR@5': '0.0073', 'NDCG@5': '0.0047', 'HR@10': '0.0133', 'NDCG@10': '0.0066', 'HR@20': '0.0238', 'NDCG@20': '0.0093'}
2025-03-07 15:23:04,540 - Validation score increased.  Saving model ...
2025-03-07 15:23:57,914 - {'epoch': 1, 'rec_loss': '8.9448'}
2025-03-07 15:24:16,281 - {'Epoch': 1, 'HR@5': '0.0130', 'NDCG@5': '0.0080', 'HR@10': '0.0234', 'NDCG@10': '0.0113', 'HR@20': '0.0413', 'NDCG@20': '0.0158'}
2025-03-07 15:24:16,283 - Validation score increased.  Saving model ...
2025-03-07 15:25:09,907 - {'epoch': 2, 'rec_loss': '8.5165'}
2025-03-07 15:25:31,324 - {'Epoch': 2, 'HR@5': '0.0184', 'NDCG@5': '0.0117', 'HR@10': '0.0316', 'NDCG@10': '0.0160', 'HR@20': '0.0522', 'NDCG@20': '0.0212'}
2025-03-07 15:25:31,327 - Validation score increased.  Saving model ...
2025-03-07 15:26:39,537 - {'epoch': 3, 'rec_loss': '8.2524'}
2025-03-07 15:27:00,235 - {'Epoch': 3, 'HR@5': '0.0220', 'NDCG@5': '0.0134', 'HR@10': '0.0375', 'NDCG@10': '0.0184', 'HR@20': '0.0606', 'NDCG@20': '0.0242'}
2025-03-07 15:27:00,238 - Validation score increased.  Saving model ...
2025-03-07 15:27:50,310 - {'epoch': 4, 'rec_loss': '8.0790'}
2025-03-07 15:28:08,273 - {'Epoch': 4, 'HR@5': '0.0223', 'NDCG@5': '0.0143', 'HR@10': '0.0392', 'NDCG@10': '0.0198', 'HR@20': '0.0660', 'NDCG@20': '0.0265'}
2025-03-07 15:28:08,276 - Validation score increased.  Saving model ...
2025-03-07 15:29:03,643 - {'epoch': 5, 'rec_loss': '7.9541'}
2025-03-07 15:29:26,745 - {'Epoch': 5, 'HR@5': '0.0237', 'NDCG@5': '0.0145', 'HR@10': '0.0413', 'NDCG@10': '0.0201', 'HR@20': '0.0691', 'NDCG@20': '0.0271'}
2025-03-07 15:29:26,749 - Validation score increased.  Saving model ...
2025-03-07 15:30:38,727 - {'epoch': 6, 'rec_loss': '7.8537'}
2025-03-07 15:30:57,652 - {'Epoch': 6, 'HR@5': '0.0251', 'NDCG@5': '0.0157', 'HR@10': '0.0436', 'NDCG@10': '0.0216', 'HR@20': '0.0727', 'NDCG@20': '0.0290'}
2025-03-07 15:30:57,654 - Validation score increased.  Saving model ...
2025-03-07 15:31:46,090 - {'epoch': 7, 'rec_loss': '7.7855'}
2025-03-07 15:32:04,792 - {'Epoch': 7, 'HR@5': '0.0261', 'NDCG@5': '0.0161', 'HR@10': '0.0454', 'NDCG@10': '0.0223', 'HR@20': '0.0732', 'NDCG@20': '0.0293'}
2025-03-07 15:32:04,795 - Validation score increased.  Saving model ...
2025-03-07 15:33:06,290 - {'epoch': 8, 'rec_loss': '7.7218'}
2025-03-07 15:33:29,509 - {'Epoch': 8, 'HR@5': '0.0272', 'NDCG@5': '0.0169', 'HR@10': '0.0466', 'NDCG@10': '0.0232', 'HR@20': '0.0743', 'NDCG@20': '0.0301'}
2025-03-07 15:33:29,512 - Validation score increased.  Saving model ...
2025-03-07 15:34:34,738 - {'epoch': 9, 'rec_loss': '7.6707'}
2025-03-07 15:34:53,656 - {'Epoch': 9, 'HR@5': '0.0267', 'NDCG@5': '0.0167', 'HR@10': '0.0470', 'NDCG@10': '0.0233', 'HR@20': '0.0763', 'NDCG@20': '0.0306'}
2025-03-07 15:34:53,658 - Validation score increased.  Saving model ...
2025-03-07 15:35:44,347 - {'epoch': 10, 'rec_loss': '7.6297'}
2025-03-07 15:36:04,134 - {'Epoch': 10, 'HR@5': '0.0274', 'NDCG@5': '0.0170', 'HR@10': '0.0466', 'NDCG@10': '0.0232', 'HR@20': '0.0774', 'NDCG@20': '0.0309'}
2025-03-07 15:36:04,136 - Validation score increased.  Saving model ...
2025-03-07 15:37:01,727 - {'epoch': 11, 'rec_loss': '7.5891'}
2025-03-07 15:37:21,534 - {'Epoch': 11, 'HR@5': '0.0275', 'NDCG@5': '0.0171', 'HR@10': '0.0475', 'NDCG@10': '0.0235', 'HR@20': '0.0763', 'NDCG@20': '0.0307'}
2025-03-07 15:37:21,536 - EarlyStopping counter: 1 out of 10
2025-03-07 15:38:17,311 - {'epoch': 12, 'rec_loss': '7.5653'}
2025-03-07 15:38:35,612 - {'Epoch': 12, 'HR@5': '0.0289', 'NDCG@5': '0.0179', 'HR@10': '0.0482', 'NDCG@10': '0.0242', 'HR@20': '0.0779', 'NDCG@20': '0.0317'}
2025-03-07 15:38:35,614 - Validation score increased.  Saving model ...
2025-03-07 15:39:30,146 - {'epoch': 13, 'rec_loss': '7.5304'}
2025-03-07 15:39:50,114 - {'Epoch': 13, 'HR@5': '0.0287', 'NDCG@5': '0.0182', 'HR@10': '0.0487', 'NDCG@10': '0.0246', 'HR@20': '0.0791', 'NDCG@20': '0.0323'}
2025-03-07 15:39:50,117 - Validation score increased.  Saving model ...
2025-03-07 15:40:41,679 - {'epoch': 14, 'rec_loss': '7.5075'}
2025-03-07 15:41:01,556 - {'Epoch': 14, 'HR@5': '0.0279', 'NDCG@5': '0.0179', 'HR@10': '0.0489', 'NDCG@10': '0.0247', 'HR@20': '0.0793', 'NDCG@20': '0.0323'}
2025-03-07 15:41:01,558 - Validation score increased.  Saving model ...
2025-03-07 15:41:55,021 - {'epoch': 15, 'rec_loss': '7.4807'}
2025-03-07 15:42:13,860 - {'Epoch': 15, 'HR@5': '0.0291', 'NDCG@5': '0.0184', 'HR@10': '0.0483', 'NDCG@10': '0.0246', 'HR@20': '0.0795', 'NDCG@20': '0.0324'}
2025-03-07 15:42:13,862 - Validation score increased.  Saving model ...
2025-03-07 15:43:05,221 - {'epoch': 16, 'rec_loss': '7.4610'}
2025-03-07 15:43:24,796 - {'Epoch': 16, 'HR@5': '0.0297', 'NDCG@5': '0.0186', 'HR@10': '0.0498', 'NDCG@10': '0.0250', 'HR@20': '0.0801', 'NDCG@20': '0.0327'}
2025-03-07 15:43:24,798 - Validation score increased.  Saving model ...
2025-03-07 15:44:15,278 - {'epoch': 17, 'rec_loss': '7.4357'}
2025-03-07 15:44:35,366 - {'Epoch': 17, 'HR@5': '0.0296', 'NDCG@5': '0.0187', 'HR@10': '0.0499', 'NDCG@10': '0.0252', 'HR@20': '0.0791', 'NDCG@20': '0.0326'}
2025-03-07 15:44:35,369 - EarlyStopping counter: 1 out of 10
2025-03-07 15:45:32,390 - {'epoch': 18, 'rec_loss': '7.4163'}
2025-03-07 15:45:52,276 - {'Epoch': 18, 'HR@5': '0.0297', 'NDCG@5': '0.0185', 'HR@10': '0.0488', 'NDCG@10': '0.0246', 'HR@20': '0.0800', 'NDCG@20': '0.0324'}
2025-03-07 15:45:52,279 - EarlyStopping counter: 2 out of 10
2025-03-07 15:46:45,118 - {'epoch': 19, 'rec_loss': '7.4012'}
2025-03-07 15:47:05,490 - {'Epoch': 19, 'HR@5': '0.0296', 'NDCG@5': '0.0185', 'HR@10': '0.0504', 'NDCG@10': '0.0251', 'HR@20': '0.0804', 'NDCG@20': '0.0327'}
2025-03-07 15:47:05,493 - Validation score increased.  Saving model ...
2025-03-07 15:47:53,169 - {'epoch': 20, 'rec_loss': '7.3821'}
2025-03-07 15:48:11,743 - {'Epoch': 20, 'HR@5': '0.0292', 'NDCG@5': '0.0182', 'HR@10': '0.0499', 'NDCG@10': '0.0249', 'HR@20': '0.0807', 'NDCG@20': '0.0326'}
2025-03-07 15:48:11,746 - EarlyStopping counter: 1 out of 10
2025-03-07 15:48:58,681 - {'epoch': 21, 'rec_loss': '7.3715'}
2025-03-07 15:49:17,577 - {'Epoch': 21, 'HR@5': '0.0301', 'NDCG@5': '0.0187', 'HR@10': '0.0501', 'NDCG@10': '0.0252', 'HR@20': '0.0796', 'NDCG@20': '0.0326'}
2025-03-07 15:49:17,579 - EarlyStopping counter: 2 out of 10
2025-03-07 15:50:07,253 - {'epoch': 22, 'rec_loss': '7.3606'}
2025-03-07 15:50:25,059 - {'Epoch': 22, 'HR@5': '0.0292', 'NDCG@5': '0.0181', 'HR@10': '0.0490', 'NDCG@10': '0.0245', 'HR@20': '0.0792', 'NDCG@20': '0.0321'}
2025-03-07 15:50:25,064 - EarlyStopping counter: 3 out of 10
2025-03-07 15:51:10,641 - {'epoch': 23, 'rec_loss': '7.3376'}
2025-03-07 15:51:29,048 - {'Epoch': 23, 'HR@5': '0.0299', 'NDCG@5': '0.0185', 'HR@10': '0.0493', 'NDCG@10': '0.0248', 'HR@20': '0.0803', 'NDCG@20': '0.0326'}
2025-03-07 15:51:29,050 - EarlyStopping counter: 4 out of 10
2025-03-07 15:52:20,087 - {'epoch': 24, 'rec_loss': '7.3317'}
2025-03-07 15:52:39,182 - {'Epoch': 24, 'HR@5': '0.0289', 'NDCG@5': '0.0179', 'HR@10': '0.0486', 'NDCG@10': '0.0243', 'HR@20': '0.0801', 'NDCG@20': '0.0322'}
2025-03-07 15:52:39,186 - EarlyStopping counter: 5 out of 10
2025-03-07 15:53:27,133 - {'epoch': 25, 'rec_loss': '7.3179'}
2025-03-07 15:53:45,496 - {'Epoch': 25, 'HR@5': '0.0302', 'NDCG@5': '0.0186', 'HR@10': '0.0499', 'NDCG@10': '0.0250', 'HR@20': '0.0797', 'NDCG@20': '0.0325'}
2025-03-07 15:53:45,499 - EarlyStopping counter: 6 out of 10
2025-03-07 15:54:34,290 - {'epoch': 26, 'rec_loss': '7.3070'}
2025-03-07 15:54:53,820 - {'Epoch': 26, 'HR@5': '0.0297', 'NDCG@5': '0.0189', 'HR@10': '0.0503', 'NDCG@10': '0.0255', 'HR@20': '0.0815', 'NDCG@20': '0.0334'}
2025-03-07 15:54:53,822 - Validation score increased.  Saving model ...
2025-03-07 15:55:51,227 - {'epoch': 27, 'rec_loss': '7.2975'}
2025-03-07 15:56:09,713 - {'Epoch': 27, 'HR@5': '0.0302', 'NDCG@5': '0.0188', 'HR@10': '0.0500', 'NDCG@10': '0.0251', 'HR@20': '0.0812', 'NDCG@20': '0.0329'}
2025-03-07 15:56:09,715 - EarlyStopping counter: 1 out of 10
2025-03-07 15:56:57,401 - {'epoch': 28, 'rec_loss': '7.2831'}
2025-03-07 15:57:15,746 - {'Epoch': 28, 'HR@5': '0.0301', 'NDCG@5': '0.0192', 'HR@10': '0.0498', 'NDCG@10': '0.0256', 'HR@20': '0.0793', 'NDCG@20': '0.0330'}
2025-03-07 15:57:15,747 - EarlyStopping counter: 2 out of 10
2025-03-07 15:58:08,156 - {'epoch': 29, 'rec_loss': '7.2753'}
2025-03-07 15:58:28,007 - {'Epoch': 29, 'HR@5': '0.0307', 'NDCG@5': '0.0192', 'HR@10': '0.0495', 'NDCG@10': '0.0252', 'HR@20': '0.0783', 'NDCG@20': '0.0324'}
2025-03-07 15:58:28,008 - EarlyStopping counter: 3 out of 10
2025-03-07 15:59:16,747 - {'epoch': 30, 'rec_loss': '7.2723'}
2025-03-07 15:59:35,651 - {'Epoch': 30, 'HR@5': '0.0294', 'NDCG@5': '0.0190', 'HR@10': '0.0498', 'NDCG@10': '0.0255', 'HR@20': '0.0823', 'NDCG@20': '0.0337'}
2025-03-07 15:59:35,654 - Validation score increased.  Saving model ...
2025-03-07 16:00:24,334 - {'epoch': 31, 'rec_loss': '7.2640'}
2025-03-07 16:00:43,742 - {'Epoch': 31, 'HR@5': '0.0307', 'NDCG@5': '0.0195', 'HR@10': '0.0515', 'NDCG@10': '0.0262', 'HR@20': '0.0812', 'NDCG@20': '0.0337'}
2025-03-07 16:00:43,744 - EarlyStopping counter: 1 out of 10
2025-03-07 16:01:34,530 - {'epoch': 32, 'rec_loss': '7.2524'}
2025-03-07 16:01:52,682 - {'Epoch': 32, 'HR@5': '0.0305', 'NDCG@5': '0.0191', 'HR@10': '0.0502', 'NDCG@10': '0.0255', 'HR@20': '0.0806', 'NDCG@20': '0.0331'}
2025-03-07 16:01:52,684 - EarlyStopping counter: 2 out of 10
2025-03-07 16:02:38,337 - {'epoch': 33, 'rec_loss': '7.2450'}
2025-03-07 16:02:56,574 - {'Epoch': 33, 'HR@5': '0.0313', 'NDCG@5': '0.0197', 'HR@10': '0.0512', 'NDCG@10': '0.0261', 'HR@20': '0.0826', 'NDCG@20': '0.0340'}
2025-03-07 16:02:56,575 - Validation score increased.  Saving model ...
2025-03-07 16:03:44,768 - {'epoch': 34, 'rec_loss': '7.2348'}
2025-03-07 16:04:04,133 - {'Epoch': 34, 'HR@5': '0.0303', 'NDCG@5': '0.0193', 'HR@10': '0.0512', 'NDCG@10': '0.0260', 'HR@20': '0.0815', 'NDCG@20': '0.0336'}
2025-03-07 16:04:04,138 - EarlyStopping counter: 1 out of 10
2025-03-07 16:04:52,426 - {'epoch': 35, 'rec_loss': '7.2307'}
2025-03-07 16:05:10,764 - {'Epoch': 35, 'HR@5': '0.0306', 'NDCG@5': '0.0194', 'HR@10': '0.0501', 'NDCG@10': '0.0257', 'HR@20': '0.0807', 'NDCG@20': '0.0334'}
2025-03-07 16:05:10,766 - EarlyStopping counter: 2 out of 10
2025-03-07 16:05:58,625 - {'epoch': 36, 'rec_loss': '7.2218'}
2025-03-07 16:06:18,192 - {'Epoch': 36, 'HR@5': '0.0300', 'NDCG@5': '0.0193', 'HR@10': '0.0501', 'NDCG@10': '0.0257', 'HR@20': '0.0799', 'NDCG@20': '0.0332'}
2025-03-07 16:06:18,195 - EarlyStopping counter: 3 out of 10
2025-03-07 16:07:08,965 - {'epoch': 37, 'rec_loss': '7.2106'}
2025-03-07 16:07:28,218 - {'Epoch': 37, 'HR@5': '0.0296', 'NDCG@5': '0.0191', 'HR@10': '0.0496', 'NDCG@10': '0.0255', 'HR@20': '0.0807', 'NDCG@20': '0.0333'}
2025-03-07 16:07:28,221 - EarlyStopping counter: 4 out of 10
2025-03-07 16:08:14,153 - {'epoch': 38, 'rec_loss': '7.2048'}
2025-03-07 16:08:32,658 - {'Epoch': 38, 'HR@5': '0.0298', 'NDCG@5': '0.0191', 'HR@10': '0.0505', 'NDCG@10': '0.0258', 'HR@20': '0.0804', 'NDCG@20': '0.0333'}
2025-03-07 16:08:32,660 - EarlyStopping counter: 5 out of 10
2025-03-07 16:09:22,947 - {'epoch': 39, 'rec_loss': '7.1995'}
2025-03-07 16:09:42,780 - {'Epoch': 39, 'HR@5': '0.0306', 'NDCG@5': '0.0192', 'HR@10': '0.0500', 'NDCG@10': '0.0255', 'HR@20': '0.0802', 'NDCG@20': '0.0331'}
2025-03-07 16:09:42,783 - EarlyStopping counter: 6 out of 10
2025-03-07 16:10:33,279 - {'epoch': 40, 'rec_loss': '7.1943'}
2025-03-07 16:10:51,278 - {'Epoch': 40, 'HR@5': '0.0304', 'NDCG@5': '0.0195', 'HR@10': '0.0512', 'NDCG@10': '0.0261', 'HR@20': '0.0823', 'NDCG@20': '0.0339'}
2025-03-07 16:10:51,280 - EarlyStopping counter: 7 out of 10
2025-03-07 16:11:37,774 - {'epoch': 41, 'rec_loss': '7.1927'}
2025-03-07 16:11:55,880 - {'Epoch': 41, 'HR@5': '0.0308', 'NDCG@5': '0.0196', 'HR@10': '0.0515', 'NDCG@10': '0.0263', 'HR@20': '0.0817', 'NDCG@20': '0.0339'}
2025-03-07 16:11:55,881 - EarlyStopping counter: 8 out of 10
2025-03-07 16:12:46,021 - {'epoch': 42, 'rec_loss': '7.1810'}
2025-03-07 16:13:04,810 - {'Epoch': 42, 'HR@5': '0.0304', 'NDCG@5': '0.0195', 'HR@10': '0.0513', 'NDCG@10': '0.0261', 'HR@20': '0.0821', 'NDCG@20': '0.0339'}
2025-03-07 16:13:04,812 - EarlyStopping counter: 9 out of 10
2025-03-07 16:13:51,727 - {'epoch': 43, 'rec_loss': '7.1857'}
2025-03-07 16:14:10,008 - {'Epoch': 43, 'HR@5': '0.0310', 'NDCG@5': '0.0197', 'HR@10': '0.0515', 'NDCG@10': '0.0263', 'HR@20': '0.0817', 'NDCG@20': '0.0339'}
2025-03-07 16:14:10,011 - EarlyStopping counter: 10 out of 10
2025-03-07 16:14:10,011 - Early stopping
2025-03-07 16:14:10,011 - ---------------Test Score---------------
2025-03-07 16:14:28,262 - {'Epoch': 0, 'HR@5': '0.0281', 'NDCG@5': '0.0181', 'HR@10': '0.0465', 'NDCG@10': '0.0240', 'HR@20': '0.0742', 'NDCG@20': '0.0309'}
2025-03-07 16:14:28,266 - Scale_Yelp
2025-03-07 16:14:28,266 - {'Epoch': 0, 'HR@5': '0.0281', 'NDCG@5': '0.0181', 'HR@10': '0.0465', 'NDCG@10': '0.0240', 'HR@20': '0.0742', 'NDCG@20': '0.0309'}
2025-03-07 16:32:46,403 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50], kernels=[4, 8, 12], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-07 16:32:49,895 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=50, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-07 16:32:49,907 - Total Parameters: 1438718
2025-03-07 16:33:25,231 - {'epoch': 0, 'rec_loss': '9.5912'}
2025-03-07 16:33:42,100 - {'Epoch': 0, 'HR@5': '0.0079', 'NDCG@5': '0.0052', 'HR@10': '0.0133', 'NDCG@10': '0.0069', 'HR@20': '0.0220', 'NDCG@20': '0.0091'}
2025-03-07 16:33:42,106 - Validation score increased.  Saving model ...
2025-03-07 16:34:13,016 - {'epoch': 1, 'rec_loss': '9.2520'}
2025-03-07 16:34:29,991 - {'Epoch': 1, 'HR@5': '0.0102', 'NDCG@5': '0.0068', 'HR@10': '0.0182', 'NDCG@10': '0.0093', 'HR@20': '0.0310', 'NDCG@20': '0.0126'}
2025-03-07 16:34:29,992 - Validation score increased.  Saving model ...
2025-03-07 16:35:06,597 - {'epoch': 2, 'rec_loss': '8.9007'}
2025-03-07 16:35:24,410 - {'Epoch': 2, 'HR@5': '0.0131', 'NDCG@5': '0.0080', 'HR@10': '0.0220', 'NDCG@10': '0.0109', 'HR@20': '0.0372', 'NDCG@20': '0.0147'}
2025-03-07 16:35:24,412 - Validation score increased.  Saving model ...
2025-03-07 16:36:00,906 - {'epoch': 3, 'rec_loss': '8.6671'}
2025-03-07 16:36:16,854 - {'Epoch': 3, 'HR@5': '0.0161', 'NDCG@5': '0.0100', 'HR@10': '0.0291', 'NDCG@10': '0.0142', 'HR@20': '0.0482', 'NDCG@20': '0.0190'}
2025-03-07 16:36:16,856 - Validation score increased.  Saving model ...
2025-03-07 16:36:48,190 - {'epoch': 4, 'rec_loss': '8.4716'}
2025-03-07 16:37:04,858 - {'Epoch': 4, 'HR@5': '0.0179', 'NDCG@5': '0.0111', 'HR@10': '0.0313', 'NDCG@10': '0.0153', 'HR@20': '0.0543', 'NDCG@20': '0.0211'}
2025-03-07 16:37:04,862 - Validation score increased.  Saving model ...
2025-03-07 16:37:34,902 - {'epoch': 5, 'rec_loss': '8.3246'}
2025-03-07 16:37:52,871 - {'Epoch': 5, 'HR@5': '0.0197', 'NDCG@5': '0.0123', 'HR@10': '0.0345', 'NDCG@10': '0.0170', 'HR@20': '0.0591', 'NDCG@20': '0.0232'}
2025-03-07 16:37:52,874 - Validation score increased.  Saving model ...
2025-03-07 16:38:28,116 - {'epoch': 6, 'rec_loss': '8.2144'}
2025-03-07 16:38:46,129 - {'Epoch': 6, 'HR@5': '0.0219', 'NDCG@5': '0.0134', 'HR@10': '0.0382', 'NDCG@10': '0.0186', 'HR@20': '0.0623', 'NDCG@20': '0.0247'}
2025-03-07 16:38:46,134 - Validation score increased.  Saving model ...
2025-03-07 16:39:15,949 - {'epoch': 7, 'rec_loss': '8.1324'}
2025-03-07 16:39:32,568 - {'Epoch': 7, 'HR@5': '0.0234', 'NDCG@5': '0.0146', 'HR@10': '0.0393', 'NDCG@10': '0.0197', 'HR@20': '0.0665', 'NDCG@20': '0.0265'}
2025-03-07 16:39:32,569 - Validation score increased.  Saving model ...
2025-03-07 16:40:02,222 - {'epoch': 8, 'rec_loss': '8.0688'}
2025-03-07 16:40:19,132 - {'Epoch': 8, 'HR@5': '0.0253', 'NDCG@5': '0.0157', 'HR@10': '0.0421', 'NDCG@10': '0.0211', 'HR@20': '0.0688', 'NDCG@20': '0.0278'}
2025-03-07 16:40:19,141 - Validation score increased.  Saving model ...
2025-03-07 16:40:54,043 - {'epoch': 9, 'rec_loss': '8.0127'}
2025-03-07 16:41:12,393 - {'Epoch': 9, 'HR@5': '0.0250', 'NDCG@5': '0.0158', 'HR@10': '0.0422', 'NDCG@10': '0.0213', 'HR@20': '0.0715', 'NDCG@20': '0.0287'}
2025-03-07 16:41:12,394 - Validation score increased.  Saving model ...
2025-03-07 16:41:48,921 - {'epoch': 10, 'rec_loss': '7.9600'}
2025-03-07 16:42:05,464 - {'Epoch': 10, 'HR@5': '0.0259', 'NDCG@5': '0.0162', 'HR@10': '0.0433', 'NDCG@10': '0.0218', 'HR@20': '0.0717', 'NDCG@20': '0.0289'}
2025-03-07 16:42:05,467 - Validation score increased.  Saving model ...
2025-03-07 16:42:33,874 - {'epoch': 11, 'rec_loss': '7.9133'}
2025-03-07 16:42:50,788 - {'Epoch': 11, 'HR@5': '0.0272', 'NDCG@5': '0.0171', 'HR@10': '0.0466', 'NDCG@10': '0.0233', 'HR@20': '0.0763', 'NDCG@20': '0.0308'}
2025-03-07 16:42:50,789 - Validation score increased.  Saving model ...
2025-03-07 16:43:23,620 - {'epoch': 12, 'rec_loss': '7.8769'}
2025-03-07 16:43:42,763 - {'Epoch': 12, 'HR@5': '0.0288', 'NDCG@5': '0.0179', 'HR@10': '0.0478', 'NDCG@10': '0.0240', 'HR@20': '0.0759', 'NDCG@20': '0.0310'}
2025-03-07 16:43:42,765 - Validation score increased.  Saving model ...
2025-03-07 16:44:19,900 - {'epoch': 13, 'rec_loss': '7.8426'}
2025-03-07 16:44:38,064 - {'Epoch': 13, 'HR@5': '0.0286', 'NDCG@5': '0.0179', 'HR@10': '0.0473', 'NDCG@10': '0.0239', 'HR@20': '0.0791', 'NDCG@20': '0.0319'}
2025-03-07 16:44:38,066 - Validation score increased.  Saving model ...
2025-03-07 16:45:11,678 - {'epoch': 14, 'rec_loss': '7.8034'}
2025-03-07 16:45:28,716 - {'Epoch': 14, 'HR@5': '0.0299', 'NDCG@5': '0.0185', 'HR@10': '0.0485', 'NDCG@10': '0.0245', 'HR@20': '0.0788', 'NDCG@20': '0.0321'}
2025-03-07 16:45:28,717 - Validation score increased.  Saving model ...
2025-03-07 16:45:59,905 - {'epoch': 15, 'rec_loss': '7.7772'}
2025-03-07 16:46:17,198 - {'Epoch': 15, 'HR@5': '0.0297', 'NDCG@5': '0.0184', 'HR@10': '0.0495', 'NDCG@10': '0.0247', 'HR@20': '0.0797', 'NDCG@20': '0.0323'}
2025-03-07 16:46:17,200 - Validation score increased.  Saving model ...
2025-03-07 16:46:50,458 - {'epoch': 16, 'rec_loss': '7.7552'}
2025-03-07 16:47:08,431 - {'Epoch': 16, 'HR@5': '0.0295', 'NDCG@5': '0.0185', 'HR@10': '0.0489', 'NDCG@10': '0.0248', 'HR@20': '0.0803', 'NDCG@20': '0.0327'}
2025-03-07 16:47:08,432 - Validation score increased.  Saving model ...
2025-03-07 16:47:44,946 - {'epoch': 17, 'rec_loss': '7.7395'}
2025-03-07 16:48:03,253 - {'Epoch': 17, 'HR@5': '0.0299', 'NDCG@5': '0.0187', 'HR@10': '0.0522', 'NDCG@10': '0.0259', 'HR@20': '0.0823', 'NDCG@20': '0.0334'}
2025-03-07 16:48:03,255 - Validation score increased.  Saving model ...
2025-03-07 16:48:33,196 - {'epoch': 18, 'rec_loss': '7.7142'}
2025-03-07 16:48:50,465 - {'Epoch': 18, 'HR@5': '0.0296', 'NDCG@5': '0.0189', 'HR@10': '0.0501', 'NDCG@10': '0.0254', 'HR@20': '0.0821', 'NDCG@20': '0.0335'}
2025-03-07 16:48:50,470 - Validation score increased.  Saving model ...
2025-03-07 16:49:22,271 - {'epoch': 19, 'rec_loss': '7.6992'}
2025-03-07 16:49:39,739 - {'Epoch': 19, 'HR@5': '0.0302', 'NDCG@5': '0.0189', 'HR@10': '0.0510', 'NDCG@10': '0.0256', 'HR@20': '0.0826', 'NDCG@20': '0.0336'}
2025-03-07 16:49:39,742 - Validation score increased.  Saving model ...
2025-03-07 16:50:21,165 - {'epoch': 20, 'rec_loss': '7.6821'}
2025-03-07 16:50:40,707 - {'Epoch': 20, 'HR@5': '0.0317', 'NDCG@5': '0.0199', 'HR@10': '0.0521', 'NDCG@10': '0.0265', 'HR@20': '0.0833', 'NDCG@20': '0.0343'}
2025-03-07 16:50:40,715 - Validation score increased.  Saving model ...
2025-03-07 16:51:19,523 - {'epoch': 21, 'rec_loss': '7.6701'}
2025-03-07 16:51:37,332 - {'Epoch': 21, 'HR@5': '0.0310', 'NDCG@5': '0.0196', 'HR@10': '0.0518', 'NDCG@10': '0.0263', 'HR@20': '0.0841', 'NDCG@20': '0.0344'}
2025-03-07 16:51:37,334 - Validation score increased.  Saving model ...
2025-03-07 16:52:15,666 - {'epoch': 22, 'rec_loss': '7.6512'}
2025-03-07 16:52:34,672 - {'Epoch': 22, 'HR@5': '0.0315', 'NDCG@5': '0.0193', 'HR@10': '0.0513', 'NDCG@10': '0.0257', 'HR@20': '0.0839', 'NDCG@20': '0.0339'}
2025-03-07 16:52:34,674 - EarlyStopping counter: 1 out of 10
2025-03-07 16:53:16,990 - {'epoch': 23, 'rec_loss': '7.6432'}
2025-03-07 16:53:38,760 - {'Epoch': 23, 'HR@5': '0.0317', 'NDCG@5': '0.0198', 'HR@10': '0.0522', 'NDCG@10': '0.0264', 'HR@20': '0.0839', 'NDCG@20': '0.0344'}
2025-03-07 16:53:38,764 - EarlyStopping counter: 2 out of 10
2025-03-07 16:54:25,899 - {'epoch': 24, 'rec_loss': '7.6260'}
2025-03-07 16:54:46,841 - {'Epoch': 24, 'HR@5': '0.0314', 'NDCG@5': '0.0199', 'HR@10': '0.0515', 'NDCG@10': '0.0263', 'HR@20': '0.0843', 'NDCG@20': '0.0345'}
2025-03-07 16:54:46,847 - Validation score increased.  Saving model ...
2025-03-07 16:55:26,474 - {'epoch': 25, 'rec_loss': '7.6201'}
2025-03-07 16:55:45,811 - {'Epoch': 25, 'HR@5': '0.0316', 'NDCG@5': '0.0197', 'HR@10': '0.0514', 'NDCG@10': '0.0261', 'HR@20': '0.0846', 'NDCG@20': '0.0344'}
2025-03-07 16:55:45,813 - EarlyStopping counter: 1 out of 10
2025-03-07 16:56:22,435 - {'epoch': 26, 'rec_loss': '7.6013'}
2025-03-07 16:56:39,729 - {'Epoch': 26, 'HR@5': '0.0320', 'NDCG@5': '0.0201', 'HR@10': '0.0515', 'NDCG@10': '0.0264', 'HR@20': '0.0847', 'NDCG@20': '0.0347'}
2025-03-07 16:56:39,731 - Validation score increased.  Saving model ...
2025-03-07 16:57:18,251 - {'epoch': 27, 'rec_loss': '7.5952'}
2025-03-07 16:57:39,564 - {'Epoch': 27, 'HR@5': '0.0311', 'NDCG@5': '0.0196', 'HR@10': '0.0531', 'NDCG@10': '0.0267', 'HR@20': '0.0842', 'NDCG@20': '0.0345'}
2025-03-07 16:57:39,570 - EarlyStopping counter: 1 out of 10
2025-03-07 16:58:25,808 - {'epoch': 28, 'rec_loss': '7.5864'}
2025-03-07 16:58:45,498 - {'Epoch': 28, 'HR@5': '0.0322', 'NDCG@5': '0.0201', 'HR@10': '0.0529', 'NDCG@10': '0.0268', 'HR@20': '0.0831', 'NDCG@20': '0.0344'}
2025-03-07 16:58:45,500 - EarlyStopping counter: 2 out of 10
2025-03-07 16:59:24,107 - {'epoch': 29, 'rec_loss': '7.5696'}
2025-03-07 16:59:43,561 - {'Epoch': 29, 'HR@5': '0.0316', 'NDCG@5': '0.0200', 'HR@10': '0.0538', 'NDCG@10': '0.0271', 'HR@20': '0.0857', 'NDCG@20': '0.0351'}
2025-03-07 16:59:43,562 - Validation score increased.  Saving model ...
2025-03-07 17:00:23,184 - {'epoch': 30, 'rec_loss': '7.5722'}
2025-03-07 17:00:44,283 - {'Epoch': 30, 'HR@5': '0.0325', 'NDCG@5': '0.0203', 'HR@10': '0.0536', 'NDCG@10': '0.0271', 'HR@20': '0.0855', 'NDCG@20': '0.0351'}
2025-03-07 17:00:44,286 - EarlyStopping counter: 1 out of 10
2025-03-07 17:01:31,647 - {'epoch': 31, 'rec_loss': '7.5615'}
2025-03-07 17:01:53,249 - {'Epoch': 31, 'HR@5': '0.0323', 'NDCG@5': '0.0204', 'HR@10': '0.0541', 'NDCG@10': '0.0274', 'HR@20': '0.0861', 'NDCG@20': '0.0354'}
2025-03-07 17:01:53,251 - Validation score increased.  Saving model ...
2025-03-07 17:02:28,543 - {'epoch': 32, 'rec_loss': '7.5625'}
2025-03-07 17:02:46,744 - {'Epoch': 32, 'HR@5': '0.0320', 'NDCG@5': '0.0204', 'HR@10': '0.0530', 'NDCG@10': '0.0272', 'HR@20': '0.0856', 'NDCG@20': '0.0354'}
2025-03-07 17:02:46,745 - EarlyStopping counter: 1 out of 10
2025-03-07 17:03:22,475 - {'epoch': 33, 'rec_loss': '7.5433'}
2025-03-07 17:03:42,192 - {'Epoch': 33, 'HR@5': '0.0315', 'NDCG@5': '0.0198', 'HR@10': '0.0532', 'NDCG@10': '0.0268', 'HR@20': '0.0849', 'NDCG@20': '0.0348'}
2025-03-07 17:03:42,198 - EarlyStopping counter: 2 out of 10
2025-03-07 17:04:22,350 - {'epoch': 34, 'rec_loss': '7.5416'}
2025-03-07 17:04:43,493 - {'Epoch': 34, 'HR@5': '0.0321', 'NDCG@5': '0.0201', 'HR@10': '0.0533', 'NDCG@10': '0.0269', 'HR@20': '0.0846', 'NDCG@20': '0.0348'}
2025-03-07 17:04:43,494 - EarlyStopping counter: 3 out of 10
2025-03-07 17:05:29,172 - {'epoch': 35, 'rec_loss': '7.5339'}
2025-03-07 17:05:51,574 - {'Epoch': 35, 'HR@5': '0.0322', 'NDCG@5': '0.0205', 'HR@10': '0.0531', 'NDCG@10': '0.0272', 'HR@20': '0.0851', 'NDCG@20': '0.0352'}
2025-03-07 17:05:51,576 - EarlyStopping counter: 4 out of 10
2025-03-07 17:06:32,444 - {'epoch': 36, 'rec_loss': '7.5375'}
2025-03-07 17:06:52,481 - {'Epoch': 36, 'HR@5': '0.0322', 'NDCG@5': '0.0204', 'HR@10': '0.0527', 'NDCG@10': '0.0270', 'HR@20': '0.0861', 'NDCG@20': '0.0353'}
2025-03-07 17:06:52,486 - EarlyStopping counter: 5 out of 10
2025-03-07 17:07:30,928 - {'epoch': 37, 'rec_loss': '7.5241'}
2025-03-07 17:07:48,251 - {'Epoch': 37, 'HR@5': '0.0327', 'NDCG@5': '0.0206', 'HR@10': '0.0538', 'NDCG@10': '0.0273', 'HR@20': '0.0843', 'NDCG@20': '0.0350'}
2025-03-07 17:07:48,253 - EarlyStopping counter: 6 out of 10
2025-03-07 17:08:27,693 - {'epoch': 38, 'rec_loss': '7.5113'}
2025-03-07 17:08:47,352 - {'Epoch': 38, 'HR@5': '0.0335', 'NDCG@5': '0.0211', 'HR@10': '0.0530', 'NDCG@10': '0.0274', 'HR@20': '0.0859', 'NDCG@20': '0.0356'}
2025-03-07 17:08:47,354 - Validation score increased.  Saving model ...
2025-03-07 17:09:32,095 - {'epoch': 39, 'rec_loss': '7.5136'}
2025-03-07 17:09:52,046 - {'Epoch': 39, 'HR@5': '0.0317', 'NDCG@5': '0.0203', 'HR@10': '0.0537', 'NDCG@10': '0.0273', 'HR@20': '0.0857', 'NDCG@20': '0.0354'}
2025-03-07 17:09:52,047 - EarlyStopping counter: 1 out of 10
2025-03-07 17:10:30,421 - {'epoch': 40, 'rec_loss': '7.5129'}
2025-03-07 17:10:50,128 - {'Epoch': 40, 'HR@5': '0.0322', 'NDCG@5': '0.0206', 'HR@10': '0.0543', 'NDCG@10': '0.0277', 'HR@20': '0.0865', 'NDCG@20': '0.0358'}
2025-03-07 17:10:50,130 - Validation score increased.  Saving model ...
2025-03-07 17:11:29,952 - {'epoch': 41, 'rec_loss': '7.5046'}
2025-03-07 17:11:50,140 - {'Epoch': 41, 'HR@5': '0.0316', 'NDCG@5': '0.0201', 'HR@10': '0.0532', 'NDCG@10': '0.0270', 'HR@20': '0.0859', 'NDCG@20': '0.0352'}
2025-03-07 17:11:50,146 - EarlyStopping counter: 1 out of 10
2025-03-07 17:12:35,145 - {'epoch': 42, 'rec_loss': '7.5002'}
2025-03-07 17:12:56,554 - {'Epoch': 42, 'HR@5': '0.0317', 'NDCG@5': '0.0203', 'HR@10': '0.0531', 'NDCG@10': '0.0271', 'HR@20': '0.0848', 'NDCG@20': '0.0351'}
2025-03-07 17:12:56,556 - EarlyStopping counter: 2 out of 10
2025-03-07 17:13:36,143 - {'epoch': 43, 'rec_loss': '7.4934'}
2025-03-07 17:13:53,988 - {'Epoch': 43, 'HR@5': '0.0320', 'NDCG@5': '0.0201', 'HR@10': '0.0526', 'NDCG@10': '0.0267', 'HR@20': '0.0845', 'NDCG@20': '0.0347'}
2025-03-07 17:13:53,993 - EarlyStopping counter: 3 out of 10
2025-03-07 17:14:29,404 - {'epoch': 44, 'rec_loss': '7.4911'}
2025-03-07 17:14:48,423 - {'Epoch': 44, 'HR@5': '0.0328', 'NDCG@5': '0.0209', 'HR@10': '0.0532', 'NDCG@10': '0.0274', 'HR@20': '0.0854', 'NDCG@20': '0.0355'}
2025-03-07 17:14:48,428 - EarlyStopping counter: 4 out of 10
2025-03-07 17:15:28,336 - {'epoch': 45, 'rec_loss': '7.4878'}
2025-03-07 17:15:49,379 - {'Epoch': 45, 'HR@5': '0.0327', 'NDCG@5': '0.0208', 'HR@10': '0.0527', 'NDCG@10': '0.0273', 'HR@20': '0.0849', 'NDCG@20': '0.0353'}
2025-03-07 17:15:49,382 - EarlyStopping counter: 5 out of 10
2025-03-07 17:16:34,388 - {'epoch': 46, 'rec_loss': '7.4801'}
2025-03-07 17:16:54,659 - {'Epoch': 46, 'HR@5': '0.0323', 'NDCG@5': '0.0208', 'HR@10': '0.0534', 'NDCG@10': '0.0275', 'HR@20': '0.0851', 'NDCG@20': '0.0355'}
2025-03-07 17:16:54,665 - EarlyStopping counter: 6 out of 10
2025-03-07 17:17:35,393 - {'epoch': 47, 'rec_loss': '7.4817'}
2025-03-07 17:17:54,899 - {'Epoch': 47, 'HR@5': '0.0316', 'NDCG@5': '0.0198', 'HR@10': '0.0527', 'NDCG@10': '0.0266', 'HR@20': '0.0849', 'NDCG@20': '0.0347'}
2025-03-07 17:17:54,901 - EarlyStopping counter: 7 out of 10
2025-03-07 17:18:32,195 - {'epoch': 48, 'rec_loss': '7.4672'}
2025-03-07 17:18:49,944 - {'Epoch': 48, 'HR@5': '0.0317', 'NDCG@5': '0.0206', 'HR@10': '0.0541', 'NDCG@10': '0.0277', 'HR@20': '0.0863', 'NDCG@20': '0.0358'}
2025-03-07 17:18:49,952 - Validation score increased.  Saving model ...
2025-03-07 17:19:27,914 - {'epoch': 49, 'rec_loss': '7.4698'}
2025-03-07 17:19:48,500 - {'Epoch': 49, 'HR@5': '0.0330', 'NDCG@5': '0.0208', 'HR@10': '0.0542', 'NDCG@10': '0.0276', 'HR@20': '0.0870', 'NDCG@20': '0.0358'}
2025-03-07 17:19:48,505 - Validation score increased.  Saving model ...
2025-03-07 17:20:33,218 - {'epoch': 50, 'rec_loss': '7.4703'}
2025-03-07 17:20:52,378 - {'Epoch': 50, 'HR@5': '0.0332', 'NDCG@5': '0.0210', 'HR@10': '0.0539', 'NDCG@10': '0.0276', 'HR@20': '0.0856', 'NDCG@20': '0.0356'}
2025-03-07 17:20:52,380 - EarlyStopping counter: 1 out of 10
2025-03-07 17:21:28,834 - {'epoch': 51, 'rec_loss': '7.4667'}
2025-03-07 17:21:48,222 - {'Epoch': 51, 'HR@5': '0.0324', 'NDCG@5': '0.0209', 'HR@10': '0.0535', 'NDCG@10': '0.0277', 'HR@20': '0.0865', 'NDCG@20': '0.0360'}
2025-03-07 17:21:48,223 - Validation score increased.  Saving model ...
2025-03-07 17:22:27,754 - {'epoch': 52, 'rec_loss': '7.4544'}
2025-03-07 17:22:48,365 - {'Epoch': 52, 'HR@5': '0.0324', 'NDCG@5': '0.0204', 'HR@10': '0.0536', 'NDCG@10': '0.0273', 'HR@20': '0.0849', 'NDCG@20': '0.0351'}
2025-03-07 17:22:48,370 - EarlyStopping counter: 1 out of 10
2025-03-07 17:23:32,543 - {'epoch': 53, 'rec_loss': '7.4540'}
2025-03-07 17:23:53,725 - {'Epoch': 53, 'HR@5': '0.0331', 'NDCG@5': '0.0211', 'HR@10': '0.0540', 'NDCG@10': '0.0278', 'HR@20': '0.0862', 'NDCG@20': '0.0359'}
2025-03-07 17:23:53,730 - EarlyStopping counter: 2 out of 10
2025-03-07 17:24:25,183 - {'epoch': 54, 'rec_loss': '7.4524'}
2025-03-07 17:24:42,067 - {'Epoch': 54, 'HR@5': '0.0321', 'NDCG@5': '0.0210', 'HR@10': '0.0527', 'NDCG@10': '0.0276', 'HR@20': '0.0842', 'NDCG@20': '0.0355'}
2025-03-07 17:24:42,069 - EarlyStopping counter: 3 out of 10
2025-03-07 17:25:16,680 - {'epoch': 55, 'rec_loss': '7.4540'}
2025-03-07 17:25:35,474 - {'Epoch': 55, 'HR@5': '0.0326', 'NDCG@5': '0.0204', 'HR@10': '0.0533', 'NDCG@10': '0.0270', 'HR@20': '0.0849', 'NDCG@20': '0.0350'}
2025-03-07 17:25:35,479 - EarlyStopping counter: 4 out of 10
2025-03-07 17:26:18,153 - {'epoch': 56, 'rec_loss': '7.4452'}
2025-03-07 17:26:38,608 - {'Epoch': 56, 'HR@5': '0.0329', 'NDCG@5': '0.0206', 'HR@10': '0.0533', 'NDCG@10': '0.0271', 'HR@20': '0.0851', 'NDCG@20': '0.0351'}
2025-03-07 17:26:38,610 - EarlyStopping counter: 5 out of 10
2025-03-07 17:27:21,439 - {'epoch': 57, 'rec_loss': '7.4477'}
2025-03-07 17:27:40,691 - {'Epoch': 57, 'HR@5': '0.0322', 'NDCG@5': '0.0205', 'HR@10': '0.0529', 'NDCG@10': '0.0271', 'HR@20': '0.0847', 'NDCG@20': '0.0351'}
2025-03-07 17:27:40,695 - EarlyStopping counter: 6 out of 10
2025-03-07 17:28:18,512 - {'epoch': 58, 'rec_loss': '7.4438'}
2025-03-07 17:28:37,788 - {'Epoch': 58, 'HR@5': '0.0316', 'NDCG@5': '0.0205', 'HR@10': '0.0538', 'NDCG@10': '0.0276', 'HR@20': '0.0845', 'NDCG@20': '0.0353'}
2025-03-07 17:28:37,790 - EarlyStopping counter: 7 out of 10
2025-03-07 17:29:10,495 - {'epoch': 59, 'rec_loss': '7.4317'}
2025-03-07 17:29:28,762 - {'Epoch': 59, 'HR@5': '0.0328', 'NDCG@5': '0.0206', 'HR@10': '0.0540', 'NDCG@10': '0.0274', 'HR@20': '0.0855', 'NDCG@20': '0.0354'}
2025-03-07 17:29:28,766 - EarlyStopping counter: 8 out of 10
2025-03-07 17:30:09,257 - {'epoch': 60, 'rec_loss': '7.4382'}
2025-03-07 17:30:29,525 - {'Epoch': 60, 'HR@5': '0.0330', 'NDCG@5': '0.0212', 'HR@10': '0.0546', 'NDCG@10': '0.0281', 'HR@20': '0.0870', 'NDCG@20': '0.0362'}
2025-03-07 17:30:29,527 - Validation score increased.  Saving model ...
2025-03-07 17:31:09,903 - {'epoch': 61, 'rec_loss': '7.4348'}
2025-03-07 17:31:29,080 - {'Epoch': 61, 'HR@5': '0.0335', 'NDCG@5': '0.0211', 'HR@10': '0.0545', 'NDCG@10': '0.0279', 'HR@20': '0.0862', 'NDCG@20': '0.0358'}
2025-03-07 17:31:29,085 - EarlyStopping counter: 1 out of 10
2025-03-07 17:32:05,710 - {'epoch': 62, 'rec_loss': '7.4366'}
2025-03-07 17:32:25,075 - {'Epoch': 62, 'HR@5': '0.0316', 'NDCG@5': '0.0206', 'HR@10': '0.0540', 'NDCG@10': '0.0278', 'HR@20': '0.0856', 'NDCG@20': '0.0357'}
2025-03-07 17:32:25,083 - EarlyStopping counter: 2 out of 10
2025-03-07 17:33:07,066 - {'epoch': 63, 'rec_loss': '7.4357'}
2025-03-07 17:33:27,566 - {'Epoch': 63, 'HR@5': '0.0321', 'NDCG@5': '0.0207', 'HR@10': '0.0537', 'NDCG@10': '0.0276', 'HR@20': '0.0865', 'NDCG@20': '0.0358'}
2025-03-07 17:33:27,570 - EarlyStopping counter: 3 out of 10
2025-03-07 17:34:09,827 - {'epoch': 64, 'rec_loss': '7.4312'}
2025-03-07 17:34:27,218 - {'Epoch': 64, 'HR@5': '0.0328', 'NDCG@5': '0.0210', 'HR@10': '0.0539', 'NDCG@10': '0.0278', 'HR@20': '0.0864', 'NDCG@20': '0.0360'}
2025-03-07 17:34:27,222 - EarlyStopping counter: 4 out of 10
2025-03-07 17:34:57,123 - {'epoch': 65, 'rec_loss': '7.4292'}
2025-03-07 17:35:15,396 - {'Epoch': 65, 'HR@5': '0.0320', 'NDCG@5': '0.0204', 'HR@10': '0.0537', 'NDCG@10': '0.0274', 'HR@20': '0.0870', 'NDCG@20': '0.0358'}
2025-03-07 17:35:15,399 - EarlyStopping counter: 5 out of 10
2025-03-07 17:35:53,632 - {'epoch': 66, 'rec_loss': '7.4253'}
2025-03-07 17:36:14,163 - {'Epoch': 66, 'HR@5': '0.0325', 'NDCG@5': '0.0204', 'HR@10': '0.0534', 'NDCG@10': '0.0271', 'HR@20': '0.0852', 'NDCG@20': '0.0351'}
2025-03-07 17:36:14,186 - EarlyStopping counter: 6 out of 10
2025-03-07 17:37:00,208 - {'epoch': 67, 'rec_loss': '7.4250'}
2025-03-07 17:37:21,534 - {'Epoch': 67, 'HR@5': '0.0326', 'NDCG@5': '0.0206', 'HR@10': '0.0540', 'NDCG@10': '0.0275', 'HR@20': '0.0866', 'NDCG@20': '0.0357'}
2025-03-07 17:37:21,543 - EarlyStopping counter: 7 out of 10
2025-03-07 17:38:04,841 - {'epoch': 68, 'rec_loss': '7.4109'}
2025-03-07 17:38:24,276 - {'Epoch': 68, 'HR@5': '0.0321', 'NDCG@5': '0.0206', 'HR@10': '0.0539', 'NDCG@10': '0.0276', 'HR@20': '0.0860', 'NDCG@20': '0.0356'}
2025-03-07 17:38:24,279 - EarlyStopping counter: 8 out of 10
2025-03-07 17:39:05,715 - {'epoch': 69, 'rec_loss': '7.4137'}
2025-03-07 17:39:23,307 - {'Epoch': 69, 'HR@5': '0.0324', 'NDCG@5': '0.0206', 'HR@10': '0.0530', 'NDCG@10': '0.0271', 'HR@20': '0.0862', 'NDCG@20': '0.0355'}
2025-03-07 17:39:23,308 - EarlyStopping counter: 9 out of 10
2025-03-07 17:39:58,648 - {'epoch': 70, 'rec_loss': '7.4126'}
2025-03-07 17:40:19,043 - {'Epoch': 70, 'HR@5': '0.0323', 'NDCG@5': '0.0205', 'HR@10': '0.0539', 'NDCG@10': '0.0274', 'HR@20': '0.0859', 'NDCG@20': '0.0354'}
2025-03-07 17:40:19,045 - EarlyStopping counter: 10 out of 10
2025-03-07 17:40:19,046 - Early stopping
2025-03-07 17:40:19,046 - ---------------Test Score---------------
2025-03-07 17:40:40,386 - {'Epoch': 0, 'HR@5': '0.0306', 'NDCG@5': '0.0193', 'HR@10': '0.0515', 'NDCG@10': '0.0261', 'HR@20': '0.0806', 'NDCG@20': '0.0334'}
2025-03-07 17:40:40,391 - Scale_Yelp
2025-03-07 17:40:40,391 - {'Epoch': 0, 'HR@5': '0.0306', 'NDCG@5': '0.0193', 'HR@10': '0.0515', 'NDCG@10': '0.0261', 'HR@20': '0.0806', 'NDCG@20': '0.0334'}
2025-03-07 19:36:46,888 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25], kernels=[4, 8, 12], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-07 19:36:50,752 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-07 19:36:50,757 - Total Parameters: 1437093
2025-03-07 19:37:31,931 - {'epoch': 0, 'rec_loss': '9.5939'}
2025-03-07 19:37:51,322 - {'Epoch': 0, 'HR@5': '0.0075', 'NDCG@5': '0.0050', 'HR@10': '0.0127', 'NDCG@10': '0.0066', 'HR@20': '0.0202', 'NDCG@20': '0.0085'}
2025-03-07 19:37:51,327 - Validation score increased.  Saving model ...
2025-03-07 19:38:29,534 - {'epoch': 1, 'rec_loss': '9.2646'}
2025-03-07 19:38:49,045 - {'Epoch': 1, 'HR@5': '0.0110', 'NDCG@5': '0.0070', 'HR@10': '0.0184', 'NDCG@10': '0.0094', 'HR@20': '0.0312', 'NDCG@20': '0.0126'}
2025-03-07 19:38:49,049 - Validation score increased.  Saving model ...
2025-03-07 19:39:20,876 - {'epoch': 2, 'rec_loss': '8.9091'}
2025-03-07 19:39:38,854 - {'Epoch': 2, 'HR@5': '0.0142', 'NDCG@5': '0.0088', 'HR@10': '0.0237', 'NDCG@10': '0.0118', 'HR@20': '0.0385', 'NDCG@20': '0.0155'}
2025-03-07 19:39:38,855 - Validation score increased.  Saving model ...
2025-03-07 19:40:13,805 - {'epoch': 3, 'rec_loss': '8.6482'}
2025-03-07 19:40:32,615 - {'Epoch': 3, 'HR@5': '0.0178', 'NDCG@5': '0.0110', 'HR@10': '0.0311', 'NDCG@10': '0.0153', 'HR@20': '0.0503', 'NDCG@20': '0.0201'}
2025-03-07 19:40:32,618 - Validation score increased.  Saving model ...
2025-03-07 19:41:11,126 - {'epoch': 4, 'rec_loss': '8.4553'}
2025-03-07 19:41:29,899 - {'Epoch': 4, 'HR@5': '0.0193', 'NDCG@5': '0.0116', 'HR@10': '0.0325', 'NDCG@10': '0.0159', 'HR@20': '0.0543', 'NDCG@20': '0.0213'}
2025-03-07 19:41:29,901 - Validation score increased.  Saving model ...
2025-03-07 19:42:08,666 - {'epoch': 5, 'rec_loss': '8.3072'}
2025-03-07 19:42:27,168 - {'Epoch': 5, 'HR@5': '0.0214', 'NDCG@5': '0.0130', 'HR@10': '0.0354', 'NDCG@10': '0.0175', 'HR@20': '0.0582', 'NDCG@20': '0.0232'}
2025-03-07 19:42:27,173 - Validation score increased.  Saving model ...
2025-03-07 19:43:05,350 - {'epoch': 6, 'rec_loss': '8.2022'}
2025-03-07 19:43:23,434 - {'Epoch': 6, 'HR@5': '0.0212', 'NDCG@5': '0.0130', 'HR@10': '0.0378', 'NDCG@10': '0.0184', 'HR@20': '0.0629', 'NDCG@20': '0.0247'}
2025-03-07 19:43:23,436 - Validation score increased.  Saving model ...
2025-03-07 19:43:56,766 - {'epoch': 7, 'rec_loss': '8.1200'}
2025-03-07 19:44:13,662 - {'Epoch': 7, 'HR@5': '0.0220', 'NDCG@5': '0.0136', 'HR@10': '0.0397', 'NDCG@10': '0.0193', 'HR@20': '0.0672', 'NDCG@20': '0.0261'}
2025-03-07 19:44:13,664 - Validation score increased.  Saving model ...
2025-03-07 19:44:51,642 - {'epoch': 8, 'rec_loss': '8.0455'}
2025-03-07 19:45:10,105 - {'Epoch': 8, 'HR@5': '0.0244', 'NDCG@5': '0.0151', 'HR@10': '0.0424', 'NDCG@10': '0.0208', 'HR@20': '0.0709', 'NDCG@20': '0.0280'}
2025-03-07 19:45:10,112 - Validation score increased.  Saving model ...
2025-03-07 19:45:48,245 - {'epoch': 9, 'rec_loss': '7.9973'}
2025-03-07 19:46:06,963 - {'Epoch': 9, 'HR@5': '0.0246', 'NDCG@5': '0.0155', 'HR@10': '0.0433', 'NDCG@10': '0.0215', 'HR@20': '0.0726', 'NDCG@20': '0.0288'}
2025-03-07 19:46:06,965 - Validation score increased.  Saving model ...
2025-03-07 19:46:44,491 - {'epoch': 10, 'rec_loss': '7.9493'}
2025-03-07 19:47:03,695 - {'Epoch': 10, 'HR@5': '0.0251', 'NDCG@5': '0.0159', 'HR@10': '0.0446', 'NDCG@10': '0.0222', 'HR@20': '0.0736', 'NDCG@20': '0.0295'}
2025-03-07 19:47:03,697 - Validation score increased.  Saving model ...
2025-03-07 19:47:41,237 - {'epoch': 11, 'rec_loss': '7.9029'}
2025-03-07 19:47:57,899 - {'Epoch': 11, 'HR@5': '0.0257', 'NDCG@5': '0.0162', 'HR@10': '0.0455', 'NDCG@10': '0.0225', 'HR@20': '0.0733', 'NDCG@20': '0.0295'}
2025-03-07 19:47:57,901 - Validation score increased.  Saving model ...
2025-03-07 19:48:29,039 - {'epoch': 12, 'rec_loss': '7.8692'}
2025-03-07 19:48:47,548 - {'Epoch': 12, 'HR@5': '0.0261', 'NDCG@5': '0.0162', 'HR@10': '0.0453', 'NDCG@10': '0.0224', 'HR@20': '0.0770', 'NDCG@20': '0.0303'}
2025-03-07 19:48:47,552 - Validation score increased.  Saving model ...
2025-03-07 19:49:28,029 - {'epoch': 13, 'rec_loss': '7.8413'}
2025-03-07 19:49:46,710 - {'Epoch': 13, 'HR@5': '0.0280', 'NDCG@5': '0.0176', 'HR@10': '0.0471', 'NDCG@10': '0.0237', 'HR@20': '0.0759', 'NDCG@20': '0.0309'}
2025-03-07 19:49:46,715 - Validation score increased.  Saving model ...
2025-03-07 19:50:24,968 - {'epoch': 14, 'rec_loss': '7.8077'}
2025-03-07 19:50:44,315 - {'Epoch': 14, 'HR@5': '0.0291', 'NDCG@5': '0.0185', 'HR@10': '0.0493', 'NDCG@10': '0.0249', 'HR@20': '0.0798', 'NDCG@20': '0.0326'}
2025-03-07 19:50:44,317 - Validation score increased.  Saving model ...
2025-03-07 19:51:25,085 - {'epoch': 15, 'rec_loss': '7.7820'}
2025-03-07 19:51:43,859 - {'Epoch': 15, 'HR@5': '0.0287', 'NDCG@5': '0.0179', 'HR@10': '0.0489', 'NDCG@10': '0.0243', 'HR@20': '0.0797', 'NDCG@20': '0.0321'}
2025-03-07 19:51:43,863 - EarlyStopping counter: 1 out of 10
2025-03-07 19:52:17,673 - {'epoch': 16, 'rec_loss': '7.7614'}
2025-03-07 19:52:34,591 - {'Epoch': 16, 'HR@5': '0.0286', 'NDCG@5': '0.0179', 'HR@10': '0.0499', 'NDCG@10': '0.0247', 'HR@20': '0.0806', 'NDCG@20': '0.0324'}
2025-03-07 19:52:34,596 - EarlyStopping counter: 2 out of 10
2025-03-07 19:53:09,581 - {'epoch': 17, 'rec_loss': '7.7343'}
2025-03-07 19:53:28,738 - {'Epoch': 17, 'HR@5': '0.0290', 'NDCG@5': '0.0181', 'HR@10': '0.0506', 'NDCG@10': '0.0250', 'HR@20': '0.0823', 'NDCG@20': '0.0330'}
2025-03-07 19:53:28,740 - Validation score increased.  Saving model ...
2025-03-07 19:54:09,271 - {'epoch': 18, 'rec_loss': '7.7154'}
2025-03-07 19:54:28,705 - {'Epoch': 18, 'HR@5': '0.0308', 'NDCG@5': '0.0188', 'HR@10': '0.0504', 'NDCG@10': '0.0252', 'HR@20': '0.0814', 'NDCG@20': '0.0330'}
2025-03-07 19:54:28,709 - EarlyStopping counter: 1 out of 10
2025-03-07 19:55:09,896 - {'epoch': 19, 'rec_loss': '7.7004'}
2025-03-07 19:55:29,075 - {'Epoch': 19, 'HR@5': '0.0306', 'NDCG@5': '0.0194', 'HR@10': '0.0497', 'NDCG@10': '0.0256', 'HR@20': '0.0823', 'NDCG@20': '0.0338'}
2025-03-07 19:55:29,080 - Validation score increased.  Saving model ...
2025-03-07 19:56:07,583 - {'epoch': 20, 'rec_loss': '7.6838'}
2025-03-07 19:56:27,004 - {'Epoch': 20, 'HR@5': '0.0295', 'NDCG@5': '0.0184', 'HR@10': '0.0518', 'NDCG@10': '0.0256', 'HR@20': '0.0834', 'NDCG@20': '0.0335'}
2025-03-07 19:56:27,007 - EarlyStopping counter: 1 out of 10
2025-03-07 19:56:58,616 - {'epoch': 21, 'rec_loss': '7.6694'}
2025-03-07 19:57:15,896 - {'Epoch': 21, 'HR@5': '0.0304', 'NDCG@5': '0.0191', 'HR@10': '0.0508', 'NDCG@10': '0.0257', 'HR@20': '0.0834', 'NDCG@20': '0.0338'}
2025-03-07 19:57:15,900 - Validation score increased.  Saving model ...
2025-03-07 19:57:55,424 - {'epoch': 22, 'rec_loss': '7.6487'}
2025-03-07 19:58:14,340 - {'Epoch': 22, 'HR@5': '0.0306', 'NDCG@5': '0.0192', 'HR@10': '0.0516', 'NDCG@10': '0.0260', 'HR@20': '0.0839', 'NDCG@20': '0.0341'}
2025-03-07 19:58:14,349 - Validation score increased.  Saving model ...
2025-03-07 19:58:54,001 - {'epoch': 23, 'rec_loss': '7.6398'}
2025-03-07 19:59:12,775 - {'Epoch': 23, 'HR@5': '0.0312', 'NDCG@5': '0.0198', 'HR@10': '0.0519', 'NDCG@10': '0.0264', 'HR@20': '0.0833', 'NDCG@20': '0.0343'}
2025-03-07 19:59:12,777 - Validation score increased.  Saving model ...
2025-03-07 19:59:52,660 - {'epoch': 24, 'rec_loss': '7.6195'}
2025-03-07 20:00:11,192 - {'Epoch': 24, 'HR@5': '0.0307', 'NDCG@5': '0.0193', 'HR@10': '0.0516', 'NDCG@10': '0.0260', 'HR@20': '0.0839', 'NDCG@20': '0.0342'}
2025-03-07 20:00:11,195 - EarlyStopping counter: 1 out of 10
2025-03-07 20:00:50,924 - {'epoch': 25, 'rec_loss': '7.6112'}
2025-03-07 20:01:07,457 - {'Epoch': 25, 'HR@5': '0.0314', 'NDCG@5': '0.0199', 'HR@10': '0.0521', 'NDCG@10': '0.0266', 'HR@20': '0.0855', 'NDCG@20': '0.0349'}
2025-03-07 20:01:07,459 - Validation score increased.  Saving model ...
2025-03-07 20:01:39,796 - {'epoch': 26, 'rec_loss': '7.6041'}
2025-03-07 20:01:58,240 - {'Epoch': 26, 'HR@5': '0.0322', 'NDCG@5': '0.0203', 'HR@10': '0.0523', 'NDCG@10': '0.0268', 'HR@20': '0.0836', 'NDCG@20': '0.0347'}
2025-03-07 20:01:58,243 - EarlyStopping counter: 1 out of 10
2025-03-07 20:02:35,599 - {'epoch': 27, 'rec_loss': '7.5925'}
2025-03-07 20:02:54,909 - {'Epoch': 27, 'HR@5': '0.0313', 'NDCG@5': '0.0194', 'HR@10': '0.0523', 'NDCG@10': '0.0261', 'HR@20': '0.0849', 'NDCG@20': '0.0343'}
2025-03-07 20:02:54,911 - EarlyStopping counter: 2 out of 10
2025-03-07 20:03:33,678 - {'epoch': 28, 'rec_loss': '7.5869'}
2025-03-07 20:03:52,682 - {'Epoch': 28, 'HR@5': '0.0322', 'NDCG@5': '0.0205', 'HR@10': '0.0534', 'NDCG@10': '0.0273', 'HR@20': '0.0844', 'NDCG@20': '0.0350'}
2025-03-07 20:03:52,685 - Validation score increased.  Saving model ...
2025-03-07 20:04:34,177 - {'epoch': 29, 'rec_loss': '7.5753'}
2025-03-07 20:04:53,783 - {'Epoch': 29, 'HR@5': '0.0312', 'NDCG@5': '0.0198', 'HR@10': '0.0522', 'NDCG@10': '0.0265', 'HR@20': '0.0832', 'NDCG@20': '0.0343'}
2025-03-07 20:04:53,785 - EarlyStopping counter: 1 out of 10
2025-03-07 20:05:27,791 - {'epoch': 30, 'rec_loss': '7.5609'}
2025-03-07 20:05:44,776 - {'Epoch': 30, 'HR@5': '0.0313', 'NDCG@5': '0.0196', 'HR@10': '0.0526', 'NDCG@10': '0.0264', 'HR@20': '0.0835', 'NDCG@20': '0.0342'}
2025-03-07 20:05:44,778 - EarlyStopping counter: 2 out of 10
2025-03-07 20:06:21,662 - {'epoch': 31, 'rec_loss': '7.5581'}
2025-03-07 20:06:40,830 - {'Epoch': 31, 'HR@5': '0.0323', 'NDCG@5': '0.0203', 'HR@10': '0.0537', 'NDCG@10': '0.0272', 'HR@20': '0.0850', 'NDCG@20': '0.0350'}
2025-03-07 20:06:40,832 - EarlyStopping counter: 3 out of 10
2025-03-07 20:07:18,790 - {'epoch': 32, 'rec_loss': '7.5586'}
2025-03-07 20:07:37,497 - {'Epoch': 32, 'HR@5': '0.0320', 'NDCG@5': '0.0198', 'HR@10': '0.0536', 'NDCG@10': '0.0267', 'HR@20': '0.0855', 'NDCG@20': '0.0348'}
2025-03-07 20:07:37,502 - EarlyStopping counter: 4 out of 10
2025-03-07 20:08:15,310 - {'epoch': 33, 'rec_loss': '7.5414'}
2025-03-07 20:08:34,454 - {'Epoch': 33, 'HR@5': '0.0331', 'NDCG@5': '0.0208', 'HR@10': '0.0538', 'NDCG@10': '0.0274', 'HR@20': '0.0848', 'NDCG@20': '0.0352'}
2025-03-07 20:08:34,456 - Validation score increased.  Saving model ...
2025-03-07 20:09:14,536 - {'epoch': 34, 'rec_loss': '7.5322'}
2025-03-07 20:09:31,756 - {'Epoch': 34, 'HR@5': '0.0326', 'NDCG@5': '0.0204', 'HR@10': '0.0532', 'NDCG@10': '0.0270', 'HR@20': '0.0857', 'NDCG@20': '0.0352'}
2025-03-07 20:09:31,759 - EarlyStopping counter: 1 out of 10
2025-03-07 20:10:03,658 - {'epoch': 35, 'rec_loss': '7.5319'}
2025-03-07 20:10:21,515 - {'Epoch': 35, 'HR@5': '0.0323', 'NDCG@5': '0.0200', 'HR@10': '0.0540', 'NDCG@10': '0.0270', 'HR@20': '0.0853', 'NDCG@20': '0.0348'}
2025-03-07 20:10:21,517 - EarlyStopping counter: 2 out of 10
2025-03-07 20:11:00,321 - {'epoch': 36, 'rec_loss': '7.5275'}
2025-03-07 20:11:19,582 - {'Epoch': 36, 'HR@5': '0.0328', 'NDCG@5': '0.0202', 'HR@10': '0.0541', 'NDCG@10': '0.0270', 'HR@20': '0.0853', 'NDCG@20': '0.0349'}
2025-03-07 20:11:19,587 - EarlyStopping counter: 3 out of 10
2025-03-07 20:11:56,163 - {'epoch': 37, 'rec_loss': '7.5250'}
2025-03-07 20:12:15,444 - {'Epoch': 37, 'HR@5': '0.0321', 'NDCG@5': '0.0200', 'HR@10': '0.0528', 'NDCG@10': '0.0267', 'HR@20': '0.0855', 'NDCG@20': '0.0349'}
2025-03-07 20:12:15,449 - EarlyStopping counter: 4 out of 10
2025-03-07 20:12:54,361 - {'epoch': 38, 'rec_loss': '7.5124'}
2025-03-07 20:13:13,675 - {'Epoch': 38, 'HR@5': '0.0323', 'NDCG@5': '0.0203', 'HR@10': '0.0536', 'NDCG@10': '0.0272', 'HR@20': '0.0856', 'NDCG@20': '0.0353'}
2025-03-07 20:13:13,677 - Validation score increased.  Saving model ...
2025-03-07 20:13:49,520 - {'epoch': 39, 'rec_loss': '7.5080'}
2025-03-07 20:14:07,278 - {'Epoch': 39, 'HR@5': '0.0325', 'NDCG@5': '0.0205', 'HR@10': '0.0542', 'NDCG@10': '0.0274', 'HR@20': '0.0877', 'NDCG@20': '0.0358'}
2025-03-07 20:14:07,289 - Validation score increased.  Saving model ...
2025-03-07 20:14:42,167 - {'epoch': 40, 'rec_loss': '7.5000'}
2025-03-07 20:15:02,797 - {'Epoch': 40, 'HR@5': '0.0325', 'NDCG@5': '0.0207', 'HR@10': '0.0550', 'NDCG@10': '0.0280', 'HR@20': '0.0858', 'NDCG@20': '0.0357'}
2025-03-07 20:15:02,799 - EarlyStopping counter: 1 out of 10
2025-03-07 20:15:41,502 - {'epoch': 41, 'rec_loss': '7.5015'}
2025-03-07 20:16:00,608 - {'Epoch': 41, 'HR@5': '0.0333', 'NDCG@5': '0.0207', 'HR@10': '0.0544', 'NDCG@10': '0.0275', 'HR@20': '0.0852', 'NDCG@20': '0.0352'}
2025-03-07 20:16:00,612 - EarlyStopping counter: 2 out of 10
2025-03-07 20:16:37,438 - {'epoch': 42, 'rec_loss': '7.4899'}
2025-03-07 20:16:57,785 - {'Epoch': 42, 'HR@5': '0.0329', 'NDCG@5': '0.0204', 'HR@10': '0.0527', 'NDCG@10': '0.0267', 'HR@20': '0.0860', 'NDCG@20': '0.0351'}
2025-03-07 20:16:57,787 - EarlyStopping counter: 3 out of 10
2025-03-07 20:17:38,379 - {'epoch': 43, 'rec_loss': '7.4908'}
2025-03-07 20:17:56,798 - {'Epoch': 43, 'HR@5': '0.0313', 'NDCG@5': '0.0195', 'HR@10': '0.0528', 'NDCG@10': '0.0264', 'HR@20': '0.0847', 'NDCG@20': '0.0344'}
2025-03-07 20:17:56,800 - EarlyStopping counter: 4 out of 10
2025-03-07 20:18:28,273 - {'epoch': 44, 'rec_loss': '7.4890'}
2025-03-07 20:18:45,585 - {'Epoch': 44, 'HR@5': '0.0326', 'NDCG@5': '0.0206', 'HR@10': '0.0538', 'NDCG@10': '0.0274', 'HR@20': '0.0865', 'NDCG@20': '0.0356'}
2025-03-07 20:18:45,587 - EarlyStopping counter: 5 out of 10
2025-03-07 20:19:24,374 - {'epoch': 45, 'rec_loss': '7.4802'}
2025-03-07 20:19:43,300 - {'Epoch': 45, 'HR@5': '0.0324', 'NDCG@5': '0.0201', 'HR@10': '0.0542', 'NDCG@10': '0.0271', 'HR@20': '0.0840', 'NDCG@20': '0.0346'}
2025-03-07 20:19:43,302 - EarlyStopping counter: 6 out of 10
2025-03-07 20:20:20,621 - {'epoch': 46, 'rec_loss': '7.4730'}
2025-03-07 20:20:39,360 - {'Epoch': 46, 'HR@5': '0.0313', 'NDCG@5': '0.0199', 'HR@10': '0.0538', 'NDCG@10': '0.0271', 'HR@20': '0.0852', 'NDCG@20': '0.0351'}
2025-03-07 20:20:39,361 - EarlyStopping counter: 7 out of 10
2025-03-07 20:21:16,725 - {'epoch': 47, 'rec_loss': '7.4601'}
2025-03-07 20:21:35,845 - {'Epoch': 47, 'HR@5': '0.0324', 'NDCG@5': '0.0202', 'HR@10': '0.0536', 'NDCG@10': '0.0270', 'HR@20': '0.0856', 'NDCG@20': '0.0351'}
2025-03-07 20:21:35,847 - EarlyStopping counter: 8 out of 10
2025-03-07 20:22:12,981 - {'epoch': 48, 'rec_loss': '7.4721'}
2025-03-07 20:22:30,448 - {'Epoch': 48, 'HR@5': '0.0330', 'NDCG@5': '0.0210', 'HR@10': '0.0545', 'NDCG@10': '0.0279', 'HR@20': '0.0854', 'NDCG@20': '0.0357'}
2025-03-07 20:22:30,452 - EarlyStopping counter: 9 out of 10
2025-03-07 20:23:03,693 - {'epoch': 49, 'rec_loss': '7.4616'}
2025-03-07 20:23:22,490 - {'Epoch': 49, 'HR@5': '0.0325', 'NDCG@5': '0.0206', 'HR@10': '0.0540', 'NDCG@10': '0.0275', 'HR@20': '0.0853', 'NDCG@20': '0.0354'}
2025-03-07 20:23:22,496 - EarlyStopping counter: 10 out of 10
2025-03-07 20:23:22,496 - Early stopping
2025-03-07 20:23:22,496 - ---------------Test Score---------------
2025-03-07 20:23:41,644 - {'Epoch': 0, 'HR@5': '0.0294', 'NDCG@5': '0.0186', 'HR@10': '0.0494', 'NDCG@10': '0.0250', 'HR@20': '0.0785', 'NDCG@20': '0.0323'}
2025-03-07 20:23:41,655 - Scale_Yelp
2025-03-07 20:23:41,655 - {'Epoch': 0, 'HR@5': '0.0294', 'NDCG@5': '0.0186', 'HR@10': '0.0494', 'NDCG@10': '0.0250', 'HR@20': '0.0785', 'NDCG@20': '0.0323'}
2025-03-07 20:31:34,685 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-07 20:31:38,349 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=50, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-07 20:31:38,355 - Total Parameters: 1438718
2025-03-07 20:32:15,961 - {'epoch': 0, 'rec_loss': '9.5908'}
2025-03-07 20:32:35,266 - {'Epoch': 0, 'HR@5': '0.0079', 'NDCG@5': '0.0051', 'HR@10': '0.0134', 'NDCG@10': '0.0068', 'HR@20': '0.0223', 'NDCG@20': '0.0091'}
2025-03-07 20:32:35,267 - Validation score increased.  Saving model ...
2025-03-07 20:33:11,288 - {'epoch': 1, 'rec_loss': '9.2475'}
2025-03-07 20:33:30,759 - {'Epoch': 1, 'HR@5': '0.0106', 'NDCG@5': '0.0070', 'HR@10': '0.0185', 'NDCG@10': '0.0095', 'HR@20': '0.0314', 'NDCG@20': '0.0127'}
2025-03-07 20:33:30,762 - Validation score increased.  Saving model ...
2025-03-07 20:34:05,111 - {'epoch': 2, 'rec_loss': '8.8953'}
2025-03-07 20:34:21,421 - {'Epoch': 2, 'HR@5': '0.0131', 'NDCG@5': '0.0081', 'HR@10': '0.0231', 'NDCG@10': '0.0112', 'HR@20': '0.0372', 'NDCG@20': '0.0148'}
2025-03-07 20:34:21,425 - Validation score increased.  Saving model ...
2025-03-07 20:34:50,526 - {'epoch': 3, 'rec_loss': '8.6631'}
2025-03-07 20:35:08,396 - {'Epoch': 3, 'HR@5': '0.0162', 'NDCG@5': '0.0101', 'HR@10': '0.0297', 'NDCG@10': '0.0144', 'HR@20': '0.0484', 'NDCG@20': '0.0191'}
2025-03-07 20:35:08,398 - Validation score increased.  Saving model ...
2025-03-07 20:35:44,810 - {'epoch': 4, 'rec_loss': '8.4673'}
2025-03-07 20:36:03,128 - {'Epoch': 4, 'HR@5': '0.0182', 'NDCG@5': '0.0112', 'HR@10': '0.0314', 'NDCG@10': '0.0154', 'HR@20': '0.0542', 'NDCG@20': '0.0211'}
2025-03-07 20:36:03,137 - Validation score increased.  Saving model ...
2025-03-07 20:36:39,184 - {'epoch': 5, 'rec_loss': '8.3171'}
2025-03-07 20:36:57,846 - {'Epoch': 5, 'HR@5': '0.0195', 'NDCG@5': '0.0122', 'HR@10': '0.0340', 'NDCG@10': '0.0168', 'HR@20': '0.0591', 'NDCG@20': '0.0231'}
2025-03-07 20:36:57,848 - Validation score increased.  Saving model ...
2025-03-07 20:37:34,841 - {'epoch': 6, 'rec_loss': '8.2079'}
2025-03-07 20:37:53,245 - {'Epoch': 6, 'HR@5': '0.0215', 'NDCG@5': '0.0132', 'HR@10': '0.0381', 'NDCG@10': '0.0186', 'HR@20': '0.0634', 'NDCG@20': '0.0249'}
2025-03-07 20:37:53,256 - Validation score increased.  Saving model ...
2025-03-07 20:38:28,260 - {'epoch': 7, 'rec_loss': '8.1277'}
2025-03-07 20:38:44,974 - {'Epoch': 7, 'HR@5': '0.0228', 'NDCG@5': '0.0144', 'HR@10': '0.0395', 'NDCG@10': '0.0198', 'HR@20': '0.0655', 'NDCG@20': '0.0263'}
2025-03-07 20:38:44,978 - Validation score increased.  Saving model ...
2025-03-07 20:39:12,867 - {'epoch': 8, 'rec_loss': '8.0650'}
2025-03-07 20:39:30,192 - {'Epoch': 8, 'HR@5': '0.0254', 'NDCG@5': '0.0157', 'HR@10': '0.0428', 'NDCG@10': '0.0213', 'HR@20': '0.0685', 'NDCG@20': '0.0278'}
2025-03-07 20:39:30,198 - Validation score increased.  Saving model ...
2025-03-07 20:40:05,775 - {'epoch': 9, 'rec_loss': '8.0076'}
2025-03-07 20:40:24,232 - {'Epoch': 9, 'HR@5': '0.0248', 'NDCG@5': '0.0158', 'HR@10': '0.0427', 'NDCG@10': '0.0215', 'HR@20': '0.0716', 'NDCG@20': '0.0287'}
2025-03-07 20:40:24,234 - Validation score increased.  Saving model ...
2025-03-07 20:40:59,528 - {'epoch': 10, 'rec_loss': '7.9573'}
2025-03-07 20:41:18,334 - {'Epoch': 10, 'HR@5': '0.0264', 'NDCG@5': '0.0165', 'HR@10': '0.0433', 'NDCG@10': '0.0219', 'HR@20': '0.0725', 'NDCG@20': '0.0292'}
2025-03-07 20:41:18,339 - Validation score increased.  Saving model ...
2025-03-07 20:41:53,966 - {'epoch': 11, 'rec_loss': '7.9121'}
2025-03-07 20:42:12,751 - {'Epoch': 11, 'HR@5': '0.0268', 'NDCG@5': '0.0167', 'HR@10': '0.0467', 'NDCG@10': '0.0231', 'HR@20': '0.0759', 'NDCG@20': '0.0304'}
2025-03-07 20:42:12,760 - Validation score increased.  Saving model ...
2025-03-07 20:42:49,596 - {'epoch': 12, 'rec_loss': '7.8773'}
2025-03-07 20:43:06,627 - {'Epoch': 12, 'HR@5': '0.0274', 'NDCG@5': '0.0174', 'HR@10': '0.0474', 'NDCG@10': '0.0239', 'HR@20': '0.0764', 'NDCG@20': '0.0312'}
2025-03-07 20:43:06,628 - Validation score increased.  Saving model ...
2025-03-07 20:43:35,582 - {'epoch': 13, 'rec_loss': '7.8444'}
2025-03-07 20:43:52,998 - {'Epoch': 13, 'HR@5': '0.0273', 'NDCG@5': '0.0172', 'HR@10': '0.0476', 'NDCG@10': '0.0237', 'HR@20': '0.0787', 'NDCG@20': '0.0315'}
2025-03-07 20:43:53,000 - Validation score increased.  Saving model ...
2025-03-07 20:44:32,546 - {'epoch': 14, 'rec_loss': '7.8053'}
2025-03-07 20:44:51,977 - {'Epoch': 14, 'HR@5': '0.0293', 'NDCG@5': '0.0182', 'HR@10': '0.0487', 'NDCG@10': '0.0244', 'HR@20': '0.0790', 'NDCG@20': '0.0320'}
2025-03-07 20:44:51,984 - Validation score increased.  Saving model ...
2025-03-07 20:45:32,249 - {'epoch': 15, 'rec_loss': '7.7803'}
2025-03-07 20:45:52,787 - {'Epoch': 15, 'HR@5': '0.0285', 'NDCG@5': '0.0179', 'HR@10': '0.0495', 'NDCG@10': '0.0246', 'HR@20': '0.0795', 'NDCG@20': '0.0321'}
2025-03-07 20:45:52,790 - Validation score increased.  Saving model ...
2025-03-07 20:46:32,363 - {'epoch': 16, 'rec_loss': '7.7577'}
2025-03-07 20:46:51,731 - {'Epoch': 16, 'HR@5': '0.0293', 'NDCG@5': '0.0184', 'HR@10': '0.0498', 'NDCG@10': '0.0250', 'HR@20': '0.0804', 'NDCG@20': '0.0327'}
2025-03-07 20:46:51,733 - Validation score increased.  Saving model ...
2025-03-07 20:47:26,062 - {'epoch': 17, 'rec_loss': '7.7421'}
2025-03-07 20:47:42,646 - {'Epoch': 17, 'HR@5': '0.0303', 'NDCG@5': '0.0188', 'HR@10': '0.0505', 'NDCG@10': '0.0253', 'HR@20': '0.0835', 'NDCG@20': '0.0336'}
2025-03-07 20:47:42,651 - Validation score increased.  Saving model ...
2025-03-07 20:48:16,762 - {'epoch': 18, 'rec_loss': '7.7150'}
2025-03-07 20:48:36,264 - {'Epoch': 18, 'HR@5': '0.0294', 'NDCG@5': '0.0190', 'HR@10': '0.0505', 'NDCG@10': '0.0257', 'HR@20': '0.0822', 'NDCG@20': '0.0337'}
2025-03-07 20:48:36,270 - Validation score increased.  Saving model ...
2025-03-07 20:49:13,427 - {'epoch': 19, 'rec_loss': '7.7002'}
2025-03-07 20:49:32,463 - {'Epoch': 19, 'HR@5': '0.0305', 'NDCG@5': '0.0191', 'HR@10': '0.0517', 'NDCG@10': '0.0259', 'HR@20': '0.0834', 'NDCG@20': '0.0338'}
2025-03-07 20:49:32,473 - Validation score increased.  Saving model ...
2025-03-07 20:50:09,992 - {'epoch': 20, 'rec_loss': '7.6827'}
2025-03-07 20:50:29,224 - {'Epoch': 20, 'HR@5': '0.0313', 'NDCG@5': '0.0198', 'HR@10': '0.0526', 'NDCG@10': '0.0266', 'HR@20': '0.0834', 'NDCG@20': '0.0343'}
2025-03-07 20:50:29,231 - Validation score increased.  Saving model ...
2025-03-07 20:51:06,860 - {'epoch': 21, 'rec_loss': '7.6728'}
2025-03-07 20:51:27,135 - {'Epoch': 21, 'HR@5': '0.0309', 'NDCG@5': '0.0195', 'HR@10': '0.0520', 'NDCG@10': '0.0262', 'HR@20': '0.0844', 'NDCG@20': '0.0343'}
2025-03-07 20:51:27,137 - EarlyStopping counter: 1 out of 10
2025-03-07 20:52:01,156 - {'epoch': 22, 'rec_loss': '7.6533'}
2025-03-07 20:52:18,646 - {'Epoch': 22, 'HR@5': '0.0316', 'NDCG@5': '0.0191', 'HR@10': '0.0518', 'NDCG@10': '0.0256', 'HR@20': '0.0835', 'NDCG@20': '0.0336'}
2025-03-07 20:52:18,652 - EarlyStopping counter: 2 out of 10
2025-03-07 20:52:56,806 - {'epoch': 23, 'rec_loss': '7.6445'}
2025-03-07 20:53:16,951 - {'Epoch': 23, 'HR@5': '0.0317', 'NDCG@5': '0.0195', 'HR@10': '0.0527', 'NDCG@10': '0.0262', 'HR@20': '0.0838', 'NDCG@20': '0.0340'}
2025-03-07 20:53:16,963 - EarlyStopping counter: 3 out of 10
2025-03-07 20:53:55,636 - {'epoch': 24, 'rec_loss': '7.6274'}
2025-03-07 20:54:14,811 - {'Epoch': 24, 'HR@5': '0.0312', 'NDCG@5': '0.0196', 'HR@10': '0.0513', 'NDCG@10': '0.0261', 'HR@20': '0.0839', 'NDCG@20': '0.0343'}
2025-03-07 20:54:14,816 - EarlyStopping counter: 4 out of 10
2025-03-07 20:54:53,177 - {'epoch': 25, 'rec_loss': '7.6218'}
2025-03-07 20:55:12,839 - {'Epoch': 25, 'HR@5': '0.0316', 'NDCG@5': '0.0195', 'HR@10': '0.0516', 'NDCG@10': '0.0259', 'HR@20': '0.0847', 'NDCG@20': '0.0343'}
2025-03-07 20:55:12,844 - EarlyStopping counter: 5 out of 10
2025-03-07 20:55:51,114 - {'epoch': 26, 'rec_loss': '7.6038'}
2025-03-07 20:56:08,127 - {'Epoch': 26, 'HR@5': '0.0313', 'NDCG@5': '0.0196', 'HR@10': '0.0517', 'NDCG@10': '0.0261', 'HR@20': '0.0846', 'NDCG@20': '0.0344'}
2025-03-07 20:56:08,131 - Validation score increased.  Saving model ...
2025-03-07 20:56:41,316 - {'epoch': 27, 'rec_loss': '7.5968'}
2025-03-07 20:57:00,033 - {'Epoch': 27, 'HR@5': '0.0309', 'NDCG@5': '0.0196', 'HR@10': '0.0530', 'NDCG@10': '0.0267', 'HR@20': '0.0836', 'NDCG@20': '0.0344'}
2025-03-07 20:57:00,041 - EarlyStopping counter: 1 out of 10
2025-03-07 20:57:38,566 - {'epoch': 28, 'rec_loss': '7.5890'}
2025-03-07 20:57:57,588 - {'Epoch': 28, 'HR@5': '0.0323', 'NDCG@5': '0.0200', 'HR@10': '0.0537', 'NDCG@10': '0.0268', 'HR@20': '0.0838', 'NDCG@20': '0.0344'}
2025-03-07 20:57:57,594 - EarlyStopping counter: 2 out of 10
2025-03-07 20:58:36,680 - {'epoch': 29, 'rec_loss': '7.5709'}
2025-03-07 20:58:56,280 - {'Epoch': 29, 'HR@5': '0.0318', 'NDCG@5': '0.0198', 'HR@10': '0.0541', 'NDCG@10': '0.0270', 'HR@20': '0.0850', 'NDCG@20': '0.0347'}
2025-03-07 20:58:56,282 - Validation score increased.  Saving model ...
2025-03-07 20:59:35,019 - {'epoch': 30, 'rec_loss': '7.5731'}
2025-03-07 20:59:54,887 - {'Epoch': 30, 'HR@5': '0.0306', 'NDCG@5': '0.0192', 'HR@10': '0.0537', 'NDCG@10': '0.0266', 'HR@20': '0.0861', 'NDCG@20': '0.0347'}
2025-03-07 20:59:54,900 - EarlyStopping counter: 1 out of 10
2025-03-07 21:00:27,742 - {'epoch': 31, 'rec_loss': '7.5631'}
2025-03-07 21:00:44,910 - {'Epoch': 31, 'HR@5': '0.0328', 'NDCG@5': '0.0203', 'HR@10': '0.0548', 'NDCG@10': '0.0274', 'HR@20': '0.0862', 'NDCG@20': '0.0353'}
2025-03-07 21:00:44,916 - Validation score increased.  Saving model ...
2025-03-07 21:01:19,781 - {'epoch': 32, 'rec_loss': '7.5621'}
2025-03-07 21:01:38,633 - {'Epoch': 32, 'HR@5': '0.0321', 'NDCG@5': '0.0203', 'HR@10': '0.0537', 'NDCG@10': '0.0272', 'HR@20': '0.0859', 'NDCG@20': '0.0354'}
2025-03-07 21:01:38,636 - Validation score increased.  Saving model ...
2025-03-07 21:02:16,556 - {'epoch': 33, 'rec_loss': '7.5449'}
2025-03-07 21:02:35,513 - {'Epoch': 33, 'HR@5': '0.0317', 'NDCG@5': '0.0200', 'HR@10': '0.0538', 'NDCG@10': '0.0271', 'HR@20': '0.0846', 'NDCG@20': '0.0348'}
2025-03-07 21:02:35,519 - EarlyStopping counter: 1 out of 10
2025-03-07 21:03:13,803 - {'epoch': 34, 'rec_loss': '7.5425'}
2025-03-07 21:03:32,871 - {'Epoch': 34, 'HR@5': '0.0324', 'NDCG@5': '0.0204', 'HR@10': '0.0538', 'NDCG@10': '0.0273', 'HR@20': '0.0850', 'NDCG@20': '0.0351'}
2025-03-07 21:03:32,874 - EarlyStopping counter: 2 out of 10
2025-03-07 21:04:10,163 - {'epoch': 35, 'rec_loss': '7.5342'}
2025-03-07 21:04:29,133 - {'Epoch': 35, 'HR@5': '0.0321', 'NDCG@5': '0.0204', 'HR@10': '0.0531', 'NDCG@10': '0.0271', 'HR@20': '0.0850', 'NDCG@20': '0.0352'}
2025-03-07 21:04:29,139 - EarlyStopping counter: 3 out of 10
2025-03-07 21:05:02,134 - {'epoch': 36, 'rec_loss': '7.5376'}
2025-03-07 21:05:19,797 - {'Epoch': 36, 'HR@5': '0.0317', 'NDCG@5': '0.0200', 'HR@10': '0.0534', 'NDCG@10': '0.0269', 'HR@20': '0.0856', 'NDCG@20': '0.0350'}
2025-03-07 21:05:19,805 - EarlyStopping counter: 4 out of 10
2025-03-07 21:05:56,528 - {'epoch': 37, 'rec_loss': '7.5249'}
2025-03-07 21:06:15,463 - {'Epoch': 37, 'HR@5': '0.0322', 'NDCG@5': '0.0203', 'HR@10': '0.0525', 'NDCG@10': '0.0269', 'HR@20': '0.0849', 'NDCG@20': '0.0350'}
2025-03-07 21:06:15,473 - EarlyStopping counter: 5 out of 10
2025-03-07 21:06:52,387 - {'epoch': 38, 'rec_loss': '7.5128'}
2025-03-07 21:07:11,065 - {'Epoch': 38, 'HR@5': '0.0328', 'NDCG@5': '0.0205', 'HR@10': '0.0538', 'NDCG@10': '0.0273', 'HR@20': '0.0853', 'NDCG@20': '0.0352'}
2025-03-07 21:07:11,067 - EarlyStopping counter: 6 out of 10
2025-03-07 21:07:47,766 - {'epoch': 39, 'rec_loss': '7.5138'}
2025-03-07 21:08:08,334 - {'Epoch': 39, 'HR@5': '0.0326', 'NDCG@5': '0.0205', 'HR@10': '0.0547', 'NDCG@10': '0.0276', 'HR@20': '0.0847', 'NDCG@20': '0.0351'}
2025-03-07 21:08:08,345 - EarlyStopping counter: 7 out of 10
2025-03-07 21:08:45,156 - {'epoch': 40, 'rec_loss': '7.5148'}
2025-03-07 21:09:02,487 - {'Epoch': 40, 'HR@5': '0.0327', 'NDCG@5': '0.0206', 'HR@10': '0.0547', 'NDCG@10': '0.0277', 'HR@20': '0.0855', 'NDCG@20': '0.0354'}
2025-03-07 21:09:02,489 - Validation score increased.  Saving model ...
2025-03-07 21:09:35,408 - {'epoch': 41, 'rec_loss': '7.5070'}
2025-03-07 21:09:54,510 - {'Epoch': 41, 'HR@5': '0.0313', 'NDCG@5': '0.0198', 'HR@10': '0.0532', 'NDCG@10': '0.0268', 'HR@20': '0.0856', 'NDCG@20': '0.0349'}
2025-03-07 21:09:54,517 - EarlyStopping counter: 1 out of 10
2025-03-07 21:10:32,221 - {'epoch': 42, 'rec_loss': '7.4999'}
2025-03-07 21:10:51,000 - {'Epoch': 42, 'HR@5': '0.0316', 'NDCG@5': '0.0202', 'HR@10': '0.0530', 'NDCG@10': '0.0271', 'HR@20': '0.0851', 'NDCG@20': '0.0351'}
2025-03-07 21:10:51,004 - EarlyStopping counter: 2 out of 10
2025-03-07 21:11:29,424 - {'epoch': 43, 'rec_loss': '7.4949'}
2025-03-07 21:11:48,150 - {'Epoch': 43, 'HR@5': '0.0313', 'NDCG@5': '0.0197', 'HR@10': '0.0526', 'NDCG@10': '0.0266', 'HR@20': '0.0846', 'NDCG@20': '0.0346'}
2025-03-07 21:11:48,152 - EarlyStopping counter: 3 out of 10
2025-03-07 21:12:26,589 - {'epoch': 44, 'rec_loss': '7.4922'}
2025-03-07 21:12:46,214 - {'Epoch': 44, 'HR@5': '0.0320', 'NDCG@5': '0.0204', 'HR@10': '0.0542', 'NDCG@10': '0.0275', 'HR@20': '0.0847', 'NDCG@20': '0.0352'}
2025-03-07 21:12:46,219 - EarlyStopping counter: 4 out of 10
2025-03-07 21:13:18,645 - {'epoch': 45, 'rec_loss': '7.4884'}
2025-03-07 21:13:35,999 - {'Epoch': 45, 'HR@5': '0.0318', 'NDCG@5': '0.0201', 'HR@10': '0.0531', 'NDCG@10': '0.0270', 'HR@20': '0.0849', 'NDCG@20': '0.0349'}
2025-03-07 21:13:36,002 - EarlyStopping counter: 5 out of 10
2025-03-07 21:14:11,758 - {'epoch': 46, 'rec_loss': '7.4835'}
2025-03-07 21:14:31,069 - {'Epoch': 46, 'HR@5': '0.0323', 'NDCG@5': '0.0208', 'HR@10': '0.0533', 'NDCG@10': '0.0275', 'HR@20': '0.0846', 'NDCG@20': '0.0354'}
2025-03-07 21:14:31,076 - EarlyStopping counter: 6 out of 10
2025-03-07 21:15:08,210 - {'epoch': 47, 'rec_loss': '7.4813'}
2025-03-07 21:15:27,397 - {'Epoch': 47, 'HR@5': '0.0312', 'NDCG@5': '0.0196', 'HR@10': '0.0520', 'NDCG@10': '0.0263', 'HR@20': '0.0846', 'NDCG@20': '0.0344'}
2025-03-07 21:15:27,399 - EarlyStopping counter: 7 out of 10
2025-03-07 21:16:05,158 - {'epoch': 48, 'rec_loss': '7.4675'}
2025-03-07 21:16:24,345 - {'Epoch': 48, 'HR@5': '0.0318', 'NDCG@5': '0.0206', 'HR@10': '0.0531', 'NDCG@10': '0.0274', 'HR@20': '0.0870', 'NDCG@20': '0.0359'}
2025-03-07 21:16:24,351 - Validation score increased.  Saving model ...
2025-03-07 21:17:03,576 - {'epoch': 49, 'rec_loss': '7.4706'}
2025-03-07 21:17:20,748 - {'Epoch': 49, 'HR@5': '0.0333', 'NDCG@5': '0.0210', 'HR@10': '0.0541', 'NDCG@10': '0.0276', 'HR@20': '0.0862', 'NDCG@20': '0.0357'}
2025-03-07 21:17:20,753 - EarlyStopping counter: 1 out of 10
2025-03-07 21:17:52,067 - {'epoch': 50, 'rec_loss': '7.4700'}
2025-03-07 21:18:10,535 - {'Epoch': 50, 'HR@5': '0.0331', 'NDCG@5': '0.0210', 'HR@10': '0.0539', 'NDCG@10': '0.0277', 'HR@20': '0.0848', 'NDCG@20': '0.0354'}
2025-03-07 21:18:10,536 - EarlyStopping counter: 2 out of 10
2025-03-07 21:18:47,991 - {'epoch': 51, 'rec_loss': '7.4682'}
2025-03-07 21:19:07,020 - {'Epoch': 51, 'HR@5': '0.0329', 'NDCG@5': '0.0209', 'HR@10': '0.0531', 'NDCG@10': '0.0274', 'HR@20': '0.0864', 'NDCG@20': '0.0358'}
2025-03-07 21:19:07,025 - EarlyStopping counter: 3 out of 10
2025-03-07 21:19:44,561 - {'epoch': 52, 'rec_loss': '7.4548'}
2025-03-07 21:20:03,682 - {'Epoch': 52, 'HR@5': '0.0314', 'NDCG@5': '0.0200', 'HR@10': '0.0530', 'NDCG@10': '0.0269', 'HR@20': '0.0853', 'NDCG@20': '0.0350'}
2025-03-07 21:20:03,686 - EarlyStopping counter: 4 out of 10
2025-03-07 21:20:41,821 - {'epoch': 53, 'rec_loss': '7.4557'}
2025-03-07 21:21:00,647 - {'Epoch': 53, 'HR@5': '0.0323', 'NDCG@5': '0.0207', 'HR@10': '0.0541', 'NDCG@10': '0.0277', 'HR@20': '0.0868', 'NDCG@20': '0.0359'}
2025-03-07 21:21:00,653 - Validation score increased.  Saving model ...
2025-03-07 21:21:35,899 - {'epoch': 54, 'rec_loss': '7.4525'}
2025-03-07 21:21:52,956 - {'Epoch': 54, 'HR@5': '0.0316', 'NDCG@5': '0.0202', 'HR@10': '0.0527', 'NDCG@10': '0.0271', 'HR@20': '0.0847', 'NDCG@20': '0.0351'}
2025-03-07 21:21:52,957 - EarlyStopping counter: 1 out of 10
2025-03-07 21:22:24,860 - {'epoch': 55, 'rec_loss': '7.4554'}
2025-03-07 21:22:44,373 - {'Epoch': 55, 'HR@5': '0.0330', 'NDCG@5': '0.0204', 'HR@10': '0.0536', 'NDCG@10': '0.0270', 'HR@20': '0.0839', 'NDCG@20': '0.0346'}
2025-03-07 21:22:44,374 - EarlyStopping counter: 2 out of 10
2025-03-07 21:23:21,581 - {'epoch': 56, 'rec_loss': '7.4449'}
2025-03-07 21:23:40,307 - {'Epoch': 56, 'HR@5': '0.0323', 'NDCG@5': '0.0203', 'HR@10': '0.0536', 'NDCG@10': '0.0271', 'HR@20': '0.0855', 'NDCG@20': '0.0351'}
2025-03-07 21:23:40,313 - EarlyStopping counter: 3 out of 10
2025-03-07 21:24:16,686 - {'epoch': 57, 'rec_loss': '7.4493'}
2025-03-07 21:24:35,606 - {'Epoch': 57, 'HR@5': '0.0321', 'NDCG@5': '0.0201', 'HR@10': '0.0535', 'NDCG@10': '0.0270', 'HR@20': '0.0849', 'NDCG@20': '0.0349'}
2025-03-07 21:24:35,613 - EarlyStopping counter: 4 out of 10
2025-03-07 21:25:13,473 - {'epoch': 58, 'rec_loss': '7.4433'}
2025-03-07 21:25:32,734 - {'Epoch': 58, 'HR@5': '0.0321', 'NDCG@5': '0.0206', 'HR@10': '0.0524', 'NDCG@10': '0.0271', 'HR@20': '0.0850', 'NDCG@20': '0.0353'}
2025-03-07 21:25:32,740 - EarlyStopping counter: 5 out of 10
2025-03-07 21:26:04,482 - {'epoch': 59, 'rec_loss': '7.4316'}
2025-03-07 21:26:22,036 - {'Epoch': 59, 'HR@5': '0.0329', 'NDCG@5': '0.0207', 'HR@10': '0.0542', 'NDCG@10': '0.0275', 'HR@20': '0.0865', 'NDCG@20': '0.0357'}
2025-03-07 21:26:22,053 - EarlyStopping counter: 6 out of 10
2025-03-07 21:26:59,042 - {'epoch': 60, 'rec_loss': '7.4393'}
2025-03-07 21:27:18,456 - {'Epoch': 60, 'HR@5': '0.0329', 'NDCG@5': '0.0208', 'HR@10': '0.0545', 'NDCG@10': '0.0277', 'HR@20': '0.0868', 'NDCG@20': '0.0358'}
2025-03-07 21:27:18,470 - EarlyStopping counter: 7 out of 10
2025-03-07 21:27:56,190 - {'epoch': 61, 'rec_loss': '7.4357'}
2025-03-07 21:28:16,172 - {'Epoch': 61, 'HR@5': '0.0328', 'NDCG@5': '0.0208', 'HR@10': '0.0550', 'NDCG@10': '0.0279', 'HR@20': '0.0859', 'NDCG@20': '0.0357'}
2025-03-07 21:28:16,174 - EarlyStopping counter: 8 out of 10
2025-03-07 21:28:55,933 - {'epoch': 62, 'rec_loss': '7.4369'}
2025-03-07 21:29:14,955 - {'Epoch': 62, 'HR@5': '0.0323', 'NDCG@5': '0.0206', 'HR@10': '0.0532', 'NDCG@10': '0.0273', 'HR@20': '0.0851', 'NDCG@20': '0.0354'}
2025-03-07 21:29:14,966 - EarlyStopping counter: 9 out of 10
2025-03-07 21:29:53,938 - {'epoch': 63, 'rec_loss': '7.4364'}
2025-03-07 21:30:10,529 - {'Epoch': 63, 'HR@5': '0.0317', 'NDCG@5': '0.0204', 'HR@10': '0.0533', 'NDCG@10': '0.0274', 'HR@20': '0.0864', 'NDCG@20': '0.0357'}
2025-03-07 21:30:10,534 - EarlyStopping counter: 10 out of 10
2025-03-07 21:30:10,535 - Early stopping
2025-03-07 21:30:10,535 - ---------------Test Score---------------
2025-03-07 21:30:27,276 - {'Epoch': 0, 'HR@5': '0.0297', 'NDCG@5': '0.0186', 'HR@10': '0.0501', 'NDCG@10': '0.0251', 'HR@20': '0.0802', 'NDCG@20': '0.0327'}
2025-03-07 21:30:27,280 - Scale_Yelp
2025-03-07 21:30:27,280 - {'Epoch': 0, 'HR@5': '0.0297', 'NDCG@5': '0.0186', 'HR@10': '0.0501', 'NDCG@10': '0.0251', 'HR@20': '0.0802', 'NDCG@20': '0.0327'}
2025-03-07 21:42:58,733 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50], kernels=[4, 8, 16], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-07 21:43:02,722 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=50, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-07 21:43:02,732 - Total Parameters: 1438718
2025-03-07 21:43:41,470 - {'epoch': 0, 'rec_loss': '9.5913'}
2025-03-07 21:44:00,338 - {'Epoch': 0, 'HR@5': '0.0077', 'NDCG@5': '0.0051', 'HR@10': '0.0133', 'NDCG@10': '0.0069', 'HR@20': '0.0220', 'NDCG@20': '0.0091'}
2025-03-07 21:44:00,339 - Validation score increased.  Saving model ...
2025-03-07 21:44:38,354 - {'epoch': 1, 'rec_loss': '9.2530'}
2025-03-07 21:44:55,608 - {'Epoch': 1, 'HR@5': '0.0103', 'NDCG@5': '0.0069', 'HR@10': '0.0181', 'NDCG@10': '0.0094', 'HR@20': '0.0315', 'NDCG@20': '0.0127'}
2025-03-07 21:44:55,610 - Validation score increased.  Saving model ...
2025-03-07 21:45:28,170 - {'epoch': 2, 'rec_loss': '8.9009'}
2025-03-07 21:45:45,755 - {'Epoch': 2, 'HR@5': '0.0131', 'NDCG@5': '0.0080', 'HR@10': '0.0224', 'NDCG@10': '0.0110', 'HR@20': '0.0371', 'NDCG@20': '0.0147'}
2025-03-07 21:45:45,757 - Validation score increased.  Saving model ...
2025-03-07 21:46:26,140 - {'epoch': 3, 'rec_loss': '8.6677'}
2025-03-07 21:46:44,962 - {'Epoch': 3, 'HR@5': '0.0162', 'NDCG@5': '0.0100', 'HR@10': '0.0293', 'NDCG@10': '0.0142', 'HR@20': '0.0484', 'NDCG@20': '0.0190'}
2025-03-07 21:46:44,964 - Validation score increased.  Saving model ...
2025-03-07 21:47:24,462 - {'epoch': 4, 'rec_loss': '8.4727'}
2025-03-07 21:47:43,129 - {'Epoch': 4, 'HR@5': '0.0180', 'NDCG@5': '0.0111', 'HR@10': '0.0314', 'NDCG@10': '0.0154', 'HR@20': '0.0544', 'NDCG@20': '0.0211'}
2025-03-07 21:47:43,131 - Validation score increased.  Saving model ...
2025-03-07 21:48:23,162 - {'epoch': 5, 'rec_loss': '8.3259'}
2025-03-07 21:48:41,581 - {'Epoch': 5, 'HR@5': '0.0197', 'NDCG@5': '0.0123', 'HR@10': '0.0344', 'NDCG@10': '0.0170', 'HR@20': '0.0588', 'NDCG@20': '0.0231'}
2025-03-07 21:48:41,586 - Validation score increased.  Saving model ...
2025-03-07 21:49:17,022 - {'epoch': 6, 'rec_loss': '8.2154'}
2025-03-07 21:49:33,329 - {'Epoch': 6, 'HR@5': '0.0218', 'NDCG@5': '0.0133', 'HR@10': '0.0383', 'NDCG@10': '0.0186', 'HR@20': '0.0627', 'NDCG@20': '0.0248'}
2025-03-07 21:49:33,331 - Validation score increased.  Saving model ...
2025-03-07 21:50:05,420 - {'epoch': 7, 'rec_loss': '8.1331'}
2025-03-07 21:50:23,531 - {'Epoch': 7, 'HR@5': '0.0233', 'NDCG@5': '0.0145', 'HR@10': '0.0392', 'NDCG@10': '0.0196', 'HR@20': '0.0666', 'NDCG@20': '0.0264'}
2025-03-07 21:50:23,538 - Validation score increased.  Saving model ...
2025-03-07 21:51:01,087 - {'epoch': 8, 'rec_loss': '8.0692'}
2025-03-07 21:51:19,956 - {'Epoch': 8, 'HR@5': '0.0255', 'NDCG@5': '0.0158', 'HR@10': '0.0426', 'NDCG@10': '0.0213', 'HR@20': '0.0691', 'NDCG@20': '0.0280'}
2025-03-07 21:51:19,957 - Validation score increased.  Saving model ...
2025-03-07 21:51:57,944 - {'epoch': 9, 'rec_loss': '8.0131'}
2025-03-07 21:52:16,418 - {'Epoch': 9, 'HR@5': '0.0249', 'NDCG@5': '0.0157', 'HR@10': '0.0424', 'NDCG@10': '0.0213', 'HR@20': '0.0720', 'NDCG@20': '0.0287'}
2025-03-07 21:52:16,422 - Validation score increased.  Saving model ...
2025-03-07 21:52:54,159 - {'epoch': 10, 'rec_loss': '7.9608'}
2025-03-07 21:53:12,642 - {'Epoch': 10, 'HR@5': '0.0258', 'NDCG@5': '0.0161', 'HR@10': '0.0437', 'NDCG@10': '0.0219', 'HR@20': '0.0719', 'NDCG@20': '0.0289'}
2025-03-07 21:53:12,644 - Validation score increased.  Saving model ...
2025-03-07 21:53:47,372 - {'epoch': 11, 'rec_loss': '7.9146'}
2025-03-07 21:54:03,455 - {'Epoch': 11, 'HR@5': '0.0274', 'NDCG@5': '0.0172', 'HR@10': '0.0464', 'NDCG@10': '0.0232', 'HR@20': '0.0765', 'NDCG@20': '0.0308'}
2025-03-07 21:54:03,457 - Validation score increased.  Saving model ...
2025-03-07 21:54:36,250 - {'epoch': 12, 'rec_loss': '7.8784'}
2025-03-07 21:54:53,340 - {'Epoch': 12, 'HR@5': '0.0287', 'NDCG@5': '0.0179', 'HR@10': '0.0480', 'NDCG@10': '0.0241', 'HR@20': '0.0755', 'NDCG@20': '0.0310'}
2025-03-07 21:54:53,342 - Validation score increased.  Saving model ...
2025-03-07 21:55:22,897 - {'epoch': 13, 'rec_loss': '7.8442'}
2025-03-07 21:55:39,827 - {'Epoch': 13, 'HR@5': '0.0283', 'NDCG@5': '0.0177', 'HR@10': '0.0478', 'NDCG@10': '0.0239', 'HR@20': '0.0796', 'NDCG@20': '0.0319'}
2025-03-07 21:55:39,835 - Validation score increased.  Saving model ...
2025-03-07 21:56:10,401 - {'epoch': 14, 'rec_loss': '7.8048'}
2025-03-07 21:56:27,400 - {'Epoch': 14, 'HR@5': '0.0300', 'NDCG@5': '0.0185', 'HR@10': '0.0488', 'NDCG@10': '0.0245', 'HR@20': '0.0796', 'NDCG@20': '0.0322'}
2025-03-07 21:56:27,405 - Validation score increased.  Saving model ...
2025-03-07 21:56:58,120 - {'epoch': 15, 'rec_loss': '7.7782'}
2025-03-07 21:57:15,125 - {'Epoch': 15, 'HR@5': '0.0298', 'NDCG@5': '0.0183', 'HR@10': '0.0495', 'NDCG@10': '0.0247', 'HR@20': '0.0800', 'NDCG@20': '0.0323'}
2025-03-07 21:57:15,131 - Validation score increased.  Saving model ...
2025-03-07 21:57:45,378 - {'epoch': 16, 'rec_loss': '7.7563'}
2025-03-07 21:58:02,041 - {'Epoch': 16, 'HR@5': '0.0294', 'NDCG@5': '0.0184', 'HR@10': '0.0496', 'NDCG@10': '0.0249', 'HR@20': '0.0805', 'NDCG@20': '0.0327'}
2025-03-07 21:58:02,042 - Validation score increased.  Saving model ...
2025-03-07 21:58:33,209 - {'epoch': 17, 'rec_loss': '7.7407'}
2025-03-07 21:58:49,689 - {'Epoch': 17, 'HR@5': '0.0302', 'NDCG@5': '0.0189', 'HR@10': '0.0523', 'NDCG@10': '0.0260', 'HR@20': '0.0822', 'NDCG@20': '0.0335'}
2025-03-07 21:58:49,692 - Validation score increased.  Saving model ...
2025-03-07 21:59:20,044 - {'epoch': 18, 'rec_loss': '7.7152'}
2025-03-07 21:59:36,908 - {'Epoch': 18, 'HR@5': '0.0295', 'NDCG@5': '0.0189', 'HR@10': '0.0501', 'NDCG@10': '0.0255', 'HR@20': '0.0821', 'NDCG@20': '0.0336'}
2025-03-07 21:59:36,916 - Validation score increased.  Saving model ...
2025-03-07 22:00:08,588 - {'epoch': 19, 'rec_loss': '7.7004'}
2025-03-07 22:00:24,717 - {'Epoch': 19, 'HR@5': '0.0302', 'NDCG@5': '0.0189', 'HR@10': '0.0508', 'NDCG@10': '0.0256', 'HR@20': '0.0819', 'NDCG@20': '0.0334'}
2025-03-07 22:00:24,721 - EarlyStopping counter: 1 out of 10
2025-03-07 22:00:54,655 - {'epoch': 20, 'rec_loss': '7.6830'}
2025-03-07 22:01:11,137 - {'Epoch': 20, 'HR@5': '0.0317', 'NDCG@5': '0.0200', 'HR@10': '0.0522', 'NDCG@10': '0.0265', 'HR@20': '0.0842', 'NDCG@20': '0.0346'}
2025-03-07 22:01:11,141 - Validation score increased.  Saving model ...
2025-03-07 22:01:42,364 - {'epoch': 21, 'rec_loss': '7.6710'}
2025-03-07 22:01:58,657 - {'Epoch': 21, 'HR@5': '0.0309', 'NDCG@5': '0.0196', 'HR@10': '0.0519', 'NDCG@10': '0.0263', 'HR@20': '0.0842', 'NDCG@20': '0.0345'}
2025-03-07 22:01:58,663 - EarlyStopping counter: 1 out of 10
2025-03-07 22:02:28,794 - {'epoch': 22, 'rec_loss': '7.6522'}
2025-03-07 22:02:45,754 - {'Epoch': 22, 'HR@5': '0.0315', 'NDCG@5': '0.0192', 'HR@10': '0.0512', 'NDCG@10': '0.0255', 'HR@20': '0.0836', 'NDCG@20': '0.0337'}
2025-03-07 22:02:45,763 - EarlyStopping counter: 2 out of 10
2025-03-07 22:03:17,130 - {'epoch': 23, 'rec_loss': '7.6440'}
2025-03-07 22:03:33,866 - {'Epoch': 23, 'HR@5': '0.0312', 'NDCG@5': '0.0196', 'HR@10': '0.0521', 'NDCG@10': '0.0263', 'HR@20': '0.0841', 'NDCG@20': '0.0344'}
2025-03-07 22:03:33,868 - EarlyStopping counter: 3 out of 10
2025-03-07 22:04:04,287 - {'epoch': 24, 'rec_loss': '7.6266'}
2025-03-07 22:04:20,799 - {'Epoch': 24, 'HR@5': '0.0316', 'NDCG@5': '0.0198', 'HR@10': '0.0515', 'NDCG@10': '0.0262', 'HR@20': '0.0836', 'NDCG@20': '0.0342'}
2025-03-07 22:04:20,803 - EarlyStopping counter: 4 out of 10
2025-03-07 22:04:50,828 - {'epoch': 25, 'rec_loss': '7.6208'}
2025-03-07 22:05:07,543 - {'Epoch': 25, 'HR@5': '0.0319', 'NDCG@5': '0.0199', 'HR@10': '0.0516', 'NDCG@10': '0.0262', 'HR@20': '0.0847', 'NDCG@20': '0.0345'}
2025-03-07 22:05:07,545 - EarlyStopping counter: 5 out of 10
2025-03-07 22:05:38,703 - {'epoch': 26, 'rec_loss': '7.6025'}
2025-03-07 22:05:55,288 - {'Epoch': 26, 'HR@5': '0.0318', 'NDCG@5': '0.0201', 'HR@10': '0.0523', 'NDCG@10': '0.0266', 'HR@20': '0.0854', 'NDCG@20': '0.0349'}
2025-03-07 22:05:55,298 - Validation score increased.  Saving model ...
2025-03-07 22:06:25,734 - {'epoch': 27, 'rec_loss': '7.5956'}
2025-03-07 22:06:42,596 - {'Epoch': 27, 'HR@5': '0.0308', 'NDCG@5': '0.0195', 'HR@10': '0.0528', 'NDCG@10': '0.0265', 'HR@20': '0.0839', 'NDCG@20': '0.0344'}
2025-03-07 22:06:42,602 - EarlyStopping counter: 1 out of 10
2025-03-07 22:07:12,665 - {'epoch': 28, 'rec_loss': '7.5874'}
2025-03-07 22:07:29,293 - {'Epoch': 28, 'HR@5': '0.0318', 'NDCG@5': '0.0200', 'HR@10': '0.0531', 'NDCG@10': '0.0269', 'HR@20': '0.0834', 'NDCG@20': '0.0345'}
2025-03-07 22:07:29,301 - EarlyStopping counter: 2 out of 10
2025-03-07 22:07:59,652 - {'epoch': 29, 'rec_loss': '7.5704'}
2025-03-07 22:08:16,293 - {'Epoch': 29, 'HR@5': '0.0323', 'NDCG@5': '0.0204', 'HR@10': '0.0536', 'NDCG@10': '0.0272', 'HR@20': '0.0860', 'NDCG@20': '0.0354'}
2025-03-07 22:08:16,295 - Validation score increased.  Saving model ...
2025-03-07 22:08:46,341 - {'epoch': 30, 'rec_loss': '7.5734'}
2025-03-07 22:09:02,570 - {'Epoch': 30, 'HR@5': '0.0325', 'NDCG@5': '0.0203', 'HR@10': '0.0539', 'NDCG@10': '0.0272', 'HR@20': '0.0856', 'NDCG@20': '0.0351'}
2025-03-07 22:09:02,576 - EarlyStopping counter: 1 out of 10
2025-03-07 22:09:33,171 - {'epoch': 31, 'rec_loss': '7.5623'}
2025-03-07 22:09:49,689 - {'Epoch': 31, 'HR@5': '0.0320', 'NDCG@5': '0.0203', 'HR@10': '0.0540', 'NDCG@10': '0.0274', 'HR@20': '0.0864', 'NDCG@20': '0.0355'}
2025-03-07 22:09:49,691 - Validation score increased.  Saving model ...
2025-03-07 22:10:21,070 - {'epoch': 32, 'rec_loss': '7.5632'}
2025-03-07 22:10:37,949 - {'Epoch': 32, 'HR@5': '0.0322', 'NDCG@5': '0.0205', 'HR@10': '0.0533', 'NDCG@10': '0.0273', 'HR@20': '0.0865', 'NDCG@20': '0.0356'}
2025-03-07 22:10:37,954 - Validation score increased.  Saving model ...
2025-03-07 22:11:08,959 - {'epoch': 33, 'rec_loss': '7.5440'}
2025-03-07 22:11:25,546 - {'Epoch': 33, 'HR@5': '0.0318', 'NDCG@5': '0.0201', 'HR@10': '0.0532', 'NDCG@10': '0.0270', 'HR@20': '0.0854', 'NDCG@20': '0.0351'}
2025-03-07 22:11:25,549 - EarlyStopping counter: 1 out of 10
2025-03-07 22:11:55,392 - {'epoch': 34, 'rec_loss': '7.5428'}
2025-03-07 22:12:12,097 - {'Epoch': 34, 'HR@5': '0.0322', 'NDCG@5': '0.0202', 'HR@10': '0.0531', 'NDCG@10': '0.0269', 'HR@20': '0.0848', 'NDCG@20': '0.0349'}
2025-03-07 22:12:12,100 - EarlyStopping counter: 2 out of 10
2025-03-07 22:12:41,716 - {'epoch': 35, 'rec_loss': '7.5348'}
2025-03-07 22:12:58,057 - {'Epoch': 35, 'HR@5': '0.0319', 'NDCG@5': '0.0205', 'HR@10': '0.0532', 'NDCG@10': '0.0273', 'HR@20': '0.0850', 'NDCG@20': '0.0353'}
2025-03-07 22:12:58,063 - EarlyStopping counter: 3 out of 10
2025-03-07 22:13:28,493 - {'epoch': 36, 'rec_loss': '7.5384'}
2025-03-07 22:13:44,998 - {'Epoch': 36, 'HR@5': '0.0322', 'NDCG@5': '0.0204', 'HR@10': '0.0528', 'NDCG@10': '0.0270', 'HR@20': '0.0858', 'NDCG@20': '0.0353'}
2025-03-07 22:13:45,003 - EarlyStopping counter: 4 out of 10
2025-03-07 22:14:15,453 - {'epoch': 37, 'rec_loss': '7.5248'}
2025-03-07 22:14:32,133 - {'Epoch': 37, 'HR@5': '0.0327', 'NDCG@5': '0.0207', 'HR@10': '0.0537', 'NDCG@10': '0.0274', 'HR@20': '0.0846', 'NDCG@20': '0.0351'}
2025-03-07 22:14:32,134 - EarlyStopping counter: 5 out of 10
2025-03-07 22:15:03,600 - {'epoch': 38, 'rec_loss': '7.5120'}
2025-03-07 22:15:19,835 - {'Epoch': 38, 'HR@5': '0.0333', 'NDCG@5': '0.0211', 'HR@10': '0.0538', 'NDCG@10': '0.0277', 'HR@20': '0.0843', 'NDCG@20': '0.0353'}
2025-03-07 22:15:19,838 - EarlyStopping counter: 6 out of 10
2025-03-07 22:15:50,239 - {'epoch': 39, 'rec_loss': '7.5139'}
2025-03-07 22:16:06,695 - {'Epoch': 39, 'HR@5': '0.0322', 'NDCG@5': '0.0205', 'HR@10': '0.0527', 'NDCG@10': '0.0271', 'HR@20': '0.0861', 'NDCG@20': '0.0355'}
2025-03-07 22:16:06,696 - EarlyStopping counter: 7 out of 10
2025-03-07 22:16:37,040 - {'epoch': 40, 'rec_loss': '7.5136'}
2025-03-07 22:16:53,600 - {'Epoch': 40, 'HR@5': '0.0324', 'NDCG@5': '0.0207', 'HR@10': '0.0548', 'NDCG@10': '0.0278', 'HR@20': '0.0864', 'NDCG@20': '0.0358'}
2025-03-07 22:16:53,606 - Validation score increased.  Saving model ...
2025-03-07 22:17:23,805 - {'epoch': 41, 'rec_loss': '7.5058'}
2025-03-07 22:17:40,690 - {'Epoch': 41, 'HR@5': '0.0319', 'NDCG@5': '0.0201', 'HR@10': '0.0531', 'NDCG@10': '0.0269', 'HR@20': '0.0856', 'NDCG@20': '0.0350'}
2025-03-07 22:17:40,695 - EarlyStopping counter: 1 out of 10
2025-03-07 22:18:10,984 - {'epoch': 42, 'rec_loss': '7.5007'}
2025-03-07 22:18:27,614 - {'Epoch': 42, 'HR@5': '0.0320', 'NDCG@5': '0.0204', 'HR@10': '0.0523', 'NDCG@10': '0.0269', 'HR@20': '0.0848', 'NDCG@20': '0.0351'}
2025-03-07 22:18:27,615 - EarlyStopping counter: 2 out of 10
2025-03-07 22:18:57,074 - {'epoch': 43, 'rec_loss': '7.4940'}
2025-03-07 22:19:13,688 - {'Epoch': 43, 'HR@5': '0.0316', 'NDCG@5': '0.0200', 'HR@10': '0.0524', 'NDCG@10': '0.0267', 'HR@20': '0.0845', 'NDCG@20': '0.0348'}
2025-03-07 22:19:13,691 - EarlyStopping counter: 3 out of 10
2025-03-07 22:19:44,008 - {'epoch': 44, 'rec_loss': '7.4917'}
2025-03-07 22:20:00,638 - {'Epoch': 44, 'HR@5': '0.0330', 'NDCG@5': '0.0210', 'HR@10': '0.0531', 'NDCG@10': '0.0275', 'HR@20': '0.0861', 'NDCG@20': '0.0358'}
2025-03-07 22:20:00,643 - EarlyStopping counter: 4 out of 10
2025-03-07 22:20:30,576 - {'epoch': 45, 'rec_loss': '7.4882'}
2025-03-07 22:20:46,973 - {'Epoch': 45, 'HR@5': '0.0326', 'NDCG@5': '0.0209', 'HR@10': '0.0531', 'NDCG@10': '0.0275', 'HR@20': '0.0851', 'NDCG@20': '0.0355'}
2025-03-07 22:20:46,974 - EarlyStopping counter: 5 out of 10
2025-03-07 22:21:17,697 - {'epoch': 46, 'rec_loss': '7.4803'}
2025-03-07 22:21:34,484 - {'Epoch': 46, 'HR@5': '0.0324', 'NDCG@5': '0.0209', 'HR@10': '0.0530', 'NDCG@10': '0.0275', 'HR@20': '0.0852', 'NDCG@20': '0.0356'}
2025-03-07 22:21:34,489 - EarlyStopping counter: 6 out of 10
2025-03-07 22:22:04,759 - {'epoch': 47, 'rec_loss': '7.4825'}
2025-03-07 22:22:20,945 - {'Epoch': 47, 'HR@5': '0.0317', 'NDCG@5': '0.0199', 'HR@10': '0.0526', 'NDCG@10': '0.0266', 'HR@20': '0.0841', 'NDCG@20': '0.0346'}
2025-03-07 22:22:20,946 - EarlyStopping counter: 7 out of 10
2025-03-07 22:22:52,264 - {'epoch': 48, 'rec_loss': '7.4679'}
2025-03-07 22:23:08,548 - {'Epoch': 48, 'HR@5': '0.0322', 'NDCG@5': '0.0208', 'HR@10': '0.0538', 'NDCG@10': '0.0277', 'HR@20': '0.0864', 'NDCG@20': '0.0359'}
2025-03-07 22:23:08,554 - Validation score increased.  Saving model ...
2025-03-07 22:23:37,980 - {'epoch': 49, 'rec_loss': '7.4701'}
2025-03-07 22:23:54,695 - {'Epoch': 49, 'HR@5': '0.0330', 'NDCG@5': '0.0208', 'HR@10': '0.0540', 'NDCG@10': '0.0276', 'HR@20': '0.0863', 'NDCG@20': '0.0357'}
2025-03-07 22:23:54,701 - EarlyStopping counter: 1 out of 10
2025-03-07 22:24:24,530 - {'epoch': 50, 'rec_loss': '7.4707'}
2025-03-07 22:24:41,087 - {'Epoch': 50, 'HR@5': '0.0330', 'NDCG@5': '0.0210', 'HR@10': '0.0541', 'NDCG@10': '0.0277', 'HR@20': '0.0855', 'NDCG@20': '0.0356'}
2025-03-07 22:24:41,092 - EarlyStopping counter: 2 out of 10
2025-03-07 22:25:10,295 - {'epoch': 51, 'rec_loss': '7.4670'}
2025-03-07 22:25:26,813 - {'Epoch': 51, 'HR@5': '0.0319', 'NDCG@5': '0.0206', 'HR@10': '0.0533', 'NDCG@10': '0.0275', 'HR@20': '0.0864', 'NDCG@20': '0.0358'}
2025-03-07 22:25:26,815 - EarlyStopping counter: 3 out of 10
2025-03-07 22:25:57,180 - {'epoch': 52, 'rec_loss': '7.4551'}
2025-03-07 22:26:13,953 - {'Epoch': 52, 'HR@5': '0.0322', 'NDCG@5': '0.0203', 'HR@10': '0.0528', 'NDCG@10': '0.0269', 'HR@20': '0.0844', 'NDCG@20': '0.0349'}
2025-03-07 22:26:13,957 - EarlyStopping counter: 4 out of 10
2025-03-07 22:26:43,008 - {'epoch': 53, 'rec_loss': '7.4547'}
2025-03-07 22:26:59,960 - {'Epoch': 53, 'HR@5': '0.0327', 'NDCG@5': '0.0209', 'HR@10': '0.0532', 'NDCG@10': '0.0275', 'HR@20': '0.0857', 'NDCG@20': '0.0357'}
2025-03-07 22:26:59,966 - EarlyStopping counter: 5 out of 10
2025-03-07 22:27:29,242 - {'epoch': 54, 'rec_loss': '7.4519'}
2025-03-07 22:27:45,220 - {'Epoch': 54, 'HR@5': '0.0326', 'NDCG@5': '0.0210', 'HR@10': '0.0531', 'NDCG@10': '0.0276', 'HR@20': '0.0837', 'NDCG@20': '0.0353'}
2025-03-07 22:27:45,223 - EarlyStopping counter: 6 out of 10
2025-03-07 22:28:14,642 - {'epoch': 55, 'rec_loss': '7.4543'}
2025-03-07 22:28:31,151 - {'Epoch': 55, 'HR@5': '0.0329', 'NDCG@5': '0.0205', 'HR@10': '0.0538', 'NDCG@10': '0.0272', 'HR@20': '0.0847', 'NDCG@20': '0.0349'}
2025-03-07 22:28:31,158 - EarlyStopping counter: 7 out of 10
2025-03-07 22:29:02,338 - {'epoch': 56, 'rec_loss': '7.4465'}
2025-03-07 22:29:18,664 - {'Epoch': 56, 'HR@5': '0.0323', 'NDCG@5': '0.0202', 'HR@10': '0.0532', 'NDCG@10': '0.0269', 'HR@20': '0.0852', 'NDCG@20': '0.0349'}
2025-03-07 22:29:18,666 - EarlyStopping counter: 8 out of 10
2025-03-07 22:29:49,446 - {'epoch': 57, 'rec_loss': '7.4479'}
2025-03-07 22:30:06,246 - {'Epoch': 57, 'HR@5': '0.0316', 'NDCG@5': '0.0203', 'HR@10': '0.0529', 'NDCG@10': '0.0271', 'HR@20': '0.0848', 'NDCG@20': '0.0352'}
2025-03-07 22:30:06,249 - EarlyStopping counter: 9 out of 10
2025-03-07 22:30:37,050 - {'epoch': 58, 'rec_loss': '7.4440'}
2025-03-07 22:30:54,008 - {'Epoch': 58, 'HR@5': '0.0315', 'NDCG@5': '0.0204', 'HR@10': '0.0531', 'NDCG@10': '0.0274', 'HR@20': '0.0846', 'NDCG@20': '0.0353'}
2025-03-07 22:30:54,009 - EarlyStopping counter: 10 out of 10
2025-03-07 22:30:54,009 - Early stopping
2025-03-07 22:30:54,009 - ---------------Test Score---------------
2025-03-07 22:31:11,089 - {'Epoch': 0, 'HR@5': '0.0290', 'NDCG@5': '0.0183', 'HR@10': '0.0504', 'NDCG@10': '0.0251', 'HR@20': '0.0792', 'NDCG@20': '0.0323'}
2025-03-07 22:31:11,090 - Scale_Yelp
2025-03-07 22:31:11,090 - {'Epoch': 0, 'HR@5': '0.0290', 'NDCG@5': '0.0183', 'HR@10': '0.0504', 'NDCG@10': '0.0251', 'HR@20': '0.0792', 'NDCG@20': '0.0323'}
2025-03-07 23:29:05,722 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 24], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-07 23:29:08,795 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-07 23:29:08,799 - Total Parameters: 1437093
2025-03-08 01:41:47,703 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50], kernels=[4, 8, 24], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-08 01:41:51,749 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=50, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-08 01:41:51,761 - Total Parameters: 1438718
2025-03-08 01:42:37,000 - {'epoch': 0, 'rec_loss': '9.5822'}
2025-03-08 01:43:02,509 - {'Epoch': 0, 'HR@5': '0.0080', 'NDCG@5': '0.0052', 'HR@10': '0.0142', 'NDCG@10': '0.0072', 'HR@20': '0.0244', 'NDCG@20': '0.0098'}
2025-03-08 01:43:02,510 - Validation score increased.  Saving model ...
2025-03-08 01:44:00,702 - {'epoch': 1, 'rec_loss': '9.1730'}
2025-03-08 01:44:23,430 - {'Epoch': 1, 'HR@5': '0.0112', 'NDCG@5': '0.0073', 'HR@10': '0.0193', 'NDCG@10': '0.0100', 'HR@20': '0.0331', 'NDCG@20': '0.0134'}
2025-03-08 01:44:23,438 - Validation score increased.  Saving model ...
2025-03-08 01:45:11,275 - {'epoch': 2, 'rec_loss': '8.8008'}
2025-03-08 01:45:33,881 - {'Epoch': 2, 'HR@5': '0.0149', 'NDCG@5': '0.0093', 'HR@10': '0.0250', 'NDCG@10': '0.0125', 'HR@20': '0.0410', 'NDCG@20': '0.0165'}
2025-03-08 01:45:33,884 - Validation score increased.  Saving model ...
2025-03-08 01:46:29,318 - {'epoch': 3, 'rec_loss': '8.5530'}
2025-03-08 01:46:53,999 - {'Epoch': 3, 'HR@5': '0.0171', 'NDCG@5': '0.0105', 'HR@10': '0.0307', 'NDCG@10': '0.0149', 'HR@20': '0.0518', 'NDCG@20': '0.0202'}
2025-03-08 01:46:54,006 - Validation score increased.  Saving model ...
2025-03-08 01:47:49,106 - {'epoch': 4, 'rec_loss': '8.3545'}
2025-03-08 01:48:13,434 - {'Epoch': 4, 'HR@5': '0.0191', 'NDCG@5': '0.0116', 'HR@10': '0.0348', 'NDCG@10': '0.0166', 'HR@20': '0.0582', 'NDCG@20': '0.0225'}
2025-03-08 01:48:13,438 - Validation score increased.  Saving model ...
2025-03-08 01:48:57,528 - {'epoch': 5, 'rec_loss': '8.2119'}
2025-03-08 01:49:16,949 - {'Epoch': 5, 'HR@5': '0.0205', 'NDCG@5': '0.0127', 'HR@10': '0.0363', 'NDCG@10': '0.0178', 'HR@20': '0.0604', 'NDCG@20': '0.0238'}
2025-03-08 01:49:16,952 - Validation score increased.  Saving model ...
2025-03-08 01:50:06,659 - {'epoch': 6, 'rec_loss': '8.1064'}
2025-03-08 01:50:31,351 - {'Epoch': 6, 'HR@5': '0.0230', 'NDCG@5': '0.0142', 'HR@10': '0.0395', 'NDCG@10': '0.0195', 'HR@20': '0.0656', 'NDCG@20': '0.0261'}
2025-03-08 01:50:31,357 - Validation score increased.  Saving model ...
2025-03-08 01:51:24,349 - {'epoch': 7, 'rec_loss': '8.0216'}
2025-03-08 01:51:46,214 - {'Epoch': 7, 'HR@5': '0.0239', 'NDCG@5': '0.0152', 'HR@10': '0.0410', 'NDCG@10': '0.0207', 'HR@20': '0.0672', 'NDCG@20': '0.0272'}
2025-03-08 01:51:46,217 - Validation score increased.  Saving model ...
2025-03-08 01:52:35,847 - {'epoch': 8, 'rec_loss': '7.9556'}
2025-03-08 01:52:59,862 - {'Epoch': 8, 'HR@5': '0.0258', 'NDCG@5': '0.0164', 'HR@10': '0.0433', 'NDCG@10': '0.0220', 'HR@20': '0.0708', 'NDCG@20': '0.0289'}
2025-03-08 01:52:59,872 - Validation score increased.  Saving model ...
2025-03-08 01:53:55,182 - {'epoch': 9, 'rec_loss': '7.8950'}
2025-03-08 01:54:19,772 - {'Epoch': 9, 'HR@5': '0.0259', 'NDCG@5': '0.0167', 'HR@10': '0.0437', 'NDCG@10': '0.0224', 'HR@20': '0.0718', 'NDCG@20': '0.0295'}
2025-03-08 01:54:19,777 - Validation score increased.  Saving model ...
2025-03-08 01:55:16,966 - {'epoch': 10, 'rec_loss': '7.8421'}
2025-03-08 01:55:38,252 - {'Epoch': 10, 'HR@5': '0.0267', 'NDCG@5': '0.0169', 'HR@10': '0.0451', 'NDCG@10': '0.0228', 'HR@20': '0.0743', 'NDCG@20': '0.0301'}
2025-03-08 01:55:38,255 - Validation score increased.  Saving model ...
2025-03-08 01:56:20,953 - {'epoch': 11, 'rec_loss': '7.7919'}
2025-03-08 01:56:41,636 - {'Epoch': 11, 'HR@5': '0.0280', 'NDCG@5': '0.0177', 'HR@10': '0.0470', 'NDCG@10': '0.0238', 'HR@20': '0.0781', 'NDCG@20': '0.0316'}
2025-03-08 01:56:41,644 - Validation score increased.  Saving model ...
2025-03-08 01:57:33,777 - {'epoch': 12, 'rec_loss': '7.7581'}
2025-03-08 01:57:57,431 - {'Epoch': 12, 'HR@5': '0.0295', 'NDCG@5': '0.0181', 'HR@10': '0.0485', 'NDCG@10': '0.0242', 'HR@20': '0.0780', 'NDCG@20': '0.0317'}
2025-03-08 01:57:57,439 - Validation score increased.  Saving model ...
2025-03-08 01:58:51,611 - {'epoch': 13, 'rec_loss': '7.7258'}
2025-03-08 01:59:13,598 - {'Epoch': 13, 'HR@5': '0.0287', 'NDCG@5': '0.0180', 'HR@10': '0.0478', 'NDCG@10': '0.0242', 'HR@20': '0.0787', 'NDCG@20': '0.0320'}
2025-03-08 01:59:13,603 - Validation score increased.  Saving model ...
2025-03-08 02:00:11,222 - {'epoch': 14, 'rec_loss': '7.6842'}
2025-03-08 02:00:35,132 - {'Epoch': 14, 'HR@5': '0.0296', 'NDCG@5': '0.0188', 'HR@10': '0.0488', 'NDCG@10': '0.0250', 'HR@20': '0.0794', 'NDCG@20': '0.0326'}
2025-03-08 02:00:35,136 - Validation score increased.  Saving model ...
2025-03-08 02:01:33,994 - {'epoch': 15, 'rec_loss': '7.6582'}
2025-03-08 02:01:57,949 - {'Epoch': 15, 'HR@5': '0.0297', 'NDCG@5': '0.0186', 'HR@10': '0.0503', 'NDCG@10': '0.0253', 'HR@20': '0.0795', 'NDCG@20': '0.0325'}
2025-03-08 02:01:57,956 - EarlyStopping counter: 1 out of 10
2025-03-08 02:02:52,938 - {'epoch': 16, 'rec_loss': '7.6393'}
2025-03-08 02:03:12,129 - {'Epoch': 16, 'HR@5': '0.0301', 'NDCG@5': '0.0188', 'HR@10': '0.0506', 'NDCG@10': '0.0253', 'HR@20': '0.0811', 'NDCG@20': '0.0330'}
2025-03-08 02:03:12,131 - Validation score increased.  Saving model ...
2025-03-08 02:03:54,469 - {'epoch': 17, 'rec_loss': '7.6167'}
2025-03-08 02:04:16,821 - {'Epoch': 17, 'HR@5': '0.0298', 'NDCG@5': '0.0188', 'HR@10': '0.0498', 'NDCG@10': '0.0252', 'HR@20': '0.0821', 'NDCG@20': '0.0333'}
2025-03-08 02:04:16,828 - Validation score increased.  Saving model ...
2025-03-08 02:05:12,119 - {'epoch': 18, 'rec_loss': '7.5995'}
2025-03-08 02:05:34,213 - {'Epoch': 18, 'HR@5': '0.0293', 'NDCG@5': '0.0185', 'HR@10': '0.0505', 'NDCG@10': '0.0253', 'HR@20': '0.0826', 'NDCG@20': '0.0334'}
2025-03-08 02:05:34,218 - Validation score increased.  Saving model ...
2025-03-08 02:06:19,855 - {'epoch': 19, 'rec_loss': '7.5798'}
2025-03-08 02:06:40,643 - {'Epoch': 19, 'HR@5': '0.0307', 'NDCG@5': '0.0193', 'HR@10': '0.0503', 'NDCG@10': '0.0256', 'HR@20': '0.0826', 'NDCG@20': '0.0338'}
2025-03-08 02:06:40,645 - Validation score increased.  Saving model ...
2025-03-08 02:07:37,117 - {'epoch': 20, 'rec_loss': '7.5649'}
2025-03-08 02:08:01,683 - {'Epoch': 20, 'HR@5': '0.0307', 'NDCG@5': '0.0199', 'HR@10': '0.0513', 'NDCG@10': '0.0265', 'HR@20': '0.0839', 'NDCG@20': '0.0347'}
2025-03-08 02:08:01,688 - Validation score increased.  Saving model ...
2025-03-08 02:08:55,170 - {'epoch': 21, 'rec_loss': '7.5498'}
2025-03-08 02:09:18,962 - {'Epoch': 21, 'HR@5': '0.0316', 'NDCG@5': '0.0201', 'HR@10': '0.0525', 'NDCG@10': '0.0268', 'HR@20': '0.0825', 'NDCG@20': '0.0343'}
2025-03-08 02:09:18,972 - EarlyStopping counter: 1 out of 10
2025-03-08 02:10:10,704 - {'epoch': 22, 'rec_loss': '7.5315'}
2025-03-08 02:10:29,765 - {'Epoch': 22, 'HR@5': '0.0305', 'NDCG@5': '0.0189', 'HR@10': '0.0515', 'NDCG@10': '0.0257', 'HR@20': '0.0826', 'NDCG@20': '0.0335'}
2025-03-08 02:10:29,774 - EarlyStopping counter: 2 out of 10
2025-03-08 02:11:11,138 - {'epoch': 23, 'rec_loss': '7.5245'}
2025-03-08 02:11:34,278 - {'Epoch': 23, 'HR@5': '0.0314', 'NDCG@5': '0.0197', 'HR@10': '0.0522', 'NDCG@10': '0.0264', 'HR@20': '0.0833', 'NDCG@20': '0.0342'}
2025-03-08 02:11:34,284 - EarlyStopping counter: 3 out of 10
2025-03-08 02:12:29,389 - {'epoch': 24, 'rec_loss': '7.5052'}
2025-03-08 02:12:50,626 - {'Epoch': 24, 'HR@5': '0.0313', 'NDCG@5': '0.0198', 'HR@10': '0.0514', 'NDCG@10': '0.0263', 'HR@20': '0.0829', 'NDCG@20': '0.0341'}
2025-03-08 02:12:50,629 - EarlyStopping counter: 4 out of 10
2025-03-08 02:13:37,697 - {'epoch': 25, 'rec_loss': '7.4984'}
2025-03-08 02:14:00,962 - {'Epoch': 25, 'HR@5': '0.0321', 'NDCG@5': '0.0201', 'HR@10': '0.0530', 'NDCG@10': '0.0268', 'HR@20': '0.0826', 'NDCG@20': '0.0343'}
2025-03-08 02:14:00,965 - EarlyStopping counter: 5 out of 10
2025-03-08 02:14:57,711 - {'epoch': 26, 'rec_loss': '7.4788'}
2025-03-08 02:15:22,058 - {'Epoch': 26, 'HR@5': '0.0308', 'NDCG@5': '0.0193', 'HR@10': '0.0516', 'NDCG@10': '0.0260', 'HR@20': '0.0820', 'NDCG@20': '0.0336'}
2025-03-08 02:15:22,060 - EarlyStopping counter: 6 out of 10
2025-03-08 02:16:16,781 - {'epoch': 27, 'rec_loss': '7.4745'}
2025-03-08 02:16:40,798 - {'Epoch': 27, 'HR@5': '0.0317', 'NDCG@5': '0.0200', 'HR@10': '0.0521', 'NDCG@10': '0.0265', 'HR@20': '0.0837', 'NDCG@20': '0.0344'}
2025-03-08 02:16:40,810 - EarlyStopping counter: 7 out of 10
2025-03-08 02:17:30,024 - {'epoch': 28, 'rec_loss': '7.4706'}
2025-03-08 02:17:49,695 - {'Epoch': 28, 'HR@5': '0.0320', 'NDCG@5': '0.0198', 'HR@10': '0.0526', 'NDCG@10': '0.0264', 'HR@20': '0.0828', 'NDCG@20': '0.0340'}
2025-03-08 02:17:49,702 - EarlyStopping counter: 8 out of 10
2025-03-08 02:18:31,314 - {'epoch': 29, 'rec_loss': '7.4516'}
2025-03-08 02:18:54,506 - {'Epoch': 29, 'HR@5': '0.0319', 'NDCG@5': '0.0201', 'HR@10': '0.0532', 'NDCG@10': '0.0269', 'HR@20': '0.0839', 'NDCG@20': '0.0346'}
2025-03-08 02:18:54,511 - EarlyStopping counter: 9 out of 10
2025-03-08 02:19:48,959 - {'epoch': 30, 'rec_loss': '7.4506'}
2025-03-08 02:20:10,408 - {'Epoch': 30, 'HR@5': '0.0315', 'NDCG@5': '0.0197', 'HR@10': '0.0522', 'NDCG@10': '0.0263', 'HR@20': '0.0844', 'NDCG@20': '0.0344'}
2025-03-08 02:20:10,413 - EarlyStopping counter: 10 out of 10
2025-03-08 02:20:10,413 - Early stopping
2025-03-08 02:20:10,413 - ---------------Test Score---------------
2025-03-08 02:20:31,548 - {'Epoch': 0, 'HR@5': '0.0276', 'NDCG@5': '0.0177', 'HR@10': '0.0463', 'NDCG@10': '0.0238', 'HR@20': '0.0751', 'NDCG@20': '0.0310'}
2025-03-08 02:20:31,557 - Scale_Yelp
2025-03-08 02:20:31,557 - {'Epoch': 0, 'HR@5': '0.0276', 'NDCG@5': '0.0177', 'HR@10': '0.0463', 'NDCG@10': '0.0238', 'HR@20': '0.0751', 'NDCG@20': '0.0310'}
2025-03-08 10:17:20,857 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 24], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-08 10:17:24,640 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-08 10:17:24,645 - Total Parameters: 1437093
2025-03-08 10:18:03,175 - {'epoch': 0, 'rec_loss': '9.5703'}
2025-03-08 10:18:23,496 - {'Epoch': 0, 'HR@5': '0.0077', 'NDCG@5': '0.0051', 'HR@10': '0.0141', 'NDCG@10': '0.0072', 'HR@20': '0.0243', 'NDCG@20': '0.0097'}
2025-03-08 10:18:23,497 - Validation score increased.  Saving model ...
2025-03-08 10:19:02,211 - {'epoch': 1, 'rec_loss': '9.0915'}
2025-03-08 10:19:20,541 - {'Epoch': 1, 'HR@5': '0.0131', 'NDCG@5': '0.0082', 'HR@10': '0.0203', 'NDCG@10': '0.0106', 'HR@20': '0.0344', 'NDCG@20': '0.0141'}
2025-03-08 10:19:20,543 - Validation score increased.  Saving model ...
2025-03-08 10:19:51,345 - {'epoch': 2, 'rec_loss': '8.7178'}
2025-03-08 10:20:08,507 - {'Epoch': 2, 'HR@5': '0.0152', 'NDCG@5': '0.0094', 'HR@10': '0.0276', 'NDCG@10': '0.0134', 'HR@20': '0.0453', 'NDCG@20': '0.0179'}
2025-03-08 10:20:08,509 - Validation score increased.  Saving model ...
2025-03-08 10:20:45,339 - {'epoch': 3, 'rec_loss': '8.4720'}
2025-03-08 10:21:04,499 - {'Epoch': 3, 'HR@5': '0.0196', 'NDCG@5': '0.0120', 'HR@10': '0.0331', 'NDCG@10': '0.0163', 'HR@20': '0.0525', 'NDCG@20': '0.0212'}
2025-03-08 10:21:04,501 - Validation score increased.  Saving model ...
2025-03-08 10:21:41,850 - {'epoch': 4, 'rec_loss': '8.2877'}
2025-03-08 10:22:00,676 - {'Epoch': 4, 'HR@5': '0.0208', 'NDCG@5': '0.0129', 'HR@10': '0.0360', 'NDCG@10': '0.0178', 'HR@20': '0.0582', 'NDCG@20': '0.0233'}
2025-03-08 10:22:00,679 - Validation score increased.  Saving model ...
2025-03-08 10:22:38,790 - {'epoch': 5, 'rec_loss': '8.1543'}
2025-03-08 10:22:58,026 - {'Epoch': 5, 'HR@5': '0.0227', 'NDCG@5': '0.0141', 'HR@10': '0.0383', 'NDCG@10': '0.0191', 'HR@20': '0.0622', 'NDCG@20': '0.0251'}
2025-03-08 10:22:58,030 - Validation score increased.  Saving model ...
2025-03-08 10:23:34,664 - {'epoch': 6, 'rec_loss': '8.0548'}
2025-03-08 10:23:51,895 - {'Epoch': 6, 'HR@5': '0.0226', 'NDCG@5': '0.0140', 'HR@10': '0.0397', 'NDCG@10': '0.0194', 'HR@20': '0.0676', 'NDCG@20': '0.0264'}
2025-03-08 10:23:51,897 - Validation score increased.  Saving model ...
2025-03-08 10:24:22,186 - {'epoch': 7, 'rec_loss': '7.9694'}
2025-03-08 10:24:39,814 - {'Epoch': 7, 'HR@5': '0.0238', 'NDCG@5': '0.0146', 'HR@10': '0.0406', 'NDCG@10': '0.0199', 'HR@20': '0.0696', 'NDCG@20': '0.0272'}
2025-03-08 10:24:39,816 - Validation score increased.  Saving model ...
2025-03-08 10:25:16,570 - {'epoch': 8, 'rec_loss': '7.8925'}
2025-03-08 10:25:35,548 - {'Epoch': 8, 'HR@5': '0.0254', 'NDCG@5': '0.0159', 'HR@10': '0.0431', 'NDCG@10': '0.0215', 'HR@20': '0.0697', 'NDCG@20': '0.0282'}
2025-03-08 10:25:35,553 - Validation score increased.  Saving model ...
2025-03-08 10:26:11,713 - {'epoch': 9, 'rec_loss': '7.8350'}
2025-03-08 10:26:30,754 - {'Epoch': 9, 'HR@5': '0.0268', 'NDCG@5': '0.0167', 'HR@10': '0.0444', 'NDCG@10': '0.0224', 'HR@20': '0.0713', 'NDCG@20': '0.0292'}
2025-03-08 10:26:30,757 - Validation score increased.  Saving model ...
2025-03-08 10:27:07,540 - {'epoch': 10, 'rec_loss': '7.7851'}
2025-03-08 10:27:26,565 - {'Epoch': 10, 'HR@5': '0.0253', 'NDCG@5': '0.0161', 'HR@10': '0.0429', 'NDCG@10': '0.0217', 'HR@20': '0.0735', 'NDCG@20': '0.0293'}
2025-03-08 10:27:26,568 - Validation score increased.  Saving model ...
2025-03-08 10:28:02,155 - {'epoch': 11, 'rec_loss': '7.7426'}
2025-03-08 10:28:18,599 - {'Epoch': 11, 'HR@5': '0.0275', 'NDCG@5': '0.0170', 'HR@10': '0.0466', 'NDCG@10': '0.0231', 'HR@20': '0.0747', 'NDCG@20': '0.0301'}
2025-03-08 10:28:18,600 - Validation score increased.  Saving model ...
2025-03-08 10:28:52,981 - {'epoch': 12, 'rec_loss': '7.7071'}
2025-03-08 10:29:12,033 - {'Epoch': 12, 'HR@5': '0.0276', 'NDCG@5': '0.0176', 'HR@10': '0.0463', 'NDCG@10': '0.0236', 'HR@20': '0.0750', 'NDCG@20': '0.0308'}
2025-03-08 10:29:12,036 - Validation score increased.  Saving model ...
2025-03-08 10:29:51,253 - {'epoch': 13, 'rec_loss': '7.6718'}
2025-03-08 10:30:10,123 - {'Epoch': 13, 'HR@5': '0.0279', 'NDCG@5': '0.0174', 'HR@10': '0.0466', 'NDCG@10': '0.0234', 'HR@20': '0.0745', 'NDCG@20': '0.0303'}
2025-03-08 10:30:10,125 - EarlyStopping counter: 1 out of 10
2025-03-08 10:30:46,640 - {'epoch': 14, 'rec_loss': '7.6410'}
2025-03-08 10:31:05,619 - {'Epoch': 14, 'HR@5': '0.0283', 'NDCG@5': '0.0179', 'HR@10': '0.0466', 'NDCG@10': '0.0238', 'HR@20': '0.0759', 'NDCG@20': '0.0311'}
2025-03-08 10:31:05,622 - Validation score increased.  Saving model ...
2025-03-08 10:31:41,909 - {'epoch': 15, 'rec_loss': '7.6202'}
2025-03-08 10:32:01,144 - {'Epoch': 15, 'HR@5': '0.0288', 'NDCG@5': '0.0178', 'HR@10': '0.0470', 'NDCG@10': '0.0237', 'HR@20': '0.0753', 'NDCG@20': '0.0308'}
2025-03-08 10:32:01,145 - EarlyStopping counter: 1 out of 10
2025-03-08 10:32:35,401 - {'epoch': 16, 'rec_loss': '7.5975'}
2025-03-08 10:32:52,311 - {'Epoch': 16, 'HR@5': '0.0281', 'NDCG@5': '0.0177', 'HR@10': '0.0475', 'NDCG@10': '0.0239', 'HR@20': '0.0777', 'NDCG@20': '0.0315'}
2025-03-08 10:32:52,312 - Validation score increased.  Saving model ...
2025-03-08 10:33:29,724 - {'epoch': 17, 'rec_loss': '7.5738'}
2025-03-08 10:33:49,185 - {'Epoch': 17, 'HR@5': '0.0283', 'NDCG@5': '0.0180', 'HR@10': '0.0478', 'NDCG@10': '0.0243', 'HR@20': '0.0779', 'NDCG@20': '0.0318'}
2025-03-08 10:33:49,187 - Validation score increased.  Saving model ...
2025-03-08 10:34:27,679 - {'epoch': 18, 'rec_loss': '7.5547'}
2025-03-08 10:34:47,094 - {'Epoch': 18, 'HR@5': '0.0279', 'NDCG@5': '0.0176', 'HR@10': '0.0476', 'NDCG@10': '0.0239', 'HR@20': '0.0791', 'NDCG@20': '0.0318'}
2025-03-08 10:34:47,097 - EarlyStopping counter: 1 out of 10
2025-03-08 10:35:24,620 - {'epoch': 19, 'rec_loss': '7.5438'}
2025-03-08 10:35:43,910 - {'Epoch': 19, 'HR@5': '0.0299', 'NDCG@5': '0.0188', 'HR@10': '0.0500', 'NDCG@10': '0.0253', 'HR@20': '0.0796', 'NDCG@20': '0.0327'}
2025-03-08 10:35:43,912 - Validation score increased.  Saving model ...
2025-03-08 10:36:21,373 - {'epoch': 20, 'rec_loss': '7.5230'}
2025-03-08 10:36:39,372 - {'Epoch': 20, 'HR@5': '0.0294', 'NDCG@5': '0.0185', 'HR@10': '0.0490', 'NDCG@10': '0.0248', 'HR@20': '0.0785', 'NDCG@20': '0.0322'}
2025-03-08 10:36:39,375 - EarlyStopping counter: 1 out of 10
2025-03-08 10:37:11,449 - {'epoch': 21, 'rec_loss': '7.5091'}
2025-03-08 10:37:29,213 - {'Epoch': 21, 'HR@5': '0.0291', 'NDCG@5': '0.0181', 'HR@10': '0.0492', 'NDCG@10': '0.0246', 'HR@20': '0.0779', 'NDCG@20': '0.0318'}
2025-03-08 10:37:29,216 - EarlyStopping counter: 2 out of 10
2025-03-08 10:38:06,894 - {'epoch': 22, 'rec_loss': '7.4983'}
2025-03-08 10:38:26,252 - {'Epoch': 22, 'HR@5': '0.0289', 'NDCG@5': '0.0181', 'HR@10': '0.0488', 'NDCG@10': '0.0246', 'HR@20': '0.0787', 'NDCG@20': '0.0321'}
2025-03-08 10:38:26,259 - EarlyStopping counter: 3 out of 10
2025-03-08 10:39:03,113 - {'epoch': 23, 'rec_loss': '7.4813'}
2025-03-08 10:39:22,810 - {'Epoch': 23, 'HR@5': '0.0292', 'NDCG@5': '0.0181', 'HR@10': '0.0496', 'NDCG@10': '0.0246', 'HR@20': '0.0799', 'NDCG@20': '0.0322'}
2025-03-08 10:39:22,814 - EarlyStopping counter: 4 out of 10
2025-03-08 10:39:59,223 - {'epoch': 24, 'rec_loss': '7.4701'}
2025-03-08 10:40:18,889 - {'Epoch': 24, 'HR@5': '0.0290', 'NDCG@5': '0.0182', 'HR@10': '0.0495', 'NDCG@10': '0.0247', 'HR@20': '0.0784', 'NDCG@20': '0.0320'}
2025-03-08 10:40:18,891 - EarlyStopping counter: 5 out of 10
2025-03-08 10:40:55,772 - {'epoch': 25, 'rec_loss': '7.4620'}
2025-03-08 10:41:12,062 - {'Epoch': 25, 'HR@5': '0.0291', 'NDCG@5': '0.0179', 'HR@10': '0.0493', 'NDCG@10': '0.0244', 'HR@20': '0.0802', 'NDCG@20': '0.0322'}
2025-03-08 10:41:12,063 - EarlyStopping counter: 6 out of 10
2025-03-08 10:41:42,634 - {'epoch': 26, 'rec_loss': '7.4552'}
2025-03-08 10:42:01,114 - {'Epoch': 26, 'HR@5': '0.0293', 'NDCG@5': '0.0183', 'HR@10': '0.0497', 'NDCG@10': '0.0248', 'HR@20': '0.0802', 'NDCG@20': '0.0325'}
2025-03-08 10:42:01,118 - EarlyStopping counter: 7 out of 10
2025-03-08 10:42:37,527 - {'epoch': 27, 'rec_loss': '7.4367'}
2025-03-08 10:42:56,876 - {'Epoch': 27, 'HR@5': '0.0294', 'NDCG@5': '0.0185', 'HR@10': '0.0507', 'NDCG@10': '0.0253', 'HR@20': '0.0803', 'NDCG@20': '0.0327'}
2025-03-08 10:42:56,878 - Validation score increased.  Saving model ...
2025-03-08 10:43:34,317 - {'epoch': 28, 'rec_loss': '7.4362'}
2025-03-08 10:43:53,837 - {'Epoch': 28, 'HR@5': '0.0296', 'NDCG@5': '0.0187', 'HR@10': '0.0500', 'NDCG@10': '0.0252', 'HR@20': '0.0807', 'NDCG@20': '0.0329'}
2025-03-08 10:43:53,843 - Validation score increased.  Saving model ...
2025-03-08 10:44:31,576 - {'epoch': 29, 'rec_loss': '7.4249'}
2025-03-08 10:44:50,527 - {'Epoch': 29, 'HR@5': '0.0292', 'NDCG@5': '0.0184', 'HR@10': '0.0502', 'NDCG@10': '0.0251', 'HR@20': '0.0809', 'NDCG@20': '0.0328'}
2025-03-08 10:44:50,530 - EarlyStopping counter: 1 out of 10
2025-03-08 10:45:25,704 - {'epoch': 30, 'rec_loss': '7.4154'}
2025-03-08 10:45:42,728 - {'Epoch': 30, 'HR@5': '0.0291', 'NDCG@5': '0.0185', 'HR@10': '0.0496', 'NDCG@10': '0.0250', 'HR@20': '0.0800', 'NDCG@20': '0.0327'}
2025-03-08 10:45:42,729 - EarlyStopping counter: 2 out of 10
2025-03-08 10:46:14,190 - {'epoch': 31, 'rec_loss': '7.4078'}
2025-03-08 10:46:33,897 - {'Epoch': 31, 'HR@5': '0.0302', 'NDCG@5': '0.0189', 'HR@10': '0.0504', 'NDCG@10': '0.0254', 'HR@20': '0.0817', 'NDCG@20': '0.0333'}
2025-03-08 10:46:33,900 - Validation score increased.  Saving model ...
2025-03-08 10:47:13,175 - {'epoch': 32, 'rec_loss': '7.4012'}
2025-03-08 10:47:32,836 - {'Epoch': 32, 'HR@5': '0.0299', 'NDCG@5': '0.0184', 'HR@10': '0.0493', 'NDCG@10': '0.0246', 'HR@20': '0.0808', 'NDCG@20': '0.0325'}
2025-03-08 10:47:32,839 - EarlyStopping counter: 1 out of 10
2025-03-08 10:48:08,649 - {'epoch': 33, 'rec_loss': '7.3983'}
2025-03-08 10:48:28,776 - {'Epoch': 33, 'HR@5': '0.0305', 'NDCG@5': '0.0192', 'HR@10': '0.0503', 'NDCG@10': '0.0255', 'HR@20': '0.0818', 'NDCG@20': '0.0335'}
2025-03-08 10:48:28,780 - Validation score increased.  Saving model ...
2025-03-08 10:49:06,559 - {'epoch': 34, 'rec_loss': '7.3923'}
2025-03-08 10:49:25,749 - {'Epoch': 34, 'HR@5': '0.0297', 'NDCG@5': '0.0186', 'HR@10': '0.0502', 'NDCG@10': '0.0252', 'HR@20': '0.0816', 'NDCG@20': '0.0330'}
2025-03-08 10:49:25,756 - EarlyStopping counter: 1 out of 10
2025-03-08 10:49:57,562 - {'epoch': 35, 'rec_loss': '7.3852'}
2025-03-08 10:50:14,560 - {'Epoch': 35, 'HR@5': '0.0298', 'NDCG@5': '0.0187', 'HR@10': '0.0501', 'NDCG@10': '0.0252', 'HR@20': '0.0820', 'NDCG@20': '0.0332'}
2025-03-08 10:50:14,561 - EarlyStopping counter: 2 out of 10
2025-03-08 10:50:48,635 - {'epoch': 36, 'rec_loss': '7.3773'}
2025-03-08 10:51:07,924 - {'Epoch': 36, 'HR@5': '0.0303', 'NDCG@5': '0.0189', 'HR@10': '0.0507', 'NDCG@10': '0.0255', 'HR@20': '0.0815', 'NDCG@20': '0.0332'}
2025-03-08 10:51:07,926 - EarlyStopping counter: 3 out of 10
2025-03-08 10:51:46,086 - {'epoch': 37, 'rec_loss': '7.3722'}
2025-03-08 10:52:05,048 - {'Epoch': 37, 'HR@5': '0.0305', 'NDCG@5': '0.0192', 'HR@10': '0.0498', 'NDCG@10': '0.0254', 'HR@20': '0.0817', 'NDCG@20': '0.0334'}
2025-03-08 10:52:05,049 - EarlyStopping counter: 4 out of 10
2025-03-08 10:52:43,513 - {'epoch': 38, 'rec_loss': '7.3635'}
2025-03-08 10:53:02,705 - {'Epoch': 38, 'HR@5': '0.0304', 'NDCG@5': '0.0192', 'HR@10': '0.0509', 'NDCG@10': '0.0258', 'HR@20': '0.0820', 'NDCG@20': '0.0336'}
2025-03-08 10:53:02,709 - Validation score increased.  Saving model ...
2025-03-08 10:53:40,198 - {'epoch': 39, 'rec_loss': '7.3604'}
2025-03-08 10:53:59,337 - {'Epoch': 39, 'HR@5': '0.0307', 'NDCG@5': '0.0194', 'HR@10': '0.0503', 'NDCG@10': '0.0256', 'HR@20': '0.0800', 'NDCG@20': '0.0331'}
2025-03-08 10:53:59,343 - EarlyStopping counter: 1 out of 10
2025-03-08 10:54:31,172 - {'epoch': 40, 'rec_loss': '7.3521'}
2025-03-08 10:54:48,127 - {'Epoch': 40, 'HR@5': '0.0296', 'NDCG@5': '0.0189', 'HR@10': '0.0502', 'NDCG@10': '0.0254', 'HR@20': '0.0811', 'NDCG@20': '0.0332'}
2025-03-08 10:54:48,129 - EarlyStopping counter: 2 out of 10
2025-03-08 10:55:24,109 - {'epoch': 41, 'rec_loss': '7.3510'}
2025-03-08 10:55:43,301 - {'Epoch': 41, 'HR@5': '0.0296', 'NDCG@5': '0.0187', 'HR@10': '0.0493', 'NDCG@10': '0.0250', 'HR@20': '0.0801', 'NDCG@20': '0.0327'}
2025-03-08 10:55:43,303 - EarlyStopping counter: 3 out of 10
2025-03-08 10:56:22,252 - {'epoch': 42, 'rec_loss': '7.3439'}
2025-03-08 10:56:41,385 - {'Epoch': 42, 'HR@5': '0.0298', 'NDCG@5': '0.0190', 'HR@10': '0.0497', 'NDCG@10': '0.0254', 'HR@20': '0.0806', 'NDCG@20': '0.0332'}
2025-03-08 10:56:41,390 - EarlyStopping counter: 4 out of 10
2025-03-08 10:57:18,349 - {'epoch': 43, 'rec_loss': '7.3444'}
2025-03-08 10:57:38,664 - {'Epoch': 43, 'HR@5': '0.0304', 'NDCG@5': '0.0190', 'HR@10': '0.0517', 'NDCG@10': '0.0259', 'HR@20': '0.0821', 'NDCG@20': '0.0335'}
2025-03-08 10:57:38,668 - EarlyStopping counter: 5 out of 10
2025-03-08 10:58:15,749 - {'epoch': 44, 'rec_loss': '7.3345'}
2025-03-08 10:58:33,947 - {'Epoch': 44, 'HR@5': '0.0303', 'NDCG@5': '0.0191', 'HR@10': '0.0498', 'NDCG@10': '0.0254', 'HR@20': '0.0814', 'NDCG@20': '0.0333'}
2025-03-08 10:58:33,948 - EarlyStopping counter: 6 out of 10
2025-03-08 10:59:04,721 - {'epoch': 45, 'rec_loss': '7.3322'}
2025-03-08 10:59:21,954 - {'Epoch': 45, 'HR@5': '0.0304', 'NDCG@5': '0.0191', 'HR@10': '0.0503', 'NDCG@10': '0.0255', 'HR@20': '0.0800', 'NDCG@20': '0.0330'}
2025-03-08 10:59:21,956 - EarlyStopping counter: 7 out of 10
2025-03-08 10:59:58,268 - {'epoch': 46, 'rec_loss': '7.3262'}
2025-03-08 11:00:17,374 - {'Epoch': 46, 'HR@5': '0.0299', 'NDCG@5': '0.0190', 'HR@10': '0.0497', 'NDCG@10': '0.0253', 'HR@20': '0.0814', 'NDCG@20': '0.0332'}
2025-03-08 11:00:17,375 - EarlyStopping counter: 8 out of 10
2025-03-08 11:00:54,707 - {'epoch': 47, 'rec_loss': '7.3302'}
2025-03-08 11:01:13,964 - {'Epoch': 47, 'HR@5': '0.0299', 'NDCG@5': '0.0188', 'HR@10': '0.0499', 'NDCG@10': '0.0253', 'HR@20': '0.0805', 'NDCG@20': '0.0329'}
2025-03-08 11:01:13,969 - EarlyStopping counter: 9 out of 10
2025-03-08 11:01:52,222 - {'epoch': 48, 'rec_loss': '7.3222'}
2025-03-08 11:02:11,227 - {'Epoch': 48, 'HR@5': '0.0302', 'NDCG@5': '0.0189', 'HR@10': '0.0502', 'NDCG@10': '0.0253', 'HR@20': '0.0800', 'NDCG@20': '0.0328'}
2025-03-08 11:02:11,229 - EarlyStopping counter: 10 out of 10
2025-03-08 11:02:11,229 - Early stopping
2025-03-08 11:02:11,229 - ---------------Test Score---------------
2025-03-08 11:02:31,466 - {'Epoch': 0, 'HR@5': '0.0281', 'NDCG@5': '0.0179', 'HR@10': '0.0464', 'NDCG@10': '0.0238', 'HR@20': '0.0748', 'NDCG@20': '0.0309'}
2025-03-08 11:02:31,468 - Scale_Yelp
2025-03-08 11:02:31,469 - {'Epoch': 0, 'HR@5': '0.0281', 'NDCG@5': '0.0179', 'HR@10': '0.0464', 'NDCG@10': '0.0238', 'HR@20': '0.0748', 'NDCG@20': '0.0309'}
2025-03-15 15:20:15,615 - Namespace(data_dir='./data/', output_dir='output/', data_name='Yelp', do_eval=False, load_model=None, train_name='Scale_Yelp', num_items=10, num_users=30432, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 24], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Yelp.txt', item_size=20034, checkpoint_path='output/Scale_Yelp.pt', same_target_path='./data/Yelp_same_target.npy')
2025-03-15 15:20:30,331 - ScaleRecModel(
  (item_embeddings): Embedding(20034, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-15 15:20:30,356 - Total Parameters: 1437093
