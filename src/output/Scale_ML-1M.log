2025-02-16 15:51:19,507 - Namespace(data_dir='./data/', output_dir='output/', data_name='ML-1M', do_eval=False, load_model=None, train_name='Scale_ML-1M', num_items=10, num_users=6041, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, cuda_condition=True, data_file='./data/ML-1M.txt', item_size=3417, checkpoint_path='output/Scale_ML-1M.pt', same_target_path='./data/ML-1M_same_target.npy')
2025-02-16 15:51:22,243 - HyperRecModel(
  (item_embeddings): Embedding(3417, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-16 15:51:22,247 - Total Parameters: 373605
2025-02-16 15:52:13,151 - {'epoch': 0, 'rec_loss': '7.1420'}
2025-02-16 15:52:14,634 - {'Epoch': 0, 'HR@5': '0.1180', 'NDCG@5': '0.0751', 'HR@10': '0.1816', 'NDCG@10': '0.0955', 'HR@20': '0.2641', 'NDCG@20': '0.1162'}
2025-02-16 15:52:14,636 - Validation score increased.  Saving model ...
2025-02-16 15:53:05,713 - {'epoch': 1, 'rec_loss': '6.4006'}
2025-02-16 15:53:07,188 - {'Epoch': 1, 'HR@5': '0.1435', 'NDCG@5': '0.0957', 'HR@10': '0.2260', 'NDCG@10': '0.1221', 'HR@20': '0.3220', 'NDCG@20': '0.1463'}
2025-02-16 15:53:07,189 - Validation score increased.  Saving model ...
2025-02-16 15:53:57,624 - {'epoch': 2, 'rec_loss': '6.2300'}
2025-02-16 15:53:59,158 - {'Epoch': 2, 'HR@5': '0.1672', 'NDCG@5': '0.1113', 'HR@10': '0.2432', 'NDCG@10': '0.1357', 'HR@20': '0.3485', 'NDCG@20': '0.1622'}
2025-02-16 15:53:59,159 - Validation score increased.  Saving model ...
2025-02-16 15:54:47,907 - {'epoch': 3, 'rec_loss': '6.1524'}
2025-02-16 15:54:49,476 - {'Epoch': 3, 'HR@5': '0.1699', 'NDCG@5': '0.1105', 'HR@10': '0.2603', 'NDCG@10': '0.1394', 'HR@20': '0.3619', 'NDCG@20': '0.1650'}
2025-02-16 15:54:49,477 - Validation score increased.  Saving model ...
2025-02-16 15:55:37,685 - {'epoch': 4, 'rec_loss': '6.1057'}
2025-02-16 15:55:39,209 - {'Epoch': 4, 'HR@5': '0.1738', 'NDCG@5': '0.1147', 'HR@10': '0.2621', 'NDCG@10': '0.1430', 'HR@20': '0.3664', 'NDCG@20': '0.1693'}
2025-02-16 15:55:39,210 - Validation score increased.  Saving model ...
2025-02-16 15:56:27,531 - {'epoch': 5, 'rec_loss': '6.0746'}
2025-02-16 15:56:28,992 - {'Epoch': 5, 'HR@5': '0.1760', 'NDCG@5': '0.1163', 'HR@10': '0.2636', 'NDCG@10': '0.1446', 'HR@20': '0.3758', 'NDCG@20': '0.1728'}
2025-02-16 15:56:28,993 - Validation score increased.  Saving model ...
2025-02-16 15:57:16,962 - {'epoch': 6, 'rec_loss': '6.0491'}
2025-02-16 15:57:18,539 - {'Epoch': 6, 'HR@5': '0.1709', 'NDCG@5': '0.1124', 'HR@10': '0.2623', 'NDCG@10': '0.1420', 'HR@20': '0.3715', 'NDCG@20': '0.1696'}
2025-02-16 15:57:18,540 - EarlyStopping counter: 1 out of 10
2025-02-16 15:58:09,430 - {'epoch': 7, 'rec_loss': '6.0294'}
2025-02-16 15:58:10,884 - {'Epoch': 7, 'HR@5': '0.1828', 'NDCG@5': '0.1173', 'HR@10': '0.2675', 'NDCG@10': '0.1445', 'HR@20': '0.3790', 'NDCG@20': '0.1727'}
2025-02-16 15:58:10,885 - EarlyStopping counter: 2 out of 10
2025-02-16 15:58:59,807 - {'epoch': 8, 'rec_loss': '6.0138'}
2025-02-16 15:59:01,335 - {'Epoch': 8, 'HR@5': '0.1763', 'NDCG@5': '0.1150', 'HR@10': '0.2690', 'NDCG@10': '0.1448', 'HR@20': '0.3800', 'NDCG@20': '0.1728'}
2025-02-16 15:59:01,336 - EarlyStopping counter: 3 out of 10
2025-02-16 15:59:48,504 - {'epoch': 9, 'rec_loss': '6.0020'}
2025-02-16 15:59:50,064 - {'Epoch': 9, 'HR@5': '0.1770', 'NDCG@5': '0.1159', 'HR@10': '0.2677', 'NDCG@10': '0.1451', 'HR@20': '0.3841', 'NDCG@20': '0.1744'}
2025-02-16 15:59:50,065 - Validation score increased.  Saving model ...
2025-02-16 16:00:37,441 - {'epoch': 10, 'rec_loss': '5.9840'}
2025-02-16 16:00:39,108 - {'Epoch': 10, 'HR@5': '0.1800', 'NDCG@5': '0.1178', 'HR@10': '0.2742', 'NDCG@10': '0.1481', 'HR@20': '0.3838', 'NDCG@20': '0.1758'}
2025-02-16 16:00:39,109 - Validation score increased.  Saving model ...
2025-02-16 16:01:30,447 - {'epoch': 11, 'rec_loss': '5.9750'}
2025-02-16 16:01:32,176 - {'Epoch': 11, 'HR@5': '0.1740', 'NDCG@5': '0.1134', 'HR@10': '0.2685', 'NDCG@10': '0.1437', 'HR@20': '0.3828', 'NDCG@20': '0.1725'}
2025-02-16 16:01:32,177 - EarlyStopping counter: 1 out of 10
2025-02-16 16:02:21,881 - {'epoch': 12, 'rec_loss': '5.9663'}
2025-02-16 16:02:23,378 - {'Epoch': 12, 'HR@5': '0.1818', 'NDCG@5': '0.1182', 'HR@10': '0.2733', 'NDCG@10': '0.1478', 'HR@20': '0.3869', 'NDCG@20': '0.1766'}
2025-02-16 16:02:23,379 - Validation score increased.  Saving model ...
2025-02-16 16:03:13,027 - {'epoch': 13, 'rec_loss': '5.9580'}
2025-02-16 16:03:14,564 - {'Epoch': 13, 'HR@5': '0.1801', 'NDCG@5': '0.1176', 'HR@10': '0.2785', 'NDCG@10': '0.1493', 'HR@20': '0.3902', 'NDCG@20': '0.1774'}
2025-02-16 16:03:14,565 - Validation score increased.  Saving model ...
2025-02-16 16:04:03,756 - {'epoch': 14, 'rec_loss': '5.9525'}
2025-02-16 16:04:05,269 - {'Epoch': 14, 'HR@5': '0.1781', 'NDCG@5': '0.1181', 'HR@10': '0.2737', 'NDCG@10': '0.1487', 'HR@20': '0.3851', 'NDCG@20': '0.1769'}
2025-02-16 16:04:05,270 - EarlyStopping counter: 1 out of 10
2025-02-16 16:04:54,544 - {'epoch': 15, 'rec_loss': '5.9445'}
2025-02-16 16:04:56,081 - {'Epoch': 15, 'HR@5': '0.1757', 'NDCG@5': '0.1177', 'HR@10': '0.2730', 'NDCG@10': '0.1490', 'HR@20': '0.3833', 'NDCG@20': '0.1769'}
2025-02-16 16:04:56,082 - EarlyStopping counter: 2 out of 10
2025-02-16 16:05:44,169 - {'epoch': 16, 'rec_loss': '5.9337'}
2025-02-16 16:05:45,738 - {'Epoch': 16, 'HR@5': '0.1826', 'NDCG@5': '0.1191', 'HR@10': '0.2775', 'NDCG@10': '0.1497', 'HR@20': '0.3912', 'NDCG@20': '0.1784'}
2025-02-16 16:05:45,739 - Validation score increased.  Saving model ...
2025-02-16 16:06:33,895 - {'epoch': 17, 'rec_loss': '5.9303'}
2025-02-16 16:06:35,413 - {'Epoch': 17, 'HR@5': '0.1826', 'NDCG@5': '0.1181', 'HR@10': '0.2738', 'NDCG@10': '0.1475', 'HR@20': '0.3859', 'NDCG@20': '0.1758'}
2025-02-16 16:06:35,415 - EarlyStopping counter: 1 out of 10
2025-02-16 16:07:24,760 - {'epoch': 18, 'rec_loss': '5.9255'}
2025-02-16 16:07:26,278 - {'Epoch': 18, 'HR@5': '0.1844', 'NDCG@5': '0.1201', 'HR@10': '0.2768', 'NDCG@10': '0.1498', 'HR@20': '0.3927', 'NDCG@20': '0.1791'}
2025-02-16 16:07:26,279 - Validation score increased.  Saving model ...
2025-02-16 16:08:15,482 - {'epoch': 19, 'rec_loss': '5.9205'}
2025-02-16 16:08:16,951 - {'Epoch': 19, 'HR@5': '0.1796', 'NDCG@5': '0.1160', 'HR@10': '0.2776', 'NDCG@10': '0.1476', 'HR@20': '0.3894', 'NDCG@20': '0.1758'}
2025-02-16 16:08:16,953 - EarlyStopping counter: 1 out of 10
2025-02-16 16:09:06,559 - {'epoch': 20, 'rec_loss': '5.9159'}
2025-02-16 16:09:08,063 - {'Epoch': 20, 'HR@5': '0.1825', 'NDCG@5': '0.1181', 'HR@10': '0.2828', 'NDCG@10': '0.1505', 'HR@20': '0.3947', 'NDCG@20': '0.1788'}
2025-02-16 16:09:08,064 - EarlyStopping counter: 2 out of 10
2025-02-16 16:09:57,567 - {'epoch': 21, 'rec_loss': '5.9101'}
2025-02-16 16:09:59,115 - {'Epoch': 21, 'HR@5': '0.1801', 'NDCG@5': '0.1163', 'HR@10': '0.2725', 'NDCG@10': '0.1462', 'HR@20': '0.3899', 'NDCG@20': '0.1759'}
2025-02-16 16:09:59,116 - EarlyStopping counter: 3 out of 10
2025-02-16 16:10:48,735 - {'epoch': 22, 'rec_loss': '5.9062'}
2025-02-16 16:10:50,298 - {'Epoch': 22, 'HR@5': '0.1823', 'NDCG@5': '0.1192', 'HR@10': '0.2800', 'NDCG@10': '0.1506', 'HR@20': '0.3937', 'NDCG@20': '0.1794'}
2025-02-16 16:10:50,299 - Validation score increased.  Saving model ...
2025-02-16 16:11:39,259 - {'epoch': 23, 'rec_loss': '5.8974'}
2025-02-16 16:11:40,789 - {'Epoch': 23, 'HR@5': '0.1815', 'NDCG@5': '0.1182', 'HR@10': '0.2773', 'NDCG@10': '0.1488', 'HR@20': '0.3930', 'NDCG@20': '0.1780'}
2025-02-16 16:11:40,791 - EarlyStopping counter: 1 out of 10
2025-02-16 16:12:30,387 - {'epoch': 24, 'rec_loss': '5.8960'}
2025-02-16 16:12:31,888 - {'Epoch': 24, 'HR@5': '0.1843', 'NDCG@5': '0.1203', 'HR@10': '0.2788', 'NDCG@10': '0.1508', 'HR@20': '0.3955', 'NDCG@20': '0.1802'}
2025-02-16 16:12:31,889 - Validation score increased.  Saving model ...
2025-02-16 16:13:22,612 - {'epoch': 25, 'rec_loss': '5.8892'}
2025-02-16 16:13:24,345 - {'Epoch': 25, 'HR@5': '0.1869', 'NDCG@5': '0.1210', 'HR@10': '0.2806', 'NDCG@10': '0.1512', 'HR@20': '0.4013', 'NDCG@20': '0.1816'}
2025-02-16 16:13:24,346 - Validation score increased.  Saving model ...
2025-02-16 16:14:16,302 - {'epoch': 26, 'rec_loss': '5.8869'}
2025-02-16 16:14:17,946 - {'Epoch': 26, 'HR@5': '0.1846', 'NDCG@5': '0.1208', 'HR@10': '0.2780', 'NDCG@10': '0.1507', 'HR@20': '0.3954', 'NDCG@20': '0.1804'}
2025-02-16 16:14:17,948 - EarlyStopping counter: 1 out of 10
2025-02-16 16:15:09,171 - {'epoch': 27, 'rec_loss': '5.8873'}
2025-02-16 16:15:10,673 - {'Epoch': 27, 'HR@5': '0.1874', 'NDCG@5': '0.1236', 'HR@10': '0.2823', 'NDCG@10': '0.1540', 'HR@20': '0.4026', 'NDCG@20': '0.1845'}
2025-02-16 16:15:10,675 - Validation score increased.  Saving model ...
2025-02-16 16:16:02,011 - {'epoch': 28, 'rec_loss': '5.8823'}
2025-02-16 16:16:03,511 - {'Epoch': 28, 'HR@5': '0.1828', 'NDCG@5': '0.1185', 'HR@10': '0.2762', 'NDCG@10': '0.1485', 'HR@20': '0.3955', 'NDCG@20': '0.1785'}
2025-02-16 16:16:03,512 - EarlyStopping counter: 1 out of 10
2025-02-16 16:16:59,442 - {'epoch': 29, 'rec_loss': '5.8805'}
2025-02-16 16:17:00,936 - {'Epoch': 29, 'HR@5': '0.1825', 'NDCG@5': '0.1196', 'HR@10': '0.2776', 'NDCG@10': '0.1502', 'HR@20': '0.3969', 'NDCG@20': '0.1803'}
2025-02-16 16:17:00,937 - EarlyStopping counter: 2 out of 10
2025-02-16 16:17:53,498 - {'epoch': 30, 'rec_loss': '5.8770'}
2025-02-16 16:17:54,950 - {'Epoch': 30, 'HR@5': '0.1825', 'NDCG@5': '0.1197', 'HR@10': '0.2753', 'NDCG@10': '0.1497', 'HR@20': '0.3955', 'NDCG@20': '0.1801'}
2025-02-16 16:17:54,951 - EarlyStopping counter: 3 out of 10
2025-02-16 16:18:46,590 - {'epoch': 31, 'rec_loss': '5.8737'}
2025-02-16 16:18:48,169 - {'Epoch': 31, 'HR@5': '0.1820', 'NDCG@5': '0.1194', 'HR@10': '0.2839', 'NDCG@10': '0.1521', 'HR@20': '0.3974', 'NDCG@20': '0.1809'}
2025-02-16 16:18:48,170 - EarlyStopping counter: 4 out of 10
2025-02-16 16:19:38,296 - {'epoch': 32, 'rec_loss': '5.8717'}
2025-02-16 16:19:39,787 - {'Epoch': 32, 'HR@5': '0.1848', 'NDCG@5': '0.1197', 'HR@10': '0.2826', 'NDCG@10': '0.1513', 'HR@20': '0.3983', 'NDCG@20': '0.1804'}
2025-02-16 16:19:39,788 - EarlyStopping counter: 5 out of 10
2025-02-16 16:20:30,014 - {'epoch': 33, 'rec_loss': '5.8695'}
2025-02-16 16:20:31,507 - {'Epoch': 33, 'HR@5': '0.1882', 'NDCG@5': '0.1224', 'HR@10': '0.2833', 'NDCG@10': '0.1528', 'HR@20': '0.3969', 'NDCG@20': '0.1815'}
2025-02-16 16:20:31,508 - EarlyStopping counter: 6 out of 10
2025-02-16 16:21:19,130 - {'epoch': 34, 'rec_loss': '5.8660'}
2025-02-16 16:21:20,703 - {'Epoch': 34, 'HR@5': '0.1846', 'NDCG@5': '0.1197', 'HR@10': '0.2820', 'NDCG@10': '0.1509', 'HR@20': '0.4015', 'NDCG@20': '0.1810'}
2025-02-16 16:21:20,704 - EarlyStopping counter: 7 out of 10
2025-02-16 16:22:11,008 - {'epoch': 35, 'rec_loss': '5.8655'}
2025-02-16 16:22:12,454 - {'Epoch': 35, 'HR@5': '0.1838', 'NDCG@5': '0.1198', 'HR@10': '0.2796', 'NDCG@10': '0.1508', 'HR@20': '0.3962', 'NDCG@20': '0.1802'}
2025-02-16 16:22:12,456 - EarlyStopping counter: 8 out of 10
2025-02-16 16:23:02,777 - {'epoch': 36, 'rec_loss': '5.8625'}
2025-02-16 16:23:04,341 - {'Epoch': 36, 'HR@5': '0.1823', 'NDCG@5': '0.1191', 'HR@10': '0.2811', 'NDCG@10': '0.1509', 'HR@20': '0.3980', 'NDCG@20': '0.1804'}
2025-02-16 16:23:04,342 - EarlyStopping counter: 9 out of 10
2025-02-16 16:23:57,268 - {'epoch': 37, 'rec_loss': '5.8591'}
2025-02-16 16:23:58,763 - {'Epoch': 37, 'HR@5': '0.1873', 'NDCG@5': '0.1223', 'HR@10': '0.2834', 'NDCG@10': '0.1532', 'HR@20': '0.3990', 'NDCG@20': '0.1825'}
2025-02-16 16:23:58,764 - EarlyStopping counter: 10 out of 10
2025-02-16 16:23:58,764 - Early stopping
2025-02-16 16:23:58,764 - ---------------Test Score---------------
2025-02-16 16:24:00,250 - {'Epoch': 0, 'HR@5': '0.1838', 'NDCG@5': '0.1240', 'HR@10': '0.2662', 'NDCG@10': '0.1505', 'HR@20': '0.3780', 'NDCG@20': '0.1787'}
2025-02-16 16:24:00,251 - Scale_ML-1M
2025-02-16 16:24:00,251 - {'Epoch': 0, 'HR@5': '0.1838', 'NDCG@5': '0.1240', 'HR@10': '0.2662', 'NDCG@10': '0.1505', 'HR@20': '0.3780', 'NDCG@20': '0.1787'}
2025-02-25 23:07:38,100 - Namespace(data_dir='./data/', output_dir='output/', data_name='ML-1M', do_eval=False, load_model=None, train_name='Scale_ML-1M', num_items=10, num_users=6041, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/ML-1M.txt', item_size=3417, checkpoint_path='output/Scale_ML-1M.pt', same_target_path='./data/ML-1M_same_target.npy')
2025-02-25 23:07:40,880 - ScaleRecModel(
  (item_embeddings): Embedding(3417, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-25 23:07:40,884 - Total Parameters: 373605
2025-02-25 23:08:32,489 - {'epoch': 0, 'rec_loss': '7.1420'}
2025-02-25 23:08:34,052 - {'Epoch': 0, 'HR@5': '0.1180', 'NDCG@5': '0.0751', 'HR@10': '0.1816', 'NDCG@10': '0.0955', 'HR@20': '0.2641', 'NDCG@20': '0.1162'}
2025-02-25 23:08:34,054 - Validation score increased.  Saving model ...
2025-02-25 23:09:23,575 - {'epoch': 1, 'rec_loss': '6.4006'}
2025-02-25 23:09:25,148 - {'Epoch': 1, 'HR@5': '0.1435', 'NDCG@5': '0.0957', 'HR@10': '0.2260', 'NDCG@10': '0.1221', 'HR@20': '0.3220', 'NDCG@20': '0.1463'}
2025-02-25 23:09:25,149 - Validation score increased.  Saving model ...
2025-02-25 23:10:14,960 - {'epoch': 2, 'rec_loss': '6.2300'}
2025-02-25 23:10:16,549 - {'Epoch': 2, 'HR@5': '0.1672', 'NDCG@5': '0.1113', 'HR@10': '0.2432', 'NDCG@10': '0.1357', 'HR@20': '0.3485', 'NDCG@20': '0.1622'}
2025-02-25 23:10:16,550 - Validation score increased.  Saving model ...
2025-02-25 23:11:02,011 - {'epoch': 3, 'rec_loss': '6.1524'}
2025-02-25 23:11:03,765 - {'Epoch': 3, 'HR@5': '0.1699', 'NDCG@5': '0.1105', 'HR@10': '0.2603', 'NDCG@10': '0.1394', 'HR@20': '0.3619', 'NDCG@20': '0.1650'}
2025-02-25 23:11:03,766 - Validation score increased.  Saving model ...
2025-02-25 23:11:52,535 - {'epoch': 4, 'rec_loss': '6.1057'}
2025-02-25 23:11:54,068 - {'Epoch': 4, 'HR@5': '0.1738', 'NDCG@5': '0.1147', 'HR@10': '0.2621', 'NDCG@10': '0.1430', 'HR@20': '0.3664', 'NDCG@20': '0.1693'}
2025-02-25 23:11:54,069 - Validation score increased.  Saving model ...
2025-02-25 23:12:45,440 - {'epoch': 5, 'rec_loss': '6.0746'}
2025-02-25 23:12:47,211 - {'Epoch': 5, 'HR@5': '0.1760', 'NDCG@5': '0.1163', 'HR@10': '0.2636', 'NDCG@10': '0.1446', 'HR@20': '0.3758', 'NDCG@20': '0.1728'}
2025-02-25 23:12:47,212 - Validation score increased.  Saving model ...
2025-02-25 23:13:41,956 - {'epoch': 6, 'rec_loss': '6.0491'}
2025-02-25 23:13:43,523 - {'Epoch': 6, 'HR@5': '0.1709', 'NDCG@5': '0.1124', 'HR@10': '0.2623', 'NDCG@10': '0.1420', 'HR@20': '0.3715', 'NDCG@20': '0.1696'}
2025-02-25 23:13:43,524 - EarlyStopping counter: 1 out of 10
2025-02-25 23:14:33,020 - {'epoch': 7, 'rec_loss': '6.0294'}
2025-02-25 23:14:34,578 - {'Epoch': 7, 'HR@5': '0.1828', 'NDCG@5': '0.1173', 'HR@10': '0.2675', 'NDCG@10': '0.1445', 'HR@20': '0.3790', 'NDCG@20': '0.1727'}
2025-02-25 23:14:34,579 - EarlyStopping counter: 2 out of 10
2025-02-25 23:15:25,061 - {'epoch': 8, 'rec_loss': '6.0138'}
2025-02-25 23:15:26,688 - {'Epoch': 8, 'HR@5': '0.1763', 'NDCG@5': '0.1150', 'HR@10': '0.2690', 'NDCG@10': '0.1448', 'HR@20': '0.3800', 'NDCG@20': '0.1728'}
2025-02-25 23:15:26,689 - EarlyStopping counter: 3 out of 10
2025-02-25 23:16:13,731 - {'epoch': 9, 'rec_loss': '6.0020'}
2025-02-25 23:16:15,280 - {'Epoch': 9, 'HR@5': '0.1770', 'NDCG@5': '0.1159', 'HR@10': '0.2677', 'NDCG@10': '0.1451', 'HR@20': '0.3841', 'NDCG@20': '0.1744'}
2025-02-25 23:16:15,281 - Validation score increased.  Saving model ...
2025-02-25 23:17:03,132 - {'epoch': 10, 'rec_loss': '5.9840'}
2025-02-25 23:17:04,746 - {'Epoch': 10, 'HR@5': '0.1800', 'NDCG@5': '0.1178', 'HR@10': '0.2742', 'NDCG@10': '0.1481', 'HR@20': '0.3838', 'NDCG@20': '0.1758'}
2025-02-25 23:17:04,747 - Validation score increased.  Saving model ...
2025-02-25 23:17:50,135 - {'epoch': 11, 'rec_loss': '5.9750'}
2025-02-25 23:17:51,883 - {'Epoch': 11, 'HR@5': '0.1740', 'NDCG@5': '0.1134', 'HR@10': '0.2685', 'NDCG@10': '0.1437', 'HR@20': '0.3828', 'NDCG@20': '0.1725'}
2025-02-25 23:17:51,884 - EarlyStopping counter: 1 out of 10
2025-02-25 23:18:39,959 - {'epoch': 12, 'rec_loss': '5.9663'}
2025-02-25 23:18:41,679 - {'Epoch': 12, 'HR@5': '0.1818', 'NDCG@5': '0.1182', 'HR@10': '0.2733', 'NDCG@10': '0.1478', 'HR@20': '0.3869', 'NDCG@20': '0.1766'}
2025-02-25 23:18:41,680 - Validation score increased.  Saving model ...
2025-02-25 23:19:28,086 - {'epoch': 13, 'rec_loss': '5.9580'}
2025-02-25 23:19:29,918 - {'Epoch': 13, 'HR@5': '0.1801', 'NDCG@5': '0.1176', 'HR@10': '0.2785', 'NDCG@10': '0.1493', 'HR@20': '0.3902', 'NDCG@20': '0.1774'}
2025-02-25 23:19:29,919 - Validation score increased.  Saving model ...
2025-02-25 23:20:15,277 - {'epoch': 14, 'rec_loss': '5.9525'}
2025-02-25 23:20:17,132 - {'Epoch': 14, 'HR@5': '0.1781', 'NDCG@5': '0.1181', 'HR@10': '0.2737', 'NDCG@10': '0.1487', 'HR@20': '0.3851', 'NDCG@20': '0.1769'}
2025-02-25 23:20:17,133 - EarlyStopping counter: 1 out of 10
2025-02-25 23:21:03,506 - {'epoch': 15, 'rec_loss': '5.9445'}
2025-02-25 23:21:05,338 - {'Epoch': 15, 'HR@5': '0.1757', 'NDCG@5': '0.1177', 'HR@10': '0.2730', 'NDCG@10': '0.1490', 'HR@20': '0.3833', 'NDCG@20': '0.1769'}
2025-02-25 23:21:05,339 - EarlyStopping counter: 2 out of 10
2025-02-25 23:21:50,969 - {'epoch': 16, 'rec_loss': '5.9337'}
2025-02-25 23:21:52,650 - {'Epoch': 16, 'HR@5': '0.1826', 'NDCG@5': '0.1191', 'HR@10': '0.2775', 'NDCG@10': '0.1497', 'HR@20': '0.3912', 'NDCG@20': '0.1784'}
2025-02-25 23:21:52,651 - Validation score increased.  Saving model ...
2025-02-25 23:22:37,834 - {'epoch': 17, 'rec_loss': '5.9303'}
2025-02-25 23:22:39,493 - {'Epoch': 17, 'HR@5': '0.1826', 'NDCG@5': '0.1181', 'HR@10': '0.2738', 'NDCG@10': '0.1475', 'HR@20': '0.3859', 'NDCG@20': '0.1758'}
2025-02-25 23:22:39,494 - EarlyStopping counter: 1 out of 10
2025-02-25 23:23:26,216 - {'epoch': 18, 'rec_loss': '5.9255'}
2025-02-25 23:23:27,908 - {'Epoch': 18, 'HR@5': '0.1844', 'NDCG@5': '0.1201', 'HR@10': '0.2768', 'NDCG@10': '0.1498', 'HR@20': '0.3927', 'NDCG@20': '0.1791'}
2025-02-25 23:23:27,909 - Validation score increased.  Saving model ...
2025-02-25 23:24:13,075 - {'epoch': 19, 'rec_loss': '5.9205'}
2025-02-25 23:24:14,786 - {'Epoch': 19, 'HR@5': '0.1796', 'NDCG@5': '0.1160', 'HR@10': '0.2776', 'NDCG@10': '0.1476', 'HR@20': '0.3894', 'NDCG@20': '0.1758'}
2025-02-25 23:24:14,787 - EarlyStopping counter: 1 out of 10
2025-02-25 23:25:03,184 - {'epoch': 20, 'rec_loss': '5.9159'}
2025-02-25 23:25:04,881 - {'Epoch': 20, 'HR@5': '0.1825', 'NDCG@5': '0.1181', 'HR@10': '0.2828', 'NDCG@10': '0.1505', 'HR@20': '0.3947', 'NDCG@20': '0.1788'}
2025-02-25 23:25:04,883 - EarlyStopping counter: 2 out of 10
2025-02-25 23:25:50,457 - {'epoch': 21, 'rec_loss': '5.9101'}
2025-02-25 23:25:52,146 - {'Epoch': 21, 'HR@5': '0.1801', 'NDCG@5': '0.1163', 'HR@10': '0.2725', 'NDCG@10': '0.1462', 'HR@20': '0.3899', 'NDCG@20': '0.1759'}
2025-02-25 23:25:52,147 - EarlyStopping counter: 3 out of 10
2025-02-25 23:26:37,457 - {'epoch': 22, 'rec_loss': '5.9062'}
2025-02-25 23:26:39,252 - {'Epoch': 22, 'HR@5': '0.1823', 'NDCG@5': '0.1192', 'HR@10': '0.2800', 'NDCG@10': '0.1506', 'HR@20': '0.3937', 'NDCG@20': '0.1794'}
2025-02-25 23:26:39,253 - Validation score increased.  Saving model ...
2025-02-25 23:27:24,680 - {'epoch': 23, 'rec_loss': '5.8974'}
2025-02-25 23:27:26,473 - {'Epoch': 23, 'HR@5': '0.1815', 'NDCG@5': '0.1182', 'HR@10': '0.2773', 'NDCG@10': '0.1488', 'HR@20': '0.3930', 'NDCG@20': '0.1780'}
2025-02-25 23:27:26,474 - EarlyStopping counter: 1 out of 10
2025-02-25 23:28:11,876 - {'epoch': 24, 'rec_loss': '5.8960'}
2025-02-25 23:28:13,682 - {'Epoch': 24, 'HR@5': '0.1843', 'NDCG@5': '0.1203', 'HR@10': '0.2788', 'NDCG@10': '0.1508', 'HR@20': '0.3955', 'NDCG@20': '0.1802'}
2025-02-25 23:28:13,683 - Validation score increased.  Saving model ...
2025-02-25 23:28:59,022 - {'epoch': 25, 'rec_loss': '5.8892'}
2025-02-25 23:29:00,647 - {'Epoch': 25, 'HR@5': '0.1869', 'NDCG@5': '0.1210', 'HR@10': '0.2806', 'NDCG@10': '0.1512', 'HR@20': '0.4013', 'NDCG@20': '0.1816'}
2025-02-25 23:29:00,648 - Validation score increased.  Saving model ...
2025-02-25 23:29:45,960 - {'epoch': 26, 'rec_loss': '5.8869'}
2025-02-25 23:29:47,791 - {'Epoch': 26, 'HR@5': '0.1846', 'NDCG@5': '0.1208', 'HR@10': '0.2780', 'NDCG@10': '0.1507', 'HR@20': '0.3954', 'NDCG@20': '0.1804'}
2025-02-25 23:29:47,792 - EarlyStopping counter: 1 out of 10
2025-02-25 23:30:33,021 - {'epoch': 27, 'rec_loss': '5.8873'}
2025-02-25 23:30:34,795 - {'Epoch': 27, 'HR@5': '0.1874', 'NDCG@5': '0.1236', 'HR@10': '0.2823', 'NDCG@10': '0.1540', 'HR@20': '0.4026', 'NDCG@20': '0.1845'}
2025-02-25 23:30:34,796 - Validation score increased.  Saving model ...
2025-02-25 23:31:20,080 - {'epoch': 28, 'rec_loss': '5.8823'}
2025-02-25 23:31:21,799 - {'Epoch': 28, 'HR@5': '0.1828', 'NDCG@5': '0.1185', 'HR@10': '0.2762', 'NDCG@10': '0.1485', 'HR@20': '0.3955', 'NDCG@20': '0.1785'}
2025-02-25 23:31:21,800 - EarlyStopping counter: 1 out of 10
2025-02-25 23:32:08,463 - {'epoch': 29, 'rec_loss': '5.8805'}
2025-02-25 23:32:10,308 - {'Epoch': 29, 'HR@5': '0.1825', 'NDCG@5': '0.1196', 'HR@10': '0.2776', 'NDCG@10': '0.1502', 'HR@20': '0.3969', 'NDCG@20': '0.1803'}
2025-02-25 23:32:10,309 - EarlyStopping counter: 2 out of 10
2025-02-25 23:32:55,503 - {'epoch': 30, 'rec_loss': '5.8770'}
2025-02-25 23:32:57,182 - {'Epoch': 30, 'HR@5': '0.1825', 'NDCG@5': '0.1197', 'HR@10': '0.2753', 'NDCG@10': '0.1497', 'HR@20': '0.3955', 'NDCG@20': '0.1801'}
2025-02-25 23:32:57,183 - EarlyStopping counter: 3 out of 10
2025-02-25 23:33:45,981 - {'epoch': 31, 'rec_loss': '5.8737'}
2025-02-25 23:33:47,711 - {'Epoch': 31, 'HR@5': '0.1820', 'NDCG@5': '0.1194', 'HR@10': '0.2839', 'NDCG@10': '0.1521', 'HR@20': '0.3974', 'NDCG@20': '0.1809'}
2025-02-25 23:33:47,712 - EarlyStopping counter: 4 out of 10
2025-02-25 23:34:36,137 - {'epoch': 32, 'rec_loss': '5.8717'}
2025-02-25 23:34:37,860 - {'Epoch': 32, 'HR@5': '0.1848', 'NDCG@5': '0.1197', 'HR@10': '0.2826', 'NDCG@10': '0.1513', 'HR@20': '0.3983', 'NDCG@20': '0.1804'}
2025-02-25 23:34:37,862 - EarlyStopping counter: 5 out of 10
2025-02-25 23:35:23,164 - {'epoch': 33, 'rec_loss': '5.8695'}
2025-02-25 23:35:24,838 - {'Epoch': 33, 'HR@5': '0.1882', 'NDCG@5': '0.1224', 'HR@10': '0.2833', 'NDCG@10': '0.1528', 'HR@20': '0.3969', 'NDCG@20': '0.1815'}
2025-02-25 23:35:24,839 - EarlyStopping counter: 6 out of 10
2025-02-25 23:36:12,029 - {'epoch': 34, 'rec_loss': '5.8660'}
2025-02-25 23:36:13,855 - {'Epoch': 34, 'HR@5': '0.1846', 'NDCG@5': '0.1197', 'HR@10': '0.2820', 'NDCG@10': '0.1509', 'HR@20': '0.4015', 'NDCG@20': '0.1810'}
2025-02-25 23:36:13,857 - EarlyStopping counter: 7 out of 10
2025-02-25 23:36:59,262 - {'epoch': 35, 'rec_loss': '5.8655'}
2025-02-25 23:37:01,077 - {'Epoch': 35, 'HR@5': '0.1838', 'NDCG@5': '0.1198', 'HR@10': '0.2796', 'NDCG@10': '0.1508', 'HR@20': '0.3962', 'NDCG@20': '0.1802'}
2025-02-25 23:37:01,078 - EarlyStopping counter: 8 out of 10
2025-02-25 23:37:46,405 - {'epoch': 36, 'rec_loss': '5.8625'}
2025-02-25 23:37:48,093 - {'Epoch': 36, 'HR@5': '0.1823', 'NDCG@5': '0.1191', 'HR@10': '0.2811', 'NDCG@10': '0.1509', 'HR@20': '0.3980', 'NDCG@20': '0.1804'}
2025-02-25 23:37:48,094 - EarlyStopping counter: 9 out of 10
2025-02-25 23:38:34,385 - {'epoch': 37, 'rec_loss': '5.8591'}
2025-02-25 23:38:36,199 - {'Epoch': 37, 'HR@5': '0.1873', 'NDCG@5': '0.1223', 'HR@10': '0.2834', 'NDCG@10': '0.1532', 'HR@20': '0.3990', 'NDCG@20': '0.1825'}
2025-02-25 23:38:36,200 - EarlyStopping counter: 10 out of 10
2025-02-25 23:38:36,200 - Early stopping
2025-02-25 23:38:36,201 - ---------------Test Score---------------
2025-02-25 23:38:38,036 - {'Epoch': 0, 'HR@5': '0.1838', 'NDCG@5': '0.1240', 'HR@10': '0.2662', 'NDCG@10': '0.1505', 'HR@20': '0.3780', 'NDCG@20': '0.1787'}
2025-02-25 23:38:38,037 - Scale_ML-1M
2025-02-25 23:38:38,038 - {'Epoch': 0, 'HR@5': '0.1838', 'NDCG@5': '0.1240', 'HR@10': '0.2662', 'NDCG@10': '0.1505', 'HR@20': '0.3780', 'NDCG@20': '0.1787'}
2025-02-26 10:58:19,246 - Namespace(data_dir='./data/', output_dir='output/', data_name='ML-1M', do_eval=False, load_model=None, train_name='Scale_ML-1M', num_items=10, num_users=6041, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/ML-1M.txt', item_size=3417, checkpoint_path='output/Scale_ML-1M.pt', same_target_path='./data/ML-1M_same_target.npy')
2025-02-26 10:58:22,034 - ScaleRecModel(
  (item_embeddings): Embedding(3417, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-26 10:58:22,038 - Total Parameters: 372630
2025-02-26 10:59:09,095 - {'epoch': 0, 'rec_loss': '7.1122'}
2025-02-26 10:59:10,901 - {'Epoch': 0, 'HR@5': '0.1182', 'NDCG@5': '0.0758', 'HR@10': '0.1785', 'NDCG@10': '0.0953', 'HR@20': '0.2576', 'NDCG@20': '0.1152'}
2025-02-26 10:59:10,903 - Validation score increased.  Saving model ...
2025-02-26 10:59:59,772 - {'epoch': 1, 'rec_loss': '6.4006'}
2025-02-26 11:00:01,315 - {'Epoch': 1, 'HR@5': '0.1517', 'NDCG@5': '0.0978', 'HR@10': '0.2316', 'NDCG@10': '0.1235', 'HR@20': '0.3258', 'NDCG@20': '0.1473'}
2025-02-26 11:00:01,316 - Validation score increased.  Saving model ...
2025-02-26 11:00:50,783 - {'epoch': 2, 'rec_loss': '6.2302'}
2025-02-26 11:00:52,416 - {'Epoch': 2, 'HR@5': '0.1646', 'NDCG@5': '0.1075', 'HR@10': '0.2495', 'NDCG@10': '0.1347', 'HR@20': '0.3432', 'NDCG@20': '0.1584'}
2025-02-26 11:00:52,418 - Validation score increased.  Saving model ...
2025-02-26 11:01:41,707 - {'epoch': 3, 'rec_loss': '6.1520'}
2025-02-26 11:01:43,289 - {'Epoch': 3, 'HR@5': '0.1680', 'NDCG@5': '0.1115', 'HR@10': '0.2523', 'NDCG@10': '0.1386', 'HR@20': '0.3584', 'NDCG@20': '0.1654'}
2025-02-26 11:01:43,291 - Validation score increased.  Saving model ...
2025-02-26 11:02:32,883 - {'epoch': 4, 'rec_loss': '6.1050'}
2025-02-26 11:02:34,674 - {'Epoch': 4, 'HR@5': '0.1720', 'NDCG@5': '0.1124', 'HR@10': '0.2581', 'NDCG@10': '0.1400', 'HR@20': '0.3685', 'NDCG@20': '0.1678'}
2025-02-26 11:02:34,675 - Validation score increased.  Saving model ...
2025-02-26 11:03:25,233 - {'epoch': 5, 'rec_loss': '6.0719'}
2025-02-26 11:03:26,813 - {'Epoch': 5, 'HR@5': '0.1677', 'NDCG@5': '0.1113', 'HR@10': '0.2578', 'NDCG@10': '0.1404', 'HR@20': '0.3707', 'NDCG@20': '0.1689'}
2025-02-26 11:03:26,815 - Validation score increased.  Saving model ...
2025-02-26 11:04:15,199 - {'epoch': 6, 'rec_loss': '6.0478'}
2025-02-26 11:04:16,795 - {'Epoch': 6, 'HR@5': '0.1760', 'NDCG@5': '0.1154', 'HR@10': '0.2689', 'NDCG@10': '0.1453', 'HR@20': '0.3770', 'NDCG@20': '0.1727'}
2025-02-26 11:04:16,796 - Validation score increased.  Saving model ...
2025-02-26 11:05:04,445 - {'epoch': 7, 'rec_loss': '6.0345'}
2025-02-26 11:05:06,015 - {'Epoch': 7, 'HR@5': '0.1778', 'NDCG@5': '0.1145', 'HR@10': '0.2689', 'NDCG@10': '0.1437', 'HR@20': '0.3778', 'NDCG@20': '0.1712'}
2025-02-26 11:05:06,016 - EarlyStopping counter: 1 out of 10
2025-02-26 11:05:55,188 - {'epoch': 8, 'rec_loss': '6.0164'}
2025-02-26 11:05:56,787 - {'Epoch': 8, 'HR@5': '0.1778', 'NDCG@5': '0.1177', 'HR@10': '0.2672', 'NDCG@10': '0.1464', 'HR@20': '0.3821', 'NDCG@20': '0.1755'}
2025-02-26 11:05:56,788 - Validation score increased.  Saving model ...
2025-02-26 11:06:46,670 - {'epoch': 9, 'rec_loss': '6.0002'}
2025-02-26 11:06:48,364 - {'Epoch': 9, 'HR@5': '0.1786', 'NDCG@5': '0.1152', 'HR@10': '0.2675', 'NDCG@10': '0.1437', 'HR@20': '0.3829', 'NDCG@20': '0.1729'}
2025-02-26 11:06:48,366 - EarlyStopping counter: 1 out of 10
2025-02-26 11:07:37,434 - {'epoch': 10, 'rec_loss': '5.9929'}
2025-02-26 11:07:39,051 - {'Epoch': 10, 'HR@5': '0.1707', 'NDCG@5': '0.1101', 'HR@10': '0.2672', 'NDCG@10': '0.1412', 'HR@20': '0.3772', 'NDCG@20': '0.1689'}
2025-02-26 11:07:39,052 - EarlyStopping counter: 2 out of 10
2025-02-26 11:08:27,273 - {'epoch': 11, 'rec_loss': '5.9810'}
2025-02-26 11:08:29,008 - {'Epoch': 11, 'HR@5': '0.1735', 'NDCG@5': '0.1139', 'HR@10': '0.2697', 'NDCG@10': '0.1448', 'HR@20': '0.3839', 'NDCG@20': '0.1737'}
2025-02-26 11:08:29,009 - EarlyStopping counter: 3 out of 10
2025-02-26 11:09:18,040 - {'epoch': 12, 'rec_loss': '5.9703'}
2025-02-26 11:09:19,703 - {'Epoch': 12, 'HR@5': '0.1768', 'NDCG@5': '0.1195', 'HR@10': '0.2679', 'NDCG@10': '0.1488', 'HR@20': '0.3808', 'NDCG@20': '0.1774'}
2025-02-26 11:09:19,704 - Validation score increased.  Saving model ...
2025-02-26 11:10:09,397 - {'epoch': 13, 'rec_loss': '5.9648'}
2025-02-26 11:10:10,991 - {'Epoch': 13, 'HR@5': '0.1785', 'NDCG@5': '0.1165', 'HR@10': '0.2662', 'NDCG@10': '0.1448', 'HR@20': '0.3823', 'NDCG@20': '0.1740'}
2025-02-26 11:10:10,992 - EarlyStopping counter: 1 out of 10
2025-02-26 11:11:01,853 - {'epoch': 14, 'rec_loss': '5.9571'}
2025-02-26 11:11:03,697 - {'Epoch': 14, 'HR@5': '0.1820', 'NDCG@5': '0.1185', 'HR@10': '0.2735', 'NDCG@10': '0.1479', 'HR@20': '0.3897', 'NDCG@20': '0.1772'}
2025-02-26 11:11:03,699 - EarlyStopping counter: 2 out of 10
2025-02-26 11:11:58,705 - {'epoch': 15, 'rec_loss': '5.9486'}
2025-02-26 11:12:00,340 - {'Epoch': 15, 'HR@5': '0.1806', 'NDCG@5': '0.1178', 'HR@10': '0.2740', 'NDCG@10': '0.1479', 'HR@20': '0.3876', 'NDCG@20': '0.1767'}
2025-02-26 11:12:00,341 - EarlyStopping counter: 3 out of 10
2025-02-26 11:12:49,972 - {'epoch': 16, 'rec_loss': '5.9433'}
2025-02-26 11:12:51,552 - {'Epoch': 16, 'HR@5': '0.1753', 'NDCG@5': '0.1143', 'HR@10': '0.2705', 'NDCG@10': '0.1447', 'HR@20': '0.3871', 'NDCG@20': '0.1741'}
2025-02-26 11:12:51,553 - EarlyStopping counter: 4 out of 10
2025-02-26 11:13:41,392 - {'epoch': 17, 'rec_loss': '5.9376'}
2025-02-26 11:13:43,017 - {'Epoch': 17, 'HR@5': '0.1816', 'NDCG@5': '0.1197', 'HR@10': '0.2795', 'NDCG@10': '0.1511', 'HR@20': '0.3896', 'NDCG@20': '0.1790'}
2025-02-26 11:13:43,018 - Validation score increased.  Saving model ...
2025-02-26 11:14:31,400 - {'epoch': 18, 'rec_loss': '5.9308'}
2025-02-26 11:14:32,986 - {'Epoch': 18, 'HR@5': '0.1856', 'NDCG@5': '0.1208', 'HR@10': '0.2730', 'NDCG@10': '0.1489', 'HR@20': '0.3881', 'NDCG@20': '0.1779'}
2025-02-26 11:14:32,987 - EarlyStopping counter: 1 out of 10
2025-02-26 11:15:23,137 - {'epoch': 19, 'rec_loss': '5.9244'}
2025-02-26 11:15:24,822 - {'Epoch': 19, 'HR@5': '0.1791', 'NDCG@5': '0.1171', 'HR@10': '0.2730', 'NDCG@10': '0.1473', 'HR@20': '0.3881', 'NDCG@20': '0.1764'}
2025-02-26 11:15:24,824 - EarlyStopping counter: 2 out of 10
2025-02-26 11:16:16,459 - {'epoch': 20, 'rec_loss': '5.9201'}
2025-02-26 11:16:17,999 - {'Epoch': 20, 'HR@5': '0.1800', 'NDCG@5': '0.1182', 'HR@10': '0.2795', 'NDCG@10': '0.1502', 'HR@20': '0.3930', 'NDCG@20': '0.1788'}
2025-02-26 11:16:18,000 - EarlyStopping counter: 3 out of 10
2025-02-26 11:17:07,034 - {'epoch': 21, 'rec_loss': '5.9175'}
2025-02-26 11:17:08,600 - {'Epoch': 21, 'HR@5': '0.1831', 'NDCG@5': '0.1204', 'HR@10': '0.2843', 'NDCG@10': '0.1529', 'HR@20': '0.3935', 'NDCG@20': '0.1805'}
2025-02-26 11:17:08,601 - Validation score increased.  Saving model ...
2025-02-26 11:17:58,157 - {'epoch': 22, 'rec_loss': '5.9086'}
2025-02-26 11:17:59,870 - {'Epoch': 22, 'HR@5': '0.1858', 'NDCG@5': '0.1202', 'HR@10': '0.2775', 'NDCG@10': '0.1497', 'HR@20': '0.3930', 'NDCG@20': '0.1789'}
2025-02-26 11:17:59,871 - EarlyStopping counter: 1 out of 10
2025-02-26 11:18:48,761 - {'epoch': 23, 'rec_loss': '5.9093'}
2025-02-26 11:18:50,344 - {'Epoch': 23, 'HR@5': '0.1786', 'NDCG@5': '0.1171', 'HR@10': '0.2728', 'NDCG@10': '0.1473', 'HR@20': '0.3899', 'NDCG@20': '0.1769'}
2025-02-26 11:18:50,346 - EarlyStopping counter: 2 out of 10
2025-02-26 11:19:40,158 - {'epoch': 24, 'rec_loss': '5.9011'}
2025-02-26 11:19:41,761 - {'Epoch': 24, 'HR@5': '0.1839', 'NDCG@5': '0.1206', 'HR@10': '0.2803', 'NDCG@10': '0.1514', 'HR@20': '0.3932', 'NDCG@20': '0.1799'}
2025-02-26 11:19:41,762 - EarlyStopping counter: 3 out of 10
2025-02-26 11:20:33,694 - {'epoch': 25, 'rec_loss': '5.9012'}
2025-02-26 11:20:35,283 - {'Epoch': 25, 'HR@5': '0.1848', 'NDCG@5': '0.1201', 'HR@10': '0.2801', 'NDCG@10': '0.1507', 'HR@20': '0.3925', 'NDCG@20': '0.1792'}
2025-02-26 11:20:35,285 - EarlyStopping counter: 4 out of 10
2025-02-26 11:21:23,940 - {'epoch': 26, 'rec_loss': '5.8943'}
2025-02-26 11:21:25,575 - {'Epoch': 26, 'HR@5': '0.1841', 'NDCG@5': '0.1183', 'HR@10': '0.2803', 'NDCG@10': '0.1493', 'HR@20': '0.3944', 'NDCG@20': '0.1781'}
2025-02-26 11:21:25,577 - EarlyStopping counter: 5 out of 10
2025-02-26 11:22:15,194 - {'epoch': 27, 'rec_loss': '5.8910'}
2025-02-26 11:22:16,727 - {'Epoch': 27, 'HR@5': '0.1831', 'NDCG@5': '0.1207', 'HR@10': '0.2810', 'NDCG@10': '0.1521', 'HR@20': '0.3977', 'NDCG@20': '0.1815'}
2025-02-26 11:22:16,728 - Validation score increased.  Saving model ...
2025-02-26 11:23:08,753 - {'epoch': 28, 'rec_loss': '5.8907'}
2025-02-26 11:23:10,393 - {'Epoch': 28, 'HR@5': '0.1831', 'NDCG@5': '0.1190', 'HR@10': '0.2773', 'NDCG@10': '0.1492', 'HR@20': '0.3902', 'NDCG@20': '0.1777'}
2025-02-26 11:23:10,394 - EarlyStopping counter: 1 out of 10
2025-02-26 11:23:59,848 - {'epoch': 29, 'rec_loss': '5.8838'}
2025-02-26 11:24:01,573 - {'Epoch': 29, 'HR@5': '0.1838', 'NDCG@5': '0.1202', 'HR@10': '0.2826', 'NDCG@10': '0.1518', 'HR@20': '0.3955', 'NDCG@20': '0.1803'}
2025-02-26 11:24:01,574 - EarlyStopping counter: 2 out of 10
2025-02-26 11:24:50,530 - {'epoch': 30, 'rec_loss': '5.8815'}
2025-02-26 11:24:52,108 - {'Epoch': 30, 'HR@5': '0.1844', 'NDCG@5': '0.1184', 'HR@10': '0.2815', 'NDCG@10': '0.1496', 'HR@20': '0.3964', 'NDCG@20': '0.1787'}
2025-02-26 11:24:52,109 - EarlyStopping counter: 3 out of 10
2025-02-26 11:25:41,840 - {'epoch': 31, 'rec_loss': '5.8819'}
2025-02-26 11:25:43,478 - {'Epoch': 31, 'HR@5': '0.1810', 'NDCG@5': '0.1188', 'HR@10': '0.2815', 'NDCG@10': '0.1511', 'HR@20': '0.3959', 'NDCG@20': '0.1800'}
2025-02-26 11:25:43,479 - EarlyStopping counter: 4 out of 10
2025-02-26 11:26:33,347 - {'epoch': 32, 'rec_loss': '5.8764'}
2025-02-26 11:26:34,971 - {'Epoch': 32, 'HR@5': '0.1810', 'NDCG@5': '0.1178', 'HR@10': '0.2796', 'NDCG@10': '0.1495', 'HR@20': '0.3945', 'NDCG@20': '0.1786'}
2025-02-26 11:26:34,972 - EarlyStopping counter: 5 out of 10
2025-02-26 11:27:24,396 - {'epoch': 33, 'rec_loss': '5.8750'}
2025-02-26 11:27:25,990 - {'Epoch': 33, 'HR@5': '0.1839', 'NDCG@5': '0.1189', 'HR@10': '0.2823', 'NDCG@10': '0.1507', 'HR@20': '0.3982', 'NDCG@20': '0.1800'}
2025-02-26 11:27:25,991 - EarlyStopping counter: 6 out of 10
2025-02-26 11:28:17,707 - {'epoch': 34, 'rec_loss': '5.8713'}
2025-02-26 11:28:19,331 - {'Epoch': 34, 'HR@5': '0.1839', 'NDCG@5': '0.1219', 'HR@10': '0.2790', 'NDCG@10': '0.1525', 'HR@20': '0.3965', 'NDCG@20': '0.1823'}
2025-02-26 11:28:19,332 - Validation score increased.  Saving model ...
2025-02-26 11:29:08,755 - {'epoch': 35, 'rec_loss': '5.8730'}
2025-02-26 11:29:10,333 - {'Epoch': 35, 'HR@5': '0.1843', 'NDCG@5': '0.1194', 'HR@10': '0.2863', 'NDCG@10': '0.1522', 'HR@20': '0.3993', 'NDCG@20': '0.1808'}
2025-02-26 11:29:10,334 - EarlyStopping counter: 1 out of 10
2025-02-26 11:29:59,783 - {'epoch': 36, 'rec_loss': '5.8690'}
2025-02-26 11:30:01,354 - {'Epoch': 36, 'HR@5': '0.1821', 'NDCG@5': '0.1191', 'HR@10': '0.2851', 'NDCG@10': '0.1521', 'HR@20': '0.4002', 'NDCG@20': '0.1811'}
2025-02-26 11:30:01,356 - EarlyStopping counter: 2 out of 10
2025-02-26 11:30:50,804 - {'epoch': 37, 'rec_loss': '5.8630'}
2025-02-26 11:30:52,351 - {'Epoch': 37, 'HR@5': '0.1829', 'NDCG@5': '0.1193', 'HR@10': '0.2798', 'NDCG@10': '0.1503', 'HR@20': '0.3978', 'NDCG@20': '0.1801'}
2025-02-26 11:30:52,352 - EarlyStopping counter: 3 out of 10
2025-02-26 11:31:41,008 - {'epoch': 38, 'rec_loss': '5.8629'}
2025-02-26 11:31:42,611 - {'Epoch': 38, 'HR@5': '0.1831', 'NDCG@5': '0.1191', 'HR@10': '0.2793', 'NDCG@10': '0.1502', 'HR@20': '0.3962', 'NDCG@20': '0.1798'}
2025-02-26 11:31:42,612 - EarlyStopping counter: 4 out of 10
2025-02-26 11:32:32,059 - {'epoch': 39, 'rec_loss': '5.8632'}
2025-02-26 11:32:33,628 - {'Epoch': 39, 'HR@5': '0.1868', 'NDCG@5': '0.1211', 'HR@10': '0.2810', 'NDCG@10': '0.1515', 'HR@20': '0.4017', 'NDCG@20': '0.1821'}
2025-02-26 11:32:33,629 - EarlyStopping counter: 5 out of 10
2025-02-26 11:33:23,377 - {'epoch': 40, 'rec_loss': '5.8559'}
2025-02-26 11:33:25,051 - {'Epoch': 40, 'HR@5': '0.1811', 'NDCG@5': '0.1162', 'HR@10': '0.2823', 'NDCG@10': '0.1486', 'HR@20': '0.3995', 'NDCG@20': '0.1783'}
2025-02-26 11:33:25,053 - EarlyStopping counter: 6 out of 10
2025-02-26 11:34:12,091 - {'epoch': 41, 'rec_loss': '5.8575'}
2025-02-26 11:34:13,649 - {'Epoch': 41, 'HR@5': '0.1849', 'NDCG@5': '0.1207', 'HR@10': '0.2839', 'NDCG@10': '0.1525', 'HR@20': '0.3992', 'NDCG@20': '0.1816'}
2025-02-26 11:34:13,650 - EarlyStopping counter: 7 out of 10
2025-02-26 11:35:02,584 - {'epoch': 42, 'rec_loss': '5.8538'}
2025-02-26 11:35:04,152 - {'Epoch': 42, 'HR@5': '0.1856', 'NDCG@5': '0.1203', 'HR@10': '0.2834', 'NDCG@10': '0.1516', 'HR@20': '0.4005', 'NDCG@20': '0.1811'}
2025-02-26 11:35:04,153 - EarlyStopping counter: 8 out of 10
2025-02-26 11:35:53,803 - {'epoch': 43, 'rec_loss': '5.8539'}
2025-02-26 11:35:55,459 - {'Epoch': 43, 'HR@5': '0.1821', 'NDCG@5': '0.1185', 'HR@10': '0.2821', 'NDCG@10': '0.1508', 'HR@20': '0.3974', 'NDCG@20': '0.1801'}
2025-02-26 11:35:55,460 - EarlyStopping counter: 9 out of 10
2025-02-26 11:36:45,267 - {'epoch': 44, 'rec_loss': '5.8485'}
2025-02-26 11:36:46,904 - {'Epoch': 44, 'HR@5': '0.1813', 'NDCG@5': '0.1181', 'HR@10': '0.2795', 'NDCG@10': '0.1496', 'HR@20': '0.3944', 'NDCG@20': '0.1787'}
2025-02-26 11:36:46,905 - EarlyStopping counter: 10 out of 10
2025-02-26 11:36:46,905 - Early stopping
2025-02-26 11:36:46,905 - ---------------Test Score---------------
2025-02-26 11:36:48,424 - {'Epoch': 0, 'HR@5': '0.1874', 'NDCG@5': '0.1267', 'HR@10': '0.2719', 'NDCG@10': '0.1538', 'HR@20': '0.3733', 'NDCG@20': '0.1793'}
2025-02-26 11:36:48,425 - Scale_ML-1M
2025-02-26 11:36:48,425 - {'Epoch': 0, 'HR@5': '0.1874', 'NDCG@5': '0.1267', 'HR@10': '0.2719', 'NDCG@10': '0.1538', 'HR@20': '0.3733', 'NDCG@20': '0.1793'}
2025-02-26 11:42:01,777 - Namespace(data_dir='./data/', output_dir='output/', data_name='ML-1M', do_eval=False, load_model=None, train_name='Scale_ML-1M', num_items=10, num_users=6041, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 5], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/ML-1M.txt', item_size=3417, checkpoint_path='output/Scale_ML-1M.pt', same_target_path='./data/ML-1M_same_target.npy')
2025-02-26 11:42:04,553 - ScaleRecModel(
  (item_embeddings): Embedding(3417, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-26 11:42:04,557 - Total Parameters: 372305
2025-02-26 11:42:53,175 - {'epoch': 0, 'rec_loss': '7.1221'}
2025-02-26 11:42:54,693 - {'Epoch': 0, 'HR@5': '0.1164', 'NDCG@5': '0.0756', 'HR@10': '0.1757', 'NDCG@10': '0.0947', 'HR@20': '0.2578', 'NDCG@20': '0.1154'}
2025-02-26 11:42:54,694 - Validation score increased.  Saving model ...
2025-02-26 11:43:40,335 - {'epoch': 1, 'rec_loss': '6.4056'}
2025-02-26 11:43:42,133 - {'Epoch': 1, 'HR@5': '0.1492', 'NDCG@5': '0.0970', 'HR@10': '0.2237', 'NDCG@10': '0.1208', 'HR@20': '0.3146', 'NDCG@20': '0.1437'}
2025-02-26 11:43:42,134 - Validation score increased.  Saving model ...
2025-02-26 11:44:27,647 - {'epoch': 2, 'rec_loss': '6.2370'}
2025-02-26 11:44:29,541 - {'Epoch': 2, 'HR@5': '0.1546', 'NDCG@5': '0.1022', 'HR@10': '0.2406', 'NDCG@10': '0.1300', 'HR@20': '0.3401', 'NDCG@20': '0.1551'}
2025-02-26 11:44:29,542 - Validation score increased.  Saving model ...
2025-02-26 11:45:19,349 - {'epoch': 3, 'rec_loss': '6.1589'}
2025-02-26 11:45:20,921 - {'Epoch': 3, 'HR@5': '0.1632', 'NDCG@5': '0.1072', 'HR@10': '0.2530', 'NDCG@10': '0.1361', 'HR@20': '0.3594', 'NDCG@20': '0.1629'}
2025-02-26 11:45:20,922 - Validation score increased.  Saving model ...
2025-02-26 11:46:10,553 - {'epoch': 4, 'rec_loss': '6.1136'}
2025-02-26 11:46:12,191 - {'Epoch': 4, 'HR@5': '0.1709', 'NDCG@5': '0.1136', 'HR@10': '0.2561', 'NDCG@10': '0.1410', 'HR@20': '0.3664', 'NDCG@20': '0.1688'}
2025-02-26 11:46:12,192 - Validation score increased.  Saving model ...
2025-02-26 11:47:02,678 - {'epoch': 5, 'rec_loss': '6.0832'}
2025-02-26 11:47:04,301 - {'Epoch': 5, 'HR@5': '0.1760', 'NDCG@5': '0.1150', 'HR@10': '0.2624', 'NDCG@10': '0.1427', 'HR@20': '0.3675', 'NDCG@20': '0.1694'}
2025-02-26 11:47:04,302 - Validation score increased.  Saving model ...
2025-02-26 11:47:53,020 - {'epoch': 6, 'rec_loss': '6.0605'}
2025-02-26 11:47:54,582 - {'Epoch': 6, 'HR@5': '0.1803', 'NDCG@5': '0.1184', 'HR@10': '0.2649', 'NDCG@10': '0.1456', 'HR@20': '0.3781', 'NDCG@20': '0.1743'}
2025-02-26 11:47:54,583 - Validation score increased.  Saving model ...
2025-02-26 11:48:43,961 - {'epoch': 7, 'rec_loss': '6.0395'}
2025-02-26 11:48:45,497 - {'Epoch': 7, 'HR@5': '0.1813', 'NDCG@5': '0.1166', 'HR@10': '0.2704', 'NDCG@10': '0.1451', 'HR@20': '0.3808', 'NDCG@20': '0.1729'}
2025-02-26 11:48:45,498 - EarlyStopping counter: 1 out of 10
2025-02-26 11:49:34,427 - {'epoch': 8, 'rec_loss': '6.0226'}
2025-02-26 11:49:35,977 - {'Epoch': 8, 'HR@5': '0.1768', 'NDCG@5': '0.1150', 'HR@10': '0.2682', 'NDCG@10': '0.1443', 'HR@20': '0.3813', 'NDCG@20': '0.1729'}
2025-02-26 11:49:35,978 - EarlyStopping counter: 2 out of 10
2025-02-26 11:50:25,130 - {'epoch': 9, 'rec_loss': '6.0071'}
2025-02-26 11:50:26,833 - {'Epoch': 9, 'HR@5': '0.1796', 'NDCG@5': '0.1171', 'HR@10': '0.2667', 'NDCG@10': '0.1452', 'HR@20': '0.3833', 'NDCG@20': '0.1746'}
2025-02-26 11:50:26,834 - Validation score increased.  Saving model ...
2025-02-26 11:51:15,448 - {'epoch': 10, 'rec_loss': '6.0004'}
2025-02-26 11:51:17,034 - {'Epoch': 10, 'HR@5': '0.1780', 'NDCG@5': '0.1169', 'HR@10': '0.2762', 'NDCG@10': '0.1484', 'HR@20': '0.3874', 'NDCG@20': '0.1763'}
2025-02-26 11:51:17,035 - Validation score increased.  Saving model ...
2025-02-26 11:52:06,965 - {'epoch': 11, 'rec_loss': '5.9862'}
2025-02-26 11:52:08,638 - {'Epoch': 11, 'HR@5': '0.1798', 'NDCG@5': '0.1158', 'HR@10': '0.2700', 'NDCG@10': '0.1449', 'HR@20': '0.3849', 'NDCG@20': '0.1739'}
2025-02-26 11:52:08,639 - EarlyStopping counter: 1 out of 10
2025-02-26 11:53:20,125 - {'epoch': 12, 'rec_loss': '5.9805'}
2025-02-26 11:53:22,114 - {'Epoch': 12, 'HR@5': '0.1829', 'NDCG@5': '0.1199', 'HR@10': '0.2737', 'NDCG@10': '0.1488', 'HR@20': '0.3871', 'NDCG@20': '0.1775'}
2025-02-26 11:53:22,115 - Validation score increased.  Saving model ...
2025-02-26 11:54:16,182 - {'epoch': 13, 'rec_loss': '5.9693'}
2025-02-26 11:54:17,908 - {'Epoch': 13, 'HR@5': '0.1776', 'NDCG@5': '0.1167', 'HR@10': '0.2743', 'NDCG@10': '0.1479', 'HR@20': '0.3874', 'NDCG@20': '0.1765'}
2025-02-26 11:54:17,910 - EarlyStopping counter: 1 out of 10
2025-02-26 11:55:07,146 - {'epoch': 14, 'rec_loss': '5.9614'}
2025-02-26 11:55:08,834 - {'Epoch': 14, 'HR@5': '0.1781', 'NDCG@5': '0.1163', 'HR@10': '0.2786', 'NDCG@10': '0.1488', 'HR@20': '0.3892', 'NDCG@20': '0.1768'}
2025-02-26 11:55:08,836 - EarlyStopping counter: 2 out of 10
2025-02-26 11:55:57,871 - {'epoch': 15, 'rec_loss': '5.9549'}
2025-02-26 11:55:59,507 - {'Epoch': 15, 'HR@5': '0.1750', 'NDCG@5': '0.1161', 'HR@10': '0.2757', 'NDCG@10': '0.1485', 'HR@20': '0.3884', 'NDCG@20': '0.1770'}
2025-02-26 11:55:59,508 - EarlyStopping counter: 3 out of 10
2025-02-26 11:56:48,154 - {'epoch': 16, 'rec_loss': '5.9459'}
2025-02-26 11:56:49,879 - {'Epoch': 16, 'HR@5': '0.1788', 'NDCG@5': '0.1191', 'HR@10': '0.2715', 'NDCG@10': '0.1491', 'HR@20': '0.3882', 'NDCG@20': '0.1786'}
2025-02-26 11:56:49,880 - Validation score increased.  Saving model ...
2025-02-26 11:57:37,025 - {'epoch': 17, 'rec_loss': '5.9382'}
2025-02-26 11:57:38,767 - {'Epoch': 17, 'HR@5': '0.1806', 'NDCG@5': '0.1179', 'HR@10': '0.2801', 'NDCG@10': '0.1498', 'HR@20': '0.3887', 'NDCG@20': '0.1772'}
2025-02-26 11:57:38,769 - EarlyStopping counter: 1 out of 10
2025-02-26 11:58:27,757 - {'epoch': 18, 'rec_loss': '5.9346'}
2025-02-26 11:58:29,383 - {'Epoch': 18, 'HR@5': '0.1820', 'NDCG@5': '0.1191', 'HR@10': '0.2767', 'NDCG@10': '0.1495', 'HR@20': '0.3907', 'NDCG@20': '0.1784'}
2025-02-26 11:58:29,384 - EarlyStopping counter: 2 out of 10
2025-02-26 11:59:18,360 - {'epoch': 19, 'rec_loss': '5.9256'}
2025-02-26 11:59:20,182 - {'Epoch': 19, 'HR@5': '0.1783', 'NDCG@5': '0.1170', 'HR@10': '0.2728', 'NDCG@10': '0.1474', 'HR@20': '0.3856', 'NDCG@20': '0.1757'}
2025-02-26 11:59:20,183 - EarlyStopping counter: 3 out of 10
2025-02-26 12:00:11,365 - {'epoch': 20, 'rec_loss': '5.9267'}
2025-02-26 12:00:12,918 - {'Epoch': 20, 'HR@5': '0.1823', 'NDCG@5': '0.1170', 'HR@10': '0.2788', 'NDCG@10': '0.1481', 'HR@20': '0.3904', 'NDCG@20': '0.1762'}
2025-02-26 12:00:12,919 - EarlyStopping counter: 4 out of 10
2025-02-26 12:01:02,236 - {'epoch': 21, 'rec_loss': '5.9188'}
2025-02-26 12:01:03,793 - {'Epoch': 21, 'HR@5': '0.1843', 'NDCG@5': '0.1195', 'HR@10': '0.2775', 'NDCG@10': '0.1494', 'HR@20': '0.3912', 'NDCG@20': '0.1779'}
2025-02-26 12:01:03,794 - EarlyStopping counter: 5 out of 10
2025-02-26 12:01:53,573 - {'epoch': 22, 'rec_loss': '5.9155'}
2025-02-26 12:01:55,308 - {'Epoch': 22, 'HR@5': '0.1773', 'NDCG@5': '0.1170', 'HR@10': '0.2695', 'NDCG@10': '0.1467', 'HR@20': '0.3899', 'NDCG@20': '0.1770'}
2025-02-26 12:01:55,309 - EarlyStopping counter: 6 out of 10
2025-02-26 12:02:45,529 - {'epoch': 23, 'rec_loss': '5.9112'}
2025-02-26 12:02:47,310 - {'Epoch': 23, 'HR@5': '0.1821', 'NDCG@5': '0.1196', 'HR@10': '0.2796', 'NDCG@10': '0.1508', 'HR@20': '0.3866', 'NDCG@20': '0.1780'}
2025-02-26 12:02:47,311 - EarlyStopping counter: 7 out of 10
2025-02-26 12:03:37,072 - {'epoch': 24, 'rec_loss': '5.9079'}
2025-02-26 12:03:38,629 - {'Epoch': 24, 'HR@5': '0.1886', 'NDCG@5': '0.1220', 'HR@10': '0.2786', 'NDCG@10': '0.1508', 'HR@20': '0.3919', 'NDCG@20': '0.1793'}
2025-02-26 12:03:38,630 - Validation score increased.  Saving model ...
2025-02-26 12:04:28,312 - {'epoch': 25, 'rec_loss': '5.9080'}
2025-02-26 12:04:29,883 - {'Epoch': 25, 'HR@5': '0.1808', 'NDCG@5': '0.1179', 'HR@10': '0.2743', 'NDCG@10': '0.1479', 'HR@20': '0.3881', 'NDCG@20': '0.1767'}
2025-02-26 12:04:29,884 - EarlyStopping counter: 1 out of 10
2025-02-26 12:05:32,241 - {'epoch': 26, 'rec_loss': '5.8977'}
2025-02-26 12:05:34,015 - {'Epoch': 26, 'HR@5': '0.1811', 'NDCG@5': '0.1176', 'HR@10': '0.2778', 'NDCG@10': '0.1487', 'HR@20': '0.3914', 'NDCG@20': '0.1774'}
2025-02-26 12:05:34,016 - EarlyStopping counter: 2 out of 10
2025-02-26 12:06:46,427 - {'epoch': 27, 'rec_loss': '5.8950'}
2025-02-26 12:06:48,143 - {'Epoch': 27, 'HR@5': '0.1839', 'NDCG@5': '0.1186', 'HR@10': '0.2786', 'NDCG@10': '0.1491', 'HR@20': '0.3912', 'NDCG@20': '0.1774'}
2025-02-26 12:06:48,144 - EarlyStopping counter: 3 out of 10
2025-02-26 12:08:05,711 - {'epoch': 28, 'rec_loss': '5.8952'}
2025-02-26 12:08:07,457 - {'Epoch': 28, 'HR@5': '0.1770', 'NDCG@5': '0.1145', 'HR@10': '0.2750', 'NDCG@10': '0.1459', 'HR@20': '0.3907', 'NDCG@20': '0.1753'}
2025-02-26 12:08:07,458 - EarlyStopping counter: 4 out of 10
2025-02-26 12:08:59,210 - {'epoch': 29, 'rec_loss': '5.8884'}
2025-02-26 12:09:00,793 - {'Epoch': 29, 'HR@5': '0.1858', 'NDCG@5': '0.1208', 'HR@10': '0.2813', 'NDCG@10': '0.1516', 'HR@20': '0.3957', 'NDCG@20': '0.1805'}
2025-02-26 12:09:00,794 - Validation score increased.  Saving model ...
2025-02-26 12:09:50,209 - {'epoch': 30, 'rec_loss': '5.8842'}
2025-02-26 12:09:51,773 - {'Epoch': 30, 'HR@5': '0.1838', 'NDCG@5': '0.1183', 'HR@10': '0.2829', 'NDCG@10': '0.1504', 'HR@20': '0.3937', 'NDCG@20': '0.1783'}
2025-02-26 12:09:51,774 - EarlyStopping counter: 1 out of 10
2025-02-26 12:10:42,864 - {'epoch': 31, 'rec_loss': '5.8816'}
2025-02-26 12:10:44,801 - {'Epoch': 31, 'HR@5': '0.1833', 'NDCG@5': '0.1192', 'HR@10': '0.2793', 'NDCG@10': '0.1500', 'HR@20': '0.3965', 'NDCG@20': '0.1794'}
2025-02-26 12:10:44,803 - EarlyStopping counter: 2 out of 10
2025-02-26 12:11:35,357 - {'epoch': 32, 'rec_loss': '5.8821'}
2025-02-26 12:11:37,112 - {'Epoch': 32, 'HR@5': '0.1851', 'NDCG@5': '0.1200', 'HR@10': '0.2750', 'NDCG@10': '0.1489', 'HR@20': '0.3934', 'NDCG@20': '0.1787'}
2025-02-26 12:11:37,114 - EarlyStopping counter: 3 out of 10
2025-02-26 12:12:27,925 - {'epoch': 33, 'rec_loss': '5.8797'}
2025-02-26 12:12:29,840 - {'Epoch': 33, 'HR@5': '0.1826', 'NDCG@5': '0.1180', 'HR@10': '0.2831', 'NDCG@10': '0.1502', 'HR@20': '0.3922', 'NDCG@20': '0.1777'}
2025-02-26 12:12:29,841 - EarlyStopping counter: 4 out of 10
2025-02-26 12:13:19,639 - {'epoch': 34, 'rec_loss': '5.8786'}
2025-02-26 12:13:21,249 - {'Epoch': 34, 'HR@5': '0.1873', 'NDCG@5': '0.1223', 'HR@10': '0.2838', 'NDCG@10': '0.1534', 'HR@20': '0.3962', 'NDCG@20': '0.1818'}
2025-02-26 12:13:21,250 - Validation score increased.  Saving model ...
2025-02-26 12:14:14,116 - {'epoch': 35, 'rec_loss': '5.8737'}
2025-02-26 12:14:15,789 - {'Epoch': 35, 'HR@5': '0.1820', 'NDCG@5': '0.1180', 'HR@10': '0.2783', 'NDCG@10': '0.1489', 'HR@20': '0.3909', 'NDCG@20': '0.1773'}
2025-02-26 12:14:15,790 - EarlyStopping counter: 1 out of 10
2025-02-26 12:15:04,430 - {'epoch': 36, 'rec_loss': '5.8718'}
2025-02-26 12:15:06,005 - {'Epoch': 36, 'HR@5': '0.1868', 'NDCG@5': '0.1217', 'HR@10': '0.2838', 'NDCG@10': '0.1528', 'HR@20': '0.3974', 'NDCG@20': '0.1815'}
2025-02-26 12:15:06,006 - EarlyStopping counter: 2 out of 10
2025-02-26 12:15:55,932 - {'epoch': 37, 'rec_loss': '5.8673'}
2025-02-26 12:15:57,790 - {'Epoch': 37, 'HR@5': '0.1805', 'NDCG@5': '0.1177', 'HR@10': '0.2768', 'NDCG@10': '0.1488', 'HR@20': '0.3993', 'NDCG@20': '0.1796'}
2025-02-26 12:15:57,791 - EarlyStopping counter: 3 out of 10
2025-02-26 12:16:49,204 - {'epoch': 38, 'rec_loss': '5.8642'}
2025-02-26 12:16:51,012 - {'Epoch': 38, 'HR@5': '0.1871', 'NDCG@5': '0.1214', 'HR@10': '0.2795', 'NDCG@10': '0.1511', 'HR@20': '0.3982', 'NDCG@20': '0.1810'}
2025-02-26 12:16:51,013 - EarlyStopping counter: 4 out of 10
2025-02-26 12:17:42,333 - {'epoch': 39, 'rec_loss': '5.8656'}
2025-02-26 12:17:44,269 - {'Epoch': 39, 'HR@5': '0.1864', 'NDCG@5': '0.1209', 'HR@10': '0.2808', 'NDCG@10': '0.1512', 'HR@20': '0.3965', 'NDCG@20': '0.1804'}
2025-02-26 12:17:44,270 - EarlyStopping counter: 5 out of 10
2025-02-26 12:18:35,260 - {'epoch': 40, 'rec_loss': '5.8630'}
2025-02-26 12:18:37,135 - {'Epoch': 40, 'HR@5': '0.1841', 'NDCG@5': '0.1207', 'HR@10': '0.2811', 'NDCG@10': '0.1519', 'HR@20': '0.4015', 'NDCG@20': '0.1822'}
2025-02-26 12:18:37,136 - Validation score increased.  Saving model ...
2025-02-26 12:19:28,288 - {'epoch': 41, 'rec_loss': '5.8598'}
2025-02-26 12:19:30,125 - {'Epoch': 41, 'HR@5': '0.1864', 'NDCG@5': '0.1210', 'HR@10': '0.2806', 'NDCG@10': '0.1511', 'HR@20': '0.3980', 'NDCG@20': '0.1806'}
2025-02-26 12:19:30,126 - EarlyStopping counter: 1 out of 10
2025-02-26 12:20:20,911 - {'epoch': 42, 'rec_loss': '5.8570'}
2025-02-26 12:20:22,884 - {'Epoch': 42, 'HR@5': '0.1818', 'NDCG@5': '0.1179', 'HR@10': '0.2778', 'NDCG@10': '0.1489', 'HR@20': '0.3965', 'NDCG@20': '0.1789'}
2025-02-26 12:20:22,885 - EarlyStopping counter: 2 out of 10
2025-02-26 12:21:13,626 - {'epoch': 43, 'rec_loss': '5.8572'}
2025-02-26 12:21:15,497 - {'Epoch': 43, 'HR@5': '0.1869', 'NDCG@5': '0.1230', 'HR@10': '0.2823', 'NDCG@10': '0.1536', 'HR@20': '0.3959', 'NDCG@20': '0.1823'}
2025-02-26 12:21:15,499 - Validation score increased.  Saving model ...
2025-02-26 12:22:06,331 - {'epoch': 44, 'rec_loss': '5.8539'}
2025-02-26 12:22:08,141 - {'Epoch': 44, 'HR@5': '0.1818', 'NDCG@5': '0.1192', 'HR@10': '0.2770', 'NDCG@10': '0.1498', 'HR@20': '0.3962', 'NDCG@20': '0.1799'}
2025-02-26 12:22:08,143 - EarlyStopping counter: 1 out of 10
2025-02-26 12:22:59,291 - {'epoch': 45, 'rec_loss': '5.8546'}
2025-02-26 12:23:01,110 - {'Epoch': 45, 'HR@5': '0.1894', 'NDCG@5': '0.1234', 'HR@10': '0.2778', 'NDCG@10': '0.1519', 'HR@20': '0.3947', 'NDCG@20': '0.1813'}
2025-02-26 12:23:01,111 - EarlyStopping counter: 2 out of 10
2025-02-26 12:23:52,161 - {'epoch': 46, 'rec_loss': '5.8540'}
2025-02-26 12:23:54,029 - {'Epoch': 46, 'HR@5': '0.1887', 'NDCG@5': '0.1229', 'HR@10': '0.2821', 'NDCG@10': '0.1528', 'HR@20': '0.4002', 'NDCG@20': '0.1825'}
2025-02-26 12:23:54,030 - Validation score increased.  Saving model ...
2025-02-26 12:24:45,349 - {'epoch': 47, 'rec_loss': '5.8519'}
2025-02-26 12:24:47,338 - {'Epoch': 47, 'HR@5': '0.1816', 'NDCG@5': '0.1182', 'HR@10': '0.2798', 'NDCG@10': '0.1500', 'HR@20': '0.3997', 'NDCG@20': '0.1802'}
2025-02-26 12:24:47,340 - EarlyStopping counter: 1 out of 10
2025-02-26 12:25:38,726 - {'epoch': 48, 'rec_loss': '5.8471'}
2025-02-26 12:25:40,586 - {'Epoch': 48, 'HR@5': '0.1864', 'NDCG@5': '0.1209', 'HR@10': '0.2838', 'NDCG@10': '0.1522', 'HR@20': '0.4015', 'NDCG@20': '0.1818'}
2025-02-26 12:25:40,588 - EarlyStopping counter: 2 out of 10
2025-02-26 12:26:32,707 - {'epoch': 49, 'rec_loss': '5.8456'}
2025-02-26 12:26:34,573 - {'Epoch': 49, 'HR@5': '0.1783', 'NDCG@5': '0.1169', 'HR@10': '0.2781', 'NDCG@10': '0.1490', 'HR@20': '0.3974', 'NDCG@20': '0.1791'}
2025-02-26 12:26:34,574 - EarlyStopping counter: 3 out of 10
2025-02-26 12:27:26,121 - {'epoch': 50, 'rec_loss': '5.8464'}
2025-02-26 12:27:28,043 - {'Epoch': 50, 'HR@5': '0.1863', 'NDCG@5': '0.1200', 'HR@10': '0.2816', 'NDCG@10': '0.1508', 'HR@20': '0.3995', 'NDCG@20': '0.1805'}
2025-02-26 12:27:28,044 - EarlyStopping counter: 4 out of 10
2025-02-26 12:28:20,081 - {'epoch': 51, 'rec_loss': '5.8429'}
2025-02-26 12:28:21,689 - {'Epoch': 51, 'HR@5': '0.1871', 'NDCG@5': '0.1206', 'HR@10': '0.2808', 'NDCG@10': '0.1507', 'HR@20': '0.3978', 'NDCG@20': '0.1801'}
2025-02-26 12:28:21,690 - EarlyStopping counter: 5 out of 10
2025-02-26 12:29:14,813 - {'epoch': 52, 'rec_loss': '5.8468'}
2025-02-26 12:29:16,403 - {'Epoch': 52, 'HR@5': '0.1791', 'NDCG@5': '0.1180', 'HR@10': '0.2815', 'NDCG@10': '0.1510', 'HR@20': '0.3950', 'NDCG@20': '0.1795'}
2025-02-26 12:29:16,404 - EarlyStopping counter: 6 out of 10
2025-02-26 12:30:07,580 - {'epoch': 53, 'rec_loss': '5.8409'}
2025-02-26 12:30:09,144 - {'Epoch': 53, 'HR@5': '0.1901', 'NDCG@5': '0.1236', 'HR@10': '0.2838', 'NDCG@10': '0.1538', 'HR@20': '0.3995', 'NDCG@20': '0.1830'}
2025-02-26 12:30:09,145 - Validation score increased.  Saving model ...
2025-02-26 12:30:59,341 - {'epoch': 54, 'rec_loss': '5.8402'}
2025-02-26 12:31:00,929 - {'Epoch': 54, 'HR@5': '0.1876', 'NDCG@5': '0.1211', 'HR@10': '0.2826', 'NDCG@10': '0.1518', 'HR@20': '0.3982', 'NDCG@20': '0.1809'}
2025-02-26 12:31:00,930 - EarlyStopping counter: 1 out of 10
2025-02-26 12:31:50,710 - {'epoch': 55, 'rec_loss': '5.8396'}
2025-02-26 12:31:52,299 - {'Epoch': 55, 'HR@5': '0.1834', 'NDCG@5': '0.1207', 'HR@10': '0.2773', 'NDCG@10': '0.1510', 'HR@20': '0.3955', 'NDCG@20': '0.1808'}
2025-02-26 12:31:52,300 - EarlyStopping counter: 2 out of 10
2025-02-26 12:32:41,221 - {'epoch': 56, 'rec_loss': '5.8400'}
2025-02-26 12:32:42,789 - {'Epoch': 56, 'HR@5': '0.1834', 'NDCG@5': '0.1187', 'HR@10': '0.2801', 'NDCG@10': '0.1497', 'HR@20': '0.3964', 'NDCG@20': '0.1790'}
2025-02-26 12:32:42,790 - EarlyStopping counter: 3 out of 10
2025-02-26 12:33:35,033 - {'epoch': 57, 'rec_loss': '5.8386'}
2025-02-26 12:33:36,738 - {'Epoch': 57, 'HR@5': '0.1932', 'NDCG@5': '0.1224', 'HR@10': '0.2848', 'NDCG@10': '0.1518', 'HR@20': '0.3997', 'NDCG@20': '0.1806'}
2025-02-26 12:33:36,739 - EarlyStopping counter: 4 out of 10
2025-02-26 12:34:25,667 - {'epoch': 58, 'rec_loss': '5.8372'}
2025-02-26 12:34:27,278 - {'Epoch': 58, 'HR@5': '0.1839', 'NDCG@5': '0.1181', 'HR@10': '0.2810', 'NDCG@10': '0.1494', 'HR@20': '0.3982', 'NDCG@20': '0.1789'}
2025-02-26 12:34:27,279 - EarlyStopping counter: 5 out of 10
2025-02-26 12:35:16,186 - {'epoch': 59, 'rec_loss': '5.8354'}
2025-02-26 12:35:17,798 - {'Epoch': 59, 'HR@5': '0.1858', 'NDCG@5': '0.1202', 'HR@10': '0.2808', 'NDCG@10': '0.1508', 'HR@20': '0.3997', 'NDCG@20': '0.1806'}
2025-02-26 12:35:17,799 - EarlyStopping counter: 6 out of 10
2025-02-26 12:36:06,562 - {'epoch': 60, 'rec_loss': '5.8356'}
2025-02-26 12:36:08,139 - {'Epoch': 60, 'HR@5': '0.1844', 'NDCG@5': '0.1212', 'HR@10': '0.2815', 'NDCG@10': '0.1524', 'HR@20': '0.3988', 'NDCG@20': '0.1819'}
2025-02-26 12:36:08,140 - EarlyStopping counter: 7 out of 10
2025-02-26 12:36:55,298 - {'epoch': 61, 'rec_loss': '5.8336'}
2025-02-26 12:36:56,928 - {'Epoch': 61, 'HR@5': '0.1853', 'NDCG@5': '0.1200', 'HR@10': '0.2836', 'NDCG@10': '0.1516', 'HR@20': '0.4025', 'NDCG@20': '0.1816'}
2025-02-26 12:36:56,929 - EarlyStopping counter: 8 out of 10
2025-02-26 12:37:45,098 - {'epoch': 62, 'rec_loss': '5.8308'}
2025-02-26 12:37:46,731 - {'Epoch': 62, 'HR@5': '0.1874', 'NDCG@5': '0.1227', 'HR@10': '0.2864', 'NDCG@10': '0.1546', 'HR@20': '0.4036', 'NDCG@20': '0.1841'}
2025-02-26 12:37:46,732 - Validation score increased.  Saving model ...
2025-02-26 12:38:36,705 - {'epoch': 63, 'rec_loss': '5.8281'}
2025-02-26 12:38:38,285 - {'Epoch': 63, 'HR@5': '0.1868', 'NDCG@5': '0.1226', 'HR@10': '0.2790', 'NDCG@10': '0.1521', 'HR@20': '0.4017', 'NDCG@20': '0.1831'}
2025-02-26 12:38:38,286 - EarlyStopping counter: 1 out of 10
2025-02-26 12:39:27,906 - {'epoch': 64, 'rec_loss': '5.8286'}
2025-02-26 12:39:29,442 - {'Epoch': 64, 'HR@5': '0.1849', 'NDCG@5': '0.1192', 'HR@10': '0.2801', 'NDCG@10': '0.1498', 'HR@20': '0.3987', 'NDCG@20': '0.1797'}
2025-02-26 12:39:29,443 - EarlyStopping counter: 2 out of 10
2025-02-26 12:40:19,325 - {'epoch': 65, 'rec_loss': '5.8294'}
2025-02-26 12:40:20,913 - {'Epoch': 65, 'HR@5': '0.1858', 'NDCG@5': '0.1209', 'HR@10': '0.2801', 'NDCG@10': '0.1511', 'HR@20': '0.3990', 'NDCG@20': '0.1811'}
2025-02-26 12:40:20,914 - EarlyStopping counter: 3 out of 10
2025-02-26 12:41:09,648 - {'epoch': 66, 'rec_loss': '5.8280'}
2025-02-26 12:41:11,245 - {'Epoch': 66, 'HR@5': '0.1826', 'NDCG@5': '0.1191', 'HR@10': '0.2798', 'NDCG@10': '0.1504', 'HR@20': '0.3990', 'NDCG@20': '0.1806'}
2025-02-26 12:41:11,246 - EarlyStopping counter: 4 out of 10
2025-02-26 12:42:00,741 - {'epoch': 67, 'rec_loss': '5.8253'}
2025-02-26 12:42:02,313 - {'Epoch': 67, 'HR@5': '0.1868', 'NDCG@5': '0.1209', 'HR@10': '0.2801', 'NDCG@10': '0.1510', 'HR@20': '0.3992', 'NDCG@20': '0.1810'}
2025-02-26 12:42:02,314 - EarlyStopping counter: 5 out of 10
2025-02-26 12:42:52,878 - {'epoch': 68, 'rec_loss': '5.8239'}
2025-02-26 12:42:54,516 - {'Epoch': 68, 'HR@5': '0.1833', 'NDCG@5': '0.1193', 'HR@10': '0.2781', 'NDCG@10': '0.1497', 'HR@20': '0.4002', 'NDCG@20': '0.1805'}
2025-02-26 12:42:54,517 - EarlyStopping counter: 6 out of 10
2025-02-26 12:43:43,489 - {'epoch': 69, 'rec_loss': '5.8267'}
2025-02-26 12:43:45,010 - {'Epoch': 69, 'HR@5': '0.1858', 'NDCG@5': '0.1194', 'HR@10': '0.2815', 'NDCG@10': '0.1502', 'HR@20': '0.3964', 'NDCG@20': '0.1793'}
2025-02-26 12:43:45,011 - EarlyStopping counter: 7 out of 10
2025-02-26 12:44:35,106 - {'epoch': 70, 'rec_loss': '5.8260'}
2025-02-26 12:44:36,782 - {'Epoch': 70, 'HR@5': '0.1884', 'NDCG@5': '0.1219', 'HR@10': '0.2838', 'NDCG@10': '0.1525', 'HR@20': '0.4015', 'NDCG@20': '0.1822'}
2025-02-26 12:44:36,783 - EarlyStopping counter: 8 out of 10
2025-02-26 12:45:24,232 - {'epoch': 71, 'rec_loss': '5.8273'}
2025-02-26 12:45:25,931 - {'Epoch': 71, 'HR@5': '0.1877', 'NDCG@5': '0.1217', 'HR@10': '0.2853', 'NDCG@10': '0.1531', 'HR@20': '0.3985', 'NDCG@20': '0.1816'}
2025-02-26 12:45:25,932 - EarlyStopping counter: 9 out of 10
2025-02-26 12:46:14,864 - {'epoch': 72, 'rec_loss': '5.8231'}
2025-02-26 12:46:16,432 - {'Epoch': 72, 'HR@5': '0.1843', 'NDCG@5': '0.1203', 'HR@10': '0.2810', 'NDCG@10': '0.1515', 'HR@20': '0.4015', 'NDCG@20': '0.1819'}
2025-02-26 12:46:16,433 - EarlyStopping counter: 10 out of 10
2025-02-26 12:46:16,433 - Early stopping
2025-02-26 12:46:16,433 - ---------------Test Score---------------
2025-02-26 12:46:18,004 - {'Epoch': 0, 'HR@5': '0.1887', 'NDCG@5': '0.1262', 'HR@10': '0.2778', 'NDCG@10': '0.1549', 'HR@20': '0.3863', 'NDCG@20': '0.1822'}
2025-02-26 12:46:18,005 - Scale_ML-1M
2025-02-26 12:46:18,005 - {'Epoch': 0, 'HR@5': '0.1887', 'NDCG@5': '0.1262', 'HR@10': '0.2778', 'NDCG@10': '0.1549', 'HR@20': '0.3863', 'NDCG@20': '0.1822'}
