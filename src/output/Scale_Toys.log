2025-02-21 20:10:30,464 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-02-21 20:10:33,715 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-21 20:10:33,730 - Total Parameters: 918117
2025-02-21 20:10:59,478 - {'epoch': 0, 'rec_loss': '9.0941'}
2025-02-21 20:11:06,686 - {'Epoch': 0, 'HR@5': '0.0065', 'NDCG@5': '0.0037', 'HR@10': '0.0122', 'NDCG@10': '0.0056', 'HR@20': '0.0200', 'NDCG@20': '0.0075'}
2025-02-21 20:11:06,690 - Validation score increased.  Saving model ...
2025-02-21 20:11:31,832 - {'epoch': 1, 'rec_loss': '8.6898'}
2025-02-21 20:11:39,692 - {'Epoch': 1, 'HR@5': '0.0179', 'NDCG@5': '0.0129', 'HR@10': '0.0269', 'NDCG@10': '0.0157', 'HR@20': '0.0406', 'NDCG@20': '0.0191'}
2025-02-21 20:11:39,698 - Validation score increased.  Saving model ...
2025-02-21 20:12:02,571 - {'epoch': 2, 'rec_loss': '8.3738'}
2025-02-21 20:12:10,881 - {'Epoch': 2, 'HR@5': '0.0376', 'NDCG@5': '0.0271', 'HR@10': '0.0537', 'NDCG@10': '0.0323', 'HR@20': '0.0763', 'NDCG@20': '0.0380'}
2025-02-21 20:12:10,886 - Validation score increased.  Saving model ...
2025-02-21 20:12:34,940 - {'epoch': 3, 'rec_loss': '8.0766'}
2025-02-21 20:12:43,481 - {'Epoch': 3, 'HR@5': '0.0528', 'NDCG@5': '0.0379', 'HR@10': '0.0734', 'NDCG@10': '0.0445', 'HR@20': '0.1045', 'NDCG@20': '0.0523'}
2025-02-21 20:12:43,482 - Validation score increased.  Saving model ...
2025-02-21 20:13:06,274 - {'epoch': 4, 'rec_loss': '7.8406'}
2025-02-21 20:13:13,744 - {'Epoch': 4, 'HR@5': '0.0668', 'NDCG@5': '0.0474', 'HR@10': '0.0897', 'NDCG@10': '0.0548', 'HR@20': '0.1209', 'NDCG@20': '0.0627'}
2025-02-21 20:13:13,751 - Validation score increased.  Saving model ...
2025-02-21 20:13:38,485 - {'epoch': 5, 'rec_loss': '7.6685'}
2025-02-21 20:13:46,245 - {'Epoch': 5, 'HR@5': '0.0739', 'NDCG@5': '0.0525', 'HR@10': '0.0989', 'NDCG@10': '0.0606', 'HR@20': '0.1328', 'NDCG@20': '0.0691'}
2025-02-21 20:13:46,250 - Validation score increased.  Saving model ...
2025-02-21 20:14:09,208 - {'epoch': 6, 'rec_loss': '7.5348'}
2025-02-21 20:14:17,177 - {'Epoch': 6, 'HR@5': '0.0768', 'NDCG@5': '0.0556', 'HR@10': '0.1054', 'NDCG@10': '0.0649', 'HR@20': '0.1419', 'NDCG@20': '0.0740'}
2025-02-21 20:14:17,186 - Validation score increased.  Saving model ...
2025-02-21 20:14:41,558 - {'epoch': 7, 'rec_loss': '7.4360'}
2025-02-21 20:14:49,875 - {'Epoch': 7, 'HR@5': '0.0806', 'NDCG@5': '0.0585', 'HR@10': '0.1116', 'NDCG@10': '0.0685', 'HR@20': '0.1472', 'NDCG@20': '0.0774'}
2025-02-21 20:14:49,883 - Validation score increased.  Saving model ...
2025-02-21 20:15:13,414 - {'epoch': 8, 'rec_loss': '7.3547'}
2025-02-21 20:15:21,707 - {'Epoch': 8, 'HR@5': '0.0840', 'NDCG@5': '0.0602', 'HR@10': '0.1122', 'NDCG@10': '0.0692', 'HR@20': '0.1477', 'NDCG@20': '0.0782'}
2025-02-21 20:15:21,714 - Validation score increased.  Saving model ...
2025-02-21 20:15:46,633 - {'epoch': 9, 'rec_loss': '7.2953'}
2025-02-21 20:15:54,336 - {'Epoch': 9, 'HR@5': '0.0851', 'NDCG@5': '0.0613', 'HR@10': '0.1140', 'NDCG@10': '0.0707', 'HR@20': '0.1509', 'NDCG@20': '0.0800'}
2025-02-21 20:15:54,343 - Validation score increased.  Saving model ...
2025-02-21 20:16:18,126 - {'epoch': 10, 'rec_loss': '7.2460'}
2025-02-21 20:16:25,527 - {'Epoch': 10, 'HR@5': '0.0869', 'NDCG@5': '0.0628', 'HR@10': '0.1168', 'NDCG@10': '0.0724', 'HR@20': '0.1548', 'NDCG@20': '0.0820'}
2025-02-21 20:16:25,533 - Validation score increased.  Saving model ...
2025-02-21 20:16:48,721 - {'epoch': 11, 'rec_loss': '7.2005'}
2025-02-21 20:16:56,533 - {'Epoch': 11, 'HR@5': '0.0870', 'NDCG@5': '0.0631', 'HR@10': '0.1184', 'NDCG@10': '0.0733', 'HR@20': '0.1558', 'NDCG@20': '0.0828'}
2025-02-21 20:16:56,535 - Validation score increased.  Saving model ...
2025-02-21 20:17:19,533 - {'epoch': 12, 'rec_loss': '7.1613'}
2025-02-21 20:17:27,070 - {'Epoch': 12, 'HR@5': '0.0881', 'NDCG@5': '0.0642', 'HR@10': '0.1187', 'NDCG@10': '0.0740', 'HR@20': '0.1571', 'NDCG@20': '0.0837'}
2025-02-21 20:17:27,076 - Validation score increased.  Saving model ...
2025-02-21 20:17:51,007 - {'epoch': 13, 'rec_loss': '7.1272'}
2025-02-21 20:17:58,665 - {'Epoch': 13, 'HR@5': '0.0886', 'NDCG@5': '0.0641', 'HR@10': '0.1190', 'NDCG@10': '0.0740', 'HR@20': '0.1567', 'NDCG@20': '0.0834'}
2025-02-21 20:17:58,673 - EarlyStopping counter: 1 out of 10
2025-02-21 20:18:22,215 - {'epoch': 14, 'rec_loss': '7.1001'}
2025-02-21 20:18:30,157 - {'Epoch': 14, 'HR@5': '0.0899', 'NDCG@5': '0.0651', 'HR@10': '0.1203', 'NDCG@10': '0.0749', 'HR@20': '0.1591', 'NDCG@20': '0.0847'}
2025-02-21 20:18:30,163 - Validation score increased.  Saving model ...
2025-02-21 20:18:53,905 - {'epoch': 15, 'rec_loss': '7.0793'}
2025-02-21 20:19:01,253 - {'Epoch': 15, 'HR@5': '0.0887', 'NDCG@5': '0.0644', 'HR@10': '0.1211', 'NDCG@10': '0.0748', 'HR@20': '0.1584', 'NDCG@20': '0.0842'}
2025-02-21 20:19:01,259 - EarlyStopping counter: 1 out of 10
2025-02-21 20:19:25,854 - {'epoch': 16, 'rec_loss': '7.0490'}
2025-02-21 20:19:34,236 - {'Epoch': 16, 'HR@5': '0.0901', 'NDCG@5': '0.0653', 'HR@10': '0.1226', 'NDCG@10': '0.0757', 'HR@20': '0.1594', 'NDCG@20': '0.0850'}
2025-02-21 20:19:34,237 - Validation score increased.  Saving model ...
2025-02-21 20:19:59,117 - {'epoch': 17, 'rec_loss': '7.0262'}
2025-02-21 20:20:06,040 - {'Epoch': 17, 'HR@5': '0.0909', 'NDCG@5': '0.0655', 'HR@10': '0.1222', 'NDCG@10': '0.0756', 'HR@20': '0.1595', 'NDCG@20': '0.0850'}
2025-02-21 20:20:06,045 - Validation score increased.  Saving model ...
2025-02-21 20:20:29,571 - {'epoch': 18, 'rec_loss': '7.0166'}
2025-02-21 20:20:37,288 - {'Epoch': 18, 'HR@5': '0.0906', 'NDCG@5': '0.0652', 'HR@10': '0.1229', 'NDCG@10': '0.0756', 'HR@20': '0.1608', 'NDCG@20': '0.0852'}
2025-02-21 20:20:37,293 - Validation score increased.  Saving model ...
2025-02-21 20:20:59,961 - {'epoch': 19, 'rec_loss': '6.9974'}
2025-02-21 20:21:07,535 - {'Epoch': 19, 'HR@5': '0.0917', 'NDCG@5': '0.0660', 'HR@10': '0.1221', 'NDCG@10': '0.0758', 'HR@20': '0.1621', 'NDCG@20': '0.0859'}
2025-02-21 20:21:07,540 - Validation score increased.  Saving model ...
2025-02-21 20:21:31,607 - {'epoch': 20, 'rec_loss': '6.9797'}
2025-02-21 20:21:39,235 - {'Epoch': 20, 'HR@5': '0.0910', 'NDCG@5': '0.0654', 'HR@10': '0.1235', 'NDCG@10': '0.0758', 'HR@20': '0.1630', 'NDCG@20': '0.0858'}
2025-02-21 20:21:39,243 - EarlyStopping counter: 1 out of 10
2025-02-21 20:22:02,790 - {'epoch': 21, 'rec_loss': '6.9632'}
2025-02-21 20:22:10,178 - {'Epoch': 21, 'HR@5': '0.0912', 'NDCG@5': '0.0658', 'HR@10': '0.1253', 'NDCG@10': '0.0768', 'HR@20': '0.1639', 'NDCG@20': '0.0865'}
2025-02-21 20:22:10,186 - Validation score increased.  Saving model ...
2025-02-21 20:22:34,775 - {'epoch': 22, 'rec_loss': '6.9507'}
2025-02-21 20:22:42,590 - {'Epoch': 22, 'HR@5': '0.0916', 'NDCG@5': '0.0667', 'HR@10': '0.1256', 'NDCG@10': '0.0777', 'HR@20': '0.1642', 'NDCG@20': '0.0874'}
2025-02-21 20:22:42,598 - Validation score increased.  Saving model ...
2025-02-21 20:23:05,003 - {'epoch': 23, 'rec_loss': '6.9383'}
2025-02-21 20:23:11,704 - {'Epoch': 23, 'HR@5': '0.0914', 'NDCG@5': '0.0665', 'HR@10': '0.1235', 'NDCG@10': '0.0768', 'HR@20': '0.1639', 'NDCG@20': '0.0870'}
2025-02-21 20:23:11,712 - EarlyStopping counter: 1 out of 10
2025-02-21 20:23:36,975 - {'epoch': 24, 'rec_loss': '6.9203'}
2025-02-21 20:23:44,056 - {'Epoch': 24, 'HR@5': '0.0907', 'NDCG@5': '0.0663', 'HR@10': '0.1249', 'NDCG@10': '0.0773', 'HR@20': '0.1654', 'NDCG@20': '0.0875'}
2025-02-21 20:23:44,064 - Validation score increased.  Saving model ...
2025-02-21 20:24:08,298 - {'epoch': 25, 'rec_loss': '6.9073'}
2025-02-21 20:24:16,187 - {'Epoch': 25, 'HR@5': '0.0907', 'NDCG@5': '0.0660', 'HR@10': '0.1229', 'NDCG@10': '0.0764', 'HR@20': '0.1644', 'NDCG@20': '0.0869'}
2025-02-21 20:24:16,194 - EarlyStopping counter: 1 out of 10
2025-02-21 20:24:38,752 - {'epoch': 26, 'rec_loss': '6.9019'}
2025-02-21 20:24:46,558 - {'Epoch': 26, 'HR@5': '0.0929', 'NDCG@5': '0.0667', 'HR@10': '0.1245', 'NDCG@10': '0.0768', 'HR@20': '0.1657', 'NDCG@20': '0.0872'}
2025-02-21 20:24:46,565 - EarlyStopping counter: 2 out of 10
2025-02-21 20:25:10,589 - {'epoch': 27, 'rec_loss': '6.8826'}
2025-02-21 20:25:18,422 - {'Epoch': 27, 'HR@5': '0.0916', 'NDCG@5': '0.0664', 'HR@10': '0.1259', 'NDCG@10': '0.0775', 'HR@20': '0.1660', 'NDCG@20': '0.0876'}
2025-02-21 20:25:18,429 - Validation score increased.  Saving model ...
2025-02-21 20:25:44,668 - {'epoch': 28, 'rec_loss': '6.8822'}
2025-02-21 20:25:52,092 - {'Epoch': 28, 'HR@5': '0.0922', 'NDCG@5': '0.0664', 'HR@10': '0.1266', 'NDCG@10': '0.0774', 'HR@20': '0.1654', 'NDCG@20': '0.0872'}
2025-02-21 20:25:52,098 - EarlyStopping counter: 1 out of 10
2025-02-21 20:26:15,929 - {'epoch': 29, 'rec_loss': '6.8651'}
2025-02-21 20:26:23,660 - {'Epoch': 29, 'HR@5': '0.0930', 'NDCG@5': '0.0671', 'HR@10': '0.1249', 'NDCG@10': '0.0774', 'HR@20': '0.1650', 'NDCG@20': '0.0875'}
2025-02-21 20:26:23,666 - EarlyStopping counter: 2 out of 10
2025-02-21 20:26:47,324 - {'epoch': 30, 'rec_loss': '6.8570'}
2025-02-21 20:26:55,279 - {'Epoch': 30, 'HR@5': '0.0934', 'NDCG@5': '0.0674', 'HR@10': '0.1271', 'NDCG@10': '0.0782', 'HR@20': '0.1659', 'NDCG@20': '0.0880'}
2025-02-21 20:26:55,284 - Validation score increased.  Saving model ...
2025-02-21 20:27:19,384 - {'epoch': 31, 'rec_loss': '6.8467'}
2025-02-21 20:27:26,518 - {'Epoch': 31, 'HR@5': '0.0937', 'NDCG@5': '0.0676', 'HR@10': '0.1245', 'NDCG@10': '0.0776', 'HR@20': '0.1657', 'NDCG@20': '0.0880'}
2025-02-21 20:27:26,526 - EarlyStopping counter: 1 out of 10
2025-02-21 20:27:51,455 - {'epoch': 32, 'rec_loss': '6.8368'}
2025-02-21 20:27:59,255 - {'Epoch': 32, 'HR@5': '0.0923', 'NDCG@5': '0.0669', 'HR@10': '0.1261', 'NDCG@10': '0.0778', 'HR@20': '0.1668', 'NDCG@20': '0.0880'}
2025-02-21 20:27:59,262 - Validation score increased.  Saving model ...
2025-02-21 20:28:24,333 - {'epoch': 33, 'rec_loss': '6.8314'}
2025-02-21 20:28:31,590 - {'Epoch': 33, 'HR@5': '0.0925', 'NDCG@5': '0.0668', 'HR@10': '0.1244', 'NDCG@10': '0.0772', 'HR@20': '0.1661', 'NDCG@20': '0.0876'}
2025-02-21 20:28:31,599 - EarlyStopping counter: 1 out of 10
2025-02-21 20:28:54,554 - {'epoch': 34, 'rec_loss': '6.8140'}
2025-02-21 20:29:01,417 - {'Epoch': 34, 'HR@5': '0.0928', 'NDCG@5': '0.0673', 'HR@10': '0.1262', 'NDCG@10': '0.0781', 'HR@20': '0.1671', 'NDCG@20': '0.0883'}
2025-02-21 20:29:01,418 - Validation score increased.  Saving model ...
2025-02-21 20:29:25,136 - {'epoch': 35, 'rec_loss': '6.8125'}
2025-02-21 20:29:32,623 - {'Epoch': 35, 'HR@5': '0.0933', 'NDCG@5': '0.0677', 'HR@10': '0.1272', 'NDCG@10': '0.0787', 'HR@20': '0.1674', 'NDCG@20': '0.0888'}
2025-02-21 20:29:32,630 - Validation score increased.  Saving model ...
2025-02-21 20:29:56,942 - {'epoch': 36, 'rec_loss': '6.8054'}
2025-02-21 20:30:04,569 - {'Epoch': 36, 'HR@5': '0.0927', 'NDCG@5': '0.0672', 'HR@10': '0.1266', 'NDCG@10': '0.0781', 'HR@20': '0.1661', 'NDCG@20': '0.0881'}
2025-02-21 20:30:04,575 - EarlyStopping counter: 1 out of 10
2025-02-21 20:30:27,768 - {'epoch': 37, 'rec_loss': '6.7933'}
2025-02-21 20:30:35,836 - {'Epoch': 37, 'HR@5': '0.0925', 'NDCG@5': '0.0669', 'HR@10': '0.1270', 'NDCG@10': '0.0780', 'HR@20': '0.1676', 'NDCG@20': '0.0882'}
2025-02-21 20:30:35,842 - EarlyStopping counter: 2 out of 10
2025-02-21 20:30:59,624 - {'epoch': 38, 'rec_loss': '6.7849'}
2025-02-21 20:31:06,665 - {'Epoch': 38, 'HR@5': '0.0934', 'NDCG@5': '0.0677', 'HR@10': '0.1289', 'NDCG@10': '0.0791', 'HR@20': '0.1667', 'NDCG@20': '0.0886'}
2025-02-21 20:31:06,670 - EarlyStopping counter: 3 out of 10
2025-02-21 20:31:30,495 - {'epoch': 39, 'rec_loss': '6.7839'}
2025-02-21 20:31:38,419 - {'Epoch': 39, 'HR@5': '0.0935', 'NDCG@5': '0.0675', 'HR@10': '0.1289', 'NDCG@10': '0.0789', 'HR@20': '0.1681', 'NDCG@20': '0.0887'}
2025-02-21 20:31:38,425 - EarlyStopping counter: 4 out of 10
2025-02-21 20:32:03,100 - {'epoch': 40, 'rec_loss': '6.7697'}
2025-02-21 20:32:11,142 - {'Epoch': 40, 'HR@5': '0.0950', 'NDCG@5': '0.0688', 'HR@10': '0.1276', 'NDCG@10': '0.0793', 'HR@20': '0.1687', 'NDCG@20': '0.0896'}
2025-02-21 20:32:11,149 - Validation score increased.  Saving model ...
2025-02-21 20:32:35,261 - {'epoch': 41, 'rec_loss': '6.7680'}
2025-02-21 20:32:42,186 - {'Epoch': 41, 'HR@5': '0.0945', 'NDCG@5': '0.0678', 'HR@10': '0.1267', 'NDCG@10': '0.0782', 'HR@20': '0.1688', 'NDCG@20': '0.0888'}
2025-02-21 20:32:42,191 - EarlyStopping counter: 1 out of 10
2025-02-21 20:33:05,753 - {'epoch': 42, 'rec_loss': '6.7615'}
2025-02-21 20:33:13,844 - {'Epoch': 42, 'HR@5': '0.0932', 'NDCG@5': '0.0674', 'HR@10': '0.1264', 'NDCG@10': '0.0782', 'HR@20': '0.1681', 'NDCG@20': '0.0887'}
2025-02-21 20:33:13,850 - EarlyStopping counter: 2 out of 10
2025-02-21 20:33:37,871 - {'epoch': 43, 'rec_loss': '6.7526'}
2025-02-21 20:33:45,558 - {'Epoch': 43, 'HR@5': '0.0951', 'NDCG@5': '0.0690', 'HR@10': '0.1263', 'NDCG@10': '0.0790', 'HR@20': '0.1678', 'NDCG@20': '0.0895'}
2025-02-21 20:33:45,559 - EarlyStopping counter: 3 out of 10
2025-02-21 20:34:08,349 - {'epoch': 44, 'rec_loss': '6.7475'}
2025-02-21 20:34:16,110 - {'Epoch': 44, 'HR@5': '0.0946', 'NDCG@5': '0.0683', 'HR@10': '0.1285', 'NDCG@10': '0.0793', 'HR@20': '0.1669', 'NDCG@20': '0.0890'}
2025-02-21 20:34:16,116 - EarlyStopping counter: 4 out of 10
2025-02-21 20:34:39,021 - {'epoch': 45, 'rec_loss': '6.7446'}
2025-02-21 20:34:46,037 - {'Epoch': 45, 'HR@5': '0.0937', 'NDCG@5': '0.0678', 'HR@10': '0.1285', 'NDCG@10': '0.0790', 'HR@20': '0.1691', 'NDCG@20': '0.0893'}
2025-02-21 20:34:46,039 - EarlyStopping counter: 5 out of 10
2025-02-21 20:35:08,976 - {'epoch': 46, 'rec_loss': '6.7424'}
2025-02-21 20:35:16,014 - {'Epoch': 46, 'HR@5': '0.0933', 'NDCG@5': '0.0677', 'HR@10': '0.1257', 'NDCG@10': '0.0782', 'HR@20': '0.1676', 'NDCG@20': '0.0887'}
2025-02-21 20:35:16,019 - EarlyStopping counter: 6 out of 10
2025-02-21 20:35:41,587 - {'epoch': 47, 'rec_loss': '6.7340'}
2025-02-21 20:35:48,499 - {'Epoch': 47, 'HR@5': '0.0951', 'NDCG@5': '0.0682', 'HR@10': '0.1279', 'NDCG@10': '0.0787', 'HR@20': '0.1693', 'NDCG@20': '0.0892'}
2025-02-21 20:35:48,505 - EarlyStopping counter: 7 out of 10
2025-02-21 20:36:11,924 - {'epoch': 48, 'rec_loss': '6.7223'}
2025-02-21 20:36:19,671 - {'Epoch': 48, 'HR@5': '0.0951', 'NDCG@5': '0.0684', 'HR@10': '0.1277', 'NDCG@10': '0.0789', 'HR@20': '0.1684', 'NDCG@20': '0.0891'}
2025-02-21 20:36:19,677 - EarlyStopping counter: 8 out of 10
2025-02-21 20:36:43,068 - {'epoch': 49, 'rec_loss': '6.7142'}
2025-02-21 20:36:51,104 - {'Epoch': 49, 'HR@5': '0.0942', 'NDCG@5': '0.0677', 'HR@10': '0.1258', 'NDCG@10': '0.0779', 'HR@20': '0.1686', 'NDCG@20': '0.0887'}
2025-02-21 20:36:51,111 - EarlyStopping counter: 9 out of 10
2025-02-21 20:37:14,322 - {'epoch': 50, 'rec_loss': '6.7220'}
2025-02-21 20:37:21,415 - {'Epoch': 50, 'HR@5': '0.0952', 'NDCG@5': '0.0679', 'HR@10': '0.1276', 'NDCG@10': '0.0783', 'HR@20': '0.1678', 'NDCG@20': '0.0885'}
2025-02-21 20:37:21,423 - EarlyStopping counter: 10 out of 10
2025-02-21 20:37:21,423 - Early stopping
2025-02-21 20:37:21,423 - ---------------Test Score---------------
2025-02-21 20:37:29,421 - {'Epoch': 0, 'HR@5': '0.0785', 'NDCG@5': '0.0569', 'HR@10': '0.1067', 'NDCG@10': '0.0660', 'HR@20': '0.1428', 'NDCG@20': '0.0751'}
2025-02-21 20:37:29,432 - Scale_Toys
2025-02-21 20:37:29,433 - {'Epoch': 0, 'HR@5': '0.0785', 'NDCG@5': '0.0569', 'HR@10': '0.1067', 'NDCG@10': '0.0660', 'HR@20': '0.1428', 'NDCG@20': '0.0751'}
2025-02-21 22:24:27,994 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-02-21 22:24:37,320 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-21 22:24:37,459 - Total Parameters: 918117
2025-02-21 22:25:14,828 - {'epoch': 0, 'rec_loss': '9.0954'}
2025-02-21 22:25:22,705 - {'Epoch': 0, 'HR@5': '0.0062', 'NDCG@5': '0.0039', 'HR@10': '0.0114', 'NDCG@10': '0.0056', 'HR@20': '0.0195', 'NDCG@20': '0.0076'}
2025-02-21 22:25:22,712 - Validation score increased.  Saving model ...
2025-02-21 22:25:56,779 - {'epoch': 1, 'rec_loss': '8.7065'}
2025-02-21 22:26:05,496 - {'Epoch': 1, 'HR@5': '0.0172', 'NDCG@5': '0.0121', 'HR@10': '0.0244', 'NDCG@10': '0.0144', 'HR@20': '0.0394', 'NDCG@20': '0.0182'}
2025-02-21 22:26:05,501 - Validation score increased.  Saving model ...
2025-02-21 22:26:38,916 - {'epoch': 2, 'rec_loss': '8.4022'}
2025-02-21 22:26:46,659 - {'Epoch': 2, 'HR@5': '0.0357', 'NDCG@5': '0.0257', 'HR@10': '0.0514', 'NDCG@10': '0.0307', 'HR@20': '0.0731', 'NDCG@20': '0.0361'}
2025-02-21 22:26:46,666 - Validation score increased.  Saving model ...
2025-02-21 22:27:19,495 - {'epoch': 3, 'rec_loss': '8.1219'}
2025-02-21 22:27:28,825 - {'Epoch': 3, 'HR@5': '0.0497', 'NDCG@5': '0.0352', 'HR@10': '0.0706', 'NDCG@10': '0.0420', 'HR@20': '0.1003', 'NDCG@20': '0.0494'}
2025-02-21 22:27:28,833 - Validation score increased.  Saving model ...
2025-02-21 22:28:01,281 - {'epoch': 4, 'rec_loss': '7.8959'}
2025-02-21 22:28:08,981 - {'Epoch': 4, 'HR@5': '0.0621', 'NDCG@5': '0.0444', 'HR@10': '0.0865', 'NDCG@10': '0.0523', 'HR@20': '0.1181', 'NDCG@20': '0.0602'}
2025-02-21 22:28:08,989 - Validation score increased.  Saving model ...
2025-02-21 22:28:43,046 - {'epoch': 5, 'rec_loss': '7.7304'}
2025-02-21 22:28:51,632 - {'Epoch': 5, 'HR@5': '0.0696', 'NDCG@5': '0.0495', 'HR@10': '0.0965', 'NDCG@10': '0.0582', 'HR@20': '0.1313', 'NDCG@20': '0.0669'}
2025-02-21 22:28:51,640 - Validation score increased.  Saving model ...
2025-02-21 22:29:25,512 - {'epoch': 6, 'rec_loss': '7.5990'}
2025-02-21 22:29:34,046 - {'Epoch': 6, 'HR@5': '0.0745', 'NDCG@5': '0.0537', 'HR@10': '0.1027', 'NDCG@10': '0.0627', 'HR@20': '0.1390', 'NDCG@20': '0.0718'}
2025-02-21 22:29:34,055 - Validation score increased.  Saving model ...
2025-02-21 22:30:07,215 - {'epoch': 7, 'rec_loss': '7.5014'}
2025-02-21 22:30:15,157 - {'Epoch': 7, 'HR@5': '0.0780', 'NDCG@5': '0.0566', 'HR@10': '0.1079', 'NDCG@10': '0.0662', 'HR@20': '0.1444', 'NDCG@20': '0.0754'}
2025-02-21 22:30:15,162 - Validation score increased.  Saving model ...
2025-02-21 22:30:46,900 - {'epoch': 8, 'rec_loss': '7.4173'}
2025-02-21 22:30:55,415 - {'Epoch': 8, 'HR@5': '0.0817', 'NDCG@5': '0.0590', 'HR@10': '0.1103', 'NDCG@10': '0.0681', 'HR@20': '0.1484', 'NDCG@20': '0.0776'}
2025-02-21 22:30:55,420 - Validation score increased.  Saving model ...
2025-02-21 22:31:27,840 - {'epoch': 9, 'rec_loss': '7.3556'}
2025-02-21 22:31:36,263 - {'Epoch': 9, 'HR@5': '0.0847', 'NDCG@5': '0.0611', 'HR@10': '0.1116', 'NDCG@10': '0.0698', 'HR@20': '0.1508', 'NDCG@20': '0.0796'}
2025-02-21 22:31:36,272 - Validation score increased.  Saving model ...
2025-02-21 22:32:08,183 - {'epoch': 10, 'rec_loss': '7.3077'}
2025-02-21 22:32:16,856 - {'Epoch': 10, 'HR@5': '0.0861', 'NDCG@5': '0.0619', 'HR@10': '0.1145', 'NDCG@10': '0.0710', 'HR@20': '0.1534', 'NDCG@20': '0.0808'}
2025-02-21 22:32:16,857 - Validation score increased.  Saving model ...
2025-02-21 22:32:48,655 - {'epoch': 11, 'rec_loss': '7.2575'}
2025-02-21 22:32:57,338 - {'Epoch': 11, 'HR@5': '0.0851', 'NDCG@5': '0.0623', 'HR@10': '0.1168', 'NDCG@10': '0.0725', 'HR@20': '0.1560', 'NDCG@20': '0.0825'}
2025-02-21 22:32:57,347 - Validation score increased.  Saving model ...
2025-02-21 22:33:29,463 - {'epoch': 12, 'rec_loss': '7.2183'}
2025-02-21 22:33:37,903 - {'Epoch': 12, 'HR@5': '0.0870', 'NDCG@5': '0.0635', 'HR@10': '0.1178', 'NDCG@10': '0.0734', 'HR@20': '0.1572', 'NDCG@20': '0.0833'}
2025-02-21 22:33:37,912 - Validation score increased.  Saving model ...
2025-02-21 22:34:03,769 - {'epoch': 13, 'rec_loss': '7.1844'}
2025-02-21 22:34:12,195 - {'Epoch': 13, 'HR@5': '0.0872', 'NDCG@5': '0.0631', 'HR@10': '0.1178', 'NDCG@10': '0.0729', 'HR@20': '0.1562', 'NDCG@20': '0.0826'}
2025-02-21 22:34:12,203 - EarlyStopping counter: 1 out of 10
2025-02-21 22:34:48,445 - {'epoch': 14, 'rec_loss': '7.1541'}
2025-02-21 22:34:56,970 - {'Epoch': 14, 'HR@5': '0.0878', 'NDCG@5': '0.0645', 'HR@10': '0.1192', 'NDCG@10': '0.0746', 'HR@20': '0.1579', 'NDCG@20': '0.0843'}
2025-02-21 22:34:56,978 - Validation score increased.  Saving model ...
2025-02-21 22:35:31,370 - {'epoch': 15, 'rec_loss': '7.1288'}
2025-02-21 22:35:39,070 - {'Epoch': 15, 'HR@5': '0.0875', 'NDCG@5': '0.0638', 'HR@10': '0.1195', 'NDCG@10': '0.0741', 'HR@20': '0.1579', 'NDCG@20': '0.0838'}
2025-02-21 22:35:39,076 - EarlyStopping counter: 1 out of 10
2025-02-21 22:36:11,834 - {'epoch': 16, 'rec_loss': '7.1001'}
2025-02-21 22:36:19,506 - {'Epoch': 16, 'HR@5': '0.0889', 'NDCG@5': '0.0646', 'HR@10': '0.1216', 'NDCG@10': '0.0752', 'HR@20': '0.1591', 'NDCG@20': '0.0846'}
2025-02-21 22:36:19,512 - Validation score increased.  Saving model ...
2025-02-21 22:36:52,521 - {'epoch': 17, 'rec_loss': '7.0766'}
2025-02-21 22:37:01,172 - {'Epoch': 17, 'HR@5': '0.0911', 'NDCG@5': '0.0655', 'HR@10': '0.1207', 'NDCG@10': '0.0750', 'HR@20': '0.1597', 'NDCG@20': '0.0848'}
2025-02-21 22:37:01,177 - Validation score increased.  Saving model ...
2025-02-21 22:37:33,956 - {'epoch': 18, 'rec_loss': '7.0665'}
2025-02-21 22:37:42,062 - {'Epoch': 18, 'HR@5': '0.0896', 'NDCG@5': '0.0649', 'HR@10': '0.1218', 'NDCG@10': '0.0753', 'HR@20': '0.1607', 'NDCG@20': '0.0851'}
2025-02-21 22:37:42,063 - Validation score increased.  Saving model ...
2025-02-21 22:38:13,984 - {'epoch': 19, 'rec_loss': '7.0439'}
2025-02-21 22:38:21,593 - {'Epoch': 19, 'HR@5': '0.0909', 'NDCG@5': '0.0654', 'HR@10': '0.1228', 'NDCG@10': '0.0756', 'HR@20': '0.1610', 'NDCG@20': '0.0852'}
2025-02-21 22:38:21,599 - Validation score increased.  Saving model ...
2025-02-21 22:38:53,616 - {'epoch': 20, 'rec_loss': '7.0264'}
2025-02-21 22:39:02,313 - {'Epoch': 20, 'HR@5': '0.0891', 'NDCG@5': '0.0649', 'HR@10': '0.1219', 'NDCG@10': '0.0754', 'HR@20': '0.1632', 'NDCG@20': '0.0858'}
2025-02-21 22:39:02,320 - Validation score increased.  Saving model ...
2025-02-21 22:39:34,269 - {'epoch': 21, 'rec_loss': '7.0078'}
2025-02-21 22:39:42,701 - {'Epoch': 21, 'HR@5': '0.0922', 'NDCG@5': '0.0664', 'HR@10': '0.1239', 'NDCG@10': '0.0766', 'HR@20': '0.1627', 'NDCG@20': '0.0864'}
2025-02-21 22:39:42,707 - Validation score increased.  Saving model ...
2025-02-21 22:40:14,362 - {'epoch': 22, 'rec_loss': '6.9944'}
2025-02-21 22:40:23,051 - {'Epoch': 22, 'HR@5': '0.0904', 'NDCG@5': '0.0663', 'HR@10': '0.1234', 'NDCG@10': '0.0769', 'HR@20': '0.1639', 'NDCG@20': '0.0872'}
2025-02-21 22:40:23,058 - Validation score increased.  Saving model ...
2025-02-21 22:40:54,901 - {'epoch': 23, 'rec_loss': '6.9835'}
2025-02-21 22:41:03,163 - {'Epoch': 23, 'HR@5': '0.0907', 'NDCG@5': '0.0663', 'HR@10': '0.1225', 'NDCG@10': '0.0765', 'HR@20': '0.1646', 'NDCG@20': '0.0871'}
2025-02-21 22:41:03,170 - EarlyStopping counter: 1 out of 10
2025-02-21 22:41:34,619 - {'epoch': 24, 'rec_loss': '6.9619'}
2025-02-21 22:41:42,944 - {'Epoch': 24, 'HR@5': '0.0910', 'NDCG@5': '0.0659', 'HR@10': '0.1235', 'NDCG@10': '0.0763', 'HR@20': '0.1647', 'NDCG@20': '0.0867'}
2025-02-21 22:41:42,951 - EarlyStopping counter: 2 out of 10
2025-02-21 22:42:14,608 - {'epoch': 25, 'rec_loss': '6.9456'}
2025-02-21 22:42:22,350 - {'Epoch': 25, 'HR@5': '0.0897', 'NDCG@5': '0.0655', 'HR@10': '0.1228', 'NDCG@10': '0.0762', 'HR@20': '0.1635', 'NDCG@20': '0.0864'}
2025-02-21 22:42:22,356 - EarlyStopping counter: 3 out of 10
2025-02-21 22:42:54,861 - {'epoch': 26, 'rec_loss': '6.9442'}
2025-02-21 22:43:03,098 - {'Epoch': 26, 'HR@5': '0.0915', 'NDCG@5': '0.0662', 'HR@10': '0.1229', 'NDCG@10': '0.0763', 'HR@20': '0.1640', 'NDCG@20': '0.0866'}
2025-02-21 22:43:03,105 - EarlyStopping counter: 4 out of 10
2025-02-21 22:43:35,771 - {'epoch': 27, 'rec_loss': '6.9256'}
2025-02-21 22:43:43,641 - {'Epoch': 27, 'HR@5': '0.0923', 'NDCG@5': '0.0670', 'HR@10': '0.1248', 'NDCG@10': '0.0775', 'HR@20': '0.1644', 'NDCG@20': '0.0875'}
2025-02-21 22:43:43,649 - Validation score increased.  Saving model ...
2025-02-21 22:44:12,976 - {'epoch': 28, 'rec_loss': '6.9230'}
2025-02-21 22:44:20,879 - {'Epoch': 28, 'HR@5': '0.0925', 'NDCG@5': '0.0668', 'HR@10': '0.1254', 'NDCG@10': '0.0773', 'HR@20': '0.1642', 'NDCG@20': '0.0871'}
2025-02-21 22:44:20,886 - EarlyStopping counter: 1 out of 10
2025-02-21 22:44:57,178 - {'epoch': 29, 'rec_loss': '6.9062'}
2025-02-21 22:45:05,767 - {'Epoch': 29, 'HR@5': '0.0931', 'NDCG@5': '0.0670', 'HR@10': '0.1236', 'NDCG@10': '0.0768', 'HR@20': '0.1647', 'NDCG@20': '0.0872'}
2025-02-21 22:45:05,773 - EarlyStopping counter: 2 out of 10
2025-02-21 22:45:42,005 - {'epoch': 30, 'rec_loss': '6.9009'}
2025-02-21 22:45:50,598 - {'Epoch': 30, 'HR@5': '0.0914', 'NDCG@5': '0.0668', 'HR@10': '0.1235', 'NDCG@10': '0.0771', 'HR@20': '0.1657', 'NDCG@20': '0.0877'}
2025-02-21 22:45:50,606 - Validation score increased.  Saving model ...
2025-02-21 22:46:22,044 - {'epoch': 31, 'rec_loss': '6.8901'}
2025-02-21 22:46:30,616 - {'Epoch': 31, 'HR@5': '0.0914', 'NDCG@5': '0.0668', 'HR@10': '0.1240', 'NDCG@10': '0.0774', 'HR@20': '0.1649', 'NDCG@20': '0.0877'}
2025-02-21 22:46:30,623 - EarlyStopping counter: 1 out of 10
2025-02-21 22:47:03,549 - {'epoch': 32, 'rec_loss': '6.8795'}
2025-02-21 22:47:12,504 - {'Epoch': 32, 'HR@5': '0.0905', 'NDCG@5': '0.0663', 'HR@10': '0.1244', 'NDCG@10': '0.0772', 'HR@20': '0.1654', 'NDCG@20': '0.0876'}
2025-02-21 22:47:12,509 - EarlyStopping counter: 2 out of 10
2025-02-21 22:47:46,682 - {'epoch': 33, 'rec_loss': '6.8703'}
2025-02-21 22:47:54,720 - {'Epoch': 33, 'HR@5': '0.0920', 'NDCG@5': '0.0671', 'HR@10': '0.1250', 'NDCG@10': '0.0777', 'HR@20': '0.1641', 'NDCG@20': '0.0875'}
2025-02-21 22:47:54,721 - EarlyStopping counter: 3 out of 10
2025-02-21 22:48:28,049 - {'epoch': 34, 'rec_loss': '6.8555'}
2025-02-21 22:48:36,055 - {'Epoch': 34, 'HR@5': '0.0926', 'NDCG@5': '0.0673', 'HR@10': '0.1252', 'NDCG@10': '0.0778', 'HR@20': '0.1665', 'NDCG@20': '0.0882'}
2025-02-21 22:48:36,063 - Validation score increased.  Saving model ...
2025-02-21 22:49:10,431 - {'epoch': 35, 'rec_loss': '6.8529'}
2025-02-21 22:49:18,635 - {'Epoch': 35, 'HR@5': '0.0932', 'NDCG@5': '0.0679', 'HR@10': '0.1263', 'NDCG@10': '0.0786', 'HR@20': '0.1671', 'NDCG@20': '0.0888'}
2025-02-21 22:49:18,641 - Validation score increased.  Saving model ...
2025-02-21 22:49:52,647 - {'epoch': 36, 'rec_loss': '6.8478'}
2025-02-21 22:50:01,096 - {'Epoch': 36, 'HR@5': '0.0938', 'NDCG@5': '0.0679', 'HR@10': '0.1270', 'NDCG@10': '0.0786', 'HR@20': '0.1664', 'NDCG@20': '0.0885'}
2025-02-21 22:50:01,102 - EarlyStopping counter: 1 out of 10
2025-02-21 22:50:34,111 - {'epoch': 37, 'rec_loss': '6.8330'}
2025-02-21 22:50:42,657 - {'Epoch': 37, 'HR@5': '0.0925', 'NDCG@5': '0.0671', 'HR@10': '0.1256', 'NDCG@10': '0.0777', 'HR@20': '0.1667', 'NDCG@20': '0.0881'}
2025-02-21 22:50:42,665 - EarlyStopping counter: 2 out of 10
2025-02-21 22:51:15,288 - {'epoch': 38, 'rec_loss': '6.8276'}
2025-02-21 22:51:23,984 - {'Epoch': 38, 'HR@5': '0.0932', 'NDCG@5': '0.0671', 'HR@10': '0.1261', 'NDCG@10': '0.0777', 'HR@20': '0.1667', 'NDCG@20': '0.0879'}
2025-02-21 22:51:23,992 - EarlyStopping counter: 3 out of 10
2025-02-21 22:51:55,909 - {'epoch': 39, 'rec_loss': '6.8260'}
2025-02-21 22:52:03,535 - {'Epoch': 39, 'HR@5': '0.0945', 'NDCG@5': '0.0682', 'HR@10': '0.1260', 'NDCG@10': '0.0784', 'HR@20': '0.1676', 'NDCG@20': '0.0888'}
2025-02-21 22:52:03,540 - EarlyStopping counter: 4 out of 10
2025-02-21 22:52:38,628 - {'epoch': 40, 'rec_loss': '6.8115'}
2025-02-21 22:52:47,402 - {'Epoch': 40, 'HR@5': '0.0939', 'NDCG@5': '0.0682', 'HR@10': '0.1271', 'NDCG@10': '0.0789', 'HR@20': '0.1657', 'NDCG@20': '0.0886'}
2025-02-21 22:52:47,407 - EarlyStopping counter: 5 out of 10
2025-02-21 22:53:19,358 - {'epoch': 41, 'rec_loss': '6.8123'}
2025-02-21 22:53:27,325 - {'Epoch': 41, 'HR@5': '0.0942', 'NDCG@5': '0.0679', 'HR@10': '0.1252', 'NDCG@10': '0.0779', 'HR@20': '0.1671', 'NDCG@20': '0.0885'}
2025-02-21 22:53:27,329 - EarlyStopping counter: 6 out of 10
2025-02-21 22:53:58,824 - {'epoch': 42, 'rec_loss': '6.8072'}
2025-02-21 22:54:06,543 - {'Epoch': 42, 'HR@5': '0.0936', 'NDCG@5': '0.0679', 'HR@10': '0.1257', 'NDCG@10': '0.0782', 'HR@20': '0.1656', 'NDCG@20': '0.0882'}
2025-02-21 22:54:06,551 - EarlyStopping counter: 7 out of 10
2025-02-21 22:54:37,117 - {'epoch': 43, 'rec_loss': '6.7982'}
2025-02-21 22:54:45,155 - {'Epoch': 43, 'HR@5': '0.0937', 'NDCG@5': '0.0682', 'HR@10': '0.1261', 'NDCG@10': '0.0786', 'HR@20': '0.1661', 'NDCG@20': '0.0887'}
2025-02-21 22:54:45,163 - EarlyStopping counter: 8 out of 10
2025-02-21 22:55:22,486 - {'epoch': 44, 'rec_loss': '6.7902'}
2025-02-21 22:55:31,180 - {'Epoch': 44, 'HR@5': '0.0938', 'NDCG@5': '0.0678', 'HR@10': '0.1266', 'NDCG@10': '0.0783', 'HR@20': '0.1671', 'NDCG@20': '0.0885'}
2025-02-21 22:55:31,187 - EarlyStopping counter: 9 out of 10
2025-02-21 22:56:07,965 - {'epoch': 45, 'rec_loss': '6.7857'}
2025-02-21 22:56:16,509 - {'Epoch': 45, 'HR@5': '0.0937', 'NDCG@5': '0.0679', 'HR@10': '0.1265', 'NDCG@10': '0.0784', 'HR@20': '0.1671', 'NDCG@20': '0.0887'}
2025-02-21 22:56:16,516 - EarlyStopping counter: 10 out of 10
2025-02-21 22:56:16,516 - Early stopping
2025-02-21 22:56:16,516 - ---------------Test Score---------------
2025-02-21 22:56:25,438 - {'Epoch': 0, 'HR@5': '0.0798', 'NDCG@5': '0.0582', 'HR@10': '0.1072', 'NDCG@10': '0.0670', 'HR@20': '0.1426', 'NDCG@20': '0.0759'}
2025-02-21 22:56:25,448 - Scale_Toys
2025-02-21 22:56:25,448 - {'Epoch': 0, 'HR@5': '0.0798', 'NDCG@5': '0.0582', 'HR@10': '0.1072', 'NDCG@10': '0.0670', 'HR@20': '0.1426', 'NDCG@20': '0.0759'}
2025-02-22 09:00:52,282 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25, 10], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-02-22 09:01:01,713 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-22 09:01:01,737 - Total Parameters: 917142
2025-02-22 09:01:46,005 - {'epoch': 0, 'rec_loss': '9.0945'}
2025-02-22 09:01:54,837 - {'Epoch': 0, 'HR@5': '0.0070', 'NDCG@5': '0.0040', 'HR@10': '0.0128', 'NDCG@10': '0.0059', 'HR@20': '0.0208', 'NDCG@20': '0.0079'}
2025-02-22 09:01:54,840 - Validation score increased.  Saving model ...
2025-02-22 09:02:36,965 - {'epoch': 1, 'rec_loss': '8.6394'}
2025-02-22 09:02:45,719 - {'Epoch': 1, 'HR@5': '0.0215', 'NDCG@5': '0.0159', 'HR@10': '0.0316', 'NDCG@10': '0.0192', 'HR@20': '0.0486', 'NDCG@20': '0.0234'}
2025-02-22 09:02:45,724 - Validation score increased.  Saving model ...
2025-02-22 09:03:28,244 - {'epoch': 2, 'rec_loss': '8.2809'}
2025-02-22 09:03:36,780 - {'Epoch': 2, 'HR@5': '0.0420', 'NDCG@5': '0.0298', 'HR@10': '0.0608', 'NDCG@10': '0.0358', 'HR@20': '0.0873', 'NDCG@20': '0.0425'}
2025-02-22 09:03:36,785 - Validation score increased.  Saving model ...
2025-02-22 09:04:22,455 - {'epoch': 3, 'rec_loss': '7.9597'}
2025-02-22 09:04:32,160 - {'Epoch': 3, 'HR@5': '0.0591', 'NDCG@5': '0.0426', 'HR@10': '0.0828', 'NDCG@10': '0.0502', 'HR@20': '0.1125', 'NDCG@20': '0.0577'}
2025-02-22 09:04:32,168 - Validation score increased.  Saving model ...
2025-02-22 09:05:14,827 - {'epoch': 4, 'rec_loss': '7.7375'}
2025-02-22 09:05:23,949 - {'Epoch': 4, 'HR@5': '0.0696', 'NDCG@5': '0.0503', 'HR@10': '0.0948', 'NDCG@10': '0.0585', 'HR@20': '0.1278', 'NDCG@20': '0.0667'}
2025-02-22 09:05:23,955 - Validation score increased.  Saving model ...
2025-02-22 09:06:05,953 - {'epoch': 5, 'rec_loss': '7.5687'}
2025-02-22 09:06:14,166 - {'Epoch': 5, 'HR@5': '0.0746', 'NDCG@5': '0.0541', 'HR@10': '0.1041', 'NDCG@10': '0.0636', 'HR@20': '0.1386', 'NDCG@20': '0.0723'}
2025-02-22 09:06:14,172 - Validation score increased.  Saving model ...
2025-02-22 09:06:59,158 - {'epoch': 6, 'rec_loss': '7.4511'}
2025-02-22 09:07:07,572 - {'Epoch': 6, 'HR@5': '0.0804', 'NDCG@5': '0.0591', 'HR@10': '0.1086', 'NDCG@10': '0.0681', 'HR@20': '0.1442', 'NDCG@20': '0.0771'}
2025-02-22 09:07:07,576 - Validation score increased.  Saving model ...
2025-02-22 09:07:50,169 - {'epoch': 7, 'rec_loss': '7.3611'}
2025-02-22 09:07:59,475 - {'Epoch': 7, 'HR@5': '0.0820', 'NDCG@5': '0.0600', 'HR@10': '0.1101', 'NDCG@10': '0.0691', 'HR@20': '0.1476', 'NDCG@20': '0.0786'}
2025-02-22 09:07:59,481 - Validation score increased.  Saving model ...
2025-02-22 09:08:36,816 - {'epoch': 8, 'rec_loss': '7.2891'}
2025-02-22 09:08:45,514 - {'Epoch': 8, 'HR@5': '0.0839', 'NDCG@5': '0.0613', 'HR@10': '0.1146', 'NDCG@10': '0.0712', 'HR@20': '0.1504', 'NDCG@20': '0.0802'}
2025-02-22 09:08:45,520 - Validation score increased.  Saving model ...
2025-02-22 09:09:32,477 - {'epoch': 9, 'rec_loss': '7.2246'}
2025-02-22 09:09:40,814 - {'Epoch': 9, 'HR@5': '0.0848', 'NDCG@5': '0.0616', 'HR@10': '0.1175', 'NDCG@10': '0.0721', 'HR@20': '0.1532', 'NDCG@20': '0.0811'}
2025-02-22 09:09:40,822 - Validation score increased.  Saving model ...
2025-02-22 09:10:24,553 - {'epoch': 10, 'rec_loss': '7.1751'}
2025-02-22 09:10:33,179 - {'Epoch': 10, 'HR@5': '0.0880', 'NDCG@5': '0.0634', 'HR@10': '0.1194', 'NDCG@10': '0.0735', 'HR@20': '0.1566', 'NDCG@20': '0.0828'}
2025-02-22 09:10:33,185 - Validation score increased.  Saving model ...
2025-02-22 09:11:16,578 - {'epoch': 11, 'rec_loss': '7.1333'}
2025-02-22 09:11:26,299 - {'Epoch': 11, 'HR@5': '0.0880', 'NDCG@5': '0.0638', 'HR@10': '0.1199', 'NDCG@10': '0.0740', 'HR@20': '0.1596', 'NDCG@20': '0.0840'}
2025-02-22 09:11:26,307 - Validation score increased.  Saving model ...
2025-02-22 09:12:08,213 - {'epoch': 12, 'rec_loss': '7.0982'}
2025-02-22 09:12:16,596 - {'Epoch': 12, 'HR@5': '0.0884', 'NDCG@5': '0.0640', 'HR@10': '0.1193', 'NDCG@10': '0.0739', 'HR@20': '0.1569', 'NDCG@20': '0.0834'}
2025-02-22 09:12:16,602 - EarlyStopping counter: 1 out of 10
2025-02-22 09:12:58,958 - {'epoch': 13, 'rec_loss': '7.0699'}
2025-02-22 09:13:08,854 - {'Epoch': 13, 'HR@5': '0.0891', 'NDCG@5': '0.0647', 'HR@10': '0.1209', 'NDCG@10': '0.0749', 'HR@20': '0.1591', 'NDCG@20': '0.0845'}
2025-02-22 09:13:08,859 - Validation score increased.  Saving model ...
2025-02-22 09:13:51,295 - {'epoch': 14, 'rec_loss': '7.0439'}
2025-02-22 09:14:01,687 - {'Epoch': 14, 'HR@5': '0.0895', 'NDCG@5': '0.0645', 'HR@10': '0.1222', 'NDCG@10': '0.0751', 'HR@20': '0.1602', 'NDCG@20': '0.0846'}
2025-02-22 09:14:01,692 - Validation score increased.  Saving model ...
2025-02-22 09:14:45,797 - {'epoch': 15, 'rec_loss': '7.0133'}
2025-02-22 09:14:54,304 - {'Epoch': 15, 'HR@5': '0.0920', 'NDCG@5': '0.0662', 'HR@10': '0.1230', 'NDCG@10': '0.0762', 'HR@20': '0.1621', 'NDCG@20': '0.0861'}
2025-02-22 09:14:54,312 - Validation score increased.  Saving model ...
2025-02-22 09:15:38,399 - {'epoch': 16, 'rec_loss': '6.9862'}
2025-02-22 09:15:48,035 - {'Epoch': 16, 'HR@5': '0.0926', 'NDCG@5': '0.0672', 'HR@10': '0.1235', 'NDCG@10': '0.0771', 'HR@20': '0.1621', 'NDCG@20': '0.0869'}
2025-02-22 09:15:48,042 - Validation score increased.  Saving model ...
2025-02-22 09:16:29,777 - {'epoch': 17, 'rec_loss': '6.9687'}
2025-02-22 09:16:38,971 - {'Epoch': 17, 'HR@5': '0.0916', 'NDCG@5': '0.0661', 'HR@10': '0.1232', 'NDCG@10': '0.0763', 'HR@20': '0.1622', 'NDCG@20': '0.0861'}
2025-02-22 09:16:38,979 - EarlyStopping counter: 1 out of 10
2025-02-22 09:17:20,957 - {'epoch': 18, 'rec_loss': '6.9520'}
2025-02-22 09:17:29,875 - {'Epoch': 18, 'HR@5': '0.0916', 'NDCG@5': '0.0668', 'HR@10': '0.1227', 'NDCG@10': '0.0768', 'HR@20': '0.1634', 'NDCG@20': '0.0870'}
2025-02-22 09:17:29,881 - Validation score increased.  Saving model ...
2025-02-22 09:18:11,293 - {'epoch': 19, 'rec_loss': '6.9247'}
2025-02-22 09:18:19,687 - {'Epoch': 19, 'HR@5': '0.0928', 'NDCG@5': '0.0668', 'HR@10': '0.1234', 'NDCG@10': '0.0766', 'HR@20': '0.1619', 'NDCG@20': '0.0862'}
2025-02-22 09:18:19,693 - EarlyStopping counter: 1 out of 10
2025-02-22 09:18:58,158 - {'epoch': 20, 'rec_loss': '6.9158'}
2025-02-22 09:19:06,179 - {'Epoch': 20, 'HR@5': '0.0924', 'NDCG@5': '0.0668', 'HR@10': '0.1233', 'NDCG@10': '0.0767', 'HR@20': '0.1600', 'NDCG@20': '0.0860'}
2025-02-22 09:19:06,186 - EarlyStopping counter: 2 out of 10
2025-02-22 09:19:50,851 - {'epoch': 21, 'rec_loss': '6.9020'}
2025-02-22 09:20:01,195 - {'Epoch': 21, 'HR@5': '0.0932', 'NDCG@5': '0.0671', 'HR@10': '0.1239', 'NDCG@10': '0.0770', 'HR@20': '0.1635', 'NDCG@20': '0.0870'}
2025-02-22 09:20:01,203 - EarlyStopping counter: 3 out of 10
2025-02-22 09:20:47,017 - {'epoch': 22, 'rec_loss': '6.8836'}
2025-02-22 09:20:55,482 - {'Epoch': 22, 'HR@5': '0.0929', 'NDCG@5': '0.0671', 'HR@10': '0.1240', 'NDCG@10': '0.0770', 'HR@20': '0.1632', 'NDCG@20': '0.0869'}
2025-02-22 09:20:55,488 - EarlyStopping counter: 4 out of 10
2025-02-22 09:21:37,839 - {'epoch': 23, 'rec_loss': '6.8648'}
2025-02-22 09:21:47,498 - {'Epoch': 23, 'HR@5': '0.0930', 'NDCG@5': '0.0678', 'HR@10': '0.1252', 'NDCG@10': '0.0782', 'HR@20': '0.1645', 'NDCG@20': '0.0880'}
2025-02-22 09:21:47,503 - Validation score increased.  Saving model ...
2025-02-22 09:22:31,839 - {'epoch': 24, 'rec_loss': '6.8553'}
2025-02-22 09:22:41,160 - {'Epoch': 24, 'HR@5': '0.0923', 'NDCG@5': '0.0661', 'HR@10': '0.1255', 'NDCG@10': '0.0768', 'HR@20': '0.1647', 'NDCG@20': '0.0867'}
2025-02-22 09:22:41,166 - EarlyStopping counter: 1 out of 10
2025-02-22 09:23:25,131 - {'epoch': 25, 'rec_loss': '6.8386'}
2025-02-22 09:23:33,485 - {'Epoch': 25, 'HR@5': '0.0933', 'NDCG@5': '0.0673', 'HR@10': '0.1252', 'NDCG@10': '0.0776', 'HR@20': '0.1651', 'NDCG@20': '0.0876'}
2025-02-22 09:23:33,491 - EarlyStopping counter: 2 out of 10
2025-02-22 09:24:15,673 - {'epoch': 26, 'rec_loss': '6.8322'}
2025-02-22 09:24:25,334 - {'Epoch': 26, 'HR@5': '0.0937', 'NDCG@5': '0.0679', 'HR@10': '0.1246', 'NDCG@10': '0.0779', 'HR@20': '0.1643', 'NDCG@20': '0.0880'}
2025-02-22 09:24:25,341 - EarlyStopping counter: 3 out of 10
2025-02-22 09:25:08,075 - {'epoch': 27, 'rec_loss': '6.8152'}
2025-02-22 09:25:17,544 - {'Epoch': 27, 'HR@5': '0.0940', 'NDCG@5': '0.0682', 'HR@10': '0.1261', 'NDCG@10': '0.0785', 'HR@20': '0.1653', 'NDCG@20': '0.0884'}
2025-02-22 09:25:17,550 - Validation score increased.  Saving model ...
2025-02-22 09:25:59,919 - {'epoch': 28, 'rec_loss': '6.8117'}
2025-02-22 09:26:08,184 - {'Epoch': 28, 'HR@5': '0.0946', 'NDCG@5': '0.0683', 'HR@10': '0.1260', 'NDCG@10': '0.0784', 'HR@20': '0.1639', 'NDCG@20': '0.0880'}
2025-02-22 09:26:08,191 - EarlyStopping counter: 1 out of 10
2025-02-22 09:26:51,045 - {'epoch': 29, 'rec_loss': '6.8038'}
2025-02-22 09:26:59,122 - {'Epoch': 29, 'HR@5': '0.0934', 'NDCG@5': '0.0679', 'HR@10': '0.1267', 'NDCG@10': '0.0787', 'HR@20': '0.1639', 'NDCG@20': '0.0880'}
2025-02-22 09:26:59,127 - EarlyStopping counter: 2 out of 10
2025-02-22 09:27:41,337 - {'epoch': 30, 'rec_loss': '6.7901'}
2025-02-22 09:27:51,241 - {'Epoch': 30, 'HR@5': '0.0944', 'NDCG@5': '0.0682', 'HR@10': '0.1269', 'NDCG@10': '0.0788', 'HR@20': '0.1649', 'NDCG@20': '0.0884'}
2025-02-22 09:27:51,248 - EarlyStopping counter: 3 out of 10
2025-02-22 09:28:33,480 - {'epoch': 31, 'rec_loss': '6.7729'}
2025-02-22 09:28:42,470 - {'Epoch': 31, 'HR@5': '0.0940', 'NDCG@5': '0.0682', 'HR@10': '0.1257', 'NDCG@10': '0.0784', 'HR@20': '0.1662', 'NDCG@20': '0.0886'}
2025-02-22 09:28:42,476 - Validation score increased.  Saving model ...
2025-02-22 09:29:22,815 - {'epoch': 32, 'rec_loss': '6.7597'}
2025-02-22 09:29:32,566 - {'Epoch': 32, 'HR@5': '0.0930', 'NDCG@5': '0.0674', 'HR@10': '0.1252', 'NDCG@10': '0.0778', 'HR@20': '0.1653', 'NDCG@20': '0.0879'}
2025-02-22 09:29:32,573 - EarlyStopping counter: 1 out of 10
2025-02-22 09:30:18,200 - {'epoch': 33, 'rec_loss': '6.7548'}
2025-02-22 09:30:28,084 - {'Epoch': 33, 'HR@5': '0.0940', 'NDCG@5': '0.0685', 'HR@10': '0.1260', 'NDCG@10': '0.0788', 'HR@20': '0.1656', 'NDCG@20': '0.0888'}
2025-02-22 09:30:28,089 - Validation score increased.  Saving model ...
2025-02-22 09:31:11,424 - {'epoch': 34, 'rec_loss': '6.7459'}
2025-02-22 09:31:21,975 - {'Epoch': 34, 'HR@5': '0.0925', 'NDCG@5': '0.0674', 'HR@10': '0.1244', 'NDCG@10': '0.0777', 'HR@20': '0.1654', 'NDCG@20': '0.0880'}
2025-02-22 09:31:21,981 - EarlyStopping counter: 1 out of 10
2025-02-22 09:32:06,087 - {'epoch': 35, 'rec_loss': '6.7384'}
2025-02-22 09:32:15,935 - {'Epoch': 35, 'HR@5': '0.0935', 'NDCG@5': '0.0678', 'HR@10': '0.1265', 'NDCG@10': '0.0785', 'HR@20': '0.1639', 'NDCG@20': '0.0879'}
2025-02-22 09:32:15,940 - EarlyStopping counter: 2 out of 10
2025-02-22 09:32:58,826 - {'epoch': 36, 'rec_loss': '6.7337'}
2025-02-22 09:33:08,564 - {'Epoch': 36, 'HR@5': '0.0941', 'NDCG@5': '0.0682', 'HR@10': '0.1254', 'NDCG@10': '0.0782', 'HR@20': '0.1654', 'NDCG@20': '0.0883'}
2025-02-22 09:33:08,571 - EarlyStopping counter: 3 out of 10
2025-02-22 09:33:50,865 - {'epoch': 37, 'rec_loss': '6.7208'}
2025-02-22 09:33:59,899 - {'Epoch': 37, 'HR@5': '0.0938', 'NDCG@5': '0.0677', 'HR@10': '0.1244', 'NDCG@10': '0.0776', 'HR@20': '0.1658', 'NDCG@20': '0.0881'}
2025-02-22 09:33:59,905 - EarlyStopping counter: 4 out of 10
2025-02-22 09:34:41,689 - {'epoch': 38, 'rec_loss': '6.7225'}
2025-02-22 09:34:50,050 - {'Epoch': 38, 'HR@5': '0.0936', 'NDCG@5': '0.0684', 'HR@10': '0.1255', 'NDCG@10': '0.0786', 'HR@20': '0.1657', 'NDCG@20': '0.0887'}
2025-02-22 09:34:50,057 - EarlyStopping counter: 5 out of 10
2025-02-22 09:35:32,373 - {'epoch': 39, 'rec_loss': '6.7051'}
2025-02-22 09:35:42,176 - {'Epoch': 39, 'HR@5': '0.0951', 'NDCG@5': '0.0684', 'HR@10': '0.1255', 'NDCG@10': '0.0782', 'HR@20': '0.1648', 'NDCG@20': '0.0881'}
2025-02-22 09:35:42,182 - EarlyStopping counter: 6 out of 10
2025-02-22 09:36:24,198 - {'epoch': 40, 'rec_loss': '6.7045'}
2025-02-22 09:36:32,539 - {'Epoch': 40, 'HR@5': '0.0936', 'NDCG@5': '0.0677', 'HR@10': '0.1254', 'NDCG@10': '0.0779', 'HR@20': '0.1634', 'NDCG@20': '0.0874'}
2025-02-22 09:36:32,544 - EarlyStopping counter: 7 out of 10
2025-02-22 09:37:15,664 - {'epoch': 41, 'rec_loss': '6.6888'}
2025-02-22 09:37:23,822 - {'Epoch': 41, 'HR@5': '0.0925', 'NDCG@5': '0.0669', 'HR@10': '0.1257', 'NDCG@10': '0.0776', 'HR@20': '0.1655', 'NDCG@20': '0.0876'}
2025-02-22 09:37:23,828 - EarlyStopping counter: 8 out of 10
2025-02-22 09:38:07,867 - {'epoch': 42, 'rec_loss': '6.6840'}
2025-02-22 09:38:17,789 - {'Epoch': 42, 'HR@5': '0.0924', 'NDCG@5': '0.0675', 'HR@10': '0.1256', 'NDCG@10': '0.0783', 'HR@20': '0.1659', 'NDCG@20': '0.0884'}
2025-02-22 09:38:17,795 - EarlyStopping counter: 9 out of 10
2025-02-22 09:38:59,549 - {'epoch': 43, 'rec_loss': '6.6788'}
2025-02-22 09:39:08,943 - {'Epoch': 43, 'HR@5': '0.0917', 'NDCG@5': '0.0663', 'HR@10': '0.1247', 'NDCG@10': '0.0770', 'HR@20': '0.1647', 'NDCG@20': '0.0870'}
2025-02-22 09:39:08,950 - EarlyStopping counter: 10 out of 10
2025-02-22 09:39:08,950 - Early stopping
2025-02-22 09:39:08,950 - ---------------Test Score---------------
2025-02-22 09:39:18,707 - {'Epoch': 0, 'HR@5': '0.0774', 'NDCG@5': '0.0558', 'HR@10': '0.1039', 'NDCG@10': '0.0643', 'HR@20': '0.1404', 'NDCG@20': '0.0735'}
2025-02-22 09:39:18,714 - Scale_Toys
2025-02-22 09:39:18,714 - {'Epoch': 0, 'HR@5': '0.0774', 'NDCG@5': '0.0558', 'HR@10': '0.1039', 'NDCG@10': '0.0643', 'HR@20': '0.1404', 'NDCG@20': '0.0735'}
2025-02-22 09:48:03,157 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25, 10, 5], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-02-22 09:48:09,597 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-22 09:48:09,732 - Total Parameters: 916817
2025-02-22 09:49:05,223 - {'epoch': 0, 'rec_loss': '9.1025'}
2025-02-22 09:49:15,145 - {'Epoch': 0, 'HR@5': '0.0070', 'NDCG@5': '0.0047', 'HR@10': '0.0126', 'NDCG@10': '0.0065', 'HR@20': '0.0209', 'NDCG@20': '0.0086'}
2025-02-22 09:49:15,149 - Validation score increased.  Saving model ...
2025-02-22 09:50:05,205 - {'epoch': 1, 'rec_loss': '8.6145'}
2025-02-22 09:50:13,334 - {'Epoch': 1, 'HR@5': '0.0231', 'NDCG@5': '0.0168', 'HR@10': '0.0344', 'NDCG@10': '0.0204', 'HR@20': '0.0533', 'NDCG@20': '0.0251'}
2025-02-22 09:50:13,342 - Validation score increased.  Saving model ...
2025-02-22 09:51:08,303 - {'epoch': 2, 'rec_loss': '8.2175'}
2025-02-22 09:51:16,846 - {'Epoch': 2, 'HR@5': '0.0498', 'NDCG@5': '0.0357', 'HR@10': '0.0691', 'NDCG@10': '0.0419', 'HR@20': '0.0959', 'NDCG@20': '0.0486'}
2025-02-22 09:51:16,852 - Validation score increased.  Saving model ...
2025-02-22 09:52:09,662 - {'epoch': 3, 'rec_loss': '7.8780'}
2025-02-22 09:52:17,850 - {'Epoch': 3, 'HR@5': '0.0655', 'NDCG@5': '0.0474', 'HR@10': '0.0891', 'NDCG@10': '0.0550', 'HR@20': '0.1200', 'NDCG@20': '0.0627'}
2025-02-22 09:52:17,857 - Validation score increased.  Saving model ...
2025-02-22 09:53:09,356 - {'epoch': 4, 'rec_loss': '7.6506'}
2025-02-22 09:53:19,146 - {'Epoch': 4, 'HR@5': '0.0730', 'NDCG@5': '0.0529', 'HR@10': '0.1001', 'NDCG@10': '0.0616', 'HR@20': '0.1336', 'NDCG@20': '0.0701'}
2025-02-22 09:53:19,153 - Validation score increased.  Saving model ...
2025-02-22 09:54:12,128 - {'epoch': 5, 'rec_loss': '7.4906'}
2025-02-22 09:54:21,329 - {'Epoch': 5, 'HR@5': '0.0792', 'NDCG@5': '0.0566', 'HR@10': '0.1091', 'NDCG@10': '0.0662', 'HR@20': '0.1437', 'NDCG@20': '0.0749'}
2025-02-22 09:54:21,336 - Validation score increased.  Saving model ...
2025-02-22 09:55:12,952 - {'epoch': 6, 'rec_loss': '7.3735'}
2025-02-22 09:55:22,452 - {'Epoch': 6, 'HR@5': '0.0815', 'NDCG@5': '0.0586', 'HR@10': '0.1113', 'NDCG@10': '0.0682', 'HR@20': '0.1472', 'NDCG@20': '0.0772'}
2025-02-22 09:55:22,458 - Validation score increased.  Saving model ...
2025-02-22 09:56:13,848 - {'epoch': 7, 'rec_loss': '7.2848'}
2025-02-22 09:56:23,471 - {'Epoch': 7, 'HR@5': '0.0852', 'NDCG@5': '0.0614', 'HR@10': '0.1154', 'NDCG@10': '0.0711', 'HR@20': '0.1508', 'NDCG@20': '0.0801'}
2025-02-22 09:56:23,477 - Validation score increased.  Saving model ...
2025-02-22 09:57:13,884 - {'epoch': 8, 'rec_loss': '7.2126'}
2025-02-22 09:57:22,227 - {'Epoch': 8, 'HR@5': '0.0864', 'NDCG@5': '0.0626', 'HR@10': '0.1193', 'NDCG@10': '0.0732', 'HR@20': '0.1547', 'NDCG@20': '0.0822'}
2025-02-22 09:57:22,234 - Validation score increased.  Saving model ...
2025-02-22 09:58:12,850 - {'epoch': 9, 'rec_loss': '7.1617'}
2025-02-22 09:58:21,737 - {'Epoch': 9, 'HR@5': '0.0882', 'NDCG@5': '0.0636', 'HR@10': '0.1187', 'NDCG@10': '0.0734', 'HR@20': '0.1556', 'NDCG@20': '0.0826'}
2025-02-22 09:58:21,743 - Validation score increased.  Saving model ...
2025-02-22 09:59:14,143 - {'epoch': 10, 'rec_loss': '7.1187'}
2025-02-22 09:59:23,725 - {'Epoch': 10, 'HR@5': '0.0893', 'NDCG@5': '0.0646', 'HR@10': '0.1201', 'NDCG@10': '0.0745', 'HR@20': '0.1583', 'NDCG@20': '0.0841'}
2025-02-22 09:59:23,731 - Validation score increased.  Saving model ...
2025-02-22 10:00:15,152 - {'epoch': 11, 'rec_loss': '7.0693'}
2025-02-22 10:00:23,256 - {'Epoch': 11, 'HR@5': '0.0889', 'NDCG@5': '0.0642', 'HR@10': '0.1195', 'NDCG@10': '0.0741', 'HR@20': '0.1578', 'NDCG@20': '0.0838'}
2025-02-22 10:00:23,263 - EarlyStopping counter: 1 out of 10
2025-02-22 10:01:13,847 - {'epoch': 12, 'rec_loss': '7.0352'}
2025-02-22 10:01:22,174 - {'Epoch': 12, 'HR@5': '0.0907', 'NDCG@5': '0.0653', 'HR@10': '0.1219', 'NDCG@10': '0.0754', 'HR@20': '0.1597', 'NDCG@20': '0.0849'}
2025-02-22 10:01:22,181 - Validation score increased.  Saving model ...
2025-02-22 10:02:15,449 - {'epoch': 13, 'rec_loss': '7.0052'}
2025-02-22 10:02:24,601 - {'Epoch': 13, 'HR@5': '0.0907', 'NDCG@5': '0.0650', 'HR@10': '0.1242', 'NDCG@10': '0.0759', 'HR@20': '0.1592', 'NDCG@20': '0.0847'}
2025-02-22 10:02:24,610 - EarlyStopping counter: 1 out of 10
2025-02-22 10:03:18,506 - {'epoch': 14, 'rec_loss': '6.9797'}
2025-02-22 10:03:28,082 - {'Epoch': 14, 'HR@5': '0.0909', 'NDCG@5': '0.0662', 'HR@10': '0.1228', 'NDCG@10': '0.0765', 'HR@20': '0.1599', 'NDCG@20': '0.0858'}
2025-02-22 10:03:28,089 - Validation score increased.  Saving model ...
2025-02-22 10:04:19,574 - {'epoch': 15, 'rec_loss': '6.9532'}
2025-02-22 10:04:29,094 - {'Epoch': 15, 'HR@5': '0.0912', 'NDCG@5': '0.0656', 'HR@10': '0.1234', 'NDCG@10': '0.0761', 'HR@20': '0.1624', 'NDCG@20': '0.0859'}
2025-02-22 10:04:29,100 - Validation score increased.  Saving model ...
2025-02-22 10:05:19,635 - {'epoch': 16, 'rec_loss': '6.9334'}
2025-02-22 10:05:28,969 - {'Epoch': 16, 'HR@5': '0.0923', 'NDCG@5': '0.0666', 'HR@10': '0.1234', 'NDCG@10': '0.0766', 'HR@20': '0.1622', 'NDCG@20': '0.0864'}
2025-02-22 10:05:28,976 - Validation score increased.  Saving model ...
2025-02-22 10:06:21,023 - {'epoch': 17, 'rec_loss': '6.9107'}
2025-02-22 10:06:30,732 - {'Epoch': 17, 'HR@5': '0.0920', 'NDCG@5': '0.0662', 'HR@10': '0.1254', 'NDCG@10': '0.0770', 'HR@20': '0.1617', 'NDCG@20': '0.0861'}
2025-02-22 10:06:30,739 - EarlyStopping counter: 1 out of 10
2025-02-22 10:07:22,746 - {'epoch': 18, 'rec_loss': '6.8888'}
2025-02-22 10:07:32,012 - {'Epoch': 18, 'HR@5': '0.0903', 'NDCG@5': '0.0653', 'HR@10': '0.1236', 'NDCG@10': '0.0761', 'HR@20': '0.1635', 'NDCG@20': '0.0861'}
2025-02-22 10:07:32,018 - EarlyStopping counter: 2 out of 10
2025-02-22 10:08:22,017 - {'epoch': 19, 'rec_loss': '6.8742'}
2025-02-22 10:08:31,371 - {'Epoch': 19, 'HR@5': '0.0928', 'NDCG@5': '0.0671', 'HR@10': '0.1249', 'NDCG@10': '0.0774', 'HR@20': '0.1637', 'NDCG@20': '0.0871'}
2025-02-22 10:08:31,378 - Validation score increased.  Saving model ...
2025-02-22 10:09:23,558 - {'epoch': 20, 'rec_loss': '6.8577'}
2025-02-22 10:09:33,222 - {'Epoch': 20, 'HR@5': '0.0910', 'NDCG@5': '0.0654', 'HR@10': '0.1233', 'NDCG@10': '0.0759', 'HR@20': '0.1644', 'NDCG@20': '0.0863'}
2025-02-22 10:09:33,229 - EarlyStopping counter: 1 out of 10
2025-02-22 10:10:24,102 - {'epoch': 21, 'rec_loss': '6.8336'}
2025-02-22 10:10:34,178 - {'Epoch': 21, 'HR@5': '0.0927', 'NDCG@5': '0.0669', 'HR@10': '0.1231', 'NDCG@10': '0.0767', 'HR@20': '0.1641', 'NDCG@20': '0.0870'}
2025-02-22 10:10:34,185 - EarlyStopping counter: 2 out of 10
2025-02-22 10:11:20,912 - {'epoch': 22, 'rec_loss': '6.8222'}
2025-02-22 10:11:30,527 - {'Epoch': 22, 'HR@5': '0.0920', 'NDCG@5': '0.0663', 'HR@10': '0.1238', 'NDCG@10': '0.0766', 'HR@20': '0.1651', 'NDCG@20': '0.0870'}
2025-02-22 10:11:30,534 - EarlyStopping counter: 3 out of 10
2025-02-22 10:12:27,209 - {'epoch': 23, 'rec_loss': '6.8087'}
2025-02-22 10:12:36,170 - {'Epoch': 23, 'HR@5': '0.0936', 'NDCG@5': '0.0672', 'HR@10': '0.1240', 'NDCG@10': '0.0770', 'HR@20': '0.1646', 'NDCG@20': '0.0872'}
2025-02-22 10:12:36,177 - Validation score increased.  Saving model ...
2025-02-22 10:13:28,504 - {'epoch': 24, 'rec_loss': '6.7978'}
2025-02-22 10:13:37,858 - {'Epoch': 24, 'HR@5': '0.0930', 'NDCG@5': '0.0675', 'HR@10': '0.1244', 'NDCG@10': '0.0776', 'HR@20': '0.1645', 'NDCG@20': '0.0877'}
2025-02-22 10:13:37,865 - Validation score increased.  Saving model ...
2025-02-22 10:14:28,843 - {'epoch': 25, 'rec_loss': '6.7828'}
2025-02-22 10:14:38,508 - {'Epoch': 25, 'HR@5': '0.0923', 'NDCG@5': '0.0670', 'HR@10': '0.1235', 'NDCG@10': '0.0771', 'HR@20': '0.1618', 'NDCG@20': '0.0867'}
2025-02-22 10:14:38,515 - EarlyStopping counter: 1 out of 10
2025-02-22 10:15:29,885 - {'epoch': 26, 'rec_loss': '6.7667'}
2025-02-22 10:15:39,567 - {'Epoch': 26, 'HR@5': '0.0931', 'NDCG@5': '0.0671', 'HR@10': '0.1249', 'NDCG@10': '0.0773', 'HR@20': '0.1642', 'NDCG@20': '0.0873'}
2025-02-22 10:15:39,573 - EarlyStopping counter: 2 out of 10
2025-02-22 10:16:29,837 - {'epoch': 27, 'rec_loss': '6.7558'}
2025-02-22 10:16:39,196 - {'Epoch': 27, 'HR@5': '0.0915', 'NDCG@5': '0.0666', 'HR@10': '0.1252', 'NDCG@10': '0.0775', 'HR@20': '0.1645', 'NDCG@20': '0.0873'}
2025-02-22 10:16:39,203 - EarlyStopping counter: 3 out of 10
2025-02-22 10:17:29,210 - {'epoch': 28, 'rec_loss': '6.7546'}
2025-02-22 10:17:38,948 - {'Epoch': 28, 'HR@5': '0.0936', 'NDCG@5': '0.0674', 'HR@10': '0.1258', 'NDCG@10': '0.0777', 'HR@20': '0.1658', 'NDCG@20': '0.0878'}
2025-02-22 10:17:38,955 - Validation score increased.  Saving model ...
2025-02-22 10:18:29,662 - {'epoch': 29, 'rec_loss': '6.7334'}
2025-02-22 10:18:38,494 - {'Epoch': 29, 'HR@5': '0.0916', 'NDCG@5': '0.0670', 'HR@10': '0.1256', 'NDCG@10': '0.0779', 'HR@20': '0.1657', 'NDCG@20': '0.0880'}
2025-02-22 10:18:38,501 - Validation score increased.  Saving model ...
2025-02-22 10:19:27,724 - {'epoch': 30, 'rec_loss': '6.7266'}
2025-02-22 10:19:37,376 - {'Epoch': 30, 'HR@5': '0.0929', 'NDCG@5': '0.0677', 'HR@10': '0.1254', 'NDCG@10': '0.0781', 'HR@20': '0.1648', 'NDCG@20': '0.0880'}
2025-02-22 10:19:37,383 - Validation score increased.  Saving model ...
2025-02-22 10:20:29,537 - {'epoch': 31, 'rec_loss': '6.7168'}
2025-02-22 10:20:38,320 - {'Epoch': 31, 'HR@5': '0.0909', 'NDCG@5': '0.0664', 'HR@10': '0.1254', 'NDCG@10': '0.0775', 'HR@20': '0.1665', 'NDCG@20': '0.0878'}
2025-02-22 10:20:38,326 - EarlyStopping counter: 1 out of 10
2025-02-22 10:21:27,800 - {'epoch': 32, 'rec_loss': '6.7015'}
2025-02-22 10:21:36,339 - {'Epoch': 32, 'HR@5': '0.0915', 'NDCG@5': '0.0671', 'HR@10': '0.1252', 'NDCG@10': '0.0779', 'HR@20': '0.1660', 'NDCG@20': '0.0882'}
2025-02-22 10:21:36,346 - Validation score increased.  Saving model ...
2025-02-22 10:22:30,315 - {'epoch': 33, 'rec_loss': '6.6975'}
2025-02-22 10:22:39,992 - {'Epoch': 33, 'HR@5': '0.0937', 'NDCG@5': '0.0683', 'HR@10': '0.1255', 'NDCG@10': '0.0785', 'HR@20': '0.1653', 'NDCG@20': '0.0885'}
2025-02-22 10:22:39,999 - Validation score increased.  Saving model ...
2025-02-22 10:23:36,057 - {'epoch': 34, 'rec_loss': '6.6837'}
2025-02-22 10:23:44,352 - {'Epoch': 34, 'HR@5': '0.0924', 'NDCG@5': '0.0673', 'HR@10': '0.1258', 'NDCG@10': '0.0780', 'HR@20': '0.1660', 'NDCG@20': '0.0881'}
2025-02-22 10:23:44,358 - EarlyStopping counter: 1 out of 10
2025-02-22 10:24:36,116 - {'epoch': 35, 'rec_loss': '6.6761'}
2025-02-22 10:24:45,883 - {'Epoch': 35, 'HR@5': '0.0925', 'NDCG@5': '0.0676', 'HR@10': '0.1237', 'NDCG@10': '0.0776', 'HR@20': '0.1643', 'NDCG@20': '0.0879'}
2025-02-22 10:24:45,890 - EarlyStopping counter: 2 out of 10
2025-02-22 10:25:34,800 - {'epoch': 36, 'rec_loss': '6.6691'}
2025-02-22 10:25:43,102 - {'Epoch': 36, 'HR@5': '0.0919', 'NDCG@5': '0.0678', 'HR@10': '0.1247', 'NDCG@10': '0.0783', 'HR@20': '0.1659', 'NDCG@20': '0.0886'}
2025-02-22 10:25:43,109 - Validation score increased.  Saving model ...
2025-02-22 10:26:33,191 - {'epoch': 37, 'rec_loss': '6.6589'}
2025-02-22 10:26:41,952 - {'Epoch': 37, 'HR@5': '0.0920', 'NDCG@5': '0.0676', 'HR@10': '0.1240', 'NDCG@10': '0.0779', 'HR@20': '0.1638', 'NDCG@20': '0.0879'}
2025-02-22 10:26:41,959 - EarlyStopping counter: 1 out of 10
2025-02-22 10:27:31,884 - {'epoch': 38, 'rec_loss': '6.6555'}
2025-02-22 10:27:41,515 - {'Epoch': 38, 'HR@5': '0.0923', 'NDCG@5': '0.0672', 'HR@10': '0.1253', 'NDCG@10': '0.0778', 'HR@20': '0.1660', 'NDCG@20': '0.0881'}
2025-02-22 10:27:41,522 - EarlyStopping counter: 2 out of 10
2025-02-22 10:28:32,020 - {'epoch': 39, 'rec_loss': '6.6401'}
2025-02-22 10:28:41,584 - {'Epoch': 39, 'HR@5': '0.0916', 'NDCG@5': '0.0664', 'HR@10': '0.1244', 'NDCG@10': '0.0769', 'HR@20': '0.1651', 'NDCG@20': '0.0872'}
2025-02-22 10:28:41,591 - EarlyStopping counter: 3 out of 10
2025-02-22 10:29:32,735 - {'epoch': 40, 'rec_loss': '6.6402'}
2025-02-22 10:29:41,728 - {'Epoch': 40, 'HR@5': '0.0920', 'NDCG@5': '0.0664', 'HR@10': '0.1237', 'NDCG@10': '0.0766', 'HR@20': '0.1632', 'NDCG@20': '0.0866'}
2025-02-22 10:29:41,735 - EarlyStopping counter: 4 out of 10
2025-02-22 10:30:31,987 - {'epoch': 41, 'rec_loss': '6.6307'}
2025-02-22 10:30:40,196 - {'Epoch': 41, 'HR@5': '0.0920', 'NDCG@5': '0.0663', 'HR@10': '0.1246', 'NDCG@10': '0.0767', 'HR@20': '0.1642', 'NDCG@20': '0.0867'}
2025-02-22 10:30:40,203 - EarlyStopping counter: 5 out of 10
2025-02-22 10:31:31,028 - {'epoch': 42, 'rec_loss': '6.6256'}
2025-02-22 10:31:40,439 - {'Epoch': 42, 'HR@5': '0.0918', 'NDCG@5': '0.0659', 'HR@10': '0.1239', 'NDCG@10': '0.0762', 'HR@20': '0.1649', 'NDCG@20': '0.0865'}
2025-02-22 10:31:40,446 - EarlyStopping counter: 6 out of 10
2025-02-22 10:32:30,041 - {'epoch': 43, 'rec_loss': '6.6147'}
2025-02-22 10:32:39,760 - {'Epoch': 43, 'HR@5': '0.0925', 'NDCG@5': '0.0668', 'HR@10': '0.1234', 'NDCG@10': '0.0768', 'HR@20': '0.1639', 'NDCG@20': '0.0870'}
2025-02-22 10:32:39,767 - EarlyStopping counter: 7 out of 10
2025-02-22 10:33:33,992 - {'epoch': 44, 'rec_loss': '6.6139'}
2025-02-22 10:33:42,806 - {'Epoch': 44, 'HR@5': '0.0907', 'NDCG@5': '0.0665', 'HR@10': '0.1249', 'NDCG@10': '0.0775', 'HR@20': '0.1643', 'NDCG@20': '0.0875'}
2025-02-22 10:33:42,813 - EarlyStopping counter: 8 out of 10
2025-02-22 10:34:33,492 - {'epoch': 45, 'rec_loss': '6.6019'}
2025-02-22 10:34:42,974 - {'Epoch': 45, 'HR@5': '0.0926', 'NDCG@5': '0.0677', 'HR@10': '0.1232', 'NDCG@10': '0.0775', 'HR@20': '0.1635', 'NDCG@20': '0.0877'}
2025-02-22 10:34:42,981 - EarlyStopping counter: 9 out of 10
2025-02-22 10:35:33,847 - {'epoch': 46, 'rec_loss': '6.5906'}
2025-02-22 10:35:42,047 - {'Epoch': 46, 'HR@5': '0.0910', 'NDCG@5': '0.0662', 'HR@10': '0.1214', 'NDCG@10': '0.0760', 'HR@20': '0.1621', 'NDCG@20': '0.0862'}
2025-02-22 10:35:42,054 - EarlyStopping counter: 10 out of 10
2025-02-22 10:35:42,054 - Early stopping
2025-02-22 10:35:42,054 - ---------------Test Score---------------
2025-02-22 10:35:51,446 - {'Epoch': 0, 'HR@5': '0.0777', 'NDCG@5': '0.0565', 'HR@10': '0.1046', 'NDCG@10': '0.0652', 'HR@20': '0.1416', 'NDCG@20': '0.0745'}
2025-02-22 10:35:51,452 - Scale_Toys
2025-02-22 10:35:51,452 - {'Epoch': 0, 'HR@5': '0.0777', 'NDCG@5': '0.0565', 'HR@10': '0.1046', 'NDCG@10': '0.0652', 'HR@20': '0.1416', 'NDCG@20': '0.0745'}
2025-02-22 10:37:43,390 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 10, 5], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-02-22 10:37:52,775 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-22 10:37:52,910 - Total Parameters: 916817
2025-02-22 10:38:38,680 - {'epoch': 0, 'rec_loss': '9.0891'}
2025-02-22 10:38:47,951 - {'Epoch': 0, 'HR@5': '0.0060', 'NDCG@5': '0.0039', 'HR@10': '0.0108', 'NDCG@10': '0.0054', 'HR@20': '0.0184', 'NDCG@20': '0.0073'}
2025-02-22 10:38:47,955 - Validation score increased.  Saving model ...
2025-02-22 10:39:29,553 - {'epoch': 1, 'rec_loss': '8.6319'}
2025-02-22 10:39:38,506 - {'Epoch': 1, 'HR@5': '0.0235', 'NDCG@5': '0.0166', 'HR@10': '0.0343', 'NDCG@10': '0.0200', 'HR@20': '0.0511', 'NDCG@20': '0.0242'}
2025-02-22 10:39:38,511 - Validation score increased.  Saving model ...
2025-02-22 10:40:23,617 - {'epoch': 2, 'rec_loss': '8.2784'}
2025-02-22 10:40:32,561 - {'Epoch': 2, 'HR@5': '0.0445', 'NDCG@5': '0.0319', 'HR@10': '0.0647', 'NDCG@10': '0.0384', 'HR@20': '0.0905', 'NDCG@20': '0.0449'}
2025-02-22 10:40:32,567 - Validation score increased.  Saving model ...
2025-02-22 10:41:18,690 - {'epoch': 3, 'rec_loss': '7.9587'}
2025-02-22 10:41:28,175 - {'Epoch': 3, 'HR@5': '0.0599', 'NDCG@5': '0.0428', 'HR@10': '0.0832', 'NDCG@10': '0.0503', 'HR@20': '0.1118', 'NDCG@20': '0.0575'}
2025-02-22 10:41:28,181 - Validation score increased.  Saving model ...
2025-02-22 10:42:11,407 - {'epoch': 4, 'rec_loss': '7.7357'}
2025-02-22 10:42:20,514 - {'Epoch': 4, 'HR@5': '0.0709', 'NDCG@5': '0.0513', 'HR@10': '0.0977', 'NDCG@10': '0.0600', 'HR@20': '0.1285', 'NDCG@20': '0.0677'}
2025-02-22 10:42:20,523 - Validation score increased.  Saving model ...
2025-02-22 10:43:05,250 - {'epoch': 5, 'rec_loss': '7.5646'}
2025-02-22 10:43:14,499 - {'Epoch': 5, 'HR@5': '0.0774', 'NDCG@5': '0.0566', 'HR@10': '0.1058', 'NDCG@10': '0.0657', 'HR@20': '0.1397', 'NDCG@20': '0.0742'}
2025-02-22 10:43:14,505 - Validation score increased.  Saving model ...
2025-02-22 10:43:59,234 - {'epoch': 6, 'rec_loss': '7.4596'}
2025-02-22 10:44:08,409 - {'Epoch': 6, 'HR@5': '0.0812', 'NDCG@5': '0.0593', 'HR@10': '0.1090', 'NDCG@10': '0.0682', 'HR@20': '0.1443', 'NDCG@20': '0.0772'}
2025-02-22 10:44:08,416 - Validation score increased.  Saving model ...
2025-02-22 10:44:50,934 - {'epoch': 7, 'rec_loss': '7.3638'}
2025-02-22 10:45:00,199 - {'Epoch': 7, 'HR@5': '0.0838', 'NDCG@5': '0.0607', 'HR@10': '0.1129', 'NDCG@10': '0.0700', 'HR@20': '0.1489', 'NDCG@20': '0.0792'}
2025-02-22 10:45:00,206 - Validation score increased.  Saving model ...
2025-02-22 10:45:43,093 - {'epoch': 8, 'rec_loss': '7.2927'}
2025-02-22 10:45:50,972 - {'Epoch': 8, 'HR@5': '0.0864', 'NDCG@5': '0.0624', 'HR@10': '0.1164', 'NDCG@10': '0.0721', 'HR@20': '0.1523', 'NDCG@20': '0.0811'}
2025-02-22 10:45:50,978 - Validation score increased.  Saving model ...
2025-02-22 10:46:34,200 - {'epoch': 9, 'rec_loss': '7.2321'}
2025-02-22 10:46:43,128 - {'Epoch': 9, 'HR@5': '0.0876', 'NDCG@5': '0.0631', 'HR@10': '0.1182', 'NDCG@10': '0.0729', 'HR@20': '0.1547', 'NDCG@20': '0.0821'}
2025-02-22 10:46:43,135 - Validation score increased.  Saving model ...
2025-02-22 10:47:24,672 - {'epoch': 10, 'rec_loss': '7.1807'}
2025-02-22 10:47:32,887 - {'Epoch': 10, 'HR@5': '0.0885', 'NDCG@5': '0.0636', 'HR@10': '0.1180', 'NDCG@10': '0.0732', 'HR@20': '0.1552', 'NDCG@20': '0.0826'}
2025-02-22 10:47:32,894 - Validation score increased.  Saving model ...
2025-02-22 10:48:16,105 - {'epoch': 11, 'rec_loss': '7.1443'}
2025-02-22 10:48:24,290 - {'Epoch': 11, 'HR@5': '0.0894', 'NDCG@5': '0.0652', 'HR@10': '0.1192', 'NDCG@10': '0.0748', 'HR@20': '0.1578', 'NDCG@20': '0.0846'}
2025-02-22 10:48:24,298 - Validation score increased.  Saving model ...
2025-02-22 10:49:07,850 - {'epoch': 12, 'rec_loss': '7.1040'}
2025-02-22 10:49:17,350 - {'Epoch': 12, 'HR@5': '0.0909', 'NDCG@5': '0.0653', 'HR@10': '0.1203', 'NDCG@10': '0.0748', 'HR@20': '0.1590', 'NDCG@20': '0.0845'}
2025-02-22 10:49:17,358 - EarlyStopping counter: 1 out of 10
2025-02-22 10:50:00,511 - {'epoch': 13, 'rec_loss': '7.0785'}
2025-02-22 10:50:09,333 - {'Epoch': 13, 'HR@5': '0.0927', 'NDCG@5': '0.0664', 'HR@10': '0.1220', 'NDCG@10': '0.0758', 'HR@20': '0.1614', 'NDCG@20': '0.0857'}
2025-02-22 10:50:09,339 - Validation score increased.  Saving model ...
2025-02-22 10:50:52,676 - {'epoch': 14, 'rec_loss': '7.0454'}
2025-02-22 10:51:01,677 - {'Epoch': 14, 'HR@5': '0.0914', 'NDCG@5': '0.0660', 'HR@10': '0.1215', 'NDCG@10': '0.0757', 'HR@20': '0.1613', 'NDCG@20': '0.0858'}
2025-02-22 10:51:01,684 - Validation score increased.  Saving model ...
2025-02-22 10:51:44,353 - {'epoch': 15, 'rec_loss': '7.0245'}
2025-02-22 10:51:52,315 - {'Epoch': 15, 'HR@5': '0.0906', 'NDCG@5': '0.0659', 'HR@10': '0.1230', 'NDCG@10': '0.0763', 'HR@20': '0.1613', 'NDCG@20': '0.0860'}
2025-02-22 10:51:52,321 - Validation score increased.  Saving model ...
2025-02-22 10:52:37,576 - {'epoch': 16, 'rec_loss': '7.0019'}
2025-02-22 10:52:45,623 - {'Epoch': 16, 'HR@5': '0.0914', 'NDCG@5': '0.0658', 'HR@10': '0.1230', 'NDCG@10': '0.0760', 'HR@20': '0.1613', 'NDCG@20': '0.0856'}
2025-02-22 10:52:45,630 - EarlyStopping counter: 1 out of 10
2025-02-22 10:53:29,702 - {'epoch': 17, 'rec_loss': '6.9723'}
2025-02-22 10:53:39,109 - {'Epoch': 17, 'HR@5': '0.0933', 'NDCG@5': '0.0662', 'HR@10': '0.1243', 'NDCG@10': '0.0762', 'HR@20': '0.1626', 'NDCG@20': '0.0859'}
2025-02-22 10:53:39,116 - EarlyStopping counter: 2 out of 10
2025-02-22 10:54:25,487 - {'epoch': 18, 'rec_loss': '6.9612'}
2025-02-22 10:54:34,450 - {'Epoch': 18, 'HR@5': '0.0912', 'NDCG@5': '0.0659', 'HR@10': '0.1247', 'NDCG@10': '0.0767', 'HR@20': '0.1638', 'NDCG@20': '0.0865'}
2025-02-22 10:54:34,458 - Validation score increased.  Saving model ...
2025-02-22 10:55:17,151 - {'epoch': 19, 'rec_loss': '6.9437'}
2025-02-22 10:55:25,622 - {'Epoch': 19, 'HR@5': '0.0923', 'NDCG@5': '0.0667', 'HR@10': '0.1241', 'NDCG@10': '0.0769', 'HR@20': '0.1625', 'NDCG@20': '0.0866'}
2025-02-22 10:55:25,629 - Validation score increased.  Saving model ...
2025-02-22 10:56:09,531 - {'epoch': 20, 'rec_loss': '6.9292'}
2025-02-22 10:56:18,678 - {'Epoch': 20, 'HR@5': '0.0925', 'NDCG@5': '0.0671', 'HR@10': '0.1239', 'NDCG@10': '0.0773', 'HR@20': '0.1625', 'NDCG@20': '0.0870'}
2025-02-22 10:56:18,685 - Validation score increased.  Saving model ...
2025-02-22 10:57:00,848 - {'epoch': 21, 'rec_loss': '6.9108'}
2025-02-22 10:57:10,292 - {'Epoch': 21, 'HR@5': '0.0939', 'NDCG@5': '0.0673', 'HR@10': '0.1251', 'NDCG@10': '0.0774', 'HR@20': '0.1638', 'NDCG@20': '0.0871'}
2025-02-22 10:57:10,299 - Validation score increased.  Saving model ...
2025-02-22 10:57:51,807 - {'epoch': 22, 'rec_loss': '6.8975'}
2025-02-22 10:57:59,885 - {'Epoch': 22, 'HR@5': '0.0927', 'NDCG@5': '0.0659', 'HR@10': '0.1233', 'NDCG@10': '0.0757', 'HR@20': '0.1627', 'NDCG@20': '0.0856'}
2025-02-22 10:57:59,891 - EarlyStopping counter: 1 out of 10
2025-02-22 10:58:42,778 - {'epoch': 23, 'rec_loss': '6.8780'}
2025-02-22 10:58:52,103 - {'Epoch': 23, 'HR@5': '0.0940', 'NDCG@5': '0.0673', 'HR@10': '0.1264', 'NDCG@10': '0.0777', 'HR@20': '0.1655', 'NDCG@20': '0.0876'}
2025-02-22 10:58:52,110 - Validation score increased.  Saving model ...
2025-02-22 10:59:35,466 - {'epoch': 24, 'rec_loss': '6.8715'}
2025-02-22 10:59:44,501 - {'Epoch': 24, 'HR@5': '0.0938', 'NDCG@5': '0.0667', 'HR@10': '0.1257', 'NDCG@10': '0.0769', 'HR@20': '0.1646', 'NDCG@20': '0.0867'}
2025-02-22 10:59:44,508 - EarlyStopping counter: 1 out of 10
2025-02-22 11:00:27,919 - {'epoch': 25, 'rec_loss': '6.8543'}
2025-02-22 11:00:36,989 - {'Epoch': 25, 'HR@5': '0.0952', 'NDCG@5': '0.0677', 'HR@10': '0.1253', 'NDCG@10': '0.0774', 'HR@20': '0.1642', 'NDCG@20': '0.0872'}
2025-02-22 11:00:36,997 - EarlyStopping counter: 2 out of 10
2025-02-22 11:01:20,479 - {'epoch': 26, 'rec_loss': '6.8382'}
2025-02-22 11:01:29,946 - {'Epoch': 26, 'HR@5': '0.0931', 'NDCG@5': '0.0671', 'HR@10': '0.1248', 'NDCG@10': '0.0772', 'HR@20': '0.1647', 'NDCG@20': '0.0873'}
2025-02-22 11:01:29,952 - EarlyStopping counter: 3 out of 10
2025-02-22 11:02:12,189 - {'epoch': 27, 'rec_loss': '6.8316'}
2025-02-22 11:02:21,654 - {'Epoch': 27, 'HR@5': '0.0945', 'NDCG@5': '0.0680', 'HR@10': '0.1255', 'NDCG@10': '0.0780', 'HR@20': '0.1632', 'NDCG@20': '0.0875'}
2025-02-22 11:02:21,661 - EarlyStopping counter: 4 out of 10
2025-02-22 11:03:04,680 - {'epoch': 28, 'rec_loss': '6.8159'}
2025-02-22 11:03:13,682 - {'Epoch': 28, 'HR@5': '0.0934', 'NDCG@5': '0.0664', 'HR@10': '0.1246', 'NDCG@10': '0.0764', 'HR@20': '0.1642', 'NDCG@20': '0.0864'}
2025-02-22 11:03:13,689 - EarlyStopping counter: 5 out of 10
2025-02-22 11:04:00,633 - {'epoch': 29, 'rec_loss': '6.8149'}
2025-02-22 11:04:08,828 - {'Epoch': 29, 'HR@5': '0.0931', 'NDCG@5': '0.0669', 'HR@10': '0.1252', 'NDCG@10': '0.0772', 'HR@20': '0.1652', 'NDCG@20': '0.0872'}
2025-02-22 11:04:08,835 - EarlyStopping counter: 6 out of 10
2025-02-22 11:04:53,756 - {'epoch': 30, 'rec_loss': '6.7922'}
2025-02-22 11:05:02,988 - {'Epoch': 30, 'HR@5': '0.0930', 'NDCG@5': '0.0667', 'HR@10': '0.1254', 'NDCG@10': '0.0771', 'HR@20': '0.1649', 'NDCG@20': '0.0871'}
2025-02-22 11:05:02,994 - EarlyStopping counter: 7 out of 10
2025-02-22 11:05:45,628 - {'epoch': 31, 'rec_loss': '6.7917'}
2025-02-22 11:05:54,993 - {'Epoch': 31, 'HR@5': '0.0929', 'NDCG@5': '0.0676', 'HR@10': '0.1254', 'NDCG@10': '0.0781', 'HR@20': '0.1656', 'NDCG@20': '0.0883'}
2025-02-22 11:05:55,000 - Validation score increased.  Saving model ...
2025-02-22 11:06:37,211 - {'epoch': 32, 'rec_loss': '6.7801'}
2025-02-22 11:06:46,601 - {'Epoch': 32, 'HR@5': '0.0936', 'NDCG@5': '0.0682', 'HR@10': '0.1254', 'NDCG@10': '0.0784', 'HR@20': '0.1666', 'NDCG@20': '0.0888'}
2025-02-22 11:06:46,609 - Validation score increased.  Saving model ...
2025-02-22 11:07:28,888 - {'epoch': 33, 'rec_loss': '6.7647'}
2025-02-22 11:07:37,149 - {'Epoch': 33, 'HR@5': '0.0945', 'NDCG@5': '0.0683', 'HR@10': '0.1257', 'NDCG@10': '0.0784', 'HR@20': '0.1648', 'NDCG@20': '0.0882'}
2025-02-22 11:07:37,156 - EarlyStopping counter: 1 out of 10
2025-02-22 11:08:19,492 - {'epoch': 34, 'rec_loss': '6.7554'}
2025-02-22 11:08:27,536 - {'Epoch': 34, 'HR@5': '0.0943', 'NDCG@5': '0.0682', 'HR@10': '0.1254', 'NDCG@10': '0.0782', 'HR@20': '0.1662', 'NDCG@20': '0.0885'}
2025-02-22 11:08:27,541 - EarlyStopping counter: 2 out of 10
2025-02-22 11:09:09,618 - {'epoch': 35, 'rec_loss': '6.7469'}
2025-02-22 11:09:19,092 - {'Epoch': 35, 'HR@5': '0.0928', 'NDCG@5': '0.0664', 'HR@10': '0.1262', 'NDCG@10': '0.0770', 'HR@20': '0.1675', 'NDCG@20': '0.0874'}
2025-02-22 11:09:19,100 - EarlyStopping counter: 3 out of 10
2025-02-22 11:10:01,393 - {'epoch': 36, 'rec_loss': '6.7394'}
2025-02-22 11:10:09,581 - {'Epoch': 36, 'HR@5': '0.0934', 'NDCG@5': '0.0669', 'HR@10': '0.1270', 'NDCG@10': '0.0777', 'HR@20': '0.1661', 'NDCG@20': '0.0875'}
2025-02-22 11:10:09,587 - EarlyStopping counter: 4 out of 10
2025-02-22 11:10:52,286 - {'epoch': 37, 'rec_loss': '6.7211'}
2025-02-22 11:11:00,850 - {'Epoch': 37, 'HR@5': '0.0928', 'NDCG@5': '0.0666', 'HR@10': '0.1254', 'NDCG@10': '0.0771', 'HR@20': '0.1643', 'NDCG@20': '0.0869'}
2025-02-22 11:11:00,858 - EarlyStopping counter: 5 out of 10
2025-02-22 11:11:43,502 - {'epoch': 38, 'rec_loss': '6.7255'}
2025-02-22 11:11:51,794 - {'Epoch': 38, 'HR@5': '0.0917', 'NDCG@5': '0.0663', 'HR@10': '0.1258', 'NDCG@10': '0.0772', 'HR@20': '0.1654', 'NDCG@20': '0.0872'}
2025-02-22 11:11:51,803 - EarlyStopping counter: 6 out of 10
2025-02-22 11:12:35,479 - {'epoch': 39, 'rec_loss': '6.7196'}
2025-02-22 11:12:44,010 - {'Epoch': 39, 'HR@5': '0.0932', 'NDCG@5': '0.0667', 'HR@10': '0.1262', 'NDCG@10': '0.0774', 'HR@20': '0.1648', 'NDCG@20': '0.0872'}
2025-02-22 11:12:44,018 - EarlyStopping counter: 7 out of 10
2025-02-22 11:13:27,243 - {'epoch': 40, 'rec_loss': '6.7098'}
2025-02-22 11:13:36,350 - {'Epoch': 40, 'HR@5': '0.0915', 'NDCG@5': '0.0656', 'HR@10': '0.1254', 'NDCG@10': '0.0765', 'HR@20': '0.1651', 'NDCG@20': '0.0865'}
2025-02-22 11:13:36,359 - EarlyStopping counter: 8 out of 10
2025-02-22 11:14:15,753 - {'epoch': 41, 'rec_loss': '6.7037'}
2025-02-22 11:14:24,564 - {'Epoch': 41, 'HR@5': '0.0928', 'NDCG@5': '0.0669', 'HR@10': '0.1272', 'NDCG@10': '0.0780', 'HR@20': '0.1668', 'NDCG@20': '0.0880'}
2025-02-22 11:14:24,571 - EarlyStopping counter: 9 out of 10
2025-02-22 11:15:09,572 - {'epoch': 42, 'rec_loss': '6.6937'}
2025-02-22 11:15:18,832 - {'Epoch': 42, 'HR@5': '0.0932', 'NDCG@5': '0.0675', 'HR@10': '0.1256', 'NDCG@10': '0.0779', 'HR@20': '0.1661', 'NDCG@20': '0.0881'}
2025-02-22 11:15:18,838 - EarlyStopping counter: 10 out of 10
2025-02-22 11:15:18,839 - Early stopping
2025-02-22 11:15:18,839 - ---------------Test Score---------------
2025-02-22 11:15:27,661 - {'Epoch': 0, 'HR@5': '0.0779', 'NDCG@5': '0.0565', 'HR@10': '0.1072', 'NDCG@10': '0.0659', 'HR@20': '0.1403', 'NDCG@20': '0.0742'}
2025-02-22 11:15:27,666 - Scale_Toys
2025-02-22 11:15:27,666 - {'Epoch': 0, 'HR@5': '0.0779', 'NDCG@5': '0.0565', 'HR@10': '0.1072', 'NDCG@10': '0.0659', 'HR@20': '0.1403', 'NDCG@20': '0.0742'}
2025-02-22 11:30:14,817 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 10], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-02-22 11:30:24,264 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-22 11:30:24,400 - Total Parameters: 917142
2025-02-22 11:31:00,884 - {'epoch': 0, 'rec_loss': '9.0927'}
2025-02-22 11:31:09,394 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0052', 'HR@10': '0.0125', 'NDCG@10': '0.0066', 'HR@20': '0.0203', 'NDCG@20': '0.0085'}
2025-02-22 11:31:09,395 - Validation score increased.  Saving model ...
2025-02-22 11:31:44,966 - {'epoch': 1, 'rec_loss': '8.7009'}
2025-02-22 11:31:53,685 - {'Epoch': 1, 'HR@5': '0.0165', 'NDCG@5': '0.0118', 'HR@10': '0.0257', 'NDCG@10': '0.0147', 'HR@20': '0.0399', 'NDCG@20': '0.0183'}
2025-02-22 11:31:53,692 - Validation score increased.  Saving model ...
2025-02-22 11:32:28,408 - {'epoch': 2, 'rec_loss': '8.3986'}
2025-02-22 11:32:36,878 - {'Epoch': 2, 'HR@5': '0.0355', 'NDCG@5': '0.0248', 'HR@10': '0.0505', 'NDCG@10': '0.0297', 'HR@20': '0.0737', 'NDCG@20': '0.0355'}
2025-02-22 11:32:36,885 - Validation score increased.  Saving model ...
2025-02-22 11:33:10,947 - {'epoch': 3, 'rec_loss': '8.1256'}
2025-02-22 11:33:19,744 - {'Epoch': 3, 'HR@5': '0.0495', 'NDCG@5': '0.0357', 'HR@10': '0.0691', 'NDCG@10': '0.0420', 'HR@20': '0.0973', 'NDCG@20': '0.0491'}
2025-02-22 11:33:19,751 - Validation score increased.  Saving model ...
2025-02-22 11:33:53,834 - {'epoch': 4, 'rec_loss': '7.9028'}
2025-02-22 11:34:02,236 - {'Epoch': 4, 'HR@5': '0.0608', 'NDCG@5': '0.0430', 'HR@10': '0.0837', 'NDCG@10': '0.0504', 'HR@20': '0.1140', 'NDCG@20': '0.0580'}
2025-02-22 11:34:02,246 - Validation score increased.  Saving model ...
2025-02-22 11:34:33,118 - {'epoch': 5, 'rec_loss': '7.7367'}
2025-02-22 11:34:41,552 - {'Epoch': 5, 'HR@5': '0.0683', 'NDCG@5': '0.0495', 'HR@10': '0.0952', 'NDCG@10': '0.0582', 'HR@20': '0.1273', 'NDCG@20': '0.0663'}
2025-02-22 11:34:41,557 - Validation score increased.  Saving model ...
2025-02-22 11:35:18,980 - {'epoch': 6, 'rec_loss': '7.6105'}
2025-02-22 11:35:27,976 - {'Epoch': 6, 'HR@5': '0.0749', 'NDCG@5': '0.0539', 'HR@10': '0.1022', 'NDCG@10': '0.0627', 'HR@20': '0.1373', 'NDCG@20': '0.0716'}
2025-02-22 11:35:27,983 - Validation score increased.  Saving model ...
2025-02-22 11:36:04,006 - {'epoch': 7, 'rec_loss': '7.5078'}
2025-02-22 11:36:13,022 - {'Epoch': 7, 'HR@5': '0.0791', 'NDCG@5': '0.0564', 'HR@10': '0.1064', 'NDCG@10': '0.0653', 'HR@20': '0.1421', 'NDCG@20': '0.0742'}
2025-02-22 11:36:13,024 - Validation score increased.  Saving model ...
2025-02-22 11:36:45,966 - {'epoch': 8, 'rec_loss': '7.4297'}
2025-02-22 11:36:54,871 - {'Epoch': 8, 'HR@5': '0.0821', 'NDCG@5': '0.0596', 'HR@10': '0.1126', 'NDCG@10': '0.0695', 'HR@20': '0.1490', 'NDCG@20': '0.0787'}
2025-02-22 11:36:54,880 - Validation score increased.  Saving model ...
2025-02-22 11:37:29,822 - {'epoch': 9, 'rec_loss': '7.3632'}
2025-02-22 11:37:38,302 - {'Epoch': 9, 'HR@5': '0.0856', 'NDCG@5': '0.0615', 'HR@10': '0.1134', 'NDCG@10': '0.0705', 'HR@20': '0.1498', 'NDCG@20': '0.0797'}
2025-02-22 11:37:38,304 - Validation score increased.  Saving model ...
2025-02-22 11:38:13,341 - {'epoch': 10, 'rec_loss': '7.3138'}
2025-02-22 11:38:22,028 - {'Epoch': 10, 'HR@5': '0.0860', 'NDCG@5': '0.0617', 'HR@10': '0.1159', 'NDCG@10': '0.0713', 'HR@20': '0.1523', 'NDCG@20': '0.0805'}
2025-02-22 11:38:22,036 - Validation score increased.  Saving model ...
2025-02-22 11:38:55,519 - {'epoch': 11, 'rec_loss': '7.2728'}
2025-02-22 11:39:03,132 - {'Epoch': 11, 'HR@5': '0.0874', 'NDCG@5': '0.0625', 'HR@10': '0.1187', 'NDCG@10': '0.0725', 'HR@20': '0.1557', 'NDCG@20': '0.0818'}
2025-02-22 11:39:03,140 - Validation score increased.  Saving model ...
2025-02-22 11:39:36,128 - {'epoch': 12, 'rec_loss': '7.2288'}
2025-02-22 11:39:44,811 - {'Epoch': 12, 'HR@5': '0.0884', 'NDCG@5': '0.0635', 'HR@10': '0.1195', 'NDCG@10': '0.0736', 'HR@20': '0.1552', 'NDCG@20': '0.0825'}
2025-02-22 11:39:44,818 - Validation score increased.  Saving model ...
2025-02-22 11:40:17,914 - {'epoch': 13, 'rec_loss': '7.1990'}
2025-02-22 11:40:27,887 - {'Epoch': 13, 'HR@5': '0.0891', 'NDCG@5': '0.0646', 'HR@10': '0.1195', 'NDCG@10': '0.0744', 'HR@20': '0.1587', 'NDCG@20': '0.0843'}
2025-02-22 11:40:27,894 - Validation score increased.  Saving model ...
2025-02-22 11:41:01,518 - {'epoch': 14, 'rec_loss': '7.1705'}
2025-02-22 11:41:10,361 - {'Epoch': 14, 'HR@5': '0.0895', 'NDCG@5': '0.0643', 'HR@10': '0.1222', 'NDCG@10': '0.0748', 'HR@20': '0.1614', 'NDCG@20': '0.0847'}
2025-02-22 11:41:10,369 - Validation score increased.  Saving model ...
2025-02-22 11:41:44,387 - {'epoch': 15, 'rec_loss': '7.1403'}
2025-02-22 11:41:53,222 - {'Epoch': 15, 'HR@5': '0.0896', 'NDCG@5': '0.0650', 'HR@10': '0.1221', 'NDCG@10': '0.0754', 'HR@20': '0.1611', 'NDCG@20': '0.0852'}
2025-02-22 11:41:53,229 - Validation score increased.  Saving model ...
2025-02-22 11:42:26,757 - {'epoch': 16, 'rec_loss': '7.1199'}
2025-02-22 11:42:35,165 - {'Epoch': 16, 'HR@5': '0.0911', 'NDCG@5': '0.0658', 'HR@10': '0.1222', 'NDCG@10': '0.0758', 'HR@20': '0.1605', 'NDCG@20': '0.0854'}
2025-02-22 11:42:35,167 - Validation score increased.  Saving model ...
2025-02-22 11:43:11,221 - {'epoch': 17, 'rec_loss': '7.0913'}
2025-02-22 11:43:18,934 - {'Epoch': 17, 'HR@5': '0.0899', 'NDCG@5': '0.0649', 'HR@10': '0.1211', 'NDCG@10': '0.0749', 'HR@20': '0.1612', 'NDCG@20': '0.0850'}
2025-02-22 11:43:18,941 - EarlyStopping counter: 1 out of 10
2025-02-22 11:43:53,698 - {'epoch': 18, 'rec_loss': '7.0791'}
2025-02-22 11:44:02,445 - {'Epoch': 18, 'HR@5': '0.0901', 'NDCG@5': '0.0655', 'HR@10': '0.1234', 'NDCG@10': '0.0762', 'HR@20': '0.1621', 'NDCG@20': '0.0859'}
2025-02-22 11:44:02,451 - Validation score increased.  Saving model ...
2025-02-22 11:44:35,637 - {'epoch': 19, 'rec_loss': '7.0621'}
2025-02-22 11:44:44,299 - {'Epoch': 19, 'HR@5': '0.0900', 'NDCG@5': '0.0649', 'HR@10': '0.1223', 'NDCG@10': '0.0753', 'HR@20': '0.1638', 'NDCG@20': '0.0857'}
2025-02-22 11:44:44,306 - EarlyStopping counter: 1 out of 10
2025-02-22 11:45:10,637 - {'epoch': 20, 'rec_loss': '7.0434'}
2025-02-22 11:45:19,222 - {'Epoch': 20, 'HR@5': '0.0913', 'NDCG@5': '0.0662', 'HR@10': '0.1252', 'NDCG@10': '0.0771', 'HR@20': '0.1634', 'NDCG@20': '0.0868'}
2025-02-22 11:45:19,231 - Validation score increased.  Saving model ...
2025-02-22 11:45:56,929 - {'epoch': 21, 'rec_loss': '7.0260'}
2025-02-22 11:46:04,502 - {'Epoch': 21, 'HR@5': '0.0926', 'NDCG@5': '0.0673', 'HR@10': '0.1249', 'NDCG@10': '0.0777', 'HR@20': '0.1632', 'NDCG@20': '0.0874'}
2025-02-22 11:46:04,508 - Validation score increased.  Saving model ...
2025-02-22 11:46:40,394 - {'epoch': 22, 'rec_loss': '7.0059'}
2025-02-22 11:46:47,936 - {'Epoch': 22, 'HR@5': '0.0925', 'NDCG@5': '0.0667', 'HR@10': '0.1253', 'NDCG@10': '0.0772', 'HR@20': '0.1637', 'NDCG@20': '0.0869'}
2025-02-22 11:46:47,945 - EarlyStopping counter: 1 out of 10
2025-02-22 11:47:23,495 - {'epoch': 23, 'rec_loss': '6.9977'}
2025-02-22 11:47:32,399 - {'Epoch': 23, 'HR@5': '0.0933', 'NDCG@5': '0.0668', 'HR@10': '0.1262', 'NDCG@10': '0.0774', 'HR@20': '0.1648', 'NDCG@20': '0.0871'}
2025-02-22 11:47:32,407 - EarlyStopping counter: 2 out of 10
2025-02-22 11:48:06,590 - {'epoch': 24, 'rec_loss': '6.9794'}
2025-02-22 11:48:15,549 - {'Epoch': 24, 'HR@5': '0.0921', 'NDCG@5': '0.0676', 'HR@10': '0.1265', 'NDCG@10': '0.0787', 'HR@20': '0.1658', 'NDCG@20': '0.0886'}
2025-02-22 11:48:15,556 - Validation score increased.  Saving model ...
2025-02-22 11:48:48,699 - {'epoch': 25, 'rec_loss': '6.9645'}
2025-02-22 11:48:57,490 - {'Epoch': 25, 'HR@5': '0.0928', 'NDCG@5': '0.0674', 'HR@10': '0.1260', 'NDCG@10': '0.0781', 'HR@20': '0.1662', 'NDCG@20': '0.0883'}
2025-02-22 11:48:57,497 - EarlyStopping counter: 1 out of 10
2025-02-22 11:49:30,978 - {'epoch': 26, 'rec_loss': '6.9627'}
2025-02-22 11:49:39,978 - {'Epoch': 26, 'HR@5': '0.0925', 'NDCG@5': '0.0671', 'HR@10': '0.1249', 'NDCG@10': '0.0775', 'HR@20': '0.1645', 'NDCG@20': '0.0875'}
2025-02-22 11:49:39,985 - EarlyStopping counter: 2 out of 10
2025-02-22 11:50:14,465 - {'epoch': 27, 'rec_loss': '6.9507'}
2025-02-22 11:50:22,495 - {'Epoch': 27, 'HR@5': '0.0920', 'NDCG@5': '0.0667', 'HR@10': '0.1248', 'NDCG@10': '0.0773', 'HR@20': '0.1647', 'NDCG@20': '0.0873'}
2025-02-22 11:50:22,496 - EarlyStopping counter: 3 out of 10
2025-02-22 11:50:59,607 - {'epoch': 28, 'rec_loss': '6.9402'}
2025-02-22 11:51:08,262 - {'Epoch': 28, 'HR@5': '0.0938', 'NDCG@5': '0.0675', 'HR@10': '0.1252', 'NDCG@10': '0.0775', 'HR@20': '0.1644', 'NDCG@20': '0.0875'}
2025-02-22 11:51:08,268 - EarlyStopping counter: 4 out of 10
2025-02-22 11:51:41,660 - {'epoch': 29, 'rec_loss': '6.9191'}
2025-02-22 11:51:49,661 - {'Epoch': 29, 'HR@5': '0.0937', 'NDCG@5': '0.0678', 'HR@10': '0.1254', 'NDCG@10': '0.0781', 'HR@20': '0.1666', 'NDCG@20': '0.0885'}
2025-02-22 11:51:49,662 - EarlyStopping counter: 5 out of 10
2025-02-22 11:52:23,135 - {'epoch': 30, 'rec_loss': '6.9112'}
2025-02-22 11:52:32,003 - {'Epoch': 30, 'HR@5': '0.0917', 'NDCG@5': '0.0669', 'HR@10': '0.1256', 'NDCG@10': '0.0777', 'HR@20': '0.1668', 'NDCG@20': '0.0881'}
2025-02-22 11:52:32,011 - EarlyStopping counter: 6 out of 10
2025-02-22 11:53:05,296 - {'epoch': 31, 'rec_loss': '6.9036'}
2025-02-22 11:53:12,959 - {'Epoch': 31, 'HR@5': '0.0934', 'NDCG@5': '0.0676', 'HR@10': '0.1262', 'NDCG@10': '0.0781', 'HR@20': '0.1665', 'NDCG@20': '0.0883'}
2025-02-22 11:53:12,967 - EarlyStopping counter: 7 out of 10
2025-02-22 11:53:47,211 - {'epoch': 32, 'rec_loss': '6.9003'}
2025-02-22 11:53:56,195 - {'Epoch': 32, 'HR@5': '0.0923', 'NDCG@5': '0.0669', 'HR@10': '0.1253', 'NDCG@10': '0.0775', 'HR@20': '0.1672', 'NDCG@20': '0.0881'}
2025-02-22 11:53:56,205 - EarlyStopping counter: 8 out of 10
2025-02-22 11:54:29,621 - {'epoch': 33, 'rec_loss': '6.8877'}
2025-02-22 11:54:38,173 - {'Epoch': 33, 'HR@5': '0.0942', 'NDCG@5': '0.0681', 'HR@10': '0.1261', 'NDCG@10': '0.0784', 'HR@20': '0.1674', 'NDCG@20': '0.0888'}
2025-02-22 11:54:38,181 - Validation score increased.  Saving model ...
2025-02-22 11:55:11,936 - {'epoch': 34, 'rec_loss': '6.8835'}
2025-02-22 11:55:20,363 - {'Epoch': 34, 'HR@5': '0.0937', 'NDCG@5': '0.0671', 'HR@10': '0.1274', 'NDCG@10': '0.0780', 'HR@20': '0.1670', 'NDCG@20': '0.0879'}
2025-02-22 11:55:20,372 - EarlyStopping counter: 1 out of 10
2025-02-22 11:55:52,542 - {'epoch': 35, 'rec_loss': '6.8735'}
2025-02-22 11:56:00,444 - {'Epoch': 35, 'HR@5': '0.0937', 'NDCG@5': '0.0677', 'HR@10': '0.1267', 'NDCG@10': '0.0783', 'HR@20': '0.1655', 'NDCG@20': '0.0881'}
2025-02-22 11:56:00,453 - EarlyStopping counter: 2 out of 10
2025-02-22 11:56:36,745 - {'epoch': 36, 'rec_loss': '6.8709'}
2025-02-22 11:56:45,517 - {'Epoch': 36, 'HR@5': '0.0940', 'NDCG@5': '0.0679', 'HR@10': '0.1277', 'NDCG@10': '0.0788', 'HR@20': '0.1665', 'NDCG@20': '0.0886'}
2025-02-22 11:56:45,518 - EarlyStopping counter: 3 out of 10
2025-02-22 11:57:20,841 - {'epoch': 37, 'rec_loss': '6.8577'}
2025-02-22 11:57:29,488 - {'Epoch': 37, 'HR@5': '0.0943', 'NDCG@5': '0.0681', 'HR@10': '0.1270', 'NDCG@10': '0.0786', 'HR@20': '0.1672', 'NDCG@20': '0.0887'}
2025-02-22 11:57:29,497 - EarlyStopping counter: 4 out of 10
2025-02-22 11:58:03,873 - {'epoch': 38, 'rec_loss': '6.8523'}
2025-02-22 11:58:12,423 - {'Epoch': 38, 'HR@5': '0.0949', 'NDCG@5': '0.0685', 'HR@10': '0.1269', 'NDCG@10': '0.0788', 'HR@20': '0.1670', 'NDCG@20': '0.0889'}
2025-02-22 11:58:12,429 - Validation score increased.  Saving model ...
2025-02-22 11:58:47,799 - {'epoch': 39, 'rec_loss': '6.8470'}
2025-02-22 11:58:56,464 - {'Epoch': 39, 'HR@5': '0.0957', 'NDCG@5': '0.0689', 'HR@10': '0.1280', 'NDCG@10': '0.0793', 'HR@20': '0.1670', 'NDCG@20': '0.0891'}
2025-02-22 11:58:56,471 - Validation score increased.  Saving model ...
2025-02-22 11:59:32,299 - {'epoch': 40, 'rec_loss': '6.8347'}
2025-02-22 11:59:40,262 - {'Epoch': 40, 'HR@5': '0.0956', 'NDCG@5': '0.0691', 'HR@10': '0.1268', 'NDCG@10': '0.0791', 'HR@20': '0.1678', 'NDCG@20': '0.0894'}
2025-02-22 11:59:40,268 - Validation score increased.  Saving model ...
2025-02-22 12:00:13,907 - {'epoch': 41, 'rec_loss': '6.8381'}
2025-02-22 12:00:22,865 - {'Epoch': 41, 'HR@5': '0.0942', 'NDCG@5': '0.0676', 'HR@10': '0.1262', 'NDCG@10': '0.0780', 'HR@20': '0.1679', 'NDCG@20': '0.0886'}
2025-02-22 12:00:22,873 - EarlyStopping counter: 1 out of 10
2025-02-22 12:00:57,245 - {'epoch': 42, 'rec_loss': '6.8276'}
2025-02-22 12:01:05,049 - {'Epoch': 42, 'HR@5': '0.0957', 'NDCG@5': '0.0693', 'HR@10': '0.1277', 'NDCG@10': '0.0795', 'HR@20': '0.1675', 'NDCG@20': '0.0896'}
2025-02-22 12:01:05,054 - Validation score increased.  Saving model ...
2025-02-22 12:01:38,942 - {'epoch': 43, 'rec_loss': '6.8211'}
2025-02-22 12:01:47,899 - {'Epoch': 43, 'HR@5': '0.0941', 'NDCG@5': '0.0679', 'HR@10': '0.1289', 'NDCG@10': '0.0791', 'HR@20': '0.1669', 'NDCG@20': '0.0887'}
2025-02-22 12:01:47,905 - EarlyStopping counter: 1 out of 10
2025-02-22 12:02:22,981 - {'epoch': 44, 'rec_loss': '6.8200'}
2025-02-22 12:02:31,843 - {'Epoch': 44, 'HR@5': '0.0969', 'NDCG@5': '0.0699', 'HR@10': '0.1270', 'NDCG@10': '0.0796', 'HR@20': '0.1680', 'NDCG@20': '0.0900'}
2025-02-22 12:02:31,849 - Validation score increased.  Saving model ...
2025-02-22 12:03:07,151 - {'epoch': 45, 'rec_loss': '6.8102'}
2025-02-22 12:03:15,811 - {'Epoch': 45, 'HR@5': '0.0951', 'NDCG@5': '0.0688', 'HR@10': '0.1285', 'NDCG@10': '0.0795', 'HR@20': '0.1689', 'NDCG@20': '0.0897'}
2025-02-22 12:03:15,817 - EarlyStopping counter: 1 out of 10
2025-02-22 12:03:48,851 - {'epoch': 46, 'rec_loss': '6.8131'}
2025-02-22 12:03:57,929 - {'Epoch': 46, 'HR@5': '0.0956', 'NDCG@5': '0.0690', 'HR@10': '0.1286', 'NDCG@10': '0.0796', 'HR@20': '0.1686', 'NDCG@20': '0.0896'}
2025-02-22 12:03:57,930 - EarlyStopping counter: 2 out of 10
2025-02-22 12:04:31,144 - {'epoch': 47, 'rec_loss': '6.7990'}
2025-02-22 12:04:38,769 - {'Epoch': 47, 'HR@5': '0.0961', 'NDCG@5': '0.0696', 'HR@10': '0.1275', 'NDCG@10': '0.0797', 'HR@20': '0.1676', 'NDCG@20': '0.0897'}
2025-02-22 12:04:38,770 - EarlyStopping counter: 3 out of 10
2025-02-22 12:05:11,688 - {'epoch': 48, 'rec_loss': '6.7847'}
2025-02-22 12:05:20,607 - {'Epoch': 48, 'HR@5': '0.0954', 'NDCG@5': '0.0695', 'HR@10': '0.1280', 'NDCG@10': '0.0800', 'HR@20': '0.1671', 'NDCG@20': '0.0898'}
2025-02-22 12:05:20,614 - EarlyStopping counter: 4 out of 10
2025-02-22 12:05:52,688 - {'epoch': 49, 'rec_loss': '6.7842'}
2025-02-22 12:06:00,997 - {'Epoch': 49, 'HR@5': '0.0946', 'NDCG@5': '0.0685', 'HR@10': '0.1288', 'NDCG@10': '0.0795', 'HR@20': '0.1661', 'NDCG@20': '0.0889'}
2025-02-22 12:06:01,004 - EarlyStopping counter: 5 out of 10
2025-02-22 12:06:37,353 - {'epoch': 50, 'rec_loss': '6.7777'}
2025-02-22 12:06:46,255 - {'Epoch': 50, 'HR@5': '0.0956', 'NDCG@5': '0.0690', 'HR@10': '0.1287', 'NDCG@10': '0.0796', 'HR@20': '0.1664', 'NDCG@20': '0.0891'}
2025-02-22 12:06:46,264 - EarlyStopping counter: 6 out of 10
2025-02-22 12:07:23,383 - {'epoch': 51, 'rec_loss': '6.7832'}
2025-02-22 12:07:32,081 - {'Epoch': 51, 'HR@5': '0.0950', 'NDCG@5': '0.0686', 'HR@10': '0.1281', 'NDCG@10': '0.0792', 'HR@20': '0.1666', 'NDCG@20': '0.0889'}
2025-02-22 12:07:32,088 - EarlyStopping counter: 7 out of 10
2025-02-22 12:08:05,589 - {'epoch': 52, 'rec_loss': '6.7727'}
2025-02-22 12:08:14,331 - {'Epoch': 52, 'HR@5': '0.0934', 'NDCG@5': '0.0673', 'HR@10': '0.1272', 'NDCG@10': '0.0782', 'HR@20': '0.1677', 'NDCG@20': '0.0884'}
2025-02-22 12:08:14,338 - EarlyStopping counter: 8 out of 10
2025-02-22 12:08:50,617 - {'epoch': 53, 'rec_loss': '6.7683'}
2025-02-22 12:08:58,530 - {'Epoch': 53, 'HR@5': '0.0947', 'NDCG@5': '0.0687', 'HR@10': '0.1289', 'NDCG@10': '0.0797', 'HR@20': '0.1673', 'NDCG@20': '0.0894'}
2025-02-22 12:08:58,539 - EarlyStopping counter: 9 out of 10
2025-02-22 12:09:34,583 - {'epoch': 54, 'rec_loss': '6.7569'}
2025-02-22 12:09:43,036 - {'Epoch': 54, 'HR@5': '0.0948', 'NDCG@5': '0.0680', 'HR@10': '0.1291', 'NDCG@10': '0.0790', 'HR@20': '0.1684', 'NDCG@20': '0.0889'}
2025-02-22 12:09:43,043 - EarlyStopping counter: 10 out of 10
2025-02-22 12:09:43,043 - Early stopping
2025-02-22 12:09:43,043 - ---------------Test Score---------------
2025-02-22 12:09:52,096 - {'Epoch': 0, 'HR@5': '0.0802', 'NDCG@5': '0.0567', 'HR@10': '0.1087', 'NDCG@10': '0.0659', 'HR@20': '0.1427', 'NDCG@20': '0.0745'}
2025-02-22 12:09:52,103 - Scale_Toys
2025-02-22 12:09:52,103 - {'Epoch': 0, 'HR@5': '0.0802', 'NDCG@5': '0.0567', 'HR@10': '0.1087', 'NDCG@10': '0.0659', 'HR@20': '0.1427', 'NDCG@20': '0.0745'}
2025-02-22 12:32:41,312 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 5], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-02-22 12:32:50,367 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-22 12:32:50,502 - Total Parameters: 916817
2025-02-22 12:33:26,919 - {'epoch': 0, 'rec_loss': '9.0939'}
2025-02-22 12:33:35,460 - {'Epoch': 0, 'HR@5': '0.0067', 'NDCG@5': '0.0043', 'HR@10': '0.0118', 'NDCG@10': '0.0059', 'HR@20': '0.0188', 'NDCG@20': '0.0076'}
2025-02-22 12:33:35,466 - Validation score increased.  Saving model ...
2025-02-22 12:34:09,139 - {'epoch': 1, 'rec_loss': '8.6872'}
2025-02-22 12:34:17,731 - {'Epoch': 1, 'HR@5': '0.0179', 'NDCG@5': '0.0130', 'HR@10': '0.0276', 'NDCG@10': '0.0161', 'HR@20': '0.0400', 'NDCG@20': '0.0192'}
2025-02-22 12:34:17,737 - Validation score increased.  Saving model ...
2025-02-22 12:34:51,404 - {'epoch': 2, 'rec_loss': '8.3909'}
2025-02-22 12:34:58,876 - {'Epoch': 2, 'HR@5': '0.0371', 'NDCG@5': '0.0269', 'HR@10': '0.0522', 'NDCG@10': '0.0317', 'HR@20': '0.0756', 'NDCG@20': '0.0376'}
2025-02-22 12:34:58,882 - Validation score increased.  Saving model ...
2025-02-22 12:35:33,400 - {'epoch': 3, 'rec_loss': '8.1135'}
2025-02-22 12:35:41,026 - {'Epoch': 3, 'HR@5': '0.0505', 'NDCG@5': '0.0361', 'HR@10': '0.0697', 'NDCG@10': '0.0423', 'HR@20': '0.0980', 'NDCG@20': '0.0494'}
2025-02-22 12:35:41,031 - Validation score increased.  Saving model ...
2025-02-22 12:36:14,947 - {'epoch': 4, 'rec_loss': '7.8994'}
2025-02-22 12:36:23,870 - {'Epoch': 4, 'HR@5': '0.0602', 'NDCG@5': '0.0432', 'HR@10': '0.0842', 'NDCG@10': '0.0509', 'HR@20': '0.1148', 'NDCG@20': '0.0585'}
2025-02-22 12:36:23,875 - Validation score increased.  Saving model ...
2025-02-22 12:36:59,266 - {'epoch': 5, 'rec_loss': '7.7366'}
2025-02-22 12:37:07,138 - {'Epoch': 5, 'HR@5': '0.0689', 'NDCG@5': '0.0491', 'HR@10': '0.0933', 'NDCG@10': '0.0569', 'HR@20': '0.1264', 'NDCG@20': '0.0652'}
2025-02-22 12:37:07,144 - Validation score increased.  Saving model ...
2025-02-22 12:37:44,581 - {'epoch': 6, 'rec_loss': '7.6086'}
2025-02-22 12:37:52,787 - {'Epoch': 6, 'HR@5': '0.0776', 'NDCG@5': '0.0547', 'HR@10': '0.1031', 'NDCG@10': '0.0629', 'HR@20': '0.1360', 'NDCG@20': '0.0712'}
2025-02-22 12:37:52,793 - Validation score increased.  Saving model ...
2025-02-22 12:38:29,712 - {'epoch': 7, 'rec_loss': '7.5088'}
2025-02-22 12:38:38,736 - {'Epoch': 7, 'HR@5': '0.0802', 'NDCG@5': '0.0581', 'HR@10': '0.1066', 'NDCG@10': '0.0666', 'HR@20': '0.1433', 'NDCG@20': '0.0758'}
2025-02-22 12:38:38,744 - Validation score increased.  Saving model ...
2025-02-22 12:39:12,585 - {'epoch': 8, 'rec_loss': '7.4299'}
2025-02-22 12:39:20,210 - {'Epoch': 8, 'HR@5': '0.0825', 'NDCG@5': '0.0596', 'HR@10': '0.1105', 'NDCG@10': '0.0686', 'HR@20': '0.1472', 'NDCG@20': '0.0779'}
2025-02-22 12:39:20,216 - Validation score increased.  Saving model ...
2025-02-22 12:39:54,463 - {'epoch': 9, 'rec_loss': '7.3620'}
2025-02-22 12:40:02,552 - {'Epoch': 9, 'HR@5': '0.0853', 'NDCG@5': '0.0619', 'HR@10': '0.1147', 'NDCG@10': '0.0713', 'HR@20': '0.1496', 'NDCG@20': '0.0801'}
2025-02-22 12:40:02,560 - Validation score increased.  Saving model ...
2025-02-22 12:40:35,586 - {'epoch': 10, 'rec_loss': '7.3123'}
2025-02-22 12:40:44,308 - {'Epoch': 10, 'HR@5': '0.0859', 'NDCG@5': '0.0624', 'HR@10': '0.1166', 'NDCG@10': '0.0722', 'HR@20': '0.1526', 'NDCG@20': '0.0813'}
2025-02-22 12:40:44,314 - Validation score increased.  Saving model ...
2025-02-22 12:41:17,914 - {'epoch': 11, 'rec_loss': '7.2639'}
2025-02-22 12:41:26,459 - {'Epoch': 11, 'HR@5': '0.0870', 'NDCG@5': '0.0632', 'HR@10': '0.1175', 'NDCG@10': '0.0730', 'HR@20': '0.1564', 'NDCG@20': '0.0828'}
2025-02-22 12:41:26,465 - Validation score increased.  Saving model ...
2025-02-22 12:42:00,548 - {'epoch': 12, 'rec_loss': '7.2210'}
2025-02-22 12:42:08,154 - {'Epoch': 12, 'HR@5': '0.0889', 'NDCG@5': '0.0643', 'HR@10': '0.1181', 'NDCG@10': '0.0737', 'HR@20': '0.1568', 'NDCG@20': '0.0835'}
2025-02-22 12:42:08,161 - Validation score increased.  Saving model ...
2025-02-22 12:42:43,710 - {'epoch': 13, 'rec_loss': '7.1986'}
2025-02-22 12:42:52,049 - {'Epoch': 13, 'HR@5': '0.0887', 'NDCG@5': '0.0639', 'HR@10': '0.1192', 'NDCG@10': '0.0737', 'HR@20': '0.1577', 'NDCG@20': '0.0834'}
2025-02-22 12:42:52,057 - EarlyStopping counter: 1 out of 10
2025-02-22 12:43:27,130 - {'epoch': 14, 'rec_loss': '7.1626'}
2025-02-22 12:43:34,767 - {'Epoch': 14, 'HR@5': '0.0892', 'NDCG@5': '0.0647', 'HR@10': '0.1203', 'NDCG@10': '0.0747', 'HR@20': '0.1592', 'NDCG@20': '0.0846'}
2025-02-22 12:43:34,773 - Validation score increased.  Saving model ...
2025-02-22 12:44:09,699 - {'epoch': 15, 'rec_loss': '7.1340'}
2025-02-22 12:44:18,264 - {'Epoch': 15, 'HR@5': '0.0902', 'NDCG@5': '0.0648', 'HR@10': '0.1212', 'NDCG@10': '0.0747', 'HR@20': '0.1606', 'NDCG@20': '0.0846'}
2025-02-22 12:44:18,270 - Validation score increased.  Saving model ...
2025-02-22 12:44:52,060 - {'epoch': 16, 'rec_loss': '7.1173'}
2025-02-22 12:45:01,046 - {'Epoch': 16, 'HR@5': '0.0904', 'NDCG@5': '0.0654', 'HR@10': '0.1213', 'NDCG@10': '0.0753', 'HR@20': '0.1603', 'NDCG@20': '0.0852'}
2025-02-22 12:45:01,054 - Validation score increased.  Saving model ...
2025-02-22 12:45:35,890 - {'epoch': 17, 'rec_loss': '7.0884'}
2025-02-22 12:45:44,827 - {'Epoch': 17, 'HR@5': '0.0896', 'NDCG@5': '0.0649', 'HR@10': '0.1212', 'NDCG@10': '0.0751', 'HR@20': '0.1619', 'NDCG@20': '0.0854'}
2025-02-22 12:45:44,838 - Validation score increased.  Saving model ...
2025-02-22 12:46:18,922 - {'epoch': 18, 'rec_loss': '7.0727'}
2025-02-22 12:46:27,724 - {'Epoch': 18, 'HR@5': '0.0916', 'NDCG@5': '0.0657', 'HR@10': '0.1218', 'NDCG@10': '0.0754', 'HR@20': '0.1610', 'NDCG@20': '0.0853'}
2025-02-22 12:46:27,731 - EarlyStopping counter: 1 out of 10
2025-02-22 12:47:03,416 - {'epoch': 19, 'rec_loss': '7.0565'}
2025-02-22 12:47:11,109 - {'Epoch': 19, 'HR@5': '0.0910', 'NDCG@5': '0.0660', 'HR@10': '0.1221', 'NDCG@10': '0.0759', 'HR@20': '0.1630', 'NDCG@20': '0.0862'}
2025-02-22 12:47:11,114 - Validation score increased.  Saving model ...
2025-02-22 12:47:40,451 - {'epoch': 20, 'rec_loss': '7.0324'}
2025-02-22 12:47:49,470 - {'Epoch': 20, 'HR@5': '0.0921', 'NDCG@5': '0.0663', 'HR@10': '0.1230', 'NDCG@10': '0.0763', 'HR@20': '0.1633', 'NDCG@20': '0.0864'}
2025-02-22 12:47:49,475 - Validation score increased.  Saving model ...
2025-02-22 12:48:26,055 - {'epoch': 21, 'rec_loss': '7.0239'}
2025-02-22 12:48:34,812 - {'Epoch': 21, 'HR@5': '0.0907', 'NDCG@5': '0.0660', 'HR@10': '0.1232', 'NDCG@10': '0.0765', 'HR@20': '0.1643', 'NDCG@20': '0.0869'}
2025-02-22 12:48:34,817 - Validation score increased.  Saving model ...
2025-02-22 12:49:14,239 - {'epoch': 22, 'rec_loss': '7.0056'}
2025-02-22 12:49:22,240 - {'Epoch': 22, 'HR@5': '0.0913', 'NDCG@5': '0.0668', 'HR@10': '0.1238', 'NDCG@10': '0.0773', 'HR@20': '0.1654', 'NDCG@20': '0.0877'}
2025-02-22 12:49:22,248 - Validation score increased.  Saving model ...
2025-02-22 12:49:55,520 - {'epoch': 23, 'rec_loss': '6.9898'}
2025-02-22 12:50:03,299 - {'Epoch': 23, 'HR@5': '0.0915', 'NDCG@5': '0.0661', 'HR@10': '0.1246', 'NDCG@10': '0.0768', 'HR@20': '0.1644', 'NDCG@20': '0.0868'}
2025-02-22 12:50:03,305 - EarlyStopping counter: 1 out of 10
2025-02-22 12:50:37,726 - {'epoch': 24, 'rec_loss': '6.9768'}
2025-02-22 12:50:46,504 - {'Epoch': 24, 'HR@5': '0.0934', 'NDCG@5': '0.0674', 'HR@10': '0.1256', 'NDCG@10': '0.0777', 'HR@20': '0.1661', 'NDCG@20': '0.0879'}
2025-02-22 12:50:46,512 - Validation score increased.  Saving model ...
2025-02-22 12:51:20,571 - {'epoch': 25, 'rec_loss': '6.9582'}
2025-02-22 12:51:29,185 - {'Epoch': 25, 'HR@5': '0.0930', 'NDCG@5': '0.0668', 'HR@10': '0.1249', 'NDCG@10': '0.0771', 'HR@20': '0.1659', 'NDCG@20': '0.0874'}
2025-02-22 12:51:29,186 - EarlyStopping counter: 1 out of 10
2025-02-22 12:52:02,935 - {'epoch': 26, 'rec_loss': '6.9574'}
2025-02-22 12:52:11,657 - {'Epoch': 26, 'HR@5': '0.0918', 'NDCG@5': '0.0664', 'HR@10': '0.1260', 'NDCG@10': '0.0774', 'HR@20': '0.1651', 'NDCG@20': '0.0873'}
2025-02-22 12:52:11,664 - EarlyStopping counter: 2 out of 10
2025-02-22 12:52:46,360 - {'epoch': 27, 'rec_loss': '6.9411'}
2025-02-22 12:52:54,603 - {'Epoch': 27, 'HR@5': '0.0914', 'NDCG@5': '0.0663', 'HR@10': '0.1237', 'NDCG@10': '0.0767', 'HR@20': '0.1647', 'NDCG@20': '0.0871'}
2025-02-22 12:52:54,605 - EarlyStopping counter: 3 out of 10
2025-02-22 12:53:29,464 - {'epoch': 28, 'rec_loss': '6.9339'}
2025-02-22 12:53:37,979 - {'Epoch': 28, 'HR@5': '0.0928', 'NDCG@5': '0.0668', 'HR@10': '0.1251', 'NDCG@10': '0.0771', 'HR@20': '0.1655', 'NDCG@20': '0.0873'}
2025-02-22 12:53:37,985 - EarlyStopping counter: 4 out of 10
2025-02-22 12:54:13,746 - {'epoch': 29, 'rec_loss': '6.9193'}
2025-02-22 12:54:22,346 - {'Epoch': 29, 'HR@5': '0.0927', 'NDCG@5': '0.0661', 'HR@10': '0.1247', 'NDCG@10': '0.0764', 'HR@20': '0.1652', 'NDCG@20': '0.0866'}
2025-02-22 12:54:22,352 - EarlyStopping counter: 5 out of 10
2025-02-22 12:54:55,839 - {'epoch': 30, 'rec_loss': '6.9078'}
2025-02-22 12:55:03,352 - {'Epoch': 30, 'HR@5': '0.0927', 'NDCG@5': '0.0670', 'HR@10': '0.1247', 'NDCG@10': '0.0774', 'HR@20': '0.1652', 'NDCG@20': '0.0876'}
2025-02-22 12:55:03,357 - EarlyStopping counter: 6 out of 10
2025-02-22 12:55:37,336 - {'epoch': 31, 'rec_loss': '6.8978'}
2025-02-22 12:55:45,006 - {'Epoch': 31, 'HR@5': '0.0924', 'NDCG@5': '0.0673', 'HR@10': '0.1243', 'NDCG@10': '0.0776', 'HR@20': '0.1666', 'NDCG@20': '0.0883'}
2025-02-22 12:55:45,012 - Validation score increased.  Saving model ...
2025-02-22 12:56:19,152 - {'epoch': 32, 'rec_loss': '6.8931'}
2025-02-22 12:56:26,804 - {'Epoch': 32, 'HR@5': '0.0937', 'NDCG@5': '0.0680', 'HR@10': '0.1266', 'NDCG@10': '0.0786', 'HR@20': '0.1664', 'NDCG@20': '0.0886'}
2025-02-22 12:56:26,813 - Validation score increased.  Saving model ...
2025-02-22 12:57:01,064 - {'epoch': 33, 'rec_loss': '6.8854'}
2025-02-22 12:57:09,890 - {'Epoch': 33, 'HR@5': '0.0938', 'NDCG@5': '0.0676', 'HR@10': '0.1262', 'NDCG@10': '0.0780', 'HR@20': '0.1661', 'NDCG@20': '0.0881'}
2025-02-22 12:57:09,896 - EarlyStopping counter: 1 out of 10
2025-02-22 12:57:45,580 - {'epoch': 34, 'rec_loss': '6.8780'}
2025-02-22 12:57:54,039 - {'Epoch': 34, 'HR@5': '0.0923', 'NDCG@5': '0.0667', 'HR@10': '0.1257', 'NDCG@10': '0.0775', 'HR@20': '0.1662', 'NDCG@20': '0.0877'}
2025-02-22 12:57:54,048 - EarlyStopping counter: 2 out of 10
2025-02-22 12:58:24,628 - {'epoch': 35, 'rec_loss': '6.8685'}
2025-02-22 12:58:33,403 - {'Epoch': 35, 'HR@5': '0.0932', 'NDCG@5': '0.0676', 'HR@10': '0.1268', 'NDCG@10': '0.0784', 'HR@20': '0.1675', 'NDCG@20': '0.0886'}
2025-02-22 12:58:33,412 - Validation score increased.  Saving model ...
2025-02-22 12:59:09,380 - {'epoch': 36, 'rec_loss': '6.8650'}
2025-02-22 12:59:18,027 - {'Epoch': 36, 'HR@5': '0.0945', 'NDCG@5': '0.0686', 'HR@10': '0.1280', 'NDCG@10': '0.0793', 'HR@20': '0.1665', 'NDCG@20': '0.0890'}
2025-02-22 12:59:18,033 - Validation score increased.  Saving model ...
2025-02-22 12:59:52,382 - {'epoch': 37, 'rec_loss': '6.8528'}
2025-02-22 13:00:00,837 - {'Epoch': 37, 'HR@5': '0.0946', 'NDCG@5': '0.0682', 'HR@10': '0.1275', 'NDCG@10': '0.0788', 'HR@20': '0.1679', 'NDCG@20': '0.0890'}
2025-02-22 13:00:00,843 - Validation score increased.  Saving model ...
2025-02-22 13:00:36,780 - {'epoch': 38, 'rec_loss': '6.8392'}
2025-02-22 13:00:44,963 - {'Epoch': 38, 'HR@5': '0.0950', 'NDCG@5': '0.0684', 'HR@10': '0.1267', 'NDCG@10': '0.0786', 'HR@20': '0.1677', 'NDCG@20': '0.0889'}
2025-02-22 13:00:44,969 - EarlyStopping counter: 1 out of 10
2025-02-22 13:01:19,622 - {'epoch': 39, 'rec_loss': '6.8419'}
2025-02-22 13:01:28,300 - {'Epoch': 39, 'HR@5': '0.0951', 'NDCG@5': '0.0685', 'HR@10': '0.1272', 'NDCG@10': '0.0789', 'HR@20': '0.1670', 'NDCG@20': '0.0889'}
2025-02-22 13:01:28,306 - EarlyStopping counter: 2 out of 10
2025-02-22 13:02:02,480 - {'epoch': 40, 'rec_loss': '6.8368'}
2025-02-22 13:02:10,555 - {'Epoch': 40, 'HR@5': '0.0936', 'NDCG@5': '0.0672', 'HR@10': '0.1269', 'NDCG@10': '0.0779', 'HR@20': '0.1671', 'NDCG@20': '0.0881'}
2025-02-22 13:02:10,564 - EarlyStopping counter: 3 out of 10
2025-02-22 13:02:43,057 - {'epoch': 41, 'rec_loss': '6.8284'}
2025-02-22 13:02:50,821 - {'Epoch': 41, 'HR@5': '0.0943', 'NDCG@5': '0.0680', 'HR@10': '0.1264', 'NDCG@10': '0.0783', 'HR@20': '0.1668', 'NDCG@20': '0.0885'}
2025-02-22 13:02:50,827 - EarlyStopping counter: 4 out of 10
2025-02-22 13:03:24,253 - {'epoch': 42, 'rec_loss': '6.8223'}
2025-02-22 13:03:31,949 - {'Epoch': 42, 'HR@5': '0.0949', 'NDCG@5': '0.0683', 'HR@10': '0.1259', 'NDCG@10': '0.0783', 'HR@20': '0.1658', 'NDCG@20': '0.0884'}
2025-02-22 13:03:31,955 - EarlyStopping counter: 5 out of 10
2025-02-22 13:04:04,979 - {'epoch': 43, 'rec_loss': '6.8160'}
2025-02-22 13:04:13,806 - {'Epoch': 43, 'HR@5': '0.0926', 'NDCG@5': '0.0673', 'HR@10': '0.1259', 'NDCG@10': '0.0781', 'HR@20': '0.1663', 'NDCG@20': '0.0882'}
2025-02-22 13:04:13,812 - EarlyStopping counter: 6 out of 10
2025-02-22 13:04:46,280 - {'epoch': 44, 'rec_loss': '6.8060'}
2025-02-22 13:04:55,431 - {'Epoch': 44, 'HR@5': '0.0937', 'NDCG@5': '0.0679', 'HR@10': '0.1260', 'NDCG@10': '0.0783', 'HR@20': '0.1687', 'NDCG@20': '0.0890'}
2025-02-22 13:04:55,439 - Validation score increased.  Saving model ...
2025-02-22 13:05:28,847 - {'epoch': 45, 'rec_loss': '6.8049'}
2025-02-22 13:05:37,086 - {'Epoch': 45, 'HR@5': '0.0932', 'NDCG@5': '0.0675', 'HR@10': '0.1266', 'NDCG@10': '0.0783', 'HR@20': '0.1673', 'NDCG@20': '0.0885'}
2025-02-22 13:05:37,093 - EarlyStopping counter: 1 out of 10
2025-02-22 13:06:10,287 - {'epoch': 46, 'rec_loss': '6.8026'}
2025-02-22 13:06:18,713 - {'Epoch': 46, 'HR@5': '0.0937', 'NDCG@5': '0.0679', 'HR@10': '0.1252', 'NDCG@10': '0.0781', 'HR@20': '0.1677', 'NDCG@20': '0.0888'}
2025-02-22 13:06:18,718 - EarlyStopping counter: 2 out of 10
2025-02-22 13:06:51,951 - {'epoch': 47, 'rec_loss': '6.7902'}
2025-02-22 13:07:00,694 - {'Epoch': 47, 'HR@5': '0.0933', 'NDCG@5': '0.0677', 'HR@10': '0.1256', 'NDCG@10': '0.0781', 'HR@20': '0.1679', 'NDCG@20': '0.0887'}
2025-02-22 13:07:00,700 - EarlyStopping counter: 3 out of 10
2025-02-22 13:07:36,012 - {'epoch': 48, 'rec_loss': '6.7930'}
2025-02-22 13:07:43,615 - {'Epoch': 48, 'HR@5': '0.0937', 'NDCG@5': '0.0679', 'HR@10': '0.1252', 'NDCG@10': '0.0780', 'HR@20': '0.1676', 'NDCG@20': '0.0887'}
2025-02-22 13:07:43,621 - EarlyStopping counter: 4 out of 10
2025-02-22 13:08:18,481 - {'epoch': 49, 'rec_loss': '6.7821'}
2025-02-22 13:08:25,696 - {'Epoch': 49, 'HR@5': '0.0934', 'NDCG@5': '0.0676', 'HR@10': '0.1239', 'NDCG@10': '0.0774', 'HR@20': '0.1661', 'NDCG@20': '0.0881'}
2025-02-22 13:08:25,701 - EarlyStopping counter: 5 out of 10
2025-02-22 13:09:01,864 - {'epoch': 50, 'rec_loss': '6.7797'}
2025-02-22 13:09:10,500 - {'Epoch': 50, 'HR@5': '0.0933', 'NDCG@5': '0.0676', 'HR@10': '0.1265', 'NDCG@10': '0.0783', 'HR@20': '0.1659', 'NDCG@20': '0.0882'}
2025-02-22 13:09:10,508 - EarlyStopping counter: 6 out of 10
2025-02-22 13:09:48,010 - {'epoch': 51, 'rec_loss': '6.7711'}
2025-02-22 13:09:56,531 - {'Epoch': 51, 'HR@5': '0.0938', 'NDCG@5': '0.0686', 'HR@10': '0.1267', 'NDCG@10': '0.0792', 'HR@20': '0.1664', 'NDCG@20': '0.0892'}
2025-02-22 13:09:56,537 - Validation score increased.  Saving model ...
2025-02-22 13:10:30,167 - {'epoch': 52, 'rec_loss': '6.7673'}
2025-02-22 13:10:39,142 - {'Epoch': 52, 'HR@5': '0.0947', 'NDCG@5': '0.0685', 'HR@10': '0.1270', 'NDCG@10': '0.0789', 'HR@20': '0.1653', 'NDCG@20': '0.0885'}
2025-02-22 13:10:39,149 - EarlyStopping counter: 1 out of 10
2025-02-22 13:11:12,501 - {'epoch': 53, 'rec_loss': '6.7580'}
2025-02-22 13:11:21,626 - {'Epoch': 53, 'HR@5': '0.0937', 'NDCG@5': '0.0678', 'HR@10': '0.1266', 'NDCG@10': '0.0784', 'HR@20': '0.1658', 'NDCG@20': '0.0882'}
2025-02-22 13:11:21,633 - EarlyStopping counter: 2 out of 10
2025-02-22 13:11:54,901 - {'epoch': 54, 'rec_loss': '6.7551'}
2025-02-22 13:12:02,859 - {'Epoch': 54, 'HR@5': '0.0948', 'NDCG@5': '0.0685', 'HR@10': '0.1266', 'NDCG@10': '0.0788', 'HR@20': '0.1656', 'NDCG@20': '0.0886'}
2025-02-22 13:12:02,866 - EarlyStopping counter: 3 out of 10
2025-02-22 13:12:36,702 - {'epoch': 55, 'rec_loss': '6.7556'}
2025-02-22 13:12:45,233 - {'Epoch': 55, 'HR@5': '0.0937', 'NDCG@5': '0.0679', 'HR@10': '0.1270', 'NDCG@10': '0.0787', 'HR@20': '0.1663', 'NDCG@20': '0.0885'}
2025-02-22 13:12:45,239 - EarlyStopping counter: 4 out of 10
2025-02-22 13:13:18,060 - {'epoch': 56, 'rec_loss': '6.7525'}
2025-02-22 13:13:26,588 - {'Epoch': 56, 'HR@5': '0.0928', 'NDCG@5': '0.0672', 'HR@10': '0.1274', 'NDCG@10': '0.0783', 'HR@20': '0.1664', 'NDCG@20': '0.0881'}
2025-02-22 13:13:26,595 - EarlyStopping counter: 5 out of 10
2025-02-22 13:14:00,194 - {'epoch': 57, 'rec_loss': '6.7546'}
2025-02-22 13:14:08,916 - {'Epoch': 57, 'HR@5': '0.0943', 'NDCG@5': '0.0680', 'HR@10': '0.1280', 'NDCG@10': '0.0789', 'HR@20': '0.1666', 'NDCG@20': '0.0887'}
2025-02-22 13:14:08,922 - EarlyStopping counter: 6 out of 10
2025-02-22 13:14:43,559 - {'epoch': 58, 'rec_loss': '6.7415'}
2025-02-22 13:14:51,933 - {'Epoch': 58, 'HR@5': '0.0932', 'NDCG@5': '0.0679', 'HR@10': '0.1263', 'NDCG@10': '0.0786', 'HR@20': '0.1671', 'NDCG@20': '0.0888'}
2025-02-22 13:14:51,938 - EarlyStopping counter: 7 out of 10
2025-02-22 13:15:27,421 - {'epoch': 59, 'rec_loss': '6.7390'}
2025-02-22 13:15:36,375 - {'Epoch': 59, 'HR@5': '0.0941', 'NDCG@5': '0.0683', 'HR@10': '0.1266', 'NDCG@10': '0.0788', 'HR@20': '0.1673', 'NDCG@20': '0.0891'}
2025-02-22 13:15:36,383 - EarlyStopping counter: 8 out of 10
2025-02-22 13:16:10,154 - {'epoch': 60, 'rec_loss': '6.7326'}
2025-02-22 13:16:19,014 - {'Epoch': 60, 'HR@5': '0.0941', 'NDCG@5': '0.0683', 'HR@10': '0.1264', 'NDCG@10': '0.0787', 'HR@20': '0.1671', 'NDCG@20': '0.0889'}
2025-02-22 13:16:19,015 - EarlyStopping counter: 9 out of 10
2025-02-22 13:16:52,720 - {'epoch': 61, 'rec_loss': '6.7332'}
2025-02-22 13:17:01,826 - {'Epoch': 61, 'HR@5': '0.0943', 'NDCG@5': '0.0684', 'HR@10': '0.1260', 'NDCG@10': '0.0785', 'HR@20': '0.1670', 'NDCG@20': '0.0888'}
2025-02-22 13:17:01,833 - EarlyStopping counter: 10 out of 10
2025-02-22 13:17:01,833 - Early stopping
2025-02-22 13:17:01,833 - ---------------Test Score---------------
2025-02-22 13:17:10,346 - {'Epoch': 0, 'HR@5': '0.0788', 'NDCG@5': '0.0578', 'HR@10': '0.1084', 'NDCG@10': '0.0674', 'HR@20': '0.1428', 'NDCG@20': '0.0761'}
2025-02-22 13:17:10,352 - Scale_Toys
2025-02-22 13:17:10,352 - {'Epoch': 0, 'HR@5': '0.0788', 'NDCG@5': '0.0578', 'HR@10': '0.1084', 'NDCG@10': '0.0674', 'HR@20': '0.1428', 'NDCG@20': '0.0761'}
2025-02-22 13:23:45,266 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10, 5], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-02-22 13:23:52,571 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-22 13:23:52,587 - Total Parameters: 916817
2025-02-22 13:24:37,710 - {'epoch': 0, 'rec_loss': '9.0853'}
2025-02-22 13:24:47,325 - {'Epoch': 0, 'HR@5': '0.0068', 'NDCG@5': '0.0040', 'HR@10': '0.0125', 'NDCG@10': '0.0059', 'HR@20': '0.0216', 'NDCG@20': '0.0082'}
2025-02-22 13:24:47,329 - Validation score increased.  Saving model ...
2025-02-22 13:25:28,417 - {'epoch': 1, 'rec_loss': '8.6298'}
2025-02-22 13:25:37,045 - {'Epoch': 1, 'HR@5': '0.0250', 'NDCG@5': '0.0179', 'HR@10': '0.0346', 'NDCG@10': '0.0210', 'HR@20': '0.0506', 'NDCG@20': '0.0250'}
2025-02-22 13:25:37,051 - Validation score increased.  Saving model ...
2025-02-22 13:26:19,542 - {'epoch': 2, 'rec_loss': '8.2723'}
2025-02-22 13:26:28,628 - {'Epoch': 2, 'HR@5': '0.0462', 'NDCG@5': '0.0328', 'HR@10': '0.0623', 'NDCG@10': '0.0380', 'HR@20': '0.0899', 'NDCG@20': '0.0449'}
2025-02-22 13:26:28,634 - Validation score increased.  Saving model ...
2025-02-22 13:27:10,745 - {'epoch': 3, 'rec_loss': '7.9495'}
2025-02-22 13:27:18,648 - {'Epoch': 3, 'HR@5': '0.0623', 'NDCG@5': '0.0444', 'HR@10': '0.0851', 'NDCG@10': '0.0518', 'HR@20': '0.1155', 'NDCG@20': '0.0594'}
2025-02-22 13:27:18,653 - Validation score increased.  Saving model ...
2025-02-22 13:28:01,672 - {'epoch': 4, 'rec_loss': '7.7315'}
2025-02-22 13:28:09,548 - {'Epoch': 4, 'HR@5': '0.0701', 'NDCG@5': '0.0506', 'HR@10': '0.0962', 'NDCG@10': '0.0590', 'HR@20': '0.1290', 'NDCG@20': '0.0673'}
2025-02-22 13:28:09,554 - Validation score increased.  Saving model ...
2025-02-22 13:28:51,700 - {'epoch': 5, 'rec_loss': '7.5735'}
2025-02-22 13:29:00,794 - {'Epoch': 5, 'HR@5': '0.0774', 'NDCG@5': '0.0554', 'HR@10': '0.1062', 'NDCG@10': '0.0647', 'HR@20': '0.1408', 'NDCG@20': '0.0734'}
2025-02-22 13:29:00,800 - Validation score increased.  Saving model ...
2025-02-22 13:29:40,521 - {'epoch': 6, 'rec_loss': '7.4513'}
2025-02-22 13:29:49,607 - {'Epoch': 6, 'HR@5': '0.0806', 'NDCG@5': '0.0585', 'HR@10': '0.1090', 'NDCG@10': '0.0677', 'HR@20': '0.1456', 'NDCG@20': '0.0769'}
2025-02-22 13:29:49,609 - Validation score increased.  Saving model ...
2025-02-22 13:30:37,860 - {'epoch': 7, 'rec_loss': '7.3581'}
2025-02-22 13:30:46,832 - {'Epoch': 7, 'HR@5': '0.0823', 'NDCG@5': '0.0595', 'HR@10': '0.1130', 'NDCG@10': '0.0694', 'HR@20': '0.1495', 'NDCG@20': '0.0786'}
2025-02-22 13:30:46,839 - Validation score increased.  Saving model ...
2025-02-22 13:31:31,543 - {'epoch': 8, 'rec_loss': '7.2915'}
2025-02-22 13:31:40,382 - {'Epoch': 8, 'HR@5': '0.0852', 'NDCG@5': '0.0616', 'HR@10': '0.1165', 'NDCG@10': '0.0717', 'HR@20': '0.1532', 'NDCG@20': '0.0810'}
2025-02-22 13:31:40,390 - Validation score increased.  Saving model ...
2025-02-22 13:32:22,213 - {'epoch': 9, 'rec_loss': '7.2325'}
2025-02-22 13:32:30,023 - {'Epoch': 9, 'HR@5': '0.0858', 'NDCG@5': '0.0626', 'HR@10': '0.1175', 'NDCG@10': '0.0729', 'HR@20': '0.1561', 'NDCG@20': '0.0826'}
2025-02-22 13:32:30,024 - Validation score increased.  Saving model ...
2025-02-22 13:33:12,937 - {'epoch': 10, 'rec_loss': '7.1802'}
2025-02-22 13:33:21,166 - {'Epoch': 10, 'HR@5': '0.0887', 'NDCG@5': '0.0639', 'HR@10': '0.1201', 'NDCG@10': '0.0740', 'HR@20': '0.1591', 'NDCG@20': '0.0838'}
2025-02-22 13:33:21,173 - Validation score increased.  Saving model ...
2025-02-22 13:34:05,286 - {'epoch': 11, 'rec_loss': '7.1372'}
2025-02-22 13:34:14,545 - {'Epoch': 11, 'HR@5': '0.0889', 'NDCG@5': '0.0643', 'HR@10': '0.1217', 'NDCG@10': '0.0749', 'HR@20': '0.1586', 'NDCG@20': '0.0842'}
2025-02-22 13:34:14,553 - Validation score increased.  Saving model ...
2025-02-22 13:34:57,684 - {'epoch': 12, 'rec_loss': '7.1011'}
2025-02-22 13:35:06,635 - {'Epoch': 12, 'HR@5': '0.0900', 'NDCG@5': '0.0655', 'HR@10': '0.1221', 'NDCG@10': '0.0759', 'HR@20': '0.1590', 'NDCG@20': '0.0852'}
2025-02-22 13:35:06,636 - Validation score increased.  Saving model ...
2025-02-22 13:35:48,679 - {'epoch': 13, 'rec_loss': '7.0683'}
2025-02-22 13:35:57,922 - {'Epoch': 13, 'HR@5': '0.0915', 'NDCG@5': '0.0662', 'HR@10': '0.1221', 'NDCG@10': '0.0761', 'HR@20': '0.1611', 'NDCG@20': '0.0859'}
2025-02-22 13:35:57,929 - Validation score increased.  Saving model ...
2025-02-22 13:36:40,265 - {'epoch': 14, 'rec_loss': '7.0423'}
2025-02-22 13:36:49,555 - {'Epoch': 14, 'HR@5': '0.0901', 'NDCG@5': '0.0656', 'HR@10': '0.1221', 'NDCG@10': '0.0759', 'HR@20': '0.1620', 'NDCG@20': '0.0859'}
2025-02-22 13:36:49,562 - EarlyStopping counter: 1 out of 10
2025-02-22 13:37:31,823 - {'epoch': 15, 'rec_loss': '7.0227'}
2025-02-22 13:37:40,642 - {'Epoch': 15, 'HR@5': '0.0907', 'NDCG@5': '0.0658', 'HR@10': '0.1203', 'NDCG@10': '0.0753', 'HR@20': '0.1609', 'NDCG@20': '0.0856'}
2025-02-22 13:37:40,649 - EarlyStopping counter: 2 out of 10
2025-02-22 13:38:24,798 - {'epoch': 16, 'rec_loss': '6.9927'}
2025-02-22 13:38:32,767 - {'Epoch': 16, 'HR@5': '0.0890', 'NDCG@5': '0.0647', 'HR@10': '0.1221', 'NDCG@10': '0.0754', 'HR@20': '0.1619', 'NDCG@20': '0.0854'}
2025-02-22 13:38:32,774 - EarlyStopping counter: 3 out of 10
2025-02-22 13:39:13,998 - {'epoch': 17, 'rec_loss': '6.9761'}
2025-02-22 13:39:22,132 - {'Epoch': 17, 'HR@5': '0.0895', 'NDCG@5': '0.0652', 'HR@10': '0.1220', 'NDCG@10': '0.0757', 'HR@20': '0.1647', 'NDCG@20': '0.0865'}
2025-02-22 13:39:22,140 - Validation score increased.  Saving model ...
2025-02-22 13:39:59,491 - {'epoch': 18, 'rec_loss': '6.9574'}
2025-02-22 13:40:09,851 - {'Epoch': 18, 'HR@5': '0.0922', 'NDCG@5': '0.0668', 'HR@10': '0.1240', 'NDCG@10': '0.0771', 'HR@20': '0.1629', 'NDCG@20': '0.0869'}
2025-02-22 13:40:09,859 - Validation score increased.  Saving model ...
2025-02-22 13:40:55,167 - {'epoch': 19, 'rec_loss': '6.9329'}
2025-02-22 13:41:03,903 - {'Epoch': 19, 'HR@5': '0.0915', 'NDCG@5': '0.0666', 'HR@10': '0.1249', 'NDCG@10': '0.0773', 'HR@20': '0.1656', 'NDCG@20': '0.0876'}
2025-02-22 13:41:03,909 - Validation score increased.  Saving model ...
2025-02-22 13:41:46,415 - {'epoch': 20, 'rec_loss': '6.9165'}
2025-02-22 13:41:55,549 - {'Epoch': 20, 'HR@5': '0.0923', 'NDCG@5': '0.0668', 'HR@10': '0.1249', 'NDCG@10': '0.0773', 'HR@20': '0.1653', 'NDCG@20': '0.0875'}
2025-02-22 13:41:55,551 - EarlyStopping counter: 1 out of 10
2025-02-22 13:42:39,110 - {'epoch': 21, 'rec_loss': '6.8999'}
2025-02-22 13:42:47,461 - {'Epoch': 21, 'HR@5': '0.0911', 'NDCG@5': '0.0663', 'HR@10': '0.1244', 'NDCG@10': '0.0770', 'HR@20': '0.1640', 'NDCG@20': '0.0870'}
2025-02-22 13:42:47,468 - EarlyStopping counter: 2 out of 10
2025-02-22 13:43:29,650 - {'epoch': 22, 'rec_loss': '6.8907'}
2025-02-22 13:43:37,617 - {'Epoch': 22, 'HR@5': '0.0931', 'NDCG@5': '0.0673', 'HR@10': '0.1245', 'NDCG@10': '0.0774', 'HR@20': '0.1652', 'NDCG@20': '0.0876'}
2025-02-22 13:43:37,623 - Validation score increased.  Saving model ...
2025-02-22 13:44:20,656 - {'epoch': 23, 'rec_loss': '6.8770'}
2025-02-22 13:44:28,822 - {'Epoch': 23, 'HR@5': '0.0933', 'NDCG@5': '0.0676', 'HR@10': '0.1240', 'NDCG@10': '0.0775', 'HR@20': '0.1652', 'NDCG@20': '0.0879'}
2025-02-22 13:44:28,830 - Validation score increased.  Saving model ...
2025-02-22 13:45:11,775 - {'epoch': 24, 'rec_loss': '6.8609'}
2025-02-22 13:45:19,807 - {'Epoch': 24, 'HR@5': '0.0922', 'NDCG@5': '0.0667', 'HR@10': '0.1250', 'NDCG@10': '0.0773', 'HR@20': '0.1657', 'NDCG@20': '0.0875'}
2025-02-22 13:45:19,814 - EarlyStopping counter: 1 out of 10
2025-02-22 13:46:04,649 - {'epoch': 25, 'rec_loss': '6.8471'}
2025-02-22 13:46:12,816 - {'Epoch': 25, 'HR@5': '0.0922', 'NDCG@5': '0.0669', 'HR@10': '0.1233', 'NDCG@10': '0.0769', 'HR@20': '0.1650', 'NDCG@20': '0.0874'}
2025-02-22 13:46:12,823 - EarlyStopping counter: 2 out of 10
2025-02-22 13:46:56,687 - {'epoch': 26, 'rec_loss': '6.8277'}
2025-02-22 13:47:05,300 - {'Epoch': 26, 'HR@5': '0.0922', 'NDCG@5': '0.0674', 'HR@10': '0.1259', 'NDCG@10': '0.0782', 'HR@20': '0.1673', 'NDCG@20': '0.0886'}
2025-02-22 13:47:05,306 - Validation score increased.  Saving model ...
2025-02-22 13:47:49,152 - {'epoch': 27, 'rec_loss': '6.8222'}
2025-02-22 13:47:58,464 - {'Epoch': 27, 'HR@5': '0.0928', 'NDCG@5': '0.0674', 'HR@10': '0.1230', 'NDCG@10': '0.0771', 'HR@20': '0.1665', 'NDCG@20': '0.0881'}
2025-02-22 13:47:58,470 - EarlyStopping counter: 1 out of 10
2025-02-22 13:48:40,838 - {'epoch': 28, 'rec_loss': '6.8113'}
2025-02-22 13:48:50,093 - {'Epoch': 28, 'HR@5': '0.0914', 'NDCG@5': '0.0668', 'HR@10': '0.1258', 'NDCG@10': '0.0779', 'HR@20': '0.1679', 'NDCG@20': '0.0885'}
2025-02-22 13:48:50,100 - EarlyStopping counter: 2 out of 10
2025-02-22 13:49:35,421 - {'epoch': 29, 'rec_loss': '6.7953'}
2025-02-22 13:49:44,680 - {'Epoch': 29, 'HR@5': '0.0933', 'NDCG@5': '0.0678', 'HR@10': '0.1249', 'NDCG@10': '0.0779', 'HR@20': '0.1656', 'NDCG@20': '0.0881'}
2025-02-22 13:49:44,687 - EarlyStopping counter: 3 out of 10
2025-02-22 13:50:22,124 - {'epoch': 30, 'rec_loss': '6.7825'}
2025-02-22 13:50:31,682 - {'Epoch': 30, 'HR@5': '0.0933', 'NDCG@5': '0.0679', 'HR@10': '0.1269', 'NDCG@10': '0.0787', 'HR@20': '0.1664', 'NDCG@20': '0.0886'}
2025-02-22 13:50:31,689 - Validation score increased.  Saving model ...
2025-02-22 13:51:17,160 - {'epoch': 31, 'rec_loss': '6.7737'}
2025-02-22 13:51:26,135 - {'Epoch': 31, 'HR@5': '0.0929', 'NDCG@5': '0.0679', 'HR@10': '0.1254', 'NDCG@10': '0.0783', 'HR@20': '0.1670', 'NDCG@20': '0.0888'}
2025-02-22 13:51:26,142 - Validation score increased.  Saving model ...
2025-02-22 13:52:09,513 - {'epoch': 32, 'rec_loss': '6.7638'}
2025-02-22 13:52:18,442 - {'Epoch': 32, 'HR@5': '0.0947', 'NDCG@5': '0.0685', 'HR@10': '0.1281', 'NDCG@10': '0.0792', 'HR@20': '0.1674', 'NDCG@20': '0.0891'}
2025-02-22 13:52:18,449 - Validation score increased.  Saving model ...
2025-02-22 13:53:01,694 - {'epoch': 33, 'rec_loss': '6.7553'}
2025-02-22 13:53:10,976 - {'Epoch': 33, 'HR@5': '0.0939', 'NDCG@5': '0.0675', 'HR@10': '0.1269', 'NDCG@10': '0.0781', 'HR@20': '0.1677', 'NDCG@20': '0.0884'}
2025-02-22 13:53:10,984 - EarlyStopping counter: 1 out of 10
2025-02-22 13:53:54,854 - {'epoch': 34, 'rec_loss': '6.7484'}
2025-02-22 13:54:04,170 - {'Epoch': 34, 'HR@5': '0.0938', 'NDCG@5': '0.0680', 'HR@10': '0.1252', 'NDCG@10': '0.0781', 'HR@20': '0.1666', 'NDCG@20': '0.0885'}
2025-02-22 13:54:04,178 - EarlyStopping counter: 2 out of 10
2025-02-22 13:54:47,091 - {'epoch': 35, 'rec_loss': '6.7375'}
2025-02-22 13:54:56,184 - {'Epoch': 35, 'HR@5': '0.0921', 'NDCG@5': '0.0671', 'HR@10': '0.1251', 'NDCG@10': '0.0778', 'HR@20': '0.1663', 'NDCG@20': '0.0882'}
2025-02-22 13:54:56,191 - EarlyStopping counter: 3 out of 10
2025-02-22 13:55:38,575 - {'epoch': 36, 'rec_loss': '6.7370'}
2025-02-22 13:55:47,947 - {'Epoch': 36, 'HR@5': '0.0931', 'NDCG@5': '0.0679', 'HR@10': '0.1260', 'NDCG@10': '0.0785', 'HR@20': '0.1664', 'NDCG@20': '0.0887'}
2025-02-22 13:55:47,948 - EarlyStopping counter: 4 out of 10
2025-02-22 13:56:30,389 - {'epoch': 37, 'rec_loss': '6.7230'}
2025-02-22 13:56:39,748 - {'Epoch': 37, 'HR@5': '0.0940', 'NDCG@5': '0.0685', 'HR@10': '0.1258', 'NDCG@10': '0.0787', 'HR@20': '0.1660', 'NDCG@20': '0.0888'}
2025-02-22 13:56:39,756 - EarlyStopping counter: 5 out of 10
2025-02-22 13:57:22,243 - {'epoch': 38, 'rec_loss': '6.7120'}
2025-02-22 13:57:31,495 - {'Epoch': 38, 'HR@5': '0.0942', 'NDCG@5': '0.0688', 'HR@10': '0.1276', 'NDCG@10': '0.0795', 'HR@20': '0.1656', 'NDCG@20': '0.0891'}
2025-02-22 13:57:31,497 - EarlyStopping counter: 6 out of 10
2025-02-22 13:58:13,745 - {'epoch': 39, 'rec_loss': '6.7049'}
2025-02-22 13:58:23,026 - {'Epoch': 39, 'HR@5': '0.0936', 'NDCG@5': '0.0685', 'HR@10': '0.1262', 'NDCG@10': '0.0790', 'HR@20': '0.1664', 'NDCG@20': '0.0892'}
2025-02-22 13:58:23,027 - Validation score increased.  Saving model ...
2025-02-22 13:59:04,817 - {'epoch': 40, 'rec_loss': '6.7019'}
2025-02-22 13:59:13,919 - {'Epoch': 40, 'HR@5': '0.0942', 'NDCG@5': '0.0684', 'HR@10': '0.1261', 'NDCG@10': '0.0787', 'HR@20': '0.1676', 'NDCG@20': '0.0891'}
2025-02-22 13:59:13,921 - EarlyStopping counter: 1 out of 10
2025-02-22 13:59:55,995 - {'epoch': 41, 'rec_loss': '6.6905'}
2025-02-22 14:00:04,113 - {'Epoch': 41, 'HR@5': '0.0950', 'NDCG@5': '0.0688', 'HR@10': '0.1267', 'NDCG@10': '0.0790', 'HR@20': '0.1669', 'NDCG@20': '0.0891'}
2025-02-22 14:00:04,120 - EarlyStopping counter: 2 out of 10
2025-02-22 14:00:43,597 - {'epoch': 42, 'rec_loss': '6.6906'}
2025-02-22 14:00:52,643 - {'Epoch': 42, 'HR@5': '0.0949', 'NDCG@5': '0.0688', 'HR@10': '0.1256', 'NDCG@10': '0.0787', 'HR@20': '0.1656', 'NDCG@20': '0.0887'}
2025-02-22 14:00:52,650 - EarlyStopping counter: 3 out of 10
2025-02-22 14:01:37,572 - {'epoch': 43, 'rec_loss': '6.6759'}
2025-02-22 14:01:47,013 - {'Epoch': 43, 'HR@5': '0.0942', 'NDCG@5': '0.0680', 'HR@10': '0.1265', 'NDCG@10': '0.0784', 'HR@20': '0.1660', 'NDCG@20': '0.0883'}
2025-02-22 14:01:47,019 - EarlyStopping counter: 4 out of 10
2025-02-22 14:02:31,850 - {'epoch': 44, 'rec_loss': '6.6708'}
2025-02-22 14:02:39,680 - {'Epoch': 44, 'HR@5': '0.0946', 'NDCG@5': '0.0685', 'HR@10': '0.1260', 'NDCG@10': '0.0786', 'HR@20': '0.1676', 'NDCG@20': '0.0891'}
2025-02-22 14:02:39,686 - EarlyStopping counter: 5 out of 10
2025-02-22 14:03:21,638 - {'epoch': 45, 'rec_loss': '6.6643'}
2025-02-22 14:03:30,910 - {'Epoch': 45, 'HR@5': '0.0941', 'NDCG@5': '0.0687', 'HR@10': '0.1242', 'NDCG@10': '0.0784', 'HR@20': '0.1668', 'NDCG@20': '0.0891'}
2025-02-22 14:03:30,915 - EarlyStopping counter: 6 out of 10
2025-02-22 14:04:12,702 - {'epoch': 46, 'rec_loss': '6.6599'}
2025-02-22 14:04:21,817 - {'Epoch': 46, 'HR@5': '0.0947', 'NDCG@5': '0.0686', 'HR@10': '0.1266', 'NDCG@10': '0.0789', 'HR@20': '0.1664', 'NDCG@20': '0.0889'}
2025-02-22 14:04:21,825 - EarlyStopping counter: 7 out of 10
2025-02-22 14:05:06,725 - {'epoch': 47, 'rec_loss': '6.6581'}
2025-02-22 14:05:15,047 - {'Epoch': 47, 'HR@5': '0.0944', 'NDCG@5': '0.0687', 'HR@10': '0.1262', 'NDCG@10': '0.0789', 'HR@20': '0.1649', 'NDCG@20': '0.0887'}
2025-02-22 14:05:15,055 - EarlyStopping counter: 8 out of 10
2025-02-22 14:05:57,498 - {'epoch': 48, 'rec_loss': '6.6494'}
2025-02-22 14:06:07,158 - {'Epoch': 48, 'HR@5': '0.0958', 'NDCG@5': '0.0696', 'HR@10': '0.1283', 'NDCG@10': '0.0800', 'HR@20': '0.1689', 'NDCG@20': '0.0903'}
2025-02-22 14:06:07,159 - Validation score increased.  Saving model ...
2025-02-22 14:06:49,323 - {'epoch': 49, 'rec_loss': '6.6407'}
2025-02-22 14:06:58,141 - {'Epoch': 49, 'HR@5': '0.0956', 'NDCG@5': '0.0692', 'HR@10': '0.1283', 'NDCG@10': '0.0797', 'HR@20': '0.1672', 'NDCG@20': '0.0895'}
2025-02-22 14:06:58,148 - EarlyStopping counter: 1 out of 10
2025-02-22 14:07:40,108 - {'epoch': 50, 'rec_loss': '6.6318'}
2025-02-22 14:07:50,220 - {'Epoch': 50, 'HR@5': '0.0951', 'NDCG@5': '0.0683', 'HR@10': '0.1277', 'NDCG@10': '0.0787', 'HR@20': '0.1664', 'NDCG@20': '0.0885'}
2025-02-22 14:07:50,221 - EarlyStopping counter: 2 out of 10
2025-02-22 14:08:32,588 - {'epoch': 51, 'rec_loss': '6.6259'}
2025-02-22 14:08:40,547 - {'Epoch': 51, 'HR@5': '0.0940', 'NDCG@5': '0.0678', 'HR@10': '0.1270', 'NDCG@10': '0.0785', 'HR@20': '0.1653', 'NDCG@20': '0.0881'}
2025-02-22 14:08:40,553 - EarlyStopping counter: 3 out of 10
2025-02-22 14:09:24,551 - {'epoch': 52, 'rec_loss': '6.6288'}
2025-02-22 14:09:33,503 - {'Epoch': 52, 'HR@5': '0.0932', 'NDCG@5': '0.0672', 'HR@10': '0.1246', 'NDCG@10': '0.0774', 'HR@20': '0.1657', 'NDCG@20': '0.0877'}
2025-02-22 14:09:33,505 - EarlyStopping counter: 4 out of 10
2025-02-22 14:10:17,398 - {'epoch': 53, 'rec_loss': '6.6134'}
2025-02-22 14:10:26,433 - {'Epoch': 53, 'HR@5': '0.0933', 'NDCG@5': '0.0676', 'HR@10': '0.1268', 'NDCG@10': '0.0783', 'HR@20': '0.1660', 'NDCG@20': '0.0882'}
2025-02-22 14:10:26,435 - EarlyStopping counter: 5 out of 10
2025-02-22 14:11:05,213 - {'epoch': 54, 'rec_loss': '6.6160'}
2025-02-22 14:11:12,942 - {'Epoch': 54, 'HR@5': '0.0941', 'NDCG@5': '0.0681', 'HR@10': '0.1276', 'NDCG@10': '0.0789', 'HR@20': '0.1677', 'NDCG@20': '0.0889'}
2025-02-22 14:11:12,949 - EarlyStopping counter: 6 out of 10
2025-02-22 14:11:57,726 - {'epoch': 55, 'rec_loss': '6.6088'}
2025-02-22 14:12:07,016 - {'Epoch': 55, 'HR@5': '0.0954', 'NDCG@5': '0.0695', 'HR@10': '0.1256', 'NDCG@10': '0.0793', 'HR@20': '0.1656', 'NDCG@20': '0.0893'}
2025-02-22 14:12:07,023 - EarlyStopping counter: 7 out of 10
2025-02-22 14:12:51,456 - {'epoch': 56, 'rec_loss': '6.6065'}
2025-02-22 14:12:59,482 - {'Epoch': 56, 'HR@5': '0.0933', 'NDCG@5': '0.0687', 'HR@10': '0.1247', 'NDCG@10': '0.0787', 'HR@20': '0.1662', 'NDCG@20': '0.0892'}
2025-02-22 14:12:59,489 - EarlyStopping counter: 8 out of 10
2025-02-22 14:13:41,408 - {'epoch': 57, 'rec_loss': '6.5981'}
2025-02-22 14:13:50,488 - {'Epoch': 57, 'HR@5': '0.0937', 'NDCG@5': '0.0680', 'HR@10': '0.1269', 'NDCG@10': '0.0787', 'HR@20': '0.1668', 'NDCG@20': '0.0888'}
2025-02-22 14:13:50,496 - EarlyStopping counter: 9 out of 10
2025-02-22 14:14:33,955 - {'epoch': 58, 'rec_loss': '6.6014'}
2025-02-22 14:14:43,307 - {'Epoch': 58, 'HR@5': '0.0926', 'NDCG@5': '0.0679', 'HR@10': '0.1256', 'NDCG@10': '0.0785', 'HR@20': '0.1660', 'NDCG@20': '0.0887'}
2025-02-22 14:14:43,315 - EarlyStopping counter: 10 out of 10
2025-02-22 14:14:43,315 - Early stopping
2025-02-22 14:14:43,315 - ---------------Test Score---------------
2025-02-22 14:14:52,542 - {'Epoch': 0, 'HR@5': '0.0790', 'NDCG@5': '0.0572', 'HR@10': '0.1069', 'NDCG@10': '0.0661', 'HR@20': '0.1406', 'NDCG@20': '0.0746'}
2025-02-22 14:14:52,550 - Scale_Toys
2025-02-22 14:14:52,550 - {'Epoch': 0, 'HR@5': '0.0790', 'NDCG@5': '0.0572', 'HR@10': '0.1069', 'NDCG@10': '0.0661', 'HR@20': '0.1406', 'NDCG@20': '0.0746'}
2025-02-22 14:48:38,105 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-02-22 14:48:47,469 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-22 14:48:47,604 - Total Parameters: 917142
2025-02-22 14:49:22,410 - {'epoch': 0, 'rec_loss': '9.0880'}
2025-02-22 14:49:31,420 - {'Epoch': 0, 'HR@5': '0.0067', 'NDCG@5': '0.0039', 'HR@10': '0.0110', 'NDCG@10': '0.0052', 'HR@20': '0.0182', 'NDCG@20': '0.0070'}
2025-02-22 14:49:31,421 - Validation score increased.  Saving model ...
2025-02-22 14:50:07,664 - {'epoch': 1, 'rec_loss': '8.6826'}
2025-02-22 14:50:16,589 - {'Epoch': 1, 'HR@5': '0.0163', 'NDCG@5': '0.0113', 'HR@10': '0.0252', 'NDCG@10': '0.0142', 'HR@20': '0.0396', 'NDCG@20': '0.0179'}
2025-02-22 14:50:16,595 - Validation score increased.  Saving model ...
2025-02-22 14:50:53,658 - {'epoch': 2, 'rec_loss': '8.3895'}
2025-02-22 14:51:02,250 - {'Epoch': 2, 'HR@5': '0.0343', 'NDCG@5': '0.0245', 'HR@10': '0.0516', 'NDCG@10': '0.0301', 'HR@20': '0.0723', 'NDCG@20': '0.0353'}
2025-02-22 14:51:02,255 - Validation score increased.  Saving model ...
2025-02-22 14:51:36,820 - {'epoch': 3, 'rec_loss': '8.1144'}
2025-02-22 14:51:45,330 - {'Epoch': 3, 'HR@5': '0.0499', 'NDCG@5': '0.0364', 'HR@10': '0.0706', 'NDCG@10': '0.0431', 'HR@20': '0.0959', 'NDCG@20': '0.0494'}
2025-02-22 14:51:45,336 - Validation score increased.  Saving model ...
2025-02-22 14:52:18,468 - {'epoch': 4, 'rec_loss': '7.8956'}
2025-02-22 14:52:27,385 - {'Epoch': 4, 'HR@5': '0.0621', 'NDCG@5': '0.0455', 'HR@10': '0.0848', 'NDCG@10': '0.0528', 'HR@20': '0.1147', 'NDCG@20': '0.0603'}
2025-02-22 14:52:27,390 - Validation score increased.  Saving model ...
2025-02-22 14:52:53,893 - {'epoch': 5, 'rec_loss': '7.7285'}
2025-02-22 14:53:02,630 - {'Epoch': 5, 'HR@5': '0.0702', 'NDCG@5': '0.0507', 'HR@10': '0.0960', 'NDCG@10': '0.0590', 'HR@20': '0.1272', 'NDCG@20': '0.0668'}
2025-02-22 14:53:02,637 - Validation score increased.  Saving model ...
2025-02-22 14:53:41,099 - {'epoch': 6, 'rec_loss': '7.6071'}
2025-02-22 14:53:49,452 - {'Epoch': 6, 'HR@5': '0.0743', 'NDCG@5': '0.0538', 'HR@10': '0.1017', 'NDCG@10': '0.0627', 'HR@20': '0.1371', 'NDCG@20': '0.0716'}
2025-02-22 14:53:49,457 - Validation score increased.  Saving model ...
2025-02-22 14:54:25,336 - {'epoch': 7, 'rec_loss': '7.5083'}
2025-02-22 14:54:33,359 - {'Epoch': 7, 'HR@5': '0.0806', 'NDCG@5': '0.0578', 'HR@10': '0.1085', 'NDCG@10': '0.0668', 'HR@20': '0.1451', 'NDCG@20': '0.0760'}
2025-02-22 14:54:33,366 - Validation score increased.  Saving model ...
2025-02-22 14:55:08,478 - {'epoch': 8, 'rec_loss': '7.4267'}
2025-02-22 14:55:16,952 - {'Epoch': 8, 'HR@5': '0.0835', 'NDCG@5': '0.0602', 'HR@10': '0.1116', 'NDCG@10': '0.0692', 'HR@20': '0.1473', 'NDCG@20': '0.0782'}
2025-02-22 14:55:16,959 - Validation score increased.  Saving model ...
2025-02-22 14:55:51,806 - {'epoch': 9, 'rec_loss': '7.3668'}
2025-02-22 14:55:59,294 - {'Epoch': 9, 'HR@5': '0.0846', 'NDCG@5': '0.0608', 'HR@10': '0.1148', 'NDCG@10': '0.0705', 'HR@20': '0.1514', 'NDCG@20': '0.0797'}
2025-02-22 14:55:59,301 - Validation score increased.  Saving model ...
2025-02-22 14:56:32,677 - {'epoch': 10, 'rec_loss': '7.3141'}
2025-02-22 14:56:41,527 - {'Epoch': 10, 'HR@5': '0.0861', 'NDCG@5': '0.0622', 'HR@10': '0.1162', 'NDCG@10': '0.0719', 'HR@20': '0.1529', 'NDCG@20': '0.0811'}
2025-02-22 14:56:41,534 - Validation score increased.  Saving model ...
2025-02-22 14:57:15,036 - {'epoch': 11, 'rec_loss': '7.2701'}
2025-02-22 14:57:22,735 - {'Epoch': 11, 'HR@5': '0.0883', 'NDCG@5': '0.0641', 'HR@10': '0.1178', 'NDCG@10': '0.0736', 'HR@20': '0.1583', 'NDCG@20': '0.0838'}
2025-02-22 14:57:22,741 - Validation score increased.  Saving model ...
2025-02-22 14:57:58,148 - {'epoch': 12, 'rec_loss': '7.2309'}
2025-02-22 14:58:06,517 - {'Epoch': 12, 'HR@5': '0.0879', 'NDCG@5': '0.0634', 'HR@10': '0.1191', 'NDCG@10': '0.0735', 'HR@20': '0.1576', 'NDCG@20': '0.0832'}
2025-02-22 14:58:06,522 - EarlyStopping counter: 1 out of 10
2025-02-22 14:58:41,059 - {'epoch': 13, 'rec_loss': '7.1989'}
2025-02-22 14:58:49,446 - {'Epoch': 13, 'HR@5': '0.0893', 'NDCG@5': '0.0648', 'HR@10': '0.1208', 'NDCG@10': '0.0749', 'HR@20': '0.1594', 'NDCG@20': '0.0846'}
2025-02-22 14:58:49,448 - Validation score increased.  Saving model ...
2025-02-22 14:59:24,327 - {'epoch': 14, 'rec_loss': '7.1671'}
2025-02-22 14:59:31,753 - {'Epoch': 14, 'HR@5': '0.0880', 'NDCG@5': '0.0638', 'HR@10': '0.1199', 'NDCG@10': '0.0741', 'HR@20': '0.1590', 'NDCG@20': '0.0840'}
2025-02-22 14:59:31,759 - EarlyStopping counter: 1 out of 10
2025-02-22 15:00:05,849 - {'epoch': 15, 'rec_loss': '7.1483'}
2025-02-22 15:00:13,462 - {'Epoch': 15, 'HR@5': '0.0915', 'NDCG@5': '0.0665', 'HR@10': '0.1220', 'NDCG@10': '0.0763', 'HR@20': '0.1616', 'NDCG@20': '0.0863'}
2025-02-22 15:00:13,468 - Validation score increased.  Saving model ...
2025-02-22 15:00:46,675 - {'epoch': 16, 'rec_loss': '7.1203'}
2025-02-22 15:00:55,345 - {'Epoch': 16, 'HR@5': '0.0909', 'NDCG@5': '0.0659', 'HR@10': '0.1222', 'NDCG@10': '0.0760', 'HR@20': '0.1607', 'NDCG@20': '0.0858'}
2025-02-22 15:00:55,351 - EarlyStopping counter: 1 out of 10
2025-02-22 15:01:28,242 - {'epoch': 17, 'rec_loss': '7.0927'}
2025-02-22 15:01:37,309 - {'Epoch': 17, 'HR@5': '0.0926', 'NDCG@5': '0.0669', 'HR@10': '0.1239', 'NDCG@10': '0.0770', 'HR@20': '0.1619', 'NDCG@20': '0.0866'}
2025-02-22 15:01:37,316 - Validation score increased.  Saving model ...
2025-02-22 15:02:10,827 - {'epoch': 18, 'rec_loss': '7.0758'}
2025-02-22 15:02:19,284 - {'Epoch': 18, 'HR@5': '0.0928', 'NDCG@5': '0.0666', 'HR@10': '0.1231', 'NDCG@10': '0.0763', 'HR@20': '0.1618', 'NDCG@20': '0.0861'}
2025-02-22 15:02:19,291 - EarlyStopping counter: 1 out of 10
2025-02-22 15:02:53,443 - {'epoch': 19, 'rec_loss': '7.0609'}
2025-02-22 15:03:01,951 - {'Epoch': 19, 'HR@5': '0.0929', 'NDCG@5': '0.0665', 'HR@10': '0.1248', 'NDCG@10': '0.0767', 'HR@20': '0.1632', 'NDCG@20': '0.0865'}
2025-02-22 15:03:01,958 - EarlyStopping counter: 2 out of 10
2025-02-22 15:03:38,995 - {'epoch': 20, 'rec_loss': '7.0414'}
2025-02-22 15:03:46,785 - {'Epoch': 20, 'HR@5': '0.0926', 'NDCG@5': '0.0666', 'HR@10': '0.1258', 'NDCG@10': '0.0773', 'HR@20': '0.1630', 'NDCG@20': '0.0867'}
2025-02-22 15:03:46,792 - Validation score increased.  Saving model ...
2025-02-22 15:04:24,808 - {'epoch': 21, 'rec_loss': '7.0205'}
2025-02-22 15:04:33,493 - {'Epoch': 21, 'HR@5': '0.0919', 'NDCG@5': '0.0664', 'HR@10': '0.1266', 'NDCG@10': '0.0776', 'HR@20': '0.1648', 'NDCG@20': '0.0872'}
2025-02-22 15:04:33,500 - Validation score increased.  Saving model ...
2025-02-22 15:05:08,003 - {'epoch': 22, 'rec_loss': '7.0070'}
2025-02-22 15:05:16,043 - {'Epoch': 22, 'HR@5': '0.0935', 'NDCG@5': '0.0673', 'HR@10': '0.1258', 'NDCG@10': '0.0777', 'HR@20': '0.1629', 'NDCG@20': '0.0870'}
2025-02-22 15:05:16,051 - EarlyStopping counter: 1 out of 10
2025-02-22 15:05:49,677 - {'epoch': 23, 'rec_loss': '6.9937'}
2025-02-22 15:05:57,319 - {'Epoch': 23, 'HR@5': '0.0944', 'NDCG@5': '0.0678', 'HR@10': '0.1269', 'NDCG@10': '0.0783', 'HR@20': '0.1637', 'NDCG@20': '0.0876'}
2025-02-22 15:05:57,326 - Validation score increased.  Saving model ...
2025-02-22 15:06:31,988 - {'epoch': 24, 'rec_loss': '6.9852'}
2025-02-22 15:06:40,763 - {'Epoch': 24, 'HR@5': '0.0943', 'NDCG@5': '0.0677', 'HR@10': '0.1269', 'NDCG@10': '0.0782', 'HR@20': '0.1642', 'NDCG@20': '0.0876'}
2025-02-22 15:06:40,770 - Validation score increased.  Saving model ...
2025-02-22 15:07:13,744 - {'epoch': 25, 'rec_loss': '6.9693'}
2025-02-22 15:07:22,349 - {'Epoch': 25, 'HR@5': '0.0945', 'NDCG@5': '0.0682', 'HR@10': '0.1279', 'NDCG@10': '0.0789', 'HR@20': '0.1645', 'NDCG@20': '0.0882'}
2025-02-22 15:07:22,356 - Validation score increased.  Saving model ...
2025-02-22 15:07:55,691 - {'epoch': 26, 'rec_loss': '6.9582'}
2025-02-22 15:08:04,309 - {'Epoch': 26, 'HR@5': '0.0937', 'NDCG@5': '0.0679', 'HR@10': '0.1289', 'NDCG@10': '0.0793', 'HR@20': '0.1670', 'NDCG@20': '0.0888'}
2025-02-22 15:08:04,316 - Validation score increased.  Saving model ...
2025-02-22 15:08:40,121 - {'epoch': 27, 'rec_loss': '6.9387'}
2025-02-22 15:08:48,973 - {'Epoch': 27, 'HR@5': '0.0941', 'NDCG@5': '0.0685', 'HR@10': '0.1265', 'NDCG@10': '0.0790', 'HR@20': '0.1657', 'NDCG@20': '0.0889'}
2025-02-22 15:08:48,978 - Validation score increased.  Saving model ...
2025-02-22 15:09:26,113 - {'epoch': 28, 'rec_loss': '6.9317'}
2025-02-22 15:09:33,995 - {'Epoch': 28, 'HR@5': '0.0926', 'NDCG@5': '0.0671', 'HR@10': '0.1269', 'NDCG@10': '0.0782', 'HR@20': '0.1644', 'NDCG@20': '0.0877'}
2025-02-22 15:09:34,002 - EarlyStopping counter: 1 out of 10
2025-02-22 15:10:08,701 - {'epoch': 29, 'rec_loss': '6.9188'}
2025-02-22 15:10:17,552 - {'Epoch': 29, 'HR@5': '0.0946', 'NDCG@5': '0.0679', 'HR@10': '0.1270', 'NDCG@10': '0.0783', 'HR@20': '0.1672', 'NDCG@20': '0.0884'}
2025-02-22 15:10:17,559 - EarlyStopping counter: 2 out of 10
2025-02-22 15:10:51,894 - {'epoch': 30, 'rec_loss': '6.9025'}
2025-02-22 15:11:00,912 - {'Epoch': 30, 'HR@5': '0.0952', 'NDCG@5': '0.0684', 'HR@10': '0.1273', 'NDCG@10': '0.0787', 'HR@20': '0.1672', 'NDCG@20': '0.0887'}
2025-02-22 15:11:00,919 - EarlyStopping counter: 3 out of 10
2025-02-22 15:11:35,926 - {'epoch': 31, 'rec_loss': '6.9042'}
2025-02-22 15:11:44,566 - {'Epoch': 31, 'HR@5': '0.0947', 'NDCG@5': '0.0678', 'HR@10': '0.1280', 'NDCG@10': '0.0785', 'HR@20': '0.1672', 'NDCG@20': '0.0884'}
2025-02-22 15:11:44,573 - EarlyStopping counter: 4 out of 10
2025-02-22 15:12:17,410 - {'epoch': 32, 'rec_loss': '6.8952'}
2025-02-22 15:12:25,949 - {'Epoch': 32, 'HR@5': '0.0939', 'NDCG@5': '0.0680', 'HR@10': '0.1272', 'NDCG@10': '0.0788', 'HR@20': '0.1658', 'NDCG@20': '0.0885'}
2025-02-22 15:12:25,955 - EarlyStopping counter: 5 out of 10
2025-02-22 15:12:59,168 - {'epoch': 33, 'rec_loss': '6.8834'}
2025-02-22 15:13:06,836 - {'Epoch': 33, 'HR@5': '0.0960', 'NDCG@5': '0.0689', 'HR@10': '0.1267', 'NDCG@10': '0.0787', 'HR@20': '0.1655', 'NDCG@20': '0.0885'}
2025-02-22 15:13:06,842 - EarlyStopping counter: 6 out of 10
2025-02-22 15:13:36,267 - {'epoch': 34, 'rec_loss': '6.8773'}
2025-02-22 15:13:44,979 - {'Epoch': 34, 'HR@5': '0.0952', 'NDCG@5': '0.0686', 'HR@10': '0.1270', 'NDCG@10': '0.0788', 'HR@20': '0.1673', 'NDCG@20': '0.0890'}
2025-02-22 15:13:44,986 - Validation score increased.  Saving model ...
2025-02-22 15:14:21,179 - {'epoch': 35, 'rec_loss': '6.8632'}
2025-02-22 15:14:29,464 - {'Epoch': 35, 'HR@5': '0.0946', 'NDCG@5': '0.0687', 'HR@10': '0.1286', 'NDCG@10': '0.0797', 'HR@20': '0.1681', 'NDCG@20': '0.0897'}
2025-02-22 15:14:29,471 - Validation score increased.  Saving model ...
2025-02-22 15:15:06,552 - {'epoch': 36, 'rec_loss': '6.8679'}
2025-02-22 15:15:15,534 - {'Epoch': 36, 'HR@5': '0.0960', 'NDCG@5': '0.0690', 'HR@10': '0.1287', 'NDCG@10': '0.0796', 'HR@20': '0.1686', 'NDCG@20': '0.0896'}
2025-02-22 15:15:15,540 - EarlyStopping counter: 1 out of 10
2025-02-22 15:15:49,664 - {'epoch': 37, 'rec_loss': '6.8539'}
2025-02-22 15:15:58,142 - {'Epoch': 37, 'HR@5': '0.0948', 'NDCG@5': '0.0690', 'HR@10': '0.1292', 'NDCG@10': '0.0800', 'HR@20': '0.1673', 'NDCG@20': '0.0897'}
2025-02-22 15:15:58,143 - EarlyStopping counter: 2 out of 10
2025-02-22 15:16:35,308 - {'epoch': 38, 'rec_loss': '6.8490'}
2025-02-22 15:16:43,944 - {'Epoch': 38, 'HR@5': '0.0953', 'NDCG@5': '0.0686', 'HR@10': '0.1282', 'NDCG@10': '0.0792', 'HR@20': '0.1676', 'NDCG@20': '0.0892'}
2025-02-22 15:16:43,950 - EarlyStopping counter: 3 out of 10
2025-02-22 15:17:17,442 - {'epoch': 39, 'rec_loss': '6.8346'}
2025-02-22 15:17:26,366 - {'Epoch': 39, 'HR@5': '0.0944', 'NDCG@5': '0.0684', 'HR@10': '0.1268', 'NDCG@10': '0.0788', 'HR@20': '0.1662', 'NDCG@20': '0.0888'}
2025-02-22 15:17:26,373 - EarlyStopping counter: 4 out of 10
2025-02-22 15:17:59,343 - {'epoch': 40, 'rec_loss': '6.8278'}
2025-02-22 15:18:07,991 - {'Epoch': 40, 'HR@5': '0.0948', 'NDCG@5': '0.0684', 'HR@10': '0.1291', 'NDCG@10': '0.0795', 'HR@20': '0.1676', 'NDCG@20': '0.0892'}
2025-02-22 15:18:07,998 - EarlyStopping counter: 5 out of 10
2025-02-22 15:18:42,105 - {'epoch': 41, 'rec_loss': '6.8225'}
2025-02-22 15:18:50,778 - {'Epoch': 41, 'HR@5': '0.0956', 'NDCG@5': '0.0696', 'HR@10': '0.1284', 'NDCG@10': '0.0802', 'HR@20': '0.1671', 'NDCG@20': '0.0899'}
2025-02-22 15:18:50,786 - Validation score increased.  Saving model ...
2025-02-22 15:19:25,985 - {'epoch': 42, 'rec_loss': '6.8249'}
2025-02-22 15:19:34,867 - {'Epoch': 42, 'HR@5': '0.0942', 'NDCG@5': '0.0681', 'HR@10': '0.1291', 'NDCG@10': '0.0794', 'HR@20': '0.1671', 'NDCG@20': '0.0889'}
2025-02-22 15:19:34,874 - EarlyStopping counter: 1 out of 10
2025-02-22 15:20:09,359 - {'epoch': 43, 'rec_loss': '6.8122'}
2025-02-22 15:20:17,499 - {'Epoch': 43, 'HR@5': '0.0953', 'NDCG@5': '0.0689', 'HR@10': '0.1278', 'NDCG@10': '0.0793', 'HR@20': '0.1688', 'NDCG@20': '0.0897'}
2025-02-22 15:20:17,506 - EarlyStopping counter: 2 out of 10
2025-02-22 15:20:53,512 - {'epoch': 44, 'rec_loss': '6.8083'}
2025-02-22 15:21:01,131 - {'Epoch': 44, 'HR@5': '0.0932', 'NDCG@5': '0.0675', 'HR@10': '0.1272', 'NDCG@10': '0.0785', 'HR@20': '0.1673', 'NDCG@20': '0.0887'}
2025-02-22 15:21:01,137 - EarlyStopping counter: 3 out of 10
2025-02-22 15:21:35,356 - {'epoch': 45, 'rec_loss': '6.7956'}
2025-02-22 15:21:43,986 - {'Epoch': 45, 'HR@5': '0.0940', 'NDCG@5': '0.0680', 'HR@10': '0.1272', 'NDCG@10': '0.0787', 'HR@20': '0.1668', 'NDCG@20': '0.0887'}
2025-02-22 15:21:43,993 - EarlyStopping counter: 4 out of 10
2025-02-22 15:22:17,416 - {'epoch': 46, 'rec_loss': '6.7922'}
2025-02-22 15:22:26,211 - {'Epoch': 46, 'HR@5': '0.0947', 'NDCG@5': '0.0686', 'HR@10': '0.1268', 'NDCG@10': '0.0789', 'HR@20': '0.1684', 'NDCG@20': '0.0894'}
2025-02-22 15:22:26,218 - EarlyStopping counter: 5 out of 10
2025-02-22 15:23:00,400 - {'epoch': 47, 'rec_loss': '6.7837'}
2025-02-22 15:23:09,208 - {'Epoch': 47, 'HR@5': '0.0934', 'NDCG@5': '0.0681', 'HR@10': '0.1267', 'NDCG@10': '0.0787', 'HR@20': '0.1638', 'NDCG@20': '0.0881'}
2025-02-22 15:23:09,216 - EarlyStopping counter: 6 out of 10
2025-02-22 15:23:44,909 - {'epoch': 48, 'rec_loss': '6.7843'}
2025-02-22 15:23:53,640 - {'Epoch': 48, 'HR@5': '0.0956', 'NDCG@5': '0.0693', 'HR@10': '0.1273', 'NDCG@10': '0.0795', 'HR@20': '0.1667', 'NDCG@20': '0.0894'}
2025-02-22 15:23:53,648 - EarlyStopping counter: 7 out of 10
2025-02-22 15:24:25,059 - {'epoch': 49, 'rec_loss': '6.7770'}
2025-02-22 15:24:33,778 - {'Epoch': 49, 'HR@5': '0.0952', 'NDCG@5': '0.0694', 'HR@10': '0.1265', 'NDCG@10': '0.0794', 'HR@20': '0.1662', 'NDCG@20': '0.0895'}
2025-02-22 15:24:33,785 - EarlyStopping counter: 8 out of 10
2025-02-22 15:25:12,266 - {'epoch': 50, 'rec_loss': '6.7656'}
2025-02-22 15:25:20,761 - {'Epoch': 50, 'HR@5': '0.0943', 'NDCG@5': '0.0686', 'HR@10': '0.1275', 'NDCG@10': '0.0793', 'HR@20': '0.1668', 'NDCG@20': '0.0892'}
2025-02-22 15:25:20,768 - EarlyStopping counter: 9 out of 10
2025-02-22 15:25:55,261 - {'epoch': 51, 'rec_loss': '6.7685'}
2025-02-22 15:26:04,120 - {'Epoch': 51, 'HR@5': '0.0950', 'NDCG@5': '0.0689', 'HR@10': '0.1268', 'NDCG@10': '0.0792', 'HR@20': '0.1680', 'NDCG@20': '0.0897'}
2025-02-22 15:26:04,128 - EarlyStopping counter: 10 out of 10
2025-02-22 15:26:04,128 - Early stopping
2025-02-22 15:26:04,128 - ---------------Test Score---------------
2025-02-22 15:26:13,051 - {'Epoch': 0, 'HR@5': '0.0803', 'NDCG@5': '0.0575', 'HR@10': '0.1083', 'NDCG@10': '0.0665', 'HR@20': '0.1437', 'NDCG@20': '0.0754'}
2025-02-22 15:26:13,057 - Scale_Toys
2025-02-22 15:26:13,057 - {'Epoch': 0, 'HR@5': '0.0803', 'NDCG@5': '0.0575', 'HR@10': '0.1083', 'NDCG@10': '0.0665', 'HR@20': '0.1437', 'NDCG@20': '0.0754'}
2025-02-22 15:31:09,515 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 5], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-02-22 15:31:18,920 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-22 15:31:19,056 - Total Parameters: 916817
2025-02-22 15:31:56,451 - {'epoch': 0, 'rec_loss': '9.0896'}
2025-02-22 15:32:04,872 - {'Epoch': 0, 'HR@5': '0.0049', 'NDCG@5': '0.0033', 'HR@10': '0.0107', 'NDCG@10': '0.0051', 'HR@20': '0.0193', 'NDCG@20': '0.0073'}
2025-02-22 15:32:04,878 - Validation score increased.  Saving model ...
2025-02-22 15:32:41,136 - {'epoch': 1, 'rec_loss': '8.6781'}
2025-02-22 15:32:49,389 - {'Epoch': 1, 'HR@5': '0.0201', 'NDCG@5': '0.0143', 'HR@10': '0.0287', 'NDCG@10': '0.0170', 'HR@20': '0.0433', 'NDCG@20': '0.0206'}
2025-02-22 15:32:49,396 - Validation score increased.  Saving model ...
2025-02-22 15:33:23,104 - {'epoch': 2, 'rec_loss': '8.3675'}
2025-02-22 15:33:31,868 - {'Epoch': 2, 'HR@5': '0.0373', 'NDCG@5': '0.0266', 'HR@10': '0.0527', 'NDCG@10': '0.0315', 'HR@20': '0.0753', 'NDCG@20': '0.0372'}
2025-02-22 15:33:31,874 - Validation score increased.  Saving model ...
2025-02-22 15:34:04,609 - {'epoch': 3, 'rec_loss': '8.0951'}
2025-02-22 15:34:13,104 - {'Epoch': 3, 'HR@5': '0.0506', 'NDCG@5': '0.0358', 'HR@10': '0.0719', 'NDCG@10': '0.0427', 'HR@20': '0.1001', 'NDCG@20': '0.0498'}
2025-02-22 15:34:13,112 - Validation score increased.  Saving model ...
2025-02-22 15:34:44,482 - {'epoch': 4, 'rec_loss': '7.8859'}
2025-02-22 15:34:52,145 - {'Epoch': 4, 'HR@5': '0.0626', 'NDCG@5': '0.0446', 'HR@10': '0.0858', 'NDCG@10': '0.0521', 'HR@20': '0.1162', 'NDCG@20': '0.0598'}
2025-02-22 15:34:52,152 - Validation score increased.  Saving model ...
2025-02-22 15:35:29,122 - {'epoch': 5, 'rec_loss': '7.7228'}
2025-02-22 15:35:36,965 - {'Epoch': 5, 'HR@5': '0.0695', 'NDCG@5': '0.0499', 'HR@10': '0.0971', 'NDCG@10': '0.0587', 'HR@20': '0.1297', 'NDCG@20': '0.0669'}
2025-02-22 15:35:36,971 - Validation score increased.  Saving model ...
2025-02-22 15:36:11,576 - {'epoch': 6, 'rec_loss': '7.6035'}
2025-02-22 15:36:19,288 - {'Epoch': 6, 'HR@5': '0.0737', 'NDCG@5': '0.0536', 'HR@10': '0.1035', 'NDCG@10': '0.0632', 'HR@20': '0.1394', 'NDCG@20': '0.0723'}
2025-02-22 15:36:19,295 - Validation score increased.  Saving model ...
2025-02-22 15:36:53,138 - {'epoch': 7, 'rec_loss': '7.5109'}
2025-02-22 15:37:01,839 - {'Epoch': 7, 'HR@5': '0.0792', 'NDCG@5': '0.0574', 'HR@10': '0.1079', 'NDCG@10': '0.0666', 'HR@20': '0.1425', 'NDCG@20': '0.0753'}
2025-02-22 15:37:01,845 - Validation score increased.  Saving model ...
2025-02-22 15:37:36,838 - {'epoch': 8, 'rec_loss': '7.4292'}
2025-02-22 15:37:45,785 - {'Epoch': 8, 'HR@5': '0.0833', 'NDCG@5': '0.0603', 'HR@10': '0.1113', 'NDCG@10': '0.0693', 'HR@20': '0.1468', 'NDCG@20': '0.0782'}
2025-02-22 15:37:45,791 - Validation score increased.  Saving model ...
2025-02-22 15:38:19,632 - {'epoch': 9, 'rec_loss': '7.3692'}
2025-02-22 15:38:28,464 - {'Epoch': 9, 'HR@5': '0.0829', 'NDCG@5': '0.0601', 'HR@10': '0.1135', 'NDCG@10': '0.0700', 'HR@20': '0.1504', 'NDCG@20': '0.0792'}
2025-02-22 15:38:28,465 - Validation score increased.  Saving model ...
2025-02-22 15:39:04,565 - {'epoch': 10, 'rec_loss': '7.3139'}
2025-02-22 15:39:12,455 - {'Epoch': 10, 'HR@5': '0.0860', 'NDCG@5': '0.0626', 'HR@10': '0.1152', 'NDCG@10': '0.0720', 'HR@20': '0.1520', 'NDCG@20': '0.0813'}
2025-02-22 15:39:12,460 - Validation score increased.  Saving model ...
2025-02-22 15:39:47,266 - {'epoch': 11, 'rec_loss': '7.2679'}
2025-02-22 15:39:56,235 - {'Epoch': 11, 'HR@5': '0.0875', 'NDCG@5': '0.0628', 'HR@10': '0.1168', 'NDCG@10': '0.0722', 'HR@20': '0.1551', 'NDCG@20': '0.0819'}
2025-02-22 15:39:56,242 - Validation score increased.  Saving model ...
2025-02-22 15:40:31,416 - {'epoch': 12, 'rec_loss': '7.2281'}
2025-02-22 15:40:40,483 - {'Epoch': 12, 'HR@5': '0.0876', 'NDCG@5': '0.0633', 'HR@10': '0.1190', 'NDCG@10': '0.0734', 'HR@20': '0.1546', 'NDCG@20': '0.0824'}
2025-02-22 15:40:40,484 - Validation score increased.  Saving model ...
2025-02-22 15:41:15,224 - {'epoch': 13, 'rec_loss': '7.1959'}
2025-02-22 15:41:24,240 - {'Epoch': 13, 'HR@5': '0.0892', 'NDCG@5': '0.0641', 'HR@10': '0.1191', 'NDCG@10': '0.0737', 'HR@20': '0.1574', 'NDCG@20': '0.0834'}
2025-02-22 15:41:24,246 - Validation score increased.  Saving model ...
2025-02-22 15:41:57,889 - {'epoch': 14, 'rec_loss': '7.1706'}
2025-02-22 15:42:06,580 - {'Epoch': 14, 'HR@5': '0.0904', 'NDCG@5': '0.0651', 'HR@10': '0.1203', 'NDCG@10': '0.0747', 'HR@20': '0.1581', 'NDCG@20': '0.0843'}
2025-02-22 15:42:06,587 - Validation score increased.  Saving model ...
2025-02-22 15:42:42,373 - {'epoch': 15, 'rec_loss': '7.1377'}
2025-02-22 15:42:51,320 - {'Epoch': 15, 'HR@5': '0.0907', 'NDCG@5': '0.0657', 'HR@10': '0.1211', 'NDCG@10': '0.0756', 'HR@20': '0.1576', 'NDCG@20': '0.0848'}
2025-02-22 15:42:51,327 - Validation score increased.  Saving model ...
2025-02-22 15:43:25,766 - {'epoch': 16, 'rec_loss': '7.1209'}
2025-02-22 15:43:33,472 - {'Epoch': 16, 'HR@5': '0.0913', 'NDCG@5': '0.0659', 'HR@10': '0.1210', 'NDCG@10': '0.0755', 'HR@20': '0.1579', 'NDCG@20': '0.0848'}
2025-02-22 15:43:33,479 - Validation score increased.  Saving model ...
2025-02-22 15:44:08,079 - {'epoch': 17, 'rec_loss': '7.0898'}
2025-02-22 15:44:16,169 - {'Epoch': 17, 'HR@5': '0.0913', 'NDCG@5': '0.0664', 'HR@10': '0.1236', 'NDCG@10': '0.0768', 'HR@20': '0.1603', 'NDCG@20': '0.0860'}
2025-02-22 15:44:16,176 - Validation score increased.  Saving model ...
2025-02-22 15:44:49,858 - {'epoch': 18, 'rec_loss': '7.0747'}
2025-02-22 15:44:58,104 - {'Epoch': 18, 'HR@5': '0.0925', 'NDCG@5': '0.0668', 'HR@10': '0.1223', 'NDCG@10': '0.0764', 'HR@20': '0.1614', 'NDCG@20': '0.0862'}
2025-02-22 15:44:58,112 - Validation score increased.  Saving model ...
2025-02-22 15:45:34,908 - {'epoch': 19, 'rec_loss': '7.0563'}
2025-02-22 15:45:43,810 - {'Epoch': 19, 'HR@5': '0.0913', 'NDCG@5': '0.0664', 'HR@10': '0.1232', 'NDCG@10': '0.0767', 'HR@20': '0.1628', 'NDCG@20': '0.0867'}
2025-02-22 15:45:43,816 - Validation score increased.  Saving model ...
2025-02-22 15:46:20,846 - {'epoch': 20, 'rec_loss': '7.0356'}
2025-02-22 15:46:28,569 - {'Epoch': 20, 'HR@5': '0.0918', 'NDCG@5': '0.0664', 'HR@10': '0.1239', 'NDCG@10': '0.0768', 'HR@20': '0.1642', 'NDCG@20': '0.0869'}
2025-02-22 15:46:28,576 - Validation score increased.  Saving model ...
2025-02-22 15:47:02,265 - {'epoch': 21, 'rec_loss': '7.0188'}
2025-02-22 15:47:11,244 - {'Epoch': 21, 'HR@5': '0.0906', 'NDCG@5': '0.0659', 'HR@10': '0.1217', 'NDCG@10': '0.0760', 'HR@20': '0.1634', 'NDCG@20': '0.0865'}
2025-02-22 15:47:11,245 - EarlyStopping counter: 1 out of 10
2025-02-22 15:47:44,781 - {'epoch': 22, 'rec_loss': '7.0063'}
2025-02-22 15:47:54,153 - {'Epoch': 22, 'HR@5': '0.0910', 'NDCG@5': '0.0663', 'HR@10': '0.1217', 'NDCG@10': '0.0762', 'HR@20': '0.1629', 'NDCG@20': '0.0866'}
2025-02-22 15:47:54,154 - EarlyStopping counter: 2 out of 10
2025-02-22 15:48:30,771 - {'epoch': 23, 'rec_loss': '6.9954'}
2025-02-22 15:48:39,214 - {'Epoch': 23, 'HR@5': '0.0897', 'NDCG@5': '0.0659', 'HR@10': '0.1222', 'NDCG@10': '0.0764', 'HR@20': '0.1635', 'NDCG@20': '0.0867'}
2025-02-22 15:48:39,220 - EarlyStopping counter: 3 out of 10
2025-02-22 15:49:13,660 - {'epoch': 24, 'rec_loss': '6.9795'}
2025-02-22 15:49:22,798 - {'Epoch': 24, 'HR@5': '0.0912', 'NDCG@5': '0.0669', 'HR@10': '0.1254', 'NDCG@10': '0.0780', 'HR@20': '0.1640', 'NDCG@20': '0.0877'}
2025-02-22 15:49:22,804 - Validation score increased.  Saving model ...
2025-02-22 15:49:56,383 - {'epoch': 25, 'rec_loss': '6.9621'}
2025-02-22 15:50:05,484 - {'Epoch': 25, 'HR@5': '0.0938', 'NDCG@5': '0.0679', 'HR@10': '0.1257', 'NDCG@10': '0.0782', 'HR@20': '0.1658', 'NDCG@20': '0.0883'}
2025-02-22 15:50:05,490 - Validation score increased.  Saving model ...
2025-02-22 15:50:40,905 - {'epoch': 26, 'rec_loss': '6.9572'}
2025-02-22 15:50:49,756 - {'Epoch': 26, 'HR@5': '0.0938', 'NDCG@5': '0.0683', 'HR@10': '0.1263', 'NDCG@10': '0.0788', 'HR@20': '0.1655', 'NDCG@20': '0.0887'}
2025-02-22 15:50:49,762 - Validation score increased.  Saving model ...
2025-02-22 15:51:23,398 - {'epoch': 27, 'rec_loss': '6.9363'}
2025-02-22 15:51:33,023 - {'Epoch': 27, 'HR@5': '0.0930', 'NDCG@5': '0.0675', 'HR@10': '0.1273', 'NDCG@10': '0.0786', 'HR@20': '0.1646', 'NDCG@20': '0.0880'}
2025-02-22 15:51:33,031 - EarlyStopping counter: 1 out of 10
2025-02-22 15:52:08,209 - {'epoch': 28, 'rec_loss': '6.9336'}
2025-02-22 15:52:15,981 - {'Epoch': 28, 'HR@5': '0.0937', 'NDCG@5': '0.0675', 'HR@10': '0.1260', 'NDCG@10': '0.0779', 'HR@20': '0.1662', 'NDCG@20': '0.0880'}
2025-02-22 15:52:15,988 - EarlyStopping counter: 2 out of 10
2025-02-22 15:52:51,503 - {'epoch': 29, 'rec_loss': '6.9170'}
2025-02-22 15:53:00,374 - {'Epoch': 29, 'HR@5': '0.0936', 'NDCG@5': '0.0684', 'HR@10': '0.1252', 'NDCG@10': '0.0786', 'HR@20': '0.1659', 'NDCG@20': '0.0888'}
2025-02-22 15:53:00,380 - Validation score increased.  Saving model ...
2025-02-22 15:53:34,763 - {'epoch': 30, 'rec_loss': '6.9047'}
2025-02-22 15:53:43,573 - {'Epoch': 30, 'HR@5': '0.0927', 'NDCG@5': '0.0677', 'HR@10': '0.1271', 'NDCG@10': '0.0788', 'HR@20': '0.1671', 'NDCG@20': '0.0889'}
2025-02-22 15:53:43,580 - Validation score increased.  Saving model ...
2025-02-22 15:54:17,677 - {'epoch': 31, 'rec_loss': '6.8996'}
2025-02-22 15:54:26,740 - {'Epoch': 31, 'HR@5': '0.0937', 'NDCG@5': '0.0681', 'HR@10': '0.1275', 'NDCG@10': '0.0789', 'HR@20': '0.1664', 'NDCG@20': '0.0887'}
2025-02-22 15:54:26,747 - EarlyStopping counter: 1 out of 10
2025-02-22 15:55:00,596 - {'epoch': 32, 'rec_loss': '6.8952'}
2025-02-22 15:55:09,531 - {'Epoch': 32, 'HR@5': '0.0939', 'NDCG@5': '0.0680', 'HR@10': '0.1274', 'NDCG@10': '0.0788', 'HR@20': '0.1680', 'NDCG@20': '0.0890'}
2025-02-22 15:55:09,533 - Validation score increased.  Saving model ...
2025-02-22 15:55:39,117 - {'epoch': 33, 'rec_loss': '6.8845'}
2025-02-22 15:55:48,225 - {'Epoch': 33, 'HR@5': '0.0939', 'NDCG@5': '0.0677', 'HR@10': '0.1271', 'NDCG@10': '0.0783', 'HR@20': '0.1675', 'NDCG@20': '0.0884'}
2025-02-22 15:55:48,232 - EarlyStopping counter: 1 out of 10
2025-02-22 15:56:25,270 - {'epoch': 34, 'rec_loss': '6.8707'}
2025-02-22 15:56:34,418 - {'Epoch': 34, 'HR@5': '0.0935', 'NDCG@5': '0.0680', 'HR@10': '0.1269', 'NDCG@10': '0.0788', 'HR@20': '0.1670', 'NDCG@20': '0.0889'}
2025-02-22 15:56:34,419 - EarlyStopping counter: 2 out of 10
2025-02-22 15:57:09,895 - {'epoch': 35, 'rec_loss': '6.8670'}
2025-02-22 15:57:18,233 - {'Epoch': 35, 'HR@5': '0.0926', 'NDCG@5': '0.0674', 'HR@10': '0.1266', 'NDCG@10': '0.0783', 'HR@20': '0.1654', 'NDCG@20': '0.0880'}
2025-02-22 15:57:18,239 - EarlyStopping counter: 3 out of 10
2025-02-22 15:57:51,926 - {'epoch': 36, 'rec_loss': '6.8656'}
2025-02-22 15:58:00,939 - {'Epoch': 36, 'HR@5': '0.0936', 'NDCG@5': '0.0679', 'HR@10': '0.1273', 'NDCG@10': '0.0788', 'HR@20': '0.1665', 'NDCG@20': '0.0887'}
2025-02-22 15:58:00,945 - EarlyStopping counter: 4 out of 10
2025-02-22 15:58:36,191 - {'epoch': 37, 'rec_loss': '6.8543'}
2025-02-22 15:58:44,043 - {'Epoch': 37, 'HR@5': '0.0940', 'NDCG@5': '0.0682', 'HR@10': '0.1297', 'NDCG@10': '0.0798', 'HR@20': '0.1690', 'NDCG@20': '0.0897'}
2025-02-22 15:58:44,049 - Validation score increased.  Saving model ...
2025-02-22 15:59:19,743 - {'epoch': 38, 'rec_loss': '6.8490'}
2025-02-22 15:59:28,788 - {'Epoch': 38, 'HR@5': '0.0938', 'NDCG@5': '0.0685', 'HR@10': '0.1281', 'NDCG@10': '0.0795', 'HR@20': '0.1681', 'NDCG@20': '0.0896'}
2025-02-22 15:59:28,794 - EarlyStopping counter: 1 out of 10
2025-02-22 16:00:02,139 - {'epoch': 39, 'rec_loss': '6.8326'}
2025-02-22 16:00:11,095 - {'Epoch': 39, 'HR@5': '0.0935', 'NDCG@5': '0.0672', 'HR@10': '0.1278', 'NDCG@10': '0.0782', 'HR@20': '0.1662', 'NDCG@20': '0.0879'}
2025-02-22 16:00:11,101 - EarlyStopping counter: 2 out of 10
2025-02-22 16:00:45,696 - {'epoch': 40, 'rec_loss': '6.8301'}
2025-02-22 16:00:54,718 - {'Epoch': 40, 'HR@5': '0.0941', 'NDCG@5': '0.0682', 'HR@10': '0.1273', 'NDCG@10': '0.0789', 'HR@20': '0.1688', 'NDCG@20': '0.0893'}
2025-02-22 16:00:54,725 - EarlyStopping counter: 3 out of 10
2025-02-22 16:01:29,537 - {'epoch': 41, 'rec_loss': '6.8242'}
2025-02-22 16:01:38,518 - {'Epoch': 41, 'HR@5': '0.0950', 'NDCG@5': '0.0688', 'HR@10': '0.1269', 'NDCG@10': '0.0791', 'HR@20': '0.1675', 'NDCG@20': '0.0894'}
2025-02-22 16:01:38,525 - EarlyStopping counter: 4 out of 10
2025-02-22 16:02:11,740 - {'epoch': 42, 'rec_loss': '6.8190'}
2025-02-22 16:02:19,593 - {'Epoch': 42, 'HR@5': '0.0959', 'NDCG@5': '0.0680', 'HR@10': '0.1298', 'NDCG@10': '0.0789', 'HR@20': '0.1675', 'NDCG@20': '0.0885'}
2025-02-22 16:02:19,600 - EarlyStopping counter: 5 out of 10
2025-02-22 16:02:54,564 - {'epoch': 43, 'rec_loss': '6.8106'}
2025-02-22 16:03:03,504 - {'Epoch': 43, 'HR@5': '0.0953', 'NDCG@5': '0.0685', 'HR@10': '0.1287', 'NDCG@10': '0.0793', 'HR@20': '0.1689', 'NDCG@20': '0.0894'}
2025-02-22 16:03:03,511 - EarlyStopping counter: 6 out of 10
2025-02-22 16:03:38,510 - {'epoch': 44, 'rec_loss': '6.8099'}
2025-02-22 16:03:46,465 - {'Epoch': 44, 'HR@5': '0.0934', 'NDCG@5': '0.0677', 'HR@10': '0.1278', 'NDCG@10': '0.0788', 'HR@20': '0.1668', 'NDCG@20': '0.0887'}
2025-02-22 16:03:46,470 - EarlyStopping counter: 7 out of 10
2025-02-22 16:04:21,037 - {'epoch': 45, 'rec_loss': '6.7975'}
2025-02-22 16:04:28,885 - {'Epoch': 45, 'HR@5': '0.0942', 'NDCG@5': '0.0685', 'HR@10': '0.1291', 'NDCG@10': '0.0797', 'HR@20': '0.1691', 'NDCG@20': '0.0898'}
2025-02-22 16:04:28,892 - Validation score increased.  Saving model ...
2025-02-22 16:05:02,919 - {'epoch': 46, 'rec_loss': '6.7899'}
2025-02-22 16:05:12,011 - {'Epoch': 46, 'HR@5': '0.0943', 'NDCG@5': '0.0685', 'HR@10': '0.1273', 'NDCG@10': '0.0791', 'HR@20': '0.1676', 'NDCG@20': '0.0893'}
2025-02-22 16:05:12,018 - EarlyStopping counter: 1 out of 10
2025-02-22 16:05:44,571 - {'epoch': 47, 'rec_loss': '6.7809'}
2025-02-22 16:05:52,292 - {'Epoch': 47, 'HR@5': '0.0946', 'NDCG@5': '0.0686', 'HR@10': '0.1284', 'NDCG@10': '0.0794', 'HR@20': '0.1678', 'NDCG@20': '0.0894'}
2025-02-22 16:05:52,300 - EarlyStopping counter: 2 out of 10
2025-02-22 16:06:28,415 - {'epoch': 48, 'rec_loss': '6.7821'}
2025-02-22 16:06:36,862 - {'Epoch': 48, 'HR@5': '0.0937', 'NDCG@5': '0.0677', 'HR@10': '0.1270', 'NDCG@10': '0.0784', 'HR@20': '0.1677', 'NDCG@20': '0.0887'}
2025-02-22 16:06:36,868 - EarlyStopping counter: 3 out of 10
2025-02-22 16:07:12,955 - {'epoch': 49, 'rec_loss': '6.7801'}
2025-02-22 16:07:22,026 - {'Epoch': 49, 'HR@5': '0.0953', 'NDCG@5': '0.0694', 'HR@10': '0.1275', 'NDCG@10': '0.0797', 'HR@20': '0.1676', 'NDCG@20': '0.0898'}
2025-02-22 16:07:22,032 - Validation score increased.  Saving model ...
2025-02-22 16:07:54,939 - {'epoch': 50, 'rec_loss': '6.7751'}
2025-02-22 16:08:03,199 - {'Epoch': 50, 'HR@5': '0.0937', 'NDCG@5': '0.0688', 'HR@10': '0.1283', 'NDCG@10': '0.0799', 'HR@20': '0.1686', 'NDCG@20': '0.0901'}
2025-02-22 16:08:03,207 - Validation score increased.  Saving model ...
2025-02-22 16:08:36,412 - {'epoch': 51, 'rec_loss': '6.7701'}
2025-02-22 16:08:45,382 - {'Epoch': 51, 'HR@5': '0.0935', 'NDCG@5': '0.0684', 'HR@10': '0.1269', 'NDCG@10': '0.0791', 'HR@20': '0.1661', 'NDCG@20': '0.0891'}
2025-02-22 16:08:45,390 - EarlyStopping counter: 1 out of 10
2025-02-22 16:09:19,430 - {'epoch': 52, 'rec_loss': '6.7610'}
2025-02-22 16:09:27,204 - {'Epoch': 52, 'HR@5': '0.0943', 'NDCG@5': '0.0692', 'HR@10': '0.1273', 'NDCG@10': '0.0798', 'HR@20': '0.1673', 'NDCG@20': '0.0899'}
2025-02-22 16:09:27,211 - EarlyStopping counter: 2 out of 10
2025-02-22 16:10:02,606 - {'epoch': 53, 'rec_loss': '6.7605'}
2025-02-22 16:10:10,680 - {'Epoch': 53, 'HR@5': '0.0936', 'NDCG@5': '0.0684', 'HR@10': '0.1275', 'NDCG@10': '0.0793', 'HR@20': '0.1671', 'NDCG@20': '0.0893'}
2025-02-22 16:10:10,687 - EarlyStopping counter: 3 out of 10
2025-02-22 16:10:45,173 - {'epoch': 54, 'rec_loss': '6.7516'}
2025-02-22 16:10:52,836 - {'Epoch': 54, 'HR@5': '0.0949', 'NDCG@5': '0.0695', 'HR@10': '0.1286', 'NDCG@10': '0.0803', 'HR@20': '0.1666', 'NDCG@20': '0.0899'}
2025-02-22 16:10:52,844 - EarlyStopping counter: 4 out of 10
2025-02-22 16:11:27,660 - {'epoch': 55, 'rec_loss': '6.7480'}
2025-02-22 16:11:36,776 - {'Epoch': 55, 'HR@5': '0.0963', 'NDCG@5': '0.0695', 'HR@10': '0.1287', 'NDCG@10': '0.0800', 'HR@20': '0.1671', 'NDCG@20': '0.0896'}
2025-02-22 16:11:36,782 - EarlyStopping counter: 5 out of 10
2025-02-22 16:12:10,707 - {'epoch': 56, 'rec_loss': '6.7534'}
2025-02-22 16:12:19,696 - {'Epoch': 56, 'HR@5': '0.0951', 'NDCG@5': '0.0691', 'HR@10': '0.1284', 'NDCG@10': '0.0798', 'HR@20': '0.1671', 'NDCG@20': '0.0895'}
2025-02-22 16:12:19,703 - EarlyStopping counter: 6 out of 10
2025-02-22 16:12:54,172 - {'epoch': 57, 'rec_loss': '6.7402'}
2025-02-22 16:13:01,948 - {'Epoch': 57, 'HR@5': '0.0959', 'NDCG@5': '0.0692', 'HR@10': '0.1294', 'NDCG@10': '0.0799', 'HR@20': '0.1675', 'NDCG@20': '0.0895'}
2025-02-22 16:13:01,954 - EarlyStopping counter: 7 out of 10
2025-02-22 16:13:35,528 - {'epoch': 58, 'rec_loss': '6.7425'}
2025-02-22 16:13:45,102 - {'Epoch': 58, 'HR@5': '0.0954', 'NDCG@5': '0.0693', 'HR@10': '0.1290', 'NDCG@10': '0.0802', 'HR@20': '0.1690', 'NDCG@20': '0.0902'}
2025-02-22 16:13:45,110 - Validation score increased.  Saving model ...
2025-02-22 16:14:21,221 - {'epoch': 59, 'rec_loss': '6.7347'}
2025-02-22 16:14:29,114 - {'Epoch': 59, 'HR@5': '0.0947', 'NDCG@5': '0.0691', 'HR@10': '0.1282', 'NDCG@10': '0.0798', 'HR@20': '0.1685', 'NDCG@20': '0.0900'}
2025-02-22 16:14:29,121 - EarlyStopping counter: 1 out of 10
2025-02-22 16:15:05,275 - {'epoch': 60, 'rec_loss': '6.7282'}
2025-02-22 16:15:13,900 - {'Epoch': 60, 'HR@5': '0.0936', 'NDCG@5': '0.0681', 'HR@10': '0.1282', 'NDCG@10': '0.0793', 'HR@20': '0.1671', 'NDCG@20': '0.0891'}
2025-02-22 16:15:13,907 - EarlyStopping counter: 2 out of 10
2025-02-22 16:15:47,733 - {'epoch': 61, 'rec_loss': '6.7204'}
2025-02-22 16:15:56,669 - {'Epoch': 61, 'HR@5': '0.0948', 'NDCG@5': '0.0691', 'HR@10': '0.1288', 'NDCG@10': '0.0800', 'HR@20': '0.1685', 'NDCG@20': '0.0900'}
2025-02-22 16:15:56,676 - EarlyStopping counter: 3 out of 10
2025-02-22 16:16:24,488 - {'epoch': 62, 'rec_loss': '6.7196'}
2025-02-22 16:16:32,587 - {'Epoch': 62, 'HR@5': '0.0939', 'NDCG@5': '0.0684', 'HR@10': '0.1273', 'NDCG@10': '0.0792', 'HR@20': '0.1668', 'NDCG@20': '0.0891'}
2025-02-22 16:16:32,595 - EarlyStopping counter: 4 out of 10
2025-02-22 16:17:09,457 - {'epoch': 63, 'rec_loss': '6.7119'}
2025-02-22 16:17:18,228 - {'Epoch': 63, 'HR@5': '0.0948', 'NDCG@5': '0.0690', 'HR@10': '0.1286', 'NDCG@10': '0.0799', 'HR@20': '0.1680', 'NDCG@20': '0.0899'}
2025-02-22 16:17:18,235 - EarlyStopping counter: 5 out of 10
2025-02-22 16:17:53,819 - {'epoch': 64, 'rec_loss': '6.7160'}
2025-02-22 16:18:02,414 - {'Epoch': 64, 'HR@5': '0.0943', 'NDCG@5': '0.0688', 'HR@10': '0.1291', 'NDCG@10': '0.0801', 'HR@20': '0.1676', 'NDCG@20': '0.0898'}
2025-02-22 16:18:02,420 - EarlyStopping counter: 6 out of 10
2025-02-22 16:18:36,583 - {'epoch': 65, 'rec_loss': '6.7112'}
2025-02-22 16:18:44,698 - {'Epoch': 65, 'HR@5': '0.0950', 'NDCG@5': '0.0689', 'HR@10': '0.1284', 'NDCG@10': '0.0796', 'HR@20': '0.1675', 'NDCG@20': '0.0895'}
2025-02-22 16:18:44,705 - EarlyStopping counter: 7 out of 10
2025-02-22 16:19:18,550 - {'epoch': 66, 'rec_loss': '6.7008'}
2025-02-22 16:19:26,902 - {'Epoch': 66, 'HR@5': '0.0936', 'NDCG@5': '0.0682', 'HR@10': '0.1263', 'NDCG@10': '0.0788', 'HR@20': '0.1675', 'NDCG@20': '0.0892'}
2025-02-22 16:19:26,910 - EarlyStopping counter: 8 out of 10
2025-02-22 16:19:59,999 - {'epoch': 67, 'rec_loss': '6.6994'}
2025-02-22 16:20:07,831 - {'Epoch': 67, 'HR@5': '0.0950', 'NDCG@5': '0.0692', 'HR@10': '0.1281', 'NDCG@10': '0.0799', 'HR@20': '0.1680', 'NDCG@20': '0.0899'}
2025-02-22 16:20:07,841 - EarlyStopping counter: 9 out of 10
2025-02-22 16:20:42,360 - {'epoch': 68, 'rec_loss': '6.7046'}
2025-02-22 16:20:51,500 - {'Epoch': 68, 'HR@5': '0.0957', 'NDCG@5': '0.0696', 'HR@10': '0.1279', 'NDCG@10': '0.0799', 'HR@20': '0.1674', 'NDCG@20': '0.0899'}
2025-02-22 16:20:51,507 - EarlyStopping counter: 10 out of 10
2025-02-22 16:20:51,508 - Early stopping
2025-02-22 16:20:51,508 - ---------------Test Score---------------
2025-02-22 16:21:00,240 - {'Epoch': 0, 'HR@5': '0.0772', 'NDCG@5': '0.0563', 'HR@10': '0.1055', 'NDCG@10': '0.0655', 'HR@20': '0.1404', 'NDCG@20': '0.0743'}
2025-02-22 16:21:00,246 - Scale_Toys
2025-02-22 16:21:00,246 - {'Epoch': 0, 'HR@5': '0.0772', 'NDCG@5': '0.0563', 'HR@10': '0.1055', 'NDCG@10': '0.0655', 'HR@20': '0.1404', 'NDCG@20': '0.0743'}
2025-02-22 16:25:53,796 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[10, 5], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-02-22 16:26:03,181 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-22 16:26:03,316 - Total Parameters: 916817
2025-02-22 16:26:36,611 - {'epoch': 0, 'rec_loss': '9.0815'}
2025-02-22 16:26:45,231 - {'Epoch': 0, 'HR@5': '0.0062', 'NDCG@5': '0.0036', 'HR@10': '0.0114', 'NDCG@10': '0.0052', 'HR@20': '0.0192', 'NDCG@20': '0.0072'}
2025-02-22 16:26:45,236 - Validation score increased.  Saving model ...
2025-02-22 16:27:22,040 - {'epoch': 1, 'rec_loss': '8.6801'}
2025-02-22 16:27:31,117 - {'Epoch': 1, 'HR@5': '0.0197', 'NDCG@5': '0.0141', 'HR@10': '0.0297', 'NDCG@10': '0.0173', 'HR@20': '0.0434', 'NDCG@20': '0.0208'}
2025-02-22 16:27:31,122 - Validation score increased.  Saving model ...
2025-02-22 16:28:09,224 - {'epoch': 2, 'rec_loss': '8.3806'}
2025-02-22 16:28:18,577 - {'Epoch': 2, 'HR@5': '0.0348', 'NDCG@5': '0.0246', 'HR@10': '0.0505', 'NDCG@10': '0.0297', 'HR@20': '0.0734', 'NDCG@20': '0.0355'}
2025-02-22 16:28:18,582 - Validation score increased.  Saving model ...
2025-02-22 16:28:56,654 - {'epoch': 3, 'rec_loss': '8.1114'}
2025-02-22 16:29:05,560 - {'Epoch': 3, 'HR@5': '0.0499', 'NDCG@5': '0.0357', 'HR@10': '0.0691', 'NDCG@10': '0.0419', 'HR@20': '0.0955', 'NDCG@20': '0.0485'}
2025-02-22 16:29:05,564 - Validation score increased.  Saving model ...
2025-02-22 16:29:40,583 - {'epoch': 4, 'rec_loss': '7.8934'}
2025-02-22 16:29:49,765 - {'Epoch': 4, 'HR@5': '0.0626', 'NDCG@5': '0.0441', 'HR@10': '0.0872', 'NDCG@10': '0.0520', 'HR@20': '0.1191', 'NDCG@20': '0.0600'}
2025-02-22 16:29:49,771 - Validation score increased.  Saving model ...
2025-02-22 16:30:22,999 - {'epoch': 5, 'rec_loss': '7.7261'}
2025-02-22 16:30:32,064 - {'Epoch': 5, 'HR@5': '0.0706', 'NDCG@5': '0.0503', 'HR@10': '0.0963', 'NDCG@10': '0.0586', 'HR@20': '0.1299', 'NDCG@20': '0.0671'}
2025-02-22 16:30:32,069 - Validation score increased.  Saving model ...
2025-02-22 16:31:05,151 - {'epoch': 6, 'rec_loss': '7.6044'}
2025-02-22 16:31:13,285 - {'Epoch': 6, 'HR@5': '0.0755', 'NDCG@5': '0.0536', 'HR@10': '0.1029', 'NDCG@10': '0.0624', 'HR@20': '0.1368', 'NDCG@20': '0.0709'}
2025-02-22 16:31:13,292 - Validation score increased.  Saving model ...
2025-02-22 16:31:48,042 - {'epoch': 7, 'rec_loss': '7.5111'}
2025-02-22 16:31:55,899 - {'Epoch': 7, 'HR@5': '0.0797', 'NDCG@5': '0.0573', 'HR@10': '0.1081', 'NDCG@10': '0.0664', 'HR@20': '0.1443', 'NDCG@20': '0.0755'}
2025-02-22 16:31:55,904 - Validation score increased.  Saving model ...
2025-02-22 16:32:29,218 - {'epoch': 8, 'rec_loss': '7.4327'}
2025-02-22 16:32:37,595 - {'Epoch': 8, 'HR@5': '0.0833', 'NDCG@5': '0.0597', 'HR@10': '0.1118', 'NDCG@10': '0.0689', 'HR@20': '0.1473', 'NDCG@20': '0.0778'}
2025-02-22 16:32:37,601 - Validation score increased.  Saving model ...
2025-02-22 16:33:13,949 - {'epoch': 9, 'rec_loss': '7.3590'}
2025-02-22 16:33:22,819 - {'Epoch': 9, 'HR@5': '0.0843', 'NDCG@5': '0.0611', 'HR@10': '0.1142', 'NDCG@10': '0.0707', 'HR@20': '0.1509', 'NDCG@20': '0.0800'}
2025-02-22 16:33:22,824 - Validation score increased.  Saving model ...
2025-02-22 16:33:57,353 - {'epoch': 10, 'rec_loss': '7.3178'}
2025-02-22 16:34:05,339 - {'Epoch': 10, 'HR@5': '0.0870', 'NDCG@5': '0.0621', 'HR@10': '0.1148', 'NDCG@10': '0.0711', 'HR@20': '0.1538', 'NDCG@20': '0.0809'}
2025-02-22 16:34:05,344 - Validation score increased.  Saving model ...
2025-02-22 16:34:39,820 - {'epoch': 11, 'rec_loss': '7.2656'}
2025-02-22 16:34:48,967 - {'Epoch': 11, 'HR@5': '0.0877', 'NDCG@5': '0.0632', 'HR@10': '0.1161', 'NDCG@10': '0.0723', 'HR@20': '0.1556', 'NDCG@20': '0.0823'}
2025-02-22 16:34:48,973 - Validation score increased.  Saving model ...
2025-02-22 16:35:23,605 - {'epoch': 12, 'rec_loss': '7.2240'}
2025-02-22 16:35:32,680 - {'Epoch': 12, 'HR@5': '0.0882', 'NDCG@5': '0.0633', 'HR@10': '0.1182', 'NDCG@10': '0.0729', 'HR@20': '0.1545', 'NDCG@20': '0.0821'}
2025-02-22 16:35:32,685 - EarlyStopping counter: 1 out of 10
2025-02-22 16:36:07,180 - {'epoch': 13, 'rec_loss': '7.1992'}
2025-02-22 16:36:16,322 - {'Epoch': 13, 'HR@5': '0.0879', 'NDCG@5': '0.0640', 'HR@10': '0.1168', 'NDCG@10': '0.0733', 'HR@20': '0.1564', 'NDCG@20': '0.0833'}
2025-02-22 16:36:16,328 - Validation score increased.  Saving model ...
2025-02-22 16:36:51,845 - {'epoch': 14, 'rec_loss': '7.1708'}
2025-02-22 16:36:59,804 - {'Epoch': 14, 'HR@5': '0.0885', 'NDCG@5': '0.0639', 'HR@10': '0.1189', 'NDCG@10': '0.0737', 'HR@20': '0.1577', 'NDCG@20': '0.0835'}
2025-02-22 16:36:59,810 - Validation score increased.  Saving model ...
2025-02-22 16:37:38,481 - {'epoch': 15, 'rec_loss': '7.1393'}
2025-02-22 16:37:47,973 - {'Epoch': 15, 'HR@5': '0.0888', 'NDCG@5': '0.0648', 'HR@10': '0.1202', 'NDCG@10': '0.0748', 'HR@20': '0.1576', 'NDCG@20': '0.0843'}
2025-02-22 16:37:47,978 - Validation score increased.  Saving model ...
2025-02-22 16:38:24,939 - {'epoch': 16, 'rec_loss': '7.1211'}
2025-02-22 16:38:32,862 - {'Epoch': 16, 'HR@5': '0.0903', 'NDCG@5': '0.0651', 'HR@10': '0.1198', 'NDCG@10': '0.0746', 'HR@20': '0.1595', 'NDCG@20': '0.0846'}
2025-02-22 16:38:32,867 - Validation score increased.  Saving model ...
2025-02-22 16:39:07,656 - {'epoch': 17, 'rec_loss': '7.0911'}
2025-02-22 16:39:16,528 - {'Epoch': 17, 'HR@5': '0.0907', 'NDCG@5': '0.0656', 'HR@10': '0.1210', 'NDCG@10': '0.0753', 'HR@20': '0.1609', 'NDCG@20': '0.0854'}
2025-02-22 16:39:16,534 - Validation score increased.  Saving model ...
2025-02-22 16:39:51,113 - {'epoch': 18, 'rec_loss': '7.0799'}
2025-02-22 16:40:00,149 - {'Epoch': 18, 'HR@5': '0.0909', 'NDCG@5': '0.0658', 'HR@10': '0.1217', 'NDCG@10': '0.0757', 'HR@20': '0.1605', 'NDCG@20': '0.0855'}
2025-02-22 16:40:00,155 - Validation score increased.  Saving model ...
2025-02-22 16:40:33,774 - {'epoch': 19, 'rec_loss': '7.0578'}
2025-02-22 16:40:41,659 - {'Epoch': 19, 'HR@5': '0.0897', 'NDCG@5': '0.0648', 'HR@10': '0.1234', 'NDCG@10': '0.0757', 'HR@20': '0.1626', 'NDCG@20': '0.0855'}
2025-02-22 16:40:41,663 - EarlyStopping counter: 1 out of 10
2025-02-22 16:41:15,735 - {'epoch': 20, 'rec_loss': '7.0442'}
2025-02-22 16:41:25,078 - {'Epoch': 20, 'HR@5': '0.0899', 'NDCG@5': '0.0652', 'HR@10': '0.1237', 'NDCG@10': '0.0761', 'HR@20': '0.1615', 'NDCG@20': '0.0856'}
2025-02-22 16:41:25,084 - Validation score increased.  Saving model ...
2025-02-22 16:41:59,650 - {'epoch': 21, 'rec_loss': '7.0181'}
2025-02-22 16:42:08,056 - {'Epoch': 21, 'HR@5': '0.0924', 'NDCG@5': '0.0664', 'HR@10': '0.1222', 'NDCG@10': '0.0760', 'HR@20': '0.1622', 'NDCG@20': '0.0860'}
2025-02-22 16:42:08,060 - Validation score increased.  Saving model ...
2025-02-22 16:42:43,374 - {'epoch': 22, 'rec_loss': '7.0081'}
2025-02-22 16:42:51,855 - {'Epoch': 22, 'HR@5': '0.0928', 'NDCG@5': '0.0668', 'HR@10': '0.1228', 'NDCG@10': '0.0765', 'HR@20': '0.1624', 'NDCG@20': '0.0864'}
2025-02-22 16:42:51,859 - Validation score increased.  Saving model ...
2025-02-22 16:43:25,794 - {'epoch': 23, 'rec_loss': '6.9924'}
2025-02-22 16:43:35,026 - {'Epoch': 23, 'HR@5': '0.0919', 'NDCG@5': '0.0661', 'HR@10': '0.1228', 'NDCG@10': '0.0761', 'HR@20': '0.1641', 'NDCG@20': '0.0865'}
2025-02-22 16:43:35,031 - Validation score increased.  Saving model ...
2025-02-22 16:44:07,941 - {'epoch': 24, 'rec_loss': '6.9840'}
2025-02-22 16:44:16,855 - {'Epoch': 24, 'HR@5': '0.0922', 'NDCG@5': '0.0660', 'HR@10': '0.1243', 'NDCG@10': '0.0763', 'HR@20': '0.1644', 'NDCG@20': '0.0864'}
2025-02-22 16:44:16,862 - EarlyStopping counter: 1 out of 10
2025-02-22 16:44:50,568 - {'epoch': 25, 'rec_loss': '6.9658'}
2025-02-22 16:44:58,238 - {'Epoch': 25, 'HR@5': '0.0933', 'NDCG@5': '0.0672', 'HR@10': '0.1250', 'NDCG@10': '0.0774', 'HR@20': '0.1655', 'NDCG@20': '0.0875'}
2025-02-22 16:44:58,243 - Validation score increased.  Saving model ...
2025-02-22 16:45:32,685 - {'epoch': 26, 'rec_loss': '6.9548'}
2025-02-22 16:45:41,762 - {'Epoch': 26, 'HR@5': '0.0919', 'NDCG@5': '0.0667', 'HR@10': '0.1237', 'NDCG@10': '0.0769', 'HR@20': '0.1630', 'NDCG@20': '0.0868'}
2025-02-22 16:45:41,768 - EarlyStopping counter: 1 out of 10
2025-02-22 16:46:14,618 - {'epoch': 27, 'rec_loss': '6.9449'}
2025-02-22 16:46:22,434 - {'Epoch': 27, 'HR@5': '0.0925', 'NDCG@5': '0.0667', 'HR@10': '0.1245', 'NDCG@10': '0.0770', 'HR@20': '0.1630', 'NDCG@20': '0.0867'}
2025-02-22 16:46:22,439 - EarlyStopping counter: 2 out of 10
2025-02-22 16:46:54,967 - {'epoch': 28, 'rec_loss': '6.9332'}
2025-02-22 16:47:04,266 - {'Epoch': 28, 'HR@5': '0.0916', 'NDCG@5': '0.0666', 'HR@10': '0.1244', 'NDCG@10': '0.0772', 'HR@20': '0.1673', 'NDCG@20': '0.0880'}
2025-02-22 16:47:04,273 - Validation score increased.  Saving model ...
2025-02-22 16:47:33,765 - {'epoch': 29, 'rec_loss': '6.9178'}
2025-02-22 16:47:42,171 - {'Epoch': 29, 'HR@5': '0.0920', 'NDCG@5': '0.0661', 'HR@10': '0.1242', 'NDCG@10': '0.0765', 'HR@20': '0.1640', 'NDCG@20': '0.0866'}
2025-02-22 16:47:42,178 - EarlyStopping counter: 1 out of 10
2025-02-22 16:48:18,692 - {'epoch': 30, 'rec_loss': '6.9104'}
2025-02-22 16:48:26,454 - {'Epoch': 30, 'HR@5': '0.0926', 'NDCG@5': '0.0676', 'HR@10': '0.1255', 'NDCG@10': '0.0782', 'HR@20': '0.1662', 'NDCG@20': '0.0885'}
2025-02-22 16:48:26,460 - Validation score increased.  Saving model ...
2025-02-22 16:49:02,373 - {'epoch': 31, 'rec_loss': '6.9019'}
2025-02-22 16:49:11,818 - {'Epoch': 31, 'HR@5': '0.0924', 'NDCG@5': '0.0667', 'HR@10': '0.1254', 'NDCG@10': '0.0773', 'HR@20': '0.1640', 'NDCG@20': '0.0870'}
2025-02-22 16:49:11,824 - EarlyStopping counter: 1 out of 10
2025-02-22 16:49:47,677 - {'epoch': 32, 'rec_loss': '6.8961'}
2025-02-22 16:49:56,840 - {'Epoch': 32, 'HR@5': '0.0939', 'NDCG@5': '0.0681', 'HR@10': '0.1262', 'NDCG@10': '0.0785', 'HR@20': '0.1651', 'NDCG@20': '0.0883'}
2025-02-22 16:49:56,848 - EarlyStopping counter: 2 out of 10
2025-02-22 16:50:32,588 - {'epoch': 33, 'rec_loss': '6.8878'}
2025-02-22 16:50:41,928 - {'Epoch': 33, 'HR@5': '0.0927', 'NDCG@5': '0.0672', 'HR@10': '0.1249', 'NDCG@10': '0.0776', 'HR@20': '0.1666', 'NDCG@20': '0.0881'}
2025-02-22 16:50:41,933 - EarlyStopping counter: 3 out of 10
2025-02-22 16:51:14,870 - {'epoch': 34, 'rec_loss': '6.8762'}
2025-02-22 16:51:22,703 - {'Epoch': 34, 'HR@5': '0.0932', 'NDCG@5': '0.0676', 'HR@10': '0.1259', 'NDCG@10': '0.0782', 'HR@20': '0.1653', 'NDCG@20': '0.0881'}
2025-02-22 16:51:22,708 - EarlyStopping counter: 4 out of 10
2025-02-22 16:51:55,793 - {'epoch': 35, 'rec_loss': '6.8658'}
2025-02-22 16:52:04,917 - {'Epoch': 35, 'HR@5': '0.0934', 'NDCG@5': '0.0671', 'HR@10': '0.1255', 'NDCG@10': '0.0775', 'HR@20': '0.1647', 'NDCG@20': '0.0874'}
2025-02-22 16:52:04,924 - EarlyStopping counter: 5 out of 10
2025-02-22 16:52:39,724 - {'epoch': 36, 'rec_loss': '6.8650'}
2025-02-22 16:52:48,588 - {'Epoch': 36, 'HR@5': '0.0929', 'NDCG@5': '0.0675', 'HR@10': '0.1258', 'NDCG@10': '0.0781', 'HR@20': '0.1675', 'NDCG@20': '0.0886'}
2025-02-22 16:52:48,593 - Validation score increased.  Saving model ...
2025-02-22 16:53:21,506 - {'epoch': 37, 'rec_loss': '6.8536'}
2025-02-22 16:53:30,699 - {'Epoch': 37, 'HR@5': '0.0930', 'NDCG@5': '0.0673', 'HR@10': '0.1256', 'NDCG@10': '0.0779', 'HR@20': '0.1652', 'NDCG@20': '0.0878'}
2025-02-22 16:53:30,707 - EarlyStopping counter: 1 out of 10
2025-02-22 16:54:05,553 - {'epoch': 38, 'rec_loss': '6.8462'}
2025-02-22 16:54:14,761 - {'Epoch': 38, 'HR@5': '0.0941', 'NDCG@5': '0.0676', 'HR@10': '0.1265', 'NDCG@10': '0.0781', 'HR@20': '0.1653', 'NDCG@20': '0.0879'}
2025-02-22 16:54:14,768 - EarlyStopping counter: 2 out of 10
2025-02-22 16:54:49,214 - {'epoch': 39, 'rec_loss': '6.8365'}
2025-02-22 16:54:57,067 - {'Epoch': 39, 'HR@5': '0.0942', 'NDCG@5': '0.0676', 'HR@10': '0.1263', 'NDCG@10': '0.0780', 'HR@20': '0.1667', 'NDCG@20': '0.0881'}
2025-02-22 16:54:57,071 - EarlyStopping counter: 3 out of 10
2025-02-22 16:55:31,158 - {'epoch': 40, 'rec_loss': '6.8320'}
2025-02-22 16:55:40,102 - {'Epoch': 40, 'HR@5': '0.0947', 'NDCG@5': '0.0684', 'HR@10': '0.1266', 'NDCG@10': '0.0787', 'HR@20': '0.1670', 'NDCG@20': '0.0889'}
2025-02-22 16:55:40,107 - Validation score increased.  Saving model ...
2025-02-22 16:56:13,080 - {'epoch': 41, 'rec_loss': '6.8243'}
2025-02-22 16:56:20,922 - {'Epoch': 41, 'HR@5': '0.0945', 'NDCG@5': '0.0685', 'HR@10': '0.1262', 'NDCG@10': '0.0788', 'HR@20': '0.1671', 'NDCG@20': '0.0891'}
2025-02-22 16:56:20,927 - Validation score increased.  Saving model ...
2025-02-22 16:56:54,601 - {'epoch': 42, 'rec_loss': '6.8154'}
2025-02-22 16:57:02,599 - {'Epoch': 42, 'HR@5': '0.0956', 'NDCG@5': '0.0683', 'HR@10': '0.1251', 'NDCG@10': '0.0778', 'HR@20': '0.1650', 'NDCG@20': '0.0879'}
2025-02-22 16:57:02,607 - EarlyStopping counter: 1 out of 10
2025-02-22 16:57:37,680 - {'epoch': 43, 'rec_loss': '6.8183'}
2025-02-22 16:57:46,754 - {'Epoch': 43, 'HR@5': '0.0954', 'NDCG@5': '0.0688', 'HR@10': '0.1273', 'NDCG@10': '0.0790', 'HR@20': '0.1676', 'NDCG@20': '0.0892'}
2025-02-22 16:57:46,761 - Validation score increased.  Saving model ...
2025-02-22 16:58:14,383 - {'epoch': 44, 'rec_loss': '6.8058'}
2025-02-22 16:58:23,735 - {'Epoch': 44, 'HR@5': '0.0949', 'NDCG@5': '0.0691', 'HR@10': '0.1258', 'NDCG@10': '0.0790', 'HR@20': '0.1666', 'NDCG@20': '0.0893'}
2025-02-22 16:58:23,740 - Validation score increased.  Saving model ...
2025-02-22 16:59:00,533 - {'epoch': 45, 'rec_loss': '6.7993'}
2025-02-22 16:59:09,683 - {'Epoch': 45, 'HR@5': '0.0961', 'NDCG@5': '0.0699', 'HR@10': '0.1263', 'NDCG@10': '0.0796', 'HR@20': '0.1675', 'NDCG@20': '0.0900'}
2025-02-22 16:59:09,689 - Validation score increased.  Saving model ...
2025-02-22 16:59:45,265 - {'epoch': 46, 'rec_loss': '6.7916'}
2025-02-22 16:59:54,109 - {'Epoch': 46, 'HR@5': '0.0964', 'NDCG@5': '0.0698', 'HR@10': '0.1271', 'NDCG@10': '0.0797', 'HR@20': '0.1664', 'NDCG@20': '0.0896'}
2025-02-22 16:59:54,116 - EarlyStopping counter: 1 out of 10
2025-02-22 17:00:29,755 - {'epoch': 47, 'rec_loss': '6.7842'}
2025-02-22 17:00:38,772 - {'Epoch': 47, 'HR@5': '0.0943', 'NDCG@5': '0.0682', 'HR@10': '0.1268', 'NDCG@10': '0.0787', 'HR@20': '0.1671', 'NDCG@20': '0.0889'}
2025-02-22 17:00:38,777 - EarlyStopping counter: 2 out of 10
2025-02-22 17:01:14,926 - {'epoch': 48, 'rec_loss': '6.7867'}
2025-02-22 17:01:23,799 - {'Epoch': 48, 'HR@5': '0.0932', 'NDCG@5': '0.0679', 'HR@10': '0.1280', 'NDCG@10': '0.0791', 'HR@20': '0.1661', 'NDCG@20': '0.0887'}
2025-02-22 17:01:23,806 - EarlyStopping counter: 3 out of 10
2025-02-22 17:01:57,843 - {'epoch': 49, 'rec_loss': '6.7775'}
2025-02-22 17:02:05,704 - {'Epoch': 49, 'HR@5': '0.0942', 'NDCG@5': '0.0678', 'HR@10': '0.1260', 'NDCG@10': '0.0780', 'HR@20': '0.1663', 'NDCG@20': '0.0881'}
2025-02-22 17:02:05,710 - EarlyStopping counter: 4 out of 10
2025-02-22 17:02:40,089 - {'epoch': 50, 'rec_loss': '6.7738'}
2025-02-22 17:02:47,883 - {'Epoch': 50, 'HR@5': '0.0955', 'NDCG@5': '0.0696', 'HR@10': '0.1267', 'NDCG@10': '0.0796', 'HR@20': '0.1676', 'NDCG@20': '0.0899'}
2025-02-22 17:02:47,889 - EarlyStopping counter: 5 out of 10
2025-02-22 17:03:21,457 - {'epoch': 51, 'rec_loss': '6.7702'}
2025-02-22 17:03:30,400 - {'Epoch': 51, 'HR@5': '0.0942', 'NDCG@5': '0.0680', 'HR@10': '0.1246', 'NDCG@10': '0.0777', 'HR@20': '0.1652', 'NDCG@20': '0.0880'}
2025-02-22 17:03:30,407 - EarlyStopping counter: 6 out of 10
2025-02-22 17:04:03,742 - {'epoch': 52, 'rec_loss': '6.7674'}
2025-02-22 17:04:12,778 - {'Epoch': 52, 'HR@5': '0.0951', 'NDCG@5': '0.0689', 'HR@10': '0.1257', 'NDCG@10': '0.0787', 'HR@20': '0.1646', 'NDCG@20': '0.0885'}
2025-02-22 17:04:12,783 - EarlyStopping counter: 7 out of 10
2025-02-22 17:04:48,061 - {'epoch': 53, 'rec_loss': '6.7601'}
2025-02-22 17:04:55,933 - {'Epoch': 53, 'HR@5': '0.0944', 'NDCG@5': '0.0679', 'HR@10': '0.1266', 'NDCG@10': '0.0782', 'HR@20': '0.1673', 'NDCG@20': '0.0884'}
2025-02-22 17:04:55,938 - EarlyStopping counter: 8 out of 10
2025-02-22 17:05:29,050 - {'epoch': 54, 'rec_loss': '6.7471'}
2025-02-22 17:05:38,165 - {'Epoch': 54, 'HR@5': '0.0939', 'NDCG@5': '0.0681', 'HR@10': '0.1256', 'NDCG@10': '0.0783', 'HR@20': '0.1670', 'NDCG@20': '0.0887'}
2025-02-22 17:05:38,172 - EarlyStopping counter: 9 out of 10
2025-02-22 17:06:13,746 - {'epoch': 55, 'rec_loss': '6.7439'}
2025-02-22 17:06:22,542 - {'Epoch': 55, 'HR@5': '0.0946', 'NDCG@5': '0.0685', 'HR@10': '0.1260', 'NDCG@10': '0.0786', 'HR@20': '0.1668', 'NDCG@20': '0.0888'}
2025-02-22 17:06:22,547 - EarlyStopping counter: 10 out of 10
2025-02-22 17:06:22,548 - Early stopping
2025-02-22 17:06:22,548 - ---------------Test Score---------------
2025-02-22 17:06:30,599 - {'Epoch': 0, 'HR@5': '0.0797', 'NDCG@5': '0.0577', 'HR@10': '0.1068', 'NDCG@10': '0.0665', 'HR@20': '0.1419', 'NDCG@20': '0.0753'}
2025-02-22 17:06:30,605 - Scale_Toys
2025-02-22 17:06:30,605 - {'Epoch': 0, 'HR@5': '0.0797', 'NDCG@5': '0.0577', 'HR@10': '0.1068', 'NDCG@10': '0.0665', 'HR@20': '0.1419', 'NDCG@20': '0.0753'}
2025-02-22 18:23:27,004 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[10, 5], kernels=[4, 8, 12], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-02-22 18:23:33,431 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-22 18:23:33,567 - Total Parameters: 916817
2025-02-22 18:24:11,364 - {'epoch': 0, 'rec_loss': '9.0894'}
2025-02-22 18:24:19,311 - {'Epoch': 0, 'HR@5': '0.0062', 'NDCG@5': '0.0037', 'HR@10': '0.0124', 'NDCG@10': '0.0057', 'HR@20': '0.0192', 'NDCG@20': '0.0074'}
2025-02-22 18:24:19,315 - Validation score increased.  Saving model ...
2025-02-22 18:24:53,047 - {'epoch': 1, 'rec_loss': '8.7121'}
2025-02-22 18:25:01,831 - {'Epoch': 1, 'HR@5': '0.0179', 'NDCG@5': '0.0131', 'HR@10': '0.0274', 'NDCG@10': '0.0161', 'HR@20': '0.0412', 'NDCG@20': '0.0196'}
2025-02-22 18:25:01,836 - Validation score increased.  Saving model ...
2025-02-22 18:25:35,088 - {'epoch': 2, 'rec_loss': '8.4378'}
2025-02-22 18:25:44,499 - {'Epoch': 2, 'HR@5': '0.0311', 'NDCG@5': '0.0217', 'HR@10': '0.0445', 'NDCG@10': '0.0260', 'HR@20': '0.0665', 'NDCG@20': '0.0315'}
2025-02-22 18:25:44,504 - Validation score increased.  Saving model ...
2025-02-22 18:26:17,821 - {'epoch': 3, 'rec_loss': '8.1878'}
2025-02-22 18:26:27,596 - {'Epoch': 3, 'HR@5': '0.0441', 'NDCG@5': '0.0318', 'HR@10': '0.0619', 'NDCG@10': '0.0375', 'HR@20': '0.0876', 'NDCG@20': '0.0440'}
2025-02-22 18:26:27,600 - Validation score increased.  Saving model ...
2025-02-22 18:27:01,604 - {'epoch': 4, 'rec_loss': '7.9759'}
2025-02-22 18:27:10,630 - {'Epoch': 4, 'HR@5': '0.0573', 'NDCG@5': '0.0406', 'HR@10': '0.0806', 'NDCG@10': '0.0481', 'HR@20': '0.1121', 'NDCG@20': '0.0560'}
2025-02-22 18:27:10,636 - Validation score increased.  Saving model ...
2025-02-22 18:27:44,001 - {'epoch': 5, 'rec_loss': '7.8105'}
2025-02-22 18:27:52,726 - {'Epoch': 5, 'HR@5': '0.0662', 'NDCG@5': '0.0473', 'HR@10': '0.0932', 'NDCG@10': '0.0560', 'HR@20': '0.1238', 'NDCG@20': '0.0637'}
2025-02-22 18:27:52,732 - Validation score increased.  Saving model ...
2025-02-22 18:28:27,410 - {'epoch': 6, 'rec_loss': '7.6863'}
2025-02-22 18:28:35,817 - {'Epoch': 6, 'HR@5': '0.0732', 'NDCG@5': '0.0520', 'HR@10': '0.0993', 'NDCG@10': '0.0605', 'HR@20': '0.1320', 'NDCG@20': '0.0687'}
2025-02-22 18:28:35,822 - Validation score increased.  Saving model ...
2025-02-22 18:29:10,615 - {'epoch': 7, 'rec_loss': '7.5943'}
2025-02-22 18:29:18,562 - {'Epoch': 7, 'HR@5': '0.0766', 'NDCG@5': '0.0551', 'HR@10': '0.1050', 'NDCG@10': '0.0643', 'HR@20': '0.1394', 'NDCG@20': '0.0729'}
2025-02-22 18:29:18,566 - Validation score increased.  Saving model ...
2025-02-22 18:29:52,932 - {'epoch': 8, 'rec_loss': '7.5115'}
2025-02-22 18:30:02,727 - {'Epoch': 8, 'HR@5': '0.0804', 'NDCG@5': '0.0575', 'HR@10': '0.1087', 'NDCG@10': '0.0666', 'HR@20': '0.1432', 'NDCG@20': '0.0753'}
2025-02-22 18:30:02,733 - Validation score increased.  Saving model ...
2025-02-22 18:30:35,889 - {'epoch': 9, 'rec_loss': '7.4389'}
2025-02-22 18:30:43,808 - {'Epoch': 9, 'HR@5': '0.0827', 'NDCG@5': '0.0597', 'HR@10': '0.1109', 'NDCG@10': '0.0688', 'HR@20': '0.1475', 'NDCG@20': '0.0780'}
2025-02-22 18:30:43,813 - Validation score increased.  Saving model ...
2025-02-22 18:31:19,017 - {'epoch': 10, 'rec_loss': '7.3963'}
2025-02-22 18:31:28,680 - {'Epoch': 10, 'HR@5': '0.0856', 'NDCG@5': '0.0614', 'HR@10': '0.1130', 'NDCG@10': '0.0703', 'HR@20': '0.1509', 'NDCG@20': '0.0798'}
2025-02-22 18:31:28,685 - Validation score increased.  Saving model ...
2025-02-22 18:31:57,310 - {'epoch': 11, 'rec_loss': '7.3474'}
2025-02-22 18:32:05,340 - {'Epoch': 11, 'HR@5': '0.0856', 'NDCG@5': '0.0617', 'HR@10': '0.1161', 'NDCG@10': '0.0715', 'HR@20': '0.1531', 'NDCG@20': '0.0808'}
2025-02-22 18:32:05,346 - Validation score increased.  Saving model ...
2025-02-22 18:32:41,489 - {'epoch': 12, 'rec_loss': '7.3034'}
2025-02-22 18:32:50,742 - {'Epoch': 12, 'HR@5': '0.0869', 'NDCG@5': '0.0628', 'HR@10': '0.1163', 'NDCG@10': '0.0723', 'HR@20': '0.1536', 'NDCG@20': '0.0817'}
2025-02-22 18:32:50,748 - Validation score increased.  Saving model ...
2025-02-22 18:33:28,546 - {'epoch': 13, 'rec_loss': '7.2755'}
2025-02-22 18:33:37,982 - {'Epoch': 13, 'HR@5': '0.0869', 'NDCG@5': '0.0631', 'HR@10': '0.1170', 'NDCG@10': '0.0728', 'HR@20': '0.1554', 'NDCG@20': '0.0824'}
2025-02-22 18:33:37,987 - Validation score increased.  Saving model ...
2025-02-22 18:34:14,883 - {'epoch': 14, 'rec_loss': '7.2485'}
2025-02-22 18:34:23,307 - {'Epoch': 14, 'HR@5': '0.0892', 'NDCG@5': '0.0642', 'HR@10': '0.1188', 'NDCG@10': '0.0736', 'HR@20': '0.1569', 'NDCG@20': '0.0832'}
2025-02-22 18:34:23,313 - Validation score increased.  Saving model ...
2025-02-22 18:34:58,128 - {'epoch': 15, 'rec_loss': '7.2175'}
2025-02-22 18:35:06,278 - {'Epoch': 15, 'HR@5': '0.0886', 'NDCG@5': '0.0642', 'HR@10': '0.1188', 'NDCG@10': '0.0739', 'HR@20': '0.1579', 'NDCG@20': '0.0838'}
2025-02-22 18:35:06,284 - Validation score increased.  Saving model ...
2025-02-22 18:35:40,930 - {'epoch': 16, 'rec_loss': '7.1976'}
2025-02-22 18:35:50,085 - {'Epoch': 16, 'HR@5': '0.0884', 'NDCG@5': '0.0640', 'HR@10': '0.1204', 'NDCG@10': '0.0744', 'HR@20': '0.1596', 'NDCG@20': '0.0842'}
2025-02-22 18:35:50,090 - Validation score increased.  Saving model ...
2025-02-22 18:36:23,235 - {'epoch': 17, 'rec_loss': '7.1665'}
2025-02-22 18:36:31,130 - {'Epoch': 17, 'HR@5': '0.0897', 'NDCG@5': '0.0649', 'HR@10': '0.1204', 'NDCG@10': '0.0748', 'HR@20': '0.1604', 'NDCG@20': '0.0849'}
2025-02-22 18:36:31,135 - Validation score increased.  Saving model ...
2025-02-22 18:37:04,527 - {'epoch': 18, 'rec_loss': '7.1548'}
2025-02-22 18:37:12,621 - {'Epoch': 18, 'HR@5': '0.0907', 'NDCG@5': '0.0656', 'HR@10': '0.1213', 'NDCG@10': '0.0754', 'HR@20': '0.1594', 'NDCG@20': '0.0851'}
2025-02-22 18:37:12,628 - Validation score increased.  Saving model ...
2025-02-22 18:37:45,615 - {'epoch': 19, 'rec_loss': '7.1367'}
2025-02-22 18:37:54,772 - {'Epoch': 19, 'HR@5': '0.0902', 'NDCG@5': '0.0653', 'HR@10': '0.1230', 'NDCG@10': '0.0759', 'HR@20': '0.1605', 'NDCG@20': '0.0853'}
2025-02-22 18:37:54,779 - Validation score increased.  Saving model ...
2025-02-22 18:38:29,535 - {'epoch': 20, 'rec_loss': '7.1210'}
2025-02-22 18:38:38,794 - {'Epoch': 20, 'HR@5': '0.0903', 'NDCG@5': '0.0648', 'HR@10': '0.1231', 'NDCG@10': '0.0753', 'HR@20': '0.1620', 'NDCG@20': '0.0851'}
2025-02-22 18:38:38,802 - EarlyStopping counter: 1 out of 10
2025-02-22 18:39:14,504 - {'epoch': 21, 'rec_loss': '7.0974'}
2025-02-22 18:39:22,482 - {'Epoch': 21, 'HR@5': '0.0914', 'NDCG@5': '0.0661', 'HR@10': '0.1222', 'NDCG@10': '0.0760', 'HR@20': '0.1626', 'NDCG@20': '0.0861'}
2025-02-22 18:39:22,487 - Validation score increased.  Saving model ...
2025-02-22 18:39:57,555 - {'epoch': 22, 'rec_loss': '7.0858'}
2025-02-22 18:40:06,633 - {'Epoch': 22, 'HR@5': '0.0920', 'NDCG@5': '0.0665', 'HR@10': '0.1229', 'NDCG@10': '0.0765', 'HR@20': '0.1621', 'NDCG@20': '0.0864'}
2025-02-22 18:40:06,638 - Validation score increased.  Saving model ...
2025-02-22 18:40:41,542 - {'epoch': 23, 'rec_loss': '7.0728'}
2025-02-22 18:40:50,723 - {'Epoch': 23, 'HR@5': '0.0916', 'NDCG@5': '0.0665', 'HR@10': '0.1220', 'NDCG@10': '0.0763', 'HR@20': '0.1642', 'NDCG@20': '0.0868'}
2025-02-22 18:40:50,728 - Validation score increased.  Saving model ...
2025-02-22 18:41:23,934 - {'epoch': 24, 'rec_loss': '7.0652'}
2025-02-22 18:41:31,870 - {'Epoch': 24, 'HR@5': '0.0914', 'NDCG@5': '0.0657', 'HR@10': '0.1240', 'NDCG@10': '0.0761', 'HR@20': '0.1636', 'NDCG@20': '0.0861'}
2025-02-22 18:41:31,876 - EarlyStopping counter: 1 out of 10
2025-02-22 18:42:03,058 - {'epoch': 25, 'rec_loss': '7.0447'}
2025-02-22 18:42:10,720 - {'Epoch': 25, 'HR@5': '0.0935', 'NDCG@5': '0.0669', 'HR@10': '0.1238', 'NDCG@10': '0.0766', 'HR@20': '0.1649', 'NDCG@20': '0.0870'}
2025-02-22 18:42:10,727 - Validation score increased.  Saving model ...
2025-02-22 18:42:48,300 - {'epoch': 26, 'rec_loss': '7.0337'}
2025-02-22 18:42:57,120 - {'Epoch': 26, 'HR@5': '0.0920', 'NDCG@5': '0.0665', 'HR@10': '0.1237', 'NDCG@10': '0.0767', 'HR@20': '0.1638', 'NDCG@20': '0.0867'}
2025-02-22 18:42:57,127 - EarlyStopping counter: 1 out of 10
2025-02-22 18:43:33,608 - {'epoch': 27, 'rec_loss': '7.0232'}
2025-02-22 18:43:41,714 - {'Epoch': 27, 'HR@5': '0.0932', 'NDCG@5': '0.0667', 'HR@10': '0.1241', 'NDCG@10': '0.0767', 'HR@20': '0.1635', 'NDCG@20': '0.0866'}
2025-02-22 18:43:41,720 - EarlyStopping counter: 2 out of 10
2025-02-22 18:44:15,133 - {'epoch': 28, 'rec_loss': '7.0179'}
2025-02-22 18:44:23,108 - {'Epoch': 28, 'HR@5': '0.0926', 'NDCG@5': '0.0668', 'HR@10': '0.1240', 'NDCG@10': '0.0769', 'HR@20': '0.1669', 'NDCG@20': '0.0877'}
2025-02-22 18:44:23,116 - Validation score increased.  Saving model ...
2025-02-22 18:44:57,670 - {'epoch': 29, 'rec_loss': '6.9975'}
2025-02-22 18:45:05,863 - {'Epoch': 29, 'HR@5': '0.0923', 'NDCG@5': '0.0662', 'HR@10': '0.1238', 'NDCG@10': '0.0764', 'HR@20': '0.1647', 'NDCG@20': '0.0867'}
2025-02-22 18:45:05,869 - EarlyStopping counter: 1 out of 10
2025-02-22 18:45:41,362 - {'epoch': 30, 'rec_loss': '6.9936'}
2025-02-22 18:45:49,355 - {'Epoch': 30, 'HR@5': '0.0928', 'NDCG@5': '0.0674', 'HR@10': '0.1253', 'NDCG@10': '0.0778', 'HR@20': '0.1663', 'NDCG@20': '0.0882'}
2025-02-22 18:45:49,362 - Validation score increased.  Saving model ...
2025-02-22 18:46:25,307 - {'epoch': 31, 'rec_loss': '6.9858'}
2025-02-22 18:46:34,600 - {'Epoch': 31, 'HR@5': '0.0924', 'NDCG@5': '0.0668', 'HR@10': '0.1250', 'NDCG@10': '0.0772', 'HR@20': '0.1652', 'NDCG@20': '0.0874'}
2025-02-22 18:46:34,605 - EarlyStopping counter: 1 out of 10
2025-02-22 18:47:08,993 - {'epoch': 32, 'rec_loss': '6.9790'}
2025-02-22 18:47:18,495 - {'Epoch': 32, 'HR@5': '0.0924', 'NDCG@5': '0.0671', 'HR@10': '0.1256', 'NDCG@10': '0.0778', 'HR@20': '0.1661', 'NDCG@20': '0.0880'}
2025-02-22 18:47:18,500 - EarlyStopping counter: 2 out of 10
2025-02-22 18:47:53,244 - {'epoch': 33, 'rec_loss': '6.9712'}
2025-02-22 18:48:02,757 - {'Epoch': 33, 'HR@5': '0.0929', 'NDCG@5': '0.0669', 'HR@10': '0.1249', 'NDCG@10': '0.0772', 'HR@20': '0.1678', 'NDCG@20': '0.0881'}
2025-02-22 18:48:02,763 - EarlyStopping counter: 3 out of 10
2025-02-22 18:48:38,072 - {'epoch': 34, 'rec_loss': '6.9613'}
2025-02-22 18:48:46,561 - {'Epoch': 34, 'HR@5': '0.0941', 'NDCG@5': '0.0676', 'HR@10': '0.1258', 'NDCG@10': '0.0778', 'HR@20': '0.1664', 'NDCG@20': '0.0880'}
2025-02-22 18:48:46,568 - EarlyStopping counter: 4 out of 10
2025-02-22 18:49:21,340 - {'epoch': 35, 'rec_loss': '6.9490'}
2025-02-22 18:49:30,133 - {'Epoch': 35, 'HR@5': '0.0930', 'NDCG@5': '0.0669', 'HR@10': '0.1247', 'NDCG@10': '0.0772', 'HR@20': '0.1670', 'NDCG@20': '0.0878'}
2025-02-22 18:49:30,138 - EarlyStopping counter: 5 out of 10
2025-02-22 18:50:04,912 - {'epoch': 36, 'rec_loss': '6.9527'}
2025-02-22 18:50:14,260 - {'Epoch': 36, 'HR@5': '0.0942', 'NDCG@5': '0.0680', 'HR@10': '0.1250', 'NDCG@10': '0.0779', 'HR@20': '0.1685', 'NDCG@20': '0.0888'}
2025-02-22 18:50:14,265 - Validation score increased.  Saving model ...
2025-02-22 18:50:47,485 - {'epoch': 37, 'rec_loss': '6.9415'}
2025-02-22 18:50:55,555 - {'Epoch': 37, 'HR@5': '0.0926', 'NDCG@5': '0.0673', 'HR@10': '0.1260', 'NDCG@10': '0.0781', 'HR@20': '0.1652', 'NDCG@20': '0.0879'}
2025-02-22 18:50:55,562 - EarlyStopping counter: 1 out of 10
2025-02-22 18:51:28,663 - {'epoch': 38, 'rec_loss': '6.9355'}
2025-02-22 18:51:36,637 - {'Epoch': 38, 'HR@5': '0.0942', 'NDCG@5': '0.0678', 'HR@10': '0.1264', 'NDCG@10': '0.0782', 'HR@20': '0.1671', 'NDCG@20': '0.0884'}
2025-02-22 18:51:36,642 - EarlyStopping counter: 2 out of 10
2025-02-22 18:52:10,492 - {'epoch': 39, 'rec_loss': '6.9239'}
2025-02-22 18:52:19,432 - {'Epoch': 39, 'HR@5': '0.0941', 'NDCG@5': '0.0677', 'HR@10': '0.1262', 'NDCG@10': '0.0780', 'HR@20': '0.1677', 'NDCG@20': '0.0885'}
2025-02-22 18:52:19,438 - EarlyStopping counter: 3 out of 10
2025-02-22 18:52:47,478 - {'epoch': 40, 'rec_loss': '6.9167'}
2025-02-22 18:52:56,452 - {'Epoch': 40, 'HR@5': '0.0943', 'NDCG@5': '0.0685', 'HR@10': '0.1269', 'NDCG@10': '0.0790', 'HR@20': '0.1675', 'NDCG@20': '0.0893'}
2025-02-22 18:52:56,457 - Validation score increased.  Saving model ...
2025-02-22 18:53:35,650 - {'epoch': 41, 'rec_loss': '6.9051'}
2025-02-22 18:53:45,038 - {'Epoch': 41, 'HR@5': '0.0944', 'NDCG@5': '0.0684', 'HR@10': '0.1270', 'NDCG@10': '0.0789', 'HR@20': '0.1684', 'NDCG@20': '0.0893'}
2025-02-22 18:53:45,043 - Validation score increased.  Saving model ...
2025-02-22 18:54:19,995 - {'epoch': 42, 'rec_loss': '6.9007'}
2025-02-22 18:54:29,224 - {'Epoch': 42, 'HR@5': '0.0941', 'NDCG@5': '0.0678', 'HR@10': '0.1267', 'NDCG@10': '0.0783', 'HR@20': '0.1656', 'NDCG@20': '0.0881'}
2025-02-22 18:54:29,232 - EarlyStopping counter: 1 out of 10
2025-02-22 18:55:02,242 - {'epoch': 43, 'rec_loss': '6.9023'}
2025-02-22 18:55:11,005 - {'Epoch': 43, 'HR@5': '0.0944', 'NDCG@5': '0.0681', 'HR@10': '0.1281', 'NDCG@10': '0.0790', 'HR@20': '0.1691', 'NDCG@20': '0.0894'}
2025-02-22 18:55:11,012 - Validation score increased.  Saving model ...
2025-02-22 18:55:45,746 - {'epoch': 44, 'rec_loss': '6.8945'}
2025-02-22 18:55:53,966 - {'Epoch': 44, 'HR@5': '0.0952', 'NDCG@5': '0.0682', 'HR@10': '0.1269', 'NDCG@10': '0.0784', 'HR@20': '0.1689', 'NDCG@20': '0.0890'}
2025-02-22 18:55:53,970 - EarlyStopping counter: 1 out of 10
2025-02-22 18:56:28,793 - {'epoch': 45, 'rec_loss': '6.8877'}
2025-02-22 18:56:36,814 - {'Epoch': 45, 'HR@5': '0.0951', 'NDCG@5': '0.0691', 'HR@10': '0.1275', 'NDCG@10': '0.0795', 'HR@20': '0.1682', 'NDCG@20': '0.0898'}
2025-02-22 18:56:36,819 - Validation score increased.  Saving model ...
2025-02-22 18:57:11,757 - {'epoch': 46, 'rec_loss': '6.8838'}
2025-02-22 18:57:19,991 - {'Epoch': 46, 'HR@5': '0.0960', 'NDCG@5': '0.0694', 'HR@10': '0.1270', 'NDCG@10': '0.0794', 'HR@20': '0.1661', 'NDCG@20': '0.0893'}
2025-02-22 18:57:19,998 - EarlyStopping counter: 1 out of 10
2025-02-22 18:57:53,734 - {'epoch': 47, 'rec_loss': '6.8720'}
2025-02-22 18:58:02,416 - {'Epoch': 47, 'HR@5': '0.0947', 'NDCG@5': '0.0683', 'HR@10': '0.1271', 'NDCG@10': '0.0787', 'HR@20': '0.1674', 'NDCG@20': '0.0889'}
2025-02-22 18:58:02,421 - EarlyStopping counter: 2 out of 10
2025-02-22 18:58:35,787 - {'epoch': 48, 'rec_loss': '6.8766'}
2025-02-22 18:58:45,071 - {'Epoch': 48, 'HR@5': '0.0939', 'NDCG@5': '0.0678', 'HR@10': '0.1273', 'NDCG@10': '0.0786', 'HR@20': '0.1660', 'NDCG@20': '0.0883'}
2025-02-22 18:58:45,078 - EarlyStopping counter: 3 out of 10
2025-02-22 18:59:19,849 - {'epoch': 49, 'rec_loss': '6.8666'}
2025-02-22 18:59:29,150 - {'Epoch': 49, 'HR@5': '0.0936', 'NDCG@5': '0.0678', 'HR@10': '0.1251', 'NDCG@10': '0.0780', 'HR@20': '0.1679', 'NDCG@20': '0.0888'}
2025-02-22 18:59:29,157 - EarlyStopping counter: 4 out of 10
2025-02-22 19:00:02,618 - {'epoch': 50, 'rec_loss': '6.8653'}
2025-02-22 19:00:11,216 - {'Epoch': 50, 'HR@5': '0.0946', 'NDCG@5': '0.0689', 'HR@10': '0.1272', 'NDCG@10': '0.0795', 'HR@20': '0.1692', 'NDCG@20': '0.0900'}
2025-02-22 19:00:11,223 - Validation score increased.  Saving model ...
2025-02-22 19:00:46,115 - {'epoch': 51, 'rec_loss': '6.8622'}
2025-02-22 19:00:54,115 - {'Epoch': 51, 'HR@5': '0.0936', 'NDCG@5': '0.0677', 'HR@10': '0.1266', 'NDCG@10': '0.0783', 'HR@20': '0.1685', 'NDCG@20': '0.0888'}
2025-02-22 19:00:54,122 - EarlyStopping counter: 1 out of 10
2025-02-22 19:01:29,681 - {'epoch': 52, 'rec_loss': '6.8616'}
2025-02-22 19:01:38,572 - {'Epoch': 52, 'HR@5': '0.0941', 'NDCG@5': '0.0680', 'HR@10': '0.1261', 'NDCG@10': '0.0782', 'HR@20': '0.1679', 'NDCG@20': '0.0888'}
2025-02-22 19:01:38,577 - EarlyStopping counter: 2 out of 10
2025-02-22 19:02:12,773 - {'epoch': 53, 'rec_loss': '6.8504'}
2025-02-22 19:02:21,432 - {'Epoch': 53, 'HR@5': '0.0943', 'NDCG@5': '0.0679', 'HR@10': '0.1264', 'NDCG@10': '0.0782', 'HR@20': '0.1693', 'NDCG@20': '0.0890'}
2025-02-22 19:02:21,437 - EarlyStopping counter: 3 out of 10
2025-02-22 19:02:53,614 - {'epoch': 54, 'rec_loss': '6.8379'}
2025-02-22 19:03:01,796 - {'Epoch': 54, 'HR@5': '0.0937', 'NDCG@5': '0.0673', 'HR@10': '0.1279', 'NDCG@10': '0.0783', 'HR@20': '0.1690', 'NDCG@20': '0.0886'}
2025-02-22 19:03:01,801 - EarlyStopping counter: 4 out of 10
2025-02-22 19:03:37,958 - {'epoch': 55, 'rec_loss': '6.8362'}
2025-02-22 19:03:45,885 - {'Epoch': 55, 'HR@5': '0.0939', 'NDCG@5': '0.0682', 'HR@10': '0.1271', 'NDCG@10': '0.0790', 'HR@20': '0.1685', 'NDCG@20': '0.0894'}
2025-02-22 19:03:45,890 - EarlyStopping counter: 5 out of 10
2025-02-22 19:04:22,429 - {'epoch': 56, 'rec_loss': '6.8419'}
2025-02-22 19:04:31,977 - {'Epoch': 56, 'HR@5': '0.0936', 'NDCG@5': '0.0680', 'HR@10': '0.1274', 'NDCG@10': '0.0789', 'HR@20': '0.1698', 'NDCG@20': '0.0895'}
2025-02-22 19:04:31,983 - EarlyStopping counter: 6 out of 10
2025-02-22 19:05:05,366 - {'epoch': 57, 'rec_loss': '6.8322'}
2025-02-22 19:05:13,914 - {'Epoch': 57, 'HR@5': '0.0945', 'NDCG@5': '0.0690', 'HR@10': '0.1275', 'NDCG@10': '0.0797', 'HR@20': '0.1672', 'NDCG@20': '0.0896'}
2025-02-22 19:05:13,921 - EarlyStopping counter: 7 out of 10
2025-02-22 19:05:46,935 - {'epoch': 58, 'rec_loss': '6.8226'}
2025-02-22 19:05:56,064 - {'Epoch': 58, 'HR@5': '0.0948', 'NDCG@5': '0.0684', 'HR@10': '0.1282', 'NDCG@10': '0.0791', 'HR@20': '0.1690', 'NDCG@20': '0.0894'}
2025-02-22 19:05:56,070 - EarlyStopping counter: 8 out of 10
2025-02-22 19:06:29,331 - {'epoch': 59, 'rec_loss': '6.8264'}
2025-02-22 19:06:38,406 - {'Epoch': 59, 'HR@5': '0.0950', 'NDCG@5': '0.0688', 'HR@10': '0.1272', 'NDCG@10': '0.0791', 'HR@20': '0.1693', 'NDCG@20': '0.0897'}
2025-02-22 19:06:38,413 - EarlyStopping counter: 9 out of 10
2025-02-22 19:07:14,657 - {'epoch': 60, 'rec_loss': '6.8235'}
2025-02-22 19:07:22,435 - {'Epoch': 60, 'HR@5': '0.0943', 'NDCG@5': '0.0682', 'HR@10': '0.1280', 'NDCG@10': '0.0790', 'HR@20': '0.1692', 'NDCG@20': '0.0893'}
2025-02-22 19:07:22,440 - EarlyStopping counter: 10 out of 10
2025-02-22 19:07:22,440 - Early stopping
2025-02-22 19:07:22,440 - ---------------Test Score---------------
2025-02-22 19:07:32,193 - {'Epoch': 0, 'HR@5': '0.0798', 'NDCG@5': '0.0576', 'HR@10': '0.1067', 'NDCG@10': '0.0663', 'HR@20': '0.1439', 'NDCG@20': '0.0756'}
2025-02-22 19:07:32,199 - Scale_Toys
2025-02-22 19:07:32,199 - {'Epoch': 0, 'HR@5': '0.0798', 'NDCG@5': '0.0576', 'HR@10': '0.1067', 'NDCG@10': '0.0663', 'HR@20': '0.1439', 'NDCG@20': '0.0756'}
2025-02-22 19:15:39,551 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[10, 5], kernels=[4, 8, 12], start_prob=0.3, end_prob=0.7, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-02-22 19:15:46,445 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-22 19:15:46,580 - Total Parameters: 916817
2025-02-22 19:16:23,965 - {'epoch': 0, 'rec_loss': '9.0946'}
2025-02-22 19:16:32,461 - {'Epoch': 0, 'HR@5': '0.0063', 'NDCG@5': '0.0038', 'HR@10': '0.0121', 'NDCG@10': '0.0056', 'HR@20': '0.0192', 'NDCG@20': '0.0074'}
2025-02-22 19:16:32,466 - Validation score increased.  Saving model ...
2025-02-22 19:17:06,363 - {'epoch': 1, 'rec_loss': '8.7356'}
2025-02-22 19:17:15,086 - {'Epoch': 1, 'HR@5': '0.0163', 'NDCG@5': '0.0115', 'HR@10': '0.0253', 'NDCG@10': '0.0144', 'HR@20': '0.0380', 'NDCG@20': '0.0176'}
2025-02-22 19:17:15,093 - Validation score increased.  Saving model ...
2025-02-22 19:17:48,998 - {'epoch': 2, 'rec_loss': '8.4723'}
2025-02-22 19:17:58,108 - {'Epoch': 2, 'HR@5': '0.0273', 'NDCG@5': '0.0196', 'HR@10': '0.0407', 'NDCG@10': '0.0239', 'HR@20': '0.0608', 'NDCG@20': '0.0290'}
2025-02-22 19:17:58,109 - Validation score increased.  Saving model ...
2025-02-22 19:18:32,803 - {'epoch': 3, 'rec_loss': '8.2401'}
2025-02-22 19:18:41,435 - {'Epoch': 3, 'HR@5': '0.0401', 'NDCG@5': '0.0286', 'HR@10': '0.0579', 'NDCG@10': '0.0343', 'HR@20': '0.0831', 'NDCG@20': '0.0407'}
2025-02-22 19:18:41,440 - Validation score increased.  Saving model ...
2025-02-22 19:19:16,327 - {'epoch': 4, 'rec_loss': '8.0418'}
2025-02-22 19:19:24,161 - {'Epoch': 4, 'HR@5': '0.0523', 'NDCG@5': '0.0364', 'HR@10': '0.0752', 'NDCG@10': '0.0437', 'HR@20': '0.1060', 'NDCG@20': '0.0515'}
2025-02-22 19:19:24,162 - Validation score increased.  Saving model ...
2025-02-22 19:19:59,612 - {'epoch': 5, 'rec_loss': '7.8824'}
2025-02-22 19:20:07,633 - {'Epoch': 5, 'HR@5': '0.0618', 'NDCG@5': '0.0433', 'HR@10': '0.0856', 'NDCG@10': '0.0510', 'HR@20': '0.1186', 'NDCG@20': '0.0593'}
2025-02-22 19:20:07,639 - Validation score increased.  Saving model ...
2025-02-22 19:20:42,436 - {'epoch': 6, 'rec_loss': '7.7610'}
2025-02-22 19:20:50,067 - {'Epoch': 6, 'HR@5': '0.0683', 'NDCG@5': '0.0483', 'HR@10': '0.0950', 'NDCG@10': '0.0570', 'HR@20': '0.1270', 'NDCG@20': '0.0650'}
2025-02-22 19:20:50,071 - Validation score increased.  Saving model ...
2025-02-22 19:21:25,461 - {'epoch': 7, 'rec_loss': '7.6720'}
2025-02-22 19:21:34,230 - {'Epoch': 7, 'HR@5': '0.0732', 'NDCG@5': '0.0517', 'HR@10': '0.1011', 'NDCG@10': '0.0608', 'HR@20': '0.1339', 'NDCG@20': '0.0690'}
2025-02-22 19:21:34,238 - Validation score increased.  Saving model ...
2025-02-22 19:22:07,640 - {'epoch': 8, 'rec_loss': '7.5860'}
2025-02-22 19:22:15,760 - {'Epoch': 8, 'HR@5': '0.0772', 'NDCG@5': '0.0551', 'HR@10': '0.1060', 'NDCG@10': '0.0643', 'HR@20': '0.1417', 'NDCG@20': '0.0733'}
2025-02-22 19:22:15,766 - Validation score increased.  Saving model ...
2025-02-22 19:22:50,455 - {'epoch': 9, 'rec_loss': '7.5132'}
2025-02-22 19:22:58,346 - {'Epoch': 9, 'HR@5': '0.0784', 'NDCG@5': '0.0570', 'HR@10': '0.1086', 'NDCG@10': '0.0667', 'HR@20': '0.1448', 'NDCG@20': '0.0758'}
2025-02-22 19:22:58,353 - Validation score increased.  Saving model ...
2025-02-22 19:23:33,679 - {'epoch': 10, 'rec_loss': '7.4670'}
2025-02-22 19:23:41,696 - {'Epoch': 10, 'HR@5': '0.0823', 'NDCG@5': '0.0589', 'HR@10': '0.1115', 'NDCG@10': '0.0682', 'HR@20': '0.1472', 'NDCG@20': '0.0772'}
2025-02-22 19:23:41,704 - Validation score increased.  Saving model ...
2025-02-22 19:24:17,967 - {'epoch': 11, 'rec_loss': '7.4168'}
2025-02-22 19:24:26,789 - {'Epoch': 11, 'HR@5': '0.0842', 'NDCG@5': '0.0607', 'HR@10': '0.1134', 'NDCG@10': '0.0701', 'HR@20': '0.1502', 'NDCG@20': '0.0794'}
2025-02-22 19:24:26,796 - Validation score increased.  Saving model ...
2025-02-22 19:25:03,654 - {'epoch': 12, 'rec_loss': '7.3720'}
2025-02-22 19:25:11,531 - {'Epoch': 12, 'HR@5': '0.0854', 'NDCG@5': '0.0616', 'HR@10': '0.1153', 'NDCG@10': '0.0713', 'HR@20': '0.1505', 'NDCG@20': '0.0801'}
2025-02-22 19:25:11,538 - Validation score increased.  Saving model ...
2025-02-22 19:25:46,746 - {'epoch': 13, 'rec_loss': '7.3429'}
2025-02-22 19:25:55,732 - {'Epoch': 13, 'HR@5': '0.0864', 'NDCG@5': '0.0622', 'HR@10': '0.1146', 'NDCG@10': '0.0713', 'HR@20': '0.1545', 'NDCG@20': '0.0814'}
2025-02-22 19:25:55,739 - Validation score increased.  Saving model ...
2025-02-22 19:26:30,627 - {'epoch': 14, 'rec_loss': '7.3141'}
2025-02-22 19:26:39,309 - {'Epoch': 14, 'HR@5': '0.0875', 'NDCG@5': '0.0633', 'HR@10': '0.1170', 'NDCG@10': '0.0728', 'HR@20': '0.1543', 'NDCG@20': '0.0822'}
2025-02-22 19:26:39,313 - Validation score increased.  Saving model ...
2025-02-22 19:27:13,787 - {'epoch': 15, 'rec_loss': '7.2853'}
2025-02-22 19:27:22,821 - {'Epoch': 15, 'HR@5': '0.0888', 'NDCG@5': '0.0641', 'HR@10': '0.1186', 'NDCG@10': '0.0737', 'HR@20': '0.1559', 'NDCG@20': '0.0831'}
2025-02-22 19:27:22,823 - Validation score increased.  Saving model ...
2025-02-22 19:27:56,364 - {'epoch': 16, 'rec_loss': '7.2618'}
2025-02-22 19:28:04,750 - {'Epoch': 16, 'HR@5': '0.0882', 'NDCG@5': '0.0636', 'HR@10': '0.1188', 'NDCG@10': '0.0735', 'HR@20': '0.1580', 'NDCG@20': '0.0833'}
2025-02-22 19:28:04,751 - Validation score increased.  Saving model ...
2025-02-22 19:28:39,751 - {'epoch': 17, 'rec_loss': '7.2276'}
2025-02-22 19:28:48,535 - {'Epoch': 17, 'HR@5': '0.0903', 'NDCG@5': '0.0655', 'HR@10': '0.1200', 'NDCG@10': '0.0751', 'HR@20': '0.1589', 'NDCG@20': '0.0849'}
2025-02-22 19:28:48,543 - Validation score increased.  Saving model ...
2025-02-22 19:29:23,889 - {'epoch': 18, 'rec_loss': '7.2153'}
2025-02-22 19:29:32,787 - {'Epoch': 18, 'HR@5': '0.0893', 'NDCG@5': '0.0647', 'HR@10': '0.1198', 'NDCG@10': '0.0745', 'HR@20': '0.1587', 'NDCG@20': '0.0843'}
2025-02-22 19:29:32,794 - EarlyStopping counter: 1 out of 10
2025-02-22 19:30:08,382 - {'epoch': 19, 'rec_loss': '7.1953'}
2025-02-22 19:30:17,244 - {'Epoch': 19, 'HR@5': '0.0880', 'NDCG@5': '0.0649', 'HR@10': '0.1211', 'NDCG@10': '0.0755', 'HR@20': '0.1595', 'NDCG@20': '0.0852'}
2025-02-22 19:30:17,253 - Validation score increased.  Saving model ...
2025-02-22 19:30:50,513 - {'epoch': 20, 'rec_loss': '7.1807'}
2025-02-22 19:30:59,554 - {'Epoch': 20, 'HR@5': '0.0883', 'NDCG@5': '0.0644', 'HR@10': '0.1212', 'NDCG@10': '0.0750', 'HR@20': '0.1595', 'NDCG@20': '0.0847'}
2025-02-22 19:30:59,559 - EarlyStopping counter: 1 out of 10
2025-02-22 19:31:34,802 - {'epoch': 21, 'rec_loss': '7.1528'}
2025-02-22 19:31:43,703 - {'Epoch': 21, 'HR@5': '0.0899', 'NDCG@5': '0.0654', 'HR@10': '0.1204', 'NDCG@10': '0.0752', 'HR@20': '0.1596', 'NDCG@20': '0.0851'}
2025-02-22 19:31:43,709 - EarlyStopping counter: 2 out of 10
2025-02-22 19:32:19,260 - {'epoch': 22, 'rec_loss': '7.1411'}
2025-02-22 19:32:27,107 - {'Epoch': 22, 'HR@5': '0.0898', 'NDCG@5': '0.0654', 'HR@10': '0.1215', 'NDCG@10': '0.0755', 'HR@20': '0.1591', 'NDCG@20': '0.0850'}
2025-02-22 19:32:27,114 - EarlyStopping counter: 3 out of 10
2025-02-22 19:32:59,851 - {'epoch': 23, 'rec_loss': '7.1271'}
2025-02-22 19:33:08,452 - {'Epoch': 23, 'HR@5': '0.0910', 'NDCG@5': '0.0658', 'HR@10': '0.1223', 'NDCG@10': '0.0758', 'HR@20': '0.1614', 'NDCG@20': '0.0856'}
2025-02-22 19:33:08,461 - Validation score increased.  Saving model ...
2025-02-22 19:33:43,127 - {'epoch': 24, 'rec_loss': '7.1210'}
2025-02-22 19:33:52,309 - {'Epoch': 24, 'HR@5': '0.0908', 'NDCG@5': '0.0654', 'HR@10': '0.1226', 'NDCG@10': '0.0757', 'HR@20': '0.1635', 'NDCG@20': '0.0860'}
2025-02-22 19:33:52,314 - Validation score increased.  Saving model ...
2025-02-22 19:34:21,321 - {'epoch': 25, 'rec_loss': '7.0989'}
2025-02-22 19:34:30,124 - {'Epoch': 25, 'HR@5': '0.0931', 'NDCG@5': '0.0664', 'HR@10': '0.1228', 'NDCG@10': '0.0760', 'HR@20': '0.1636', 'NDCG@20': '0.0862'}
2025-02-22 19:34:30,132 - Validation score increased.  Saving model ...
2025-02-22 19:35:06,212 - {'epoch': 26, 'rec_loss': '7.0847'}
2025-02-22 19:35:14,933 - {'Epoch': 26, 'HR@5': '0.0911', 'NDCG@5': '0.0661', 'HR@10': '0.1228', 'NDCG@10': '0.0763', 'HR@20': '0.1606', 'NDCG@20': '0.0858'}
2025-02-22 19:35:14,942 - EarlyStopping counter: 1 out of 10
2025-02-22 19:35:50,946 - {'epoch': 27, 'rec_loss': '7.0757'}
2025-02-22 19:35:59,887 - {'Epoch': 27, 'HR@5': '0.0920', 'NDCG@5': '0.0659', 'HR@10': '0.1237', 'NDCG@10': '0.0762', 'HR@20': '0.1628', 'NDCG@20': '0.0861'}
2025-02-22 19:35:59,895 - EarlyStopping counter: 2 out of 10
2025-02-22 19:36:34,344 - {'epoch': 28, 'rec_loss': '7.0666'}
2025-02-22 19:36:42,164 - {'Epoch': 28, 'HR@5': '0.0923', 'NDCG@5': '0.0668', 'HR@10': '0.1241', 'NDCG@10': '0.0771', 'HR@20': '0.1656', 'NDCG@20': '0.0875'}
2025-02-22 19:36:42,173 - Validation score increased.  Saving model ...
2025-02-22 19:37:15,874 - {'epoch': 29, 'rec_loss': '7.0526'}
2025-02-22 19:37:23,800 - {'Epoch': 29, 'HR@5': '0.0911', 'NDCG@5': '0.0659', 'HR@10': '0.1231', 'NDCG@10': '0.0763', 'HR@20': '0.1630', 'NDCG@20': '0.0863'}
2025-02-22 19:37:23,805 - EarlyStopping counter: 1 out of 10
2025-02-22 19:37:57,171 - {'epoch': 30, 'rec_loss': '7.0481'}
2025-02-22 19:38:06,405 - {'Epoch': 30, 'HR@5': '0.0939', 'NDCG@5': '0.0677', 'HR@10': '0.1238', 'NDCG@10': '0.0774', 'HR@20': '0.1624', 'NDCG@20': '0.0871'}
2025-02-22 19:38:06,414 - EarlyStopping counter: 2 out of 10
2025-02-22 19:38:40,516 - {'epoch': 31, 'rec_loss': '7.0354'}
2025-02-22 19:38:48,557 - {'Epoch': 31, 'HR@5': '0.0923', 'NDCG@5': '0.0666', 'HR@10': '0.1242', 'NDCG@10': '0.0768', 'HR@20': '0.1642', 'NDCG@20': '0.0869'}
2025-02-22 19:38:48,563 - EarlyStopping counter: 3 out of 10
2025-02-22 19:39:21,658 - {'epoch': 32, 'rec_loss': '7.0303'}
2025-02-22 19:39:30,166 - {'Epoch': 32, 'HR@5': '0.0928', 'NDCG@5': '0.0674', 'HR@10': '0.1235', 'NDCG@10': '0.0773', 'HR@20': '0.1649', 'NDCG@20': '0.0877'}
2025-02-22 19:39:30,172 - Validation score increased.  Saving model ...
2025-02-22 19:40:04,819 - {'epoch': 33, 'rec_loss': '7.0204'}
2025-02-22 19:40:14,146 - {'Epoch': 33, 'HR@5': '0.0930', 'NDCG@5': '0.0673', 'HR@10': '0.1247', 'NDCG@10': '0.0774', 'HR@20': '0.1659', 'NDCG@20': '0.0878'}
2025-02-22 19:40:14,153 - Validation score increased.  Saving model ...
2025-02-22 19:40:50,479 - {'epoch': 34, 'rec_loss': '7.0116'}
2025-02-22 19:40:58,763 - {'Epoch': 34, 'HR@5': '0.0928', 'NDCG@5': '0.0673', 'HR@10': '0.1248', 'NDCG@10': '0.0776', 'HR@20': '0.1656', 'NDCG@20': '0.0879'}
2025-02-22 19:40:58,772 - Validation score increased.  Saving model ...
2025-02-22 19:41:34,385 - {'epoch': 35, 'rec_loss': '6.9994'}
2025-02-22 19:41:43,594 - {'Epoch': 35, 'HR@5': '0.0937', 'NDCG@5': '0.0674', 'HR@10': '0.1249', 'NDCG@10': '0.0774', 'HR@20': '0.1652', 'NDCG@20': '0.0875'}
2025-02-22 19:41:43,602 - EarlyStopping counter: 1 out of 10
2025-02-22 19:42:17,171 - {'epoch': 36, 'rec_loss': '7.0064'}
2025-02-22 19:42:26,464 - {'Epoch': 36, 'HR@5': '0.0926', 'NDCG@5': '0.0674', 'HR@10': '0.1230', 'NDCG@10': '0.0773', 'HR@20': '0.1649', 'NDCG@20': '0.0878'}
2025-02-22 19:42:26,471 - EarlyStopping counter: 2 out of 10
2025-02-22 19:42:59,435 - {'epoch': 37, 'rec_loss': '6.9885'}
2025-02-22 19:43:08,206 - {'Epoch': 37, 'HR@5': '0.0922', 'NDCG@5': '0.0671', 'HR@10': '0.1244', 'NDCG@10': '0.0775', 'HR@20': '0.1636', 'NDCG@20': '0.0873'}
2025-02-22 19:43:08,214 - EarlyStopping counter: 3 out of 10
2025-02-22 19:43:41,438 - {'epoch': 38, 'rec_loss': '6.9861'}
2025-02-22 19:43:50,205 - {'Epoch': 38, 'HR@5': '0.0936', 'NDCG@5': '0.0679', 'HR@10': '0.1250', 'NDCG@10': '0.0779', 'HR@20': '0.1657', 'NDCG@20': '0.0882'}
2025-02-22 19:43:50,214 - Validation score increased.  Saving model ...
2025-02-22 19:44:23,485 - {'epoch': 39, 'rec_loss': '6.9714'}
2025-02-22 19:44:32,376 - {'Epoch': 39, 'HR@5': '0.0936', 'NDCG@5': '0.0674', 'HR@10': '0.1247', 'NDCG@10': '0.0774', 'HR@20': '0.1660', 'NDCG@20': '0.0878'}
2025-02-22 19:44:32,381 - EarlyStopping counter: 1 out of 10
2025-02-22 19:45:00,475 - {'epoch': 40, 'rec_loss': '6.9617'}
2025-02-22 19:45:08,423 - {'Epoch': 40, 'HR@5': '0.0944', 'NDCG@5': '0.0682', 'HR@10': '0.1258', 'NDCG@10': '0.0783', 'HR@20': '0.1666', 'NDCG@20': '0.0886'}
2025-02-22 19:45:08,430 - Validation score increased.  Saving model ...
2025-02-22 19:45:45,059 - {'epoch': 41, 'rec_loss': '6.9569'}
2025-02-22 19:45:52,922 - {'Epoch': 41, 'HR@5': '0.0945', 'NDCG@5': '0.0687', 'HR@10': '0.1265', 'NDCG@10': '0.0790', 'HR@20': '0.1667', 'NDCG@20': '0.0891'}
2025-02-22 19:45:52,928 - Validation score increased.  Saving model ...
2025-02-22 19:46:27,525 - {'epoch': 42, 'rec_loss': '6.9481'}
2025-02-22 19:46:36,798 - {'Epoch': 42, 'HR@5': '0.0943', 'NDCG@5': '0.0681', 'HR@10': '0.1258', 'NDCG@10': '0.0783', 'HR@20': '0.1651', 'NDCG@20': '0.0882'}
2025-02-22 19:46:36,799 - EarlyStopping counter: 1 out of 10
2025-02-22 19:47:11,122 - {'epoch': 43, 'rec_loss': '6.9462'}
2025-02-22 19:47:20,042 - {'Epoch': 43, 'HR@5': '0.0951', 'NDCG@5': '0.0688', 'HR@10': '0.1266', 'NDCG@10': '0.0790', 'HR@20': '0.1677', 'NDCG@20': '0.0893'}
2025-02-22 19:47:20,043 - Validation score increased.  Saving model ...
2025-02-22 19:47:55,567 - {'epoch': 44, 'rec_loss': '6.9457'}
2025-02-22 19:48:04,183 - {'Epoch': 44, 'HR@5': '0.0950', 'NDCG@5': '0.0688', 'HR@10': '0.1260', 'NDCG@10': '0.0788', 'HR@20': '0.1666', 'NDCG@20': '0.0891'}
2025-02-22 19:48:04,185 - EarlyStopping counter: 1 out of 10
2025-02-22 19:48:39,505 - {'epoch': 45, 'rec_loss': '6.9342'}
2025-02-22 19:48:47,061 - {'Epoch': 45, 'HR@5': '0.0961', 'NDCG@5': '0.0698', 'HR@10': '0.1278', 'NDCG@10': '0.0800', 'HR@20': '0.1670', 'NDCG@20': '0.0899'}
2025-02-22 19:48:47,066 - Validation score increased.  Saving model ...
2025-02-22 19:49:22,442 - {'epoch': 46, 'rec_loss': '6.9272'}
2025-02-22 19:49:32,053 - {'Epoch': 46, 'HR@5': '0.0968', 'NDCG@5': '0.0701', 'HR@10': '0.1278', 'NDCG@10': '0.0800', 'HR@20': '0.1665', 'NDCG@20': '0.0898'}
2025-02-22 19:49:32,060 - EarlyStopping counter: 1 out of 10
2025-02-22 19:50:06,085 - {'epoch': 47, 'rec_loss': '6.9179'}
2025-02-22 19:50:15,163 - {'Epoch': 47, 'HR@5': '0.0947', 'NDCG@5': '0.0684', 'HR@10': '0.1261', 'NDCG@10': '0.0785', 'HR@20': '0.1670', 'NDCG@20': '0.0889'}
2025-02-22 19:50:15,172 - EarlyStopping counter: 2 out of 10
2025-02-22 19:50:48,010 - {'epoch': 48, 'rec_loss': '6.9238'}
2025-02-22 19:50:55,720 - {'Epoch': 48, 'HR@5': '0.0942', 'NDCG@5': '0.0684', 'HR@10': '0.1263', 'NDCG@10': '0.0787', 'HR@20': '0.1668', 'NDCG@20': '0.0889'}
2025-02-22 19:50:55,728 - EarlyStopping counter: 3 out of 10
2025-02-22 19:51:28,787 - {'epoch': 49, 'rec_loss': '6.9143'}
2025-02-22 19:51:37,857 - {'Epoch': 49, 'HR@5': '0.0944', 'NDCG@5': '0.0682', 'HR@10': '0.1259', 'NDCG@10': '0.0783', 'HR@20': '0.1676', 'NDCG@20': '0.0889'}
2025-02-22 19:51:37,865 - EarlyStopping counter: 4 out of 10
2025-02-22 19:52:10,843 - {'epoch': 50, 'rec_loss': '6.9096'}
2025-02-22 19:52:18,966 - {'Epoch': 50, 'HR@5': '0.0953', 'NDCG@5': '0.0693', 'HR@10': '0.1283', 'NDCG@10': '0.0799', 'HR@20': '0.1679', 'NDCG@20': '0.0899'}
2025-02-22 19:52:18,970 - EarlyStopping counter: 5 out of 10
2025-02-22 19:52:52,476 - {'epoch': 51, 'rec_loss': '6.9065'}
2025-02-22 19:53:01,705 - {'Epoch': 51, 'HR@5': '0.0947', 'NDCG@5': '0.0682', 'HR@10': '0.1256', 'NDCG@10': '0.0782', 'HR@20': '0.1663', 'NDCG@20': '0.0884'}
2025-02-22 19:53:01,713 - EarlyStopping counter: 6 out of 10
2025-02-22 19:53:36,751 - {'epoch': 52, 'rec_loss': '6.9082'}
2025-02-22 19:53:44,751 - {'Epoch': 52, 'HR@5': '0.0939', 'NDCG@5': '0.0681', 'HR@10': '0.1261', 'NDCG@10': '0.0785', 'HR@20': '0.1651', 'NDCG@20': '0.0883'}
2025-02-22 19:53:44,758 - EarlyStopping counter: 7 out of 10
2025-02-22 19:54:19,982 - {'epoch': 53, 'rec_loss': '6.8934'}
2025-02-22 19:54:27,886 - {'Epoch': 53, 'HR@5': '0.0940', 'NDCG@5': '0.0681', 'HR@10': '0.1278', 'NDCG@10': '0.0790', 'HR@20': '0.1659', 'NDCG@20': '0.0887'}
2025-02-22 19:54:27,894 - EarlyStopping counter: 8 out of 10
2025-02-22 19:55:02,306 - {'epoch': 54, 'rec_loss': '6.8830'}
2025-02-22 19:55:10,856 - {'Epoch': 54, 'HR@5': '0.0938', 'NDCG@5': '0.0681', 'HR@10': '0.1262', 'NDCG@10': '0.0786', 'HR@20': '0.1670', 'NDCG@20': '0.0889'}
2025-02-22 19:55:10,857 - EarlyStopping counter: 9 out of 10
2025-02-22 19:55:46,895 - {'epoch': 55, 'rec_loss': '6.8794'}
2025-02-22 19:55:54,496 - {'Epoch': 55, 'HR@5': '0.0941', 'NDCG@5': '0.0686', 'HR@10': '0.1266', 'NDCG@10': '0.0791', 'HR@20': '0.1673', 'NDCG@20': '0.0893'}
2025-02-22 19:55:54,501 - EarlyStopping counter: 10 out of 10
2025-02-22 19:55:54,501 - Early stopping
2025-02-22 19:55:54,501 - ---------------Test Score---------------
2025-02-22 19:56:02,648 - {'Epoch': 0, 'HR@5': '0.0785', 'NDCG@5': '0.0568', 'HR@10': '0.1058', 'NDCG@10': '0.0656', 'HR@20': '0.1407', 'NDCG@20': '0.0744'}
2025-02-22 19:56:02,656 - Scale_Toys
2025-02-22 19:56:02,656 - {'Epoch': 0, 'HR@5': '0.0785', 'NDCG@5': '0.0568', 'HR@10': '0.1058', 'NDCG@10': '0.0656', 'HR@20': '0.1407', 'NDCG@20': '0.0744'}
2025-02-22 20:05:00,881 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[10, 5], kernels=[4, 8, 12], start_prob=0.3, end_prob=0.8, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-02-22 20:05:07,635 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-22 20:05:07,773 - Total Parameters: 916817
2025-02-22 20:05:38,051 - {'epoch': 0, 'rec_loss': '9.0975'}
2025-02-22 20:05:47,389 - {'Epoch': 0, 'HR@5': '0.0075', 'NDCG@5': '0.0047', 'HR@10': '0.0122', 'NDCG@10': '0.0062', 'HR@20': '0.0183', 'NDCG@20': '0.0077'}
2025-02-22 20:05:47,394 - Validation score increased.  Saving model ...
2025-02-22 20:06:25,101 - {'epoch': 1, 'rec_loss': '8.7566'}
2025-02-22 20:06:34,183 - {'Epoch': 1, 'HR@5': '0.0137', 'NDCG@5': '0.0089', 'HR@10': '0.0223', 'NDCG@10': '0.0117', 'HR@20': '0.0343', 'NDCG@20': '0.0146'}
2025-02-22 20:06:34,191 - Validation score increased.  Saving model ...
2025-02-22 20:07:10,096 - {'epoch': 2, 'rec_loss': '8.5103'}
2025-02-22 20:07:17,836 - {'Epoch': 2, 'HR@5': '0.0235', 'NDCG@5': '0.0166', 'HR@10': '0.0363', 'NDCG@10': '0.0207', 'HR@20': '0.0557', 'NDCG@20': '0.0256'}
2025-02-22 20:07:17,843 - Validation score increased.  Saving model ...
2025-02-22 20:07:52,380 - {'epoch': 3, 'rec_loss': '8.2960'}
2025-02-22 20:08:00,662 - {'Epoch': 3, 'HR@5': '0.0371', 'NDCG@5': '0.0266', 'HR@10': '0.0536', 'NDCG@10': '0.0319', 'HR@20': '0.0758', 'NDCG@20': '0.0374'}
2025-02-22 20:08:00,669 - Validation score increased.  Saving model ...
2025-02-22 20:08:36,110 - {'epoch': 4, 'rec_loss': '8.1065'}
2025-02-22 20:08:44,592 - {'Epoch': 4, 'HR@5': '0.0463', 'NDCG@5': '0.0326', 'HR@10': '0.0676', 'NDCG@10': '0.0395', 'HR@20': '0.0975', 'NDCG@20': '0.0470'}
2025-02-22 20:08:44,600 - Validation score increased.  Saving model ...
2025-02-22 20:09:17,395 - {'epoch': 5, 'rec_loss': '7.9517'}
2025-02-22 20:09:26,186 - {'Epoch': 5, 'HR@5': '0.0560', 'NDCG@5': '0.0392', 'HR@10': '0.0794', 'NDCG@10': '0.0468', 'HR@20': '0.1108', 'NDCG@20': '0.0547'}
2025-02-22 20:09:26,193 - Validation score increased.  Saving model ...
2025-02-22 20:10:02,348 - {'epoch': 6, 'rec_loss': '7.8329'}
2025-02-22 20:10:11,104 - {'Epoch': 6, 'HR@5': '0.0633', 'NDCG@5': '0.0446', 'HR@10': '0.0889', 'NDCG@10': '0.0528', 'HR@20': '0.1214', 'NDCG@20': '0.0610'}
2025-02-22 20:10:11,112 - Validation score increased.  Saving model ...
2025-02-22 20:10:45,142 - {'epoch': 7, 'rec_loss': '7.7454'}
2025-02-22 20:10:53,611 - {'Epoch': 7, 'HR@5': '0.0682', 'NDCG@5': '0.0474', 'HR@10': '0.0957', 'NDCG@10': '0.0563', 'HR@20': '0.1283', 'NDCG@20': '0.0645'}
2025-02-22 20:10:53,617 - Validation score increased.  Saving model ...
2025-02-22 20:11:29,633 - {'epoch': 8, 'rec_loss': '7.6579'}
2025-02-22 20:11:37,067 - {'Epoch': 8, 'HR@5': '0.0735', 'NDCG@5': '0.0519', 'HR@10': '0.1005', 'NDCG@10': '0.0605', 'HR@20': '0.1373', 'NDCG@20': '0.0698'}
2025-02-22 20:11:37,073 - Validation score increased.  Saving model ...
2025-02-22 20:12:12,608 - {'epoch': 9, 'rec_loss': '7.5907'}
2025-02-22 20:12:20,333 - {'Epoch': 9, 'HR@5': '0.0761', 'NDCG@5': '0.0545', 'HR@10': '0.1045', 'NDCG@10': '0.0636', 'HR@20': '0.1414', 'NDCG@20': '0.0729'}
2025-02-22 20:12:20,339 - Validation score increased.  Saving model ...
2025-02-22 20:12:53,662 - {'epoch': 10, 'rec_loss': '7.5409'}
2025-02-22 20:13:02,456 - {'Epoch': 10, 'HR@5': '0.0777', 'NDCG@5': '0.0561', 'HR@10': '0.1070', 'NDCG@10': '0.0655', 'HR@20': '0.1430', 'NDCG@20': '0.0746'}
2025-02-22 20:13:02,463 - Validation score increased.  Saving model ...
2025-02-22 20:13:36,293 - {'epoch': 11, 'rec_loss': '7.4916'}
2025-02-22 20:13:44,348 - {'Epoch': 11, 'HR@5': '0.0803', 'NDCG@5': '0.0577', 'HR@10': '0.1098', 'NDCG@10': '0.0672', 'HR@20': '0.1470', 'NDCG@20': '0.0766'}
2025-02-22 20:13:44,355 - Validation score increased.  Saving model ...
2025-02-22 20:14:17,617 - {'epoch': 12, 'rec_loss': '7.4427'}
2025-02-22 20:14:26,454 - {'Epoch': 12, 'HR@5': '0.0826', 'NDCG@5': '0.0594', 'HR@10': '0.1117', 'NDCG@10': '0.0689', 'HR@20': '0.1478', 'NDCG@20': '0.0779'}
2025-02-22 20:14:26,460 - Validation score increased.  Saving model ...
2025-02-22 20:14:59,393 - {'epoch': 13, 'rec_loss': '7.4120'}
2025-02-22 20:15:08,023 - {'Epoch': 13, 'HR@5': '0.0840', 'NDCG@5': '0.0601', 'HR@10': '0.1136', 'NDCG@10': '0.0697', 'HR@20': '0.1516', 'NDCG@20': '0.0792'}
2025-02-22 20:15:08,030 - Validation score increased.  Saving model ...
2025-02-22 20:15:42,353 - {'epoch': 14, 'rec_loss': '7.3849'}
2025-02-22 20:15:51,177 - {'Epoch': 14, 'HR@5': '0.0853', 'NDCG@5': '0.0612', 'HR@10': '0.1150', 'NDCG@10': '0.0708', 'HR@20': '0.1534', 'NDCG@20': '0.0805'}
2025-02-22 20:15:51,184 - Validation score increased.  Saving model ...
2025-02-22 20:16:22,187 - {'epoch': 15, 'rec_loss': '7.3548'}
2025-02-22 20:16:31,303 - {'Epoch': 15, 'HR@5': '0.0858', 'NDCG@5': '0.0617', 'HR@10': '0.1166', 'NDCG@10': '0.0717', 'HR@20': '0.1555', 'NDCG@20': '0.0815'}
2025-02-22 20:16:31,310 - Validation score increased.  Saving model ...
2025-02-22 20:17:08,642 - {'epoch': 16, 'rec_loss': '7.3304'}
2025-02-22 20:17:16,279 - {'Epoch': 16, 'HR@5': '0.0854', 'NDCG@5': '0.0612', 'HR@10': '0.1176', 'NDCG@10': '0.0715', 'HR@20': '0.1566', 'NDCG@20': '0.0814'}
2025-02-22 20:17:16,286 - EarlyStopping counter: 1 out of 10
2025-02-22 20:17:52,261 - {'epoch': 17, 'rec_loss': '7.2921'}
2025-02-22 20:18:00,650 - {'Epoch': 17, 'HR@5': '0.0892', 'NDCG@5': '0.0642', 'HR@10': '0.1185', 'NDCG@10': '0.0737', 'HR@20': '0.1574', 'NDCG@20': '0.0834'}
2025-02-22 20:18:00,657 - Validation score increased.  Saving model ...
2025-02-22 20:18:35,811 - {'epoch': 18, 'rec_loss': '7.2780'}
2025-02-22 20:18:44,227 - {'Epoch': 18, 'HR@5': '0.0875', 'NDCG@5': '0.0629', 'HR@10': '0.1191', 'NDCG@10': '0.0730', 'HR@20': '0.1588', 'NDCG@20': '0.0830'}
2025-02-22 20:18:44,233 - EarlyStopping counter: 1 out of 10
2025-02-22 20:19:18,645 - {'epoch': 19, 'rec_loss': '7.2579'}
2025-02-22 20:19:26,253 - {'Epoch': 19, 'HR@5': '0.0873', 'NDCG@5': '0.0631', 'HR@10': '0.1192', 'NDCG@10': '0.0734', 'HR@20': '0.1572', 'NDCG@20': '0.0830'}
2025-02-22 20:19:26,260 - EarlyStopping counter: 2 out of 10
2025-02-22 20:19:59,579 - {'epoch': 20, 'rec_loss': '7.2404'}
2025-02-22 20:20:08,548 - {'Epoch': 20, 'HR@5': '0.0888', 'NDCG@5': '0.0640', 'HR@10': '0.1209', 'NDCG@10': '0.0743', 'HR@20': '0.1570', 'NDCG@20': '0.0834'}
2025-02-22 20:20:08,556 - EarlyStopping counter: 3 out of 10
2025-02-22 20:20:42,540 - {'epoch': 21, 'rec_loss': '7.2122'}
2025-02-22 20:20:50,917 - {'Epoch': 21, 'HR@5': '0.0880', 'NDCG@5': '0.0637', 'HR@10': '0.1206', 'NDCG@10': '0.0743', 'HR@20': '0.1581', 'NDCG@20': '0.0837'}
2025-02-22 20:20:50,923 - Validation score increased.  Saving model ...
2025-02-22 20:21:24,222 - {'epoch': 22, 'rec_loss': '7.2016'}
2025-02-22 20:21:32,907 - {'Epoch': 22, 'HR@5': '0.0897', 'NDCG@5': '0.0648', 'HR@10': '0.1204', 'NDCG@10': '0.0747', 'HR@20': '0.1585', 'NDCG@20': '0.0842'}
2025-02-22 20:21:32,914 - Validation score increased.  Saving model ...
2025-02-22 20:22:07,294 - {'epoch': 23, 'rec_loss': '7.1907'}
2025-02-22 20:22:15,315 - {'Epoch': 23, 'HR@5': '0.0892', 'NDCG@5': '0.0641', 'HR@10': '0.1199', 'NDCG@10': '0.0741', 'HR@20': '0.1585', 'NDCG@20': '0.0838'}
2025-02-22 20:22:15,321 - EarlyStopping counter: 1 out of 10
2025-02-22 20:22:49,670 - {'epoch': 24, 'rec_loss': '7.1802'}
2025-02-22 20:22:57,457 - {'Epoch': 24, 'HR@5': '0.0904', 'NDCG@5': '0.0648', 'HR@10': '0.1210', 'NDCG@10': '0.0747', 'HR@20': '0.1586', 'NDCG@20': '0.0841'}
2025-02-22 20:22:57,464 - EarlyStopping counter: 2 out of 10
2025-02-22 20:23:32,106 - {'epoch': 25, 'rec_loss': '7.1562'}
2025-02-22 20:23:40,481 - {'Epoch': 25, 'HR@5': '0.0910', 'NDCG@5': '0.0656', 'HR@10': '0.1223', 'NDCG@10': '0.0757', 'HR@20': '0.1609', 'NDCG@20': '0.0854'}
2025-02-22 20:23:40,488 - Validation score increased.  Saving model ...
2025-02-22 20:24:15,584 - {'epoch': 26, 'rec_loss': '7.1437'}
2025-02-22 20:24:23,338 - {'Epoch': 26, 'HR@5': '0.0916', 'NDCG@5': '0.0656', 'HR@10': '0.1207', 'NDCG@10': '0.0750', 'HR@20': '0.1595', 'NDCG@20': '0.0848'}
2025-02-22 20:24:23,345 - EarlyStopping counter: 1 out of 10
2025-02-22 20:24:59,980 - {'epoch': 27, 'rec_loss': '7.1362'}
2025-02-22 20:25:09,069 - {'Epoch': 27, 'HR@5': '0.0909', 'NDCG@5': '0.0653', 'HR@10': '0.1230', 'NDCG@10': '0.0756', 'HR@20': '0.1608', 'NDCG@20': '0.0851'}
2025-02-22 20:25:09,076 - EarlyStopping counter: 2 out of 10
2025-02-22 20:25:42,305 - {'epoch': 28, 'rec_loss': '7.1258'}
2025-02-22 20:25:51,224 - {'Epoch': 28, 'HR@5': '0.0907', 'NDCG@5': '0.0656', 'HR@10': '0.1238', 'NDCG@10': '0.0763', 'HR@20': '0.1619', 'NDCG@20': '0.0859'}
2025-02-22 20:25:51,232 - Validation score increased.  Saving model ...
2025-02-22 20:26:22,919 - {'epoch': 29, 'rec_loss': '7.1123'}
2025-02-22 20:26:31,581 - {'Epoch': 29, 'HR@5': '0.0897', 'NDCG@5': '0.0646', 'HR@10': '0.1228', 'NDCG@10': '0.0753', 'HR@20': '0.1605', 'NDCG@20': '0.0848'}
2025-02-22 20:26:31,589 - EarlyStopping counter: 1 out of 10
2025-02-22 20:27:08,670 - {'epoch': 30, 'rec_loss': '7.1104'}
2025-02-22 20:27:17,486 - {'Epoch': 30, 'HR@5': '0.0911', 'NDCG@5': '0.0653', 'HR@10': '0.1232', 'NDCG@10': '0.0757', 'HR@20': '0.1599', 'NDCG@20': '0.0849'}
2025-02-22 20:27:17,492 - EarlyStopping counter: 2 out of 10
2025-02-22 20:27:53,485 - {'epoch': 31, 'rec_loss': '7.0954'}
2025-02-22 20:28:02,431 - {'Epoch': 31, 'HR@5': '0.0909', 'NDCG@5': '0.0652', 'HR@10': '0.1217', 'NDCG@10': '0.0751', 'HR@20': '0.1613', 'NDCG@20': '0.0851'}
2025-02-22 20:28:02,439 - EarlyStopping counter: 3 out of 10
2025-02-22 20:28:36,487 - {'epoch': 32, 'rec_loss': '7.0844'}
2025-02-22 20:28:44,660 - {'Epoch': 32, 'HR@5': '0.0909', 'NDCG@5': '0.0654', 'HR@10': '0.1237', 'NDCG@10': '0.0760', 'HR@20': '0.1619', 'NDCG@20': '0.0856'}
2025-02-22 20:28:44,667 - EarlyStopping counter: 4 out of 10
2025-02-22 20:29:20,136 - {'epoch': 33, 'rec_loss': '7.0809'}
2025-02-22 20:29:28,242 - {'Epoch': 33, 'HR@5': '0.0907', 'NDCG@5': '0.0656', 'HR@10': '0.1227', 'NDCG@10': '0.0759', 'HR@20': '0.1632', 'NDCG@20': '0.0861'}
2025-02-22 20:29:28,249 - Validation score increased.  Saving model ...
2025-02-22 20:30:03,311 - {'epoch': 34, 'rec_loss': '7.0673'}
2025-02-22 20:30:10,961 - {'Epoch': 34, 'HR@5': '0.0924', 'NDCG@5': '0.0664', 'HR@10': '0.1241', 'NDCG@10': '0.0766', 'HR@20': '0.1629', 'NDCG@20': '0.0864'}
2025-02-22 20:30:10,968 - Validation score increased.  Saving model ...
2025-02-22 20:30:45,348 - {'epoch': 35, 'rec_loss': '7.0543'}
2025-02-22 20:30:53,138 - {'Epoch': 35, 'HR@5': '0.0921', 'NDCG@5': '0.0666', 'HR@10': '0.1235', 'NDCG@10': '0.0767', 'HR@20': '0.1635', 'NDCG@20': '0.0867'}
2025-02-22 20:30:53,145 - Validation score increased.  Saving model ...
2025-02-22 20:31:26,689 - {'epoch': 36, 'rec_loss': '7.0606'}
2025-02-22 20:31:34,141 - {'Epoch': 36, 'HR@5': '0.0909', 'NDCG@5': '0.0662', 'HR@10': '0.1231', 'NDCG@10': '0.0766', 'HR@20': '0.1632', 'NDCG@20': '0.0867'}
2025-02-22 20:31:34,148 - EarlyStopping counter: 1 out of 10
2025-02-22 20:32:06,812 - {'epoch': 37, 'rec_loss': '7.0441'}
2025-02-22 20:32:15,329 - {'Epoch': 37, 'HR@5': '0.0912', 'NDCG@5': '0.0658', 'HR@10': '0.1243', 'NDCG@10': '0.0765', 'HR@20': '0.1617', 'NDCG@20': '0.0859'}
2025-02-22 20:32:15,337 - EarlyStopping counter: 2 out of 10
2025-02-22 20:32:50,426 - {'epoch': 38, 'rec_loss': '7.0396'}
2025-02-22 20:32:58,064 - {'Epoch': 38, 'HR@5': '0.0926', 'NDCG@5': '0.0668', 'HR@10': '0.1243', 'NDCG@10': '0.0770', 'HR@20': '0.1641', 'NDCG@20': '0.0870'}
2025-02-22 20:32:58,069 - Validation score increased.  Saving model ...
2025-02-22 20:33:32,549 - {'epoch': 39, 'rec_loss': '7.0286'}
2025-02-22 20:33:40,138 - {'Epoch': 39, 'HR@5': '0.0920', 'NDCG@5': '0.0664', 'HR@10': '0.1247', 'NDCG@10': '0.0769', 'HR@20': '0.1627', 'NDCG@20': '0.0865'}
2025-02-22 20:33:40,144 - EarlyStopping counter: 1 out of 10
2025-02-22 20:34:13,439 - {'epoch': 40, 'rec_loss': '7.0181'}
2025-02-22 20:34:21,470 - {'Epoch': 40, 'HR@5': '0.0923', 'NDCG@5': '0.0668', 'HR@10': '0.1247', 'NDCG@10': '0.0772', 'HR@20': '0.1640', 'NDCG@20': '0.0871'}
2025-02-22 20:34:21,476 - Validation score increased.  Saving model ...
2025-02-22 20:34:55,141 - {'epoch': 41, 'rec_loss': '7.0140'}
2025-02-22 20:35:03,643 - {'Epoch': 41, 'HR@5': '0.0920', 'NDCG@5': '0.0665', 'HR@10': '0.1246', 'NDCG@10': '0.0770', 'HR@20': '0.1644', 'NDCG@20': '0.0870'}
2025-02-22 20:35:03,649 - EarlyStopping counter: 1 out of 10
2025-02-22 20:35:37,849 - {'epoch': 42, 'rec_loss': '7.0063'}
2025-02-22 20:35:46,373 - {'Epoch': 42, 'HR@5': '0.0930', 'NDCG@5': '0.0669', 'HR@10': '0.1244', 'NDCG@10': '0.0770', 'HR@20': '0.1629', 'NDCG@20': '0.0867'}
2025-02-22 20:35:46,380 - EarlyStopping counter: 2 out of 10
2025-02-22 20:36:21,290 - {'epoch': 43, 'rec_loss': '6.9997'}
2025-02-22 20:36:28,832 - {'Epoch': 43, 'HR@5': '0.0929', 'NDCG@5': '0.0671', 'HR@10': '0.1257', 'NDCG@10': '0.0777', 'HR@20': '0.1637', 'NDCG@20': '0.0873'}
2025-02-22 20:36:28,839 - Validation score increased.  Saving model ...
2025-02-22 20:36:56,755 - {'epoch': 44, 'rec_loss': '7.0018'}
2025-02-22 20:37:05,499 - {'Epoch': 44, 'HR@5': '0.0925', 'NDCG@5': '0.0674', 'HR@10': '0.1236', 'NDCG@10': '0.0774', 'HR@20': '0.1635', 'NDCG@20': '0.0875'}
2025-02-22 20:37:05,505 - Validation score increased.  Saving model ...
2025-02-22 20:37:41,981 - {'epoch': 45, 'rec_loss': '6.9889'}
2025-02-22 20:37:49,822 - {'Epoch': 45, 'HR@5': '0.0930', 'NDCG@5': '0.0678', 'HR@10': '0.1249', 'NDCG@10': '0.0781', 'HR@20': '0.1647', 'NDCG@20': '0.0882'}
2025-02-22 20:37:49,828 - Validation score increased.  Saving model ...
2025-02-22 20:38:26,303 - {'epoch': 46, 'rec_loss': '6.9862'}
2025-02-22 20:38:34,167 - {'Epoch': 46, 'HR@5': '0.0938', 'NDCG@5': '0.0678', 'HR@10': '0.1251', 'NDCG@10': '0.0778', 'HR@20': '0.1644', 'NDCG@20': '0.0877'}
2025-02-22 20:38:34,175 - EarlyStopping counter: 1 out of 10
2025-02-22 20:39:09,041 - {'epoch': 47, 'rec_loss': '6.9727'}
2025-02-22 20:39:17,850 - {'Epoch': 47, 'HR@5': '0.0932', 'NDCG@5': '0.0678', 'HR@10': '0.1256', 'NDCG@10': '0.0782', 'HR@20': '0.1655', 'NDCG@20': '0.0883'}
2025-02-22 20:39:17,858 - Validation score increased.  Saving model ...
2025-02-22 20:39:52,307 - {'epoch': 48, 'rec_loss': '6.9772'}
2025-02-22 20:39:59,955 - {'Epoch': 48, 'HR@5': '0.0926', 'NDCG@5': '0.0674', 'HR@10': '0.1252', 'NDCG@10': '0.0778', 'HR@20': '0.1627', 'NDCG@20': '0.0873'}
2025-02-22 20:39:59,964 - EarlyStopping counter: 1 out of 10
2025-02-22 20:40:35,265 - {'epoch': 49, 'rec_loss': '6.9694'}
2025-02-22 20:40:44,336 - {'Epoch': 49, 'HR@5': '0.0925', 'NDCG@5': '0.0666', 'HR@10': '0.1247', 'NDCG@10': '0.0770', 'HR@20': '0.1642', 'NDCG@20': '0.0870'}
2025-02-22 20:40:44,344 - EarlyStopping counter: 2 out of 10
2025-02-22 20:41:17,847 - {'epoch': 50, 'rec_loss': '6.9691'}
2025-02-22 20:41:26,634 - {'Epoch': 50, 'HR@5': '0.0943', 'NDCG@5': '0.0685', 'HR@10': '0.1244', 'NDCG@10': '0.0783', 'HR@20': '0.1659', 'NDCG@20': '0.0887'}
2025-02-22 20:41:26,642 - Validation score increased.  Saving model ...
2025-02-22 20:42:01,231 - {'epoch': 51, 'rec_loss': '6.9623'}
2025-02-22 20:42:10,015 - {'Epoch': 51, 'HR@5': '0.0922', 'NDCG@5': '0.0671', 'HR@10': '0.1242', 'NDCG@10': '0.0774', 'HR@20': '0.1642', 'NDCG@20': '0.0875'}
2025-02-22 20:42:10,023 - EarlyStopping counter: 1 out of 10
2025-02-22 20:42:44,961 - {'epoch': 52, 'rec_loss': '6.9647'}
2025-02-22 20:42:52,903 - {'Epoch': 52, 'HR@5': '0.0914', 'NDCG@5': '0.0669', 'HR@10': '0.1245', 'NDCG@10': '0.0775', 'HR@20': '0.1646', 'NDCG@20': '0.0877'}
2025-02-22 20:42:52,910 - EarlyStopping counter: 2 out of 10
2025-02-22 20:43:27,305 - {'epoch': 53, 'rec_loss': '6.9478'}
2025-02-22 20:43:35,379 - {'Epoch': 53, 'HR@5': '0.0930', 'NDCG@5': '0.0671', 'HR@10': '0.1250', 'NDCG@10': '0.0774', 'HR@20': '0.1646', 'NDCG@20': '0.0874'}
2025-02-22 20:43:35,385 - EarlyStopping counter: 3 out of 10
2025-02-22 20:44:10,075 - {'epoch': 54, 'rec_loss': '6.9428'}
2025-02-22 20:44:18,291 - {'Epoch': 54, 'HR@5': '0.0928', 'NDCG@5': '0.0673', 'HR@10': '0.1245', 'NDCG@10': '0.0775', 'HR@20': '0.1648', 'NDCG@20': '0.0876'}
2025-02-22 20:44:18,298 - EarlyStopping counter: 4 out of 10
2025-02-22 20:44:51,821 - {'epoch': 55, 'rec_loss': '6.9312'}
2025-02-22 20:45:00,635 - {'Epoch': 55, 'HR@5': '0.0923', 'NDCG@5': '0.0672', 'HR@10': '0.1256', 'NDCG@10': '0.0778', 'HR@20': '0.1645', 'NDCG@20': '0.0876'}
2025-02-22 20:45:00,642 - EarlyStopping counter: 5 out of 10
2025-02-22 20:45:33,335 - {'epoch': 56, 'rec_loss': '6.9462'}
2025-02-22 20:45:42,108 - {'Epoch': 56, 'HR@5': '0.0930', 'NDCG@5': '0.0671', 'HR@10': '0.1258', 'NDCG@10': '0.0776', 'HR@20': '0.1639', 'NDCG@20': '0.0872'}
2025-02-22 20:45:42,114 - EarlyStopping counter: 6 out of 10
2025-02-22 20:46:16,686 - {'epoch': 57, 'rec_loss': '6.9308'}
2025-02-22 20:46:25,463 - {'Epoch': 57, 'HR@5': '0.0929', 'NDCG@5': '0.0678', 'HR@10': '0.1248', 'NDCG@10': '0.0781', 'HR@20': '0.1628', 'NDCG@20': '0.0877'}
2025-02-22 20:46:25,470 - EarlyStopping counter: 7 out of 10
2025-02-22 20:46:58,251 - {'epoch': 58, 'rec_loss': '6.9239'}
2025-02-22 20:47:06,738 - {'Epoch': 58, 'HR@5': '0.0925', 'NDCG@5': '0.0672', 'HR@10': '0.1257', 'NDCG@10': '0.0779', 'HR@20': '0.1644', 'NDCG@20': '0.0877'}
2025-02-22 20:47:06,744 - EarlyStopping counter: 8 out of 10
2025-02-22 20:47:37,368 - {'epoch': 59, 'rec_loss': '6.9289'}
2025-02-22 20:47:45,484 - {'Epoch': 59, 'HR@5': '0.0928', 'NDCG@5': '0.0679', 'HR@10': '0.1254', 'NDCG@10': '0.0785', 'HR@20': '0.1654', 'NDCG@20': '0.0885'}
2025-02-22 20:47:45,491 - EarlyStopping counter: 9 out of 10
2025-02-22 20:48:24,166 - {'epoch': 60, 'rec_loss': '6.9200'}
2025-02-22 20:48:33,128 - {'Epoch': 60, 'HR@5': '0.0937', 'NDCG@5': '0.0675', 'HR@10': '0.1247', 'NDCG@10': '0.0775', 'HR@20': '0.1635', 'NDCG@20': '0.0873'}
2025-02-22 20:48:33,136 - EarlyStopping counter: 10 out of 10
2025-02-22 20:48:33,136 - Early stopping
2025-02-22 20:48:33,136 - ---------------Test Score---------------
2025-02-22 20:48:41,771 - {'Epoch': 0, 'HR@5': '0.0771', 'NDCG@5': '0.0555', 'HR@10': '0.1040', 'NDCG@10': '0.0642', 'HR@20': '0.1403', 'NDCG@20': '0.0733'}
2025-02-22 20:48:41,779 - Scale_Toys
2025-02-22 20:48:41,779 - {'Epoch': 0, 'HR@5': '0.0771', 'NDCG@5': '0.0555', 'HR@10': '0.1040', 'NDCG@10': '0.0642', 'HR@20': '0.1403', 'NDCG@20': '0.0733'}
2025-02-22 21:51:55,385 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[10, 5], kernels=[4, 8, 12], start_prob=0.3, end_prob=0.9, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-02-22 21:52:04,437 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-22 21:52:04,447 - Total Parameters: 916817
2025-02-22 21:52:39,908 - {'epoch': 0, 'rec_loss': '9.1002'}
2025-02-22 21:52:48,532 - {'Epoch': 0, 'HR@5': '0.0060', 'NDCG@5': '0.0039', 'HR@10': '0.0115', 'NDCG@10': '0.0057', 'HR@20': '0.0176', 'NDCG@20': '0.0072'}
2025-02-22 21:52:48,536 - Validation score increased.  Saving model ...
2025-02-22 21:53:24,575 - {'epoch': 1, 'rec_loss': '8.7796'}
2025-02-22 21:53:33,034 - {'Epoch': 1, 'HR@5': '0.0120', 'NDCG@5': '0.0079', 'HR@10': '0.0191', 'NDCG@10': '0.0102', 'HR@20': '0.0301', 'NDCG@20': '0.0130'}
2025-02-22 21:53:33,040 - Validation score increased.  Saving model ...
2025-02-22 21:54:08,194 - {'epoch': 2, 'rec_loss': '8.5437'}
2025-02-22 21:54:16,730 - {'Epoch': 2, 'HR@5': '0.0198', 'NDCG@5': '0.0139', 'HR@10': '0.0311', 'NDCG@10': '0.0175', 'HR@20': '0.0493', 'NDCG@20': '0.0221'}
2025-02-22 21:54:16,736 - Validation score increased.  Saving model ...
2025-02-22 21:54:51,958 - {'epoch': 3, 'rec_loss': '8.3488'}
2025-02-22 21:54:59,595 - {'Epoch': 3, 'HR@5': '0.0317', 'NDCG@5': '0.0227', 'HR@10': '0.0490', 'NDCG@10': '0.0283', 'HR@20': '0.0709', 'NDCG@20': '0.0338'}
2025-02-22 21:54:59,600 - Validation score increased.  Saving model ...
2025-02-22 21:55:33,956 - {'epoch': 4, 'rec_loss': '8.1717'}
2025-02-22 21:55:41,808 - {'Epoch': 4, 'HR@5': '0.0413', 'NDCG@5': '0.0291', 'HR@10': '0.0613', 'NDCG@10': '0.0355', 'HR@20': '0.0894', 'NDCG@20': '0.0426'}
2025-02-22 21:55:41,814 - Validation score increased.  Saving model ...
2025-02-22 21:56:16,639 - {'epoch': 5, 'rec_loss': '8.0206'}
2025-02-22 21:56:24,148 - {'Epoch': 5, 'HR@5': '0.0496', 'NDCG@5': '0.0346', 'HR@10': '0.0729', 'NDCG@10': '0.0421', 'HR@20': '0.1017', 'NDCG@20': '0.0494'}
2025-02-22 21:56:24,154 - Validation score increased.  Saving model ...
2025-02-22 21:56:59,167 - {'epoch': 6, 'rec_loss': '7.9040'}
2025-02-22 21:57:07,570 - {'Epoch': 6, 'HR@5': '0.0577', 'NDCG@5': '0.0407', 'HR@10': '0.0812', 'NDCG@10': '0.0482', 'HR@20': '0.1141', 'NDCG@20': '0.0565'}
2025-02-22 21:57:07,577 - Validation score increased.  Saving model ...
2025-02-22 21:57:45,802 - {'epoch': 7, 'rec_loss': '7.8148'}
2025-02-22 21:57:54,306 - {'Epoch': 7, 'HR@5': '0.0625', 'NDCG@5': '0.0436', 'HR@10': '0.0890', 'NDCG@10': '0.0521', 'HR@20': '0.1208', 'NDCG@20': '0.0601'}
2025-02-22 21:57:54,311 - Validation score increased.  Saving model ...
2025-02-22 21:58:27,193 - {'epoch': 8, 'rec_loss': '7.7356'}
2025-02-22 21:58:35,839 - {'Epoch': 8, 'HR@5': '0.0671', 'NDCG@5': '0.0473', 'HR@10': '0.0959', 'NDCG@10': '0.0566', 'HR@20': '0.1305', 'NDCG@20': '0.0653'}
2025-02-22 21:58:35,845 - Validation score increased.  Saving model ...
2025-02-22 21:59:09,128 - {'epoch': 9, 'rec_loss': '7.6647'}
2025-02-22 21:59:17,798 - {'Epoch': 9, 'HR@5': '0.0713', 'NDCG@5': '0.0505', 'HR@10': '0.0987', 'NDCG@10': '0.0593', 'HR@20': '0.1349', 'NDCG@20': '0.0684'}
2025-02-22 21:59:17,800 - Validation score increased.  Saving model ...
2025-02-22 21:59:50,583 - {'epoch': 10, 'rec_loss': '7.6094'}
2025-02-22 21:59:59,096 - {'Epoch': 10, 'HR@5': '0.0754', 'NDCG@5': '0.0535', 'HR@10': '0.1028', 'NDCG@10': '0.0623', 'HR@20': '0.1398', 'NDCG@20': '0.0716'}
2025-02-22 21:59:59,103 - Validation score increased.  Saving model ...
2025-02-22 22:00:33,194 - {'epoch': 11, 'rec_loss': '7.5635'}
2025-02-22 22:00:40,688 - {'Epoch': 11, 'HR@5': '0.0774', 'NDCG@5': '0.0548', 'HR@10': '0.1057', 'NDCG@10': '0.0639', 'HR@20': '0.1426', 'NDCG@20': '0.0732'}
2025-02-22 22:00:40,689 - Validation score increased.  Saving model ...
2025-02-22 22:01:13,900 - {'epoch': 12, 'rec_loss': '7.5184'}
2025-02-22 22:01:21,496 - {'Epoch': 12, 'HR@5': '0.0798', 'NDCG@5': '0.0569', 'HR@10': '0.1072', 'NDCG@10': '0.0657', 'HR@20': '0.1437', 'NDCG@20': '0.0749'}
2025-02-22 22:01:21,501 - Validation score increased.  Saving model ...
2025-02-22 22:01:57,594 - {'epoch': 13, 'rec_loss': '7.4841'}
2025-02-22 22:02:06,273 - {'Epoch': 13, 'HR@5': '0.0802', 'NDCG@5': '0.0570', 'HR@10': '0.1099', 'NDCG@10': '0.0666', 'HR@20': '0.1461', 'NDCG@20': '0.0757'}
2025-02-22 22:02:06,279 - Validation score increased.  Saving model ...
2025-02-22 22:02:43,283 - {'epoch': 14, 'rec_loss': '7.4569'}
2025-02-22 22:02:51,709 - {'Epoch': 14, 'HR@5': '0.0820', 'NDCG@5': '0.0585', 'HR@10': '0.1119', 'NDCG@10': '0.0681', 'HR@20': '0.1476', 'NDCG@20': '0.0771'}
2025-02-22 22:02:51,715 - Validation score increased.  Saving model ...
2025-02-22 22:03:27,550 - {'epoch': 15, 'rec_loss': '7.4264'}
2025-02-22 22:03:34,983 - {'Epoch': 15, 'HR@5': '0.0838', 'NDCG@5': '0.0599', 'HR@10': '0.1140', 'NDCG@10': '0.0696', 'HR@20': '0.1483', 'NDCG@20': '0.0783'}
2025-02-22 22:03:34,989 - Validation score increased.  Saving model ...
2025-02-22 22:04:09,336 - {'epoch': 16, 'rec_loss': '7.4022'}
2025-02-22 22:04:17,925 - {'Epoch': 16, 'HR@5': '0.0843', 'NDCG@5': '0.0599', 'HR@10': '0.1145', 'NDCG@10': '0.0697', 'HR@20': '0.1509', 'NDCG@20': '0.0789'}
2025-02-22 22:04:17,932 - Validation score increased.  Saving model ...
2025-02-22 22:04:52,044 - {'epoch': 17, 'rec_loss': '7.3573'}
2025-02-22 22:05:00,496 - {'Epoch': 17, 'HR@5': '0.0846', 'NDCG@5': '0.0610', 'HR@10': '0.1153', 'NDCG@10': '0.0709', 'HR@20': '0.1532', 'NDCG@20': '0.0805'}
2025-02-22 22:05:00,502 - Validation score increased.  Saving model ...
2025-02-22 22:05:34,995 - {'epoch': 18, 'rec_loss': '7.3463'}
2025-02-22 22:05:43,192 - {'Epoch': 18, 'HR@5': '0.0844', 'NDCG@5': '0.0604', 'HR@10': '0.1147', 'NDCG@10': '0.0702', 'HR@20': '0.1524', 'NDCG@20': '0.0797'}
2025-02-22 22:05:43,199 - EarlyStopping counter: 1 out of 10
2025-02-22 22:06:17,840 - {'epoch': 19, 'rec_loss': '7.3235'}
2025-02-22 22:06:25,258 - {'Epoch': 19, 'HR@5': '0.0849', 'NDCG@5': '0.0614', 'HR@10': '0.1156', 'NDCG@10': '0.0712', 'HR@20': '0.1531', 'NDCG@20': '0.0807'}
2025-02-22 22:06:25,263 - Validation score increased.  Saving model ...
2025-02-22 22:06:59,016 - {'epoch': 20, 'rec_loss': '7.3062'}
2025-02-22 22:07:07,597 - {'Epoch': 20, 'HR@5': '0.0859', 'NDCG@5': '0.0613', 'HR@10': '0.1176', 'NDCG@10': '0.0715', 'HR@20': '0.1550', 'NDCG@20': '0.0809'}
2025-02-22 22:07:07,604 - Validation score increased.  Saving model ...
2025-02-22 22:07:41,322 - {'epoch': 21, 'rec_loss': '7.2807'}
2025-02-22 22:07:49,015 - {'Epoch': 21, 'HR@5': '0.0870', 'NDCG@5': '0.0628', 'HR@10': '0.1167', 'NDCG@10': '0.0724', 'HR@20': '0.1541', 'NDCG@20': '0.0818'}
2025-02-22 22:07:49,020 - Validation score increased.  Saving model ...
2025-02-22 22:08:23,001 - {'epoch': 22, 'rec_loss': '7.2710'}
2025-02-22 22:08:31,772 - {'Epoch': 22, 'HR@5': '0.0877', 'NDCG@5': '0.0630', 'HR@10': '0.1182', 'NDCG@10': '0.0728', 'HR@20': '0.1563', 'NDCG@20': '0.0824'}
2025-02-22 22:08:31,779 - Validation score increased.  Saving model ...
2025-02-22 22:09:05,510 - {'epoch': 23, 'rec_loss': '7.2564'}
2025-02-22 22:09:13,440 - {'Epoch': 23, 'HR@5': '0.0868', 'NDCG@5': '0.0620', 'HR@10': '0.1185', 'NDCG@10': '0.0722', 'HR@20': '0.1568', 'NDCG@20': '0.0818'}
2025-02-22 22:09:13,446 - EarlyStopping counter: 1 out of 10
2025-02-22 22:09:48,413 - {'epoch': 24, 'rec_loss': '7.2420'}
2025-02-22 22:09:57,050 - {'Epoch': 24, 'HR@5': '0.0898', 'NDCG@5': '0.0637', 'HR@10': '0.1198', 'NDCG@10': '0.0734', 'HR@20': '0.1565', 'NDCG@20': '0.0827'}
2025-02-22 22:09:57,056 - Validation score increased.  Saving model ...
2025-02-22 22:10:30,653 - {'epoch': 25, 'rec_loss': '7.2197'}
2025-02-22 22:10:38,220 - {'Epoch': 25, 'HR@5': '0.0897', 'NDCG@5': '0.0636', 'HR@10': '0.1219', 'NDCG@10': '0.0739', 'HR@20': '0.1580', 'NDCG@20': '0.0830'}
2025-02-22 22:10:38,226 - Validation score increased.  Saving model ...
2025-02-22 22:11:12,687 - {'epoch': 26, 'rec_loss': '7.2064'}
2025-02-22 22:11:21,280 - {'Epoch': 26, 'HR@5': '0.0896', 'NDCG@5': '0.0640', 'HR@10': '0.1196', 'NDCG@10': '0.0737', 'HR@20': '0.1571', 'NDCG@20': '0.0831'}
2025-02-22 22:11:21,286 - Validation score increased.  Saving model ...
2025-02-22 22:11:55,159 - {'epoch': 27, 'rec_loss': '7.2004'}
2025-02-22 22:12:02,735 - {'Epoch': 27, 'HR@5': '0.0896', 'NDCG@5': '0.0634', 'HR@10': '0.1206', 'NDCG@10': '0.0734', 'HR@20': '0.1577', 'NDCG@20': '0.0827'}
2025-02-22 22:12:02,741 - EarlyStopping counter: 1 out of 10
2025-02-22 22:12:31,532 - {'epoch': 28, 'rec_loss': '7.1857'}
2025-02-22 22:12:40,094 - {'Epoch': 28, 'HR@5': '0.0904', 'NDCG@5': '0.0647', 'HR@10': '0.1208', 'NDCG@10': '0.0745', 'HR@20': '0.1582', 'NDCG@20': '0.0839'}
2025-02-22 22:12:40,101 - Validation score increased.  Saving model ...
2025-02-22 22:13:17,967 - {'epoch': 29, 'rec_loss': '7.1752'}
2025-02-22 22:13:26,545 - {'Epoch': 29, 'HR@5': '0.0912', 'NDCG@5': '0.0652', 'HR@10': '0.1202', 'NDCG@10': '0.0745', 'HR@20': '0.1583', 'NDCG@20': '0.0841'}
2025-02-22 22:13:26,553 - Validation score increased.  Saving model ...
2025-02-22 22:14:03,693 - {'epoch': 30, 'rec_loss': '7.1694'}
2025-02-22 22:14:11,616 - {'Epoch': 30, 'HR@5': '0.0897', 'NDCG@5': '0.0642', 'HR@10': '0.1206', 'NDCG@10': '0.0742', 'HR@20': '0.1577', 'NDCG@20': '0.0835'}
2025-02-22 22:14:11,624 - EarlyStopping counter: 1 out of 10
2025-02-22 22:14:48,873 - {'epoch': 31, 'rec_loss': '7.1524'}
2025-02-22 22:14:56,604 - {'Epoch': 31, 'HR@5': '0.0909', 'NDCG@5': '0.0641', 'HR@10': '0.1212', 'NDCG@10': '0.0739', 'HR@20': '0.1580', 'NDCG@20': '0.0832'}
2025-02-22 22:14:56,610 - EarlyStopping counter: 2 out of 10
2025-02-22 22:15:31,118 - {'epoch': 32, 'rec_loss': '7.1424'}
2025-02-22 22:15:38,820 - {'Epoch': 32, 'HR@5': '0.0891', 'NDCG@5': '0.0644', 'HR@10': '0.1225', 'NDCG@10': '0.0751', 'HR@20': '0.1596', 'NDCG@20': '0.0845'}
2025-02-22 22:15:38,825 - Validation score increased.  Saving model ...
2025-02-22 22:16:13,639 - {'epoch': 33, 'rec_loss': '7.1382'}
2025-02-22 22:16:21,230 - {'Epoch': 33, 'HR@5': '0.0892', 'NDCG@5': '0.0637', 'HR@10': '0.1216', 'NDCG@10': '0.0742', 'HR@20': '0.1604', 'NDCG@20': '0.0840'}
2025-02-22 22:16:21,235 - EarlyStopping counter: 1 out of 10
2025-02-22 22:16:56,324 - {'epoch': 34, 'rec_loss': '7.1240'}
2025-02-22 22:17:05,199 - {'Epoch': 34, 'HR@5': '0.0907', 'NDCG@5': '0.0646', 'HR@10': '0.1214', 'NDCG@10': '0.0745', 'HR@20': '0.1608', 'NDCG@20': '0.0844'}
2025-02-22 22:17:05,206 - EarlyStopping counter: 2 out of 10
2025-02-22 22:17:39,360 - {'epoch': 35, 'rec_loss': '7.1099'}
2025-02-22 22:17:47,137 - {'Epoch': 35, 'HR@5': '0.0904', 'NDCG@5': '0.0650', 'HR@10': '0.1207', 'NDCG@10': '0.0748', 'HR@20': '0.1605', 'NDCG@20': '0.0849'}
2025-02-22 22:17:47,142 - Validation score increased.  Saving model ...
2025-02-22 22:18:21,437 - {'epoch': 36, 'rec_loss': '7.1083'}
2025-02-22 22:18:30,196 - {'Epoch': 36, 'HR@5': '0.0894', 'NDCG@5': '0.0645', 'HR@10': '0.1206', 'NDCG@10': '0.0746', 'HR@20': '0.1618', 'NDCG@20': '0.0850'}
2025-02-22 22:18:30,201 - Validation score increased.  Saving model ...
2025-02-22 22:19:04,252 - {'epoch': 37, 'rec_loss': '7.0959'}
2025-02-22 22:19:13,028 - {'Epoch': 37, 'HR@5': '0.0910', 'NDCG@5': '0.0649', 'HR@10': '0.1211', 'NDCG@10': '0.0746', 'HR@20': '0.1596', 'NDCG@20': '0.0843'}
2025-02-22 22:19:13,032 - EarlyStopping counter: 1 out of 10
2025-02-22 22:19:46,728 - {'epoch': 38, 'rec_loss': '7.0986'}
2025-02-22 22:19:54,491 - {'Epoch': 38, 'HR@5': '0.0912', 'NDCG@5': '0.0655', 'HR@10': '0.1224', 'NDCG@10': '0.0756', 'HR@20': '0.1604', 'NDCG@20': '0.0851'}
2025-02-22 22:19:54,499 - Validation score increased.  Saving model ...
2025-02-22 22:20:28,323 - {'epoch': 39, 'rec_loss': '7.0789'}
2025-02-22 22:20:36,754 - {'Epoch': 39, 'HR@5': '0.0911', 'NDCG@5': '0.0651', 'HR@10': '0.1225', 'NDCG@10': '0.0752', 'HR@20': '0.1610', 'NDCG@20': '0.0849'}
2025-02-22 22:20:36,761 - EarlyStopping counter: 1 out of 10
2025-02-22 22:21:10,822 - {'epoch': 40, 'rec_loss': '7.0694'}
2025-02-22 22:21:19,783 - {'Epoch': 40, 'HR@5': '0.0906', 'NDCG@5': '0.0650', 'HR@10': '0.1230', 'NDCG@10': '0.0755', 'HR@20': '0.1609', 'NDCG@20': '0.0850'}
2025-02-22 22:21:19,790 - EarlyStopping counter: 2 out of 10
2025-02-22 22:21:53,231 - {'epoch': 41, 'rec_loss': '7.0638'}
2025-02-22 22:22:02,277 - {'Epoch': 41, 'HR@5': '0.0928', 'NDCG@5': '0.0662', 'HR@10': '0.1228', 'NDCG@10': '0.0759', 'HR@20': '0.1628', 'NDCG@20': '0.0860'}
2025-02-22 22:22:02,285 - Validation score increased.  Saving model ...
2025-02-22 22:22:35,890 - {'epoch': 42, 'rec_loss': '7.0557'}
2025-02-22 22:22:43,740 - {'Epoch': 42, 'HR@5': '0.0921', 'NDCG@5': '0.0660', 'HR@10': '0.1220', 'NDCG@10': '0.0756', 'HR@20': '0.1607', 'NDCG@20': '0.0854'}
2025-02-22 22:22:43,747 - EarlyStopping counter: 1 out of 10
2025-02-22 22:23:16,857 - {'epoch': 43, 'rec_loss': '7.0511'}
2025-02-22 22:23:24,972 - {'Epoch': 43, 'HR@5': '0.0912', 'NDCG@5': '0.0655', 'HR@10': '0.1232', 'NDCG@10': '0.0758', 'HR@20': '0.1611', 'NDCG@20': '0.0853'}
2025-02-22 22:23:24,981 - EarlyStopping counter: 2 out of 10
2025-02-22 22:24:01,596 - {'epoch': 44, 'rec_loss': '7.0539'}
2025-02-22 22:24:10,116 - {'Epoch': 44, 'HR@5': '0.0912', 'NDCG@5': '0.0656', 'HR@10': '0.1234', 'NDCG@10': '0.0759', 'HR@20': '0.1605', 'NDCG@20': '0.0853'}
2025-02-22 22:24:10,123 - EarlyStopping counter: 3 out of 10
2025-02-22 22:24:46,531 - {'epoch': 45, 'rec_loss': '7.0387'}
2025-02-22 22:24:55,277 - {'Epoch': 45, 'HR@5': '0.0926', 'NDCG@5': '0.0673', 'HR@10': '0.1248', 'NDCG@10': '0.0777', 'HR@20': '0.1619', 'NDCG@20': '0.0870'}
2025-02-22 22:24:55,284 - Validation score increased.  Saving model ...
2025-02-22 22:25:29,282 - {'epoch': 46, 'rec_loss': '7.0327'}
2025-02-22 22:25:38,295 - {'Epoch': 46, 'HR@5': '0.0914', 'NDCG@5': '0.0664', 'HR@10': '0.1248', 'NDCG@10': '0.0771', 'HR@20': '0.1634', 'NDCG@20': '0.0868'}
2025-02-22 22:25:38,301 - EarlyStopping counter: 1 out of 10
2025-02-22 22:26:13,381 - {'epoch': 47, 'rec_loss': '7.0227'}
2025-02-22 22:26:21,788 - {'Epoch': 47, 'HR@5': '0.0923', 'NDCG@5': '0.0667', 'HR@10': '0.1242', 'NDCG@10': '0.0769', 'HR@20': '0.1641', 'NDCG@20': '0.0870'}
2025-02-22 22:26:21,793 - EarlyStopping counter: 2 out of 10
2025-02-22 22:26:55,991 - {'epoch': 48, 'rec_loss': '7.0239'}
2025-02-22 22:27:04,915 - {'Epoch': 48, 'HR@5': '0.0923', 'NDCG@5': '0.0666', 'HR@10': '0.1227', 'NDCG@10': '0.0764', 'HR@20': '0.1610', 'NDCG@20': '0.0860'}
2025-02-22 22:27:04,916 - EarlyStopping counter: 3 out of 10
2025-02-22 22:27:38,217 - {'epoch': 49, 'rec_loss': '7.0193'}
2025-02-22 22:27:46,959 - {'Epoch': 49, 'HR@5': '0.0920', 'NDCG@5': '0.0658', 'HR@10': '0.1235', 'NDCG@10': '0.0759', 'HR@20': '0.1624', 'NDCG@20': '0.0857'}
2025-02-22 22:27:46,966 - EarlyStopping counter: 4 out of 10
2025-02-22 22:28:21,219 - {'epoch': 50, 'rec_loss': '7.0161'}
2025-02-22 22:28:29,775 - {'Epoch': 50, 'HR@5': '0.0932', 'NDCG@5': '0.0672', 'HR@10': '0.1240', 'NDCG@10': '0.0771', 'HR@20': '0.1629', 'NDCG@20': '0.0869'}
2025-02-22 22:28:29,782 - EarlyStopping counter: 5 out of 10
2025-02-22 22:29:06,151 - {'epoch': 51, 'rec_loss': '7.0055'}
2025-02-22 22:29:14,905 - {'Epoch': 51, 'HR@5': '0.0921', 'NDCG@5': '0.0661', 'HR@10': '0.1226', 'NDCG@10': '0.0760', 'HR@20': '0.1617', 'NDCG@20': '0.0858'}
2025-02-22 22:29:14,911 - EarlyStopping counter: 6 out of 10
2025-02-22 22:29:48,092 - {'epoch': 52, 'rec_loss': '7.0106'}
2025-02-22 22:29:56,716 - {'Epoch': 52, 'HR@5': '0.0935', 'NDCG@5': '0.0673', 'HR@10': '0.1232', 'NDCG@10': '0.0768', 'HR@20': '0.1626', 'NDCG@20': '0.0868'}
2025-02-22 22:29:56,725 - EarlyStopping counter: 7 out of 10
2025-02-22 22:30:30,211 - {'epoch': 53, 'rec_loss': '6.9907'}
2025-02-22 22:30:38,904 - {'Epoch': 53, 'HR@5': '0.0912', 'NDCG@5': '0.0660', 'HR@10': '0.1233', 'NDCG@10': '0.0763', 'HR@20': '0.1619', 'NDCG@20': '0.0860'}
2025-02-22 22:30:38,910 - EarlyStopping counter: 8 out of 10
2025-02-22 22:31:11,786 - {'epoch': 54, 'rec_loss': '6.9922'}
2025-02-22 22:31:20,499 - {'Epoch': 54, 'HR@5': '0.0914', 'NDCG@5': '0.0662', 'HR@10': '0.1240', 'NDCG@10': '0.0767', 'HR@20': '0.1628', 'NDCG@20': '0.0865'}
2025-02-22 22:31:20,506 - EarlyStopping counter: 9 out of 10
2025-02-22 22:31:54,303 - {'epoch': 55, 'rec_loss': '6.9764'}
2025-02-22 22:32:02,920 - {'Epoch': 55, 'HR@5': '0.0922', 'NDCG@5': '0.0669', 'HR@10': '0.1231', 'NDCG@10': '0.0768', 'HR@20': '0.1624', 'NDCG@20': '0.0867'}
2025-02-22 22:32:02,927 - EarlyStopping counter: 10 out of 10
2025-02-22 22:32:02,927 - Early stopping
2025-02-22 22:32:02,927 - ---------------Test Score---------------
2025-02-22 22:32:11,771 - {'Epoch': 0, 'HR@5': '0.0767', 'NDCG@5': '0.0550', 'HR@10': '0.1015', 'NDCG@10': '0.0630', 'HR@20': '0.1353', 'NDCG@20': '0.0715'}
2025-02-22 22:32:11,777 - Scale_Toys
2025-02-22 22:32:11,777 - {'Epoch': 0, 'HR@5': '0.0767', 'NDCG@5': '0.0550', 'HR@10': '0.1015', 'NDCG@10': '0.0630', 'HR@20': '0.1353', 'NDCG@20': '0.0715'}
2025-02-22 23:12:16,124 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[10, 5], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.9, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-02-22 23:12:25,324 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-22 23:12:25,337 - Total Parameters: 916817
2025-02-22 23:13:00,796 - {'epoch': 0, 'rec_loss': '9.0910'}
2025-02-22 23:13:09,102 - {'Epoch': 0, 'HR@5': '0.0064', 'NDCG@5': '0.0039', 'HR@10': '0.0121', 'NDCG@10': '0.0057', 'HR@20': '0.0183', 'NDCG@20': '0.0072'}
2025-02-22 23:13:09,104 - Validation score increased.  Saving model ...
2025-02-22 23:13:44,010 - {'epoch': 1, 'rec_loss': '8.7396'}
2025-02-22 23:13:52,420 - {'Epoch': 1, 'HR@5': '0.0138', 'NDCG@5': '0.0091', 'HR@10': '0.0217', 'NDCG@10': '0.0117', 'HR@20': '0.0346', 'NDCG@20': '0.0149'}
2025-02-22 23:13:52,421 - Validation score increased.  Saving model ...
2025-02-22 23:14:28,299 - {'epoch': 2, 'rec_loss': '8.4846'}
2025-02-22 23:14:36,321 - {'Epoch': 2, 'HR@5': '0.0245', 'NDCG@5': '0.0170', 'HR@10': '0.0371', 'NDCG@10': '0.0211', 'HR@20': '0.0569', 'NDCG@20': '0.0260'}
2025-02-22 23:14:36,326 - Validation score increased.  Saving model ...
2025-02-22 23:15:12,823 - {'epoch': 3, 'rec_loss': '8.2599'}
2025-02-22 23:15:20,895 - {'Epoch': 3, 'HR@5': '0.0378', 'NDCG@5': '0.0270', 'HR@10': '0.0554', 'NDCG@10': '0.0327', 'HR@20': '0.0795', 'NDCG@20': '0.0388'}
2025-02-22 23:15:20,900 - Validation score increased.  Saving model ...
2025-02-22 23:15:56,439 - {'epoch': 4, 'rec_loss': '8.0667'}
2025-02-22 23:16:05,515 - {'Epoch': 4, 'HR@5': '0.0498', 'NDCG@5': '0.0343', 'HR@10': '0.0712', 'NDCG@10': '0.0412', 'HR@20': '0.1001', 'NDCG@20': '0.0485'}
2025-02-22 23:16:05,521 - Validation score increased.  Saving model ...
2025-02-22 23:16:40,017 - {'epoch': 5, 'rec_loss': '7.9095'}
2025-02-22 23:16:48,272 - {'Epoch': 5, 'HR@5': '0.0577', 'NDCG@5': '0.0405', 'HR@10': '0.0820', 'NDCG@10': '0.0484', 'HR@20': '0.1137', 'NDCG@20': '0.0563'}
2025-02-22 23:16:48,277 - Validation score increased.  Saving model ...
2025-02-22 23:17:23,845 - {'epoch': 6, 'rec_loss': '7.7925'}
2025-02-22 23:17:31,669 - {'Epoch': 6, 'HR@5': '0.0647', 'NDCG@5': '0.0455', 'HR@10': '0.0896', 'NDCG@10': '0.0536', 'HR@20': '0.1244', 'NDCG@20': '0.0623'}
2025-02-22 23:17:31,675 - Validation score increased.  Saving model ...
2025-02-22 23:18:06,212 - {'epoch': 7, 'rec_loss': '7.7032'}
2025-02-22 23:18:13,961 - {'Epoch': 7, 'HR@5': '0.0676', 'NDCG@5': '0.0477', 'HR@10': '0.0955', 'NDCG@10': '0.0567', 'HR@20': '0.1311', 'NDCG@20': '0.0657'}
2025-02-22 23:18:13,962 - Validation score increased.  Saving model ...
2025-02-22 23:18:51,324 - {'epoch': 8, 'rec_loss': '7.6215'}
2025-02-22 23:19:00,011 - {'Epoch': 8, 'HR@5': '0.0738', 'NDCG@5': '0.0517', 'HR@10': '0.1006', 'NDCG@10': '0.0604', 'HR@20': '0.1389', 'NDCG@20': '0.0700'}
2025-02-22 23:19:00,012 - Validation score increased.  Saving model ...
2025-02-22 23:19:36,770 - {'epoch': 9, 'rec_loss': '7.5527'}
2025-02-22 23:19:45,075 - {'Epoch': 9, 'HR@5': '0.0769', 'NDCG@5': '0.0544', 'HR@10': '0.1044', 'NDCG@10': '0.0632', 'HR@20': '0.1415', 'NDCG@20': '0.0726'}
2025-02-22 23:19:45,083 - Validation score increased.  Saving model ...
2025-02-22 23:20:19,808 - {'epoch': 10, 'rec_loss': '7.4992'}
2025-02-22 23:20:27,289 - {'Epoch': 10, 'HR@5': '0.0795', 'NDCG@5': '0.0565', 'HR@10': '0.1072', 'NDCG@10': '0.0653', 'HR@20': '0.1456', 'NDCG@20': '0.0750'}
2025-02-22 23:20:27,290 - Validation score increased.  Saving model ...
2025-02-22 23:21:01,659 - {'epoch': 11, 'rec_loss': '7.4485'}
2025-02-22 23:21:10,015 - {'Epoch': 11, 'HR@5': '0.0803', 'NDCG@5': '0.0578', 'HR@10': '0.1094', 'NDCG@10': '0.0672', 'HR@20': '0.1480', 'NDCG@20': '0.0769'}
2025-02-22 23:21:10,017 - Validation score increased.  Saving model ...
2025-02-22 23:21:43,921 - {'epoch': 12, 'rec_loss': '7.4043'}
2025-02-22 23:21:52,131 - {'Epoch': 12, 'HR@5': '0.0823', 'NDCG@5': '0.0593', 'HR@10': '0.1120', 'NDCG@10': '0.0689', 'HR@20': '0.1467', 'NDCG@20': '0.0777'}
2025-02-22 23:21:52,132 - Validation score increased.  Saving model ...
2025-02-22 23:22:26,285 - {'epoch': 13, 'rec_loss': '7.3663'}
2025-02-22 23:22:33,669 - {'Epoch': 13, 'HR@5': '0.0828', 'NDCG@5': '0.0597', 'HR@10': '0.1138', 'NDCG@10': '0.0697', 'HR@20': '0.1509', 'NDCG@20': '0.0790'}
2025-02-22 23:22:33,675 - Validation score increased.  Saving model ...
2025-02-22 23:23:08,065 - {'epoch': 14, 'rec_loss': '7.3387'}
2025-02-22 23:23:17,119 - {'Epoch': 14, 'HR@5': '0.0853', 'NDCG@5': '0.0613', 'HR@10': '0.1153', 'NDCG@10': '0.0709', 'HR@20': '0.1505', 'NDCG@20': '0.0798'}
2025-02-22 23:23:17,126 - Validation score increased.  Saving model ...
2025-02-22 23:23:52,330 - {'epoch': 15, 'rec_loss': '7.3081'}
2025-02-22 23:24:00,866 - {'Epoch': 15, 'HR@5': '0.0858', 'NDCG@5': '0.0620', 'HR@10': '0.1171', 'NDCG@10': '0.0722', 'HR@20': '0.1538', 'NDCG@20': '0.0814'}
2025-02-22 23:24:00,874 - Validation score increased.  Saving model ...
2025-02-22 23:24:33,744 - {'epoch': 16, 'rec_loss': '7.2816'}
2025-02-22 23:24:41,632 - {'Epoch': 16, 'HR@5': '0.0860', 'NDCG@5': '0.0619', 'HR@10': '0.1185', 'NDCG@10': '0.0724', 'HR@20': '0.1544', 'NDCG@20': '0.0814'}
2025-02-22 23:24:41,639 - Validation score increased.  Saving model ...
2025-02-22 23:25:15,820 - {'epoch': 17, 'rec_loss': '7.2443'}
2025-02-22 23:25:23,735 - {'Epoch': 17, 'HR@5': '0.0881', 'NDCG@5': '0.0640', 'HR@10': '0.1186', 'NDCG@10': '0.0738', 'HR@20': '0.1557', 'NDCG@20': '0.0832'}
2025-02-22 23:25:23,742 - Validation score increased.  Saving model ...
2025-02-22 23:25:57,816 - {'epoch': 18, 'rec_loss': '7.2297'}
2025-02-22 23:26:06,533 - {'Epoch': 18, 'HR@5': '0.0868', 'NDCG@5': '0.0624', 'HR@10': '0.1178', 'NDCG@10': '0.0724', 'HR@20': '0.1547', 'NDCG@20': '0.0817'}
2025-02-22 23:26:06,534 - EarlyStopping counter: 1 out of 10
2025-02-22 23:26:40,347 - {'epoch': 19, 'rec_loss': '7.2063'}
2025-02-22 23:26:49,209 - {'Epoch': 19, 'HR@5': '0.0865', 'NDCG@5': '0.0633', 'HR@10': '0.1184', 'NDCG@10': '0.0736', 'HR@20': '0.1557', 'NDCG@20': '0.0829'}
2025-02-22 23:26:49,216 - EarlyStopping counter: 2 out of 10
2025-02-22 23:27:23,069 - {'epoch': 20, 'rec_loss': '7.1878'}
2025-02-22 23:27:31,216 - {'Epoch': 20, 'HR@5': '0.0875', 'NDCG@5': '0.0633', 'HR@10': '0.1197', 'NDCG@10': '0.0736', 'HR@20': '0.1576', 'NDCG@20': '0.0831'}
2025-02-22 23:27:31,217 - EarlyStopping counter: 3 out of 10
2025-02-22 23:28:05,718 - {'epoch': 21, 'rec_loss': '7.1589'}
2025-02-22 23:28:14,738 - {'Epoch': 21, 'HR@5': '0.0886', 'NDCG@5': '0.0643', 'HR@10': '0.1190', 'NDCG@10': '0.0741', 'HR@20': '0.1559', 'NDCG@20': '0.0834'}
2025-02-22 23:28:14,745 - Validation score increased.  Saving model ...
2025-02-22 23:28:49,022 - {'epoch': 22, 'rec_loss': '7.1485'}
2025-02-22 23:28:57,734 - {'Epoch': 22, 'HR@5': '0.0893', 'NDCG@5': '0.0642', 'HR@10': '0.1212', 'NDCG@10': '0.0745', 'HR@20': '0.1567', 'NDCG@20': '0.0834'}
2025-02-22 23:28:57,741 - Validation score increased.  Saving model ...
2025-02-22 23:29:25,442 - {'epoch': 23, 'rec_loss': '7.1317'}
2025-02-22 23:29:32,928 - {'Epoch': 23, 'HR@5': '0.0881', 'NDCG@5': '0.0639', 'HR@10': '0.1195', 'NDCG@10': '0.0740', 'HR@20': '0.1568', 'NDCG@20': '0.0834'}
2025-02-22 23:29:32,935 - EarlyStopping counter: 1 out of 10
2025-02-22 23:30:09,989 - {'epoch': 24, 'rec_loss': '7.1214'}
2025-02-22 23:30:18,094 - {'Epoch': 24, 'HR@5': '0.0889', 'NDCG@5': '0.0639', 'HR@10': '0.1199', 'NDCG@10': '0.0739', 'HR@20': '0.1564', 'NDCG@20': '0.0832'}
2025-02-22 23:30:18,095 - EarlyStopping counter: 2 out of 10
2025-02-22 23:30:55,661 - {'epoch': 25, 'rec_loss': '7.0971'}
2025-02-22 23:31:03,847 - {'Epoch': 25, 'HR@5': '0.0911', 'NDCG@5': '0.0656', 'HR@10': '0.1219', 'NDCG@10': '0.0755', 'HR@20': '0.1581', 'NDCG@20': '0.0846'}
2025-02-22 23:31:03,854 - Validation score increased.  Saving model ...
2025-02-22 23:31:40,992 - {'epoch': 26, 'rec_loss': '7.0839'}
2025-02-22 23:31:49,730 - {'Epoch': 26, 'HR@5': '0.0900', 'NDCG@5': '0.0653', 'HR@10': '0.1192', 'NDCG@10': '0.0747', 'HR@20': '0.1570', 'NDCG@20': '0.0842'}
2025-02-22 23:31:49,732 - EarlyStopping counter: 1 out of 10
2025-02-22 23:32:24,322 - {'epoch': 27, 'rec_loss': '7.0732'}
2025-02-22 23:32:31,843 - {'Epoch': 27, 'HR@5': '0.0908', 'NDCG@5': '0.0652', 'HR@10': '0.1233', 'NDCG@10': '0.0756', 'HR@20': '0.1585', 'NDCG@20': '0.0845'}
2025-02-22 23:32:31,851 - EarlyStopping counter: 2 out of 10
2025-02-22 23:33:06,462 - {'epoch': 28, 'rec_loss': '7.0605'}
2025-02-22 23:33:15,055 - {'Epoch': 28, 'HR@5': '0.0908', 'NDCG@5': '0.0653', 'HR@10': '0.1242', 'NDCG@10': '0.0760', 'HR@20': '0.1588', 'NDCG@20': '0.0847'}
2025-02-22 23:33:15,062 - Validation score increased.  Saving model ...
2025-02-22 23:33:49,443 - {'epoch': 29, 'rec_loss': '7.0497'}
2025-02-22 23:33:57,458 - {'Epoch': 29, 'HR@5': '0.0922', 'NDCG@5': '0.0659', 'HR@10': '0.1215', 'NDCG@10': '0.0754', 'HR@20': '0.1573', 'NDCG@20': '0.0844'}
2025-02-22 23:33:57,465 - EarlyStopping counter: 1 out of 10
2025-02-22 23:34:32,183 - {'epoch': 30, 'rec_loss': '7.0396'}
2025-02-22 23:34:39,681 - {'Epoch': 30, 'HR@5': '0.0925', 'NDCG@5': '0.0664', 'HR@10': '0.1221', 'NDCG@10': '0.0760', 'HR@20': '0.1581', 'NDCG@20': '0.0850'}
2025-02-22 23:34:39,687 - Validation score increased.  Saving model ...
2025-02-22 23:35:14,396 - {'epoch': 31, 'rec_loss': '7.0306'}
2025-02-22 23:35:22,524 - {'Epoch': 31, 'HR@5': '0.0917', 'NDCG@5': '0.0656', 'HR@10': '0.1220', 'NDCG@10': '0.0754', 'HR@20': '0.1581', 'NDCG@20': '0.0845'}
2025-02-22 23:35:22,529 - EarlyStopping counter: 1 out of 10
2025-02-22 23:35:56,735 - {'epoch': 32, 'rec_loss': '7.0188'}
2025-02-22 23:36:05,688 - {'Epoch': 32, 'HR@5': '0.0923', 'NDCG@5': '0.0666', 'HR@10': '0.1227', 'NDCG@10': '0.0764', 'HR@20': '0.1595', 'NDCG@20': '0.0857'}
2025-02-22 23:36:05,696 - Validation score increased.  Saving model ...
2025-02-22 23:36:40,035 - {'epoch': 33, 'rec_loss': '7.0113'}
2025-02-22 23:36:47,822 - {'Epoch': 33, 'HR@5': '0.0909', 'NDCG@5': '0.0662', 'HR@10': '0.1223', 'NDCG@10': '0.0762', 'HR@20': '0.1614', 'NDCG@20': '0.0861'}
2025-02-22 23:36:47,824 - Validation score increased.  Saving model ...
2025-02-22 23:37:21,402 - {'epoch': 34, 'rec_loss': '6.9951'}
2025-02-22 23:37:29,550 - {'Epoch': 34, 'HR@5': '0.0924', 'NDCG@5': '0.0666', 'HR@10': '0.1232', 'NDCG@10': '0.0766', 'HR@20': '0.1610', 'NDCG@20': '0.0861'}
2025-02-22 23:37:29,555 - Validation score increased.  Saving model ...
2025-02-22 23:38:04,269 - {'epoch': 35, 'rec_loss': '6.9888'}
2025-02-22 23:38:12,774 - {'Epoch': 35, 'HR@5': '0.0915', 'NDCG@5': '0.0667', 'HR@10': '0.1238', 'NDCG@10': '0.0772', 'HR@20': '0.1604', 'NDCG@20': '0.0864'}
2025-02-22 23:38:12,781 - Validation score increased.  Saving model ...
2025-02-22 23:38:47,936 - {'epoch': 36, 'rec_loss': '6.9876'}
2025-02-22 23:38:56,128 - {'Epoch': 36, 'HR@5': '0.0927', 'NDCG@5': '0.0670', 'HR@10': '0.1237', 'NDCG@10': '0.0769', 'HR@20': '0.1599', 'NDCG@20': '0.0860'}
2025-02-22 23:38:56,134 - EarlyStopping counter: 1 out of 10
2025-02-22 23:39:30,073 - {'epoch': 37, 'rec_loss': '6.9704'}
2025-02-22 23:39:38,945 - {'Epoch': 37, 'HR@5': '0.0920', 'NDCG@5': '0.0665', 'HR@10': '0.1231', 'NDCG@10': '0.0766', 'HR@20': '0.1589', 'NDCG@20': '0.0856'}
2025-02-22 23:39:38,946 - EarlyStopping counter: 2 out of 10
2025-02-22 23:40:12,198 - {'epoch': 38, 'rec_loss': '6.9689'}
2025-02-22 23:40:20,069 - {'Epoch': 38, 'HR@5': '0.0919', 'NDCG@5': '0.0669', 'HR@10': '0.1240', 'NDCG@10': '0.0772', 'HR@20': '0.1589', 'NDCG@20': '0.0860'}
2025-02-22 23:40:20,071 - EarlyStopping counter: 3 out of 10
2025-02-22 23:40:56,039 - {'epoch': 39, 'rec_loss': '6.9548'}
2025-02-22 23:41:05,013 - {'Epoch': 39, 'HR@5': '0.0925', 'NDCG@5': '0.0674', 'HR@10': '0.1237', 'NDCG@10': '0.0775', 'HR@20': '0.1605', 'NDCG@20': '0.0867'}
2025-02-22 23:41:05,020 - Validation score increased.  Saving model ...
2025-02-22 23:41:41,468 - {'epoch': 40, 'rec_loss': '6.9401'}
2025-02-22 23:41:49,409 - {'Epoch': 40, 'HR@5': '0.0937', 'NDCG@5': '0.0676', 'HR@10': '0.1244', 'NDCG@10': '0.0775', 'HR@20': '0.1590', 'NDCG@20': '0.0863'}
2025-02-22 23:41:49,410 - EarlyStopping counter: 1 out of 10
2025-02-22 23:42:23,604 - {'epoch': 41, 'rec_loss': '6.9324'}
2025-02-22 23:42:32,128 - {'Epoch': 41, 'HR@5': '0.0940', 'NDCG@5': '0.0678', 'HR@10': '0.1238', 'NDCG@10': '0.0774', 'HR@20': '0.1609', 'NDCG@20': '0.0868'}
2025-02-22 23:42:32,135 - Validation score increased.  Saving model ...
2025-02-22 23:43:06,333 - {'epoch': 42, 'rec_loss': '6.9256'}
2025-02-22 23:43:15,221 - {'Epoch': 42, 'HR@5': '0.0936', 'NDCG@5': '0.0678', 'HR@10': '0.1239', 'NDCG@10': '0.0776', 'HR@20': '0.1598', 'NDCG@20': '0.0866'}
2025-02-22 23:43:15,229 - EarlyStopping counter: 1 out of 10
2025-02-22 23:43:49,068 - {'epoch': 43, 'rec_loss': '6.9168'}
2025-02-22 23:43:57,688 - {'Epoch': 43, 'HR@5': '0.0920', 'NDCG@5': '0.0674', 'HR@10': '0.1246', 'NDCG@10': '0.0779', 'HR@20': '0.1602', 'NDCG@20': '0.0869'}
2025-02-22 23:43:57,694 - Validation score increased.  Saving model ...
2025-02-22 23:44:32,607 - {'epoch': 44, 'rec_loss': '6.9233'}
2025-02-22 23:44:41,800 - {'Epoch': 44, 'HR@5': '0.0930', 'NDCG@5': '0.0675', 'HR@10': '0.1252', 'NDCG@10': '0.0779', 'HR@20': '0.1607', 'NDCG@20': '0.0869'}
2025-02-22 23:44:41,801 - EarlyStopping counter: 1 out of 10
2025-02-22 23:45:15,554 - {'epoch': 45, 'rec_loss': '6.9077'}
2025-02-22 23:45:24,157 - {'Epoch': 45, 'HR@5': '0.0939', 'NDCG@5': '0.0685', 'HR@10': '0.1250', 'NDCG@10': '0.0785', 'HR@20': '0.1600', 'NDCG@20': '0.0874'}
2025-02-22 23:45:24,164 - Validation score increased.  Saving model ...
2025-02-22 23:45:58,050 - {'epoch': 46, 'rec_loss': '6.9070'}
2025-02-22 23:46:06,395 - {'Epoch': 46, 'HR@5': '0.0945', 'NDCG@5': '0.0688', 'HR@10': '0.1256', 'NDCG@10': '0.0788', 'HR@20': '0.1601', 'NDCG@20': '0.0875'}
2025-02-22 23:46:06,402 - Validation score increased.  Saving model ...
2025-02-22 23:46:40,113 - {'epoch': 47, 'rec_loss': '6.8881'}
2025-02-22 23:46:48,639 - {'Epoch': 47, 'HR@5': '0.0936', 'NDCG@5': '0.0681', 'HR@10': '0.1252', 'NDCG@10': '0.0783', 'HR@20': '0.1601', 'NDCG@20': '0.0871'}
2025-02-22 23:46:48,648 - EarlyStopping counter: 1 out of 10
2025-02-22 23:47:24,033 - {'epoch': 48, 'rec_loss': '6.8960'}
2025-02-22 23:47:32,174 - {'Epoch': 48, 'HR@5': '0.0922', 'NDCG@5': '0.0680', 'HR@10': '0.1240', 'NDCG@10': '0.0782', 'HR@20': '0.1585', 'NDCG@20': '0.0869'}
2025-02-22 23:47:32,180 - EarlyStopping counter: 2 out of 10
2025-02-22 23:48:04,927 - {'epoch': 49, 'rec_loss': '6.8869'}
2025-02-22 23:48:12,714 - {'Epoch': 49, 'HR@5': '0.0930', 'NDCG@5': '0.0673', 'HR@10': '0.1244', 'NDCG@10': '0.0774', 'HR@20': '0.1604', 'NDCG@20': '0.0864'}
2025-02-22 23:48:12,715 - EarlyStopping counter: 3 out of 10
2025-02-22 23:48:46,624 - {'epoch': 50, 'rec_loss': '6.8780'}
2025-02-22 23:48:55,096 - {'Epoch': 50, 'HR@5': '0.0940', 'NDCG@5': '0.0690', 'HR@10': '0.1237', 'NDCG@10': '0.0785', 'HR@20': '0.1596', 'NDCG@20': '0.0876'}
2025-02-22 23:48:55,103 - Validation score increased.  Saving model ...
2025-02-22 23:49:28,102 - {'epoch': 51, 'rec_loss': '6.8730'}
2025-02-22 23:49:36,893 - {'Epoch': 51, 'HR@5': '0.0927', 'NDCG@5': '0.0680', 'HR@10': '0.1238', 'NDCG@10': '0.0780', 'HR@20': '0.1598', 'NDCG@20': '0.0871'}
2025-02-22 23:49:36,894 - EarlyStopping counter: 1 out of 10
2025-02-22 23:50:11,321 - {'epoch': 52, 'rec_loss': '6.8809'}
2025-02-22 23:50:19,013 - {'Epoch': 52, 'HR@5': '0.0929', 'NDCG@5': '0.0678', 'HR@10': '0.1231', 'NDCG@10': '0.0775', 'HR@20': '0.1603', 'NDCG@20': '0.0869'}
2025-02-22 23:50:19,014 - EarlyStopping counter: 2 out of 10
2025-02-22 23:50:52,718 - {'epoch': 53, 'rec_loss': '6.8629'}
2025-02-22 23:51:00,869 - {'Epoch': 53, 'HR@5': '0.0939', 'NDCG@5': '0.0679', 'HR@10': '0.1228', 'NDCG@10': '0.0772', 'HR@20': '0.1605', 'NDCG@20': '0.0867'}
2025-02-22 23:51:00,877 - EarlyStopping counter: 3 out of 10
2025-02-22 23:51:30,598 - {'epoch': 54, 'rec_loss': '6.8582'}
2025-02-22 23:51:38,765 - {'Epoch': 54, 'HR@5': '0.0933', 'NDCG@5': '0.0681', 'HR@10': '0.1235', 'NDCG@10': '0.0779', 'HR@20': '0.1617', 'NDCG@20': '0.0875'}
2025-02-22 23:51:38,771 - EarlyStopping counter: 4 out of 10
2025-02-22 23:52:15,504 - {'epoch': 55, 'rec_loss': '6.8440'}
2025-02-22 23:52:24,589 - {'Epoch': 55, 'HR@5': '0.0943', 'NDCG@5': '0.0684', 'HR@10': '0.1243', 'NDCG@10': '0.0781', 'HR@20': '0.1602', 'NDCG@20': '0.0872'}
2025-02-22 23:52:24,596 - EarlyStopping counter: 5 out of 10
2025-02-22 23:53:01,220 - {'epoch': 56, 'rec_loss': '6.8618'}
2025-02-22 23:53:09,875 - {'Epoch': 56, 'HR@5': '0.0940', 'NDCG@5': '0.0685', 'HR@10': '0.1239', 'NDCG@10': '0.0781', 'HR@20': '0.1608', 'NDCG@20': '0.0875'}
2025-02-22 23:53:09,883 - EarlyStopping counter: 6 out of 10
2025-02-22 23:53:45,722 - {'epoch': 57, 'rec_loss': '6.8395'}
2025-02-22 23:53:54,229 - {'Epoch': 57, 'HR@5': '0.0941', 'NDCG@5': '0.0690', 'HR@10': '0.1232', 'NDCG@10': '0.0785', 'HR@20': '0.1603', 'NDCG@20': '0.0879'}
2025-02-22 23:53:54,236 - Validation score increased.  Saving model ...
2025-02-22 23:54:30,422 - {'epoch': 58, 'rec_loss': '6.8387'}
2025-02-22 23:54:38,916 - {'Epoch': 58, 'HR@5': '0.0940', 'NDCG@5': '0.0685', 'HR@10': '0.1234', 'NDCG@10': '0.0780', 'HR@20': '0.1617', 'NDCG@20': '0.0876'}
2025-02-22 23:54:38,918 - EarlyStopping counter: 1 out of 10
2025-02-22 23:55:13,876 - {'epoch': 59, 'rec_loss': '6.8397'}
2025-02-22 23:55:22,315 - {'Epoch': 59, 'HR@5': '0.0944', 'NDCG@5': '0.0688', 'HR@10': '0.1244', 'NDCG@10': '0.0784', 'HR@20': '0.1620', 'NDCG@20': '0.0879'}
2025-02-22 23:55:22,316 - Validation score increased.  Saving model ...
2025-02-22 23:55:56,603 - {'epoch': 60, 'rec_loss': '6.8297'}
2025-02-22 23:56:05,239 - {'Epoch': 60, 'HR@5': '0.0939', 'NDCG@5': '0.0681', 'HR@10': '0.1223', 'NDCG@10': '0.0773', 'HR@20': '0.1608', 'NDCG@20': '0.0870'}
2025-02-22 23:56:05,247 - EarlyStopping counter: 1 out of 10
2025-02-22 23:56:39,604 - {'epoch': 61, 'rec_loss': '6.8266'}
2025-02-22 23:56:47,658 - {'Epoch': 61, 'HR@5': '0.0936', 'NDCG@5': '0.0682', 'HR@10': '0.1246', 'NDCG@10': '0.0782', 'HR@20': '0.1604', 'NDCG@20': '0.0872'}
2025-02-22 23:56:47,665 - EarlyStopping counter: 2 out of 10
2025-02-22 23:57:21,096 - {'epoch': 62, 'rec_loss': '6.8196'}
2025-02-22 23:57:30,221 - {'Epoch': 62, 'HR@5': '0.0948', 'NDCG@5': '0.0693', 'HR@10': '0.1257', 'NDCG@10': '0.0793', 'HR@20': '0.1600', 'NDCG@20': '0.0880'}
2025-02-22 23:57:30,229 - Validation score increased.  Saving model ...
2025-02-22 23:58:04,219 - {'epoch': 63, 'rec_loss': '6.8201'}
2025-02-22 23:58:12,979 - {'Epoch': 63, 'HR@5': '0.0945', 'NDCG@5': '0.0686', 'HR@10': '0.1248', 'NDCG@10': '0.0784', 'HR@20': '0.1606', 'NDCG@20': '0.0874'}
2025-02-22 23:58:12,980 - EarlyStopping counter: 1 out of 10
2025-02-22 23:58:47,703 - {'epoch': 64, 'rec_loss': '6.8108'}
2025-02-22 23:58:56,810 - {'Epoch': 64, 'HR@5': '0.0930', 'NDCG@5': '0.0681', 'HR@10': '0.1230', 'NDCG@10': '0.0778', 'HR@20': '0.1601', 'NDCG@20': '0.0871'}
2025-02-22 23:58:56,815 - EarlyStopping counter: 2 out of 10
2025-02-22 23:59:30,514 - {'epoch': 65, 'rec_loss': '6.8056'}
2025-02-22 23:59:39,175 - {'Epoch': 65, 'HR@5': '0.0938', 'NDCG@5': '0.0683', 'HR@10': '0.1229', 'NDCG@10': '0.0777', 'HR@20': '0.1613', 'NDCG@20': '0.0874'}
2025-02-22 23:59:39,182 - EarlyStopping counter: 3 out of 10
2025-02-23 00:00:13,896 - {'epoch': 66, 'rec_loss': '6.7976'}
2025-02-23 00:00:23,110 - {'Epoch': 66, 'HR@5': '0.0929', 'NDCG@5': '0.0681', 'HR@10': '0.1247', 'NDCG@10': '0.0783', 'HR@20': '0.1600', 'NDCG@20': '0.0872'}
2025-02-23 00:00:23,111 - EarlyStopping counter: 4 out of 10
2025-02-23 00:00:57,061 - {'epoch': 67, 'rec_loss': '6.7985'}
2025-02-23 00:01:05,926 - {'Epoch': 67, 'HR@5': '0.0954', 'NDCG@5': '0.0698', 'HR@10': '0.1249', 'NDCG@10': '0.0793', 'HR@20': '0.1609', 'NDCG@20': '0.0884'}
2025-02-23 00:01:05,934 - Validation score increased.  Saving model ...
2025-02-23 00:01:41,628 - {'epoch': 68, 'rec_loss': '6.8031'}
2025-02-23 00:01:50,826 - {'Epoch': 68, 'HR@5': '0.0937', 'NDCG@5': '0.0687', 'HR@10': '0.1236', 'NDCG@10': '0.0784', 'HR@20': '0.1607', 'NDCG@20': '0.0878'}
2025-02-23 00:01:50,834 - EarlyStopping counter: 1 out of 10
2025-02-23 00:02:21,416 - {'epoch': 69, 'rec_loss': '6.7921'}
2025-02-23 00:02:29,072 - {'Epoch': 69, 'HR@5': '0.0934', 'NDCG@5': '0.0684', 'HR@10': '0.1234', 'NDCG@10': '0.0781', 'HR@20': '0.1608', 'NDCG@20': '0.0876'}
2025-02-23 00:02:29,079 - EarlyStopping counter: 2 out of 10
2025-02-23 00:03:05,806 - {'epoch': 70, 'rec_loss': '6.7872'}
2025-02-23 00:03:14,438 - {'Epoch': 70, 'HR@5': '0.0935', 'NDCG@5': '0.0688', 'HR@10': '0.1240', 'NDCG@10': '0.0786', 'HR@20': '0.1610', 'NDCG@20': '0.0879'}
2025-02-23 00:03:14,448 - EarlyStopping counter: 3 out of 10
2025-02-23 00:03:51,173 - {'epoch': 71, 'rec_loss': '6.8011'}
2025-02-23 00:03:59,935 - {'Epoch': 71, 'HR@5': '0.0941', 'NDCG@5': '0.0692', 'HR@10': '0.1245', 'NDCG@10': '0.0790', 'HR@20': '0.1600', 'NDCG@20': '0.0879'}
2025-02-23 00:03:59,943 - EarlyStopping counter: 4 out of 10
2025-02-23 00:04:33,933 - {'epoch': 72, 'rec_loss': '6.7856'}
2025-02-23 00:04:42,229 - {'Epoch': 72, 'HR@5': '0.0942', 'NDCG@5': '0.0682', 'HR@10': '0.1226', 'NDCG@10': '0.0774', 'HR@20': '0.1621', 'NDCG@20': '0.0874'}
2025-02-23 00:04:42,236 - EarlyStopping counter: 5 out of 10
2025-02-23 00:05:16,885 - {'epoch': 73, 'rec_loss': '6.7807'}
2025-02-23 00:05:26,213 - {'Epoch': 73, 'HR@5': '0.0941', 'NDCG@5': '0.0689', 'HR@10': '0.1234', 'NDCG@10': '0.0784', 'HR@20': '0.1602', 'NDCG@20': '0.0877'}
2025-02-23 00:05:26,214 - EarlyStopping counter: 6 out of 10
2025-02-23 00:06:00,432 - {'epoch': 74, 'rec_loss': '6.7726'}
2025-02-23 00:06:08,742 - {'Epoch': 74, 'HR@5': '0.0933', 'NDCG@5': '0.0688', 'HR@10': '0.1231', 'NDCG@10': '0.0784', 'HR@20': '0.1617', 'NDCG@20': '0.0882'}
2025-02-23 00:06:08,749 - EarlyStopping counter: 7 out of 10
2025-02-23 00:06:42,678 - {'epoch': 75, 'rec_loss': '6.7748'}
2025-02-23 00:06:51,018 - {'Epoch': 75, 'HR@5': '0.0944', 'NDCG@5': '0.0684', 'HR@10': '0.1223', 'NDCG@10': '0.0774', 'HR@20': '0.1602', 'NDCG@20': '0.0869'}
2025-02-23 00:06:51,025 - EarlyStopping counter: 8 out of 10
2025-02-23 00:07:25,038 - {'epoch': 76, 'rec_loss': '6.7741'}
2025-02-23 00:07:33,651 - {'Epoch': 76, 'HR@5': '0.0945', 'NDCG@5': '0.0690', 'HR@10': '0.1229', 'NDCG@10': '0.0781', 'HR@20': '0.1600', 'NDCG@20': '0.0875'}
2025-02-23 00:07:33,659 - EarlyStopping counter: 9 out of 10
2025-02-23 00:08:06,591 - {'epoch': 77, 'rec_loss': '6.7686'}
2025-02-23 00:08:14,521 - {'Epoch': 77, 'HR@5': '0.0951', 'NDCG@5': '0.0698', 'HR@10': '0.1237', 'NDCG@10': '0.0790', 'HR@20': '0.1623', 'NDCG@20': '0.0888'}
2025-02-23 00:08:14,528 - Validation score increased.  Saving model ...
2025-02-23 00:08:47,636 - {'epoch': 78, 'rec_loss': '6.7588'}
2025-02-23 00:08:56,247 - {'Epoch': 78, 'HR@5': '0.0942', 'NDCG@5': '0.0691', 'HR@10': '0.1237', 'NDCG@10': '0.0786', 'HR@20': '0.1602', 'NDCG@20': '0.0878'}
2025-02-23 00:08:56,254 - EarlyStopping counter: 1 out of 10
2025-02-23 00:09:30,604 - {'epoch': 79, 'rec_loss': '6.7618'}
2025-02-23 00:09:39,441 - {'Epoch': 79, 'HR@5': '0.0934', 'NDCG@5': '0.0689', 'HR@10': '0.1229', 'NDCG@10': '0.0784', 'HR@20': '0.1609', 'NDCG@20': '0.0880'}
2025-02-23 00:09:39,448 - EarlyStopping counter: 2 out of 10
2025-02-23 00:10:14,643 - {'epoch': 80, 'rec_loss': '6.7639'}
2025-02-23 00:10:22,581 - {'Epoch': 80, 'HR@5': '0.0943', 'NDCG@5': '0.0691', 'HR@10': '0.1229', 'NDCG@10': '0.0783', 'HR@20': '0.1609', 'NDCG@20': '0.0879'}
2025-02-23 00:10:22,583 - EarlyStopping counter: 3 out of 10
2025-02-23 00:10:56,237 - {'epoch': 81, 'rec_loss': '6.7456'}
2025-02-23 00:11:03,770 - {'Epoch': 81, 'HR@5': '0.0927', 'NDCG@5': '0.0686', 'HR@10': '0.1231', 'NDCG@10': '0.0784', 'HR@20': '0.1622', 'NDCG@20': '0.0882'}
2025-02-23 00:11:03,775 - EarlyStopping counter: 4 out of 10
2025-02-23 00:11:37,754 - {'epoch': 82, 'rec_loss': '6.7463'}
2025-02-23 00:11:45,559 - {'Epoch': 82, 'HR@5': '0.0939', 'NDCG@5': '0.0685', 'HR@10': '0.1233', 'NDCG@10': '0.0780', 'HR@20': '0.1611', 'NDCG@20': '0.0875'}
2025-02-23 00:11:45,565 - EarlyStopping counter: 5 out of 10
2025-02-23 00:12:18,374 - {'epoch': 83, 'rec_loss': '6.7550'}
2025-02-23 00:12:26,755 - {'Epoch': 83, 'HR@5': '0.0936', 'NDCG@5': '0.0691', 'HR@10': '0.1236', 'NDCG@10': '0.0787', 'HR@20': '0.1617', 'NDCG@20': '0.0883'}
2025-02-23 00:12:26,761 - EarlyStopping counter: 6 out of 10
2025-02-23 00:13:00,462 - {'epoch': 84, 'rec_loss': '6.7396'}
2025-02-23 00:13:09,781 - {'Epoch': 84, 'HR@5': '0.0936', 'NDCG@5': '0.0686', 'HR@10': '0.1222', 'NDCG@10': '0.0779', 'HR@20': '0.1609', 'NDCG@20': '0.0876'}
2025-02-23 00:13:09,790 - EarlyStopping counter: 7 out of 10
2025-02-23 00:13:37,345 - {'epoch': 85, 'rec_loss': '6.7450'}
2025-02-23 00:13:46,052 - {'Epoch': 85, 'HR@5': '0.0950', 'NDCG@5': '0.0698', 'HR@10': '0.1235', 'NDCG@10': '0.0790', 'HR@20': '0.1612', 'NDCG@20': '0.0885'}
2025-02-23 00:13:46,059 - EarlyStopping counter: 8 out of 10
2025-02-23 00:14:22,216 - {'epoch': 86, 'rec_loss': '6.7445'}
2025-02-23 00:14:29,902 - {'Epoch': 86, 'HR@5': '0.0932', 'NDCG@5': '0.0690', 'HR@10': '0.1237', 'NDCG@10': '0.0788', 'HR@20': '0.1616', 'NDCG@20': '0.0883'}
2025-02-23 00:14:29,910 - EarlyStopping counter: 9 out of 10
2025-02-23 00:15:07,352 - {'epoch': 87, 'rec_loss': '6.7325'}
2025-02-23 00:15:15,794 - {'Epoch': 87, 'HR@5': '0.0940', 'NDCG@5': '0.0696', 'HR@10': '0.1234', 'NDCG@10': '0.0791', 'HR@20': '0.1633', 'NDCG@20': '0.0891'}
2025-02-23 00:15:15,802 - Validation score increased.  Saving model ...
2025-02-23 00:15:50,665 - {'epoch': 88, 'rec_loss': '6.7472'}
2025-02-23 00:15:58,755 - {'Epoch': 88, 'HR@5': '0.0946', 'NDCG@5': '0.0697', 'HR@10': '0.1230', 'NDCG@10': '0.0789', 'HR@20': '0.1616', 'NDCG@20': '0.0886'}
2025-02-23 00:15:58,757 - EarlyStopping counter: 1 out of 10
2025-02-23 00:16:34,008 - {'epoch': 89, 'rec_loss': '6.7364'}
2025-02-23 00:16:41,933 - {'Epoch': 89, 'HR@5': '0.0944', 'NDCG@5': '0.0693', 'HR@10': '0.1233', 'NDCG@10': '0.0786', 'HR@20': '0.1622', 'NDCG@20': '0.0884'}
2025-02-23 00:16:41,941 - EarlyStopping counter: 2 out of 10
2025-02-23 00:17:17,328 - {'epoch': 90, 'rec_loss': '6.7296'}
2025-02-23 00:17:25,738 - {'Epoch': 90, 'HR@5': '0.0955', 'NDCG@5': '0.0697', 'HR@10': '0.1246', 'NDCG@10': '0.0791', 'HR@20': '0.1612', 'NDCG@20': '0.0883'}
2025-02-23 00:17:25,747 - EarlyStopping counter: 3 out of 10
2025-02-23 00:18:00,557 - {'epoch': 91, 'rec_loss': '6.7181'}
2025-02-23 00:18:08,866 - {'Epoch': 91, 'HR@5': '0.0948', 'NDCG@5': '0.0696', 'HR@10': '0.1232', 'NDCG@10': '0.0788', 'HR@20': '0.1602', 'NDCG@20': '0.0881'}
2025-02-23 00:18:08,873 - EarlyStopping counter: 4 out of 10
2025-02-23 00:18:43,399 - {'epoch': 92, 'rec_loss': '6.7160'}
2025-02-23 00:18:52,375 - {'Epoch': 92, 'HR@5': '0.0943', 'NDCG@5': '0.0693', 'HR@10': '0.1231', 'NDCG@10': '0.0785', 'HR@20': '0.1613', 'NDCG@20': '0.0882'}
2025-02-23 00:18:52,384 - EarlyStopping counter: 5 out of 10
2025-02-23 00:19:25,791 - {'epoch': 93, 'rec_loss': '6.7214'}
2025-02-23 00:19:33,500 - {'Epoch': 93, 'HR@5': '0.0942', 'NDCG@5': '0.0692', 'HR@10': '0.1235', 'NDCG@10': '0.0786', 'HR@20': '0.1622', 'NDCG@20': '0.0883'}
2025-02-23 00:19:33,509 - EarlyStopping counter: 6 out of 10
2025-02-23 00:20:07,680 - {'epoch': 94, 'rec_loss': '6.7274'}
2025-02-23 00:20:17,012 - {'Epoch': 94, 'HR@5': '0.0948', 'NDCG@5': '0.0697', 'HR@10': '0.1232', 'NDCG@10': '0.0788', 'HR@20': '0.1612', 'NDCG@20': '0.0884'}
2025-02-23 00:20:17,020 - EarlyStopping counter: 7 out of 10
2025-02-23 00:20:50,509 - {'epoch': 95, 'rec_loss': '6.7097'}
2025-02-23 00:20:59,191 - {'Epoch': 95, 'HR@5': '0.0940', 'NDCG@5': '0.0690', 'HR@10': '0.1230', 'NDCG@10': '0.0783', 'HR@20': '0.1606', 'NDCG@20': '0.0878'}
2025-02-23 00:20:59,199 - EarlyStopping counter: 8 out of 10
2025-02-23 00:21:32,231 - {'epoch': 96, 'rec_loss': '6.7170'}
2025-02-23 00:21:41,411 - {'Epoch': 96, 'HR@5': '0.0938', 'NDCG@5': '0.0689', 'HR@10': '0.1233', 'NDCG@10': '0.0784', 'HR@20': '0.1604', 'NDCG@20': '0.0877'}
2025-02-23 00:21:41,419 - EarlyStopping counter: 9 out of 10
2025-02-23 00:22:15,801 - {'epoch': 97, 'rec_loss': '6.7223'}
2025-02-23 00:22:24,319 - {'Epoch': 97, 'HR@5': '0.0918', 'NDCG@5': '0.0677', 'HR@10': '0.1228', 'NDCG@10': '0.0777', 'HR@20': '0.1602', 'NDCG@20': '0.0871'}
2025-02-23 00:22:24,326 - EarlyStopping counter: 10 out of 10
2025-02-23 00:22:24,326 - Early stopping
2025-02-23 00:22:24,326 - ---------------Test Score---------------
2025-02-23 00:22:32,081 - {'Epoch': 0, 'HR@5': '0.0760', 'NDCG@5': '0.0556', 'HR@10': '0.1028', 'NDCG@10': '0.0643', 'HR@20': '0.1360', 'NDCG@20': '0.0727'}
2025-02-23 00:22:32,082 - Scale_Toys
2025-02-23 00:22:32,082 - {'Epoch': 0, 'HR@5': '0.0760', 'NDCG@5': '0.0556', 'HR@10': '0.1028', 'NDCG@10': '0.0643', 'HR@20': '0.1360', 'NDCG@20': '0.0727'}
2025-02-26 17:48:51,498 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-02-26 17:48:55,002 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-26 17:48:55,014 - Total Parameters: 917142
2025-02-26 17:49:21,476 - {'epoch': 0, 'rec_loss': '9.0880'}
2025-02-26 17:49:30,185 - {'Epoch': 0, 'HR@5': '0.0067', 'NDCG@5': '0.0039', 'HR@10': '0.0110', 'NDCG@10': '0.0052', 'HR@20': '0.0182', 'NDCG@20': '0.0070'}
2025-02-26 17:49:30,192 - Validation score increased.  Saving model ...
2025-02-26 17:49:55,183 - {'epoch': 1, 'rec_loss': '8.6826'}
2025-02-26 17:50:03,827 - {'Epoch': 1, 'HR@5': '0.0163', 'NDCG@5': '0.0113', 'HR@10': '0.0252', 'NDCG@10': '0.0142', 'HR@20': '0.0396', 'NDCG@20': '0.0179'}
2025-02-26 17:50:03,829 - Validation score increased.  Saving model ...
2025-02-26 17:50:28,741 - {'epoch': 2, 'rec_loss': '8.3895'}
2025-02-26 17:50:37,186 - {'Epoch': 2, 'HR@5': '0.0343', 'NDCG@5': '0.0245', 'HR@10': '0.0516', 'NDCG@10': '0.0301', 'HR@20': '0.0723', 'NDCG@20': '0.0353'}
2025-02-26 17:50:37,187 - Validation score increased.  Saving model ...
2025-02-26 17:51:01,785 - {'epoch': 3, 'rec_loss': '8.1144'}
2025-02-26 17:51:10,326 - {'Epoch': 3, 'HR@5': '0.0499', 'NDCG@5': '0.0364', 'HR@10': '0.0706', 'NDCG@10': '0.0431', 'HR@20': '0.0959', 'NDCG@20': '0.0494'}
2025-02-26 17:51:10,327 - Validation score increased.  Saving model ...
2025-02-26 17:51:35,658 - {'epoch': 4, 'rec_loss': '7.8956'}
2025-02-26 17:51:44,337 - {'Epoch': 4, 'HR@5': '0.0621', 'NDCG@5': '0.0455', 'HR@10': '0.0848', 'NDCG@10': '0.0528', 'HR@20': '0.1147', 'NDCG@20': '0.0603'}
2025-02-26 17:51:44,339 - Validation score increased.  Saving model ...
2025-02-26 17:52:09,392 - {'epoch': 5, 'rec_loss': '7.7285'}
2025-02-26 17:52:18,319 - {'Epoch': 5, 'HR@5': '0.0702', 'NDCG@5': '0.0507', 'HR@10': '0.0960', 'NDCG@10': '0.0590', 'HR@20': '0.1272', 'NDCG@20': '0.0668'}
2025-02-26 17:52:18,321 - Validation score increased.  Saving model ...
2025-02-26 17:52:43,079 - {'epoch': 6, 'rec_loss': '7.6071'}
2025-02-26 17:52:51,493 - {'Epoch': 6, 'HR@5': '0.0743', 'NDCG@5': '0.0538', 'HR@10': '0.1017', 'NDCG@10': '0.0627', 'HR@20': '0.1371', 'NDCG@20': '0.0716'}
2025-02-26 17:52:51,495 - Validation score increased.  Saving model ...
2025-02-26 17:53:16,732 - {'epoch': 7, 'rec_loss': '7.5083'}
2025-02-26 17:53:24,803 - {'Epoch': 7, 'HR@5': '0.0806', 'NDCG@5': '0.0578', 'HR@10': '0.1085', 'NDCG@10': '0.0668', 'HR@20': '0.1451', 'NDCG@20': '0.0760'}
2025-02-26 17:53:24,805 - Validation score increased.  Saving model ...
2025-02-26 17:53:49,405 - {'epoch': 8, 'rec_loss': '7.4267'}
2025-02-26 17:53:58,275 - {'Epoch': 8, 'HR@5': '0.0835', 'NDCG@5': '0.0602', 'HR@10': '0.1116', 'NDCG@10': '0.0692', 'HR@20': '0.1473', 'NDCG@20': '0.0782'}
2025-02-26 17:53:58,277 - Validation score increased.  Saving model ...
2025-02-26 17:54:23,795 - {'epoch': 9, 'rec_loss': '7.3668'}
2025-02-26 17:54:32,288 - {'Epoch': 9, 'HR@5': '0.0846', 'NDCG@5': '0.0608', 'HR@10': '0.1148', 'NDCG@10': '0.0705', 'HR@20': '0.1514', 'NDCG@20': '0.0797'}
2025-02-26 17:54:32,290 - Validation score increased.  Saving model ...
2025-02-26 17:54:57,081 - {'epoch': 10, 'rec_loss': '7.3141'}
2025-02-26 17:55:05,474 - {'Epoch': 10, 'HR@5': '0.0861', 'NDCG@5': '0.0622', 'HR@10': '0.1162', 'NDCG@10': '0.0719', 'HR@20': '0.1529', 'NDCG@20': '0.0811'}
2025-02-26 17:55:05,475 - Validation score increased.  Saving model ...
2025-02-26 17:55:29,829 - {'epoch': 11, 'rec_loss': '7.2701'}
2025-02-26 17:55:38,106 - {'Epoch': 11, 'HR@5': '0.0883', 'NDCG@5': '0.0641', 'HR@10': '0.1178', 'NDCG@10': '0.0736', 'HR@20': '0.1583', 'NDCG@20': '0.0838'}
2025-02-26 17:55:38,107 - Validation score increased.  Saving model ...
2025-02-26 17:56:03,975 - {'epoch': 12, 'rec_loss': '7.2309'}
2025-02-26 17:56:12,375 - {'Epoch': 12, 'HR@5': '0.0879', 'NDCG@5': '0.0634', 'HR@10': '0.1191', 'NDCG@10': '0.0735', 'HR@20': '0.1576', 'NDCG@20': '0.0832'}
2025-02-26 17:56:12,377 - EarlyStopping counter: 1 out of 10
2025-02-26 17:56:37,515 - {'epoch': 13, 'rec_loss': '7.1989'}
2025-02-26 17:56:46,185 - {'Epoch': 13, 'HR@5': '0.0893', 'NDCG@5': '0.0648', 'HR@10': '0.1208', 'NDCG@10': '0.0749', 'HR@20': '0.1594', 'NDCG@20': '0.0846'}
2025-02-26 17:56:46,187 - Validation score increased.  Saving model ...
2025-02-26 17:57:12,353 - {'epoch': 14, 'rec_loss': '7.1671'}
2025-02-26 17:57:20,955 - {'Epoch': 14, 'HR@5': '0.0880', 'NDCG@5': '0.0638', 'HR@10': '0.1199', 'NDCG@10': '0.0741', 'HR@20': '0.1590', 'NDCG@20': '0.0840'}
2025-02-26 17:57:20,957 - EarlyStopping counter: 1 out of 10
2025-02-26 17:57:45,958 - {'epoch': 15, 'rec_loss': '7.1483'}
2025-02-26 17:57:54,588 - {'Epoch': 15, 'HR@5': '0.0915', 'NDCG@5': '0.0665', 'HR@10': '0.1220', 'NDCG@10': '0.0763', 'HR@20': '0.1616', 'NDCG@20': '0.0863'}
2025-02-26 17:57:54,591 - Validation score increased.  Saving model ...
2025-02-26 17:58:19,349 - {'epoch': 16, 'rec_loss': '7.1203'}
2025-02-26 17:58:27,612 - {'Epoch': 16, 'HR@5': '0.0909', 'NDCG@5': '0.0659', 'HR@10': '0.1222', 'NDCG@10': '0.0760', 'HR@20': '0.1607', 'NDCG@20': '0.0858'}
2025-02-26 17:58:27,614 - EarlyStopping counter: 1 out of 10
2025-02-26 17:58:51,601 - {'epoch': 17, 'rec_loss': '7.0927'}
2025-02-26 17:59:00,148 - {'Epoch': 17, 'HR@5': '0.0926', 'NDCG@5': '0.0669', 'HR@10': '0.1239', 'NDCG@10': '0.0770', 'HR@20': '0.1619', 'NDCG@20': '0.0866'}
2025-02-26 17:59:00,149 - Validation score increased.  Saving model ...
2025-02-26 17:59:25,085 - {'epoch': 18, 'rec_loss': '7.0758'}
2025-02-26 17:59:33,366 - {'Epoch': 18, 'HR@5': '0.0928', 'NDCG@5': '0.0666', 'HR@10': '0.1231', 'NDCG@10': '0.0763', 'HR@20': '0.1618', 'NDCG@20': '0.0861'}
2025-02-26 17:59:33,367 - EarlyStopping counter: 1 out of 10
2025-02-26 17:59:58,686 - {'epoch': 19, 'rec_loss': '7.0609'}
2025-02-26 18:00:07,372 - {'Epoch': 19, 'HR@5': '0.0929', 'NDCG@5': '0.0665', 'HR@10': '0.1248', 'NDCG@10': '0.0767', 'HR@20': '0.1632', 'NDCG@20': '0.0865'}
2025-02-26 18:00:07,373 - EarlyStopping counter: 2 out of 10
2025-02-26 18:00:31,855 - {'epoch': 20, 'rec_loss': '7.0414'}
2025-02-26 18:00:40,279 - {'Epoch': 20, 'HR@5': '0.0926', 'NDCG@5': '0.0666', 'HR@10': '0.1258', 'NDCG@10': '0.0773', 'HR@20': '0.1630', 'NDCG@20': '0.0867'}
2025-02-26 18:00:40,280 - Validation score increased.  Saving model ...
2025-02-26 18:01:05,627 - {'epoch': 21, 'rec_loss': '7.0205'}
2025-02-26 18:01:13,916 - {'Epoch': 21, 'HR@5': '0.0919', 'NDCG@5': '0.0664', 'HR@10': '0.1266', 'NDCG@10': '0.0776', 'HR@20': '0.1648', 'NDCG@20': '0.0872'}
2025-02-26 18:01:13,918 - Validation score increased.  Saving model ...
2025-02-26 18:01:38,606 - {'epoch': 22, 'rec_loss': '7.0070'}
2025-02-26 18:01:46,925 - {'Epoch': 22, 'HR@5': '0.0935', 'NDCG@5': '0.0673', 'HR@10': '0.1258', 'NDCG@10': '0.0777', 'HR@20': '0.1629', 'NDCG@20': '0.0870'}
2025-02-26 18:01:46,927 - EarlyStopping counter: 1 out of 10
2025-02-26 18:02:12,377 - {'epoch': 23, 'rec_loss': '6.9937'}
2025-02-26 18:02:20,634 - {'Epoch': 23, 'HR@5': '0.0944', 'NDCG@5': '0.0678', 'HR@10': '0.1269', 'NDCG@10': '0.0783', 'HR@20': '0.1637', 'NDCG@20': '0.0876'}
2025-02-26 18:02:20,636 - Validation score increased.  Saving model ...
2025-02-26 18:02:44,825 - {'epoch': 24, 'rec_loss': '6.9852'}
2025-02-26 18:02:53,003 - {'Epoch': 24, 'HR@5': '0.0943', 'NDCG@5': '0.0677', 'HR@10': '0.1269', 'NDCG@10': '0.0782', 'HR@20': '0.1642', 'NDCG@20': '0.0876'}
2025-02-26 18:02:53,004 - Validation score increased.  Saving model ...
2025-02-26 18:03:18,146 - {'epoch': 25, 'rec_loss': '6.9693'}
2025-02-26 18:03:27,208 - {'Epoch': 25, 'HR@5': '0.0945', 'NDCG@5': '0.0682', 'HR@10': '0.1279', 'NDCG@10': '0.0789', 'HR@20': '0.1645', 'NDCG@20': '0.0882'}
2025-02-26 18:03:27,216 - Validation score increased.  Saving model ...
2025-02-26 18:03:52,170 - {'epoch': 26, 'rec_loss': '6.9582'}
2025-02-26 18:04:00,639 - {'Epoch': 26, 'HR@5': '0.0937', 'NDCG@5': '0.0679', 'HR@10': '0.1289', 'NDCG@10': '0.0793', 'HR@20': '0.1670', 'NDCG@20': '0.0888'}
2025-02-26 18:04:00,641 - Validation score increased.  Saving model ...
2025-02-26 18:04:25,642 - {'epoch': 27, 'rec_loss': '6.9387'}
2025-02-26 18:04:34,131 - {'Epoch': 27, 'HR@5': '0.0941', 'NDCG@5': '0.0685', 'HR@10': '0.1265', 'NDCG@10': '0.0790', 'HR@20': '0.1657', 'NDCG@20': '0.0889'}
2025-02-26 18:04:34,132 - Validation score increased.  Saving model ...
2025-02-26 18:04:58,681 - {'epoch': 28, 'rec_loss': '6.9317'}
2025-02-26 18:05:07,127 - {'Epoch': 28, 'HR@5': '0.0926', 'NDCG@5': '0.0671', 'HR@10': '0.1269', 'NDCG@10': '0.0782', 'HR@20': '0.1644', 'NDCG@20': '0.0877'}
2025-02-26 18:05:07,129 - EarlyStopping counter: 1 out of 10
2025-02-26 18:05:32,650 - {'epoch': 29, 'rec_loss': '6.9188'}
2025-02-26 18:05:40,842 - {'Epoch': 29, 'HR@5': '0.0946', 'NDCG@5': '0.0679', 'HR@10': '0.1270', 'NDCG@10': '0.0783', 'HR@20': '0.1672', 'NDCG@20': '0.0884'}
2025-02-26 18:05:40,843 - EarlyStopping counter: 2 out of 10
2025-02-26 18:06:06,257 - {'epoch': 30, 'rec_loss': '6.9025'}
2025-02-26 18:06:14,628 - {'Epoch': 30, 'HR@5': '0.0952', 'NDCG@5': '0.0684', 'HR@10': '0.1273', 'NDCG@10': '0.0787', 'HR@20': '0.1672', 'NDCG@20': '0.0887'}
2025-02-26 18:06:14,630 - EarlyStopping counter: 3 out of 10
2025-02-26 18:06:39,735 - {'epoch': 31, 'rec_loss': '6.9042'}
2025-02-26 18:06:48,134 - {'Epoch': 31, 'HR@5': '0.0947', 'NDCG@5': '0.0678', 'HR@10': '0.1280', 'NDCG@10': '0.0785', 'HR@20': '0.1672', 'NDCG@20': '0.0884'}
2025-02-26 18:06:48,135 - EarlyStopping counter: 4 out of 10
2025-02-26 18:07:13,288 - {'epoch': 32, 'rec_loss': '6.8952'}
2025-02-26 18:07:21,609 - {'Epoch': 32, 'HR@5': '0.0939', 'NDCG@5': '0.0680', 'HR@10': '0.1272', 'NDCG@10': '0.0788', 'HR@20': '0.1658', 'NDCG@20': '0.0885'}
2025-02-26 18:07:21,610 - EarlyStopping counter: 5 out of 10
2025-02-26 18:07:47,729 - {'epoch': 33, 'rec_loss': '6.8834'}
2025-02-26 18:07:55,686 - {'Epoch': 33, 'HR@5': '0.0960', 'NDCG@5': '0.0689', 'HR@10': '0.1267', 'NDCG@10': '0.0787', 'HR@20': '0.1655', 'NDCG@20': '0.0885'}
2025-02-26 18:07:55,688 - EarlyStopping counter: 6 out of 10
2025-02-26 18:08:20,612 - {'epoch': 34, 'rec_loss': '6.8773'}
2025-02-26 18:08:29,018 - {'Epoch': 34, 'HR@5': '0.0952', 'NDCG@5': '0.0686', 'HR@10': '0.1270', 'NDCG@10': '0.0788', 'HR@20': '0.1673', 'NDCG@20': '0.0890'}
2025-02-26 18:08:29,019 - Validation score increased.  Saving model ...
2025-02-26 18:08:55,090 - {'epoch': 35, 'rec_loss': '6.8632'}
2025-02-26 18:09:03,526 - {'Epoch': 35, 'HR@5': '0.0946', 'NDCG@5': '0.0687', 'HR@10': '0.1286', 'NDCG@10': '0.0797', 'HR@20': '0.1681', 'NDCG@20': '0.0897'}
2025-02-26 18:09:03,528 - Validation score increased.  Saving model ...
2025-02-26 18:09:29,456 - {'epoch': 36, 'rec_loss': '6.8679'}
2025-02-26 18:09:38,207 - {'Epoch': 36, 'HR@5': '0.0960', 'NDCG@5': '0.0690', 'HR@10': '0.1287', 'NDCG@10': '0.0796', 'HR@20': '0.1686', 'NDCG@20': '0.0896'}
2025-02-26 18:09:38,208 - EarlyStopping counter: 1 out of 10
2025-02-26 18:10:04,264 - {'epoch': 37, 'rec_loss': '6.8539'}
2025-02-26 18:10:12,670 - {'Epoch': 37, 'HR@5': '0.0948', 'NDCG@5': '0.0690', 'HR@10': '0.1292', 'NDCG@10': '0.0800', 'HR@20': '0.1673', 'NDCG@20': '0.0897'}
2025-02-26 18:10:12,673 - EarlyStopping counter: 2 out of 10
2025-02-26 18:10:39,158 - {'epoch': 38, 'rec_loss': '6.8490'}
2025-02-26 18:10:47,277 - {'Epoch': 38, 'HR@5': '0.0953', 'NDCG@5': '0.0686', 'HR@10': '0.1282', 'NDCG@10': '0.0792', 'HR@20': '0.1676', 'NDCG@20': '0.0892'}
2025-02-26 18:10:47,279 - EarlyStopping counter: 3 out of 10
2025-02-26 18:11:12,944 - {'epoch': 39, 'rec_loss': '6.8346'}
2025-02-26 18:11:21,478 - {'Epoch': 39, 'HR@5': '0.0944', 'NDCG@5': '0.0684', 'HR@10': '0.1268', 'NDCG@10': '0.0788', 'HR@20': '0.1662', 'NDCG@20': '0.0888'}
2025-02-26 18:11:21,480 - EarlyStopping counter: 4 out of 10
2025-02-26 18:11:46,952 - {'epoch': 40, 'rec_loss': '6.8278'}
2025-02-26 18:11:55,411 - {'Epoch': 40, 'HR@5': '0.0948', 'NDCG@5': '0.0684', 'HR@10': '0.1291', 'NDCG@10': '0.0795', 'HR@20': '0.1676', 'NDCG@20': '0.0892'}
2025-02-26 18:11:55,412 - EarlyStopping counter: 5 out of 10
2025-02-26 18:12:20,839 - {'epoch': 41, 'rec_loss': '6.8225'}
2025-02-26 18:12:29,250 - {'Epoch': 41, 'HR@5': '0.0956', 'NDCG@5': '0.0696', 'HR@10': '0.1284', 'NDCG@10': '0.0802', 'HR@20': '0.1671', 'NDCG@20': '0.0899'}
2025-02-26 18:12:29,251 - Validation score increased.  Saving model ...
2025-02-26 18:12:54,871 - {'epoch': 42, 'rec_loss': '6.8249'}
2025-02-26 18:13:03,110 - {'Epoch': 42, 'HR@5': '0.0942', 'NDCG@5': '0.0681', 'HR@10': '0.1291', 'NDCG@10': '0.0794', 'HR@20': '0.1671', 'NDCG@20': '0.0889'}
2025-02-26 18:13:03,112 - EarlyStopping counter: 1 out of 10
2025-02-26 18:13:27,918 - {'epoch': 43, 'rec_loss': '6.8122'}
2025-02-26 18:13:36,799 - {'Epoch': 43, 'HR@5': '0.0953', 'NDCG@5': '0.0689', 'HR@10': '0.1278', 'NDCG@10': '0.0793', 'HR@20': '0.1688', 'NDCG@20': '0.0897'}
2025-02-26 18:13:36,801 - EarlyStopping counter: 2 out of 10
2025-02-26 18:14:01,878 - {'epoch': 44, 'rec_loss': '6.8083'}
2025-02-26 18:14:10,526 - {'Epoch': 44, 'HR@5': '0.0932', 'NDCG@5': '0.0675', 'HR@10': '0.1272', 'NDCG@10': '0.0785', 'HR@20': '0.1673', 'NDCG@20': '0.0887'}
2025-02-26 18:14:10,528 - EarlyStopping counter: 3 out of 10
2025-02-26 18:14:36,630 - {'epoch': 45, 'rec_loss': '6.7956'}
2025-02-26 18:14:44,862 - {'Epoch': 45, 'HR@5': '0.0940', 'NDCG@5': '0.0680', 'HR@10': '0.1272', 'NDCG@10': '0.0787', 'HR@20': '0.1668', 'NDCG@20': '0.0887'}
2025-02-26 18:14:44,864 - EarlyStopping counter: 4 out of 10
2025-02-26 18:15:10,510 - {'epoch': 46, 'rec_loss': '6.7922'}
2025-02-26 18:15:19,157 - {'Epoch': 46, 'HR@5': '0.0947', 'NDCG@5': '0.0686', 'HR@10': '0.1268', 'NDCG@10': '0.0789', 'HR@20': '0.1684', 'NDCG@20': '0.0894'}
2025-02-26 18:15:19,158 - EarlyStopping counter: 5 out of 10
2025-02-26 18:15:44,873 - {'epoch': 47, 'rec_loss': '6.7837'}
2025-02-26 18:15:53,392 - {'Epoch': 47, 'HR@5': '0.0934', 'NDCG@5': '0.0681', 'HR@10': '0.1267', 'NDCG@10': '0.0787', 'HR@20': '0.1638', 'NDCG@20': '0.0881'}
2025-02-26 18:15:53,394 - EarlyStopping counter: 6 out of 10
2025-02-26 18:16:17,486 - {'epoch': 48, 'rec_loss': '6.7843'}
2025-02-26 18:16:25,865 - {'Epoch': 48, 'HR@5': '0.0956', 'NDCG@5': '0.0693', 'HR@10': '0.1273', 'NDCG@10': '0.0795', 'HR@20': '0.1667', 'NDCG@20': '0.0894'}
2025-02-26 18:16:25,867 - EarlyStopping counter: 7 out of 10
2025-02-26 18:16:50,871 - {'epoch': 49, 'rec_loss': '6.7770'}
2025-02-26 18:16:59,374 - {'Epoch': 49, 'HR@5': '0.0952', 'NDCG@5': '0.0694', 'HR@10': '0.1265', 'NDCG@10': '0.0794', 'HR@20': '0.1662', 'NDCG@20': '0.0895'}
2025-02-26 18:16:59,376 - EarlyStopping counter: 8 out of 10
2025-02-26 18:17:24,698 - {'epoch': 50, 'rec_loss': '6.7656'}
2025-02-26 18:17:33,092 - {'Epoch': 50, 'HR@5': '0.0943', 'NDCG@5': '0.0686', 'HR@10': '0.1275', 'NDCG@10': '0.0793', 'HR@20': '0.1668', 'NDCG@20': '0.0892'}
2025-02-26 18:17:33,095 - EarlyStopping counter: 9 out of 10
2025-02-26 18:17:59,467 - {'epoch': 51, 'rec_loss': '6.7685'}
2025-02-26 18:18:08,034 - {'Epoch': 51, 'HR@5': '0.0950', 'NDCG@5': '0.0689', 'HR@10': '0.1268', 'NDCG@10': '0.0792', 'HR@20': '0.1680', 'NDCG@20': '0.0897'}
2025-02-26 18:18:08,036 - EarlyStopping counter: 10 out of 10
2025-02-26 18:18:08,036 - Early stopping
2025-02-26 18:18:08,036 - ---------------Test Score---------------
2025-02-26 18:18:16,614 - {'Epoch': 0, 'HR@5': '0.0803', 'NDCG@5': '0.0575', 'HR@10': '0.1083', 'NDCG@10': '0.0665', 'HR@20': '0.1437', 'NDCG@20': '0.0754'}
2025-02-26 18:18:16,616 - Scale_Toys
2025-02-26 18:18:16,616 - {'Epoch': 0, 'HR@5': '0.0803', 'NDCG@5': '0.0575', 'HR@10': '0.1083', 'NDCG@10': '0.0665', 'HR@20': '0.1437', 'NDCG@20': '0.0754'}
2025-02-26 19:10:58,425 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 5], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-02-26 19:11:02,386 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-26 19:11:02,416 - Total Parameters: 916817
2025-02-26 19:11:30,383 - {'epoch': 0, 'rec_loss': '9.0896'}
2025-02-26 19:11:38,438 - {'Epoch': 0, 'HR@5': '0.0049', 'NDCG@5': '0.0033', 'HR@10': '0.0107', 'NDCG@10': '0.0051', 'HR@20': '0.0193', 'NDCG@20': '0.0073'}
2025-02-26 19:11:38,440 - Validation score increased.  Saving model ...
2025-02-26 19:12:04,383 - {'epoch': 1, 'rec_loss': '8.6781'}
2025-02-26 19:12:12,809 - {'Epoch': 1, 'HR@5': '0.0201', 'NDCG@5': '0.0143', 'HR@10': '0.0287', 'NDCG@10': '0.0170', 'HR@20': '0.0433', 'NDCG@20': '0.0206'}
2025-02-26 19:12:12,817 - Validation score increased.  Saving model ...
2025-02-26 19:12:36,923 - {'epoch': 2, 'rec_loss': '8.3675'}
2025-02-26 19:12:44,825 - {'Epoch': 2, 'HR@5': '0.0373', 'NDCG@5': '0.0266', 'HR@10': '0.0527', 'NDCG@10': '0.0315', 'HR@20': '0.0753', 'NDCG@20': '0.0372'}
2025-02-26 19:12:44,836 - Validation score increased.  Saving model ...
2025-02-26 19:13:10,150 - {'epoch': 3, 'rec_loss': '8.0951'}
2025-02-26 19:13:18,563 - {'Epoch': 3, 'HR@5': '0.0506', 'NDCG@5': '0.0358', 'HR@10': '0.0719', 'NDCG@10': '0.0427', 'HR@20': '0.1001', 'NDCG@20': '0.0498'}
2025-02-26 19:13:18,573 - Validation score increased.  Saving model ...
2025-02-26 19:13:45,019 - {'epoch': 4, 'rec_loss': '7.8859'}
2025-02-26 19:13:53,214 - {'Epoch': 4, 'HR@5': '0.0626', 'NDCG@5': '0.0446', 'HR@10': '0.0858', 'NDCG@10': '0.0521', 'HR@20': '0.1162', 'NDCG@20': '0.0598'}
2025-02-26 19:13:53,222 - Validation score increased.  Saving model ...
2025-02-26 19:14:18,006 - {'epoch': 5, 'rec_loss': '7.7228'}
2025-02-26 19:14:26,138 - {'Epoch': 5, 'HR@5': '0.0695', 'NDCG@5': '0.0499', 'HR@10': '0.0971', 'NDCG@10': '0.0587', 'HR@20': '0.1297', 'NDCG@20': '0.0669'}
2025-02-26 19:14:26,150 - Validation score increased.  Saving model ...
2025-02-26 19:14:51,114 - {'epoch': 6, 'rec_loss': '7.6035'}
2025-02-26 19:14:59,267 - {'Epoch': 6, 'HR@5': '0.0737', 'NDCG@5': '0.0536', 'HR@10': '0.1035', 'NDCG@10': '0.0632', 'HR@20': '0.1394', 'NDCG@20': '0.0723'}
2025-02-26 19:14:59,272 - Validation score increased.  Saving model ...
2025-02-26 19:15:26,166 - {'epoch': 7, 'rec_loss': '7.5109'}
2025-02-26 19:15:34,761 - {'Epoch': 7, 'HR@5': '0.0792', 'NDCG@5': '0.0574', 'HR@10': '0.1079', 'NDCG@10': '0.0666', 'HR@20': '0.1425', 'NDCG@20': '0.0753'}
2025-02-26 19:15:34,769 - Validation score increased.  Saving model ...
2025-02-26 19:16:01,470 - {'epoch': 8, 'rec_loss': '7.4292'}
2025-02-26 19:16:09,807 - {'Epoch': 8, 'HR@5': '0.0833', 'NDCG@5': '0.0603', 'HR@10': '0.1113', 'NDCG@10': '0.0693', 'HR@20': '0.1468', 'NDCG@20': '0.0782'}
2025-02-26 19:16:09,815 - Validation score increased.  Saving model ...
2025-02-26 19:16:35,757 - {'epoch': 9, 'rec_loss': '7.3692'}
2025-02-26 19:16:43,795 - {'Epoch': 9, 'HR@5': '0.0829', 'NDCG@5': '0.0601', 'HR@10': '0.1135', 'NDCG@10': '0.0700', 'HR@20': '0.1504', 'NDCG@20': '0.0792'}
2025-02-26 19:16:43,804 - Validation score increased.  Saving model ...
2025-02-26 19:17:09,638 - {'epoch': 10, 'rec_loss': '7.3139'}
2025-02-26 19:17:17,598 - {'Epoch': 10, 'HR@5': '0.0860', 'NDCG@5': '0.0626', 'HR@10': '0.1152', 'NDCG@10': '0.0720', 'HR@20': '0.1520', 'NDCG@20': '0.0813'}
2025-02-26 19:17:17,606 - Validation score increased.  Saving model ...
2025-02-26 19:17:44,232 - {'epoch': 11, 'rec_loss': '7.2679'}
2025-02-26 19:17:52,861 - {'Epoch': 11, 'HR@5': '0.0875', 'NDCG@5': '0.0628', 'HR@10': '0.1168', 'NDCG@10': '0.0722', 'HR@20': '0.1551', 'NDCG@20': '0.0819'}
2025-02-26 19:17:52,869 - Validation score increased.  Saving model ...
2025-02-26 19:18:18,477 - {'epoch': 12, 'rec_loss': '7.2281'}
2025-02-26 19:18:26,681 - {'Epoch': 12, 'HR@5': '0.0876', 'NDCG@5': '0.0633', 'HR@10': '0.1190', 'NDCG@10': '0.0734', 'HR@20': '0.1546', 'NDCG@20': '0.0824'}
2025-02-26 19:18:26,687 - Validation score increased.  Saving model ...
2025-02-26 19:18:51,414 - {'epoch': 13, 'rec_loss': '7.1959'}
2025-02-26 19:18:59,693 - {'Epoch': 13, 'HR@5': '0.0892', 'NDCG@5': '0.0641', 'HR@10': '0.1191', 'NDCG@10': '0.0737', 'HR@20': '0.1574', 'NDCG@20': '0.0834'}
2025-02-26 19:18:59,701 - Validation score increased.  Saving model ...
2025-02-26 19:19:25,828 - {'epoch': 14, 'rec_loss': '7.1706'}
2025-02-26 19:19:34,162 - {'Epoch': 14, 'HR@5': '0.0904', 'NDCG@5': '0.0651', 'HR@10': '0.1203', 'NDCG@10': '0.0747', 'HR@20': '0.1581', 'NDCG@20': '0.0843'}
2025-02-26 19:19:34,167 - Validation score increased.  Saving model ...
2025-02-26 19:20:00,455 - {'epoch': 15, 'rec_loss': '7.1377'}
2025-02-26 19:20:08,829 - {'Epoch': 15, 'HR@5': '0.0907', 'NDCG@5': '0.0657', 'HR@10': '0.1211', 'NDCG@10': '0.0756', 'HR@20': '0.1576', 'NDCG@20': '0.0848'}
2025-02-26 19:20:08,837 - Validation score increased.  Saving model ...
2025-02-26 19:20:34,342 - {'epoch': 16, 'rec_loss': '7.1209'}
2025-02-26 19:20:42,941 - {'Epoch': 16, 'HR@5': '0.0913', 'NDCG@5': '0.0659', 'HR@10': '0.1210', 'NDCG@10': '0.0755', 'HR@20': '0.1579', 'NDCG@20': '0.0848'}
2025-02-26 19:20:42,950 - Validation score increased.  Saving model ...
2025-02-26 19:21:08,262 - {'epoch': 17, 'rec_loss': '7.0898'}
2025-02-26 19:21:16,713 - {'Epoch': 17, 'HR@5': '0.0913', 'NDCG@5': '0.0664', 'HR@10': '0.1236', 'NDCG@10': '0.0768', 'HR@20': '0.1603', 'NDCG@20': '0.0860'}
2025-02-26 19:21:16,720 - Validation score increased.  Saving model ...
2025-02-26 19:21:44,111 - {'epoch': 18, 'rec_loss': '7.0747'}
2025-02-26 19:21:52,811 - {'Epoch': 18, 'HR@5': '0.0925', 'NDCG@5': '0.0668', 'HR@10': '0.1223', 'NDCG@10': '0.0764', 'HR@20': '0.1614', 'NDCG@20': '0.0862'}
2025-02-26 19:21:52,820 - Validation score increased.  Saving model ...
2025-02-26 19:22:20,037 - {'epoch': 19, 'rec_loss': '7.0563'}
2025-02-26 19:22:28,477 - {'Epoch': 19, 'HR@5': '0.0913', 'NDCG@5': '0.0664', 'HR@10': '0.1232', 'NDCG@10': '0.0767', 'HR@20': '0.1628', 'NDCG@20': '0.0867'}
2025-02-26 19:22:28,485 - Validation score increased.  Saving model ...
2025-02-26 19:22:53,571 - {'epoch': 20, 'rec_loss': '7.0356'}
2025-02-26 19:23:01,755 - {'Epoch': 20, 'HR@5': '0.0918', 'NDCG@5': '0.0664', 'HR@10': '0.1239', 'NDCG@10': '0.0768', 'HR@20': '0.1642', 'NDCG@20': '0.0869'}
2025-02-26 19:23:01,762 - Validation score increased.  Saving model ...
2025-02-26 19:23:27,469 - {'epoch': 21, 'rec_loss': '7.0188'}
2025-02-26 19:23:36,009 - {'Epoch': 21, 'HR@5': '0.0906', 'NDCG@5': '0.0659', 'HR@10': '0.1217', 'NDCG@10': '0.0760', 'HR@20': '0.1634', 'NDCG@20': '0.0865'}
2025-02-26 19:23:36,018 - EarlyStopping counter: 1 out of 10
2025-02-26 19:24:02,688 - {'epoch': 22, 'rec_loss': '7.0063'}
2025-02-26 19:24:11,223 - {'Epoch': 22, 'HR@5': '0.0910', 'NDCG@5': '0.0663', 'HR@10': '0.1217', 'NDCG@10': '0.0762', 'HR@20': '0.1629', 'NDCG@20': '0.0866'}
2025-02-26 19:24:11,229 - EarlyStopping counter: 2 out of 10
2025-02-26 19:24:37,483 - {'epoch': 23, 'rec_loss': '6.9954'}
2025-02-26 19:24:45,720 - {'Epoch': 23, 'HR@5': '0.0897', 'NDCG@5': '0.0659', 'HR@10': '0.1222', 'NDCG@10': '0.0764', 'HR@20': '0.1635', 'NDCG@20': '0.0867'}
2025-02-26 19:24:45,730 - EarlyStopping counter: 3 out of 10
2025-02-26 19:25:10,167 - {'epoch': 24, 'rec_loss': '6.9795'}
2025-02-26 19:25:18,211 - {'Epoch': 24, 'HR@5': '0.0912', 'NDCG@5': '0.0669', 'HR@10': '0.1254', 'NDCG@10': '0.0780', 'HR@20': '0.1640', 'NDCG@20': '0.0877'}
2025-02-26 19:25:18,219 - Validation score increased.  Saving model ...
2025-02-26 19:25:44,251 - {'epoch': 25, 'rec_loss': '6.9621'}
2025-02-26 19:25:52,996 - {'Epoch': 25, 'HR@5': '0.0938', 'NDCG@5': '0.0679', 'HR@10': '0.1257', 'NDCG@10': '0.0782', 'HR@20': '0.1658', 'NDCG@20': '0.0883'}
2025-02-26 19:25:52,998 - Validation score increased.  Saving model ...
2025-02-26 19:26:19,721 - {'epoch': 26, 'rec_loss': '6.9572'}
2025-02-26 19:26:28,217 - {'Epoch': 26, 'HR@5': '0.0938', 'NDCG@5': '0.0683', 'HR@10': '0.1263', 'NDCG@10': '0.0788', 'HR@20': '0.1655', 'NDCG@20': '0.0887'}
2025-02-26 19:26:28,225 - Validation score increased.  Saving model ...
2025-02-26 19:26:53,123 - {'epoch': 27, 'rec_loss': '6.9363'}
2025-02-26 19:27:01,242 - {'Epoch': 27, 'HR@5': '0.0930', 'NDCG@5': '0.0675', 'HR@10': '0.1273', 'NDCG@10': '0.0786', 'HR@20': '0.1646', 'NDCG@20': '0.0880'}
2025-02-26 19:27:01,248 - EarlyStopping counter: 1 out of 10
2025-02-26 19:27:26,483 - {'epoch': 28, 'rec_loss': '6.9336'}
2025-02-26 19:27:34,675 - {'Epoch': 28, 'HR@5': '0.0937', 'NDCG@5': '0.0675', 'HR@10': '0.1260', 'NDCG@10': '0.0779', 'HR@20': '0.1662', 'NDCG@20': '0.0880'}
2025-02-26 19:27:34,682 - EarlyStopping counter: 2 out of 10
2025-02-26 19:28:01,277 - {'epoch': 29, 'rec_loss': '6.9170'}
2025-02-26 19:28:10,123 - {'Epoch': 29, 'HR@5': '0.0936', 'NDCG@5': '0.0684', 'HR@10': '0.1252', 'NDCG@10': '0.0786', 'HR@20': '0.1659', 'NDCG@20': '0.0888'}
2025-02-26 19:28:10,128 - Validation score increased.  Saving model ...
2025-02-26 19:28:37,384 - {'epoch': 30, 'rec_loss': '6.9047'}
2025-02-26 19:28:45,591 - {'Epoch': 30, 'HR@5': '0.0927', 'NDCG@5': '0.0677', 'HR@10': '0.1271', 'NDCG@10': '0.0788', 'HR@20': '0.1671', 'NDCG@20': '0.0889'}
2025-02-26 19:28:45,600 - Validation score increased.  Saving model ...
2025-02-26 19:29:10,647 - {'epoch': 31, 'rec_loss': '6.8996'}
2025-02-26 19:29:18,908 - {'Epoch': 31, 'HR@5': '0.0937', 'NDCG@5': '0.0681', 'HR@10': '0.1275', 'NDCG@10': '0.0789', 'HR@20': '0.1664', 'NDCG@20': '0.0887'}
2025-02-26 19:29:18,918 - EarlyStopping counter: 1 out of 10
2025-02-26 19:29:43,231 - {'epoch': 32, 'rec_loss': '6.8952'}
2025-02-26 19:29:51,806 - {'Epoch': 32, 'HR@5': '0.0939', 'NDCG@5': '0.0680', 'HR@10': '0.1274', 'NDCG@10': '0.0788', 'HR@20': '0.1680', 'NDCG@20': '0.0890'}
2025-02-26 19:29:51,814 - Validation score increased.  Saving model ...
2025-02-26 19:30:16,230 - {'epoch': 33, 'rec_loss': '6.8845'}
2025-02-26 19:30:24,649 - {'Epoch': 33, 'HR@5': '0.0939', 'NDCG@5': '0.0677', 'HR@10': '0.1271', 'NDCG@10': '0.0783', 'HR@20': '0.1675', 'NDCG@20': '0.0884'}
2025-02-26 19:30:24,657 - EarlyStopping counter: 1 out of 10
2025-02-26 19:30:48,933 - {'epoch': 34, 'rec_loss': '6.8707'}
2025-02-26 19:30:57,292 - {'Epoch': 34, 'HR@5': '0.0935', 'NDCG@5': '0.0680', 'HR@10': '0.1269', 'NDCG@10': '0.0788', 'HR@20': '0.1670', 'NDCG@20': '0.0889'}
2025-02-26 19:30:57,303 - EarlyStopping counter: 2 out of 10
2025-02-26 19:31:21,685 - {'epoch': 35, 'rec_loss': '6.8670'}
2025-02-26 19:31:30,117 - {'Epoch': 35, 'HR@5': '0.0926', 'NDCG@5': '0.0674', 'HR@10': '0.1266', 'NDCG@10': '0.0783', 'HR@20': '0.1654', 'NDCG@20': '0.0880'}
2025-02-26 19:31:30,124 - EarlyStopping counter: 3 out of 10
2025-02-26 19:31:54,146 - {'epoch': 36, 'rec_loss': '6.8656'}
2025-02-26 19:32:02,918 - {'Epoch': 36, 'HR@5': '0.0936', 'NDCG@5': '0.0679', 'HR@10': '0.1273', 'NDCG@10': '0.0788', 'HR@20': '0.1665', 'NDCG@20': '0.0887'}
2025-02-26 19:32:02,927 - EarlyStopping counter: 4 out of 10
2025-02-26 19:32:27,197 - {'epoch': 37, 'rec_loss': '6.8543'}
2025-02-26 19:32:35,870 - {'Epoch': 37, 'HR@5': '0.0940', 'NDCG@5': '0.0682', 'HR@10': '0.1297', 'NDCG@10': '0.0798', 'HR@20': '0.1690', 'NDCG@20': '0.0897'}
2025-02-26 19:32:35,872 - Validation score increased.  Saving model ...
2025-02-26 19:33:00,361 - {'epoch': 38, 'rec_loss': '6.8490'}
2025-02-26 19:33:08,858 - {'Epoch': 38, 'HR@5': '0.0938', 'NDCG@5': '0.0685', 'HR@10': '0.1281', 'NDCG@10': '0.0795', 'HR@20': '0.1681', 'NDCG@20': '0.0896'}
2025-02-26 19:33:08,864 - EarlyStopping counter: 1 out of 10
2025-02-26 19:33:32,563 - {'epoch': 39, 'rec_loss': '6.8326'}
2025-02-26 19:33:40,942 - {'Epoch': 39, 'HR@5': '0.0935', 'NDCG@5': '0.0672', 'HR@10': '0.1278', 'NDCG@10': '0.0782', 'HR@20': '0.1662', 'NDCG@20': '0.0879'}
2025-02-26 19:33:40,951 - EarlyStopping counter: 2 out of 10
2025-02-26 19:34:06,639 - {'epoch': 40, 'rec_loss': '6.8301'}
2025-02-26 19:34:14,970 - {'Epoch': 40, 'HR@5': '0.0941', 'NDCG@5': '0.0682', 'HR@10': '0.1273', 'NDCG@10': '0.0789', 'HR@20': '0.1688', 'NDCG@20': '0.0893'}
2025-02-26 19:34:14,976 - EarlyStopping counter: 3 out of 10
2025-02-26 19:34:39,799 - {'epoch': 41, 'rec_loss': '6.8242'}
2025-02-26 19:34:47,907 - {'Epoch': 41, 'HR@5': '0.0950', 'NDCG@5': '0.0688', 'HR@10': '0.1269', 'NDCG@10': '0.0791', 'HR@20': '0.1675', 'NDCG@20': '0.0894'}
2025-02-26 19:34:47,915 - EarlyStopping counter: 4 out of 10
2025-02-26 19:35:14,045 - {'epoch': 42, 'rec_loss': '6.8190'}
2025-02-26 19:35:22,370 - {'Epoch': 42, 'HR@5': '0.0959', 'NDCG@5': '0.0680', 'HR@10': '0.1298', 'NDCG@10': '0.0789', 'HR@20': '0.1675', 'NDCG@20': '0.0885'}
2025-02-26 19:35:22,380 - EarlyStopping counter: 5 out of 10
2025-02-26 19:35:48,920 - {'epoch': 43, 'rec_loss': '6.8106'}
2025-02-26 19:35:57,000 - {'Epoch': 43, 'HR@5': '0.0953', 'NDCG@5': '0.0685', 'HR@10': '0.1287', 'NDCG@10': '0.0793', 'HR@20': '0.1689', 'NDCG@20': '0.0894'}
2025-02-26 19:35:57,008 - EarlyStopping counter: 6 out of 10
2025-02-26 19:36:23,464 - {'epoch': 44, 'rec_loss': '6.8099'}
2025-02-26 19:36:31,716 - {'Epoch': 44, 'HR@5': '0.0934', 'NDCG@5': '0.0677', 'HR@10': '0.1278', 'NDCG@10': '0.0788', 'HR@20': '0.1668', 'NDCG@20': '0.0887'}
2025-02-26 19:36:31,727 - EarlyStopping counter: 7 out of 10
2025-02-26 19:36:57,383 - {'epoch': 45, 'rec_loss': '6.7975'}
2025-02-26 19:37:05,617 - {'Epoch': 45, 'HR@5': '0.0942', 'NDCG@5': '0.0685', 'HR@10': '0.1291', 'NDCG@10': '0.0797', 'HR@20': '0.1691', 'NDCG@20': '0.0898'}
2025-02-26 19:37:05,628 - Validation score increased.  Saving model ...
2025-02-26 19:37:33,102 - {'epoch': 46, 'rec_loss': '6.7899'}
2025-02-26 19:37:41,508 - {'Epoch': 46, 'HR@5': '0.0943', 'NDCG@5': '0.0685', 'HR@10': '0.1273', 'NDCG@10': '0.0791', 'HR@20': '0.1676', 'NDCG@20': '0.0893'}
2025-02-26 19:37:41,515 - EarlyStopping counter: 1 out of 10
2025-02-26 19:38:08,302 - {'epoch': 47, 'rec_loss': '6.7809'}
2025-02-26 19:38:16,490 - {'Epoch': 47, 'HR@5': '0.0946', 'NDCG@5': '0.0686', 'HR@10': '0.1284', 'NDCG@10': '0.0794', 'HR@20': '0.1678', 'NDCG@20': '0.0894'}
2025-02-26 19:38:16,497 - EarlyStopping counter: 2 out of 10
2025-02-26 19:38:41,598 - {'epoch': 48, 'rec_loss': '6.7821'}
2025-02-26 19:38:50,010 - {'Epoch': 48, 'HR@5': '0.0937', 'NDCG@5': '0.0677', 'HR@10': '0.1270', 'NDCG@10': '0.0784', 'HR@20': '0.1677', 'NDCG@20': '0.0887'}
2025-02-26 19:38:50,017 - EarlyStopping counter: 3 out of 10
2025-02-26 19:39:16,512 - {'epoch': 49, 'rec_loss': '6.7801'}
2025-02-26 19:39:24,835 - {'Epoch': 49, 'HR@5': '0.0953', 'NDCG@5': '0.0694', 'HR@10': '0.1275', 'NDCG@10': '0.0797', 'HR@20': '0.1676', 'NDCG@20': '0.0898'}
2025-02-26 19:39:24,840 - Validation score increased.  Saving model ...
2025-02-26 19:39:52,132 - {'epoch': 50, 'rec_loss': '6.7751'}
2025-02-26 19:40:01,129 - {'Epoch': 50, 'HR@5': '0.0937', 'NDCG@5': '0.0688', 'HR@10': '0.1283', 'NDCG@10': '0.0799', 'HR@20': '0.1686', 'NDCG@20': '0.0901'}
2025-02-26 19:40:01,140 - Validation score increased.  Saving model ...
2025-02-26 19:40:28,679 - {'epoch': 51, 'rec_loss': '6.7701'}
2025-02-26 19:40:37,377 - {'Epoch': 51, 'HR@5': '0.0935', 'NDCG@5': '0.0684', 'HR@10': '0.1269', 'NDCG@10': '0.0791', 'HR@20': '0.1661', 'NDCG@20': '0.0891'}
2025-02-26 19:40:37,386 - EarlyStopping counter: 1 out of 10
2025-02-26 19:41:03,512 - {'epoch': 52, 'rec_loss': '6.7610'}
2025-02-26 19:41:12,265 - {'Epoch': 52, 'HR@5': '0.0943', 'NDCG@5': '0.0692', 'HR@10': '0.1273', 'NDCG@10': '0.0798', 'HR@20': '0.1673', 'NDCG@20': '0.0899'}
2025-02-26 19:41:12,272 - EarlyStopping counter: 2 out of 10
2025-02-26 19:41:39,399 - {'epoch': 53, 'rec_loss': '6.7605'}
2025-02-26 19:41:47,761 - {'Epoch': 53, 'HR@5': '0.0936', 'NDCG@5': '0.0684', 'HR@10': '0.1275', 'NDCG@10': '0.0793', 'HR@20': '0.1671', 'NDCG@20': '0.0893'}
2025-02-26 19:41:47,769 - EarlyStopping counter: 3 out of 10
2025-02-26 19:42:17,943 - {'epoch': 54, 'rec_loss': '6.7516'}
2025-02-26 19:42:26,163 - {'Epoch': 54, 'HR@5': '0.0949', 'NDCG@5': '0.0695', 'HR@10': '0.1286', 'NDCG@10': '0.0803', 'HR@20': '0.1666', 'NDCG@20': '0.0899'}
2025-02-26 19:42:26,173 - EarlyStopping counter: 4 out of 10
2025-02-26 19:42:53,475 - {'epoch': 55, 'rec_loss': '6.7480'}
2025-02-26 19:43:01,476 - {'Epoch': 55, 'HR@5': '0.0963', 'NDCG@5': '0.0695', 'HR@10': '0.1287', 'NDCG@10': '0.0800', 'HR@20': '0.1671', 'NDCG@20': '0.0896'}
2025-02-26 19:43:01,484 - EarlyStopping counter: 5 out of 10
2025-02-26 19:43:27,431 - {'epoch': 56, 'rec_loss': '6.7534'}
2025-02-26 19:43:35,987 - {'Epoch': 56, 'HR@5': '0.0951', 'NDCG@5': '0.0691', 'HR@10': '0.1284', 'NDCG@10': '0.0798', 'HR@20': '0.1671', 'NDCG@20': '0.0895'}
2025-02-26 19:43:35,994 - EarlyStopping counter: 6 out of 10
2025-02-26 19:44:03,690 - {'epoch': 57, 'rec_loss': '6.7402'}
2025-02-26 19:44:12,076 - {'Epoch': 57, 'HR@5': '0.0959', 'NDCG@5': '0.0692', 'HR@10': '0.1294', 'NDCG@10': '0.0799', 'HR@20': '0.1675', 'NDCG@20': '0.0895'}
2025-02-26 19:44:12,082 - EarlyStopping counter: 7 out of 10
2025-02-26 19:44:39,773 - {'epoch': 58, 'rec_loss': '6.7425'}
2025-02-26 19:44:48,133 - {'Epoch': 58, 'HR@5': '0.0954', 'NDCG@5': '0.0693', 'HR@10': '0.1290', 'NDCG@10': '0.0802', 'HR@20': '0.1690', 'NDCG@20': '0.0902'}
2025-02-26 19:44:48,140 - Validation score increased.  Saving model ...
2025-02-26 19:45:15,807 - {'epoch': 59, 'rec_loss': '6.7347'}
2025-02-26 19:45:24,706 - {'Epoch': 59, 'HR@5': '0.0947', 'NDCG@5': '0.0691', 'HR@10': '0.1282', 'NDCG@10': '0.0798', 'HR@20': '0.1685', 'NDCG@20': '0.0900'}
2025-02-26 19:45:24,714 - EarlyStopping counter: 1 out of 10
2025-02-26 19:45:53,058 - {'epoch': 60, 'rec_loss': '6.7282'}
2025-02-26 19:46:01,993 - {'Epoch': 60, 'HR@5': '0.0936', 'NDCG@5': '0.0681', 'HR@10': '0.1282', 'NDCG@10': '0.0793', 'HR@20': '0.1671', 'NDCG@20': '0.0891'}
2025-02-26 19:46:02,000 - EarlyStopping counter: 2 out of 10
2025-02-26 19:46:30,289 - {'epoch': 61, 'rec_loss': '6.7204'}
2025-02-26 19:46:38,987 - {'Epoch': 61, 'HR@5': '0.0948', 'NDCG@5': '0.0691', 'HR@10': '0.1288', 'NDCG@10': '0.0800', 'HR@20': '0.1685', 'NDCG@20': '0.0900'}
2025-02-26 19:46:38,995 - EarlyStopping counter: 3 out of 10
2025-02-26 19:47:07,201 - {'epoch': 62, 'rec_loss': '6.7196'}
2025-02-26 19:47:15,655 - {'Epoch': 62, 'HR@5': '0.0939', 'NDCG@5': '0.0684', 'HR@10': '0.1273', 'NDCG@10': '0.0792', 'HR@20': '0.1668', 'NDCG@20': '0.0891'}
2025-02-26 19:47:15,661 - EarlyStopping counter: 4 out of 10
2025-02-26 19:47:43,822 - {'epoch': 63, 'rec_loss': '6.7119'}
2025-02-26 19:47:52,395 - {'Epoch': 63, 'HR@5': '0.0948', 'NDCG@5': '0.0690', 'HR@10': '0.1286', 'NDCG@10': '0.0799', 'HR@20': '0.1680', 'NDCG@20': '0.0899'}
2025-02-26 19:47:52,397 - EarlyStopping counter: 5 out of 10
2025-02-26 19:48:21,678 - {'epoch': 64, 'rec_loss': '6.7160'}
2025-02-26 19:48:30,351 - {'Epoch': 64, 'HR@5': '0.0943', 'NDCG@5': '0.0688', 'HR@10': '0.1291', 'NDCG@10': '0.0801', 'HR@20': '0.1676', 'NDCG@20': '0.0898'}
2025-02-26 19:48:30,357 - EarlyStopping counter: 6 out of 10
2025-02-26 19:48:59,138 - {'epoch': 65, 'rec_loss': '6.7112'}
2025-02-26 19:49:07,808 - {'Epoch': 65, 'HR@5': '0.0950', 'NDCG@5': '0.0689', 'HR@10': '0.1284', 'NDCG@10': '0.0796', 'HR@20': '0.1675', 'NDCG@20': '0.0895'}
2025-02-26 19:49:07,815 - EarlyStopping counter: 7 out of 10
2025-02-26 19:49:35,719 - {'epoch': 66, 'rec_loss': '6.7008'}
2025-02-26 19:49:44,363 - {'Epoch': 66, 'HR@5': '0.0936', 'NDCG@5': '0.0682', 'HR@10': '0.1263', 'NDCG@10': '0.0788', 'HR@20': '0.1675', 'NDCG@20': '0.0892'}
2025-02-26 19:49:44,370 - EarlyStopping counter: 8 out of 10
2025-02-26 19:50:11,186 - {'epoch': 67, 'rec_loss': '6.6994'}
2025-02-26 19:50:19,587 - {'Epoch': 67, 'HR@5': '0.0950', 'NDCG@5': '0.0692', 'HR@10': '0.1281', 'NDCG@10': '0.0799', 'HR@20': '0.1680', 'NDCG@20': '0.0899'}
2025-02-26 19:50:19,597 - EarlyStopping counter: 9 out of 10
2025-02-26 19:50:47,792 - {'epoch': 68, 'rec_loss': '6.7046'}
2025-02-26 19:50:56,228 - {'Epoch': 68, 'HR@5': '0.0957', 'NDCG@5': '0.0696', 'HR@10': '0.1279', 'NDCG@10': '0.0799', 'HR@20': '0.1674', 'NDCG@20': '0.0899'}
2025-02-26 19:50:56,238 - EarlyStopping counter: 10 out of 10
2025-02-26 19:50:56,238 - Early stopping
2025-02-26 19:50:56,239 - ---------------Test Score---------------
2025-02-26 19:51:04,603 - {'Epoch': 0, 'HR@5': '0.0772', 'NDCG@5': '0.0563', 'HR@10': '0.1055', 'NDCG@10': '0.0655', 'HR@20': '0.1404', 'NDCG@20': '0.0743'}
2025-02-26 19:51:04,609 - Scale_Toys
2025-02-26 19:51:04,610 - {'Epoch': 0, 'HR@5': '0.0772', 'NDCG@5': '0.0563', 'HR@10': '0.1055', 'NDCG@10': '0.0655', 'HR@20': '0.1404', 'NDCG@20': '0.0743'}
2025-02-26 20:08:54,122 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 10], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-02-26 20:08:59,706 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-26 20:08:59,718 - Total Parameters: 917142
2025-02-26 20:09:25,923 - {'epoch': 0, 'rec_loss': '9.0927'}
2025-02-26 20:09:34,158 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0052', 'HR@10': '0.0125', 'NDCG@10': '0.0066', 'HR@20': '0.0203', 'NDCG@20': '0.0085'}
2025-02-26 20:09:34,164 - Validation score increased.  Saving model ...
2025-02-26 20:09:59,044 - {'epoch': 1, 'rec_loss': '8.7009'}
2025-02-26 20:10:07,582 - {'Epoch': 1, 'HR@5': '0.0165', 'NDCG@5': '0.0118', 'HR@10': '0.0257', 'NDCG@10': '0.0147', 'HR@20': '0.0399', 'NDCG@20': '0.0183'}
2025-02-26 20:10:07,593 - Validation score increased.  Saving model ...
2025-02-26 20:10:32,997 - {'epoch': 2, 'rec_loss': '8.3986'}
2025-02-26 20:10:41,291 - {'Epoch': 2, 'HR@5': '0.0355', 'NDCG@5': '0.0248', 'HR@10': '0.0505', 'NDCG@10': '0.0297', 'HR@20': '0.0737', 'NDCG@20': '0.0355'}
2025-02-26 20:10:41,295 - Validation score increased.  Saving model ...
2025-02-26 20:11:07,147 - {'epoch': 3, 'rec_loss': '8.1256'}
2025-02-26 20:11:15,542 - {'Epoch': 3, 'HR@5': '0.0495', 'NDCG@5': '0.0357', 'HR@10': '0.0691', 'NDCG@10': '0.0420', 'HR@20': '0.0973', 'NDCG@20': '0.0491'}
2025-02-26 20:11:15,549 - Validation score increased.  Saving model ...
2025-02-26 20:11:41,336 - {'epoch': 4, 'rec_loss': '7.9028'}
2025-02-26 20:11:49,521 - {'Epoch': 4, 'HR@5': '0.0608', 'NDCG@5': '0.0430', 'HR@10': '0.0837', 'NDCG@10': '0.0504', 'HR@20': '0.1140', 'NDCG@20': '0.0580'}
2025-02-26 20:11:49,529 - Validation score increased.  Saving model ...
2025-02-26 20:12:15,464 - {'epoch': 5, 'rec_loss': '7.7367'}
2025-02-26 20:12:23,638 - {'Epoch': 5, 'HR@5': '0.0683', 'NDCG@5': '0.0495', 'HR@10': '0.0952', 'NDCG@10': '0.0582', 'HR@20': '0.1273', 'NDCG@20': '0.0663'}
2025-02-26 20:12:23,644 - Validation score increased.  Saving model ...
2025-02-26 20:12:49,490 - {'epoch': 6, 'rec_loss': '7.6105'}
2025-02-26 20:12:57,243 - {'Epoch': 6, 'HR@5': '0.0749', 'NDCG@5': '0.0539', 'HR@10': '0.1022', 'NDCG@10': '0.0627', 'HR@20': '0.1373', 'NDCG@20': '0.0716'}
2025-02-26 20:12:57,250 - Validation score increased.  Saving model ...
2025-02-26 20:13:22,630 - {'epoch': 7, 'rec_loss': '7.5078'}
2025-02-26 20:13:30,279 - {'Epoch': 7, 'HR@5': '0.0791', 'NDCG@5': '0.0564', 'HR@10': '0.1064', 'NDCG@10': '0.0653', 'HR@20': '0.1421', 'NDCG@20': '0.0742'}
2025-02-26 20:13:30,286 - Validation score increased.  Saving model ...
2025-02-26 20:13:58,776 - {'epoch': 8, 'rec_loss': '7.4297'}
2025-02-26 20:14:06,612 - {'Epoch': 8, 'HR@5': '0.0821', 'NDCG@5': '0.0596', 'HR@10': '0.1126', 'NDCG@10': '0.0695', 'HR@20': '0.1490', 'NDCG@20': '0.0787'}
2025-02-26 20:14:06,621 - Validation score increased.  Saving model ...
2025-02-26 20:14:32,397 - {'epoch': 9, 'rec_loss': '7.3632'}
2025-02-26 20:14:39,949 - {'Epoch': 9, 'HR@5': '0.0856', 'NDCG@5': '0.0615', 'HR@10': '0.1134', 'NDCG@10': '0.0705', 'HR@20': '0.1498', 'NDCG@20': '0.0797'}
2025-02-26 20:14:39,955 - Validation score increased.  Saving model ...
2025-02-26 20:15:06,561 - {'epoch': 10, 'rec_loss': '7.3138'}
2025-02-26 20:15:14,506 - {'Epoch': 10, 'HR@5': '0.0860', 'NDCG@5': '0.0617', 'HR@10': '0.1159', 'NDCG@10': '0.0713', 'HR@20': '0.1523', 'NDCG@20': '0.0805'}
2025-02-26 20:15:14,514 - Validation score increased.  Saving model ...
2025-02-26 20:15:39,699 - {'epoch': 11, 'rec_loss': '7.2728'}
2025-02-26 20:15:47,768 - {'Epoch': 11, 'HR@5': '0.0874', 'NDCG@5': '0.0625', 'HR@10': '0.1187', 'NDCG@10': '0.0725', 'HR@20': '0.1557', 'NDCG@20': '0.0818'}
2025-02-26 20:15:47,774 - Validation score increased.  Saving model ...
2025-02-26 20:16:13,710 - {'epoch': 12, 'rec_loss': '7.2288'}
2025-02-26 20:16:21,935 - {'Epoch': 12, 'HR@5': '0.0884', 'NDCG@5': '0.0635', 'HR@10': '0.1195', 'NDCG@10': '0.0736', 'HR@20': '0.1552', 'NDCG@20': '0.0825'}
2025-02-26 20:16:21,945 - Validation score increased.  Saving model ...
2025-02-26 20:16:48,517 - {'epoch': 13, 'rec_loss': '7.1990'}
2025-02-26 20:16:56,926 - {'Epoch': 13, 'HR@5': '0.0891', 'NDCG@5': '0.0646', 'HR@10': '0.1195', 'NDCG@10': '0.0744', 'HR@20': '0.1587', 'NDCG@20': '0.0843'}
2025-02-26 20:16:56,935 - Validation score increased.  Saving model ...
2025-02-26 20:17:24,168 - {'epoch': 14, 'rec_loss': '7.1705'}
2025-02-26 20:17:32,380 - {'Epoch': 14, 'HR@5': '0.0895', 'NDCG@5': '0.0643', 'HR@10': '0.1222', 'NDCG@10': '0.0748', 'HR@20': '0.1614', 'NDCG@20': '0.0847'}
2025-02-26 20:17:32,386 - Validation score increased.  Saving model ...
2025-02-26 20:17:59,385 - {'epoch': 15, 'rec_loss': '7.1403'}
2025-02-26 20:18:07,484 - {'Epoch': 15, 'HR@5': '0.0896', 'NDCG@5': '0.0650', 'HR@10': '0.1221', 'NDCG@10': '0.0754', 'HR@20': '0.1611', 'NDCG@20': '0.0852'}
2025-02-26 20:18:07,491 - Validation score increased.  Saving model ...
2025-02-26 20:18:33,801 - {'epoch': 16, 'rec_loss': '7.1199'}
2025-02-26 20:18:41,959 - {'Epoch': 16, 'HR@5': '0.0911', 'NDCG@5': '0.0658', 'HR@10': '0.1222', 'NDCG@10': '0.0758', 'HR@20': '0.1605', 'NDCG@20': '0.0854'}
2025-02-26 20:18:41,966 - Validation score increased.  Saving model ...
2025-02-26 20:19:08,626 - {'epoch': 17, 'rec_loss': '7.0913'}
2025-02-26 20:19:16,801 - {'Epoch': 17, 'HR@5': '0.0899', 'NDCG@5': '0.0649', 'HR@10': '0.1211', 'NDCG@10': '0.0749', 'HR@20': '0.1612', 'NDCG@20': '0.0850'}
2025-02-26 20:19:16,810 - EarlyStopping counter: 1 out of 10
2025-02-26 20:19:43,180 - {'epoch': 18, 'rec_loss': '7.0791'}
2025-02-26 20:19:50,987 - {'Epoch': 18, 'HR@5': '0.0901', 'NDCG@5': '0.0655', 'HR@10': '0.1234', 'NDCG@10': '0.0762', 'HR@20': '0.1621', 'NDCG@20': '0.0859'}
2025-02-26 20:19:50,995 - Validation score increased.  Saving model ...
2025-02-26 20:20:17,753 - {'epoch': 19, 'rec_loss': '7.0621'}
2025-02-26 20:20:25,602 - {'Epoch': 19, 'HR@5': '0.0900', 'NDCG@5': '0.0649', 'HR@10': '0.1223', 'NDCG@10': '0.0753', 'HR@20': '0.1638', 'NDCG@20': '0.0857'}
2025-02-26 20:20:25,608 - EarlyStopping counter: 1 out of 10
2025-02-26 20:20:51,634 - {'epoch': 20, 'rec_loss': '7.0434'}
2025-02-26 20:21:00,143 - {'Epoch': 20, 'HR@5': '0.0913', 'NDCG@5': '0.0662', 'HR@10': '0.1252', 'NDCG@10': '0.0771', 'HR@20': '0.1634', 'NDCG@20': '0.0868'}
2025-02-26 20:21:00,145 - Validation score increased.  Saving model ...
2025-02-26 20:21:26,866 - {'epoch': 21, 'rec_loss': '7.0260'}
2025-02-26 20:21:35,224 - {'Epoch': 21, 'HR@5': '0.0926', 'NDCG@5': '0.0673', 'HR@10': '0.1249', 'NDCG@10': '0.0777', 'HR@20': '0.1632', 'NDCG@20': '0.0874'}
2025-02-26 20:21:35,232 - Validation score increased.  Saving model ...
2025-02-26 20:22:01,940 - {'epoch': 22, 'rec_loss': '7.0059'}
2025-02-26 20:22:10,280 - {'Epoch': 22, 'HR@5': '0.0925', 'NDCG@5': '0.0667', 'HR@10': '0.1253', 'NDCG@10': '0.0772', 'HR@20': '0.1637', 'NDCG@20': '0.0869'}
2025-02-26 20:22:10,285 - EarlyStopping counter: 1 out of 10
2025-02-26 20:22:37,614 - {'epoch': 23, 'rec_loss': '6.9977'}
2025-02-26 20:22:45,736 - {'Epoch': 23, 'HR@5': '0.0933', 'NDCG@5': '0.0668', 'HR@10': '0.1262', 'NDCG@10': '0.0774', 'HR@20': '0.1648', 'NDCG@20': '0.0871'}
2025-02-26 20:22:45,742 - EarlyStopping counter: 2 out of 10
2025-02-26 20:23:11,596 - {'epoch': 24, 'rec_loss': '6.9794'}
2025-02-26 20:23:19,884 - {'Epoch': 24, 'HR@5': '0.0921', 'NDCG@5': '0.0676', 'HR@10': '0.1265', 'NDCG@10': '0.0787', 'HR@20': '0.1658', 'NDCG@20': '0.0886'}
2025-02-26 20:23:19,892 - Validation score increased.  Saving model ...
2025-02-26 20:23:46,269 - {'epoch': 25, 'rec_loss': '6.9645'}
2025-02-26 20:23:54,312 - {'Epoch': 25, 'HR@5': '0.0928', 'NDCG@5': '0.0674', 'HR@10': '0.1260', 'NDCG@10': '0.0781', 'HR@20': '0.1662', 'NDCG@20': '0.0883'}
2025-02-26 20:23:54,317 - EarlyStopping counter: 1 out of 10
2025-02-26 20:24:21,050 - {'epoch': 26, 'rec_loss': '6.9627'}
2025-02-26 20:24:30,088 - {'Epoch': 26, 'HR@5': '0.0925', 'NDCG@5': '0.0671', 'HR@10': '0.1249', 'NDCG@10': '0.0775', 'HR@20': '0.1645', 'NDCG@20': '0.0875'}
2025-02-26 20:24:30,094 - EarlyStopping counter: 2 out of 10
2025-02-26 20:24:56,324 - {'epoch': 27, 'rec_loss': '6.9507'}
2025-02-26 20:25:04,797 - {'Epoch': 27, 'HR@5': '0.0920', 'NDCG@5': '0.0667', 'HR@10': '0.1248', 'NDCG@10': '0.0773', 'HR@20': '0.1647', 'NDCG@20': '0.0873'}
2025-02-26 20:25:04,799 - EarlyStopping counter: 3 out of 10
2025-02-26 20:25:31,430 - {'epoch': 28, 'rec_loss': '6.9402'}
2025-02-26 20:25:39,852 - {'Epoch': 28, 'HR@5': '0.0938', 'NDCG@5': '0.0675', 'HR@10': '0.1252', 'NDCG@10': '0.0775', 'HR@20': '0.1644', 'NDCG@20': '0.0875'}
2025-02-26 20:25:39,860 - EarlyStopping counter: 4 out of 10
2025-02-26 20:26:06,024 - {'epoch': 29, 'rec_loss': '6.9191'}
2025-02-26 20:26:13,710 - {'Epoch': 29, 'HR@5': '0.0937', 'NDCG@5': '0.0678', 'HR@10': '0.1254', 'NDCG@10': '0.0781', 'HR@20': '0.1666', 'NDCG@20': '0.0885'}
2025-02-26 20:26:13,716 - EarlyStopping counter: 5 out of 10
2025-02-26 20:26:39,895 - {'epoch': 30, 'rec_loss': '6.9112'}
2025-02-26 20:26:47,925 - {'Epoch': 30, 'HR@5': '0.0917', 'NDCG@5': '0.0669', 'HR@10': '0.1256', 'NDCG@10': '0.0777', 'HR@20': '0.1668', 'NDCG@20': '0.0881'}
2025-02-26 20:26:47,932 - EarlyStopping counter: 6 out of 10
2025-02-26 20:27:13,870 - {'epoch': 31, 'rec_loss': '6.9036'}
2025-02-26 20:27:21,675 - {'Epoch': 31, 'HR@5': '0.0934', 'NDCG@5': '0.0676', 'HR@10': '0.1262', 'NDCG@10': '0.0781', 'HR@20': '0.1665', 'NDCG@20': '0.0883'}
2025-02-26 20:27:21,676 - EarlyStopping counter: 7 out of 10
2025-02-26 20:27:47,736 - {'epoch': 32, 'rec_loss': '6.9003'}
2025-02-26 20:27:55,860 - {'Epoch': 32, 'HR@5': '0.0923', 'NDCG@5': '0.0669', 'HR@10': '0.1253', 'NDCG@10': '0.0775', 'HR@20': '0.1672', 'NDCG@20': '0.0881'}
2025-02-26 20:27:55,869 - EarlyStopping counter: 8 out of 10
2025-02-26 20:28:22,754 - {'epoch': 33, 'rec_loss': '6.8877'}
2025-02-26 20:28:31,033 - {'Epoch': 33, 'HR@5': '0.0942', 'NDCG@5': '0.0681', 'HR@10': '0.1261', 'NDCG@10': '0.0784', 'HR@20': '0.1674', 'NDCG@20': '0.0888'}
2025-02-26 20:28:31,042 - Validation score increased.  Saving model ...
2025-02-26 20:28:57,489 - {'epoch': 34, 'rec_loss': '6.8835'}
2025-02-26 20:29:05,626 - {'Epoch': 34, 'HR@5': '0.0937', 'NDCG@5': '0.0671', 'HR@10': '0.1274', 'NDCG@10': '0.0780', 'HR@20': '0.1670', 'NDCG@20': '0.0879'}
2025-02-26 20:29:05,634 - EarlyStopping counter: 1 out of 10
2025-02-26 20:29:33,222 - {'epoch': 35, 'rec_loss': '6.8735'}
2025-02-26 20:29:41,009 - {'Epoch': 35, 'HR@5': '0.0937', 'NDCG@5': '0.0677', 'HR@10': '0.1267', 'NDCG@10': '0.0783', 'HR@20': '0.1655', 'NDCG@20': '0.0881'}
2025-02-26 20:29:41,018 - EarlyStopping counter: 2 out of 10
2025-02-26 20:30:07,684 - {'epoch': 36, 'rec_loss': '6.8709'}
2025-02-26 20:30:15,758 - {'Epoch': 36, 'HR@5': '0.0940', 'NDCG@5': '0.0679', 'HR@10': '0.1277', 'NDCG@10': '0.0788', 'HR@20': '0.1665', 'NDCG@20': '0.0886'}
2025-02-26 20:30:15,765 - EarlyStopping counter: 3 out of 10
2025-02-26 20:30:43,254 - {'epoch': 37, 'rec_loss': '6.8577'}
2025-02-26 20:30:51,797 - {'Epoch': 37, 'HR@5': '0.0943', 'NDCG@5': '0.0681', 'HR@10': '0.1270', 'NDCG@10': '0.0786', 'HR@20': '0.1672', 'NDCG@20': '0.0887'}
2025-02-26 20:30:51,808 - EarlyStopping counter: 4 out of 10
2025-02-26 20:31:16,816 - {'epoch': 38, 'rec_loss': '6.8523'}
2025-02-26 20:31:24,907 - {'Epoch': 38, 'HR@5': '0.0949', 'NDCG@5': '0.0685', 'HR@10': '0.1269', 'NDCG@10': '0.0788', 'HR@20': '0.1670', 'NDCG@20': '0.0889'}
2025-02-26 20:31:24,915 - Validation score increased.  Saving model ...
2025-02-26 20:31:50,158 - {'epoch': 39, 'rec_loss': '6.8470'}
2025-02-26 20:31:58,032 - {'Epoch': 39, 'HR@5': '0.0957', 'NDCG@5': '0.0689', 'HR@10': '0.1280', 'NDCG@10': '0.0793', 'HR@20': '0.1670', 'NDCG@20': '0.0891'}
2025-02-26 20:31:58,041 - Validation score increased.  Saving model ...
2025-02-26 20:32:23,479 - {'epoch': 40, 'rec_loss': '6.8347'}
2025-02-26 20:32:31,716 - {'Epoch': 40, 'HR@5': '0.0956', 'NDCG@5': '0.0691', 'HR@10': '0.1268', 'NDCG@10': '0.0791', 'HR@20': '0.1678', 'NDCG@20': '0.0894'}
2025-02-26 20:32:31,724 - Validation score increased.  Saving model ...
2025-02-26 20:32:56,916 - {'epoch': 41, 'rec_loss': '6.8381'}
2025-02-26 20:33:05,296 - {'Epoch': 41, 'HR@5': '0.0942', 'NDCG@5': '0.0676', 'HR@10': '0.1262', 'NDCG@10': '0.0780', 'HR@20': '0.1679', 'NDCG@20': '0.0886'}
2025-02-26 20:33:05,305 - EarlyStopping counter: 1 out of 10
2025-02-26 20:33:30,258 - {'epoch': 42, 'rec_loss': '6.8276'}
2025-02-26 20:33:38,481 - {'Epoch': 42, 'HR@5': '0.0957', 'NDCG@5': '0.0693', 'HR@10': '0.1277', 'NDCG@10': '0.0795', 'HR@20': '0.1675', 'NDCG@20': '0.0896'}
2025-02-26 20:33:38,482 - Validation score increased.  Saving model ...
2025-02-26 20:34:03,525 - {'epoch': 43, 'rec_loss': '6.8211'}
2025-02-26 20:34:11,808 - {'Epoch': 43, 'HR@5': '0.0941', 'NDCG@5': '0.0679', 'HR@10': '0.1289', 'NDCG@10': '0.0791', 'HR@20': '0.1669', 'NDCG@20': '0.0887'}
2025-02-26 20:34:11,809 - EarlyStopping counter: 1 out of 10
2025-02-26 20:34:36,935 - {'epoch': 44, 'rec_loss': '6.8200'}
2025-02-26 20:34:45,212 - {'Epoch': 44, 'HR@5': '0.0969', 'NDCG@5': '0.0699', 'HR@10': '0.1270', 'NDCG@10': '0.0796', 'HR@20': '0.1680', 'NDCG@20': '0.0900'}
2025-02-26 20:34:45,219 - Validation score increased.  Saving model ...
2025-02-26 20:35:10,110 - {'epoch': 45, 'rec_loss': '6.8102'}
2025-02-26 20:35:18,539 - {'Epoch': 45, 'HR@5': '0.0951', 'NDCG@5': '0.0688', 'HR@10': '0.1285', 'NDCG@10': '0.0795', 'HR@20': '0.1689', 'NDCG@20': '0.0897'}
2025-02-26 20:35:18,548 - EarlyStopping counter: 1 out of 10
2025-02-26 20:35:42,902 - {'epoch': 46, 'rec_loss': '6.8131'}
2025-02-26 20:35:50,949 - {'Epoch': 46, 'HR@5': '0.0956', 'NDCG@5': '0.0690', 'HR@10': '0.1286', 'NDCG@10': '0.0796', 'HR@20': '0.1686', 'NDCG@20': '0.0896'}
2025-02-26 20:35:50,956 - EarlyStopping counter: 2 out of 10
2025-02-26 20:36:15,952 - {'epoch': 47, 'rec_loss': '6.7990'}
2025-02-26 20:36:24,486 - {'Epoch': 47, 'HR@5': '0.0961', 'NDCG@5': '0.0696', 'HR@10': '0.1275', 'NDCG@10': '0.0797', 'HR@20': '0.1676', 'NDCG@20': '0.0897'}
2025-02-26 20:36:24,494 - EarlyStopping counter: 3 out of 10
2025-02-26 20:36:49,235 - {'epoch': 48, 'rec_loss': '6.7847'}
2025-02-26 20:36:57,683 - {'Epoch': 48, 'HR@5': '0.0954', 'NDCG@5': '0.0695', 'HR@10': '0.1280', 'NDCG@10': '0.0800', 'HR@20': '0.1671', 'NDCG@20': '0.0898'}
2025-02-26 20:36:57,694 - EarlyStopping counter: 4 out of 10
2025-02-26 20:37:22,642 - {'epoch': 49, 'rec_loss': '6.7842'}
2025-02-26 20:37:31,003 - {'Epoch': 49, 'HR@5': '0.0946', 'NDCG@5': '0.0685', 'HR@10': '0.1288', 'NDCG@10': '0.0795', 'HR@20': '0.1661', 'NDCG@20': '0.0889'}
2025-02-26 20:37:31,011 - EarlyStopping counter: 5 out of 10
2025-02-26 20:37:55,899 - {'epoch': 50, 'rec_loss': '6.7777'}
2025-02-26 20:38:04,030 - {'Epoch': 50, 'HR@5': '0.0956', 'NDCG@5': '0.0690', 'HR@10': '0.1287', 'NDCG@10': '0.0796', 'HR@20': '0.1664', 'NDCG@20': '0.0891'}
2025-02-26 20:38:04,032 - EarlyStopping counter: 6 out of 10
2025-02-26 20:38:28,833 - {'epoch': 51, 'rec_loss': '6.7832'}
2025-02-26 20:38:36,871 - {'Epoch': 51, 'HR@5': '0.0950', 'NDCG@5': '0.0686', 'HR@10': '0.1281', 'NDCG@10': '0.0792', 'HR@20': '0.1666', 'NDCG@20': '0.0889'}
2025-02-26 20:38:36,879 - EarlyStopping counter: 7 out of 10
2025-02-26 20:39:01,627 - {'epoch': 52, 'rec_loss': '6.7727'}
2025-02-26 20:39:10,237 - {'Epoch': 52, 'HR@5': '0.0934', 'NDCG@5': '0.0673', 'HR@10': '0.1272', 'NDCG@10': '0.0782', 'HR@20': '0.1677', 'NDCG@20': '0.0884'}
2025-02-26 20:39:10,247 - EarlyStopping counter: 8 out of 10
2025-02-26 20:39:35,204 - {'epoch': 53, 'rec_loss': '6.7683'}
2025-02-26 20:39:43,553 - {'Epoch': 53, 'HR@5': '0.0947', 'NDCG@5': '0.0687', 'HR@10': '0.1289', 'NDCG@10': '0.0797', 'HR@20': '0.1673', 'NDCG@20': '0.0894'}
2025-02-26 20:39:43,565 - EarlyStopping counter: 9 out of 10
2025-02-26 20:40:08,844 - {'epoch': 54, 'rec_loss': '6.7569'}
2025-02-26 20:40:17,058 - {'Epoch': 54, 'HR@5': '0.0948', 'NDCG@5': '0.0680', 'HR@10': '0.1291', 'NDCG@10': '0.0790', 'HR@20': '0.1684', 'NDCG@20': '0.0889'}
2025-02-26 20:40:17,071 - EarlyStopping counter: 10 out of 10
2025-02-26 20:40:17,071 - Early stopping
2025-02-26 20:40:17,071 - ---------------Test Score---------------
2025-02-26 20:40:25,235 - {'Epoch': 0, 'HR@5': '0.0802', 'NDCG@5': '0.0567', 'HR@10': '0.1087', 'NDCG@10': '0.0659', 'HR@20': '0.1427', 'NDCG@20': '0.0745'}
2025-02-26 20:40:25,243 - Scale_Toys
2025-02-26 20:40:25,243 - {'Epoch': 0, 'HR@5': '0.0802', 'NDCG@5': '0.0567', 'HR@10': '0.1087', 'NDCG@10': '0.0659', 'HR@20': '0.1427', 'NDCG@20': '0.0745'}
2025-02-26 20:42:56,051 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25, 10], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-02-26 20:42:59,518 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-26 20:42:59,530 - Total Parameters: 917142
2025-02-26 20:43:32,700 - {'epoch': 0, 'rec_loss': '9.0945'}
2025-02-26 20:43:41,425 - {'Epoch': 0, 'HR@5': '0.0070', 'NDCG@5': '0.0040', 'HR@10': '0.0128', 'NDCG@10': '0.0059', 'HR@20': '0.0208', 'NDCG@20': '0.0079'}
2025-02-26 20:43:41,431 - Validation score increased.  Saving model ...
2025-02-26 20:44:14,497 - {'epoch': 1, 'rec_loss': '8.6394'}
2025-02-26 20:44:23,456 - {'Epoch': 1, 'HR@5': '0.0215', 'NDCG@5': '0.0159', 'HR@10': '0.0316', 'NDCG@10': '0.0192', 'HR@20': '0.0486', 'NDCG@20': '0.0234'}
2025-02-26 20:44:23,462 - Validation score increased.  Saving model ...
2025-02-26 20:44:55,568 - {'epoch': 2, 'rec_loss': '8.2809'}
2025-02-26 20:45:04,150 - {'Epoch': 2, 'HR@5': '0.0420', 'NDCG@5': '0.0298', 'HR@10': '0.0608', 'NDCG@10': '0.0358', 'HR@20': '0.0873', 'NDCG@20': '0.0425'}
2025-02-26 20:45:04,155 - Validation score increased.  Saving model ...
2025-02-26 20:45:35,760 - {'epoch': 3, 'rec_loss': '7.9597'}
2025-02-26 20:45:44,615 - {'Epoch': 3, 'HR@5': '0.0591', 'NDCG@5': '0.0426', 'HR@10': '0.0828', 'NDCG@10': '0.0502', 'HR@20': '0.1125', 'NDCG@20': '0.0577'}
2025-02-26 20:45:44,622 - Validation score increased.  Saving model ...
2025-02-26 20:46:16,030 - {'epoch': 4, 'rec_loss': '7.7375'}
2025-02-26 20:46:24,923 - {'Epoch': 4, 'HR@5': '0.0696', 'NDCG@5': '0.0503', 'HR@10': '0.0948', 'NDCG@10': '0.0585', 'HR@20': '0.1278', 'NDCG@20': '0.0667'}
2025-02-26 20:46:24,933 - Validation score increased.  Saving model ...
2025-02-26 20:46:56,586 - {'epoch': 5, 'rec_loss': '7.5687'}
2025-02-26 20:47:05,151 - {'Epoch': 5, 'HR@5': '0.0746', 'NDCG@5': '0.0541', 'HR@10': '0.1041', 'NDCG@10': '0.0636', 'HR@20': '0.1386', 'NDCG@20': '0.0723'}
2025-02-26 20:47:05,162 - Validation score increased.  Saving model ...
2025-02-26 20:47:36,680 - {'epoch': 6, 'rec_loss': '7.4511'}
2025-02-26 20:47:45,461 - {'Epoch': 6, 'HR@5': '0.0804', 'NDCG@5': '0.0591', 'HR@10': '0.1086', 'NDCG@10': '0.0681', 'HR@20': '0.1442', 'NDCG@20': '0.0771'}
2025-02-26 20:47:45,468 - Validation score increased.  Saving model ...
2025-02-26 20:48:16,830 - {'epoch': 7, 'rec_loss': '7.3611'}
2025-02-26 20:48:25,719 - {'Epoch': 7, 'HR@5': '0.0820', 'NDCG@5': '0.0600', 'HR@10': '0.1101', 'NDCG@10': '0.0691', 'HR@20': '0.1476', 'NDCG@20': '0.0786'}
2025-02-26 20:48:25,728 - Validation score increased.  Saving model ...
2025-02-26 20:48:57,104 - {'epoch': 8, 'rec_loss': '7.2891'}
2025-02-26 20:49:05,844 - {'Epoch': 8, 'HR@5': '0.0839', 'NDCG@5': '0.0613', 'HR@10': '0.1146', 'NDCG@10': '0.0712', 'HR@20': '0.1504', 'NDCG@20': '0.0802'}
2025-02-26 20:49:05,851 - Validation score increased.  Saving model ...
2025-02-26 20:49:36,973 - {'epoch': 9, 'rec_loss': '7.2246'}
2025-02-26 20:49:45,918 - {'Epoch': 9, 'HR@5': '0.0848', 'NDCG@5': '0.0616', 'HR@10': '0.1175', 'NDCG@10': '0.0721', 'HR@20': '0.1532', 'NDCG@20': '0.0811'}
2025-02-26 20:49:45,924 - Validation score increased.  Saving model ...
2025-02-26 20:50:17,475 - {'epoch': 10, 'rec_loss': '7.1751'}
2025-02-26 20:50:26,189 - {'Epoch': 10, 'HR@5': '0.0880', 'NDCG@5': '0.0634', 'HR@10': '0.1194', 'NDCG@10': '0.0735', 'HR@20': '0.1566', 'NDCG@20': '0.0828'}
2025-02-26 20:50:26,197 - Validation score increased.  Saving model ...
2025-02-26 20:50:57,269 - {'epoch': 11, 'rec_loss': '7.1333'}
2025-02-26 20:51:06,157 - {'Epoch': 11, 'HR@5': '0.0880', 'NDCG@5': '0.0638', 'HR@10': '0.1199', 'NDCG@10': '0.0740', 'HR@20': '0.1596', 'NDCG@20': '0.0840'}
2025-02-26 20:51:06,164 - Validation score increased.  Saving model ...
2025-02-26 20:51:38,410 - {'epoch': 12, 'rec_loss': '7.0982'}
2025-02-26 20:51:47,323 - {'Epoch': 12, 'HR@5': '0.0884', 'NDCG@5': '0.0640', 'HR@10': '0.1193', 'NDCG@10': '0.0739', 'HR@20': '0.1569', 'NDCG@20': '0.0834'}
2025-02-26 20:51:47,332 - EarlyStopping counter: 1 out of 10
2025-02-26 20:52:19,548 - {'epoch': 13, 'rec_loss': '7.0699'}
2025-02-26 20:52:28,360 - {'Epoch': 13, 'HR@5': '0.0891', 'NDCG@5': '0.0647', 'HR@10': '0.1209', 'NDCG@10': '0.0749', 'HR@20': '0.1591', 'NDCG@20': '0.0845'}
2025-02-26 20:52:28,368 - Validation score increased.  Saving model ...
2025-02-26 20:53:00,118 - {'epoch': 14, 'rec_loss': '7.0439'}
2025-02-26 20:53:09,221 - {'Epoch': 14, 'HR@5': '0.0895', 'NDCG@5': '0.0645', 'HR@10': '0.1222', 'NDCG@10': '0.0751', 'HR@20': '0.1602', 'NDCG@20': '0.0846'}
2025-02-26 20:53:09,229 - Validation score increased.  Saving model ...
2025-02-26 20:53:41,167 - {'epoch': 15, 'rec_loss': '7.0133'}
2025-02-26 20:53:50,431 - {'Epoch': 15, 'HR@5': '0.0920', 'NDCG@5': '0.0662', 'HR@10': '0.1230', 'NDCG@10': '0.0762', 'HR@20': '0.1621', 'NDCG@20': '0.0861'}
2025-02-26 20:53:50,441 - Validation score increased.  Saving model ...
2025-02-26 20:54:24,050 - {'epoch': 16, 'rec_loss': '6.9862'}
2025-02-26 20:54:33,045 - {'Epoch': 16, 'HR@5': '0.0926', 'NDCG@5': '0.0672', 'HR@10': '0.1235', 'NDCG@10': '0.0771', 'HR@20': '0.1621', 'NDCG@20': '0.0869'}
2025-02-26 20:54:33,053 - Validation score increased.  Saving model ...
2025-02-26 20:55:06,036 - {'epoch': 17, 'rec_loss': '6.9687'}
2025-02-26 20:55:14,839 - {'Epoch': 17, 'HR@5': '0.0916', 'NDCG@5': '0.0661', 'HR@10': '0.1232', 'NDCG@10': '0.0763', 'HR@20': '0.1622', 'NDCG@20': '0.0861'}
2025-02-26 20:55:14,850 - EarlyStopping counter: 1 out of 10
2025-02-26 20:55:48,646 - {'epoch': 18, 'rec_loss': '6.9520'}
2025-02-26 20:55:57,387 - {'Epoch': 18, 'HR@5': '0.0916', 'NDCG@5': '0.0668', 'HR@10': '0.1227', 'NDCG@10': '0.0768', 'HR@20': '0.1634', 'NDCG@20': '0.0870'}
2025-02-26 20:55:57,394 - Validation score increased.  Saving model ...
2025-02-26 20:56:31,197 - {'epoch': 19, 'rec_loss': '6.9247'}
2025-02-26 20:56:40,222 - {'Epoch': 19, 'HR@5': '0.0928', 'NDCG@5': '0.0668', 'HR@10': '0.1234', 'NDCG@10': '0.0766', 'HR@20': '0.1619', 'NDCG@20': '0.0862'}
2025-02-26 20:56:40,228 - EarlyStopping counter: 1 out of 10
2025-02-26 20:57:14,285 - {'epoch': 20, 'rec_loss': '6.9158'}
2025-02-26 20:57:23,069 - {'Epoch': 20, 'HR@5': '0.0924', 'NDCG@5': '0.0668', 'HR@10': '0.1233', 'NDCG@10': '0.0767', 'HR@20': '0.1600', 'NDCG@20': '0.0860'}
2025-02-26 20:57:23,077 - EarlyStopping counter: 2 out of 10
2025-02-26 20:57:56,394 - {'epoch': 21, 'rec_loss': '6.9020'}
2025-02-26 20:58:05,014 - {'Epoch': 21, 'HR@5': '0.0932', 'NDCG@5': '0.0671', 'HR@10': '0.1239', 'NDCG@10': '0.0770', 'HR@20': '0.1635', 'NDCG@20': '0.0870'}
2025-02-26 20:58:05,020 - EarlyStopping counter: 3 out of 10
2025-02-26 20:58:38,829 - {'epoch': 22, 'rec_loss': '6.8836'}
2025-02-26 20:58:47,433 - {'Epoch': 22, 'HR@5': '0.0929', 'NDCG@5': '0.0671', 'HR@10': '0.1240', 'NDCG@10': '0.0770', 'HR@20': '0.1632', 'NDCG@20': '0.0869'}
2025-02-26 20:58:47,444 - EarlyStopping counter: 4 out of 10
2025-02-26 20:59:20,963 - {'epoch': 23, 'rec_loss': '6.8648'}
2025-02-26 20:59:29,614 - {'Epoch': 23, 'HR@5': '0.0930', 'NDCG@5': '0.0678', 'HR@10': '0.1252', 'NDCG@10': '0.0782', 'HR@20': '0.1645', 'NDCG@20': '0.0880'}
2025-02-26 20:59:29,620 - Validation score increased.  Saving model ...
2025-02-26 21:00:02,978 - {'epoch': 24, 'rec_loss': '6.8553'}
2025-02-26 21:00:12,231 - {'Epoch': 24, 'HR@5': '0.0923', 'NDCG@5': '0.0661', 'HR@10': '0.1255', 'NDCG@10': '0.0768', 'HR@20': '0.1647', 'NDCG@20': '0.0867'}
2025-02-26 21:00:12,239 - EarlyStopping counter: 1 out of 10
2025-02-26 21:00:45,979 - {'epoch': 25, 'rec_loss': '6.8386'}
2025-02-26 21:00:54,620 - {'Epoch': 25, 'HR@5': '0.0933', 'NDCG@5': '0.0673', 'HR@10': '0.1252', 'NDCG@10': '0.0776', 'HR@20': '0.1651', 'NDCG@20': '0.0876'}
2025-02-26 21:00:54,626 - EarlyStopping counter: 2 out of 10
2025-02-26 21:01:28,469 - {'epoch': 26, 'rec_loss': '6.8322'}
2025-02-26 21:01:37,536 - {'Epoch': 26, 'HR@5': '0.0937', 'NDCG@5': '0.0679', 'HR@10': '0.1246', 'NDCG@10': '0.0779', 'HR@20': '0.1643', 'NDCG@20': '0.0880'}
2025-02-26 21:01:37,543 - EarlyStopping counter: 3 out of 10
2025-02-26 21:02:09,401 - {'epoch': 27, 'rec_loss': '6.8152'}
2025-02-26 21:02:17,047 - {'Epoch': 27, 'HR@5': '0.0940', 'NDCG@5': '0.0682', 'HR@10': '0.1261', 'NDCG@10': '0.0785', 'HR@20': '0.1653', 'NDCG@20': '0.0884'}
2025-02-26 21:02:17,054 - Validation score increased.  Saving model ...
2025-02-26 21:02:47,768 - {'epoch': 28, 'rec_loss': '6.8117'}
2025-02-26 21:02:55,284 - {'Epoch': 28, 'HR@5': '0.0946', 'NDCG@5': '0.0683', 'HR@10': '0.1260', 'NDCG@10': '0.0784', 'HR@20': '0.1639', 'NDCG@20': '0.0880'}
2025-02-26 21:02:55,290 - EarlyStopping counter: 1 out of 10
2025-02-26 21:03:26,466 - {'epoch': 29, 'rec_loss': '6.8038'}
2025-02-26 21:03:34,324 - {'Epoch': 29, 'HR@5': '0.0934', 'NDCG@5': '0.0679', 'HR@10': '0.1267', 'NDCG@10': '0.0787', 'HR@20': '0.1639', 'NDCG@20': '0.0880'}
2025-02-26 21:03:34,332 - EarlyStopping counter: 2 out of 10
2025-02-26 21:04:04,104 - {'epoch': 30, 'rec_loss': '6.7901'}
2025-02-26 21:04:11,443 - {'Epoch': 30, 'HR@5': '0.0944', 'NDCG@5': '0.0682', 'HR@10': '0.1269', 'NDCG@10': '0.0788', 'HR@20': '0.1649', 'NDCG@20': '0.0884'}
2025-02-26 21:04:11,449 - EarlyStopping counter: 3 out of 10
2025-02-26 21:04:41,568 - {'epoch': 31, 'rec_loss': '6.7729'}
2025-02-26 21:04:50,076 - {'Epoch': 31, 'HR@5': '0.0940', 'NDCG@5': '0.0682', 'HR@10': '0.1257', 'NDCG@10': '0.0784', 'HR@20': '0.1662', 'NDCG@20': '0.0886'}
2025-02-26 21:04:50,082 - Validation score increased.  Saving model ...
2025-02-26 21:05:19,666 - {'epoch': 32, 'rec_loss': '6.7597'}
2025-02-26 21:05:27,407 - {'Epoch': 32, 'HR@5': '0.0930', 'NDCG@5': '0.0674', 'HR@10': '0.1252', 'NDCG@10': '0.0778', 'HR@20': '0.1653', 'NDCG@20': '0.0879'}
2025-02-26 21:05:27,412 - EarlyStopping counter: 1 out of 10
2025-02-26 21:05:58,159 - {'epoch': 33, 'rec_loss': '6.7548'}
2025-02-26 21:06:05,370 - {'Epoch': 33, 'HR@5': '0.0940', 'NDCG@5': '0.0685', 'HR@10': '0.1260', 'NDCG@10': '0.0788', 'HR@20': '0.1656', 'NDCG@20': '0.0888'}
2025-02-26 21:06:05,378 - Validation score increased.  Saving model ...
2025-02-26 21:06:35,711 - {'epoch': 34, 'rec_loss': '6.7459'}
2025-02-26 21:06:42,851 - {'Epoch': 34, 'HR@5': '0.0925', 'NDCG@5': '0.0674', 'HR@10': '0.1244', 'NDCG@10': '0.0777', 'HR@20': '0.1654', 'NDCG@20': '0.0880'}
2025-02-26 21:06:42,857 - EarlyStopping counter: 1 out of 10
2025-02-26 21:07:12,299 - {'epoch': 35, 'rec_loss': '6.7384'}
2025-02-26 21:07:19,842 - {'Epoch': 35, 'HR@5': '0.0935', 'NDCG@5': '0.0678', 'HR@10': '0.1265', 'NDCG@10': '0.0785', 'HR@20': '0.1639', 'NDCG@20': '0.0879'}
2025-02-26 21:07:19,848 - EarlyStopping counter: 2 out of 10
2025-02-26 21:07:50,775 - {'epoch': 36, 'rec_loss': '6.7337'}
2025-02-26 21:07:58,768 - {'Epoch': 36, 'HR@5': '0.0941', 'NDCG@5': '0.0682', 'HR@10': '0.1254', 'NDCG@10': '0.0782', 'HR@20': '0.1654', 'NDCG@20': '0.0883'}
2025-02-26 21:07:58,774 - EarlyStopping counter: 3 out of 10
2025-02-26 21:08:30,030 - {'epoch': 37, 'rec_loss': '6.7208'}
2025-02-26 21:08:37,534 - {'Epoch': 37, 'HR@5': '0.0938', 'NDCG@5': '0.0677', 'HR@10': '0.1244', 'NDCG@10': '0.0776', 'HR@20': '0.1658', 'NDCG@20': '0.0881'}
2025-02-26 21:08:37,541 - EarlyStopping counter: 4 out of 10
2025-02-26 21:09:06,781 - {'epoch': 38, 'rec_loss': '6.7225'}
2025-02-26 21:09:14,876 - {'Epoch': 38, 'HR@5': '0.0936', 'NDCG@5': '0.0684', 'HR@10': '0.1255', 'NDCG@10': '0.0786', 'HR@20': '0.1657', 'NDCG@20': '0.0887'}
2025-02-26 21:09:14,882 - EarlyStopping counter: 5 out of 10
2025-02-26 21:09:44,184 - {'epoch': 39, 'rec_loss': '6.7051'}
2025-02-26 21:09:51,859 - {'Epoch': 39, 'HR@5': '0.0951', 'NDCG@5': '0.0684', 'HR@10': '0.1255', 'NDCG@10': '0.0782', 'HR@20': '0.1648', 'NDCG@20': '0.0881'}
2025-02-26 21:09:51,866 - EarlyStopping counter: 6 out of 10
2025-02-26 21:10:21,109 - {'epoch': 40, 'rec_loss': '6.7045'}
2025-02-26 21:10:28,368 - {'Epoch': 40, 'HR@5': '0.0936', 'NDCG@5': '0.0677', 'HR@10': '0.1254', 'NDCG@10': '0.0779', 'HR@20': '0.1634', 'NDCG@20': '0.0874'}
2025-02-26 21:10:28,374 - EarlyStopping counter: 7 out of 10
2025-02-26 21:10:58,428 - {'epoch': 41, 'rec_loss': '6.6888'}
2025-02-26 21:11:05,792 - {'Epoch': 41, 'HR@5': '0.0925', 'NDCG@5': '0.0669', 'HR@10': '0.1257', 'NDCG@10': '0.0776', 'HR@20': '0.1655', 'NDCG@20': '0.0876'}
2025-02-26 21:11:05,798 - EarlyStopping counter: 8 out of 10
2025-02-26 21:11:36,558 - {'epoch': 42, 'rec_loss': '6.6840'}
2025-02-26 21:11:43,852 - {'Epoch': 42, 'HR@5': '0.0924', 'NDCG@5': '0.0675', 'HR@10': '0.1256', 'NDCG@10': '0.0783', 'HR@20': '0.1659', 'NDCG@20': '0.0884'}
2025-02-26 21:11:43,859 - EarlyStopping counter: 9 out of 10
2025-02-26 21:12:16,721 - {'epoch': 43, 'rec_loss': '6.6788'}
2025-02-26 21:12:24,137 - {'Epoch': 43, 'HR@5': '0.0917', 'NDCG@5': '0.0663', 'HR@10': '0.1247', 'NDCG@10': '0.0770', 'HR@20': '0.1647', 'NDCG@20': '0.0870'}
2025-02-26 21:12:24,143 - EarlyStopping counter: 10 out of 10
2025-02-26 21:12:24,144 - Early stopping
2025-02-26 21:12:24,144 - ---------------Test Score---------------
2025-02-26 21:12:31,387 - {'Epoch': 0, 'HR@5': '0.0774', 'NDCG@5': '0.0558', 'HR@10': '0.1039', 'NDCG@10': '0.0643', 'HR@20': '0.1404', 'NDCG@20': '0.0735'}
2025-02-26 21:12:31,393 - Scale_Toys
2025-02-26 21:12:31,394 - {'Epoch': 0, 'HR@5': '0.0774', 'NDCG@5': '0.0558', 'HR@10': '0.1039', 'NDCG@10': '0.0643', 'HR@20': '0.1404', 'NDCG@20': '0.0735'}
2025-02-26 21:18:18,567 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 12], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-02-26 21:18:21,633 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-26 21:18:21,644 - Total Parameters: 918117
2025-02-26 21:18:45,485 - {'epoch': 0, 'rec_loss': '9.0988'}
2025-02-26 21:18:52,751 - {'Epoch': 0, 'HR@5': '0.0070', 'NDCG@5': '0.0045', 'HR@10': '0.0109', 'NDCG@10': '0.0058', 'HR@20': '0.0192', 'NDCG@20': '0.0079'}
2025-02-26 21:18:52,755 - Validation score increased.  Saving model ...
2025-02-26 21:19:15,315 - {'epoch': 1, 'rec_loss': '8.7441'}
2025-02-26 21:19:22,317 - {'Epoch': 1, 'HR@5': '0.0158', 'NDCG@5': '0.0107', 'HR@10': '0.0231', 'NDCG@10': '0.0131', 'HR@20': '0.0368', 'NDCG@20': '0.0165'}
2025-02-26 21:19:22,323 - Validation score increased.  Saving model ...
2025-02-26 21:19:44,932 - {'epoch': 2, 'rec_loss': '8.4592'}
2025-02-26 21:19:52,327 - {'Epoch': 2, 'HR@5': '0.0299', 'NDCG@5': '0.0214', 'HR@10': '0.0431', 'NDCG@10': '0.0256', 'HR@20': '0.0659', 'NDCG@20': '0.0313'}
2025-02-26 21:19:52,334 - Validation score increased.  Saving model ...
2025-02-26 21:20:15,778 - {'epoch': 3, 'rec_loss': '8.2072'}
2025-02-26 21:20:22,417 - {'Epoch': 3, 'HR@5': '0.0453', 'NDCG@5': '0.0319', 'HR@10': '0.0625', 'NDCG@10': '0.0375', 'HR@20': '0.0906', 'NDCG@20': '0.0445'}
2025-02-26 21:20:22,424 - Validation score increased.  Saving model ...
2025-02-26 21:20:44,931 - {'epoch': 4, 'rec_loss': '7.9843'}
2025-02-26 21:20:51,572 - {'Epoch': 4, 'HR@5': '0.0579', 'NDCG@5': '0.0411', 'HR@10': '0.0795', 'NDCG@10': '0.0481', 'HR@20': '0.1114', 'NDCG@20': '0.0560'}
2025-02-26 21:20:51,579 - Validation score increased.  Saving model ...
2025-02-26 21:21:14,454 - {'epoch': 5, 'rec_loss': '7.8174'}
2025-02-26 21:21:21,150 - {'Epoch': 5, 'HR@5': '0.0664', 'NDCG@5': '0.0470', 'HR@10': '0.0919', 'NDCG@10': '0.0552', 'HR@20': '0.1245', 'NDCG@20': '0.0634'}
2025-02-26 21:21:21,156 - Validation score increased.  Saving model ...
2025-02-26 21:21:45,319 - {'epoch': 6, 'rec_loss': '7.6881'}
2025-02-26 21:21:51,943 - {'Epoch': 6, 'HR@5': '0.0723', 'NDCG@5': '0.0512', 'HR@10': '0.0990', 'NDCG@10': '0.0598', 'HR@20': '0.1339', 'NDCG@20': '0.0685'}
2025-02-26 21:21:51,949 - Validation score increased.  Saving model ...
2025-02-26 21:22:14,951 - {'epoch': 7, 'rec_loss': '7.5856'}
2025-02-26 21:22:21,672 - {'Epoch': 7, 'HR@5': '0.0753', 'NDCG@5': '0.0543', 'HR@10': '0.1046', 'NDCG@10': '0.0638', 'HR@20': '0.1398', 'NDCG@20': '0.0726'}
2025-02-26 21:22:21,679 - Validation score increased.  Saving model ...
2025-02-26 21:22:44,861 - {'epoch': 8, 'rec_loss': '7.5036'}
2025-02-26 21:22:51,501 - {'Epoch': 8, 'HR@5': '0.0791', 'NDCG@5': '0.0569', 'HR@10': '0.1073', 'NDCG@10': '0.0660', 'HR@20': '0.1440', 'NDCG@20': '0.0752'}
2025-02-26 21:22:51,508 - Validation score increased.  Saving model ...
2025-02-26 21:23:14,833 - {'epoch': 9, 'rec_loss': '7.4366'}
2025-02-26 21:23:21,510 - {'Epoch': 9, 'HR@5': '0.0822', 'NDCG@5': '0.0591', 'HR@10': '0.1103', 'NDCG@10': '0.0683', 'HR@20': '0.1475', 'NDCG@20': '0.0776'}
2025-02-26 21:23:21,516 - Validation score increased.  Saving model ...
2025-02-26 21:23:45,669 - {'epoch': 10, 'rec_loss': '7.3900'}
2025-02-26 21:23:52,306 - {'Epoch': 10, 'HR@5': '0.0844', 'NDCG@5': '0.0604', 'HR@10': '0.1135', 'NDCG@10': '0.0699', 'HR@20': '0.1507', 'NDCG@20': '0.0792'}
2025-02-26 21:23:52,312 - Validation score increased.  Saving model ...
2025-02-26 21:24:16,251 - {'epoch': 11, 'rec_loss': '7.3380'}
2025-02-26 21:24:22,881 - {'Epoch': 11, 'HR@5': '0.0850', 'NDCG@5': '0.0615', 'HR@10': '0.1150', 'NDCG@10': '0.0711', 'HR@20': '0.1539', 'NDCG@20': '0.0809'}
2025-02-26 21:24:22,887 - Validation score increased.  Saving model ...
2025-02-26 21:24:45,860 - {'epoch': 12, 'rec_loss': '7.2949'}
2025-02-26 21:24:52,660 - {'Epoch': 12, 'HR@5': '0.0868', 'NDCG@5': '0.0627', 'HR@10': '0.1161', 'NDCG@10': '0.0721', 'HR@20': '0.1555', 'NDCG@20': '0.0820'}
2025-02-26 21:24:52,667 - Validation score increased.  Saving model ...
2025-02-26 21:25:15,410 - {'epoch': 13, 'rec_loss': '7.2628'}
2025-02-26 21:25:22,088 - {'Epoch': 13, 'HR@5': '0.0863', 'NDCG@5': '0.0623', 'HR@10': '0.1183', 'NDCG@10': '0.0726', 'HR@20': '0.1547', 'NDCG@20': '0.0819'}
2025-02-26 21:25:22,096 - EarlyStopping counter: 1 out of 10
2025-02-26 21:25:45,330 - {'epoch': 14, 'rec_loss': '7.2333'}
2025-02-26 21:25:52,238 - {'Epoch': 14, 'HR@5': '0.0868', 'NDCG@5': '0.0637', 'HR@10': '0.1188', 'NDCG@10': '0.0740', 'HR@20': '0.1574', 'NDCG@20': '0.0837'}
2025-02-26 21:25:52,245 - Validation score increased.  Saving model ...
2025-02-26 21:26:15,363 - {'epoch': 15, 'rec_loss': '7.2087'}
2025-02-26 21:26:22,493 - {'Epoch': 15, 'HR@5': '0.0865', 'NDCG@5': '0.0630', 'HR@10': '0.1190', 'NDCG@10': '0.0735', 'HR@20': '0.1587', 'NDCG@20': '0.0835'}
2025-02-26 21:26:22,500 - EarlyStopping counter: 1 out of 10
2025-02-26 21:26:45,346 - {'epoch': 16, 'rec_loss': '7.1766'}
2025-02-26 21:26:52,204 - {'Epoch': 16, 'HR@5': '0.0881', 'NDCG@5': '0.0641', 'HR@10': '0.1205', 'NDCG@10': '0.0745', 'HR@20': '0.1595', 'NDCG@20': '0.0844'}
2025-02-26 21:26:52,211 - Validation score increased.  Saving model ...
2025-02-26 21:27:14,764 - {'epoch': 17, 'rec_loss': '7.1527'}
2025-02-26 21:27:21,591 - {'Epoch': 17, 'HR@5': '0.0883', 'NDCG@5': '0.0642', 'HR@10': '0.1197', 'NDCG@10': '0.0743', 'HR@20': '0.1594', 'NDCG@20': '0.0844'}
2025-02-26 21:27:21,598 - EarlyStopping counter: 1 out of 10
2025-02-26 21:27:46,743 - {'epoch': 18, 'rec_loss': '7.1409'}
2025-02-26 21:27:53,349 - {'Epoch': 18, 'HR@5': '0.0917', 'NDCG@5': '0.0657', 'HR@10': '0.1225', 'NDCG@10': '0.0756', 'HR@20': '0.1603', 'NDCG@20': '0.0851'}
2025-02-26 21:27:53,355 - Validation score increased.  Saving model ...
2025-02-26 21:28:17,992 - {'epoch': 19, 'rec_loss': '7.1207'}
2025-02-26 21:28:24,514 - {'Epoch': 19, 'HR@5': '0.0905', 'NDCG@5': '0.0654', 'HR@10': '0.1217', 'NDCG@10': '0.0755', 'HR@20': '0.1596', 'NDCG@20': '0.0851'}
2025-02-26 21:28:24,520 - EarlyStopping counter: 1 out of 10
2025-02-26 21:28:47,523 - {'epoch': 20, 'rec_loss': '7.1039'}
2025-02-26 21:28:54,307 - {'Epoch': 20, 'HR@5': '0.0896', 'NDCG@5': '0.0654', 'HR@10': '0.1211', 'NDCG@10': '0.0756', 'HR@20': '0.1617', 'NDCG@20': '0.0858'}
2025-02-26 21:28:54,314 - Validation score increased.  Saving model ...
2025-02-26 21:29:17,835 - {'epoch': 21, 'rec_loss': '7.0866'}
2025-02-26 21:29:25,027 - {'Epoch': 21, 'HR@5': '0.0917', 'NDCG@5': '0.0664', 'HR@10': '0.1237', 'NDCG@10': '0.0767', 'HR@20': '0.1627', 'NDCG@20': '0.0865'}
2025-02-26 21:29:25,035 - Validation score increased.  Saving model ...
2025-02-26 21:29:48,471 - {'epoch': 22, 'rec_loss': '7.0716'}
2025-02-26 21:29:55,763 - {'Epoch': 22, 'HR@5': '0.0903', 'NDCG@5': '0.0655', 'HR@10': '0.1236', 'NDCG@10': '0.0763', 'HR@20': '0.1631', 'NDCG@20': '0.0862'}
2025-02-26 21:29:55,769 - EarlyStopping counter: 1 out of 10
2025-02-26 21:30:20,016 - {'epoch': 23, 'rec_loss': '7.0638'}
2025-02-26 21:30:27,494 - {'Epoch': 23, 'HR@5': '0.0914', 'NDCG@5': '0.0664', 'HR@10': '0.1232', 'NDCG@10': '0.0766', 'HR@20': '0.1638', 'NDCG@20': '0.0869'}
2025-02-26 21:30:27,500 - Validation score increased.  Saving model ...
2025-02-26 21:30:50,878 - {'epoch': 24, 'rec_loss': '7.0395'}
2025-02-26 21:30:58,705 - {'Epoch': 24, 'HR@5': '0.0913', 'NDCG@5': '0.0657', 'HR@10': '0.1260', 'NDCG@10': '0.0770', 'HR@20': '0.1647', 'NDCG@20': '0.0867'}
2025-02-26 21:30:58,712 - EarlyStopping counter: 1 out of 10
2025-02-26 21:31:22,407 - {'epoch': 25, 'rec_loss': '7.0274'}
2025-02-26 21:31:29,915 - {'Epoch': 25, 'HR@5': '0.0891', 'NDCG@5': '0.0651', 'HR@10': '0.1244', 'NDCG@10': '0.0765', 'HR@20': '0.1646', 'NDCG@20': '0.0867'}
2025-02-26 21:31:29,921 - EarlyStopping counter: 2 out of 10
2025-02-26 21:31:53,641 - {'epoch': 26, 'rec_loss': '7.0240'}
2025-02-26 21:32:01,065 - {'Epoch': 26, 'HR@5': '0.0915', 'NDCG@5': '0.0656', 'HR@10': '0.1239', 'NDCG@10': '0.0760', 'HR@20': '0.1659', 'NDCG@20': '0.0866'}
2025-02-26 21:32:01,071 - EarlyStopping counter: 3 out of 10
2025-02-26 21:32:25,243 - {'epoch': 27, 'rec_loss': '7.0028'}
2025-02-26 21:32:33,324 - {'Epoch': 27, 'HR@5': '0.0917', 'NDCG@5': '0.0664', 'HR@10': '0.1256', 'NDCG@10': '0.0773', 'HR@20': '0.1651', 'NDCG@20': '0.0873'}
2025-02-26 21:32:33,329 - Validation score increased.  Saving model ...
2025-02-26 21:32:56,504 - {'epoch': 28, 'rec_loss': '7.0078'}
2025-02-26 21:33:03,702 - {'Epoch': 28, 'HR@5': '0.0917', 'NDCG@5': '0.0663', 'HR@10': '0.1266', 'NDCG@10': '0.0775', 'HR@20': '0.1657', 'NDCG@20': '0.0874'}
2025-02-26 21:33:03,708 - Validation score increased.  Saving model ...
2025-02-26 21:33:27,640 - {'epoch': 29, 'rec_loss': '6.9889'}
2025-02-26 21:33:35,495 - {'Epoch': 29, 'HR@5': '0.0924', 'NDCG@5': '0.0664', 'HR@10': '0.1250', 'NDCG@10': '0.0769', 'HR@20': '0.1664', 'NDCG@20': '0.0873'}
2025-02-26 21:33:35,503 - EarlyStopping counter: 1 out of 10
2025-02-26 21:33:59,348 - {'epoch': 30, 'rec_loss': '6.9843'}
2025-02-26 21:34:06,113 - {'Epoch': 30, 'HR@5': '0.0922', 'NDCG@5': '0.0668', 'HR@10': '0.1250', 'NDCG@10': '0.0773', 'HR@20': '0.1659', 'NDCG@20': '0.0876'}
2025-02-26 21:34:06,120 - Validation score increased.  Saving model ...
2025-02-26 21:34:29,918 - {'epoch': 31, 'rec_loss': '6.9713'}
2025-02-26 21:34:37,079 - {'Epoch': 31, 'HR@5': '0.0928', 'NDCG@5': '0.0669', 'HR@10': '0.1247', 'NDCG@10': '0.0772', 'HR@20': '0.1663', 'NDCG@20': '0.0877'}
2025-02-26 21:34:37,085 - Validation score increased.  Saving model ...
2025-02-26 21:35:00,109 - {'epoch': 32, 'rec_loss': '6.9659'}
2025-02-26 21:35:07,510 - {'Epoch': 32, 'HR@5': '0.0919', 'NDCG@5': '0.0665', 'HR@10': '0.1253', 'NDCG@10': '0.0773', 'HR@20': '0.1676', 'NDCG@20': '0.0879'}
2025-02-26 21:35:07,517 - Validation score increased.  Saving model ...
2025-02-26 21:35:35,269 - {'epoch': 33, 'rec_loss': '6.9520'}
2025-02-26 21:35:43,252 - {'Epoch': 33, 'HR@5': '0.0933', 'NDCG@5': '0.0670', 'HR@10': '0.1261', 'NDCG@10': '0.0776', 'HR@20': '0.1658', 'NDCG@20': '0.0876'}
2025-02-26 21:35:43,258 - EarlyStopping counter: 1 out of 10
2025-02-26 21:36:10,122 - {'epoch': 34, 'rec_loss': '6.9428'}
2025-02-26 21:36:17,744 - {'Epoch': 34, 'HR@5': '0.0933', 'NDCG@5': '0.0670', 'HR@10': '0.1255', 'NDCG@10': '0.0774', 'HR@20': '0.1674', 'NDCG@20': '0.0878'}
2025-02-26 21:36:17,750 - EarlyStopping counter: 2 out of 10
2025-02-26 21:36:43,479 - {'epoch': 35, 'rec_loss': '6.9340'}
2025-02-26 21:36:51,579 - {'Epoch': 35, 'HR@5': '0.0934', 'NDCG@5': '0.0674', 'HR@10': '0.1272', 'NDCG@10': '0.0783', 'HR@20': '0.1665', 'NDCG@20': '0.0882'}
2025-02-26 21:36:51,586 - Validation score increased.  Saving model ...
2025-02-26 21:37:26,734 - {'epoch': 36, 'rec_loss': '6.9330'}
2025-02-26 21:37:34,112 - {'Epoch': 36, 'HR@5': '0.0940', 'NDCG@5': '0.0671', 'HR@10': '0.1265', 'NDCG@10': '0.0775', 'HR@20': '0.1671', 'NDCG@20': '0.0878'}
2025-02-26 21:37:34,117 - EarlyStopping counter: 1 out of 10
2025-02-26 21:37:59,829 - {'epoch': 37, 'rec_loss': '6.9182'}
2025-02-26 21:38:07,455 - {'Epoch': 37, 'HR@5': '0.0926', 'NDCG@5': '0.0664', 'HR@10': '0.1264', 'NDCG@10': '0.0772', 'HR@20': '0.1685', 'NDCG@20': '0.0879'}
2025-02-26 21:38:07,462 - EarlyStopping counter: 2 out of 10
2025-02-26 21:38:32,460 - {'epoch': 38, 'rec_loss': '6.9130'}
2025-02-26 21:38:39,576 - {'Epoch': 38, 'HR@5': '0.0936', 'NDCG@5': '0.0665', 'HR@10': '0.1285', 'NDCG@10': '0.0778', 'HR@20': '0.1671', 'NDCG@20': '0.0875'}
2025-02-26 21:38:39,581 - EarlyStopping counter: 3 out of 10
2025-02-26 21:39:05,519 - {'epoch': 39, 'rec_loss': '6.9089'}
2025-02-26 21:39:13,332 - {'Epoch': 39, 'HR@5': '0.0940', 'NDCG@5': '0.0677', 'HR@10': '0.1278', 'NDCG@10': '0.0786', 'HR@20': '0.1685', 'NDCG@20': '0.0889'}
2025-02-26 21:39:13,341 - Validation score increased.  Saving model ...
2025-02-26 21:39:41,488 - {'epoch': 40, 'rec_loss': '6.8982'}
2025-02-26 21:39:49,129 - {'Epoch': 40, 'HR@5': '0.0948', 'NDCG@5': '0.0678', 'HR@10': '0.1276', 'NDCG@10': '0.0783', 'HR@20': '0.1691', 'NDCG@20': '0.0888'}
2025-02-26 21:39:49,135 - EarlyStopping counter: 1 out of 10
2025-02-26 21:40:15,932 - {'epoch': 41, 'rec_loss': '6.8984'}
2025-02-26 21:40:23,379 - {'Epoch': 41, 'HR@5': '0.0938', 'NDCG@5': '0.0671', 'HR@10': '0.1281', 'NDCG@10': '0.0782', 'HR@20': '0.1682', 'NDCG@20': '0.0882'}
2025-02-26 21:40:23,385 - EarlyStopping counter: 2 out of 10
2025-02-26 21:40:48,268 - {'epoch': 42, 'rec_loss': '6.8913'}
2025-02-26 21:40:56,039 - {'Epoch': 42, 'HR@5': '0.0933', 'NDCG@5': '0.0670', 'HR@10': '0.1261', 'NDCG@10': '0.0775', 'HR@20': '0.1670', 'NDCG@20': '0.0878'}
2025-02-26 21:40:56,048 - EarlyStopping counter: 3 out of 10
2025-02-26 21:41:17,970 - {'epoch': 43, 'rec_loss': '6.8836'}
2025-02-26 21:41:24,947 - {'Epoch': 43, 'HR@5': '0.0939', 'NDCG@5': '0.0673', 'HR@10': '0.1264', 'NDCG@10': '0.0778', 'HR@20': '0.1682', 'NDCG@20': '0.0883'}
2025-02-26 21:41:24,954 - EarlyStopping counter: 4 out of 10
2025-02-26 21:41:46,882 - {'epoch': 44, 'rec_loss': '6.8823'}
2025-02-26 21:41:53,547 - {'Epoch': 44, 'HR@5': '0.0947', 'NDCG@5': '0.0678', 'HR@10': '0.1274', 'NDCG@10': '0.0783', 'HR@20': '0.1686', 'NDCG@20': '0.0887'}
2025-02-26 21:41:53,553 - EarlyStopping counter: 5 out of 10
2025-02-26 21:42:15,140 - {'epoch': 45, 'rec_loss': '6.8728'}
2025-02-26 21:42:21,973 - {'Epoch': 45, 'HR@5': '0.0929', 'NDCG@5': '0.0666', 'HR@10': '0.1271', 'NDCG@10': '0.0776', 'HR@20': '0.1697', 'NDCG@20': '0.0883'}
2025-02-26 21:42:21,981 - EarlyStopping counter: 6 out of 10
2025-02-26 21:42:44,015 - {'epoch': 46, 'rec_loss': '6.8721'}
2025-02-26 21:42:51,138 - {'Epoch': 46, 'HR@5': '0.0936', 'NDCG@5': '0.0666', 'HR@10': '0.1277', 'NDCG@10': '0.0777', 'HR@20': '0.1674', 'NDCG@20': '0.0876'}
2025-02-26 21:42:51,145 - EarlyStopping counter: 7 out of 10
2025-02-26 21:43:14,279 - {'epoch': 47, 'rec_loss': '6.8604'}
2025-02-26 21:43:22,234 - {'Epoch': 47, 'HR@5': '0.0942', 'NDCG@5': '0.0672', 'HR@10': '0.1279', 'NDCG@10': '0.0781', 'HR@20': '0.1693', 'NDCG@20': '0.0885'}
2025-02-26 21:43:22,242 - EarlyStopping counter: 8 out of 10
2025-02-26 21:43:45,105 - {'epoch': 48, 'rec_loss': '6.8523'}
2025-02-26 21:43:51,930 - {'Epoch': 48, 'HR@5': '0.0953', 'NDCG@5': '0.0686', 'HR@10': '0.1277', 'NDCG@10': '0.0790', 'HR@20': '0.1688', 'NDCG@20': '0.0894'}
2025-02-26 21:43:51,936 - Validation score increased.  Saving model ...
2025-02-26 21:44:15,193 - {'epoch': 49, 'rec_loss': '6.8473'}
2025-02-26 21:44:21,998 - {'Epoch': 49, 'HR@5': '0.0940', 'NDCG@5': '0.0673', 'HR@10': '0.1271', 'NDCG@10': '0.0779', 'HR@20': '0.1684', 'NDCG@20': '0.0883'}
2025-02-26 21:44:22,005 - EarlyStopping counter: 1 out of 10
2025-02-26 21:44:45,506 - {'epoch': 50, 'rec_loss': '6.8564'}
2025-02-26 21:44:52,470 - {'Epoch': 50, 'HR@5': '0.0943', 'NDCG@5': '0.0676', 'HR@10': '0.1274', 'NDCG@10': '0.0783', 'HR@20': '0.1697', 'NDCG@20': '0.0890'}
2025-02-26 21:44:52,476 - EarlyStopping counter: 2 out of 10
2025-02-26 21:45:14,754 - {'epoch': 51, 'rec_loss': '6.8436'}
2025-02-26 21:45:21,527 - {'Epoch': 51, 'HR@5': '0.0936', 'NDCG@5': '0.0676', 'HR@10': '0.1285', 'NDCG@10': '0.0789', 'HR@20': '0.1690', 'NDCG@20': '0.0891'}
2025-02-26 21:45:21,534 - EarlyStopping counter: 3 out of 10
2025-02-26 21:45:44,879 - {'epoch': 52, 'rec_loss': '6.8406'}
2025-02-26 21:45:52,873 - {'Epoch': 52, 'HR@5': '0.0947', 'NDCG@5': '0.0680', 'HR@10': '0.1286', 'NDCG@10': '0.0789', 'HR@20': '0.1701', 'NDCG@20': '0.0893'}
2025-02-26 21:45:52,879 - EarlyStopping counter: 4 out of 10
2025-02-26 21:46:15,197 - {'epoch': 53, 'rec_loss': '6.8283'}
2025-02-26 21:46:22,288 - {'Epoch': 53, 'HR@5': '0.0963', 'NDCG@5': '0.0691', 'HR@10': '0.1287', 'NDCG@10': '0.0795', 'HR@20': '0.1690', 'NDCG@20': '0.0897'}
2025-02-26 21:46:22,295 - Validation score increased.  Saving model ...
2025-02-26 21:46:45,051 - {'epoch': 54, 'rec_loss': '6.8258'}
2025-02-26 21:46:52,348 - {'Epoch': 54, 'HR@5': '0.0947', 'NDCG@5': '0.0685', 'HR@10': '0.1272', 'NDCG@10': '0.0790', 'HR@20': '0.1679', 'NDCG@20': '0.0893'}
2025-02-26 21:46:52,356 - EarlyStopping counter: 1 out of 10
2025-02-26 21:47:14,618 - {'epoch': 55, 'rec_loss': '6.8271'}
2025-02-26 21:47:21,946 - {'Epoch': 55, 'HR@5': '0.0946', 'NDCG@5': '0.0675', 'HR@10': '0.1270', 'NDCG@10': '0.0780', 'HR@20': '0.1667', 'NDCG@20': '0.0880'}
2025-02-26 21:47:21,955 - EarlyStopping counter: 2 out of 10
2025-02-26 21:47:45,083 - {'epoch': 56, 'rec_loss': '6.8265'}
2025-02-26 21:47:51,752 - {'Epoch': 56, 'HR@5': '0.0947', 'NDCG@5': '0.0681', 'HR@10': '0.1270', 'NDCG@10': '0.0785', 'HR@20': '0.1682', 'NDCG@20': '0.0889'}
2025-02-26 21:47:51,758 - EarlyStopping counter: 3 out of 10
2025-02-26 21:48:15,133 - {'epoch': 57, 'rec_loss': '6.8206'}
2025-02-26 21:48:21,858 - {'Epoch': 57, 'HR@5': '0.0952', 'NDCG@5': '0.0680', 'HR@10': '0.1280', 'NDCG@10': '0.0785', 'HR@20': '0.1684', 'NDCG@20': '0.0887'}
2025-02-26 21:48:21,865 - EarlyStopping counter: 4 out of 10
2025-02-26 21:48:44,704 - {'epoch': 58, 'rec_loss': '6.8136'}
2025-02-26 21:48:51,881 - {'Epoch': 58, 'HR@5': '0.0940', 'NDCG@5': '0.0675', 'HR@10': '0.1279', 'NDCG@10': '0.0785', 'HR@20': '0.1675', 'NDCG@20': '0.0885'}
2025-02-26 21:48:51,888 - EarlyStopping counter: 5 out of 10
2025-02-26 21:49:14,870 - {'epoch': 59, 'rec_loss': '6.8164'}
2025-02-26 21:49:21,571 - {'Epoch': 59, 'HR@5': '0.0949', 'NDCG@5': '0.0677', 'HR@10': '0.1278', 'NDCG@10': '0.0783', 'HR@20': '0.1692', 'NDCG@20': '0.0887'}
2025-02-26 21:49:21,577 - EarlyStopping counter: 6 out of 10
2025-02-26 21:49:43,646 - {'epoch': 60, 'rec_loss': '6.8127'}
2025-02-26 21:49:50,336 - {'Epoch': 60, 'HR@5': '0.0946', 'NDCG@5': '0.0680', 'HR@10': '0.1281', 'NDCG@10': '0.0788', 'HR@20': '0.1685', 'NDCG@20': '0.0890'}
2025-02-26 21:49:50,341 - EarlyStopping counter: 7 out of 10
2025-02-26 21:50:12,037 - {'epoch': 61, 'rec_loss': '6.8024'}
2025-02-26 21:50:19,387 - {'Epoch': 61, 'HR@5': '0.0948', 'NDCG@5': '0.0683', 'HR@10': '0.1286', 'NDCG@10': '0.0792', 'HR@20': '0.1690', 'NDCG@20': '0.0894'}
2025-02-26 21:50:19,394 - EarlyStopping counter: 8 out of 10
2025-02-26 21:50:43,566 - {'epoch': 62, 'rec_loss': '6.8036'}
2025-02-26 21:50:50,322 - {'Epoch': 62, 'HR@5': '0.0937', 'NDCG@5': '0.0680', 'HR@10': '0.1277', 'NDCG@10': '0.0789', 'HR@20': '0.1685', 'NDCG@20': '0.0892'}
2025-02-26 21:50:50,329 - EarlyStopping counter: 9 out of 10
2025-02-26 21:51:13,103 - {'epoch': 63, 'rec_loss': '6.7979'}
2025-02-26 21:51:19,772 - {'Epoch': 63, 'HR@5': '0.0931', 'NDCG@5': '0.0674', 'HR@10': '0.1282', 'NDCG@10': '0.0787', 'HR@20': '0.1694', 'NDCG@20': '0.0891'}
2025-02-26 21:51:19,778 - EarlyStopping counter: 10 out of 10
2025-02-26 21:51:19,779 - Early stopping
2025-02-26 21:51:19,779 - ---------------Test Score---------------
2025-02-26 21:51:26,502 - {'Epoch': 0, 'HR@5': '0.0792', 'NDCG@5': '0.0569', 'HR@10': '0.1070', 'NDCG@10': '0.0659', 'HR@20': '0.1433', 'NDCG@20': '0.0750'}
2025-02-26 21:51:26,510 - Scale_Toys
2025-02-26 21:51:26,510 - {'Epoch': 0, 'HR@5': '0.0792', 'NDCG@5': '0.0569', 'HR@10': '0.1070', 'NDCG@10': '0.0659', 'HR@20': '0.1433', 'NDCG@20': '0.0750'}
2025-02-26 22:31:38,927 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 12], start_prob=0.1, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-02-26 22:31:41,852 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-26 22:31:41,856 - Total Parameters: 918117
2025-02-26 22:32:05,994 - {'epoch': 0, 'rec_loss': '9.0910'}
2025-02-26 22:32:13,429 - {'Epoch': 0, 'HR@5': '0.0066', 'NDCG@5': '0.0039', 'HR@10': '0.0114', 'NDCG@10': '0.0054', 'HR@20': '0.0196', 'NDCG@20': '0.0075'}
2025-02-26 22:32:13,431 - Validation score increased.  Saving model ...
2025-02-26 22:32:35,384 - {'epoch': 1, 'rec_loss': '8.6766'}
2025-02-26 22:32:42,926 - {'Epoch': 1, 'HR@5': '0.0183', 'NDCG@5': '0.0131', 'HR@10': '0.0265', 'NDCG@10': '0.0158', 'HR@20': '0.0413', 'NDCG@20': '0.0194'}
2025-02-26 22:32:42,932 - Validation score increased.  Saving model ...
2025-02-26 22:33:04,566 - {'epoch': 2, 'rec_loss': '8.3539'}
2025-02-26 22:33:11,967 - {'Epoch': 2, 'HR@5': '0.0384', 'NDCG@5': '0.0277', 'HR@10': '0.0554', 'NDCG@10': '0.0331', 'HR@20': '0.0783', 'NDCG@20': '0.0389'}
2025-02-26 22:33:11,975 - Validation score increased.  Saving model ...
2025-02-26 22:33:34,725 - {'epoch': 3, 'rec_loss': '8.0524'}
2025-02-26 22:33:41,858 - {'Epoch': 3, 'HR@5': '0.0540', 'NDCG@5': '0.0381', 'HR@10': '0.0759', 'NDCG@10': '0.0451', 'HR@20': '0.1059', 'NDCG@20': '0.0527'}
2025-02-26 22:33:41,867 - Validation score increased.  Saving model ...
2025-02-26 22:34:05,297 - {'epoch': 4, 'rec_loss': '7.8216'}
2025-02-26 22:34:12,631 - {'Epoch': 4, 'HR@5': '0.0652', 'NDCG@5': '0.0463', 'HR@10': '0.0900', 'NDCG@10': '0.0543', 'HR@20': '0.1213', 'NDCG@20': '0.0622'}
2025-02-26 22:34:12,639 - Validation score increased.  Saving model ...
2025-02-26 22:34:36,037 - {'epoch': 5, 'rec_loss': '7.6558'}
2025-02-26 22:34:43,132 - {'Epoch': 5, 'HR@5': '0.0746', 'NDCG@5': '0.0531', 'HR@10': '0.1000', 'NDCG@10': '0.0612', 'HR@20': '0.1324', 'NDCG@20': '0.0694'}
2025-02-26 22:34:43,141 - Validation score increased.  Saving model ...
2025-02-26 22:35:05,355 - {'epoch': 6, 'rec_loss': '7.5250'}
2025-02-26 22:35:12,850 - {'Epoch': 6, 'HR@5': '0.0773', 'NDCG@5': '0.0557', 'HR@10': '0.1056', 'NDCG@10': '0.0648', 'HR@20': '0.1407', 'NDCG@20': '0.0736'}
2025-02-26 22:35:12,858 - Validation score increased.  Saving model ...
2025-02-26 22:35:36,609 - {'epoch': 7, 'rec_loss': '7.4269'}
2025-02-26 22:35:44,103 - {'Epoch': 7, 'HR@5': '0.0811', 'NDCG@5': '0.0586', 'HR@10': '0.1105', 'NDCG@10': '0.0680', 'HR@20': '0.1450', 'NDCG@20': '0.0767'}
2025-02-26 22:35:44,112 - Validation score increased.  Saving model ...
2025-02-26 22:36:07,311 - {'epoch': 8, 'rec_loss': '7.3444'}
2025-02-26 22:36:15,147 - {'Epoch': 8, 'HR@5': '0.0834', 'NDCG@5': '0.0603', 'HR@10': '0.1115', 'NDCG@10': '0.0693', 'HR@20': '0.1484', 'NDCG@20': '0.0786'}
2025-02-26 22:36:15,154 - Validation score increased.  Saving model ...
2025-02-26 22:36:38,261 - {'epoch': 9, 'rec_loss': '7.2825'}
2025-02-26 22:36:45,174 - {'Epoch': 9, 'HR@5': '0.0849', 'NDCG@5': '0.0616', 'HR@10': '0.1134', 'NDCG@10': '0.0707', 'HR@20': '0.1514', 'NDCG@20': '0.0803'}
2025-02-26 22:36:45,182 - Validation score increased.  Saving model ...
2025-02-26 22:37:08,544 - {'epoch': 10, 'rec_loss': '7.2361'}
2025-02-26 22:37:15,850 - {'Epoch': 10, 'HR@5': '0.0864', 'NDCG@5': '0.0631', 'HR@10': '0.1167', 'NDCG@10': '0.0729', 'HR@20': '0.1540', 'NDCG@20': '0.0823'}
2025-02-26 22:37:15,855 - Validation score increased.  Saving model ...
2025-02-26 22:37:39,484 - {'epoch': 11, 'rec_loss': '7.1905'}
2025-02-26 22:37:46,909 - {'Epoch': 11, 'HR@5': '0.0875', 'NDCG@5': '0.0640', 'HR@10': '0.1181', 'NDCG@10': '0.0739', 'HR@20': '0.1562', 'NDCG@20': '0.0835'}
2025-02-26 22:37:46,910 - Validation score increased.  Saving model ...
2025-02-26 22:38:09,427 - {'epoch': 12, 'rec_loss': '7.1499'}
2025-02-26 22:38:16,621 - {'Epoch': 12, 'HR@5': '0.0878', 'NDCG@5': '0.0645', 'HR@10': '0.1190', 'NDCG@10': '0.0746', 'HR@20': '0.1559', 'NDCG@20': '0.0839'}
2025-02-26 22:38:16,623 - Validation score increased.  Saving model ...
2025-02-26 22:38:39,542 - {'epoch': 13, 'rec_loss': '7.1153'}
2025-02-26 22:38:47,223 - {'Epoch': 13, 'HR@5': '0.0881', 'NDCG@5': '0.0641', 'HR@10': '0.1196', 'NDCG@10': '0.0742', 'HR@20': '0.1555', 'NDCG@20': '0.0832'}
2025-02-26 22:38:47,229 - EarlyStopping counter: 1 out of 10
2025-02-26 22:39:09,948 - {'epoch': 14, 'rec_loss': '7.0866'}
2025-02-26 22:39:16,950 - {'Epoch': 14, 'HR@5': '0.0887', 'NDCG@5': '0.0649', 'HR@10': '0.1199', 'NDCG@10': '0.0750', 'HR@20': '0.1569', 'NDCG@20': '0.0843'}
2025-02-26 22:39:16,954 - Validation score increased.  Saving model ...
2025-02-26 22:39:40,887 - {'epoch': 15, 'rec_loss': '7.0614'}
2025-02-26 22:39:47,641 - {'Epoch': 15, 'HR@5': '0.0888', 'NDCG@5': '0.0649', 'HR@10': '0.1201', 'NDCG@10': '0.0750', 'HR@20': '0.1579', 'NDCG@20': '0.0845'}
2025-02-26 22:39:47,643 - Validation score increased.  Saving model ...
2025-02-26 22:40:10,580 - {'epoch': 16, 'rec_loss': '7.0308'}
2025-02-26 22:40:17,675 - {'Epoch': 16, 'HR@5': '0.0899', 'NDCG@5': '0.0656', 'HR@10': '0.1224', 'NDCG@10': '0.0761', 'HR@20': '0.1588', 'NDCG@20': '0.0853'}
2025-02-26 22:40:17,683 - Validation score increased.  Saving model ...
2025-02-26 22:40:40,544 - {'epoch': 17, 'rec_loss': '7.0101'}
2025-02-26 22:40:47,790 - {'Epoch': 17, 'HR@5': '0.0904', 'NDCG@5': '0.0657', 'HR@10': '0.1218', 'NDCG@10': '0.0758', 'HR@20': '0.1583', 'NDCG@20': '0.0850'}
2025-02-26 22:40:47,800 - EarlyStopping counter: 1 out of 10
2025-02-26 22:41:11,026 - {'epoch': 18, 'rec_loss': '6.9968'}
2025-02-26 22:41:18,324 - {'Epoch': 18, 'HR@5': '0.0906', 'NDCG@5': '0.0655', 'HR@10': '0.1226', 'NDCG@10': '0.0758', 'HR@20': '0.1607', 'NDCG@20': '0.0854'}
2025-02-26 22:41:18,331 - Validation score increased.  Saving model ...
2025-02-26 22:41:41,343 - {'epoch': 19, 'rec_loss': '6.9764'}
2025-02-26 22:41:48,313 - {'Epoch': 19, 'HR@5': '0.0906', 'NDCG@5': '0.0655', 'HR@10': '0.1226', 'NDCG@10': '0.0758', 'HR@20': '0.1602', 'NDCG@20': '0.0853'}
2025-02-26 22:41:48,318 - EarlyStopping counter: 1 out of 10
2025-02-26 22:42:11,880 - {'epoch': 20, 'rec_loss': '6.9575'}
2025-02-26 22:42:19,562 - {'Epoch': 20, 'HR@5': '0.0899', 'NDCG@5': '0.0653', 'HR@10': '0.1219', 'NDCG@10': '0.0757', 'HR@20': '0.1630', 'NDCG@20': '0.0861'}
2025-02-26 22:42:19,568 - Validation score increased.  Saving model ...
2025-02-26 22:42:40,868 - {'epoch': 21, 'rec_loss': '6.9380'}
2025-02-26 22:42:47,984 - {'Epoch': 21, 'HR@5': '0.0925', 'NDCG@5': '0.0669', 'HR@10': '0.1245', 'NDCG@10': '0.0772', 'HR@20': '0.1627', 'NDCG@20': '0.0868'}
2025-02-26 22:42:47,992 - Validation score increased.  Saving model ...
2025-02-26 22:43:10,349 - {'epoch': 22, 'rec_loss': '6.9249'}
2025-02-26 22:43:18,019 - {'Epoch': 22, 'HR@5': '0.0912', 'NDCG@5': '0.0668', 'HR@10': '0.1240', 'NDCG@10': '0.0774', 'HR@20': '0.1637', 'NDCG@20': '0.0873'}
2025-02-26 22:43:18,026 - Validation score increased.  Saving model ...
2025-02-26 22:43:40,859 - {'epoch': 23, 'rec_loss': '6.9117'}
2025-02-26 22:43:48,508 - {'Epoch': 23, 'HR@5': '0.0915', 'NDCG@5': '0.0666', 'HR@10': '0.1220', 'NDCG@10': '0.0764', 'HR@20': '0.1634', 'NDCG@20': '0.0868'}
2025-02-26 22:43:48,517 - EarlyStopping counter: 1 out of 10
2025-02-26 22:44:11,838 - {'epoch': 24, 'rec_loss': '6.8936'}
2025-02-26 22:44:19,236 - {'Epoch': 24, 'HR@5': '0.0913', 'NDCG@5': '0.0664', 'HR@10': '0.1234', 'NDCG@10': '0.0768', 'HR@20': '0.1640', 'NDCG@20': '0.0870'}
2025-02-26 22:44:19,242 - EarlyStopping counter: 2 out of 10
2025-02-26 22:44:42,240 - {'epoch': 25, 'rec_loss': '6.8770'}
2025-02-26 22:44:49,379 - {'Epoch': 25, 'HR@5': '0.0905', 'NDCG@5': '0.0661', 'HR@10': '0.1231', 'NDCG@10': '0.0766', 'HR@20': '0.1628', 'NDCG@20': '0.0866'}
2025-02-26 22:44:49,385 - EarlyStopping counter: 3 out of 10
2025-02-26 22:45:11,511 - {'epoch': 26, 'rec_loss': '6.8730'}
2025-02-26 22:45:18,853 - {'Epoch': 26, 'HR@5': '0.0922', 'NDCG@5': '0.0666', 'HR@10': '0.1238', 'NDCG@10': '0.0768', 'HR@20': '0.1643', 'NDCG@20': '0.0870'}
2025-02-26 22:45:18,858 - EarlyStopping counter: 4 out of 10
2025-02-26 22:45:42,077 - {'epoch': 27, 'rec_loss': '6.8534'}
2025-02-26 22:45:49,326 - {'Epoch': 27, 'HR@5': '0.0923', 'NDCG@5': '0.0668', 'HR@10': '0.1240', 'NDCG@10': '0.0770', 'HR@20': '0.1637', 'NDCG@20': '0.0871'}
2025-02-26 22:45:49,336 - EarlyStopping counter: 5 out of 10
2025-02-26 22:46:12,233 - {'epoch': 28, 'rec_loss': '6.8501'}
2025-02-26 22:46:20,082 - {'Epoch': 28, 'HR@5': '0.0936', 'NDCG@5': '0.0670', 'HR@10': '0.1253', 'NDCG@10': '0.0772', 'HR@20': '0.1641', 'NDCG@20': '0.0869'}
2025-02-26 22:46:20,083 - EarlyStopping counter: 6 out of 10
2025-02-26 22:46:43,132 - {'epoch': 29, 'rec_loss': '6.8353'}
2025-02-26 22:46:50,248 - {'Epoch': 29, 'HR@5': '0.0925', 'NDCG@5': '0.0671', 'HR@10': '0.1242', 'NDCG@10': '0.0773', 'HR@20': '0.1643', 'NDCG@20': '0.0874'}
2025-02-26 22:46:50,252 - Validation score increased.  Saving model ...
2025-02-26 22:47:12,878 - {'epoch': 30, 'rec_loss': '6.8250'}
2025-02-26 22:47:19,855 - {'Epoch': 30, 'HR@5': '0.0927', 'NDCG@5': '0.0673', 'HR@10': '0.1245', 'NDCG@10': '0.0775', 'HR@20': '0.1627', 'NDCG@20': '0.0871'}
2025-02-26 22:47:19,860 - EarlyStopping counter: 1 out of 10
2025-02-26 22:47:42,373 - {'epoch': 31, 'rec_loss': '6.8158'}
2025-02-26 22:47:49,378 - {'Epoch': 31, 'HR@5': '0.0921', 'NDCG@5': '0.0671', 'HR@10': '0.1248', 'NDCG@10': '0.0776', 'HR@20': '0.1642', 'NDCG@20': '0.0875'}
2025-02-26 22:47:49,385 - Validation score increased.  Saving model ...
2025-02-26 22:48:11,979 - {'epoch': 32, 'rec_loss': '6.8051'}
2025-02-26 22:48:19,697 - {'Epoch': 32, 'HR@5': '0.0909', 'NDCG@5': '0.0666', 'HR@10': '0.1250', 'NDCG@10': '0.0775', 'HR@20': '0.1638', 'NDCG@20': '0.0873'}
2025-02-26 22:48:19,702 - EarlyStopping counter: 1 out of 10
2025-02-26 22:48:42,940 - {'epoch': 33, 'rec_loss': '6.8012'}
2025-02-26 22:48:49,792 - {'Epoch': 33, 'HR@5': '0.0926', 'NDCG@5': '0.0670', 'HR@10': '0.1245', 'NDCG@10': '0.0772', 'HR@20': '0.1636', 'NDCG@20': '0.0871'}
2025-02-26 22:48:49,800 - EarlyStopping counter: 2 out of 10
2025-02-26 22:49:12,201 - {'epoch': 34, 'rec_loss': '6.7859'}
2025-02-26 22:49:19,751 - {'Epoch': 34, 'HR@5': '0.0916', 'NDCG@5': '0.0669', 'HR@10': '0.1252', 'NDCG@10': '0.0778', 'HR@20': '0.1646', 'NDCG@20': '0.0877'}
2025-02-26 22:49:19,757 - Validation score increased.  Saving model ...
2025-02-26 22:49:43,046 - {'epoch': 35, 'rec_loss': '6.7775'}
2025-02-26 22:49:50,146 - {'Epoch': 35, 'HR@5': '0.0932', 'NDCG@5': '0.0678', 'HR@10': '0.1249', 'NDCG@10': '0.0780', 'HR@20': '0.1658', 'NDCG@20': '0.0883'}
2025-02-26 22:49:50,152 - Validation score increased.  Saving model ...
2025-02-26 22:50:13,126 - {'epoch': 36, 'rec_loss': '6.7705'}
2025-02-26 22:50:20,911 - {'Epoch': 36, 'HR@5': '0.0917', 'NDCG@5': '0.0669', 'HR@10': '0.1256', 'NDCG@10': '0.0778', 'HR@20': '0.1655', 'NDCG@20': '0.0879'}
2025-02-26 22:50:20,919 - EarlyStopping counter: 1 out of 10
2025-02-26 22:50:44,280 - {'epoch': 37, 'rec_loss': '6.7545'}
2025-02-26 22:50:51,219 - {'Epoch': 37, 'HR@5': '0.0919', 'NDCG@5': '0.0665', 'HR@10': '0.1248', 'NDCG@10': '0.0771', 'HR@20': '0.1641', 'NDCG@20': '0.0870'}
2025-02-26 22:50:51,227 - EarlyStopping counter: 2 out of 10
2025-02-26 22:51:13,553 - {'epoch': 38, 'rec_loss': '6.7489'}
2025-02-26 22:51:21,131 - {'Epoch': 38, 'HR@5': '0.0941', 'NDCG@5': '0.0681', 'HR@10': '0.1262', 'NDCG@10': '0.0784', 'HR@20': '0.1662', 'NDCG@20': '0.0885'}
2025-02-26 22:51:21,136 - Validation score increased.  Saving model ...
2025-02-26 22:51:43,785 - {'epoch': 39, 'rec_loss': '6.7468'}
2025-02-26 22:51:51,792 - {'Epoch': 39, 'HR@5': '0.0940', 'NDCG@5': '0.0679', 'HR@10': '0.1253', 'NDCG@10': '0.0780', 'HR@20': '0.1655', 'NDCG@20': '0.0881'}
2025-02-26 22:51:51,801 - EarlyStopping counter: 1 out of 10
2025-02-26 22:52:15,146 - {'epoch': 40, 'rec_loss': '6.7318'}
2025-02-26 22:52:22,445 - {'Epoch': 40, 'HR@5': '0.0939', 'NDCG@5': '0.0683', 'HR@10': '0.1264', 'NDCG@10': '0.0787', 'HR@20': '0.1655', 'NDCG@20': '0.0885'}
2025-02-26 22:52:22,447 - EarlyStopping counter: 2 out of 10
2025-02-26 22:52:45,231 - {'epoch': 41, 'rec_loss': '6.7286'}
2025-02-26 22:52:52,435 - {'Epoch': 41, 'HR@5': '0.0933', 'NDCG@5': '0.0675', 'HR@10': '0.1245', 'NDCG@10': '0.0776', 'HR@20': '0.1641', 'NDCG@20': '0.0876'}
2025-02-26 22:52:52,440 - EarlyStopping counter: 3 out of 10
2025-02-26 22:53:15,024 - {'epoch': 42, 'rec_loss': '6.7274'}
2025-02-26 22:53:22,213 - {'Epoch': 42, 'HR@5': '0.0935', 'NDCG@5': '0.0678', 'HR@10': '0.1247', 'NDCG@10': '0.0778', 'HR@20': '0.1634', 'NDCG@20': '0.0876'}
2025-02-26 22:53:22,219 - EarlyStopping counter: 4 out of 10
2025-02-26 22:53:45,528 - {'epoch': 43, 'rec_loss': '6.7147'}
2025-02-26 22:53:52,971 - {'Epoch': 43, 'HR@5': '0.0925', 'NDCG@5': '0.0678', 'HR@10': '0.1264', 'NDCG@10': '0.0787', 'HR@20': '0.1651', 'NDCG@20': '0.0884'}
2025-02-26 22:53:52,977 - EarlyStopping counter: 5 out of 10
2025-02-26 22:54:15,822 - {'epoch': 44, 'rec_loss': '6.7040'}
2025-02-26 22:54:22,942 - {'Epoch': 44, 'HR@5': '0.0916', 'NDCG@5': '0.0670', 'HR@10': '0.1260', 'NDCG@10': '0.0781', 'HR@20': '0.1647', 'NDCG@20': '0.0879'}
2025-02-26 22:54:22,951 - EarlyStopping counter: 6 out of 10
2025-02-26 22:54:45,999 - {'epoch': 45, 'rec_loss': '6.7040'}
2025-02-26 22:54:53,463 - {'Epoch': 45, 'HR@5': '0.0937', 'NDCG@5': '0.0679', 'HR@10': '0.1263', 'NDCG@10': '0.0784', 'HR@20': '0.1654', 'NDCG@20': '0.0883'}
2025-02-26 22:54:53,464 - EarlyStopping counter: 7 out of 10
2025-02-26 22:55:16,227 - {'epoch': 46, 'rec_loss': '6.7031'}
2025-02-26 22:55:23,486 - {'Epoch': 46, 'HR@5': '0.0920', 'NDCG@5': '0.0670', 'HR@10': '0.1229', 'NDCG@10': '0.0770', 'HR@20': '0.1623', 'NDCG@20': '0.0870'}
2025-02-26 22:55:23,491 - EarlyStopping counter: 8 out of 10
2025-02-26 22:55:45,726 - {'epoch': 47, 'rec_loss': '6.6912'}
2025-02-26 22:55:53,966 - {'Epoch': 47, 'HR@5': '0.0928', 'NDCG@5': '0.0672', 'HR@10': '0.1255', 'NDCG@10': '0.0778', 'HR@20': '0.1650', 'NDCG@20': '0.0877'}
2025-02-26 22:55:53,973 - EarlyStopping counter: 9 out of 10
2025-02-26 22:56:16,309 - {'epoch': 48, 'rec_loss': '6.6825'}
2025-02-26 22:56:24,715 - {'Epoch': 48, 'HR@5': '0.0926', 'NDCG@5': '0.0674', 'HR@10': '0.1251', 'NDCG@10': '0.0779', 'HR@20': '0.1637', 'NDCG@20': '0.0876'}
2025-02-26 22:56:24,725 - EarlyStopping counter: 10 out of 10
2025-02-26 22:56:24,725 - Early stopping
2025-02-26 22:56:24,725 - ---------------Test Score---------------
2025-02-26 22:56:32,300 - {'Epoch': 0, 'HR@5': '0.0783', 'NDCG@5': '0.0566', 'HR@10': '0.1045', 'NDCG@10': '0.0651', 'HR@20': '0.1400', 'NDCG@20': '0.0740'}
2025-02-26 22:56:32,307 - Scale_Toys
2025-02-26 22:56:32,307 - {'Epoch': 0, 'HR@5': '0.0783', 'NDCG@5': '0.0566', 'HR@10': '0.1045', 'NDCG@10': '0.0651', 'HR@20': '0.1400', 'NDCG@20': '0.0740'}
2025-02-26 22:59:09,158 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[10, 5], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-02-26 22:59:12,044 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-26 22:59:12,048 - Total Parameters: 916817
2025-02-26 22:59:35,513 - {'epoch': 0, 'rec_loss': '9.0815'}
2025-02-26 22:59:43,354 - {'Epoch': 0, 'HR@5': '0.0062', 'NDCG@5': '0.0036', 'HR@10': '0.0114', 'NDCG@10': '0.0052', 'HR@20': '0.0192', 'NDCG@20': '0.0072'}
2025-02-26 22:59:43,359 - Validation score increased.  Saving model ...
2025-02-26 23:00:06,335 - {'epoch': 1, 'rec_loss': '8.6801'}
2025-02-26 23:00:13,346 - {'Epoch': 1, 'HR@5': '0.0197', 'NDCG@5': '0.0141', 'HR@10': '0.0297', 'NDCG@10': '0.0173', 'HR@20': '0.0434', 'NDCG@20': '0.0208'}
2025-02-26 23:00:13,354 - Validation score increased.  Saving model ...
2025-02-26 23:00:36,078 - {'epoch': 2, 'rec_loss': '8.3806'}
2025-02-26 23:00:43,723 - {'Epoch': 2, 'HR@5': '0.0348', 'NDCG@5': '0.0246', 'HR@10': '0.0505', 'NDCG@10': '0.0297', 'HR@20': '0.0734', 'NDCG@20': '0.0355'}
2025-02-26 23:00:43,731 - Validation score increased.  Saving model ...
2025-02-26 23:01:06,780 - {'epoch': 3, 'rec_loss': '8.1114'}
2025-02-26 23:01:14,464 - {'Epoch': 3, 'HR@5': '0.0499', 'NDCG@5': '0.0357', 'HR@10': '0.0691', 'NDCG@10': '0.0419', 'HR@20': '0.0955', 'NDCG@20': '0.0485'}
2025-02-26 23:01:14,472 - Validation score increased.  Saving model ...
2025-02-26 23:01:37,792 - {'epoch': 4, 'rec_loss': '7.8934'}
2025-02-26 23:01:44,832 - {'Epoch': 4, 'HR@5': '0.0626', 'NDCG@5': '0.0441', 'HR@10': '0.0872', 'NDCG@10': '0.0520', 'HR@20': '0.1191', 'NDCG@20': '0.0600'}
2025-02-26 23:01:44,833 - Validation score increased.  Saving model ...
2025-02-26 23:02:08,572 - {'epoch': 5, 'rec_loss': '7.7261'}
2025-02-26 23:02:16,603 - {'Epoch': 5, 'HR@5': '0.0706', 'NDCG@5': '0.0503', 'HR@10': '0.0963', 'NDCG@10': '0.0586', 'HR@20': '0.1299', 'NDCG@20': '0.0671'}
2025-02-26 23:02:16,611 - Validation score increased.  Saving model ...
2025-02-26 23:02:39,572 - {'epoch': 6, 'rec_loss': '7.6044'}
2025-02-26 23:02:47,209 - {'Epoch': 6, 'HR@5': '0.0755', 'NDCG@5': '0.0536', 'HR@10': '0.1029', 'NDCG@10': '0.0624', 'HR@20': '0.1368', 'NDCG@20': '0.0709'}
2025-02-26 23:02:47,210 - Validation score increased.  Saving model ...
2025-02-26 23:03:10,344 - {'epoch': 7, 'rec_loss': '7.5111'}
2025-02-26 23:03:17,007 - {'Epoch': 7, 'HR@5': '0.0797', 'NDCG@5': '0.0573', 'HR@10': '0.1081', 'NDCG@10': '0.0664', 'HR@20': '0.1443', 'NDCG@20': '0.0755'}
2025-02-26 23:03:17,014 - Validation score increased.  Saving model ...
2025-02-26 23:03:39,389 - {'epoch': 8, 'rec_loss': '7.4327'}
2025-02-26 23:03:46,337 - {'Epoch': 8, 'HR@5': '0.0833', 'NDCG@5': '0.0597', 'HR@10': '0.1118', 'NDCG@10': '0.0689', 'HR@20': '0.1473', 'NDCG@20': '0.0778'}
2025-02-26 23:03:46,345 - Validation score increased.  Saving model ...
2025-02-26 23:04:09,224 - {'epoch': 9, 'rec_loss': '7.3590'}
2025-02-26 23:04:16,478 - {'Epoch': 9, 'HR@5': '0.0843', 'NDCG@5': '0.0611', 'HR@10': '0.1142', 'NDCG@10': '0.0707', 'HR@20': '0.1509', 'NDCG@20': '0.0800'}
2025-02-26 23:04:16,480 - Validation score increased.  Saving model ...
2025-02-26 23:04:40,156 - {'epoch': 10, 'rec_loss': '7.3178'}
2025-02-26 23:04:47,537 - {'Epoch': 10, 'HR@5': '0.0870', 'NDCG@5': '0.0621', 'HR@10': '0.1148', 'NDCG@10': '0.0711', 'HR@20': '0.1538', 'NDCG@20': '0.0809'}
2025-02-26 23:04:47,544 - Validation score increased.  Saving model ...
2025-02-26 23:05:09,932 - {'epoch': 11, 'rec_loss': '7.2656'}
2025-02-26 23:05:16,968 - {'Epoch': 11, 'HR@5': '0.0877', 'NDCG@5': '0.0632', 'HR@10': '0.1161', 'NDCG@10': '0.0723', 'HR@20': '0.1556', 'NDCG@20': '0.0823'}
2025-02-26 23:05:16,969 - Validation score increased.  Saving model ...
2025-02-26 23:05:40,141 - {'epoch': 12, 'rec_loss': '7.2240'}
2025-02-26 23:05:47,975 - {'Epoch': 12, 'HR@5': '0.0882', 'NDCG@5': '0.0633', 'HR@10': '0.1182', 'NDCG@10': '0.0729', 'HR@20': '0.1545', 'NDCG@20': '0.0821'}
2025-02-26 23:05:47,982 - EarlyStopping counter: 1 out of 10
2025-02-26 23:06:11,549 - {'epoch': 13, 'rec_loss': '7.1992'}
2025-02-26 23:06:18,314 - {'Epoch': 13, 'HR@5': '0.0879', 'NDCG@5': '0.0640', 'HR@10': '0.1168', 'NDCG@10': '0.0733', 'HR@20': '0.1564', 'NDCG@20': '0.0833'}
2025-02-26 23:06:18,316 - Validation score increased.  Saving model ...
2025-02-26 23:06:40,572 - {'epoch': 14, 'rec_loss': '7.1708'}
2025-02-26 23:06:47,788 - {'Epoch': 14, 'HR@5': '0.0885', 'NDCG@5': '0.0639', 'HR@10': '0.1189', 'NDCG@10': '0.0737', 'HR@20': '0.1577', 'NDCG@20': '0.0835'}
2025-02-26 23:06:47,797 - Validation score increased.  Saving model ...
2025-02-26 23:07:11,068 - {'epoch': 15, 'rec_loss': '7.1393'}
2025-02-26 23:07:18,004 - {'Epoch': 15, 'HR@5': '0.0888', 'NDCG@5': '0.0648', 'HR@10': '0.1202', 'NDCG@10': '0.0748', 'HR@20': '0.1576', 'NDCG@20': '0.0843'}
2025-02-26 23:07:18,005 - Validation score increased.  Saving model ...
2025-02-26 23:07:40,346 - {'epoch': 16, 'rec_loss': '7.1211'}
2025-02-26 23:07:47,348 - {'Epoch': 16, 'HR@5': '0.0903', 'NDCG@5': '0.0651', 'HR@10': '0.1198', 'NDCG@10': '0.0746', 'HR@20': '0.1595', 'NDCG@20': '0.0846'}
2025-02-26 23:07:47,355 - Validation score increased.  Saving model ...
2025-02-26 23:08:11,010 - {'epoch': 17, 'rec_loss': '7.0911'}
2025-02-26 23:08:18,265 - {'Epoch': 17, 'HR@5': '0.0907', 'NDCG@5': '0.0656', 'HR@10': '0.1210', 'NDCG@10': '0.0753', 'HR@20': '0.1609', 'NDCG@20': '0.0854'}
2025-02-26 23:08:18,273 - Validation score increased.  Saving model ...
2025-02-26 23:08:40,439 - {'epoch': 18, 'rec_loss': '7.0799'}
2025-02-26 23:08:48,217 - {'Epoch': 18, 'HR@5': '0.0909', 'NDCG@5': '0.0658', 'HR@10': '0.1217', 'NDCG@10': '0.0757', 'HR@20': '0.1605', 'NDCG@20': '0.0855'}
2025-02-26 23:08:48,218 - Validation score increased.  Saving model ...
2025-02-26 23:09:11,008 - {'epoch': 19, 'rec_loss': '7.0578'}
2025-02-26 23:09:18,125 - {'Epoch': 19, 'HR@5': '0.0897', 'NDCG@5': '0.0648', 'HR@10': '0.1234', 'NDCG@10': '0.0757', 'HR@20': '0.1626', 'NDCG@20': '0.0855'}
2025-02-26 23:09:18,133 - EarlyStopping counter: 1 out of 10
2025-02-26 23:09:40,582 - {'epoch': 20, 'rec_loss': '7.0442'}
2025-02-26 23:09:48,154 - {'Epoch': 20, 'HR@5': '0.0899', 'NDCG@5': '0.0652', 'HR@10': '0.1237', 'NDCG@10': '0.0761', 'HR@20': '0.1615', 'NDCG@20': '0.0856'}
2025-02-26 23:09:48,160 - Validation score increased.  Saving model ...
2025-02-26 23:10:11,330 - {'epoch': 21, 'rec_loss': '7.0181'}
2025-02-26 23:10:18,305 - {'Epoch': 21, 'HR@5': '0.0924', 'NDCG@5': '0.0664', 'HR@10': '0.1222', 'NDCG@10': '0.0760', 'HR@20': '0.1622', 'NDCG@20': '0.0860'}
2025-02-26 23:10:18,306 - Validation score increased.  Saving model ...
2025-02-26 23:10:41,371 - {'epoch': 22, 'rec_loss': '7.0081'}
2025-02-26 23:10:49,361 - {'Epoch': 22, 'HR@5': '0.0928', 'NDCG@5': '0.0668', 'HR@10': '0.1228', 'NDCG@10': '0.0765', 'HR@20': '0.1624', 'NDCG@20': '0.0864'}
2025-02-26 23:10:49,369 - Validation score increased.  Saving model ...
2025-02-26 23:11:12,380 - {'epoch': 23, 'rec_loss': '6.9924'}
2025-02-26 23:11:19,093 - {'Epoch': 23, 'HR@5': '0.0919', 'NDCG@5': '0.0661', 'HR@10': '0.1228', 'NDCG@10': '0.0761', 'HR@20': '0.1641', 'NDCG@20': '0.0865'}
2025-02-26 23:11:19,100 - Validation score increased.  Saving model ...
2025-02-26 23:11:42,332 - {'epoch': 24, 'rec_loss': '6.9840'}
2025-02-26 23:11:50,265 - {'Epoch': 24, 'HR@5': '0.0922', 'NDCG@5': '0.0660', 'HR@10': '0.1243', 'NDCG@10': '0.0763', 'HR@20': '0.1644', 'NDCG@20': '0.0864'}
2025-02-26 23:11:50,266 - EarlyStopping counter: 1 out of 10
2025-02-26 23:12:12,595 - {'epoch': 25, 'rec_loss': '6.9658'}
2025-02-26 23:12:19,933 - {'Epoch': 25, 'HR@5': '0.0933', 'NDCG@5': '0.0672', 'HR@10': '0.1250', 'NDCG@10': '0.0774', 'HR@20': '0.1655', 'NDCG@20': '0.0875'}
2025-02-26 23:12:19,934 - Validation score increased.  Saving model ...
2025-02-26 23:12:43,435 - {'epoch': 26, 'rec_loss': '6.9548'}
2025-02-26 23:12:50,261 - {'Epoch': 26, 'HR@5': '0.0919', 'NDCG@5': '0.0667', 'HR@10': '0.1237', 'NDCG@10': '0.0769', 'HR@20': '0.1630', 'NDCG@20': '0.0868'}
2025-02-26 23:12:50,262 - EarlyStopping counter: 1 out of 10
2025-02-26 23:13:11,801 - {'epoch': 27, 'rec_loss': '6.9449'}
2025-02-26 23:13:19,130 - {'Epoch': 27, 'HR@5': '0.0925', 'NDCG@5': '0.0667', 'HR@10': '0.1245', 'NDCG@10': '0.0770', 'HR@20': '0.1630', 'NDCG@20': '0.0867'}
2025-02-26 23:13:19,138 - EarlyStopping counter: 2 out of 10
2025-02-26 23:13:41,677 - {'epoch': 28, 'rec_loss': '6.9332'}
2025-02-26 23:13:49,612 - {'Epoch': 28, 'HR@5': '0.0916', 'NDCG@5': '0.0666', 'HR@10': '0.1244', 'NDCG@10': '0.0772', 'HR@20': '0.1673', 'NDCG@20': '0.0880'}
2025-02-26 23:13:49,614 - Validation score increased.  Saving model ...
2025-02-26 23:14:13,020 - {'epoch': 29, 'rec_loss': '6.9178'}
2025-02-26 23:14:19,828 - {'Epoch': 29, 'HR@5': '0.0920', 'NDCG@5': '0.0661', 'HR@10': '0.1242', 'NDCG@10': '0.0765', 'HR@20': '0.1640', 'NDCG@20': '0.0866'}
2025-02-26 23:14:19,836 - EarlyStopping counter: 1 out of 10
2025-02-26 23:14:42,909 - {'epoch': 30, 'rec_loss': '6.9104'}
2025-02-26 23:14:50,314 - {'Epoch': 30, 'HR@5': '0.0926', 'NDCG@5': '0.0676', 'HR@10': '0.1255', 'NDCG@10': '0.0782', 'HR@20': '0.1662', 'NDCG@20': '0.0885'}
2025-02-26 23:14:50,320 - Validation score increased.  Saving model ...
2025-02-26 23:15:12,421 - {'epoch': 31, 'rec_loss': '6.9019'}
2025-02-26 23:15:19,707 - {'Epoch': 31, 'HR@5': '0.0924', 'NDCG@5': '0.0667', 'HR@10': '0.1254', 'NDCG@10': '0.0773', 'HR@20': '0.1640', 'NDCG@20': '0.0870'}
2025-02-26 23:15:19,718 - EarlyStopping counter: 1 out of 10
2025-02-26 23:15:42,507 - {'epoch': 32, 'rec_loss': '6.8961'}
2025-02-26 23:15:49,565 - {'Epoch': 32, 'HR@5': '0.0939', 'NDCG@5': '0.0681', 'HR@10': '0.1262', 'NDCG@10': '0.0785', 'HR@20': '0.1651', 'NDCG@20': '0.0883'}
2025-02-26 23:15:49,566 - EarlyStopping counter: 2 out of 10
2025-02-26 23:16:11,568 - {'epoch': 33, 'rec_loss': '6.8878'}
2025-02-26 23:16:19,454 - {'Epoch': 33, 'HR@5': '0.0927', 'NDCG@5': '0.0672', 'HR@10': '0.1249', 'NDCG@10': '0.0776', 'HR@20': '0.1666', 'NDCG@20': '0.0881'}
2025-02-26 23:16:19,462 - EarlyStopping counter: 3 out of 10
2025-02-26 23:16:42,181 - {'epoch': 34, 'rec_loss': '6.8762'}
2025-02-26 23:16:48,982 - {'Epoch': 34, 'HR@5': '0.0932', 'NDCG@5': '0.0676', 'HR@10': '0.1259', 'NDCG@10': '0.0782', 'HR@20': '0.1653', 'NDCG@20': '0.0881'}
2025-02-26 23:16:48,990 - EarlyStopping counter: 4 out of 10
2025-02-26 23:17:13,573 - {'epoch': 35, 'rec_loss': '6.8658'}
2025-02-26 23:17:21,119 - {'Epoch': 35, 'HR@5': '0.0934', 'NDCG@5': '0.0671', 'HR@10': '0.1255', 'NDCG@10': '0.0775', 'HR@20': '0.1647', 'NDCG@20': '0.0874'}
2025-02-26 23:17:21,120 - EarlyStopping counter: 5 out of 10
2025-02-26 23:17:44,166 - {'epoch': 36, 'rec_loss': '6.8650'}
2025-02-26 23:17:51,501 - {'Epoch': 36, 'HR@5': '0.0929', 'NDCG@5': '0.0675', 'HR@10': '0.1258', 'NDCG@10': '0.0781', 'HR@20': '0.1675', 'NDCG@20': '0.0886'}
2025-02-26 23:17:51,503 - Validation score increased.  Saving model ...
2025-02-26 23:18:13,892 - {'epoch': 37, 'rec_loss': '6.8536'}
2025-02-26 23:18:21,452 - {'Epoch': 37, 'HR@5': '0.0930', 'NDCG@5': '0.0673', 'HR@10': '0.1256', 'NDCG@10': '0.0779', 'HR@20': '0.1652', 'NDCG@20': '0.0878'}
2025-02-26 23:18:21,461 - EarlyStopping counter: 1 out of 10
2025-02-26 23:18:44,477 - {'epoch': 38, 'rec_loss': '6.8462'}
2025-02-26 23:18:51,917 - {'Epoch': 38, 'HR@5': '0.0941', 'NDCG@5': '0.0676', 'HR@10': '0.1265', 'NDCG@10': '0.0781', 'HR@20': '0.1653', 'NDCG@20': '0.0879'}
2025-02-26 23:18:51,918 - EarlyStopping counter: 2 out of 10
2025-02-26 23:19:14,585 - {'epoch': 39, 'rec_loss': '6.8365'}
2025-02-26 23:19:21,628 - {'Epoch': 39, 'HR@5': '0.0942', 'NDCG@5': '0.0676', 'HR@10': '0.1263', 'NDCG@10': '0.0780', 'HR@20': '0.1667', 'NDCG@20': '0.0881'}
2025-02-26 23:19:21,629 - EarlyStopping counter: 3 out of 10
2025-02-26 23:19:43,225 - {'epoch': 40, 'rec_loss': '6.8320'}
2025-02-26 23:19:50,441 - {'Epoch': 40, 'HR@5': '0.0947', 'NDCG@5': '0.0684', 'HR@10': '0.1266', 'NDCG@10': '0.0787', 'HR@20': '0.1670', 'NDCG@20': '0.0889'}
2025-02-26 23:19:50,443 - Validation score increased.  Saving model ...
2025-02-26 23:20:12,961 - {'epoch': 41, 'rec_loss': '6.8243'}
2025-02-26 23:20:20,149 - {'Epoch': 41, 'HR@5': '0.0945', 'NDCG@5': '0.0685', 'HR@10': '0.1262', 'NDCG@10': '0.0788', 'HR@20': '0.1671', 'NDCG@20': '0.0891'}
2025-02-26 23:20:20,150 - Validation score increased.  Saving model ...
2025-02-26 23:20:42,888 - {'epoch': 42, 'rec_loss': '6.8154'}
2025-02-26 23:20:50,118 - {'Epoch': 42, 'HR@5': '0.0956', 'NDCG@5': '0.0683', 'HR@10': '0.1251', 'NDCG@10': '0.0778', 'HR@20': '0.1650', 'NDCG@20': '0.0879'}
2025-02-26 23:20:50,120 - EarlyStopping counter: 1 out of 10
2025-02-26 23:21:13,248 - {'epoch': 43, 'rec_loss': '6.8183'}
2025-02-26 23:21:20,083 - {'Epoch': 43, 'HR@5': '0.0954', 'NDCG@5': '0.0688', 'HR@10': '0.1273', 'NDCG@10': '0.0790', 'HR@20': '0.1676', 'NDCG@20': '0.0892'}
2025-02-26 23:21:20,084 - Validation score increased.  Saving model ...
2025-02-26 23:21:42,391 - {'epoch': 44, 'rec_loss': '6.8058'}
2025-02-26 23:21:49,983 - {'Epoch': 44, 'HR@5': '0.0949', 'NDCG@5': '0.0691', 'HR@10': '0.1258', 'NDCG@10': '0.0790', 'HR@20': '0.1666', 'NDCG@20': '0.0893'}
2025-02-26 23:21:49,984 - Validation score increased.  Saving model ...
2025-02-26 23:22:12,884 - {'epoch': 45, 'rec_loss': '6.7993'}
2025-02-26 23:22:20,132 - {'Epoch': 45, 'HR@5': '0.0961', 'NDCG@5': '0.0699', 'HR@10': '0.1263', 'NDCG@10': '0.0796', 'HR@20': '0.1675', 'NDCG@20': '0.0900'}
2025-02-26 23:22:20,140 - Validation score increased.  Saving model ...
2025-02-26 23:22:43,821 - {'epoch': 46, 'rec_loss': '6.7916'}
2025-02-26 23:22:51,345 - {'Epoch': 46, 'HR@5': '0.0964', 'NDCG@5': '0.0698', 'HR@10': '0.1271', 'NDCG@10': '0.0797', 'HR@20': '0.1664', 'NDCG@20': '0.0896'}
2025-02-26 23:22:51,346 - EarlyStopping counter: 1 out of 10
2025-02-26 23:23:13,945 - {'epoch': 47, 'rec_loss': '6.7842'}
2025-02-26 23:23:21,695 - {'Epoch': 47, 'HR@5': '0.0943', 'NDCG@5': '0.0682', 'HR@10': '0.1268', 'NDCG@10': '0.0787', 'HR@20': '0.1671', 'NDCG@20': '0.0889'}
2025-02-26 23:23:21,704 - EarlyStopping counter: 2 out of 10
2025-02-26 23:23:45,251 - {'epoch': 48, 'rec_loss': '6.7867'}
2025-02-26 23:23:52,521 - {'Epoch': 48, 'HR@5': '0.0932', 'NDCG@5': '0.0679', 'HR@10': '0.1280', 'NDCG@10': '0.0791', 'HR@20': '0.1661', 'NDCG@20': '0.0887'}
2025-02-26 23:23:52,523 - EarlyStopping counter: 3 out of 10
2025-02-26 23:24:15,107 - {'epoch': 49, 'rec_loss': '6.7775'}
2025-02-26 23:24:22,314 - {'Epoch': 49, 'HR@5': '0.0942', 'NDCG@5': '0.0678', 'HR@10': '0.1260', 'NDCG@10': '0.0780', 'HR@20': '0.1663', 'NDCG@20': '0.0881'}
2025-02-26 23:24:22,316 - EarlyStopping counter: 4 out of 10
2025-02-26 23:24:45,616 - {'epoch': 50, 'rec_loss': '6.7738'}
2025-02-26 23:24:53,403 - {'Epoch': 50, 'HR@5': '0.0955', 'NDCG@5': '0.0696', 'HR@10': '0.1267', 'NDCG@10': '0.0796', 'HR@20': '0.1676', 'NDCG@20': '0.0899'}
2025-02-26 23:24:53,404 - EarlyStopping counter: 5 out of 10
2025-02-26 23:25:18,874 - {'epoch': 51, 'rec_loss': '6.7702'}
2025-02-26 23:25:26,612 - {'Epoch': 51, 'HR@5': '0.0942', 'NDCG@5': '0.0680', 'HR@10': '0.1246', 'NDCG@10': '0.0777', 'HR@20': '0.1652', 'NDCG@20': '0.0880'}
2025-02-26 23:25:26,619 - EarlyStopping counter: 6 out of 10
2025-02-26 23:25:52,533 - {'epoch': 52, 'rec_loss': '6.7674'}
2025-02-26 23:26:00,485 - {'Epoch': 52, 'HR@5': '0.0951', 'NDCG@5': '0.0689', 'HR@10': '0.1257', 'NDCG@10': '0.0787', 'HR@20': '0.1646', 'NDCG@20': '0.0885'}
2025-02-26 23:26:00,493 - EarlyStopping counter: 7 out of 10
2025-02-26 23:26:25,349 - {'epoch': 53, 'rec_loss': '6.7601'}
2025-02-26 23:26:33,102 - {'Epoch': 53, 'HR@5': '0.0944', 'NDCG@5': '0.0679', 'HR@10': '0.1266', 'NDCG@10': '0.0782', 'HR@20': '0.1673', 'NDCG@20': '0.0884'}
2025-02-26 23:26:33,104 - EarlyStopping counter: 8 out of 10
2025-02-26 23:26:58,910 - {'epoch': 54, 'rec_loss': '6.7471'}
2025-02-26 23:27:07,025 - {'Epoch': 54, 'HR@5': '0.0939', 'NDCG@5': '0.0681', 'HR@10': '0.1256', 'NDCG@10': '0.0783', 'HR@20': '0.1670', 'NDCG@20': '0.0887'}
2025-02-26 23:27:07,033 - EarlyStopping counter: 9 out of 10
2025-02-26 23:27:33,933 - {'epoch': 55, 'rec_loss': '6.7439'}
2025-02-26 23:27:42,025 - {'Epoch': 55, 'HR@5': '0.0946', 'NDCG@5': '0.0685', 'HR@10': '0.1260', 'NDCG@10': '0.0786', 'HR@20': '0.1668', 'NDCG@20': '0.0888'}
2025-02-26 23:27:42,026 - EarlyStopping counter: 10 out of 10
2025-02-26 23:27:42,027 - Early stopping
2025-02-26 23:27:42,027 - ---------------Test Score---------------
2025-02-26 23:27:50,042 - {'Epoch': 0, 'HR@5': '0.0797', 'NDCG@5': '0.0577', 'HR@10': '0.1068', 'NDCG@10': '0.0665', 'HR@20': '0.1419', 'NDCG@20': '0.0753'}
2025-02-26 23:27:50,047 - Scale_Toys
2025-02-26 23:27:50,047 - {'Epoch': 0, 'HR@5': '0.0797', 'NDCG@5': '0.0577', 'HR@10': '0.1068', 'NDCG@10': '0.0665', 'HR@20': '0.1419', 'NDCG@20': '0.0753'}
2025-02-26 23:57:37,841 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[2, 4, 8], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-02-26 23:57:40,824 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-26 23:57:40,829 - Total Parameters: 918117
2025-02-26 23:58:04,097 - {'epoch': 0, 'rec_loss': '9.0957'}
2025-02-26 23:58:12,134 - {'Epoch': 0, 'HR@5': '0.0061', 'NDCG@5': '0.0040', 'HR@10': '0.0114', 'NDCG@10': '0.0058', 'HR@20': '0.0194', 'NDCG@20': '0.0078'}
2025-02-26 23:58:12,139 - Validation score increased.  Saving model ...
2025-02-26 23:58:33,444 - {'epoch': 1, 'rec_loss': '8.7075'}
2025-02-26 23:58:41,392 - {'Epoch': 1, 'HR@5': '0.0171', 'NDCG@5': '0.0121', 'HR@10': '0.0249', 'NDCG@10': '0.0146', 'HR@20': '0.0394', 'NDCG@20': '0.0182'}
2025-02-26 23:58:41,399 - Validation score increased.  Saving model ...
2025-02-26 23:59:02,882 - {'epoch': 2, 'rec_loss': '8.3988'}
2025-02-26 23:59:10,829 - {'Epoch': 2, 'HR@5': '0.0353', 'NDCG@5': '0.0253', 'HR@10': '0.0509', 'NDCG@10': '0.0303', 'HR@20': '0.0728', 'NDCG@20': '0.0358'}
2025-02-26 23:59:10,837 - Validation score increased.  Saving model ...
2025-02-26 23:59:32,020 - {'epoch': 3, 'rec_loss': '8.1180'}
2025-02-26 23:59:39,925 - {'Epoch': 3, 'HR@5': '0.0504', 'NDCG@5': '0.0355', 'HR@10': '0.0705', 'NDCG@10': '0.0419', 'HR@20': '0.1000', 'NDCG@20': '0.0493'}
2025-02-26 23:59:39,930 - Validation score increased.  Saving model ...
2025-02-27 00:00:01,113 - {'epoch': 4, 'rec_loss': '7.8923'}
2025-02-27 00:00:08,226 - {'Epoch': 4, 'HR@5': '0.0620', 'NDCG@5': '0.0446', 'HR@10': '0.0864', 'NDCG@10': '0.0524', 'HR@20': '0.1176', 'NDCG@20': '0.0603'}
2025-02-27 00:00:08,232 - Validation score increased.  Saving model ...
2025-02-27 00:00:29,732 - {'epoch': 5, 'rec_loss': '7.7273'}
2025-02-27 00:00:37,795 - {'Epoch': 5, 'HR@5': '0.0690', 'NDCG@5': '0.0491', 'HR@10': '0.0967', 'NDCG@10': '0.0580', 'HR@20': '0.1307', 'NDCG@20': '0.0666'}
2025-02-27 00:00:37,802 - Validation score increased.  Saving model ...
2025-02-27 00:00:59,492 - {'epoch': 6, 'rec_loss': '7.5957'}
2025-02-27 00:01:07,424 - {'Epoch': 6, 'HR@5': '0.0739', 'NDCG@5': '0.0536', 'HR@10': '0.1029', 'NDCG@10': '0.0629', 'HR@20': '0.1390', 'NDCG@20': '0.0720'}
2025-02-27 00:01:07,430 - Validation score increased.  Saving model ...
2025-02-27 00:01:28,959 - {'epoch': 7, 'rec_loss': '7.4981'}
2025-02-27 00:01:36,141 - {'Epoch': 7, 'HR@5': '0.0779', 'NDCG@5': '0.0565', 'HR@10': '0.1076', 'NDCG@10': '0.0661', 'HR@20': '0.1452', 'NDCG@20': '0.0755'}
2025-02-27 00:01:36,149 - Validation score increased.  Saving model ...
2025-02-27 00:01:58,026 - {'epoch': 8, 'rec_loss': '7.4135'}
2025-02-27 00:02:05,112 - {'Epoch': 8, 'HR@5': '0.0815', 'NDCG@5': '0.0589', 'HR@10': '0.1095', 'NDCG@10': '0.0680', 'HR@20': '0.1485', 'NDCG@20': '0.0778'}
2025-02-27 00:02:05,114 - Validation score increased.  Saving model ...
2025-02-27 00:02:26,846 - {'epoch': 9, 'rec_loss': '7.3525'}
2025-02-27 00:02:34,984 - {'Epoch': 9, 'HR@5': '0.0844', 'NDCG@5': '0.0609', 'HR@10': '0.1120', 'NDCG@10': '0.0698', 'HR@20': '0.1508', 'NDCG@20': '0.0796'}
2025-02-27 00:02:34,990 - Validation score increased.  Saving model ...
2025-02-27 00:02:57,180 - {'epoch': 10, 'rec_loss': '7.3060'}
2025-02-27 00:03:04,183 - {'Epoch': 10, 'HR@5': '0.0857', 'NDCG@5': '0.0619', 'HR@10': '0.1147', 'NDCG@10': '0.0712', 'HR@20': '0.1536', 'NDCG@20': '0.0810'}
2025-02-27 00:03:04,191 - Validation score increased.  Saving model ...
2025-02-27 00:03:27,088 - {'epoch': 11, 'rec_loss': '7.2556'}
2025-02-27 00:03:34,097 - {'Epoch': 11, 'HR@5': '0.0853', 'NDCG@5': '0.0622', 'HR@10': '0.1168', 'NDCG@10': '0.0724', 'HR@20': '0.1556', 'NDCG@20': '0.0822'}
2025-02-27 00:03:34,101 - Validation score increased.  Saving model ...
2025-02-27 00:03:55,682 - {'epoch': 12, 'rec_loss': '7.2174'}
2025-02-27 00:04:03,494 - {'Epoch': 12, 'HR@5': '0.0871', 'NDCG@5': '0.0638', 'HR@10': '0.1174', 'NDCG@10': '0.0736', 'HR@20': '0.1575', 'NDCG@20': '0.0837'}
2025-02-27 00:04:03,500 - Validation score increased.  Saving model ...
2025-02-27 00:04:24,787 - {'epoch': 13, 'rec_loss': '7.1832'}
2025-02-27 00:04:32,443 - {'Epoch': 13, 'HR@5': '0.0876', 'NDCG@5': '0.0632', 'HR@10': '0.1189', 'NDCG@10': '0.0733', 'HR@20': '0.1563', 'NDCG@20': '0.0827'}
2025-02-27 00:04:32,451 - EarlyStopping counter: 1 out of 10
2025-02-27 00:04:55,258 - {'epoch': 14, 'rec_loss': '7.1536'}
2025-02-27 00:05:02,691 - {'Epoch': 14, 'HR@5': '0.0878', 'NDCG@5': '0.0642', 'HR@10': '0.1191', 'NDCG@10': '0.0743', 'HR@20': '0.1578', 'NDCG@20': '0.0840'}
2025-02-27 00:05:02,698 - Validation score increased.  Saving model ...
2025-02-27 00:05:24,634 - {'epoch': 15, 'rec_loss': '7.1287'}
2025-02-27 00:05:31,697 - {'Epoch': 15, 'HR@5': '0.0871', 'NDCG@5': '0.0636', 'HR@10': '0.1198', 'NDCG@10': '0.0741', 'HR@20': '0.1580', 'NDCG@20': '0.0838'}
2025-02-27 00:05:31,701 - EarlyStopping counter: 1 out of 10
2025-02-27 00:05:53,189 - {'epoch': 16, 'rec_loss': '7.1000'}
2025-02-27 00:06:00,908 - {'Epoch': 16, 'HR@5': '0.0890', 'NDCG@5': '0.0645', 'HR@10': '0.1214', 'NDCG@10': '0.0750', 'HR@20': '0.1606', 'NDCG@20': '0.0848'}
2025-02-27 00:06:00,915 - Validation score increased.  Saving model ...
2025-02-27 00:06:23,284 - {'epoch': 17, 'rec_loss': '7.0778'}
2025-02-27 00:06:30,906 - {'Epoch': 17, 'HR@5': '0.0903', 'NDCG@5': '0.0650', 'HR@10': '0.1214', 'NDCG@10': '0.0751', 'HR@20': '0.1586', 'NDCG@20': '0.0844'}
2025-02-27 00:06:30,914 - EarlyStopping counter: 1 out of 10
2025-02-27 00:06:52,305 - {'epoch': 18, 'rec_loss': '7.0669'}
2025-02-27 00:07:00,023 - {'Epoch': 18, 'HR@5': '0.0905', 'NDCG@5': '0.0653', 'HR@10': '0.1211', 'NDCG@10': '0.0752', 'HR@20': '0.1609', 'NDCG@20': '0.0852'}
2025-02-27 00:07:00,028 - Validation score increased.  Saving model ...
2025-02-27 00:07:21,375 - {'epoch': 19, 'rec_loss': '7.0448'}
2025-02-27 00:07:29,498 - {'Epoch': 19, 'HR@5': '0.0905', 'NDCG@5': '0.0651', 'HR@10': '0.1222', 'NDCG@10': '0.0753', 'HR@20': '0.1616', 'NDCG@20': '0.0852'}
2025-02-27 00:07:29,499 - EarlyStopping counter: 1 out of 10
2025-02-27 00:07:51,322 - {'epoch': 20, 'rec_loss': '7.0278'}
2025-02-27 00:07:58,608 - {'Epoch': 20, 'HR@5': '0.0890', 'NDCG@5': '0.0649', 'HR@10': '0.1216', 'NDCG@10': '0.0753', 'HR@20': '0.1622', 'NDCG@20': '0.0856'}
2025-02-27 00:07:58,614 - Validation score increased.  Saving model ...
2025-02-27 00:08:22,137 - {'epoch': 21, 'rec_loss': '7.0099'}
2025-02-27 00:08:30,095 - {'Epoch': 21, 'HR@5': '0.0916', 'NDCG@5': '0.0662', 'HR@10': '0.1240', 'NDCG@10': '0.0766', 'HR@20': '0.1628', 'NDCG@20': '0.0864'}
2025-02-27 00:08:30,100 - Validation score increased.  Saving model ...
2025-02-27 00:08:52,693 - {'epoch': 22, 'rec_loss': '6.9960'}
2025-02-27 00:08:59,856 - {'Epoch': 22, 'HR@5': '0.0906', 'NDCG@5': '0.0662', 'HR@10': '0.1231', 'NDCG@10': '0.0766', 'HR@20': '0.1640', 'NDCG@20': '0.0869'}
2025-02-27 00:08:59,863 - Validation score increased.  Saving model ...
2025-02-27 00:09:21,544 - {'epoch': 23, 'rec_loss': '6.9869'}
2025-02-27 00:09:29,349 - {'Epoch': 23, 'HR@5': '0.0909', 'NDCG@5': '0.0664', 'HR@10': '0.1227', 'NDCG@10': '0.0766', 'HR@20': '0.1648', 'NDCG@20': '0.0873'}
2025-02-27 00:09:29,358 - Validation score increased.  Saving model ...
2025-02-27 00:09:51,490 - {'epoch': 24, 'rec_loss': '6.9666'}
2025-02-27 00:09:59,609 - {'Epoch': 24, 'HR@5': '0.0911', 'NDCG@5': '0.0658', 'HR@10': '0.1248', 'NDCG@10': '0.0767', 'HR@20': '0.1659', 'NDCG@20': '0.0871'}
2025-02-27 00:09:59,616 - EarlyStopping counter: 1 out of 10
2025-02-27 00:10:21,802 - {'epoch': 25, 'rec_loss': '6.9505'}
2025-02-27 00:10:28,802 - {'Epoch': 25, 'HR@5': '0.0905', 'NDCG@5': '0.0658', 'HR@10': '0.1238', 'NDCG@10': '0.0766', 'HR@20': '0.1634', 'NDCG@20': '0.0865'}
2025-02-27 00:10:28,809 - EarlyStopping counter: 2 out of 10
2025-02-27 00:10:50,112 - {'epoch': 26, 'rec_loss': '6.9490'}
2025-02-27 00:10:57,547 - {'Epoch': 26, 'HR@5': '0.0928', 'NDCG@5': '0.0669', 'HR@10': '0.1237', 'NDCG@10': '0.0769', 'HR@20': '0.1632', 'NDCG@20': '0.0869'}
2025-02-27 00:10:57,554 - EarlyStopping counter: 3 out of 10
2025-02-27 00:11:18,693 - {'epoch': 27, 'rec_loss': '6.9311'}
2025-02-27 00:11:26,664 - {'Epoch': 27, 'HR@5': '0.0932', 'NDCG@5': '0.0674', 'HR@10': '0.1252', 'NDCG@10': '0.0777', 'HR@20': '0.1660', 'NDCG@20': '0.0880'}
2025-02-27 00:11:26,674 - Validation score increased.  Saving model ...
2025-02-27 00:11:50,524 - {'epoch': 28, 'rec_loss': '6.9282'}
2025-02-27 00:11:57,923 - {'Epoch': 28, 'HR@5': '0.0931', 'NDCG@5': '0.0668', 'HR@10': '0.1263', 'NDCG@10': '0.0775', 'HR@20': '0.1648', 'NDCG@20': '0.0872'}
2025-02-27 00:11:57,931 - EarlyStopping counter: 1 out of 10
2025-02-27 00:12:21,125 - {'epoch': 29, 'rec_loss': '6.9117'}
2025-02-27 00:12:28,837 - {'Epoch': 29, 'HR@5': '0.0929', 'NDCG@5': '0.0672', 'HR@10': '0.1238', 'NDCG@10': '0.0771', 'HR@20': '0.1651', 'NDCG@20': '0.0875'}
2025-02-27 00:12:28,838 - EarlyStopping counter: 2 out of 10
2025-02-27 00:12:50,301 - {'epoch': 30, 'rec_loss': '6.9062'}
2025-02-27 00:12:57,401 - {'Epoch': 30, 'HR@5': '0.0923', 'NDCG@5': '0.0671', 'HR@10': '0.1246', 'NDCG@10': '0.0775', 'HR@20': '0.1659', 'NDCG@20': '0.0878'}
2025-02-27 00:12:57,408 - EarlyStopping counter: 3 out of 10
2025-02-27 00:13:18,998 - {'epoch': 31, 'rec_loss': '6.8943'}
2025-02-27 00:13:26,456 - {'Epoch': 31, 'HR@5': '0.0929', 'NDCG@5': '0.0674', 'HR@10': '0.1248', 'NDCG@10': '0.0777', 'HR@20': '0.1652', 'NDCG@20': '0.0878'}
2025-02-27 00:13:26,464 - EarlyStopping counter: 4 out of 10
2025-02-27 00:13:47,577 - {'epoch': 32, 'rec_loss': '6.8846'}
2025-02-27 00:13:55,155 - {'Epoch': 32, 'HR@5': '0.0913', 'NDCG@5': '0.0669', 'HR@10': '0.1255', 'NDCG@10': '0.0780', 'HR@20': '0.1670', 'NDCG@20': '0.0884'}
2025-02-27 00:13:55,161 - Validation score increased.  Saving model ...
2025-02-27 00:14:18,801 - {'epoch': 33, 'rec_loss': '6.8738'}
2025-02-27 00:14:26,120 - {'Epoch': 33, 'HR@5': '0.0923', 'NDCG@5': '0.0672', 'HR@10': '0.1249', 'NDCG@10': '0.0777', 'HR@20': '0.1656', 'NDCG@20': '0.0880'}
2025-02-27 00:14:26,129 - EarlyStopping counter: 1 out of 10
2025-02-27 00:14:47,401 - {'epoch': 34, 'rec_loss': '6.8594'}
2025-02-27 00:14:55,190 - {'Epoch': 34, 'HR@5': '0.0928', 'NDCG@5': '0.0676', 'HR@10': '0.1260', 'NDCG@10': '0.0783', 'HR@20': '0.1671', 'NDCG@20': '0.0886'}
2025-02-27 00:14:55,197 - Validation score increased.  Saving model ...
2025-02-27 00:15:16,437 - {'epoch': 35, 'rec_loss': '6.8575'}
2025-02-27 00:15:24,488 - {'Epoch': 35, 'HR@5': '0.0926', 'NDCG@5': '0.0676', 'HR@10': '0.1278', 'NDCG@10': '0.0790', 'HR@20': '0.1671', 'NDCG@20': '0.0889'}
2025-02-27 00:15:24,494 - Validation score increased.  Saving model ...
2025-02-27 00:15:46,342 - {'epoch': 36, 'rec_loss': '6.8522'}
2025-02-27 00:15:54,298 - {'Epoch': 36, 'HR@5': '0.0937', 'NDCG@5': '0.0681', 'HR@10': '0.1264', 'NDCG@10': '0.0787', 'HR@20': '0.1668', 'NDCG@20': '0.0889'}
2025-02-27 00:15:54,307 - EarlyStopping counter: 1 out of 10
2025-02-27 00:16:16,042 - {'epoch': 37, 'rec_loss': '6.8375'}
2025-02-27 00:16:23,690 - {'Epoch': 37, 'HR@5': '0.0919', 'NDCG@5': '0.0667', 'HR@10': '0.1269', 'NDCG@10': '0.0780', 'HR@20': '0.1670', 'NDCG@20': '0.0881'}
2025-02-27 00:16:23,698 - EarlyStopping counter: 2 out of 10
2025-02-27 00:16:45,704 - {'epoch': 38, 'rec_loss': '6.8307'}
2025-02-27 00:16:53,255 - {'Epoch': 38, 'HR@5': '0.0925', 'NDCG@5': '0.0668', 'HR@10': '0.1268', 'NDCG@10': '0.0779', 'HR@20': '0.1658', 'NDCG@20': '0.0877'}
2025-02-27 00:16:53,263 - EarlyStopping counter: 3 out of 10
2025-02-27 00:17:16,191 - {'epoch': 39, 'rec_loss': '6.8301'}
2025-02-27 00:17:23,413 - {'Epoch': 39, 'HR@5': '0.0942', 'NDCG@5': '0.0681', 'HR@10': '0.1271', 'NDCG@10': '0.0787', 'HR@20': '0.1678', 'NDCG@20': '0.0890'}
2025-02-27 00:17:23,421 - Validation score increased.  Saving model ...
2025-02-27 00:17:45,047 - {'epoch': 40, 'rec_loss': '6.8173'}
2025-02-27 00:17:51,985 - {'Epoch': 40, 'HR@5': '0.0944', 'NDCG@5': '0.0686', 'HR@10': '0.1285', 'NDCG@10': '0.0796', 'HR@20': '0.1672', 'NDCG@20': '0.0893'}
2025-02-27 00:17:51,992 - Validation score increased.  Saving model ...
2025-02-27 00:18:13,898 - {'epoch': 41, 'rec_loss': '6.8160'}
2025-02-27 00:18:20,866 - {'Epoch': 41, 'HR@5': '0.0936', 'NDCG@5': '0.0676', 'HR@10': '0.1265', 'NDCG@10': '0.0782', 'HR@20': '0.1665', 'NDCG@20': '0.0882'}
2025-02-27 00:18:20,874 - EarlyStopping counter: 1 out of 10
2025-02-27 00:18:42,038 - {'epoch': 42, 'rec_loss': '6.8111'}
2025-02-27 00:18:49,943 - {'Epoch': 42, 'HR@5': '0.0937', 'NDCG@5': '0.0678', 'HR@10': '0.1246', 'NDCG@10': '0.0778', 'HR@20': '0.1651', 'NDCG@20': '0.0880'}
2025-02-27 00:18:49,950 - EarlyStopping counter: 2 out of 10
2025-02-27 00:19:11,237 - {'epoch': 43, 'rec_loss': '6.8013'}
2025-02-27 00:19:19,014 - {'Epoch': 43, 'HR@5': '0.0942', 'NDCG@5': '0.0683', 'HR@10': '0.1275', 'NDCG@10': '0.0789', 'HR@20': '0.1671', 'NDCG@20': '0.0889'}
2025-02-27 00:19:19,021 - EarlyStopping counter: 3 out of 10
2025-02-27 00:19:40,152 - {'epoch': 44, 'rec_loss': '6.7950'}
2025-02-27 00:19:47,815 - {'Epoch': 44, 'HR@5': '0.0940', 'NDCG@5': '0.0676', 'HR@10': '0.1274', 'NDCG@10': '0.0783', 'HR@20': '0.1664', 'NDCG@20': '0.0882'}
2025-02-27 00:19:47,823 - EarlyStopping counter: 4 out of 10
2025-02-27 00:20:08,939 - {'epoch': 45, 'rec_loss': '6.7888'}
2025-02-27 00:20:16,933 - {'Epoch': 45, 'HR@5': '0.0942', 'NDCG@5': '0.0681', 'HR@10': '0.1274', 'NDCG@10': '0.0787', 'HR@20': '0.1682', 'NDCG@20': '0.0890'}
2025-02-27 00:20:16,940 - EarlyStopping counter: 5 out of 10
2025-02-27 00:20:38,850 - {'epoch': 46, 'rec_loss': '6.7881'}
2025-02-27 00:20:46,663 - {'Epoch': 46, 'HR@5': '0.0933', 'NDCG@5': '0.0675', 'HR@10': '0.1261', 'NDCG@10': '0.0780', 'HR@20': '0.1655', 'NDCG@20': '0.0880'}
2025-02-27 00:20:46,664 - EarlyStopping counter: 6 out of 10
2025-02-27 00:21:09,912 - {'epoch': 47, 'rec_loss': '6.7803'}
2025-02-27 00:21:17,667 - {'Epoch': 47, 'HR@5': '0.0926', 'NDCG@5': '0.0671', 'HR@10': '0.1270', 'NDCG@10': '0.0782', 'HR@20': '0.1691', 'NDCG@20': '0.0888'}
2025-02-27 00:21:17,675 - EarlyStopping counter: 7 out of 10
2025-02-27 00:21:40,798 - {'epoch': 48, 'rec_loss': '6.7656'}
2025-02-27 00:21:48,684 - {'Epoch': 48, 'HR@5': '0.0938', 'NDCG@5': '0.0680', 'HR@10': '0.1261', 'NDCG@10': '0.0785', 'HR@20': '0.1677', 'NDCG@20': '0.0889'}
2025-02-27 00:21:48,692 - EarlyStopping counter: 8 out of 10
2025-02-27 00:22:10,245 - {'epoch': 49, 'rec_loss': '6.7608'}
2025-02-27 00:22:17,331 - {'Epoch': 49, 'HR@5': '0.0938', 'NDCG@5': '0.0678', 'HR@10': '0.1262', 'NDCG@10': '0.0783', 'HR@20': '0.1677', 'NDCG@20': '0.0887'}
2025-02-27 00:22:17,337 - EarlyStopping counter: 9 out of 10
2025-02-27 00:22:39,132 - {'epoch': 50, 'rec_loss': '6.7666'}
2025-02-27 00:22:46,955 - {'Epoch': 50, 'HR@5': '0.0930', 'NDCG@5': '0.0674', 'HR@10': '0.1263', 'NDCG@10': '0.0782', 'HR@20': '0.1676', 'NDCG@20': '0.0886'}
2025-02-27 00:22:46,962 - EarlyStopping counter: 10 out of 10
2025-02-27 00:22:46,962 - Early stopping
2025-02-27 00:22:46,962 - ---------------Test Score---------------
2025-02-27 00:22:54,068 - {'Epoch': 0, 'HR@5': '0.0795', 'NDCG@5': '0.0576', 'HR@10': '0.1078', 'NDCG@10': '0.0667', 'HR@20': '0.1428', 'NDCG@20': '0.0754'}
2025-02-27 00:22:54,074 - Scale_Toys
2025-02-27 00:22:54,075 - {'Epoch': 0, 'HR@5': '0.0795', 'NDCG@5': '0.0576', 'HR@10': '0.1078', 'NDCG@10': '0.0667', 'HR@20': '0.1428', 'NDCG@20': '0.0754'}
2025-02-27 09:48:34,897 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[2, 4, 8, 12], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-02-27 09:48:37,816 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=4, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=4, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-27 09:48:37,821 - Total Parameters: 918121
2025-02-27 09:49:02,123 - {'epoch': 0, 'rec_loss': '9.0849'}
2025-02-27 09:49:09,472 - {'Epoch': 0, 'HR@5': '0.0076', 'NDCG@5': '0.0047', 'HR@10': '0.0126', 'NDCG@10': '0.0063', 'HR@20': '0.0216', 'NDCG@20': '0.0085'}
2025-02-27 09:49:09,475 - Validation score increased.  Saving model ...
2025-02-27 09:49:34,432 - {'epoch': 1, 'rec_loss': '8.6804'}
2025-02-27 09:49:42,659 - {'Epoch': 1, 'HR@5': '0.0169', 'NDCG@5': '0.0121', 'HR@10': '0.0269', 'NDCG@10': '0.0153', 'HR@20': '0.0413', 'NDCG@20': '0.0189'}
2025-02-27 09:49:42,660 - Validation score increased.  Saving model ...
2025-02-27 09:50:06,502 - {'epoch': 2, 'rec_loss': '8.3818'}
2025-02-27 09:50:13,716 - {'Epoch': 2, 'HR@5': '0.0360', 'NDCG@5': '0.0253', 'HR@10': '0.0529', 'NDCG@10': '0.0307', 'HR@20': '0.0752', 'NDCG@20': '0.0363'}
2025-02-27 09:50:13,722 - Validation score increased.  Saving model ...
2025-02-27 09:50:38,076 - {'epoch': 3, 'rec_loss': '8.1056'}
2025-02-27 09:50:46,428 - {'Epoch': 3, 'HR@5': '0.0502', 'NDCG@5': '0.0353', 'HR@10': '0.0700', 'NDCG@10': '0.0416', 'HR@20': '0.0980', 'NDCG@20': '0.0487'}
2025-02-27 09:50:46,429 - Validation score increased.  Saving model ...
2025-02-27 09:51:09,760 - {'epoch': 4, 'rec_loss': '7.8862'}
2025-02-27 09:51:17,562 - {'Epoch': 4, 'HR@5': '0.0607', 'NDCG@5': '0.0439', 'HR@10': '0.0869', 'NDCG@10': '0.0524', 'HR@20': '0.1183', 'NDCG@20': '0.0603'}
2025-02-27 09:51:17,563 - Validation score increased.  Saving model ...
2025-02-27 09:51:41,706 - {'epoch': 5, 'rec_loss': '7.7219'}
2025-02-27 09:51:49,023 - {'Epoch': 5, 'HR@5': '0.0696', 'NDCG@5': '0.0497', 'HR@10': '0.0952', 'NDCG@10': '0.0580', 'HR@20': '0.1293', 'NDCG@20': '0.0666'}
2025-02-27 09:51:49,029 - Validation score increased.  Saving model ...
2025-02-27 09:52:13,369 - {'epoch': 6, 'rec_loss': '7.5971'}
2025-02-27 09:52:20,853 - {'Epoch': 6, 'HR@5': '0.0768', 'NDCG@5': '0.0552', 'HR@10': '0.1033', 'NDCG@10': '0.0637', 'HR@20': '0.1407', 'NDCG@20': '0.0731'}
2025-02-27 09:52:20,854 - Validation score increased.  Saving model ...
2025-02-27 09:52:44,882 - {'epoch': 7, 'rec_loss': '7.4989'}
2025-02-27 09:52:51,989 - {'Epoch': 7, 'HR@5': '0.0788', 'NDCG@5': '0.0565', 'HR@10': '0.1082', 'NDCG@10': '0.0660', 'HR@20': '0.1439', 'NDCG@20': '0.0750'}
2025-02-27 09:52:51,996 - Validation score increased.  Saving model ...
2025-02-27 09:53:15,156 - {'epoch': 8, 'rec_loss': '7.4199'}
2025-02-27 09:53:22,545 - {'Epoch': 8, 'HR@5': '0.0823', 'NDCG@5': '0.0594', 'HR@10': '0.1110', 'NDCG@10': '0.0687', 'HR@20': '0.1478', 'NDCG@20': '0.0780'}
2025-02-27 09:53:22,551 - Validation score increased.  Saving model ...
2025-02-27 09:53:46,072 - {'epoch': 9, 'rec_loss': '7.3527'}
2025-02-27 09:53:53,826 - {'Epoch': 9, 'HR@5': '0.0857', 'NDCG@5': '0.0611', 'HR@10': '0.1155', 'NDCG@10': '0.0706', 'HR@20': '0.1516', 'NDCG@20': '0.0797'}
2025-02-27 09:53:53,831 - Validation score increased.  Saving model ...
2025-02-27 09:54:17,429 - {'epoch': 10, 'rec_loss': '7.3043'}
2025-02-27 09:54:25,614 - {'Epoch': 10, 'HR@5': '0.0846', 'NDCG@5': '0.0614', 'HR@10': '0.1161', 'NDCG@10': '0.0716', 'HR@20': '0.1542', 'NDCG@20': '0.0811'}
2025-02-27 09:54:25,615 - Validation score increased.  Saving model ...
2025-02-27 09:54:47,927 - {'epoch': 11, 'rec_loss': '7.2591'}
2025-02-27 09:54:55,880 - {'Epoch': 11, 'HR@5': '0.0869', 'NDCG@5': '0.0623', 'HR@10': '0.1185', 'NDCG@10': '0.0724', 'HR@20': '0.1572', 'NDCG@20': '0.0822'}
2025-02-27 09:54:55,881 - Validation score increased.  Saving model ...
2025-02-27 09:55:19,259 - {'epoch': 12, 'rec_loss': '7.2197'}
2025-02-27 09:55:26,386 - {'Epoch': 12, 'HR@5': '0.0878', 'NDCG@5': '0.0629', 'HR@10': '0.1200', 'NDCG@10': '0.0733', 'HR@20': '0.1573', 'NDCG@20': '0.0827'}
2025-02-27 09:55:26,393 - Validation score increased.  Saving model ...
2025-02-27 09:55:49,651 - {'epoch': 13, 'rec_loss': '7.1868'}
2025-02-27 09:55:57,350 - {'Epoch': 13, 'HR@5': '0.0883', 'NDCG@5': '0.0633', 'HR@10': '0.1204', 'NDCG@10': '0.0736', 'HR@20': '0.1591', 'NDCG@20': '0.0834'}
2025-02-27 09:55:57,358 - Validation score increased.  Saving model ...
2025-02-27 09:56:21,270 - {'epoch': 14, 'rec_loss': '7.1601'}
2025-02-27 09:56:28,581 - {'Epoch': 14, 'HR@5': '0.0899', 'NDCG@5': '0.0648', 'HR@10': '0.1215', 'NDCG@10': '0.0750', 'HR@20': '0.1612', 'NDCG@20': '0.0850'}
2025-02-27 09:56:28,588 - Validation score increased.  Saving model ...
2025-02-27 09:56:51,970 - {'epoch': 15, 'rec_loss': '7.1317'}
2025-02-27 09:56:59,166 - {'Epoch': 15, 'HR@5': '0.0905', 'NDCG@5': '0.0646', 'HR@10': '0.1230', 'NDCG@10': '0.0751', 'HR@20': '0.1609', 'NDCG@20': '0.0846'}
2025-02-27 09:56:59,172 - EarlyStopping counter: 1 out of 10
2025-02-27 09:57:23,429 - {'epoch': 16, 'rec_loss': '7.1064'}
2025-02-27 09:57:30,549 - {'Epoch': 16, 'HR@5': '0.0899', 'NDCG@5': '0.0649', 'HR@10': '0.1228', 'NDCG@10': '0.0756', 'HR@20': '0.1624', 'NDCG@20': '0.0856'}
2025-02-27 09:57:30,550 - Validation score increased.  Saving model ...
2025-02-27 09:57:53,943 - {'epoch': 17, 'rec_loss': '7.0809'}
2025-02-27 09:58:00,996 - {'Epoch': 17, 'HR@5': '0.0904', 'NDCG@5': '0.0652', 'HR@10': '0.1244', 'NDCG@10': '0.0761', 'HR@20': '0.1628', 'NDCG@20': '0.0858'}
2025-02-27 09:58:01,002 - Validation score increased.  Saving model ...
2025-02-27 09:58:23,851 - {'epoch': 18, 'rec_loss': '7.0641'}
2025-02-27 09:58:31,410 - {'Epoch': 18, 'HR@5': '0.0906', 'NDCG@5': '0.0652', 'HR@10': '0.1234', 'NDCG@10': '0.0758', 'HR@20': '0.1644', 'NDCG@20': '0.0861'}
2025-02-27 09:58:31,411 - Validation score increased.  Saving model ...
2025-02-27 09:58:55,623 - {'epoch': 19, 'rec_loss': '7.0474'}
2025-02-27 09:59:02,690 - {'Epoch': 19, 'HR@5': '0.0916', 'NDCG@5': '0.0659', 'HR@10': '0.1248', 'NDCG@10': '0.0766', 'HR@20': '0.1622', 'NDCG@20': '0.0860'}
2025-02-27 09:59:02,696 - EarlyStopping counter: 1 out of 10
2025-02-27 09:59:26,837 - {'epoch': 20, 'rec_loss': '7.0254'}
2025-02-27 09:59:33,917 - {'Epoch': 20, 'HR@5': '0.0906', 'NDCG@5': '0.0655', 'HR@10': '0.1228', 'NDCG@10': '0.0759', 'HR@20': '0.1641', 'NDCG@20': '0.0863'}
2025-02-27 09:59:33,918 - Validation score increased.  Saving model ...
2025-02-27 09:59:57,521 - {'epoch': 21, 'rec_loss': '7.0102'}
2025-02-27 10:00:05,081 - {'Epoch': 21, 'HR@5': '0.0931', 'NDCG@5': '0.0667', 'HR@10': '0.1245', 'NDCG@10': '0.0768', 'HR@20': '0.1644', 'NDCG@20': '0.0869'}
2025-02-27 10:00:05,082 - Validation score increased.  Saving model ...
2025-02-27 10:00:28,323 - {'epoch': 22, 'rec_loss': '6.9929'}
2025-02-27 10:00:36,046 - {'Epoch': 22, 'HR@5': '0.0938', 'NDCG@5': '0.0671', 'HR@10': '0.1254', 'NDCG@10': '0.0773', 'HR@20': '0.1654', 'NDCG@20': '0.0873'}
2025-02-27 10:00:36,052 - Validation score increased.  Saving model ...
2025-02-27 10:00:59,665 - {'epoch': 23, 'rec_loss': '6.9876'}
2025-02-27 10:01:06,792 - {'Epoch': 23, 'HR@5': '0.0932', 'NDCG@5': '0.0670', 'HR@10': '0.1264', 'NDCG@10': '0.0776', 'HR@20': '0.1656', 'NDCG@20': '0.0875'}
2025-02-27 10:01:06,793 - Validation score increased.  Saving model ...
2025-02-27 10:01:30,700 - {'epoch': 24, 'rec_loss': '6.9578'}
2025-02-27 10:01:37,886 - {'Epoch': 24, 'HR@5': '0.0912', 'NDCG@5': '0.0658', 'HR@10': '0.1243', 'NDCG@10': '0.0765', 'HR@20': '0.1641', 'NDCG@20': '0.0865'}
2025-02-27 10:01:37,892 - EarlyStopping counter: 1 out of 10
2025-02-27 10:02:01,772 - {'epoch': 25, 'rec_loss': '6.9519'}
2025-02-27 10:02:09,037 - {'Epoch': 25, 'HR@5': '0.0931', 'NDCG@5': '0.0670', 'HR@10': '0.1255', 'NDCG@10': '0.0774', 'HR@20': '0.1648', 'NDCG@20': '0.0873'}
2025-02-27 10:02:09,044 - EarlyStopping counter: 2 out of 10
2025-02-27 10:02:32,952 - {'epoch': 26, 'rec_loss': '6.9455'}
2025-02-27 10:02:40,841 - {'Epoch': 26, 'HR@5': '0.0923', 'NDCG@5': '0.0664', 'HR@10': '0.1255', 'NDCG@10': '0.0771', 'HR@20': '0.1647', 'NDCG@20': '0.0870'}
2025-02-27 10:02:40,847 - EarlyStopping counter: 3 out of 10
2025-02-27 10:03:04,372 - {'epoch': 27, 'rec_loss': '6.9300'}
2025-02-27 10:03:11,900 - {'Epoch': 27, 'HR@5': '0.0934', 'NDCG@5': '0.0674', 'HR@10': '0.1256', 'NDCG@10': '0.0778', 'HR@20': '0.1663', 'NDCG@20': '0.0880'}
2025-02-27 10:03:11,901 - Validation score increased.  Saving model ...
2025-02-27 10:03:36,200 - {'epoch': 28, 'rec_loss': '6.9222'}
2025-02-27 10:03:43,568 - {'Epoch': 28, 'HR@5': '0.0945', 'NDCG@5': '0.0676', 'HR@10': '0.1273', 'NDCG@10': '0.0782', 'HR@20': '0.1658', 'NDCG@20': '0.0878'}
2025-02-27 10:03:43,569 - EarlyStopping counter: 1 out of 10
2025-02-27 10:04:07,212 - {'epoch': 29, 'rec_loss': '6.9077'}
2025-02-27 10:04:15,584 - {'Epoch': 29, 'HR@5': '0.0955', 'NDCG@5': '0.0688', 'HR@10': '0.1279', 'NDCG@10': '0.0792', 'HR@20': '0.1664', 'NDCG@20': '0.0890'}
2025-02-27 10:04:15,585 - Validation score increased.  Saving model ...
2025-02-27 10:04:39,493 - {'epoch': 30, 'rec_loss': '6.9038'}
2025-02-27 10:04:47,288 - {'Epoch': 30, 'HR@5': '0.0954', 'NDCG@5': '0.0682', 'HR@10': '0.1280', 'NDCG@10': '0.0787', 'HR@20': '0.1672', 'NDCG@20': '0.0886'}
2025-02-27 10:04:47,294 - EarlyStopping counter: 1 out of 10
2025-02-27 10:05:10,367 - {'epoch': 31, 'rec_loss': '6.8911'}
2025-02-27 10:05:17,959 - {'Epoch': 31, 'HR@5': '0.0942', 'NDCG@5': '0.0676', 'HR@10': '0.1269', 'NDCG@10': '0.0781', 'HR@20': '0.1677', 'NDCG@20': '0.0884'}
2025-02-27 10:05:17,961 - EarlyStopping counter: 2 out of 10
2025-02-27 10:05:40,867 - {'epoch': 32, 'rec_loss': '6.8890'}
2025-02-27 10:05:49,105 - {'Epoch': 32, 'HR@5': '0.0945', 'NDCG@5': '0.0681', 'HR@10': '0.1258', 'NDCG@10': '0.0782', 'HR@20': '0.1672', 'NDCG@20': '0.0887'}
2025-02-27 10:05:49,112 - EarlyStopping counter: 3 out of 10
2025-02-27 10:06:12,890 - {'epoch': 33, 'rec_loss': '6.8696'}
2025-02-27 10:06:19,988 - {'Epoch': 33, 'HR@5': '0.0949', 'NDCG@5': '0.0687', 'HR@10': '0.1265', 'NDCG@10': '0.0789', 'HR@20': '0.1669', 'NDCG@20': '0.0890'}
2025-02-27 10:06:19,989 - Validation score increased.  Saving model ...
2025-02-27 10:06:44,466 - {'epoch': 34, 'rec_loss': '6.8654'}
2025-02-27 10:06:51,907 - {'Epoch': 34, 'HR@5': '0.0946', 'NDCG@5': '0.0683', 'HR@10': '0.1263', 'NDCG@10': '0.0786', 'HR@20': '0.1677', 'NDCG@20': '0.0890'}
2025-02-27 10:06:51,915 - Validation score increased.  Saving model ...
2025-02-27 10:07:15,312 - {'epoch': 35, 'rec_loss': '6.8572'}
2025-02-27 10:07:22,954 - {'Epoch': 35, 'HR@5': '0.0941', 'NDCG@5': '0.0684', 'HR@10': '0.1270', 'NDCG@10': '0.0790', 'HR@20': '0.1671', 'NDCG@20': '0.0891'}
2025-02-27 10:07:22,955 - Validation score increased.  Saving model ...
2025-02-27 10:07:46,356 - {'epoch': 36, 'rec_loss': '6.8535'}
2025-02-27 10:07:53,646 - {'Epoch': 36, 'HR@5': '0.0941', 'NDCG@5': '0.0677', 'HR@10': '0.1283', 'NDCG@10': '0.0787', 'HR@20': '0.1679', 'NDCG@20': '0.0887'}
2025-02-27 10:07:53,653 - EarlyStopping counter: 1 out of 10
2025-02-27 10:08:17,591 - {'epoch': 37, 'rec_loss': '6.8397'}
2025-02-27 10:08:24,587 - {'Epoch': 37, 'HR@5': '0.0939', 'NDCG@5': '0.0682', 'HR@10': '0.1286', 'NDCG@10': '0.0793', 'HR@20': '0.1676', 'NDCG@20': '0.0892'}
2025-02-27 10:08:24,588 - Validation score increased.  Saving model ...
2025-02-27 10:08:47,980 - {'epoch': 38, 'rec_loss': '6.8367'}
2025-02-27 10:08:55,209 - {'Epoch': 38, 'HR@5': '0.0950', 'NDCG@5': '0.0690', 'HR@10': '0.1286', 'NDCG@10': '0.0798', 'HR@20': '0.1681', 'NDCG@20': '0.0898'}
2025-02-27 10:08:55,216 - Validation score increased.  Saving model ...
2025-02-27 10:09:19,863 - {'epoch': 39, 'rec_loss': '6.8352'}
2025-02-27 10:09:27,038 - {'Epoch': 39, 'HR@5': '0.0947', 'NDCG@5': '0.0687', 'HR@10': '0.1291', 'NDCG@10': '0.0798', 'HR@20': '0.1685', 'NDCG@20': '0.0897'}
2025-02-27 10:09:27,039 - EarlyStopping counter: 1 out of 10
2025-02-27 10:09:50,151 - {'epoch': 40, 'rec_loss': '6.8272'}
2025-02-27 10:09:57,266 - {'Epoch': 40, 'HR@5': '0.0973', 'NDCG@5': '0.0697', 'HR@10': '0.1301', 'NDCG@10': '0.0802', 'HR@20': '0.1682', 'NDCG@20': '0.0898'}
2025-02-27 10:09:57,268 - Validation score increased.  Saving model ...
2025-02-27 10:10:20,284 - {'epoch': 41, 'rec_loss': '6.8240'}
2025-02-27 10:10:27,366 - {'Epoch': 41, 'HR@5': '0.0962', 'NDCG@5': '0.0689', 'HR@10': '0.1281', 'NDCG@10': '0.0792', 'HR@20': '0.1677', 'NDCG@20': '0.0891'}
2025-02-27 10:10:27,368 - EarlyStopping counter: 1 out of 10
2025-02-27 10:10:51,589 - {'epoch': 42, 'rec_loss': '6.8110'}
2025-02-27 10:10:58,697 - {'Epoch': 42, 'HR@5': '0.0944', 'NDCG@5': '0.0685', 'HR@10': '0.1292', 'NDCG@10': '0.0797', 'HR@20': '0.1687', 'NDCG@20': '0.0897'}
2025-02-27 10:10:58,704 - EarlyStopping counter: 2 out of 10
2025-02-27 10:11:21,615 - {'epoch': 43, 'rec_loss': '6.8111'}
2025-02-27 10:11:28,833 - {'Epoch': 43, 'HR@5': '0.0963', 'NDCG@5': '0.0694', 'HR@10': '0.1282', 'NDCG@10': '0.0797', 'HR@20': '0.1680', 'NDCG@20': '0.0898'}
2025-02-27 10:11:28,842 - EarlyStopping counter: 3 out of 10
2025-02-27 10:11:52,185 - {'epoch': 44, 'rec_loss': '6.8065'}
2025-02-27 10:11:59,691 - {'Epoch': 44, 'HR@5': '0.0961', 'NDCG@5': '0.0689', 'HR@10': '0.1281', 'NDCG@10': '0.0793', 'HR@20': '0.1688', 'NDCG@20': '0.0895'}
2025-02-27 10:11:59,692 - EarlyStopping counter: 4 out of 10
2025-02-27 10:12:22,433 - {'epoch': 45, 'rec_loss': '6.8023'}
2025-02-27 10:12:29,629 - {'Epoch': 45, 'HR@5': '0.0973', 'NDCG@5': '0.0690', 'HR@10': '0.1298', 'NDCG@10': '0.0795', 'HR@20': '0.1683', 'NDCG@20': '0.0892'}
2025-02-27 10:12:29,634 - EarlyStopping counter: 5 out of 10
2025-02-27 10:12:53,359 - {'epoch': 46, 'rec_loss': '6.7909'}
2025-02-27 10:13:01,034 - {'Epoch': 46, 'HR@5': '0.0975', 'NDCG@5': '0.0695', 'HR@10': '0.1289', 'NDCG@10': '0.0796', 'HR@20': '0.1675', 'NDCG@20': '0.0894'}
2025-02-27 10:13:01,035 - EarlyStopping counter: 6 out of 10
2025-02-27 10:13:24,136 - {'epoch': 47, 'rec_loss': '6.7802'}
2025-02-27 10:13:31,294 - {'Epoch': 47, 'HR@5': '0.0966', 'NDCG@5': '0.0688', 'HR@10': '0.1282', 'NDCG@10': '0.0790', 'HR@20': '0.1674', 'NDCG@20': '0.0888'}
2025-02-27 10:13:31,301 - EarlyStopping counter: 7 out of 10
2025-02-27 10:13:55,166 - {'epoch': 48, 'rec_loss': '6.7729'}
2025-02-27 10:14:02,266 - {'Epoch': 48, 'HR@5': '0.0965', 'NDCG@5': '0.0693', 'HR@10': '0.1284', 'NDCG@10': '0.0797', 'HR@20': '0.1668', 'NDCG@20': '0.0893'}
2025-02-27 10:14:02,267 - EarlyStopping counter: 8 out of 10
2025-02-27 10:14:27,031 - {'epoch': 49, 'rec_loss': '6.7705'}
2025-02-27 10:14:34,204 - {'Epoch': 49, 'HR@5': '0.0963', 'NDCG@5': '0.0687', 'HR@10': '0.1277', 'NDCG@10': '0.0788', 'HR@20': '0.1675', 'NDCG@20': '0.0888'}
2025-02-27 10:14:34,211 - EarlyStopping counter: 9 out of 10
2025-02-27 10:14:57,973 - {'epoch': 50, 'rec_loss': '6.7635'}
2025-02-27 10:15:06,189 - {'Epoch': 50, 'HR@5': '0.0965', 'NDCG@5': '0.0689', 'HR@10': '0.1303', 'NDCG@10': '0.0798', 'HR@20': '0.1686', 'NDCG@20': '0.0894'}
2025-02-27 10:15:06,191 - EarlyStopping counter: 10 out of 10
2025-02-27 10:15:06,191 - Early stopping
2025-02-27 10:15:06,191 - ---------------Test Score---------------
2025-02-27 10:15:13,211 - {'Epoch': 0, 'HR@5': '0.0801', 'NDCG@5': '0.0578', 'HR@10': '0.1060', 'NDCG@10': '0.0661', 'HR@20': '0.1432', 'NDCG@20': '0.0754'}
2025-02-27 10:15:13,212 - Scale_Toys
2025-02-27 10:15:13,212 - {'Epoch': 0, 'HR@5': '0.0801', 'NDCG@5': '0.0578', 'HR@10': '0.1060', 'NDCG@10': '0.0661', 'HR@20': '0.1432', 'NDCG@20': '0.0754'}
2025-02-27 10:24:10,120 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 16], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-02-27 10:24:13,074 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-27 10:24:13,078 - Total Parameters: 918117
2025-02-27 10:24:37,640 - {'epoch': 0, 'rec_loss': '9.0955'}
2025-02-27 10:24:44,905 - {'Epoch': 0, 'HR@5': '0.0064', 'NDCG@5': '0.0039', 'HR@10': '0.0112', 'NDCG@10': '0.0055', 'HR@20': '0.0196', 'NDCG@20': '0.0076'}
2025-02-27 10:24:44,910 - Validation score increased.  Saving model ...
2025-02-27 10:25:09,378 - {'epoch': 1, 'rec_loss': '8.7066'}
2025-02-27 10:25:16,867 - {'Epoch': 1, 'HR@5': '0.0173', 'NDCG@5': '0.0121', 'HR@10': '0.0245', 'NDCG@10': '0.0144', 'HR@20': '0.0387', 'NDCG@20': '0.0180'}
2025-02-27 10:25:16,875 - Validation score increased.  Saving model ...
2025-02-27 10:25:40,726 - {'epoch': 2, 'rec_loss': '8.4036'}
2025-02-27 10:25:48,705 - {'Epoch': 2, 'HR@5': '0.0351', 'NDCG@5': '0.0255', 'HR@10': '0.0509', 'NDCG@10': '0.0305', 'HR@20': '0.0730', 'NDCG@20': '0.0361'}
2025-02-27 10:25:48,712 - Validation score increased.  Saving model ...
2025-02-27 10:26:11,920 - {'epoch': 3, 'rec_loss': '8.1234'}
2025-02-27 10:26:19,490 - {'Epoch': 3, 'HR@5': '0.0498', 'NDCG@5': '0.0353', 'HR@10': '0.0706', 'NDCG@10': '0.0420', 'HR@20': '0.1010', 'NDCG@20': '0.0496'}
2025-02-27 10:26:19,499 - Validation score increased.  Saving model ...
2025-02-27 10:26:42,548 - {'epoch': 4, 'rec_loss': '7.8971'}
2025-02-27 10:26:50,325 - {'Epoch': 4, 'HR@5': '0.0624', 'NDCG@5': '0.0446', 'HR@10': '0.0868', 'NDCG@10': '0.0524', 'HR@20': '0.1181', 'NDCG@20': '0.0602'}
2025-02-27 10:26:50,332 - Validation score increased.  Saving model ...
2025-02-27 10:27:12,837 - {'epoch': 5, 'rec_loss': '7.7314'}
2025-02-27 10:27:20,144 - {'Epoch': 5, 'HR@5': '0.0696', 'NDCG@5': '0.0495', 'HR@10': '0.0969', 'NDCG@10': '0.0583', 'HR@20': '0.1311', 'NDCG@20': '0.0669'}
2025-02-27 10:27:20,150 - Validation score increased.  Saving model ...
2025-02-27 10:27:43,109 - {'epoch': 6, 'rec_loss': '7.5999'}
2025-02-27 10:27:50,330 - {'Epoch': 6, 'HR@5': '0.0749', 'NDCG@5': '0.0539', 'HR@10': '0.1024', 'NDCG@10': '0.0627', 'HR@20': '0.1391', 'NDCG@20': '0.0719'}
2025-02-27 10:27:50,337 - Validation score increased.  Saving model ...
2025-02-27 10:28:13,720 - {'epoch': 7, 'rec_loss': '7.5023'}
2025-02-27 10:28:20,924 - {'Epoch': 7, 'HR@5': '0.0778', 'NDCG@5': '0.0565', 'HR@10': '0.1081', 'NDCG@10': '0.0662', 'HR@20': '0.1451', 'NDCG@20': '0.0755'}
2025-02-27 10:28:20,932 - Validation score increased.  Saving model ...
2025-02-27 10:28:44,318 - {'epoch': 8, 'rec_loss': '7.4184'}
2025-02-27 10:28:51,382 - {'Epoch': 8, 'HR@5': '0.0813', 'NDCG@5': '0.0588', 'HR@10': '0.1107', 'NDCG@10': '0.0682', 'HR@20': '0.1475', 'NDCG@20': '0.0774'}
2025-02-27 10:28:51,388 - Validation score increased.  Saving model ...
2025-02-27 10:29:15,254 - {'epoch': 9, 'rec_loss': '7.3567'}
2025-02-27 10:29:22,381 - {'Epoch': 9, 'HR@5': '0.0848', 'NDCG@5': '0.0612', 'HR@10': '0.1114', 'NDCG@10': '0.0698', 'HR@20': '0.1509', 'NDCG@20': '0.0797'}
2025-02-27 10:29:22,383 - Validation score increased.  Saving model ...
2025-02-27 10:29:45,586 - {'epoch': 10, 'rec_loss': '7.3089'}
2025-02-27 10:29:52,921 - {'Epoch': 10, 'HR@5': '0.0855', 'NDCG@5': '0.0617', 'HR@10': '0.1146', 'NDCG@10': '0.0711', 'HR@20': '0.1537', 'NDCG@20': '0.0809'}
2025-02-27 10:29:52,930 - Validation score increased.  Saving model ...
2025-02-27 10:30:15,346 - {'epoch': 11, 'rec_loss': '7.2580'}
2025-02-27 10:30:22,999 - {'Epoch': 11, 'HR@5': '0.0852', 'NDCG@5': '0.0622', 'HR@10': '0.1175', 'NDCG@10': '0.0726', 'HR@20': '0.1563', 'NDCG@20': '0.0824'}
2025-02-27 10:30:23,000 - Validation score increased.  Saving model ...
2025-02-27 10:30:45,124 - {'epoch': 12, 'rec_loss': '7.2187'}
2025-02-27 10:30:53,087 - {'Epoch': 12, 'HR@5': '0.0868', 'NDCG@5': '0.0636', 'HR@10': '0.1176', 'NDCG@10': '0.0735', 'HR@20': '0.1569', 'NDCG@20': '0.0834'}
2025-02-27 10:30:53,093 - Validation score increased.  Saving model ...
2025-02-27 10:31:17,401 - {'epoch': 13, 'rec_loss': '7.1849'}
2025-02-27 10:31:24,967 - {'Epoch': 13, 'HR@5': '0.0873', 'NDCG@5': '0.0631', 'HR@10': '0.1180', 'NDCG@10': '0.0730', 'HR@20': '0.1560', 'NDCG@20': '0.0826'}
2025-02-27 10:31:24,974 - EarlyStopping counter: 1 out of 10
2025-02-27 10:31:49,164 - {'epoch': 14, 'rec_loss': '7.1545'}
2025-02-27 10:31:56,328 - {'Epoch': 14, 'HR@5': '0.0878', 'NDCG@5': '0.0645', 'HR@10': '0.1191', 'NDCG@10': '0.0746', 'HR@20': '0.1577', 'NDCG@20': '0.0843'}
2025-02-27 10:31:56,336 - Validation score increased.  Saving model ...
2025-02-27 10:32:19,562 - {'epoch': 15, 'rec_loss': '7.1292'}
2025-02-27 10:32:27,308 - {'Epoch': 15, 'HR@5': '0.0873', 'NDCG@5': '0.0636', 'HR@10': '0.1197', 'NDCG@10': '0.0741', 'HR@20': '0.1576', 'NDCG@20': '0.0836'}
2025-02-27 10:32:27,315 - EarlyStopping counter: 1 out of 10
2025-02-27 10:32:49,685 - {'epoch': 16, 'rec_loss': '7.0999'}
2025-02-27 10:32:56,868 - {'Epoch': 16, 'HR@5': '0.0891', 'NDCG@5': '0.0647', 'HR@10': '0.1213', 'NDCG@10': '0.0751', 'HR@20': '0.1591', 'NDCG@20': '0.0846'}
2025-02-27 10:32:56,875 - Validation score increased.  Saving model ...
2025-02-27 10:33:20,472 - {'epoch': 17, 'rec_loss': '7.0763'}
2025-02-27 10:33:28,457 - {'Epoch': 17, 'HR@5': '0.0904', 'NDCG@5': '0.0652', 'HR@10': '0.1205', 'NDCG@10': '0.0749', 'HR@20': '0.1592', 'NDCG@20': '0.0847'}
2025-02-27 10:33:28,465 - Validation score increased.  Saving model ...
2025-02-27 10:33:51,291 - {'epoch': 18, 'rec_loss': '7.0663'}
2025-02-27 10:33:58,365 - {'Epoch': 18, 'HR@5': '0.0902', 'NDCG@5': '0.0651', 'HR@10': '0.1225', 'NDCG@10': '0.0754', 'HR@20': '0.1613', 'NDCG@20': '0.0852'}
2025-02-27 10:33:58,373 - Validation score increased.  Saving model ...
2025-02-27 10:34:22,403 - {'epoch': 19, 'rec_loss': '7.0435'}
2025-02-27 10:34:29,932 - {'Epoch': 19, 'HR@5': '0.0904', 'NDCG@5': '0.0654', 'HR@10': '0.1225', 'NDCG@10': '0.0757', 'HR@20': '0.1606', 'NDCG@20': '0.0853'}
2025-02-27 10:34:29,938 - Validation score increased.  Saving model ...
2025-02-27 10:34:53,143 - {'epoch': 20, 'rec_loss': '7.0262'}
2025-02-27 10:35:00,319 - {'Epoch': 20, 'HR@5': '0.0890', 'NDCG@5': '0.0649', 'HR@10': '0.1220', 'NDCG@10': '0.0755', 'HR@20': '0.1635', 'NDCG@20': '0.0859'}
2025-02-27 10:35:00,320 - Validation score increased.  Saving model ...
2025-02-27 10:35:23,283 - {'epoch': 21, 'rec_loss': '7.0073'}
2025-02-27 10:35:30,453 - {'Epoch': 21, 'HR@5': '0.0915', 'NDCG@5': '0.0661', 'HR@10': '0.1234', 'NDCG@10': '0.0763', 'HR@20': '0.1627', 'NDCG@20': '0.0863'}
2025-02-27 10:35:30,462 - Validation score increased.  Saving model ...
2025-02-27 10:35:54,175 - {'epoch': 22, 'rec_loss': '6.9938'}
2025-02-27 10:36:01,575 - {'Epoch': 22, 'HR@5': '0.0903', 'NDCG@5': '0.0661', 'HR@10': '0.1229', 'NDCG@10': '0.0766', 'HR@20': '0.1641', 'NDCG@20': '0.0870'}
2025-02-27 10:36:01,581 - Validation score increased.  Saving model ...
2025-02-27 10:36:24,447 - {'epoch': 23, 'rec_loss': '6.9829'}
2025-02-27 10:36:32,820 - {'Epoch': 23, 'HR@5': '0.0910', 'NDCG@5': '0.0664', 'HR@10': '0.1229', 'NDCG@10': '0.0767', 'HR@20': '0.1650', 'NDCG@20': '0.0873'}
2025-02-27 10:36:32,827 - Validation score increased.  Saving model ...
2025-02-27 10:36:56,173 - {'epoch': 24, 'rec_loss': '6.9612'}
2025-02-27 10:37:03,585 - {'Epoch': 24, 'HR@5': '0.0905', 'NDCG@5': '0.0657', 'HR@10': '0.1242', 'NDCG@10': '0.0765', 'HR@20': '0.1652', 'NDCG@20': '0.0869'}
2025-02-27 10:37:03,592 - EarlyStopping counter: 1 out of 10
2025-02-27 10:37:26,586 - {'epoch': 25, 'rec_loss': '6.9454'}
2025-02-27 10:37:34,112 - {'Epoch': 25, 'HR@5': '0.0895', 'NDCG@5': '0.0655', 'HR@10': '0.1231', 'NDCG@10': '0.0763', 'HR@20': '0.1631', 'NDCG@20': '0.0864'}
2025-02-27 10:37:34,120 - EarlyStopping counter: 2 out of 10
2025-02-27 10:37:57,849 - {'epoch': 26, 'rec_loss': '6.9440'}
2025-02-27 10:38:05,457 - {'Epoch': 26, 'HR@5': '0.0915', 'NDCG@5': '0.0662', 'HR@10': '0.1224', 'NDCG@10': '0.0762', 'HR@20': '0.1639', 'NDCG@20': '0.0866'}
2025-02-27 10:38:05,465 - EarlyStopping counter: 3 out of 10
2025-02-27 10:38:29,238 - {'epoch': 27, 'rec_loss': '6.9255'}
2025-02-27 10:38:36,232 - {'Epoch': 27, 'HR@5': '0.0925', 'NDCG@5': '0.0671', 'HR@10': '0.1245', 'NDCG@10': '0.0774', 'HR@20': '0.1643', 'NDCG@20': '0.0874'}
2025-02-27 10:38:36,239 - Validation score increased.  Saving model ...
2025-02-27 10:39:00,101 - {'epoch': 28, 'rec_loss': '6.9226'}
2025-02-27 10:39:07,093 - {'Epoch': 28, 'HR@5': '0.0923', 'NDCG@5': '0.0666', 'HR@10': '0.1248', 'NDCG@10': '0.0770', 'HR@20': '0.1639', 'NDCG@20': '0.0869'}
2025-02-27 10:39:07,101 - EarlyStopping counter: 1 out of 10
2025-02-27 10:39:29,940 - {'epoch': 29, 'rec_loss': '6.9061'}
2025-02-27 10:39:37,190 - {'Epoch': 29, 'HR@5': '0.0928', 'NDCG@5': '0.0670', 'HR@10': '0.1231', 'NDCG@10': '0.0768', 'HR@20': '0.1640', 'NDCG@20': '0.0871'}
2025-02-27 10:39:37,198 - EarlyStopping counter: 2 out of 10
2025-02-27 10:40:00,508 - {'epoch': 30, 'rec_loss': '6.9004'}
2025-02-27 10:40:07,840 - {'Epoch': 30, 'HR@5': '0.0913', 'NDCG@5': '0.0669', 'HR@10': '0.1236', 'NDCG@10': '0.0773', 'HR@20': '0.1658', 'NDCG@20': '0.0879'}
2025-02-27 10:40:07,849 - Validation score increased.  Saving model ...
2025-02-27 10:40:31,297 - {'epoch': 31, 'rec_loss': '6.8895'}
2025-02-27 10:40:38,836 - {'Epoch': 31, 'HR@5': '0.0916', 'NDCG@5': '0.0669', 'HR@10': '0.1235', 'NDCG@10': '0.0772', 'HR@20': '0.1650', 'NDCG@20': '0.0876'}
2025-02-27 10:40:38,844 - EarlyStopping counter: 1 out of 10
2025-02-27 10:41:01,908 - {'epoch': 32, 'rec_loss': '6.8797'}
2025-02-27 10:41:09,636 - {'Epoch': 32, 'HR@5': '0.0905', 'NDCG@5': '0.0666', 'HR@10': '0.1255', 'NDCG@10': '0.0779', 'HR@20': '0.1649', 'NDCG@20': '0.0878'}
2025-02-27 10:41:09,637 - EarlyStopping counter: 2 out of 10
2025-02-27 10:41:33,542 - {'epoch': 33, 'rec_loss': '6.8702'}
2025-02-27 10:41:40,718 - {'Epoch': 33, 'HR@5': '0.0919', 'NDCG@5': '0.0670', 'HR@10': '0.1253', 'NDCG@10': '0.0777', 'HR@20': '0.1645', 'NDCG@20': '0.0876'}
2025-02-27 10:41:40,725 - EarlyStopping counter: 3 out of 10
2025-02-27 10:42:04,157 - {'epoch': 34, 'rec_loss': '6.8556'}
2025-02-27 10:42:11,663 - {'Epoch': 34, 'HR@5': '0.0928', 'NDCG@5': '0.0675', 'HR@10': '0.1255', 'NDCG@10': '0.0781', 'HR@20': '0.1662', 'NDCG@20': '0.0883'}
2025-02-27 10:42:11,669 - Validation score increased.  Saving model ...
2025-02-27 10:42:34,854 - {'epoch': 35, 'rec_loss': '6.8526'}
2025-02-27 10:42:42,269 - {'Epoch': 35, 'HR@5': '0.0931', 'NDCG@5': '0.0679', 'HR@10': '0.1263', 'NDCG@10': '0.0786', 'HR@20': '0.1664', 'NDCG@20': '0.0887'}
2025-02-27 10:42:42,277 - Validation score increased.  Saving model ...
2025-02-27 10:43:04,842 - {'epoch': 36, 'rec_loss': '6.8479'}
2025-02-27 10:43:12,611 - {'Epoch': 36, 'HR@5': '0.0938', 'NDCG@5': '0.0680', 'HR@10': '0.1270', 'NDCG@10': '0.0788', 'HR@20': '0.1664', 'NDCG@20': '0.0886'}
2025-02-27 10:43:12,618 - EarlyStopping counter: 1 out of 10
2025-02-27 10:43:35,502 - {'epoch': 37, 'rec_loss': '6.8328'}
2025-02-27 10:43:43,944 - {'Epoch': 37, 'HR@5': '0.0930', 'NDCG@5': '0.0674', 'HR@10': '0.1262', 'NDCG@10': '0.0780', 'HR@20': '0.1670', 'NDCG@20': '0.0883'}
2025-02-27 10:43:43,951 - EarlyStopping counter: 2 out of 10
2025-02-27 10:44:06,949 - {'epoch': 38, 'rec_loss': '6.8273'}
2025-02-27 10:44:14,629 - {'Epoch': 38, 'HR@5': '0.0937', 'NDCG@5': '0.0673', 'HR@10': '0.1270', 'NDCG@10': '0.0780', 'HR@20': '0.1661', 'NDCG@20': '0.0879'}
2025-02-27 10:44:14,636 - EarlyStopping counter: 3 out of 10
2025-02-27 10:44:37,282 - {'epoch': 39, 'rec_loss': '6.8258'}
2025-02-27 10:44:45,334 - {'Epoch': 39, 'HR@5': '0.0946', 'NDCG@5': '0.0682', 'HR@10': '0.1264', 'NDCG@10': '0.0785', 'HR@20': '0.1672', 'NDCG@20': '0.0887'}
2025-02-27 10:44:45,341 - Validation score increased.  Saving model ...
2025-02-27 10:45:08,313 - {'epoch': 40, 'rec_loss': '6.8116'}
2025-02-27 10:45:15,686 - {'Epoch': 40, 'HR@5': '0.0946', 'NDCG@5': '0.0688', 'HR@10': '0.1267', 'NDCG@10': '0.0791', 'HR@20': '0.1663', 'NDCG@20': '0.0891'}
2025-02-27 10:45:15,692 - Validation score increased.  Saving model ...
2025-02-27 10:45:38,218 - {'epoch': 41, 'rec_loss': '6.8120'}
2025-02-27 10:45:45,444 - {'Epoch': 41, 'HR@5': '0.0937', 'NDCG@5': '0.0677', 'HR@10': '0.1261', 'NDCG@10': '0.0781', 'HR@20': '0.1667', 'NDCG@20': '0.0883'}
2025-02-27 10:45:45,452 - EarlyStopping counter: 1 out of 10
2025-02-27 10:46:08,667 - {'epoch': 42, 'rec_loss': '6.8070'}
2025-02-27 10:46:15,717 - {'Epoch': 42, 'HR@5': '0.0935', 'NDCG@5': '0.0678', 'HR@10': '0.1258', 'NDCG@10': '0.0782', 'HR@20': '0.1655', 'NDCG@20': '0.0882'}
2025-02-27 10:46:15,725 - EarlyStopping counter: 2 out of 10
2025-02-27 10:46:39,527 - {'epoch': 43, 'rec_loss': '6.7987'}
2025-02-27 10:46:47,153 - {'Epoch': 43, 'HR@5': '0.0935', 'NDCG@5': '0.0683', 'HR@10': '0.1263', 'NDCG@10': '0.0789', 'HR@20': '0.1663', 'NDCG@20': '0.0889'}
2025-02-27 10:46:47,160 - EarlyStopping counter: 3 out of 10
2025-02-27 10:47:09,598 - {'epoch': 44, 'rec_loss': '6.7903'}
2025-02-27 10:47:17,530 - {'Epoch': 44, 'HR@5': '0.0936', 'NDCG@5': '0.0678', 'HR@10': '0.1267', 'NDCG@10': '0.0784', 'HR@20': '0.1677', 'NDCG@20': '0.0887'}
2025-02-27 10:47:17,532 - EarlyStopping counter: 4 out of 10
2025-02-27 10:47:41,941 - {'epoch': 45, 'rec_loss': '6.7859'}
2025-02-27 10:47:49,978 - {'Epoch': 45, 'HR@5': '0.0936', 'NDCG@5': '0.0679', 'HR@10': '0.1267', 'NDCG@10': '0.0786', 'HR@20': '0.1680', 'NDCG@20': '0.0890'}
2025-02-27 10:47:49,985 - EarlyStopping counter: 5 out of 10
2025-02-27 10:48:12,460 - {'epoch': 46, 'rec_loss': '6.7853'}
2025-02-27 10:48:19,355 - {'Epoch': 46, 'HR@5': '0.0938', 'NDCG@5': '0.0678', 'HR@10': '0.1258', 'NDCG@10': '0.0781', 'HR@20': '0.1646', 'NDCG@20': '0.0879'}
2025-02-27 10:48:19,362 - EarlyStopping counter: 6 out of 10
2025-02-27 10:48:42,146 - {'epoch': 47, 'rec_loss': '6.7760'}
2025-02-27 10:48:49,613 - {'Epoch': 47, 'HR@5': '0.0936', 'NDCG@5': '0.0676', 'HR@10': '0.1276', 'NDCG@10': '0.0786', 'HR@20': '0.1682', 'NDCG@20': '0.0888'}
2025-02-27 10:48:49,620 - EarlyStopping counter: 7 out of 10
2025-02-27 10:49:13,115 - {'epoch': 48, 'rec_loss': '6.7632'}
2025-02-27 10:49:21,310 - {'Epoch': 48, 'HR@5': '0.0945', 'NDCG@5': '0.0684', 'HR@10': '0.1260', 'NDCG@10': '0.0786', 'HR@20': '0.1671', 'NDCG@20': '0.0889'}
2025-02-27 10:49:21,318 - EarlyStopping counter: 8 out of 10
2025-02-27 10:49:45,332 - {'epoch': 49, 'rec_loss': '6.7576'}
2025-02-27 10:49:53,808 - {'Epoch': 49, 'HR@5': '0.0942', 'NDCG@5': '0.0680', 'HR@10': '0.1256', 'NDCG@10': '0.0781', 'HR@20': '0.1674', 'NDCG@20': '0.0886'}
2025-02-27 10:49:53,816 - EarlyStopping counter: 9 out of 10
2025-02-27 10:50:16,804 - {'epoch': 50, 'rec_loss': '6.7631'}
2025-02-27 10:50:24,041 - {'Epoch': 50, 'HR@5': '0.0930', 'NDCG@5': '0.0674', 'HR@10': '0.1267', 'NDCG@10': '0.0783', 'HR@20': '0.1668', 'NDCG@20': '0.0884'}
2025-02-27 10:50:24,049 - EarlyStopping counter: 10 out of 10
2025-02-27 10:50:24,049 - Early stopping
2025-02-27 10:50:24,049 - ---------------Test Score---------------
2025-02-27 10:50:31,857 - {'Epoch': 0, 'HR@5': '0.0777', 'NDCG@5': '0.0567', 'HR@10': '0.1072', 'NDCG@10': '0.0662', 'HR@20': '0.1427', 'NDCG@20': '0.0751'}
2025-02-27 10:50:31,858 - Scale_Toys
2025-02-27 10:50:31,858 - {'Epoch': 0, 'HR@5': '0.0777', 'NDCG@5': '0.0567', 'HR@10': '0.1072', 'NDCG@10': '0.0662', 'HR@20': '0.1427', 'NDCG@20': '0.0751'}
2025-03-04 22:23:25,964 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 12, 32], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-03-04 22:23:30,180 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-04 22:23:30,197 - Total Parameters: 918117
2025-03-04 22:24:05,493 - {'epoch': 0, 'rec_loss': '9.0966'}
2025-03-04 22:24:14,916 - {'Epoch': 0, 'HR@5': '0.0061', 'NDCG@5': '0.0038', 'HR@10': '0.0118', 'NDCG@10': '0.0057', 'HR@20': '0.0199', 'NDCG@20': '0.0077'}
2025-03-04 22:24:14,918 - Validation score increased.  Saving model ...
2025-03-04 22:24:42,231 - {'epoch': 1, 'rec_loss': '8.7100'}
2025-03-04 22:24:49,489 - {'Epoch': 1, 'HR@5': '0.0174', 'NDCG@5': '0.0122', 'HR@10': '0.0241', 'NDCG@10': '0.0143', 'HR@20': '0.0379', 'NDCG@20': '0.0178'}
2025-03-04 22:24:49,496 - Validation score increased.  Saving model ...
2025-03-04 22:25:11,325 - {'epoch': 2, 'rec_loss': '8.4098'}
2025-03-04 22:25:19,074 - {'Epoch': 2, 'HR@5': '0.0351', 'NDCG@5': '0.0251', 'HR@10': '0.0509', 'NDCG@10': '0.0302', 'HR@20': '0.0722', 'NDCG@20': '0.0355'}
2025-03-04 22:25:19,084 - Validation score increased.  Saving model ...
2025-03-04 22:25:49,496 - {'epoch': 3, 'rec_loss': '8.1322'}
2025-03-04 22:25:58,261 - {'Epoch': 3, 'HR@5': '0.0501', 'NDCG@5': '0.0354', 'HR@10': '0.0704', 'NDCG@10': '0.0420', 'HR@20': '0.1014', 'NDCG@20': '0.0497'}
2025-03-04 22:25:58,269 - Validation score increased.  Saving model ...
2025-03-04 22:26:31,389 - {'epoch': 4, 'rec_loss': '7.9063'}
2025-03-04 22:26:40,905 - {'Epoch': 4, 'HR@5': '0.0624', 'NDCG@5': '0.0447', 'HR@10': '0.0856', 'NDCG@10': '0.0521', 'HR@20': '0.1167', 'NDCG@20': '0.0600'}
2025-03-04 22:26:40,907 - Validation score increased.  Saving model ...
2025-03-04 22:27:04,183 - {'epoch': 5, 'rec_loss': '7.7387'}
2025-03-04 22:27:11,897 - {'Epoch': 5, 'HR@5': '0.0699', 'NDCG@5': '0.0497', 'HR@10': '0.0957', 'NDCG@10': '0.0581', 'HR@20': '0.1296', 'NDCG@20': '0.0666'}
2025-03-04 22:27:11,898 - Validation score increased.  Saving model ...
2025-03-04 22:27:34,013 - {'epoch': 6, 'rec_loss': '7.6072'}
2025-03-04 22:27:42,229 - {'Epoch': 6, 'HR@5': '0.0739', 'NDCG@5': '0.0533', 'HR@10': '0.1010', 'NDCG@10': '0.0620', 'HR@20': '0.1372', 'NDCG@20': '0.0711'}
2025-03-04 22:27:42,234 - Validation score increased.  Saving model ...
2025-03-04 22:28:15,679 - {'epoch': 7, 'rec_loss': '7.5085'}
2025-03-04 22:28:24,880 - {'Epoch': 7, 'HR@5': '0.0776', 'NDCG@5': '0.0567', 'HR@10': '0.1081', 'NDCG@10': '0.0664', 'HR@20': '0.1437', 'NDCG@20': '0.0754'}
2025-03-04 22:28:24,882 - Validation score increased.  Saving model ...
2025-03-04 22:28:57,720 - {'epoch': 8, 'rec_loss': '7.4230'}
2025-03-04 22:29:05,188 - {'Epoch': 8, 'HR@5': '0.0812', 'NDCG@5': '0.0588', 'HR@10': '0.1099', 'NDCG@10': '0.0680', 'HR@20': '0.1469', 'NDCG@20': '0.0772'}
2025-03-04 22:29:05,198 - Validation score increased.  Saving model ...
2025-03-04 22:29:27,022 - {'epoch': 9, 'rec_loss': '7.3607'}
2025-03-04 22:29:33,799 - {'Epoch': 9, 'HR@5': '0.0852', 'NDCG@5': '0.0612', 'HR@10': '0.1113', 'NDCG@10': '0.0696', 'HR@20': '0.1495', 'NDCG@20': '0.0792'}
2025-03-04 22:29:33,806 - Validation score increased.  Saving model ...
2025-03-04 22:29:56,059 - {'epoch': 10, 'rec_loss': '7.3127'}
2025-03-04 22:30:02,868 - {'Epoch': 10, 'HR@5': '0.0863', 'NDCG@5': '0.0621', 'HR@10': '0.1142', 'NDCG@10': '0.0712', 'HR@20': '0.1525', 'NDCG@20': '0.0808'}
2025-03-04 22:30:02,875 - Validation score increased.  Saving model ...
2025-03-04 22:30:35,153 - {'epoch': 11, 'rec_loss': '7.2613'}
2025-03-04 22:30:44,736 - {'Epoch': 11, 'HR@5': '0.0853', 'NDCG@5': '0.0621', 'HR@10': '0.1175', 'NDCG@10': '0.0724', 'HR@20': '0.1558', 'NDCG@20': '0.0821'}
2025-03-04 22:30:44,747 - Validation score increased.  Saving model ...
2025-03-04 22:31:09,698 - {'epoch': 12, 'rec_loss': '7.2236'}
2025-03-04 22:31:17,119 - {'Epoch': 12, 'HR@5': '0.0868', 'NDCG@5': '0.0634', 'HR@10': '0.1185', 'NDCG@10': '0.0736', 'HR@20': '0.1559', 'NDCG@20': '0.0830'}
2025-03-04 22:31:17,128 - Validation score increased.  Saving model ...
2025-03-04 22:31:39,245 - {'epoch': 13, 'rec_loss': '7.1895'}
2025-03-04 22:31:46,296 - {'Epoch': 13, 'HR@5': '0.0876', 'NDCG@5': '0.0635', 'HR@10': '0.1180', 'NDCG@10': '0.0733', 'HR@20': '0.1557', 'NDCG@20': '0.0828'}
2025-03-04 22:31:46,303 - EarlyStopping counter: 1 out of 10
2025-03-04 22:32:07,885 - {'epoch': 14, 'rec_loss': '7.1572'}
2025-03-04 22:32:15,389 - {'Epoch': 14, 'HR@5': '0.0892', 'NDCG@5': '0.0651', 'HR@10': '0.1185', 'NDCG@10': '0.0745', 'HR@20': '0.1561', 'NDCG@20': '0.0840'}
2025-03-04 22:32:15,394 - Validation score increased.  Saving model ...
2025-03-04 22:32:38,561 - {'epoch': 15, 'rec_loss': '7.1320'}
2025-03-04 22:32:45,560 - {'Epoch': 15, 'HR@5': '0.0885', 'NDCG@5': '0.0641', 'HR@10': '0.1203', 'NDCG@10': '0.0744', 'HR@20': '0.1575', 'NDCG@20': '0.0838'}
2025-03-04 22:32:45,569 - EarlyStopping counter: 1 out of 10
2025-03-04 22:33:09,106 - {'epoch': 16, 'rec_loss': '7.1017'}
2025-03-04 22:33:15,947 - {'Epoch': 16, 'HR@5': '0.0904', 'NDCG@5': '0.0654', 'HR@10': '0.1213', 'NDCG@10': '0.0753', 'HR@20': '0.1589', 'NDCG@20': '0.0847'}
2025-03-04 22:33:15,952 - Validation score increased.  Saving model ...
2025-03-04 22:33:40,040 - {'epoch': 17, 'rec_loss': '7.0780'}
2025-03-04 22:33:49,037 - {'Epoch': 17, 'HR@5': '0.0899', 'NDCG@5': '0.0652', 'HR@10': '0.1211', 'NDCG@10': '0.0753', 'HR@20': '0.1587', 'NDCG@20': '0.0847'}
2025-03-04 22:33:49,044 - Validation score increased.  Saving model ...
2025-03-04 22:34:19,593 - {'epoch': 18, 'rec_loss': '7.0667'}
2025-03-04 22:34:28,279 - {'Epoch': 18, 'HR@5': '0.0903', 'NDCG@5': '0.0651', 'HR@10': '0.1222', 'NDCG@10': '0.0754', 'HR@20': '0.1614', 'NDCG@20': '0.0853'}
2025-03-04 22:34:28,290 - Validation score increased.  Saving model ...
2025-03-04 22:34:55,641 - {'epoch': 19, 'rec_loss': '7.0434'}
2025-03-04 22:35:03,057 - {'Epoch': 19, 'HR@5': '0.0913', 'NDCG@5': '0.0655', 'HR@10': '0.1221', 'NDCG@10': '0.0754', 'HR@20': '0.1603', 'NDCG@20': '0.0850'}
2025-03-04 22:35:03,062 - EarlyStopping counter: 1 out of 10
2025-03-04 22:35:25,222 - {'epoch': 20, 'rec_loss': '7.0249'}
2025-03-04 22:35:32,171 - {'Epoch': 20, 'HR@5': '0.0895', 'NDCG@5': '0.0653', 'HR@10': '0.1219', 'NDCG@10': '0.0758', 'HR@20': '0.1636', 'NDCG@20': '0.0862'}
2025-03-04 22:35:32,176 - Validation score increased.  Saving model ...
2025-03-04 22:35:56,869 - {'epoch': 21, 'rec_loss': '7.0051'}
2025-03-04 22:36:05,793 - {'Epoch': 21, 'HR@5': '0.0914', 'NDCG@5': '0.0665', 'HR@10': '0.1237', 'NDCG@10': '0.0769', 'HR@20': '0.1619', 'NDCG@20': '0.0866'}
2025-03-04 22:36:05,803 - Validation score increased.  Saving model ...
2025-03-04 22:36:36,933 - {'epoch': 22, 'rec_loss': '6.9916'}
2025-03-04 22:36:45,949 - {'Epoch': 22, 'HR@5': '0.0906', 'NDCG@5': '0.0664', 'HR@10': '0.1232', 'NDCG@10': '0.0769', 'HR@20': '0.1651', 'NDCG@20': '0.0874'}
2025-03-04 22:36:45,958 - Validation score increased.  Saving model ...
2025-03-04 22:37:13,837 - {'epoch': 23, 'rec_loss': '6.9795'}
2025-03-04 22:37:20,531 - {'Epoch': 23, 'HR@5': '0.0912', 'NDCG@5': '0.0664', 'HR@10': '0.1240', 'NDCG@10': '0.0770', 'HR@20': '0.1652', 'NDCG@20': '0.0873'}
2025-03-04 22:37:20,536 - EarlyStopping counter: 1 out of 10
2025-03-04 22:37:43,271 - {'epoch': 24, 'rec_loss': '6.9579'}
2025-03-04 22:37:50,060 - {'Epoch': 24, 'HR@5': '0.0906', 'NDCG@5': '0.0662', 'HR@10': '0.1242', 'NDCG@10': '0.0769', 'HR@20': '0.1645', 'NDCG@20': '0.0871'}
2025-03-04 22:37:50,066 - EarlyStopping counter: 2 out of 10
2025-03-04 22:38:14,290 - {'epoch': 25, 'rec_loss': '6.9424'}
2025-03-04 22:38:22,901 - {'Epoch': 25, 'HR@5': '0.0899', 'NDCG@5': '0.0654', 'HR@10': '0.1231', 'NDCG@10': '0.0761', 'HR@20': '0.1637', 'NDCG@20': '0.0863'}
2025-03-04 22:38:22,910 - EarlyStopping counter: 3 out of 10
2025-03-04 22:38:53,195 - {'epoch': 26, 'rec_loss': '6.9402'}
2025-03-04 22:39:02,382 - {'Epoch': 26, 'HR@5': '0.0916', 'NDCG@5': '0.0664', 'HR@10': '0.1237', 'NDCG@10': '0.0767', 'HR@20': '0.1643', 'NDCG@20': '0.0869'}
2025-03-04 22:39:02,393 - EarlyStopping counter: 4 out of 10
2025-03-04 22:39:32,532 - {'epoch': 27, 'rec_loss': '6.9220'}
2025-03-04 22:39:40,184 - {'Epoch': 27, 'HR@5': '0.0922', 'NDCG@5': '0.0668', 'HR@10': '0.1260', 'NDCG@10': '0.0777', 'HR@20': '0.1643', 'NDCG@20': '0.0874'}
2025-03-04 22:39:40,186 - EarlyStopping counter: 5 out of 10
2025-03-04 22:40:01,977 - {'epoch': 28, 'rec_loss': '6.9199'}
2025-03-04 22:40:08,892 - {'Epoch': 28, 'HR@5': '0.0914', 'NDCG@5': '0.0662', 'HR@10': '0.1254', 'NDCG@10': '0.0771', 'HR@20': '0.1645', 'NDCG@20': '0.0870'}
2025-03-04 22:40:08,898 - EarlyStopping counter: 6 out of 10
2025-03-04 22:40:36,881 - {'epoch': 29, 'rec_loss': '6.9033'}
2025-03-04 22:40:45,849 - {'Epoch': 29, 'HR@5': '0.0926', 'NDCG@5': '0.0672', 'HR@10': '0.1243', 'NDCG@10': '0.0774', 'HR@20': '0.1648', 'NDCG@20': '0.0876'}
2025-03-04 22:40:45,858 - Validation score increased.  Saving model ...
2025-03-04 22:41:17,151 - {'epoch': 30, 'rec_loss': '6.8970'}
2025-03-04 22:41:25,928 - {'Epoch': 30, 'HR@5': '0.0923', 'NDCG@5': '0.0670', 'HR@10': '0.1258', 'NDCG@10': '0.0778', 'HR@20': '0.1652', 'NDCG@20': '0.0877'}
2025-03-04 22:41:25,930 - Validation score increased.  Saving model ...
2025-03-04 22:41:55,579 - {'epoch': 31, 'rec_loss': '6.8850'}
2025-03-04 22:42:03,157 - {'Epoch': 31, 'HR@5': '0.0917', 'NDCG@5': '0.0673', 'HR@10': '0.1239', 'NDCG@10': '0.0777', 'HR@20': '0.1650', 'NDCG@20': '0.0880'}
2025-03-04 22:42:03,158 - Validation score increased.  Saving model ...
2025-03-04 22:42:25,038 - {'epoch': 32, 'rec_loss': '6.8759'}
2025-03-04 22:42:32,683 - {'Epoch': 32, 'HR@5': '0.0915', 'NDCG@5': '0.0671', 'HR@10': '0.1248', 'NDCG@10': '0.0779', 'HR@20': '0.1654', 'NDCG@20': '0.0881'}
2025-03-04 22:42:32,692 - Validation score increased.  Saving model ...
2025-03-04 22:42:57,522 - {'epoch': 33, 'rec_loss': '6.8676'}
2025-03-04 22:43:06,194 - {'Epoch': 33, 'HR@5': '0.0932', 'NDCG@5': '0.0677', 'HR@10': '0.1253', 'NDCG@10': '0.0781', 'HR@20': '0.1659', 'NDCG@20': '0.0882'}
2025-03-04 22:43:06,201 - Validation score increased.  Saving model ...
2025-03-04 22:43:29,617 - {'epoch': 34, 'rec_loss': '6.8527'}
2025-03-04 22:43:36,596 - {'Epoch': 34, 'HR@5': '0.0936', 'NDCG@5': '0.0679', 'HR@10': '0.1264', 'NDCG@10': '0.0785', 'HR@20': '0.1664', 'NDCG@20': '0.0886'}
2025-03-04 22:43:36,607 - Validation score increased.  Saving model ...
2025-03-04 22:43:59,975 - {'epoch': 35, 'rec_loss': '6.8500'}
2025-03-04 22:44:07,119 - {'Epoch': 35, 'HR@5': '0.0926', 'NDCG@5': '0.0675', 'HR@10': '0.1263', 'NDCG@10': '0.0784', 'HR@20': '0.1666', 'NDCG@20': '0.0885'}
2025-03-04 22:44:07,125 - EarlyStopping counter: 1 out of 10
2025-03-04 22:44:30,251 - {'epoch': 36, 'rec_loss': '6.8448'}
2025-03-04 22:44:37,232 - {'Epoch': 36, 'HR@5': '0.0925', 'NDCG@5': '0.0674', 'HR@10': '0.1267', 'NDCG@10': '0.0784', 'HR@20': '0.1654', 'NDCG@20': '0.0882'}
2025-03-04 22:44:37,240 - EarlyStopping counter: 2 out of 10
2025-03-04 22:45:00,831 - {'epoch': 37, 'rec_loss': '6.8307'}
2025-03-04 22:45:08,502 - {'Epoch': 37, 'HR@5': '0.0909', 'NDCG@5': '0.0665', 'HR@10': '0.1262', 'NDCG@10': '0.0779', 'HR@20': '0.1664', 'NDCG@20': '0.0881'}
2025-03-04 22:45:08,509 - EarlyStopping counter: 3 out of 10
2025-03-04 22:45:32,101 - {'epoch': 38, 'rec_loss': '6.8229'}
2025-03-04 22:45:40,172 - {'Epoch': 38, 'HR@5': '0.0938', 'NDCG@5': '0.0679', 'HR@10': '0.1268', 'NDCG@10': '0.0785', 'HR@20': '0.1667', 'NDCG@20': '0.0885'}
2025-03-04 22:45:40,177 - EarlyStopping counter: 4 out of 10
2025-03-04 22:46:03,601 - {'epoch': 39, 'rec_loss': '6.8219'}
2025-03-04 22:46:11,220 - {'Epoch': 39, 'HR@5': '0.0939', 'NDCG@5': '0.0680', 'HR@10': '0.1270', 'NDCG@10': '0.0787', 'HR@20': '0.1673', 'NDCG@20': '0.0888'}
2025-03-04 22:46:11,226 - Validation score increased.  Saving model ...
2025-03-04 22:46:33,328 - {'epoch': 40, 'rec_loss': '6.8085'}
2025-03-04 22:46:40,023 - {'Epoch': 40, 'HR@5': '0.0934', 'NDCG@5': '0.0684', 'HR@10': '0.1255', 'NDCG@10': '0.0788', 'HR@20': '0.1660', 'NDCG@20': '0.0890'}
2025-03-04 22:46:40,028 - Validation score increased.  Saving model ...
2025-03-04 22:47:01,593 - {'epoch': 41, 'rec_loss': '6.8074'}
2025-03-04 22:47:08,758 - {'Epoch': 41, 'HR@5': '0.0939', 'NDCG@5': '0.0679', 'HR@10': '0.1256', 'NDCG@10': '0.0781', 'HR@20': '0.1658', 'NDCG@20': '0.0882'}
2025-03-04 22:47:08,764 - EarlyStopping counter: 1 out of 10
2025-03-04 22:47:30,110 - {'epoch': 42, 'rec_loss': '6.8038'}
2025-03-04 22:47:37,731 - {'Epoch': 42, 'HR@5': '0.0933', 'NDCG@5': '0.0678', 'HR@10': '0.1265', 'NDCG@10': '0.0785', 'HR@20': '0.1651', 'NDCG@20': '0.0882'}
2025-03-04 22:47:37,741 - EarlyStopping counter: 2 out of 10
2025-03-04 22:47:59,107 - {'epoch': 43, 'rec_loss': '6.7948'}
2025-03-04 22:48:05,858 - {'Epoch': 43, 'HR@5': '0.0951', 'NDCG@5': '0.0686', 'HR@10': '0.1257', 'NDCG@10': '0.0784', 'HR@20': '0.1656', 'NDCG@20': '0.0884'}
2025-03-04 22:48:05,866 - EarlyStopping counter: 3 out of 10
2025-03-04 22:48:28,199 - {'epoch': 44, 'rec_loss': '6.7871'}
2025-03-04 22:48:34,990 - {'Epoch': 44, 'HR@5': '0.0934', 'NDCG@5': '0.0679', 'HR@10': '0.1261', 'NDCG@10': '0.0784', 'HR@20': '0.1675', 'NDCG@20': '0.0889'}
2025-03-04 22:48:34,997 - EarlyStopping counter: 4 out of 10
2025-03-04 22:48:56,325 - {'epoch': 45, 'rec_loss': '6.7837'}
2025-03-04 22:49:03,903 - {'Epoch': 45, 'HR@5': '0.0942', 'NDCG@5': '0.0681', 'HR@10': '0.1267', 'NDCG@10': '0.0786', 'HR@20': '0.1667', 'NDCG@20': '0.0887'}
2025-03-04 22:49:03,908 - EarlyStopping counter: 5 out of 10
2025-03-04 22:49:24,884 - {'epoch': 46, 'rec_loss': '6.7822'}
2025-03-04 22:49:32,459 - {'Epoch': 46, 'HR@5': '0.0931', 'NDCG@5': '0.0672', 'HR@10': '0.1261', 'NDCG@10': '0.0778', 'HR@20': '0.1651', 'NDCG@20': '0.0876'}
2025-03-04 22:49:32,467 - EarlyStopping counter: 6 out of 10
2025-03-04 22:49:55,480 - {'epoch': 47, 'rec_loss': '6.7726'}
2025-03-04 22:50:02,151 - {'Epoch': 47, 'HR@5': '0.0933', 'NDCG@5': '0.0674', 'HR@10': '0.1279', 'NDCG@10': '0.0785', 'HR@20': '0.1673', 'NDCG@20': '0.0885'}
2025-03-04 22:50:02,153 - EarlyStopping counter: 7 out of 10
2025-03-04 22:50:23,658 - {'epoch': 48, 'rec_loss': '6.7594'}
2025-03-04 22:50:30,558 - {'Epoch': 48, 'HR@5': '0.0940', 'NDCG@5': '0.0681', 'HR@10': '0.1263', 'NDCG@10': '0.0784', 'HR@20': '0.1661', 'NDCG@20': '0.0885'}
2025-03-04 22:50:30,567 - EarlyStopping counter: 8 out of 10
2025-03-04 22:50:51,623 - {'epoch': 49, 'rec_loss': '6.7548'}
2025-03-04 22:50:59,226 - {'Epoch': 49, 'HR@5': '0.0927', 'NDCG@5': '0.0674', 'HR@10': '0.1260', 'NDCG@10': '0.0781', 'HR@20': '0.1660', 'NDCG@20': '0.0882'}
2025-03-04 22:50:59,233 - EarlyStopping counter: 9 out of 10
2025-03-04 22:51:20,309 - {'epoch': 50, 'rec_loss': '6.7606'}
2025-03-04 22:51:27,858 - {'Epoch': 50, 'HR@5': '0.0928', 'NDCG@5': '0.0672', 'HR@10': '0.1259', 'NDCG@10': '0.0779', 'HR@20': '0.1662', 'NDCG@20': '0.0881'}
2025-03-04 22:51:27,863 - EarlyStopping counter: 10 out of 10
2025-03-04 22:51:27,864 - Early stopping
2025-03-04 22:51:27,864 - ---------------Test Score---------------
2025-03-04 22:51:35,582 - {'Epoch': 0, 'HR@5': '0.0778', 'NDCG@5': '0.0564', 'HR@10': '0.1067', 'NDCG@10': '0.0658', 'HR@20': '0.1423', 'NDCG@20': '0.0747'}
2025-03-04 22:51:35,583 - Scale_Toys
2025-03-04 22:51:35,583 - {'Epoch': 0, 'HR@5': '0.0778', 'NDCG@5': '0.0564', 'HR@10': '0.1067', 'NDCG@10': '0.0658', 'HR@20': '0.1423', 'NDCG@20': '0.0747'}
2025-03-05 00:16:22,181 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[2, 3, 4], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-03-05 00:16:25,142 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-05 00:16:25,151 - Total Parameters: 918117
2025-03-05 00:16:48,437 - {'epoch': 0, 'rec_loss': '9.0961'}
2025-03-05 00:16:56,282 - {'Epoch': 0, 'HR@5': '0.0066', 'NDCG@5': '0.0045', 'HR@10': '0.0127', 'NDCG@10': '0.0064', 'HR@20': '0.0197', 'NDCG@20': '0.0082'}
2025-03-05 00:16:56,284 - Validation score increased.  Saving model ...
2025-03-05 00:17:20,369 - {'epoch': 1, 'rec_loss': '8.7070'}
2025-03-05 00:17:28,799 - {'Epoch': 1, 'HR@5': '0.0173', 'NDCG@5': '0.0123', 'HR@10': '0.0256', 'NDCG@10': '0.0150', 'HR@20': '0.0402', 'NDCG@20': '0.0186'}
2025-03-05 00:17:28,804 - Validation score increased.  Saving model ...
2025-03-05 00:17:50,207 - {'epoch': 2, 'rec_loss': '8.3953'}
2025-03-05 00:17:58,311 - {'Epoch': 2, 'HR@5': '0.0355', 'NDCG@5': '0.0253', 'HR@10': '0.0507', 'NDCG@10': '0.0301', 'HR@20': '0.0739', 'NDCG@20': '0.0359'}
2025-03-05 00:17:58,317 - Validation score increased.  Saving model ...
2025-03-05 00:18:20,530 - {'epoch': 3, 'rec_loss': '8.1141'}
2025-03-05 00:18:27,312 - {'Epoch': 3, 'HR@5': '0.0496', 'NDCG@5': '0.0351', 'HR@10': '0.0713', 'NDCG@10': '0.0422', 'HR@20': '0.0993', 'NDCG@20': '0.0492'}
2025-03-05 00:18:27,318 - Validation score increased.  Saving model ...
2025-03-05 00:18:51,325 - {'epoch': 4, 'rec_loss': '7.8888'}
2025-03-05 00:18:59,169 - {'Epoch': 4, 'HR@5': '0.0618', 'NDCG@5': '0.0442', 'HR@10': '0.0859', 'NDCG@10': '0.0519', 'HR@20': '0.1179', 'NDCG@20': '0.0600'}
2025-03-05 00:18:59,176 - Validation score increased.  Saving model ...
2025-03-05 00:19:21,124 - {'epoch': 5, 'rec_loss': '7.7258'}
2025-03-05 00:19:28,906 - {'Epoch': 5, 'HR@5': '0.0691', 'NDCG@5': '0.0493', 'HR@10': '0.0960', 'NDCG@10': '0.0579', 'HR@20': '0.1304', 'NDCG@20': '0.0667'}
2025-03-05 00:19:28,913 - Validation score increased.  Saving model ...
2025-03-05 00:19:51,921 - {'epoch': 6, 'rec_loss': '7.5939'}
2025-03-05 00:19:59,575 - {'Epoch': 6, 'HR@5': '0.0745', 'NDCG@5': '0.0536', 'HR@10': '0.1025', 'NDCG@10': '0.0625', 'HR@20': '0.1389', 'NDCG@20': '0.0717'}
2025-03-05 00:19:59,581 - Validation score increased.  Saving model ...
2025-03-05 00:20:23,948 - {'epoch': 7, 'rec_loss': '7.4979'}
2025-03-05 00:20:31,623 - {'Epoch': 7, 'HR@5': '0.0781', 'NDCG@5': '0.0566', 'HR@10': '0.1084', 'NDCG@10': '0.0663', 'HR@20': '0.1449', 'NDCG@20': '0.0755'}
2025-03-05 00:20:31,629 - Validation score increased.  Saving model ...
2025-03-05 00:20:52,912 - {'epoch': 8, 'rec_loss': '7.4145'}
2025-03-05 00:21:00,676 - {'Epoch': 8, 'HR@5': '0.0812', 'NDCG@5': '0.0590', 'HR@10': '0.1102', 'NDCG@10': '0.0684', 'HR@20': '0.1468', 'NDCG@20': '0.0776'}
2025-03-05 00:21:00,682 - Validation score increased.  Saving model ...
2025-03-05 00:21:22,538 - {'epoch': 9, 'rec_loss': '7.3527'}
2025-03-05 00:21:30,600 - {'Epoch': 9, 'HR@5': '0.0836', 'NDCG@5': '0.0606', 'HR@10': '0.1133', 'NDCG@10': '0.0703', 'HR@20': '0.1508', 'NDCG@20': '0.0797'}
2025-03-05 00:21:30,606 - Validation score increased.  Saving model ...
2025-03-05 00:21:52,512 - {'epoch': 10, 'rec_loss': '7.3070'}
2025-03-05 00:22:00,317 - {'Epoch': 10, 'HR@5': '0.0855', 'NDCG@5': '0.0615', 'HR@10': '0.1152', 'NDCG@10': '0.0711', 'HR@20': '0.1543', 'NDCG@20': '0.0809'}
2025-03-05 00:22:00,323 - Validation score increased.  Saving model ...
2025-03-05 00:22:21,866 - {'epoch': 11, 'rec_loss': '7.2574'}
2025-03-05 00:22:29,692 - {'Epoch': 11, 'HR@5': '0.0851', 'NDCG@5': '0.0623', 'HR@10': '0.1171', 'NDCG@10': '0.0726', 'HR@20': '0.1555', 'NDCG@20': '0.0823'}
2025-03-05 00:22:29,694 - Validation score increased.  Saving model ...
2025-03-05 00:22:51,658 - {'epoch': 12, 'rec_loss': '7.2178'}
2025-03-05 00:22:58,640 - {'Epoch': 12, 'HR@5': '0.0872', 'NDCG@5': '0.0641', 'HR@10': '0.1173', 'NDCG@10': '0.0737', 'HR@20': '0.1563', 'NDCG@20': '0.0836'}
2025-03-05 00:22:58,646 - Validation score increased.  Saving model ...
2025-03-05 00:23:23,346 - {'epoch': 13, 'rec_loss': '7.1840'}
2025-03-05 00:23:31,482 - {'Epoch': 13, 'HR@5': '0.0876', 'NDCG@5': '0.0633', 'HR@10': '0.1186', 'NDCG@10': '0.0732', 'HR@20': '0.1567', 'NDCG@20': '0.0828'}
2025-03-05 00:23:31,488 - EarlyStopping counter: 1 out of 10
2025-03-05 00:23:54,462 - {'epoch': 14, 'rec_loss': '7.1552'}
2025-03-05 00:24:01,376 - {'Epoch': 14, 'HR@5': '0.0882', 'NDCG@5': '0.0646', 'HR@10': '0.1185', 'NDCG@10': '0.0744', 'HR@20': '0.1576', 'NDCG@20': '0.0842'}
2025-03-05 00:24:01,377 - Validation score increased.  Saving model ...
2025-03-05 00:24:23,429 - {'epoch': 15, 'rec_loss': '7.1308'}
2025-03-05 00:24:31,611 - {'Epoch': 15, 'HR@5': '0.0878', 'NDCG@5': '0.0638', 'HR@10': '0.1189', 'NDCG@10': '0.0738', 'HR@20': '0.1574', 'NDCG@20': '0.0835'}
2025-03-05 00:24:31,618 - EarlyStopping counter: 1 out of 10
2025-03-05 00:24:53,133 - {'epoch': 16, 'rec_loss': '7.1009'}
2025-03-05 00:25:00,874 - {'Epoch': 16, 'HR@5': '0.0897', 'NDCG@5': '0.0644', 'HR@10': '0.1209', 'NDCG@10': '0.0745', 'HR@20': '0.1606', 'NDCG@20': '0.0844'}
2025-03-05 00:25:00,881 - Validation score increased.  Saving model ...
2025-03-05 00:25:23,451 - {'epoch': 17, 'rec_loss': '7.0794'}
2025-03-05 00:25:30,406 - {'Epoch': 17, 'HR@5': '0.0892', 'NDCG@5': '0.0649', 'HR@10': '0.1214', 'NDCG@10': '0.0753', 'HR@20': '0.1597', 'NDCG@20': '0.0849'}
2025-03-05 00:25:30,413 - Validation score increased.  Saving model ...
2025-03-05 00:25:53,927 - {'epoch': 18, 'rec_loss': '7.0688'}
2025-03-05 00:26:01,793 - {'Epoch': 18, 'HR@5': '0.0908', 'NDCG@5': '0.0656', 'HR@10': '0.1222', 'NDCG@10': '0.0757', 'HR@20': '0.1620', 'NDCG@20': '0.0857'}
2025-03-05 00:26:01,802 - Validation score increased.  Saving model ...
2025-03-05 00:26:26,519 - {'epoch': 19, 'rec_loss': '7.0470'}
2025-03-05 00:26:34,242 - {'Epoch': 19, 'HR@5': '0.0905', 'NDCG@5': '0.0650', 'HR@10': '0.1219', 'NDCG@10': '0.0752', 'HR@20': '0.1613', 'NDCG@20': '0.0851'}
2025-03-05 00:26:34,248 - EarlyStopping counter: 1 out of 10
2025-03-05 00:26:55,518 - {'epoch': 20, 'rec_loss': '7.0292'}
2025-03-05 00:27:02,501 - {'Epoch': 20, 'HR@5': '0.0892', 'NDCG@5': '0.0651', 'HR@10': '0.1220', 'NDCG@10': '0.0756', 'HR@20': '0.1626', 'NDCG@20': '0.0858'}
2025-03-05 00:27:02,506 - Validation score increased.  Saving model ...
2025-03-05 00:27:24,688 - {'epoch': 21, 'rec_loss': '7.0107'}
2025-03-05 00:27:32,531 - {'Epoch': 21, 'HR@5': '0.0920', 'NDCG@5': '0.0666', 'HR@10': '0.1247', 'NDCG@10': '0.0770', 'HR@20': '0.1620', 'NDCG@20': '0.0864'}
2025-03-05 00:27:32,536 - Validation score increased.  Saving model ...
2025-03-05 00:27:54,004 - {'epoch': 22, 'rec_loss': '6.9969'}
2025-03-05 00:28:00,866 - {'Epoch': 22, 'HR@5': '0.0912', 'NDCG@5': '0.0662', 'HR@10': '0.1238', 'NDCG@10': '0.0767', 'HR@20': '0.1632', 'NDCG@20': '0.0866'}
2025-03-05 00:28:00,871 - Validation score increased.  Saving model ...
2025-03-05 00:28:22,457 - {'epoch': 23, 'rec_loss': '6.9882'}
2025-03-05 00:28:29,611 - {'Epoch': 23, 'HR@5': '0.0909', 'NDCG@5': '0.0665', 'HR@10': '0.1239', 'NDCG@10': '0.0772', 'HR@20': '0.1642', 'NDCG@20': '0.0873'}
2025-03-05 00:28:29,620 - Validation score increased.  Saving model ...
2025-03-05 00:28:54,138 - {'epoch': 24, 'rec_loss': '6.9686'}
2025-03-05 00:29:01,937 - {'Epoch': 24, 'HR@5': '0.0910', 'NDCG@5': '0.0660', 'HR@10': '0.1239', 'NDCG@10': '0.0767', 'HR@20': '0.1648', 'NDCG@20': '0.0870'}
2025-03-05 00:29:01,945 - EarlyStopping counter: 1 out of 10
2025-03-05 00:29:24,108 - {'epoch': 25, 'rec_loss': '6.9517'}
2025-03-05 00:29:31,852 - {'Epoch': 25, 'HR@5': '0.0906', 'NDCG@5': '0.0657', 'HR@10': '0.1242', 'NDCG@10': '0.0765', 'HR@20': '0.1624', 'NDCG@20': '0.0861'}
2025-03-05 00:29:31,858 - EarlyStopping counter: 2 out of 10
2025-03-05 00:29:53,694 - {'epoch': 26, 'rec_loss': '6.9521'}
2025-03-05 00:30:00,461 - {'Epoch': 26, 'HR@5': '0.0929', 'NDCG@5': '0.0667', 'HR@10': '0.1238', 'NDCG@10': '0.0767', 'HR@20': '0.1643', 'NDCG@20': '0.0868'}
2025-03-05 00:30:00,462 - EarlyStopping counter: 3 out of 10
2025-03-05 00:30:22,297 - {'epoch': 27, 'rec_loss': '6.9344'}
2025-03-05 00:30:29,008 - {'Epoch': 27, 'HR@5': '0.0928', 'NDCG@5': '0.0672', 'HR@10': '0.1258', 'NDCG@10': '0.0779', 'HR@20': '0.1653', 'NDCG@20': '0.0878'}
2025-03-05 00:30:29,012 - Validation score increased.  Saving model ...
2025-03-05 00:30:51,178 - {'epoch': 28, 'rec_loss': '6.9318'}
2025-03-05 00:30:59,027 - {'Epoch': 28, 'HR@5': '0.0926', 'NDCG@5': '0.0670', 'HR@10': '0.1261', 'NDCG@10': '0.0778', 'HR@20': '0.1641', 'NDCG@20': '0.0874'}
2025-03-05 00:30:59,033 - EarlyStopping counter: 1 out of 10
2025-03-05 00:31:20,590 - {'epoch': 29, 'rec_loss': '6.9145'}
2025-03-05 00:31:28,256 - {'Epoch': 29, 'HR@5': '0.0930', 'NDCG@5': '0.0672', 'HR@10': '0.1240', 'NDCG@10': '0.0771', 'HR@20': '0.1653', 'NDCG@20': '0.0875'}
2025-03-05 00:31:28,261 - EarlyStopping counter: 2 out of 10
2025-03-05 00:31:52,939 - {'epoch': 30, 'rec_loss': '6.9092'}
2025-03-05 00:32:00,895 - {'Epoch': 30, 'HR@5': '0.0922', 'NDCG@5': '0.0671', 'HR@10': '0.1245', 'NDCG@10': '0.0774', 'HR@20': '0.1657', 'NDCG@20': '0.0878'}
2025-03-05 00:32:00,896 - Validation score increased.  Saving model ...
2025-03-05 00:32:23,285 - {'epoch': 31, 'rec_loss': '6.8971'}
2025-03-05 00:32:30,253 - {'Epoch': 31, 'HR@5': '0.0926', 'NDCG@5': '0.0673', 'HR@10': '0.1253', 'NDCG@10': '0.0779', 'HR@20': '0.1650', 'NDCG@20': '0.0878'}
2025-03-05 00:32:30,261 - Validation score increased.  Saving model ...
2025-03-05 00:32:52,186 - {'epoch': 32, 'rec_loss': '6.8884'}
2025-03-05 00:32:59,976 - {'Epoch': 32, 'HR@5': '0.0912', 'NDCG@5': '0.0671', 'HR@10': '0.1245', 'NDCG@10': '0.0779', 'HR@20': '0.1663', 'NDCG@20': '0.0884'}
2025-03-05 00:32:59,977 - Validation score increased.  Saving model ...
2025-03-05 00:33:21,944 - {'epoch': 33, 'rec_loss': '6.8772'}
2025-03-05 00:33:29,658 - {'Epoch': 33, 'HR@5': '0.0915', 'NDCG@5': '0.0669', 'HR@10': '0.1243', 'NDCG@10': '0.0774', 'HR@20': '0.1651', 'NDCG@20': '0.0877'}
2025-03-05 00:33:29,663 - EarlyStopping counter: 1 out of 10
2025-03-05 00:33:51,304 - {'epoch': 34, 'rec_loss': '6.8630'}
2025-03-05 00:33:57,948 - {'Epoch': 34, 'HR@5': '0.0934', 'NDCG@5': '0.0675', 'HR@10': '0.1252', 'NDCG@10': '0.0778', 'HR@20': '0.1668', 'NDCG@20': '0.0883'}
2025-03-05 00:33:57,952 - EarlyStopping counter: 2 out of 10
2025-03-05 00:34:21,934 - {'epoch': 35, 'rec_loss': '6.8624'}
2025-03-05 00:34:29,970 - {'Epoch': 35, 'HR@5': '0.0923', 'NDCG@5': '0.0678', 'HR@10': '0.1271', 'NDCG@10': '0.0790', 'HR@20': '0.1669', 'NDCG@20': '0.0890'}
2025-03-05 00:34:29,978 - Validation score increased.  Saving model ...
2025-03-05 00:34:53,403 - {'epoch': 36, 'rec_loss': '6.8553'}
2025-03-05 00:35:00,386 - {'Epoch': 36, 'HR@5': '0.0936', 'NDCG@5': '0.0681', 'HR@10': '0.1265', 'NDCG@10': '0.0787', 'HR@20': '0.1666', 'NDCG@20': '0.0888'}
2025-03-05 00:35:00,392 - EarlyStopping counter: 1 out of 10
2025-03-05 00:35:21,713 - {'epoch': 37, 'rec_loss': '6.8393'}
2025-03-05 00:35:28,551 - {'Epoch': 37, 'HR@5': '0.0913', 'NDCG@5': '0.0667', 'HR@10': '0.1261', 'NDCG@10': '0.0780', 'HR@20': '0.1681', 'NDCG@20': '0.0886'}
2025-03-05 00:35:28,556 - EarlyStopping counter: 2 out of 10
2025-03-05 00:35:50,090 - {'epoch': 38, 'rec_loss': '6.8325'}
2025-03-05 00:35:57,817 - {'Epoch': 38, 'HR@5': '0.0928', 'NDCG@5': '0.0672', 'HR@10': '0.1271', 'NDCG@10': '0.0783', 'HR@20': '0.1663', 'NDCG@20': '0.0882'}
2025-03-05 00:35:57,819 - EarlyStopping counter: 3 out of 10
2025-03-05 00:36:19,363 - {'epoch': 39, 'rec_loss': '6.8328'}
2025-03-05 00:36:27,271 - {'Epoch': 39, 'HR@5': '0.0939', 'NDCG@5': '0.0681', 'HR@10': '0.1278', 'NDCG@10': '0.0790', 'HR@20': '0.1678', 'NDCG@20': '0.0891'}
2025-03-05 00:36:27,275 - Validation score increased.  Saving model ...
2025-03-05 00:36:48,811 - {'epoch': 40, 'rec_loss': '6.8211'}
2025-03-05 00:36:56,770 - {'Epoch': 40, 'HR@5': '0.0940', 'NDCG@5': '0.0683', 'HR@10': '0.1274', 'NDCG@10': '0.0791', 'HR@20': '0.1668', 'NDCG@20': '0.0890'}
2025-03-05 00:36:56,776 - EarlyStopping counter: 1 out of 10
2025-03-05 00:37:21,181 - {'epoch': 41, 'rec_loss': '6.8191'}
2025-03-05 00:37:29,342 - {'Epoch': 41, 'HR@5': '0.0932', 'NDCG@5': '0.0674', 'HR@10': '0.1251', 'NDCG@10': '0.0776', 'HR@20': '0.1658', 'NDCG@20': '0.0879'}
2025-03-05 00:37:29,347 - EarlyStopping counter: 2 out of 10
2025-03-05 00:37:50,609 - {'epoch': 42, 'rec_loss': '6.8135'}
2025-03-05 00:37:57,464 - {'Epoch': 42, 'HR@5': '0.0931', 'NDCG@5': '0.0677', 'HR@10': '0.1252', 'NDCG@10': '0.0781', 'HR@20': '0.1662', 'NDCG@20': '0.0883'}
2025-03-05 00:37:57,469 - EarlyStopping counter: 3 out of 10
2025-03-05 00:38:20,307 - {'epoch': 43, 'rec_loss': '6.8045'}
2025-03-05 00:38:28,093 - {'Epoch': 43, 'HR@5': '0.0942', 'NDCG@5': '0.0683', 'HR@10': '0.1264', 'NDCG@10': '0.0787', 'HR@20': '0.1660', 'NDCG@20': '0.0886'}
2025-03-05 00:38:28,097 - EarlyStopping counter: 4 out of 10
2025-03-05 00:38:49,864 - {'epoch': 44, 'rec_loss': '6.7978'}
2025-03-05 00:38:57,670 - {'Epoch': 44, 'HR@5': '0.0935', 'NDCG@5': '0.0677', 'HR@10': '0.1263', 'NDCG@10': '0.0783', 'HR@20': '0.1660', 'NDCG@20': '0.0883'}
2025-03-05 00:38:57,678 - EarlyStopping counter: 5 out of 10
2025-03-05 00:39:19,821 - {'epoch': 45, 'rec_loss': '6.7914'}
2025-03-05 00:39:26,798 - {'Epoch': 45, 'HR@5': '0.0934', 'NDCG@5': '0.0677', 'HR@10': '0.1268', 'NDCG@10': '0.0784', 'HR@20': '0.1683', 'NDCG@20': '0.0889'}
2025-03-05 00:39:26,806 - EarlyStopping counter: 6 out of 10
2025-03-05 00:39:50,976 - {'epoch': 46, 'rec_loss': '6.7907'}
2025-03-05 00:39:58,980 - {'Epoch': 46, 'HR@5': '0.0936', 'NDCG@5': '0.0675', 'HR@10': '0.1247', 'NDCG@10': '0.0775', 'HR@20': '0.1649', 'NDCG@20': '0.0877'}
2025-03-05 00:39:58,984 - EarlyStopping counter: 7 out of 10
2025-03-05 00:40:21,589 - {'epoch': 47, 'rec_loss': '6.7830'}
2025-03-05 00:40:29,286 - {'Epoch': 47, 'HR@5': '0.0925', 'NDCG@5': '0.0671', 'HR@10': '0.1266', 'NDCG@10': '0.0781', 'HR@20': '0.1684', 'NDCG@20': '0.0886'}
2025-03-05 00:40:29,291 - EarlyStopping counter: 8 out of 10
2025-03-05 00:40:53,004 - {'epoch': 48, 'rec_loss': '6.7687'}
2025-03-05 00:41:00,816 - {'Epoch': 48, 'HR@5': '0.0945', 'NDCG@5': '0.0680', 'HR@10': '0.1257', 'NDCG@10': '0.0781', 'HR@20': '0.1673', 'NDCG@20': '0.0886'}
2025-03-05 00:41:00,824 - EarlyStopping counter: 9 out of 10
2025-03-05 00:41:22,771 - {'epoch': 49, 'rec_loss': '6.7631'}
2025-03-05 00:41:30,667 - {'Epoch': 49, 'HR@5': '0.0929', 'NDCG@5': '0.0674', 'HR@10': '0.1264', 'NDCG@10': '0.0782', 'HR@20': '0.1679', 'NDCG@20': '0.0886'}
2025-03-05 00:41:30,672 - EarlyStopping counter: 10 out of 10
2025-03-05 00:41:30,672 - Early stopping
2025-03-05 00:41:30,672 - ---------------Test Score---------------
2025-03-05 00:41:38,412 - {'Epoch': 0, 'HR@5': '0.0801', 'NDCG@5': '0.0576', 'HR@10': '0.1074', 'NDCG@10': '0.0664', 'HR@20': '0.1432', 'NDCG@20': '0.0755'}
2025-03-05 00:41:38,419 - Scale_Toys
2025-03-05 00:41:38,419 - {'Epoch': 0, 'HR@5': '0.0801', 'NDCG@5': '0.0576', 'HR@10': '0.1074', 'NDCG@10': '0.0664', 'HR@20': '0.1432', 'NDCG@20': '0.0755'}
2025-03-05 00:45:39,026 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 10], kernels=[2, 3, 4], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-03-05 00:45:42,029 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-05 00:45:42,038 - Total Parameters: 917142
2025-03-05 00:46:06,067 - {'epoch': 0, 'rec_loss': '9.0935'}
2025-03-05 00:46:13,066 - {'Epoch': 0, 'HR@5': '0.0079', 'NDCG@5': '0.0052', 'HR@10': '0.0129', 'NDCG@10': '0.0068', 'HR@20': '0.0207', 'NDCG@20': '0.0088'}
2025-03-05 00:46:13,069 - Validation score increased.  Saving model ...
2025-03-05 00:46:35,122 - {'epoch': 1, 'rec_loss': '8.7004'}
2025-03-05 00:46:42,421 - {'Epoch': 1, 'HR@5': '0.0168', 'NDCG@5': '0.0119', 'HR@10': '0.0255', 'NDCG@10': '0.0147', 'HR@20': '0.0402', 'NDCG@20': '0.0183'}
2025-03-05 00:46:42,425 - Validation score increased.  Saving model ...
2025-03-05 00:47:07,560 - {'epoch': 2, 'rec_loss': '8.3948'}
2025-03-05 00:47:14,639 - {'Epoch': 2, 'HR@5': '0.0353', 'NDCG@5': '0.0246', 'HR@10': '0.0498', 'NDCG@10': '0.0292', 'HR@20': '0.0723', 'NDCG@20': '0.0349'}
2025-03-05 00:47:14,643 - Validation score increased.  Saving model ...
2025-03-05 00:47:38,749 - {'epoch': 3, 'rec_loss': '8.1216'}
2025-03-05 00:47:46,444 - {'Epoch': 3, 'HR@5': '0.0490', 'NDCG@5': '0.0357', 'HR@10': '0.0681', 'NDCG@10': '0.0418', 'HR@20': '0.0964', 'NDCG@20': '0.0489'}
2025-03-05 00:47:46,450 - Validation score increased.  Saving model ...
2025-03-05 00:48:09,691 - {'epoch': 4, 'rec_loss': '7.8998'}
2025-03-05 00:48:16,378 - {'Epoch': 4, 'HR@5': '0.0610', 'NDCG@5': '0.0432', 'HR@10': '0.0838', 'NDCG@10': '0.0506', 'HR@20': '0.1138', 'NDCG@20': '0.0581'}
2025-03-05 00:48:16,385 - Validation score increased.  Saving model ...
2025-03-05 00:48:39,111 - {'epoch': 5, 'rec_loss': '7.7323'}
2025-03-05 00:48:45,956 - {'Epoch': 5, 'HR@5': '0.0693', 'NDCG@5': '0.0503', 'HR@10': '0.0958', 'NDCG@10': '0.0588', 'HR@20': '0.1279', 'NDCG@20': '0.0668'}
2025-03-05 00:48:45,962 - Validation score increased.  Saving model ...
2025-03-05 00:49:07,889 - {'epoch': 6, 'rec_loss': '7.6076'}
2025-03-05 00:49:14,545 - {'Epoch': 6, 'HR@5': '0.0747', 'NDCG@5': '0.0543', 'HR@10': '0.1037', 'NDCG@10': '0.0637', 'HR@20': '0.1360', 'NDCG@20': '0.0718'}
2025-03-05 00:49:14,550 - Validation score increased.  Saving model ...
2025-03-05 00:49:36,992 - {'epoch': 7, 'rec_loss': '7.5047'}
2025-03-05 00:49:44,306 - {'Epoch': 7, 'HR@5': '0.0785', 'NDCG@5': '0.0566', 'HR@10': '0.1066', 'NDCG@10': '0.0657', 'HR@20': '0.1407', 'NDCG@20': '0.0743'}
2025-03-05 00:49:44,311 - Validation score increased.  Saving model ...
2025-03-05 00:50:09,224 - {'epoch': 8, 'rec_loss': '7.4263'}
2025-03-05 00:50:16,605 - {'Epoch': 8, 'HR@5': '0.0827', 'NDCG@5': '0.0598', 'HR@10': '0.1127', 'NDCG@10': '0.0694', 'HR@20': '0.1475', 'NDCG@20': '0.0782'}
2025-03-05 00:50:16,615 - Validation score increased.  Saving model ...
2025-03-05 00:50:41,367 - {'epoch': 9, 'rec_loss': '7.3612'}
2025-03-05 00:50:48,763 - {'Epoch': 9, 'HR@5': '0.0847', 'NDCG@5': '0.0611', 'HR@10': '0.1136', 'NDCG@10': '0.0705', 'HR@20': '0.1493', 'NDCG@20': '0.0794'}
2025-03-05 00:50:48,768 - Validation score increased.  Saving model ...
2025-03-05 00:51:11,947 - {'epoch': 10, 'rec_loss': '7.3117'}
2025-03-05 00:51:19,164 - {'Epoch': 10, 'HR@5': '0.0858', 'NDCG@5': '0.0618', 'HR@10': '0.1151', 'NDCG@10': '0.0713', 'HR@20': '0.1524', 'NDCG@20': '0.0807'}
2025-03-05 00:51:19,169 - Validation score increased.  Saving model ...
2025-03-05 00:51:41,077 - {'epoch': 11, 'rec_loss': '7.2716'}
2025-03-05 00:51:48,323 - {'Epoch': 11, 'HR@5': '0.0877', 'NDCG@5': '0.0624', 'HR@10': '0.1187', 'NDCG@10': '0.0724', 'HR@20': '0.1557', 'NDCG@20': '0.0817'}
2025-03-05 00:51:48,329 - Validation score increased.  Saving model ...
2025-03-05 00:52:10,856 - {'epoch': 12, 'rec_loss': '7.2281'}
2025-03-05 00:52:17,591 - {'Epoch': 12, 'HR@5': '0.0881', 'NDCG@5': '0.0632', 'HR@10': '0.1184', 'NDCG@10': '0.0730', 'HR@20': '0.1548', 'NDCG@20': '0.0822'}
2025-03-05 00:52:17,597 - Validation score increased.  Saving model ...
2025-03-05 00:52:39,551 - {'epoch': 13, 'rec_loss': '7.1982'}
2025-03-05 00:52:46,963 - {'Epoch': 13, 'HR@5': '0.0884', 'NDCG@5': '0.0640', 'HR@10': '0.1195', 'NDCG@10': '0.0740', 'HR@20': '0.1583', 'NDCG@20': '0.0837'}
2025-03-05 00:52:46,968 - Validation score increased.  Saving model ...
2025-03-05 00:53:10,901 - {'epoch': 14, 'rec_loss': '7.1685'}
2025-03-05 00:53:18,590 - {'Epoch': 14, 'HR@5': '0.0899', 'NDCG@5': '0.0642', 'HR@10': '0.1217', 'NDCG@10': '0.0745', 'HR@20': '0.1612', 'NDCG@20': '0.0844'}
2025-03-05 00:53:18,599 - Validation score increased.  Saving model ...
2025-03-05 00:53:41,205 - {'epoch': 15, 'rec_loss': '7.1405'}
2025-03-05 00:53:47,868 - {'Epoch': 15, 'HR@5': '0.0901', 'NDCG@5': '0.0652', 'HR@10': '0.1217', 'NDCG@10': '0.0754', 'HR@20': '0.1594', 'NDCG@20': '0.0850'}
2025-03-05 00:53:47,873 - Validation score increased.  Saving model ...
2025-03-05 00:54:10,206 - {'epoch': 16, 'rec_loss': '7.1192'}
2025-03-05 00:54:16,891 - {'Epoch': 16, 'HR@5': '0.0907', 'NDCG@5': '0.0656', 'HR@10': '0.1223', 'NDCG@10': '0.0758', 'HR@20': '0.1602', 'NDCG@20': '0.0853'}
2025-03-05 00:54:16,898 - Validation score increased.  Saving model ...
2025-03-05 00:54:40,299 - {'epoch': 17, 'rec_loss': '7.0912'}
2025-03-05 00:54:46,861 - {'Epoch': 17, 'HR@5': '0.0899', 'NDCG@5': '0.0649', 'HR@10': '0.1220', 'NDCG@10': '0.0752', 'HR@20': '0.1614', 'NDCG@20': '0.0851'}
2025-03-05 00:54:46,867 - EarlyStopping counter: 1 out of 10
2025-03-05 00:55:08,769 - {'epoch': 18, 'rec_loss': '7.0819'}
2025-03-05 00:55:16,239 - {'Epoch': 18, 'HR@5': '0.0902', 'NDCG@5': '0.0652', 'HR@10': '0.1228', 'NDCG@10': '0.0757', 'HR@20': '0.1622', 'NDCG@20': '0.0857'}
2025-03-05 00:55:16,243 - Validation score increased.  Saving model ...
2025-03-05 00:55:40,751 - {'epoch': 19, 'rec_loss': '7.0648'}
2025-03-05 00:55:48,216 - {'Epoch': 19, 'HR@5': '0.0899', 'NDCG@5': '0.0647', 'HR@10': '0.1215', 'NDCG@10': '0.0749', 'HR@20': '0.1630', 'NDCG@20': '0.0854'}
2025-03-05 00:55:48,223 - EarlyStopping counter: 1 out of 10
2025-03-05 00:56:11,260 - {'epoch': 20, 'rec_loss': '7.0461'}
2025-03-05 00:56:18,810 - {'Epoch': 20, 'HR@5': '0.0909', 'NDCG@5': '0.0658', 'HR@10': '0.1254', 'NDCG@10': '0.0768', 'HR@20': '0.1636', 'NDCG@20': '0.0865'}
2025-03-05 00:56:18,814 - Validation score increased.  Saving model ...
2025-03-05 00:56:40,951 - {'epoch': 21, 'rec_loss': '7.0308'}
2025-03-05 00:56:48,455 - {'Epoch': 21, 'HR@5': '0.0923', 'NDCG@5': '0.0670', 'HR@10': '0.1254', 'NDCG@10': '0.0777', 'HR@20': '0.1631', 'NDCG@20': '0.0872'}
2025-03-05 00:56:48,459 - Validation score increased.  Saving model ...
2025-03-05 00:57:12,730 - {'epoch': 22, 'rec_loss': '7.0095'}
2025-03-05 00:57:19,603 - {'Epoch': 22, 'HR@5': '0.0926', 'NDCG@5': '0.0665', 'HR@10': '0.1256', 'NDCG@10': '0.0771', 'HR@20': '0.1638', 'NDCG@20': '0.0868'}
2025-03-05 00:57:19,610 - EarlyStopping counter: 1 out of 10
2025-03-05 00:57:42,064 - {'epoch': 23, 'rec_loss': '7.0025'}
2025-03-05 00:57:49,365 - {'Epoch': 23, 'HR@5': '0.0925', 'NDCG@5': '0.0666', 'HR@10': '0.1256', 'NDCG@10': '0.0772', 'HR@20': '0.1651', 'NDCG@20': '0.0872'}
2025-03-05 00:57:49,371 - EarlyStopping counter: 2 out of 10
2025-03-05 00:58:14,350 - {'epoch': 24, 'rec_loss': '6.9835'}
2025-03-05 00:58:21,950 - {'Epoch': 24, 'HR@5': '0.0926', 'NDCG@5': '0.0678', 'HR@10': '0.1248', 'NDCG@10': '0.0782', 'HR@20': '0.1656', 'NDCG@20': '0.0885'}
2025-03-05 00:58:21,955 - Validation score increased.  Saving model ...
2025-03-05 00:58:45,913 - {'epoch': 25, 'rec_loss': '6.9707'}
2025-03-05 00:58:52,485 - {'Epoch': 25, 'HR@5': '0.0924', 'NDCG@5': '0.0675', 'HR@10': '0.1236', 'NDCG@10': '0.0776', 'HR@20': '0.1658', 'NDCG@20': '0.0883'}
2025-03-05 00:58:52,490 - EarlyStopping counter: 1 out of 10
2025-03-05 00:59:15,199 - {'epoch': 26, 'rec_loss': '6.9662'}
2025-03-05 00:59:22,550 - {'Epoch': 26, 'HR@5': '0.0933', 'NDCG@5': '0.0672', 'HR@10': '0.1244', 'NDCG@10': '0.0772', 'HR@20': '0.1637', 'NDCG@20': '0.0871'}
2025-03-05 00:59:22,558 - EarlyStopping counter: 2 out of 10
2025-03-05 00:59:47,571 - {'epoch': 27, 'rec_loss': '6.9550'}
2025-03-05 00:59:54,718 - {'Epoch': 27, 'HR@5': '0.0928', 'NDCG@5': '0.0667', 'HR@10': '0.1256', 'NDCG@10': '0.0773', 'HR@20': '0.1646', 'NDCG@20': '0.0871'}
2025-03-05 00:59:54,723 - EarlyStopping counter: 3 out of 10
2025-03-05 01:00:16,967 - {'epoch': 28, 'rec_loss': '6.9440'}
2025-03-05 01:00:24,251 - {'Epoch': 28, 'HR@5': '0.0933', 'NDCG@5': '0.0676', 'HR@10': '0.1257', 'NDCG@10': '0.0781', 'HR@20': '0.1645', 'NDCG@20': '0.0879'}
2025-03-05 01:00:24,257 - EarlyStopping counter: 4 out of 10
2025-03-05 01:00:46,194 - {'epoch': 29, 'rec_loss': '6.9238'}
2025-03-05 01:00:53,514 - {'Epoch': 29, 'HR@5': '0.0937', 'NDCG@5': '0.0677', 'HR@10': '0.1257', 'NDCG@10': '0.0781', 'HR@20': '0.1667', 'NDCG@20': '0.0884'}
2025-03-05 01:00:53,520 - EarlyStopping counter: 5 out of 10
2025-03-05 01:01:17,372 - {'epoch': 30, 'rec_loss': '6.9159'}
2025-03-05 01:01:24,955 - {'Epoch': 30, 'HR@5': '0.0917', 'NDCG@5': '0.0672', 'HR@10': '0.1255', 'NDCG@10': '0.0781', 'HR@20': '0.1664', 'NDCG@20': '0.0884'}
2025-03-05 01:01:24,960 - EarlyStopping counter: 6 out of 10
2025-03-05 01:01:47,575 - {'epoch': 31, 'rec_loss': '6.9082'}
2025-03-05 01:01:55,218 - {'Epoch': 31, 'HR@5': '0.0940', 'NDCG@5': '0.0679', 'HR@10': '0.1261', 'NDCG@10': '0.0782', 'HR@20': '0.1661', 'NDCG@20': '0.0883'}
2025-03-05 01:01:55,225 - EarlyStopping counter: 7 out of 10
2025-03-05 01:02:17,309 - {'epoch': 32, 'rec_loss': '6.9044'}
2025-03-05 01:02:23,872 - {'Epoch': 32, 'HR@5': '0.0924', 'NDCG@5': '0.0670', 'HR@10': '0.1262', 'NDCG@10': '0.0779', 'HR@20': '0.1681', 'NDCG@20': '0.0884'}
2025-03-05 01:02:23,877 - EarlyStopping counter: 8 out of 10
2025-03-05 01:02:45,829 - {'epoch': 33, 'rec_loss': '6.8927'}
2025-03-05 01:02:52,921 - {'Epoch': 33, 'HR@5': '0.0931', 'NDCG@5': '0.0677', 'HR@10': '0.1275', 'NDCG@10': '0.0788', 'HR@20': '0.1672', 'NDCG@20': '0.0888'}
2025-03-05 01:02:52,926 - Validation score increased.  Saving model ...
2025-03-05 01:03:14,897 - {'epoch': 34, 'rec_loss': '6.8866'}
2025-03-05 01:03:22,230 - {'Epoch': 34, 'HR@5': '0.0936', 'NDCG@5': '0.0671', 'HR@10': '0.1273', 'NDCG@10': '0.0780', 'HR@20': '0.1670', 'NDCG@20': '0.0879'}
2025-03-05 01:03:22,236 - EarlyStopping counter: 1 out of 10
2025-03-05 01:03:46,083 - {'epoch': 35, 'rec_loss': '6.8773'}
2025-03-05 01:03:53,671 - {'Epoch': 35, 'HR@5': '0.0940', 'NDCG@5': '0.0679', 'HR@10': '0.1266', 'NDCG@10': '0.0784', 'HR@20': '0.1652', 'NDCG@20': '0.0881'}
2025-03-05 01:03:53,678 - EarlyStopping counter: 2 out of 10
2025-03-05 01:04:17,189 - {'epoch': 36, 'rec_loss': '6.8728'}
2025-03-05 01:04:24,468 - {'Epoch': 36, 'HR@5': '0.0945', 'NDCG@5': '0.0681', 'HR@10': '0.1270', 'NDCG@10': '0.0786', 'HR@20': '0.1670', 'NDCG@20': '0.0887'}
2025-03-05 01:04:24,474 - EarlyStopping counter: 3 out of 10
2025-03-05 01:04:49,474 - {'epoch': 37, 'rec_loss': '6.8602'}
2025-03-05 01:04:56,327 - {'Epoch': 37, 'HR@5': '0.0950', 'NDCG@5': '0.0683', 'HR@10': '0.1272', 'NDCG@10': '0.0786', 'HR@20': '0.1672', 'NDCG@20': '0.0887'}
2025-03-05 01:04:56,333 - EarlyStopping counter: 4 out of 10
2025-03-05 01:05:19,405 - {'epoch': 38, 'rec_loss': '6.8558'}
2025-03-05 01:05:25,951 - {'Epoch': 38, 'HR@5': '0.0948', 'NDCG@5': '0.0682', 'HR@10': '0.1277', 'NDCG@10': '0.0789', 'HR@20': '0.1680', 'NDCG@20': '0.0890'}
2025-03-05 01:05:25,957 - Validation score increased.  Saving model ...
2025-03-05 01:05:48,312 - {'epoch': 39, 'rec_loss': '6.8475'}
2025-03-05 01:05:55,263 - {'Epoch': 39, 'HR@5': '0.0955', 'NDCG@5': '0.0687', 'HR@10': '0.1283', 'NDCG@10': '0.0793', 'HR@20': '0.1671', 'NDCG@20': '0.0890'}
2025-03-05 01:05:55,269 - Validation score increased.  Saving model ...
2025-03-05 01:06:17,908 - {'epoch': 40, 'rec_loss': '6.8374'}
2025-03-05 01:06:25,348 - {'Epoch': 40, 'HR@5': '0.0957', 'NDCG@5': '0.0688', 'HR@10': '0.1270', 'NDCG@10': '0.0789', 'HR@20': '0.1678', 'NDCG@20': '0.0892'}
2025-03-05 01:06:25,355 - Validation score increased.  Saving model ...
2025-03-05 01:06:49,483 - {'epoch': 41, 'rec_loss': '6.8414'}
2025-03-05 01:06:57,353 - {'Epoch': 41, 'HR@5': '0.0950', 'NDCG@5': '0.0684', 'HR@10': '0.1285', 'NDCG@10': '0.0791', 'HR@20': '0.1681', 'NDCG@20': '0.0891'}
2025-03-05 01:06:57,355 - EarlyStopping counter: 1 out of 10
2025-03-05 01:07:19,679 - {'epoch': 42, 'rec_loss': '6.8294'}
2025-03-05 01:07:26,810 - {'Epoch': 42, 'HR@5': '0.0960', 'NDCG@5': '0.0695', 'HR@10': '0.1292', 'NDCG@10': '0.0802', 'HR@20': '0.1679', 'NDCG@20': '0.0899'}
2025-03-05 01:07:26,815 - Validation score increased.  Saving model ...
2025-03-05 01:07:48,650 - {'epoch': 43, 'rec_loss': '6.8244'}
2025-03-05 01:07:55,965 - {'Epoch': 43, 'HR@5': '0.0950', 'NDCG@5': '0.0685', 'HR@10': '0.1295', 'NDCG@10': '0.0796', 'HR@20': '0.1677', 'NDCG@20': '0.0892'}
2025-03-05 01:07:55,972 - EarlyStopping counter: 1 out of 10
2025-03-05 01:08:20,370 - {'epoch': 44, 'rec_loss': '6.8236'}
2025-03-05 01:08:28,090 - {'Epoch': 44, 'HR@5': '0.0962', 'NDCG@5': '0.0695', 'HR@10': '0.1279', 'NDCG@10': '0.0797', 'HR@20': '0.1677', 'NDCG@20': '0.0897'}
2025-03-05 01:08:28,096 - EarlyStopping counter: 2 out of 10
2025-03-05 01:08:51,766 - {'epoch': 45, 'rec_loss': '6.8119'}
2025-03-05 01:08:59,192 - {'Epoch': 45, 'HR@5': '0.0962', 'NDCG@5': '0.0692', 'HR@10': '0.1283', 'NDCG@10': '0.0796', 'HR@20': '0.1680', 'NDCG@20': '0.0896'}
2025-03-05 01:08:59,196 - EarlyStopping counter: 3 out of 10
2025-03-05 01:09:22,768 - {'epoch': 46, 'rec_loss': '6.8158'}
2025-03-05 01:09:30,852 - {'Epoch': 46, 'HR@5': '0.0948', 'NDCG@5': '0.0685', 'HR@10': '0.1269', 'NDCG@10': '0.0789', 'HR@20': '0.1679', 'NDCG@20': '0.0892'}
2025-03-05 01:09:30,857 - EarlyStopping counter: 4 out of 10
2025-03-05 01:09:54,714 - {'epoch': 47, 'rec_loss': '6.8025'}
2025-03-05 01:10:01,221 - {'Epoch': 47, 'HR@5': '0.0965', 'NDCG@5': '0.0698', 'HR@10': '0.1280', 'NDCG@10': '0.0799', 'HR@20': '0.1674', 'NDCG@20': '0.0899'}
2025-03-05 01:10:01,227 - EarlyStopping counter: 5 out of 10
2025-03-05 01:10:23,134 - {'epoch': 48, 'rec_loss': '6.7881'}
2025-03-05 01:10:30,590 - {'Epoch': 48, 'HR@5': '0.0961', 'NDCG@5': '0.0700', 'HR@10': '0.1280', 'NDCG@10': '0.0803', 'HR@20': '0.1676', 'NDCG@20': '0.0902'}
2025-03-05 01:10:30,595 - Validation score increased.  Saving model ...
2025-03-05 01:10:53,270 - {'epoch': 49, 'rec_loss': '6.7851'}
2025-03-05 01:11:01,043 - {'Epoch': 49, 'HR@5': '0.0955', 'NDCG@5': '0.0690', 'HR@10': '0.1287', 'NDCG@10': '0.0797', 'HR@20': '0.1662', 'NDCG@20': '0.0891'}
2025-03-05 01:11:01,048 - EarlyStopping counter: 1 out of 10
2025-03-05 01:11:23,555 - {'epoch': 50, 'rec_loss': '6.7813'}
2025-03-05 01:11:30,693 - {'Epoch': 50, 'HR@5': '0.0955', 'NDCG@5': '0.0690', 'HR@10': '0.1284', 'NDCG@10': '0.0795', 'HR@20': '0.1686', 'NDCG@20': '0.0897'}
2025-03-05 01:11:30,698 - EarlyStopping counter: 2 out of 10
2025-03-05 01:11:53,052 - {'epoch': 51, 'rec_loss': '6.7829'}
2025-03-05 01:12:00,901 - {'Epoch': 51, 'HR@5': '0.0944', 'NDCG@5': '0.0683', 'HR@10': '0.1270', 'NDCG@10': '0.0789', 'HR@20': '0.1670', 'NDCG@20': '0.0890'}
2025-03-05 01:12:00,906 - EarlyStopping counter: 3 out of 10
2025-03-05 01:12:25,489 - {'epoch': 52, 'rec_loss': '6.7757'}
2025-03-05 01:12:33,227 - {'Epoch': 52, 'HR@5': '0.0939', 'NDCG@5': '0.0677', 'HR@10': '0.1282', 'NDCG@10': '0.0787', 'HR@20': '0.1673', 'NDCG@20': '0.0886'}
2025-03-05 01:12:33,233 - EarlyStopping counter: 4 out of 10
2025-03-05 01:12:55,307 - {'epoch': 53, 'rec_loss': '6.7707'}
2025-03-05 01:13:02,782 - {'Epoch': 53, 'HR@5': '0.0958', 'NDCG@5': '0.0692', 'HR@10': '0.1288', 'NDCG@10': '0.0799', 'HR@20': '0.1667', 'NDCG@20': '0.0894'}
2025-03-05 01:13:02,788 - EarlyStopping counter: 5 out of 10
2025-03-05 01:13:25,331 - {'epoch': 54, 'rec_loss': '6.7600'}
2025-03-05 01:13:32,772 - {'Epoch': 54, 'HR@5': '0.0937', 'NDCG@5': '0.0678', 'HR@10': '0.1285', 'NDCG@10': '0.0790', 'HR@20': '0.1683', 'NDCG@20': '0.0891'}
2025-03-05 01:13:32,778 - EarlyStopping counter: 6 out of 10
2025-03-05 01:13:54,965 - {'epoch': 55, 'rec_loss': '6.7604'}
2025-03-05 01:14:02,125 - {'Epoch': 55, 'HR@5': '0.0943', 'NDCG@5': '0.0681', 'HR@10': '0.1276', 'NDCG@10': '0.0789', 'HR@20': '0.1670', 'NDCG@20': '0.0888'}
2025-03-05 01:14:02,130 - EarlyStopping counter: 7 out of 10
2025-03-05 01:14:24,504 - {'epoch': 56, 'rec_loss': '6.7619'}
2025-03-05 01:14:32,132 - {'Epoch': 56, 'HR@5': '0.0938', 'NDCG@5': '0.0679', 'HR@10': '0.1272', 'NDCG@10': '0.0787', 'HR@20': '0.1665', 'NDCG@20': '0.0886'}
2025-03-05 01:14:32,138 - EarlyStopping counter: 8 out of 10
2025-03-05 01:14:57,091 - {'epoch': 57, 'rec_loss': '6.7506'}
2025-03-05 01:15:04,811 - {'Epoch': 57, 'HR@5': '0.0955', 'NDCG@5': '0.0694', 'HR@10': '0.1276', 'NDCG@10': '0.0797', 'HR@20': '0.1678', 'NDCG@20': '0.0899'}
2025-03-05 01:15:04,817 - EarlyStopping counter: 9 out of 10
2025-03-05 01:15:28,244 - {'epoch': 58, 'rec_loss': '6.7446'}
2025-03-05 01:15:35,188 - {'Epoch': 58, 'HR@5': '0.0954', 'NDCG@5': '0.0693', 'HR@10': '0.1285', 'NDCG@10': '0.0799', 'HR@20': '0.1677', 'NDCG@20': '0.0898'}
2025-03-05 01:15:35,194 - EarlyStopping counter: 10 out of 10
2025-03-05 01:15:35,194 - Early stopping
2025-03-05 01:15:35,194 - ---------------Test Score---------------
2025-03-05 01:15:42,718 - {'Epoch': 0, 'HR@5': '0.0799', 'NDCG@5': '0.0575', 'HR@10': '0.1092', 'NDCG@10': '0.0670', 'HR@20': '0.1427', 'NDCG@20': '0.0754'}
2025-03-05 01:15:42,723 - Scale_Toys
2025-03-05 01:15:42,724 - {'Epoch': 0, 'HR@5': '0.0799', 'NDCG@5': '0.0575', 'HR@10': '0.1092', 'NDCG@10': '0.0670', 'HR@20': '0.1427', 'NDCG@20': '0.0754'}
2025-03-05 01:42:51,689 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-03-05 01:42:54,863 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-05 01:42:54,870 - Total Parameters: 917142
2025-03-05 01:43:20,499 - {'epoch': 0, 'rec_loss': '9.0878'}
2025-03-05 01:43:28,535 - {'Epoch': 0, 'HR@5': '0.0065', 'NDCG@5': '0.0038', 'HR@10': '0.0110', 'NDCG@10': '0.0053', 'HR@20': '0.0183', 'NDCG@20': '0.0071'}
2025-03-05 01:43:28,539 - Validation score increased.  Saving model ...
2025-03-05 01:43:50,804 - {'epoch': 1, 'rec_loss': '8.6799'}
2025-03-05 01:43:57,779 - {'Epoch': 1, 'HR@5': '0.0161', 'NDCG@5': '0.0112', 'HR@10': '0.0262', 'NDCG@10': '0.0144', 'HR@20': '0.0401', 'NDCG@20': '0.0179'}
2025-03-05 01:43:57,783 - Validation score increased.  Saving model ...
2025-03-05 01:44:21,033 - {'epoch': 2, 'rec_loss': '8.3855'}
2025-03-05 01:44:28,055 - {'Epoch': 2, 'HR@5': '0.0341', 'NDCG@5': '0.0244', 'HR@10': '0.0504', 'NDCG@10': '0.0296', 'HR@20': '0.0726', 'NDCG@20': '0.0352'}
2025-03-05 01:44:28,059 - Validation score increased.  Saving model ...
2025-03-05 01:44:50,410 - {'epoch': 3, 'rec_loss': '8.1110'}
2025-03-05 01:44:57,191 - {'Epoch': 3, 'HR@5': '0.0507', 'NDCG@5': '0.0365', 'HR@10': '0.0703', 'NDCG@10': '0.0428', 'HR@20': '0.0964', 'NDCG@20': '0.0494'}
2025-03-05 01:44:57,192 - Validation score increased.  Saving model ...
2025-03-05 01:45:19,280 - {'epoch': 4, 'rec_loss': '7.8949'}
2025-03-05 01:45:27,157 - {'Epoch': 4, 'HR@5': '0.0620', 'NDCG@5': '0.0451', 'HR@10': '0.0849', 'NDCG@10': '0.0524', 'HR@20': '0.1141', 'NDCG@20': '0.0597'}
2025-03-05 01:45:27,164 - Validation score increased.  Saving model ...
2025-03-05 01:45:51,349 - {'epoch': 5, 'rec_loss': '7.7275'}
2025-03-05 01:45:59,219 - {'Epoch': 5, 'HR@5': '0.0695', 'NDCG@5': '0.0502', 'HR@10': '0.0948', 'NDCG@10': '0.0583', 'HR@20': '0.1276', 'NDCG@20': '0.0665'}
2025-03-05 01:45:59,227 - Validation score increased.  Saving model ...
2025-03-05 01:46:23,378 - {'epoch': 6, 'rec_loss': '7.6059'}
2025-03-05 01:46:31,552 - {'Epoch': 6, 'HR@5': '0.0741', 'NDCG@5': '0.0537', 'HR@10': '0.1018', 'NDCG@10': '0.0626', 'HR@20': '0.1377', 'NDCG@20': '0.0716'}
2025-03-05 01:46:31,559 - Validation score increased.  Saving model ...
2025-03-05 01:46:53,162 - {'epoch': 7, 'rec_loss': '7.5081'}
2025-03-05 01:47:01,144 - {'Epoch': 7, 'HR@5': '0.0800', 'NDCG@5': '0.0576', 'HR@10': '0.1086', 'NDCG@10': '0.0668', 'HR@20': '0.1448', 'NDCG@20': '0.0760'}
2025-03-05 01:47:01,148 - Validation score increased.  Saving model ...
2025-03-05 01:47:23,520 - {'epoch': 8, 'rec_loss': '7.4278'}
2025-03-05 01:47:31,273 - {'Epoch': 8, 'HR@5': '0.0826', 'NDCG@5': '0.0597', 'HR@10': '0.1108', 'NDCG@10': '0.0688', 'HR@20': '0.1470', 'NDCG@20': '0.0779'}
2025-03-05 01:47:31,282 - Validation score increased.  Saving model ...
2025-03-05 01:47:53,648 - {'epoch': 9, 'rec_loss': '7.3661'}
2025-03-05 01:48:01,522 - {'Epoch': 9, 'HR@5': '0.0844', 'NDCG@5': '0.0609', 'HR@10': '0.1146', 'NDCG@10': '0.0705', 'HR@20': '0.1505', 'NDCG@20': '0.0796'}
2025-03-05 01:48:01,527 - Validation score increased.  Saving model ...
2025-03-05 01:48:23,464 - {'epoch': 10, 'rec_loss': '7.3144'}
2025-03-05 01:48:31,228 - {'Epoch': 10, 'HR@5': '0.0856', 'NDCG@5': '0.0620', 'HR@10': '0.1157', 'NDCG@10': '0.0716', 'HR@20': '0.1528', 'NDCG@20': '0.0810'}
2025-03-05 01:48:31,237 - Validation score increased.  Saving model ...
2025-03-05 01:48:56,662 - {'epoch': 11, 'rec_loss': '7.2715'}
2025-03-05 01:49:04,965 - {'Epoch': 11, 'HR@5': '0.0877', 'NDCG@5': '0.0637', 'HR@10': '0.1162', 'NDCG@10': '0.0729', 'HR@20': '0.1565', 'NDCG@20': '0.0831'}
2025-03-05 01:49:04,972 - Validation score increased.  Saving model ...
2025-03-05 01:49:28,548 - {'epoch': 12, 'rec_loss': '7.2315'}
2025-03-05 01:49:36,324 - {'Epoch': 12, 'HR@5': '0.0881', 'NDCG@5': '0.0634', 'HR@10': '0.1189', 'NDCG@10': '0.0733', 'HR@20': '0.1569', 'NDCG@20': '0.0829'}
2025-03-05 01:49:36,330 - EarlyStopping counter: 1 out of 10
2025-03-05 01:49:58,105 - {'epoch': 13, 'rec_loss': '7.1997'}
2025-03-05 01:50:05,706 - {'Epoch': 13, 'HR@5': '0.0893', 'NDCG@5': '0.0648', 'HR@10': '0.1209', 'NDCG@10': '0.0750', 'HR@20': '0.1583', 'NDCG@20': '0.0844'}
2025-03-05 01:50:05,714 - Validation score increased.  Saving model ...
2025-03-05 01:50:28,883 - {'epoch': 14, 'rec_loss': '7.1695'}
2025-03-05 01:50:36,299 - {'Epoch': 14, 'HR@5': '0.0884', 'NDCG@5': '0.0638', 'HR@10': '0.1200', 'NDCG@10': '0.0740', 'HR@20': '0.1594', 'NDCG@20': '0.0839'}
2025-03-05 01:50:36,307 - EarlyStopping counter: 1 out of 10
2025-03-05 01:50:58,823 - {'epoch': 15, 'rec_loss': '7.1494'}
2025-03-05 01:51:06,699 - {'Epoch': 15, 'HR@5': '0.0920', 'NDCG@5': '0.0664', 'HR@10': '0.1226', 'NDCG@10': '0.0762', 'HR@20': '0.1613', 'NDCG@20': '0.0860'}
2025-03-05 01:51:06,707 - Validation score increased.  Saving model ...
2025-03-05 01:51:31,599 - {'epoch': 16, 'rec_loss': '7.1231'}
2025-03-05 01:51:39,543 - {'Epoch': 16, 'HR@5': '0.0915', 'NDCG@5': '0.0660', 'HR@10': '0.1228', 'NDCG@10': '0.0761', 'HR@20': '0.1610', 'NDCG@20': '0.0858'}
2025-03-05 01:51:39,552 - EarlyStopping counter: 1 out of 10
2025-03-05 01:52:01,551 - {'epoch': 17, 'rec_loss': '7.0946'}
2025-03-05 01:52:08,746 - {'Epoch': 17, 'HR@5': '0.0925', 'NDCG@5': '0.0666', 'HR@10': '0.1233', 'NDCG@10': '0.0765', 'HR@20': '0.1605', 'NDCG@20': '0.0859'}
2025-03-05 01:52:08,753 - EarlyStopping counter: 2 out of 10
2025-03-05 01:52:32,175 - {'epoch': 18, 'rec_loss': '7.0772'}
2025-03-05 01:52:40,083 - {'Epoch': 18, 'HR@5': '0.0920', 'NDCG@5': '0.0664', 'HR@10': '0.1225', 'NDCG@10': '0.0762', 'HR@20': '0.1611', 'NDCG@20': '0.0860'}
2025-03-05 01:52:40,092 - EarlyStopping counter: 3 out of 10
2025-03-05 01:53:01,848 - {'epoch': 19, 'rec_loss': '7.0631'}
2025-03-05 01:53:10,107 - {'Epoch': 19, 'HR@5': '0.0941', 'NDCG@5': '0.0670', 'HR@10': '0.1252', 'NDCG@10': '0.0769', 'HR@20': '0.1630', 'NDCG@20': '0.0865'}
2025-03-05 01:53:10,114 - Validation score increased.  Saving model ...
2025-03-05 01:53:31,816 - {'epoch': 20, 'rec_loss': '7.0442'}
2025-03-05 01:53:39,891 - {'Epoch': 20, 'HR@5': '0.0930', 'NDCG@5': '0.0670', 'HR@10': '0.1250', 'NDCG@10': '0.0773', 'HR@20': '0.1641', 'NDCG@20': '0.0871'}
2025-03-05 01:53:39,899 - Validation score increased.  Saving model ...
2025-03-05 01:54:02,211 - {'epoch': 21, 'rec_loss': '7.0235'}
2025-03-05 01:54:10,107 - {'Epoch': 21, 'HR@5': '0.0921', 'NDCG@5': '0.0668', 'HR@10': '0.1253', 'NDCG@10': '0.0775', 'HR@20': '0.1637', 'NDCG@20': '0.0872'}
2025-03-05 01:54:10,114 - Validation score increased.  Saving model ...
2025-03-05 01:54:34,349 - {'epoch': 22, 'rec_loss': '7.0099'}
2025-03-05 01:54:42,468 - {'Epoch': 22, 'HR@5': '0.0928', 'NDCG@5': '0.0672', 'HR@10': '0.1241', 'NDCG@10': '0.0772', 'HR@20': '0.1624', 'NDCG@20': '0.0869'}
2025-03-05 01:54:42,470 - EarlyStopping counter: 1 out of 10
2025-03-05 01:55:05,679 - {'epoch': 23, 'rec_loss': '6.9984'}
2025-03-05 01:55:13,343 - {'Epoch': 23, 'HR@5': '0.0936', 'NDCG@5': '0.0674', 'HR@10': '0.1269', 'NDCG@10': '0.0782', 'HR@20': '0.1639', 'NDCG@20': '0.0875'}
2025-03-05 01:55:13,351 - Validation score increased.  Saving model ...
2025-03-05 01:55:35,617 - {'epoch': 24, 'rec_loss': '6.9894'}
2025-03-05 01:55:42,746 - {'Epoch': 24, 'HR@5': '0.0935', 'NDCG@5': '0.0676', 'HR@10': '0.1270', 'NDCG@10': '0.0784', 'HR@20': '0.1639', 'NDCG@20': '0.0877'}
2025-03-05 01:55:42,752 - Validation score increased.  Saving model ...
2025-03-05 01:56:06,638 - {'epoch': 25, 'rec_loss': '6.9752'}
2025-03-05 01:56:13,782 - {'Epoch': 25, 'HR@5': '0.0939', 'NDCG@5': '0.0681', 'HR@10': '0.1285', 'NDCG@10': '0.0793', 'HR@20': '0.1647', 'NDCG@20': '0.0884'}
2025-03-05 01:56:13,790 - Validation score increased.  Saving model ...
2025-03-05 01:56:35,621 - {'epoch': 26, 'rec_loss': '6.9628'}
2025-03-05 01:56:43,583 - {'Epoch': 26, 'HR@5': '0.0940', 'NDCG@5': '0.0681', 'HR@10': '0.1282', 'NDCG@10': '0.0791', 'HR@20': '0.1653', 'NDCG@20': '0.0885'}
2025-03-05 01:56:43,591 - Validation score increased.  Saving model ...
2025-03-05 01:57:05,838 - {'epoch': 27, 'rec_loss': '6.9443'}
2025-03-05 01:57:14,005 - {'Epoch': 27, 'HR@5': '0.0939', 'NDCG@5': '0.0686', 'HR@10': '0.1265', 'NDCG@10': '0.0792', 'HR@20': '0.1653', 'NDCG@20': '0.0889'}
2025-03-05 01:57:14,013 - Validation score increased.  Saving model ...
2025-03-05 01:57:38,564 - {'epoch': 28, 'rec_loss': '6.9355'}
2025-03-05 01:57:46,699 - {'Epoch': 28, 'HR@5': '0.0930', 'NDCG@5': '0.0670', 'HR@10': '0.1270', 'NDCG@10': '0.0779', 'HR@20': '0.1645', 'NDCG@20': '0.0874'}
2025-03-05 01:57:46,706 - EarlyStopping counter: 1 out of 10
2025-03-05 01:58:08,292 - {'epoch': 29, 'rec_loss': '6.9240'}
2025-03-05 01:58:15,338 - {'Epoch': 29, 'HR@5': '0.0949', 'NDCG@5': '0.0680', 'HR@10': '0.1264', 'NDCG@10': '0.0781', 'HR@20': '0.1665', 'NDCG@20': '0.0882'}
2025-03-05 01:58:15,347 - EarlyStopping counter: 2 out of 10
2025-03-05 01:58:37,749 - {'epoch': 30, 'rec_loss': '6.9074'}
2025-03-05 01:58:45,745 - {'Epoch': 30, 'HR@5': '0.0950', 'NDCG@5': '0.0688', 'HR@10': '0.1266', 'NDCG@10': '0.0789', 'HR@20': '0.1661', 'NDCG@20': '0.0889'}
2025-03-05 01:58:45,751 - EarlyStopping counter: 3 out of 10
2025-03-05 01:59:07,972 - {'epoch': 31, 'rec_loss': '6.9108'}
2025-03-05 01:59:15,896 - {'Epoch': 31, 'HR@5': '0.0946', 'NDCG@5': '0.0684', 'HR@10': '0.1269', 'NDCG@10': '0.0788', 'HR@20': '0.1665', 'NDCG@20': '0.0888'}
2025-03-05 01:59:15,903 - EarlyStopping counter: 4 out of 10
2025-03-05 01:59:37,810 - {'epoch': 32, 'rec_loss': '6.9004'}
2025-03-05 01:59:45,748 - {'Epoch': 32, 'HR@5': '0.0942', 'NDCG@5': '0.0684', 'HR@10': '0.1273', 'NDCG@10': '0.0791', 'HR@20': '0.1671', 'NDCG@20': '0.0891'}
2025-03-05 01:59:45,755 - Validation score increased.  Saving model ...
2025-03-05 02:00:10,259 - {'epoch': 33, 'rec_loss': '6.8888'}
2025-03-05 02:00:18,680 - {'Epoch': 33, 'HR@5': '0.0960', 'NDCG@5': '0.0688', 'HR@10': '0.1270', 'NDCG@10': '0.0788', 'HR@20': '0.1656', 'NDCG@20': '0.0885'}
2025-03-05 02:00:18,688 - EarlyStopping counter: 1 out of 10
2025-03-05 02:00:42,537 - {'epoch': 34, 'rec_loss': '6.8840'}
2025-03-05 02:00:50,377 - {'Epoch': 34, 'HR@5': '0.0948', 'NDCG@5': '0.0681', 'HR@10': '0.1280', 'NDCG@10': '0.0788', 'HR@20': '0.1671', 'NDCG@20': '0.0886'}
2025-03-05 02:00:50,385 - EarlyStopping counter: 2 out of 10
2025-03-05 02:01:13,124 - {'epoch': 35, 'rec_loss': '6.8716'}
2025-03-05 02:01:21,179 - {'Epoch': 35, 'HR@5': '0.0948', 'NDCG@5': '0.0688', 'HR@10': '0.1275', 'NDCG@10': '0.0794', 'HR@20': '0.1682', 'NDCG@20': '0.0896'}
2025-03-05 02:01:21,181 - Validation score increased.  Saving model ...
2025-03-05 02:01:43,060 - {'epoch': 36, 'rec_loss': '6.8774'}
2025-03-05 02:01:50,855 - {'Epoch': 36, 'HR@5': '0.0957', 'NDCG@5': '0.0691', 'HR@10': '0.1286', 'NDCG@10': '0.0797', 'HR@20': '0.1686', 'NDCG@20': '0.0897'}
2025-03-05 02:01:50,863 - Validation score increased.  Saving model ...
2025-03-05 02:02:12,735 - {'epoch': 37, 'rec_loss': '6.8629'}
2025-03-05 02:02:20,778 - {'Epoch': 37, 'HR@5': '0.0951', 'NDCG@5': '0.0689', 'HR@10': '0.1278', 'NDCG@10': '0.0794', 'HR@20': '0.1680', 'NDCG@20': '0.0896'}
2025-03-05 02:02:20,784 - EarlyStopping counter: 1 out of 10
2025-03-05 02:02:44,267 - {'epoch': 38, 'rec_loss': '6.8576'}
2025-03-05 02:02:52,604 - {'Epoch': 38, 'HR@5': '0.0953', 'NDCG@5': '0.0687', 'HR@10': '0.1275', 'NDCG@10': '0.0790', 'HR@20': '0.1664', 'NDCG@20': '0.0888'}
2025-03-05 02:02:52,613 - EarlyStopping counter: 2 out of 10
2025-03-05 02:03:16,025 - {'epoch': 39, 'rec_loss': '6.8409'}
2025-03-05 02:03:24,073 - {'Epoch': 39, 'HR@5': '0.0946', 'NDCG@5': '0.0684', 'HR@10': '0.1265', 'NDCG@10': '0.0786', 'HR@20': '0.1659', 'NDCG@20': '0.0886'}
2025-03-05 02:03:24,074 - EarlyStopping counter: 3 out of 10
2025-03-05 02:03:45,924 - {'epoch': 40, 'rec_loss': '6.8355'}
2025-03-05 02:03:53,831 - {'Epoch': 40, 'HR@5': '0.0941', 'NDCG@5': '0.0684', 'HR@10': '0.1289', 'NDCG@10': '0.0796', 'HR@20': '0.1681', 'NDCG@20': '0.0895'}
2025-03-05 02:03:53,837 - EarlyStopping counter: 4 out of 10
2025-03-05 02:04:15,605 - {'epoch': 41, 'rec_loss': '6.8304'}
2025-03-05 02:04:23,144 - {'Epoch': 41, 'HR@5': '0.0954', 'NDCG@5': '0.0692', 'HR@10': '0.1283', 'NDCG@10': '0.0799', 'HR@20': '0.1679', 'NDCG@20': '0.0898'}
2025-03-05 02:04:23,152 - Validation score increased.  Saving model ...
2025-03-05 02:04:45,454 - {'epoch': 42, 'rec_loss': '6.8331'}
2025-03-05 02:04:53,251 - {'Epoch': 42, 'HR@5': '0.0937', 'NDCG@5': '0.0680', 'HR@10': '0.1282', 'NDCG@10': '0.0792', 'HR@20': '0.1679', 'NDCG@20': '0.0892'}
2025-03-05 02:04:53,252 - EarlyStopping counter: 1 out of 10
2025-03-05 02:05:17,098 - {'epoch': 43, 'rec_loss': '6.8197'}
2025-03-05 02:05:25,067 - {'Epoch': 43, 'HR@5': '0.0946', 'NDCG@5': '0.0687', 'HR@10': '0.1280', 'NDCG@10': '0.0794', 'HR@20': '0.1681', 'NDCG@20': '0.0896'}
2025-03-05 02:05:25,073 - EarlyStopping counter: 2 out of 10
2025-03-05 02:05:50,028 - {'epoch': 44, 'rec_loss': '6.8163'}
2025-03-05 02:05:58,563 - {'Epoch': 44, 'HR@5': '0.0944', 'NDCG@5': '0.0679', 'HR@10': '0.1270', 'NDCG@10': '0.0784', 'HR@20': '0.1676', 'NDCG@20': '0.0886'}
2025-03-05 02:05:58,569 - EarlyStopping counter: 3 out of 10
2025-03-05 02:06:20,336 - {'epoch': 45, 'rec_loss': '6.8025'}
2025-03-05 02:06:27,332 - {'Epoch': 45, 'HR@5': '0.0955', 'NDCG@5': '0.0685', 'HR@10': '0.1277', 'NDCG@10': '0.0789', 'HR@20': '0.1685', 'NDCG@20': '0.0892'}
2025-03-05 02:06:27,339 - EarlyStopping counter: 4 out of 10
2025-03-05 02:06:49,041 - {'epoch': 46, 'rec_loss': '6.7991'}
2025-03-05 02:06:56,967 - {'Epoch': 46, 'HR@5': '0.0954', 'NDCG@5': '0.0688', 'HR@10': '0.1275', 'NDCG@10': '0.0791', 'HR@20': '0.1683', 'NDCG@20': '0.0894'}
2025-03-05 02:06:56,975 - EarlyStopping counter: 5 out of 10
2025-03-05 02:07:19,197 - {'epoch': 47, 'rec_loss': '6.7910'}
2025-03-05 02:07:26,853 - {'Epoch': 47, 'HR@5': '0.0933', 'NDCG@5': '0.0679', 'HR@10': '0.1274', 'NDCG@10': '0.0789', 'HR@20': '0.1668', 'NDCG@20': '0.0887'}
2025-03-05 02:07:26,861 - EarlyStopping counter: 6 out of 10
2025-03-05 02:07:48,816 - {'epoch': 48, 'rec_loss': '6.7908'}
2025-03-05 02:07:56,006 - {'Epoch': 48, 'HR@5': '0.0956', 'NDCG@5': '0.0694', 'HR@10': '0.1282', 'NDCG@10': '0.0799', 'HR@20': '0.1679', 'NDCG@20': '0.0899'}
2025-03-05 02:07:56,013 - Validation score increased.  Saving model ...
2025-03-05 02:08:18,120 - {'epoch': 49, 'rec_loss': '6.7837'}
2025-03-05 02:08:26,422 - {'Epoch': 49, 'HR@5': '0.0943', 'NDCG@5': '0.0689', 'HR@10': '0.1277', 'NDCG@10': '0.0797', 'HR@20': '0.1683', 'NDCG@20': '0.0899'}
2025-03-05 02:08:26,430 - EarlyStopping counter: 1 out of 10
2025-03-05 02:08:51,158 - {'epoch': 50, 'rec_loss': '6.7717'}
2025-03-05 02:08:59,442 - {'Epoch': 50, 'HR@5': '0.0945', 'NDCG@5': '0.0686', 'HR@10': '0.1281', 'NDCG@10': '0.0794', 'HR@20': '0.1678', 'NDCG@20': '0.0894'}
2025-03-05 02:08:59,449 - EarlyStopping counter: 2 out of 10
2025-03-05 02:09:21,689 - {'epoch': 51, 'rec_loss': '6.7744'}
2025-03-05 02:09:28,873 - {'Epoch': 51, 'HR@5': '0.0944', 'NDCG@5': '0.0682', 'HR@10': '0.1275', 'NDCG@10': '0.0789', 'HR@20': '0.1695', 'NDCG@20': '0.0895'}
2025-03-05 02:09:28,876 - EarlyStopping counter: 3 out of 10
2025-03-05 02:09:51,091 - {'epoch': 52, 'rec_loss': '6.7746'}
2025-03-05 02:09:59,056 - {'Epoch': 52, 'HR@5': '0.0948', 'NDCG@5': '0.0686', 'HR@10': '0.1272', 'NDCG@10': '0.0790', 'HR@20': '0.1679', 'NDCG@20': '0.0892'}
2025-03-05 02:09:59,062 - EarlyStopping counter: 4 out of 10
2025-03-05 02:10:21,138 - {'epoch': 53, 'rec_loss': '6.7582'}
2025-03-05 02:10:29,158 - {'Epoch': 53, 'HR@5': '0.0945', 'NDCG@5': '0.0687', 'HR@10': '0.1274', 'NDCG@10': '0.0793', 'HR@20': '0.1659', 'NDCG@20': '0.0890'}
2025-03-05 02:10:29,165 - EarlyStopping counter: 5 out of 10
2025-03-05 02:10:51,526 - {'epoch': 54, 'rec_loss': '6.7524'}
2025-03-05 02:10:59,115 - {'Epoch': 54, 'HR@5': '0.0940', 'NDCG@5': '0.0680', 'HR@10': '0.1268', 'NDCG@10': '0.0786', 'HR@20': '0.1678', 'NDCG@20': '0.0889'}
2025-03-05 02:10:59,121 - EarlyStopping counter: 6 out of 10
2025-03-05 02:11:23,194 - {'epoch': 55, 'rec_loss': '6.7519'}
2025-03-05 02:11:31,199 - {'Epoch': 55, 'HR@5': '0.0950', 'NDCG@5': '0.0682', 'HR@10': '0.1273', 'NDCG@10': '0.0786', 'HR@20': '0.1671', 'NDCG@20': '0.0886'}
2025-03-05 02:11:31,206 - EarlyStopping counter: 7 out of 10
2025-03-05 02:11:54,874 - {'epoch': 56, 'rec_loss': '6.7505'}
2025-03-05 02:12:02,897 - {'Epoch': 56, 'HR@5': '0.0942', 'NDCG@5': '0.0684', 'HR@10': '0.1269', 'NDCG@10': '0.0789', 'HR@20': '0.1688', 'NDCG@20': '0.0895'}
2025-03-05 02:12:02,903 - EarlyStopping counter: 8 out of 10
2025-03-05 02:12:24,946 - {'epoch': 57, 'rec_loss': '6.7453'}
2025-03-05 02:12:32,953 - {'Epoch': 57, 'HR@5': '0.0938', 'NDCG@5': '0.0683', 'HR@10': '0.1278', 'NDCG@10': '0.0792', 'HR@20': '0.1671', 'NDCG@20': '0.0891'}
2025-03-05 02:12:32,960 - EarlyStopping counter: 9 out of 10
2025-03-05 02:12:54,919 - {'epoch': 58, 'rec_loss': '6.7367'}
2025-03-05 02:13:02,007 - {'Epoch': 58, 'HR@5': '0.0952', 'NDCG@5': '0.0685', 'HR@10': '0.1287', 'NDCG@10': '0.0794', 'HR@20': '0.1671', 'NDCG@20': '0.0890'}
2025-03-05 02:13:02,014 - EarlyStopping counter: 10 out of 10
2025-03-05 02:13:02,015 - Early stopping
2025-03-05 02:13:02,015 - ---------------Test Score---------------
2025-03-05 02:13:09,896 - {'Epoch': 0, 'HR@5': '0.0803', 'NDCG@5': '0.0583', 'HR@10': '0.1074', 'NDCG@10': '0.0671', 'HR@20': '0.1431', 'NDCG@20': '0.0761'}
2025-03-05 02:13:09,904 - Scale_Toys
2025-03-05 02:13:09,904 - {'Epoch': 0, 'HR@5': '0.0803', 'NDCG@5': '0.0583', 'HR@10': '0.1074', 'NDCG@10': '0.0671', 'HR@20': '0.1431', 'NDCG@20': '0.0761'}
2025-03-05 19:18:23,740 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50], kernels=[2, 3, 4], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-03-05 19:18:38,458 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=50, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-05 19:18:38,476 - Total Parameters: 919742
2025-03-05 19:18:57,778 - {'epoch': 0, 'rec_loss': '9.1076'}
2025-03-05 19:19:04,777 - {'Epoch': 0, 'HR@5': '0.0077', 'NDCG@5': '0.0049', 'HR@10': '0.0116', 'NDCG@10': '0.0062', 'HR@20': '0.0177', 'NDCG@20': '0.0077'}
2025-03-05 19:19:04,782 - Validation score increased.  Saving model ...
2025-03-05 19:19:21,148 - {'epoch': 1, 'rec_loss': '8.8749'}
2025-03-05 19:19:29,034 - {'Epoch': 1, 'HR@5': '0.0096', 'NDCG@5': '0.0061', 'HR@10': '0.0161', 'NDCG@10': '0.0082', 'HR@20': '0.0258', 'NDCG@20': '0.0107'}
2025-03-05 19:19:29,040 - Validation score increased.  Saving model ...
2025-03-05 19:19:50,788 - {'epoch': 2, 'rec_loss': '8.6396'}
2025-03-05 19:20:01,495 - {'Epoch': 2, 'HR@5': '0.0183', 'NDCG@5': '0.0116', 'HR@10': '0.0267', 'NDCG@10': '0.0143', 'HR@20': '0.0415', 'NDCG@20': '0.0180'}
2025-03-05 19:20:01,503 - Validation score increased.  Saving model ...
2025-03-05 19:20:27,445 - {'epoch': 3, 'rec_loss': '8.4669'}
2025-03-05 19:20:38,149 - {'Epoch': 3, 'HR@5': '0.0245', 'NDCG@5': '0.0172', 'HR@10': '0.0365', 'NDCG@10': '0.0211', 'HR@20': '0.0556', 'NDCG@20': '0.0259'}
2025-03-05 19:20:38,157 - Validation score increased.  Saving model ...
2025-03-05 19:21:02,987 - {'epoch': 4, 'rec_loss': '8.3120'}
2025-03-05 19:21:11,796 - {'Epoch': 4, 'HR@5': '0.0350', 'NDCG@5': '0.0251', 'HR@10': '0.0507', 'NDCG@10': '0.0301', 'HR@20': '0.0743', 'NDCG@20': '0.0360'}
2025-03-05 19:21:11,805 - Validation score increased.  Saving model ...
2025-03-05 19:21:27,928 - {'epoch': 5, 'rec_loss': '8.1581'}
2025-03-05 19:21:35,194 - {'Epoch': 5, 'HR@5': '0.0440', 'NDCG@5': '0.0306', 'HR@10': '0.0637', 'NDCG@10': '0.0369', 'HR@20': '0.0893', 'NDCG@20': '0.0434'}
2025-03-05 19:21:35,201 - Validation score increased.  Saving model ...
2025-03-05 19:21:51,209 - {'epoch': 6, 'rec_loss': '8.0235'}
2025-03-05 19:21:58,407 - {'Epoch': 6, 'HR@5': '0.0523', 'NDCG@5': '0.0374', 'HR@10': '0.0747', 'NDCG@10': '0.0447', 'HR@20': '0.1046', 'NDCG@20': '0.0522'}
2025-03-05 19:21:58,415 - Validation score increased.  Saving model ...
2025-03-05 19:22:15,162 - {'epoch': 7, 'rec_loss': '7.9067'}
2025-03-05 19:22:24,096 - {'Epoch': 7, 'HR@5': '0.0587', 'NDCG@5': '0.0418', 'HR@10': '0.0808', 'NDCG@10': '0.0489', 'HR@20': '0.1130', 'NDCG@20': '0.0570'}
2025-03-05 19:22:24,108 - Validation score increased.  Saving model ...
2025-03-05 19:22:48,424 - {'epoch': 8, 'rec_loss': '7.8100'}
2025-03-05 19:22:58,603 - {'Epoch': 8, 'HR@5': '0.0652', 'NDCG@5': '0.0461', 'HR@10': '0.0904', 'NDCG@10': '0.0542', 'HR@20': '0.1217', 'NDCG@20': '0.0621'}
2025-03-05 19:22:58,610 - Validation score increased.  Saving model ...
2025-03-05 19:23:24,068 - {'epoch': 9, 'rec_loss': '7.7347'}
2025-03-05 19:23:34,004 - {'Epoch': 9, 'HR@5': '0.0690', 'NDCG@5': '0.0490', 'HR@10': '0.0951', 'NDCG@10': '0.0574', 'HR@20': '0.1285', 'NDCG@20': '0.0658'}
2025-03-05 19:23:34,013 - Validation score increased.  Saving model ...
2025-03-05 19:23:56,409 - {'epoch': 10, 'rec_loss': '7.6679'}
2025-03-05 19:24:03,810 - {'Epoch': 10, 'HR@5': '0.0730', 'NDCG@5': '0.0519', 'HR@10': '0.1005', 'NDCG@10': '0.0608', 'HR@20': '0.1364', 'NDCG@20': '0.0698'}
2025-03-05 19:24:03,819 - Validation score increased.  Saving model ...
2025-03-05 19:24:21,721 - {'epoch': 11, 'rec_loss': '7.6024'}
2025-03-05 19:24:29,186 - {'Epoch': 11, 'HR@5': '0.0745', 'NDCG@5': '0.0533', 'HR@10': '0.1031', 'NDCG@10': '0.0626', 'HR@20': '0.1406', 'NDCG@20': '0.0720'}
2025-03-05 19:24:29,194 - Validation score increased.  Saving model ...
2025-03-05 19:24:45,976 - {'epoch': 12, 'rec_loss': '7.5560'}
2025-03-05 19:24:54,101 - {'Epoch': 12, 'HR@5': '0.0777', 'NDCG@5': '0.0554', 'HR@10': '0.1073', 'NDCG@10': '0.0650', 'HR@20': '0.1414', 'NDCG@20': '0.0736'}
2025-03-05 19:24:54,106 - Validation score increased.  Saving model ...
2025-03-05 19:25:16,477 - {'epoch': 13, 'rec_loss': '7.5194'}
2025-03-05 19:25:26,106 - {'Epoch': 13, 'HR@5': '0.0793', 'NDCG@5': '0.0573', 'HR@10': '0.1079', 'NDCG@10': '0.0666', 'HR@20': '0.1455', 'NDCG@20': '0.0761'}
2025-03-05 19:25:26,114 - Validation score increased.  Saving model ...
2025-03-05 19:25:52,272 - {'epoch': 14, 'rec_loss': '7.4824'}
2025-03-05 19:26:02,534 - {'Epoch': 14, 'HR@5': '0.0820', 'NDCG@5': '0.0587', 'HR@10': '0.1109', 'NDCG@10': '0.0680', 'HR@20': '0.1481', 'NDCG@20': '0.0774'}
2025-03-05 19:26:02,543 - Validation score increased.  Saving model ...
2025-03-05 19:26:27,725 - {'epoch': 15, 'rec_loss': '7.4434'}
2025-03-05 19:26:37,091 - {'Epoch': 15, 'HR@5': '0.0829', 'NDCG@5': '0.0590', 'HR@10': '0.1131', 'NDCG@10': '0.0687', 'HR@20': '0.1502', 'NDCG@20': '0.0780'}
2025-03-05 19:26:37,099 - Validation score increased.  Saving model ...
2025-03-05 19:26:53,283 - {'epoch': 16, 'rec_loss': '7.4139'}
2025-03-05 19:27:00,930 - {'Epoch': 16, 'HR@5': '0.0837', 'NDCG@5': '0.0605', 'HR@10': '0.1162', 'NDCG@10': '0.0710', 'HR@20': '0.1530', 'NDCG@20': '0.0802'}
2025-03-05 19:27:00,935 - Validation score increased.  Saving model ...
2025-03-05 19:27:16,722 - {'epoch': 17, 'rec_loss': '7.3931'}
2025-03-05 19:27:24,305 - {'Epoch': 17, 'HR@5': '0.0862', 'NDCG@5': '0.0618', 'HR@10': '0.1181', 'NDCG@10': '0.0721', 'HR@20': '0.1544', 'NDCG@20': '0.0813'}
2025-03-05 19:27:24,312 - Validation score increased.  Saving model ...
2025-03-05 19:27:41,256 - {'epoch': 18, 'rec_loss': '7.3733'}
2025-03-05 19:27:50,325 - {'Epoch': 18, 'HR@5': '0.0858', 'NDCG@5': '0.0609', 'HR@10': '0.1168', 'NDCG@10': '0.0709', 'HR@20': '0.1547', 'NDCG@20': '0.0805'}
2025-03-05 19:27:50,340 - EarlyStopping counter: 1 out of 10
2025-03-05 19:28:15,681 - {'epoch': 19, 'rec_loss': '7.3514'}
2025-03-05 19:28:26,462 - {'Epoch': 19, 'HR@5': '0.0873', 'NDCG@5': '0.0624', 'HR@10': '0.1189', 'NDCG@10': '0.0726', 'HR@20': '0.1565', 'NDCG@20': '0.0821'}
2025-03-05 19:28:26,476 - Validation score increased.  Saving model ...
2025-03-05 19:28:51,520 - {'epoch': 20, 'rec_loss': '7.3344'}
2025-03-05 19:29:01,051 - {'Epoch': 20, 'HR@5': '0.0873', 'NDCG@5': '0.0633', 'HR@10': '0.1194', 'NDCG@10': '0.0737', 'HR@20': '0.1576', 'NDCG@20': '0.0833'}
2025-03-05 19:29:01,061 - Validation score increased.  Saving model ...
2025-03-05 19:29:22,807 - {'epoch': 21, 'rec_loss': '7.3136'}
2025-03-05 19:29:30,647 - {'Epoch': 21, 'HR@5': '0.0879', 'NDCG@5': '0.0635', 'HR@10': '0.1207', 'NDCG@10': '0.0740', 'HR@20': '0.1596', 'NDCG@20': '0.0838'}
2025-03-05 19:29:30,656 - Validation score increased.  Saving model ...
2025-03-05 19:29:46,353 - {'epoch': 22, 'rec_loss': '7.2839'}
2025-03-05 19:29:53,887 - {'Epoch': 22, 'HR@5': '0.0894', 'NDCG@5': '0.0643', 'HR@10': '0.1226', 'NDCG@10': '0.0750', 'HR@20': '0.1612', 'NDCG@20': '0.0848'}
2025-03-05 19:29:53,893 - Validation score increased.  Saving model ...
2025-03-05 19:30:09,477 - {'epoch': 23, 'rec_loss': '7.2816'}
2025-03-05 19:30:17,347 - {'Epoch': 23, 'HR@5': '0.0904', 'NDCG@5': '0.0649', 'HR@10': '0.1228', 'NDCG@10': '0.0753', 'HR@20': '0.1618', 'NDCG@20': '0.0851'}
2025-03-05 19:30:17,354 - Validation score increased.  Saving model ...
2025-03-05 19:30:37,764 - {'epoch': 24, 'rec_loss': '7.2728'}
2025-03-05 19:30:47,734 - {'Epoch': 24, 'HR@5': '0.0891', 'NDCG@5': '0.0640', 'HR@10': '0.1230', 'NDCG@10': '0.0750', 'HR@20': '0.1633', 'NDCG@20': '0.0851'}
2025-03-05 19:30:47,746 - EarlyStopping counter: 1 out of 10
2025-03-05 19:31:13,720 - {'epoch': 25, 'rec_loss': '7.2502'}
2025-03-05 19:31:24,016 - {'Epoch': 25, 'HR@5': '0.0894', 'NDCG@5': '0.0637', 'HR@10': '0.1236', 'NDCG@10': '0.0747', 'HR@20': '0.1636', 'NDCG@20': '0.0848'}
2025-03-05 19:31:24,025 - EarlyStopping counter: 2 out of 10
2025-03-05 19:31:49,724 - {'epoch': 26, 'rec_loss': '7.2413'}
2025-03-05 19:31:59,342 - {'Epoch': 26, 'HR@5': '0.0906', 'NDCG@5': '0.0652', 'HR@10': '0.1238', 'NDCG@10': '0.0760', 'HR@20': '0.1627', 'NDCG@20': '0.0858'}
2025-03-05 19:31:59,349 - Validation score increased.  Saving model ...
2025-03-05 19:32:15,456 - {'epoch': 27, 'rec_loss': '7.2202'}
2025-03-05 19:32:23,461 - {'Epoch': 27, 'HR@5': '0.0902', 'NDCG@5': '0.0648', 'HR@10': '0.1237', 'NDCG@10': '0.0756', 'HR@20': '0.1648', 'NDCG@20': '0.0860'}
2025-03-05 19:32:23,469 - Validation score increased.  Saving model ...
2025-03-05 19:32:41,089 - {'epoch': 28, 'rec_loss': '7.2239'}
2025-03-05 19:32:48,937 - {'Epoch': 28, 'HR@5': '0.0897', 'NDCG@5': '0.0646', 'HR@10': '0.1238', 'NDCG@10': '0.0756', 'HR@20': '0.1639', 'NDCG@20': '0.0857'}
2025-03-05 19:32:48,944 - EarlyStopping counter: 1 out of 10
2025-03-05 19:33:06,174 - {'epoch': 29, 'rec_loss': '7.1978'}
2025-03-05 19:33:15,207 - {'Epoch': 29, 'HR@5': '0.0905', 'NDCG@5': '0.0650', 'HR@10': '0.1242', 'NDCG@10': '0.0758', 'HR@20': '0.1651', 'NDCG@20': '0.0861'}
2025-03-05 19:33:15,213 - Validation score increased.  Saving model ...
2025-03-05 19:33:41,400 - {'epoch': 30, 'rec_loss': '7.1957'}
2025-03-05 19:33:50,840 - {'Epoch': 30, 'HR@5': '0.0906', 'NDCG@5': '0.0652', 'HR@10': '0.1250', 'NDCG@10': '0.0763', 'HR@20': '0.1639', 'NDCG@20': '0.0861'}
2025-03-05 19:33:50,847 - Validation score increased.  Saving model ...
2025-03-05 19:34:16,268 - {'epoch': 31, 'rec_loss': '7.1812'}
2025-03-05 19:34:26,629 - {'Epoch': 31, 'HR@5': '0.0913', 'NDCG@5': '0.0653', 'HR@10': '0.1250', 'NDCG@10': '0.0761', 'HR@20': '0.1644', 'NDCG@20': '0.0861'}
2025-03-05 19:34:26,638 - EarlyStopping counter: 1 out of 10
2025-03-05 19:34:51,185 - {'epoch': 32, 'rec_loss': '7.1705'}
2025-03-05 19:34:58,687 - {'Epoch': 32, 'HR@5': '0.0920', 'NDCG@5': '0.0656', 'HR@10': '0.1258', 'NDCG@10': '0.0765', 'HR@20': '0.1647', 'NDCG@20': '0.0863'}
2025-03-05 19:34:58,696 - Validation score increased.  Saving model ...
2025-03-05 19:35:16,476 - {'epoch': 33, 'rec_loss': '7.1585'}
2025-03-05 19:35:24,397 - {'Epoch': 33, 'HR@5': '0.0907', 'NDCG@5': '0.0652', 'HR@10': '0.1253', 'NDCG@10': '0.0764', 'HR@20': '0.1654', 'NDCG@20': '0.0865'}
2025-03-05 19:35:24,404 - Validation score increased.  Saving model ...
2025-03-05 19:35:42,852 - {'epoch': 34, 'rec_loss': '7.1615'}
2025-03-05 19:35:50,509 - {'Epoch': 34, 'HR@5': '0.0933', 'NDCG@5': '0.0672', 'HR@10': '0.1257', 'NDCG@10': '0.0776', 'HR@20': '0.1665', 'NDCG@20': '0.0879'}
2025-03-05 19:35:50,517 - Validation score increased.  Saving model ...
2025-03-05 19:36:11,094 - {'epoch': 35, 'rec_loss': '7.1485'}
2025-03-05 19:36:21,378 - {'Epoch': 35, 'HR@5': '0.0946', 'NDCG@5': '0.0674', 'HR@10': '0.1260', 'NDCG@10': '0.0774', 'HR@20': '0.1665', 'NDCG@20': '0.0877'}
2025-03-05 19:36:21,387 - EarlyStopping counter: 1 out of 10
2025-03-05 19:36:46,374 - {'epoch': 36, 'rec_loss': '7.1401'}
2025-03-05 19:36:56,808 - {'Epoch': 36, 'HR@5': '0.0940', 'NDCG@5': '0.0667', 'HR@10': '0.1268', 'NDCG@10': '0.0773', 'HR@20': '0.1659', 'NDCG@20': '0.0871'}
2025-03-05 19:36:56,815 - EarlyStopping counter: 2 out of 10
2025-03-05 19:37:22,349 - {'epoch': 37, 'rec_loss': '7.1372'}
2025-03-05 19:37:32,252 - {'Epoch': 37, 'HR@5': '0.0930', 'NDCG@5': '0.0661', 'HR@10': '0.1264', 'NDCG@10': '0.0769', 'HR@20': '0.1647', 'NDCG@20': '0.0866'}
2025-03-05 19:37:32,261 - EarlyStopping counter: 3 out of 10
2025-03-05 19:37:50,460 - {'epoch': 38, 'rec_loss': '7.1280'}
2025-03-05 19:37:58,403 - {'Epoch': 38, 'HR@5': '0.0930', 'NDCG@5': '0.0664', 'HR@10': '0.1260', 'NDCG@10': '0.0770', 'HR@20': '0.1677', 'NDCG@20': '0.0876'}
2025-03-05 19:37:58,409 - EarlyStopping counter: 4 out of 10
2025-03-05 19:38:17,223 - {'epoch': 39, 'rec_loss': '7.1235'}
2025-03-05 19:38:25,468 - {'Epoch': 39, 'HR@5': '0.0920', 'NDCG@5': '0.0661', 'HR@10': '0.1254', 'NDCG@10': '0.0769', 'HR@20': '0.1658', 'NDCG@20': '0.0871'}
2025-03-05 19:38:25,480 - EarlyStopping counter: 5 out of 10
2025-03-05 19:38:42,128 - {'epoch': 40, 'rec_loss': '7.1071'}
2025-03-05 19:38:52,019 - {'Epoch': 40, 'HR@5': '0.0933', 'NDCG@5': '0.0670', 'HR@10': '0.1266', 'NDCG@10': '0.0777', 'HR@20': '0.1682', 'NDCG@20': '0.0882'}
2025-03-05 19:38:52,027 - Validation score increased.  Saving model ...
2025-03-05 19:39:18,012 - {'epoch': 41, 'rec_loss': '7.1037'}
2025-03-05 19:39:27,985 - {'Epoch': 41, 'HR@5': '0.0945', 'NDCG@5': '0.0671', 'HR@10': '0.1280', 'NDCG@10': '0.0779', 'HR@20': '0.1687', 'NDCG@20': '0.0881'}
2025-03-05 19:39:27,995 - EarlyStopping counter: 1 out of 10
2025-03-05 19:39:53,660 - {'epoch': 42, 'rec_loss': '7.1035'}
2025-03-05 19:40:03,866 - {'Epoch': 42, 'HR@5': '0.0939', 'NDCG@5': '0.0666', 'HR@10': '0.1262', 'NDCG@10': '0.0770', 'HR@20': '0.1666', 'NDCG@20': '0.0872'}
2025-03-05 19:40:03,879 - EarlyStopping counter: 2 out of 10
2025-03-05 19:40:25,113 - {'epoch': 43, 'rec_loss': '7.0937'}
2025-03-05 19:40:33,052 - {'Epoch': 43, 'HR@5': '0.0943', 'NDCG@5': '0.0671', 'HR@10': '0.1275', 'NDCG@10': '0.0779', 'HR@20': '0.1680', 'NDCG@20': '0.0881'}
2025-03-05 19:40:33,063 - EarlyStopping counter: 3 out of 10
2025-03-05 19:40:49,971 - {'epoch': 44, 'rec_loss': '7.0866'}
2025-03-05 19:40:57,485 - {'Epoch': 44, 'HR@5': '0.0945', 'NDCG@5': '0.0675', 'HR@10': '0.1264', 'NDCG@10': '0.0777', 'HR@20': '0.1671', 'NDCG@20': '0.0880'}
2025-03-05 19:40:57,492 - EarlyStopping counter: 4 out of 10
2025-03-05 19:41:16,259 - {'epoch': 45, 'rec_loss': '7.0884'}
2025-03-05 19:41:24,098 - {'Epoch': 45, 'HR@5': '0.0950', 'NDCG@5': '0.0673', 'HR@10': '0.1282', 'NDCG@10': '0.0780', 'HR@20': '0.1689', 'NDCG@20': '0.0883'}
2025-03-05 19:41:24,105 - Validation score increased.  Saving model ...
2025-03-05 19:41:46,397 - {'epoch': 46, 'rec_loss': '7.0912'}
2025-03-05 19:41:56,318 - {'Epoch': 46, 'HR@5': '0.0942', 'NDCG@5': '0.0667', 'HR@10': '0.1272', 'NDCG@10': '0.0774', 'HR@20': '0.1687', 'NDCG@20': '0.0878'}
2025-03-05 19:41:56,327 - EarlyStopping counter: 1 out of 10
2025-03-05 19:42:22,671 - {'epoch': 47, 'rec_loss': '7.0654'}
2025-03-05 19:42:33,464 - {'Epoch': 47, 'HR@5': '0.0946', 'NDCG@5': '0.0675', 'HR@10': '0.1279', 'NDCG@10': '0.0782', 'HR@20': '0.1689', 'NDCG@20': '0.0885'}
2025-03-05 19:42:33,473 - Validation score increased.  Saving model ...
2025-03-05 19:43:00,058 - {'epoch': 48, 'rec_loss': '7.0742'}
2025-03-05 19:43:08,911 - {'Epoch': 48, 'HR@5': '0.0958', 'NDCG@5': '0.0679', 'HR@10': '0.1277', 'NDCG@10': '0.0783', 'HR@20': '0.1694', 'NDCG@20': '0.0888'}
2025-03-05 19:43:08,922 - Validation score increased.  Saving model ...
2025-03-05 19:43:26,664 - {'epoch': 49, 'rec_loss': '7.0655'}
2025-03-05 19:43:34,506 - {'Epoch': 49, 'HR@5': '0.0948', 'NDCG@5': '0.0679', 'HR@10': '0.1279', 'NDCG@10': '0.0786', 'HR@20': '0.1685', 'NDCG@20': '0.0888'}
2025-03-05 19:43:34,511 - Validation score increased.  Saving model ...
2025-03-05 19:43:52,513 - {'epoch': 50, 'rec_loss': '7.0652'}
2025-03-05 19:44:01,040 - {'Epoch': 50, 'HR@5': '0.0948', 'NDCG@5': '0.0677', 'HR@10': '0.1272', 'NDCG@10': '0.0781', 'HR@20': '0.1679', 'NDCG@20': '0.0884'}
2025-03-05 19:44:01,052 - EarlyStopping counter: 1 out of 10
2025-03-05 19:44:20,323 - {'epoch': 51, 'rec_loss': '7.0570'}
2025-03-05 19:44:30,010 - {'Epoch': 51, 'HR@5': '0.0954', 'NDCG@5': '0.0685', 'HR@10': '0.1292', 'NDCG@10': '0.0795', 'HR@20': '0.1685', 'NDCG@20': '0.0894'}
2025-03-05 19:44:30,017 - Validation score increased.  Saving model ...
2025-03-05 19:44:55,606 - {'epoch': 52, 'rec_loss': '7.0543'}
2025-03-05 19:45:05,628 - {'Epoch': 52, 'HR@5': '0.0957', 'NDCG@5': '0.0682', 'HR@10': '0.1291', 'NDCG@10': '0.0790', 'HR@20': '0.1694', 'NDCG@20': '0.0892'}
2025-03-05 19:45:05,641 - EarlyStopping counter: 1 out of 10
2025-03-05 19:45:32,049 - {'epoch': 53, 'rec_loss': '7.0499'}
2025-03-05 19:45:42,151 - {'Epoch': 53, 'HR@5': '0.0950', 'NDCG@5': '0.0681', 'HR@10': '0.1281', 'NDCG@10': '0.0788', 'HR@20': '0.1690', 'NDCG@20': '0.0891'}
2025-03-05 19:45:42,166 - EarlyStopping counter: 2 out of 10
2025-03-05 19:46:02,575 - {'epoch': 54, 'rec_loss': '7.0514'}
2025-03-05 19:46:09,713 - {'Epoch': 54, 'HR@5': '0.0955', 'NDCG@5': '0.0683', 'HR@10': '0.1298', 'NDCG@10': '0.0793', 'HR@20': '0.1691', 'NDCG@20': '0.0892'}
2025-03-05 19:46:09,720 - EarlyStopping counter: 3 out of 10
2025-03-05 19:46:25,247 - {'epoch': 55, 'rec_loss': '7.0465'}
2025-03-05 19:46:32,897 - {'Epoch': 55, 'HR@5': '0.0957', 'NDCG@5': '0.0684', 'HR@10': '0.1293', 'NDCG@10': '0.0792', 'HR@20': '0.1687', 'NDCG@20': '0.0891'}
2025-03-05 19:46:32,904 - EarlyStopping counter: 4 out of 10
2025-03-05 19:46:50,150 - {'epoch': 56, 'rec_loss': '7.0374'}
2025-03-05 19:46:57,846 - {'Epoch': 56, 'HR@5': '0.0956', 'NDCG@5': '0.0681', 'HR@10': '0.1305', 'NDCG@10': '0.0793', 'HR@20': '0.1686', 'NDCG@20': '0.0888'}
2025-03-05 19:46:57,854 - EarlyStopping counter: 5 out of 10
2025-03-05 19:47:19,816 - {'epoch': 57, 'rec_loss': '7.0304'}
2025-03-05 19:47:30,191 - {'Epoch': 57, 'HR@5': '0.0950', 'NDCG@5': '0.0682', 'HR@10': '0.1296', 'NDCG@10': '0.0794', 'HR@20': '0.1708', 'NDCG@20': '0.0898'}
2025-03-05 19:47:30,199 - Validation score increased.  Saving model ...
2025-03-05 19:47:55,053 - {'epoch': 58, 'rec_loss': '7.0346'}
2025-03-05 19:48:05,505 - {'Epoch': 58, 'HR@5': '0.0959', 'NDCG@5': '0.0679', 'HR@10': '0.1293', 'NDCG@10': '0.0786', 'HR@20': '0.1695', 'NDCG@20': '0.0888'}
2025-03-05 19:48:05,514 - EarlyStopping counter: 1 out of 10
2025-03-05 19:48:31,597 - {'epoch': 59, 'rec_loss': '7.0283'}
2025-03-05 19:48:41,242 - {'Epoch': 59, 'HR@5': '0.0957', 'NDCG@5': '0.0679', 'HR@10': '0.1304', 'NDCG@10': '0.0791', 'HR@20': '0.1693', 'NDCG@20': '0.0889'}
2025-03-05 19:48:41,249 - EarlyStopping counter: 2 out of 10
2025-03-05 19:48:58,129 - {'epoch': 60, 'rec_loss': '7.0277'}
2025-03-05 19:49:06,137 - {'Epoch': 60, 'HR@5': '0.0945', 'NDCG@5': '0.0676', 'HR@10': '0.1295', 'NDCG@10': '0.0788', 'HR@20': '0.1697', 'NDCG@20': '0.0890'}
2025-03-05 19:49:06,144 - EarlyStopping counter: 3 out of 10
2025-03-05 19:49:24,525 - {'epoch': 61, 'rec_loss': '7.0040'}
2025-03-05 19:49:32,376 - {'Epoch': 61, 'HR@5': '0.0970', 'NDCG@5': '0.0693', 'HR@10': '0.1291', 'NDCG@10': '0.0796', 'HR@20': '0.1698', 'NDCG@20': '0.0898'}
2025-03-05 19:49:32,385 - Validation score increased.  Saving model ...
2025-03-05 19:49:48,368 - {'epoch': 62, 'rec_loss': '7.0281'}
2025-03-05 19:49:58,296 - {'Epoch': 62, 'HR@5': '0.0962', 'NDCG@5': '0.0684', 'HR@10': '0.1294', 'NDCG@10': '0.0791', 'HR@20': '0.1698', 'NDCG@20': '0.0893'}
2025-03-05 19:49:58,306 - EarlyStopping counter: 1 out of 10
2025-03-05 19:50:25,769 - {'epoch': 63, 'rec_loss': '7.0111'}
2025-03-05 19:50:36,165 - {'Epoch': 63, 'HR@5': '0.0954', 'NDCG@5': '0.0684', 'HR@10': '0.1295', 'NDCG@10': '0.0793', 'HR@20': '0.1692', 'NDCG@20': '0.0893'}
2025-03-05 19:50:36,175 - EarlyStopping counter: 2 out of 10
2025-03-05 19:51:02,465 - {'epoch': 64, 'rec_loss': '7.0139'}
2025-03-05 19:51:12,852 - {'Epoch': 64, 'HR@5': '0.0950', 'NDCG@5': '0.0683', 'HR@10': '0.1284', 'NDCG@10': '0.0791', 'HR@20': '0.1699', 'NDCG@20': '0.0896'}
2025-03-05 19:51:12,862 - EarlyStopping counter: 3 out of 10
2025-03-05 19:51:33,825 - {'epoch': 65, 'rec_loss': '7.0064'}
2025-03-05 19:51:41,373 - {'Epoch': 65, 'HR@5': '0.0964', 'NDCG@5': '0.0687', 'HR@10': '0.1298', 'NDCG@10': '0.0795', 'HR@20': '0.1704', 'NDCG@20': '0.0897'}
2025-03-05 19:51:41,381 - EarlyStopping counter: 4 out of 10
2025-03-05 19:51:59,762 - {'epoch': 66, 'rec_loss': '7.0109'}
2025-03-05 19:52:07,264 - {'Epoch': 66, 'HR@5': '0.0964', 'NDCG@5': '0.0690', 'HR@10': '0.1282', 'NDCG@10': '0.0792', 'HR@20': '0.1723', 'NDCG@20': '0.0903'}
2025-03-05 19:52:07,272 - Validation score increased.  Saving model ...
2025-03-05 19:52:24,468 - {'epoch': 67, 'rec_loss': '7.0009'}
2025-03-05 19:52:32,023 - {'Epoch': 67, 'HR@5': '0.0958', 'NDCG@5': '0.0687', 'HR@10': '0.1292', 'NDCG@10': '0.0794', 'HR@20': '0.1698', 'NDCG@20': '0.0897'}
2025-03-05 19:52:32,030 - EarlyStopping counter: 1 out of 10
2025-03-05 19:52:55,572 - {'epoch': 68, 'rec_loss': '7.0112'}
2025-03-05 19:53:05,653 - {'Epoch': 68, 'HR@5': '0.0968', 'NDCG@5': '0.0692', 'HR@10': '0.1301', 'NDCG@10': '0.0799', 'HR@20': '0.1709', 'NDCG@20': '0.0902'}
2025-03-05 19:53:05,663 - EarlyStopping counter: 2 out of 10
2025-03-05 19:53:30,352 - {'epoch': 69, 'rec_loss': '6.9933'}
2025-03-05 19:53:40,317 - {'Epoch': 69, 'HR@5': '0.0941', 'NDCG@5': '0.0674', 'HR@10': '0.1284', 'NDCG@10': '0.0785', 'HR@20': '0.1702', 'NDCG@20': '0.0891'}
2025-03-05 19:53:40,328 - EarlyStopping counter: 3 out of 10
2025-03-05 19:54:05,749 - {'epoch': 70, 'rec_loss': '6.9963'}
2025-03-05 19:54:14,512 - {'Epoch': 70, 'HR@5': '0.0957', 'NDCG@5': '0.0685', 'HR@10': '0.1289', 'NDCG@10': '0.0792', 'HR@20': '0.1710', 'NDCG@20': '0.0898'}
2025-03-05 19:54:14,521 - EarlyStopping counter: 4 out of 10
2025-03-05 19:54:31,889 - {'epoch': 71, 'rec_loss': '6.9963'}
2025-03-05 19:54:39,410 - {'Epoch': 71, 'HR@5': '0.0959', 'NDCG@5': '0.0685', 'HR@10': '0.1281', 'NDCG@10': '0.0789', 'HR@20': '0.1709', 'NDCG@20': '0.0897'}
2025-03-05 19:54:39,416 - EarlyStopping counter: 5 out of 10
2025-03-05 19:54:57,280 - {'epoch': 72, 'rec_loss': '6.9858'}
2025-03-05 19:55:05,259 - {'Epoch': 72, 'HR@5': '0.0956', 'NDCG@5': '0.0689', 'HR@10': '0.1292', 'NDCG@10': '0.0797', 'HR@20': '0.1690', 'NDCG@20': '0.0897'}
2025-03-05 19:55:05,268 - EarlyStopping counter: 6 out of 10
2025-03-05 19:55:22,428 - {'epoch': 73, 'rec_loss': '6.9857'}
2025-03-05 19:55:33,106 - {'Epoch': 73, 'HR@5': '0.0951', 'NDCG@5': '0.0686', 'HR@10': '0.1288', 'NDCG@10': '0.0794', 'HR@20': '0.1699', 'NDCG@20': '0.0898'}
2025-03-05 19:55:33,113 - EarlyStopping counter: 7 out of 10
2025-03-05 19:55:59,423 - {'epoch': 74, 'rec_loss': '6.9875'}
2025-03-05 19:56:09,135 - {'Epoch': 74, 'HR@5': '0.0942', 'NDCG@5': '0.0684', 'HR@10': '0.1287', 'NDCG@10': '0.0795', 'HR@20': '0.1704', 'NDCG@20': '0.0900'}
2025-03-05 19:56:09,144 - EarlyStopping counter: 8 out of 10
2025-03-05 19:56:35,798 - {'epoch': 75, 'rec_loss': '6.9820'}
2025-03-05 19:56:46,311 - {'Epoch': 75, 'HR@5': '0.0949', 'NDCG@5': '0.0680', 'HR@10': '0.1283', 'NDCG@10': '0.0787', 'HR@20': '0.1704', 'NDCG@20': '0.0894'}
2025-03-05 19:56:46,322 - EarlyStopping counter: 9 out of 10
2025-03-05 19:57:05,567 - {'epoch': 76, 'rec_loss': '6.9726'}
2025-03-05 19:57:13,123 - {'Epoch': 76, 'HR@5': '0.0957', 'NDCG@5': '0.0687', 'HR@10': '0.1298', 'NDCG@10': '0.0797', 'HR@20': '0.1715', 'NDCG@20': '0.0902'}
2025-03-05 19:57:13,124 - EarlyStopping counter: 10 out of 10
2025-03-05 19:57:13,124 - Early stopping
2025-03-05 19:57:13,124 - ---------------Test Score---------------
2025-03-05 19:57:21,195 - {'Epoch': 0, 'HR@5': '0.0783', 'NDCG@5': '0.0558', 'HR@10': '0.1080', 'NDCG@10': '0.0654', 'HR@20': '0.1444', 'NDCG@20': '0.0746'}
2025-03-05 19:57:21,203 - Scale_Toys
2025-03-05 19:57:21,204 - {'Epoch': 0, 'HR@5': '0.0783', 'NDCG@5': '0.0558', 'HR@10': '0.1080', 'NDCG@10': '0.0654', 'HR@20': '0.1444', 'NDCG@20': '0.0746'}
2025-03-05 20:49:31,892 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-03-05 20:49:35,049 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-05 20:49:35,054 - Total Parameters: 917142
2025-03-05 20:50:01,197 - {'epoch': 0, 'rec_loss': '9.1134'}
2025-03-05 20:50:09,397 - {'Epoch': 0, 'HR@5': '0.0070', 'NDCG@5': '0.0046', 'HR@10': '0.0104', 'NDCG@10': '0.0057', 'HR@20': '0.0169', 'NDCG@20': '0.0073'}
2025-03-05 20:50:09,403 - Validation score increased.  Saving model ...
2025-03-05 20:50:34,770 - {'epoch': 1, 'rec_loss': '8.7566'}
2025-03-05 20:50:42,778 - {'Epoch': 1, 'HR@5': '0.0139', 'NDCG@5': '0.0088', 'HR@10': '0.0214', 'NDCG@10': '0.0113', 'HR@20': '0.0343', 'NDCG@20': '0.0145'}
2025-03-05 20:50:42,785 - Validation score increased.  Saving model ...
2025-03-05 20:51:07,277 - {'epoch': 2, 'rec_loss': '8.4626'}
2025-03-05 20:51:15,416 - {'Epoch': 2, 'HR@5': '0.0288', 'NDCG@5': '0.0211', 'HR@10': '0.0418', 'NDCG@10': '0.0254', 'HR@20': '0.0609', 'NDCG@20': '0.0301'}
2025-03-05 20:51:15,426 - Validation score increased.  Saving model ...
2025-03-05 20:51:39,478 - {'epoch': 3, 'rec_loss': '8.2088'}
2025-03-05 20:51:47,447 - {'Epoch': 3, 'HR@5': '0.0441', 'NDCG@5': '0.0316', 'HR@10': '0.0611', 'NDCG@10': '0.0371', 'HR@20': '0.0844', 'NDCG@20': '0.0430'}
2025-03-05 20:51:47,457 - Validation score increased.  Saving model ...
2025-03-05 20:52:11,848 - {'epoch': 4, 'rec_loss': '7.9918'}
2025-03-05 20:52:19,494 - {'Epoch': 4, 'HR@5': '0.0549', 'NDCG@5': '0.0398', 'HR@10': '0.0745', 'NDCG@10': '0.0461', 'HR@20': '0.1015', 'NDCG@20': '0.0529'}
2025-03-05 20:52:19,502 - Validation score increased.  Saving model ...
2025-03-05 20:52:43,724 - {'epoch': 5, 'rec_loss': '7.8235'}
2025-03-05 20:52:51,456 - {'Epoch': 5, 'HR@5': '0.0638', 'NDCG@5': '0.0466', 'HR@10': '0.0846', 'NDCG@10': '0.0533', 'HR@20': '0.1158', 'NDCG@20': '0.0612'}
2025-03-05 20:52:51,463 - Validation score increased.  Saving model ...
2025-03-05 20:53:17,474 - {'epoch': 6, 'rec_loss': '7.6982'}
2025-03-05 20:53:25,140 - {'Epoch': 6, 'HR@5': '0.0673', 'NDCG@5': '0.0487', 'HR@10': '0.0923', 'NDCG@10': '0.0567', 'HR@20': '0.1251', 'NDCG@20': '0.0650'}
2025-03-05 20:53:25,147 - Validation score increased.  Saving model ...
2025-03-05 20:53:50,015 - {'epoch': 7, 'rec_loss': '7.5987'}
2025-03-05 20:53:57,845 - {'Epoch': 7, 'HR@5': '0.0738', 'NDCG@5': '0.0532', 'HR@10': '0.1000', 'NDCG@10': '0.0617', 'HR@20': '0.1336', 'NDCG@20': '0.0701'}
2025-03-05 20:53:57,859 - Validation score increased.  Saving model ...
2025-03-05 20:54:20,829 - {'epoch': 8, 'rec_loss': '7.5154'}
2025-03-05 20:54:28,479 - {'Epoch': 8, 'HR@5': '0.0777', 'NDCG@5': '0.0562', 'HR@10': '0.1046', 'NDCG@10': '0.0650', 'HR@20': '0.1372', 'NDCG@20': '0.0732'}
2025-03-05 20:54:28,487 - Validation score increased.  Saving model ...
2025-03-05 20:54:55,158 - {'epoch': 9, 'rec_loss': '7.4507'}
2025-03-05 20:55:03,495 - {'Epoch': 9, 'HR@5': '0.0788', 'NDCG@5': '0.0573', 'HR@10': '0.1065', 'NDCG@10': '0.0662', 'HR@20': '0.1437', 'NDCG@20': '0.0756'}
2025-03-05 20:55:03,502 - Validation score increased.  Saving model ...
2025-03-05 20:55:28,696 - {'epoch': 10, 'rec_loss': '7.3964'}
2025-03-05 20:55:36,463 - {'Epoch': 10, 'HR@5': '0.0797', 'NDCG@5': '0.0583', 'HR@10': '0.1109', 'NDCG@10': '0.0683', 'HR@20': '0.1468', 'NDCG@20': '0.0774'}
2025-03-05 20:55:36,472 - Validation score increased.  Saving model ...
2025-03-05 20:56:02,106 - {'epoch': 11, 'rec_loss': '7.3493'}
2025-03-05 20:56:10,827 - {'Epoch': 11, 'HR@5': '0.0819', 'NDCG@5': '0.0603', 'HR@10': '0.1120', 'NDCG@10': '0.0701', 'HR@20': '0.1483', 'NDCG@20': '0.0792'}
2025-03-05 20:56:10,835 - Validation score increased.  Saving model ...
2025-03-05 20:56:38,202 - {'epoch': 12, 'rec_loss': '7.3080'}
2025-03-05 20:56:46,490 - {'Epoch': 12, 'HR@5': '0.0852', 'NDCG@5': '0.0610', 'HR@10': '0.1149', 'NDCG@10': '0.0706', 'HR@20': '0.1517', 'NDCG@20': '0.0799'}
2025-03-05 20:56:46,501 - Validation score increased.  Saving model ...
2025-03-05 20:57:10,938 - {'epoch': 13, 'rec_loss': '7.2718'}
2025-03-05 20:57:19,246 - {'Epoch': 13, 'HR@5': '0.0853', 'NDCG@5': '0.0623', 'HR@10': '0.1158', 'NDCG@10': '0.0721', 'HR@20': '0.1517', 'NDCG@20': '0.0812'}
2025-03-05 20:57:19,254 - Validation score increased.  Saving model ...
2025-03-05 20:57:45,055 - {'epoch': 14, 'rec_loss': '7.2410'}
2025-03-05 20:57:53,444 - {'Epoch': 14, 'HR@5': '0.0853', 'NDCG@5': '0.0618', 'HR@10': '0.1151', 'NDCG@10': '0.0714', 'HR@20': '0.1511', 'NDCG@20': '0.0805'}
2025-03-05 20:57:53,452 - EarlyStopping counter: 1 out of 10
2025-03-05 20:58:18,979 - {'epoch': 15, 'rec_loss': '7.2165'}
2025-03-05 20:58:27,154 - {'Epoch': 15, 'HR@5': '0.0864', 'NDCG@5': '0.0630', 'HR@10': '0.1160', 'NDCG@10': '0.0725', 'HR@20': '0.1539', 'NDCG@20': '0.0821'}
2025-03-05 20:58:27,158 - Validation score increased.  Saving model ...
2025-03-05 20:58:52,956 - {'epoch': 16, 'rec_loss': '7.1916'}
2025-03-05 20:59:01,790 - {'Epoch': 16, 'HR@5': '0.0875', 'NDCG@5': '0.0638', 'HR@10': '0.1168', 'NDCG@10': '0.0732', 'HR@20': '0.1546', 'NDCG@20': '0.0828'}
2025-03-05 20:59:01,795 - Validation score increased.  Saving model ...
2025-03-05 20:59:26,998 - {'epoch': 17, 'rec_loss': '7.1644'}
2025-03-05 20:59:35,562 - {'Epoch': 17, 'HR@5': '0.0886', 'NDCG@5': '0.0638', 'HR@10': '0.1190', 'NDCG@10': '0.0735', 'HR@20': '0.1542', 'NDCG@20': '0.0824'}
2025-03-05 20:59:35,570 - EarlyStopping counter: 1 out of 10
2025-03-05 21:00:00,131 - {'epoch': 18, 'rec_loss': '7.1451'}
2025-03-05 21:00:09,085 - {'Epoch': 18, 'HR@5': '0.0885', 'NDCG@5': '0.0640', 'HR@10': '0.1181', 'NDCG@10': '0.0736', 'HR@20': '0.1552', 'NDCG@20': '0.0829'}
2025-03-05 21:00:09,089 - Validation score increased.  Saving model ...
2025-03-05 21:00:34,258 - {'epoch': 19, 'rec_loss': '7.1312'}
2025-03-05 21:00:42,294 - {'Epoch': 19, 'HR@5': '0.0896', 'NDCG@5': '0.0644', 'HR@10': '0.1196', 'NDCG@10': '0.0740', 'HR@20': '0.1571', 'NDCG@20': '0.0835'}
2025-03-05 21:00:42,301 - Validation score increased.  Saving model ...
2025-03-05 21:01:07,518 - {'epoch': 20, 'rec_loss': '7.1146'}
2025-03-05 21:01:15,362 - {'Epoch': 20, 'HR@5': '0.0896', 'NDCG@5': '0.0643', 'HR@10': '0.1198', 'NDCG@10': '0.0741', 'HR@20': '0.1570', 'NDCG@20': '0.0835'}
2025-03-05 21:01:15,366 - EarlyStopping counter: 1 out of 10
2025-03-05 21:01:39,799 - {'epoch': 21, 'rec_loss': '7.0946'}
2025-03-05 21:01:47,787 - {'Epoch': 21, 'HR@5': '0.0892', 'NDCG@5': '0.0645', 'HR@10': '0.1212', 'NDCG@10': '0.0748', 'HR@20': '0.1579', 'NDCG@20': '0.0841'}
2025-03-05 21:01:47,794 - Validation score increased.  Saving model ...
2025-03-05 21:02:11,776 - {'epoch': 22, 'rec_loss': '7.0787'}
2025-03-05 21:02:20,060 - {'Epoch': 22, 'HR@5': '0.0905', 'NDCG@5': '0.0655', 'HR@10': '0.1200', 'NDCG@10': '0.0750', 'HR@20': '0.1562', 'NDCG@20': '0.0841'}
2025-03-05 21:02:20,072 - Validation score increased.  Saving model ...
2025-03-05 21:02:44,775 - {'epoch': 23, 'rec_loss': '7.0656'}
2025-03-05 21:02:53,038 - {'Epoch': 23, 'HR@5': '0.0913', 'NDCG@5': '0.0655', 'HR@10': '0.1226', 'NDCG@10': '0.0755', 'HR@20': '0.1577', 'NDCG@20': '0.0843'}
2025-03-05 21:02:53,041 - Validation score increased.  Saving model ...
2025-03-05 21:03:16,012 - {'epoch': 24, 'rec_loss': '7.0587'}
2025-03-05 21:03:24,018 - {'Epoch': 24, 'HR@5': '0.0903', 'NDCG@5': '0.0657', 'HR@10': '0.1213', 'NDCG@10': '0.0758', 'HR@20': '0.1577', 'NDCG@20': '0.0849'}
2025-03-05 21:03:24,024 - Validation score increased.  Saving model ...
2025-03-05 21:03:49,236 - {'epoch': 25, 'rec_loss': '7.0413'}
2025-03-05 21:03:57,306 - {'Epoch': 25, 'HR@5': '0.0915', 'NDCG@5': '0.0660', 'HR@10': '0.1226', 'NDCG@10': '0.0760', 'HR@20': '0.1581', 'NDCG@20': '0.0850'}
2025-03-05 21:03:57,311 - Validation score increased.  Saving model ...
2025-03-05 21:04:20,803 - {'epoch': 26, 'rec_loss': '7.0311'}
2025-03-05 21:04:29,118 - {'Epoch': 26, 'HR@5': '0.0917', 'NDCG@5': '0.0663', 'HR@10': '0.1223', 'NDCG@10': '0.0761', 'HR@20': '0.1597', 'NDCG@20': '0.0855'}
2025-03-05 21:04:29,121 - Validation score increased.  Saving model ...
2025-03-05 21:04:53,827 - {'epoch': 27, 'rec_loss': '7.0109'}
2025-03-05 21:05:01,878 - {'Epoch': 27, 'HR@5': '0.0914', 'NDCG@5': '0.0664', 'HR@10': '0.1223', 'NDCG@10': '0.0763', 'HR@20': '0.1587', 'NDCG@20': '0.0855'}
2025-03-05 21:05:01,884 - EarlyStopping counter: 1 out of 10
2025-03-05 21:05:27,150 - {'epoch': 28, 'rec_loss': '7.0031'}
2025-03-05 21:05:35,331 - {'Epoch': 28, 'HR@5': '0.0915', 'NDCG@5': '0.0660', 'HR@10': '0.1207', 'NDCG@10': '0.0754', 'HR@20': '0.1583', 'NDCG@20': '0.0849'}
2025-03-05 21:05:35,337 - EarlyStopping counter: 2 out of 10
2025-03-05 21:06:00,570 - {'epoch': 29, 'rec_loss': '6.9960'}
2025-03-05 21:06:08,482 - {'Epoch': 29, 'HR@5': '0.0930', 'NDCG@5': '0.0667', 'HR@10': '0.1219', 'NDCG@10': '0.0760', 'HR@20': '0.1595', 'NDCG@20': '0.0855'}
2025-03-05 21:06:08,490 - EarlyStopping counter: 3 out of 10
2025-03-05 21:06:32,907 - {'epoch': 30, 'rec_loss': '6.9795'}
2025-03-05 21:06:40,936 - {'Epoch': 30, 'HR@5': '0.0921', 'NDCG@5': '0.0668', 'HR@10': '0.1229', 'NDCG@10': '0.0767', 'HR@20': '0.1608', 'NDCG@20': '0.0863'}
2025-03-05 21:06:40,941 - Validation score increased.  Saving model ...
2025-03-05 21:07:06,036 - {'epoch': 31, 'rec_loss': '6.9835'}
2025-03-05 21:07:13,787 - {'Epoch': 31, 'HR@5': '0.0923', 'NDCG@5': '0.0664', 'HR@10': '0.1235', 'NDCG@10': '0.0765', 'HR@20': '0.1611', 'NDCG@20': '0.0859'}
2025-03-05 21:07:13,791 - EarlyStopping counter: 1 out of 10
2025-03-05 21:07:36,811 - {'epoch': 32, 'rec_loss': '6.9738'}
2025-03-05 21:07:44,542 - {'Epoch': 32, 'HR@5': '0.0924', 'NDCG@5': '0.0666', 'HR@10': '0.1226', 'NDCG@10': '0.0763', 'HR@20': '0.1591', 'NDCG@20': '0.0856'}
2025-03-05 21:07:44,546 - EarlyStopping counter: 2 out of 10
2025-03-05 21:08:08,339 - {'epoch': 33, 'rec_loss': '6.9593'}
2025-03-05 21:08:16,163 - {'Epoch': 33, 'HR@5': '0.0920', 'NDCG@5': '0.0670', 'HR@10': '0.1230', 'NDCG@10': '0.0770', 'HR@20': '0.1611', 'NDCG@20': '0.0866'}
2025-03-05 21:08:16,167 - Validation score increased.  Saving model ...
2025-03-05 21:08:41,138 - {'epoch': 34, 'rec_loss': '6.9581'}
2025-03-05 21:08:49,411 - {'Epoch': 34, 'HR@5': '0.0916', 'NDCG@5': '0.0666', 'HR@10': '0.1224', 'NDCG@10': '0.0766', 'HR@20': '0.1605', 'NDCG@20': '0.0862'}
2025-03-05 21:08:49,421 - EarlyStopping counter: 1 out of 10
2025-03-05 21:09:14,449 - {'epoch': 35, 'rec_loss': '6.9418'}
2025-03-05 21:09:22,454 - {'Epoch': 35, 'HR@5': '0.0924', 'NDCG@5': '0.0672', 'HR@10': '0.1232', 'NDCG@10': '0.0771', 'HR@20': '0.1614', 'NDCG@20': '0.0868'}
2025-03-05 21:09:22,462 - Validation score increased.  Saving model ...
2025-03-05 21:09:47,698 - {'epoch': 36, 'rec_loss': '6.9459'}
2025-03-05 21:09:55,620 - {'Epoch': 36, 'HR@5': '0.0937', 'NDCG@5': '0.0672', 'HR@10': '0.1237', 'NDCG@10': '0.0769', 'HR@20': '0.1594', 'NDCG@20': '0.0859'}
2025-03-05 21:09:55,628 - EarlyStopping counter: 1 out of 10
2025-03-05 21:10:19,023 - {'epoch': 37, 'rec_loss': '6.9365'}
2025-03-05 21:10:26,831 - {'Epoch': 37, 'HR@5': '0.0923', 'NDCG@5': '0.0672', 'HR@10': '0.1243', 'NDCG@10': '0.0775', 'HR@20': '0.1621', 'NDCG@20': '0.0870'}
2025-03-05 21:10:26,835 - Validation score increased.  Saving model ...
2025-03-05 21:10:52,481 - {'epoch': 38, 'rec_loss': '6.9282'}
2025-03-05 21:11:00,409 - {'Epoch': 38, 'HR@5': '0.0927', 'NDCG@5': '0.0672', 'HR@10': '0.1246', 'NDCG@10': '0.0774', 'HR@20': '0.1610', 'NDCG@20': '0.0866'}
2025-03-05 21:11:00,416 - EarlyStopping counter: 1 out of 10
2025-03-05 21:11:25,939 - {'epoch': 39, 'rec_loss': '6.9184'}
2025-03-05 21:11:34,111 - {'Epoch': 39, 'HR@5': '0.0922', 'NDCG@5': '0.0673', 'HR@10': '0.1238', 'NDCG@10': '0.0775', 'HR@20': '0.1604', 'NDCG@20': '0.0867'}
2025-03-05 21:11:34,119 - EarlyStopping counter: 2 out of 10
2025-03-05 21:11:59,201 - {'epoch': 40, 'rec_loss': '6.9138'}
2025-03-05 21:12:07,003 - {'Epoch': 40, 'HR@5': '0.0927', 'NDCG@5': '0.0672', 'HR@10': '0.1232', 'NDCG@10': '0.0771', 'HR@20': '0.1621', 'NDCG@20': '0.0869'}
2025-03-05 21:12:07,009 - EarlyStopping counter: 3 out of 10
2025-03-05 21:12:31,235 - {'epoch': 41, 'rec_loss': '6.9108'}
2025-03-05 21:12:39,249 - {'Epoch': 41, 'HR@5': '0.0918', 'NDCG@5': '0.0667', 'HR@10': '0.1227', 'NDCG@10': '0.0766', 'HR@20': '0.1614', 'NDCG@20': '0.0864'}
2025-03-05 21:12:39,255 - EarlyStopping counter: 4 out of 10
2025-03-05 21:13:02,404 - {'epoch': 42, 'rec_loss': '6.9059'}
2025-03-05 21:13:10,219 - {'Epoch': 42, 'HR@5': '0.0927', 'NDCG@5': '0.0671', 'HR@10': '0.1236', 'NDCG@10': '0.0771', 'HR@20': '0.1601', 'NDCG@20': '0.0863'}
2025-03-05 21:13:10,226 - EarlyStopping counter: 5 out of 10
2025-03-05 21:13:34,610 - {'epoch': 43, 'rec_loss': '6.8947'}
2025-03-05 21:13:42,464 - {'Epoch': 43, 'HR@5': '0.0936', 'NDCG@5': '0.0678', 'HR@10': '0.1236', 'NDCG@10': '0.0775', 'HR@20': '0.1617', 'NDCG@20': '0.0871'}
2025-03-05 21:13:42,470 - Validation score increased.  Saving model ...
2025-03-05 21:14:07,294 - {'epoch': 44, 'rec_loss': '6.8934'}
2025-03-05 21:14:15,390 - {'Epoch': 44, 'HR@5': '0.0917', 'NDCG@5': '0.0664', 'HR@10': '0.1247', 'NDCG@10': '0.0771', 'HR@20': '0.1619', 'NDCG@20': '0.0865'}
2025-03-05 21:14:15,397 - EarlyStopping counter: 1 out of 10
2025-03-05 21:14:39,921 - {'epoch': 45, 'rec_loss': '6.8832'}
2025-03-05 21:14:48,104 - {'Epoch': 45, 'HR@5': '0.0926', 'NDCG@5': '0.0665', 'HR@10': '0.1259', 'NDCG@10': '0.0772', 'HR@20': '0.1616', 'NDCG@20': '0.0862'}
2025-03-05 21:14:48,108 - EarlyStopping counter: 2 out of 10
2025-03-05 21:15:13,657 - {'epoch': 46, 'rec_loss': '6.8762'}
2025-03-05 21:15:21,538 - {'Epoch': 46, 'HR@5': '0.0930', 'NDCG@5': '0.0672', 'HR@10': '0.1239', 'NDCG@10': '0.0772', 'HR@20': '0.1615', 'NDCG@20': '0.0867'}
2025-03-05 21:15:21,542 - EarlyStopping counter: 3 out of 10
2025-03-05 21:15:46,221 - {'epoch': 47, 'rec_loss': '6.8720'}
2025-03-05 21:15:53,994 - {'Epoch': 47, 'HR@5': '0.0907', 'NDCG@5': '0.0662', 'HR@10': '0.1234', 'NDCG@10': '0.0768', 'HR@20': '0.1610', 'NDCG@20': '0.0863'}
2025-03-05 21:15:54,003 - EarlyStopping counter: 4 out of 10
2025-03-05 21:16:19,639 - {'epoch': 48, 'rec_loss': '6.8723'}
2025-03-05 21:16:27,738 - {'Epoch': 48, 'HR@5': '0.0921', 'NDCG@5': '0.0672', 'HR@10': '0.1245', 'NDCG@10': '0.0777', 'HR@20': '0.1622', 'NDCG@20': '0.0872'}
2025-03-05 21:16:27,744 - Validation score increased.  Saving model ...
2025-03-05 21:16:52,354 - {'epoch': 49, 'rec_loss': '6.8635'}
2025-03-05 21:17:00,397 - {'Epoch': 49, 'HR@5': '0.0923', 'NDCG@5': '0.0672', 'HR@10': '0.1240', 'NDCG@10': '0.0774', 'HR@20': '0.1627', 'NDCG@20': '0.0871'}
2025-03-05 21:17:00,402 - EarlyStopping counter: 1 out of 10
2025-03-05 21:17:25,002 - {'epoch': 50, 'rec_loss': '6.8584'}
2025-03-05 21:17:33,779 - {'Epoch': 50, 'HR@5': '0.0930', 'NDCG@5': '0.0676', 'HR@10': '0.1247', 'NDCG@10': '0.0778', 'HR@20': '0.1636', 'NDCG@20': '0.0876'}
2025-03-05 21:17:33,783 - Validation score increased.  Saving model ...
2025-03-05 21:17:58,211 - {'epoch': 51, 'rec_loss': '6.8588'}
2025-03-05 21:18:06,306 - {'Epoch': 51, 'HR@5': '0.0928', 'NDCG@5': '0.0675', 'HR@10': '0.1265', 'NDCG@10': '0.0784', 'HR@20': '0.1637', 'NDCG@20': '0.0878'}
2025-03-05 21:18:06,313 - Validation score increased.  Saving model ...
2025-03-05 21:18:29,993 - {'epoch': 52, 'rec_loss': '6.8612'}
2025-03-05 21:18:38,148 - {'Epoch': 52, 'HR@5': '0.0917', 'NDCG@5': '0.0668', 'HR@10': '0.1250', 'NDCG@10': '0.0776', 'HR@20': '0.1631', 'NDCG@20': '0.0872'}
2025-03-05 21:18:38,152 - EarlyStopping counter: 1 out of 10
2025-03-05 21:19:03,050 - {'epoch': 53, 'rec_loss': '6.8410'}
2025-03-05 21:19:11,104 - {'Epoch': 53, 'HR@5': '0.0929', 'NDCG@5': '0.0670', 'HR@10': '0.1248', 'NDCG@10': '0.0773', 'HR@20': '0.1624', 'NDCG@20': '0.0868'}
2025-03-05 21:19:11,108 - EarlyStopping counter: 2 out of 10
2025-03-05 21:19:35,579 - {'epoch': 54, 'rec_loss': '6.8355'}
2025-03-05 21:19:43,789 - {'Epoch': 54, 'HR@5': '0.0931', 'NDCG@5': '0.0675', 'HR@10': '0.1246', 'NDCG@10': '0.0776', 'HR@20': '0.1621', 'NDCG@20': '0.0871'}
2025-03-05 21:19:43,793 - EarlyStopping counter: 3 out of 10
2025-03-05 21:20:09,358 - {'epoch': 55, 'rec_loss': '6.8373'}
2025-03-05 21:20:17,480 - {'Epoch': 55, 'HR@5': '0.0926', 'NDCG@5': '0.0673', 'HR@10': '0.1258', 'NDCG@10': '0.0780', 'HR@20': '0.1635', 'NDCG@20': '0.0875'}
2025-03-05 21:20:17,486 - EarlyStopping counter: 4 out of 10
2025-03-05 21:20:42,108 - {'epoch': 56, 'rec_loss': '6.8370'}
2025-03-05 21:20:49,774 - {'Epoch': 56, 'HR@5': '0.0925', 'NDCG@5': '0.0674', 'HR@10': '0.1246', 'NDCG@10': '0.0777', 'HR@20': '0.1636', 'NDCG@20': '0.0875'}
2025-03-05 21:20:49,779 - EarlyStopping counter: 5 out of 10
2025-03-05 21:21:13,504 - {'epoch': 57, 'rec_loss': '6.8318'}
2025-03-05 21:21:21,098 - {'Epoch': 57, 'HR@5': '0.0925', 'NDCG@5': '0.0672', 'HR@10': '0.1256', 'NDCG@10': '0.0779', 'HR@20': '0.1631', 'NDCG@20': '0.0874'}
2025-03-05 21:21:21,107 - EarlyStopping counter: 6 out of 10
2025-03-05 21:21:44,505 - {'epoch': 58, 'rec_loss': '6.8256'}
2025-03-05 21:21:52,711 - {'Epoch': 58, 'HR@5': '0.0936', 'NDCG@5': '0.0675', 'HR@10': '0.1263', 'NDCG@10': '0.0781', 'HR@20': '0.1638', 'NDCG@20': '0.0875'}
2025-03-05 21:21:52,717 - EarlyStopping counter: 7 out of 10
2025-03-05 21:22:17,065 - {'epoch': 59, 'rec_loss': '6.8298'}
2025-03-05 21:22:24,898 - {'Epoch': 59, 'HR@5': '0.0943', 'NDCG@5': '0.0677', 'HR@10': '0.1252', 'NDCG@10': '0.0777', 'HR@20': '0.1637', 'NDCG@20': '0.0874'}
2025-03-05 21:22:24,903 - EarlyStopping counter: 8 out of 10
2025-03-05 21:22:49,788 - {'epoch': 60, 'rec_loss': '6.8153'}
2025-03-05 21:22:57,625 - {'Epoch': 60, 'HR@5': '0.0942', 'NDCG@5': '0.0686', 'HR@10': '0.1267', 'NDCG@10': '0.0790', 'HR@20': '0.1632', 'NDCG@20': '0.0882'}
2025-03-05 21:22:57,629 - Validation score increased.  Saving model ...
2025-03-05 21:23:24,898 - {'epoch': 61, 'rec_loss': '6.8168'}
2025-03-05 21:23:33,011 - {'Epoch': 61, 'HR@5': '0.0939', 'NDCG@5': '0.0678', 'HR@10': '0.1263', 'NDCG@10': '0.0783', 'HR@20': '0.1635', 'NDCG@20': '0.0877'}
2025-03-05 21:23:33,019 - EarlyStopping counter: 1 out of 10
2025-03-05 21:23:57,285 - {'epoch': 62, 'rec_loss': '6.8117'}
2025-03-05 21:24:05,193 - {'Epoch': 62, 'HR@5': '0.0932', 'NDCG@5': '0.0673', 'HR@10': '0.1266', 'NDCG@10': '0.0780', 'HR@20': '0.1635', 'NDCG@20': '0.0873'}
2025-03-05 21:24:05,201 - EarlyStopping counter: 2 out of 10
2025-03-05 21:24:30,722 - {'epoch': 63, 'rec_loss': '6.7983'}
2025-03-05 21:24:38,632 - {'Epoch': 63, 'HR@5': '0.0933', 'NDCG@5': '0.0677', 'HR@10': '0.1256', 'NDCG@10': '0.0782', 'HR@20': '0.1638', 'NDCG@20': '0.0878'}
2025-03-05 21:24:38,639 - EarlyStopping counter: 3 out of 10
2025-03-05 21:25:03,193 - {'epoch': 64, 'rec_loss': '6.7973'}
2025-03-05 21:25:11,048 - {'Epoch': 64, 'HR@5': '0.0938', 'NDCG@5': '0.0680', 'HR@10': '0.1253', 'NDCG@10': '0.0781', 'HR@20': '0.1643', 'NDCG@20': '0.0879'}
2025-03-05 21:25:11,055 - EarlyStopping counter: 4 out of 10
2025-03-05 21:25:35,104 - {'epoch': 65, 'rec_loss': '6.8017'}
2025-03-05 21:25:42,980 - {'Epoch': 65, 'HR@5': '0.0937', 'NDCG@5': '0.0679', 'HR@10': '0.1266', 'NDCG@10': '0.0785', 'HR@20': '0.1640', 'NDCG@20': '0.0880'}
2025-03-05 21:25:42,988 - EarlyStopping counter: 5 out of 10
2025-03-05 21:26:07,165 - {'epoch': 66, 'rec_loss': '6.7952'}
2025-03-05 21:26:15,199 - {'Epoch': 66, 'HR@5': '0.0939', 'NDCG@5': '0.0682', 'HR@10': '0.1262', 'NDCG@10': '0.0786', 'HR@20': '0.1649', 'NDCG@20': '0.0883'}
2025-03-05 21:26:15,204 - Validation score increased.  Saving model ...
2025-03-05 21:26:40,702 - {'epoch': 67, 'rec_loss': '6.7920'}
2025-03-05 21:26:48,622 - {'Epoch': 67, 'HR@5': '0.0936', 'NDCG@5': '0.0685', 'HR@10': '0.1267', 'NDCG@10': '0.0792', 'HR@20': '0.1641', 'NDCG@20': '0.0887'}
2025-03-05 21:26:48,630 - Validation score increased.  Saving model ...
2025-03-05 21:27:12,897 - {'epoch': 68, 'rec_loss': '6.7981'}
2025-03-05 21:27:20,907 - {'Epoch': 68, 'HR@5': '0.0943', 'NDCG@5': '0.0683', 'HR@10': '0.1267', 'NDCG@10': '0.0787', 'HR@20': '0.1642', 'NDCG@20': '0.0882'}
2025-03-05 21:27:20,913 - EarlyStopping counter: 1 out of 10
2025-03-05 21:27:46,413 - {'epoch': 69, 'rec_loss': '6.7824'}
2025-03-05 21:27:54,456 - {'Epoch': 69, 'HR@5': '0.0948', 'NDCG@5': '0.0688', 'HR@10': '0.1256', 'NDCG@10': '0.0787', 'HR@20': '0.1637', 'NDCG@20': '0.0883'}
2025-03-05 21:27:54,464 - EarlyStopping counter: 2 out of 10
2025-03-05 21:28:19,828 - {'epoch': 70, 'rec_loss': '6.7764'}
2025-03-05 21:28:27,667 - {'Epoch': 70, 'HR@5': '0.0921', 'NDCG@5': '0.0672', 'HR@10': '0.1248', 'NDCG@10': '0.0777', 'HR@20': '0.1640', 'NDCG@20': '0.0876'}
2025-03-05 21:28:27,673 - EarlyStopping counter: 3 out of 10
2025-03-05 21:28:51,887 - {'epoch': 71, 'rec_loss': '6.7886'}
2025-03-05 21:28:59,655 - {'Epoch': 71, 'HR@5': '0.0946', 'NDCG@5': '0.0684', 'HR@10': '0.1272', 'NDCG@10': '0.0789', 'HR@20': '0.1646', 'NDCG@20': '0.0883'}
2025-03-05 21:28:59,665 - EarlyStopping counter: 4 out of 10
2025-03-05 21:29:24,018 - {'epoch': 72, 'rec_loss': '6.7847'}
2025-03-05 21:29:31,840 - {'Epoch': 72, 'HR@5': '0.0944', 'NDCG@5': '0.0686', 'HR@10': '0.1258', 'NDCG@10': '0.0788', 'HR@20': '0.1643', 'NDCG@20': '0.0885'}
2025-03-05 21:29:31,845 - EarlyStopping counter: 5 out of 10
2025-03-05 21:29:56,193 - {'epoch': 73, 'rec_loss': '6.7732'}
2025-03-05 21:30:03,749 - {'Epoch': 73, 'HR@5': '0.0928', 'NDCG@5': '0.0678', 'HR@10': '0.1265', 'NDCG@10': '0.0787', 'HR@20': '0.1648', 'NDCG@20': '0.0883'}
2025-03-05 21:30:03,755 - EarlyStopping counter: 6 out of 10
2025-03-05 21:30:25,655 - {'epoch': 74, 'rec_loss': '6.7719'}
2025-03-05 21:30:33,258 - {'Epoch': 74, 'HR@5': '0.0935', 'NDCG@5': '0.0680', 'HR@10': '0.1264', 'NDCG@10': '0.0787', 'HR@20': '0.1631', 'NDCG@20': '0.0879'}
2025-03-05 21:30:33,264 - EarlyStopping counter: 7 out of 10
2025-03-05 21:30:55,395 - {'epoch': 75, 'rec_loss': '6.7703'}
2025-03-05 21:31:03,275 - {'Epoch': 75, 'HR@5': '0.0949', 'NDCG@5': '0.0688', 'HR@10': '0.1267', 'NDCG@10': '0.0790', 'HR@20': '0.1645', 'NDCG@20': '0.0885'}
2025-03-05 21:31:03,279 - EarlyStopping counter: 8 out of 10
2025-03-05 21:31:25,913 - {'epoch': 76, 'rec_loss': '6.7693'}
2025-03-05 21:31:33,578 - {'Epoch': 76, 'HR@5': '0.0937', 'NDCG@5': '0.0685', 'HR@10': '0.1272', 'NDCG@10': '0.0793', 'HR@20': '0.1628', 'NDCG@20': '0.0882'}
2025-03-05 21:31:33,585 - EarlyStopping counter: 9 out of 10
2025-03-05 21:31:56,399 - {'epoch': 77, 'rec_loss': '6.7702'}
2025-03-05 21:32:04,081 - {'Epoch': 77, 'HR@5': '0.0939', 'NDCG@5': '0.0684', 'HR@10': '0.1268', 'NDCG@10': '0.0790', 'HR@20': '0.1631', 'NDCG@20': '0.0882'}
2025-03-05 21:32:04,087 - EarlyStopping counter: 10 out of 10
2025-03-05 21:32:04,087 - Early stopping
2025-03-05 21:32:04,087 - ---------------Test Score---------------
2025-03-05 21:32:11,677 - {'Epoch': 0, 'HR@5': '0.0787', 'NDCG@5': '0.0582', 'HR@10': '0.1057', 'NDCG@10': '0.0669', 'HR@20': '0.1387', 'NDCG@20': '0.0752'}
2025-03-05 21:32:11,683 - Scale_Toys
2025-03-05 21:32:11,683 - {'Epoch': 0, 'HR@5': '0.0787', 'NDCG@5': '0.0582', 'HR@10': '0.1057', 'NDCG@10': '0.0669', 'HR@20': '0.1387', 'NDCG@20': '0.0752'}
2025-03-06 16:28:29,085 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-03-06 16:28:32,271 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-06 16:28:32,276 - Total Parameters: 917142
2025-03-06 16:28:54,694 - {'epoch': 0, 'rec_loss': '9.0948'}
2025-03-06 16:29:02,633 - {'Epoch': 0, 'HR@5': '0.0072', 'NDCG@5': '0.0043', 'HR@10': '0.0115', 'NDCG@10': '0.0057', 'HR@20': '0.0183', 'NDCG@20': '0.0074'}
2025-03-06 16:29:02,644 - Validation score increased.  Saving model ...
2025-03-06 16:29:23,677 - {'epoch': 1, 'rec_loss': '8.6919'}
2025-03-06 16:29:31,691 - {'Epoch': 1, 'HR@5': '0.0159', 'NDCG@5': '0.0110', 'HR@10': '0.0250', 'NDCG@10': '0.0139', 'HR@20': '0.0398', 'NDCG@20': '0.0176'}
2025-03-06 16:29:31,696 - Validation score increased.  Saving model ...
2025-03-06 16:29:52,378 - {'epoch': 2, 'rec_loss': '8.3918'}
2025-03-06 16:30:00,718 - {'Epoch': 2, 'HR@5': '0.0331', 'NDCG@5': '0.0239', 'HR@10': '0.0504', 'NDCG@10': '0.0295', 'HR@20': '0.0723', 'NDCG@20': '0.0350'}
2025-03-06 16:30:00,724 - Validation score increased.  Saving model ...
2025-03-06 16:30:25,148 - {'epoch': 3, 'rec_loss': '8.1193'}
2025-03-06 16:30:33,415 - {'Epoch': 3, 'HR@5': '0.0505', 'NDCG@5': '0.0365', 'HR@10': '0.0692', 'NDCG@10': '0.0425', 'HR@20': '0.0959', 'NDCG@20': '0.0492'}
2025-03-06 16:30:33,421 - Validation score increased.  Saving model ...
2025-03-06 16:30:59,395 - {'epoch': 4, 'rec_loss': '7.9021'}
2025-03-06 16:31:08,184 - {'Epoch': 4, 'HR@5': '0.0614', 'NDCG@5': '0.0446', 'HR@10': '0.0833', 'NDCG@10': '0.0516', 'HR@20': '0.1147', 'NDCG@20': '0.0596'}
2025-03-06 16:31:08,190 - Validation score increased.  Saving model ...
2025-03-06 16:31:33,071 - {'epoch': 5, 'rec_loss': '7.7352'}
2025-03-06 16:31:40,780 - {'Epoch': 5, 'HR@5': '0.0691', 'NDCG@5': '0.0500', 'HR@10': '0.0935', 'NDCG@10': '0.0578', 'HR@20': '0.1270', 'NDCG@20': '0.0662'}
2025-03-06 16:31:40,784 - Validation score increased.  Saving model ...
2025-03-06 16:32:01,069 - {'epoch': 6, 'rec_loss': '7.6134'}
2025-03-06 16:32:09,074 - {'Epoch': 6, 'HR@5': '0.0739', 'NDCG@5': '0.0536', 'HR@10': '0.1009', 'NDCG@10': '0.0622', 'HR@20': '0.1360', 'NDCG@20': '0.0711'}
2025-03-06 16:32:09,080 - Validation score increased.  Saving model ...
2025-03-06 16:32:32,720 - {'epoch': 7, 'rec_loss': '7.5160'}
2025-03-06 16:32:40,640 - {'Epoch': 7, 'HR@5': '0.0776', 'NDCG@5': '0.0566', 'HR@10': '0.1092', 'NDCG@10': '0.0667', 'HR@20': '0.1457', 'NDCG@20': '0.0759'}
2025-03-06 16:32:40,644 - Validation score increased.  Saving model ...
2025-03-06 16:33:02,572 - {'epoch': 8, 'rec_loss': '7.4359'}
2025-03-06 16:33:11,285 - {'Epoch': 8, 'HR@5': '0.0826', 'NDCG@5': '0.0595', 'HR@10': '0.1118', 'NDCG@10': '0.0688', 'HR@20': '0.1451', 'NDCG@20': '0.0772'}
2025-03-06 16:33:11,290 - Validation score increased.  Saving model ...
2025-03-06 16:33:37,347 - {'epoch': 9, 'rec_loss': '7.3761'}
2025-03-06 16:33:45,627 - {'Epoch': 9, 'HR@5': '0.0844', 'NDCG@5': '0.0609', 'HR@10': '0.1143', 'NDCG@10': '0.0704', 'HR@20': '0.1511', 'NDCG@20': '0.0797'}
2025-03-06 16:33:45,632 - Validation score increased.  Saving model ...
2025-03-06 16:34:09,956 - {'epoch': 10, 'rec_loss': '7.3234'}
2025-03-06 16:34:19,032 - {'Epoch': 10, 'HR@5': '0.0848', 'NDCG@5': '0.0621', 'HR@10': '0.1151', 'NDCG@10': '0.0718', 'HR@20': '0.1536', 'NDCG@20': '0.0815'}
2025-03-06 16:34:19,034 - Validation score increased.  Saving model ...
2025-03-06 16:34:42,738 - {'epoch': 11, 'rec_loss': '7.2817'}
2025-03-06 16:34:50,696 - {'Epoch': 11, 'HR@5': '0.0871', 'NDCG@5': '0.0633', 'HR@10': '0.1172', 'NDCG@10': '0.0730', 'HR@20': '0.1568', 'NDCG@20': '0.0830'}
2025-03-06 16:34:50,700 - Validation score increased.  Saving model ...
2025-03-06 16:35:13,102 - {'epoch': 12, 'rec_loss': '7.2382'}
2025-03-06 16:35:21,084 - {'Epoch': 12, 'HR@5': '0.0889', 'NDCG@5': '0.0641', 'HR@10': '0.1193', 'NDCG@10': '0.0738', 'HR@20': '0.1556', 'NDCG@20': '0.0830'}
2025-03-06 16:35:21,088 - Validation score increased.  Saving model ...
2025-03-06 16:35:43,329 - {'epoch': 13, 'rec_loss': '7.2084'}
2025-03-06 16:35:51,591 - {'Epoch': 13, 'HR@5': '0.0896', 'NDCG@5': '0.0650', 'HR@10': '0.1201', 'NDCG@10': '0.0748', 'HR@20': '0.1579', 'NDCG@20': '0.0843'}
2025-03-06 16:35:51,595 - Validation score increased.  Saving model ...
2025-03-06 16:36:15,062 - {'epoch': 14, 'rec_loss': '7.1791'}
2025-03-06 16:36:23,599 - {'Epoch': 14, 'HR@5': '0.0889', 'NDCG@5': '0.0642', 'HR@10': '0.1198', 'NDCG@10': '0.0742', 'HR@20': '0.1578', 'NDCG@20': '0.0839'}
2025-03-06 16:36:23,603 - EarlyStopping counter: 1 out of 10
2025-03-06 16:36:48,518 - {'epoch': 15, 'rec_loss': '7.1565'}
2025-03-06 16:36:56,434 - {'Epoch': 15, 'HR@5': '0.0909', 'NDCG@5': '0.0658', 'HR@10': '0.1219', 'NDCG@10': '0.0758', 'HR@20': '0.1609', 'NDCG@20': '0.0856'}
2025-03-06 16:36:56,438 - Validation score increased.  Saving model ...
2025-03-06 16:37:21,043 - {'epoch': 16, 'rec_loss': '7.1303'}
2025-03-06 16:37:29,052 - {'Epoch': 16, 'HR@5': '0.0918', 'NDCG@5': '0.0664', 'HR@10': '0.1224', 'NDCG@10': '0.0762', 'HR@20': '0.1610', 'NDCG@20': '0.0859'}
2025-03-06 16:37:29,058 - Validation score increased.  Saving model ...
2025-03-06 16:37:49,976 - {'epoch': 17, 'rec_loss': '7.1028'}
2025-03-06 16:37:58,083 - {'Epoch': 17, 'HR@5': '0.0910', 'NDCG@5': '0.0660', 'HR@10': '0.1229', 'NDCG@10': '0.0763', 'HR@20': '0.1607', 'NDCG@20': '0.0858'}
2025-03-06 16:37:58,088 - EarlyStopping counter: 1 out of 10
2025-03-06 16:38:20,416 - {'epoch': 18, 'rec_loss': '7.0854'}
2025-03-06 16:38:28,056 - {'Epoch': 18, 'HR@5': '0.0920', 'NDCG@5': '0.0664', 'HR@10': '0.1237', 'NDCG@10': '0.0766', 'HR@20': '0.1588', 'NDCG@20': '0.0854'}
2025-03-06 16:38:28,061 - EarlyStopping counter: 2 out of 10
2025-03-06 16:38:51,126 - {'epoch': 19, 'rec_loss': '7.0730'}
2025-03-06 16:38:59,825 - {'Epoch': 19, 'HR@5': '0.0931', 'NDCG@5': '0.0665', 'HR@10': '0.1256', 'NDCG@10': '0.0770', 'HR@20': '0.1626', 'NDCG@20': '0.0863'}
2025-03-06 16:38:59,830 - Validation score increased.  Saving model ...
2025-03-06 16:39:24,398 - {'epoch': 20, 'rec_loss': '7.0540'}
2025-03-06 16:39:32,577 - {'Epoch': 20, 'HR@5': '0.0916', 'NDCG@5': '0.0663', 'HR@10': '0.1247', 'NDCG@10': '0.0770', 'HR@20': '0.1625', 'NDCG@20': '0.0865'}
2025-03-06 16:39:32,583 - Validation score increased.  Saving model ...
2025-03-06 16:39:57,204 - {'epoch': 21, 'rec_loss': '7.0333'}
2025-03-06 16:40:05,888 - {'Epoch': 21, 'HR@5': '0.0909', 'NDCG@5': '0.0662', 'HR@10': '0.1252', 'NDCG@10': '0.0773', 'HR@20': '0.1631', 'NDCG@20': '0.0869'}
2025-03-06 16:40:05,895 - Validation score increased.  Saving model ...
2025-03-06 16:40:29,726 - {'epoch': 22, 'rec_loss': '7.0212'}
2025-03-06 16:40:37,614 - {'Epoch': 22, 'HR@5': '0.0934', 'NDCG@5': '0.0671', 'HR@10': '0.1244', 'NDCG@10': '0.0771', 'HR@20': '0.1607', 'NDCG@20': '0.0862'}
2025-03-06 16:40:37,619 - EarlyStopping counter: 1 out of 10
2025-03-06 16:40:59,695 - {'epoch': 23, 'rec_loss': '7.0070'}
2025-03-06 16:41:07,532 - {'Epoch': 23, 'HR@5': '0.0945', 'NDCG@5': '0.0677', 'HR@10': '0.1269', 'NDCG@10': '0.0782', 'HR@20': '0.1639', 'NDCG@20': '0.0874'}
2025-03-06 16:41:07,533 - Validation score increased.  Saving model ...
2025-03-06 16:41:29,899 - {'epoch': 24, 'rec_loss': '7.0013'}
2025-03-06 16:41:37,440 - {'Epoch': 24, 'HR@5': '0.0924', 'NDCG@5': '0.0669', 'HR@10': '0.1250', 'NDCG@10': '0.0774', 'HR@20': '0.1635', 'NDCG@20': '0.0871'}
2025-03-06 16:41:37,447 - EarlyStopping counter: 1 out of 10
2025-03-06 16:42:02,578 - {'epoch': 25, 'rec_loss': '6.9854'}
2025-03-06 16:42:10,865 - {'Epoch': 25, 'HR@5': '0.0931', 'NDCG@5': '0.0675', 'HR@10': '0.1272', 'NDCG@10': '0.0785', 'HR@20': '0.1636', 'NDCG@20': '0.0876'}
2025-03-06 16:42:10,872 - Validation score increased.  Saving model ...
2025-03-06 16:42:35,370 - {'epoch': 26, 'rec_loss': '6.9732'}
2025-03-06 16:42:43,496 - {'Epoch': 26, 'HR@5': '0.0931', 'NDCG@5': '0.0672', 'HR@10': '0.1266', 'NDCG@10': '0.0780', 'HR@20': '0.1648', 'NDCG@20': '0.0877'}
2025-03-06 16:42:43,500 - Validation score increased.  Saving model ...
2025-03-06 16:43:06,815 - {'epoch': 27, 'rec_loss': '6.9545'}
2025-03-06 16:43:14,706 - {'Epoch': 27, 'HR@5': '0.0937', 'NDCG@5': '0.0682', 'HR@10': '0.1255', 'NDCG@10': '0.0785', 'HR@20': '0.1643', 'NDCG@20': '0.0882'}
2025-03-06 16:43:14,711 - Validation score increased.  Saving model ...
2025-03-06 16:43:35,998 - {'epoch': 28, 'rec_loss': '6.9453'}
2025-03-06 16:43:43,913 - {'Epoch': 28, 'HR@5': '0.0926', 'NDCG@5': '0.0667', 'HR@10': '0.1254', 'NDCG@10': '0.0773', 'HR@20': '0.1639', 'NDCG@20': '0.0869'}
2025-03-06 16:43:43,919 - EarlyStopping counter: 1 out of 10
2025-03-06 16:44:06,025 - {'epoch': 29, 'rec_loss': '6.9320'}
2025-03-06 16:44:13,819 - {'Epoch': 29, 'HR@5': '0.0946', 'NDCG@5': '0.0678', 'HR@10': '0.1260', 'NDCG@10': '0.0779', 'HR@20': '0.1672', 'NDCG@20': '0.0883'}
2025-03-06 16:44:13,821 - Validation score increased.  Saving model ...
2025-03-06 16:44:36,302 - {'epoch': 30, 'rec_loss': '6.9189'}
2025-03-06 16:44:44,484 - {'Epoch': 30, 'HR@5': '0.0954', 'NDCG@5': '0.0685', 'HR@10': '0.1267', 'NDCG@10': '0.0786', 'HR@20': '0.1671', 'NDCG@20': '0.0888'}
2025-03-06 16:44:44,489 - Validation score increased.  Saving model ...
2025-03-06 16:45:08,953 - {'epoch': 31, 'rec_loss': '6.9207'}
2025-03-06 16:45:17,503 - {'Epoch': 31, 'HR@5': '0.0962', 'NDCG@5': '0.0686', 'HR@10': '0.1267', 'NDCG@10': '0.0784', 'HR@20': '0.1674', 'NDCG@20': '0.0886'}
2025-03-06 16:45:17,509 - EarlyStopping counter: 1 out of 10
2025-03-06 16:45:41,788 - {'epoch': 32, 'rec_loss': '6.9080'}
2025-03-06 16:45:49,763 - {'Epoch': 32, 'HR@5': '0.0941', 'NDCG@5': '0.0678', 'HR@10': '0.1273', 'NDCG@10': '0.0785', 'HR@20': '0.1667', 'NDCG@20': '0.0885'}
2025-03-06 16:45:49,768 - EarlyStopping counter: 2 out of 10
2025-03-06 16:46:14,471 - {'epoch': 33, 'rec_loss': '6.8985'}
2025-03-06 16:46:21,934 - {'Epoch': 33, 'HR@5': '0.0948', 'NDCG@5': '0.0681', 'HR@10': '0.1268', 'NDCG@10': '0.0785', 'HR@20': '0.1674', 'NDCG@20': '0.0887'}
2025-03-06 16:46:21,939 - EarlyStopping counter: 3 out of 10
2025-03-06 16:46:43,391 - {'epoch': 34, 'rec_loss': '6.8895'}
2025-03-06 16:46:51,337 - {'Epoch': 34, 'HR@5': '0.0957', 'NDCG@5': '0.0682', 'HR@10': '0.1269', 'NDCG@10': '0.0782', 'HR@20': '0.1678', 'NDCG@20': '0.0884'}
2025-03-06 16:46:51,338 - EarlyStopping counter: 4 out of 10
2025-03-06 16:47:13,347 - {'epoch': 35, 'rec_loss': '6.8804'}
2025-03-06 16:47:20,989 - {'Epoch': 35, 'HR@5': '0.0939', 'NDCG@5': '0.0679', 'HR@10': '0.1268', 'NDCG@10': '0.0785', 'HR@20': '0.1671', 'NDCG@20': '0.0886'}
2025-03-06 16:47:20,990 - EarlyStopping counter: 5 out of 10
2025-03-06 16:47:43,122 - {'epoch': 36, 'rec_loss': '6.8815'}
2025-03-06 16:47:51,471 - {'Epoch': 36, 'HR@5': '0.0962', 'NDCG@5': '0.0685', 'HR@10': '0.1284', 'NDCG@10': '0.0789', 'HR@20': '0.1672', 'NDCG@20': '0.0887'}
2025-03-06 16:47:51,476 - EarlyStopping counter: 6 out of 10
2025-03-06 16:48:17,390 - {'epoch': 37, 'rec_loss': '6.8713'}
2025-03-06 16:48:25,988 - {'Epoch': 37, 'HR@5': '0.0959', 'NDCG@5': '0.0689', 'HR@10': '0.1279', 'NDCG@10': '0.0791', 'HR@20': '0.1676', 'NDCG@20': '0.0892'}
2025-03-06 16:48:25,993 - Validation score increased.  Saving model ...
2025-03-06 16:48:50,059 - {'epoch': 38, 'rec_loss': '6.8603'}
2025-03-06 16:48:58,054 - {'Epoch': 38, 'HR@5': '0.0944', 'NDCG@5': '0.0678', 'HR@10': '0.1271', 'NDCG@10': '0.0784', 'HR@20': '0.1685', 'NDCG@20': '0.0888'}
2025-03-06 16:48:58,060 - EarlyStopping counter: 1 out of 10
2025-03-06 16:49:19,925 - {'epoch': 39, 'rec_loss': '6.8462'}
2025-03-06 16:49:27,582 - {'Epoch': 39, 'HR@5': '0.0940', 'NDCG@5': '0.0682', 'HR@10': '0.1268', 'NDCG@10': '0.0787', 'HR@20': '0.1664', 'NDCG@20': '0.0887'}
2025-03-06 16:49:27,588 - EarlyStopping counter: 2 out of 10
2025-03-06 16:49:48,495 - {'epoch': 40, 'rec_loss': '6.8407'}
2025-03-06 16:49:56,381 - {'Epoch': 40, 'HR@5': '0.0947', 'NDCG@5': '0.0683', 'HR@10': '0.1284', 'NDCG@10': '0.0791', 'HR@20': '0.1690', 'NDCG@20': '0.0893'}
2025-03-06 16:49:56,382 - Validation score increased.  Saving model ...
2025-03-06 16:50:19,774 - {'epoch': 41, 'rec_loss': '6.8351'}
2025-03-06 16:50:27,336 - {'Epoch': 41, 'HR@5': '0.0957', 'NDCG@5': '0.0690', 'HR@10': '0.1280', 'NDCG@10': '0.0794', 'HR@20': '0.1679', 'NDCG@20': '0.0895'}
2025-03-06 16:50:27,340 - Validation score increased.  Saving model ...
2025-03-06 16:50:50,939 - {'epoch': 42, 'rec_loss': '6.8395'}
2025-03-06 16:50:59,242 - {'Epoch': 42, 'HR@5': '0.0954', 'NDCG@5': '0.0686', 'HR@10': '0.1280', 'NDCG@10': '0.0791', 'HR@20': '0.1675', 'NDCG@20': '0.0892'}
2025-03-06 16:50:59,248 - EarlyStopping counter: 1 out of 10
2025-03-06 16:51:24,228 - {'epoch': 43, 'rec_loss': '6.8234'}
2025-03-06 16:51:32,184 - {'Epoch': 43, 'HR@5': '0.0948', 'NDCG@5': '0.0683', 'HR@10': '0.1289', 'NDCG@10': '0.0792', 'HR@20': '0.1691', 'NDCG@20': '0.0893'}
2025-03-06 16:51:32,188 - EarlyStopping counter: 2 out of 10
2025-03-06 16:51:56,728 - {'epoch': 44, 'rec_loss': '6.8222'}
2025-03-06 16:52:05,484 - {'Epoch': 44, 'HR@5': '0.0941', 'NDCG@5': '0.0677', 'HR@10': '0.1271', 'NDCG@10': '0.0783', 'HR@20': '0.1679', 'NDCG@20': '0.0885'}
2025-03-06 16:52:05,489 - EarlyStopping counter: 3 out of 10
2025-03-06 16:52:26,236 - {'epoch': 45, 'rec_loss': '6.8078'}
2025-03-06 16:52:34,267 - {'Epoch': 45, 'HR@5': '0.0941', 'NDCG@5': '0.0677', 'HR@10': '0.1264', 'NDCG@10': '0.0780', 'HR@20': '0.1684', 'NDCG@20': '0.0886'}
2025-03-06 16:52:34,272 - EarlyStopping counter: 4 out of 10
2025-03-06 16:52:56,025 - {'epoch': 46, 'rec_loss': '6.8028'}
2025-03-06 16:53:04,434 - {'Epoch': 46, 'HR@5': '0.0940', 'NDCG@5': '0.0677', 'HR@10': '0.1275', 'NDCG@10': '0.0784', 'HR@20': '0.1685', 'NDCG@20': '0.0887'}
2025-03-06 16:53:04,435 - EarlyStopping counter: 5 out of 10
2025-03-06 16:53:26,463 - {'epoch': 47, 'rec_loss': '6.7991'}
2025-03-06 16:53:34,397 - {'Epoch': 47, 'HR@5': '0.0933', 'NDCG@5': '0.0680', 'HR@10': '0.1255', 'NDCG@10': '0.0784', 'HR@20': '0.1672', 'NDCG@20': '0.0889'}
2025-03-06 16:53:34,398 - EarlyStopping counter: 6 out of 10
2025-03-06 16:53:58,397 - {'epoch': 48, 'rec_loss': '6.7959'}
2025-03-06 16:54:06,693 - {'Epoch': 48, 'HR@5': '0.0956', 'NDCG@5': '0.0690', 'HR@10': '0.1281', 'NDCG@10': '0.0794', 'HR@20': '0.1676', 'NDCG@20': '0.0894'}
2025-03-06 16:54:06,700 - EarlyStopping counter: 7 out of 10
2025-03-06 16:54:30,286 - {'epoch': 49, 'rec_loss': '6.7893'}
2025-03-06 16:54:38,869 - {'Epoch': 49, 'HR@5': '0.0946', 'NDCG@5': '0.0691', 'HR@10': '0.1265', 'NDCG@10': '0.0793', 'HR@20': '0.1671', 'NDCG@20': '0.0895'}
2025-03-06 16:54:38,870 - Validation score increased.  Saving model ...
2025-03-06 16:55:02,695 - {'epoch': 50, 'rec_loss': '6.7776'}
2025-03-06 16:55:10,801 - {'Epoch': 50, 'HR@5': '0.0947', 'NDCG@5': '0.0684', 'HR@10': '0.1278', 'NDCG@10': '0.0791', 'HR@20': '0.1670', 'NDCG@20': '0.0889'}
2025-03-06 16:55:10,805 - EarlyStopping counter: 1 out of 10
2025-03-06 16:55:32,057 - {'epoch': 51, 'rec_loss': '6.7784'}
2025-03-06 16:55:40,138 - {'Epoch': 51, 'HR@5': '0.0937', 'NDCG@5': '0.0683', 'HR@10': '0.1273', 'NDCG@10': '0.0791', 'HR@20': '0.1694', 'NDCG@20': '0.0897'}
2025-03-06 16:55:40,144 - Validation score increased.  Saving model ...
2025-03-06 16:56:02,282 - {'epoch': 52, 'rec_loss': '6.7800'}
2025-03-06 16:56:10,090 - {'Epoch': 52, 'HR@5': '0.0938', 'NDCG@5': '0.0681', 'HR@10': '0.1276', 'NDCG@10': '0.0790', 'HR@20': '0.1680', 'NDCG@20': '0.0892'}
2025-03-06 16:56:10,094 - EarlyStopping counter: 1 out of 10
2025-03-06 16:56:32,881 - {'epoch': 53, 'rec_loss': '6.7663'}
2025-03-06 16:56:41,272 - {'Epoch': 53, 'HR@5': '0.0946', 'NDCG@5': '0.0683', 'HR@10': '0.1267', 'NDCG@10': '0.0786', 'HR@20': '0.1671', 'NDCG@20': '0.0888'}
2025-03-06 16:56:41,277 - EarlyStopping counter: 2 out of 10
2025-03-06 16:57:06,428 - {'epoch': 54, 'rec_loss': '6.7608'}
2025-03-06 16:57:14,605 - {'Epoch': 54, 'HR@5': '0.0951', 'NDCG@5': '0.0685', 'HR@10': '0.1262', 'NDCG@10': '0.0786', 'HR@20': '0.1679', 'NDCG@20': '0.0891'}
2025-03-06 16:57:14,609 - EarlyStopping counter: 3 out of 10
2025-03-06 16:57:38,425 - {'epoch': 55, 'rec_loss': '6.7579'}
2025-03-06 16:57:46,629 - {'Epoch': 55, 'HR@5': '0.0948', 'NDCG@5': '0.0680', 'HR@10': '0.1282', 'NDCG@10': '0.0787', 'HR@20': '0.1664', 'NDCG@20': '0.0884'}
2025-03-06 16:57:46,638 - EarlyStopping counter: 4 out of 10
2025-03-06 16:58:09,757 - {'epoch': 56, 'rec_loss': '6.7590'}
2025-03-06 16:58:17,417 - {'Epoch': 56, 'HR@5': '0.0954', 'NDCG@5': '0.0683', 'HR@10': '0.1286', 'NDCG@10': '0.0790', 'HR@20': '0.1673', 'NDCG@20': '0.0887'}
2025-03-06 16:58:17,422 - EarlyStopping counter: 5 out of 10
2025-03-06 16:58:39,146 - {'epoch': 57, 'rec_loss': '6.7528'}
2025-03-06 16:58:46,796 - {'Epoch': 57, 'HR@5': '0.0957', 'NDCG@5': '0.0688', 'HR@10': '0.1280', 'NDCG@10': '0.0792', 'HR@20': '0.1671', 'NDCG@20': '0.0891'}
2025-03-06 16:58:46,802 - EarlyStopping counter: 6 out of 10
2025-03-06 16:59:09,263 - {'epoch': 58, 'rec_loss': '6.7436'}
2025-03-06 16:59:17,199 - {'Epoch': 58, 'HR@5': '0.0960', 'NDCG@5': '0.0695', 'HR@10': '0.1290', 'NDCG@10': '0.0802', 'HR@20': '0.1687', 'NDCG@20': '0.0902'}
2025-03-06 16:59:17,204 - Validation score increased.  Saving model ...
2025-03-06 16:59:41,765 - {'epoch': 59, 'rec_loss': '6.7465'}
2025-03-06 16:59:49,910 - {'Epoch': 59, 'HR@5': '0.0948', 'NDCG@5': '0.0690', 'HR@10': '0.1286', 'NDCG@10': '0.0799', 'HR@20': '0.1685', 'NDCG@20': '0.0899'}
2025-03-06 16:59:49,915 - EarlyStopping counter: 1 out of 10
2025-03-06 17:00:13,681 - {'epoch': 60, 'rec_loss': '6.7425'}
2025-03-06 17:00:21,918 - {'Epoch': 60, 'HR@5': '0.0950', 'NDCG@5': '0.0691', 'HR@10': '0.1283', 'NDCG@10': '0.0798', 'HR@20': '0.1674', 'NDCG@20': '0.0897'}
2025-03-06 17:00:21,919 - EarlyStopping counter: 2 out of 10
2025-03-06 17:00:45,533 - {'epoch': 61, 'rec_loss': '6.7335'}
2025-03-06 17:00:54,318 - {'Epoch': 61, 'HR@5': '0.0954', 'NDCG@5': '0.0694', 'HR@10': '0.1291', 'NDCG@10': '0.0802', 'HR@20': '0.1689', 'NDCG@20': '0.0903'}
2025-03-06 17:00:54,319 - Validation score increased.  Saving model ...
2025-03-06 17:01:15,216 - {'epoch': 62, 'rec_loss': '6.7332'}
2025-03-06 17:01:23,130 - {'Epoch': 62, 'HR@5': '0.0953', 'NDCG@5': '0.0681', 'HR@10': '0.1290', 'NDCG@10': '0.0789', 'HR@20': '0.1683', 'NDCG@20': '0.0889'}
2025-03-06 17:01:23,135 - EarlyStopping counter: 1 out of 10
2025-03-06 17:01:45,228 - {'epoch': 63, 'rec_loss': '6.7250'}
2025-03-06 17:01:52,857 - {'Epoch': 63, 'HR@5': '0.0945', 'NDCG@5': '0.0680', 'HR@10': '0.1303', 'NDCG@10': '0.0796', 'HR@20': '0.1673', 'NDCG@20': '0.0889'}
2025-03-06 17:01:52,862 - EarlyStopping counter: 2 out of 10
2025-03-06 17:02:14,527 - {'epoch': 64, 'rec_loss': '6.7242'}
2025-03-06 17:02:23,012 - {'Epoch': 64, 'HR@5': '0.0962', 'NDCG@5': '0.0694', 'HR@10': '0.1288', 'NDCG@10': '0.0799', 'HR@20': '0.1688', 'NDCG@20': '0.0900'}
2025-03-06 17:02:23,019 - EarlyStopping counter: 3 out of 10
2025-03-06 17:02:48,017 - {'epoch': 65, 'rec_loss': '6.7208'}
2025-03-06 17:02:56,707 - {'Epoch': 65, 'HR@5': '0.0964', 'NDCG@5': '0.0698', 'HR@10': '0.1303', 'NDCG@10': '0.0807', 'HR@20': '0.1689', 'NDCG@20': '0.0904'}
2025-03-06 17:02:56,712 - Validation score increased.  Saving model ...
2025-03-06 17:03:21,036 - {'epoch': 66, 'rec_loss': '6.7067'}
2025-03-06 17:03:30,082 - {'Epoch': 66, 'HR@5': '0.0961', 'NDCG@5': '0.0700', 'HR@10': '0.1284', 'NDCG@10': '0.0804', 'HR@20': '0.1681', 'NDCG@20': '0.0904'}
2025-03-06 17:03:30,084 - Validation score increased.  Saving model ...
2025-03-06 17:03:54,161 - {'epoch': 67, 'rec_loss': '6.7124'}
2025-03-06 17:04:02,024 - {'Epoch': 67, 'HR@5': '0.0965', 'NDCG@5': '0.0698', 'HR@10': '0.1284', 'NDCG@10': '0.0800', 'HR@20': '0.1677', 'NDCG@20': '0.0900'}
2025-03-06 17:04:02,028 - EarlyStopping counter: 1 out of 10
2025-03-06 17:04:23,400 - {'epoch': 68, 'rec_loss': '6.7143'}
2025-03-06 17:04:31,718 - {'Epoch': 68, 'HR@5': '0.0960', 'NDCG@5': '0.0695', 'HR@10': '0.1288', 'NDCG@10': '0.0801', 'HR@20': '0.1679', 'NDCG@20': '0.0899'}
2025-03-06 17:04:31,725 - EarlyStopping counter: 2 out of 10
2025-03-06 17:04:53,119 - {'epoch': 69, 'rec_loss': '6.7031'}
2025-03-06 17:05:00,953 - {'Epoch': 69, 'HR@5': '0.0951', 'NDCG@5': '0.0694', 'HR@10': '0.1288', 'NDCG@10': '0.0802', 'HR@20': '0.1679', 'NDCG@20': '0.0900'}
2025-03-06 17:05:00,957 - EarlyStopping counter: 3 out of 10
2025-03-06 17:05:23,689 - {'epoch': 70, 'rec_loss': '6.6961'}
2025-03-06 17:05:32,053 - {'Epoch': 70, 'HR@5': '0.0943', 'NDCG@5': '0.0691', 'HR@10': '0.1271', 'NDCG@10': '0.0797', 'HR@20': '0.1666', 'NDCG@20': '0.0896'}
2025-03-06 17:05:32,060 - EarlyStopping counter: 4 out of 10
2025-03-06 17:05:55,712 - {'epoch': 71, 'rec_loss': '6.7018'}
2025-03-06 17:06:04,329 - {'Epoch': 71, 'HR@5': '0.0947', 'NDCG@5': '0.0694', 'HR@10': '0.1260', 'NDCG@10': '0.0795', 'HR@20': '0.1671', 'NDCG@20': '0.0899'}
2025-03-06 17:06:04,336 - EarlyStopping counter: 5 out of 10
2025-03-06 17:06:28,158 - {'epoch': 72, 'rec_loss': '6.7050'}
2025-03-06 17:06:36,701 - {'Epoch': 72, 'HR@5': '0.0947', 'NDCG@5': '0.0688', 'HR@10': '0.1272', 'NDCG@10': '0.0792', 'HR@20': '0.1677', 'NDCG@20': '0.0894'}
2025-03-06 17:06:36,702 - EarlyStopping counter: 6 out of 10
2025-03-06 17:06:59,694 - {'epoch': 73, 'rec_loss': '6.6946'}
2025-03-06 17:07:08,070 - {'Epoch': 73, 'HR@5': '0.0952', 'NDCG@5': '0.0686', 'HR@10': '0.1273', 'NDCG@10': '0.0789', 'HR@20': '0.1666', 'NDCG@20': '0.0888'}
2025-03-06 17:07:08,072 - EarlyStopping counter: 7 out of 10
2025-03-06 17:07:30,053 - {'epoch': 74, 'rec_loss': '6.6906'}
2025-03-06 17:07:38,340 - {'Epoch': 74, 'HR@5': '0.0940', 'NDCG@5': '0.0679', 'HR@10': '0.1284', 'NDCG@10': '0.0790', 'HR@20': '0.1674', 'NDCG@20': '0.0888'}
2025-03-06 17:07:38,346 - EarlyStopping counter: 8 out of 10
2025-03-06 17:07:59,696 - {'epoch': 75, 'rec_loss': '6.6907'}
2025-03-06 17:08:07,399 - {'Epoch': 75, 'HR@5': '0.0961', 'NDCG@5': '0.0694', 'HR@10': '0.1282', 'NDCG@10': '0.0797', 'HR@20': '0.1671', 'NDCG@20': '0.0895'}
2025-03-06 17:08:07,403 - EarlyStopping counter: 9 out of 10
2025-03-06 17:08:29,663 - {'epoch': 76, 'rec_loss': '6.6840'}
2025-03-06 17:08:38,133 - {'Epoch': 76, 'HR@5': '0.0955', 'NDCG@5': '0.0691', 'HR@10': '0.1290', 'NDCG@10': '0.0799', 'HR@20': '0.1676', 'NDCG@20': '0.0896'}
2025-03-06 17:08:38,138 - EarlyStopping counter: 10 out of 10
2025-03-06 17:08:38,138 - Early stopping
2025-03-06 17:08:38,138 - ---------------Test Score---------------
2025-03-06 17:08:47,023 - {'Epoch': 0, 'HR@5': '0.0797', 'NDCG@5': '0.0578', 'HR@10': '0.1087', 'NDCG@10': '0.0671', 'HR@20': '0.1431', 'NDCG@20': '0.0758'}
2025-03-06 17:08:47,028 - Scale_Toys
2025-03-06 17:08:47,028 - {'Epoch': 0, 'HR@5': '0.0797', 'NDCG@5': '0.0578', 'HR@10': '0.1087', 'NDCG@10': '0.0671', 'HR@20': '0.1431', 'NDCG@20': '0.0758'}
2025-03-06 21:50:42,077 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-03-06 21:50:46,215 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-06 21:50:46,226 - Total Parameters: 917142
2025-03-06 21:51:14,578 - {'epoch': 0, 'rec_loss': '9.0664'}
2025-03-06 21:51:23,993 - {'Epoch': 0, 'HR@5': '0.0083', 'NDCG@5': '0.0053', 'HR@10': '0.0130', 'NDCG@10': '0.0068', 'HR@20': '0.0225', 'NDCG@20': '0.0092'}
2025-03-06 21:51:24,001 - Validation score increased.  Saving model ...
2025-03-06 21:51:50,015 - {'epoch': 1, 'rec_loss': '8.5484'}
2025-03-06 21:51:58,871 - {'Epoch': 1, 'HR@5': '0.0320', 'NDCG@5': '0.0229', 'HR@10': '0.0475', 'NDCG@10': '0.0279', 'HR@20': '0.0668', 'NDCG@20': '0.0328'}
2025-03-06 21:51:58,887 - Validation score increased.  Saving model ...
2025-03-06 21:52:25,530 - {'epoch': 2, 'rec_loss': '8.0951'}
2025-03-06 21:52:34,164 - {'Epoch': 2, 'HR@5': '0.0553', 'NDCG@5': '0.0399', 'HR@10': '0.0770', 'NDCG@10': '0.0468', 'HR@20': '0.1041', 'NDCG@20': '0.0537'}
2025-03-06 21:52:34,171 - Validation score increased.  Saving model ...
2025-03-06 21:53:00,689 - {'epoch': 3, 'rec_loss': '7.7284'}
2025-03-06 21:53:09,698 - {'Epoch': 3, 'HR@5': '0.0711', 'NDCG@5': '0.0512', 'HR@10': '0.0948', 'NDCG@10': '0.0588', 'HR@20': '0.1272', 'NDCG@20': '0.0670'}
2025-03-06 21:53:09,704 - Validation score increased.  Saving model ...
2025-03-06 21:53:38,574 - {'epoch': 4, 'rec_loss': '7.4837'}
2025-03-06 21:53:47,655 - {'Epoch': 4, 'HR@5': '0.0801', 'NDCG@5': '0.0580', 'HR@10': '0.1065', 'NDCG@10': '0.0665', 'HR@20': '0.1401', 'NDCG@20': '0.0750'}
2025-03-06 21:53:47,669 - Validation score increased.  Saving model ...
2025-03-06 21:54:17,782 - {'epoch': 5, 'rec_loss': '7.3166'}
2025-03-06 21:54:26,408 - {'Epoch': 5, 'HR@5': '0.0830', 'NDCG@5': '0.0604', 'HR@10': '0.1109', 'NDCG@10': '0.0695', 'HR@20': '0.1468', 'NDCG@20': '0.0785'}
2025-03-06 21:54:26,414 - Validation score increased.  Saving model ...
2025-03-06 21:54:52,435 - {'epoch': 6, 'rec_loss': '7.1967'}
2025-03-06 21:55:00,917 - {'Epoch': 6, 'HR@5': '0.0841', 'NDCG@5': '0.0608', 'HR@10': '0.1120', 'NDCG@10': '0.0698', 'HR@20': '0.1508', 'NDCG@20': '0.0796'}
2025-03-06 21:55:00,923 - Validation score increased.  Saving model ...
2025-03-06 21:55:28,035 - {'epoch': 7, 'rec_loss': '7.1099'}
2025-03-06 21:55:36,777 - {'Epoch': 7, 'HR@5': '0.0876', 'NDCG@5': '0.0625', 'HR@10': '0.1170', 'NDCG@10': '0.0720', 'HR@20': '0.1550', 'NDCG@20': '0.0815'}
2025-03-06 21:55:36,788 - Validation score increased.  Saving model ...
2025-03-06 21:56:02,690 - {'epoch': 8, 'rec_loss': '7.0364'}
2025-03-06 21:56:11,983 - {'Epoch': 8, 'HR@5': '0.0880', 'NDCG@5': '0.0634', 'HR@10': '0.1199', 'NDCG@10': '0.0737', 'HR@20': '0.1581', 'NDCG@20': '0.0833'}
2025-03-06 21:56:11,990 - Validation score increased.  Saving model ...
2025-03-06 21:56:40,198 - {'epoch': 9, 'rec_loss': '6.9811'}
2025-03-06 21:56:49,083 - {'Epoch': 9, 'HR@5': '0.0890', 'NDCG@5': '0.0646', 'HR@10': '0.1179', 'NDCG@10': '0.0739', 'HR@20': '0.1568', 'NDCG@20': '0.0837'}
2025-03-06 21:56:49,089 - Validation score increased.  Saving model ...
2025-03-06 21:57:15,955 - {'epoch': 10, 'rec_loss': '6.9345'}
2025-03-06 21:57:25,533 - {'Epoch': 10, 'HR@5': '0.0883', 'NDCG@5': '0.0642', 'HR@10': '0.1202', 'NDCG@10': '0.0744', 'HR@20': '0.1585', 'NDCG@20': '0.0841'}
2025-03-06 21:57:25,540 - Validation score increased.  Saving model ...
2025-03-06 21:57:52,620 - {'epoch': 11, 'rec_loss': '6.8897'}
2025-03-06 21:58:00,996 - {'Epoch': 11, 'HR@5': '0.0880', 'NDCG@5': '0.0642', 'HR@10': '0.1216', 'NDCG@10': '0.0750', 'HR@20': '0.1604', 'NDCG@20': '0.0848'}
2025-03-06 21:58:01,004 - Validation score increased.  Saving model ...
2025-03-06 21:58:26,376 - {'epoch': 12, 'rec_loss': '6.8528'}
2025-03-06 21:58:34,840 - {'Epoch': 12, 'HR@5': '0.0910', 'NDCG@5': '0.0655', 'HR@10': '0.1215', 'NDCG@10': '0.0753', 'HR@20': '0.1613', 'NDCG@20': '0.0853'}
2025-03-06 21:58:34,847 - Validation score increased.  Saving model ...
2025-03-06 21:59:00,480 - {'epoch': 13, 'rec_loss': '6.8269'}
2025-03-06 21:59:09,308 - {'Epoch': 13, 'HR@5': '0.0916', 'NDCG@5': '0.0661', 'HR@10': '0.1243', 'NDCG@10': '0.0765', 'HR@20': '0.1627', 'NDCG@20': '0.0862'}
2025-03-06 21:59:09,318 - Validation score increased.  Saving model ...
2025-03-06 21:59:36,245 - {'epoch': 14, 'rec_loss': '6.7940'}
2025-03-06 21:59:45,055 - {'Epoch': 14, 'HR@5': '0.0891', 'NDCG@5': '0.0642', 'HR@10': '0.1226', 'NDCG@10': '0.0749', 'HR@20': '0.1610', 'NDCG@20': '0.0846'}
2025-03-06 21:59:45,065 - EarlyStopping counter: 1 out of 10
2025-03-06 22:00:12,143 - {'epoch': 15, 'rec_loss': '6.7682'}
2025-03-06 22:00:20,862 - {'Epoch': 15, 'HR@5': '0.0904', 'NDCG@5': '0.0659', 'HR@10': '0.1236', 'NDCG@10': '0.0766', 'HR@20': '0.1647', 'NDCG@20': '0.0869'}
2025-03-06 22:00:20,873 - Validation score increased.  Saving model ...
2025-03-06 22:00:47,765 - {'epoch': 16, 'rec_loss': '6.7467'}
2025-03-06 22:00:55,880 - {'Epoch': 16, 'HR@5': '0.0896', 'NDCG@5': '0.0644', 'HR@10': '0.1223', 'NDCG@10': '0.0749', 'HR@20': '0.1627', 'NDCG@20': '0.0851'}
2025-03-06 22:00:55,889 - EarlyStopping counter: 1 out of 10
2025-03-06 22:01:21,763 - {'epoch': 17, 'rec_loss': '6.7193'}
2025-03-06 22:01:30,073 - {'Epoch': 17, 'HR@5': '0.0914', 'NDCG@5': '0.0660', 'HR@10': '0.1228', 'NDCG@10': '0.0761', 'HR@20': '0.1635', 'NDCG@20': '0.0863'}
2025-03-06 22:01:30,079 - EarlyStopping counter: 2 out of 10
2025-03-06 22:01:55,299 - {'epoch': 18, 'rec_loss': '6.6999'}
2025-03-06 22:02:03,550 - {'Epoch': 18, 'HR@5': '0.0911', 'NDCG@5': '0.0661', 'HR@10': '0.1233', 'NDCG@10': '0.0765', 'HR@20': '0.1623', 'NDCG@20': '0.0862'}
2025-03-06 22:02:03,558 - EarlyStopping counter: 3 out of 10
2025-03-06 22:02:31,005 - {'epoch': 19, 'rec_loss': '6.6801'}
2025-03-06 22:02:40,108 - {'Epoch': 19, 'HR@5': '0.0921', 'NDCG@5': '0.0667', 'HR@10': '0.1245', 'NDCG@10': '0.0772', 'HR@20': '0.1657', 'NDCG@20': '0.0876'}
2025-03-06 22:02:40,113 - Validation score increased.  Saving model ...
2025-03-06 22:03:09,333 - {'epoch': 20, 'rec_loss': '6.6680'}
2025-03-06 22:03:18,560 - {'Epoch': 20, 'HR@5': '0.0912', 'NDCG@5': '0.0656', 'HR@10': '0.1234', 'NDCG@10': '0.0760', 'HR@20': '0.1631', 'NDCG@20': '0.0860'}
2025-03-06 22:03:18,567 - EarlyStopping counter: 1 out of 10
2025-03-06 22:03:46,425 - {'epoch': 21, 'rec_loss': '6.6471'}
2025-03-06 22:03:54,524 - {'Epoch': 21, 'HR@5': '0.0924', 'NDCG@5': '0.0665', 'HR@10': '0.1229', 'NDCG@10': '0.0764', 'HR@20': '0.1627', 'NDCG@20': '0.0864'}
2025-03-06 22:03:54,533 - EarlyStopping counter: 2 out of 10
2025-03-06 22:04:19,235 - {'epoch': 22, 'rec_loss': '6.6363'}
2025-03-06 22:04:27,864 - {'Epoch': 22, 'HR@5': '0.0926', 'NDCG@5': '0.0661', 'HR@10': '0.1236', 'NDCG@10': '0.0762', 'HR@20': '0.1644', 'NDCG@20': '0.0865'}
2025-03-06 22:04:27,871 - EarlyStopping counter: 3 out of 10
2025-03-06 22:04:53,277 - {'epoch': 23, 'rec_loss': '6.6135'}
2025-03-06 22:05:01,682 - {'Epoch': 23, 'HR@5': '0.0916', 'NDCG@5': '0.0660', 'HR@10': '0.1229', 'NDCG@10': '0.0761', 'HR@20': '0.1637', 'NDCG@20': '0.0864'}
2025-03-06 22:05:01,691 - EarlyStopping counter: 4 out of 10
2025-03-06 22:05:29,927 - {'epoch': 24, 'rec_loss': '6.6030'}
2025-03-06 22:05:38,682 - {'Epoch': 24, 'HR@5': '0.0936', 'NDCG@5': '0.0668', 'HR@10': '0.1234', 'NDCG@10': '0.0764', 'HR@20': '0.1645', 'NDCG@20': '0.0868'}
2025-03-06 22:05:38,690 - EarlyStopping counter: 5 out of 10
2025-03-06 22:06:07,473 - {'epoch': 25, 'rec_loss': '6.5887'}
2025-03-06 22:06:16,859 - {'Epoch': 25, 'HR@5': '0.0921', 'NDCG@5': '0.0657', 'HR@10': '0.1233', 'NDCG@10': '0.0757', 'HR@20': '0.1641', 'NDCG@20': '0.0860'}
2025-03-06 22:06:16,865 - EarlyStopping counter: 6 out of 10
2025-03-06 22:06:43,759 - {'epoch': 26, 'rec_loss': '6.5719'}
2025-03-06 22:06:52,109 - {'Epoch': 26, 'HR@5': '0.0930', 'NDCG@5': '0.0671', 'HR@10': '0.1254', 'NDCG@10': '0.0775', 'HR@20': '0.1655', 'NDCG@20': '0.0876'}
2025-03-06 22:06:52,115 - EarlyStopping counter: 7 out of 10
2025-03-06 22:07:16,896 - {'epoch': 27, 'rec_loss': '6.5662'}
2025-03-06 22:07:25,430 - {'Epoch': 27, 'HR@5': '0.0909', 'NDCG@5': '0.0659', 'HR@10': '0.1224', 'NDCG@10': '0.0760', 'HR@20': '0.1641', 'NDCG@20': '0.0866'}
2025-03-06 22:07:25,436 - EarlyStopping counter: 8 out of 10
2025-03-06 22:07:50,918 - {'epoch': 28, 'rec_loss': '6.5511'}
2025-03-06 22:07:59,574 - {'Epoch': 28, 'HR@5': '0.0906', 'NDCG@5': '0.0658', 'HR@10': '0.1226', 'NDCG@10': '0.0761', 'HR@20': '0.1620', 'NDCG@20': '0.0861'}
2025-03-06 22:07:59,580 - EarlyStopping counter: 9 out of 10
2025-03-06 22:08:25,338 - {'epoch': 29, 'rec_loss': '6.5451'}
2025-03-06 22:08:34,281 - {'Epoch': 29, 'HR@5': '0.0919', 'NDCG@5': '0.0662', 'HR@10': '0.1247', 'NDCG@10': '0.0768', 'HR@20': '0.1650', 'NDCG@20': '0.0870'}
2025-03-06 22:08:34,289 - EarlyStopping counter: 10 out of 10
2025-03-06 22:08:34,290 - Early stopping
2025-03-06 22:08:34,290 - ---------------Test Score---------------
2025-03-06 22:08:43,017 - {'Epoch': 0, 'HR@5': '0.0763', 'NDCG@5': '0.0558', 'HR@10': '0.1042', 'NDCG@10': '0.0648', 'HR@20': '0.1401', 'NDCG@20': '0.0738'}
2025-03-06 22:08:43,022 - Scale_Toys
2025-03-06 22:08:43,023 - {'Epoch': 0, 'HR@5': '0.0763', 'NDCG@5': '0.0558', 'HR@10': '0.1042', 'NDCG@10': '0.0648', 'HR@20': '0.1401', 'NDCG@20': '0.0738'}
2025-03-06 22:11:15,471 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-03-06 22:11:19,213 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-06 22:11:19,226 - Total Parameters: 917142
2025-03-06 22:11:35,995 - {'epoch': 0, 'rec_loss': '9.1475'}
2025-03-06 22:11:43,433 - {'Epoch': 0, 'HR@5': '0.0085', 'NDCG@5': '0.0056', 'HR@10': '0.0130', 'NDCG@10': '0.0070', 'HR@20': '0.0202', 'NDCG@20': '0.0089'}
2025-03-06 22:11:43,438 - Validation score increased.  Saving model ...
2025-03-06 22:11:58,342 - {'epoch': 1, 'rec_loss': '8.8532'}
2025-03-06 22:12:06,521 - {'Epoch': 1, 'HR@5': '0.0114', 'NDCG@5': '0.0079', 'HR@10': '0.0178', 'NDCG@10': '0.0100', 'HR@20': '0.0296', 'NDCG@20': '0.0129'}
2025-03-06 22:12:06,531 - Validation score increased.  Saving model ...
2025-03-06 22:12:21,627 - {'epoch': 2, 'rec_loss': '8.5738'}
2025-03-06 22:12:29,560 - {'Epoch': 2, 'HR@5': '0.0249', 'NDCG@5': '0.0180', 'HR@10': '0.0356', 'NDCG@10': '0.0214', 'HR@20': '0.0532', 'NDCG@20': '0.0258'}
2025-03-06 22:12:29,565 - Validation score increased.  Saving model ...
2025-03-06 22:12:43,617 - {'epoch': 3, 'rec_loss': '8.3133'}
2025-03-06 22:12:51,201 - {'Epoch': 3, 'HR@5': '0.0375', 'NDCG@5': '0.0261', 'HR@10': '0.0545', 'NDCG@10': '0.0315', 'HR@20': '0.0792', 'NDCG@20': '0.0377'}
2025-03-06 22:12:51,208 - Validation score increased.  Saving model ...
2025-03-06 22:13:06,864 - {'epoch': 4, 'rec_loss': '8.0885'}
2025-03-06 22:13:15,083 - {'Epoch': 4, 'HR@5': '0.0461', 'NDCG@5': '0.0333', 'HR@10': '0.0681', 'NDCG@10': '0.0404', 'HR@20': '0.0974', 'NDCG@20': '0.0478'}
2025-03-06 22:13:15,091 - Validation score increased.  Saving model ...
2025-03-06 22:13:30,562 - {'epoch': 5, 'rec_loss': '7.9164'}
2025-03-06 22:13:38,528 - {'Epoch': 5, 'HR@5': '0.0577', 'NDCG@5': '0.0402', 'HR@10': '0.0814', 'NDCG@10': '0.0477', 'HR@20': '0.1123', 'NDCG@20': '0.0555'}
2025-03-06 22:13:38,536 - Validation score increased.  Saving model ...
2025-03-06 22:13:54,781 - {'epoch': 6, 'rec_loss': '7.7725'}
2025-03-06 22:14:02,869 - {'Epoch': 6, 'HR@5': '0.0640', 'NDCG@5': '0.0450', 'HR@10': '0.0894', 'NDCG@10': '0.0531', 'HR@20': '0.1253', 'NDCG@20': '0.0622'}
2025-03-06 22:14:02,875 - Validation score increased.  Saving model ...
2025-03-06 22:14:18,469 - {'epoch': 7, 'rec_loss': '7.6597'}
2025-03-06 22:14:26,553 - {'Epoch': 7, 'HR@5': '0.0706', 'NDCG@5': '0.0500', 'HR@10': '0.0976', 'NDCG@10': '0.0586', 'HR@20': '0.1354', 'NDCG@20': '0.0682'}
2025-03-06 22:14:26,557 - Validation score increased.  Saving model ...
2025-03-06 22:14:41,183 - {'epoch': 8, 'rec_loss': '7.5606'}
2025-03-06 22:14:48,605 - {'Epoch': 8, 'HR@5': '0.0761', 'NDCG@5': '0.0536', 'HR@10': '0.1052', 'NDCG@10': '0.0629', 'HR@20': '0.1422', 'NDCG@20': '0.0723'}
2025-03-06 22:14:48,606 - Validation score increased.  Saving model ...
2025-03-06 22:15:02,253 - {'epoch': 9, 'rec_loss': '7.4828'}
2025-03-06 22:15:09,945 - {'Epoch': 9, 'HR@5': '0.0789', 'NDCG@5': '0.0563', 'HR@10': '0.1095', 'NDCG@10': '0.0661', 'HR@20': '0.1451', 'NDCG@20': '0.0751'}
2025-03-06 22:15:09,950 - Validation score increased.  Saving model ...
2025-03-06 22:15:24,411 - {'epoch': 10, 'rec_loss': '7.4192'}
2025-03-06 22:15:32,446 - {'Epoch': 10, 'HR@5': '0.0791', 'NDCG@5': '0.0566', 'HR@10': '0.1109', 'NDCG@10': '0.0669', 'HR@20': '0.1488', 'NDCG@20': '0.0764'}
2025-03-06 22:15:32,453 - Validation score increased.  Saving model ...
2025-03-06 22:15:47,242 - {'epoch': 11, 'rec_loss': '7.3729'}
2025-03-06 22:15:54,970 - {'Epoch': 11, 'HR@5': '0.0829', 'NDCG@5': '0.0587', 'HR@10': '0.1130', 'NDCG@10': '0.0684', 'HR@20': '0.1520', 'NDCG@20': '0.0783'}
2025-03-06 22:15:54,977 - Validation score increased.  Saving model ...
2025-03-06 22:16:10,219 - {'epoch': 12, 'rec_loss': '7.3197'}
2025-03-06 22:16:18,486 - {'Epoch': 12, 'HR@5': '0.0843', 'NDCG@5': '0.0594', 'HR@10': '0.1139', 'NDCG@10': '0.0690', 'HR@20': '0.1532', 'NDCG@20': '0.0788'}
2025-03-06 22:16:18,491 - Validation score increased.  Saving model ...
2025-03-06 22:16:34,630 - {'epoch': 13, 'rec_loss': '7.2802'}
2025-03-06 22:16:42,470 - {'Epoch': 13, 'HR@5': '0.0848', 'NDCG@5': '0.0607', 'HR@10': '0.1154', 'NDCG@10': '0.0706', 'HR@20': '0.1571', 'NDCG@20': '0.0811'}
2025-03-06 22:16:42,476 - Validation score increased.  Saving model ...
2025-03-06 22:16:57,381 - {'epoch': 14, 'rec_loss': '7.2450'}
2025-03-06 22:17:05,500 - {'Epoch': 14, 'HR@5': '0.0852', 'NDCG@5': '0.0607', 'HR@10': '0.1156', 'NDCG@10': '0.0705', 'HR@20': '0.1579', 'NDCG@20': '0.0811'}
2025-03-06 22:17:05,508 - Validation score increased.  Saving model ...
2025-03-06 22:17:21,290 - {'epoch': 15, 'rec_loss': '7.2186'}
2025-03-06 22:17:29,337 - {'Epoch': 15, 'HR@5': '0.0871', 'NDCG@5': '0.0621', 'HR@10': '0.1189', 'NDCG@10': '0.0724', 'HR@20': '0.1565', 'NDCG@20': '0.0819'}
2025-03-06 22:17:29,338 - Validation score increased.  Saving model ...
2025-03-06 22:17:44,084 - {'epoch': 16, 'rec_loss': '7.1829'}
2025-03-06 22:17:51,550 - {'Epoch': 16, 'HR@5': '0.0871', 'NDCG@5': '0.0626', 'HR@10': '0.1197', 'NDCG@10': '0.0731', 'HR@20': '0.1585', 'NDCG@20': '0.0829'}
2025-03-06 22:17:51,555 - Validation score increased.  Saving model ...
2025-03-06 22:18:04,851 - {'epoch': 17, 'rec_loss': '7.1615'}
2025-03-06 22:18:12,761 - {'Epoch': 17, 'HR@5': '0.0894', 'NDCG@5': '0.0639', 'HR@10': '0.1193', 'NDCG@10': '0.0735', 'HR@20': '0.1593', 'NDCG@20': '0.0836'}
2025-03-06 22:18:12,769 - Validation score increased.  Saving model ...
2025-03-06 22:18:27,066 - {'epoch': 18, 'rec_loss': '7.1398'}
2025-03-06 22:18:34,918 - {'Epoch': 18, 'HR@5': '0.0890', 'NDCG@5': '0.0636', 'HR@10': '0.1203', 'NDCG@10': '0.0737', 'HR@20': '0.1581', 'NDCG@20': '0.0833'}
2025-03-06 22:18:34,924 - EarlyStopping counter: 1 out of 10
2025-03-06 22:18:48,918 - {'epoch': 19, 'rec_loss': '7.1226'}
2025-03-06 22:18:56,829 - {'Epoch': 19, 'HR@5': '0.0898', 'NDCG@5': '0.0643', 'HR@10': '0.1212', 'NDCG@10': '0.0743', 'HR@20': '0.1625', 'NDCG@20': '0.0847'}
2025-03-06 22:18:56,834 - Validation score increased.  Saving model ...
2025-03-06 22:19:12,825 - {'epoch': 20, 'rec_loss': '7.0943'}
2025-03-06 22:19:21,304 - {'Epoch': 20, 'HR@5': '0.0903', 'NDCG@5': '0.0636', 'HR@10': '0.1236', 'NDCG@10': '0.0743', 'HR@20': '0.1622', 'NDCG@20': '0.0840'}
2025-03-06 22:19:21,310 - EarlyStopping counter: 1 out of 10
2025-03-06 22:19:38,567 - {'epoch': 21, 'rec_loss': '7.0764'}
2025-03-06 22:19:47,312 - {'Epoch': 21, 'HR@5': '0.0904', 'NDCG@5': '0.0644', 'HR@10': '0.1216', 'NDCG@10': '0.0743', 'HR@20': '0.1621', 'NDCG@20': '0.0846'}
2025-03-06 22:19:47,321 - EarlyStopping counter: 2 out of 10
2025-03-06 22:20:04,855 - {'epoch': 22, 'rec_loss': '7.0611'}
2025-03-06 22:20:13,582 - {'Epoch': 22, 'HR@5': '0.0901', 'NDCG@5': '0.0643', 'HR@10': '0.1213', 'NDCG@10': '0.0743', 'HR@20': '0.1625', 'NDCG@20': '0.0847'}
2025-03-06 22:20:13,583 - Validation score increased.  Saving model ...
2025-03-06 22:20:30,268 - {'epoch': 23, 'rec_loss': '7.0460'}
2025-03-06 22:20:38,768 - {'Epoch': 23, 'HR@5': '0.0895', 'NDCG@5': '0.0640', 'HR@10': '0.1226', 'NDCG@10': '0.0747', 'HR@20': '0.1629', 'NDCG@20': '0.0848'}
2025-03-06 22:20:38,776 - Validation score increased.  Saving model ...
2025-03-06 22:20:52,894 - {'epoch': 24, 'rec_loss': '7.0394'}
2025-03-06 22:21:00,234 - {'Epoch': 24, 'HR@5': '0.0908', 'NDCG@5': '0.0648', 'HR@10': '0.1224', 'NDCG@10': '0.0750', 'HR@20': '0.1626', 'NDCG@20': '0.0851'}
2025-03-06 22:21:00,240 - Validation score increased.  Saving model ...
2025-03-06 22:21:14,342 - {'epoch': 25, 'rec_loss': '7.0268'}
2025-03-06 22:21:22,406 - {'Epoch': 25, 'HR@5': '0.0907', 'NDCG@5': '0.0651', 'HR@10': '0.1237', 'NDCG@10': '0.0757', 'HR@20': '0.1651', 'NDCG@20': '0.0861'}
2025-03-06 22:21:22,413 - Validation score increased.  Saving model ...
2025-03-06 22:21:36,782 - {'epoch': 26, 'rec_loss': '7.0083'}
2025-03-06 22:21:44,674 - {'Epoch': 26, 'HR@5': '0.0920', 'NDCG@5': '0.0660', 'HR@10': '0.1233', 'NDCG@10': '0.0760', 'HR@20': '0.1646', 'NDCG@20': '0.0864'}
2025-03-06 22:21:44,680 - Validation score increased.  Saving model ...
2025-03-06 22:21:59,349 - {'epoch': 27, 'rec_loss': '7.0087'}
2025-03-06 22:22:07,192 - {'Epoch': 27, 'HR@5': '0.0910', 'NDCG@5': '0.0657', 'HR@10': '0.1232', 'NDCG@10': '0.0761', 'HR@20': '0.1653', 'NDCG@20': '0.0867'}
2025-03-06 22:22:07,206 - Validation score increased.  Saving model ...
2025-03-06 22:22:23,976 - {'epoch': 28, 'rec_loss': '6.9868'}
2025-03-06 22:22:32,446 - {'Epoch': 28, 'HR@5': '0.0906', 'NDCG@5': '0.0649', 'HR@10': '0.1242', 'NDCG@10': '0.0757', 'HR@20': '0.1645', 'NDCG@20': '0.0859'}
2025-03-06 22:22:32,459 - EarlyStopping counter: 1 out of 10
2025-03-06 22:22:49,080 - {'epoch': 29, 'rec_loss': '6.9869'}
2025-03-06 22:22:57,440 - {'Epoch': 29, 'HR@5': '0.0915', 'NDCG@5': '0.0662', 'HR@10': '0.1252', 'NDCG@10': '0.0771', 'HR@20': '0.1666', 'NDCG@20': '0.0876'}
2025-03-06 22:22:57,445 - Validation score increased.  Saving model ...
2025-03-06 22:23:14,802 - {'epoch': 30, 'rec_loss': '6.9738'}
2025-03-06 22:23:23,386 - {'Epoch': 30, 'HR@5': '0.0923', 'NDCG@5': '0.0660', 'HR@10': '0.1260', 'NDCG@10': '0.0769', 'HR@20': '0.1669', 'NDCG@20': '0.0872'}
2025-03-06 22:23:23,394 - EarlyStopping counter: 1 out of 10
2025-03-06 22:23:40,657 - {'epoch': 31, 'rec_loss': '6.9652'}
2025-03-06 22:23:48,475 - {'Epoch': 31, 'HR@5': '0.0922', 'NDCG@5': '0.0658', 'HR@10': '0.1263', 'NDCG@10': '0.0768', 'HR@20': '0.1660', 'NDCG@20': '0.0868'}
2025-03-06 22:23:48,490 - EarlyStopping counter: 2 out of 10
2025-03-06 22:24:02,843 - {'epoch': 32, 'rec_loss': '6.9529'}
2025-03-06 22:24:10,877 - {'Epoch': 32, 'HR@5': '0.0918', 'NDCG@5': '0.0659', 'HR@10': '0.1268', 'NDCG@10': '0.0772', 'HR@20': '0.1673', 'NDCG@20': '0.0874'}
2025-03-06 22:24:10,878 - EarlyStopping counter: 3 out of 10
2025-03-06 22:24:24,947 - {'epoch': 33, 'rec_loss': '6.9499'}
2025-03-06 22:24:32,777 - {'Epoch': 33, 'HR@5': '0.0933', 'NDCG@5': '0.0671', 'HR@10': '0.1268', 'NDCG@10': '0.0779', 'HR@20': '0.1665', 'NDCG@20': '0.0879'}
2025-03-06 22:24:32,782 - Validation score increased.  Saving model ...
2025-03-06 22:24:47,927 - {'epoch': 34, 'rec_loss': '6.9443'}
2025-03-06 22:24:55,588 - {'Epoch': 34, 'HR@5': '0.0925', 'NDCG@5': '0.0662', 'HR@10': '0.1263', 'NDCG@10': '0.0771', 'HR@20': '0.1671', 'NDCG@20': '0.0873'}
2025-03-06 22:24:55,593 - EarlyStopping counter: 1 out of 10
2025-03-06 22:25:10,928 - {'epoch': 35, 'rec_loss': '6.9270'}
2025-03-06 22:25:19,344 - {'Epoch': 35, 'HR@5': '0.0926', 'NDCG@5': '0.0660', 'HR@10': '0.1245', 'NDCG@10': '0.0763', 'HR@20': '0.1659', 'NDCG@20': '0.0867'}
2025-03-06 22:25:19,352 - EarlyStopping counter: 2 out of 10
2025-03-06 22:25:36,071 - {'epoch': 36, 'rec_loss': '6.9248'}
2025-03-06 22:25:44,907 - {'Epoch': 36, 'HR@5': '0.0924', 'NDCG@5': '0.0663', 'HR@10': '0.1271', 'NDCG@10': '0.0775', 'HR@20': '0.1672', 'NDCG@20': '0.0876'}
2025-03-06 22:25:44,913 - EarlyStopping counter: 3 out of 10
2025-03-06 22:26:01,802 - {'epoch': 37, 'rec_loss': '6.9101'}
2025-03-06 22:26:09,909 - {'Epoch': 37, 'HR@5': '0.0928', 'NDCG@5': '0.0663', 'HR@10': '0.1274', 'NDCG@10': '0.0775', 'HR@20': '0.1680', 'NDCG@20': '0.0877'}
2025-03-06 22:26:09,922 - EarlyStopping counter: 4 out of 10
2025-03-06 22:26:26,343 - {'epoch': 38, 'rec_loss': '6.9089'}
2025-03-06 22:26:34,863 - {'Epoch': 38, 'HR@5': '0.0928', 'NDCG@5': '0.0663', 'HR@10': '0.1250', 'NDCG@10': '0.0766', 'HR@20': '0.1660', 'NDCG@20': '0.0870'}
2025-03-06 22:26:34,869 - EarlyStopping counter: 5 out of 10
2025-03-06 22:26:48,555 - {'epoch': 39, 'rec_loss': '6.8982'}
2025-03-06 22:26:56,175 - {'Epoch': 39, 'HR@5': '0.0925', 'NDCG@5': '0.0661', 'HR@10': '0.1254', 'NDCG@10': '0.0767', 'HR@20': '0.1654', 'NDCG@20': '0.0868'}
2025-03-06 22:26:56,180 - EarlyStopping counter: 6 out of 10
2025-03-06 22:27:10,262 - {'epoch': 40, 'rec_loss': '6.8953'}
2025-03-06 22:27:17,923 - {'Epoch': 40, 'HR@5': '0.0923', 'NDCG@5': '0.0667', 'HR@10': '0.1252', 'NDCG@10': '0.0773', 'HR@20': '0.1665', 'NDCG@20': '0.0877'}
2025-03-06 22:27:17,928 - EarlyStopping counter: 7 out of 10
2025-03-06 22:27:32,353 - {'epoch': 41, 'rec_loss': '6.9012'}
2025-03-06 22:27:40,415 - {'Epoch': 41, 'HR@5': '0.0932', 'NDCG@5': '0.0667', 'HR@10': '0.1260', 'NDCG@10': '0.0772', 'HR@20': '0.1669', 'NDCG@20': '0.0876'}
2025-03-06 22:27:40,421 - EarlyStopping counter: 8 out of 10
2025-03-06 22:27:54,481 - {'epoch': 42, 'rec_loss': '6.8812'}
2025-03-06 22:28:02,079 - {'Epoch': 42, 'HR@5': '0.0919', 'NDCG@5': '0.0656', 'HR@10': '0.1255', 'NDCG@10': '0.0764', 'HR@20': '0.1672', 'NDCG@20': '0.0869'}
2025-03-06 22:28:02,085 - EarlyStopping counter: 9 out of 10
2025-03-06 22:28:18,820 - {'epoch': 43, 'rec_loss': '6.8894'}
2025-03-06 22:28:27,403 - {'Epoch': 43, 'HR@5': '0.0928', 'NDCG@5': '0.0665', 'HR@10': '0.1263', 'NDCG@10': '0.0773', 'HR@20': '0.1686', 'NDCG@20': '0.0880'}
2025-03-06 22:28:27,414 - Validation score increased.  Saving model ...
2025-03-06 22:28:44,648 - {'epoch': 44, 'rec_loss': '6.8795'}
2025-03-06 22:28:53,017 - {'Epoch': 44, 'HR@5': '0.0934', 'NDCG@5': '0.0664', 'HR@10': '0.1255', 'NDCG@10': '0.0767', 'HR@20': '0.1689', 'NDCG@20': '0.0877'}
2025-03-06 22:28:53,022 - EarlyStopping counter: 1 out of 10
2025-03-06 22:29:10,235 - {'epoch': 45, 'rec_loss': '6.8687'}
2025-03-06 22:29:18,608 - {'Epoch': 45, 'HR@5': '0.0920', 'NDCG@5': '0.0653', 'HR@10': '0.1255', 'NDCG@10': '0.0762', 'HR@20': '0.1674', 'NDCG@20': '0.0867'}
2025-03-06 22:29:18,616 - EarlyStopping counter: 2 out of 10
2025-03-06 22:29:35,618 - {'epoch': 46, 'rec_loss': '6.8643'}
2025-03-06 22:29:43,095 - {'Epoch': 46, 'HR@5': '0.0925', 'NDCG@5': '0.0658', 'HR@10': '0.1265', 'NDCG@10': '0.0768', 'HR@20': '0.1677', 'NDCG@20': '0.0871'}
2025-03-06 22:29:43,099 - EarlyStopping counter: 3 out of 10
2025-03-06 22:29:56,437 - {'epoch': 47, 'rec_loss': '6.8577'}
2025-03-06 22:30:04,405 - {'Epoch': 47, 'HR@5': '0.0934', 'NDCG@5': '0.0669', 'HR@10': '0.1252', 'NDCG@10': '0.0771', 'HR@20': '0.1670', 'NDCG@20': '0.0876'}
2025-03-06 22:30:04,412 - EarlyStopping counter: 4 out of 10
2025-03-06 22:30:18,143 - {'epoch': 48, 'rec_loss': '6.8544'}
2025-03-06 22:30:25,870 - {'Epoch': 48, 'HR@5': '0.0944', 'NDCG@5': '0.0671', 'HR@10': '0.1281', 'NDCG@10': '0.0780', 'HR@20': '0.1671', 'NDCG@20': '0.0878'}
2025-03-06 22:30:25,877 - EarlyStopping counter: 5 out of 10
2025-03-06 22:30:40,662 - {'epoch': 49, 'rec_loss': '6.8580'}
2025-03-06 22:30:48,354 - {'Epoch': 49, 'HR@5': '0.0941', 'NDCG@5': '0.0670', 'HR@10': '0.1271', 'NDCG@10': '0.0777', 'HR@20': '0.1673', 'NDCG@20': '0.0878'}
2025-03-06 22:30:48,359 - EarlyStopping counter: 6 out of 10
2025-03-06 22:31:02,929 - {'epoch': 50, 'rec_loss': '6.8470'}
2025-03-06 22:31:11,031 - {'Epoch': 50, 'HR@5': '0.0935', 'NDCG@5': '0.0667', 'HR@10': '0.1260', 'NDCG@10': '0.0771', 'HR@20': '0.1673', 'NDCG@20': '0.0876'}
2025-03-06 22:31:11,036 - EarlyStopping counter: 7 out of 10
2025-03-06 22:31:27,977 - {'epoch': 51, 'rec_loss': '6.8319'}
2025-03-06 22:31:36,108 - {'Epoch': 51, 'HR@5': '0.0929', 'NDCG@5': '0.0663', 'HR@10': '0.1269', 'NDCG@10': '0.0773', 'HR@20': '0.1672', 'NDCG@20': '0.0875'}
2025-03-06 22:31:36,114 - EarlyStopping counter: 8 out of 10
2025-03-06 22:31:53,460 - {'epoch': 52, 'rec_loss': '6.8351'}
2025-03-06 22:32:01,951 - {'Epoch': 52, 'HR@5': '0.0927', 'NDCG@5': '0.0661', 'HR@10': '0.1257', 'NDCG@10': '0.0767', 'HR@20': '0.1666', 'NDCG@20': '0.0870'}
2025-03-06 22:32:01,956 - EarlyStopping counter: 9 out of 10
2025-03-06 22:32:18,163 - {'epoch': 53, 'rec_loss': '6.8246'}
2025-03-06 22:32:26,374 - {'Epoch': 53, 'HR@5': '0.0933', 'NDCG@5': '0.0667', 'HR@10': '0.1262', 'NDCG@10': '0.0772', 'HR@20': '0.1666', 'NDCG@20': '0.0874'}
2025-03-06 22:32:26,382 - EarlyStopping counter: 10 out of 10
2025-03-06 22:32:26,382 - Early stopping
2025-03-06 22:32:26,382 - ---------------Test Score---------------
2025-03-06 22:32:34,847 - {'Epoch': 0, 'HR@5': '0.0768', 'NDCG@5': '0.0550', 'HR@10': '0.1055', 'NDCG@10': '0.0642', 'HR@20': '0.1407', 'NDCG@20': '0.0731'}
2025-03-06 22:32:34,853 - Scale_Toys
2025-03-06 22:32:34,853 - {'Epoch': 0, 'HR@5': '0.0768', 'NDCG@5': '0.0550', 'HR@10': '0.1055', 'NDCG@10': '0.0642', 'HR@20': '0.1407', 'NDCG@20': '0.0731'}
2025-03-07 11:00:24,072 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-03-07 11:00:28,225 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-07 11:00:28,235 - Total Parameters: 917142
2025-03-07 11:00:47,875 - {'epoch': 0, 'rec_loss': '9.0838'}
2025-03-07 11:00:56,732 - {'Epoch': 0, 'HR@5': '0.0066', 'NDCG@5': '0.0042', 'HR@10': '0.0113', 'NDCG@10': '0.0057', 'HR@20': '0.0187', 'NDCG@20': '0.0076'}
2025-03-07 11:00:56,739 - Validation score increased.  Saving model ...
2025-03-07 11:01:16,374 - {'epoch': 1, 'rec_loss': '8.7362'}
2025-03-07 11:01:25,663 - {'Epoch': 1, 'HR@5': '0.0148', 'NDCG@5': '0.0099', 'HR@10': '0.0240', 'NDCG@10': '0.0129', 'HR@20': '0.0378', 'NDCG@20': '0.0163'}
2025-03-07 11:01:25,673 - Validation score increased.  Saving model ...
2025-03-07 11:01:44,238 - {'epoch': 2, 'rec_loss': '8.4893'}
2025-03-07 11:01:53,405 - {'Epoch': 2, 'HR@5': '0.0260', 'NDCG@5': '0.0182', 'HR@10': '0.0384', 'NDCG@10': '0.0221', 'HR@20': '0.0574', 'NDCG@20': '0.0269'}
2025-03-07 11:01:53,413 - Validation score increased.  Saving model ...
2025-03-07 11:02:09,514 - {'epoch': 3, 'rec_loss': '8.2542'}
2025-03-07 11:02:17,784 - {'Epoch': 3, 'HR@5': '0.0355', 'NDCG@5': '0.0253', 'HR@10': '0.0536', 'NDCG@10': '0.0311', 'HR@20': '0.0787', 'NDCG@20': '0.0374'}
2025-03-07 11:02:17,794 - Validation score increased.  Saving model ...
2025-03-07 11:02:35,417 - {'epoch': 4, 'rec_loss': '8.0441'}
2025-03-07 11:02:44,247 - {'Epoch': 4, 'HR@5': '0.0497', 'NDCG@5': '0.0343', 'HR@10': '0.0694', 'NDCG@10': '0.0406', 'HR@20': '0.0994', 'NDCG@20': '0.0481'}
2025-03-07 11:02:44,254 - Validation score increased.  Saving model ...
2025-03-07 11:03:02,143 - {'epoch': 5, 'rec_loss': '7.8780'}
2025-03-07 11:03:10,639 - {'Epoch': 5, 'HR@5': '0.0565', 'NDCG@5': '0.0399', 'HR@10': '0.0806', 'NDCG@10': '0.0476', 'HR@20': '0.1120', 'NDCG@20': '0.0555'}
2025-03-07 11:03:10,649 - Validation score increased.  Saving model ...
2025-03-07 11:03:27,906 - {'epoch': 6, 'rec_loss': '7.7328'}
2025-03-07 11:03:36,902 - {'Epoch': 6, 'HR@5': '0.0635', 'NDCG@5': '0.0449', 'HR@10': '0.0910', 'NDCG@10': '0.0538', 'HR@20': '0.1255', 'NDCG@20': '0.0625'}
2025-03-07 11:03:36,908 - Validation score increased.  Saving model ...
2025-03-07 11:03:56,067 - {'epoch': 7, 'rec_loss': '7.6209'}
2025-03-07 11:04:05,195 - {'Epoch': 7, 'HR@5': '0.0708', 'NDCG@5': '0.0500', 'HR@10': '0.0987', 'NDCG@10': '0.0590', 'HR@20': '0.1361', 'NDCG@20': '0.0684'}
2025-03-07 11:04:05,206 - Validation score increased.  Saving model ...
2025-03-07 11:04:25,134 - {'epoch': 8, 'rec_loss': '7.5263'}
2025-03-07 11:04:35,048 - {'Epoch': 8, 'HR@5': '0.0765', 'NDCG@5': '0.0539', 'HR@10': '0.1053', 'NDCG@10': '0.0632', 'HR@20': '0.1427', 'NDCG@20': '0.0726'}
2025-03-07 11:04:35,058 - Validation score increased.  Saving model ...
2025-03-07 11:04:55,547 - {'epoch': 9, 'rec_loss': '7.4478'}
2025-03-07 11:05:04,874 - {'Epoch': 9, 'HR@5': '0.0787', 'NDCG@5': '0.0560', 'HR@10': '0.1091', 'NDCG@10': '0.0658', 'HR@20': '0.1483', 'NDCG@20': '0.0757'}
2025-03-07 11:05:04,880 - Validation score increased.  Saving model ...
2025-03-07 11:05:23,691 - {'epoch': 10, 'rec_loss': '7.3836'}
2025-03-07 11:05:32,264 - {'Epoch': 10, 'HR@5': '0.0804', 'NDCG@5': '0.0580', 'HR@10': '0.1121', 'NDCG@10': '0.0683', 'HR@20': '0.1498', 'NDCG@20': '0.0778'}
2025-03-07 11:05:32,272 - Validation score increased.  Saving model ...
2025-03-07 11:05:51,198 - {'epoch': 11, 'rec_loss': '7.3274'}
2025-03-07 11:05:59,785 - {'Epoch': 11, 'HR@5': '0.0836', 'NDCG@5': '0.0598', 'HR@10': '0.1148', 'NDCG@10': '0.0698', 'HR@20': '0.1527', 'NDCG@20': '0.0794'}
2025-03-07 11:05:59,791 - Validation score increased.  Saving model ...
2025-03-07 11:06:16,852 - {'epoch': 12, 'rec_loss': '7.2785'}
2025-03-07 11:06:25,808 - {'Epoch': 12, 'HR@5': '0.0852', 'NDCG@5': '0.0603', 'HR@10': '0.1177', 'NDCG@10': '0.0707', 'HR@20': '0.1554', 'NDCG@20': '0.0802'}
2025-03-07 11:06:25,819 - Validation score increased.  Saving model ...
2025-03-07 11:06:42,332 - {'epoch': 13, 'rec_loss': '7.2409'}
2025-03-07 11:06:50,679 - {'Epoch': 13, 'HR@5': '0.0863', 'NDCG@5': '0.0618', 'HR@10': '0.1164', 'NDCG@10': '0.0716', 'HR@20': '0.1578', 'NDCG@20': '0.0820'}
2025-03-07 11:06:50,689 - Validation score increased.  Saving model ...
2025-03-07 11:07:08,461 - {'epoch': 14, 'rec_loss': '7.1991'}
2025-03-07 11:07:16,952 - {'Epoch': 14, 'HR@5': '0.0871', 'NDCG@5': '0.0620', 'HR@10': '0.1176', 'NDCG@10': '0.0718', 'HR@20': '0.1577', 'NDCG@20': '0.0820'}
2025-03-07 11:07:16,959 - EarlyStopping counter: 1 out of 10
2025-03-07 11:07:35,028 - {'epoch': 15, 'rec_loss': '7.1697'}
2025-03-07 11:07:44,174 - {'Epoch': 15, 'HR@5': '0.0874', 'NDCG@5': '0.0629', 'HR@10': '0.1195', 'NDCG@10': '0.0733', 'HR@20': '0.1593', 'NDCG@20': '0.0833'}
2025-03-07 11:07:44,188 - Validation score increased.  Saving model ...
2025-03-07 11:08:04,368 - {'epoch': 16, 'rec_loss': '7.1418'}
2025-03-07 11:08:13,690 - {'Epoch': 16, 'HR@5': '0.0885', 'NDCG@5': '0.0638', 'HR@10': '0.1200', 'NDCG@10': '0.0740', 'HR@20': '0.1594', 'NDCG@20': '0.0839'}
2025-03-07 11:08:13,701 - Validation score increased.  Saving model ...
2025-03-07 11:08:33,422 - {'epoch': 17, 'rec_loss': '7.1161'}
2025-03-07 11:08:42,127 - {'Epoch': 17, 'HR@5': '0.0890', 'NDCG@5': '0.0636', 'HR@10': '0.1220', 'NDCG@10': '0.0743', 'HR@20': '0.1619', 'NDCG@20': '0.0843'}
2025-03-07 11:08:42,134 - Validation score increased.  Saving model ...
2025-03-07 11:09:00,736 - {'epoch': 18, 'rec_loss': '7.0997'}
2025-03-07 11:09:09,795 - {'Epoch': 18, 'HR@5': '0.0890', 'NDCG@5': '0.0636', 'HR@10': '0.1211', 'NDCG@10': '0.0740', 'HR@20': '0.1597', 'NDCG@20': '0.0838'}
2025-03-07 11:09:09,805 - EarlyStopping counter: 1 out of 10
2025-03-07 11:09:27,747 - {'epoch': 19, 'rec_loss': '7.0774'}
2025-03-07 11:09:36,954 - {'Epoch': 19, 'HR@5': '0.0899', 'NDCG@5': '0.0648', 'HR@10': '0.1220', 'NDCG@10': '0.0752', 'HR@20': '0.1618', 'NDCG@20': '0.0852'}
2025-03-07 11:09:36,962 - Validation score increased.  Saving model ...
2025-03-07 11:09:54,164 - {'epoch': 20, 'rec_loss': '7.0572'}
2025-03-07 11:10:02,899 - {'Epoch': 20, 'HR@5': '0.0897', 'NDCG@5': '0.0646', 'HR@10': '0.1238', 'NDCG@10': '0.0756', 'HR@20': '0.1632', 'NDCG@20': '0.0855'}
2025-03-07 11:10:02,905 - Validation score increased.  Saving model ...
2025-03-07 11:10:21,655 - {'epoch': 21, 'rec_loss': '7.0311'}
2025-03-07 11:10:29,776 - {'Epoch': 21, 'HR@5': '0.0897', 'NDCG@5': '0.0645', 'HR@10': '0.1224', 'NDCG@10': '0.0750', 'HR@20': '0.1647', 'NDCG@20': '0.0857'}
2025-03-07 11:10:29,785 - Validation score increased.  Saving model ...
2025-03-07 11:10:48,034 - {'epoch': 22, 'rec_loss': '7.0237'}
2025-03-07 11:10:56,923 - {'Epoch': 22, 'HR@5': '0.0907', 'NDCG@5': '0.0649', 'HR@10': '0.1227', 'NDCG@10': '0.0752', 'HR@20': '0.1636', 'NDCG@20': '0.0855'}
2025-03-07 11:10:56,935 - EarlyStopping counter: 1 out of 10
2025-03-07 11:11:15,699 - {'epoch': 23, 'rec_loss': '7.0005'}
2025-03-07 11:11:24,989 - {'Epoch': 23, 'HR@5': '0.0913', 'NDCG@5': '0.0658', 'HR@10': '0.1243', 'NDCG@10': '0.0765', 'HR@20': '0.1645', 'NDCG@20': '0.0866'}
2025-03-07 11:11:24,997 - Validation score increased.  Saving model ...
2025-03-07 11:11:44,994 - {'epoch': 24, 'rec_loss': '7.0003'}
2025-03-07 11:11:54,026 - {'Epoch': 24, 'HR@5': '0.0905', 'NDCG@5': '0.0655', 'HR@10': '0.1236', 'NDCG@10': '0.0762', 'HR@20': '0.1642', 'NDCG@20': '0.0864'}
2025-03-07 11:11:54,033 - EarlyStopping counter: 1 out of 10
2025-03-07 11:12:13,259 - {'epoch': 25, 'rec_loss': '6.9781'}
2025-03-07 11:12:22,810 - {'Epoch': 25, 'HR@5': '0.0914', 'NDCG@5': '0.0655', 'HR@10': '0.1236', 'NDCG@10': '0.0759', 'HR@20': '0.1652', 'NDCG@20': '0.0863'}
2025-03-07 11:12:22,818 - EarlyStopping counter: 2 out of 10
2025-03-07 11:12:40,400 - {'epoch': 26, 'rec_loss': '6.9669'}
2025-03-07 11:12:48,948 - {'Epoch': 26, 'HR@5': '0.0912', 'NDCG@5': '0.0656', 'HR@10': '0.1238', 'NDCG@10': '0.0761', 'HR@20': '0.1645', 'NDCG@20': '0.0863'}
2025-03-07 11:12:48,959 - EarlyStopping counter: 3 out of 10
2025-03-07 11:13:06,164 - {'epoch': 27, 'rec_loss': '6.9624'}
2025-03-07 11:13:14,535 - {'Epoch': 27, 'HR@5': '0.0928', 'NDCG@5': '0.0666', 'HR@10': '0.1247', 'NDCG@10': '0.0769', 'HR@20': '0.1640', 'NDCG@20': '0.0868'}
2025-03-07 11:13:14,545 - Validation score increased.  Saving model ...
2025-03-07 11:13:32,943 - {'epoch': 28, 'rec_loss': '6.9448'}
2025-03-07 11:13:41,762 - {'Epoch': 28, 'HR@5': '0.0917', 'NDCG@5': '0.0658', 'HR@10': '0.1232', 'NDCG@10': '0.0760', 'HR@20': '0.1648', 'NDCG@20': '0.0865'}
2025-03-07 11:13:41,769 - EarlyStopping counter: 1 out of 10
2025-03-07 11:13:58,694 - {'epoch': 29, 'rec_loss': '6.9371'}
2025-03-07 11:14:08,359 - {'Epoch': 29, 'HR@5': '0.0917', 'NDCG@5': '0.0661', 'HR@10': '0.1242', 'NDCG@10': '0.0766', 'HR@20': '0.1653', 'NDCG@20': '0.0870'}
2025-03-07 11:14:08,367 - Validation score increased.  Saving model ...
2025-03-07 11:14:27,703 - {'epoch': 30, 'rec_loss': '6.9325'}
2025-03-07 11:14:37,256 - {'Epoch': 30, 'HR@5': '0.0923', 'NDCG@5': '0.0664', 'HR@10': '0.1253', 'NDCG@10': '0.0770', 'HR@20': '0.1658', 'NDCG@20': '0.0872'}
2025-03-07 11:14:37,266 - Validation score increased.  Saving model ...
2025-03-07 11:14:55,572 - {'epoch': 31, 'rec_loss': '6.9189'}
2025-03-07 11:15:05,227 - {'Epoch': 31, 'HR@5': '0.0910', 'NDCG@5': '0.0654', 'HR@10': '0.1248', 'NDCG@10': '0.0763', 'HR@20': '0.1665', 'NDCG@20': '0.0868'}
2025-03-07 11:15:05,233 - EarlyStopping counter: 1 out of 10
2025-03-07 11:15:23,112 - {'epoch': 32, 'rec_loss': '6.9081'}
2025-03-07 11:15:32,252 - {'Epoch': 32, 'HR@5': '0.0916', 'NDCG@5': '0.0662', 'HR@10': '0.1243', 'NDCG@10': '0.0767', 'HR@20': '0.1664', 'NDCG@20': '0.0873'}
2025-03-07 11:15:32,262 - Validation score increased.  Saving model ...
2025-03-07 11:15:51,956 - {'epoch': 33, 'rec_loss': '6.9042'}
2025-03-07 11:16:01,532 - {'Epoch': 33, 'HR@5': '0.0922', 'NDCG@5': '0.0665', 'HR@10': '0.1246', 'NDCG@10': '0.0770', 'HR@20': '0.1670', 'NDCG@20': '0.0876'}
2025-03-07 11:16:01,541 - Validation score increased.  Saving model ...
2025-03-07 11:16:19,186 - {'epoch': 34, 'rec_loss': '6.8984'}
2025-03-07 11:16:28,163 - {'Epoch': 34, 'HR@5': '0.0915', 'NDCG@5': '0.0664', 'HR@10': '0.1254', 'NDCG@10': '0.0773', 'HR@20': '0.1655', 'NDCG@20': '0.0874'}
2025-03-07 11:16:28,174 - EarlyStopping counter: 1 out of 10
2025-03-07 11:16:45,051 - {'epoch': 35, 'rec_loss': '6.8821'}
2025-03-07 11:16:54,290 - {'Epoch': 35, 'HR@5': '0.0915', 'NDCG@5': '0.0661', 'HR@10': '0.1247', 'NDCG@10': '0.0767', 'HR@20': '0.1641', 'NDCG@20': '0.0866'}
2025-03-07 11:16:54,303 - EarlyStopping counter: 2 out of 10
2025-03-07 11:17:11,197 - {'epoch': 36, 'rec_loss': '6.8886'}
2025-03-07 11:17:19,826 - {'Epoch': 36, 'HR@5': '0.0930', 'NDCG@5': '0.0661', 'HR@10': '0.1242', 'NDCG@10': '0.0762', 'HR@20': '0.1644', 'NDCG@20': '0.0863'}
2025-03-07 11:17:19,833 - EarlyStopping counter: 3 out of 10
2025-03-07 11:17:40,589 - {'epoch': 37, 'rec_loss': '6.8693'}
2025-03-07 11:17:50,064 - {'Epoch': 37, 'HR@5': '0.0931', 'NDCG@5': '0.0671', 'HR@10': '0.1267', 'NDCG@10': '0.0779', 'HR@20': '0.1652', 'NDCG@20': '0.0875'}
2025-03-07 11:17:50,071 - EarlyStopping counter: 4 out of 10
2025-03-07 11:18:08,521 - {'epoch': 38, 'rec_loss': '6.8652'}
2025-03-07 11:18:18,006 - {'Epoch': 38, 'HR@5': '0.0927', 'NDCG@5': '0.0665', 'HR@10': '0.1245', 'NDCG@10': '0.0767', 'HR@20': '0.1658', 'NDCG@20': '0.0871'}
2025-03-07 11:18:18,013 - EarlyStopping counter: 5 out of 10
2025-03-07 11:18:34,549 - {'epoch': 39, 'rec_loss': '6.8557'}
2025-03-07 11:18:43,525 - {'Epoch': 39, 'HR@5': '0.0937', 'NDCG@5': '0.0668', 'HR@10': '0.1242', 'NDCG@10': '0.0766', 'HR@20': '0.1660', 'NDCG@20': '0.0872'}
2025-03-07 11:18:43,531 - EarlyStopping counter: 6 out of 10
2025-03-07 11:19:02,893 - {'epoch': 40, 'rec_loss': '6.8516'}
2025-03-07 11:19:11,986 - {'Epoch': 40, 'HR@5': '0.0928', 'NDCG@5': '0.0666', 'HR@10': '0.1257', 'NDCG@10': '0.0772', 'HR@20': '0.1666', 'NDCG@20': '0.0874'}
2025-03-07 11:19:11,999 - EarlyStopping counter: 7 out of 10
2025-03-07 11:19:29,880 - {'epoch': 41, 'rec_loss': '6.8495'}
2025-03-07 11:19:38,819 - {'Epoch': 41, 'HR@5': '0.0942', 'NDCG@5': '0.0677', 'HR@10': '0.1270', 'NDCG@10': '0.0782', 'HR@20': '0.1653', 'NDCG@20': '0.0879'}
2025-03-07 11:19:38,827 - Validation score increased.  Saving model ...
2025-03-07 11:19:55,796 - {'epoch': 42, 'rec_loss': '6.8397'}
2025-03-07 11:20:05,287 - {'Epoch': 42, 'HR@5': '0.0940', 'NDCG@5': '0.0670', 'HR@10': '0.1255', 'NDCG@10': '0.0772', 'HR@20': '0.1668', 'NDCG@20': '0.0875'}
2025-03-07 11:20:05,293 - EarlyStopping counter: 1 out of 10
2025-03-07 11:20:23,471 - {'epoch': 43, 'rec_loss': '6.8468'}
2025-03-07 11:20:32,234 - {'Epoch': 43, 'HR@5': '0.0930', 'NDCG@5': '0.0672', 'HR@10': '0.1258', 'NDCG@10': '0.0778', 'HR@20': '0.1688', 'NDCG@20': '0.0886'}
2025-03-07 11:20:32,240 - Validation score increased.  Saving model ...
2025-03-07 11:20:50,321 - {'epoch': 44, 'rec_loss': '6.8315'}
2025-03-07 11:20:59,505 - {'Epoch': 44, 'HR@5': '0.0939', 'NDCG@5': '0.0674', 'HR@10': '0.1252', 'NDCG@10': '0.0775', 'HR@20': '0.1672', 'NDCG@20': '0.0880'}
2025-03-07 11:20:59,512 - EarlyStopping counter: 1 out of 10
2025-03-07 11:21:18,912 - {'epoch': 45, 'rec_loss': '6.8226'}
2025-03-07 11:21:28,022 - {'Epoch': 45, 'HR@5': '0.0938', 'NDCG@5': '0.0670', 'HR@10': '0.1255', 'NDCG@10': '0.0772', 'HR@20': '0.1672', 'NDCG@20': '0.0877'}
2025-03-07 11:21:28,032 - EarlyStopping counter: 2 out of 10
2025-03-07 11:21:45,207 - {'epoch': 46, 'rec_loss': '6.8199'}
2025-03-07 11:21:54,129 - {'Epoch': 46, 'HR@5': '0.0932', 'NDCG@5': '0.0668', 'HR@10': '0.1257', 'NDCG@10': '0.0773', 'HR@20': '0.1672', 'NDCG@20': '0.0877'}
2025-03-07 11:21:54,134 - EarlyStopping counter: 3 out of 10
2025-03-07 11:22:13,767 - {'epoch': 47, 'rec_loss': '6.8155'}
2025-03-07 11:22:23,905 - {'Epoch': 47, 'HR@5': '0.0943', 'NDCG@5': '0.0676', 'HR@10': '0.1245', 'NDCG@10': '0.0774', 'HR@20': '0.1650', 'NDCG@20': '0.0876'}
2025-03-07 11:22:23,915 - EarlyStopping counter: 4 out of 10
2025-03-07 11:22:40,495 - {'epoch': 48, 'rec_loss': '6.8159'}
2025-03-07 11:22:49,947 - {'Epoch': 48, 'HR@5': '0.0953', 'NDCG@5': '0.0686', 'HR@10': '0.1266', 'NDCG@10': '0.0787', 'HR@20': '0.1675', 'NDCG@20': '0.0890'}
2025-03-07 11:22:49,954 - Validation score increased.  Saving model ...
2025-03-07 11:23:08,296 - {'epoch': 49, 'rec_loss': '6.8072'}
2025-03-07 11:23:17,418 - {'Epoch': 49, 'HR@5': '0.0954', 'NDCG@5': '0.0687', 'HR@10': '0.1262', 'NDCG@10': '0.0786', 'HR@20': '0.1675', 'NDCG@20': '0.0891'}
2025-03-07 11:23:17,425 - Validation score increased.  Saving model ...
2025-03-07 11:23:36,216 - {'epoch': 50, 'rec_loss': '6.8002'}
2025-03-07 11:23:44,838 - {'Epoch': 50, 'HR@5': '0.0940', 'NDCG@5': '0.0673', 'HR@10': '0.1269', 'NDCG@10': '0.0779', 'HR@20': '0.1678', 'NDCG@20': '0.0882'}
2025-03-07 11:23:44,849 - EarlyStopping counter: 1 out of 10
2025-03-07 11:24:02,766 - {'epoch': 51, 'rec_loss': '6.7943'}
2025-03-07 11:24:11,908 - {'Epoch': 51, 'HR@5': '0.0944', 'NDCG@5': '0.0678', 'HR@10': '0.1264', 'NDCG@10': '0.0781', 'HR@20': '0.1678', 'NDCG@20': '0.0886'}
2025-03-07 11:24:11,916 - EarlyStopping counter: 2 out of 10
2025-03-07 11:24:30,970 - {'epoch': 52, 'rec_loss': '6.7876'}
2025-03-07 11:24:40,684 - {'Epoch': 52, 'HR@5': '0.0944', 'NDCG@5': '0.0678', 'HR@10': '0.1269', 'NDCG@10': '0.0784', 'HR@20': '0.1668', 'NDCG@20': '0.0884'}
2025-03-07 11:24:40,696 - EarlyStopping counter: 3 out of 10
2025-03-07 11:24:57,991 - {'epoch': 53, 'rec_loss': '6.7880'}
2025-03-07 11:25:06,040 - {'Epoch': 53, 'HR@5': '0.0959', 'NDCG@5': '0.0682', 'HR@10': '0.1265', 'NDCG@10': '0.0781', 'HR@20': '0.1677', 'NDCG@20': '0.0884'}
2025-03-07 11:25:06,045 - EarlyStopping counter: 4 out of 10
2025-03-07 11:25:23,723 - {'epoch': 54, 'rec_loss': '6.7811'}
2025-03-07 11:25:33,072 - {'Epoch': 54, 'HR@5': '0.0941', 'NDCG@5': '0.0684', 'HR@10': '0.1260', 'NDCG@10': '0.0787', 'HR@20': '0.1660', 'NDCG@20': '0.0888'}
2025-03-07 11:25:33,078 - EarlyStopping counter: 5 out of 10
2025-03-07 11:25:51,459 - {'epoch': 55, 'rec_loss': '6.7790'}
2025-03-07 11:25:59,947 - {'Epoch': 55, 'HR@5': '0.0948', 'NDCG@5': '0.0681', 'HR@10': '0.1283', 'NDCG@10': '0.0789', 'HR@20': '0.1670', 'NDCG@20': '0.0886'}
2025-03-07 11:25:59,957 - EarlyStopping counter: 6 out of 10
2025-03-07 11:26:16,819 - {'epoch': 56, 'rec_loss': '6.7779'}
2025-03-07 11:26:25,574 - {'Epoch': 56, 'HR@5': '0.0956', 'NDCG@5': '0.0684', 'HR@10': '0.1275', 'NDCG@10': '0.0787', 'HR@20': '0.1674', 'NDCG@20': '0.0887'}
2025-03-07 11:26:25,582 - EarlyStopping counter: 7 out of 10
2025-03-07 11:26:45,201 - {'epoch': 57, 'rec_loss': '6.7795'}
2025-03-07 11:26:54,482 - {'Epoch': 57, 'HR@5': '0.0948', 'NDCG@5': '0.0679', 'HR@10': '0.1272', 'NDCG@10': '0.0784', 'HR@20': '0.1661', 'NDCG@20': '0.0882'}
2025-03-07 11:26:54,488 - EarlyStopping counter: 8 out of 10
2025-03-07 11:27:11,544 - {'epoch': 58, 'rec_loss': '6.7688'}
2025-03-07 11:27:20,142 - {'Epoch': 58, 'HR@5': '0.0950', 'NDCG@5': '0.0683', 'HR@10': '0.1272', 'NDCG@10': '0.0787', 'HR@20': '0.1675', 'NDCG@20': '0.0888'}
2025-03-07 11:27:20,152 - EarlyStopping counter: 9 out of 10
2025-03-07 11:27:40,301 - {'epoch': 59, 'rec_loss': '6.7737'}
2025-03-07 11:27:50,115 - {'Epoch': 59, 'HR@5': '0.0950', 'NDCG@5': '0.0682', 'HR@10': '0.1255', 'NDCG@10': '0.0780', 'HR@20': '0.1670', 'NDCG@20': '0.0885'}
2025-03-07 11:27:50,124 - EarlyStopping counter: 10 out of 10
2025-03-07 11:27:50,125 - Early stopping
2025-03-07 11:27:50,125 - ---------------Test Score---------------
2025-03-07 11:27:59,150 - {'Epoch': 0, 'HR@5': '0.0761', 'NDCG@5': '0.0546', 'HR@10': '0.1048', 'NDCG@10': '0.0639', 'HR@20': '0.1399', 'NDCG@20': '0.0728'}
2025-03-07 11:27:59,156 - Scale_Toys
2025-03-07 11:27:59,156 - {'Epoch': 0, 'HR@5': '0.0761', 'NDCG@5': '0.0546', 'HR@10': '0.1048', 'NDCG@10': '0.0639', 'HR@20': '0.1399', 'NDCG@20': '0.0728'}
2025-03-07 13:26:07,828 - Namespace(data_dir='./data/', output_dir='output/', data_name='Toys_and_Games', do_eval=False, load_model=None, train_name='Scale_Toys', num_items=10, num_users=19413, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Toys_and_Games.txt', item_size=11925, checkpoint_path='output/Scale_Toys.pt', same_target_path='./data/Toys_and_Games_same_target.npy')
2025-03-07 13:26:11,979 - ScaleRecModel(
  (item_embeddings): Embedding(11925, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-07 13:26:11,987 - Total Parameters: 917142
2025-03-07 13:26:40,413 - {'epoch': 0, 'rec_loss': '9.1019'}
2025-03-07 13:26:50,540 - {'Epoch': 0, 'HR@5': '0.0071', 'NDCG@5': '0.0048', 'HR@10': '0.0106', 'NDCG@10': '0.0059', 'HR@20': '0.0183', 'NDCG@20': '0.0079'}
2025-03-07 13:26:50,545 - Validation score increased.  Saving model ...
2025-03-07 13:27:15,842 - {'epoch': 1, 'rec_loss': '8.7992'}
2025-03-07 13:27:26,818 - {'Epoch': 1, 'HR@5': '0.0114', 'NDCG@5': '0.0070', 'HR@10': '0.0184', 'NDCG@10': '0.0092', 'HR@20': '0.0301', 'NDCG@20': '0.0121'}
2025-03-07 13:27:26,826 - Validation score increased.  Saving model ...
2025-03-07 13:27:52,886 - {'epoch': 2, 'rec_loss': '8.5450'}
2025-03-07 13:28:01,775 - {'Epoch': 2, 'HR@5': '0.0206', 'NDCG@5': '0.0148', 'HR@10': '0.0298', 'NDCG@10': '0.0178', 'HR@20': '0.0448', 'NDCG@20': '0.0215'}
2025-03-07 13:28:01,782 - Validation score increased.  Saving model ...
2025-03-07 13:28:24,063 - {'epoch': 3, 'rec_loss': '8.3492'}
2025-03-07 13:28:33,219 - {'Epoch': 3, 'HR@5': '0.0283', 'NDCG@5': '0.0203', 'HR@10': '0.0416', 'NDCG@10': '0.0246', 'HR@20': '0.0620', 'NDCG@20': '0.0297'}
2025-03-07 13:28:33,227 - Validation score increased.  Saving model ...
2025-03-07 13:28:56,084 - {'epoch': 4, 'rec_loss': '8.1637'}
2025-03-07 13:29:04,889 - {'Epoch': 4, 'HR@5': '0.0385', 'NDCG@5': '0.0276', 'HR@10': '0.0580', 'NDCG@10': '0.0339', 'HR@20': '0.0817', 'NDCG@20': '0.0399'}
2025-03-07 13:29:04,897 - Validation score increased.  Saving model ...
2025-03-07 13:29:23,690 - {'epoch': 5, 'rec_loss': '8.0005'}
2025-03-07 13:29:31,978 - {'Epoch': 5, 'HR@5': '0.0502', 'NDCG@5': '0.0353', 'HR@10': '0.0696', 'NDCG@10': '0.0415', 'HR@20': '0.0993', 'NDCG@20': '0.0490'}
2025-03-07 13:29:31,985 - Validation score increased.  Saving model ...
2025-03-07 13:29:53,052 - {'epoch': 6, 'rec_loss': '7.8610'}
2025-03-07 13:30:03,129 - {'Epoch': 6, 'HR@5': '0.0570', 'NDCG@5': '0.0403', 'HR@10': '0.0815', 'NDCG@10': '0.0481', 'HR@20': '0.1101', 'NDCG@20': '0.0553'}
2025-03-07 13:30:03,140 - Validation score increased.  Saving model ...
2025-03-07 13:30:28,710 - {'epoch': 7, 'rec_loss': '7.7517'}
2025-03-07 13:30:38,547 - {'Epoch': 7, 'HR@5': '0.0638', 'NDCG@5': '0.0454', 'HR@10': '0.0894', 'NDCG@10': '0.0537', 'HR@20': '0.1209', 'NDCG@20': '0.0616'}
2025-03-07 13:30:38,557 - Validation score increased.  Saving model ...
2025-03-07 13:31:05,275 - {'epoch': 8, 'rec_loss': '7.6526'}
2025-03-07 13:31:16,007 - {'Epoch': 8, 'HR@5': '0.0705', 'NDCG@5': '0.0501', 'HR@10': '0.0963', 'NDCG@10': '0.0584', 'HR@20': '0.1286', 'NDCG@20': '0.0665'}
2025-03-07 13:31:16,015 - Validation score increased.  Saving model ...
2025-03-07 13:31:43,655 - {'epoch': 9, 'rec_loss': '7.5768'}
2025-03-07 13:31:53,423 - {'Epoch': 9, 'HR@5': '0.0735', 'NDCG@5': '0.0530', 'HR@10': '0.1022', 'NDCG@10': '0.0622', 'HR@20': '0.1342', 'NDCG@20': '0.0702'}
2025-03-07 13:31:53,432 - Validation score increased.  Saving model ...
2025-03-07 13:32:16,022 - {'epoch': 10, 'rec_loss': '7.5074'}
2025-03-07 13:32:24,668 - {'Epoch': 10, 'HR@5': '0.0760', 'NDCG@5': '0.0549', 'HR@10': '0.1039', 'NDCG@10': '0.0638', 'HR@20': '0.1369', 'NDCG@20': '0.0722'}
2025-03-07 13:32:24,679 - Validation score increased.  Saving model ...
2025-03-07 13:32:45,503 - {'epoch': 11, 'rec_loss': '7.4510'}
2025-03-07 13:32:53,633 - {'Epoch': 11, 'HR@5': '0.0796', 'NDCG@5': '0.0578', 'HR@10': '0.1072', 'NDCG@10': '0.0667', 'HR@20': '0.1407', 'NDCG@20': '0.0752'}
2025-03-07 13:32:53,641 - Validation score increased.  Saving model ...
2025-03-07 13:33:13,297 - {'epoch': 12, 'rec_loss': '7.3996'}
2025-03-07 13:33:21,270 - {'Epoch': 12, 'HR@5': '0.0820', 'NDCG@5': '0.0594', 'HR@10': '0.1091', 'NDCG@10': '0.0681', 'HR@20': '0.1437', 'NDCG@20': '0.0768'}
2025-03-07 13:33:21,276 - Validation score increased.  Saving model ...
2025-03-07 13:33:42,808 - {'epoch': 13, 'rec_loss': '7.3623'}
2025-03-07 13:33:51,648 - {'Epoch': 13, 'HR@5': '0.0841', 'NDCG@5': '0.0609', 'HR@10': '0.1109', 'NDCG@10': '0.0695', 'HR@20': '0.1461', 'NDCG@20': '0.0784'}
2025-03-07 13:33:51,657 - Validation score increased.  Saving model ...
2025-03-07 13:34:19,554 - {'epoch': 14, 'rec_loss': '7.3249'}
2025-03-07 13:34:30,147 - {'Epoch': 14, 'HR@5': '0.0845', 'NDCG@5': '0.0609', 'HR@10': '0.1130', 'NDCG@10': '0.0701', 'HR@20': '0.1468', 'NDCG@20': '0.0786'}
2025-03-07 13:34:30,155 - Validation score increased.  Saving model ...
2025-03-07 13:34:59,851 - {'epoch': 15, 'rec_loss': '7.2925'}
2025-03-07 13:35:10,918 - {'Epoch': 15, 'HR@5': '0.0859', 'NDCG@5': '0.0622', 'HR@10': '0.1160', 'NDCG@10': '0.0719', 'HR@20': '0.1491', 'NDCG@20': '0.0802'}
2025-03-07 13:35:10,932 - Validation score increased.  Saving model ...
2025-03-07 13:35:40,631 - {'epoch': 16, 'rec_loss': '7.2656'}
2025-03-07 13:35:50,268 - {'Epoch': 16, 'HR@5': '0.0859', 'NDCG@5': '0.0622', 'HR@10': '0.1150', 'NDCG@10': '0.0716', 'HR@20': '0.1510', 'NDCG@20': '0.0806'}
2025-03-07 13:35:50,282 - Validation score increased.  Saving model ...
2025-03-07 13:36:13,828 - {'epoch': 17, 'rec_loss': '7.2408'}
2025-03-07 13:36:22,269 - {'Epoch': 17, 'HR@5': '0.0879', 'NDCG@5': '0.0636', 'HR@10': '0.1171', 'NDCG@10': '0.0730', 'HR@20': '0.1530', 'NDCG@20': '0.0821'}
2025-03-07 13:36:22,277 - Validation score increased.  Saving model ...
2025-03-07 13:36:42,012 - {'epoch': 18, 'rec_loss': '7.2222'}
2025-03-07 13:36:50,498 - {'Epoch': 18, 'HR@5': '0.0881', 'NDCG@5': '0.0635', 'HR@10': '0.1165', 'NDCG@10': '0.0726', 'HR@20': '0.1516', 'NDCG@20': '0.0815'}
2025-03-07 13:36:50,505 - EarlyStopping counter: 1 out of 10
2025-03-07 13:37:10,295 - {'epoch': 19, 'rec_loss': '7.1994'}
2025-03-07 13:37:18,733 - {'Epoch': 19, 'HR@5': '0.0885', 'NDCG@5': '0.0640', 'HR@10': '0.1175', 'NDCG@10': '0.0733', 'HR@20': '0.1537', 'NDCG@20': '0.0824'}
2025-03-07 13:37:18,739 - Validation score increased.  Saving model ...
2025-03-07 13:37:38,608 - {'epoch': 20, 'rec_loss': '7.1814'}
2025-03-07 13:37:47,740 - {'Epoch': 20, 'HR@5': '0.0892', 'NDCG@5': '0.0644', 'HR@10': '0.1179', 'NDCG@10': '0.0737', 'HR@20': '0.1543', 'NDCG@20': '0.0829'}
2025-03-07 13:37:47,751 - Validation score increased.  Saving model ...
2025-03-07 13:38:12,205 - {'epoch': 21, 'rec_loss': '7.1633'}
2025-03-07 13:38:22,732 - {'Epoch': 21, 'HR@5': '0.0886', 'NDCG@5': '0.0640', 'HR@10': '0.1181', 'NDCG@10': '0.0735', 'HR@20': '0.1559', 'NDCG@20': '0.0830'}
2025-03-07 13:38:22,741 - Validation score increased.  Saving model ...
2025-03-07 13:38:50,881 - {'epoch': 22, 'rec_loss': '7.1532'}
2025-03-07 13:39:01,924 - {'Epoch': 22, 'HR@5': '0.0896', 'NDCG@5': '0.0647', 'HR@10': '0.1196', 'NDCG@10': '0.0743', 'HR@20': '0.1560', 'NDCG@20': '0.0835'}
2025-03-07 13:39:01,933 - Validation score increased.  Saving model ...
2025-03-07 13:39:29,901 - {'epoch': 23, 'rec_loss': '7.1360'}
2025-03-07 13:39:40,349 - {'Epoch': 23, 'HR@5': '0.0892', 'NDCG@5': '0.0647', 'HR@10': '0.1199', 'NDCG@10': '0.0746', 'HR@20': '0.1563', 'NDCG@20': '0.0839'}
2025-03-07 13:39:40,357 - Validation score increased.  Saving model ...
2025-03-07 13:40:04,148 - {'epoch': 24, 'rec_loss': '7.1221'}
2025-03-07 13:40:12,976 - {'Epoch': 24, 'HR@5': '0.0900', 'NDCG@5': '0.0656', 'HR@10': '0.1210', 'NDCG@10': '0.0755', 'HR@20': '0.1568', 'NDCG@20': '0.0845'}
2025-03-07 13:40:12,982 - Validation score increased.  Saving model ...
2025-03-07 13:40:32,345 - {'epoch': 25, 'rec_loss': '7.1138'}
2025-03-07 13:40:40,916 - {'Epoch': 25, 'HR@5': '0.0906', 'NDCG@5': '0.0655', 'HR@10': '0.1216', 'NDCG@10': '0.0755', 'HR@20': '0.1578', 'NDCG@20': '0.0846'}
2025-03-07 13:40:40,923 - Validation score increased.  Saving model ...
2025-03-07 13:41:00,520 - {'epoch': 26, 'rec_loss': '7.1022'}
2025-03-07 13:41:08,840 - {'Epoch': 26, 'HR@5': '0.0910', 'NDCG@5': '0.0664', 'HR@10': '0.1202', 'NDCG@10': '0.0758', 'HR@20': '0.1581', 'NDCG@20': '0.0853'}
2025-03-07 13:41:08,847 - Validation score increased.  Saving model ...
2025-03-07 13:41:28,520 - {'epoch': 27, 'rec_loss': '7.0855'}
2025-03-07 13:41:37,089 - {'Epoch': 27, 'HR@5': '0.0903', 'NDCG@5': '0.0659', 'HR@10': '0.1209', 'NDCG@10': '0.0758', 'HR@20': '0.1571', 'NDCG@20': '0.0849'}
2025-03-07 13:41:37,096 - EarlyStopping counter: 1 out of 10
2025-03-07 13:41:59,105 - {'epoch': 28, 'rec_loss': '7.0767'}
2025-03-07 13:42:08,487 - {'Epoch': 28, 'HR@5': '0.0897', 'NDCG@5': '0.0657', 'HR@10': '0.1213', 'NDCG@10': '0.0759', 'HR@20': '0.1585', 'NDCG@20': '0.0853'}
2025-03-07 13:42:08,496 - Validation score increased.  Saving model ...
2025-03-07 13:42:34,779 - {'epoch': 29, 'rec_loss': '7.0608'}
2025-03-07 13:42:44,691 - {'Epoch': 29, 'HR@5': '0.0904', 'NDCG@5': '0.0661', 'HR@10': '0.1208', 'NDCG@10': '0.0759', 'HR@20': '0.1589', 'NDCG@20': '0.0855'}
2025-03-07 13:42:44,704 - Validation score increased.  Saving model ...
2025-03-07 13:43:12,118 - {'epoch': 30, 'rec_loss': '7.0594'}
2025-03-07 13:43:22,628 - {'Epoch': 30, 'HR@5': '0.0905', 'NDCG@5': '0.0660', 'HR@10': '0.1225', 'NDCG@10': '0.0762', 'HR@20': '0.1597', 'NDCG@20': '0.0857'}
2025-03-07 13:43:22,636 - Validation score increased.  Saving model ...
2025-03-07 13:43:47,727 - {'epoch': 31, 'rec_loss': '7.0501'}
2025-03-07 13:43:56,878 - {'Epoch': 31, 'HR@5': '0.0900', 'NDCG@5': '0.0659', 'HR@10': '0.1219', 'NDCG@10': '0.0761', 'HR@20': '0.1591', 'NDCG@20': '0.0856'}
2025-03-07 13:43:56,885 - EarlyStopping counter: 1 out of 10
2025-03-07 13:44:20,153 - {'epoch': 32, 'rec_loss': '7.0395'}
2025-03-07 13:44:28,069 - {'Epoch': 32, 'HR@5': '0.0914', 'NDCG@5': '0.0665', 'HR@10': '0.1226', 'NDCG@10': '0.0765', 'HR@20': '0.1586', 'NDCG@20': '0.0856'}
2025-03-07 13:44:28,077 - EarlyStopping counter: 2 out of 10
2025-03-07 13:44:47,309 - {'epoch': 33, 'rec_loss': '7.0354'}
2025-03-07 13:44:55,327 - {'Epoch': 33, 'HR@5': '0.0911', 'NDCG@5': '0.0668', 'HR@10': '0.1235', 'NDCG@10': '0.0773', 'HR@20': '0.1590', 'NDCG@20': '0.0862'}
2025-03-07 13:44:55,335 - Validation score increased.  Saving model ...
2025-03-07 13:45:14,409 - {'epoch': 34, 'rec_loss': '7.0227'}
2025-03-07 13:45:22,419 - {'Epoch': 34, 'HR@5': '0.0919', 'NDCG@5': '0.0661', 'HR@10': '0.1229', 'NDCG@10': '0.0761', 'HR@20': '0.1598', 'NDCG@20': '0.0854'}
2025-03-07 13:45:22,426 - EarlyStopping counter: 1 out of 10
2025-03-07 13:45:45,603 - {'epoch': 35, 'rec_loss': '7.0140'}
2025-03-07 13:45:55,090 - {'Epoch': 35, 'HR@5': '0.0916', 'NDCG@5': '0.0661', 'HR@10': '0.1230', 'NDCG@10': '0.0762', 'HR@20': '0.1597', 'NDCG@20': '0.0855'}
2025-03-07 13:45:55,100 - EarlyStopping counter: 2 out of 10
2025-03-07 13:46:19,829 - {'epoch': 36, 'rec_loss': '7.0137'}
2025-03-07 13:46:29,389 - {'Epoch': 36, 'HR@5': '0.0911', 'NDCG@5': '0.0661', 'HR@10': '0.1238', 'NDCG@10': '0.0767', 'HR@20': '0.1595', 'NDCG@20': '0.0857'}
2025-03-07 13:46:29,397 - EarlyStopping counter: 3 out of 10
2025-03-07 13:46:57,606 - {'epoch': 37, 'rec_loss': '7.0087'}
2025-03-07 13:47:08,497 - {'Epoch': 37, 'HR@5': '0.0917', 'NDCG@5': '0.0667', 'HR@10': '0.1229', 'NDCG@10': '0.0767', 'HR@20': '0.1613', 'NDCG@20': '0.0864'}
2025-03-07 13:47:08,512 - Validation score increased.  Saving model ...
2025-03-07 13:47:33,382 - {'epoch': 38, 'rec_loss': '6.9993'}
2025-03-07 13:47:43,630 - {'Epoch': 38, 'HR@5': '0.0921', 'NDCG@5': '0.0665', 'HR@10': '0.1240', 'NDCG@10': '0.0767', 'HR@20': '0.1618', 'NDCG@20': '0.0863'}
2025-03-07 13:47:43,640 - EarlyStopping counter: 1 out of 10
2025-03-07 13:48:07,667 - {'epoch': 39, 'rec_loss': '6.9852'}
2025-03-07 13:48:15,811 - {'Epoch': 39, 'HR@5': '0.0908', 'NDCG@5': '0.0664', 'HR@10': '0.1235', 'NDCG@10': '0.0770', 'HR@20': '0.1626', 'NDCG@20': '0.0869'}
2025-03-07 13:48:15,819 - Validation score increased.  Saving model ...
2025-03-07 13:48:34,605 - {'epoch': 40, 'rec_loss': '6.9822'}
2025-03-07 13:48:41,990 - {'Epoch': 40, 'HR@5': '0.0925', 'NDCG@5': '0.0669', 'HR@10': '0.1241', 'NDCG@10': '0.0771', 'HR@20': '0.1618', 'NDCG@20': '0.0866'}
2025-03-07 13:48:41,999 - EarlyStopping counter: 1 out of 10
2025-03-07 13:49:00,745 - {'epoch': 41, 'rec_loss': '6.9780'}
2025-03-07 13:49:08,505 - {'Epoch': 41, 'HR@5': '0.0934', 'NDCG@5': '0.0674', 'HR@10': '0.1243', 'NDCG@10': '0.0773', 'HR@20': '0.1625', 'NDCG@20': '0.0870'}
2025-03-07 13:49:08,511 - Validation score increased.  Saving model ...
2025-03-07 13:49:26,742 - {'epoch': 42, 'rec_loss': '6.9693'}
2025-03-07 13:49:34,965 - {'Epoch': 42, 'HR@5': '0.0935', 'NDCG@5': '0.0676', 'HR@10': '0.1242', 'NDCG@10': '0.0774', 'HR@20': '0.1635', 'NDCG@20': '0.0873'}
2025-03-07 13:49:34,973 - Validation score increased.  Saving model ...
2025-03-07 13:49:56,211 - {'epoch': 43, 'rec_loss': '6.9664'}
2025-03-07 13:50:05,142 - {'Epoch': 43, 'HR@5': '0.0931', 'NDCG@5': '0.0678', 'HR@10': '0.1244', 'NDCG@10': '0.0778', 'HR@20': '0.1634', 'NDCG@20': '0.0877'}
2025-03-07 13:50:05,150 - Validation score increased.  Saving model ...
2025-03-07 13:50:28,525 - {'epoch': 44, 'rec_loss': '6.9620'}
2025-03-07 13:50:37,855 - {'Epoch': 44, 'HR@5': '0.0934', 'NDCG@5': '0.0675', 'HR@10': '0.1246', 'NDCG@10': '0.0776', 'HR@20': '0.1625', 'NDCG@20': '0.0871'}
2025-03-07 13:50:37,864 - EarlyStopping counter: 1 out of 10
2025-03-07 13:51:03,536 - {'epoch': 45, 'rec_loss': '6.9536'}
2025-03-07 13:51:12,813 - {'Epoch': 45, 'HR@5': '0.0937', 'NDCG@5': '0.0672', 'HR@10': '0.1251', 'NDCG@10': '0.0773', 'HR@20': '0.1630', 'NDCG@20': '0.0869'}
2025-03-07 13:51:12,821 - EarlyStopping counter: 2 out of 10
2025-03-07 13:51:35,839 - {'epoch': 46, 'rec_loss': '6.9570'}
2025-03-07 13:51:44,375 - {'Epoch': 46, 'HR@5': '0.0916', 'NDCG@5': '0.0667', 'HR@10': '0.1234', 'NDCG@10': '0.0770', 'HR@20': '0.1634', 'NDCG@20': '0.0871'}
2025-03-07 13:51:44,383 - EarlyStopping counter: 3 out of 10
2025-03-07 13:52:04,929 - {'epoch': 47, 'rec_loss': '6.9423'}
2025-03-07 13:52:12,572 - {'Epoch': 47, 'HR@5': '0.0936', 'NDCG@5': '0.0681', 'HR@10': '0.1243', 'NDCG@10': '0.0779', 'HR@20': '0.1639', 'NDCG@20': '0.0879'}
2025-03-07 13:52:12,579 - Validation score increased.  Saving model ...
2025-03-07 13:52:31,256 - {'epoch': 48, 'rec_loss': '6.9471'}
2025-03-07 13:52:39,255 - {'Epoch': 48, 'HR@5': '0.0926', 'NDCG@5': '0.0674', 'HR@10': '0.1259', 'NDCG@10': '0.0781', 'HR@20': '0.1641', 'NDCG@20': '0.0877'}
2025-03-07 13:52:39,266 - EarlyStopping counter: 1 out of 10
2025-03-07 13:52:58,994 - {'epoch': 49, 'rec_loss': '6.9390'}
2025-03-07 13:53:07,247 - {'Epoch': 49, 'HR@5': '0.0924', 'NDCG@5': '0.0670', 'HR@10': '0.1245', 'NDCG@10': '0.0773', 'HR@20': '0.1633', 'NDCG@20': '0.0871'}
2025-03-07 13:53:07,252 - EarlyStopping counter: 2 out of 10
2025-03-07 13:53:28,827 - {'epoch': 50, 'rec_loss': '6.9387'}
2025-03-07 13:53:38,819 - {'Epoch': 50, 'HR@5': '0.0927', 'NDCG@5': '0.0667', 'HR@10': '0.1252', 'NDCG@10': '0.0771', 'HR@20': '0.1628', 'NDCG@20': '0.0866'}
2025-03-07 13:53:38,827 - EarlyStopping counter: 3 out of 10
2025-03-07 13:54:01,149 - {'epoch': 51, 'rec_loss': '6.9281'}
2025-03-07 13:54:11,152 - {'Epoch': 51, 'HR@5': '0.0929', 'NDCG@5': '0.0674', 'HR@10': '0.1240', 'NDCG@10': '0.0775', 'HR@20': '0.1650', 'NDCG@20': '0.0878'}
2025-03-07 13:54:11,164 - EarlyStopping counter: 4 out of 10
2025-03-07 13:54:35,797 - {'epoch': 52, 'rec_loss': '6.9211'}
2025-03-07 13:54:44,282 - {'Epoch': 52, 'HR@5': '0.0920', 'NDCG@5': '0.0668', 'HR@10': '0.1255', 'NDCG@10': '0.0776', 'HR@20': '0.1631', 'NDCG@20': '0.0871'}
2025-03-07 13:54:44,293 - EarlyStopping counter: 5 out of 10
2025-03-07 13:55:04,215 - {'epoch': 53, 'rec_loss': '6.9196'}
2025-03-07 13:55:13,066 - {'Epoch': 53, 'HR@5': '0.0932', 'NDCG@5': '0.0672', 'HR@10': '0.1242', 'NDCG@10': '0.0772', 'HR@20': '0.1636', 'NDCG@20': '0.0871'}
2025-03-07 13:55:13,072 - EarlyStopping counter: 6 out of 10
2025-03-07 13:55:33,041 - {'epoch': 54, 'rec_loss': '6.9152'}
2025-03-07 13:55:41,542 - {'Epoch': 54, 'HR@5': '0.0944', 'NDCG@5': '0.0680', 'HR@10': '0.1256', 'NDCG@10': '0.0780', 'HR@20': '0.1634', 'NDCG@20': '0.0875'}
2025-03-07 13:55:41,550 - EarlyStopping counter: 7 out of 10
2025-03-07 13:56:00,388 - {'epoch': 55, 'rec_loss': '6.9066'}
2025-03-07 13:56:08,774 - {'Epoch': 55, 'HR@5': '0.0954', 'NDCG@5': '0.0690', 'HR@10': '0.1250', 'NDCG@10': '0.0785', 'HR@20': '0.1632', 'NDCG@20': '0.0881'}
2025-03-07 13:56:08,779 - Validation score increased.  Saving model ...
2025-03-07 13:56:26,454 - {'epoch': 56, 'rec_loss': '6.9098'}
2025-03-07 13:56:34,142 - {'Epoch': 56, 'HR@5': '0.0943', 'NDCG@5': '0.0685', 'HR@10': '0.1265', 'NDCG@10': '0.0789', 'HR@20': '0.1645', 'NDCG@20': '0.0885'}
2025-03-07 13:56:34,147 - Validation score increased.  Saving model ...
2025-03-07 13:56:55,190 - {'epoch': 57, 'rec_loss': '6.9074'}
2025-03-07 13:57:04,603 - {'Epoch': 57, 'HR@5': '0.0927', 'NDCG@5': '0.0673', 'HR@10': '0.1253', 'NDCG@10': '0.0779', 'HR@20': '0.1634', 'NDCG@20': '0.0875'}
2025-03-07 13:57:04,609 - EarlyStopping counter: 1 out of 10
2025-03-07 13:57:26,967 - {'epoch': 58, 'rec_loss': '6.8957'}
2025-03-07 13:57:35,747 - {'Epoch': 58, 'HR@5': '0.0939', 'NDCG@5': '0.0680', 'HR@10': '0.1259', 'NDCG@10': '0.0784', 'HR@20': '0.1649', 'NDCG@20': '0.0882'}
2025-03-07 13:57:35,754 - EarlyStopping counter: 2 out of 10
2025-03-07 13:58:00,390 - {'epoch': 59, 'rec_loss': '6.8980'}
2025-03-07 13:58:10,623 - {'Epoch': 59, 'HR@5': '0.0944', 'NDCG@5': '0.0684', 'HR@10': '0.1269', 'NDCG@10': '0.0789', 'HR@20': '0.1644', 'NDCG@20': '0.0883'}
2025-03-07 13:58:10,631 - EarlyStopping counter: 3 out of 10
2025-03-07 13:58:37,603 - {'epoch': 60, 'rec_loss': '6.8972'}
2025-03-07 13:58:46,334 - {'Epoch': 60, 'HR@5': '0.0959', 'NDCG@5': '0.0693', 'HR@10': '0.1258', 'NDCG@10': '0.0789', 'HR@20': '0.1639', 'NDCG@20': '0.0885'}
2025-03-07 13:58:46,340 - Validation score increased.  Saving model ...
2025-03-07 13:59:05,755 - {'epoch': 61, 'rec_loss': '6.8928'}
2025-03-07 13:59:14,153 - {'Epoch': 61, 'HR@5': '0.0938', 'NDCG@5': '0.0683', 'HR@10': '0.1262', 'NDCG@10': '0.0787', 'HR@20': '0.1654', 'NDCG@20': '0.0886'}
2025-03-07 13:59:14,160 - Validation score increased.  Saving model ...
2025-03-07 13:59:32,793 - {'epoch': 62, 'rec_loss': '6.8831'}
2025-03-07 13:59:40,686 - {'Epoch': 62, 'HR@5': '0.0926', 'NDCG@5': '0.0666', 'HR@10': '0.1247', 'NDCG@10': '0.0769', 'HR@20': '0.1613', 'NDCG@20': '0.0862'}
2025-03-07 13:59:40,693 - EarlyStopping counter: 1 out of 10
2025-03-07 13:59:58,465 - {'epoch': 63, 'rec_loss': '6.8798'}
2025-03-07 14:00:06,270 - {'Epoch': 63, 'HR@5': '0.0943', 'NDCG@5': '0.0681', 'HR@10': '0.1239', 'NDCG@10': '0.0776', 'HR@20': '0.1628', 'NDCG@20': '0.0875'}
2025-03-07 14:00:06,277 - EarlyStopping counter: 2 out of 10
2025-03-07 14:00:27,984 - {'epoch': 64, 'rec_loss': '6.8742'}
2025-03-07 14:00:37,261 - {'Epoch': 64, 'HR@5': '0.0943', 'NDCG@5': '0.0683', 'HR@10': '0.1250', 'NDCG@10': '0.0782', 'HR@20': '0.1636', 'NDCG@20': '0.0879'}
2025-03-07 14:00:37,268 - EarlyStopping counter: 3 out of 10
2025-03-07 14:00:58,991 - {'epoch': 65, 'rec_loss': '6.8780'}
2025-03-07 14:01:08,617 - {'Epoch': 65, 'HR@5': '0.0944', 'NDCG@5': '0.0685', 'HR@10': '0.1255', 'NDCG@10': '0.0785', 'HR@20': '0.1634', 'NDCG@20': '0.0881'}
2025-03-07 14:01:08,628 - EarlyStopping counter: 4 out of 10
2025-03-07 14:01:33,786 - {'epoch': 66, 'rec_loss': '6.8683'}
2025-03-07 14:01:43,850 - {'Epoch': 66, 'HR@5': '0.0951', 'NDCG@5': '0.0687', 'HR@10': '0.1250', 'NDCG@10': '0.0782', 'HR@20': '0.1636', 'NDCG@20': '0.0880'}
2025-03-07 14:01:43,861 - EarlyStopping counter: 5 out of 10
2025-03-07 14:02:08,357 - {'epoch': 67, 'rec_loss': '6.8719'}
2025-03-07 14:02:16,702 - {'Epoch': 67, 'HR@5': '0.0938', 'NDCG@5': '0.0685', 'HR@10': '0.1247', 'NDCG@10': '0.0784', 'HR@20': '0.1632', 'NDCG@20': '0.0882'}
2025-03-07 14:02:16,709 - EarlyStopping counter: 6 out of 10
2025-03-07 14:02:36,446 - {'epoch': 68, 'rec_loss': '6.8679'}
2025-03-07 14:02:44,658 - {'Epoch': 68, 'HR@5': '0.0945', 'NDCG@5': '0.0685', 'HR@10': '0.1245', 'NDCG@10': '0.0782', 'HR@20': '0.1631', 'NDCG@20': '0.0880'}
2025-03-07 14:02:44,667 - EarlyStopping counter: 7 out of 10
2025-03-07 14:03:02,851 - {'epoch': 69, 'rec_loss': '6.8645'}
2025-03-07 14:03:10,606 - {'Epoch': 69, 'HR@5': '0.0941', 'NDCG@5': '0.0688', 'HR@10': '0.1251', 'NDCG@10': '0.0788', 'HR@20': '0.1648', 'NDCG@20': '0.0888'}
2025-03-07 14:03:10,612 - Validation score increased.  Saving model ...
2025-03-07 14:03:28,350 - {'epoch': 70, 'rec_loss': '6.8661'}
2025-03-07 14:03:37,071 - {'Epoch': 70, 'HR@5': '0.0940', 'NDCG@5': '0.0683', 'HR@10': '0.1247', 'NDCG@10': '0.0782', 'HR@20': '0.1660', 'NDCG@20': '0.0886'}
2025-03-07 14:03:37,079 - EarlyStopping counter: 1 out of 10
2025-03-07 14:03:56,755 - {'epoch': 71, 'rec_loss': '6.8535'}
2025-03-07 14:04:05,953 - {'Epoch': 71, 'HR@5': '0.0943', 'NDCG@5': '0.0687', 'HR@10': '0.1264', 'NDCG@10': '0.0790', 'HR@20': '0.1642', 'NDCG@20': '0.0886'}
2025-03-07 14:04:05,960 - EarlyStopping counter: 2 out of 10
2025-03-07 14:04:28,815 - {'epoch': 72, 'rec_loss': '6.8555'}
2025-03-07 14:04:38,385 - {'Epoch': 72, 'HR@5': '0.0938', 'NDCG@5': '0.0683', 'HR@10': '0.1265', 'NDCG@10': '0.0788', 'HR@20': '0.1644', 'NDCG@20': '0.0884'}
2025-03-07 14:04:38,394 - EarlyStopping counter: 3 out of 10
2025-03-07 14:05:01,790 - {'epoch': 73, 'rec_loss': '6.8543'}
2025-03-07 14:05:12,431 - {'Epoch': 73, 'HR@5': '0.0949', 'NDCG@5': '0.0689', 'HR@10': '0.1251', 'NDCG@10': '0.0786', 'HR@20': '0.1649', 'NDCG@20': '0.0886'}
2025-03-07 14:05:12,440 - EarlyStopping counter: 4 out of 10
2025-03-07 14:05:38,644 - {'epoch': 74, 'rec_loss': '6.8594'}
2025-03-07 14:05:47,832 - {'Epoch': 74, 'HR@5': '0.0943', 'NDCG@5': '0.0688', 'HR@10': '0.1262', 'NDCG@10': '0.0791', 'HR@20': '0.1650', 'NDCG@20': '0.0889'}
2025-03-07 14:05:47,838 - Validation score increased.  Saving model ...
2025-03-07 14:06:06,920 - {'epoch': 75, 'rec_loss': '6.8412'}
2025-03-07 14:06:15,262 - {'Epoch': 75, 'HR@5': '0.0953', 'NDCG@5': '0.0690', 'HR@10': '0.1264', 'NDCG@10': '0.0790', 'HR@20': '0.1657', 'NDCG@20': '0.0889'}
2025-03-07 14:06:15,268 - Validation score increased.  Saving model ...
2025-03-07 14:06:34,128 - {'epoch': 76, 'rec_loss': '6.8472'}
2025-03-07 14:06:41,715 - {'Epoch': 76, 'HR@5': '0.0957', 'NDCG@5': '0.0693', 'HR@10': '0.1257', 'NDCG@10': '0.0790', 'HR@20': '0.1652', 'NDCG@20': '0.0890'}
2025-03-07 14:06:41,721 - Validation score increased.  Saving model ...
2025-03-07 14:06:59,247 - {'epoch': 77, 'rec_loss': '6.8439'}
2025-03-07 14:07:07,315 - {'Epoch': 77, 'HR@5': '0.0947', 'NDCG@5': '0.0690', 'HR@10': '0.1258', 'NDCG@10': '0.0790', 'HR@20': '0.1644', 'NDCG@20': '0.0887'}
2025-03-07 14:07:07,321 - EarlyStopping counter: 1 out of 10
2025-03-07 14:07:26,864 - {'epoch': 78, 'rec_loss': '6.8451'}
2025-03-07 14:07:35,669 - {'Epoch': 78, 'HR@5': '0.0955', 'NDCG@5': '0.0689', 'HR@10': '0.1268', 'NDCG@10': '0.0790', 'HR@20': '0.1643', 'NDCG@20': '0.0884'}
2025-03-07 14:07:35,676 - EarlyStopping counter: 2 out of 10
2025-03-07 14:07:58,002 - {'epoch': 79, 'rec_loss': '6.8361'}
2025-03-07 14:08:07,249 - {'Epoch': 79, 'HR@5': '0.0960', 'NDCG@5': '0.0695', 'HR@10': '0.1277', 'NDCG@10': '0.0797', 'HR@20': '0.1653', 'NDCG@20': '0.0891'}
2025-03-07 14:08:07,258 - Validation score increased.  Saving model ...
2025-03-07 14:08:31,253 - {'epoch': 80, 'rec_loss': '6.8396'}
2025-03-07 14:08:40,972 - {'Epoch': 80, 'HR@5': '0.0948', 'NDCG@5': '0.0688', 'HR@10': '0.1263', 'NDCG@10': '0.0790', 'HR@20': '0.1641', 'NDCG@20': '0.0886'}
2025-03-07 14:08:40,981 - EarlyStopping counter: 1 out of 10
2025-03-07 14:09:06,247 - {'epoch': 81, 'rec_loss': '6.8393'}
2025-03-07 14:09:15,690 - {'Epoch': 81, 'HR@5': '0.0953', 'NDCG@5': '0.0689', 'HR@10': '0.1267', 'NDCG@10': '0.0790', 'HR@20': '0.1649', 'NDCG@20': '0.0887'}
2025-03-07 14:09:15,700 - EarlyStopping counter: 2 out of 10
2025-03-07 14:09:39,101 - {'epoch': 82, 'rec_loss': '6.8351'}
2025-03-07 14:09:47,275 - {'Epoch': 82, 'HR@5': '0.0953', 'NDCG@5': '0.0692', 'HR@10': '0.1271', 'NDCG@10': '0.0795', 'HR@20': '0.1645', 'NDCG@20': '0.0889'}
2025-03-07 14:09:47,282 - EarlyStopping counter: 3 out of 10
2025-03-07 14:10:06,638 - {'epoch': 83, 'rec_loss': '6.8273'}
2025-03-07 14:10:14,261 - {'Epoch': 83, 'HR@5': '0.0953', 'NDCG@5': '0.0689', 'HR@10': '0.1277', 'NDCG@10': '0.0793', 'HR@20': '0.1660', 'NDCG@20': '0.0890'}
2025-03-07 14:10:14,269 - EarlyStopping counter: 4 out of 10
2025-03-07 14:10:31,833 - {'epoch': 84, 'rec_loss': '6.8314'}
2025-03-07 14:10:39,893 - {'Epoch': 84, 'HR@5': '0.0956', 'NDCG@5': '0.0693', 'HR@10': '0.1284', 'NDCG@10': '0.0799', 'HR@20': '0.1672', 'NDCG@20': '0.0896'}
2025-03-07 14:10:39,903 - Validation score increased.  Saving model ...
2025-03-07 14:11:01,668 - {'epoch': 85, 'rec_loss': '6.8289'}
2025-03-07 14:11:10,683 - {'Epoch': 85, 'HR@5': '0.0955', 'NDCG@5': '0.0687', 'HR@10': '0.1268', 'NDCG@10': '0.0787', 'HR@20': '0.1647', 'NDCG@20': '0.0883'}
2025-03-07 14:11:10,692 - EarlyStopping counter: 1 out of 10
2025-03-07 14:11:34,728 - {'epoch': 86, 'rec_loss': '6.8279'}
2025-03-07 14:11:44,912 - {'Epoch': 86, 'HR@5': '0.0947', 'NDCG@5': '0.0689', 'HR@10': '0.1289', 'NDCG@10': '0.0799', 'HR@20': '0.1658', 'NDCG@20': '0.0892'}
2025-03-07 14:11:44,921 - EarlyStopping counter: 2 out of 10
2025-03-07 14:12:14,612 - {'epoch': 87, 'rec_loss': '6.8253'}
2025-03-07 14:12:24,951 - {'Epoch': 87, 'HR@5': '0.0955', 'NDCG@5': '0.0687', 'HR@10': '0.1269', 'NDCG@10': '0.0788', 'HR@20': '0.1662', 'NDCG@20': '0.0887'}
2025-03-07 14:12:24,958 - EarlyStopping counter: 3 out of 10
2025-03-07 14:12:53,756 - {'epoch': 88, 'rec_loss': '6.8225'}
2025-03-07 14:13:04,093 - {'Epoch': 88, 'HR@5': '0.0953', 'NDCG@5': '0.0688', 'HR@10': '0.1285', 'NDCG@10': '0.0795', 'HR@20': '0.1658', 'NDCG@20': '0.0889'}
2025-03-07 14:13:04,099 - EarlyStopping counter: 4 out of 10
2025-03-07 14:13:27,214 - {'epoch': 89, 'rec_loss': '6.8149'}
2025-03-07 14:13:36,883 - {'Epoch': 89, 'HR@5': '0.0947', 'NDCG@5': '0.0691', 'HR@10': '0.1266', 'NDCG@10': '0.0793', 'HR@20': '0.1648', 'NDCG@20': '0.0890'}
2025-03-07 14:13:36,890 - EarlyStopping counter: 5 out of 10
2025-03-07 14:13:56,538 - {'epoch': 90, 'rec_loss': '6.8179'}
2025-03-07 14:14:04,472 - {'Epoch': 90, 'HR@5': '0.0948', 'NDCG@5': '0.0690', 'HR@10': '0.1277', 'NDCG@10': '0.0796', 'HR@20': '0.1643', 'NDCG@20': '0.0888'}
2025-03-07 14:14:04,479 - EarlyStopping counter: 6 out of 10
2025-03-07 14:14:23,776 - {'epoch': 91, 'rec_loss': '6.8093'}
2025-03-07 14:14:32,324 - {'Epoch': 91, 'HR@5': '0.0947', 'NDCG@5': '0.0692', 'HR@10': '0.1281', 'NDCG@10': '0.0799', 'HR@20': '0.1667', 'NDCG@20': '0.0896'}
2025-03-07 14:14:32,333 - EarlyStopping counter: 7 out of 10
2025-03-07 14:14:54,890 - {'epoch': 92, 'rec_loss': '6.8117'}
2025-03-07 14:15:04,428 - {'Epoch': 92, 'HR@5': '0.0953', 'NDCG@5': '0.0696', 'HR@10': '0.1268', 'NDCG@10': '0.0797', 'HR@20': '0.1646', 'NDCG@20': '0.0892'}
2025-03-07 14:15:04,437 - EarlyStopping counter: 8 out of 10
2025-03-07 14:15:28,098 - {'epoch': 93, 'rec_loss': '6.8122'}
2025-03-07 14:15:38,547 - {'Epoch': 93, 'HR@5': '0.0963', 'NDCG@5': '0.0698', 'HR@10': '0.1267', 'NDCG@10': '0.0796', 'HR@20': '0.1658', 'NDCG@20': '0.0895'}
2025-03-07 14:15:38,557 - EarlyStopping counter: 9 out of 10
2025-03-07 14:16:08,448 - {'epoch': 94, 'rec_loss': '6.8086'}
2025-03-07 14:16:19,800 - {'Epoch': 94, 'HR@5': '0.0957', 'NDCG@5': '0.0697', 'HR@10': '0.1273', 'NDCG@10': '0.0799', 'HR@20': '0.1651', 'NDCG@20': '0.0894'}
2025-03-07 14:16:19,810 - EarlyStopping counter: 10 out of 10
2025-03-07 14:16:19,811 - Early stopping
2025-03-07 14:16:19,811 - ---------------Test Score---------------
2025-03-07 14:16:29,842 - {'Epoch': 0, 'HR@5': '0.0772', 'NDCG@5': '0.0568', 'HR@10': '0.1056', 'NDCG@10': '0.0660', 'HR@20': '0.1385', 'NDCG@20': '0.0743'}
2025-03-07 14:16:29,850 - Scale_Toys
2025-03-07 14:16:29,854 - {'Epoch': 0, 'HR@5': '0.0772', 'NDCG@5': '0.0568', 'HR@10': '0.1056', 'NDCG@10': '0.0660', 'HR@20': '0.1385', 'NDCG@20': '0.0743'}
