2025-02-19 16:36:46,497 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-19 16:36:49,319 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-19 16:36:49,332 - Total Parameters: 929445
2025-02-19 16:37:28,601 - {'epoch': 0, 'rec_loss': '8.8325'}
2025-02-19 16:37:38,324 - {'Epoch': 0, 'HR@5': '0.0190', 'NDCG@5': '0.0120', 'HR@10': '0.0305', 'NDCG@10': '0.0157', 'HR@20': '0.0467', 'NDCG@20': '0.0198'}
2025-02-19 16:37:38,329 - Validation score increased.  Saving model ...
2025-02-19 16:38:12,927 - {'epoch': 1, 'rec_loss': '8.3257'}
2025-02-19 16:38:22,599 - {'Epoch': 1, 'HR@5': '0.0375', 'NDCG@5': '0.0252', 'HR@10': '0.0559', 'NDCG@10': '0.0311', 'HR@20': '0.0819', 'NDCG@20': '0.0377'}
2025-02-19 16:38:22,601 - Validation score increased.  Saving model ...
2025-02-19 16:38:52,607 - {'epoch': 2, 'rec_loss': '8.0142'}
2025-02-19 16:39:01,509 - {'Epoch': 2, 'HR@5': '0.0489', 'NDCG@5': '0.0336', 'HR@10': '0.0720', 'NDCG@10': '0.0410', 'HR@20': '0.1033', 'NDCG@20': '0.0489'}
2025-02-19 16:39:01,511 - Validation score increased.  Saving model ...
2025-02-19 16:39:33,417 - {'epoch': 3, 'rec_loss': '7.7982'}
2025-02-19 16:39:42,897 - {'Epoch': 3, 'HR@5': '0.0586', 'NDCG@5': '0.0401', 'HR@10': '0.0860', 'NDCG@10': '0.0489', 'HR@20': '0.1238', 'NDCG@20': '0.0584'}
2025-02-19 16:39:42,897 - Validation score increased.  Saving model ...
2025-02-19 16:40:15,434 - {'epoch': 4, 'rec_loss': '7.6349'}
2025-02-19 16:40:24,412 - {'Epoch': 4, 'HR@5': '0.0675', 'NDCG@5': '0.0468', 'HR@10': '0.0959', 'NDCG@10': '0.0559', 'HR@20': '0.1322', 'NDCG@20': '0.0651'}
2025-02-19 16:40:24,414 - Validation score increased.  Saving model ...
2025-02-19 16:40:55,516 - {'epoch': 5, 'rec_loss': '7.5195'}
2025-02-19 16:41:04,350 - {'Epoch': 5, 'HR@5': '0.0727', 'NDCG@5': '0.0510', 'HR@10': '0.1028', 'NDCG@10': '0.0607', 'HR@20': '0.1394', 'NDCG@20': '0.0699'}
2025-02-19 16:41:04,352 - Validation score increased.  Saving model ...
2025-02-19 16:41:31,646 - {'epoch': 6, 'rec_loss': '7.4215'}
2025-02-19 16:41:41,298 - {'Epoch': 6, 'HR@5': '0.0755', 'NDCG@5': '0.0531', 'HR@10': '0.1051', 'NDCG@10': '0.0627', 'HR@20': '0.1456', 'NDCG@20': '0.0729'}
2025-02-19 16:41:41,299 - Validation score increased.  Saving model ...
2025-02-19 16:42:13,832 - {'epoch': 7, 'rec_loss': '7.3411'}
2025-02-19 16:42:22,880 - {'Epoch': 7, 'HR@5': '0.0801', 'NDCG@5': '0.0562', 'HR@10': '0.1090', 'NDCG@10': '0.0654', 'HR@20': '0.1490', 'NDCG@20': '0.0755'}
2025-02-19 16:42:22,882 - Validation score increased.  Saving model ...
2025-02-19 16:42:52,394 - {'epoch': 8, 'rec_loss': '7.2714'}
2025-02-19 16:43:01,442 - {'Epoch': 8, 'HR@5': '0.0824', 'NDCG@5': '0.0582', 'HR@10': '0.1112', 'NDCG@10': '0.0674', 'HR@20': '0.1501', 'NDCG@20': '0.0772'}
2025-02-19 16:43:01,443 - Validation score increased.  Saving model ...
2025-02-19 16:43:33,665 - {'epoch': 9, 'rec_loss': '7.2231'}
2025-02-19 16:43:42,890 - {'Epoch': 9, 'HR@5': '0.0815', 'NDCG@5': '0.0570', 'HR@10': '0.1133', 'NDCG@10': '0.0672', 'HR@20': '0.1526', 'NDCG@20': '0.0771'}
2025-02-19 16:43:42,891 - EarlyStopping counter: 1 out of 10
2025-02-19 16:44:13,473 - {'epoch': 10, 'rec_loss': '7.1750'}
2025-02-19 16:44:22,663 - {'Epoch': 10, 'HR@5': '0.0833', 'NDCG@5': '0.0587', 'HR@10': '0.1134', 'NDCG@10': '0.0684', 'HR@20': '0.1524', 'NDCG@20': '0.0782'}
2025-02-19 16:44:22,663 - Validation score increased.  Saving model ...
2025-02-19 16:44:53,901 - {'epoch': 11, 'rec_loss': '7.1370'}
2025-02-19 16:45:02,761 - {'Epoch': 11, 'HR@5': '0.0846', 'NDCG@5': '0.0599', 'HR@10': '0.1141', 'NDCG@10': '0.0694', 'HR@20': '0.1538', 'NDCG@20': '0.0794'}
2025-02-19 16:45:02,763 - Validation score increased.  Saving model ...
2025-02-19 16:45:33,183 - {'epoch': 12, 'rec_loss': '7.1003'}
2025-02-19 16:45:42,218 - {'Epoch': 12, 'HR@5': '0.0838', 'NDCG@5': '0.0596', 'HR@10': '0.1166', 'NDCG@10': '0.0701', 'HR@20': '0.1564', 'NDCG@20': '0.0801'}
2025-02-19 16:45:42,219 - Validation score increased.  Saving model ...
2025-02-19 16:46:12,343 - {'epoch': 13, 'rec_loss': '7.0745'}
2025-02-19 16:46:21,574 - {'Epoch': 13, 'HR@5': '0.0852', 'NDCG@5': '0.0597', 'HR@10': '0.1179', 'NDCG@10': '0.0702', 'HR@20': '0.1579', 'NDCG@20': '0.0803'}
2025-02-19 16:46:21,574 - Validation score increased.  Saving model ...
2025-02-19 16:46:55,328 - {'epoch': 14, 'rec_loss': '7.0441'}
2025-02-19 16:47:04,496 - {'Epoch': 14, 'HR@5': '0.0868', 'NDCG@5': '0.0608', 'HR@10': '0.1183', 'NDCG@10': '0.0709', 'HR@20': '0.1596', 'NDCG@20': '0.0813'}
2025-02-19 16:47:04,497 - Validation score increased.  Saving model ...
2025-02-19 16:47:40,030 - {'epoch': 15, 'rec_loss': '7.0244'}
2025-02-19 16:47:49,015 - {'Epoch': 15, 'HR@5': '0.0863', 'NDCG@5': '0.0605', 'HR@10': '0.1183', 'NDCG@10': '0.0708', 'HR@20': '0.1607', 'NDCG@20': '0.0815'}
2025-02-19 16:47:49,017 - Validation score increased.  Saving model ...
2025-02-19 16:48:21,905 - {'epoch': 16, 'rec_loss': '7.0022'}
2025-02-19 16:48:31,076 - {'Epoch': 16, 'HR@5': '0.0861', 'NDCG@5': '0.0604', 'HR@10': '0.1183', 'NDCG@10': '0.0708', 'HR@20': '0.1613', 'NDCG@20': '0.0816'}
2025-02-19 16:48:31,076 - Validation score increased.  Saving model ...
2025-02-19 16:49:02,696 - {'epoch': 17, 'rec_loss': '6.9863'}
2025-02-19 16:49:11,688 - {'Epoch': 17, 'HR@5': '0.0851', 'NDCG@5': '0.0607', 'HR@10': '0.1183', 'NDCG@10': '0.0714', 'HR@20': '0.1604', 'NDCG@20': '0.0820'}
2025-02-19 16:49:11,690 - Validation score increased.  Saving model ...
2025-02-19 16:49:42,293 - {'epoch': 18, 'rec_loss': '6.9548'}
2025-02-19 16:49:51,102 - {'Epoch': 18, 'HR@5': '0.0870', 'NDCG@5': '0.0610', 'HR@10': '0.1185', 'NDCG@10': '0.0712', 'HR@20': '0.1616', 'NDCG@20': '0.0820'}
2025-02-19 16:49:51,103 - EarlyStopping counter: 1 out of 10
2025-02-19 16:50:22,427 - {'epoch': 19, 'rec_loss': '6.9440'}
2025-02-19 16:50:31,597 - {'Epoch': 19, 'HR@5': '0.0872', 'NDCG@5': '0.0618', 'HR@10': '0.1182', 'NDCG@10': '0.0718', 'HR@20': '0.1623', 'NDCG@20': '0.0829'}
2025-02-19 16:50:31,598 - Validation score increased.  Saving model ...
2025-02-19 16:51:03,128 - {'epoch': 20, 'rec_loss': '6.9231'}
2025-02-19 16:51:12,477 - {'Epoch': 20, 'HR@5': '0.0870', 'NDCG@5': '0.0615', 'HR@10': '0.1202', 'NDCG@10': '0.0723', 'HR@20': '0.1635', 'NDCG@20': '0.0832'}
2025-02-19 16:51:12,478 - Validation score increased.  Saving model ...
2025-02-19 16:51:45,553 - {'epoch': 21, 'rec_loss': '6.9149'}
2025-02-19 16:51:54,584 - {'Epoch': 21, 'HR@5': '0.0874', 'NDCG@5': '0.0615', 'HR@10': '0.1208', 'NDCG@10': '0.0723', 'HR@20': '0.1626', 'NDCG@20': '0.0827'}
2025-02-19 16:51:54,586 - EarlyStopping counter: 1 out of 10
2025-02-19 16:52:22,770 - {'epoch': 22, 'rec_loss': '6.9037'}
2025-02-19 16:52:31,793 - {'Epoch': 22, 'HR@5': '0.0878', 'NDCG@5': '0.0622', 'HR@10': '0.1214', 'NDCG@10': '0.0730', 'HR@20': '0.1635', 'NDCG@20': '0.0836'}
2025-02-19 16:52:31,795 - Validation score increased.  Saving model ...
2025-02-19 16:53:04,497 - {'epoch': 23, 'rec_loss': '6.8873'}
2025-02-19 16:53:14,360 - {'Epoch': 23, 'HR@5': '0.0875', 'NDCG@5': '0.0624', 'HR@10': '0.1209', 'NDCG@10': '0.0731', 'HR@20': '0.1635', 'NDCG@20': '0.0838'}
2025-02-19 16:53:14,361 - Validation score increased.  Saving model ...
2025-02-19 16:53:48,078 - {'epoch': 24, 'rec_loss': '6.8800'}
2025-02-19 16:53:57,158 - {'Epoch': 24, 'HR@5': '0.0872', 'NDCG@5': '0.0617', 'HR@10': '0.1202', 'NDCG@10': '0.0724', 'HR@20': '0.1624', 'NDCG@20': '0.0830'}
2025-02-19 16:53:57,159 - EarlyStopping counter: 1 out of 10
2025-02-19 16:54:27,515 - {'epoch': 25, 'rec_loss': '6.8605'}
2025-02-19 16:54:36,568 - {'Epoch': 25, 'HR@5': '0.0872', 'NDCG@5': '0.0614', 'HR@10': '0.1208', 'NDCG@10': '0.0723', 'HR@20': '0.1632', 'NDCG@20': '0.0829'}
2025-02-19 16:54:36,570 - EarlyStopping counter: 2 out of 10
2025-02-19 16:55:04,579 - {'epoch': 26, 'rec_loss': '6.8557'}
2025-02-19 16:55:13,820 - {'Epoch': 26, 'HR@5': '0.0888', 'NDCG@5': '0.0626', 'HR@10': '0.1220', 'NDCG@10': '0.0733', 'HR@20': '0.1638', 'NDCG@20': '0.0838'}
2025-02-19 16:55:13,822 - EarlyStopping counter: 3 out of 10
2025-02-19 16:55:45,105 - {'epoch': 27, 'rec_loss': '6.8397'}
2025-02-19 16:55:54,291 - {'Epoch': 27, 'HR@5': '0.0879', 'NDCG@5': '0.0624', 'HR@10': '0.1200', 'NDCG@10': '0.0727', 'HR@20': '0.1628', 'NDCG@20': '0.0834'}
2025-02-19 16:55:54,292 - EarlyStopping counter: 4 out of 10
2025-02-19 16:56:29,727 - {'epoch': 28, 'rec_loss': '6.8360'}
2025-02-19 16:56:38,613 - {'Epoch': 28, 'HR@5': '0.0883', 'NDCG@5': '0.0621', 'HR@10': '0.1216', 'NDCG@10': '0.0728', 'HR@20': '0.1619', 'NDCG@20': '0.0830'}
2025-02-19 16:56:38,615 - EarlyStopping counter: 5 out of 10
2025-02-19 16:57:08,706 - {'epoch': 29, 'rec_loss': '6.8273'}
2025-02-19 16:57:17,678 - {'Epoch': 29, 'HR@5': '0.0873', 'NDCG@5': '0.0614', 'HR@10': '0.1215', 'NDCG@10': '0.0724', 'HR@20': '0.1634', 'NDCG@20': '0.0829'}
2025-02-19 16:57:17,678 - EarlyStopping counter: 6 out of 10
2025-02-19 16:57:47,890 - {'epoch': 30, 'rec_loss': '6.8171'}
2025-02-19 16:57:56,882 - {'Epoch': 30, 'HR@5': '0.0884', 'NDCG@5': '0.0621', 'HR@10': '0.1210', 'NDCG@10': '0.0726', 'HR@20': '0.1642', 'NDCG@20': '0.0835'}
2025-02-19 16:57:56,884 - EarlyStopping counter: 7 out of 10
2025-02-19 16:58:30,253 - {'epoch': 31, 'rec_loss': '6.8028'}
2025-02-19 16:58:39,437 - {'Epoch': 31, 'HR@5': '0.0881', 'NDCG@5': '0.0626', 'HR@10': '0.1204', 'NDCG@10': '0.0729', 'HR@20': '0.1633', 'NDCG@20': '0.0838'}
2025-02-19 16:58:39,439 - EarlyStopping counter: 8 out of 10
2025-02-19 16:59:11,049 - {'epoch': 32, 'rec_loss': '6.7997'}
2025-02-19 16:59:20,211 - {'Epoch': 32, 'HR@5': '0.0886', 'NDCG@5': '0.0630', 'HR@10': '0.1211', 'NDCG@10': '0.0734', 'HR@20': '0.1635', 'NDCG@20': '0.0841'}
2025-02-19 16:59:20,213 - Validation score increased.  Saving model ...
2025-02-19 16:59:49,304 - {'epoch': 33, 'rec_loss': '6.7964'}
2025-02-19 16:59:58,378 - {'Epoch': 33, 'HR@5': '0.0879', 'NDCG@5': '0.0624', 'HR@10': '0.1190', 'NDCG@10': '0.0724', 'HR@20': '0.1631', 'NDCG@20': '0.0835'}
2025-02-19 16:59:58,380 - EarlyStopping counter: 1 out of 10
2025-02-19 17:00:29,950 - {'epoch': 34, 'rec_loss': '6.7798'}
2025-02-19 17:00:39,079 - {'Epoch': 34, 'HR@5': '0.0883', 'NDCG@5': '0.0624', 'HR@10': '0.1202', 'NDCG@10': '0.0727', 'HR@20': '0.1626', 'NDCG@20': '0.0834'}
2025-02-19 17:00:39,080 - EarlyStopping counter: 2 out of 10
2025-02-19 17:01:10,396 - {'epoch': 35, 'rec_loss': '6.7762'}
2025-02-19 17:01:19,442 - {'Epoch': 35, 'HR@5': '0.0871', 'NDCG@5': '0.0612', 'HR@10': '0.1189', 'NDCG@10': '0.0715', 'HR@20': '0.1638', 'NDCG@20': '0.0827'}
2025-02-19 17:01:19,444 - EarlyStopping counter: 3 out of 10
2025-02-19 17:01:49,846 - {'epoch': 36, 'rec_loss': '6.7678'}
2025-02-19 17:01:59,405 - {'Epoch': 36, 'HR@5': '0.0872', 'NDCG@5': '0.0624', 'HR@10': '0.1214', 'NDCG@10': '0.0734', 'HR@20': '0.1634', 'NDCG@20': '0.0840'}
2025-02-19 17:01:59,405 - EarlyStopping counter: 4 out of 10
2025-02-19 17:02:29,741 - {'epoch': 37, 'rec_loss': '6.7533'}
2025-02-19 17:02:38,746 - {'Epoch': 37, 'HR@5': '0.0867', 'NDCG@5': '0.0614', 'HR@10': '0.1201', 'NDCG@10': '0.0721', 'HR@20': '0.1656', 'NDCG@20': '0.0836'}
2025-02-19 17:02:38,747 - EarlyStopping counter: 5 out of 10
2025-02-19 17:03:10,019 - {'epoch': 38, 'rec_loss': '6.7541'}
2025-02-19 17:03:19,161 - {'Epoch': 38, 'HR@5': '0.0869', 'NDCG@5': '0.0617', 'HR@10': '0.1207', 'NDCG@10': '0.0725', 'HR@20': '0.1635', 'NDCG@20': '0.0833'}
2025-02-19 17:03:19,163 - EarlyStopping counter: 6 out of 10
2025-02-19 17:03:48,977 - {'epoch': 39, 'rec_loss': '6.7469'}
2025-02-19 17:03:58,471 - {'Epoch': 39, 'HR@5': '0.0856', 'NDCG@5': '0.0607', 'HR@10': '0.1189', 'NDCG@10': '0.0714', 'HR@20': '0.1615', 'NDCG@20': '0.0821'}
2025-02-19 17:03:58,472 - EarlyStopping counter: 7 out of 10
2025-02-19 17:04:28,833 - {'epoch': 40, 'rec_loss': '6.7483'}
2025-02-19 17:04:38,238 - {'Epoch': 40, 'HR@5': '0.0871', 'NDCG@5': '0.0619', 'HR@10': '0.1196', 'NDCG@10': '0.0724', 'HR@20': '0.1646', 'NDCG@20': '0.0837'}
2025-02-19 17:04:38,240 - EarlyStopping counter: 8 out of 10
2025-02-19 17:05:07,367 - {'epoch': 41, 'rec_loss': '6.7356'}
2025-02-19 17:05:16,384 - {'Epoch': 41, 'HR@5': '0.0877', 'NDCG@5': '0.0623', 'HR@10': '0.1203', 'NDCG@10': '0.0728', 'HR@20': '0.1641', 'NDCG@20': '0.0839'}
2025-02-19 17:05:16,386 - EarlyStopping counter: 9 out of 10
2025-02-19 17:05:46,465 - {'epoch': 42, 'rec_loss': '6.7321'}
2025-02-19 17:05:56,073 - {'Epoch': 42, 'HR@5': '0.0893', 'NDCG@5': '0.0630', 'HR@10': '0.1206', 'NDCG@10': '0.0730', 'HR@20': '0.1642', 'NDCG@20': '0.0840'}
2025-02-19 17:05:56,073 - EarlyStopping counter: 10 out of 10
2025-02-19 17:05:56,073 - Early stopping
2025-02-19 17:05:56,073 - ---------------Test Score---------------
2025-02-19 17:06:04,813 - {'Epoch': 0, 'HR@5': '0.0727', 'NDCG@5': '0.0509', 'HR@10': '0.1001', 'NDCG@10': '0.0597', 'HR@20': '0.1368', 'NDCG@20': '0.0690'}
2025-02-19 17:06:04,813 - Scale_Beauty
2025-02-19 17:06:04,813 - {'Epoch': 0, 'HR@5': '0.0727', 'NDCG@5': '0.0509', 'HR@10': '0.1001', 'NDCG@10': '0.0597', 'HR@20': '0.1368', 'NDCG@20': '0.0690'}
2025-02-19 17:30:41,897 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-19 17:30:44,663 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-19 17:30:44,668 - Total Parameters: 929445
2025-02-19 17:31:14,205 - {'epoch': 0, 'rec_loss': '8.8444'}
2025-02-19 17:31:21,916 - {'Epoch': 0, 'HR@5': '0.0173', 'NDCG@5': '0.0107', 'HR@10': '0.0281', 'NDCG@10': '0.0142', 'HR@20': '0.0439', 'NDCG@20': '0.0182'}
2025-02-19 17:31:21,917 - Validation score increased.  Saving model ...
2025-02-19 17:31:50,022 - {'epoch': 1, 'rec_loss': '8.3554'}
2025-02-19 17:31:57,943 - {'Epoch': 1, 'HR@5': '0.0351', 'NDCG@5': '0.0238', 'HR@10': '0.0533', 'NDCG@10': '0.0297', 'HR@20': '0.0786', 'NDCG@20': '0.0361'}
2025-02-19 17:31:57,944 - Validation score increased.  Saving model ...
2025-02-19 17:32:25,253 - {'epoch': 2, 'rec_loss': '8.0526'}
2025-02-19 17:32:33,137 - {'Epoch': 2, 'HR@5': '0.0465', 'NDCG@5': '0.0315', 'HR@10': '0.0695', 'NDCG@10': '0.0389', 'HR@20': '0.0990', 'NDCG@20': '0.0463'}
2025-02-19 17:32:33,138 - Validation score increased.  Saving model ...
2025-02-19 17:33:00,949 - {'epoch': 3, 'rec_loss': '7.8402'}
2025-02-19 17:33:08,888 - {'Epoch': 3, 'HR@5': '0.0568', 'NDCG@5': '0.0386', 'HR@10': '0.0832', 'NDCG@10': '0.0471', 'HR@20': '0.1191', 'NDCG@20': '0.0561'}
2025-02-19 17:33:08,889 - Validation score increased.  Saving model ...
2025-02-19 17:33:35,905 - {'epoch': 4, 'rec_loss': '7.6826'}
2025-02-19 17:33:43,659 - {'Epoch': 4, 'HR@5': '0.0639', 'NDCG@5': '0.0445', 'HR@10': '0.0933', 'NDCG@10': '0.0539', 'HR@20': '0.1282', 'NDCG@20': '0.0627'}
2025-02-19 17:33:43,660 - Validation score increased.  Saving model ...
2025-02-19 17:34:10,944 - {'epoch': 5, 'rec_loss': '7.5728'}
2025-02-19 17:34:18,474 - {'Epoch': 5, 'HR@5': '0.0711', 'NDCG@5': '0.0497', 'HR@10': '0.0999', 'NDCG@10': '0.0590', 'HR@20': '0.1367', 'NDCG@20': '0.0682'}
2025-02-19 17:34:18,475 - Validation score increased.  Saving model ...
2025-02-19 17:34:46,123 - {'epoch': 6, 'rec_loss': '7.4773'}
2025-02-19 17:34:53,693 - {'Epoch': 6, 'HR@5': '0.0738', 'NDCG@5': '0.0516', 'HR@10': '0.1032', 'NDCG@10': '0.0610', 'HR@20': '0.1423', 'NDCG@20': '0.0709'}
2025-02-19 17:34:53,694 - Validation score increased.  Saving model ...
2025-02-19 17:35:24,713 - {'epoch': 7, 'rec_loss': '7.3974'}
2025-02-19 17:35:33,017 - {'Epoch': 7, 'HR@5': '0.0783', 'NDCG@5': '0.0549', 'HR@10': '0.1069', 'NDCG@10': '0.0642', 'HR@20': '0.1465', 'NDCG@20': '0.0741'}
2025-02-19 17:35:33,018 - Validation score increased.  Saving model ...
2025-02-19 17:36:00,485 - {'epoch': 8, 'rec_loss': '7.3303'}
2025-02-19 17:36:08,542 - {'Epoch': 8, 'HR@5': '0.0809', 'NDCG@5': '0.0570', 'HR@10': '0.1090', 'NDCG@10': '0.0660', 'HR@20': '0.1493', 'NDCG@20': '0.0762'}
2025-02-19 17:36:08,543 - Validation score increased.  Saving model ...
2025-02-19 17:36:37,451 - {'epoch': 9, 'rec_loss': '7.2812'}
2025-02-19 17:36:44,908 - {'Epoch': 9, 'HR@5': '0.0803', 'NDCG@5': '0.0560', 'HR@10': '0.1122', 'NDCG@10': '0.0663', 'HR@20': '0.1508', 'NDCG@20': '0.0760'}
2025-02-19 17:36:44,909 - EarlyStopping counter: 1 out of 10
2025-02-19 17:37:12,251 - {'epoch': 10, 'rec_loss': '7.2339'}
2025-02-19 17:37:19,877 - {'Epoch': 10, 'HR@5': '0.0825', 'NDCG@5': '0.0584', 'HR@10': '0.1127', 'NDCG@10': '0.0681', 'HR@20': '0.1536', 'NDCG@20': '0.0784'}
2025-02-19 17:37:19,878 - Validation score increased.  Saving model ...
2025-02-19 17:37:47,690 - {'epoch': 11, 'rec_loss': '7.1959'}
2025-02-19 17:37:55,484 - {'Epoch': 11, 'HR@5': '0.0833', 'NDCG@5': '0.0589', 'HR@10': '0.1132', 'NDCG@10': '0.0686', 'HR@20': '0.1533', 'NDCG@20': '0.0786'}
2025-02-19 17:37:55,485 - Validation score increased.  Saving model ...
2025-02-19 17:38:22,190 - {'epoch': 12, 'rec_loss': '7.1587'}
2025-02-19 17:38:29,535 - {'Epoch': 12, 'HR@5': '0.0843', 'NDCG@5': '0.0599', 'HR@10': '0.1147', 'NDCG@10': '0.0696', 'HR@20': '0.1560', 'NDCG@20': '0.0800'}
2025-02-19 17:38:29,536 - Validation score increased.  Saving model ...
2025-02-19 17:38:56,822 - {'epoch': 13, 'rec_loss': '7.1322'}
2025-02-19 17:39:04,955 - {'Epoch': 13, 'HR@5': '0.0845', 'NDCG@5': '0.0597', 'HR@10': '0.1176', 'NDCG@10': '0.0704', 'HR@20': '0.1574', 'NDCG@20': '0.0804'}
2025-02-19 17:39:04,956 - Validation score increased.  Saving model ...
2025-02-19 17:39:35,398 - {'epoch': 14, 'rec_loss': '7.1004'}
2025-02-19 17:39:43,162 - {'Epoch': 14, 'HR@5': '0.0877', 'NDCG@5': '0.0616', 'HR@10': '0.1179', 'NDCG@10': '0.0713', 'HR@20': '0.1591', 'NDCG@20': '0.0817'}
2025-02-19 17:39:43,163 - Validation score increased.  Saving model ...
2025-02-19 17:40:14,478 - {'epoch': 15, 'rec_loss': '7.0789'}
2025-02-19 17:40:21,948 - {'Epoch': 15, 'HR@5': '0.0854', 'NDCG@5': '0.0600', 'HR@10': '0.1177', 'NDCG@10': '0.0704', 'HR@20': '0.1596', 'NDCG@20': '0.0810'}
2025-02-19 17:40:21,949 - EarlyStopping counter: 1 out of 10
2025-02-19 17:40:49,875 - {'epoch': 16, 'rec_loss': '7.0580'}
2025-02-19 17:40:57,674 - {'Epoch': 16, 'HR@5': '0.0858', 'NDCG@5': '0.0602', 'HR@10': '0.1181', 'NDCG@10': '0.0706', 'HR@20': '0.1609', 'NDCG@20': '0.0814'}
2025-02-19 17:40:57,675 - EarlyStopping counter: 2 out of 10
2025-02-19 17:41:25,512 - {'epoch': 17, 'rec_loss': '7.0371'}
2025-02-19 17:41:33,280 - {'Epoch': 17, 'HR@5': '0.0858', 'NDCG@5': '0.0611', 'HR@10': '0.1189', 'NDCG@10': '0.0717', 'HR@20': '0.1614', 'NDCG@20': '0.0824'}
2025-02-19 17:41:33,281 - Validation score increased.  Saving model ...
2025-02-19 17:42:01,922 - {'epoch': 18, 'rec_loss': '7.0087'}
2025-02-19 17:42:09,683 - {'Epoch': 18, 'HR@5': '0.0872', 'NDCG@5': '0.0616', 'HR@10': '0.1185', 'NDCG@10': '0.0717', 'HR@20': '0.1608', 'NDCG@20': '0.0823'}
2025-02-19 17:42:09,688 - EarlyStopping counter: 1 out of 10
2025-02-19 17:42:36,907 - {'epoch': 19, 'rec_loss': '6.9942'}
2025-02-19 17:42:44,751 - {'Epoch': 19, 'HR@5': '0.0870', 'NDCG@5': '0.0617', 'HR@10': '0.1184', 'NDCG@10': '0.0718', 'HR@20': '0.1621', 'NDCG@20': '0.0828'}
2025-02-19 17:42:44,752 - Validation score increased.  Saving model ...
2025-02-19 17:43:11,340 - {'epoch': 20, 'rec_loss': '6.9771'}
2025-02-19 17:43:19,593 - {'Epoch': 20, 'HR@5': '0.0861', 'NDCG@5': '0.0615', 'HR@10': '0.1198', 'NDCG@10': '0.0724', 'HR@20': '0.1617', 'NDCG@20': '0.0830'}
2025-02-19 17:43:19,595 - Validation score increased.  Saving model ...
2025-02-19 17:43:48,119 - {'epoch': 21, 'rec_loss': '6.9661'}
2025-02-19 17:43:55,698 - {'Epoch': 21, 'HR@5': '0.0873', 'NDCG@5': '0.0615', 'HR@10': '0.1191', 'NDCG@10': '0.0718', 'HR@20': '0.1613', 'NDCG@20': '0.0824'}
2025-02-19 17:43:55,703 - EarlyStopping counter: 1 out of 10
2025-02-19 17:44:23,532 - {'epoch': 22, 'rec_loss': '6.9550'}
2025-02-19 17:44:31,282 - {'Epoch': 22, 'HR@5': '0.0870', 'NDCG@5': '0.0619', 'HR@10': '0.1201', 'NDCG@10': '0.0726', 'HR@20': '0.1630', 'NDCG@20': '0.0834'}
2025-02-19 17:44:31,283 - Validation score increased.  Saving model ...
2025-02-19 17:44:59,003 - {'epoch': 23, 'rec_loss': '6.9404'}
2025-02-19 17:45:07,038 - {'Epoch': 23, 'HR@5': '0.0869', 'NDCG@5': '0.0614', 'HR@10': '0.1201', 'NDCG@10': '0.0722', 'HR@20': '0.1625', 'NDCG@20': '0.0829'}
2025-02-19 17:45:07,042 - EarlyStopping counter: 1 out of 10
2025-02-19 17:45:33,699 - {'epoch': 24, 'rec_loss': '6.9338'}
2025-02-19 17:45:41,698 - {'Epoch': 24, 'HR@5': '0.0869', 'NDCG@5': '0.0616', 'HR@10': '0.1181', 'NDCG@10': '0.0716', 'HR@20': '0.1625', 'NDCG@20': '0.0828'}
2025-02-19 17:45:41,699 - EarlyStopping counter: 2 out of 10
2025-02-19 17:46:09,661 - {'epoch': 25, 'rec_loss': '6.9113'}
2025-02-19 17:46:17,192 - {'Epoch': 25, 'HR@5': '0.0873', 'NDCG@5': '0.0616', 'HR@10': '0.1202', 'NDCG@10': '0.0721', 'HR@20': '0.1631', 'NDCG@20': '0.0829'}
2025-02-19 17:46:17,193 - EarlyStopping counter: 3 out of 10
2025-02-19 17:46:46,494 - {'epoch': 26, 'rec_loss': '6.9057'}
2025-02-19 17:46:54,493 - {'Epoch': 26, 'HR@5': '0.0869', 'NDCG@5': '0.0618', 'HR@10': '0.1196', 'NDCG@10': '0.0723', 'HR@20': '0.1623', 'NDCG@20': '0.0831'}
2025-02-19 17:46:54,494 - EarlyStopping counter: 4 out of 10
2025-02-19 17:47:25,096 - {'epoch': 27, 'rec_loss': '6.8890'}
2025-02-19 17:47:33,411 - {'Epoch': 27, 'HR@5': '0.0870', 'NDCG@5': '0.0626', 'HR@10': '0.1197', 'NDCG@10': '0.0731', 'HR@20': '0.1623', 'NDCG@20': '0.0837'}
2025-02-19 17:47:33,412 - Validation score increased.  Saving model ...
2025-02-19 17:48:03,768 - {'epoch': 28, 'rec_loss': '6.8849'}
2025-02-19 17:48:11,537 - {'Epoch': 28, 'HR@5': '0.0875', 'NDCG@5': '0.0614', 'HR@10': '0.1200', 'NDCG@10': '0.0718', 'HR@20': '0.1618', 'NDCG@20': '0.0823'}
2025-02-19 17:48:11,538 - EarlyStopping counter: 1 out of 10
2025-02-19 17:48:38,773 - {'epoch': 29, 'rec_loss': '6.8746'}
2025-02-19 17:48:46,635 - {'Epoch': 29, 'HR@5': '0.0870', 'NDCG@5': '0.0610', 'HR@10': '0.1206', 'NDCG@10': '0.0718', 'HR@20': '0.1633', 'NDCG@20': '0.0826'}
2025-02-19 17:48:46,636 - EarlyStopping counter: 2 out of 10
2025-02-19 17:49:14,096 - {'epoch': 30, 'rec_loss': '6.8655'}
2025-02-19 17:49:21,911 - {'Epoch': 30, 'HR@5': '0.0874', 'NDCG@5': '0.0622', 'HR@10': '0.1206', 'NDCG@10': '0.0728', 'HR@20': '0.1636', 'NDCG@20': '0.0837'}
2025-02-19 17:49:21,912 - EarlyStopping counter: 3 out of 10
2025-02-19 17:49:49,625 - {'epoch': 31, 'rec_loss': '6.8521'}
2025-02-19 17:49:57,693 - {'Epoch': 31, 'HR@5': '0.0871', 'NDCG@5': '0.0620', 'HR@10': '0.1206', 'NDCG@10': '0.0728', 'HR@20': '0.1637', 'NDCG@20': '0.0836'}
2025-02-19 17:49:57,694 - EarlyStopping counter: 4 out of 10
2025-02-19 17:50:24,793 - {'epoch': 32, 'rec_loss': '6.8484'}
2025-02-19 17:50:32,515 - {'Epoch': 32, 'HR@5': '0.0868', 'NDCG@5': '0.0620', 'HR@10': '0.1205', 'NDCG@10': '0.0728', 'HR@20': '0.1630', 'NDCG@20': '0.0835'}
2025-02-19 17:50:32,516 - EarlyStopping counter: 5 out of 10
2025-02-19 17:51:01,975 - {'epoch': 33, 'rec_loss': '6.8449'}
2025-02-19 17:51:10,283 - {'Epoch': 33, 'HR@5': '0.0870', 'NDCG@5': '0.0623', 'HR@10': '0.1191', 'NDCG@10': '0.0727', 'HR@20': '0.1640', 'NDCG@20': '0.0839'}
2025-02-19 17:51:10,284 - Validation score increased.  Saving model ...
2025-02-19 17:51:40,489 - {'epoch': 34, 'rec_loss': '6.8298'}
2025-02-19 17:51:48,570 - {'Epoch': 34, 'HR@5': '0.0876', 'NDCG@5': '0.0618', 'HR@10': '0.1190', 'NDCG@10': '0.0719', 'HR@20': '0.1626', 'NDCG@20': '0.0829'}
2025-02-19 17:51:48,574 - EarlyStopping counter: 1 out of 10
2025-02-19 17:52:16,092 - {'epoch': 35, 'rec_loss': '6.8275'}
2025-02-19 17:52:23,963 - {'Epoch': 35, 'HR@5': '0.0868', 'NDCG@5': '0.0616', 'HR@10': '0.1198', 'NDCG@10': '0.0722', 'HR@20': '0.1638', 'NDCG@20': '0.0833'}
2025-02-19 17:52:23,964 - EarlyStopping counter: 2 out of 10
2025-02-19 17:52:50,744 - {'epoch': 36, 'rec_loss': '6.8183'}
2025-02-19 17:52:58,399 - {'Epoch': 36, 'HR@5': '0.0872', 'NDCG@5': '0.0623', 'HR@10': '0.1196', 'NDCG@10': '0.0727', 'HR@20': '0.1642', 'NDCG@20': '0.0840'}
2025-02-19 17:52:58,400 - Validation score increased.  Saving model ...
2025-02-19 17:53:25,608 - {'epoch': 37, 'rec_loss': '6.8018'}
2025-02-19 17:53:33,824 - {'Epoch': 37, 'HR@5': '0.0864', 'NDCG@5': '0.0614', 'HR@10': '0.1200', 'NDCG@10': '0.0723', 'HR@20': '0.1645', 'NDCG@20': '0.0835'}
2025-02-19 17:53:33,830 - EarlyStopping counter: 1 out of 10
2025-02-19 17:54:01,494 - {'epoch': 38, 'rec_loss': '6.8006'}
2025-02-19 17:54:09,402 - {'Epoch': 38, 'HR@5': '0.0864', 'NDCG@5': '0.0617', 'HR@10': '0.1208', 'NDCG@10': '0.0727', 'HR@20': '0.1636', 'NDCG@20': '0.0835'}
2025-02-19 17:54:09,403 - EarlyStopping counter: 2 out of 10
2025-02-19 17:54:40,228 - {'epoch': 39, 'rec_loss': '6.7929'}
2025-02-19 17:54:47,882 - {'Epoch': 39, 'HR@5': '0.0859', 'NDCG@5': '0.0607', 'HR@10': '0.1191', 'NDCG@10': '0.0714', 'HR@20': '0.1624', 'NDCG@20': '0.0823'}
2025-02-19 17:54:47,883 - EarlyStopping counter: 3 out of 10
2025-02-19 17:55:14,786 - {'epoch': 40, 'rec_loss': '6.7962'}
2025-02-19 17:55:22,915 - {'Epoch': 40, 'HR@5': '0.0872', 'NDCG@5': '0.0623', 'HR@10': '0.1199', 'NDCG@10': '0.0728', 'HR@20': '0.1638', 'NDCG@20': '0.0839'}
2025-02-19 17:55:22,916 - EarlyStopping counter: 4 out of 10
2025-02-19 17:55:49,516 - {'epoch': 41, 'rec_loss': '6.7832'}
2025-02-19 17:55:57,323 - {'Epoch': 41, 'HR@5': '0.0884', 'NDCG@5': '0.0629', 'HR@10': '0.1210', 'NDCG@10': '0.0734', 'HR@20': '0.1646', 'NDCG@20': '0.0843'}
2025-02-19 17:55:57,324 - Validation score increased.  Saving model ...
2025-02-19 17:56:25,969 - {'epoch': 42, 'rec_loss': '6.7796'}
2025-02-19 17:56:33,669 - {'Epoch': 42, 'HR@5': '0.0869', 'NDCG@5': '0.0621', 'HR@10': '0.1204', 'NDCG@10': '0.0728', 'HR@20': '0.1629', 'NDCG@20': '0.0836'}
2025-02-19 17:56:33,670 - EarlyStopping counter: 1 out of 10
2025-02-19 17:57:02,560 - {'epoch': 43, 'rec_loss': '6.7684'}
2025-02-19 17:57:10,204 - {'Epoch': 43, 'HR@5': '0.0878', 'NDCG@5': '0.0622', 'HR@10': '0.1201', 'NDCG@10': '0.0726', 'HR@20': '0.1629', 'NDCG@20': '0.0833'}
2025-02-19 17:57:10,206 - EarlyStopping counter: 2 out of 10
2025-02-19 17:57:38,312 - {'epoch': 44, 'rec_loss': '6.7698'}
2025-02-19 17:57:46,400 - {'Epoch': 44, 'HR@5': '0.0868', 'NDCG@5': '0.0617', 'HR@10': '0.1197', 'NDCG@10': '0.0723', 'HR@20': '0.1610', 'NDCG@20': '0.0827'}
2025-02-19 17:57:46,401 - EarlyStopping counter: 3 out of 10
2025-02-19 17:58:12,840 - {'epoch': 45, 'rec_loss': '6.7610'}
2025-02-19 17:58:20,535 - {'Epoch': 45, 'HR@5': '0.0872', 'NDCG@5': '0.0624', 'HR@10': '0.1206', 'NDCG@10': '0.0732', 'HR@20': '0.1646', 'NDCG@20': '0.0842'}
2025-02-19 17:58:20,541 - EarlyStopping counter: 4 out of 10
2025-02-19 17:58:48,100 - {'epoch': 46, 'rec_loss': '6.7503'}
2025-02-19 17:58:55,990 - {'Epoch': 46, 'HR@5': '0.0881', 'NDCG@5': '0.0629', 'HR@10': '0.1206', 'NDCG@10': '0.0734', 'HR@20': '0.1647', 'NDCG@20': '0.0844'}
2025-02-19 17:58:55,992 - Validation score increased.  Saving model ...
2025-02-19 17:59:22,187 - {'epoch': 47, 'rec_loss': '6.7468'}
2025-02-19 17:59:29,977 - {'Epoch': 47, 'HR@5': '0.0876', 'NDCG@5': '0.0624', 'HR@10': '0.1184', 'NDCG@10': '0.0723', 'HR@20': '0.1629', 'NDCG@20': '0.0835'}
2025-02-19 17:59:29,978 - EarlyStopping counter: 1 out of 10
2025-02-19 17:59:57,297 - {'epoch': 48, 'rec_loss': '6.7477'}
2025-02-19 18:00:05,134 - {'Epoch': 48, 'HR@5': '0.0881', 'NDCG@5': '0.0624', 'HR@10': '0.1201', 'NDCG@10': '0.0727', 'HR@20': '0.1629', 'NDCG@20': '0.0835'}
2025-02-19 18:00:05,136 - EarlyStopping counter: 2 out of 10
2025-02-19 18:00:31,791 - {'epoch': 49, 'rec_loss': '6.7389'}
2025-02-19 18:00:39,764 - {'Epoch': 49, 'HR@5': '0.0871', 'NDCG@5': '0.0620', 'HR@10': '0.1204', 'NDCG@10': '0.0727', 'HR@20': '0.1622', 'NDCG@20': '0.0832'}
2025-02-19 18:00:39,770 - EarlyStopping counter: 3 out of 10
2025-02-19 18:01:06,469 - {'epoch': 50, 'rec_loss': '6.7385'}
2025-02-19 18:01:14,539 - {'Epoch': 50, 'HR@5': '0.0878', 'NDCG@5': '0.0621', 'HR@10': '0.1207', 'NDCG@10': '0.0727', 'HR@20': '0.1631', 'NDCG@20': '0.0833'}
2025-02-19 18:01:14,541 - EarlyStopping counter: 4 out of 10
2025-02-19 18:01:42,407 - {'epoch': 51, 'rec_loss': '6.7323'}
2025-02-19 18:01:50,760 - {'Epoch': 51, 'HR@5': '0.0881', 'NDCG@5': '0.0623', 'HR@10': '0.1205', 'NDCG@10': '0.0727', 'HR@20': '0.1642', 'NDCG@20': '0.0837'}
2025-02-19 18:01:50,761 - EarlyStopping counter: 5 out of 10
2025-02-19 18:02:18,242 - {'epoch': 52, 'rec_loss': '6.7274'}
2025-02-19 18:02:26,140 - {'Epoch': 52, 'HR@5': '0.0862', 'NDCG@5': '0.0616', 'HR@10': '0.1189', 'NDCG@10': '0.0721', 'HR@20': '0.1628', 'NDCG@20': '0.0832'}
2025-02-19 18:02:26,141 - EarlyStopping counter: 6 out of 10
2025-02-19 18:02:54,174 - {'epoch': 53, 'rec_loss': '6.7271'}
2025-02-19 18:03:01,818 - {'Epoch': 53, 'HR@5': '0.0881', 'NDCG@5': '0.0627', 'HR@10': '0.1201', 'NDCG@10': '0.0729', 'HR@20': '0.1636', 'NDCG@20': '0.0839'}
2025-02-19 18:03:01,823 - EarlyStopping counter: 7 out of 10
2025-02-19 18:03:29,713 - {'epoch': 54, 'rec_loss': '6.7222'}
2025-02-19 18:03:37,593 - {'Epoch': 54, 'HR@5': '0.0898', 'NDCG@5': '0.0634', 'HR@10': '0.1197', 'NDCG@10': '0.0730', 'HR@20': '0.1630', 'NDCG@20': '0.0839'}
2025-02-19 18:03:37,595 - EarlyStopping counter: 8 out of 10
2025-02-19 18:04:05,599 - {'epoch': 55, 'rec_loss': '6.7138'}
2025-02-19 18:04:13,620 - {'Epoch': 55, 'HR@5': '0.0894', 'NDCG@5': '0.0635', 'HR@10': '0.1207', 'NDCG@10': '0.0736', 'HR@20': '0.1657', 'NDCG@20': '0.0849'}
2025-02-19 18:04:13,621 - Validation score increased.  Saving model ...
2025-02-19 18:04:40,852 - {'epoch': 56, 'rec_loss': '6.7125'}
2025-02-19 18:04:48,609 - {'Epoch': 56, 'HR@5': '0.0876', 'NDCG@5': '0.0627', 'HR@10': '0.1203', 'NDCG@10': '0.0733', 'HR@20': '0.1638', 'NDCG@20': '0.0842'}
2025-02-19 18:04:48,610 - EarlyStopping counter: 1 out of 10
2025-02-19 18:05:17,517 - {'epoch': 57, 'rec_loss': '6.7046'}
2025-02-19 18:05:25,150 - {'Epoch': 57, 'HR@5': '0.0884', 'NDCG@5': '0.0629', 'HR@10': '0.1199', 'NDCG@10': '0.0731', 'HR@20': '0.1633', 'NDCG@20': '0.0840'}
2025-02-19 18:05:25,154 - EarlyStopping counter: 2 out of 10
2025-02-19 18:05:55,161 - {'epoch': 58, 'rec_loss': '6.7032'}
2025-02-19 18:06:03,021 - {'Epoch': 58, 'HR@5': '0.0882', 'NDCG@5': '0.0628', 'HR@10': '0.1196', 'NDCG@10': '0.0729', 'HR@20': '0.1629', 'NDCG@20': '0.0838'}
2025-02-19 18:06:03,022 - EarlyStopping counter: 3 out of 10
2025-02-19 18:06:31,024 - {'epoch': 59, 'rec_loss': '6.6962'}
2025-02-19 18:06:38,922 - {'Epoch': 59, 'HR@5': '0.0888', 'NDCG@5': '0.0631', 'HR@10': '0.1214', 'NDCG@10': '0.0735', 'HR@20': '0.1652', 'NDCG@20': '0.0845'}
2025-02-19 18:06:38,924 - EarlyStopping counter: 4 out of 10
2025-02-19 18:07:06,631 - {'epoch': 60, 'rec_loss': '6.6919'}
2025-02-19 18:07:14,977 - {'Epoch': 60, 'HR@5': '0.0890', 'NDCG@5': '0.0636', 'HR@10': '0.1216', 'NDCG@10': '0.0740', 'HR@20': '0.1646', 'NDCG@20': '0.0849'}
2025-02-19 18:07:14,978 - Validation score increased.  Saving model ...
2025-02-19 18:07:42,158 - {'epoch': 61, 'rec_loss': '6.6923'}
2025-02-19 18:07:50,337 - {'Epoch': 61, 'HR@5': '0.0884', 'NDCG@5': '0.0635', 'HR@10': '0.1202', 'NDCG@10': '0.0737', 'HR@20': '0.1640', 'NDCG@20': '0.0848'}
2025-02-19 18:07:50,338 - EarlyStopping counter: 1 out of 10
2025-02-19 18:08:19,159 - {'epoch': 62, 'rec_loss': '6.6853'}
2025-02-19 18:08:27,408 - {'Epoch': 62, 'HR@5': '0.0889', 'NDCG@5': '0.0639', 'HR@10': '0.1217', 'NDCG@10': '0.0745', 'HR@20': '0.1644', 'NDCG@20': '0.0852'}
2025-02-19 18:08:27,410 - Validation score increased.  Saving model ...
2025-02-19 18:08:55,308 - {'epoch': 63, 'rec_loss': '6.6853'}
2025-02-19 18:09:03,076 - {'Epoch': 63, 'HR@5': '0.0888', 'NDCG@5': '0.0630', 'HR@10': '0.1208', 'NDCG@10': '0.0733', 'HR@20': '0.1652', 'NDCG@20': '0.0844'}
2025-02-19 18:09:03,077 - EarlyStopping counter: 1 out of 10
2025-02-19 18:09:30,782 - {'epoch': 64, 'rec_loss': '6.6810'}
2025-02-19 18:09:38,841 - {'Epoch': 64, 'HR@5': '0.0887', 'NDCG@5': '0.0636', 'HR@10': '0.1203', 'NDCG@10': '0.0738', 'HR@20': '0.1633', 'NDCG@20': '0.0846'}
2025-02-19 18:09:38,843 - EarlyStopping counter: 2 out of 10
2025-02-19 18:10:05,492 - {'epoch': 65, 'rec_loss': '6.6757'}
2025-02-19 18:10:13,384 - {'Epoch': 65, 'HR@5': '0.0878', 'NDCG@5': '0.0628', 'HR@10': '0.1201', 'NDCG@10': '0.0732', 'HR@20': '0.1652', 'NDCG@20': '0.0845'}
2025-02-19 18:10:13,385 - EarlyStopping counter: 3 out of 10
2025-02-19 18:10:40,501 - {'epoch': 66, 'rec_loss': '6.6801'}
2025-02-19 18:10:48,228 - {'Epoch': 66, 'HR@5': '0.0876', 'NDCG@5': '0.0626', 'HR@10': '0.1189', 'NDCG@10': '0.0727', 'HR@20': '0.1630', 'NDCG@20': '0.0838'}
2025-02-19 18:10:48,229 - EarlyStopping counter: 4 out of 10
2025-02-19 18:11:15,884 - {'epoch': 67, 'rec_loss': '6.6721'}
2025-02-19 18:11:23,582 - {'Epoch': 67, 'HR@5': '0.0871', 'NDCG@5': '0.0622', 'HR@10': '0.1189', 'NDCG@10': '0.0725', 'HR@20': '0.1617', 'NDCG@20': '0.0833'}
2025-02-19 18:11:23,590 - EarlyStopping counter: 5 out of 10
2025-02-19 18:11:51,388 - {'epoch': 68, 'rec_loss': '6.6716'}
2025-02-19 18:11:59,367 - {'Epoch': 68, 'HR@5': '0.0880', 'NDCG@5': '0.0629', 'HR@10': '0.1210', 'NDCG@10': '0.0735', 'HR@20': '0.1642', 'NDCG@20': '0.0844'}
2025-02-19 18:11:59,368 - EarlyStopping counter: 6 out of 10
2025-02-19 18:12:26,010 - {'epoch': 69, 'rec_loss': '6.6629'}
2025-02-19 18:12:34,232 - {'Epoch': 69, 'HR@5': '0.0885', 'NDCG@5': '0.0637', 'HR@10': '0.1210', 'NDCG@10': '0.0741', 'HR@20': '0.1635', 'NDCG@20': '0.0848'}
2025-02-19 18:12:34,233 - EarlyStopping counter: 7 out of 10
2025-02-19 18:13:00,941 - {'epoch': 70, 'rec_loss': '6.6597'}
2025-02-19 18:13:08,734 - {'Epoch': 70, 'HR@5': '0.0866', 'NDCG@5': '0.0622', 'HR@10': '0.1202', 'NDCG@10': '0.0730', 'HR@20': '0.1624', 'NDCG@20': '0.0836'}
2025-02-19 18:13:08,735 - EarlyStopping counter: 8 out of 10
2025-02-19 18:13:35,517 - {'epoch': 71, 'rec_loss': '6.6595'}
2025-02-19 18:13:43,101 - {'Epoch': 71, 'HR@5': '0.0871', 'NDCG@5': '0.0621', 'HR@10': '0.1186', 'NDCG@10': '0.0723', 'HR@20': '0.1624', 'NDCG@20': '0.0833'}
2025-02-19 18:13:43,102 - EarlyStopping counter: 9 out of 10
2025-02-19 18:14:10,679 - {'epoch': 72, 'rec_loss': '6.6571'}
2025-02-19 18:14:18,371 - {'Epoch': 72, 'HR@5': '0.0876', 'NDCG@5': '0.0637', 'HR@10': '0.1207', 'NDCG@10': '0.0744', 'HR@20': '0.1628', 'NDCG@20': '0.0850'}
2025-02-19 18:14:18,372 - EarlyStopping counter: 10 out of 10
2025-02-19 18:14:18,372 - Early stopping
2025-02-19 18:14:18,372 - ---------------Test Score---------------
2025-02-19 18:14:26,139 - {'Epoch': 0, 'HR@5': '0.0711', 'NDCG@5': '0.0507', 'HR@10': '0.0987', 'NDCG@10': '0.0596', 'HR@20': '0.1380', 'NDCG@20': '0.0695'}
2025-02-19 18:14:26,141 - Scale_Beauty
2025-02-19 18:14:26,141 - {'Epoch': 0, 'HR@5': '0.0711', 'NDCG@5': '0.0507', 'HR@10': '0.0987', 'NDCG@10': '0.0596', 'HR@20': '0.1380', 'NDCG@20': '0.0695'}
2025-02-19 19:02:54,428 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-19 19:02:57,722 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-19 19:02:57,728 - Total Parameters: 929445
2025-02-19 19:03:26,896 - {'epoch': 0, 'rec_loss': '8.8585'}
2025-02-19 19:03:35,037 - {'Epoch': 0, 'HR@5': '0.0148', 'NDCG@5': '0.0093', 'HR@10': '0.0254', 'NDCG@10': '0.0127', 'HR@20': '0.0408', 'NDCG@20': '0.0165'}
2025-02-19 19:03:35,038 - Validation score increased.  Saving model ...
2025-02-19 19:04:01,505 - {'epoch': 1, 'rec_loss': '8.3972'}
2025-02-19 19:04:09,806 - {'Epoch': 1, 'HR@5': '0.0326', 'NDCG@5': '0.0219', 'HR@10': '0.0502', 'NDCG@10': '0.0275', 'HR@20': '0.0740', 'NDCG@20': '0.0335'}
2025-02-19 19:04:09,813 - Validation score increased.  Saving model ...
2025-02-19 19:04:36,645 - {'epoch': 2, 'rec_loss': '8.1106'}
2025-02-19 19:04:44,488 - {'Epoch': 2, 'HR@5': '0.0434', 'NDCG@5': '0.0295', 'HR@10': '0.0662', 'NDCG@10': '0.0368', 'HR@20': '0.0941', 'NDCG@20': '0.0438'}
2025-02-19 19:04:44,489 - Validation score increased.  Saving model ...
2025-02-19 19:05:12,712 - {'epoch': 3, 'rec_loss': '7.9036'}
2025-02-19 19:05:20,373 - {'Epoch': 3, 'HR@5': '0.0535', 'NDCG@5': '0.0358', 'HR@10': '0.0798', 'NDCG@10': '0.0443', 'HR@20': '0.1153', 'NDCG@20': '0.0532'}
2025-02-19 19:05:20,377 - Validation score increased.  Saving model ...
2025-02-19 19:05:48,780 - {'epoch': 4, 'rec_loss': '7.7496'}
2025-02-19 19:05:56,170 - {'Epoch': 4, 'HR@5': '0.0621', 'NDCG@5': '0.0427', 'HR@10': '0.0885', 'NDCG@10': '0.0512', 'HR@20': '0.1228', 'NDCG@20': '0.0598'}
2025-02-19 19:05:56,171 - Validation score increased.  Saving model ...
2025-02-19 19:06:22,805 - {'epoch': 5, 'rec_loss': '7.6431'}
2025-02-19 19:06:30,402 - {'Epoch': 5, 'HR@5': '0.0673', 'NDCG@5': '0.0468', 'HR@10': '0.0970', 'NDCG@10': '0.0564', 'HR@20': '0.1329', 'NDCG@20': '0.0654'}
2025-02-19 19:06:30,403 - Validation score increased.  Saving model ...
2025-02-19 19:06:58,757 - {'epoch': 6, 'rec_loss': '7.5494'}
2025-02-19 19:07:06,116 - {'Epoch': 6, 'HR@5': '0.0720', 'NDCG@5': '0.0499', 'HR@10': '0.1003', 'NDCG@10': '0.0590', 'HR@20': '0.1398', 'NDCG@20': '0.0689'}
2025-02-19 19:07:06,117 - Validation score increased.  Saving model ...
2025-02-19 19:07:34,634 - {'epoch': 7, 'rec_loss': '7.4705'}
2025-02-19 19:07:41,884 - {'Epoch': 7, 'HR@5': '0.0760', 'NDCG@5': '0.0530', 'HR@10': '0.1047', 'NDCG@10': '0.0622', 'HR@20': '0.1452', 'NDCG@20': '0.0724'}
2025-02-19 19:07:41,886 - Validation score increased.  Saving model ...
2025-02-19 19:08:08,014 - {'epoch': 8, 'rec_loss': '7.4020'}
2025-02-19 19:08:15,496 - {'Epoch': 8, 'HR@5': '0.0787', 'NDCG@5': '0.0553', 'HR@10': '0.1071', 'NDCG@10': '0.0645', 'HR@20': '0.1464', 'NDCG@20': '0.0744'}
2025-02-19 19:08:15,497 - Validation score increased.  Saving model ...
2025-02-19 19:08:42,601 - {'epoch': 9, 'rec_loss': '7.3571'}
2025-02-19 19:08:50,183 - {'Epoch': 9, 'HR@5': '0.0784', 'NDCG@5': '0.0543', 'HR@10': '0.1103', 'NDCG@10': '0.0646', 'HR@20': '0.1492', 'NDCG@20': '0.0744'}
2025-02-19 19:08:50,184 - Validation score increased.  Saving model ...
2025-02-19 19:09:18,034 - {'epoch': 10, 'rec_loss': '7.3067'}
2025-02-19 19:09:25,369 - {'Epoch': 10, 'HR@5': '0.0815', 'NDCG@5': '0.0573', 'HR@10': '0.1117', 'NDCG@10': '0.0671', 'HR@20': '0.1507', 'NDCG@20': '0.0769'}
2025-02-19 19:09:25,371 - Validation score increased.  Saving model ...
2025-02-19 19:09:52,838 - {'epoch': 11, 'rec_loss': '7.2665'}
2025-02-19 19:10:00,627 - {'Epoch': 11, 'HR@5': '0.0810', 'NDCG@5': '0.0573', 'HR@10': '0.1119', 'NDCG@10': '0.0673', 'HR@20': '0.1518', 'NDCG@20': '0.0773'}
2025-02-19 19:10:00,628 - Validation score increased.  Saving model ...
2025-02-19 19:10:28,678 - {'epoch': 12, 'rec_loss': '7.2293'}
2025-02-19 19:10:35,865 - {'Epoch': 12, 'HR@5': '0.0833', 'NDCG@5': '0.0584', 'HR@10': '0.1140', 'NDCG@10': '0.0683', 'HR@20': '0.1535', 'NDCG@20': '0.0783'}
2025-02-19 19:10:35,866 - Validation score increased.  Saving model ...
2025-02-19 19:11:04,101 - {'epoch': 13, 'rec_loss': '7.2026'}
2025-02-19 19:11:11,375 - {'Epoch': 13, 'HR@5': '0.0843', 'NDCG@5': '0.0587', 'HR@10': '0.1156', 'NDCG@10': '0.0687', 'HR@20': '0.1543', 'NDCG@20': '0.0785'}
2025-02-19 19:11:11,377 - Validation score increased.  Saving model ...
2025-02-19 19:11:38,556 - {'epoch': 14, 'rec_loss': '7.1732'}
2025-02-19 19:11:45,828 - {'Epoch': 14, 'HR@5': '0.0863', 'NDCG@5': '0.0601', 'HR@10': '0.1171', 'NDCG@10': '0.0700', 'HR@20': '0.1582', 'NDCG@20': '0.0803'}
2025-02-19 19:11:45,829 - Validation score increased.  Saving model ...
2025-02-19 19:12:13,121 - {'epoch': 15, 'rec_loss': '7.1498'}
2025-02-19 19:12:20,307 - {'Epoch': 15, 'HR@5': '0.0865', 'NDCG@5': '0.0604', 'HR@10': '0.1169', 'NDCG@10': '0.0702', 'HR@20': '0.1579', 'NDCG@20': '0.0805'}
2025-02-19 19:12:20,309 - Validation score increased.  Saving model ...
2025-02-19 19:12:47,435 - {'epoch': 16, 'rec_loss': '7.1274'}
2025-02-19 19:12:54,857 - {'Epoch': 16, 'HR@5': '0.0849', 'NDCG@5': '0.0599', 'HR@10': '0.1176', 'NDCG@10': '0.0704', 'HR@20': '0.1600', 'NDCG@20': '0.0811'}
2025-02-19 19:12:54,858 - Validation score increased.  Saving model ...
2025-02-19 19:13:21,870 - {'epoch': 17, 'rec_loss': '7.1065'}
2025-02-19 19:13:28,959 - {'Epoch': 17, 'HR@5': '0.0848', 'NDCG@5': '0.0602', 'HR@10': '0.1171', 'NDCG@10': '0.0706', 'HR@20': '0.1597', 'NDCG@20': '0.0813'}
2025-02-19 19:13:28,961 - Validation score increased.  Saving model ...
2025-02-19 19:13:56,295 - {'epoch': 18, 'rec_loss': '7.0795'}
2025-02-19 19:14:03,539 - {'Epoch': 18, 'HR@5': '0.0851', 'NDCG@5': '0.0603', 'HR@10': '0.1166', 'NDCG@10': '0.0705', 'HR@20': '0.1602', 'NDCG@20': '0.0815'}
2025-02-19 19:14:03,540 - Validation score increased.  Saving model ...
2025-02-19 19:14:30,942 - {'epoch': 19, 'rec_loss': '7.0616'}
2025-02-19 19:14:38,171 - {'Epoch': 19, 'HR@5': '0.0862', 'NDCG@5': '0.0607', 'HR@10': '0.1177', 'NDCG@10': '0.0708', 'HR@20': '0.1600', 'NDCG@20': '0.0814'}
2025-02-19 19:14:38,172 - EarlyStopping counter: 1 out of 10
2025-02-19 19:15:05,450 - {'epoch': 20, 'rec_loss': '7.0461'}
2025-02-19 19:15:12,602 - {'Epoch': 20, 'HR@5': '0.0872', 'NDCG@5': '0.0614', 'HR@10': '0.1185', 'NDCG@10': '0.0714', 'HR@20': '0.1612', 'NDCG@20': '0.0822'}
2025-02-19 19:15:12,603 - Validation score increased.  Saving model ...
2025-02-19 19:15:40,482 - {'epoch': 21, 'rec_loss': '7.0337'}
2025-02-19 19:15:47,755 - {'Epoch': 21, 'HR@5': '0.0869', 'NDCG@5': '0.0608', 'HR@10': '0.1180', 'NDCG@10': '0.0709', 'HR@20': '0.1614', 'NDCG@20': '0.0818'}
2025-02-19 19:15:47,756 - EarlyStopping counter: 1 out of 10
2025-02-19 19:16:16,441 - {'epoch': 22, 'rec_loss': '7.0227'}
2025-02-19 19:16:23,810 - {'Epoch': 22, 'HR@5': '0.0879', 'NDCG@5': '0.0614', 'HR@10': '0.1190', 'NDCG@10': '0.0714', 'HR@20': '0.1623', 'NDCG@20': '0.0823'}
2025-02-19 19:16:23,811 - Validation score increased.  Saving model ...
2025-02-19 19:16:52,850 - {'epoch': 23, 'rec_loss': '7.0073'}
2025-02-19 19:17:00,140 - {'Epoch': 23, 'HR@5': '0.0873', 'NDCG@5': '0.0612', 'HR@10': '0.1198', 'NDCG@10': '0.0717', 'HR@20': '0.1616', 'NDCG@20': '0.0822'}
2025-02-19 19:17:00,141 - EarlyStopping counter: 1 out of 10
2025-02-19 19:17:27,009 - {'epoch': 24, 'rec_loss': '7.0003'}
2025-02-19 19:17:34,233 - {'Epoch': 24, 'HR@5': '0.0862', 'NDCG@5': '0.0609', 'HR@10': '0.1190', 'NDCG@10': '0.0714', 'HR@20': '0.1631', 'NDCG@20': '0.0825'}
2025-02-19 19:17:34,234 - Validation score increased.  Saving model ...
2025-02-19 19:18:02,262 - {'epoch': 25, 'rec_loss': '6.9796'}
2025-02-19 19:18:09,869 - {'Epoch': 25, 'HR@5': '0.0859', 'NDCG@5': '0.0605', 'HR@10': '0.1202', 'NDCG@10': '0.0716', 'HR@20': '0.1650', 'NDCG@20': '0.0829'}
2025-02-19 19:18:09,870 - Validation score increased.  Saving model ...
2025-02-19 19:18:37,424 - {'epoch': 26, 'rec_loss': '6.9756'}
2025-02-19 19:18:44,873 - {'Epoch': 26, 'HR@5': '0.0872', 'NDCG@5': '0.0615', 'HR@10': '0.1203', 'NDCG@10': '0.0721', 'HR@20': '0.1649', 'NDCG@20': '0.0834'}
2025-02-19 19:18:44,874 - Validation score increased.  Saving model ...
2025-02-19 19:19:12,271 - {'epoch': 27, 'rec_loss': '6.9574'}
2025-02-19 19:19:19,724 - {'Epoch': 27, 'HR@5': '0.0868', 'NDCG@5': '0.0620', 'HR@10': '0.1200', 'NDCG@10': '0.0727', 'HR@20': '0.1637', 'NDCG@20': '0.0837'}
2025-02-19 19:19:19,725 - Validation score increased.  Saving model ...
2025-02-19 19:19:47,377 - {'epoch': 28, 'rec_loss': '6.9544'}
2025-02-19 19:19:55,019 - {'Epoch': 28, 'HR@5': '0.0874', 'NDCG@5': '0.0610', 'HR@10': '0.1204', 'NDCG@10': '0.0715', 'HR@20': '0.1632', 'NDCG@20': '0.0823'}
2025-02-19 19:19:55,020 - EarlyStopping counter: 1 out of 10
2025-02-19 19:20:23,035 - {'epoch': 29, 'rec_loss': '6.9441'}
2025-02-19 19:20:30,415 - {'Epoch': 29, 'HR@5': '0.0876', 'NDCG@5': '0.0607', 'HR@10': '0.1208', 'NDCG@10': '0.0714', 'HR@20': '0.1642', 'NDCG@20': '0.0824'}
2025-02-19 19:20:30,416 - EarlyStopping counter: 2 out of 10
2025-02-19 19:20:58,383 - {'epoch': 30, 'rec_loss': '6.9390'}
2025-02-19 19:21:05,783 - {'Epoch': 30, 'HR@5': '0.0880', 'NDCG@5': '0.0617', 'HR@10': '0.1214', 'NDCG@10': '0.0725', 'HR@20': '0.1665', 'NDCG@20': '0.0838'}
2025-02-19 19:21:05,784 - Validation score increased.  Saving model ...
2025-02-19 19:21:33,780 - {'epoch': 31, 'rec_loss': '6.9243'}
2025-02-19 19:21:41,688 - {'Epoch': 31, 'HR@5': '0.0873', 'NDCG@5': '0.0614', 'HR@10': '0.1215', 'NDCG@10': '0.0724', 'HR@20': '0.1659', 'NDCG@20': '0.0836'}
2025-02-19 19:21:41,689 - EarlyStopping counter: 1 out of 10
2025-02-19 19:22:09,096 - {'epoch': 32, 'rec_loss': '6.9213'}
2025-02-19 19:22:17,031 - {'Epoch': 32, 'HR@5': '0.0867', 'NDCG@5': '0.0614', 'HR@10': '0.1203', 'NDCG@10': '0.0723', 'HR@20': '0.1648', 'NDCG@20': '0.0835'}
2025-02-19 19:22:17,032 - EarlyStopping counter: 2 out of 10
2025-02-19 19:22:45,195 - {'epoch': 33, 'rec_loss': '6.9177'}
2025-02-19 19:22:52,758 - {'Epoch': 33, 'HR@5': '0.0873', 'NDCG@5': '0.0617', 'HR@10': '0.1210', 'NDCG@10': '0.0726', 'HR@20': '0.1631', 'NDCG@20': '0.0832'}
2025-02-19 19:22:52,759 - EarlyStopping counter: 3 out of 10
2025-02-19 19:23:21,078 - {'epoch': 34, 'rec_loss': '6.8997'}
2025-02-19 19:23:28,619 - {'Epoch': 34, 'HR@5': '0.0870', 'NDCG@5': '0.0613', 'HR@10': '0.1219', 'NDCG@10': '0.0726', 'HR@20': '0.1639', 'NDCG@20': '0.0831'}
2025-02-19 19:23:28,620 - EarlyStopping counter: 4 out of 10
2025-02-19 19:23:57,202 - {'epoch': 35, 'rec_loss': '6.8974'}
2025-02-19 19:24:04,520 - {'Epoch': 35, 'HR@5': '0.0866', 'NDCG@5': '0.0611', 'HR@10': '0.1216', 'NDCG@10': '0.0724', 'HR@20': '0.1651', 'NDCG@20': '0.0833'}
2025-02-19 19:24:04,521 - EarlyStopping counter: 5 out of 10
2025-02-19 19:24:31,944 - {'epoch': 36, 'rec_loss': '6.8914'}
2025-02-19 19:24:39,721 - {'Epoch': 36, 'HR@5': '0.0876', 'NDCG@5': '0.0618', 'HR@10': '0.1220', 'NDCG@10': '0.0729', 'HR@20': '0.1644', 'NDCG@20': '0.0836'}
2025-02-19 19:24:39,722 - EarlyStopping counter: 6 out of 10
2025-02-19 19:25:06,063 - {'epoch': 37, 'rec_loss': '6.8762'}
2025-02-19 19:25:13,452 - {'Epoch': 37, 'HR@5': '0.0877', 'NDCG@5': '0.0618', 'HR@10': '0.1227', 'NDCG@10': '0.0731', 'HR@20': '0.1660', 'NDCG@20': '0.0840'}
2025-02-19 19:25:13,453 - Validation score increased.  Saving model ...
2025-02-19 19:25:40,718 - {'epoch': 38, 'rec_loss': '6.8748'}
2025-02-19 19:25:47,992 - {'Epoch': 38, 'HR@5': '0.0875', 'NDCG@5': '0.0618', 'HR@10': '0.1217', 'NDCG@10': '0.0728', 'HR@20': '0.1660', 'NDCG@20': '0.0840'}
2025-02-19 19:25:47,994 - Validation score increased.  Saving model ...
2025-02-19 19:26:15,624 - {'epoch': 39, 'rec_loss': '6.8679'}
2025-02-19 19:26:22,918 - {'Epoch': 39, 'HR@5': '0.0852', 'NDCG@5': '0.0604', 'HR@10': '0.1202', 'NDCG@10': '0.0716', 'HR@20': '0.1649', 'NDCG@20': '0.0829'}
2025-02-19 19:26:22,919 - EarlyStopping counter: 1 out of 10
2025-02-19 19:26:51,824 - {'epoch': 40, 'rec_loss': '6.8682'}
2025-02-19 19:26:59,635 - {'Epoch': 40, 'HR@5': '0.0872', 'NDCG@5': '0.0616', 'HR@10': '0.1210', 'NDCG@10': '0.0726', 'HR@20': '0.1656', 'NDCG@20': '0.0838'}
2025-02-19 19:26:59,636 - EarlyStopping counter: 2 out of 10
2025-02-19 19:27:27,436 - {'epoch': 41, 'rec_loss': '6.8568'}
2025-02-19 19:27:34,648 - {'Epoch': 41, 'HR@5': '0.0891', 'NDCG@5': '0.0628', 'HR@10': '0.1219', 'NDCG@10': '0.0734', 'HR@20': '0.1665', 'NDCG@20': '0.0846'}
2025-02-19 19:27:34,649 - Validation score increased.  Saving model ...
2025-02-19 19:28:02,674 - {'epoch': 42, 'rec_loss': '6.8533'}
2025-02-19 19:28:10,357 - {'Epoch': 42, 'HR@5': '0.0882', 'NDCG@5': '0.0624', 'HR@10': '0.1215', 'NDCG@10': '0.0731', 'HR@20': '0.1657', 'NDCG@20': '0.0843'}
2025-02-19 19:28:10,358 - EarlyStopping counter: 1 out of 10
2025-02-19 19:28:38,449 - {'epoch': 43, 'rec_loss': '6.8467'}
2025-02-19 19:28:45,832 - {'Epoch': 43, 'HR@5': '0.0873', 'NDCG@5': '0.0618', 'HR@10': '0.1210', 'NDCG@10': '0.0726', 'HR@20': '0.1660', 'NDCG@20': '0.0839'}
2025-02-19 19:28:45,833 - EarlyStopping counter: 2 out of 10
2025-02-19 19:29:15,570 - {'epoch': 44, 'rec_loss': '6.8430'}
2025-02-19 19:29:23,101 - {'Epoch': 44, 'HR@5': '0.0880', 'NDCG@5': '0.0620', 'HR@10': '0.1195', 'NDCG@10': '0.0722', 'HR@20': '0.1638', 'NDCG@20': '0.0833'}
2025-02-19 19:29:23,102 - EarlyStopping counter: 3 out of 10
2025-02-19 19:29:52,839 - {'epoch': 45, 'rec_loss': '6.8354'}
2025-02-19 19:30:00,695 - {'Epoch': 45, 'HR@5': '0.0881', 'NDCG@5': '0.0624', 'HR@10': '0.1201', 'NDCG@10': '0.0727', 'HR@20': '0.1663', 'NDCG@20': '0.0844'}
2025-02-19 19:30:00,696 - EarlyStopping counter: 4 out of 10
2025-02-19 19:30:28,221 - {'epoch': 46, 'rec_loss': '6.8233'}
2025-02-19 19:30:35,559 - {'Epoch': 46, 'HR@5': '0.0887', 'NDCG@5': '0.0632', 'HR@10': '0.1229', 'NDCG@10': '0.0742', 'HR@20': '0.1672', 'NDCG@20': '0.0852'}
2025-02-19 19:30:35,560 - Validation score increased.  Saving model ...
2025-02-19 19:31:03,802 - {'epoch': 47, 'rec_loss': '6.8210'}
2025-02-19 19:31:11,221 - {'Epoch': 47, 'HR@5': '0.0882', 'NDCG@5': '0.0626', 'HR@10': '0.1198', 'NDCG@10': '0.0727', 'HR@20': '0.1652', 'NDCG@20': '0.0841'}
2025-02-19 19:31:11,222 - EarlyStopping counter: 1 out of 10
2025-02-19 19:31:38,266 - {'epoch': 48, 'rec_loss': '6.8209'}
2025-02-19 19:31:45,624 - {'Epoch': 48, 'HR@5': '0.0887', 'NDCG@5': '0.0628', 'HR@10': '0.1211', 'NDCG@10': '0.0732', 'HR@20': '0.1663', 'NDCG@20': '0.0846'}
2025-02-19 19:31:45,625 - EarlyStopping counter: 2 out of 10
2025-02-19 19:32:13,587 - {'epoch': 49, 'rec_loss': '6.8179'}
2025-02-19 19:32:21,151 - {'Epoch': 49, 'HR@5': '0.0889', 'NDCG@5': '0.0625', 'HR@10': '0.1208', 'NDCG@10': '0.0727', 'HR@20': '0.1651', 'NDCG@20': '0.0839'}
2025-02-19 19:32:21,152 - EarlyStopping counter: 3 out of 10
2025-02-19 19:32:49,194 - {'epoch': 50, 'rec_loss': '6.8133'}
2025-02-19 19:32:56,568 - {'Epoch': 50, 'HR@5': '0.0895', 'NDCG@5': '0.0630', 'HR@10': '0.1211', 'NDCG@10': '0.0732', 'HR@20': '0.1668', 'NDCG@20': '0.0846'}
2025-02-19 19:32:56,569 - EarlyStopping counter: 4 out of 10
2025-02-19 19:33:24,130 - {'epoch': 51, 'rec_loss': '6.8076'}
2025-02-19 19:33:31,772 - {'Epoch': 51, 'HR@5': '0.0886', 'NDCG@5': '0.0623', 'HR@10': '0.1224', 'NDCG@10': '0.0732', 'HR@20': '0.1651', 'NDCG@20': '0.0839'}
2025-02-19 19:33:31,773 - EarlyStopping counter: 5 out of 10
2025-02-19 19:33:59,276 - {'epoch': 52, 'rec_loss': '6.8025'}
2025-02-19 19:34:06,759 - {'Epoch': 52, 'HR@5': '0.0880', 'NDCG@5': '0.0621', 'HR@10': '0.1217', 'NDCG@10': '0.0730', 'HR@20': '0.1650', 'NDCG@20': '0.0839'}
2025-02-19 19:34:06,760 - EarlyStopping counter: 6 out of 10
2025-02-19 19:34:34,461 - {'epoch': 53, 'rec_loss': '6.8028'}
2025-02-19 19:34:41,910 - {'Epoch': 53, 'HR@5': '0.0884', 'NDCG@5': '0.0622', 'HR@10': '0.1225', 'NDCG@10': '0.0731', 'HR@20': '0.1660', 'NDCG@20': '0.0841'}
2025-02-19 19:34:41,911 - EarlyStopping counter: 7 out of 10
2025-02-19 19:35:09,335 - {'epoch': 54, 'rec_loss': '6.7945'}
2025-02-19 19:35:16,888 - {'Epoch': 54, 'HR@5': '0.0887', 'NDCG@5': '0.0628', 'HR@10': '0.1227', 'NDCG@10': '0.0738', 'HR@20': '0.1650', 'NDCG@20': '0.0844'}
2025-02-19 19:35:16,889 - EarlyStopping counter: 8 out of 10
2025-02-19 19:35:44,517 - {'epoch': 55, 'rec_loss': '6.7863'}
2025-02-19 19:35:51,937 - {'Epoch': 55, 'HR@5': '0.0896', 'NDCG@5': '0.0635', 'HR@10': '0.1227', 'NDCG@10': '0.0741', 'HR@20': '0.1660', 'NDCG@20': '0.0850'}
2025-02-19 19:35:51,938 - EarlyStopping counter: 9 out of 10
2025-02-19 19:36:20,091 - {'epoch': 56, 'rec_loss': '6.7872'}
2025-02-19 19:36:27,524 - {'Epoch': 56, 'HR@5': '0.0889', 'NDCG@5': '0.0631', 'HR@10': '0.1214', 'NDCG@10': '0.0736', 'HR@20': '0.1667', 'NDCG@20': '0.0850'}
2025-02-19 19:36:27,525 - EarlyStopping counter: 10 out of 10
2025-02-19 19:36:27,525 - Early stopping
2025-02-19 19:36:27,525 - ---------------Test Score---------------
2025-02-19 19:36:35,020 - {'Epoch': 0, 'HR@5': '0.0711', 'NDCG@5': '0.0507', 'HR@10': '0.0999', 'NDCG@10': '0.0599', 'HR@20': '0.1371', 'NDCG@20': '0.0693'}
2025-02-19 19:36:35,021 - Scale_Beauty
2025-02-19 19:36:35,022 - {'Epoch': 0, 'HR@5': '0.0711', 'NDCG@5': '0.0507', 'HR@10': '0.0999', 'NDCG@10': '0.0599', 'HR@20': '0.1371', 'NDCG@20': '0.0693'}
2025-02-19 19:46:17,370 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], start_prob=0.3, end_prob=0.7, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-19 19:46:20,140 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-19 19:46:20,146 - Total Parameters: 929445
2025-02-19 19:46:48,637 - {'epoch': 0, 'rec_loss': '8.8677'}
2025-02-19 19:46:56,424 - {'Epoch': 0, 'HR@5': '0.0134', 'NDCG@5': '0.0086', 'HR@10': '0.0243', 'NDCG@10': '0.0121', 'HR@20': '0.0394', 'NDCG@20': '0.0159'}
2025-02-19 19:46:56,426 - Validation score increased.  Saving model ...
2025-02-19 19:47:24,194 - {'epoch': 1, 'rec_loss': '8.4323'}
2025-02-19 19:47:32,059 - {'Epoch': 1, 'HR@5': '0.0305', 'NDCG@5': '0.0201', 'HR@10': '0.0478', 'NDCG@10': '0.0257', 'HR@20': '0.0692', 'NDCG@20': '0.0310'}
2025-02-19 19:47:32,060 - Validation score increased.  Saving model ...
2025-02-19 19:47:58,415 - {'epoch': 2, 'rec_loss': '8.1577'}
2025-02-19 19:48:05,949 - {'Epoch': 2, 'HR@5': '0.0418', 'NDCG@5': '0.0283', 'HR@10': '0.0622', 'NDCG@10': '0.0348', 'HR@20': '0.0893', 'NDCG@20': '0.0416'}
2025-02-19 19:48:05,951 - Validation score increased.  Saving model ...
2025-02-19 19:48:33,154 - {'epoch': 3, 'rec_loss': '7.9521'}
2025-02-19 19:48:40,626 - {'Epoch': 3, 'HR@5': '0.0509', 'NDCG@5': '0.0332', 'HR@10': '0.0762', 'NDCG@10': '0.0413', 'HR@20': '0.1112', 'NDCG@20': '0.0501'}
2025-02-19 19:48:40,628 - Validation score increased.  Saving model ...
2025-02-19 19:49:07,790 - {'epoch': 4, 'rec_loss': '7.8015'}
2025-02-19 19:49:15,223 - {'Epoch': 4, 'HR@5': '0.0596', 'NDCG@5': '0.0406', 'HR@10': '0.0850', 'NDCG@10': '0.0488', 'HR@20': '0.1190', 'NDCG@20': '0.0574'}
2025-02-19 19:49:15,224 - Validation score increased.  Saving model ...
2025-02-19 19:49:42,712 - {'epoch': 5, 'rec_loss': '7.6981'}
2025-02-19 19:49:50,112 - {'Epoch': 5, 'HR@5': '0.0642', 'NDCG@5': '0.0442', 'HR@10': '0.0932', 'NDCG@10': '0.0536', 'HR@20': '0.1292', 'NDCG@20': '0.0626'}
2025-02-19 19:49:50,113 - Validation score increased.  Saving model ...
2025-02-19 19:50:18,138 - {'epoch': 6, 'rec_loss': '7.6072'}
2025-02-19 19:50:25,439 - {'Epoch': 6, 'HR@5': '0.0686', 'NDCG@5': '0.0478', 'HR@10': '0.0979', 'NDCG@10': '0.0573', 'HR@20': '0.1357', 'NDCG@20': '0.0668'}
2025-02-19 19:50:25,440 - Validation score increased.  Saving model ...
2025-02-19 19:50:52,575 - {'epoch': 7, 'rec_loss': '7.5340'}
2025-02-19 19:51:00,976 - {'Epoch': 7, 'HR@5': '0.0729', 'NDCG@5': '0.0506', 'HR@10': '0.1019', 'NDCG@10': '0.0598', 'HR@20': '0.1413', 'NDCG@20': '0.0698'}
2025-02-19 19:51:00,977 - Validation score increased.  Saving model ...
2025-02-19 19:51:28,530 - {'epoch': 8, 'rec_loss': '7.4659'}
2025-02-19 19:51:36,102 - {'Epoch': 8, 'HR@5': '0.0750', 'NDCG@5': '0.0525', 'HR@10': '0.1042', 'NDCG@10': '0.0619', 'HR@20': '0.1445', 'NDCG@20': '0.0720'}
2025-02-19 19:51:36,103 - Validation score increased.  Saving model ...
2025-02-19 19:52:02,801 - {'epoch': 9, 'rec_loss': '7.4221'}
2025-02-19 19:52:10,393 - {'Epoch': 9, 'HR@5': '0.0761', 'NDCG@5': '0.0529', 'HR@10': '0.1081', 'NDCG@10': '0.0632', 'HR@20': '0.1477', 'NDCG@20': '0.0731'}
2025-02-19 19:52:10,395 - Validation score increased.  Saving model ...
2025-02-19 19:52:37,219 - {'epoch': 10, 'rec_loss': '7.3717'}
2025-02-19 19:52:44,890 - {'Epoch': 10, 'HR@5': '0.0787', 'NDCG@5': '0.0553', 'HR@10': '0.1094', 'NDCG@10': '0.0652', 'HR@20': '0.1509', 'NDCG@20': '0.0757'}
2025-02-19 19:52:44,892 - Validation score increased.  Saving model ...
2025-02-19 19:53:14,261 - {'epoch': 11, 'rec_loss': '7.3322'}
2025-02-19 19:53:21,879 - {'Epoch': 11, 'HR@5': '0.0794', 'NDCG@5': '0.0560', 'HR@10': '0.1096', 'NDCG@10': '0.0658', 'HR@20': '0.1504', 'NDCG@20': '0.0760'}
2025-02-19 19:53:21,880 - Validation score increased.  Saving model ...
2025-02-19 19:53:52,162 - {'epoch': 12, 'rec_loss': '7.2955'}
2025-02-19 19:54:00,485 - {'Epoch': 12, 'HR@5': '0.0802', 'NDCG@5': '0.0568', 'HR@10': '0.1132', 'NDCG@10': '0.0674', 'HR@20': '0.1543', 'NDCG@20': '0.0777'}
2025-02-19 19:54:00,486 - Validation score increased.  Saving model ...
2025-02-19 19:54:29,740 - {'epoch': 13, 'rec_loss': '7.2704'}
2025-02-19 19:54:37,780 - {'Epoch': 13, 'HR@5': '0.0825', 'NDCG@5': '0.0577', 'HR@10': '0.1140', 'NDCG@10': '0.0678', 'HR@20': '0.1544', 'NDCG@20': '0.0779'}
2025-02-19 19:54:37,781 - Validation score increased.  Saving model ...
2025-02-19 19:55:07,931 - {'epoch': 14, 'rec_loss': '7.2412'}
2025-02-19 19:55:15,465 - {'Epoch': 14, 'HR@5': '0.0837', 'NDCG@5': '0.0586', 'HR@10': '0.1169', 'NDCG@10': '0.0693', 'HR@20': '0.1571', 'NDCG@20': '0.0794'}
2025-02-19 19:55:15,466 - Validation score increased.  Saving model ...
2025-02-19 19:55:42,577 - {'epoch': 15, 'rec_loss': '7.2136'}
2025-02-19 19:55:50,252 - {'Epoch': 15, 'HR@5': '0.0847', 'NDCG@5': '0.0592', 'HR@10': '0.1154', 'NDCG@10': '0.0690', 'HR@20': '0.1581', 'NDCG@20': '0.0798'}
2025-02-19 19:55:50,253 - Validation score increased.  Saving model ...
2025-02-19 19:56:18,067 - {'epoch': 16, 'rec_loss': '7.1914'}
2025-02-19 19:56:25,873 - {'Epoch': 16, 'HR@5': '0.0849', 'NDCG@5': '0.0591', 'HR@10': '0.1163', 'NDCG@10': '0.0692', 'HR@20': '0.1592', 'NDCG@20': '0.0800'}
2025-02-19 19:56:25,874 - Validation score increased.  Saving model ...
2025-02-19 19:56:53,223 - {'epoch': 17, 'rec_loss': '7.1702'}
2025-02-19 19:57:00,798 - {'Epoch': 17, 'HR@5': '0.0844', 'NDCG@5': '0.0595', 'HR@10': '0.1170', 'NDCG@10': '0.0699', 'HR@20': '0.1588', 'NDCG@20': '0.0805'}
2025-02-19 19:57:00,799 - Validation score increased.  Saving model ...
2025-02-19 19:57:28,627 - {'epoch': 18, 'rec_loss': '7.1458'}
2025-02-19 19:57:36,250 - {'Epoch': 18, 'HR@5': '0.0852', 'NDCG@5': '0.0606', 'HR@10': '0.1170', 'NDCG@10': '0.0707', 'HR@20': '0.1600', 'NDCG@20': '0.0816'}
2025-02-19 19:57:36,251 - Validation score increased.  Saving model ...
2025-02-19 19:58:03,312 - {'epoch': 19, 'rec_loss': '7.1269'}
2025-02-19 19:58:11,076 - {'Epoch': 19, 'HR@5': '0.0853', 'NDCG@5': '0.0606', 'HR@10': '0.1184', 'NDCG@10': '0.0712', 'HR@20': '0.1602', 'NDCG@20': '0.0817'}
2025-02-19 19:58:11,077 - Validation score increased.  Saving model ...
2025-02-19 19:58:37,609 - {'epoch': 20, 'rec_loss': '7.1096'}
2025-02-19 19:58:45,168 - {'Epoch': 20, 'HR@5': '0.0857', 'NDCG@5': '0.0604', 'HR@10': '0.1189', 'NDCG@10': '0.0710', 'HR@20': '0.1611', 'NDCG@20': '0.0816'}
2025-02-19 19:58:45,169 - EarlyStopping counter: 1 out of 10
2025-02-19 19:59:13,079 - {'epoch': 21, 'rec_loss': '7.0962'}
2025-02-19 19:59:21,358 - {'Epoch': 21, 'HR@5': '0.0862', 'NDCG@5': '0.0608', 'HR@10': '0.1183', 'NDCG@10': '0.0711', 'HR@20': '0.1609', 'NDCG@20': '0.0818'}
2025-02-19 19:59:21,360 - Validation score increased.  Saving model ...
2025-02-19 19:59:49,515 - {'epoch': 22, 'rec_loss': '7.0831'}
2025-02-19 19:59:57,221 - {'Epoch': 22, 'HR@5': '0.0871', 'NDCG@5': '0.0612', 'HR@10': '0.1193', 'NDCG@10': '0.0716', 'HR@20': '0.1605', 'NDCG@20': '0.0820'}
2025-02-19 19:59:57,222 - Validation score increased.  Saving model ...
2025-02-19 20:00:26,871 - {'epoch': 23, 'rec_loss': '7.0715'}
2025-02-19 20:00:34,666 - {'Epoch': 23, 'HR@5': '0.0856', 'NDCG@5': '0.0609', 'HR@10': '0.1187', 'NDCG@10': '0.0715', 'HR@20': '0.1631', 'NDCG@20': '0.0827'}
2025-02-19 20:00:34,667 - Validation score increased.  Saving model ...
2025-02-19 20:01:01,290 - {'epoch': 24, 'rec_loss': '7.0635'}
2025-02-19 20:01:09,017 - {'Epoch': 24, 'HR@5': '0.0865', 'NDCG@5': '0.0613', 'HR@10': '0.1188', 'NDCG@10': '0.0716', 'HR@20': '0.1617', 'NDCG@20': '0.0825'}
2025-02-19 20:01:09,018 - EarlyStopping counter: 1 out of 10
2025-02-19 20:01:36,080 - {'epoch': 25, 'rec_loss': '7.0424'}
2025-02-19 20:01:43,616 - {'Epoch': 25, 'HR@5': '0.0868', 'NDCG@5': '0.0611', 'HR@10': '0.1195', 'NDCG@10': '0.0716', 'HR@20': '0.1629', 'NDCG@20': '0.0825'}
2025-02-19 20:01:43,617 - EarlyStopping counter: 2 out of 10
2025-02-19 20:02:09,466 - {'epoch': 26, 'rec_loss': '7.0370'}
2025-02-19 20:02:17,372 - {'Epoch': 26, 'HR@5': '0.0868', 'NDCG@5': '0.0612', 'HR@10': '0.1194', 'NDCG@10': '0.0717', 'HR@20': '0.1628', 'NDCG@20': '0.0827'}
2025-02-19 20:02:17,373 - EarlyStopping counter: 3 out of 10
2025-02-19 20:02:43,639 - {'epoch': 27, 'rec_loss': '7.0209'}
2025-02-19 20:02:51,259 - {'Epoch': 27, 'HR@5': '0.0859', 'NDCG@5': '0.0612', 'HR@10': '0.1196', 'NDCG@10': '0.0721', 'HR@20': '0.1620', 'NDCG@20': '0.0827'}
2025-02-19 20:02:51,261 - EarlyStopping counter: 4 out of 10
2025-02-19 20:03:19,309 - {'epoch': 28, 'rec_loss': '7.0186'}
2025-02-19 20:03:27,085 - {'Epoch': 28, 'HR@5': '0.0858', 'NDCG@5': '0.0600', 'HR@10': '0.1187', 'NDCG@10': '0.0706', 'HR@20': '0.1612', 'NDCG@20': '0.0813'}
2025-02-19 20:03:27,086 - EarlyStopping counter: 5 out of 10
2025-02-19 20:03:54,550 - {'epoch': 29, 'rec_loss': '7.0032'}
2025-02-19 20:04:02,284 - {'Epoch': 29, 'HR@5': '0.0855', 'NDCG@5': '0.0603', 'HR@10': '0.1196', 'NDCG@10': '0.0714', 'HR@20': '0.1628', 'NDCG@20': '0.0822'}
2025-02-19 20:04:02,285 - EarlyStopping counter: 6 out of 10
2025-02-19 20:04:29,918 - {'epoch': 30, 'rec_loss': '7.0006'}
2025-02-19 20:04:37,878 - {'Epoch': 30, 'HR@5': '0.0875', 'NDCG@5': '0.0616', 'HR@10': '0.1204', 'NDCG@10': '0.0723', 'HR@20': '0.1637', 'NDCG@20': '0.0832'}
2025-02-19 20:04:37,879 - Validation score increased.  Saving model ...
2025-02-19 20:05:05,628 - {'epoch': 31, 'rec_loss': '6.9861'}
2025-02-19 20:05:13,367 - {'Epoch': 31, 'HR@5': '0.0874', 'NDCG@5': '0.0616', 'HR@10': '0.1210', 'NDCG@10': '0.0725', 'HR@20': '0.1645', 'NDCG@20': '0.0834'}
2025-02-19 20:05:13,368 - Validation score increased.  Saving model ...
2025-02-19 20:05:42,012 - {'epoch': 32, 'rec_loss': '6.9832'}
2025-02-19 20:05:49,905 - {'Epoch': 32, 'HR@5': '0.0866', 'NDCG@5': '0.0614', 'HR@10': '0.1200', 'NDCG@10': '0.0722', 'HR@20': '0.1645', 'NDCG@20': '0.0834'}
2025-02-19 20:05:49,906 - EarlyStopping counter: 1 out of 10
2025-02-19 20:06:17,628 - {'epoch': 33, 'rec_loss': '6.9765'}
2025-02-19 20:06:25,618 - {'Epoch': 33, 'HR@5': '0.0880', 'NDCG@5': '0.0617', 'HR@10': '0.1202', 'NDCG@10': '0.0721', 'HR@20': '0.1640', 'NDCG@20': '0.0831'}
2025-02-19 20:06:25,619 - EarlyStopping counter: 2 out of 10
2025-02-19 20:06:52,992 - {'epoch': 34, 'rec_loss': '6.9563'}
2025-02-19 20:07:01,296 - {'Epoch': 34, 'HR@5': '0.0883', 'NDCG@5': '0.0619', 'HR@10': '0.1206', 'NDCG@10': '0.0723', 'HR@20': '0.1624', 'NDCG@20': '0.0829'}
2025-02-19 20:07:01,297 - EarlyStopping counter: 3 out of 10
2025-02-19 20:07:29,920 - {'epoch': 35, 'rec_loss': '6.9566'}
2025-02-19 20:07:37,821 - {'Epoch': 35, 'HR@5': '0.0870', 'NDCG@5': '0.0611', 'HR@10': '0.1193', 'NDCG@10': '0.0715', 'HR@20': '0.1645', 'NDCG@20': '0.0828'}
2025-02-19 20:07:37,822 - EarlyStopping counter: 4 out of 10
2025-02-19 20:08:04,354 - {'epoch': 36, 'rec_loss': '6.9532'}
2025-02-19 20:08:11,963 - {'Epoch': 36, 'HR@5': '0.0889', 'NDCG@5': '0.0622', 'HR@10': '0.1214', 'NDCG@10': '0.0725', 'HR@20': '0.1633', 'NDCG@20': '0.0831'}
2025-02-19 20:08:11,964 - EarlyStopping counter: 5 out of 10
2025-02-19 20:08:42,078 - {'epoch': 37, 'rec_loss': '6.9359'}
2025-02-19 20:08:49,729 - {'Epoch': 37, 'HR@5': '0.0875', 'NDCG@5': '0.0618', 'HR@10': '0.1211', 'NDCG@10': '0.0726', 'HR@20': '0.1643', 'NDCG@20': '0.0835'}
2025-02-19 20:08:49,730 - Validation score increased.  Saving model ...
2025-02-19 20:09:19,944 - {'epoch': 38, 'rec_loss': '6.9340'}
2025-02-19 20:09:27,611 - {'Epoch': 38, 'HR@5': '0.0879', 'NDCG@5': '0.0621', 'HR@10': '0.1216', 'NDCG@10': '0.0729', 'HR@20': '0.1650', 'NDCG@20': '0.0838'}
2025-02-19 20:09:27,613 - Validation score increased.  Saving model ...
2025-02-19 20:09:55,057 - {'epoch': 39, 'rec_loss': '6.9238'}
2025-02-19 20:10:02,771 - {'Epoch': 39, 'HR@5': '0.0855', 'NDCG@5': '0.0606', 'HR@10': '0.1198', 'NDCG@10': '0.0717', 'HR@20': '0.1626', 'NDCG@20': '0.0825'}
2025-02-19 20:10:02,772 - EarlyStopping counter: 1 out of 10
2025-02-19 20:10:30,586 - {'epoch': 40, 'rec_loss': '6.9221'}
2025-02-19 20:10:38,438 - {'Epoch': 40, 'HR@5': '0.0872', 'NDCG@5': '0.0617', 'HR@10': '0.1210', 'NDCG@10': '0.0726', 'HR@20': '0.1641', 'NDCG@20': '0.0835'}
2025-02-19 20:10:38,439 - EarlyStopping counter: 2 out of 10
2025-02-19 20:11:06,027 - {'epoch': 41, 'rec_loss': '6.9153'}
2025-02-19 20:11:13,852 - {'Epoch': 41, 'HR@5': '0.0880', 'NDCG@5': '0.0624', 'HR@10': '0.1210', 'NDCG@10': '0.0730', 'HR@20': '0.1643', 'NDCG@20': '0.0839'}
2025-02-19 20:11:13,856 - Validation score increased.  Saving model ...
2025-02-19 20:11:40,885 - {'epoch': 42, 'rec_loss': '6.9105'}
2025-02-19 20:11:48,705 - {'Epoch': 42, 'HR@5': '0.0886', 'NDCG@5': '0.0625', 'HR@10': '0.1214', 'NDCG@10': '0.0730', 'HR@20': '0.1651', 'NDCG@20': '0.0840'}
2025-02-19 20:11:48,706 - Validation score increased.  Saving model ...
2025-02-19 20:12:16,158 - {'epoch': 43, 'rec_loss': '6.9035'}
2025-02-19 20:12:23,900 - {'Epoch': 43, 'HR@5': '0.0872', 'NDCG@5': '0.0621', 'HR@10': '0.1209', 'NDCG@10': '0.0730', 'HR@20': '0.1642', 'NDCG@20': '0.0838'}
2025-02-19 20:12:23,901 - EarlyStopping counter: 1 out of 10
2025-02-19 20:12:53,023 - {'epoch': 44, 'rec_loss': '6.8993'}
2025-02-19 20:13:00,752 - {'Epoch': 44, 'HR@5': '0.0881', 'NDCG@5': '0.0625', 'HR@10': '0.1212', 'NDCG@10': '0.0731', 'HR@20': '0.1628', 'NDCG@20': '0.0835'}
2025-02-19 20:13:00,754 - EarlyStopping counter: 2 out of 10
2025-02-19 20:13:27,694 - {'epoch': 45, 'rec_loss': '6.8912'}
2025-02-19 20:13:35,794 - {'Epoch': 45, 'HR@5': '0.0884', 'NDCG@5': '0.0625', 'HR@10': '0.1210', 'NDCG@10': '0.0730', 'HR@20': '0.1649', 'NDCG@20': '0.0840'}
2025-02-19 20:13:35,795 - Validation score increased.  Saving model ...
2025-02-19 20:14:03,305 - {'epoch': 46, 'rec_loss': '6.8814'}
2025-02-19 20:14:11,053 - {'Epoch': 46, 'HR@5': '0.0888', 'NDCG@5': '0.0627', 'HR@10': '0.1207', 'NDCG@10': '0.0730', 'HR@20': '0.1650', 'NDCG@20': '0.0841'}
2025-02-19 20:14:11,054 - Validation score increased.  Saving model ...
2025-02-19 20:14:38,950 - {'epoch': 47, 'rec_loss': '6.8760'}
2025-02-19 20:14:46,640 - {'Epoch': 47, 'HR@5': '0.0885', 'NDCG@5': '0.0624', 'HR@10': '0.1193', 'NDCG@10': '0.0723', 'HR@20': '0.1635', 'NDCG@20': '0.0835'}
2025-02-19 20:14:46,641 - EarlyStopping counter: 1 out of 10
2025-02-19 20:15:15,481 - {'epoch': 48, 'rec_loss': '6.8756'}
2025-02-19 20:15:23,878 - {'Epoch': 48, 'HR@5': '0.0879', 'NDCG@5': '0.0626', 'HR@10': '0.1206', 'NDCG@10': '0.0731', 'HR@20': '0.1642', 'NDCG@20': '0.0841'}
2025-02-19 20:15:23,879 - Validation score increased.  Saving model ...
2025-02-19 20:15:51,713 - {'epoch': 49, 'rec_loss': '6.8730'}
2025-02-19 20:15:59,631 - {'Epoch': 49, 'HR@5': '0.0883', 'NDCG@5': '0.0630', 'HR@10': '0.1208', 'NDCG@10': '0.0735', 'HR@20': '0.1630', 'NDCG@20': '0.0841'}
2025-02-19 20:15:59,637 - EarlyStopping counter: 1 out of 10
2025-02-19 20:16:26,744 - {'epoch': 50, 'rec_loss': '6.8666'}
2025-02-19 20:16:34,409 - {'Epoch': 50, 'HR@5': '0.0880', 'NDCG@5': '0.0624', 'HR@10': '0.1207', 'NDCG@10': '0.0729', 'HR@20': '0.1640', 'NDCG@20': '0.0838'}
2025-02-19 20:16:34,410 - EarlyStopping counter: 2 out of 10
2025-02-19 20:17:01,290 - {'epoch': 51, 'rec_loss': '6.8661'}
2025-02-19 20:17:09,183 - {'Epoch': 51, 'HR@5': '0.0874', 'NDCG@5': '0.0619', 'HR@10': '0.1206', 'NDCG@10': '0.0726', 'HR@20': '0.1647', 'NDCG@20': '0.0837'}
2025-02-19 20:17:09,185 - EarlyStopping counter: 3 out of 10
2025-02-19 20:17:35,938 - {'epoch': 52, 'rec_loss': '6.8537'}
2025-02-19 20:17:43,526 - {'Epoch': 52, 'HR@5': '0.0877', 'NDCG@5': '0.0620', 'HR@10': '0.1212', 'NDCG@10': '0.0728', 'HR@20': '0.1639', 'NDCG@20': '0.0836'}
2025-02-19 20:17:43,527 - EarlyStopping counter: 4 out of 10
2025-02-19 20:18:11,354 - {'epoch': 53, 'rec_loss': '6.8573'}
2025-02-19 20:18:19,616 - {'Epoch': 53, 'HR@5': '0.0884', 'NDCG@5': '0.0624', 'HR@10': '0.1212', 'NDCG@10': '0.0730', 'HR@20': '0.1646', 'NDCG@20': '0.0839'}
2025-02-19 20:18:19,617 - EarlyStopping counter: 5 out of 10
2025-02-19 20:18:47,280 - {'epoch': 54, 'rec_loss': '6.8515'}
2025-02-19 20:18:54,949 - {'Epoch': 54, 'HR@5': '0.0889', 'NDCG@5': '0.0630', 'HR@10': '0.1214', 'NDCG@10': '0.0735', 'HR@20': '0.1642', 'NDCG@20': '0.0842'}
2025-02-19 20:18:54,951 - Validation score increased.  Saving model ...
2025-02-19 20:19:22,553 - {'epoch': 55, 'rec_loss': '6.8403'}
2025-02-19 20:19:30,420 - {'Epoch': 55, 'HR@5': '0.0882', 'NDCG@5': '0.0629', 'HR@10': '0.1214', 'NDCG@10': '0.0736', 'HR@20': '0.1647', 'NDCG@20': '0.0844'}
2025-02-19 20:19:30,421 - Validation score increased.  Saving model ...
2025-02-19 20:19:58,606 - {'epoch': 56, 'rec_loss': '6.8396'}
2025-02-19 20:20:06,736 - {'Epoch': 56, 'HR@5': '0.0888', 'NDCG@5': '0.0631', 'HR@10': '0.1207', 'NDCG@10': '0.0734', 'HR@20': '0.1648', 'NDCG@20': '0.0845'}
2025-02-19 20:20:06,738 - Validation score increased.  Saving model ...
2025-02-19 20:20:33,658 - {'epoch': 57, 'rec_loss': '6.8411'}
2025-02-19 20:20:41,489 - {'Epoch': 57, 'HR@5': '0.0885', 'NDCG@5': '0.0629', 'HR@10': '0.1196', 'NDCG@10': '0.0729', 'HR@20': '0.1634', 'NDCG@20': '0.0839'}
2025-02-19 20:20:41,490 - EarlyStopping counter: 1 out of 10
2025-02-19 20:21:09,360 - {'epoch': 58, 'rec_loss': '6.8349'}
2025-02-19 20:21:16,884 - {'Epoch': 58, 'HR@5': '0.0882', 'NDCG@5': '0.0626', 'HR@10': '0.1196', 'NDCG@10': '0.0728', 'HR@20': '0.1635', 'NDCG@20': '0.0838'}
2025-02-19 20:21:16,885 - EarlyStopping counter: 2 out of 10
2025-02-19 20:21:44,584 - {'epoch': 59, 'rec_loss': '6.8276'}
2025-02-19 20:21:52,484 - {'Epoch': 59, 'HR@5': '0.0886', 'NDCG@5': '0.0631', 'HR@10': '0.1219', 'NDCG@10': '0.0739', 'HR@20': '0.1648', 'NDCG@20': '0.0846'}
2025-02-19 20:21:52,485 - Validation score increased.  Saving model ...
2025-02-19 20:22:19,667 - {'epoch': 60, 'rec_loss': '6.8228'}
2025-02-19 20:22:27,449 - {'Epoch': 60, 'HR@5': '0.0900', 'NDCG@5': '0.0645', 'HR@10': '0.1210', 'NDCG@10': '0.0745', 'HR@20': '0.1652', 'NDCG@20': '0.0856'}
2025-02-19 20:22:27,450 - Validation score increased.  Saving model ...
2025-02-19 20:22:54,234 - {'epoch': 61, 'rec_loss': '6.8202'}
2025-02-19 20:23:02,116 - {'Epoch': 61, 'HR@5': '0.0894', 'NDCG@5': '0.0638', 'HR@10': '0.1206', 'NDCG@10': '0.0739', 'HR@20': '0.1640', 'NDCG@20': '0.0848'}
2025-02-19 20:23:02,117 - EarlyStopping counter: 1 out of 10
2025-02-19 20:23:30,192 - {'epoch': 62, 'rec_loss': '6.8216'}
2025-02-19 20:23:37,942 - {'Epoch': 62, 'HR@5': '0.0895', 'NDCG@5': '0.0645', 'HR@10': '0.1215', 'NDCG@10': '0.0749', 'HR@20': '0.1631', 'NDCG@20': '0.0853'}
2025-02-19 20:23:37,943 - EarlyStopping counter: 2 out of 10
2025-02-19 20:24:06,152 - {'epoch': 63, 'rec_loss': '6.8129'}
2025-02-19 20:24:13,929 - {'Epoch': 63, 'HR@5': '0.0893', 'NDCG@5': '0.0635', 'HR@10': '0.1199', 'NDCG@10': '0.0734', 'HR@20': '0.1635', 'NDCG@20': '0.0843'}
2025-02-19 20:24:13,930 - EarlyStopping counter: 3 out of 10
2025-02-19 20:24:41,495 - {'epoch': 64, 'rec_loss': '6.8105'}
2025-02-19 20:24:49,326 - {'Epoch': 64, 'HR@5': '0.0900', 'NDCG@5': '0.0642', 'HR@10': '0.1203', 'NDCG@10': '0.0739', 'HR@20': '0.1629', 'NDCG@20': '0.0846'}
2025-02-19 20:24:49,327 - EarlyStopping counter: 4 out of 10
2025-02-19 20:25:16,985 - {'epoch': 65, 'rec_loss': '6.8106'}
2025-02-19 20:25:24,797 - {'Epoch': 65, 'HR@5': '0.0885', 'NDCG@5': '0.0627', 'HR@10': '0.1213', 'NDCG@10': '0.0733', 'HR@20': '0.1652', 'NDCG@20': '0.0843'}
2025-02-19 20:25:24,799 - EarlyStopping counter: 5 out of 10
2025-02-19 20:25:52,015 - {'epoch': 66, 'rec_loss': '6.8072'}
2025-02-19 20:25:59,977 - {'Epoch': 66, 'HR@5': '0.0895', 'NDCG@5': '0.0630', 'HR@10': '0.1203', 'NDCG@10': '0.0730', 'HR@20': '0.1638', 'NDCG@20': '0.0839'}
2025-02-19 20:25:59,982 - EarlyStopping counter: 6 out of 10
2025-02-19 20:26:27,527 - {'epoch': 67, 'rec_loss': '6.8061'}
2025-02-19 20:26:35,637 - {'Epoch': 67, 'HR@5': '0.0887', 'NDCG@5': '0.0627', 'HR@10': '0.1215', 'NDCG@10': '0.0733', 'HR@20': '0.1650', 'NDCG@20': '0.0841'}
2025-02-19 20:26:35,638 - EarlyStopping counter: 7 out of 10
2025-02-19 20:27:03,891 - {'epoch': 68, 'rec_loss': '6.8061'}
2025-02-19 20:27:12,785 - {'Epoch': 68, 'HR@5': '0.0896', 'NDCG@5': '0.0638', 'HR@10': '0.1217', 'NDCG@10': '0.0742', 'HR@20': '0.1642', 'NDCG@20': '0.0848'}
2025-02-19 20:27:12,786 - EarlyStopping counter: 8 out of 10
2025-02-19 20:27:41,592 - {'epoch': 69, 'rec_loss': '6.7904'}
2025-02-19 20:27:49,392 - {'Epoch': 69, 'HR@5': '0.0907', 'NDCG@5': '0.0644', 'HR@10': '0.1229', 'NDCG@10': '0.0747', 'HR@20': '0.1637', 'NDCG@20': '0.0850'}
2025-02-19 20:27:49,397 - EarlyStopping counter: 9 out of 10
2025-02-19 20:28:16,859 - {'epoch': 70, 'rec_loss': '6.7951'}
2025-02-19 20:28:24,499 - {'Epoch': 70, 'HR@5': '0.0892', 'NDCG@5': '0.0633', 'HR@10': '0.1210', 'NDCG@10': '0.0736', 'HR@20': '0.1639', 'NDCG@20': '0.0844'}
2025-02-19 20:28:24,500 - EarlyStopping counter: 10 out of 10
2025-02-19 20:28:24,500 - Early stopping
2025-02-19 20:28:24,500 - ---------------Test Score---------------
2025-02-19 20:28:32,083 - {'Epoch': 0, 'HR@5': '0.0706', 'NDCG@5': '0.0499', 'HR@10': '0.0985', 'NDCG@10': '0.0590', 'HR@20': '0.1366', 'NDCG@20': '0.0686'}
2025-02-19 20:28:32,084 - Scale_Beauty
2025-02-19 20:28:32,084 - {'Epoch': 0, 'HR@5': '0.0706', 'NDCG@5': '0.0499', 'HR@10': '0.0985', 'NDCG@10': '0.0590', 'HR@20': '0.1366', 'NDCG@20': '0.0686'}
2025-02-19 21:45:27,729 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25, 10], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-19 21:45:30,483 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-19 21:45:30,487 - Total Parameters: 928470
2025-02-19 21:46:06,499 - {'epoch': 0, 'rec_loss': '8.8051'}
2025-02-19 21:46:15,780 - {'Epoch': 0, 'HR@5': '0.0240', 'NDCG@5': '0.0156', 'HR@10': '0.0372', 'NDCG@10': '0.0198', 'HR@20': '0.0560', 'NDCG@20': '0.0245'}
2025-02-19 21:46:15,782 - Validation score increased.  Saving model ...
2025-02-19 21:46:52,564 - {'epoch': 1, 'rec_loss': '8.2287'}
2025-02-19 21:47:01,145 - {'Epoch': 1, 'HR@5': '0.0420', 'NDCG@5': '0.0282', 'HR@10': '0.0639', 'NDCG@10': '0.0352', 'HR@20': '0.0915', 'NDCG@20': '0.0421'}
2025-02-19 21:47:01,146 - Validation score increased.  Saving model ...
2025-02-19 21:47:35,252 - {'epoch': 2, 'rec_loss': '7.9153'}
2025-02-19 21:47:43,828 - {'Epoch': 2, 'HR@5': '0.0577', 'NDCG@5': '0.0399', 'HR@10': '0.0817', 'NDCG@10': '0.0476', 'HR@20': '0.1156', 'NDCG@20': '0.0562'}
2025-02-19 21:47:43,831 - Validation score increased.  Saving model ...
2025-02-19 21:48:19,851 - {'epoch': 3, 'rec_loss': '7.6929'}
2025-02-19 21:48:28,248 - {'Epoch': 3, 'HR@5': '0.0664', 'NDCG@5': '0.0461', 'HR@10': '0.0962', 'NDCG@10': '0.0557', 'HR@20': '0.1336', 'NDCG@20': '0.0651'}
2025-02-19 21:48:28,249 - Validation score increased.  Saving model ...
2025-02-19 21:49:06,624 - {'epoch': 4, 'rec_loss': '7.5287'}
2025-02-19 21:49:15,152 - {'Epoch': 4, 'HR@5': '0.0729', 'NDCG@5': '0.0510', 'HR@10': '0.1018', 'NDCG@10': '0.0604', 'HR@20': '0.1403', 'NDCG@20': '0.0701'}
2025-02-19 21:49:15,154 - Validation score increased.  Saving model ...
2025-02-19 21:49:51,634 - {'epoch': 5, 'rec_loss': '7.4014'}
2025-02-19 21:49:59,713 - {'Epoch': 5, 'HR@5': '0.0756', 'NDCG@5': '0.0537', 'HR@10': '0.1051', 'NDCG@10': '0.0632', 'HR@20': '0.1437', 'NDCG@20': '0.0729'}
2025-02-19 21:49:59,715 - Validation score increased.  Saving model ...
2025-02-19 21:50:35,686 - {'epoch': 6, 'rec_loss': '7.3036'}
2025-02-19 21:50:44,521 - {'Epoch': 6, 'HR@5': '0.0783', 'NDCG@5': '0.0547', 'HR@10': '0.1084', 'NDCG@10': '0.0644', 'HR@20': '0.1495', 'NDCG@20': '0.0748'}
2025-02-19 21:50:44,522 - Validation score increased.  Saving model ...
2025-02-19 21:51:20,676 - {'epoch': 7, 'rec_loss': '7.2226'}
2025-02-19 21:51:28,969 - {'Epoch': 7, 'HR@5': '0.0797', 'NDCG@5': '0.0558', 'HR@10': '0.1103', 'NDCG@10': '0.0657', 'HR@20': '0.1511', 'NDCG@20': '0.0759'}
2025-02-19 21:51:28,971 - Validation score increased.  Saving model ...
2025-02-19 21:52:04,286 - {'epoch': 8, 'rec_loss': '7.1636'}
2025-02-19 21:52:13,065 - {'Epoch': 8, 'HR@5': '0.0826', 'NDCG@5': '0.0586', 'HR@10': '0.1136', 'NDCG@10': '0.0686', 'HR@20': '0.1533', 'NDCG@20': '0.0786'}
2025-02-19 21:52:13,067 - Validation score increased.  Saving model ...
2025-02-19 21:52:48,290 - {'epoch': 9, 'rec_loss': '7.1146'}
2025-02-19 21:52:56,426 - {'Epoch': 9, 'HR@5': '0.0814', 'NDCG@5': '0.0588', 'HR@10': '0.1118', 'NDCG@10': '0.0686', 'HR@20': '0.1529', 'NDCG@20': '0.0789'}
2025-02-19 21:52:56,428 - Validation score increased.  Saving model ...
2025-02-19 21:53:33,348 - {'epoch': 10, 'rec_loss': '7.0687'}
2025-02-19 21:53:41,480 - {'Epoch': 10, 'HR@5': '0.0838', 'NDCG@5': '0.0603', 'HR@10': '0.1164', 'NDCG@10': '0.0708', 'HR@20': '0.1560', 'NDCG@20': '0.0807'}
2025-02-19 21:53:41,481 - Validation score increased.  Saving model ...
2025-02-19 21:54:18,886 - {'epoch': 11, 'rec_loss': '7.0353'}
2025-02-19 21:54:27,816 - {'Epoch': 11, 'HR@5': '0.0845', 'NDCG@5': '0.0599', 'HR@10': '0.1169', 'NDCG@10': '0.0703', 'HR@20': '0.1584', 'NDCG@20': '0.0808'}
2025-02-19 21:54:27,818 - Validation score increased.  Saving model ...
2025-02-19 21:55:04,748 - {'epoch': 12, 'rec_loss': '7.0007'}
2025-02-19 21:55:13,168 - {'Epoch': 12, 'HR@5': '0.0862', 'NDCG@5': '0.0614', 'HR@10': '0.1147', 'NDCG@10': '0.0705', 'HR@20': '0.1564', 'NDCG@20': '0.0810'}
2025-02-19 21:55:13,170 - Validation score increased.  Saving model ...
2025-02-19 21:55:48,558 - {'epoch': 13, 'rec_loss': '6.9708'}
2025-02-19 21:55:56,735 - {'Epoch': 13, 'HR@5': '0.0849', 'NDCG@5': '0.0597', 'HR@10': '0.1167', 'NDCG@10': '0.0699', 'HR@20': '0.1595', 'NDCG@20': '0.0807'}
2025-02-19 21:55:56,736 - EarlyStopping counter: 1 out of 10
2025-02-19 21:56:33,051 - {'epoch': 14, 'rec_loss': '6.9461'}
2025-02-19 21:56:41,895 - {'Epoch': 14, 'HR@5': '0.0840', 'NDCG@5': '0.0593', 'HR@10': '0.1147', 'NDCG@10': '0.0691', 'HR@20': '0.1567', 'NDCG@20': '0.0797'}
2025-02-19 21:56:41,896 - EarlyStopping counter: 2 out of 10
2025-02-19 21:57:18,538 - {'epoch': 15, 'rec_loss': '6.9238'}
2025-02-19 21:57:26,803 - {'Epoch': 15, 'HR@5': '0.0857', 'NDCG@5': '0.0601', 'HR@10': '0.1164', 'NDCG@10': '0.0700', 'HR@20': '0.1568', 'NDCG@20': '0.0802'}
2025-02-19 21:57:26,805 - EarlyStopping counter: 3 out of 10
2025-02-19 21:58:02,464 - {'epoch': 16, 'rec_loss': '6.9014'}
2025-02-19 21:58:10,614 - {'Epoch': 16, 'HR@5': '0.0849', 'NDCG@5': '0.0599', 'HR@10': '0.1172', 'NDCG@10': '0.0702', 'HR@20': '0.1581', 'NDCG@20': '0.0805'}
2025-02-19 21:58:10,615 - EarlyStopping counter: 4 out of 10
2025-02-19 21:58:46,917 - {'epoch': 17, 'rec_loss': '6.8859'}
2025-02-19 21:58:54,997 - {'Epoch': 17, 'HR@5': '0.0845', 'NDCG@5': '0.0598', 'HR@10': '0.1185', 'NDCG@10': '0.0707', 'HR@20': '0.1587', 'NDCG@20': '0.0809'}
2025-02-19 21:58:54,998 - EarlyStopping counter: 5 out of 10
2025-02-19 21:59:30,770 - {'epoch': 18, 'rec_loss': '6.8664'}
2025-02-19 21:59:38,980 - {'Epoch': 18, 'HR@5': '0.0857', 'NDCG@5': '0.0609', 'HR@10': '0.1189', 'NDCG@10': '0.0715', 'HR@20': '0.1596', 'NDCG@20': '0.0818'}
2025-02-19 21:59:38,981 - Validation score increased.  Saving model ...
2025-02-19 22:00:17,039 - {'epoch': 19, 'rec_loss': '6.8493'}
2025-02-19 22:00:25,356 - {'Epoch': 19, 'HR@5': '0.0839', 'NDCG@5': '0.0604', 'HR@10': '0.1174', 'NDCG@10': '0.0712', 'HR@20': '0.1600', 'NDCG@20': '0.0820'}
2025-02-19 22:00:25,357 - Validation score increased.  Saving model ...
2025-02-19 22:01:01,136 - {'epoch': 20, 'rec_loss': '6.8327'}
2025-02-19 22:01:09,376 - {'Epoch': 20, 'HR@5': '0.0851', 'NDCG@5': '0.0608', 'HR@10': '0.1184', 'NDCG@10': '0.0714', 'HR@20': '0.1616', 'NDCG@20': '0.0824'}
2025-02-19 22:01:09,377 - Validation score increased.  Saving model ...
2025-02-19 22:01:46,391 - {'epoch': 21, 'rec_loss': '6.8205'}
2025-02-19 22:01:54,481 - {'Epoch': 21, 'HR@5': '0.0861', 'NDCG@5': '0.0612', 'HR@10': '0.1182', 'NDCG@10': '0.0715', 'HR@20': '0.1603', 'NDCG@20': '0.0821'}
2025-02-19 22:01:54,482 - EarlyStopping counter: 1 out of 10
2025-02-19 22:02:29,281 - {'epoch': 22, 'rec_loss': '6.8067'}
2025-02-19 22:02:37,358 - {'Epoch': 22, 'HR@5': '0.0850', 'NDCG@5': '0.0607', 'HR@10': '0.1188', 'NDCG@10': '0.0716', 'HR@20': '0.1608', 'NDCG@20': '0.0821'}
2025-02-19 22:02:37,359 - EarlyStopping counter: 2 out of 10
2025-02-19 22:03:10,521 - {'epoch': 23, 'rec_loss': '6.7934'}
2025-02-19 22:03:18,854 - {'Epoch': 23, 'HR@5': '0.0852', 'NDCG@5': '0.0603', 'HR@10': '0.1193', 'NDCG@10': '0.0713', 'HR@20': '0.1595', 'NDCG@20': '0.0814'}
2025-02-19 22:03:18,855 - EarlyStopping counter: 3 out of 10
2025-02-19 22:03:55,052 - {'epoch': 24, 'rec_loss': '6.7767'}
2025-02-19 22:04:03,467 - {'Epoch': 24, 'HR@5': '0.0864', 'NDCG@5': '0.0609', 'HR@10': '0.1203', 'NDCG@10': '0.0717', 'HR@20': '0.1628', 'NDCG@20': '0.0824'}
2025-02-19 22:04:03,468 - Validation score increased.  Saving model ...
2025-02-19 22:04:40,053 - {'epoch': 25, 'rec_loss': '6.7654'}
2025-02-19 22:04:48,247 - {'Epoch': 25, 'HR@5': '0.0859', 'NDCG@5': '0.0608', 'HR@10': '0.1203', 'NDCG@10': '0.0719', 'HR@20': '0.1617', 'NDCG@20': '0.0823'}
2025-02-19 22:04:48,248 - EarlyStopping counter: 1 out of 10
2025-02-19 22:05:23,090 - {'epoch': 26, 'rec_loss': '6.7606'}
2025-02-19 22:05:31,211 - {'Epoch': 26, 'HR@5': '0.0868', 'NDCG@5': '0.0620', 'HR@10': '0.1185', 'NDCG@10': '0.0723', 'HR@20': '0.1620', 'NDCG@20': '0.0832'}
2025-02-19 22:05:31,213 - Validation score increased.  Saving model ...
2025-02-19 22:06:04,544 - {'epoch': 27, 'rec_loss': '6.7417'}
2025-02-19 22:06:12,856 - {'Epoch': 27, 'HR@5': '0.0876', 'NDCG@5': '0.0611', 'HR@10': '0.1194', 'NDCG@10': '0.0713', 'HR@20': '0.1611', 'NDCG@20': '0.0818'}
2025-02-19 22:06:12,857 - EarlyStopping counter: 1 out of 10
2025-02-19 22:06:49,581 - {'epoch': 28, 'rec_loss': '6.7352'}
2025-02-19 22:06:57,887 - {'Epoch': 28, 'HR@5': '0.0851', 'NDCG@5': '0.0603', 'HR@10': '0.1197', 'NDCG@10': '0.0714', 'HR@20': '0.1619', 'NDCG@20': '0.0821'}
2025-02-19 22:06:57,888 - EarlyStopping counter: 2 out of 10
2025-02-19 22:07:31,754 - {'epoch': 29, 'rec_loss': '6.7235'}
2025-02-19 22:07:39,981 - {'Epoch': 29, 'HR@5': '0.0868', 'NDCG@5': '0.0616', 'HR@10': '0.1201', 'NDCG@10': '0.0723', 'HR@20': '0.1638', 'NDCG@20': '0.0833'}
2025-02-19 22:07:39,982 - Validation score increased.  Saving model ...
2025-02-19 22:08:15,281 - {'epoch': 30, 'rec_loss': '6.7181'}
2025-02-19 22:08:23,423 - {'Epoch': 30, 'HR@5': '0.0858', 'NDCG@5': '0.0606', 'HR@10': '0.1192', 'NDCG@10': '0.0714', 'HR@20': '0.1607', 'NDCG@20': '0.0819'}
2025-02-19 22:08:23,424 - EarlyStopping counter: 1 out of 10
2025-02-19 22:08:58,941 - {'epoch': 31, 'rec_loss': '6.7089'}
2025-02-19 22:09:07,058 - {'Epoch': 31, 'HR@5': '0.0873', 'NDCG@5': '0.0618', 'HR@10': '0.1185', 'NDCG@10': '0.0718', 'HR@20': '0.1615', 'NDCG@20': '0.0827'}
2025-02-19 22:09:07,059 - EarlyStopping counter: 2 out of 10
2025-02-19 22:09:42,359 - {'epoch': 32, 'rec_loss': '6.6976'}
2025-02-19 22:09:50,450 - {'Epoch': 32, 'HR@5': '0.0861', 'NDCG@5': '0.0605', 'HR@10': '0.1193', 'NDCG@10': '0.0712', 'HR@20': '0.1629', 'NDCG@20': '0.0822'}
2025-02-19 22:09:50,451 - EarlyStopping counter: 3 out of 10
2025-02-19 22:10:25,930 - {'epoch': 33, 'rec_loss': '6.6933'}
2025-02-19 22:10:34,547 - {'Epoch': 33, 'HR@5': '0.0859', 'NDCG@5': '0.0609', 'HR@10': '0.1182', 'NDCG@10': '0.0714', 'HR@20': '0.1601', 'NDCG@20': '0.0819'}
2025-02-19 22:10:34,548 - EarlyStopping counter: 4 out of 10
2025-02-19 22:11:10,618 - {'epoch': 34, 'rec_loss': '6.6856'}
2025-02-19 22:11:18,806 - {'Epoch': 34, 'HR@5': '0.0892', 'NDCG@5': '0.0623', 'HR@10': '0.1213', 'NDCG@10': '0.0726', 'HR@20': '0.1634', 'NDCG@20': '0.0832'}
2025-02-19 22:11:18,807 - EarlyStopping counter: 5 out of 10
2025-02-19 22:11:52,558 - {'epoch': 35, 'rec_loss': '6.6710'}
2025-02-19 22:12:00,745 - {'Epoch': 35, 'HR@5': '0.0871', 'NDCG@5': '0.0617', 'HR@10': '0.1214', 'NDCG@10': '0.0727', 'HR@20': '0.1623', 'NDCG@20': '0.0831'}
2025-02-19 22:12:00,747 - EarlyStopping counter: 6 out of 10
2025-02-19 22:12:37,477 - {'epoch': 36, 'rec_loss': '6.6686'}
2025-02-19 22:12:45,742 - {'Epoch': 36, 'HR@5': '0.0865', 'NDCG@5': '0.0609', 'HR@10': '0.1204', 'NDCG@10': '0.0718', 'HR@20': '0.1607', 'NDCG@20': '0.0820'}
2025-02-19 22:12:45,743 - EarlyStopping counter: 7 out of 10
2025-02-19 22:13:21,203 - {'epoch': 37, 'rec_loss': '6.6590'}
2025-02-19 22:13:29,390 - {'Epoch': 37, 'HR@5': '0.0867', 'NDCG@5': '0.0610', 'HR@10': '0.1217', 'NDCG@10': '0.0722', 'HR@20': '0.1622', 'NDCG@20': '0.0825'}
2025-02-19 22:13:29,391 - EarlyStopping counter: 8 out of 10
2025-02-19 22:14:03,051 - {'epoch': 38, 'rec_loss': '6.6508'}
2025-02-19 22:14:11,394 - {'Epoch': 38, 'HR@5': '0.0871', 'NDCG@5': '0.0612', 'HR@10': '0.1214', 'NDCG@10': '0.0722', 'HR@20': '0.1639', 'NDCG@20': '0.0830'}
2025-02-19 22:14:11,396 - EarlyStopping counter: 9 out of 10
2025-02-19 22:14:47,698 - {'epoch': 39, 'rec_loss': '6.6447'}
2025-02-19 22:14:55,935 - {'Epoch': 39, 'HR@5': '0.0881', 'NDCG@5': '0.0620', 'HR@10': '0.1219', 'NDCG@10': '0.0728', 'HR@20': '0.1635', 'NDCG@20': '0.0833'}
2025-02-19 22:14:55,937 - Validation score increased.  Saving model ...
2025-02-19 22:15:32,426 - {'epoch': 40, 'rec_loss': '6.6354'}
2025-02-19 22:15:41,364 - {'Epoch': 40, 'HR@5': '0.0875', 'NDCG@5': '0.0614', 'HR@10': '0.1211', 'NDCG@10': '0.0723', 'HR@20': '0.1632', 'NDCG@20': '0.0829'}
2025-02-19 22:15:41,366 - EarlyStopping counter: 1 out of 10
2025-02-19 22:16:14,431 - {'epoch': 41, 'rec_loss': '6.6309'}
2025-02-19 22:16:22,590 - {'Epoch': 41, 'HR@5': '0.0871', 'NDCG@5': '0.0611', 'HR@10': '0.1205', 'NDCG@10': '0.0719', 'HR@20': '0.1629', 'NDCG@20': '0.0826'}
2025-02-19 22:16:22,591 - EarlyStopping counter: 2 out of 10
2025-02-19 22:16:58,010 - {'epoch': 42, 'rec_loss': '6.6292'}
2025-02-19 22:17:06,202 - {'Epoch': 42, 'HR@5': '0.0879', 'NDCG@5': '0.0616', 'HR@10': '0.1215', 'NDCG@10': '0.0725', 'HR@20': '0.1640', 'NDCG@20': '0.0831'}
2025-02-19 22:17:06,204 - EarlyStopping counter: 3 out of 10
2025-02-19 22:17:40,955 - {'epoch': 43, 'rec_loss': '6.6225'}
2025-02-19 22:17:49,126 - {'Epoch': 43, 'HR@5': '0.0888', 'NDCG@5': '0.0622', 'HR@10': '0.1207', 'NDCG@10': '0.0725', 'HR@20': '0.1635', 'NDCG@20': '0.0832'}
2025-02-19 22:17:49,127 - EarlyStopping counter: 4 out of 10
2025-02-19 22:18:26,162 - {'epoch': 44, 'rec_loss': '6.6178'}
2025-02-19 22:18:34,614 - {'Epoch': 44, 'HR@5': '0.0866', 'NDCG@5': '0.0614', 'HR@10': '0.1211', 'NDCG@10': '0.0725', 'HR@20': '0.1641', 'NDCG@20': '0.0834'}
2025-02-19 22:18:34,615 - Validation score increased.  Saving model ...
2025-02-19 22:19:10,969 - {'epoch': 45, 'rec_loss': '6.6115'}
2025-02-19 22:19:19,814 - {'Epoch': 45, 'HR@5': '0.0881', 'NDCG@5': '0.0621', 'HR@10': '0.1214', 'NDCG@10': '0.0728', 'HR@20': '0.1634', 'NDCG@20': '0.0834'}
2025-02-19 22:19:19,816 - Validation score increased.  Saving model ...
2025-02-19 22:19:55,889 - {'epoch': 46, 'rec_loss': '6.6046'}
2025-02-19 22:20:04,211 - {'Epoch': 46, 'HR@5': '0.0864', 'NDCG@5': '0.0611', 'HR@10': '0.1198', 'NDCG@10': '0.0719', 'HR@20': '0.1631', 'NDCG@20': '0.0828'}
2025-02-19 22:20:04,213 - EarlyStopping counter: 1 out of 10
2025-02-19 22:20:38,209 - {'epoch': 47, 'rec_loss': '6.6023'}
2025-02-19 22:20:46,763 - {'Epoch': 47, 'HR@5': '0.0856', 'NDCG@5': '0.0607', 'HR@10': '0.1218', 'NDCG@10': '0.0724', 'HR@20': '0.1638', 'NDCG@20': '0.0830'}
2025-02-19 22:20:46,764 - EarlyStopping counter: 2 out of 10
2025-02-19 22:21:22,088 - {'epoch': 48, 'rec_loss': '6.5933'}
2025-02-19 22:21:30,279 - {'Epoch': 48, 'HR@5': '0.0877', 'NDCG@5': '0.0609', 'HR@10': '0.1221', 'NDCG@10': '0.0720', 'HR@20': '0.1643', 'NDCG@20': '0.0827'}
2025-02-19 22:21:30,280 - EarlyStopping counter: 3 out of 10
2025-02-19 22:22:05,254 - {'epoch': 49, 'rec_loss': '6.5859'}
2025-02-19 22:22:13,466 - {'Epoch': 49, 'HR@5': '0.0869', 'NDCG@5': '0.0619', 'HR@10': '0.1209', 'NDCG@10': '0.0729', 'HR@20': '0.1617', 'NDCG@20': '0.0832'}
2025-02-19 22:22:13,467 - EarlyStopping counter: 4 out of 10
2025-02-19 22:22:50,051 - {'epoch': 50, 'rec_loss': '6.5835'}
2025-02-19 22:22:58,396 - {'Epoch': 50, 'HR@5': '0.0888', 'NDCG@5': '0.0620', 'HR@10': '0.1235', 'NDCG@10': '0.0731', 'HR@20': '0.1640', 'NDCG@20': '0.0833'}
2025-02-19 22:22:58,398 - EarlyStopping counter: 5 out of 10
2025-02-19 22:23:37,071 - {'epoch': 51, 'rec_loss': '6.5803'}
2025-02-19 22:23:46,027 - {'Epoch': 51, 'HR@5': '0.0865', 'NDCG@5': '0.0607', 'HR@10': '0.1204', 'NDCG@10': '0.0717', 'HR@20': '0.1621', 'NDCG@20': '0.0822'}
2025-02-19 22:23:46,029 - EarlyStopping counter: 6 out of 10
2025-02-19 22:24:19,090 - {'epoch': 52, 'rec_loss': '6.5683'}
2025-02-19 22:24:27,344 - {'Epoch': 52, 'HR@5': '0.0881', 'NDCG@5': '0.0625', 'HR@10': '0.1223', 'NDCG@10': '0.0736', 'HR@20': '0.1643', 'NDCG@20': '0.0842'}
2025-02-19 22:24:27,345 - Validation score increased.  Saving model ...
2025-02-19 22:25:01,156 - {'epoch': 53, 'rec_loss': '6.5685'}
2025-02-19 22:25:09,356 - {'Epoch': 53, 'HR@5': '0.0881', 'NDCG@5': '0.0627', 'HR@10': '0.1233', 'NDCG@10': '0.0740', 'HR@20': '0.1637', 'NDCG@20': '0.0842'}
2025-02-19 22:25:09,357 - Validation score increased.  Saving model ...
2025-02-19 22:25:43,691 - {'epoch': 54, 'rec_loss': '6.5602'}
2025-02-19 22:25:51,944 - {'Epoch': 54, 'HR@5': '0.0884', 'NDCG@5': '0.0621', 'HR@10': '0.1225', 'NDCG@10': '0.0730', 'HR@20': '0.1635', 'NDCG@20': '0.0833'}
2025-02-19 22:25:51,946 - EarlyStopping counter: 1 out of 10
2025-02-19 22:26:27,902 - {'epoch': 55, 'rec_loss': '6.5571'}
2025-02-19 22:26:36,175 - {'Epoch': 55, 'HR@5': '0.0891', 'NDCG@5': '0.0629', 'HR@10': '0.1223', 'NDCG@10': '0.0736', 'HR@20': '0.1632', 'NDCG@20': '0.0839'}
2025-02-19 22:26:36,176 - EarlyStopping counter: 2 out of 10
2025-02-19 22:27:11,825 - {'epoch': 56, 'rec_loss': '6.5516'}
2025-02-19 22:27:20,137 - {'Epoch': 56, 'HR@5': '0.0883', 'NDCG@5': '0.0621', 'HR@10': '0.1220', 'NDCG@10': '0.0730', 'HR@20': '0.1647', 'NDCG@20': '0.0837'}
2025-02-19 22:27:20,138 - EarlyStopping counter: 3 out of 10
2025-02-19 22:27:55,723 - {'epoch': 57, 'rec_loss': '6.5479'}
2025-02-19 22:28:03,876 - {'Epoch': 57, 'HR@5': '0.0882', 'NDCG@5': '0.0617', 'HR@10': '0.1216', 'NDCG@10': '0.0725', 'HR@20': '0.1625', 'NDCG@20': '0.0828'}
2025-02-19 22:28:03,877 - EarlyStopping counter: 4 out of 10
2025-02-19 22:28:43,933 - {'epoch': 58, 'rec_loss': '6.5453'}
2025-02-19 22:28:52,963 - {'Epoch': 58, 'HR@5': '0.0877', 'NDCG@5': '0.0620', 'HR@10': '0.1198', 'NDCG@10': '0.0723', 'HR@20': '0.1616', 'NDCG@20': '0.0829'}
2025-02-19 22:28:52,964 - EarlyStopping counter: 5 out of 10
2025-02-19 22:29:30,375 - {'epoch': 59, 'rec_loss': '6.5468'}
2025-02-19 22:29:38,780 - {'Epoch': 59, 'HR@5': '0.0870', 'NDCG@5': '0.0619', 'HR@10': '0.1211', 'NDCG@10': '0.0729', 'HR@20': '0.1630', 'NDCG@20': '0.0834'}
2025-02-19 22:29:38,782 - EarlyStopping counter: 6 out of 10
2025-02-19 22:30:15,300 - {'epoch': 60, 'rec_loss': '6.5412'}
2025-02-19 22:30:23,517 - {'Epoch': 60, 'HR@5': '0.0855', 'NDCG@5': '0.0604', 'HR@10': '0.1205', 'NDCG@10': '0.0717', 'HR@20': '0.1635', 'NDCG@20': '0.0825'}
2025-02-19 22:30:23,519 - EarlyStopping counter: 7 out of 10
2025-02-19 22:30:57,418 - {'epoch': 61, 'rec_loss': '6.5298'}
2025-02-19 22:31:05,631 - {'Epoch': 61, 'HR@5': '0.0878', 'NDCG@5': '0.0623', 'HR@10': '0.1222', 'NDCG@10': '0.0734', 'HR@20': '0.1633', 'NDCG@20': '0.0838'}
2025-02-19 22:31:05,632 - EarlyStopping counter: 8 out of 10
2025-02-19 22:31:41,966 - {'epoch': 62, 'rec_loss': '6.5267'}
2025-02-19 22:31:50,247 - {'Epoch': 62, 'HR@5': '0.0871', 'NDCG@5': '0.0618', 'HR@10': '0.1219', 'NDCG@10': '0.0731', 'HR@20': '0.1622', 'NDCG@20': '0.0832'}
2025-02-19 22:31:50,249 - EarlyStopping counter: 9 out of 10
2025-02-19 22:32:25,656 - {'epoch': 63, 'rec_loss': '6.5246'}
2025-02-19 22:32:33,963 - {'Epoch': 63, 'HR@5': '0.0880', 'NDCG@5': '0.0624', 'HR@10': '0.1230', 'NDCG@10': '0.0736', 'HR@20': '0.1629', 'NDCG@20': '0.0837'}
2025-02-19 22:32:33,964 - EarlyStopping counter: 10 out of 10
2025-02-19 22:32:33,964 - Early stopping
2025-02-19 22:32:33,964 - ---------------Test Score---------------
2025-02-19 22:32:42,278 - {'Epoch': 0, 'HR@5': '0.0715', 'NDCG@5': '0.0502', 'HR@10': '0.0999', 'NDCG@10': '0.0594', 'HR@20': '0.1365', 'NDCG@20': '0.0686'}
2025-02-19 22:32:42,280 - Scale_Beauty
2025-02-19 22:32:42,280 - {'Epoch': 0, 'HR@5': '0.0715', 'NDCG@5': '0.0502', 'HR@10': '0.0999', 'NDCG@10': '0.0594', 'HR@20': '0.1365', 'NDCG@20': '0.0686'}
2025-02-19 22:39:08,896 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25, 10, 5], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-19 22:39:11,660 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-19 22:39:11,664 - Total Parameters: 928145
2025-02-19 22:40:00,229 - {'epoch': 0, 'rec_loss': '8.8182'}
2025-02-19 22:40:08,918 - {'Epoch': 0, 'HR@5': '0.0257', 'NDCG@5': '0.0165', 'HR@10': '0.0393', 'NDCG@10': '0.0209', 'HR@20': '0.0583', 'NDCG@20': '0.0256'}
2025-02-19 22:40:08,920 - Validation score increased.  Saving model ...
2025-02-19 22:40:54,726 - {'epoch': 1, 'rec_loss': '8.1900'}
2025-02-19 22:41:03,098 - {'Epoch': 1, 'HR@5': '0.0457', 'NDCG@5': '0.0307', 'HR@10': '0.0671', 'NDCG@10': '0.0376', 'HR@20': '0.0953', 'NDCG@20': '0.0447'}
2025-02-19 22:41:03,100 - Validation score increased.  Saving model ...
2025-02-19 22:41:43,601 - {'epoch': 2, 'rec_loss': '7.8649'}
2025-02-19 22:41:52,494 - {'Epoch': 2, 'HR@5': '0.0605', 'NDCG@5': '0.0415', 'HR@10': '0.0871', 'NDCG@10': '0.0501', 'HR@20': '0.1203', 'NDCG@20': '0.0584'}
2025-02-19 22:41:52,495 - Validation score increased.  Saving model ...
2025-02-19 22:42:34,529 - {'epoch': 3, 'rec_loss': '7.6342'}
2025-02-19 22:42:43,213 - {'Epoch': 3, 'HR@5': '0.0699', 'NDCG@5': '0.0487', 'HR@10': '0.0973', 'NDCG@10': '0.0575', 'HR@20': '0.1333', 'NDCG@20': '0.0665'}
2025-02-19 22:42:43,215 - Validation score increased.  Saving model ...
2025-02-19 22:43:26,350 - {'epoch': 4, 'rec_loss': '7.4650'}
2025-02-19 22:43:34,525 - {'Epoch': 4, 'HR@5': '0.0745', 'NDCG@5': '0.0522', 'HR@10': '0.1045', 'NDCG@10': '0.0618', 'HR@20': '0.1421', 'NDCG@20': '0.0712'}
2025-02-19 22:43:34,527 - Validation score increased.  Saving model ...
2025-02-19 22:44:15,046 - {'epoch': 5, 'rec_loss': '7.3350'}
2025-02-19 22:44:23,432 - {'Epoch': 5, 'HR@5': '0.0779', 'NDCG@5': '0.0550', 'HR@10': '0.1075', 'NDCG@10': '0.0645', 'HR@20': '0.1461', 'NDCG@20': '0.0742'}
2025-02-19 22:44:23,434 - Validation score increased.  Saving model ...
2025-02-19 22:45:03,753 - {'epoch': 6, 'rec_loss': '7.2399'}
2025-02-19 22:45:12,375 - {'Epoch': 6, 'HR@5': '0.0792', 'NDCG@5': '0.0554', 'HR@10': '0.1102', 'NDCG@10': '0.0654', 'HR@20': '0.1472', 'NDCG@20': '0.0746'}
2025-02-19 22:45:12,376 - Validation score increased.  Saving model ...
2025-02-19 22:45:54,674 - {'epoch': 7, 'rec_loss': '7.1652'}
2025-02-19 22:46:03,354 - {'Epoch': 7, 'HR@5': '0.0825', 'NDCG@5': '0.0576', 'HR@10': '0.1130', 'NDCG@10': '0.0674', 'HR@20': '0.1527', 'NDCG@20': '0.0774'}
2025-02-19 22:46:03,356 - Validation score increased.  Saving model ...
2025-02-19 22:46:48,153 - {'epoch': 8, 'rec_loss': '7.1099'}
2025-02-19 22:46:56,591 - {'Epoch': 8, 'HR@5': '0.0825', 'NDCG@5': '0.0584', 'HR@10': '0.1141', 'NDCG@10': '0.0685', 'HR@20': '0.1549', 'NDCG@20': '0.0788'}
2025-02-19 22:46:56,593 - Validation score increased.  Saving model ...
2025-02-19 22:47:38,410 - {'epoch': 9, 'rec_loss': '7.0578'}
2025-02-19 22:47:47,045 - {'Epoch': 9, 'HR@5': '0.0824', 'NDCG@5': '0.0580', 'HR@10': '0.1153', 'NDCG@10': '0.0685', 'HR@20': '0.1560', 'NDCG@20': '0.0788'}
2025-02-19 22:47:47,047 - EarlyStopping counter: 1 out of 10
2025-02-19 22:48:29,273 - {'epoch': 10, 'rec_loss': '7.0124'}
2025-02-19 22:48:37,729 - {'Epoch': 10, 'HR@5': '0.0833', 'NDCG@5': '0.0590', 'HR@10': '0.1150', 'NDCG@10': '0.0692', 'HR@20': '0.1550', 'NDCG@20': '0.0792'}
2025-02-19 22:48:37,730 - Validation score increased.  Saving model ...
2025-02-19 22:49:20,136 - {'epoch': 11, 'rec_loss': '6.9790'}
2025-02-19 22:49:28,353 - {'Epoch': 11, 'HR@5': '0.0851', 'NDCG@5': '0.0597', 'HR@10': '0.1156', 'NDCG@10': '0.0695', 'HR@20': '0.1569', 'NDCG@20': '0.0799'}
2025-02-19 22:49:28,354 - Validation score increased.  Saving model ...
2025-02-19 22:50:11,491 - {'epoch': 12, 'rec_loss': '6.9496'}
2025-02-19 22:50:20,010 - {'Epoch': 12, 'HR@5': '0.0846', 'NDCG@5': '0.0598', 'HR@10': '0.1164', 'NDCG@10': '0.0700', 'HR@20': '0.1581', 'NDCG@20': '0.0805'}
2025-02-19 22:50:20,012 - Validation score increased.  Saving model ...
2025-02-19 22:51:01,056 - {'epoch': 13, 'rec_loss': '6.9205'}
2025-02-19 22:51:09,506 - {'Epoch': 13, 'HR@5': '0.0840', 'NDCG@5': '0.0590', 'HR@10': '0.1156', 'NDCG@10': '0.0691', 'HR@20': '0.1568', 'NDCG@20': '0.0795'}
2025-02-19 22:51:09,508 - EarlyStopping counter: 1 out of 10
2025-02-19 22:51:55,550 - {'epoch': 14, 'rec_loss': '6.8944'}
2025-02-19 22:52:03,942 - {'Epoch': 14, 'HR@5': '0.0834', 'NDCG@5': '0.0590', 'HR@10': '0.1160', 'NDCG@10': '0.0695', 'HR@20': '0.1597', 'NDCG@20': '0.0804'}
2025-02-19 22:52:03,944 - EarlyStopping counter: 2 out of 10
2025-02-19 22:52:45,993 - {'epoch': 15, 'rec_loss': '6.8734'}
2025-02-19 22:52:54,749 - {'Epoch': 15, 'HR@5': '0.0836', 'NDCG@5': '0.0590', 'HR@10': '0.1164', 'NDCG@10': '0.0696', 'HR@20': '0.1576', 'NDCG@20': '0.0800'}
2025-02-19 22:52:54,750 - EarlyStopping counter: 3 out of 10
2025-02-19 22:53:39,563 - {'epoch': 16, 'rec_loss': '6.8506'}
2025-02-19 22:53:48,139 - {'Epoch': 16, 'HR@5': '0.0860', 'NDCG@5': '0.0609', 'HR@10': '0.1180', 'NDCG@10': '0.0712', 'HR@20': '0.1596', 'NDCG@20': '0.0817'}
2025-02-19 22:53:48,140 - Validation score increased.  Saving model ...
2025-02-19 22:54:29,796 - {'epoch': 17, 'rec_loss': '6.8342'}
2025-02-19 22:54:38,648 - {'Epoch': 17, 'HR@5': '0.0845', 'NDCG@5': '0.0597', 'HR@10': '0.1176', 'NDCG@10': '0.0703', 'HR@20': '0.1596', 'NDCG@20': '0.0810'}
2025-02-19 22:54:38,649 - EarlyStopping counter: 1 out of 10
2025-02-19 22:55:23,303 - {'epoch': 18, 'rec_loss': '6.8179'}
2025-02-19 22:55:31,788 - {'Epoch': 18, 'HR@5': '0.0858', 'NDCG@5': '0.0606', 'HR@10': '0.1176', 'NDCG@10': '0.0708', 'HR@20': '0.1616', 'NDCG@20': '0.0818'}
2025-02-19 22:55:31,790 - Validation score increased.  Saving model ...
2025-02-19 22:56:15,895 - {'epoch': 19, 'rec_loss': '6.7928'}
2025-02-19 22:56:24,349 - {'Epoch': 19, 'HR@5': '0.0855', 'NDCG@5': '0.0610', 'HR@10': '0.1196', 'NDCG@10': '0.0720', 'HR@20': '0.1625', 'NDCG@20': '0.0828'}
2025-02-19 22:56:24,353 - Validation score increased.  Saving model ...
2025-02-19 22:57:08,953 - {'epoch': 20, 'rec_loss': '6.7791'}
2025-02-19 22:57:17,727 - {'Epoch': 20, 'HR@5': '0.0858', 'NDCG@5': '0.0602', 'HR@10': '0.1169', 'NDCG@10': '0.0702', 'HR@20': '0.1600', 'NDCG@20': '0.0810'}
2025-02-19 22:57:17,729 - EarlyStopping counter: 1 out of 10
2025-02-19 22:58:05,352 - {'epoch': 21, 'rec_loss': '6.7651'}
2025-02-19 22:58:14,052 - {'Epoch': 21, 'HR@5': '0.0858', 'NDCG@5': '0.0596', 'HR@10': '0.1190', 'NDCG@10': '0.0704', 'HR@20': '0.1610', 'NDCG@20': '0.0809'}
2025-02-19 22:58:14,054 - EarlyStopping counter: 2 out of 10
2025-02-19 22:58:59,329 - {'epoch': 22, 'rec_loss': '6.7564'}
2025-02-19 22:59:07,880 - {'Epoch': 22, 'HR@5': '0.0839', 'NDCG@5': '0.0592', 'HR@10': '0.1172', 'NDCG@10': '0.0699', 'HR@20': '0.1581', 'NDCG@20': '0.0802'}
2025-02-19 22:59:07,882 - EarlyStopping counter: 3 out of 10
2025-02-19 22:59:55,928 - {'epoch': 23, 'rec_loss': '6.7396'}
2025-02-19 23:00:04,284 - {'Epoch': 23, 'HR@5': '0.0845', 'NDCG@5': '0.0594', 'HR@10': '0.1169', 'NDCG@10': '0.0699', 'HR@20': '0.1594', 'NDCG@20': '0.0806'}
2025-02-19 23:00:04,285 - EarlyStopping counter: 4 out of 10
2025-02-19 23:00:46,182 - {'epoch': 24, 'rec_loss': '6.7299'}
2025-02-19 23:00:54,749 - {'Epoch': 24, 'HR@5': '0.0858', 'NDCG@5': '0.0603', 'HR@10': '0.1172', 'NDCG@10': '0.0704', 'HR@20': '0.1590', 'NDCG@20': '0.0809'}
2025-02-19 23:00:54,750 - EarlyStopping counter: 5 out of 10
2025-02-19 23:01:36,825 - {'epoch': 25, 'rec_loss': '6.7149'}
2025-02-19 23:01:45,501 - {'Epoch': 25, 'HR@5': '0.0857', 'NDCG@5': '0.0601', 'HR@10': '0.1196', 'NDCG@10': '0.0710', 'HR@20': '0.1601', 'NDCG@20': '0.0812'}
2025-02-19 23:01:45,505 - EarlyStopping counter: 6 out of 10
2025-02-19 23:02:29,651 - {'epoch': 26, 'rec_loss': '6.7034'}
2025-02-19 23:02:38,260 - {'Epoch': 26, 'HR@5': '0.0841', 'NDCG@5': '0.0588', 'HR@10': '0.1185', 'NDCG@10': '0.0699', 'HR@20': '0.1617', 'NDCG@20': '0.0808'}
2025-02-19 23:02:38,261 - EarlyStopping counter: 7 out of 10
2025-02-19 23:03:21,642 - {'epoch': 27, 'rec_loss': '6.6911'}
2025-02-19 23:03:30,306 - {'Epoch': 27, 'HR@5': '0.0855', 'NDCG@5': '0.0608', 'HR@10': '0.1188', 'NDCG@10': '0.0715', 'HR@20': '0.1614', 'NDCG@20': '0.0822'}
2025-02-19 23:03:30,307 - EarlyStopping counter: 8 out of 10
2025-02-19 23:04:13,858 - {'epoch': 28, 'rec_loss': '6.6868'}
2025-02-19 23:04:22,506 - {'Epoch': 28, 'HR@5': '0.0859', 'NDCG@5': '0.0604', 'HR@10': '0.1188', 'NDCG@10': '0.0710', 'HR@20': '0.1594', 'NDCG@20': '0.0812'}
2025-02-19 23:04:22,507 - EarlyStopping counter: 9 out of 10
2025-02-19 23:05:04,286 - {'epoch': 29, 'rec_loss': '6.6711'}
2025-02-19 23:05:13,301 - {'Epoch': 29, 'HR@5': '0.0843', 'NDCG@5': '0.0589', 'HR@10': '0.1180', 'NDCG@10': '0.0698', 'HR@20': '0.1593', 'NDCG@20': '0.0803'}
2025-02-19 23:05:13,303 - EarlyStopping counter: 10 out of 10
2025-02-19 23:05:13,303 - Early stopping
2025-02-19 23:05:13,303 - ---------------Test Score---------------
2025-02-19 23:05:21,854 - {'Epoch': 0, 'HR@5': '0.0715', 'NDCG@5': '0.0508', 'HR@10': '0.1002', 'NDCG@10': '0.0601', 'HR@20': '0.1363', 'NDCG@20': '0.0691'}
2025-02-19 23:05:21,855 - Scale_Beauty
2025-02-19 23:05:21,855 - {'Epoch': 0, 'HR@5': '0.0715', 'NDCG@5': '0.0508', 'HR@10': '0.1002', 'NDCG@10': '0.0601', 'HR@20': '0.1363', 'NDCG@20': '0.0691'}
2025-02-20 10:36:20,004 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 5], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-20 10:36:22,788 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-20 10:36:22,794 - Total Parameters: 928145
2025-02-20 10:36:53,118 - {'epoch': 0, 'rec_loss': '8.8414'}
2025-02-20 10:37:01,222 - {'Epoch': 0, 'HR@5': '0.0199', 'NDCG@5': '0.0127', 'HR@10': '0.0309', 'NDCG@10': '0.0163', 'HR@20': '0.0487', 'NDCG@20': '0.0208'}
2025-02-20 10:37:01,223 - Validation score increased.  Saving model ...
2025-02-20 10:37:30,441 - {'epoch': 1, 'rec_loss': '8.3087'}
2025-02-20 10:37:38,369 - {'Epoch': 1, 'HR@5': '0.0377', 'NDCG@5': '0.0252', 'HR@10': '0.0568', 'NDCG@10': '0.0314', 'HR@20': '0.0814', 'NDCG@20': '0.0376'}
2025-02-20 10:37:38,370 - Validation score increased.  Saving model ...
2025-02-20 10:38:04,977 - {'epoch': 2, 'rec_loss': '7.9954'}
2025-02-20 10:38:12,821 - {'Epoch': 2, 'HR@5': '0.0511', 'NDCG@5': '0.0344', 'HR@10': '0.0750', 'NDCG@10': '0.0422', 'HR@20': '0.1079', 'NDCG@20': '0.0505'}
2025-02-20 10:38:12,822 - Validation score increased.  Saving model ...
2025-02-20 10:38:39,907 - {'epoch': 3, 'rec_loss': '7.7752'}
2025-02-20 10:38:47,478 - {'Epoch': 3, 'HR@5': '0.0609', 'NDCG@5': '0.0420', 'HR@10': '0.0889', 'NDCG@10': '0.0510', 'HR@20': '0.1243', 'NDCG@20': '0.0599'}
2025-02-20 10:38:47,483 - Validation score increased.  Saving model ...
2025-02-20 10:39:15,163 - {'epoch': 4, 'rec_loss': '7.6205'}
2025-02-20 10:39:22,522 - {'Epoch': 4, 'HR@5': '0.0697', 'NDCG@5': '0.0485', 'HR@10': '0.0986', 'NDCG@10': '0.0577', 'HR@20': '0.1370', 'NDCG@20': '0.0674'}
2025-02-20 10:39:22,523 - Validation score increased.  Saving model ...
2025-02-20 10:39:50,332 - {'epoch': 5, 'rec_loss': '7.5015'}
2025-02-20 10:39:57,918 - {'Epoch': 5, 'HR@5': '0.0726', 'NDCG@5': '0.0510', 'HR@10': '0.1023', 'NDCG@10': '0.0606', 'HR@20': '0.1398', 'NDCG@20': '0.0700'}
2025-02-20 10:39:57,919 - Validation score increased.  Saving model ...
2025-02-20 10:40:25,622 - {'epoch': 6, 'rec_loss': '7.4142'}
2025-02-20 10:40:33,087 - {'Epoch': 6, 'HR@5': '0.0764', 'NDCG@5': '0.0534', 'HR@10': '0.1061', 'NDCG@10': '0.0629', 'HR@20': '0.1472', 'NDCG@20': '0.0733'}
2025-02-20 10:40:33,091 - Validation score increased.  Saving model ...
2025-02-20 10:41:00,914 - {'epoch': 7, 'rec_loss': '7.3374'}
2025-02-20 10:41:08,410 - {'Epoch': 7, 'HR@5': '0.0787', 'NDCG@5': '0.0555', 'HR@10': '0.1084', 'NDCG@10': '0.0651', 'HR@20': '0.1490', 'NDCG@20': '0.0753'}
2025-02-20 10:41:08,411 - Validation score increased.  Saving model ...
2025-02-20 10:41:34,118 - {'epoch': 8, 'rec_loss': '7.2714'}
2025-02-20 10:41:41,954 - {'Epoch': 8, 'HR@5': '0.0801', 'NDCG@5': '0.0568', 'HR@10': '0.1098', 'NDCG@10': '0.0664', 'HR@20': '0.1527', 'NDCG@20': '0.0772'}
2025-02-20 10:41:41,959 - Validation score increased.  Saving model ...
2025-02-20 10:42:08,350 - {'epoch': 9, 'rec_loss': '7.2217'}
2025-02-20 10:42:15,910 - {'Epoch': 9, 'HR@5': '0.0802', 'NDCG@5': '0.0563', 'HR@10': '0.1111', 'NDCG@10': '0.0663', 'HR@20': '0.1536', 'NDCG@20': '0.0770'}
2025-02-20 10:42:15,911 - EarlyStopping counter: 1 out of 10
2025-02-20 10:42:43,504 - {'epoch': 10, 'rec_loss': '7.1771'}
2025-02-20 10:42:51,211 - {'Epoch': 10, 'HR@5': '0.0824', 'NDCG@5': '0.0584', 'HR@10': '0.1148', 'NDCG@10': '0.0689', 'HR@20': '0.1565', 'NDCG@20': '0.0793'}
2025-02-20 10:42:51,212 - Validation score increased.  Saving model ...
2025-02-20 10:43:18,862 - {'epoch': 11, 'rec_loss': '7.1354'}
2025-02-20 10:43:26,427 - {'Epoch': 11, 'HR@5': '0.0824', 'NDCG@5': '0.0579', 'HR@10': '0.1157', 'NDCG@10': '0.0686', 'HR@20': '0.1573', 'NDCG@20': '0.0790'}
2025-02-20 10:43:26,432 - EarlyStopping counter: 1 out of 10
2025-02-20 10:43:54,294 - {'epoch': 12, 'rec_loss': '7.1006'}
2025-02-20 10:44:02,055 - {'Epoch': 12, 'HR@5': '0.0836', 'NDCG@5': '0.0588', 'HR@10': '0.1173', 'NDCG@10': '0.0696', 'HR@20': '0.1585', 'NDCG@20': '0.0800'}
2025-02-20 10:44:02,056 - Validation score increased.  Saving model ...
2025-02-20 10:44:29,805 - {'epoch': 13, 'rec_loss': '7.0736'}
2025-02-20 10:44:37,447 - {'Epoch': 13, 'HR@5': '0.0854', 'NDCG@5': '0.0601', 'HR@10': '0.1173', 'NDCG@10': '0.0705', 'HR@20': '0.1586', 'NDCG@20': '0.0808'}
2025-02-20 10:44:37,448 - Validation score increased.  Saving model ...
2025-02-20 10:45:04,125 - {'epoch': 14, 'rec_loss': '7.0446'}
2025-02-20 10:45:11,883 - {'Epoch': 14, 'HR@5': '0.0844', 'NDCG@5': '0.0592', 'HR@10': '0.1178', 'NDCG@10': '0.0700', 'HR@20': '0.1608', 'NDCG@20': '0.0808'}
2025-02-20 10:45:11,889 - EarlyStopping counter: 1 out of 10
2025-02-20 10:45:41,296 - {'epoch': 15, 'rec_loss': '7.0237'}
2025-02-20 10:45:49,071 - {'Epoch': 15, 'HR@5': '0.0855', 'NDCG@5': '0.0600', 'HR@10': '0.1168', 'NDCG@10': '0.0701', 'HR@20': '0.1590', 'NDCG@20': '0.0806'}
2025-02-20 10:45:49,072 - EarlyStopping counter: 2 out of 10
2025-02-20 10:46:18,336 - {'epoch': 16, 'rec_loss': '7.0042'}
2025-02-20 10:46:25,972 - {'Epoch': 16, 'HR@5': '0.0856', 'NDCG@5': '0.0605', 'HR@10': '0.1184', 'NDCG@10': '0.0710', 'HR@20': '0.1612', 'NDCG@20': '0.0818'}
2025-02-20 10:46:25,977 - Validation score increased.  Saving model ...
2025-02-20 10:46:54,818 - {'epoch': 17, 'rec_loss': '6.9866'}
2025-02-20 10:47:02,759 - {'Epoch': 17, 'HR@5': '0.0868', 'NDCG@5': '0.0613', 'HR@10': '0.1189', 'NDCG@10': '0.0717', 'HR@20': '0.1609', 'NDCG@20': '0.0822'}
2025-02-20 10:47:02,760 - Validation score increased.  Saving model ...
2025-02-20 10:47:30,734 - {'epoch': 18, 'rec_loss': '6.9586'}
2025-02-20 10:47:38,303 - {'Epoch': 18, 'HR@5': '0.0860', 'NDCG@5': '0.0604', 'HR@10': '0.1189', 'NDCG@10': '0.0710', 'HR@20': '0.1601', 'NDCG@20': '0.0814'}
2025-02-20 10:47:38,307 - EarlyStopping counter: 1 out of 10
2025-02-20 10:48:04,899 - {'epoch': 19, 'rec_loss': '6.9463'}
2025-02-20 10:48:12,596 - {'Epoch': 19, 'HR@5': '0.0853', 'NDCG@5': '0.0600', 'HR@10': '0.1196', 'NDCG@10': '0.0710', 'HR@20': '0.1624', 'NDCG@20': '0.0818'}
2025-02-20 10:48:12,602 - EarlyStopping counter: 2 out of 10
2025-02-20 10:48:40,504 - {'epoch': 20, 'rec_loss': '6.9306'}
2025-02-20 10:48:48,262 - {'Epoch': 20, 'HR@5': '0.0872', 'NDCG@5': '0.0619', 'HR@10': '0.1193', 'NDCG@10': '0.0722', 'HR@20': '0.1614', 'NDCG@20': '0.0828'}
2025-02-20 10:48:48,264 - Validation score increased.  Saving model ...
2025-02-20 10:49:15,174 - {'epoch': 21, 'rec_loss': '6.9132'}
2025-02-20 10:49:22,912 - {'Epoch': 21, 'HR@5': '0.0867', 'NDCG@5': '0.0611', 'HR@10': '0.1196', 'NDCG@10': '0.0717', 'HR@20': '0.1632', 'NDCG@20': '0.0827'}
2025-02-20 10:49:22,917 - EarlyStopping counter: 1 out of 10
2025-02-20 10:49:50,608 - {'epoch': 22, 'rec_loss': '6.9049'}
2025-02-20 10:49:58,439 - {'Epoch': 22, 'HR@5': '0.0868', 'NDCG@5': '0.0613', 'HR@10': '0.1208', 'NDCG@10': '0.0722', 'HR@20': '0.1632', 'NDCG@20': '0.0829'}
2025-02-20 10:49:58,440 - Validation score increased.  Saving model ...
2025-02-20 10:50:26,428 - {'epoch': 23, 'rec_loss': '6.8873'}
2025-02-20 10:50:34,235 - {'Epoch': 23, 'HR@5': '0.0864', 'NDCG@5': '0.0609', 'HR@10': '0.1186', 'NDCG@10': '0.0713', 'HR@20': '0.1638', 'NDCG@20': '0.0827'}
2025-02-20 10:50:34,236 - EarlyStopping counter: 1 out of 10
2025-02-20 10:51:01,336 - {'epoch': 24, 'rec_loss': '6.8790'}
2025-02-20 10:51:08,997 - {'Epoch': 24, 'HR@5': '0.0866', 'NDCG@5': '0.0609', 'HR@10': '0.1192', 'NDCG@10': '0.0713', 'HR@20': '0.1615', 'NDCG@20': '0.0820'}
2025-02-20 10:51:08,998 - EarlyStopping counter: 2 out of 10
2025-02-20 10:51:37,343 - {'epoch': 25, 'rec_loss': '6.8666'}
2025-02-20 10:51:45,135 - {'Epoch': 25, 'HR@5': '0.0872', 'NDCG@5': '0.0617', 'HR@10': '0.1211', 'NDCG@10': '0.0726', 'HR@20': '0.1643', 'NDCG@20': '0.0835'}
2025-02-20 10:51:45,139 - Validation score increased.  Saving model ...
2025-02-20 10:52:13,859 - {'epoch': 26, 'rec_loss': '6.8523'}
2025-02-20 10:52:21,680 - {'Epoch': 26, 'HR@5': '0.0861', 'NDCG@5': '0.0616', 'HR@10': '0.1191', 'NDCG@10': '0.0722', 'HR@20': '0.1647', 'NDCG@20': '0.0838'}
2025-02-20 10:52:21,681 - Validation score increased.  Saving model ...
2025-02-20 10:52:53,384 - {'epoch': 27, 'rec_loss': '6.8482'}
2025-02-20 10:53:01,128 - {'Epoch': 27, 'HR@5': '0.0861', 'NDCG@5': '0.0612', 'HR@10': '0.1199', 'NDCG@10': '0.0721', 'HR@20': '0.1638', 'NDCG@20': '0.0831'}
2025-02-20 10:53:01,129 - EarlyStopping counter: 1 out of 10
2025-02-20 10:53:28,933 - {'epoch': 28, 'rec_loss': '6.8362'}
2025-02-20 10:53:36,596 - {'Epoch': 28, 'HR@5': '0.0855', 'NDCG@5': '0.0609', 'HR@10': '0.1189', 'NDCG@10': '0.0716', 'HR@20': '0.1633', 'NDCG@20': '0.0828'}
2025-02-20 10:53:36,597 - EarlyStopping counter: 2 out of 10
2025-02-20 10:54:03,741 - {'epoch': 29, 'rec_loss': '6.8280'}
2025-02-20 10:54:11,769 - {'Epoch': 29, 'HR@5': '0.0869', 'NDCG@5': '0.0617', 'HR@10': '0.1192', 'NDCG@10': '0.0721', 'HR@20': '0.1632', 'NDCG@20': '0.0833'}
2025-02-20 10:54:11,770 - EarlyStopping counter: 3 out of 10
2025-02-20 10:54:41,704 - {'epoch': 30, 'rec_loss': '6.8175'}
2025-02-20 10:54:50,298 - {'Epoch': 30, 'HR@5': '0.0855', 'NDCG@5': '0.0605', 'HR@10': '0.1209', 'NDCG@10': '0.0718', 'HR@20': '0.1638', 'NDCG@20': '0.0826'}
2025-02-20 10:54:50,303 - EarlyStopping counter: 4 out of 10
2025-02-20 10:55:17,436 - {'epoch': 31, 'rec_loss': '6.8070'}
2025-02-20 10:55:25,562 - {'Epoch': 31, 'HR@5': '0.0865', 'NDCG@5': '0.0610', 'HR@10': '0.1194', 'NDCG@10': '0.0716', 'HR@20': '0.1625', 'NDCG@20': '0.0824'}
2025-02-20 10:55:25,563 - EarlyStopping counter: 5 out of 10
2025-02-20 10:55:54,543 - {'epoch': 32, 'rec_loss': '6.7950'}
2025-02-20 10:56:02,428 - {'Epoch': 32, 'HR@5': '0.0863', 'NDCG@5': '0.0613', 'HR@10': '0.1200', 'NDCG@10': '0.0721', 'HR@20': '0.1639', 'NDCG@20': '0.0832'}
2025-02-20 10:56:02,433 - EarlyStopping counter: 6 out of 10
2025-02-20 10:56:29,705 - {'epoch': 33, 'rec_loss': '6.7963'}
2025-02-20 10:56:37,403 - {'Epoch': 33, 'HR@5': '0.0856', 'NDCG@5': '0.0612', 'HR@10': '0.1179', 'NDCG@10': '0.0715', 'HR@20': '0.1626', 'NDCG@20': '0.0828'}
2025-02-20 10:56:37,408 - EarlyStopping counter: 7 out of 10
2025-02-20 10:57:05,534 - {'epoch': 34, 'rec_loss': '6.7840'}
2025-02-20 10:57:13,382 - {'Epoch': 34, 'HR@5': '0.0863', 'NDCG@5': '0.0616', 'HR@10': '0.1194', 'NDCG@10': '0.0723', 'HR@20': '0.1630', 'NDCG@20': '0.0833'}
2025-02-20 10:57:13,387 - EarlyStopping counter: 8 out of 10
2025-02-20 10:57:42,417 - {'epoch': 35, 'rec_loss': '6.7799'}
2025-02-20 10:57:50,038 - {'Epoch': 35, 'HR@5': '0.0850', 'NDCG@5': '0.0606', 'HR@10': '0.1176', 'NDCG@10': '0.0711', 'HR@20': '0.1621', 'NDCG@20': '0.0822'}
2025-02-20 10:57:50,039 - EarlyStopping counter: 9 out of 10
2025-02-20 10:58:17,719 - {'epoch': 36, 'rec_loss': '6.7697'}
2025-02-20 10:58:25,459 - {'Epoch': 36, 'HR@5': '0.0876', 'NDCG@5': '0.0625', 'HR@10': '0.1202', 'NDCG@10': '0.0730', 'HR@20': '0.1636', 'NDCG@20': '0.0839'}
2025-02-20 10:58:25,460 - Validation score increased.  Saving model ...
2025-02-20 10:58:53,503 - {'epoch': 37, 'rec_loss': '6.7602'}
2025-02-20 10:59:01,192 - {'Epoch': 37, 'HR@5': '0.0872', 'NDCG@5': '0.0614', 'HR@10': '0.1198', 'NDCG@10': '0.0718', 'HR@20': '0.1627', 'NDCG@20': '0.0826'}
2025-02-20 10:59:01,193 - EarlyStopping counter: 1 out of 10
2025-02-20 10:59:27,927 - {'epoch': 38, 'rec_loss': '6.7573'}
2025-02-20 10:59:35,530 - {'Epoch': 38, 'HR@5': '0.0861', 'NDCG@5': '0.0614', 'HR@10': '0.1206', 'NDCG@10': '0.0725', 'HR@20': '0.1638', 'NDCG@20': '0.0834'}
2025-02-20 10:59:35,532 - EarlyStopping counter: 2 out of 10
2025-02-20 11:00:05,023 - {'epoch': 39, 'rec_loss': '6.7517'}
2025-02-20 11:00:13,502 - {'Epoch': 39, 'HR@5': '0.0862', 'NDCG@5': '0.0615', 'HR@10': '0.1203', 'NDCG@10': '0.0725', 'HR@20': '0.1648', 'NDCG@20': '0.0837'}
2025-02-20 11:00:13,503 - EarlyStopping counter: 3 out of 10
2025-02-20 11:00:41,467 - {'epoch': 40, 'rec_loss': '6.7472'}
2025-02-20 11:00:49,375 - {'Epoch': 40, 'HR@5': '0.0850', 'NDCG@5': '0.0606', 'HR@10': '0.1198', 'NDCG@10': '0.0718', 'HR@20': '0.1636', 'NDCG@20': '0.0829'}
2025-02-20 11:00:49,380 - EarlyStopping counter: 4 out of 10
2025-02-20 11:01:17,740 - {'epoch': 41, 'rec_loss': '6.7408'}
2025-02-20 11:01:25,634 - {'Epoch': 41, 'HR@5': '0.0874', 'NDCG@5': '0.0621', 'HR@10': '0.1213', 'NDCG@10': '0.0730', 'HR@20': '0.1649', 'NDCG@20': '0.0839'}
2025-02-20 11:01:25,635 - Validation score increased.  Saving model ...
2025-02-20 11:01:53,109 - {'epoch': 42, 'rec_loss': '6.7367'}
2025-02-20 11:02:01,654 - {'Epoch': 42, 'HR@5': '0.0866', 'NDCG@5': '0.0615', 'HR@10': '0.1198', 'NDCG@10': '0.0721', 'HR@20': '0.1633', 'NDCG@20': '0.0831'}
2025-02-20 11:02:01,658 - EarlyStopping counter: 1 out of 10
2025-02-20 11:02:29,306 - {'epoch': 43, 'rec_loss': '6.7266'}
2025-02-20 11:02:37,850 - {'Epoch': 43, 'HR@5': '0.0869', 'NDCG@5': '0.0616', 'HR@10': '0.1196', 'NDCG@10': '0.0721', 'HR@20': '0.1629', 'NDCG@20': '0.0830'}
2025-02-20 11:02:37,851 - EarlyStopping counter: 2 out of 10
2025-02-20 11:03:07,118 - {'epoch': 44, 'rec_loss': '6.7257'}
2025-02-20 11:03:15,050 - {'Epoch': 44, 'HR@5': '0.0862', 'NDCG@5': '0.0613', 'HR@10': '0.1198', 'NDCG@10': '0.0721', 'HR@20': '0.1637', 'NDCG@20': '0.0832'}
2025-02-20 11:03:15,056 - EarlyStopping counter: 3 out of 10
2025-02-20 11:03:42,082 - {'epoch': 45, 'rec_loss': '6.7208'}
2025-02-20 11:03:49,790 - {'Epoch': 45, 'HR@5': '0.0876', 'NDCG@5': '0.0618', 'HR@10': '0.1216', 'NDCG@10': '0.0727', 'HR@20': '0.1638', 'NDCG@20': '0.0833'}
2025-02-20 11:03:49,794 - EarlyStopping counter: 4 out of 10
2025-02-20 11:04:18,599 - {'epoch': 46, 'rec_loss': '6.7147'}
2025-02-20 11:04:26,445 - {'Epoch': 46, 'HR@5': '0.0868', 'NDCG@5': '0.0618', 'HR@10': '0.1208', 'NDCG@10': '0.0727', 'HR@20': '0.1632', 'NDCG@20': '0.0834'}
2025-02-20 11:04:26,450 - EarlyStopping counter: 5 out of 10
2025-02-20 11:04:58,834 - {'epoch': 47, 'rec_loss': '6.7102'}
2025-02-20 11:05:06,692 - {'Epoch': 47, 'HR@5': '0.0872', 'NDCG@5': '0.0620', 'HR@10': '0.1207', 'NDCG@10': '0.0727', 'HR@20': '0.1652', 'NDCG@20': '0.0840'}
2025-02-20 11:05:06,696 - Validation score increased.  Saving model ...
2025-02-20 11:05:33,780 - {'epoch': 48, 'rec_loss': '6.7001'}
2025-02-20 11:05:41,325 - {'Epoch': 48, 'HR@5': '0.0862', 'NDCG@5': '0.0613', 'HR@10': '0.1210', 'NDCG@10': '0.0726', 'HR@20': '0.1661', 'NDCG@20': '0.0839'}
2025-02-20 11:05:41,331 - EarlyStopping counter: 1 out of 10
2025-02-20 11:06:09,711 - {'epoch': 49, 'rec_loss': '6.7010'}
2025-02-20 11:06:17,967 - {'Epoch': 49, 'HR@5': '0.0860', 'NDCG@5': '0.0612', 'HR@10': '0.1205', 'NDCG@10': '0.0723', 'HR@20': '0.1638', 'NDCG@20': '0.0833'}
2025-02-20 11:06:17,969 - EarlyStopping counter: 2 out of 10
2025-02-20 11:06:45,774 - {'epoch': 50, 'rec_loss': '6.7000'}
2025-02-20 11:06:53,518 - {'Epoch': 50, 'HR@5': '0.0874', 'NDCG@5': '0.0614', 'HR@10': '0.1214', 'NDCG@10': '0.0723', 'HR@20': '0.1650', 'NDCG@20': '0.0832'}
2025-02-20 11:06:53,519 - EarlyStopping counter: 3 out of 10
2025-02-20 11:07:21,254 - {'epoch': 51, 'rec_loss': '6.6926'}
2025-02-20 11:07:29,107 - {'Epoch': 51, 'HR@5': '0.0854', 'NDCG@5': '0.0603', 'HR@10': '0.1208', 'NDCG@10': '0.0717', 'HR@20': '0.1639', 'NDCG@20': '0.0825'}
2025-02-20 11:07:29,109 - EarlyStopping counter: 4 out of 10
2025-02-20 11:07:56,978 - {'epoch': 52, 'rec_loss': '6.6893'}
2025-02-20 11:08:04,935 - {'Epoch': 52, 'HR@5': '0.0877', 'NDCG@5': '0.0622', 'HR@10': '0.1218', 'NDCG@10': '0.0732', 'HR@20': '0.1644', 'NDCG@20': '0.0839'}
2025-02-20 11:08:04,940 - EarlyStopping counter: 5 out of 10
2025-02-20 11:08:32,072 - {'epoch': 53, 'rec_loss': '6.6820'}
2025-02-20 11:08:39,847 - {'Epoch': 53, 'HR@5': '0.0872', 'NDCG@5': '0.0616', 'HR@10': '0.1206', 'NDCG@10': '0.0724', 'HR@20': '0.1641', 'NDCG@20': '0.0833'}
2025-02-20 11:08:39,848 - EarlyStopping counter: 6 out of 10
2025-02-20 11:09:07,396 - {'epoch': 54, 'rec_loss': '6.6776'}
2025-02-20 11:09:15,026 - {'Epoch': 54, 'HR@5': '0.0860', 'NDCG@5': '0.0606', 'HR@10': '0.1210', 'NDCG@10': '0.0718', 'HR@20': '0.1645', 'NDCG@20': '0.0828'}
2025-02-20 11:09:15,027 - EarlyStopping counter: 7 out of 10
2025-02-20 11:09:42,237 - {'epoch': 55, 'rec_loss': '6.6771'}
2025-02-20 11:09:50,005 - {'Epoch': 55, 'HR@5': '0.0868', 'NDCG@5': '0.0616', 'HR@10': '0.1212', 'NDCG@10': '0.0727', 'HR@20': '0.1642', 'NDCG@20': '0.0835'}
2025-02-20 11:09:50,007 - EarlyStopping counter: 8 out of 10
2025-02-20 11:10:16,896 - {'epoch': 56, 'rec_loss': '6.6748'}
2025-02-20 11:10:24,660 - {'Epoch': 56, 'HR@5': '0.0868', 'NDCG@5': '0.0616', 'HR@10': '0.1207', 'NDCG@10': '0.0725', 'HR@20': '0.1650', 'NDCG@20': '0.0836'}
2025-02-20 11:10:24,661 - EarlyStopping counter: 9 out of 10
2025-02-20 11:10:52,108 - {'epoch': 57, 'rec_loss': '6.6682'}
2025-02-20 11:10:59,917 - {'Epoch': 57, 'HR@5': '0.0870', 'NDCG@5': '0.0615', 'HR@10': '0.1203', 'NDCG@10': '0.0722', 'HR@20': '0.1641', 'NDCG@20': '0.0833'}
2025-02-20 11:10:59,923 - EarlyStopping counter: 10 out of 10
2025-02-20 11:10:59,923 - Early stopping
2025-02-20 11:10:59,923 - ---------------Test Score---------------
2025-02-20 11:11:07,447 - {'Epoch': 0, 'HR@5': '0.0703', 'NDCG@5': '0.0493', 'HR@10': '0.0992', 'NDCG@10': '0.0586', 'HR@20': '0.1379', 'NDCG@20': '0.0684'}
2025-02-20 11:11:07,452 - Scale_Beauty
2025-02-20 11:11:07,452 - {'Epoch': 0, 'HR@5': '0.0703', 'NDCG@5': '0.0493', 'HR@10': '0.0992', 'NDCG@10': '0.0586', 'HR@20': '0.1379', 'NDCG@20': '0.0684'}
2025-02-23 11:53:08,905 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25, 10, 5], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-23 11:53:11,727 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-23 11:53:11,732 - Total Parameters: 928145
2025-02-23 11:53:57,584 - {'epoch': 0, 'rec_loss': '8.8180'}
2025-02-23 11:54:06,764 - {'Epoch': 0, 'HR@5': '0.0254', 'NDCG@5': '0.0165', 'HR@10': '0.0386', 'NDCG@10': '0.0207', 'HR@20': '0.0582', 'NDCG@20': '0.0256'}
2025-02-23 11:54:06,769 - Validation score increased.  Saving model ...
2025-02-23 11:54:51,375 - {'epoch': 1, 'rec_loss': '8.1969'}
2025-02-23 11:54:59,718 - {'Epoch': 1, 'HR@5': '0.0449', 'NDCG@5': '0.0303', 'HR@10': '0.0663', 'NDCG@10': '0.0372', 'HR@20': '0.0951', 'NDCG@20': '0.0444'}
2025-02-23 11:54:59,720 - Validation score increased.  Saving model ...
2025-02-23 11:55:44,348 - {'epoch': 2, 'rec_loss': '7.8781'}
2025-02-23 11:55:53,505 - {'Epoch': 2, 'HR@5': '0.0592', 'NDCG@5': '0.0403', 'HR@10': '0.0852', 'NDCG@10': '0.0487', 'HR@20': '0.1187', 'NDCG@20': '0.0571'}
2025-02-23 11:55:53,507 - Validation score increased.  Saving model ...
2025-02-23 11:56:37,894 - {'epoch': 3, 'rec_loss': '7.6557'}
2025-02-23 11:56:46,579 - {'Epoch': 3, 'HR@5': '0.0702', 'NDCG@5': '0.0484', 'HR@10': '0.0957', 'NDCG@10': '0.0566', 'HR@20': '0.1329', 'NDCG@20': '0.0660'}
2025-02-23 11:56:46,582 - Validation score increased.  Saving model ...
2025-02-23 11:57:34,101 - {'epoch': 4, 'rec_loss': '7.4908'}
2025-02-23 11:57:43,707 - {'Epoch': 4, 'HR@5': '0.0736', 'NDCG@5': '0.0511', 'HR@10': '0.1041', 'NDCG@10': '0.0610', 'HR@20': '0.1411', 'NDCG@20': '0.0702'}
2025-02-23 11:57:43,708 - Validation score increased.  Saving model ...
2025-02-23 11:58:28,001 - {'epoch': 5, 'rec_loss': '7.3652'}
2025-02-23 11:58:37,405 - {'Epoch': 5, 'HR@5': '0.0771', 'NDCG@5': '0.0543', 'HR@10': '0.1069', 'NDCG@10': '0.0639', 'HR@20': '0.1464', 'NDCG@20': '0.0738'}
2025-02-23 11:58:37,407 - Validation score increased.  Saving model ...
2025-02-23 11:59:23,283 - {'epoch': 6, 'rec_loss': '7.2705'}
2025-02-23 11:59:32,159 - {'Epoch': 6, 'HR@5': '0.0792', 'NDCG@5': '0.0555', 'HR@10': '0.1100', 'NDCG@10': '0.0654', 'HR@20': '0.1479', 'NDCG@20': '0.0749'}
2025-02-23 11:59:32,161 - Validation score increased.  Saving model ...
2025-02-23 12:00:19,485 - {'epoch': 7, 'rec_loss': '7.1978'}
2025-02-23 12:00:28,793 - {'Epoch': 7, 'HR@5': '0.0825', 'NDCG@5': '0.0576', 'HR@10': '0.1137', 'NDCG@10': '0.0676', 'HR@20': '0.1531', 'NDCG@20': '0.0775'}
2025-02-23 12:00:28,795 - Validation score increased.  Saving model ...
2025-02-23 12:01:15,695 - {'epoch': 8, 'rec_loss': '7.1407'}
2025-02-23 12:01:25,240 - {'Epoch': 8, 'HR@5': '0.0817', 'NDCG@5': '0.0583', 'HR@10': '0.1151', 'NDCG@10': '0.0692', 'HR@20': '0.1560', 'NDCG@20': '0.0795'}
2025-02-23 12:01:25,241 - Validation score increased.  Saving model ...
2025-02-23 12:02:13,688 - {'epoch': 9, 'rec_loss': '7.0899'}
2025-02-23 12:02:23,301 - {'Epoch': 9, 'HR@5': '0.0830', 'NDCG@5': '0.0585', 'HR@10': '0.1151', 'NDCG@10': '0.0688', 'HR@20': '0.1561', 'NDCG@20': '0.0791'}
2025-02-23 12:02:23,303 - EarlyStopping counter: 1 out of 10
2025-02-23 12:03:09,609 - {'epoch': 10, 'rec_loss': '7.0434'}
2025-02-23 12:03:18,512 - {'Epoch': 10, 'HR@5': '0.0825', 'NDCG@5': '0.0584', 'HR@10': '0.1160', 'NDCG@10': '0.0691', 'HR@20': '0.1553', 'NDCG@20': '0.0790'}
2025-02-23 12:03:18,514 - EarlyStopping counter: 2 out of 10
2025-02-23 12:04:04,063 - {'epoch': 11, 'rec_loss': '7.0081'}
2025-02-23 12:04:12,799 - {'Epoch': 11, 'HR@5': '0.0853', 'NDCG@5': '0.0592', 'HR@10': '0.1151', 'NDCG@10': '0.0689', 'HR@20': '0.1566', 'NDCG@20': '0.0793'}
2025-02-23 12:04:12,801 - EarlyStopping counter: 3 out of 10
2025-02-23 12:05:01,750 - {'epoch': 12, 'rec_loss': '6.9794'}
2025-02-23 12:05:11,310 - {'Epoch': 12, 'HR@5': '0.0845', 'NDCG@5': '0.0595', 'HR@10': '0.1167', 'NDCG@10': '0.0699', 'HR@20': '0.1583', 'NDCG@20': '0.0804'}
2025-02-23 12:05:11,312 - Validation score increased.  Saving model ...
2025-02-23 12:05:57,763 - {'epoch': 13, 'rec_loss': '6.9495'}
2025-02-23 12:06:07,463 - {'Epoch': 13, 'HR@5': '0.0840', 'NDCG@5': '0.0591', 'HR@10': '0.1161', 'NDCG@10': '0.0693', 'HR@20': '0.1568', 'NDCG@20': '0.0796'}
2025-02-23 12:06:07,465 - EarlyStopping counter: 1 out of 10
2025-02-23 12:06:51,854 - {'epoch': 14, 'rec_loss': '6.9221'}
2025-02-23 12:07:02,952 - {'Epoch': 14, 'HR@5': '0.0831', 'NDCG@5': '0.0591', 'HR@10': '0.1159', 'NDCG@10': '0.0696', 'HR@20': '0.1586', 'NDCG@20': '0.0804'}
2025-02-23 12:07:02,954 - EarlyStopping counter: 2 out of 10
2025-02-23 12:07:47,368 - {'epoch': 15, 'rec_loss': '6.9006'}
2025-02-23 12:07:57,349 - {'Epoch': 15, 'HR@5': '0.0843', 'NDCG@5': '0.0598', 'HR@10': '0.1179', 'NDCG@10': '0.0706', 'HR@20': '0.1595', 'NDCG@20': '0.0810'}
2025-02-23 12:07:57,350 - Validation score increased.  Saving model ...
2025-02-23 12:08:41,895 - {'epoch': 16, 'rec_loss': '6.8790'}
2025-02-23 12:08:52,161 - {'Epoch': 16, 'HR@5': '0.0862', 'NDCG@5': '0.0610', 'HR@10': '0.1186', 'NDCG@10': '0.0714', 'HR@20': '0.1588', 'NDCG@20': '0.0815'}
2025-02-23 12:08:52,162 - Validation score increased.  Saving model ...
2025-02-23 12:09:36,864 - {'epoch': 17, 'rec_loss': '6.8617'}
2025-02-23 12:09:46,284 - {'Epoch': 17, 'HR@5': '0.0837', 'NDCG@5': '0.0594', 'HR@10': '0.1174', 'NDCG@10': '0.0703', 'HR@20': '0.1600', 'NDCG@20': '0.0810'}
2025-02-23 12:09:46,286 - EarlyStopping counter: 1 out of 10
2025-02-23 12:10:31,762 - {'epoch': 18, 'rec_loss': '6.8428'}
2025-02-23 12:10:42,181 - {'Epoch': 18, 'HR@5': '0.0858', 'NDCG@5': '0.0605', 'HR@10': '0.1179', 'NDCG@10': '0.0708', 'HR@20': '0.1597', 'NDCG@20': '0.0814'}
2025-02-23 12:10:42,183 - EarlyStopping counter: 2 out of 10
2025-02-23 12:11:28,093 - {'epoch': 19, 'rec_loss': '6.8222'}
2025-02-23 12:11:36,611 - {'Epoch': 19, 'HR@5': '0.0874', 'NDCG@5': '0.0619', 'HR@10': '0.1200', 'NDCG@10': '0.0724', 'HR@20': '0.1623', 'NDCG@20': '0.0830'}
2025-02-23 12:11:36,613 - Validation score increased.  Saving model ...
2025-02-23 12:12:24,388 - {'epoch': 20, 'rec_loss': '6.8040'}
2025-02-23 12:12:34,115 - {'Epoch': 20, 'HR@5': '0.0859', 'NDCG@5': '0.0604', 'HR@10': '0.1169', 'NDCG@10': '0.0705', 'HR@20': '0.1583', 'NDCG@20': '0.0809'}
2025-02-23 12:12:34,117 - EarlyStopping counter: 1 out of 10
2025-02-23 12:13:18,013 - {'epoch': 21, 'rec_loss': '6.7911'}
2025-02-23 12:13:26,533 - {'Epoch': 21, 'HR@5': '0.0867', 'NDCG@5': '0.0603', 'HR@10': '0.1196', 'NDCG@10': '0.0709', 'HR@20': '0.1607', 'NDCG@20': '0.0812'}
2025-02-23 12:13:26,535 - EarlyStopping counter: 2 out of 10
2025-02-23 12:14:12,384 - {'epoch': 22, 'rec_loss': '6.7816'}
2025-02-23 12:14:22,161 - {'Epoch': 22, 'HR@5': '0.0859', 'NDCG@5': '0.0609', 'HR@10': '0.1170', 'NDCG@10': '0.0710', 'HR@20': '0.1587', 'NDCG@20': '0.0815'}
2025-02-23 12:14:22,162 - EarlyStopping counter: 3 out of 10
2025-02-23 12:15:06,036 - {'epoch': 23, 'rec_loss': '6.7648'}
2025-02-23 12:15:14,969 - {'Epoch': 23, 'HR@5': '0.0861', 'NDCG@5': '0.0608', 'HR@10': '0.1172', 'NDCG@10': '0.0708', 'HR@20': '0.1589', 'NDCG@20': '0.0813'}
2025-02-23 12:15:14,971 - EarlyStopping counter: 4 out of 10
2025-02-23 12:15:59,212 - {'epoch': 24, 'rec_loss': '6.7547'}
2025-02-23 12:16:08,923 - {'Epoch': 24, 'HR@5': '0.0866', 'NDCG@5': '0.0611', 'HR@10': '0.1167', 'NDCG@10': '0.0708', 'HR@20': '0.1585', 'NDCG@20': '0.0813'}
2025-02-23 12:16:08,925 - EarlyStopping counter: 5 out of 10
2025-02-23 12:16:52,852 - {'epoch': 25, 'rec_loss': '6.7403'}
2025-02-23 12:17:02,829 - {'Epoch': 25, 'HR@5': '0.0859', 'NDCG@5': '0.0604', 'HR@10': '0.1191', 'NDCG@10': '0.0711', 'HR@20': '0.1601', 'NDCG@20': '0.0814'}
2025-02-23 12:17:02,831 - EarlyStopping counter: 6 out of 10
2025-02-23 12:17:48,592 - {'epoch': 26, 'rec_loss': '6.7282'}
2025-02-23 12:17:57,120 - {'Epoch': 26, 'HR@5': '0.0849', 'NDCG@5': '0.0599', 'HR@10': '0.1189', 'NDCG@10': '0.0709', 'HR@20': '0.1603', 'NDCG@20': '0.0812'}
2025-02-23 12:17:57,121 - EarlyStopping counter: 7 out of 10
2025-02-23 12:18:41,867 - {'epoch': 27, 'rec_loss': '6.7142'}
2025-02-23 12:18:50,347 - {'Epoch': 27, 'HR@5': '0.0870', 'NDCG@5': '0.0619', 'HR@10': '0.1190', 'NDCG@10': '0.0722', 'HR@20': '0.1612', 'NDCG@20': '0.0828'}
2025-02-23 12:18:50,348 - EarlyStopping counter: 8 out of 10
2025-02-23 12:19:34,556 - {'epoch': 28, 'rec_loss': '6.7118'}
2025-02-23 12:19:45,172 - {'Epoch': 28, 'HR@5': '0.0876', 'NDCG@5': '0.0618', 'HR@10': '0.1189', 'NDCG@10': '0.0719', 'HR@20': '0.1600', 'NDCG@20': '0.0822'}
2025-02-23 12:19:45,173 - EarlyStopping counter: 9 out of 10
2025-02-23 12:20:31,371 - {'epoch': 29, 'rec_loss': '6.6932'}
2025-02-23 12:20:40,973 - {'Epoch': 29, 'HR@5': '0.0846', 'NDCG@5': '0.0592', 'HR@10': '0.1179', 'NDCG@10': '0.0700', 'HR@20': '0.1587', 'NDCG@20': '0.0802'}
2025-02-23 12:20:40,974 - EarlyStopping counter: 10 out of 10
2025-02-23 12:20:40,975 - Early stopping
2025-02-23 12:20:40,975 - ---------------Test Score---------------
2025-02-23 12:20:49,848 - {'Epoch': 0, 'HR@5': '0.0704', 'NDCG@5': '0.0501', 'HR@10': '0.0996', 'NDCG@10': '0.0595', 'HR@20': '0.1354', 'NDCG@20': '0.0685'}
2025-02-23 12:20:49,850 - Scale_Beauty
2025-02-23 12:20:49,850 - {'Epoch': 0, 'HR@5': '0.0704', 'NDCG@5': '0.0501', 'HR@10': '0.0996', 'NDCG@10': '0.0595', 'HR@20': '0.1354', 'NDCG@20': '0.0685'}
2025-02-23 12:59:45,101 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 10], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-23 12:59:47,851 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-23 12:59:47,856 - Total Parameters: 928470
2025-02-23 13:00:16,728 - {'epoch': 0, 'rec_loss': '8.8297'}
2025-02-23 13:00:25,366 - {'Epoch': 0, 'HR@5': '0.0195', 'NDCG@5': '0.0124', 'HR@10': '0.0306', 'NDCG@10': '0.0159', 'HR@20': '0.0465', 'NDCG@20': '0.0199'}
2025-02-23 13:00:25,367 - Validation score increased.  Saving model ...
2025-02-23 13:00:52,615 - {'epoch': 1, 'rec_loss': '8.3130'}
2025-02-23 13:01:02,037 - {'Epoch': 1, 'HR@5': '0.0359', 'NDCG@5': '0.0231', 'HR@10': '0.0557', 'NDCG@10': '0.0295', 'HR@20': '0.0805', 'NDCG@20': '0.0358'}
2025-02-23 13:01:02,038 - Validation score increased.  Saving model ...
2025-02-23 13:01:27,575 - {'epoch': 2, 'rec_loss': '8.0021'}
2025-02-23 13:01:35,530 - {'Epoch': 2, 'HR@5': '0.0523', 'NDCG@5': '0.0350', 'HR@10': '0.0757', 'NDCG@10': '0.0426', 'HR@20': '0.1062', 'NDCG@20': '0.0502'}
2025-02-23 13:01:35,531 - Validation score increased.  Saving model ...
2025-02-23 13:02:01,934 - {'epoch': 3, 'rec_loss': '7.7861'}
2025-02-23 13:02:10,601 - {'Epoch': 3, 'HR@5': '0.0621', 'NDCG@5': '0.0427', 'HR@10': '0.0893', 'NDCG@10': '0.0513', 'HR@20': '0.1250', 'NDCG@20': '0.0603'}
2025-02-23 13:02:10,603 - Validation score increased.  Saving model ...
2025-02-23 13:02:36,053 - {'epoch': 4, 'rec_loss': '7.6344'}
2025-02-23 13:02:44,021 - {'Epoch': 4, 'HR@5': '0.0696', 'NDCG@5': '0.0487', 'HR@10': '0.0968', 'NDCG@10': '0.0575', 'HR@20': '0.1341', 'NDCG@20': '0.0669'}
2025-02-23 13:02:44,022 - Validation score increased.  Saving model ...
2025-02-23 13:03:09,307 - {'epoch': 5, 'rec_loss': '7.5141'}
2025-02-23 13:03:18,289 - {'Epoch': 5, 'HR@5': '0.0745', 'NDCG@5': '0.0516', 'HR@10': '0.1033', 'NDCG@10': '0.0609', 'HR@20': '0.1413', 'NDCG@20': '0.0704'}
2025-02-23 13:03:18,291 - Validation score increased.  Saving model ...
2025-02-23 13:03:45,185 - {'epoch': 6, 'rec_loss': '7.4188'}
2025-02-23 13:03:53,788 - {'Epoch': 6, 'HR@5': '0.0755', 'NDCG@5': '0.0531', 'HR@10': '0.1059', 'NDCG@10': '0.0630', 'HR@20': '0.1457', 'NDCG@20': '0.0730'}
2025-02-23 13:03:53,789 - Validation score increased.  Saving model ...
2025-02-23 13:04:18,818 - {'epoch': 7, 'rec_loss': '7.3394'}
2025-02-23 13:04:26,701 - {'Epoch': 7, 'HR@5': '0.0808', 'NDCG@5': '0.0571', 'HR@10': '0.1109', 'NDCG@10': '0.0668', 'HR@20': '0.1502', 'NDCG@20': '0.0767'}
2025-02-23 13:04:26,703 - Validation score increased.  Saving model ...
2025-02-23 13:04:53,260 - {'epoch': 8, 'rec_loss': '7.2745'}
2025-02-23 13:05:01,310 - {'Epoch': 8, 'HR@5': '0.0803', 'NDCG@5': '0.0567', 'HR@10': '0.1116', 'NDCG@10': '0.0668', 'HR@20': '0.1519', 'NDCG@20': '0.0770'}
2025-02-23 13:05:01,311 - Validation score increased.  Saving model ...
2025-02-23 13:05:27,112 - {'epoch': 9, 'rec_loss': '7.2265'}
2025-02-23 13:05:34,917 - {'Epoch': 9, 'HR@5': '0.0816', 'NDCG@5': '0.0586', 'HR@10': '0.1133', 'NDCG@10': '0.0688', 'HR@20': '0.1540', 'NDCG@20': '0.0790'}
2025-02-23 13:05:34,918 - Validation score increased.  Saving model ...
2025-02-23 13:06:01,281 - {'epoch': 10, 'rec_loss': '7.1785'}
2025-02-23 13:06:10,309 - {'Epoch': 10, 'HR@5': '0.0830', 'NDCG@5': '0.0590', 'HR@10': '0.1134', 'NDCG@10': '0.0688', 'HR@20': '0.1550', 'NDCG@20': '0.0792'}
2025-02-23 13:06:10,311 - Validation score increased.  Saving model ...
2025-02-23 13:06:37,055 - {'epoch': 11, 'rec_loss': '7.1408'}
2025-02-23 13:06:44,963 - {'Epoch': 11, 'HR@5': '0.0832', 'NDCG@5': '0.0591', 'HR@10': '0.1142', 'NDCG@10': '0.0691', 'HR@20': '0.1564', 'NDCG@20': '0.0797'}
2025-02-23 13:06:44,964 - Validation score increased.  Saving model ...
2025-02-23 13:07:10,720 - {'epoch': 12, 'rec_loss': '7.1076'}
2025-02-23 13:07:19,483 - {'Epoch': 12, 'HR@5': '0.0842', 'NDCG@5': '0.0595', 'HR@10': '0.1150', 'NDCG@10': '0.0695', 'HR@20': '0.1570', 'NDCG@20': '0.0800'}
2025-02-23 13:07:19,484 - Validation score increased.  Saving model ...
2025-02-23 13:07:45,743 - {'epoch': 13, 'rec_loss': '7.0809'}
2025-02-23 13:07:54,579 - {'Epoch': 13, 'HR@5': '0.0857', 'NDCG@5': '0.0603', 'HR@10': '0.1155', 'NDCG@10': '0.0699', 'HR@20': '0.1595', 'NDCG@20': '0.0809'}
2025-02-23 13:07:54,581 - Validation score increased.  Saving model ...
2025-02-23 13:08:19,683 - {'epoch': 14, 'rec_loss': '7.0516'}
2025-02-23 13:08:28,584 - {'Epoch': 14, 'HR@5': '0.0846', 'NDCG@5': '0.0598', 'HR@10': '0.1162', 'NDCG@10': '0.0699', 'HR@20': '0.1591', 'NDCG@20': '0.0807'}
2025-02-23 13:08:28,585 - EarlyStopping counter: 1 out of 10
2025-02-23 13:08:54,405 - {'epoch': 15, 'rec_loss': '7.0348'}
2025-02-23 13:09:02,354 - {'Epoch': 15, 'HR@5': '0.0837', 'NDCG@5': '0.0589', 'HR@10': '0.1166', 'NDCG@10': '0.0695', 'HR@20': '0.1604', 'NDCG@20': '0.0806'}
2025-02-23 13:09:02,355 - EarlyStopping counter: 2 out of 10
2025-02-23 13:09:29,064 - {'epoch': 16, 'rec_loss': '7.0110'}
2025-02-23 13:09:37,860 - {'Epoch': 16, 'HR@5': '0.0843', 'NDCG@5': '0.0595', 'HR@10': '0.1166', 'NDCG@10': '0.0699', 'HR@20': '0.1613', 'NDCG@20': '0.0812'}
2025-02-23 13:09:37,861 - Validation score increased.  Saving model ...
2025-02-23 13:10:02,891 - {'epoch': 17, 'rec_loss': '6.9939'}
2025-02-23 13:10:10,902 - {'Epoch': 17, 'HR@5': '0.0857', 'NDCG@5': '0.0608', 'HR@10': '0.1191', 'NDCG@10': '0.0716', 'HR@20': '0.1616', 'NDCG@20': '0.0822'}
2025-02-23 13:10:10,903 - Validation score increased.  Saving model ...
2025-02-23 13:10:37,163 - {'epoch': 18, 'rec_loss': '6.9646'}
2025-02-23 13:10:46,031 - {'Epoch': 18, 'HR@5': '0.0863', 'NDCG@5': '0.0603', 'HR@10': '0.1190', 'NDCG@10': '0.0708', 'HR@20': '0.1624', 'NDCG@20': '0.0817'}
2025-02-23 13:10:46,032 - EarlyStopping counter: 1 out of 10
2025-02-23 13:11:12,456 - {'epoch': 19, 'rec_loss': '6.9516'}
2025-02-23 13:11:20,388 - {'Epoch': 19, 'HR@5': '0.0861', 'NDCG@5': '0.0605', 'HR@10': '0.1193', 'NDCG@10': '0.0711', 'HR@20': '0.1619', 'NDCG@20': '0.0819'}
2025-02-23 13:11:20,390 - EarlyStopping counter: 2 out of 10
2025-02-23 13:11:45,240 - {'epoch': 20, 'rec_loss': '6.9421'}
2025-02-23 13:11:54,125 - {'Epoch': 20, 'HR@5': '0.0873', 'NDCG@5': '0.0615', 'HR@10': '0.1202', 'NDCG@10': '0.0721', 'HR@20': '0.1621', 'NDCG@20': '0.0826'}
2025-02-23 13:11:54,126 - Validation score increased.  Saving model ...
2025-02-23 13:12:20,546 - {'epoch': 21, 'rec_loss': '6.9190'}
2025-02-23 13:12:28,879 - {'Epoch': 21, 'HR@5': '0.0872', 'NDCG@5': '0.0614', 'HR@10': '0.1208', 'NDCG@10': '0.0722', 'HR@20': '0.1637', 'NDCG@20': '0.0829'}
2025-02-23 13:12:28,880 - Validation score increased.  Saving model ...
2025-02-23 13:12:53,695 - {'epoch': 22, 'rec_loss': '6.9106'}
2025-02-23 13:13:02,561 - {'Epoch': 22, 'HR@5': '0.0882', 'NDCG@5': '0.0620', 'HR@10': '0.1210', 'NDCG@10': '0.0725', 'HR@20': '0.1634', 'NDCG@20': '0.0832'}
2025-02-23 13:13:02,562 - Validation score increased.  Saving model ...
2025-02-23 13:13:29,792 - {'epoch': 23, 'rec_loss': '6.8978'}
2025-02-23 13:13:38,586 - {'Epoch': 23, 'HR@5': '0.0889', 'NDCG@5': '0.0619', 'HR@10': '0.1220', 'NDCG@10': '0.0726', 'HR@20': '0.1639', 'NDCG@20': '0.0831'}
2025-02-23 13:13:38,587 - EarlyStopping counter: 1 out of 10
2025-02-23 13:14:04,854 - {'epoch': 24, 'rec_loss': '6.8825'}
2025-02-23 13:14:13,113 - {'Epoch': 24, 'HR@5': '0.0867', 'NDCG@5': '0.0612', 'HR@10': '0.1202', 'NDCG@10': '0.0720', 'HR@20': '0.1636', 'NDCG@20': '0.0829'}
2025-02-23 13:14:13,115 - EarlyStopping counter: 2 out of 10
2025-02-23 13:14:39,346 - {'epoch': 25, 'rec_loss': '6.8670'}
2025-02-23 13:14:48,354 - {'Epoch': 25, 'HR@5': '0.0873', 'NDCG@5': '0.0614', 'HR@10': '0.1206', 'NDCG@10': '0.0721', 'HR@20': '0.1645', 'NDCG@20': '0.0831'}
2025-02-23 13:14:48,355 - EarlyStopping counter: 3 out of 10
2025-02-23 13:15:14,704 - {'epoch': 26, 'rec_loss': '6.8614'}
2025-02-23 13:15:22,815 - {'Epoch': 26, 'HR@5': '0.0865', 'NDCG@5': '0.0611', 'HR@10': '0.1211', 'NDCG@10': '0.0722', 'HR@20': '0.1636', 'NDCG@20': '0.0829'}
2025-02-23 13:15:22,817 - EarlyStopping counter: 4 out of 10
2025-02-23 13:15:50,066 - {'epoch': 27, 'rec_loss': '6.8516'}
2025-02-23 13:15:57,954 - {'Epoch': 27, 'HR@5': '0.0881', 'NDCG@5': '0.0623', 'HR@10': '0.1232', 'NDCG@10': '0.0736', 'HR@20': '0.1664', 'NDCG@20': '0.0845'}
2025-02-23 13:15:57,956 - Validation score increased.  Saving model ...
2025-02-23 13:16:25,516 - {'epoch': 28, 'rec_loss': '6.8374'}
2025-02-23 13:16:33,545 - {'Epoch': 28, 'HR@5': '0.0883', 'NDCG@5': '0.0623', 'HR@10': '0.1217', 'NDCG@10': '0.0730', 'HR@20': '0.1650', 'NDCG@20': '0.0839'}
2025-02-23 13:16:33,547 - EarlyStopping counter: 1 out of 10
2025-02-23 13:16:58,713 - {'epoch': 29, 'rec_loss': '6.8331'}
2025-02-23 13:17:08,006 - {'Epoch': 29, 'HR@5': '0.0880', 'NDCG@5': '0.0620', 'HR@10': '0.1215', 'NDCG@10': '0.0727', 'HR@20': '0.1662', 'NDCG@20': '0.0840'}
2025-02-23 13:17:08,008 - EarlyStopping counter: 2 out of 10
2025-02-23 13:17:37,526 - {'epoch': 30, 'rec_loss': '6.8189'}
2025-02-23 13:17:45,712 - {'Epoch': 30, 'HR@5': '0.0887', 'NDCG@5': '0.0627', 'HR@10': '0.1228', 'NDCG@10': '0.0737', 'HR@20': '0.1676', 'NDCG@20': '0.0849'}
2025-02-23 13:17:45,713 - Validation score increased.  Saving model ...
2025-02-23 13:18:13,006 - {'epoch': 31, 'rec_loss': '6.8124'}
2025-02-23 13:18:21,020 - {'Epoch': 31, 'HR@5': '0.0874', 'NDCG@5': '0.0614', 'HR@10': '0.1216', 'NDCG@10': '0.0724', 'HR@20': '0.1634', 'NDCG@20': '0.0830'}
2025-02-23 13:18:21,021 - EarlyStopping counter: 1 out of 10
2025-02-23 13:18:47,520 - {'epoch': 32, 'rec_loss': '6.8027'}
2025-02-23 13:18:56,913 - {'Epoch': 32, 'HR@5': '0.0882', 'NDCG@5': '0.0617', 'HR@10': '0.1219', 'NDCG@10': '0.0726', 'HR@20': '0.1651', 'NDCG@20': '0.0835'}
2025-02-23 13:18:56,914 - EarlyStopping counter: 2 out of 10
2025-02-23 13:19:23,738 - {'epoch': 33, 'rec_loss': '6.7985'}
2025-02-23 13:19:32,583 - {'Epoch': 33, 'HR@5': '0.0883', 'NDCG@5': '0.0622', 'HR@10': '0.1239', 'NDCG@10': '0.0737', 'HR@20': '0.1664', 'NDCG@20': '0.0844'}
2025-02-23 13:19:32,584 - EarlyStopping counter: 3 out of 10
2025-02-23 13:19:58,725 - {'epoch': 34, 'rec_loss': '6.7838'}
2025-02-23 13:20:06,986 - {'Epoch': 34, 'HR@5': '0.0893', 'NDCG@5': '0.0627', 'HR@10': '0.1235', 'NDCG@10': '0.0737', 'HR@20': '0.1658', 'NDCG@20': '0.0843'}
2025-02-23 13:20:06,987 - EarlyStopping counter: 4 out of 10
2025-02-23 13:20:34,099 - {'epoch': 35, 'rec_loss': '6.7834'}
2025-02-23 13:20:43,312 - {'Epoch': 35, 'HR@5': '0.0879', 'NDCG@5': '0.0622', 'HR@10': '0.1212', 'NDCG@10': '0.0729', 'HR@20': '0.1650', 'NDCG@20': '0.0838'}
2025-02-23 13:20:43,313 - EarlyStopping counter: 5 out of 10
2025-02-23 13:21:11,379 - {'epoch': 36, 'rec_loss': '6.7750'}
2025-02-23 13:21:20,767 - {'Epoch': 36, 'HR@5': '0.0885', 'NDCG@5': '0.0620', 'HR@10': '0.1215', 'NDCG@10': '0.0726', 'HR@20': '0.1648', 'NDCG@20': '0.0836'}
2025-02-23 13:21:20,768 - EarlyStopping counter: 6 out of 10
2025-02-23 13:21:51,602 - {'epoch': 37, 'rec_loss': '6.7687'}
2025-02-23 13:22:00,249 - {'Epoch': 37, 'HR@5': '0.0892', 'NDCG@5': '0.0627', 'HR@10': '0.1234', 'NDCG@10': '0.0737', 'HR@20': '0.1666', 'NDCG@20': '0.0846'}
2025-02-23 13:22:00,250 - EarlyStopping counter: 7 out of 10
2025-02-23 13:22:27,969 - {'epoch': 38, 'rec_loss': '6.7621'}
2025-02-23 13:22:36,115 - {'Epoch': 38, 'HR@5': '0.0899', 'NDCG@5': '0.0625', 'HR@10': '0.1242', 'NDCG@10': '0.0736', 'HR@20': '0.1670', 'NDCG@20': '0.0843'}
2025-02-23 13:22:36,116 - EarlyStopping counter: 8 out of 10
2025-02-23 13:23:02,525 - {'epoch': 39, 'rec_loss': '6.7525'}
2025-02-23 13:23:11,972 - {'Epoch': 39, 'HR@5': '0.0889', 'NDCG@5': '0.0626', 'HR@10': '0.1226', 'NDCG@10': '0.0735', 'HR@20': '0.1658', 'NDCG@20': '0.0844'}
2025-02-23 13:23:11,974 - EarlyStopping counter: 9 out of 10
2025-02-23 13:23:36,811 - {'epoch': 40, 'rec_loss': '6.7454'}
2025-02-23 13:23:44,982 - {'Epoch': 40, 'HR@5': '0.0880', 'NDCG@5': '0.0621', 'HR@10': '0.1229', 'NDCG@10': '0.0734', 'HR@20': '0.1665', 'NDCG@20': '0.0844'}
2025-02-23 13:23:44,983 - EarlyStopping counter: 10 out of 10
2025-02-23 13:23:44,983 - Early stopping
2025-02-23 13:23:44,983 - ---------------Test Score---------------
2025-02-23 13:23:52,932 - {'Epoch': 0, 'HR@5': '0.0705', 'NDCG@5': '0.0492', 'HR@10': '0.0989', 'NDCG@10': '0.0583', 'HR@20': '0.1354', 'NDCG@20': '0.0675'}
2025-02-23 13:23:52,933 - Scale_Beauty
2025-02-23 13:23:52,933 - {'Epoch': 0, 'HR@5': '0.0705', 'NDCG@5': '0.0492', 'HR@10': '0.0989', 'NDCG@10': '0.0583', 'HR@20': '0.1354', 'NDCG@20': '0.0675'}
2025-02-23 13:36:37,043 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.4, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-23 13:36:39,866 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-23 13:36:39,871 - Total Parameters: 929445
2025-02-23 13:37:09,470 - {'epoch': 0, 'rec_loss': '8.8209'}
2025-02-23 13:37:17,556 - {'Epoch': 0, 'HR@5': '0.0212', 'NDCG@5': '0.0135', 'HR@10': '0.0326', 'NDCG@10': '0.0172', 'HR@20': '0.0500', 'NDCG@20': '0.0215'}
2025-02-23 13:37:17,558 - Validation score increased.  Saving model ...
2025-02-23 13:37:45,275 - {'epoch': 1, 'rec_loss': '8.2910'}
2025-02-23 13:37:53,315 - {'Epoch': 1, 'HR@5': '0.0385', 'NDCG@5': '0.0261', 'HR@10': '0.0588', 'NDCG@10': '0.0326', 'HR@20': '0.0846', 'NDCG@20': '0.0391'}
2025-02-23 13:37:53,316 - Validation score increased.  Saving model ...
2025-02-23 13:38:21,084 - {'epoch': 2, 'rec_loss': '7.9738'}
2025-02-23 13:38:28,565 - {'Epoch': 2, 'HR@5': '0.0504', 'NDCG@5': '0.0344', 'HR@10': '0.0745', 'NDCG@10': '0.0421', 'HR@20': '0.1086', 'NDCG@20': '0.0507'}
2025-02-23 13:38:28,566 - Validation score increased.  Saving model ...
2025-02-23 13:38:56,719 - {'epoch': 3, 'rec_loss': '7.7567'}
2025-02-23 13:39:04,603 - {'Epoch': 3, 'HR@5': '0.0614', 'NDCG@5': '0.0417', 'HR@10': '0.0901', 'NDCG@10': '0.0509', 'HR@20': '0.1259', 'NDCG@20': '0.0599'}
2025-02-23 13:39:04,604 - Validation score increased.  Saving model ...
2025-02-23 13:39:32,002 - {'epoch': 4, 'rec_loss': '7.5913'}
2025-02-23 13:39:39,534 - {'Epoch': 4, 'HR@5': '0.0702', 'NDCG@5': '0.0489', 'HR@10': '0.0983', 'NDCG@10': '0.0580', 'HR@20': '0.1347', 'NDCG@20': '0.0671'}
2025-02-23 13:39:39,535 - Validation score increased.  Saving model ...
2025-02-23 13:40:07,590 - {'epoch': 5, 'rec_loss': '7.4717'}
2025-02-23 13:40:15,256 - {'Epoch': 5, 'HR@5': '0.0749', 'NDCG@5': '0.0525', 'HR@10': '0.1052', 'NDCG@10': '0.0622', 'HR@20': '0.1429', 'NDCG@20': '0.0717'}
2025-02-23 13:40:15,257 - Validation score increased.  Saving model ...
2025-02-23 13:40:41,946 - {'epoch': 6, 'rec_loss': '7.3726'}
2025-02-23 13:40:49,622 - {'Epoch': 6, 'HR@5': '0.0763', 'NDCG@5': '0.0542', 'HR@10': '0.1058', 'NDCG@10': '0.0637', 'HR@20': '0.1479', 'NDCG@20': '0.0743'}
2025-02-23 13:40:49,623 - Validation score increased.  Saving model ...
2025-02-23 13:41:16,825 - {'epoch': 7, 'rec_loss': '7.2921'}
2025-02-23 13:41:24,241 - {'Epoch': 7, 'HR@5': '0.0809', 'NDCG@5': '0.0571', 'HR@10': '0.1099', 'NDCG@10': '0.0664', 'HR@20': '0.1511', 'NDCG@20': '0.0768'}
2025-02-23 13:41:24,242 - Validation score increased.  Saving model ...
2025-02-23 13:41:54,914 - {'epoch': 8, 'rec_loss': '7.2202'}
2025-02-23 13:42:02,445 - {'Epoch': 8, 'HR@5': '0.0833', 'NDCG@5': '0.0589', 'HR@10': '0.1113', 'NDCG@10': '0.0679', 'HR@20': '0.1519', 'NDCG@20': '0.0781'}
2025-02-23 13:42:02,446 - Validation score increased.  Saving model ...
2025-02-23 13:42:30,682 - {'epoch': 9, 'rec_loss': '7.1736'}
2025-02-23 13:42:38,241 - {'Epoch': 9, 'HR@5': '0.0833', 'NDCG@5': '0.0585', 'HR@10': '0.1143', 'NDCG@10': '0.0685', 'HR@20': '0.1523', 'NDCG@20': '0.0780'}
2025-02-23 13:42:38,243 - EarlyStopping counter: 1 out of 10
2025-02-23 13:43:07,024 - {'epoch': 10, 'rec_loss': '7.1254'}
2025-02-23 13:43:15,118 - {'Epoch': 10, 'HR@5': '0.0836', 'NDCG@5': '0.0590', 'HR@10': '0.1131', 'NDCG@10': '0.0685', 'HR@20': '0.1535', 'NDCG@20': '0.0786'}
2025-02-23 13:43:15,120 - Validation score increased.  Saving model ...
2025-02-23 13:43:45,560 - {'epoch': 11, 'rec_loss': '7.0862'}
2025-02-23 13:43:53,000 - {'Epoch': 11, 'HR@5': '0.0844', 'NDCG@5': '0.0598', 'HR@10': '0.1150', 'NDCG@10': '0.0697', 'HR@20': '0.1554', 'NDCG@20': '0.0798'}
2025-02-23 13:43:53,001 - Validation score increased.  Saving model ...
2025-02-23 13:44:22,668 - {'epoch': 12, 'rec_loss': '7.0521'}
2025-02-23 13:44:30,152 - {'Epoch': 12, 'HR@5': '0.0845', 'NDCG@5': '0.0595', 'HR@10': '0.1174', 'NDCG@10': '0.0701', 'HR@20': '0.1583', 'NDCG@20': '0.0804'}
2025-02-23 13:44:30,153 - Validation score increased.  Saving model ...
2025-02-23 13:44:58,350 - {'epoch': 13, 'rec_loss': '7.0275'}
2025-02-23 13:45:06,352 - {'Epoch': 13, 'HR@5': '0.0849', 'NDCG@5': '0.0599', 'HR@10': '0.1186', 'NDCG@10': '0.0707', 'HR@20': '0.1595', 'NDCG@20': '0.0810'}
2025-02-23 13:45:06,354 - Validation score increased.  Saving model ...
2025-02-23 13:45:37,433 - {'epoch': 14, 'rec_loss': '6.9970'}
2025-02-23 13:45:45,027 - {'Epoch': 14, 'HR@5': '0.0857', 'NDCG@5': '0.0602', 'HR@10': '0.1182', 'NDCG@10': '0.0708', 'HR@20': '0.1601', 'NDCG@20': '0.0813'}
2025-02-23 13:45:45,029 - Validation score increased.  Saving model ...
2025-02-23 13:46:12,626 - {'epoch': 15, 'rec_loss': '6.9778'}
2025-02-23 13:46:20,550 - {'Epoch': 15, 'HR@5': '0.0872', 'NDCG@5': '0.0610', 'HR@10': '0.1193', 'NDCG@10': '0.0713', 'HR@20': '0.1612', 'NDCG@20': '0.0818'}
2025-02-23 13:46:20,551 - Validation score increased.  Saving model ...
2025-02-23 13:46:48,866 - {'epoch': 16, 'rec_loss': '6.9545'}
2025-02-23 13:46:56,343 - {'Epoch': 16, 'HR@5': '0.0867', 'NDCG@5': '0.0606', 'HR@10': '0.1185', 'NDCG@10': '0.0708', 'HR@20': '0.1605', 'NDCG@20': '0.0815'}
2025-02-23 13:46:56,345 - EarlyStopping counter: 1 out of 10
2025-02-23 13:47:23,506 - {'epoch': 17, 'rec_loss': '6.9406'}
2025-02-23 13:47:31,107 - {'Epoch': 17, 'HR@5': '0.0847', 'NDCG@5': '0.0598', 'HR@10': '0.1195', 'NDCG@10': '0.0709', 'HR@20': '0.1621', 'NDCG@20': '0.0817'}
2025-02-23 13:47:31,109 - EarlyStopping counter: 2 out of 10
2025-02-23 13:47:58,032 - {'epoch': 18, 'rec_loss': '6.9120'}
2025-02-23 13:48:06,059 - {'Epoch': 18, 'HR@5': '0.0868', 'NDCG@5': '0.0611', 'HR@10': '0.1199', 'NDCG@10': '0.0718', 'HR@20': '0.1624', 'NDCG@20': '0.0825'}
2025-02-23 13:48:06,060 - Validation score increased.  Saving model ...
2025-02-23 13:48:35,742 - {'epoch': 19, 'rec_loss': '6.8990'}
2025-02-23 13:48:43,391 - {'Epoch': 19, 'HR@5': '0.0856', 'NDCG@5': '0.0605', 'HR@10': '0.1186', 'NDCG@10': '0.0712', 'HR@20': '0.1622', 'NDCG@20': '0.0821'}
2025-02-23 13:48:43,393 - EarlyStopping counter: 1 out of 10
2025-02-23 13:49:10,852 - {'epoch': 20, 'rec_loss': '6.8772'}
2025-02-23 13:49:19,096 - {'Epoch': 20, 'HR@5': '0.0868', 'NDCG@5': '0.0611', 'HR@10': '0.1217', 'NDCG@10': '0.0723', 'HR@20': '0.1633', 'NDCG@20': '0.0828'}
2025-02-23 13:49:19,097 - Validation score increased.  Saving model ...
2025-02-23 13:49:48,064 - {'epoch': 21, 'rec_loss': '6.8700'}
2025-02-23 13:49:56,195 - {'Epoch': 21, 'HR@5': '0.0873', 'NDCG@5': '0.0613', 'HR@10': '0.1209', 'NDCG@10': '0.0721', 'HR@20': '0.1621', 'NDCG@20': '0.0826'}
2025-02-23 13:49:56,196 - EarlyStopping counter: 1 out of 10
2025-02-23 13:50:24,517 - {'epoch': 22, 'rec_loss': '6.8550'}
2025-02-23 13:50:32,554 - {'Epoch': 22, 'HR@5': '0.0868', 'NDCG@5': '0.0615', 'HR@10': '0.1215', 'NDCG@10': '0.0728', 'HR@20': '0.1642', 'NDCG@20': '0.0835'}
2025-02-23 13:50:32,556 - Validation score increased.  Saving model ...
2025-02-23 13:51:00,571 - {'epoch': 23, 'rec_loss': '6.8431'}
2025-02-23 13:51:08,714 - {'Epoch': 23, 'HR@5': '0.0873', 'NDCG@5': '0.0616', 'HR@10': '0.1196', 'NDCG@10': '0.0720', 'HR@20': '0.1638', 'NDCG@20': '0.0832'}
2025-02-23 13:51:08,715 - EarlyStopping counter: 1 out of 10
2025-02-23 13:51:35,408 - {'epoch': 24, 'rec_loss': '6.8333'}
2025-02-23 13:51:44,369 - {'Epoch': 24, 'HR@5': '0.0856', 'NDCG@5': '0.0605', 'HR@10': '0.1203', 'NDCG@10': '0.0716', 'HR@20': '0.1633', 'NDCG@20': '0.0824'}
2025-02-23 13:51:44,371 - EarlyStopping counter: 2 out of 10
2025-02-23 13:52:12,646 - {'epoch': 25, 'rec_loss': '6.8148'}
2025-02-23 13:52:20,889 - {'Epoch': 25, 'HR@5': '0.0871', 'NDCG@5': '0.0610', 'HR@10': '0.1213', 'NDCG@10': '0.0721', 'HR@20': '0.1644', 'NDCG@20': '0.0829'}
2025-02-23 13:52:20,890 - EarlyStopping counter: 3 out of 10
2025-02-23 13:52:47,421 - {'epoch': 26, 'rec_loss': '6.8112'}
2025-02-23 13:52:55,024 - {'Epoch': 26, 'HR@5': '0.0881', 'NDCG@5': '0.0620', 'HR@10': '0.1210', 'NDCG@10': '0.0726', 'HR@20': '0.1639', 'NDCG@20': '0.0834'}
2025-02-23 13:52:55,025 - EarlyStopping counter: 4 out of 10
2025-02-23 13:53:21,857 - {'epoch': 27, 'rec_loss': '6.7947'}
2025-02-23 13:53:29,812 - {'Epoch': 27, 'HR@5': '0.0870', 'NDCG@5': '0.0615', 'HR@10': '0.1211', 'NDCG@10': '0.0725', 'HR@20': '0.1630', 'NDCG@20': '0.0831'}
2025-02-23 13:53:29,814 - EarlyStopping counter: 5 out of 10
2025-02-23 13:53:55,520 - {'epoch': 28, 'rec_loss': '6.7888'}
2025-02-23 13:54:03,497 - {'Epoch': 28, 'HR@5': '0.0872', 'NDCG@5': '0.0610', 'HR@10': '0.1214', 'NDCG@10': '0.0720', 'HR@20': '0.1642', 'NDCG@20': '0.0828'}
2025-02-23 13:54:03,499 - EarlyStopping counter: 6 out of 10
2025-02-23 13:54:32,499 - {'epoch': 29, 'rec_loss': '6.7806'}
2025-02-23 13:54:41,002 - {'Epoch': 29, 'HR@5': '0.0869', 'NDCG@5': '0.0608', 'HR@10': '0.1201', 'NDCG@10': '0.0715', 'HR@20': '0.1652', 'NDCG@20': '0.0829'}
2025-02-23 13:54:41,004 - EarlyStopping counter: 7 out of 10
2025-02-23 13:55:07,334 - {'epoch': 30, 'rec_loss': '6.7711'}
2025-02-23 13:55:15,807 - {'Epoch': 30, 'HR@5': '0.0872', 'NDCG@5': '0.0614', 'HR@10': '0.1212', 'NDCG@10': '0.0724', 'HR@20': '0.1665', 'NDCG@20': '0.0838'}
2025-02-23 13:55:15,808 - Validation score increased.  Saving model ...
2025-02-23 13:55:45,762 - {'epoch': 31, 'rec_loss': '6.7586'}
2025-02-23 13:55:53,384 - {'Epoch': 31, 'HR@5': '0.0889', 'NDCG@5': '0.0626', 'HR@10': '0.1212', 'NDCG@10': '0.0731', 'HR@20': '0.1659', 'NDCG@20': '0.0843'}
2025-02-23 13:55:53,386 - Validation score increased.  Saving model ...
2025-02-23 13:56:20,657 - {'epoch': 32, 'rec_loss': '6.7558'}
2025-02-23 13:56:28,943 - {'Epoch': 32, 'HR@5': '0.0875', 'NDCG@5': '0.0620', 'HR@10': '0.1223', 'NDCG@10': '0.0732', 'HR@20': '0.1656', 'NDCG@20': '0.0841'}
2025-02-23 13:56:28,944 - EarlyStopping counter: 1 out of 10
2025-02-23 13:56:54,800 - {'epoch': 33, 'rec_loss': '6.7516'}
2025-02-23 13:57:03,269 - {'Epoch': 33, 'HR@5': '0.0871', 'NDCG@5': '0.0617', 'HR@10': '0.1206', 'NDCG@10': '0.0726', 'HR@20': '0.1642', 'NDCG@20': '0.0836'}
2025-02-23 13:57:03,271 - EarlyStopping counter: 2 out of 10
2025-02-23 13:57:30,201 - {'epoch': 34, 'rec_loss': '6.7369'}
2025-02-23 13:57:37,984 - {'Epoch': 34, 'HR@5': '0.0882', 'NDCG@5': '0.0619', 'HR@10': '0.1210', 'NDCG@10': '0.0725', 'HR@20': '0.1639', 'NDCG@20': '0.0833'}
2025-02-23 13:57:37,986 - EarlyStopping counter: 3 out of 10
2025-02-23 13:58:03,759 - {'epoch': 35, 'rec_loss': '6.7308'}
2025-02-23 13:58:12,307 - {'Epoch': 35, 'HR@5': '0.0870', 'NDCG@5': '0.0609', 'HR@10': '0.1209', 'NDCG@10': '0.0718', 'HR@20': '0.1657', 'NDCG@20': '0.0830'}
2025-02-23 13:58:12,309 - EarlyStopping counter: 4 out of 10
2025-02-23 13:58:38,630 - {'epoch': 36, 'rec_loss': '6.7244'}
2025-02-23 13:58:46,554 - {'Epoch': 36, 'HR@5': '0.0879', 'NDCG@5': '0.0621', 'HR@10': '0.1217', 'NDCG@10': '0.0730', 'HR@20': '0.1656', 'NDCG@20': '0.0841'}
2025-02-23 13:58:46,556 - EarlyStopping counter: 5 out of 10
2025-02-23 13:59:14,133 - {'epoch': 37, 'rec_loss': '6.7108'}
2025-02-23 13:59:22,465 - {'Epoch': 37, 'HR@5': '0.0870', 'NDCG@5': '0.0608', 'HR@10': '0.1229', 'NDCG@10': '0.0724', 'HR@20': '0.1663', 'NDCG@20': '0.0833'}
2025-02-23 13:59:22,466 - EarlyStopping counter: 6 out of 10
2025-02-23 13:59:48,681 - {'epoch': 38, 'rec_loss': '6.7063'}
2025-02-23 13:59:56,240 - {'Epoch': 38, 'HR@5': '0.0862', 'NDCG@5': '0.0608', 'HR@10': '0.1210', 'NDCG@10': '0.0720', 'HR@20': '0.1649', 'NDCG@20': '0.0831'}
2025-02-23 13:59:56,241 - EarlyStopping counter: 7 out of 10
2025-02-23 14:00:22,806 - {'epoch': 39, 'rec_loss': '6.7033'}
2025-02-23 14:00:30,641 - {'Epoch': 39, 'HR@5': '0.0856', 'NDCG@5': '0.0602', 'HR@10': '0.1194', 'NDCG@10': '0.0711', 'HR@20': '0.1630', 'NDCG@20': '0.0820'}
2025-02-23 14:00:30,642 - EarlyStopping counter: 8 out of 10
2025-02-23 14:00:57,403 - {'epoch': 40, 'rec_loss': '6.7008'}
2025-02-23 14:01:05,710 - {'Epoch': 40, 'HR@5': '0.0865', 'NDCG@5': '0.0612', 'HR@10': '0.1204', 'NDCG@10': '0.0720', 'HR@20': '0.1653', 'NDCG@20': '0.0834'}
2025-02-23 14:01:05,711 - EarlyStopping counter: 9 out of 10
2025-02-23 14:01:34,116 - {'epoch': 41, 'rec_loss': '6.6893'}
2025-02-23 14:01:42,163 - {'Epoch': 41, 'HR@5': '0.0877', 'NDCG@5': '0.0620', 'HR@10': '0.1218', 'NDCG@10': '0.0729', 'HR@20': '0.1658', 'NDCG@20': '0.0840'}
2025-02-23 14:01:42,165 - EarlyStopping counter: 10 out of 10
2025-02-23 14:01:42,165 - Early stopping
2025-02-23 14:01:42,165 - ---------------Test Score---------------
2025-02-23 14:01:50,416 - {'Epoch': 0, 'HR@5': '0.0720', 'NDCG@5': '0.0502', 'HR@10': '0.0996', 'NDCG@10': '0.0591', 'HR@20': '0.1378', 'NDCG@20': '0.0687'}
2025-02-23 14:01:50,417 - Scale_Beauty
2025-02-23 14:01:50,417 - {'Epoch': 0, 'HR@5': '0.0720', 'NDCG@5': '0.0502', 'HR@10': '0.0996', 'NDCG@10': '0.0591', 'HR@20': '0.1378', 'NDCG@20': '0.0687'}
2025-02-23 14:05:44,601 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 12], start_prob=0.1, end_prob=0.4, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-23 14:05:47,410 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-23 14:05:47,415 - Total Parameters: 929445
2025-02-23 14:06:14,511 - {'epoch': 0, 'rec_loss': '8.8106'}
2025-02-23 14:06:22,016 - {'Epoch': 0, 'HR@5': '0.0224', 'NDCG@5': '0.0143', 'HR@10': '0.0344', 'NDCG@10': '0.0182', 'HR@20': '0.0519', 'NDCG@20': '0.0226'}
2025-02-23 14:06:22,017 - Validation score increased.  Saving model ...
2025-02-23 14:06:49,445 - {'epoch': 1, 'rec_loss': '8.2603'}
2025-02-23 14:06:57,807 - {'Epoch': 1, 'HR@5': '0.0407', 'NDCG@5': '0.0275', 'HR@10': '0.0604', 'NDCG@10': '0.0338', 'HR@20': '0.0868', 'NDCG@20': '0.0405'}
2025-02-23 14:06:57,808 - Validation score increased.  Saving model ...
2025-02-23 14:07:25,783 - {'epoch': 2, 'rec_loss': '7.9353'}
2025-02-23 14:07:34,023 - {'Epoch': 2, 'HR@5': '0.0541', 'NDCG@5': '0.0367', 'HR@10': '0.0793', 'NDCG@10': '0.0449', 'HR@20': '0.1125', 'NDCG@20': '0.0532'}
2025-02-23 14:07:34,025 - Validation score increased.  Saving model ...
2025-02-23 14:08:02,183 - {'epoch': 3, 'rec_loss': '7.7126'}
2025-02-23 14:08:09,941 - {'Epoch': 3, 'HR@5': '0.0650', 'NDCG@5': '0.0440', 'HR@10': '0.0921', 'NDCG@10': '0.0527', 'HR@20': '0.1284', 'NDCG@20': '0.0618'}
2025-02-23 14:08:09,942 - Validation score increased.  Saving model ...
2025-02-23 14:08:36,274 - {'epoch': 4, 'rec_loss': '7.5414'}
2025-02-23 14:08:44,189 - {'Epoch': 4, 'HR@5': '0.0723', 'NDCG@5': '0.0507', 'HR@10': '0.1011', 'NDCG@10': '0.0600', 'HR@20': '0.1377', 'NDCG@20': '0.0691'}
2025-02-23 14:08:44,191 - Validation score increased.  Saving model ...
2025-02-23 14:09:13,004 - {'epoch': 5, 'rec_loss': '7.4179'}
2025-02-23 14:09:20,747 - {'Epoch': 5, 'HR@5': '0.0769', 'NDCG@5': '0.0539', 'HR@10': '0.1062', 'NDCG@10': '0.0634', 'HR@20': '0.1446', 'NDCG@20': '0.0730'}
2025-02-23 14:09:20,748 - Validation score increased.  Saving model ...
2025-02-23 14:09:48,745 - {'epoch': 6, 'rec_loss': '7.3167'}
2025-02-23 14:09:57,694 - {'Epoch': 6, 'HR@5': '0.0786', 'NDCG@5': '0.0555', 'HR@10': '0.1078', 'NDCG@10': '0.0649', 'HR@20': '0.1485', 'NDCG@20': '0.0751'}
2025-02-23 14:09:57,701 - Validation score increased.  Saving model ...
2025-02-23 14:10:24,931 - {'epoch': 7, 'rec_loss': '7.2376'}
2025-02-23 14:10:32,741 - {'Epoch': 7, 'HR@5': '0.0816', 'NDCG@5': '0.0576', 'HR@10': '0.1121', 'NDCG@10': '0.0675', 'HR@20': '0.1521', 'NDCG@20': '0.0775'}
2025-02-23 14:10:32,742 - Validation score increased.  Saving model ...
2025-02-23 14:11:00,841 - {'epoch': 8, 'rec_loss': '7.1669'}
2025-02-23 14:11:08,473 - {'Epoch': 8, 'HR@5': '0.0820', 'NDCG@5': '0.0585', 'HR@10': '0.1117', 'NDCG@10': '0.0681', 'HR@20': '0.1518', 'NDCG@20': '0.0782'}
2025-02-23 14:11:08,474 - Validation score increased.  Saving model ...
2025-02-23 14:11:35,281 - {'epoch': 9, 'rec_loss': '7.1207'}
2025-02-23 14:11:42,853 - {'Epoch': 9, 'HR@5': '0.0830', 'NDCG@5': '0.0581', 'HR@10': '0.1147', 'NDCG@10': '0.0684', 'HR@20': '0.1527', 'NDCG@20': '0.0779'}
2025-02-23 14:11:42,861 - EarlyStopping counter: 1 out of 10
2025-02-23 14:12:10,356 - {'epoch': 10, 'rec_loss': '7.0725'}
2025-02-23 14:12:17,997 - {'Epoch': 10, 'HR@5': '0.0836', 'NDCG@5': '0.0591', 'HR@10': '0.1126', 'NDCG@10': '0.0685', 'HR@20': '0.1532', 'NDCG@20': '0.0787'}
2025-02-23 14:12:17,998 - Validation score increased.  Saving model ...
2025-02-23 14:12:44,767 - {'epoch': 11, 'rec_loss': '7.0345'}
2025-02-23 14:12:52,734 - {'Epoch': 11, 'HR@5': '0.0842', 'NDCG@5': '0.0599', 'HR@10': '0.1157', 'NDCG@10': '0.0701', 'HR@20': '0.1553', 'NDCG@20': '0.0801'}
2025-02-23 14:12:52,741 - Validation score increased.  Saving model ...
2025-02-23 14:13:19,953 - {'epoch': 12, 'rec_loss': '7.0020'}
2025-02-23 14:13:27,656 - {'Epoch': 12, 'HR@5': '0.0854', 'NDCG@5': '0.0601', 'HR@10': '0.1161', 'NDCG@10': '0.0700', 'HR@20': '0.1578', 'NDCG@20': '0.0805'}
2025-02-23 14:13:27,662 - Validation score increased.  Saving model ...
2025-02-23 14:13:55,653 - {'epoch': 13, 'rec_loss': '6.9746'}
2025-02-23 14:14:03,575 - {'Epoch': 13, 'HR@5': '0.0851', 'NDCG@5': '0.0601', 'HR@10': '0.1176', 'NDCG@10': '0.0706', 'HR@20': '0.1597', 'NDCG@20': '0.0812'}
2025-02-23 14:14:03,576 - Validation score increased.  Saving model ...
2025-02-23 14:14:30,911 - {'epoch': 14, 'rec_loss': '6.9453'}
2025-02-23 14:14:38,622 - {'Epoch': 14, 'HR@5': '0.0863', 'NDCG@5': '0.0608', 'HR@10': '0.1189', 'NDCG@10': '0.0712', 'HR@20': '0.1588', 'NDCG@20': '0.0813'}
2025-02-23 14:14:38,623 - Validation score increased.  Saving model ...
2025-02-23 14:15:06,556 - {'epoch': 15, 'rec_loss': '6.9244'}
2025-02-23 14:15:14,229 - {'Epoch': 15, 'HR@5': '0.0867', 'NDCG@5': '0.0611', 'HR@10': '0.1189', 'NDCG@10': '0.0714', 'HR@20': '0.1617', 'NDCG@20': '0.0822'}
2025-02-23 14:15:14,230 - Validation score increased.  Saving model ...
2025-02-23 14:15:42,675 - {'epoch': 16, 'rec_loss': '6.9018'}
2025-02-23 14:15:51,118 - {'Epoch': 16, 'HR@5': '0.0868', 'NDCG@5': '0.0608', 'HR@10': '0.1194', 'NDCG@10': '0.0713', 'HR@20': '0.1608', 'NDCG@20': '0.0817'}
2025-02-23 14:15:51,119 - EarlyStopping counter: 1 out of 10
2025-02-23 14:16:18,022 - {'epoch': 17, 'rec_loss': '6.8850'}
2025-02-23 14:16:26,299 - {'Epoch': 17, 'HR@5': '0.0861', 'NDCG@5': '0.0604', 'HR@10': '0.1188', 'NDCG@10': '0.0709', 'HR@20': '0.1604', 'NDCG@20': '0.0814'}
2025-02-23 14:16:26,300 - EarlyStopping counter: 2 out of 10
2025-02-23 14:16:53,570 - {'epoch': 18, 'rec_loss': '6.8615'}
2025-02-23 14:17:01,821 - {'Epoch': 18, 'HR@5': '0.0870', 'NDCG@5': '0.0612', 'HR@10': '0.1196', 'NDCG@10': '0.0717', 'HR@20': '0.1619', 'NDCG@20': '0.0823'}
2025-02-23 14:17:01,828 - Validation score increased.  Saving model ...
2025-02-23 14:17:27,109 - {'epoch': 19, 'rec_loss': '6.8477'}
2025-02-23 14:17:35,574 - {'Epoch': 19, 'HR@5': '0.0863', 'NDCG@5': '0.0606', 'HR@10': '0.1180', 'NDCG@10': '0.0708', 'HR@20': '0.1612', 'NDCG@20': '0.0817'}
2025-02-23 14:17:35,575 - EarlyStopping counter: 1 out of 10
2025-02-23 14:18:01,319 - {'epoch': 20, 'rec_loss': '6.8264'}
2025-02-23 14:18:10,302 - {'Epoch': 20, 'HR@5': '0.0872', 'NDCG@5': '0.0617', 'HR@10': '0.1207', 'NDCG@10': '0.0725', 'HR@20': '0.1612', 'NDCG@20': '0.0828'}
2025-02-23 14:18:10,303 - Validation score increased.  Saving model ...
2025-02-23 14:18:36,179 - {'epoch': 21, 'rec_loss': '6.8179'}
2025-02-23 14:18:44,645 - {'Epoch': 21, 'HR@5': '0.0881', 'NDCG@5': '0.0614', 'HR@10': '0.1204', 'NDCG@10': '0.0718', 'HR@20': '0.1627', 'NDCG@20': '0.0825'}
2025-02-23 14:18:44,646 - EarlyStopping counter: 1 out of 10
2025-02-23 14:19:12,030 - {'epoch': 22, 'rec_loss': '6.8014'}
2025-02-23 14:19:20,099 - {'Epoch': 22, 'HR@5': '0.0862', 'NDCG@5': '0.0615', 'HR@10': '0.1209', 'NDCG@10': '0.0727', 'HR@20': '0.1634', 'NDCG@20': '0.0834'}
2025-02-23 14:19:20,101 - Validation score increased.  Saving model ...
2025-02-23 14:19:46,116 - {'epoch': 23, 'rec_loss': '6.7908'}
2025-02-23 14:19:54,528 - {'Epoch': 23, 'HR@5': '0.0872', 'NDCG@5': '0.0612', 'HR@10': '0.1199', 'NDCG@10': '0.0718', 'HR@20': '0.1617', 'NDCG@20': '0.0823'}
2025-02-23 14:19:54,529 - EarlyStopping counter: 1 out of 10
2025-02-23 14:20:22,055 - {'epoch': 24, 'rec_loss': '6.7792'}
2025-02-23 14:20:30,466 - {'Epoch': 24, 'HR@5': '0.0856', 'NDCG@5': '0.0605', 'HR@10': '0.1199', 'NDCG@10': '0.0716', 'HR@20': '0.1625', 'NDCG@20': '0.0823'}
2025-02-23 14:20:30,468 - EarlyStopping counter: 2 out of 10
2025-02-23 14:20:58,259 - {'epoch': 25, 'rec_loss': '6.7654'}
2025-02-23 14:21:06,354 - {'Epoch': 25, 'HR@5': '0.0884', 'NDCG@5': '0.0621', 'HR@10': '0.1201', 'NDCG@10': '0.0723', 'HR@20': '0.1637', 'NDCG@20': '0.0833'}
2025-02-23 14:21:06,355 - EarlyStopping counter: 3 out of 10
2025-02-23 14:21:33,581 - {'epoch': 26, 'rec_loss': '6.7581'}
2025-02-23 14:21:41,542 - {'Epoch': 26, 'HR@5': '0.0883', 'NDCG@5': '0.0618', 'HR@10': '0.1197', 'NDCG@10': '0.0720', 'HR@20': '0.1616', 'NDCG@20': '0.0825'}
2025-02-23 14:21:41,547 - EarlyStopping counter: 4 out of 10
2025-02-23 14:22:08,150 - {'epoch': 27, 'rec_loss': '6.7445'}
2025-02-23 14:22:16,068 - {'Epoch': 27, 'HR@5': '0.0875', 'NDCG@5': '0.0617', 'HR@10': '0.1193', 'NDCG@10': '0.0720', 'HR@20': '0.1610', 'NDCG@20': '0.0825'}
2025-02-23 14:22:16,070 - EarlyStopping counter: 5 out of 10
2025-02-23 14:22:41,411 - {'epoch': 28, 'rec_loss': '6.7349'}
2025-02-23 14:22:50,462 - {'Epoch': 28, 'HR@5': '0.0867', 'NDCG@5': '0.0609', 'HR@10': '0.1203', 'NDCG@10': '0.0718', 'HR@20': '0.1623', 'NDCG@20': '0.0823'}
2025-02-23 14:22:50,463 - EarlyStopping counter: 6 out of 10
2025-02-23 14:23:19,905 - {'epoch': 29, 'rec_loss': '6.7283'}
2025-02-23 14:23:28,661 - {'Epoch': 29, 'HR@5': '0.0859', 'NDCG@5': '0.0607', 'HR@10': '0.1197', 'NDCG@10': '0.0716', 'HR@20': '0.1626', 'NDCG@20': '0.0824'}
2025-02-23 14:23:28,662 - EarlyStopping counter: 7 out of 10
2025-02-23 14:23:54,755 - {'epoch': 30, 'rec_loss': '6.7186'}
2025-02-23 14:24:02,450 - {'Epoch': 30, 'HR@5': '0.0865', 'NDCG@5': '0.0612', 'HR@10': '0.1210', 'NDCG@10': '0.0723', 'HR@20': '0.1643', 'NDCG@20': '0.0833'}
2025-02-23 14:24:02,454 - EarlyStopping counter: 8 out of 10
2025-02-23 14:24:28,678 - {'epoch': 31, 'rec_loss': '6.7071'}
2025-02-23 14:24:37,297 - {'Epoch': 31, 'HR@5': '0.0882', 'NDCG@5': '0.0621', 'HR@10': '0.1204', 'NDCG@10': '0.0725', 'HR@20': '0.1639', 'NDCG@20': '0.0834'}
2025-02-23 14:24:37,302 - Validation score increased.  Saving model ...
2025-02-23 14:25:03,006 - {'epoch': 32, 'rec_loss': '6.7045'}
2025-02-23 14:25:11,806 - {'Epoch': 32, 'HR@5': '0.0888', 'NDCG@5': '0.0621', 'HR@10': '0.1214', 'NDCG@10': '0.0726', 'HR@20': '0.1638', 'NDCG@20': '0.0833'}
2025-02-23 14:25:11,808 - EarlyStopping counter: 1 out of 10
2025-02-23 14:25:38,902 - {'epoch': 33, 'rec_loss': '6.6979'}
2025-02-23 14:25:48,230 - {'Epoch': 33, 'HR@5': '0.0873', 'NDCG@5': '0.0616', 'HR@10': '0.1205', 'NDCG@10': '0.0723', 'HR@20': '0.1623', 'NDCG@20': '0.0828'}
2025-02-23 14:25:48,236 - EarlyStopping counter: 2 out of 10
2025-02-23 14:26:17,595 - {'epoch': 34, 'rec_loss': '6.6844'}
2025-02-23 14:26:26,383 - {'Epoch': 34, 'HR@5': '0.0878', 'NDCG@5': '0.0616', 'HR@10': '0.1202', 'NDCG@10': '0.0720', 'HR@20': '0.1611', 'NDCG@20': '0.0823'}
2025-02-23 14:26:26,388 - EarlyStopping counter: 3 out of 10
2025-02-23 14:26:55,065 - {'epoch': 35, 'rec_loss': '6.6814'}
2025-02-23 14:27:04,012 - {'Epoch': 35, 'HR@5': '0.0868', 'NDCG@5': '0.0615', 'HR@10': '0.1183', 'NDCG@10': '0.0716', 'HR@20': '0.1642', 'NDCG@20': '0.0831'}
2025-02-23 14:27:04,014 - EarlyStopping counter: 4 out of 10
2025-02-23 14:27:29,519 - {'epoch': 36, 'rec_loss': '6.6683'}
2025-02-23 14:27:38,254 - {'Epoch': 36, 'HR@5': '0.0875', 'NDCG@5': '0.0616', 'HR@10': '0.1208', 'NDCG@10': '0.0724', 'HR@20': '0.1629', 'NDCG@20': '0.0830'}
2025-02-23 14:27:38,255 - EarlyStopping counter: 5 out of 10
2025-02-23 14:28:05,854 - {'epoch': 37, 'rec_loss': '6.6576'}
2025-02-23 14:28:13,612 - {'Epoch': 37, 'HR@5': '0.0872', 'NDCG@5': '0.0612', 'HR@10': '0.1208', 'NDCG@10': '0.0721', 'HR@20': '0.1648', 'NDCG@20': '0.0832'}
2025-02-23 14:28:13,613 - EarlyStopping counter: 6 out of 10
2025-02-23 14:28:42,019 - {'epoch': 38, 'rec_loss': '6.6533'}
2025-02-23 14:28:51,636 - {'Epoch': 38, 'HR@5': '0.0855', 'NDCG@5': '0.0611', 'HR@10': '0.1206', 'NDCG@10': '0.0723', 'HR@20': '0.1632', 'NDCG@20': '0.0831'}
2025-02-23 14:28:51,637 - EarlyStopping counter: 7 out of 10
2025-02-23 14:29:18,814 - {'epoch': 39, 'rec_loss': '6.6486'}
2025-02-23 14:29:28,053 - {'Epoch': 39, 'HR@5': '0.0849', 'NDCG@5': '0.0600', 'HR@10': '0.1181', 'NDCG@10': '0.0707', 'HR@20': '0.1595', 'NDCG@20': '0.0811'}
2025-02-23 14:29:28,055 - EarlyStopping counter: 8 out of 10
2025-02-23 14:29:56,616 - {'epoch': 40, 'rec_loss': '6.6470'}
2025-02-23 14:30:04,600 - {'Epoch': 40, 'HR@5': '0.0858', 'NDCG@5': '0.0605', 'HR@10': '0.1200', 'NDCG@10': '0.0715', 'HR@20': '0.1616', 'NDCG@20': '0.0820'}
2025-02-23 14:30:04,602 - EarlyStopping counter: 9 out of 10
2025-02-23 14:30:31,798 - {'epoch': 41, 'rec_loss': '6.6373'}
2025-02-23 14:30:40,361 - {'Epoch': 41, 'HR@5': '0.0864', 'NDCG@5': '0.0613', 'HR@10': '0.1208', 'NDCG@10': '0.0724', 'HR@20': '0.1630', 'NDCG@20': '0.0830'}
2025-02-23 14:30:40,363 - EarlyStopping counter: 10 out of 10
2025-02-23 14:30:40,363 - Early stopping
2025-02-23 14:30:40,363 - ---------------Test Score---------------
2025-02-23 14:30:48,150 - {'Epoch': 0, 'HR@5': '0.0717', 'NDCG@5': '0.0501', 'HR@10': '0.0991', 'NDCG@10': '0.0589', 'HR@20': '0.1369', 'NDCG@20': '0.0684'}
2025-02-23 14:30:48,151 - Scale_Beauty
2025-02-23 14:30:48,151 - {'Epoch': 0, 'HR@5': '0.0717', 'NDCG@5': '0.0501', 'HR@10': '0.0991', 'NDCG@10': '0.0589', 'HR@20': '0.1369', 'NDCG@20': '0.0684'}
2025-02-24 16:32:41,495 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 12], start_prob=0.0, end_prob=0.3, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-24 16:32:44,268 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-24 16:32:44,273 - Total Parameters: 929445
2025-02-24 16:33:10,324 - {'epoch': 0, 'rec_loss': '8.7930'}
2025-02-24 16:33:18,419 - {'Epoch': 0, 'HR@5': '0.0243', 'NDCG@5': '0.0156', 'HR@10': '0.0377', 'NDCG@10': '0.0199', 'HR@20': '0.0556', 'NDCG@20': '0.0244'}
2025-02-24 16:33:18,420 - Validation score increased.  Saving model ...
2025-02-24 16:33:44,470 - {'epoch': 1, 'rec_loss': '8.2064'}
2025-02-24 16:33:53,045 - {'Epoch': 1, 'HR@5': '0.0444', 'NDCG@5': '0.0298', 'HR@10': '0.0640', 'NDCG@10': '0.0362', 'HR@20': '0.0921', 'NDCG@20': '0.0432'}
2025-02-24 16:33:53,046 - Validation score increased.  Saving model ...
2025-02-24 16:34:19,959 - {'epoch': 2, 'rec_loss': '7.8686'}
2025-02-24 16:34:28,176 - {'Epoch': 2, 'HR@5': '0.0579', 'NDCG@5': '0.0404', 'HR@10': '0.0846', 'NDCG@10': '0.0489', 'HR@20': '0.1158', 'NDCG@20': '0.0567'}
2025-02-24 16:34:28,177 - Validation score increased.  Saving model ...
2025-02-24 16:34:54,376 - {'epoch': 3, 'rec_loss': '7.6364'}
2025-02-24 16:35:02,837 - {'Epoch': 3, 'HR@5': '0.0679', 'NDCG@5': '0.0467', 'HR@10': '0.0957', 'NDCG@10': '0.0557', 'HR@20': '0.1333', 'NDCG@20': '0.0651'}
2025-02-24 16:35:02,839 - Validation score increased.  Saving model ...
2025-02-24 16:35:27,685 - {'epoch': 4, 'rec_loss': '7.4586'}
2025-02-24 16:35:35,105 - {'Epoch': 4, 'HR@5': '0.0747', 'NDCG@5': '0.0523', 'HR@10': '0.1033', 'NDCG@10': '0.0615', 'HR@20': '0.1404', 'NDCG@20': '0.0708'}
2025-02-24 16:35:35,107 - Validation score increased.  Saving model ...
2025-02-24 16:36:00,056 - {'epoch': 5, 'rec_loss': '7.3282'}
2025-02-24 16:36:08,281 - {'Epoch': 5, 'HR@5': '0.0784', 'NDCG@5': '0.0551', 'HR@10': '0.1079', 'NDCG@10': '0.0646', 'HR@20': '0.1479', 'NDCG@20': '0.0747'}
2025-02-24 16:36:08,282 - Validation score increased.  Saving model ...
2025-02-24 16:36:33,149 - {'epoch': 6, 'rec_loss': '7.2264'}
2025-02-24 16:36:41,935 - {'Epoch': 6, 'HR@5': '0.0794', 'NDCG@5': '0.0563', 'HR@10': '0.1092', 'NDCG@10': '0.0659', 'HR@20': '0.1512', 'NDCG@20': '0.0765'}
2025-02-24 16:36:41,936 - Validation score increased.  Saving model ...
2025-02-24 16:37:07,155 - {'epoch': 7, 'rec_loss': '7.1487'}
2025-02-24 16:37:15,479 - {'Epoch': 7, 'HR@5': '0.0816', 'NDCG@5': '0.0580', 'HR@10': '0.1131', 'NDCG@10': '0.0681', 'HR@20': '0.1537', 'NDCG@20': '0.0783'}
2025-02-24 16:37:15,480 - Validation score increased.  Saving model ...
2025-02-24 16:37:42,590 - {'epoch': 8, 'rec_loss': '7.0794'}
2025-02-24 16:37:51,107 - {'Epoch': 8, 'HR@5': '0.0824', 'NDCG@5': '0.0586', 'HR@10': '0.1131', 'NDCG@10': '0.0685', 'HR@20': '0.1534', 'NDCG@20': '0.0787'}
2025-02-24 16:37:51,108 - Validation score increased.  Saving model ...
2025-02-24 16:38:16,887 - {'epoch': 9, 'rec_loss': '7.0293'}
2025-02-24 16:38:25,548 - {'Epoch': 9, 'HR@5': '0.0818', 'NDCG@5': '0.0578', 'HR@10': '0.1139', 'NDCG@10': '0.0681', 'HR@20': '0.1545', 'NDCG@20': '0.0783'}
2025-02-24 16:38:25,549 - EarlyStopping counter: 1 out of 10
2025-02-24 16:38:50,596 - {'epoch': 10, 'rec_loss': '6.9843'}
2025-02-24 16:38:59,100 - {'Epoch': 10, 'HR@5': '0.0819', 'NDCG@5': '0.0584', 'HR@10': '0.1136', 'NDCG@10': '0.0686', 'HR@20': '0.1539', 'NDCG@20': '0.0788'}
2025-02-24 16:38:59,101 - Validation score increased.  Saving model ...
2025-02-24 16:39:24,016 - {'epoch': 11, 'rec_loss': '6.9454'}
2025-02-24 16:39:32,696 - {'Epoch': 11, 'HR@5': '0.0842', 'NDCG@5': '0.0601', 'HR@10': '0.1168', 'NDCG@10': '0.0706', 'HR@20': '0.1569', 'NDCG@20': '0.0807'}
2025-02-24 16:39:32,697 - Validation score increased.  Saving model ...
2025-02-24 16:39:57,989 - {'epoch': 12, 'rec_loss': '6.9133'}
2025-02-24 16:40:05,646 - {'Epoch': 12, 'HR@5': '0.0832', 'NDCG@5': '0.0589', 'HR@10': '0.1170', 'NDCG@10': '0.0698', 'HR@20': '0.1565', 'NDCG@20': '0.0797'}
2025-02-24 16:40:05,647 - EarlyStopping counter: 1 out of 10
2025-02-24 16:40:30,543 - {'epoch': 13, 'rec_loss': '6.8844'}
2025-02-24 16:40:38,294 - {'Epoch': 13, 'HR@5': '0.0858', 'NDCG@5': '0.0600', 'HR@10': '0.1188', 'NDCG@10': '0.0707', 'HR@20': '0.1596', 'NDCG@20': '0.0809'}
2025-02-24 16:40:38,296 - Validation score increased.  Saving model ...
2025-02-24 16:41:04,349 - {'epoch': 14, 'rec_loss': '6.8524'}
2025-02-24 16:41:11,872 - {'Epoch': 14, 'HR@5': '0.0848', 'NDCG@5': '0.0592', 'HR@10': '0.1174', 'NDCG@10': '0.0698', 'HR@20': '0.1585', 'NDCG@20': '0.0801'}
2025-02-24 16:41:11,874 - EarlyStopping counter: 1 out of 10
2025-02-24 16:41:38,076 - {'epoch': 15, 'rec_loss': '6.8351'}
2025-02-24 16:41:45,728 - {'Epoch': 15, 'HR@5': '0.0857', 'NDCG@5': '0.0603', 'HR@10': '0.1180', 'NDCG@10': '0.0707', 'HR@20': '0.1598', 'NDCG@20': '0.0812'}
2025-02-24 16:41:45,729 - Validation score increased.  Saving model ...
2025-02-24 16:42:12,574 - {'epoch': 16, 'rec_loss': '6.8118'}
2025-02-24 16:42:21,458 - {'Epoch': 16, 'HR@5': '0.0850', 'NDCG@5': '0.0599', 'HR@10': '0.1173', 'NDCG@10': '0.0704', 'HR@20': '0.1603', 'NDCG@20': '0.0812'}
2025-02-24 16:42:21,459 - EarlyStopping counter: 1 out of 10
2025-02-24 16:42:46,362 - {'epoch': 17, 'rec_loss': '6.7963'}
2025-02-24 16:42:54,255 - {'Epoch': 17, 'HR@5': '0.0851', 'NDCG@5': '0.0593', 'HR@10': '0.1167', 'NDCG@10': '0.0695', 'HR@20': '0.1595', 'NDCG@20': '0.0803'}
2025-02-24 16:42:54,256 - EarlyStopping counter: 2 out of 10
2025-02-24 16:43:20,154 - {'epoch': 18, 'rec_loss': '6.7711'}
2025-02-24 16:43:28,707 - {'Epoch': 18, 'HR@5': '0.0856', 'NDCG@5': '0.0601', 'HR@10': '0.1173', 'NDCG@10': '0.0703', 'HR@20': '0.1597', 'NDCG@20': '0.0810'}
2025-02-24 16:43:28,708 - EarlyStopping counter: 3 out of 10
2025-02-24 16:43:53,662 - {'epoch': 19, 'rec_loss': '6.7566'}
2025-02-24 16:44:02,031 - {'Epoch': 19, 'HR@5': '0.0843', 'NDCG@5': '0.0595', 'HR@10': '0.1179', 'NDCG@10': '0.0702', 'HR@20': '0.1601', 'NDCG@20': '0.0809'}
2025-02-24 16:44:02,032 - EarlyStopping counter: 4 out of 10
2025-02-24 16:44:26,969 - {'epoch': 20, 'rec_loss': '6.7361'}
2025-02-24 16:44:35,008 - {'Epoch': 20, 'HR@5': '0.0863', 'NDCG@5': '0.0605', 'HR@10': '0.1196', 'NDCG@10': '0.0712', 'HR@20': '0.1618', 'NDCG@20': '0.0818'}
2025-02-24 16:44:35,009 - Validation score increased.  Saving model ...
2025-02-24 16:45:00,025 - {'epoch': 21, 'rec_loss': '6.7275'}
2025-02-24 16:45:07,592 - {'Epoch': 21, 'HR@5': '0.0860', 'NDCG@5': '0.0603', 'HR@10': '0.1190', 'NDCG@10': '0.0710', 'HR@20': '0.1621', 'NDCG@20': '0.0818'}
2025-02-24 16:45:07,593 - EarlyStopping counter: 1 out of 10
2025-02-24 16:45:32,444 - {'epoch': 22, 'rec_loss': '6.7098'}
2025-02-24 16:45:41,272 - {'Epoch': 22, 'HR@5': '0.0860', 'NDCG@5': '0.0611', 'HR@10': '0.1198', 'NDCG@10': '0.0720', 'HR@20': '0.1630', 'NDCG@20': '0.0829'}
2025-02-24 16:45:41,274 - Validation score increased.  Saving model ...
2025-02-24 16:46:06,180 - {'epoch': 23, 'rec_loss': '6.6976'}
2025-02-24 16:46:14,438 - {'Epoch': 23, 'HR@5': '0.0845', 'NDCG@5': '0.0599', 'HR@10': '0.1171', 'NDCG@10': '0.0705', 'HR@20': '0.1600', 'NDCG@20': '0.0813'}
2025-02-24 16:46:14,439 - EarlyStopping counter: 1 out of 10
2025-02-24 16:46:39,329 - {'epoch': 24, 'rec_loss': '6.6887'}
2025-02-24 16:46:47,848 - {'Epoch': 24, 'HR@5': '0.0840', 'NDCG@5': '0.0589', 'HR@10': '0.1196', 'NDCG@10': '0.0704', 'HR@20': '0.1611', 'NDCG@20': '0.0808'}
2025-02-24 16:46:47,850 - EarlyStopping counter: 2 out of 10
2025-02-24 16:47:13,422 - {'epoch': 25, 'rec_loss': '6.6706'}
2025-02-24 16:47:22,261 - {'Epoch': 25, 'HR@5': '0.0861', 'NDCG@5': '0.0606', 'HR@10': '0.1179', 'NDCG@10': '0.0709', 'HR@20': '0.1614', 'NDCG@20': '0.0819'}
2025-02-24 16:47:22,262 - EarlyStopping counter: 3 out of 10
2025-02-24 16:47:48,899 - {'epoch': 26, 'rec_loss': '6.6654'}
2025-02-24 16:47:57,558 - {'Epoch': 26, 'HR@5': '0.0859', 'NDCG@5': '0.0604', 'HR@10': '0.1183', 'NDCG@10': '0.0709', 'HR@20': '0.1600', 'NDCG@20': '0.0814'}
2025-02-24 16:47:57,559 - EarlyStopping counter: 4 out of 10
2025-02-24 16:48:22,460 - {'epoch': 27, 'rec_loss': '6.6504'}
2025-02-24 16:48:29,903 - {'Epoch': 27, 'HR@5': '0.0854', 'NDCG@5': '0.0606', 'HR@10': '0.1166', 'NDCG@10': '0.0706', 'HR@20': '0.1598', 'NDCG@20': '0.0816'}
2025-02-24 16:48:29,904 - EarlyStopping counter: 5 out of 10
2025-02-24 16:48:55,113 - {'epoch': 28, 'rec_loss': '6.6402'}
2025-02-24 16:49:02,626 - {'Epoch': 28, 'HR@5': '0.0853', 'NDCG@5': '0.0599', 'HR@10': '0.1193', 'NDCG@10': '0.0708', 'HR@20': '0.1612', 'NDCG@20': '0.0814'}
2025-02-24 16:49:02,628 - EarlyStopping counter: 6 out of 10
2025-02-24 16:49:27,485 - {'epoch': 29, 'rec_loss': '6.6311'}
2025-02-24 16:49:36,086 - {'Epoch': 29, 'HR@5': '0.0847', 'NDCG@5': '0.0597', 'HR@10': '0.1187', 'NDCG@10': '0.0707', 'HR@20': '0.1608', 'NDCG@20': '0.0813'}
2025-02-24 16:49:36,088 - EarlyStopping counter: 7 out of 10
2025-02-24 16:50:02,501 - {'epoch': 30, 'rec_loss': '6.6236'}
2025-02-24 16:50:10,081 - {'Epoch': 30, 'HR@5': '0.0861', 'NDCG@5': '0.0608', 'HR@10': '0.1190', 'NDCG@10': '0.0714', 'HR@20': '0.1616', 'NDCG@20': '0.0821'}
2025-02-24 16:50:10,082 - EarlyStopping counter: 8 out of 10
2025-02-24 16:50:36,319 - {'epoch': 31, 'rec_loss': '6.6102'}
2025-02-24 16:50:44,096 - {'Epoch': 31, 'HR@5': '0.0862', 'NDCG@5': '0.0604', 'HR@10': '0.1210', 'NDCG@10': '0.0716', 'HR@20': '0.1620', 'NDCG@20': '0.0819'}
2025-02-24 16:50:44,098 - EarlyStopping counter: 9 out of 10
2025-02-24 16:51:11,211 - {'epoch': 32, 'rec_loss': '6.6076'}
2025-02-24 16:51:18,800 - {'Epoch': 32, 'HR@5': '0.0863', 'NDCG@5': '0.0608', 'HR@10': '0.1200', 'NDCG@10': '0.0717', 'HR@20': '0.1616', 'NDCG@20': '0.0821'}
2025-02-24 16:51:18,801 - EarlyStopping counter: 10 out of 10
2025-02-24 16:51:18,801 - Early stopping
2025-02-24 16:51:18,801 - ---------------Test Score---------------
2025-02-24 16:51:27,672 - {'Epoch': 0, 'HR@5': '0.0712', 'NDCG@5': '0.0507', 'HR@10': '0.0995', 'NDCG@10': '0.0598', 'HR@20': '0.1365', 'NDCG@20': '0.0690'}
2025-02-24 16:51:27,677 - Scale_Beauty
2025-02-24 16:51:27,677 - {'Epoch': 0, 'HR@5': '0.0712', 'NDCG@5': '0.0507', 'HR@10': '0.0995', 'NDCG@10': '0.0598', 'HR@20': '0.1365', 'NDCG@20': '0.0690'}
2025-02-24 16:57:43,637 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 12], start_prob=0.4, end_prob=0.7, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-24 16:57:46,440 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-24 16:57:46,445 - Total Parameters: 929445
2025-02-24 16:58:15,095 - {'epoch': 0, 'rec_loss': '8.8870'}
2025-02-24 16:58:23,471 - {'Epoch': 0, 'HR@5': '0.0127', 'NDCG@5': '0.0079', 'HR@10': '0.0232', 'NDCG@10': '0.0113', 'HR@20': '0.0372', 'NDCG@20': '0.0148'}
2025-02-24 16:58:23,472 - Validation score increased.  Saving model ...
2025-02-24 16:58:51,456 - {'epoch': 1, 'rec_loss': '8.4777'}
2025-02-24 16:58:59,499 - {'Epoch': 1, 'HR@5': '0.0282', 'NDCG@5': '0.0181', 'HR@10': '0.0443', 'NDCG@10': '0.0233', 'HR@20': '0.0643', 'NDCG@20': '0.0283'}
2025-02-24 16:58:59,500 - Validation score increased.  Saving model ...
2025-02-24 16:59:27,663 - {'epoch': 2, 'rec_loss': '8.2253'}
2025-02-24 16:59:36,149 - {'Epoch': 2, 'HR@5': '0.0379', 'NDCG@5': '0.0252', 'HR@10': '0.0571', 'NDCG@10': '0.0314', 'HR@20': '0.0831', 'NDCG@20': '0.0380'}
2025-02-24 16:59:36,150 - Validation score increased.  Saving model ...
2025-02-24 17:00:03,928 - {'epoch': 3, 'rec_loss': '8.0265'}
2025-02-24 17:00:11,864 - {'Epoch': 3, 'HR@5': '0.0455', 'NDCG@5': '0.0302', 'HR@10': '0.0689', 'NDCG@10': '0.0377', 'HR@20': '0.1035', 'NDCG@20': '0.0464'}
2025-02-24 17:00:11,865 - Validation score increased.  Saving model ...
2025-02-24 17:00:39,074 - {'epoch': 4, 'rec_loss': '7.8792'}
2025-02-24 17:00:47,239 - {'Epoch': 4, 'HR@5': '0.0551', 'NDCG@5': '0.0377', 'HR@10': '0.0801', 'NDCG@10': '0.0457', 'HR@20': '0.1137', 'NDCG@20': '0.0542'}
2025-02-24 17:00:47,241 - Validation score increased.  Saving model ...
2025-02-24 17:01:17,477 - {'epoch': 5, 'rec_loss': '7.7722'}
2025-02-24 17:01:25,477 - {'Epoch': 5, 'HR@5': '0.0601', 'NDCG@5': '0.0410', 'HR@10': '0.0888', 'NDCG@10': '0.0503', 'HR@20': '0.1244', 'NDCG@20': '0.0593'}
2025-02-24 17:01:25,478 - Validation score increased.  Saving model ...
2025-02-24 17:01:54,835 - {'epoch': 6, 'rec_loss': '7.6885'}
2025-02-24 17:02:02,581 - {'Epoch': 6, 'HR@5': '0.0652', 'NDCG@5': '0.0449', 'HR@10': '0.0931', 'NDCG@10': '0.0539', 'HR@20': '0.1297', 'NDCG@20': '0.0631'}
2025-02-24 17:02:02,586 - Validation score increased.  Saving model ...
2025-02-24 17:02:29,398 - {'epoch': 7, 'rec_loss': '7.6174'}
2025-02-24 17:02:37,540 - {'Epoch': 7, 'HR@5': '0.0684', 'NDCG@5': '0.0476', 'HR@10': '0.0970', 'NDCG@10': '0.0568', 'HR@20': '0.1355', 'NDCG@20': '0.0665'}
2025-02-24 17:02:37,546 - Validation score increased.  Saving model ...
2025-02-24 17:03:04,133 - {'epoch': 8, 'rec_loss': '7.5496'}
2025-02-24 17:03:12,291 - {'Epoch': 8, 'HR@5': '0.0715', 'NDCG@5': '0.0501', 'HR@10': '0.1005', 'NDCG@10': '0.0594', 'HR@20': '0.1400', 'NDCG@20': '0.0693'}
2025-02-24 17:03:12,292 - Validation score increased.  Saving model ...
2025-02-24 17:03:40,086 - {'epoch': 9, 'rec_loss': '7.5053'}
2025-02-24 17:03:48,314 - {'Epoch': 9, 'HR@5': '0.0719', 'NDCG@5': '0.0496', 'HR@10': '0.1042', 'NDCG@10': '0.0599', 'HR@20': '0.1436', 'NDCG@20': '0.0699'}
2025-02-24 17:03:48,315 - Validation score increased.  Saving model ...
2025-02-24 17:04:15,571 - {'epoch': 10, 'rec_loss': '7.4562'}
2025-02-24 17:04:23,868 - {'Epoch': 10, 'HR@5': '0.0766', 'NDCG@5': '0.0531', 'HR@10': '0.1059', 'NDCG@10': '0.0626', 'HR@20': '0.1470', 'NDCG@20': '0.0729'}
2025-02-24 17:04:23,869 - Validation score increased.  Saving model ...
2025-02-24 17:04:51,728 - {'epoch': 11, 'rec_loss': '7.4175'}
2025-02-24 17:04:59,926 - {'Epoch': 11, 'HR@5': '0.0765', 'NDCG@5': '0.0532', 'HR@10': '0.1080', 'NDCG@10': '0.0633', 'HR@20': '0.1482', 'NDCG@20': '0.0734'}
2025-02-24 17:04:59,928 - Validation score increased.  Saving model ...
2025-02-24 17:05:27,172 - {'epoch': 12, 'rec_loss': '7.3825'}
2025-02-24 17:05:35,703 - {'Epoch': 12, 'HR@5': '0.0789', 'NDCG@5': '0.0549', 'HR@10': '0.1088', 'NDCG@10': '0.0645', 'HR@20': '0.1513', 'NDCG@20': '0.0752'}
2025-02-24 17:05:35,704 - Validation score increased.  Saving model ...
2025-02-24 17:06:02,354 - {'epoch': 13, 'rec_loss': '7.3575'}
2025-02-24 17:06:10,477 - {'Epoch': 13, 'HR@5': '0.0791', 'NDCG@5': '0.0551', 'HR@10': '0.1114', 'NDCG@10': '0.0655', 'HR@20': '0.1520', 'NDCG@20': '0.0757'}
2025-02-24 17:06:10,482 - Validation score increased.  Saving model ...
2025-02-24 17:06:39,074 - {'epoch': 14, 'rec_loss': '7.3275'}
2025-02-24 17:06:47,380 - {'Epoch': 14, 'HR@5': '0.0810', 'NDCG@5': '0.0560', 'HR@10': '0.1147', 'NDCG@10': '0.0668', 'HR@20': '0.1551', 'NDCG@20': '0.0769'}
2025-02-24 17:06:47,381 - Validation score increased.  Saving model ...
2025-02-24 17:07:13,754 - {'epoch': 15, 'rec_loss': '7.2987'}
2025-02-24 17:07:22,156 - {'Epoch': 15, 'HR@5': '0.0814', 'NDCG@5': '0.0558', 'HR@10': '0.1143', 'NDCG@10': '0.0664', 'HR@20': '0.1560', 'NDCG@20': '0.0769'}
2025-02-24 17:07:22,157 - EarlyStopping counter: 1 out of 10
2025-02-24 17:07:47,854 - {'epoch': 16, 'rec_loss': '7.2762'}
2025-02-24 17:07:56,016 - {'Epoch': 16, 'HR@5': '0.0812', 'NDCG@5': '0.0567', 'HR@10': '0.1147', 'NDCG@10': '0.0674', 'HR@20': '0.1564', 'NDCG@20': '0.0779'}
2025-02-24 17:07:56,018 - Validation score increased.  Saving model ...
2025-02-24 17:08:24,673 - {'epoch': 17, 'rec_loss': '7.2556'}
2025-02-24 17:08:32,641 - {'Epoch': 17, 'HR@5': '0.0824', 'NDCG@5': '0.0576', 'HR@10': '0.1152', 'NDCG@10': '0.0682', 'HR@20': '0.1571', 'NDCG@20': '0.0787'}
2025-02-24 17:08:32,642 - Validation score increased.  Saving model ...
2025-02-24 17:09:00,485 - {'epoch': 18, 'rec_loss': '7.2361'}
2025-02-24 17:09:09,282 - {'Epoch': 18, 'HR@5': '0.0829', 'NDCG@5': '0.0584', 'HR@10': '0.1146', 'NDCG@10': '0.0685', 'HR@20': '0.1584', 'NDCG@20': '0.0796'}
2025-02-24 17:09:09,283 - Validation score increased.  Saving model ...
2025-02-24 17:09:36,301 - {'epoch': 19, 'rec_loss': '7.2144'}
2025-02-24 17:09:44,739 - {'Epoch': 19, 'HR@5': '0.0835', 'NDCG@5': '0.0590', 'HR@10': '0.1159', 'NDCG@10': '0.0694', 'HR@20': '0.1585', 'NDCG@20': '0.0801'}
2025-02-24 17:09:44,741 - Validation score increased.  Saving model ...
2025-02-24 17:10:13,407 - {'epoch': 20, 'rec_loss': '7.1969'}
2025-02-24 17:10:22,203 - {'Epoch': 20, 'HR@5': '0.0836', 'NDCG@5': '0.0588', 'HR@10': '0.1176', 'NDCG@10': '0.0697', 'HR@20': '0.1599', 'NDCG@20': '0.0804'}
2025-02-24 17:10:22,204 - Validation score increased.  Saving model ...
2025-02-24 17:10:47,740 - {'epoch': 21, 'rec_loss': '7.1822'}
2025-02-24 17:10:56,431 - {'Epoch': 21, 'HR@5': '0.0852', 'NDCG@5': '0.0600', 'HR@10': '0.1172', 'NDCG@10': '0.0702', 'HR@20': '0.1612', 'NDCG@20': '0.0813'}
2025-02-24 17:10:56,432 - Validation score increased.  Saving model ...
2025-02-24 17:11:25,192 - {'epoch': 22, 'rec_loss': '7.1699'}
2025-02-24 17:11:34,291 - {'Epoch': 22, 'HR@5': '0.0860', 'NDCG@5': '0.0602', 'HR@10': '0.1185', 'NDCG@10': '0.0706', 'HR@20': '0.1596', 'NDCG@20': '0.0809'}
2025-02-24 17:11:34,292 - EarlyStopping counter: 1 out of 10
2025-02-24 17:12:01,422 - {'epoch': 23, 'rec_loss': '7.1588'}
2025-02-24 17:12:10,300 - {'Epoch': 23, 'HR@5': '0.0851', 'NDCG@5': '0.0601', 'HR@10': '0.1166', 'NDCG@10': '0.0702', 'HR@20': '0.1619', 'NDCG@20': '0.0816'}
2025-02-24 17:12:10,302 - Validation score increased.  Saving model ...
2025-02-24 17:12:35,782 - {'epoch': 24, 'rec_loss': '7.1467'}
2025-02-24 17:12:45,197 - {'Epoch': 24, 'HR@5': '0.0846', 'NDCG@5': '0.0598', 'HR@10': '0.1170', 'NDCG@10': '0.0702', 'HR@20': '0.1613', 'NDCG@20': '0.0813'}
2025-02-24 17:12:45,199 - EarlyStopping counter: 1 out of 10
2025-02-24 17:13:13,243 - {'epoch': 25, 'rec_loss': '7.1330'}
2025-02-24 17:13:21,132 - {'Epoch': 25, 'HR@5': '0.0842', 'NDCG@5': '0.0593', 'HR@10': '0.1173', 'NDCG@10': '0.0700', 'HR@20': '0.1625', 'NDCG@20': '0.0814'}
2025-02-24 17:13:21,133 - EarlyStopping counter: 2 out of 10
2025-02-24 17:13:48,719 - {'epoch': 26, 'rec_loss': '7.1250'}
2025-02-24 17:13:56,875 - {'Epoch': 26, 'HR@5': '0.0860', 'NDCG@5': '0.0600', 'HR@10': '0.1183', 'NDCG@10': '0.0704', 'HR@20': '0.1617', 'NDCG@20': '0.0813'}
2025-02-24 17:13:56,876 - EarlyStopping counter: 3 out of 10
2025-02-24 17:14:24,930 - {'epoch': 27, 'rec_loss': '7.1074'}
2025-02-24 17:14:33,080 - {'Epoch': 27, 'HR@5': '0.0850', 'NDCG@5': '0.0607', 'HR@10': '0.1181', 'NDCG@10': '0.0713', 'HR@20': '0.1618', 'NDCG@20': '0.0823'}
2025-02-24 17:14:33,081 - Validation score increased.  Saving model ...
2025-02-24 17:15:01,724 - {'epoch': 28, 'rec_loss': '7.1064'}
2025-02-24 17:15:09,873 - {'Epoch': 28, 'HR@5': '0.0833', 'NDCG@5': '0.0585', 'HR@10': '0.1189', 'NDCG@10': '0.0700', 'HR@20': '0.1618', 'NDCG@20': '0.0808'}
2025-02-24 17:15:09,874 - EarlyStopping counter: 1 out of 10
2025-02-24 17:15:39,624 - {'epoch': 29, 'rec_loss': '7.0933'}
2025-02-24 17:15:47,700 - {'Epoch': 29, 'HR@5': '0.0845', 'NDCG@5': '0.0591', 'HR@10': '0.1189', 'NDCG@10': '0.0702', 'HR@20': '0.1629', 'NDCG@20': '0.0812'}
2025-02-24 17:15:47,701 - EarlyStopping counter: 2 out of 10
2025-02-24 17:16:15,094 - {'epoch': 30, 'rec_loss': '7.0914'}
2025-02-24 17:16:23,012 - {'Epoch': 30, 'HR@5': '0.0862', 'NDCG@5': '0.0602', 'HR@10': '0.1194', 'NDCG@10': '0.0709', 'HR@20': '0.1637', 'NDCG@20': '0.0821'}
2025-02-24 17:16:23,013 - EarlyStopping counter: 3 out of 10
2025-02-24 17:16:51,428 - {'epoch': 31, 'rec_loss': '7.0755'}
2025-02-24 17:16:59,339 - {'Epoch': 31, 'HR@5': '0.0865', 'NDCG@5': '0.0608', 'HR@10': '0.1198', 'NDCG@10': '0.0715', 'HR@20': '0.1642', 'NDCG@20': '0.0827'}
2025-02-24 17:16:59,340 - Validation score increased.  Saving model ...
2025-02-24 17:17:26,363 - {'epoch': 32, 'rec_loss': '7.0738'}
2025-02-24 17:17:34,526 - {'Epoch': 32, 'HR@5': '0.0858', 'NDCG@5': '0.0604', 'HR@10': '0.1197', 'NDCG@10': '0.0713', 'HR@20': '0.1635', 'NDCG@20': '0.0824'}
2025-02-24 17:17:34,527 - EarlyStopping counter: 1 out of 10
2025-02-24 17:18:02,615 - {'epoch': 33, 'rec_loss': '7.0622'}
2025-02-24 17:18:10,837 - {'Epoch': 33, 'HR@5': '0.0863', 'NDCG@5': '0.0609', 'HR@10': '0.1202', 'NDCG@10': '0.0718', 'HR@20': '0.1635', 'NDCG@20': '0.0827'}
2025-02-24 17:18:10,843 - Validation score increased.  Saving model ...
2025-02-24 17:18:38,877 - {'epoch': 34, 'rec_loss': '7.0492'}
2025-02-24 17:18:46,988 - {'Epoch': 34, 'HR@5': '0.0871', 'NDCG@5': '0.0610', 'HR@10': '0.1196', 'NDCG@10': '0.0714', 'HR@20': '0.1631', 'NDCG@20': '0.0824'}
2025-02-24 17:18:46,990 - EarlyStopping counter: 1 out of 10
2025-02-24 17:19:13,715 - {'epoch': 35, 'rec_loss': '7.0452'}
2025-02-24 17:19:21,579 - {'Epoch': 35, 'HR@5': '0.0847', 'NDCG@5': '0.0595', 'HR@10': '0.1190', 'NDCG@10': '0.0705', 'HR@20': '0.1650', 'NDCG@20': '0.0820'}
2025-02-24 17:19:21,580 - EarlyStopping counter: 2 out of 10
2025-02-24 17:19:49,304 - {'epoch': 36, 'rec_loss': '7.0437'}
2025-02-24 17:19:57,442 - {'Epoch': 36, 'HR@5': '0.0858', 'NDCG@5': '0.0607', 'HR@10': '0.1189', 'NDCG@10': '0.0713', 'HR@20': '0.1641', 'NDCG@20': '0.0827'}
2025-02-24 17:19:57,443 - EarlyStopping counter: 3 out of 10
2025-02-24 17:20:25,362 - {'epoch': 37, 'rec_loss': '7.0295'}
2025-02-24 17:20:33,557 - {'Epoch': 37, 'HR@5': '0.0865', 'NDCG@5': '0.0609', 'HR@10': '0.1198', 'NDCG@10': '0.0716', 'HR@20': '0.1646', 'NDCG@20': '0.0829'}
2025-02-24 17:20:33,558 - Validation score increased.  Saving model ...
2025-02-24 17:21:02,134 - {'epoch': 38, 'rec_loss': '7.0262'}
2025-02-24 17:21:10,264 - {'Epoch': 38, 'HR@5': '0.0860', 'NDCG@5': '0.0605', 'HR@10': '0.1205', 'NDCG@10': '0.0716', 'HR@20': '0.1638', 'NDCG@20': '0.0825'}
2025-02-24 17:21:10,265 - EarlyStopping counter: 1 out of 10
2025-02-24 17:21:38,656 - {'epoch': 39, 'rec_loss': '7.0163'}
2025-02-24 17:21:47,396 - {'Epoch': 39, 'HR@5': '0.0843', 'NDCG@5': '0.0597', 'HR@10': '0.1192', 'NDCG@10': '0.0709', 'HR@20': '0.1624', 'NDCG@20': '0.0818'}
2025-02-24 17:21:47,397 - EarlyStopping counter: 2 out of 10
2025-02-24 17:22:16,946 - {'epoch': 40, 'rec_loss': '7.0170'}
2025-02-24 17:22:25,179 - {'Epoch': 40, 'HR@5': '0.0858', 'NDCG@5': '0.0604', 'HR@10': '0.1197', 'NDCG@10': '0.0714', 'HR@20': '0.1642', 'NDCG@20': '0.0826'}
2025-02-24 17:22:25,180 - EarlyStopping counter: 3 out of 10
2025-02-24 17:22:53,380 - {'epoch': 41, 'rec_loss': '7.0097'}
2025-02-24 17:23:01,448 - {'Epoch': 41, 'HR@5': '0.0869', 'NDCG@5': '0.0614', 'HR@10': '0.1212', 'NDCG@10': '0.0725', 'HR@20': '0.1650', 'NDCG@20': '0.0835'}
2025-02-24 17:23:01,450 - Validation score increased.  Saving model ...
2025-02-24 17:23:28,516 - {'epoch': 42, 'rec_loss': '7.0019'}
2025-02-24 17:23:36,604 - {'Epoch': 42, 'HR@5': '0.0856', 'NDCG@5': '0.0609', 'HR@10': '0.1204', 'NDCG@10': '0.0722', 'HR@20': '0.1655', 'NDCG@20': '0.0836'}
2025-02-24 17:23:36,608 - Validation score increased.  Saving model ...
2025-02-24 17:24:03,285 - {'epoch': 43, 'rec_loss': '6.9976'}
2025-02-24 17:24:11,427 - {'Epoch': 43, 'HR@5': '0.0868', 'NDCG@5': '0.0606', 'HR@10': '0.1206', 'NDCG@10': '0.0715', 'HR@20': '0.1649', 'NDCG@20': '0.0826'}
2025-02-24 17:24:11,428 - EarlyStopping counter: 1 out of 10
2025-02-24 17:24:39,728 - {'epoch': 44, 'rec_loss': '6.9942'}
2025-02-24 17:24:48,111 - {'Epoch': 44, 'HR@5': '0.0868', 'NDCG@5': '0.0612', 'HR@10': '0.1186', 'NDCG@10': '0.0715', 'HR@20': '0.1628', 'NDCG@20': '0.0826'}
2025-02-24 17:24:48,112 - EarlyStopping counter: 2 out of 10
2025-02-24 17:25:15,347 - {'epoch': 45, 'rec_loss': '6.9900'}
2025-02-24 17:25:23,185 - {'Epoch': 45, 'HR@5': '0.0872', 'NDCG@5': '0.0614', 'HR@10': '0.1200', 'NDCG@10': '0.0720', 'HR@20': '0.1656', 'NDCG@20': '0.0835'}
2025-02-24 17:25:23,187 - EarlyStopping counter: 3 out of 10
2025-02-24 17:25:50,857 - {'epoch': 46, 'rec_loss': '6.9751'}
2025-02-24 17:25:58,540 - {'Epoch': 46, 'HR@5': '0.0871', 'NDCG@5': '0.0617', 'HR@10': '0.1206', 'NDCG@10': '0.0725', 'HR@20': '0.1647', 'NDCG@20': '0.0836'}
2025-02-24 17:25:58,542 - Validation score increased.  Saving model ...
2025-02-24 17:26:27,567 - {'epoch': 47, 'rec_loss': '6.9699'}
2025-02-24 17:26:35,650 - {'Epoch': 47, 'HR@5': '0.0875', 'NDCG@5': '0.0614', 'HR@10': '0.1197', 'NDCG@10': '0.0717', 'HR@20': '0.1649', 'NDCG@20': '0.0831'}
2025-02-24 17:26:35,651 - EarlyStopping counter: 1 out of 10
2025-02-24 17:27:02,854 - {'epoch': 48, 'rec_loss': '6.9738'}
2025-02-24 17:27:11,174 - {'Epoch': 48, 'HR@5': '0.0876', 'NDCG@5': '0.0619', 'HR@10': '0.1219', 'NDCG@10': '0.0729', 'HR@20': '0.1646', 'NDCG@20': '0.0837'}
2025-02-24 17:27:11,175 - Validation score increased.  Saving model ...
2025-02-24 17:27:39,679 - {'epoch': 49, 'rec_loss': '6.9688'}
2025-02-24 17:27:48,456 - {'Epoch': 49, 'HR@5': '0.0869', 'NDCG@5': '0.0610', 'HR@10': '0.1220', 'NDCG@10': '0.0723', 'HR@20': '0.1651', 'NDCG@20': '0.0832'}
2025-02-24 17:27:48,457 - EarlyStopping counter: 1 out of 10
2025-02-24 17:28:16,131 - {'epoch': 50, 'rec_loss': '6.9640'}
2025-02-24 17:28:24,280 - {'Epoch': 50, 'HR@5': '0.0878', 'NDCG@5': '0.0617', 'HR@10': '0.1215', 'NDCG@10': '0.0726', 'HR@20': '0.1662', 'NDCG@20': '0.0838'}
2025-02-24 17:28:24,281 - Validation score increased.  Saving model ...
2025-02-24 17:28:51,967 - {'epoch': 51, 'rec_loss': '6.9640'}
2025-02-24 17:29:00,560 - {'Epoch': 51, 'HR@5': '0.0864', 'NDCG@5': '0.0603', 'HR@10': '0.1217', 'NDCG@10': '0.0717', 'HR@20': '0.1657', 'NDCG@20': '0.0828'}
2025-02-24 17:29:00,562 - EarlyStopping counter: 1 out of 10
2025-02-24 17:29:26,395 - {'epoch': 52, 'rec_loss': '6.9504'}
2025-02-24 17:29:34,459 - {'Epoch': 52, 'HR@5': '0.0871', 'NDCG@5': '0.0610', 'HR@10': '0.1214', 'NDCG@10': '0.0720', 'HR@20': '0.1669', 'NDCG@20': '0.0835'}
2025-02-24 17:29:34,460 - EarlyStopping counter: 2 out of 10
2025-02-24 17:30:00,285 - {'epoch': 53, 'rec_loss': '6.9558'}
2025-02-24 17:30:08,581 - {'Epoch': 53, 'HR@5': '0.0870', 'NDCG@5': '0.0613', 'HR@10': '0.1215', 'NDCG@10': '0.0724', 'HR@20': '0.1673', 'NDCG@20': '0.0839'}
2025-02-24 17:30:08,582 - Validation score increased.  Saving model ...
2025-02-24 17:30:35,021 - {'epoch': 54, 'rec_loss': '6.9465'}
2025-02-24 17:30:44,803 - {'Epoch': 54, 'HR@5': '0.0881', 'NDCG@5': '0.0618', 'HR@10': '0.1214', 'NDCG@10': '0.0726', 'HR@20': '0.1658', 'NDCG@20': '0.0837'}
2025-02-24 17:30:44,810 - EarlyStopping counter: 1 out of 10
2025-02-24 17:31:11,147 - {'epoch': 55, 'rec_loss': '6.9378'}
2025-02-24 17:31:20,602 - {'Epoch': 55, 'HR@5': '0.0876', 'NDCG@5': '0.0618', 'HR@10': '0.1215', 'NDCG@10': '0.0727', 'HR@20': '0.1669', 'NDCG@20': '0.0841'}
2025-02-24 17:31:20,608 - Validation score increased.  Saving model ...
2025-02-24 17:31:48,375 - {'epoch': 56, 'rec_loss': '6.9416'}
2025-02-24 17:31:58,291 - {'Epoch': 56, 'HR@5': '0.0883', 'NDCG@5': '0.0622', 'HR@10': '0.1207', 'NDCG@10': '0.0726', 'HR@20': '0.1668', 'NDCG@20': '0.0842'}
2025-02-24 17:31:58,292 - Validation score increased.  Saving model ...
2025-02-24 17:32:26,478 - {'epoch': 57, 'rec_loss': '6.9446'}
2025-02-24 17:32:34,417 - {'Epoch': 57, 'HR@5': '0.0871', 'NDCG@5': '0.0613', 'HR@10': '0.1215', 'NDCG@10': '0.0724', 'HR@20': '0.1656', 'NDCG@20': '0.0835'}
2025-02-24 17:32:34,419 - EarlyStopping counter: 1 out of 10
2025-02-24 17:33:02,012 - {'epoch': 58, 'rec_loss': '6.9375'}
2025-02-24 17:33:11,553 - {'Epoch': 58, 'HR@5': '0.0878', 'NDCG@5': '0.0618', 'HR@10': '0.1212', 'NDCG@10': '0.0726', 'HR@20': '0.1665', 'NDCG@20': '0.0839'}
2025-02-24 17:33:11,554 - EarlyStopping counter: 2 out of 10
2025-02-24 17:33:38,314 - {'epoch': 59, 'rec_loss': '6.9254'}
2025-02-24 17:33:47,753 - {'Epoch': 59, 'HR@5': '0.0881', 'NDCG@5': '0.0617', 'HR@10': '0.1218', 'NDCG@10': '0.0726', 'HR@20': '0.1678', 'NDCG@20': '0.0841'}
2025-02-24 17:33:47,754 - EarlyStopping counter: 3 out of 10
2025-02-24 17:34:16,922 - {'epoch': 60, 'rec_loss': '6.9198'}
2025-02-24 17:34:24,876 - {'Epoch': 60, 'HR@5': '0.0876', 'NDCG@5': '0.0625', 'HR@10': '0.1210', 'NDCG@10': '0.0733', 'HR@20': '0.1679', 'NDCG@20': '0.0850'}
2025-02-24 17:34:24,878 - Validation score increased.  Saving model ...
2025-02-24 17:34:50,042 - {'epoch': 61, 'rec_loss': '6.9198'}
2025-02-24 17:34:58,892 - {'Epoch': 61, 'HR@5': '0.0883', 'NDCG@5': '0.0628', 'HR@10': '0.1235', 'NDCG@10': '0.0742', 'HR@20': '0.1682', 'NDCG@20': '0.0854'}
2025-02-24 17:34:58,894 - Validation score increased.  Saving model ...
2025-02-24 17:35:24,780 - {'epoch': 62, 'rec_loss': '6.9243'}
2025-02-24 17:35:33,627 - {'Epoch': 62, 'HR@5': '0.0889', 'NDCG@5': '0.0634', 'HR@10': '0.1210', 'NDCG@10': '0.0737', 'HR@20': '0.1663', 'NDCG@20': '0.0851'}
2025-02-24 17:35:33,628 - EarlyStopping counter: 1 out of 10
2025-02-24 17:35:59,201 - {'epoch': 63, 'rec_loss': '6.9121'}
2025-02-24 17:36:08,891 - {'Epoch': 63, 'HR@5': '0.0886', 'NDCG@5': '0.0624', 'HR@10': '0.1217', 'NDCG@10': '0.0731', 'HR@20': '0.1654', 'NDCG@20': '0.0841'}
2025-02-24 17:36:08,892 - EarlyStopping counter: 2 out of 10
2025-02-24 17:36:37,905 - {'epoch': 64, 'rec_loss': '6.9078'}
2025-02-24 17:36:46,896 - {'Epoch': 64, 'HR@5': '0.0898', 'NDCG@5': '0.0634', 'HR@10': '0.1210', 'NDCG@10': '0.0734', 'HR@20': '0.1662', 'NDCG@20': '0.0848'}
2025-02-24 17:36:46,897 - EarlyStopping counter: 3 out of 10
2025-02-24 17:37:14,368 - {'epoch': 65, 'rec_loss': '6.9130'}
2025-02-24 17:37:22,734 - {'Epoch': 65, 'HR@5': '0.0877', 'NDCG@5': '0.0617', 'HR@10': '0.1208', 'NDCG@10': '0.0724', 'HR@20': '0.1657', 'NDCG@20': '0.0837'}
2025-02-24 17:37:22,735 - EarlyStopping counter: 4 out of 10
2025-02-24 17:37:48,711 - {'epoch': 66, 'rec_loss': '6.9051'}
2025-02-24 17:37:57,520 - {'Epoch': 66, 'HR@5': '0.0886', 'NDCG@5': '0.0622', 'HR@10': '0.1215', 'NDCG@10': '0.0728', 'HR@20': '0.1655', 'NDCG@20': '0.0839'}
2025-02-24 17:37:57,521 - EarlyStopping counter: 5 out of 10
2025-02-24 17:38:24,873 - {'epoch': 67, 'rec_loss': '6.9047'}
2025-02-24 17:38:34,277 - {'Epoch': 67, 'HR@5': '0.0875', 'NDCG@5': '0.0615', 'HR@10': '0.1225', 'NDCG@10': '0.0728', 'HR@20': '0.1665', 'NDCG@20': '0.0839'}
2025-02-24 17:38:34,278 - EarlyStopping counter: 6 out of 10
2025-02-24 17:39:05,692 - {'epoch': 68, 'rec_loss': '6.9068'}
2025-02-24 17:39:13,548 - {'Epoch': 68, 'HR@5': '0.0876', 'NDCG@5': '0.0621', 'HR@10': '0.1228', 'NDCG@10': '0.0735', 'HR@20': '0.1672', 'NDCG@20': '0.0847'}
2025-02-24 17:39:13,549 - EarlyStopping counter: 7 out of 10
2025-02-24 17:39:40,852 - {'epoch': 69, 'rec_loss': '6.8941'}
2025-02-24 17:39:48,530 - {'Epoch': 69, 'HR@5': '0.0886', 'NDCG@5': '0.0630', 'HR@10': '0.1226', 'NDCG@10': '0.0740', 'HR@20': '0.1657', 'NDCG@20': '0.0849'}
2025-02-24 17:39:48,531 - EarlyStopping counter: 8 out of 10
2025-02-24 17:40:14,727 - {'epoch': 70, 'rec_loss': '6.8944'}
2025-02-24 17:40:24,092 - {'Epoch': 70, 'HR@5': '0.0886', 'NDCG@5': '0.0619', 'HR@10': '0.1215', 'NDCG@10': '0.0725', 'HR@20': '0.1664', 'NDCG@20': '0.0838'}
2025-02-24 17:40:24,093 - EarlyStopping counter: 9 out of 10
2025-02-24 17:40:51,286 - {'epoch': 71, 'rec_loss': '6.8951'}
2025-02-24 17:40:59,948 - {'Epoch': 71, 'HR@5': '0.0894', 'NDCG@5': '0.0627', 'HR@10': '0.1215', 'NDCG@10': '0.0730', 'HR@20': '0.1674', 'NDCG@20': '0.0845'}
2025-02-24 17:40:59,949 - EarlyStopping counter: 10 out of 10
2025-02-24 17:40:59,949 - Early stopping
2025-02-24 17:40:59,949 - ---------------Test Score---------------
2025-02-24 17:41:08,129 - {'Epoch': 0, 'HR@5': '0.0713', 'NDCG@5': '0.0507', 'HR@10': '0.0993', 'NDCG@10': '0.0597', 'HR@20': '0.1373', 'NDCG@20': '0.0693'}
2025-02-24 17:41:08,130 - Scale_Beauty
2025-02-24 17:41:08,130 - {'Epoch': 0, 'HR@5': '0.0713', 'NDCG@5': '0.0507', 'HR@10': '0.0993', 'NDCG@10': '0.0597', 'HR@20': '0.1373', 'NDCG@20': '0.0693'}
2025-02-24 18:44:09,743 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 12], start_prob=0.5, end_prob=0.8, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-24 18:44:12,541 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-24 18:44:12,546 - Total Parameters: 929445
2025-02-24 18:44:40,933 - {'epoch': 0, 'rec_loss': '8.9268'}
2025-02-24 18:44:48,538 - {'Epoch': 0, 'HR@5': '0.0121', 'NDCG@5': '0.0075', 'HR@10': '0.0219', 'NDCG@10': '0.0107', 'HR@20': '0.0355', 'NDCG@20': '0.0141'}
2025-02-24 18:44:48,543 - Validation score increased.  Saving model ...
2025-02-24 18:45:13,880 - {'epoch': 1, 'rec_loss': '8.5646'}
2025-02-24 18:45:22,064 - {'Epoch': 1, 'HR@5': '0.0242', 'NDCG@5': '0.0157', 'HR@10': '0.0365', 'NDCG@10': '0.0197', 'HR@20': '0.0525', 'NDCG@20': '0.0237'}
2025-02-24 18:45:22,065 - Validation score increased.  Saving model ...
2025-02-24 18:45:49,943 - {'epoch': 2, 'rec_loss': '8.3556'}
2025-02-24 18:45:57,703 - {'Epoch': 2, 'HR@5': '0.0322', 'NDCG@5': '0.0205', 'HR@10': '0.0505', 'NDCG@10': '0.0264', 'HR@20': '0.0737', 'NDCG@20': '0.0322'}
2025-02-24 18:45:57,709 - Validation score increased.  Saving model ...
2025-02-24 18:46:25,229 - {'epoch': 3, 'rec_loss': '8.1809'}
2025-02-24 18:46:32,963 - {'Epoch': 3, 'HR@5': '0.0373', 'NDCG@5': '0.0247', 'HR@10': '0.0571', 'NDCG@10': '0.0311', 'HR@20': '0.0880', 'NDCG@20': '0.0389'}
2025-02-24 18:46:32,970 - Validation score increased.  Saving model ...
2025-02-24 18:47:00,336 - {'epoch': 4, 'rec_loss': '8.0408'}
2025-02-24 18:47:07,780 - {'Epoch': 4, 'HR@5': '0.0450', 'NDCG@5': '0.0312', 'HR@10': '0.0677', 'NDCG@10': '0.0384', 'HR@20': '0.0999', 'NDCG@20': '0.0466'}
2025-02-24 18:47:07,785 - Validation score increased.  Saving model ...
2025-02-24 18:47:35,731 - {'epoch': 5, 'rec_loss': '7.9309'}
2025-02-24 18:47:43,303 - {'Epoch': 5, 'HR@5': '0.0504', 'NDCG@5': '0.0337', 'HR@10': '0.0776', 'NDCG@10': '0.0424', 'HR@20': '0.1117', 'NDCG@20': '0.0510'}
2025-02-24 18:47:43,308 - Validation score increased.  Saving model ...
2025-02-24 18:48:11,484 - {'epoch': 6, 'rec_loss': '7.8489'}
2025-02-24 18:48:18,876 - {'Epoch': 6, 'HR@5': '0.0544', 'NDCG@5': '0.0372', 'HR@10': '0.0802', 'NDCG@10': '0.0455', 'HR@20': '0.1181', 'NDCG@20': '0.0551'}
2025-02-24 18:48:18,878 - Validation score increased.  Saving model ...
2025-02-24 18:48:45,896 - {'epoch': 7, 'rec_loss': '7.7809'}
2025-02-24 18:48:53,797 - {'Epoch': 7, 'HR@5': '0.0597', 'NDCG@5': '0.0407', 'HR@10': '0.0858', 'NDCG@10': '0.0490', 'HR@20': '0.1238', 'NDCG@20': '0.0586'}
2025-02-24 18:48:53,803 - Validation score increased.  Saving model ...
2025-02-24 18:49:21,171 - {'epoch': 8, 'rec_loss': '7.7213'}
2025-02-24 18:49:28,670 - {'Epoch': 8, 'HR@5': '0.0626', 'NDCG@5': '0.0429', 'HR@10': '0.0932', 'NDCG@10': '0.0527', 'HR@20': '0.1284', 'NDCG@20': '0.0616'}
2025-02-24 18:49:28,671 - Validation score increased.  Saving model ...
2025-02-24 18:49:56,023 - {'epoch': 9, 'rec_loss': '7.6802'}
2025-02-24 18:50:03,439 - {'Epoch': 9, 'HR@5': '0.0650', 'NDCG@5': '0.0441', 'HR@10': '0.0942', 'NDCG@10': '0.0535', 'HR@20': '0.1322', 'NDCG@20': '0.0631'}
2025-02-24 18:50:03,443 - Validation score increased.  Saving model ...
2025-02-24 18:50:31,426 - {'epoch': 10, 'rec_loss': '7.6329'}
2025-02-24 18:50:38,974 - {'Epoch': 10, 'HR@5': '0.0689', 'NDCG@5': '0.0468', 'HR@10': '0.0978', 'NDCG@10': '0.0560', 'HR@20': '0.1360', 'NDCG@20': '0.0656'}
2025-02-24 18:50:38,979 - Validation score increased.  Saving model ...
2025-02-24 18:51:06,376 - {'epoch': 11, 'rec_loss': '7.6001'}
2025-02-24 18:51:14,095 - {'Epoch': 11, 'HR@5': '0.0691', 'NDCG@5': '0.0474', 'HR@10': '0.0987', 'NDCG@10': '0.0570', 'HR@20': '0.1364', 'NDCG@20': '0.0665'}
2025-02-24 18:51:14,096 - Validation score increased.  Saving model ...
2025-02-24 18:51:44,812 - {'epoch': 12, 'rec_loss': '7.5647'}
2025-02-24 18:51:52,971 - {'Epoch': 12, 'HR@5': '0.0705', 'NDCG@5': '0.0486', 'HR@10': '0.1024', 'NDCG@10': '0.0589', 'HR@20': '0.1413', 'NDCG@20': '0.0687'}
2025-02-24 18:51:52,972 - Validation score increased.  Saving model ...
2025-02-24 18:52:20,990 - {'epoch': 13, 'rec_loss': '7.5365'}
2025-02-24 18:52:28,557 - {'Epoch': 13, 'HR@5': '0.0715', 'NDCG@5': '0.0493', 'HR@10': '0.1041', 'NDCG@10': '0.0599', 'HR@20': '0.1420', 'NDCG@20': '0.0694'}
2025-02-24 18:52:28,563 - Validation score increased.  Saving model ...
2025-02-24 18:52:56,653 - {'epoch': 14, 'rec_loss': '7.5166'}
2025-02-24 18:53:04,015 - {'Epoch': 14, 'HR@5': '0.0739', 'NDCG@5': '0.0514', 'HR@10': '0.1058', 'NDCG@10': '0.0616', 'HR@20': '0.1451', 'NDCG@20': '0.0715'}
2025-02-24 18:53:04,016 - Validation score increased.  Saving model ...
2025-02-24 18:53:31,124 - {'epoch': 15, 'rec_loss': '7.4870'}
2025-02-24 18:53:38,626 - {'Epoch': 15, 'HR@5': '0.0738', 'NDCG@5': '0.0506', 'HR@10': '0.1040', 'NDCG@10': '0.0604', 'HR@20': '0.1455', 'NDCG@20': '0.0708'}
2025-02-24 18:53:38,631 - EarlyStopping counter: 1 out of 10
2025-02-24 18:54:06,596 - {'epoch': 16, 'rec_loss': '7.4668'}
2025-02-24 18:54:14,178 - {'Epoch': 16, 'HR@5': '0.0743', 'NDCG@5': '0.0517', 'HR@10': '0.1064', 'NDCG@10': '0.0620', 'HR@20': '0.1473', 'NDCG@20': '0.0723'}
2025-02-24 18:54:14,180 - Validation score increased.  Saving model ...
2025-02-24 18:54:42,470 - {'epoch': 17, 'rec_loss': '7.4436'}
2025-02-24 18:54:50,670 - {'Epoch': 17, 'HR@5': '0.0754', 'NDCG@5': '0.0521', 'HR@10': '0.1067', 'NDCG@10': '0.0622', 'HR@20': '0.1469', 'NDCG@20': '0.0723'}
2025-02-24 18:54:50,676 - Validation score increased.  Saving model ...
2025-02-24 18:55:20,287 - {'epoch': 18, 'rec_loss': '7.4315'}
2025-02-24 18:55:27,976 - {'Epoch': 18, 'HR@5': '0.0755', 'NDCG@5': '0.0529', 'HR@10': '0.1081', 'NDCG@10': '0.0634', 'HR@20': '0.1490', 'NDCG@20': '0.0736'}
2025-02-24 18:55:27,978 - Validation score increased.  Saving model ...
2025-02-24 18:55:57,891 - {'epoch': 19, 'rec_loss': '7.4052'}
2025-02-24 18:56:05,871 - {'Epoch': 19, 'HR@5': '0.0767', 'NDCG@5': '0.0539', 'HR@10': '0.1082', 'NDCG@10': '0.0640', 'HR@20': '0.1495', 'NDCG@20': '0.0744'}
2025-02-24 18:56:05,872 - Validation score increased.  Saving model ...
2025-02-24 18:56:33,319 - {'epoch': 20, 'rec_loss': '7.3874'}
2025-02-24 18:56:42,084 - {'Epoch': 20, 'HR@5': '0.0772', 'NDCG@5': '0.0542', 'HR@10': '0.1098', 'NDCG@10': '0.0647', 'HR@20': '0.1502', 'NDCG@20': '0.0748'}
2025-02-24 18:56:42,092 - Validation score increased.  Saving model ...
2025-02-24 18:57:07,268 - {'epoch': 21, 'rec_loss': '7.3711'}
2025-02-24 18:57:16,044 - {'Epoch': 21, 'HR@5': '0.0791', 'NDCG@5': '0.0553', 'HR@10': '0.1117', 'NDCG@10': '0.0658', 'HR@20': '0.1548', 'NDCG@20': '0.0766'}
2025-02-24 18:57:16,045 - Validation score increased.  Saving model ...
2025-02-24 18:57:41,628 - {'epoch': 22, 'rec_loss': '7.3602'}
2025-02-24 18:57:49,230 - {'Epoch': 22, 'HR@5': '0.0788', 'NDCG@5': '0.0551', 'HR@10': '0.1122', 'NDCG@10': '0.0659', 'HR@20': '0.1533', 'NDCG@20': '0.0762'}
2025-02-24 18:57:49,231 - EarlyStopping counter: 1 out of 10
2025-02-24 18:58:17,567 - {'epoch': 23, 'rec_loss': '7.3476'}
2025-02-24 18:58:25,833 - {'Epoch': 23, 'HR@5': '0.0798', 'NDCG@5': '0.0559', 'HR@10': '0.1115', 'NDCG@10': '0.0661', 'HR@20': '0.1551', 'NDCG@20': '0.0771'}
2025-02-24 18:58:25,834 - Validation score increased.  Saving model ...
2025-02-24 18:58:51,893 - {'epoch': 24, 'rec_loss': '7.3336'}
2025-02-24 18:58:59,580 - {'Epoch': 24, 'HR@5': '0.0794', 'NDCG@5': '0.0560', 'HR@10': '0.1107', 'NDCG@10': '0.0660', 'HR@20': '0.1541', 'NDCG@20': '0.0769'}
2025-02-24 18:58:59,584 - EarlyStopping counter: 1 out of 10
2025-02-24 18:59:26,483 - {'epoch': 25, 'rec_loss': '7.3239'}
2025-02-24 18:59:34,056 - {'Epoch': 25, 'HR@5': '0.0796', 'NDCG@5': '0.0553', 'HR@10': '0.1122', 'NDCG@10': '0.0658', 'HR@20': '0.1563', 'NDCG@20': '0.0769'}
2025-02-24 18:59:34,057 - EarlyStopping counter: 2 out of 10
2025-02-24 19:00:02,790 - {'epoch': 26, 'rec_loss': '7.3136'}
2025-02-24 19:00:10,446 - {'Epoch': 26, 'HR@5': '0.0800', 'NDCG@5': '0.0558', 'HR@10': '0.1126', 'NDCG@10': '0.0663', 'HR@20': '0.1574', 'NDCG@20': '0.0776'}
2025-02-24 19:00:10,447 - Validation score increased.  Saving model ...
2025-02-24 19:00:35,722 - {'epoch': 27, 'rec_loss': '7.2997'}
2025-02-24 19:00:44,150 - {'Epoch': 27, 'HR@5': '0.0803', 'NDCG@5': '0.0568', 'HR@10': '0.1133', 'NDCG@10': '0.0675', 'HR@20': '0.1562', 'NDCG@20': '0.0783'}
2025-02-24 19:00:44,156 - Validation score increased.  Saving model ...
2025-02-24 19:01:10,054 - {'epoch': 28, 'rec_loss': '7.2907'}
2025-02-24 19:01:18,387 - {'Epoch': 28, 'HR@5': '0.0802', 'NDCG@5': '0.0560', 'HR@10': '0.1129', 'NDCG@10': '0.0666', 'HR@20': '0.1559', 'NDCG@20': '0.0774'}
2025-02-24 19:01:18,388 - EarlyStopping counter: 1 out of 10
2025-02-24 19:01:47,821 - {'epoch': 29, 'rec_loss': '7.2839'}
2025-02-24 19:01:56,519 - {'Epoch': 29, 'HR@5': '0.0830', 'NDCG@5': '0.0573', 'HR@10': '0.1135', 'NDCG@10': '0.0671', 'HR@20': '0.1570', 'NDCG@20': '0.0780'}
2025-02-24 19:01:56,524 - EarlyStopping counter: 2 out of 10
2025-02-24 19:02:24,770 - {'epoch': 30, 'rec_loss': '7.2815'}
2025-02-24 19:02:32,341 - {'Epoch': 30, 'HR@5': '0.0805', 'NDCG@5': '0.0566', 'HR@10': '0.1142', 'NDCG@10': '0.0674', 'HR@20': '0.1578', 'NDCG@20': '0.0784'}
2025-02-24 19:02:32,342 - Validation score increased.  Saving model ...
2025-02-24 19:02:59,844 - {'epoch': 31, 'rec_loss': '7.2660'}
2025-02-24 19:03:07,532 - {'Epoch': 31, 'HR@5': '0.0817', 'NDCG@5': '0.0576', 'HR@10': '0.1138', 'NDCG@10': '0.0680', 'HR@20': '0.1572', 'NDCG@20': '0.0789'}
2025-02-24 19:03:07,534 - Validation score increased.  Saving model ...
2025-02-24 19:03:36,126 - {'epoch': 32, 'rec_loss': '7.2552'}
2025-02-24 19:03:44,551 - {'Epoch': 32, 'HR@5': '0.0826', 'NDCG@5': '0.0581', 'HR@10': '0.1156', 'NDCG@10': '0.0688', 'HR@20': '0.1590', 'NDCG@20': '0.0797'}
2025-02-24 19:03:44,552 - Validation score increased.  Saving model ...
2025-02-24 19:04:13,375 - {'epoch': 33, 'rec_loss': '7.2522'}
2025-02-24 19:04:22,170 - {'Epoch': 33, 'HR@5': '0.0824', 'NDCG@5': '0.0577', 'HR@10': '0.1159', 'NDCG@10': '0.0685', 'HR@20': '0.1583', 'NDCG@20': '0.0792'}
2025-02-24 19:04:22,176 - EarlyStopping counter: 1 out of 10
2025-02-24 19:04:50,143 - {'epoch': 34, 'rec_loss': '7.2296'}
2025-02-24 19:04:57,854 - {'Epoch': 34, 'HR@5': '0.0832', 'NDCG@5': '0.0581', 'HR@10': '0.1164', 'NDCG@10': '0.0688', 'HR@20': '0.1590', 'NDCG@20': '0.0796'}
2025-02-24 19:04:57,860 - EarlyStopping counter: 2 out of 10
2025-02-24 19:05:26,126 - {'epoch': 35, 'rec_loss': '7.2324'}
2025-02-24 19:05:33,992 - {'Epoch': 35, 'HR@5': '0.0815', 'NDCG@5': '0.0574', 'HR@10': '0.1155', 'NDCG@10': '0.0683', 'HR@20': '0.1592', 'NDCG@20': '0.0793'}
2025-02-24 19:05:33,996 - EarlyStopping counter: 3 out of 10
2025-02-24 19:06:01,645 - {'epoch': 36, 'rec_loss': '7.2358'}
2025-02-24 19:06:09,490 - {'Epoch': 36, 'HR@5': '0.0832', 'NDCG@5': '0.0586', 'HR@10': '0.1161', 'NDCG@10': '0.0692', 'HR@20': '0.1587', 'NDCG@20': '0.0799'}
2025-02-24 19:06:09,493 - Validation score increased.  Saving model ...
2025-02-24 19:06:36,735 - {'epoch': 37, 'rec_loss': '7.2139'}
2025-02-24 19:06:44,517 - {'Epoch': 37, 'HR@5': '0.0832', 'NDCG@5': '0.0575', 'HR@10': '0.1167', 'NDCG@10': '0.0682', 'HR@20': '0.1600', 'NDCG@20': '0.0792'}
2025-02-24 19:06:44,518 - EarlyStopping counter: 1 out of 10
2025-02-24 19:07:12,230 - {'epoch': 38, 'rec_loss': '7.2090'}
2025-02-24 19:07:19,986 - {'Epoch': 38, 'HR@5': '0.0821', 'NDCG@5': '0.0574', 'HR@10': '0.1168', 'NDCG@10': '0.0686', 'HR@20': '0.1593', 'NDCG@20': '0.0793'}
2025-02-24 19:07:19,988 - EarlyStopping counter: 2 out of 10
2025-02-24 19:07:47,054 - {'epoch': 39, 'rec_loss': '7.2046'}
2025-02-24 19:07:54,893 - {'Epoch': 39, 'HR@5': '0.0821', 'NDCG@5': '0.0572', 'HR@10': '0.1162', 'NDCG@10': '0.0682', 'HR@20': '0.1593', 'NDCG@20': '0.0790'}
2025-02-24 19:07:54,897 - EarlyStopping counter: 3 out of 10
2025-02-24 19:08:22,401 - {'epoch': 40, 'rec_loss': '7.2007'}
2025-02-24 19:08:30,861 - {'Epoch': 40, 'HR@5': '0.0832', 'NDCG@5': '0.0587', 'HR@10': '0.1163', 'NDCG@10': '0.0693', 'HR@20': '0.1597', 'NDCG@20': '0.0802'}
2025-02-24 19:08:30,862 - Validation score increased.  Saving model ...
2025-02-24 19:09:00,966 - {'epoch': 41, 'rec_loss': '7.2003'}
2025-02-24 19:09:09,759 - {'Epoch': 41, 'HR@5': '0.0842', 'NDCG@5': '0.0592', 'HR@10': '0.1172', 'NDCG@10': '0.0699', 'HR@20': '0.1595', 'NDCG@20': '0.0805'}
2025-02-24 19:09:09,760 - Validation score increased.  Saving model ...
2025-02-24 19:09:39,703 - {'epoch': 42, 'rec_loss': '7.1847'}
2025-02-24 19:09:47,505 - {'Epoch': 42, 'HR@5': '0.0846', 'NDCG@5': '0.0594', 'HR@10': '0.1160', 'NDCG@10': '0.0695', 'HR@20': '0.1621', 'NDCG@20': '0.0811'}
2025-02-24 19:09:47,507 - Validation score increased.  Saving model ...
2025-02-24 19:10:15,674 - {'epoch': 43, 'rec_loss': '7.1835'}
2025-02-24 19:10:24,177 - {'Epoch': 43, 'HR@5': '0.0836', 'NDCG@5': '0.0581', 'HR@10': '0.1154', 'NDCG@10': '0.0684', 'HR@20': '0.1609', 'NDCG@20': '0.0799'}
2025-02-24 19:10:24,178 - EarlyStopping counter: 1 out of 10
2025-02-24 19:10:53,767 - {'epoch': 44, 'rec_loss': '7.1868'}
2025-02-24 19:11:02,551 - {'Epoch': 44, 'HR@5': '0.0833', 'NDCG@5': '0.0582', 'HR@10': '0.1172', 'NDCG@10': '0.0691', 'HR@20': '0.1596', 'NDCG@20': '0.0798'}
2025-02-24 19:11:02,552 - EarlyStopping counter: 2 out of 10
2025-02-24 19:11:28,686 - {'epoch': 45, 'rec_loss': '7.1726'}
2025-02-24 19:11:37,014 - {'Epoch': 45, 'HR@5': '0.0844', 'NDCG@5': '0.0594', 'HR@10': '0.1176', 'NDCG@10': '0.0701', 'HR@20': '0.1614', 'NDCG@20': '0.0811'}
2025-02-24 19:11:37,021 - Validation score increased.  Saving model ...
2025-02-24 19:12:05,277 - {'epoch': 46, 'rec_loss': '7.1621'}
2025-02-24 19:12:14,222 - {'Epoch': 46, 'HR@5': '0.0845', 'NDCG@5': '0.0590', 'HR@10': '0.1179', 'NDCG@10': '0.0699', 'HR@20': '0.1616', 'NDCG@20': '0.0808'}
2025-02-24 19:12:14,223 - EarlyStopping counter: 1 out of 10
2025-02-24 19:12:40,353 - {'epoch': 47, 'rec_loss': '7.1566'}
2025-02-24 19:12:48,798 - {'Epoch': 47, 'HR@5': '0.0846', 'NDCG@5': '0.0593', 'HR@10': '0.1177', 'NDCG@10': '0.0700', 'HR@20': '0.1620', 'NDCG@20': '0.0811'}
2025-02-24 19:12:48,803 - EarlyStopping counter: 2 out of 10
2025-02-24 19:13:14,878 - {'epoch': 48, 'rec_loss': '7.1646'}
2025-02-24 19:13:23,607 - {'Epoch': 48, 'HR@5': '0.0846', 'NDCG@5': '0.0591', 'HR@10': '0.1182', 'NDCG@10': '0.0698', 'HR@20': '0.1615', 'NDCG@20': '0.0807'}
2025-02-24 19:13:23,613 - EarlyStopping counter: 3 out of 10
2025-02-24 19:13:49,686 - {'epoch': 49, 'rec_loss': '7.1618'}
2025-02-24 19:13:58,630 - {'Epoch': 49, 'HR@5': '0.0849', 'NDCG@5': '0.0594', 'HR@10': '0.1193', 'NDCG@10': '0.0704', 'HR@20': '0.1619', 'NDCG@20': '0.0812'}
2025-02-24 19:13:58,631 - Validation score increased.  Saving model ...
2025-02-24 19:14:23,911 - {'epoch': 50, 'rec_loss': '7.1616'}
2025-02-24 19:14:32,429 - {'Epoch': 50, 'HR@5': '0.0848', 'NDCG@5': '0.0590', 'HR@10': '0.1172', 'NDCG@10': '0.0694', 'HR@20': '0.1626', 'NDCG@20': '0.0808'}
2025-02-24 19:14:32,430 - EarlyStopping counter: 1 out of 10
2025-02-24 19:14:58,332 - {'epoch': 51, 'rec_loss': '7.1506'}
2025-02-24 19:15:06,195 - {'Epoch': 51, 'HR@5': '0.0831', 'NDCG@5': '0.0582', 'HR@10': '0.1167', 'NDCG@10': '0.0690', 'HR@20': '0.1608', 'NDCG@20': '0.0801'}
2025-02-24 19:15:06,202 - EarlyStopping counter: 2 out of 10
2025-02-24 19:15:32,955 - {'epoch': 52, 'rec_loss': '7.1405'}
2025-02-24 19:15:40,778 - {'Epoch': 52, 'HR@5': '0.0834', 'NDCG@5': '0.0589', 'HR@10': '0.1182', 'NDCG@10': '0.0701', 'HR@20': '0.1625', 'NDCG@20': '0.0812'}
2025-02-24 19:15:40,779 - Validation score increased.  Saving model ...
2025-02-24 19:16:08,628 - {'epoch': 53, 'rec_loss': '7.1408'}
2025-02-24 19:16:16,291 - {'Epoch': 53, 'HR@5': '0.0842', 'NDCG@5': '0.0590', 'HR@10': '0.1168', 'NDCG@10': '0.0695', 'HR@20': '0.1607', 'NDCG@20': '0.0806'}
2025-02-24 19:16:16,292 - EarlyStopping counter: 1 out of 10
2025-02-24 19:16:43,956 - {'epoch': 54, 'rec_loss': '7.1400'}
2025-02-24 19:16:52,057 - {'Epoch': 54, 'HR@5': '0.0846', 'NDCG@5': '0.0589', 'HR@10': '0.1182', 'NDCG@10': '0.0697', 'HR@20': '0.1612', 'NDCG@20': '0.0805'}
2025-02-24 19:16:52,059 - EarlyStopping counter: 2 out of 10
2025-02-24 19:17:19,682 - {'epoch': 55, 'rec_loss': '7.1279'}
2025-02-24 19:17:27,543 - {'Epoch': 55, 'HR@5': '0.0842', 'NDCG@5': '0.0589', 'HR@10': '0.1179', 'NDCG@10': '0.0697', 'HR@20': '0.1632', 'NDCG@20': '0.0811'}
2025-02-24 19:17:27,544 - EarlyStopping counter: 3 out of 10
2025-02-24 19:17:56,152 - {'epoch': 56, 'rec_loss': '7.1317'}
2025-02-24 19:18:04,046 - {'Epoch': 56, 'HR@5': '0.0841', 'NDCG@5': '0.0595', 'HR@10': '0.1184', 'NDCG@10': '0.0706', 'HR@20': '0.1608', 'NDCG@20': '0.0813'}
2025-02-24 19:18:04,047 - Validation score increased.  Saving model ...
2025-02-24 19:18:30,440 - {'epoch': 57, 'rec_loss': '7.1331'}
2025-02-24 19:18:38,277 - {'Epoch': 57, 'HR@5': '0.0846', 'NDCG@5': '0.0598', 'HR@10': '0.1184', 'NDCG@10': '0.0706', 'HR@20': '0.1622', 'NDCG@20': '0.0816'}
2025-02-24 19:18:38,283 - Validation score increased.  Saving model ...
2025-02-24 19:19:06,737 - {'epoch': 58, 'rec_loss': '7.1259'}
2025-02-24 19:19:15,137 - {'Epoch': 58, 'HR@5': '0.0834', 'NDCG@5': '0.0589', 'HR@10': '0.1179', 'NDCG@10': '0.0700', 'HR@20': '0.1627', 'NDCG@20': '0.0812'}
2025-02-24 19:19:15,139 - EarlyStopping counter: 1 out of 10
2025-02-24 19:19:42,180 - {'epoch': 59, 'rec_loss': '7.1117'}
2025-02-24 19:19:50,343 - {'Epoch': 59, 'HR@5': '0.0857', 'NDCG@5': '0.0597', 'HR@10': '0.1185', 'NDCG@10': '0.0703', 'HR@20': '0.1636', 'NDCG@20': '0.0816'}
2025-02-24 19:19:50,344 - Validation score increased.  Saving model ...
2025-02-24 19:20:18,639 - {'epoch': 60, 'rec_loss': '7.1141'}
2025-02-24 19:20:26,837 - {'Epoch': 60, 'HR@5': '0.0851', 'NDCG@5': '0.0603', 'HR@10': '0.1184', 'NDCG@10': '0.0710', 'HR@20': '0.1625', 'NDCG@20': '0.0821'}
2025-02-24 19:20:26,841 - Validation score increased.  Saving model ...
2025-02-24 19:20:55,767 - {'epoch': 61, 'rec_loss': '7.1140'}
2025-02-24 19:21:03,862 - {'Epoch': 61, 'HR@5': '0.0858', 'NDCG@5': '0.0602', 'HR@10': '0.1196', 'NDCG@10': '0.0711', 'HR@20': '0.1630', 'NDCG@20': '0.0820'}
2025-02-24 19:21:03,864 - EarlyStopping counter: 1 out of 10
2025-02-24 19:21:31,512 - {'epoch': 62, 'rec_loss': '7.1129'}
2025-02-24 19:21:42,338 - {'Epoch': 62, 'HR@5': '0.0850', 'NDCG@5': '0.0601', 'HR@10': '0.1188', 'NDCG@10': '0.0710', 'HR@20': '0.1629', 'NDCG@20': '0.0821'}
2025-02-24 19:21:42,341 - EarlyStopping counter: 2 out of 10
2025-02-24 19:22:18,102 - {'epoch': 63, 'rec_loss': '7.1070'}
2025-02-24 19:22:26,958 - {'Epoch': 63, 'HR@5': '0.0850', 'NDCG@5': '0.0596', 'HR@10': '0.1175', 'NDCG@10': '0.0701', 'HR@20': '0.1621', 'NDCG@20': '0.0813'}
2025-02-24 19:22:26,965 - EarlyStopping counter: 3 out of 10
2025-02-24 19:22:58,239 - {'epoch': 64, 'rec_loss': '7.1005'}
2025-02-24 19:23:06,039 - {'Epoch': 64, 'HR@5': '0.0848', 'NDCG@5': '0.0597', 'HR@10': '0.1182', 'NDCG@10': '0.0704', 'HR@20': '0.1607', 'NDCG@20': '0.0811'}
2025-02-24 19:23:06,040 - EarlyStopping counter: 4 out of 10
2025-02-24 19:23:34,793 - {'epoch': 65, 'rec_loss': '7.1029'}
2025-02-24 19:23:43,313 - {'Epoch': 65, 'HR@5': '0.0837', 'NDCG@5': '0.0593', 'HR@10': '0.1176', 'NDCG@10': '0.0702', 'HR@20': '0.1626', 'NDCG@20': '0.0815'}
2025-02-24 19:23:43,314 - EarlyStopping counter: 5 out of 10
2025-02-24 19:24:13,177 - {'epoch': 66, 'rec_loss': '7.0938'}
2025-02-24 19:24:21,768 - {'Epoch': 66, 'HR@5': '0.0847', 'NDCG@5': '0.0596', 'HR@10': '0.1177', 'NDCG@10': '0.0702', 'HR@20': '0.1607', 'NDCG@20': '0.0811'}
2025-02-24 19:24:21,776 - EarlyStopping counter: 6 out of 10
2025-02-24 19:24:51,845 - {'epoch': 67, 'rec_loss': '7.0928'}
2025-02-24 19:25:00,472 - {'Epoch': 67, 'HR@5': '0.0839', 'NDCG@5': '0.0589', 'HR@10': '0.1174', 'NDCG@10': '0.0697', 'HR@20': '0.1625', 'NDCG@20': '0.0811'}
2025-02-24 19:25:00,477 - EarlyStopping counter: 7 out of 10
2025-02-24 19:25:29,866 - {'epoch': 68, 'rec_loss': '7.1004'}
2025-02-24 19:25:38,383 - {'Epoch': 68, 'HR@5': '0.0860', 'NDCG@5': '0.0604', 'HR@10': '0.1198', 'NDCG@10': '0.0712', 'HR@20': '0.1643', 'NDCG@20': '0.0824'}
2025-02-24 19:25:38,390 - Validation score increased.  Saving model ...
2025-02-24 19:26:07,836 - {'epoch': 69, 'rec_loss': '7.0887'}
2025-02-24 19:26:16,641 - {'Epoch': 69, 'HR@5': '0.0859', 'NDCG@5': '0.0600', 'HR@10': '0.1192', 'NDCG@10': '0.0707', 'HR@20': '0.1627', 'NDCG@20': '0.0816'}
2025-02-24 19:26:16,642 - EarlyStopping counter: 1 out of 10
2025-02-24 19:26:44,279 - {'epoch': 70, 'rec_loss': '7.0911'}
2025-02-24 19:26:53,234 - {'Epoch': 70, 'HR@5': '0.0850', 'NDCG@5': '0.0597', 'HR@10': '0.1184', 'NDCG@10': '0.0704', 'HR@20': '0.1621', 'NDCG@20': '0.0814'}
2025-02-24 19:26:53,236 - EarlyStopping counter: 2 out of 10
2025-02-24 19:27:34,095 - {'epoch': 71, 'rec_loss': '7.0928'}
2025-02-24 19:27:42,380 - {'Epoch': 71, 'HR@5': '0.0850', 'NDCG@5': '0.0595', 'HR@10': '0.1197', 'NDCG@10': '0.0706', 'HR@20': '0.1625', 'NDCG@20': '0.0814'}
2025-02-24 19:27:42,387 - EarlyStopping counter: 3 out of 10
2025-02-24 19:28:11,921 - {'epoch': 72, 'rec_loss': '7.0830'}
2025-02-24 19:28:21,152 - {'Epoch': 72, 'HR@5': '0.0851', 'NDCG@5': '0.0604', 'HR@10': '0.1183', 'NDCG@10': '0.0711', 'HR@20': '0.1632', 'NDCG@20': '0.0824'}
2025-02-24 19:28:21,159 - EarlyStopping counter: 4 out of 10
2025-02-24 19:28:49,496 - {'epoch': 73, 'rec_loss': '7.0794'}
2025-02-24 19:28:58,558 - {'Epoch': 73, 'HR@5': '0.0862', 'NDCG@5': '0.0601', 'HR@10': '0.1194', 'NDCG@10': '0.0708', 'HR@20': '0.1623', 'NDCG@20': '0.0816'}
2025-02-24 19:28:58,565 - EarlyStopping counter: 5 out of 10
2025-02-24 19:29:30,265 - {'epoch': 74, 'rec_loss': '7.0797'}
2025-02-24 19:29:39,596 - {'Epoch': 74, 'HR@5': '0.0852', 'NDCG@5': '0.0597', 'HR@10': '0.1193', 'NDCG@10': '0.0707', 'HR@20': '0.1623', 'NDCG@20': '0.0815'}
2025-02-24 19:29:39,602 - EarlyStopping counter: 6 out of 10
2025-02-24 19:30:10,675 - {'epoch': 75, 'rec_loss': '7.0785'}
2025-02-24 19:30:19,762 - {'Epoch': 75, 'HR@5': '0.0849', 'NDCG@5': '0.0597', 'HR@10': '0.1189', 'NDCG@10': '0.0706', 'HR@20': '0.1625', 'NDCG@20': '0.0816'}
2025-02-24 19:30:19,764 - EarlyStopping counter: 7 out of 10
2025-02-24 19:30:54,699 - {'epoch': 76, 'rec_loss': '7.0643'}
2025-02-24 19:31:03,461 - {'Epoch': 76, 'HR@5': '0.0865', 'NDCG@5': '0.0608', 'HR@10': '0.1196', 'NDCG@10': '0.0715', 'HR@20': '0.1619', 'NDCG@20': '0.0822'}
2025-02-24 19:31:03,468 - EarlyStopping counter: 8 out of 10
2025-02-24 19:31:31,285 - {'epoch': 77, 'rec_loss': '7.0663'}
2025-02-24 19:31:41,191 - {'Epoch': 77, 'HR@5': '0.0866', 'NDCG@5': '0.0607', 'HR@10': '0.1197', 'NDCG@10': '0.0714', 'HR@20': '0.1637', 'NDCG@20': '0.0825'}
2025-02-24 19:31:41,199 - Validation score increased.  Saving model ...
2025-02-24 19:32:16,833 - {'epoch': 78, 'rec_loss': '7.0629'}
2025-02-24 19:32:24,992 - {'Epoch': 78, 'HR@5': '0.0862', 'NDCG@5': '0.0609', 'HR@10': '0.1192', 'NDCG@10': '0.0715', 'HR@20': '0.1629', 'NDCG@20': '0.0825'}
2025-02-24 19:32:24,997 - Validation score increased.  Saving model ...
2025-02-24 19:32:56,437 - {'epoch': 79, 'rec_loss': '7.0720'}
2025-02-24 19:33:06,392 - {'Epoch': 79, 'HR@5': '0.0860', 'NDCG@5': '0.0604', 'HR@10': '0.1190', 'NDCG@10': '0.0710', 'HR@20': '0.1634', 'NDCG@20': '0.0822'}
2025-02-24 19:33:06,393 - EarlyStopping counter: 1 out of 10
2025-02-24 19:33:40,591 - {'epoch': 80, 'rec_loss': '7.0654'}
2025-02-24 19:33:48,436 - {'Epoch': 80, 'HR@5': '0.0853', 'NDCG@5': '0.0599', 'HR@10': '0.1199', 'NDCG@10': '0.0711', 'HR@20': '0.1625', 'NDCG@20': '0.0818'}
2025-02-24 19:33:48,438 - EarlyStopping counter: 2 out of 10
2025-02-24 19:34:21,374 - {'epoch': 81, 'rec_loss': '7.0587'}
2025-02-24 19:34:31,419 - {'Epoch': 81, 'HR@5': '0.0872', 'NDCG@5': '0.0614', 'HR@10': '0.1201', 'NDCG@10': '0.0719', 'HR@20': '0.1639', 'NDCG@20': '0.0829'}
2025-02-24 19:34:31,421 - Validation score increased.  Saving model ...
2025-02-24 19:35:08,708 - {'epoch': 82, 'rec_loss': '7.0609'}
2025-02-24 19:35:17,958 - {'Epoch': 82, 'HR@5': '0.0856', 'NDCG@5': '0.0593', 'HR@10': '0.1194', 'NDCG@10': '0.0702', 'HR@20': '0.1650', 'NDCG@20': '0.0817'}
2025-02-24 19:35:17,959 - EarlyStopping counter: 1 out of 10
2025-02-24 19:35:47,479 - {'epoch': 83, 'rec_loss': '7.0538'}
2025-02-24 19:35:55,512 - {'Epoch': 83, 'HR@5': '0.0851', 'NDCG@5': '0.0597', 'HR@10': '0.1204', 'NDCG@10': '0.0710', 'HR@20': '0.1638', 'NDCG@20': '0.0819'}
2025-02-24 19:35:55,513 - EarlyStopping counter: 2 out of 10
2025-02-24 19:36:29,212 - {'epoch': 84, 'rec_loss': '7.0611'}
2025-02-24 19:36:38,859 - {'Epoch': 84, 'HR@5': '0.0852', 'NDCG@5': '0.0602', 'HR@10': '0.1198', 'NDCG@10': '0.0713', 'HR@20': '0.1629', 'NDCG@20': '0.0822'}
2025-02-24 19:36:38,866 - EarlyStopping counter: 3 out of 10
2025-02-24 19:37:05,517 - {'epoch': 85, 'rec_loss': '7.0538'}
2025-02-24 19:37:14,704 - {'Epoch': 85, 'HR@5': '0.0867', 'NDCG@5': '0.0606', 'HR@10': '0.1190', 'NDCG@10': '0.0710', 'HR@20': '0.1633', 'NDCG@20': '0.0821'}
2025-02-24 19:37:14,712 - EarlyStopping counter: 4 out of 10
2025-02-24 19:37:49,262 - {'epoch': 86, 'rec_loss': '7.0560'}
2025-02-24 19:37:57,604 - {'Epoch': 86, 'HR@5': '0.0865', 'NDCG@5': '0.0610', 'HR@10': '0.1188', 'NDCG@10': '0.0713', 'HR@20': '0.1631', 'NDCG@20': '0.0825'}
2025-02-24 19:37:57,605 - EarlyStopping counter: 5 out of 10
2025-02-24 19:38:25,696 - {'epoch': 87, 'rec_loss': '7.0554'}
2025-02-24 19:38:33,701 - {'Epoch': 87, 'HR@5': '0.0861', 'NDCG@5': '0.0605', 'HR@10': '0.1199', 'NDCG@10': '0.0713', 'HR@20': '0.1628', 'NDCG@20': '0.0821'}
2025-02-24 19:38:33,702 - EarlyStopping counter: 6 out of 10
2025-02-24 19:39:01,434 - {'epoch': 88, 'rec_loss': '7.0520'}
2025-02-24 19:39:11,876 - {'Epoch': 88, 'HR@5': '0.0875', 'NDCG@5': '0.0613', 'HR@10': '0.1203', 'NDCG@10': '0.0718', 'HR@20': '0.1633', 'NDCG@20': '0.0827'}
2025-02-24 19:39:11,884 - EarlyStopping counter: 7 out of 10
2025-02-24 19:39:40,363 - {'epoch': 89, 'rec_loss': '7.0493'}
2025-02-24 19:39:48,561 - {'Epoch': 89, 'HR@5': '0.0870', 'NDCG@5': '0.0612', 'HR@10': '0.1214', 'NDCG@10': '0.0722', 'HR@20': '0.1644', 'NDCG@20': '0.0830'}
2025-02-24 19:39:48,563 - Validation score increased.  Saving model ...
2025-02-24 19:40:14,443 - {'epoch': 90, 'rec_loss': '7.0519'}
2025-02-24 19:40:22,843 - {'Epoch': 90, 'HR@5': '0.0852', 'NDCG@5': '0.0597', 'HR@10': '0.1212', 'NDCG@10': '0.0713', 'HR@20': '0.1622', 'NDCG@20': '0.0816'}
2025-02-24 19:40:22,848 - EarlyStopping counter: 1 out of 10
2025-02-24 19:40:50,456 - {'epoch': 91, 'rec_loss': '7.0435'}
2025-02-24 19:40:59,261 - {'Epoch': 91, 'HR@5': '0.0874', 'NDCG@5': '0.0614', 'HR@10': '0.1191', 'NDCG@10': '0.0716', 'HR@20': '0.1641', 'NDCG@20': '0.0829'}
2025-02-24 19:40:59,262 - EarlyStopping counter: 2 out of 10
2025-02-24 19:41:26,728 - {'epoch': 92, 'rec_loss': '7.0417'}
2025-02-24 19:41:35,549 - {'Epoch': 92, 'HR@5': '0.0861', 'NDCG@5': '0.0605', 'HR@10': '0.1207', 'NDCG@10': '0.0717', 'HR@20': '0.1628', 'NDCG@20': '0.0823'}
2025-02-24 19:41:35,554 - EarlyStopping counter: 3 out of 10
2025-02-24 19:42:04,478 - {'epoch': 93, 'rec_loss': '7.0379'}
2025-02-24 19:42:13,143 - {'Epoch': 93, 'HR@5': '0.0880', 'NDCG@5': '0.0614', 'HR@10': '0.1208', 'NDCG@10': '0.0719', 'HR@20': '0.1621', 'NDCG@20': '0.0823'}
2025-02-24 19:42:13,150 - EarlyStopping counter: 4 out of 10
2025-02-24 19:42:39,695 - {'epoch': 94, 'rec_loss': '7.0406'}
2025-02-24 19:42:48,240 - {'Epoch': 94, 'HR@5': '0.0864', 'NDCG@5': '0.0605', 'HR@10': '0.1200', 'NDCG@10': '0.0713', 'HR@20': '0.1624', 'NDCG@20': '0.0820'}
2025-02-24 19:42:48,245 - EarlyStopping counter: 5 out of 10
2025-02-24 19:43:16,435 - {'epoch': 95, 'rec_loss': '7.0358'}
2025-02-24 19:43:25,526 - {'Epoch': 95, 'HR@5': '0.0864', 'NDCG@5': '0.0608', 'HR@10': '0.1194', 'NDCG@10': '0.0714', 'HR@20': '0.1622', 'NDCG@20': '0.0822'}
2025-02-24 19:43:25,528 - EarlyStopping counter: 6 out of 10
2025-02-24 19:43:58,368 - {'epoch': 96, 'rec_loss': '7.0391'}
2025-02-24 19:44:07,528 - {'Epoch': 96, 'HR@5': '0.0875', 'NDCG@5': '0.0613', 'HR@10': '0.1207', 'NDCG@10': '0.0719', 'HR@20': '0.1628', 'NDCG@20': '0.0825'}
2025-02-24 19:44:07,529 - EarlyStopping counter: 7 out of 10
2025-02-24 19:44:39,870 - {'epoch': 97, 'rec_loss': '7.0300'}
2025-02-24 19:44:48,805 - {'Epoch': 97, 'HR@5': '0.0872', 'NDCG@5': '0.0614', 'HR@10': '0.1197', 'NDCG@10': '0.0719', 'HR@20': '0.1632', 'NDCG@20': '0.0828'}
2025-02-24 19:44:48,806 - EarlyStopping counter: 8 out of 10
2025-02-24 19:45:16,923 - {'epoch': 98, 'rec_loss': '7.0283'}
2025-02-24 19:45:26,243 - {'Epoch': 98, 'HR@5': '0.0878', 'NDCG@5': '0.0613', 'HR@10': '0.1199', 'NDCG@10': '0.0717', 'HR@20': '0.1636', 'NDCG@20': '0.0827'}
2025-02-24 19:45:26,245 - EarlyStopping counter: 9 out of 10
2025-02-24 19:45:53,436 - {'epoch': 99, 'rec_loss': '7.0400'}
2025-02-24 19:46:02,319 - {'Epoch': 99, 'HR@5': '0.0870', 'NDCG@5': '0.0611', 'HR@10': '0.1202', 'NDCG@10': '0.0717', 'HR@20': '0.1635', 'NDCG@20': '0.0826'}
2025-02-24 19:46:02,320 - EarlyStopping counter: 10 out of 10
2025-02-24 19:46:02,320 - Early stopping
2025-02-24 19:46:02,320 - ---------------Test Score---------------
2025-02-24 19:46:10,872 - {'Epoch': 0, 'HR@5': '0.0686', 'NDCG@5': '0.0480', 'HR@10': '0.0973', 'NDCG@10': '0.0572', 'HR@20': '0.1364', 'NDCG@20': '0.0671'}
2025-02-24 19:46:10,877 - Scale_Beauty
2025-02-24 19:46:10,877 - {'Epoch': 0, 'HR@5': '0.0686', 'NDCG@5': '0.0480', 'HR@10': '0.0973', 'NDCG@10': '0.0572', 'HR@20': '0.1364', 'NDCG@20': '0.0671'}
2025-02-24 19:53:57,683 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 12], start_prob=0.6, end_prob=0.9, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-24 19:54:00,577 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-24 19:54:00,582 - Total Parameters: 929445
2025-02-24 19:54:29,868 - {'epoch': 0, 'rec_loss': '8.9725'}
2025-02-24 19:54:38,670 - {'Epoch': 0, 'HR@5': '0.0117', 'NDCG@5': '0.0073', 'HR@10': '0.0202', 'NDCG@10': '0.0100', 'HR@20': '0.0329', 'NDCG@20': '0.0132'}
2025-02-24 19:54:38,671 - Validation score increased.  Saving model ...
2025-02-24 19:55:06,749 - {'epoch': 1, 'rec_loss': '8.6770'}
2025-02-24 19:55:16,345 - {'Epoch': 1, 'HR@5': '0.0137', 'NDCG@5': '0.0084', 'HR@10': '0.0265', 'NDCG@10': '0.0125', 'HR@20': '0.0406', 'NDCG@20': '0.0161'}
2025-02-24 19:55:16,347 - Validation score increased.  Saving model ...
2025-02-24 19:55:45,494 - {'epoch': 2, 'rec_loss': '8.5122'}
2025-02-24 19:55:55,295 - {'Epoch': 2, 'HR@5': '0.0254', 'NDCG@5': '0.0162', 'HR@10': '0.0380', 'NDCG@10': '0.0202', 'HR@20': '0.0568', 'NDCG@20': '0.0250'}
2025-02-24 19:55:55,301 - Validation score increased.  Saving model ...
2025-02-24 19:56:23,573 - {'epoch': 3, 'rec_loss': '8.3646'}
2025-02-24 19:56:32,210 - {'Epoch': 3, 'HR@5': '0.0279', 'NDCG@5': '0.0185', 'HR@10': '0.0464', 'NDCG@10': '0.0245', 'HR@20': '0.0706', 'NDCG@20': '0.0305'}
2025-02-24 19:56:32,212 - Validation score increased.  Saving model ...
2025-02-24 19:57:03,139 - {'epoch': 4, 'rec_loss': '8.2431'}
2025-02-24 19:57:12,449 - {'Epoch': 4, 'HR@5': '0.0351', 'NDCG@5': '0.0231', 'HR@10': '0.0538', 'NDCG@10': '0.0291', 'HR@20': '0.0817', 'NDCG@20': '0.0361'}
2025-02-24 19:57:12,451 - Validation score increased.  Saving model ...
2025-02-24 19:57:42,946 - {'epoch': 5, 'rec_loss': '8.1397'}
2025-02-24 19:57:50,992 - {'Epoch': 5, 'HR@5': '0.0378', 'NDCG@5': '0.0249', 'HR@10': '0.0597', 'NDCG@10': '0.0319', 'HR@20': '0.0895', 'NDCG@20': '0.0394'}
2025-02-24 19:57:50,996 - Validation score increased.  Saving model ...
2025-02-24 19:58:20,944 - {'epoch': 6, 'rec_loss': '8.0550'}
2025-02-24 19:58:28,619 - {'Epoch': 6, 'HR@5': '0.0423', 'NDCG@5': '0.0285', 'HR@10': '0.0660', 'NDCG@10': '0.0361', 'HR@20': '0.0969', 'NDCG@20': '0.0439'}
2025-02-24 19:58:28,625 - Validation score increased.  Saving model ...
2025-02-24 19:58:56,105 - {'epoch': 7, 'rec_loss': '7.9862'}
2025-02-24 19:59:05,614 - {'Epoch': 7, 'HR@5': '0.0466', 'NDCG@5': '0.0310', 'HR@10': '0.0704', 'NDCG@10': '0.0387', 'HR@20': '0.1033', 'NDCG@20': '0.0469'}
2025-02-24 19:59:05,615 - Validation score increased.  Saving model ...
2025-02-24 19:59:34,419 - {'epoch': 8, 'rec_loss': '7.9333'}
2025-02-24 19:59:43,439 - {'Epoch': 8, 'HR@5': '0.0492', 'NDCG@5': '0.0326', 'HR@10': '0.0765', 'NDCG@10': '0.0414', 'HR@20': '0.1109', 'NDCG@20': '0.0500'}
2025-02-24 19:59:43,440 - Validation score increased.  Saving model ...
2025-02-24 20:00:10,896 - {'epoch': 9, 'rec_loss': '7.8902'}
2025-02-24 20:00:19,964 - {'Epoch': 9, 'HR@5': '0.0509', 'NDCG@5': '0.0345', 'HR@10': '0.0776', 'NDCG@10': '0.0431', 'HR@20': '0.1133', 'NDCG@20': '0.0521'}
2025-02-24 20:00:19,965 - Validation score increased.  Saving model ...
2025-02-24 20:01:01,568 - {'epoch': 10, 'rec_loss': '7.8483'}
2025-02-24 20:01:09,405 - {'Epoch': 10, 'HR@5': '0.0550', 'NDCG@5': '0.0365', 'HR@10': '0.0819', 'NDCG@10': '0.0451', 'HR@20': '0.1193', 'NDCG@20': '0.0545'}
2025-02-24 20:01:09,407 - Validation score increased.  Saving model ...
2025-02-24 20:01:50,749 - {'epoch': 11, 'rec_loss': '7.8188'}
2025-02-24 20:01:59,589 - {'Epoch': 11, 'HR@5': '0.0573', 'NDCG@5': '0.0381', 'HR@10': '0.0839', 'NDCG@10': '0.0467', 'HR@20': '0.1209', 'NDCG@20': '0.0560'}
2025-02-24 20:01:59,596 - Validation score increased.  Saving model ...
2025-02-24 20:02:30,760 - {'epoch': 12, 'rec_loss': '7.7850'}
2025-02-24 20:02:43,217 - {'Epoch': 12, 'HR@5': '0.0584', 'NDCG@5': '0.0396', 'HR@10': '0.0868', 'NDCG@10': '0.0487', 'HR@20': '0.1246', 'NDCG@20': '0.0582'}
2025-02-24 20:02:43,221 - Validation score increased.  Saving model ...
2025-02-24 20:03:10,619 - {'epoch': 13, 'rec_loss': '7.7580'}
2025-02-24 20:03:18,481 - {'Epoch': 13, 'HR@5': '0.0590', 'NDCG@5': '0.0393', 'HR@10': '0.0892', 'NDCG@10': '0.0490', 'HR@20': '0.1276', 'NDCG@20': '0.0587'}
2025-02-24 20:03:18,482 - Validation score increased.  Saving model ...
2025-02-24 20:03:44,772 - {'epoch': 14, 'rec_loss': '7.7460'}
2025-02-24 20:03:52,684 - {'Epoch': 14, 'HR@5': '0.0615', 'NDCG@5': '0.0417', 'HR@10': '0.0914', 'NDCG@10': '0.0514', 'HR@20': '0.1303', 'NDCG@20': '0.0611'}
2025-02-24 20:03:52,685 - Validation score increased.  Saving model ...
2025-02-24 20:04:20,813 - {'epoch': 15, 'rec_loss': '7.7116'}
2025-02-24 20:04:28,941 - {'Epoch': 15, 'HR@5': '0.0629', 'NDCG@5': '0.0423', 'HR@10': '0.0927', 'NDCG@10': '0.0519', 'HR@20': '0.1318', 'NDCG@20': '0.0617'}
2025-02-24 20:04:28,942 - Validation score increased.  Saving model ...
2025-02-24 20:04:57,758 - {'epoch': 16, 'rec_loss': '7.6938'}
2025-02-24 20:05:10,205 - {'Epoch': 16, 'HR@5': '0.0625', 'NDCG@5': '0.0427', 'HR@10': '0.0937', 'NDCG@10': '0.0527', 'HR@20': '0.1306', 'NDCG@20': '0.0620'}
2025-02-24 20:05:10,213 - Validation score increased.  Saving model ...
2025-02-24 20:05:50,540 - {'epoch': 17, 'rec_loss': '7.6754'}
2025-02-24 20:06:03,419 - {'Epoch': 17, 'HR@5': '0.0630', 'NDCG@5': '0.0428', 'HR@10': '0.0934', 'NDCG@10': '0.0525', 'HR@20': '0.1332', 'NDCG@20': '0.0625'}
2025-02-24 20:06:03,421 - Validation score increased.  Saving model ...
2025-02-24 20:06:55,663 - {'epoch': 18, 'rec_loss': '7.6601'}
2025-02-24 20:07:06,488 - {'Epoch': 18, 'HR@5': '0.0645', 'NDCG@5': '0.0443', 'HR@10': '0.0973', 'NDCG@10': '0.0549', 'HR@20': '0.1358', 'NDCG@20': '0.0646'}
2025-02-24 20:07:06,497 - Validation score increased.  Saving model ...
2025-02-24 20:07:48,107 - {'epoch': 19, 'rec_loss': '7.6365'}
2025-02-24 20:07:57,230 - {'Epoch': 19, 'HR@5': '0.0668', 'NDCG@5': '0.0452', 'HR@10': '0.0963', 'NDCG@10': '0.0547', 'HR@20': '0.1370', 'NDCG@20': '0.0650'}
2025-02-24 20:07:57,231 - Validation score increased.  Saving model ...
2025-02-24 20:08:30,389 - {'epoch': 20, 'rec_loss': '7.6172'}
2025-02-24 20:08:39,604 - {'Epoch': 20, 'HR@5': '0.0662', 'NDCG@5': '0.0457', 'HR@10': '0.0978', 'NDCG@10': '0.0559', 'HR@20': '0.1389', 'NDCG@20': '0.0662'}
2025-02-24 20:08:39,605 - Validation score increased.  Saving model ...
2025-02-24 20:09:07,484 - {'epoch': 21, 'rec_loss': '7.6074'}
2025-02-24 20:09:16,829 - {'Epoch': 21, 'HR@5': '0.0686', 'NDCG@5': '0.0471', 'HR@10': '0.0996', 'NDCG@10': '0.0571', 'HR@20': '0.1393', 'NDCG@20': '0.0671'}
2025-02-24 20:09:16,830 - Validation score increased.  Saving model ...
2025-02-24 20:09:49,669 - {'epoch': 22, 'rec_loss': '7.5905'}
2025-02-24 20:09:58,823 - {'Epoch': 22, 'HR@5': '0.0691', 'NDCG@5': '0.0475', 'HR@10': '0.1005', 'NDCG@10': '0.0577', 'HR@20': '0.1399', 'NDCG@20': '0.0677'}
2025-02-24 20:09:58,830 - Validation score increased.  Saving model ...
2025-02-24 20:10:26,110 - {'epoch': 23, 'rec_loss': '7.5801'}
2025-02-24 20:10:35,065 - {'Epoch': 23, 'HR@5': '0.0704', 'NDCG@5': '0.0485', 'HR@10': '0.1020', 'NDCG@10': '0.0587', 'HR@20': '0.1414', 'NDCG@20': '0.0687'}
2025-02-24 20:10:35,066 - Validation score increased.  Saving model ...
2025-02-24 20:11:03,267 - {'epoch': 24, 'rec_loss': '7.5742'}
2025-02-24 20:11:11,758 - {'Epoch': 24, 'HR@5': '0.0710', 'NDCG@5': '0.0482', 'HR@10': '0.1023', 'NDCG@10': '0.0583', 'HR@20': '0.1403', 'NDCG@20': '0.0678'}
2025-02-24 20:11:11,766 - EarlyStopping counter: 1 out of 10
2025-02-24 20:11:43,835 - {'epoch': 25, 'rec_loss': '7.5599'}
2025-02-24 20:11:52,088 - {'Epoch': 25, 'HR@5': '0.0719', 'NDCG@5': '0.0495', 'HR@10': '0.1027', 'NDCG@10': '0.0595', 'HR@20': '0.1429', 'NDCG@20': '0.0696'}
2025-02-24 20:11:52,096 - Validation score increased.  Saving model ...
2025-02-24 20:12:20,430 - {'epoch': 26, 'rec_loss': '7.5547'}
2025-02-24 20:12:28,057 - {'Epoch': 26, 'HR@5': '0.0725', 'NDCG@5': '0.0492', 'HR@10': '0.1043', 'NDCG@10': '0.0594', 'HR@20': '0.1451', 'NDCG@20': '0.0697'}
2025-02-24 20:12:28,058 - Validation score increased.  Saving model ...
2025-02-24 20:12:55,872 - {'epoch': 27, 'rec_loss': '7.5354'}
2025-02-24 20:13:04,662 - {'Epoch': 27, 'HR@5': '0.0715', 'NDCG@5': '0.0496', 'HR@10': '0.1054', 'NDCG@10': '0.0605', 'HR@20': '0.1446', 'NDCG@20': '0.0704'}
2025-02-24 20:13:04,663 - Validation score increased.  Saving model ...
2025-02-24 20:13:32,388 - {'epoch': 28, 'rec_loss': '7.5289'}
2025-02-24 20:13:40,086 - {'Epoch': 28, 'HR@5': '0.0740', 'NDCG@5': '0.0505', 'HR@10': '0.1039', 'NDCG@10': '0.0602', 'HR@20': '0.1450', 'NDCG@20': '0.0705'}
2025-02-24 20:13:40,087 - Validation score increased.  Saving model ...
2025-02-24 20:14:09,887 - {'epoch': 29, 'rec_loss': '7.5207'}
2025-02-24 20:14:23,759 - {'Epoch': 29, 'HR@5': '0.0732', 'NDCG@5': '0.0502', 'HR@10': '0.1054', 'NDCG@10': '0.0606', 'HR@20': '0.1468', 'NDCG@20': '0.0710'}
2025-02-24 20:14:23,760 - Validation score increased.  Saving model ...
2025-02-24 20:14:51,805 - {'epoch': 30, 'rec_loss': '7.5155'}
2025-02-24 20:15:00,120 - {'Epoch': 30, 'HR@5': '0.0745', 'NDCG@5': '0.0514', 'HR@10': '0.1054', 'NDCG@10': '0.0613', 'HR@20': '0.1469', 'NDCG@20': '0.0717'}
2025-02-24 20:15:00,125 - Validation score increased.  Saving model ...
2025-02-24 20:15:28,924 - {'epoch': 31, 'rec_loss': '7.5069'}
2025-02-24 20:15:36,833 - {'Epoch': 31, 'HR@5': '0.0739', 'NDCG@5': '0.0510', 'HR@10': '0.1041', 'NDCG@10': '0.0607', 'HR@20': '0.1467', 'NDCG@20': '0.0715'}
2025-02-24 20:15:36,840 - EarlyStopping counter: 1 out of 10
2025-02-24 20:16:06,422 - {'epoch': 32, 'rec_loss': '7.4964'}
2025-02-24 20:16:13,699 - {'Epoch': 32, 'HR@5': '0.0759', 'NDCG@5': '0.0519', 'HR@10': '0.1064', 'NDCG@10': '0.0617', 'HR@20': '0.1477', 'NDCG@20': '0.0721'}
2025-02-24 20:16:13,700 - Validation score increased.  Saving model ...
2025-02-24 20:16:47,285 - {'epoch': 33, 'rec_loss': '7.4933'}
2025-02-24 20:16:55,373 - {'Epoch': 33, 'HR@5': '0.0770', 'NDCG@5': '0.0528', 'HR@10': '0.1071', 'NDCG@10': '0.0624', 'HR@20': '0.1479', 'NDCG@20': '0.0727'}
2025-02-24 20:16:55,374 - Validation score increased.  Saving model ...
2025-02-24 20:17:21,289 - {'epoch': 34, 'rec_loss': '7.4814'}
2025-02-24 20:17:29,153 - {'Epoch': 34, 'HR@5': '0.0746', 'NDCG@5': '0.0511', 'HR@10': '0.1067', 'NDCG@10': '0.0615', 'HR@20': '0.1478', 'NDCG@20': '0.0718'}
2025-02-24 20:17:29,161 - EarlyStopping counter: 1 out of 10
2025-02-24 20:17:54,742 - {'epoch': 35, 'rec_loss': '7.4721'}
2025-02-24 20:18:03,148 - {'Epoch': 35, 'HR@5': '0.0758', 'NDCG@5': '0.0522', 'HR@10': '0.1078', 'NDCG@10': '0.0624', 'HR@20': '0.1488', 'NDCG@20': '0.0728'}
2025-02-24 20:18:03,149 - Validation score increased.  Saving model ...
2025-02-24 20:18:29,636 - {'epoch': 36, 'rec_loss': '7.4748'}
2025-02-24 20:18:38,270 - {'Epoch': 36, 'HR@5': '0.0749', 'NDCG@5': '0.0519', 'HR@10': '0.1083', 'NDCG@10': '0.0626', 'HR@20': '0.1492', 'NDCG@20': '0.0729'}
2025-02-24 20:18:38,271 - Validation score increased.  Saving model ...
2025-02-24 20:19:05,648 - {'epoch': 37, 'rec_loss': '7.4502'}
2025-02-24 20:19:13,599 - {'Epoch': 37, 'HR@5': '0.0759', 'NDCG@5': '0.0523', 'HR@10': '0.1096', 'NDCG@10': '0.0632', 'HR@20': '0.1515', 'NDCG@20': '0.0737'}
2025-02-24 20:19:13,606 - Validation score increased.  Saving model ...
2025-02-24 20:19:42,906 - {'epoch': 38, 'rec_loss': '7.4514'}
2025-02-24 20:19:52,888 - {'Epoch': 38, 'HR@5': '0.0763', 'NDCG@5': '0.0524', 'HR@10': '0.1082', 'NDCG@10': '0.0627', 'HR@20': '0.1504', 'NDCG@20': '0.0733'}
2025-02-24 20:19:52,890 - EarlyStopping counter: 1 out of 10
2025-02-24 20:20:23,567 - {'epoch': 39, 'rec_loss': '7.4544'}
2025-02-24 20:20:35,041 - {'Epoch': 39, 'HR@5': '0.0762', 'NDCG@5': '0.0521', 'HR@10': '0.1085', 'NDCG@10': '0.0625', 'HR@20': '0.1507', 'NDCG@20': '0.0731'}
2025-02-24 20:20:35,042 - EarlyStopping counter: 2 out of 10
2025-02-24 20:21:03,928 - {'epoch': 40, 'rec_loss': '7.4427'}
2025-02-24 20:21:12,894 - {'Epoch': 40, 'HR@5': '0.0763', 'NDCG@5': '0.0525', 'HR@10': '0.1084', 'NDCG@10': '0.0629', 'HR@20': '0.1504', 'NDCG@20': '0.0735'}
2025-02-24 20:21:12,903 - EarlyStopping counter: 3 out of 10
2025-02-24 20:21:42,162 - {'epoch': 41, 'rec_loss': '7.4448'}
2025-02-24 20:21:52,206 - {'Epoch': 41, 'HR@5': '0.0786', 'NDCG@5': '0.0541', 'HR@10': '0.1105', 'NDCG@10': '0.0644', 'HR@20': '0.1535', 'NDCG@20': '0.0752'}
2025-02-24 20:21:52,207 - Validation score increased.  Saving model ...
2025-02-24 20:22:22,804 - {'epoch': 42, 'rec_loss': '7.4333'}
2025-02-24 20:22:34,333 - {'Epoch': 42, 'HR@5': '0.0782', 'NDCG@5': '0.0537', 'HR@10': '0.1097', 'NDCG@10': '0.0639', 'HR@20': '0.1514', 'NDCG@20': '0.0744'}
2025-02-24 20:22:34,335 - EarlyStopping counter: 1 out of 10
2025-02-24 20:23:04,828 - {'epoch': 43, 'rec_loss': '7.4264'}
2025-02-24 20:23:13,360 - {'Epoch': 43, 'HR@5': '0.0772', 'NDCG@5': '0.0529', 'HR@10': '0.1094', 'NDCG@10': '0.0632', 'HR@20': '0.1519', 'NDCG@20': '0.0739'}
2025-02-24 20:23:13,361 - EarlyStopping counter: 2 out of 10
2025-02-24 20:23:40,792 - {'epoch': 44, 'rec_loss': '7.4381'}
2025-02-24 20:23:48,951 - {'Epoch': 44, 'HR@5': '0.0770', 'NDCG@5': '0.0531', 'HR@10': '0.1086', 'NDCG@10': '0.0632', 'HR@20': '0.1517', 'NDCG@20': '0.0740'}
2025-02-24 20:23:48,957 - EarlyStopping counter: 3 out of 10
2025-02-24 20:24:17,571 - {'epoch': 45, 'rec_loss': '7.4176'}
2025-02-24 20:24:25,315 - {'Epoch': 45, 'HR@5': '0.0787', 'NDCG@5': '0.0541', 'HR@10': '0.1104', 'NDCG@10': '0.0643', 'HR@20': '0.1523', 'NDCG@20': '0.0749'}
2025-02-24 20:24:25,321 - EarlyStopping counter: 4 out of 10
2025-02-24 20:24:52,802 - {'epoch': 46, 'rec_loss': '7.4170'}
2025-02-24 20:25:00,927 - {'Epoch': 46, 'HR@5': '0.0783', 'NDCG@5': '0.0541', 'HR@10': '0.1106', 'NDCG@10': '0.0645', 'HR@20': '0.1529', 'NDCG@20': '0.0752'}
2025-02-24 20:25:00,934 - EarlyStopping counter: 5 out of 10
2025-02-24 20:25:26,876 - {'epoch': 47, 'rec_loss': '7.4055'}
2025-02-24 20:25:34,846 - {'Epoch': 47, 'HR@5': '0.0789', 'NDCG@5': '0.0545', 'HR@10': '0.1117', 'NDCG@10': '0.0651', 'HR@20': '0.1528', 'NDCG@20': '0.0754'}
2025-02-24 20:25:34,848 - Validation score increased.  Saving model ...
2025-02-24 20:26:02,985 - {'epoch': 48, 'rec_loss': '7.4093'}
2025-02-24 20:26:11,566 - {'Epoch': 48, 'HR@5': '0.0786', 'NDCG@5': '0.0544', 'HR@10': '0.1113', 'NDCG@10': '0.0650', 'HR@20': '0.1536', 'NDCG@20': '0.0756'}
2025-02-24 20:26:11,567 - Validation score increased.  Saving model ...
2025-02-24 20:26:38,363 - {'epoch': 49, 'rec_loss': '7.4097'}
2025-02-24 20:26:46,198 - {'Epoch': 49, 'HR@5': '0.0794', 'NDCG@5': '0.0547', 'HR@10': '0.1116', 'NDCG@10': '0.0650', 'HR@20': '0.1534', 'NDCG@20': '0.0756'}
2025-02-24 20:26:46,200 - EarlyStopping counter: 1 out of 10
2025-02-24 20:27:15,422 - {'epoch': 50, 'rec_loss': '7.3993'}
2025-02-24 20:27:24,551 - {'Epoch': 50, 'HR@5': '0.0787', 'NDCG@5': '0.0538', 'HR@10': '0.1112', 'NDCG@10': '0.0642', 'HR@20': '0.1524', 'NDCG@20': '0.0746'}
2025-02-24 20:27:24,552 - EarlyStopping counter: 2 out of 10
2025-02-24 20:27:59,286 - {'epoch': 51, 'rec_loss': '7.4022'}
2025-02-24 20:28:07,818 - {'Epoch': 51, 'HR@5': '0.0795', 'NDCG@5': '0.0545', 'HR@10': '0.1109', 'NDCG@10': '0.0646', 'HR@20': '0.1543', 'NDCG@20': '0.0755'}
2025-02-24 20:28:07,825 - EarlyStopping counter: 3 out of 10
2025-02-24 20:28:36,919 - {'epoch': 52, 'rec_loss': '7.3852'}
2025-02-24 20:28:45,273 - {'Epoch': 52, 'HR@5': '0.0782', 'NDCG@5': '0.0545', 'HR@10': '0.1116', 'NDCG@10': '0.0653', 'HR@20': '0.1534', 'NDCG@20': '0.0758'}
2025-02-24 20:28:45,275 - Validation score increased.  Saving model ...
2025-02-24 20:29:16,813 - {'epoch': 53, 'rec_loss': '7.3913'}
2025-02-24 20:29:25,357 - {'Epoch': 53, 'HR@5': '0.0793', 'NDCG@5': '0.0551', 'HR@10': '0.1111', 'NDCG@10': '0.0653', 'HR@20': '0.1549', 'NDCG@20': '0.0763'}
2025-02-24 20:29:25,358 - Validation score increased.  Saving model ...
2025-02-24 20:29:54,659 - {'epoch': 54, 'rec_loss': '7.3761'}
2025-02-24 20:30:02,849 - {'Epoch': 54, 'HR@5': '0.0782', 'NDCG@5': '0.0546', 'HR@10': '0.1117', 'NDCG@10': '0.0654', 'HR@20': '0.1531', 'NDCG@20': '0.0758'}
2025-02-24 20:30:02,851 - EarlyStopping counter: 1 out of 10
2025-02-24 20:30:34,755 - {'epoch': 55, 'rec_loss': '7.3775'}
2025-02-24 20:30:44,898 - {'Epoch': 55, 'HR@5': '0.0789', 'NDCG@5': '0.0552', 'HR@10': '0.1119', 'NDCG@10': '0.0659', 'HR@20': '0.1554', 'NDCG@20': '0.0768'}
2025-02-24 20:30:44,899 - Validation score increased.  Saving model ...
2025-02-24 20:31:19,465 - {'epoch': 56, 'rec_loss': '7.3770'}
2025-02-24 20:31:30,112 - {'Epoch': 56, 'HR@5': '0.0776', 'NDCG@5': '0.0547', 'HR@10': '0.1117', 'NDCG@10': '0.0657', 'HR@20': '0.1540', 'NDCG@20': '0.0764'}
2025-02-24 20:31:30,115 - EarlyStopping counter: 1 out of 10
2025-02-24 20:31:58,696 - {'epoch': 57, 'rec_loss': '7.3745'}
2025-02-24 20:32:06,245 - {'Epoch': 57, 'HR@5': '0.0789', 'NDCG@5': '0.0546', 'HR@10': '0.1123', 'NDCG@10': '0.0654', 'HR@20': '0.1546', 'NDCG@20': '0.0760'}
2025-02-24 20:32:06,246 - EarlyStopping counter: 2 out of 10
2025-02-24 20:32:32,630 - {'epoch': 58, 'rec_loss': '7.3725'}
2025-02-24 20:32:40,313 - {'Epoch': 58, 'HR@5': '0.0780', 'NDCG@5': '0.0547', 'HR@10': '0.1113', 'NDCG@10': '0.0654', 'HR@20': '0.1545', 'NDCG@20': '0.0763'}
2025-02-24 20:32:40,314 - EarlyStopping counter: 3 out of 10
2025-02-24 20:33:09,501 - {'epoch': 59, 'rec_loss': '7.3724'}
2025-02-24 20:33:17,243 - {'Epoch': 59, 'HR@5': '0.0796', 'NDCG@5': '0.0556', 'HR@10': '0.1120', 'NDCG@10': '0.0661', 'HR@20': '0.1544', 'NDCG@20': '0.0768'}
2025-02-24 20:33:17,245 - EarlyStopping counter: 4 out of 10
2025-02-24 20:33:51,136 - {'epoch': 60, 'rec_loss': '7.3617'}
2025-02-24 20:33:58,831 - {'Epoch': 60, 'HR@5': '0.0792', 'NDCG@5': '0.0559', 'HR@10': '0.1126', 'NDCG@10': '0.0667', 'HR@20': '0.1552', 'NDCG@20': '0.0774'}
2025-02-24 20:33:58,839 - Validation score increased.  Saving model ...
2025-02-24 20:34:26,960 - {'epoch': 61, 'rec_loss': '7.3614'}
2025-02-24 20:34:35,414 - {'Epoch': 61, 'HR@5': '0.0787', 'NDCG@5': '0.0550', 'HR@10': '0.1124', 'NDCG@10': '0.0659', 'HR@20': '0.1555', 'NDCG@20': '0.0767'}
2025-02-24 20:34:35,416 - EarlyStopping counter: 1 out of 10
2025-02-24 20:35:03,926 - {'epoch': 62, 'rec_loss': '7.3652'}
2025-02-24 20:35:12,360 - {'Epoch': 62, 'HR@5': '0.0796', 'NDCG@5': '0.0558', 'HR@10': '0.1119', 'NDCG@10': '0.0662', 'HR@20': '0.1528', 'NDCG@20': '0.0765'}
2025-02-24 20:35:12,362 - EarlyStopping counter: 2 out of 10
2025-02-24 20:35:41,938 - {'epoch': 63, 'rec_loss': '7.3595'}
2025-02-24 20:35:50,376 - {'Epoch': 63, 'HR@5': '0.0786', 'NDCG@5': '0.0550', 'HR@10': '0.1121', 'NDCG@10': '0.0658', 'HR@20': '0.1546', 'NDCG@20': '0.0765'}
2025-02-24 20:35:50,377 - EarlyStopping counter: 3 out of 10
2025-02-24 20:36:17,579 - {'epoch': 64, 'rec_loss': '7.3448'}
2025-02-24 20:36:26,130 - {'Epoch': 64, 'HR@5': '0.0799', 'NDCG@5': '0.0564', 'HR@10': '0.1113', 'NDCG@10': '0.0665', 'HR@20': '0.1535', 'NDCG@20': '0.0771'}
2025-02-24 20:36:26,136 - EarlyStopping counter: 4 out of 10
2025-02-24 20:36:55,340 - {'epoch': 65, 'rec_loss': '7.3469'}
2025-02-24 20:37:03,037 - {'Epoch': 65, 'HR@5': '0.0786', 'NDCG@5': '0.0543', 'HR@10': '0.1110', 'NDCG@10': '0.0647', 'HR@20': '0.1534', 'NDCG@20': '0.0754'}
2025-02-24 20:37:03,038 - EarlyStopping counter: 5 out of 10
2025-02-24 20:37:30,365 - {'epoch': 66, 'rec_loss': '7.3376'}
2025-02-24 20:37:38,843 - {'Epoch': 66, 'HR@5': '0.0798', 'NDCG@5': '0.0552', 'HR@10': '0.1112', 'NDCG@10': '0.0653', 'HR@20': '0.1540', 'NDCG@20': '0.0761'}
2025-02-24 20:37:38,844 - EarlyStopping counter: 6 out of 10
2025-02-24 20:38:06,794 - {'epoch': 67, 'rec_loss': '7.3409'}
2025-02-24 20:38:15,819 - {'Epoch': 67, 'HR@5': '0.0793', 'NDCG@5': '0.0549', 'HR@10': '0.1126', 'NDCG@10': '0.0656', 'HR@20': '0.1548', 'NDCG@20': '0.0762'}
2025-02-24 20:38:15,820 - EarlyStopping counter: 7 out of 10
2025-02-24 20:38:44,954 - {'epoch': 68, 'rec_loss': '7.3460'}
2025-02-24 20:38:53,445 - {'Epoch': 68, 'HR@5': '0.0800', 'NDCG@5': '0.0562', 'HR@10': '0.1142', 'NDCG@10': '0.0671', 'HR@20': '0.1561', 'NDCG@20': '0.0777'}
2025-02-24 20:38:53,447 - Validation score increased.  Saving model ...
2025-02-24 20:39:20,258 - {'epoch': 69, 'rec_loss': '7.3397'}
2025-02-24 20:39:28,062 - {'Epoch': 69, 'HR@5': '0.0806', 'NDCG@5': '0.0557', 'HR@10': '0.1132', 'NDCG@10': '0.0662', 'HR@20': '0.1543', 'NDCG@20': '0.0766'}
2025-02-24 20:39:28,070 - EarlyStopping counter: 1 out of 10
2025-02-24 20:39:56,035 - {'epoch': 70, 'rec_loss': '7.3399'}
2025-02-24 20:40:03,861 - {'Epoch': 70, 'HR@5': '0.0792', 'NDCG@5': '0.0554', 'HR@10': '0.1129', 'NDCG@10': '0.0662', 'HR@20': '0.1538', 'NDCG@20': '0.0765'}
2025-02-24 20:40:03,863 - EarlyStopping counter: 2 out of 10
2025-02-24 20:40:32,217 - {'epoch': 71, 'rec_loss': '7.3379'}
2025-02-24 20:40:39,626 - {'Epoch': 71, 'HR@5': '0.0792', 'NDCG@5': '0.0553', 'HR@10': '0.1128', 'NDCG@10': '0.0661', 'HR@20': '0.1555', 'NDCG@20': '0.0768'}
2025-02-24 20:40:39,627 - EarlyStopping counter: 3 out of 10
2025-02-24 20:41:06,994 - {'epoch': 72, 'rec_loss': '7.3386'}
2025-02-24 20:41:15,677 - {'Epoch': 72, 'HR@5': '0.0815', 'NDCG@5': '0.0569', 'HR@10': '0.1141', 'NDCG@10': '0.0674', 'HR@20': '0.1550', 'NDCG@20': '0.0777'}
2025-02-24 20:41:15,678 - Validation score increased.  Saving model ...
2025-02-24 20:41:43,065 - {'epoch': 73, 'rec_loss': '7.3264'}
2025-02-24 20:41:50,778 - {'Epoch': 73, 'HR@5': '0.0798', 'NDCG@5': '0.0558', 'HR@10': '0.1145', 'NDCG@10': '0.0670', 'HR@20': '0.1549', 'NDCG@20': '0.0771'}
2025-02-24 20:41:50,784 - EarlyStopping counter: 1 out of 10
2025-02-24 20:42:18,473 - {'epoch': 74, 'rec_loss': '7.3258'}
2025-02-24 20:42:26,197 - {'Epoch': 74, 'HR@5': '0.0806', 'NDCG@5': '0.0563', 'HR@10': '0.1136', 'NDCG@10': '0.0669', 'HR@20': '0.1542', 'NDCG@20': '0.0771'}
2025-02-24 20:42:26,198 - EarlyStopping counter: 2 out of 10
2025-02-24 20:42:53,861 - {'epoch': 75, 'rec_loss': '7.3269'}
2025-02-24 20:43:01,661 - {'Epoch': 75, 'HR@5': '0.0810', 'NDCG@5': '0.0560', 'HR@10': '0.1132', 'NDCG@10': '0.0663', 'HR@20': '0.1549', 'NDCG@20': '0.0768'}
2025-02-24 20:43:01,662 - EarlyStopping counter: 3 out of 10
2025-02-24 20:43:29,552 - {'epoch': 76, 'rec_loss': '7.3142'}
2025-02-24 20:43:37,795 - {'Epoch': 76, 'HR@5': '0.0804', 'NDCG@5': '0.0560', 'HR@10': '0.1137', 'NDCG@10': '0.0668', 'HR@20': '0.1556', 'NDCG@20': '0.0773'}
2025-02-24 20:43:37,796 - EarlyStopping counter: 4 out of 10
2025-02-24 20:44:05,468 - {'epoch': 77, 'rec_loss': '7.3286'}
2025-02-24 20:44:12,911 - {'Epoch': 77, 'HR@5': '0.0806', 'NDCG@5': '0.0562', 'HR@10': '0.1135', 'NDCG@10': '0.0669', 'HR@20': '0.1561', 'NDCG@20': '0.0776'}
2025-02-24 20:44:12,912 - EarlyStopping counter: 5 out of 10
2025-02-24 20:44:40,677 - {'epoch': 78, 'rec_loss': '7.3134'}
2025-02-24 20:44:49,246 - {'Epoch': 78, 'HR@5': '0.0814', 'NDCG@5': '0.0567', 'HR@10': '0.1134', 'NDCG@10': '0.0671', 'HR@20': '0.1558', 'NDCG@20': '0.0777'}
2025-02-24 20:44:49,253 - Validation score increased.  Saving model ...
2025-02-24 20:45:16,570 - {'epoch': 79, 'rec_loss': '7.3206'}
2025-02-24 20:45:23,998 - {'Epoch': 79, 'HR@5': '0.0815', 'NDCG@5': '0.0565', 'HR@10': '0.1132', 'NDCG@10': '0.0667', 'HR@20': '0.1556', 'NDCG@20': '0.0774'}
2025-02-24 20:45:24,005 - EarlyStopping counter: 1 out of 10
2025-02-24 20:45:52,036 - {'epoch': 80, 'rec_loss': '7.3262'}
2025-02-24 20:46:00,034 - {'Epoch': 80, 'HR@5': '0.0802', 'NDCG@5': '0.0559', 'HR@10': '0.1126', 'NDCG@10': '0.0664', 'HR@20': '0.1548', 'NDCG@20': '0.0770'}
2025-02-24 20:46:00,035 - EarlyStopping counter: 2 out of 10
2025-02-24 20:46:26,876 - {'epoch': 81, 'rec_loss': '7.3185'}
2025-02-24 20:46:34,633 - {'Epoch': 81, 'HR@5': '0.0814', 'NDCG@5': '0.0571', 'HR@10': '0.1138', 'NDCG@10': '0.0675', 'HR@20': '0.1558', 'NDCG@20': '0.0781'}
2025-02-24 20:46:34,634 - Validation score increased.  Saving model ...
2025-02-24 20:47:01,195 - {'epoch': 82, 'rec_loss': '7.3221'}
2025-02-24 20:47:09,346 - {'Epoch': 82, 'HR@5': '0.0809', 'NDCG@5': '0.0560', 'HR@10': '0.1122', 'NDCG@10': '0.0662', 'HR@20': '0.1553', 'NDCG@20': '0.0770'}
2025-02-24 20:47:09,347 - EarlyStopping counter: 1 out of 10
2025-02-24 20:47:36,569 - {'epoch': 83, 'rec_loss': '7.3050'}
2025-02-24 20:47:44,311 - {'Epoch': 83, 'HR@5': '0.0804', 'NDCG@5': '0.0559', 'HR@10': '0.1147', 'NDCG@10': '0.0669', 'HR@20': '0.1556', 'NDCG@20': '0.0772'}
2025-02-24 20:47:44,312 - EarlyStopping counter: 2 out of 10
2025-02-24 20:48:12,317 - {'epoch': 84, 'rec_loss': '7.3049'}
2025-02-24 20:48:20,181 - {'Epoch': 84, 'HR@5': '0.0809', 'NDCG@5': '0.0568', 'HR@10': '0.1136', 'NDCG@10': '0.0674', 'HR@20': '0.1547', 'NDCG@20': '0.0777'}
2025-02-24 20:48:20,182 - EarlyStopping counter: 3 out of 10
2025-02-24 20:48:45,725 - {'epoch': 85, 'rec_loss': '7.3083'}
2025-02-24 20:48:54,319 - {'Epoch': 85, 'HR@5': '0.0807', 'NDCG@5': '0.0561', 'HR@10': '0.1134', 'NDCG@10': '0.0666', 'HR@20': '0.1539', 'NDCG@20': '0.0768'}
2025-02-24 20:48:54,320 - EarlyStopping counter: 4 out of 10
2025-02-24 20:49:21,573 - {'epoch': 86, 'rec_loss': '7.3079'}
2025-02-24 20:49:30,080 - {'Epoch': 86, 'HR@5': '0.0824', 'NDCG@5': '0.0568', 'HR@10': '0.1134', 'NDCG@10': '0.0668', 'HR@20': '0.1531', 'NDCG@20': '0.0768'}
2025-02-24 20:49:30,081 - EarlyStopping counter: 5 out of 10
2025-02-24 20:49:55,616 - {'epoch': 87, 'rec_loss': '7.3048'}
2025-02-24 20:50:04,322 - {'Epoch': 87, 'HR@5': '0.0808', 'NDCG@5': '0.0565', 'HR@10': '0.1139', 'NDCG@10': '0.0671', 'HR@20': '0.1542', 'NDCG@20': '0.0773'}
2025-02-24 20:50:04,324 - EarlyStopping counter: 6 out of 10
2025-02-24 20:50:32,084 - {'epoch': 88, 'rec_loss': '7.3028'}
2025-02-24 20:50:39,700 - {'Epoch': 88, 'HR@5': '0.0819', 'NDCG@5': '0.0577', 'HR@10': '0.1140', 'NDCG@10': '0.0681', 'HR@20': '0.1563', 'NDCG@20': '0.0787'}
2025-02-24 20:50:39,702 - Validation score increased.  Saving model ...
2025-02-24 20:51:06,709 - {'epoch': 89, 'rec_loss': '7.2996'}
2025-02-24 20:51:14,887 - {'Epoch': 89, 'HR@5': '0.0811', 'NDCG@5': '0.0564', 'HR@10': '0.1140', 'NDCG@10': '0.0670', 'HR@20': '0.1558', 'NDCG@20': '0.0775'}
2025-02-24 20:51:14,888 - EarlyStopping counter: 1 out of 10
2025-02-24 20:51:42,094 - {'epoch': 90, 'rec_loss': '7.3003'}
2025-02-24 20:51:49,653 - {'Epoch': 90, 'HR@5': '0.0808', 'NDCG@5': '0.0568', 'HR@10': '0.1130', 'NDCG@10': '0.0672', 'HR@20': '0.1555', 'NDCG@20': '0.0778'}
2025-02-24 20:51:49,660 - EarlyStopping counter: 2 out of 10
2025-02-24 20:52:19,643 - {'epoch': 91, 'rec_loss': '7.2991'}
2025-02-24 20:52:27,470 - {'Epoch': 91, 'HR@5': '0.0821', 'NDCG@5': '0.0577', 'HR@10': '0.1137', 'NDCG@10': '0.0679', 'HR@20': '0.1555', 'NDCG@20': '0.0784'}
2025-02-24 20:52:27,471 - EarlyStopping counter: 3 out of 10
2025-02-24 20:52:56,032 - {'epoch': 92, 'rec_loss': '7.3005'}
2025-02-24 20:53:03,736 - {'Epoch': 92, 'HR@5': '0.0823', 'NDCG@5': '0.0571', 'HR@10': '0.1137', 'NDCG@10': '0.0672', 'HR@20': '0.1554', 'NDCG@20': '0.0777'}
2025-02-24 20:53:03,737 - EarlyStopping counter: 4 out of 10
2025-02-24 20:53:31,684 - {'epoch': 93, 'rec_loss': '7.2877'}
2025-02-24 20:53:39,060 - {'Epoch': 93, 'HR@5': '0.0801', 'NDCG@5': '0.0565', 'HR@10': '0.1130', 'NDCG@10': '0.0671', 'HR@20': '0.1538', 'NDCG@20': '0.0774'}
2025-02-24 20:53:39,061 - EarlyStopping counter: 5 out of 10
2025-02-24 20:54:06,918 - {'epoch': 94, 'rec_loss': '7.2956'}
2025-02-24 20:54:14,704 - {'Epoch': 94, 'HR@5': '0.0805', 'NDCG@5': '0.0564', 'HR@10': '0.1131', 'NDCG@10': '0.0670', 'HR@20': '0.1538', 'NDCG@20': '0.0773'}
2025-02-24 20:54:14,705 - EarlyStopping counter: 6 out of 10
2025-02-24 20:54:42,777 - {'epoch': 95, 'rec_loss': '7.2913'}
2025-02-24 20:54:50,490 - {'Epoch': 95, 'HR@5': '0.0810', 'NDCG@5': '0.0569', 'HR@10': '0.1130', 'NDCG@10': '0.0672', 'HR@20': '0.1557', 'NDCG@20': '0.0780'}
2025-02-24 20:54:50,491 - EarlyStopping counter: 7 out of 10
2025-02-24 20:55:17,359 - {'epoch': 96, 'rec_loss': '7.2877'}
2025-02-24 20:55:24,921 - {'Epoch': 96, 'HR@5': '0.0822', 'NDCG@5': '0.0577', 'HR@10': '0.1143', 'NDCG@10': '0.0680', 'HR@20': '0.1556', 'NDCG@20': '0.0784'}
2025-02-24 20:55:24,922 - EarlyStopping counter: 8 out of 10
2025-02-24 20:55:52,089 - {'epoch': 97, 'rec_loss': '7.2849'}
2025-02-24 20:55:59,647 - {'Epoch': 97, 'HR@5': '0.0824', 'NDCG@5': '0.0576', 'HR@10': '0.1138', 'NDCG@10': '0.0678', 'HR@20': '0.1557', 'NDCG@20': '0.0783'}
2025-02-24 20:55:59,648 - EarlyStopping counter: 9 out of 10
2025-02-24 20:56:27,322 - {'epoch': 98, 'rec_loss': '7.2823'}
2025-02-24 20:56:35,051 - {'Epoch': 98, 'HR@5': '0.0818', 'NDCG@5': '0.0573', 'HR@10': '0.1143', 'NDCG@10': '0.0678', 'HR@20': '0.1547', 'NDCG@20': '0.0779'}
2025-02-24 20:56:35,053 - EarlyStopping counter: 10 out of 10
2025-02-24 20:56:35,053 - Early stopping
2025-02-24 20:56:35,053 - ---------------Test Score---------------
2025-02-24 20:56:42,564 - {'Epoch': 0, 'HR@5': '0.0632', 'NDCG@5': '0.0442', 'HR@10': '0.0905', 'NDCG@10': '0.0530', 'HR@20': '0.1287', 'NDCG@20': '0.0626'}
2025-02-24 20:56:42,565 - Scale_Beauty
2025-02-24 20:56:42,566 - {'Epoch': 0, 'HR@5': '0.0632', 'NDCG@5': '0.0442', 'HR@10': '0.0905', 'NDCG@10': '0.0530', 'HR@20': '0.1287', 'NDCG@20': '0.0626'}
2025-02-26 13:27:41,020 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10, 5], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-26 13:27:44,069 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-26 13:27:44,080 - Total Parameters: 928145
2025-02-26 13:28:21,813 - {'epoch': 0, 'rec_loss': '8.8042'}
2025-02-26 13:28:30,912 - {'Epoch': 0, 'HR@5': '0.0229', 'NDCG@5': '0.0147', 'HR@10': '0.0357', 'NDCG@10': '0.0188', 'HR@20': '0.0545', 'NDCG@20': '0.0235'}
2025-02-26 13:28:30,914 - Validation score increased.  Saving model ...
2025-02-26 13:29:08,009 - {'epoch': 1, 'rec_loss': '8.2197'}
2025-02-26 13:29:17,952 - {'Epoch': 1, 'HR@5': '0.0420', 'NDCG@5': '0.0287', 'HR@10': '0.0618', 'NDCG@10': '0.0351', 'HR@20': '0.0908', 'NDCG@20': '0.0424'}
2025-02-26 13:29:17,954 - Validation score increased.  Saving model ...
2025-02-26 13:29:54,591 - {'epoch': 2, 'rec_loss': '7.8974'}
2025-02-26 13:30:02,945 - {'Epoch': 2, 'HR@5': '0.0591', 'NDCG@5': '0.0402', 'HR@10': '0.0835', 'NDCG@10': '0.0481', 'HR@20': '0.1170', 'NDCG@20': '0.0566'}
2025-02-26 13:30:02,946 - Validation score increased.  Saving model ...
2025-02-26 13:30:41,093 - {'epoch': 3, 'rec_loss': '7.6829'}
2025-02-26 13:30:49,392 - {'Epoch': 3, 'HR@5': '0.0685', 'NDCG@5': '0.0474', 'HR@10': '0.0969', 'NDCG@10': '0.0565', 'HR@20': '0.1325', 'NDCG@20': '0.0655'}
2025-02-26 13:30:49,394 - Validation score increased.  Saving model ...
2025-02-26 13:31:25,801 - {'epoch': 4, 'rec_loss': '7.5132'}
2025-02-26 13:31:34,325 - {'Epoch': 4, 'HR@5': '0.0735', 'NDCG@5': '0.0516', 'HR@10': '0.1040', 'NDCG@10': '0.0614', 'HR@20': '0.1406', 'NDCG@20': '0.0706'}
2025-02-26 13:31:34,326 - Validation score increased.  Saving model ...
2025-02-26 13:32:10,087 - {'epoch': 5, 'rec_loss': '7.3949'}
2025-02-26 13:32:18,833 - {'Epoch': 5, 'HR@5': '0.0765', 'NDCG@5': '0.0542', 'HR@10': '0.1070', 'NDCG@10': '0.0640', 'HR@20': '0.1458', 'NDCG@20': '0.0737'}
2025-02-26 13:32:18,834 - Validation score increased.  Saving model ...
2025-02-26 13:32:55,586 - {'epoch': 6, 'rec_loss': '7.3013'}
2025-02-26 13:33:04,327 - {'Epoch': 6, 'HR@5': '0.0803', 'NDCG@5': '0.0565', 'HR@10': '0.1101', 'NDCG@10': '0.0661', 'HR@20': '0.1485', 'NDCG@20': '0.0758'}
2025-02-26 13:33:04,328 - Validation score increased.  Saving model ...
2025-02-26 13:33:40,722 - {'epoch': 7, 'rec_loss': '7.2257'}
2025-02-26 13:33:49,175 - {'Epoch': 7, 'HR@5': '0.0789', 'NDCG@5': '0.0555', 'HR@10': '0.1105', 'NDCG@10': '0.0656', 'HR@20': '0.1523', 'NDCG@20': '0.0761'}
2025-02-26 13:33:49,177 - Validation score increased.  Saving model ...
2025-02-26 13:34:25,861 - {'epoch': 8, 'rec_loss': '7.1661'}
2025-02-26 13:34:34,461 - {'Epoch': 8, 'HR@5': '0.0807', 'NDCG@5': '0.0570', 'HR@10': '0.1112', 'NDCG@10': '0.0668', 'HR@20': '0.1543', 'NDCG@20': '0.0777'}
2025-02-26 13:34:34,462 - Validation score increased.  Saving model ...
2025-02-26 13:35:11,151 - {'epoch': 9, 'rec_loss': '7.1136'}
2025-02-26 13:35:20,059 - {'Epoch': 9, 'HR@5': '0.0846', 'NDCG@5': '0.0597', 'HR@10': '0.1159', 'NDCG@10': '0.0698', 'HR@20': '0.1570', 'NDCG@20': '0.0801'}
2025-02-26 13:35:20,060 - Validation score increased.  Saving model ...
2025-02-26 13:35:56,936 - {'epoch': 10, 'rec_loss': '7.0723'}
2025-02-26 13:36:05,525 - {'Epoch': 10, 'HR@5': '0.0840', 'NDCG@5': '0.0597', 'HR@10': '0.1149', 'NDCG@10': '0.0697', 'HR@20': '0.1571', 'NDCG@20': '0.0804'}
2025-02-26 13:36:05,526 - Validation score increased.  Saving model ...
2025-02-26 13:36:43,463 - {'epoch': 11, 'rec_loss': '7.0369'}
2025-02-26 13:36:52,657 - {'Epoch': 11, 'HR@5': '0.0851', 'NDCG@5': '0.0601', 'HR@10': '0.1165', 'NDCG@10': '0.0701', 'HR@20': '0.1570', 'NDCG@20': '0.0803'}
2025-02-26 13:36:52,658 - EarlyStopping counter: 1 out of 10
2025-02-26 13:37:29,119 - {'epoch': 12, 'rec_loss': '7.0048'}
2025-02-26 13:37:37,651 - {'Epoch': 12, 'HR@5': '0.0852', 'NDCG@5': '0.0608', 'HR@10': '0.1179', 'NDCG@10': '0.0713', 'HR@20': '0.1602', 'NDCG@20': '0.0820'}
2025-02-26 13:37:37,653 - Validation score increased.  Saving model ...
2025-02-26 13:38:15,620 - {'epoch': 13, 'rec_loss': '6.9757'}
2025-02-26 13:38:24,161 - {'Epoch': 13, 'HR@5': '0.0850', 'NDCG@5': '0.0617', 'HR@10': '0.1167', 'NDCG@10': '0.0720', 'HR@20': '0.1594', 'NDCG@20': '0.0827'}
2025-02-26 13:38:24,163 - Validation score increased.  Saving model ...
2025-02-26 13:39:01,618 - {'epoch': 14, 'rec_loss': '6.9457'}
2025-02-26 13:39:10,747 - {'Epoch': 14, 'HR@5': '0.0847', 'NDCG@5': '0.0602', 'HR@10': '0.1178', 'NDCG@10': '0.0708', 'HR@20': '0.1607', 'NDCG@20': '0.0816'}
2025-02-26 13:39:10,749 - EarlyStopping counter: 1 out of 10
2025-02-26 13:39:46,707 - {'epoch': 15, 'rec_loss': '6.9243'}
2025-02-26 13:39:55,184 - {'Epoch': 15, 'HR@5': '0.0858', 'NDCG@5': '0.0608', 'HR@10': '0.1159', 'NDCG@10': '0.0704', 'HR@20': '0.1587', 'NDCG@20': '0.0812'}
2025-02-26 13:39:55,185 - EarlyStopping counter: 2 out of 10
2025-02-26 13:40:30,237 - {'epoch': 16, 'rec_loss': '6.9005'}
2025-02-26 13:40:39,345 - {'Epoch': 16, 'HR@5': '0.0846', 'NDCG@5': '0.0600', 'HR@10': '0.1165', 'NDCG@10': '0.0702', 'HR@20': '0.1605', 'NDCG@20': '0.0813'}
2025-02-26 13:40:39,347 - EarlyStopping counter: 3 out of 10
2025-02-26 13:41:14,974 - {'epoch': 17, 'rec_loss': '6.8854'}
2025-02-26 13:41:23,694 - {'Epoch': 17, 'HR@5': '0.0854', 'NDCG@5': '0.0609', 'HR@10': '0.1180', 'NDCG@10': '0.0714', 'HR@20': '0.1582', 'NDCG@20': '0.0815'}
2025-02-26 13:41:23,696 - EarlyStopping counter: 4 out of 10
2025-02-26 13:41:59,234 - {'epoch': 18, 'rec_loss': '6.8697'}
2025-02-26 13:42:07,772 - {'Epoch': 18, 'HR@5': '0.0835', 'NDCG@5': '0.0589', 'HR@10': '0.1167', 'NDCG@10': '0.0696', 'HR@20': '0.1591', 'NDCG@20': '0.0802'}
2025-02-26 13:42:07,773 - EarlyStopping counter: 5 out of 10
2025-02-26 13:42:43,411 - {'epoch': 19, 'rec_loss': '6.8491'}
2025-02-26 13:42:52,229 - {'Epoch': 19, 'HR@5': '0.0872', 'NDCG@5': '0.0613', 'HR@10': '0.1186', 'NDCG@10': '0.0714', 'HR@20': '0.1600', 'NDCG@20': '0.0818'}
2025-02-26 13:42:52,234 - EarlyStopping counter: 6 out of 10
2025-02-26 13:43:28,622 - {'epoch': 20, 'rec_loss': '6.8316'}
2025-02-26 13:43:37,397 - {'Epoch': 20, 'HR@5': '0.0846', 'NDCG@5': '0.0598', 'HR@10': '0.1179', 'NDCG@10': '0.0706', 'HR@20': '0.1610', 'NDCG@20': '0.0814'}
2025-02-26 13:43:37,399 - EarlyStopping counter: 7 out of 10
2025-02-26 13:44:13,519 - {'epoch': 21, 'rec_loss': '6.8215'}
2025-02-26 13:44:22,004 - {'Epoch': 21, 'HR@5': '0.0858', 'NDCG@5': '0.0603', 'HR@10': '0.1172', 'NDCG@10': '0.0704', 'HR@20': '0.1604', 'NDCG@20': '0.0813'}
2025-02-26 13:44:22,006 - EarlyStopping counter: 8 out of 10
2025-02-26 13:44:58,287 - {'epoch': 22, 'rec_loss': '6.8050'}
2025-02-26 13:45:07,642 - {'Epoch': 22, 'HR@5': '0.0876', 'NDCG@5': '0.0621', 'HR@10': '0.1194', 'NDCG@10': '0.0723', 'HR@20': '0.1608', 'NDCG@20': '0.0827'}
2025-02-26 13:45:07,645 - Validation score increased.  Saving model ...
2025-02-26 13:45:45,104 - {'epoch': 23, 'rec_loss': '6.7852'}
2025-02-26 13:45:54,659 - {'Epoch': 23, 'HR@5': '0.0867', 'NDCG@5': '0.0613', 'HR@10': '0.1190', 'NDCG@10': '0.0717', 'HR@20': '0.1604', 'NDCG@20': '0.0822'}
2025-02-26 13:45:54,661 - EarlyStopping counter: 1 out of 10
2025-02-26 13:46:30,674 - {'epoch': 24, 'rec_loss': '6.7793'}
2025-02-26 13:46:40,152 - {'Epoch': 24, 'HR@5': '0.0869', 'NDCG@5': '0.0617', 'HR@10': '0.1197', 'NDCG@10': '0.0723', 'HR@20': '0.1621', 'NDCG@20': '0.0829'}
2025-02-26 13:46:40,154 - Validation score increased.  Saving model ...
2025-02-26 13:47:16,256 - {'epoch': 25, 'rec_loss': '6.7706'}
2025-02-26 13:47:26,126 - {'Epoch': 25, 'HR@5': '0.0856', 'NDCG@5': '0.0602', 'HR@10': '0.1176', 'NDCG@10': '0.0705', 'HR@20': '0.1615', 'NDCG@20': '0.0816'}
2025-02-26 13:47:26,128 - EarlyStopping counter: 1 out of 10
2025-02-26 13:48:03,352 - {'epoch': 26, 'rec_loss': '6.7556'}
2025-02-26 13:48:12,041 - {'Epoch': 26, 'HR@5': '0.0876', 'NDCG@5': '0.0620', 'HR@10': '0.1183', 'NDCG@10': '0.0719', 'HR@20': '0.1625', 'NDCG@20': '0.0830'}
2025-02-26 13:48:12,042 - Validation score increased.  Saving model ...
2025-02-26 13:48:49,424 - {'epoch': 27, 'rec_loss': '6.7465'}
2025-02-26 13:48:58,616 - {'Epoch': 27, 'HR@5': '0.0869', 'NDCG@5': '0.0614', 'HR@10': '0.1192', 'NDCG@10': '0.0719', 'HR@20': '0.1630', 'NDCG@20': '0.0829'}
2025-02-26 13:48:58,618 - EarlyStopping counter: 1 out of 10
2025-02-26 13:49:34,949 - {'epoch': 28, 'rec_loss': '6.7323'}
2025-02-26 13:49:44,964 - {'Epoch': 28, 'HR@5': '0.0870', 'NDCG@5': '0.0610', 'HR@10': '0.1210', 'NDCG@10': '0.0720', 'HR@20': '0.1642', 'NDCG@20': '0.0828'}
2025-02-26 13:49:44,966 - EarlyStopping counter: 2 out of 10
2025-02-26 13:50:21,270 - {'epoch': 29, 'rec_loss': '6.7247'}
2025-02-26 13:50:30,180 - {'Epoch': 29, 'HR@5': '0.0862', 'NDCG@5': '0.0609', 'HR@10': '0.1197', 'NDCG@10': '0.0716', 'HR@20': '0.1630', 'NDCG@20': '0.0825'}
2025-02-26 13:50:30,181 - EarlyStopping counter: 3 out of 10
2025-02-26 13:51:05,771 - {'epoch': 30, 'rec_loss': '6.7146'}
2025-02-26 13:51:15,017 - {'Epoch': 30, 'HR@5': '0.0882', 'NDCG@5': '0.0626', 'HR@10': '0.1198', 'NDCG@10': '0.0727', 'HR@20': '0.1634', 'NDCG@20': '0.0837'}
2025-02-26 13:51:15,019 - Validation score increased.  Saving model ...
2025-02-26 13:51:51,243 - {'epoch': 31, 'rec_loss': '6.7019'}
2025-02-26 13:52:01,191 - {'Epoch': 31, 'HR@5': '0.0873', 'NDCG@5': '0.0622', 'HR@10': '0.1189', 'NDCG@10': '0.0723', 'HR@20': '0.1610', 'NDCG@20': '0.0829'}
2025-02-26 13:52:01,193 - EarlyStopping counter: 1 out of 10
2025-02-26 13:52:37,649 - {'epoch': 32, 'rec_loss': '6.6983'}
2025-02-26 13:52:46,612 - {'Epoch': 32, 'HR@5': '0.0869', 'NDCG@5': '0.0615', 'HR@10': '0.1175', 'NDCG@10': '0.0714', 'HR@20': '0.1608', 'NDCG@20': '0.0822'}
2025-02-26 13:52:46,615 - EarlyStopping counter: 2 out of 10
2025-02-26 13:53:22,673 - {'epoch': 33, 'rec_loss': '6.6877'}
2025-02-26 13:53:32,444 - {'Epoch': 33, 'HR@5': '0.0877', 'NDCG@5': '0.0621', 'HR@10': '0.1196', 'NDCG@10': '0.0723', 'HR@20': '0.1619', 'NDCG@20': '0.0829'}
2025-02-26 13:53:32,446 - EarlyStopping counter: 3 out of 10
2025-02-26 13:54:09,902 - {'epoch': 34, 'rec_loss': '6.6797'}
2025-02-26 13:54:19,487 - {'Epoch': 34, 'HR@5': '0.0847', 'NDCG@5': '0.0609', 'HR@10': '0.1202', 'NDCG@10': '0.0723', 'HR@20': '0.1615', 'NDCG@20': '0.0827'}
2025-02-26 13:54:19,489 - EarlyStopping counter: 4 out of 10
2025-02-26 13:54:55,139 - {'epoch': 35, 'rec_loss': '6.6766'}
2025-02-26 13:55:04,737 - {'Epoch': 35, 'HR@5': '0.0872', 'NDCG@5': '0.0622', 'HR@10': '0.1206', 'NDCG@10': '0.0730', 'HR@20': '0.1614', 'NDCG@20': '0.0832'}
2025-02-26 13:55:04,742 - EarlyStopping counter: 5 out of 10
2025-02-26 13:55:41,540 - {'epoch': 36, 'rec_loss': '6.6650'}
2025-02-26 13:55:50,046 - {'Epoch': 36, 'HR@5': '0.0873', 'NDCG@5': '0.0616', 'HR@10': '0.1189', 'NDCG@10': '0.0717', 'HR@20': '0.1618', 'NDCG@20': '0.0826'}
2025-02-26 13:55:50,047 - EarlyStopping counter: 6 out of 10
2025-02-26 13:56:26,400 - {'epoch': 37, 'rec_loss': '6.6538'}
2025-02-26 13:56:35,716 - {'Epoch': 37, 'HR@5': '0.0864', 'NDCG@5': '0.0607', 'HR@10': '0.1193', 'NDCG@10': '0.0714', 'HR@20': '0.1622', 'NDCG@20': '0.0822'}
2025-02-26 13:56:35,717 - EarlyStopping counter: 7 out of 10
2025-02-26 13:57:11,529 - {'epoch': 38, 'rec_loss': '6.6477'}
2025-02-26 13:57:20,759 - {'Epoch': 38, 'HR@5': '0.0878', 'NDCG@5': '0.0619', 'HR@10': '0.1206', 'NDCG@10': '0.0724', 'HR@20': '0.1614', 'NDCG@20': '0.0827'}
2025-02-26 13:57:20,761 - EarlyStopping counter: 8 out of 10
2025-02-26 13:57:56,894 - {'epoch': 39, 'rec_loss': '6.6466'}
2025-02-26 13:58:06,004 - {'Epoch': 39, 'HR@5': '0.0872', 'NDCG@5': '0.0611', 'HR@10': '0.1184', 'NDCG@10': '0.0711', 'HR@20': '0.1616', 'NDCG@20': '0.0820'}
2025-02-26 13:58:06,005 - EarlyStopping counter: 9 out of 10
2025-02-26 13:58:43,134 - {'epoch': 40, 'rec_loss': '6.6378'}
2025-02-26 13:58:53,115 - {'Epoch': 40, 'HR@5': '0.0873', 'NDCG@5': '0.0613', 'HR@10': '0.1196', 'NDCG@10': '0.0717', 'HR@20': '0.1608', 'NDCG@20': '0.0820'}
2025-02-26 13:58:53,116 - EarlyStopping counter: 10 out of 10
2025-02-26 13:58:53,117 - Early stopping
2025-02-26 13:58:53,117 - ---------------Test Score---------------
2025-02-26 13:59:02,831 - {'Epoch': 0, 'HR@5': '0.0707', 'NDCG@5': '0.0507', 'HR@10': '0.0991', 'NDCG@10': '0.0599', 'HR@20': '0.1364', 'NDCG@20': '0.0693'}
2025-02-26 13:59:02,832 - Scale_Beauty
2025-02-26 13:59:02,832 - {'Epoch': 0, 'HR@5': '0.0707', 'NDCG@5': '0.0507', 'HR@10': '0.0991', 'NDCG@10': '0.0599', 'HR@20': '0.1364', 'NDCG@20': '0.0693'}
2025-02-26 14:03:36,932 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 10, 5], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-26 14:03:39,998 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-26 14:03:40,011 - Total Parameters: 928145
2025-02-26 14:04:17,241 - {'epoch': 0, 'rec_loss': '8.8136'}
2025-02-26 14:04:26,344 - {'Epoch': 0, 'HR@5': '0.0228', 'NDCG@5': '0.0146', 'HR@10': '0.0360', 'NDCG@10': '0.0189', 'HR@20': '0.0540', 'NDCG@20': '0.0233'}
2025-02-26 14:04:26,345 - Validation score increased.  Saving model ...
2025-02-26 14:05:02,228 - {'epoch': 1, 'rec_loss': '8.2209'}
2025-02-26 14:05:11,664 - {'Epoch': 1, 'HR@5': '0.0431', 'NDCG@5': '0.0290', 'HR@10': '0.0627', 'NDCG@10': '0.0353', 'HR@20': '0.0926', 'NDCG@20': '0.0428'}
2025-02-26 14:05:11,665 - Validation score increased.  Saving model ...
2025-02-26 14:05:46,616 - {'epoch': 2, 'rec_loss': '7.9012'}
2025-02-26 14:05:55,954 - {'Epoch': 2, 'HR@5': '0.0576', 'NDCG@5': '0.0391', 'HR@10': '0.0834', 'NDCG@10': '0.0475', 'HR@20': '0.1169', 'NDCG@20': '0.0559'}
2025-02-26 14:05:55,955 - Validation score increased.  Saving model ...
2025-02-26 14:06:31,220 - {'epoch': 3, 'rec_loss': '7.6765'}
2025-02-26 14:06:40,591 - {'Epoch': 3, 'HR@5': '0.0666', 'NDCG@5': '0.0464', 'HR@10': '0.0940', 'NDCG@10': '0.0552', 'HR@20': '0.1303', 'NDCG@20': '0.0643'}
2025-02-26 14:06:40,593 - Validation score increased.  Saving model ...
2025-02-26 14:07:16,504 - {'epoch': 4, 'rec_loss': '7.5195'}
2025-02-26 14:07:25,600 - {'Epoch': 4, 'HR@5': '0.0728', 'NDCG@5': '0.0501', 'HR@10': '0.1022', 'NDCG@10': '0.0596', 'HR@20': '0.1405', 'NDCG@20': '0.0692'}
2025-02-26 14:07:25,602 - Validation score increased.  Saving model ...
2025-02-26 14:08:01,194 - {'epoch': 5, 'rec_loss': '7.3901'}
2025-02-26 14:08:10,515 - {'Epoch': 5, 'HR@5': '0.0779', 'NDCG@5': '0.0551', 'HR@10': '0.1074', 'NDCG@10': '0.0645', 'HR@20': '0.1468', 'NDCG@20': '0.0745'}
2025-02-26 14:08:10,516 - Validation score increased.  Saving model ...
2025-02-26 14:08:45,837 - {'epoch': 6, 'rec_loss': '7.2952'}
2025-02-26 14:08:54,344 - {'Epoch': 6, 'HR@5': '0.0797', 'NDCG@5': '0.0566', 'HR@10': '0.1117', 'NDCG@10': '0.0669', 'HR@20': '0.1522', 'NDCG@20': '0.0770'}
2025-02-26 14:08:54,345 - Validation score increased.  Saving model ...
2025-02-26 14:09:29,986 - {'epoch': 7, 'rec_loss': '7.2239'}
2025-02-26 14:09:38,441 - {'Epoch': 7, 'HR@5': '0.0812', 'NDCG@5': '0.0576', 'HR@10': '0.1128', 'NDCG@10': '0.0678', 'HR@20': '0.1538', 'NDCG@20': '0.0781'}
2025-02-26 14:09:38,443 - Validation score increased.  Saving model ...
2025-02-26 14:10:13,915 - {'epoch': 8, 'rec_loss': '7.1623'}
2025-02-26 14:10:23,038 - {'Epoch': 8, 'HR@5': '0.0816', 'NDCG@5': '0.0579', 'HR@10': '0.1121', 'NDCG@10': '0.0677', 'HR@20': '0.1529', 'NDCG@20': '0.0779'}
2025-02-26 14:10:23,039 - EarlyStopping counter: 1 out of 10
2025-02-26 14:10:58,302 - {'epoch': 9, 'rec_loss': '7.1140'}
2025-02-26 14:11:07,067 - {'Epoch': 9, 'HR@5': '0.0841', 'NDCG@5': '0.0594', 'HR@10': '0.1146', 'NDCG@10': '0.0693', 'HR@20': '0.1550', 'NDCG@20': '0.0795'}
2025-02-26 14:11:07,068 - Validation score increased.  Saving model ...
2025-02-26 14:11:43,093 - {'epoch': 10, 'rec_loss': '7.0725'}
2025-02-26 14:11:52,222 - {'Epoch': 10, 'HR@5': '0.0842', 'NDCG@5': '0.0592', 'HR@10': '0.1173', 'NDCG@10': '0.0698', 'HR@20': '0.1567', 'NDCG@20': '0.0797'}
2025-02-26 14:11:52,225 - Validation score increased.  Saving model ...
2025-02-26 14:12:28,126 - {'epoch': 11, 'rec_loss': '7.0328'}
2025-02-26 14:12:37,544 - {'Epoch': 11, 'HR@5': '0.0833', 'NDCG@5': '0.0594', 'HR@10': '0.1164', 'NDCG@10': '0.0700', 'HR@20': '0.1583', 'NDCG@20': '0.0805'}
2025-02-26 14:12:37,546 - Validation score increased.  Saving model ...
2025-02-26 14:13:13,260 - {'epoch': 12, 'rec_loss': '7.0041'}
2025-02-26 14:13:22,745 - {'Epoch': 12, 'HR@5': '0.0860', 'NDCG@5': '0.0603', 'HR@10': '0.1182', 'NDCG@10': '0.0707', 'HR@20': '0.1579', 'NDCG@20': '0.0807'}
2025-02-26 14:13:22,746 - Validation score increased.  Saving model ...
2025-02-26 14:13:58,220 - {'epoch': 13, 'rec_loss': '6.9745'}
2025-02-26 14:14:07,331 - {'Epoch': 13, 'HR@5': '0.0845', 'NDCG@5': '0.0599', 'HR@10': '0.1179', 'NDCG@10': '0.0707', 'HR@20': '0.1591', 'NDCG@20': '0.0811'}
2025-02-26 14:14:07,333 - Validation score increased.  Saving model ...
2025-02-26 14:14:42,782 - {'epoch': 14, 'rec_loss': '6.9468'}
2025-02-26 14:14:52,014 - {'Epoch': 14, 'HR@5': '0.0843', 'NDCG@5': '0.0595', 'HR@10': '0.1177', 'NDCG@10': '0.0703', 'HR@20': '0.1590', 'NDCG@20': '0.0807'}
2025-02-26 14:14:52,016 - EarlyStopping counter: 1 out of 10
2025-02-26 14:15:27,794 - {'epoch': 15, 'rec_loss': '6.9249'}
2025-02-26 14:15:37,350 - {'Epoch': 15, 'HR@5': '0.0842', 'NDCG@5': '0.0593', 'HR@10': '0.1171', 'NDCG@10': '0.0699', 'HR@20': '0.1593', 'NDCG@20': '0.0806'}
2025-02-26 14:15:37,351 - EarlyStopping counter: 2 out of 10
2025-02-26 14:16:13,010 - {'epoch': 16, 'rec_loss': '6.9029'}
2025-02-26 14:16:21,518 - {'Epoch': 16, 'HR@5': '0.0856', 'NDCG@5': '0.0599', 'HR@10': '0.1175', 'NDCG@10': '0.0702', 'HR@20': '0.1600', 'NDCG@20': '0.0809'}
2025-02-26 14:16:21,520 - EarlyStopping counter: 3 out of 10
2025-02-26 14:16:57,288 - {'epoch': 17, 'rec_loss': '6.8879'}
2025-02-26 14:17:06,497 - {'Epoch': 17, 'HR@5': '0.0872', 'NDCG@5': '0.0614', 'HR@10': '0.1181', 'NDCG@10': '0.0714', 'HR@20': '0.1606', 'NDCG@20': '0.0821'}
2025-02-26 14:17:06,498 - Validation score increased.  Saving model ...
2025-02-26 14:17:42,206 - {'epoch': 18, 'rec_loss': '6.8659'}
2025-02-26 14:17:51,029 - {'Epoch': 18, 'HR@5': '0.0876', 'NDCG@5': '0.0613', 'HR@10': '0.1190', 'NDCG@10': '0.0714', 'HR@20': '0.1621', 'NDCG@20': '0.0822'}
2025-02-26 14:17:51,030 - Validation score increased.  Saving model ...
2025-02-26 14:18:26,696 - {'epoch': 19, 'rec_loss': '6.8493'}
2025-02-26 14:18:35,743 - {'Epoch': 19, 'HR@5': '0.0866', 'NDCG@5': '0.0611', 'HR@10': '0.1178', 'NDCG@10': '0.0712', 'HR@20': '0.1614', 'NDCG@20': '0.0822'}
2025-02-26 14:18:35,745 - EarlyStopping counter: 1 out of 10
2025-02-26 14:19:11,347 - {'epoch': 20, 'rec_loss': '6.8383'}
2025-02-26 14:19:20,963 - {'Epoch': 20, 'HR@5': '0.0858', 'NDCG@5': '0.0606', 'HR@10': '0.1188', 'NDCG@10': '0.0712', 'HR@20': '0.1619', 'NDCG@20': '0.0821'}
2025-02-26 14:19:20,965 - EarlyStopping counter: 2 out of 10
2025-02-26 14:19:56,473 - {'epoch': 21, 'rec_loss': '6.8218'}
2025-02-26 14:20:05,657 - {'Epoch': 21, 'HR@5': '0.0867', 'NDCG@5': '0.0607', 'HR@10': '0.1187', 'NDCG@10': '0.0710', 'HR@20': '0.1612', 'NDCG@20': '0.0817'}
2025-02-26 14:20:05,659 - EarlyStopping counter: 3 out of 10
2025-02-26 14:20:41,609 - {'epoch': 22, 'rec_loss': '6.8071'}
2025-02-26 14:20:50,337 - {'Epoch': 22, 'HR@5': '0.0862', 'NDCG@5': '0.0616', 'HR@10': '0.1185', 'NDCG@10': '0.0719', 'HR@20': '0.1621', 'NDCG@20': '0.0829'}
2025-02-26 14:20:50,339 - Validation score increased.  Saving model ...
2025-02-26 14:21:26,326 - {'epoch': 23, 'rec_loss': '6.7939'}
2025-02-26 14:21:35,808 - {'Epoch': 23, 'HR@5': '0.0847', 'NDCG@5': '0.0600', 'HR@10': '0.1199', 'NDCG@10': '0.0713', 'HR@20': '0.1615', 'NDCG@20': '0.0818'}
2025-02-26 14:21:35,809 - EarlyStopping counter: 1 out of 10
2025-02-26 14:22:11,449 - {'epoch': 24, 'rec_loss': '6.7866'}
2025-02-26 14:22:21,060 - {'Epoch': 24, 'HR@5': '0.0870', 'NDCG@5': '0.0616', 'HR@10': '0.1184', 'NDCG@10': '0.0718', 'HR@20': '0.1620', 'NDCG@20': '0.0828'}
2025-02-26 14:22:21,061 - EarlyStopping counter: 2 out of 10
2025-02-26 14:22:56,622 - {'epoch': 25, 'rec_loss': '6.7721'}
2025-02-26 14:23:05,328 - {'Epoch': 25, 'HR@5': '0.0860', 'NDCG@5': '0.0605', 'HR@10': '0.1217', 'NDCG@10': '0.0720', 'HR@20': '0.1637', 'NDCG@20': '0.0826'}
2025-02-26 14:23:05,330 - EarlyStopping counter: 3 out of 10
2025-02-26 14:23:42,122 - {'epoch': 26, 'rec_loss': '6.7601'}
2025-02-26 14:23:51,851 - {'Epoch': 26, 'HR@5': '0.0875', 'NDCG@5': '0.0617', 'HR@10': '0.1201', 'NDCG@10': '0.0722', 'HR@20': '0.1617', 'NDCG@20': '0.0827'}
2025-02-26 14:23:51,852 - EarlyStopping counter: 4 out of 10
2025-02-26 14:24:27,713 - {'epoch': 27, 'rec_loss': '6.7471'}
2025-02-26 14:24:37,383 - {'Epoch': 27, 'HR@5': '0.0855', 'NDCG@5': '0.0603', 'HR@10': '0.1190', 'NDCG@10': '0.0711', 'HR@20': '0.1622', 'NDCG@20': '0.0820'}
2025-02-26 14:24:37,384 - EarlyStopping counter: 5 out of 10
2025-02-26 14:25:13,127 - {'epoch': 28, 'rec_loss': '6.7369'}
2025-02-26 14:25:22,701 - {'Epoch': 28, 'HR@5': '0.0878', 'NDCG@5': '0.0620', 'HR@10': '0.1180', 'NDCG@10': '0.0716', 'HR@20': '0.1614', 'NDCG@20': '0.0826'}
2025-02-26 14:25:22,702 - EarlyStopping counter: 6 out of 10
2025-02-26 14:25:58,605 - {'epoch': 29, 'rec_loss': '6.7230'}
2025-02-26 14:26:07,258 - {'Epoch': 29, 'HR@5': '0.0866', 'NDCG@5': '0.0616', 'HR@10': '0.1191', 'NDCG@10': '0.0720', 'HR@20': '0.1631', 'NDCG@20': '0.0831'}
2025-02-26 14:26:07,267 - Validation score increased.  Saving model ...
2025-02-26 14:26:43,287 - {'epoch': 30, 'rec_loss': '6.7192'}
2025-02-26 14:26:52,693 - {'Epoch': 30, 'HR@5': '0.0875', 'NDCG@5': '0.0620', 'HR@10': '0.1201', 'NDCG@10': '0.0725', 'HR@20': '0.1634', 'NDCG@20': '0.0834'}
2025-02-26 14:26:52,695 - Validation score increased.  Saving model ...
2025-02-26 14:27:28,684 - {'epoch': 31, 'rec_loss': '6.7097'}
2025-02-26 14:27:37,459 - {'Epoch': 31, 'HR@5': '0.0877', 'NDCG@5': '0.0621', 'HR@10': '0.1209', 'NDCG@10': '0.0728', 'HR@20': '0.1628', 'NDCG@20': '0.0833'}
2025-02-26 14:27:37,460 - EarlyStopping counter: 1 out of 10
2025-02-26 14:28:13,278 - {'epoch': 32, 'rec_loss': '6.7018'}
2025-02-26 14:28:21,978 - {'Epoch': 32, 'HR@5': '0.0865', 'NDCG@5': '0.0609', 'HR@10': '0.1214', 'NDCG@10': '0.0721', 'HR@20': '0.1644', 'NDCG@20': '0.0830'}
2025-02-26 14:28:21,979 - EarlyStopping counter: 2 out of 10
2025-02-26 14:28:57,470 - {'epoch': 33, 'rec_loss': '6.6890'}
2025-02-26 14:29:07,374 - {'Epoch': 33, 'HR@5': '0.0859', 'NDCG@5': '0.0604', 'HR@10': '0.1205', 'NDCG@10': '0.0715', 'HR@20': '0.1638', 'NDCG@20': '0.0825'}
2025-02-26 14:29:07,376 - EarlyStopping counter: 3 out of 10
2025-02-26 14:29:43,151 - {'epoch': 34, 'rec_loss': '6.6824'}
2025-02-26 14:29:52,902 - {'Epoch': 34, 'HR@5': '0.0879', 'NDCG@5': '0.0622', 'HR@10': '0.1211', 'NDCG@10': '0.0729', 'HR@20': '0.1640', 'NDCG@20': '0.0838'}
2025-02-26 14:29:52,905 - Validation score increased.  Saving model ...
2025-02-26 14:30:28,192 - {'epoch': 35, 'rec_loss': '6.6769'}
2025-02-26 14:30:36,813 - {'Epoch': 35, 'HR@5': '0.0858', 'NDCG@5': '0.0601', 'HR@10': '0.1198', 'NDCG@10': '0.0711', 'HR@20': '0.1626', 'NDCG@20': '0.0818'}
2025-02-26 14:30:36,815 - EarlyStopping counter: 1 out of 10
2025-02-26 14:31:12,265 - {'epoch': 36, 'rec_loss': '6.6674'}
2025-02-26 14:31:21,506 - {'Epoch': 36, 'HR@5': '0.0851', 'NDCG@5': '0.0599', 'HR@10': '0.1181', 'NDCG@10': '0.0705', 'HR@20': '0.1608', 'NDCG@20': '0.0813'}
2025-02-26 14:31:21,508 - EarlyStopping counter: 2 out of 10
2025-02-26 14:31:57,295 - {'epoch': 37, 'rec_loss': '6.6636'}
2025-02-26 14:32:06,693 - {'Epoch': 37, 'HR@5': '0.0873', 'NDCG@5': '0.0615', 'HR@10': '0.1202', 'NDCG@10': '0.0721', 'HR@20': '0.1628', 'NDCG@20': '0.0828'}
2025-02-26 14:32:06,695 - EarlyStopping counter: 3 out of 10
2025-02-26 14:32:42,080 - {'epoch': 38, 'rec_loss': '6.6536'}
2025-02-26 14:32:51,916 - {'Epoch': 38, 'HR@5': '0.0869', 'NDCG@5': '0.0616', 'HR@10': '0.1198', 'NDCG@10': '0.0722', 'HR@20': '0.1630', 'NDCG@20': '0.0831'}
2025-02-26 14:32:51,918 - EarlyStopping counter: 4 out of 10
2025-02-26 14:33:27,547 - {'epoch': 39, 'rec_loss': '6.6474'}
2025-02-26 14:33:37,369 - {'Epoch': 39, 'HR@5': '0.0873', 'NDCG@5': '0.0616', 'HR@10': '0.1210', 'NDCG@10': '0.0725', 'HR@20': '0.1628', 'NDCG@20': '0.0830'}
2025-02-26 14:33:37,370 - EarlyStopping counter: 5 out of 10
2025-02-26 14:34:12,661 - {'epoch': 40, 'rec_loss': '6.6418'}
2025-02-26 14:34:21,939 - {'Epoch': 40, 'HR@5': '0.0855', 'NDCG@5': '0.0604', 'HR@10': '0.1195', 'NDCG@10': '0.0714', 'HR@20': '0.1609', 'NDCG@20': '0.0818'}
2025-02-26 14:34:21,940 - EarlyStopping counter: 6 out of 10
2025-02-26 14:34:58,328 - {'epoch': 41, 'rec_loss': '6.6328'}
2025-02-26 14:35:07,548 - {'Epoch': 41, 'HR@5': '0.0860', 'NDCG@5': '0.0609', 'HR@10': '0.1200', 'NDCG@10': '0.0718', 'HR@20': '0.1611', 'NDCG@20': '0.0822'}
2025-02-26 14:35:07,549 - EarlyStopping counter: 7 out of 10
2025-02-26 14:35:42,802 - {'epoch': 42, 'rec_loss': '6.6329'}
2025-02-26 14:35:51,852 - {'Epoch': 42, 'HR@5': '0.0872', 'NDCG@5': '0.0616', 'HR@10': '0.1199', 'NDCG@10': '0.0722', 'HR@20': '0.1615', 'NDCG@20': '0.0827'}
2025-02-26 14:35:51,854 - EarlyStopping counter: 8 out of 10
2025-02-26 14:36:28,324 - {'epoch': 43, 'rec_loss': '6.6280'}
2025-02-26 14:36:38,035 - {'Epoch': 43, 'HR@5': '0.0862', 'NDCG@5': '0.0614', 'HR@10': '0.1209', 'NDCG@10': '0.0725', 'HR@20': '0.1626', 'NDCG@20': '0.0830'}
2025-02-26 14:36:38,037 - EarlyStopping counter: 9 out of 10
2025-02-26 14:37:14,461 - {'epoch': 44, 'rec_loss': '6.6200'}
2025-02-26 14:37:23,381 - {'Epoch': 44, 'HR@5': '0.0871', 'NDCG@5': '0.0617', 'HR@10': '0.1214', 'NDCG@10': '0.0727', 'HR@20': '0.1634', 'NDCG@20': '0.0833'}
2025-02-26 14:37:23,383 - EarlyStopping counter: 10 out of 10
2025-02-26 14:37:23,383 - Early stopping
2025-02-26 14:37:23,383 - ---------------Test Score---------------
2025-02-26 14:37:31,934 - {'Epoch': 0, 'HR@5': '0.0704', 'NDCG@5': '0.0499', 'HR@10': '0.1008', 'NDCG@10': '0.0597', 'HR@20': '0.1375', 'NDCG@20': '0.0689'}
2025-02-26 14:37:31,936 - Scale_Beauty
2025-02-26 14:37:31,936 - {'Epoch': 0, 'HR@5': '0.0704', 'NDCG@5': '0.0499', 'HR@10': '0.1008', 'NDCG@10': '0.0597', 'HR@20': '0.1375', 'NDCG@20': '0.0689'}
2025-02-26 15:12:27,593 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25, 5], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-26 15:12:30,762 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-26 15:12:30,774 - Total Parameters: 928145
2025-02-26 15:13:09,415 - {'epoch': 0, 'rec_loss': '8.8004'}
2025-02-26 15:13:19,454 - {'Epoch': 0, 'HR@5': '0.0234', 'NDCG@5': '0.0151', 'HR@10': '0.0366', 'NDCG@10': '0.0193', 'HR@20': '0.0574', 'NDCG@20': '0.0245'}
2025-02-26 15:13:19,456 - Validation score increased.  Saving model ...
2025-02-26 15:13:56,639 - {'epoch': 1, 'rec_loss': '8.2165'}
2025-02-26 15:14:06,532 - {'Epoch': 1, 'HR@5': '0.0438', 'NDCG@5': '0.0296', 'HR@10': '0.0646', 'NDCG@10': '0.0364', 'HR@20': '0.0939', 'NDCG@20': '0.0437'}
2025-02-26 15:14:06,535 - Validation score increased.  Saving model ...
2025-02-26 15:14:44,022 - {'epoch': 2, 'rec_loss': '7.8977'}
2025-02-26 15:14:53,583 - {'Epoch': 2, 'HR@5': '0.0578', 'NDCG@5': '0.0395', 'HR@10': '0.0829', 'NDCG@10': '0.0476', 'HR@20': '0.1160', 'NDCG@20': '0.0559'}
2025-02-26 15:14:53,584 - Validation score increased.  Saving model ...
2025-02-26 15:15:30,673 - {'epoch': 3, 'rec_loss': '7.6809'}
2025-02-26 15:15:40,076 - {'Epoch': 3, 'HR@5': '0.0661', 'NDCG@5': '0.0456', 'HR@10': '0.0936', 'NDCG@10': '0.0545', 'HR@20': '0.1301', 'NDCG@20': '0.0636'}
2025-02-26 15:15:40,078 - Validation score increased.  Saving model ...
2025-02-26 15:16:17,045 - {'epoch': 4, 'rec_loss': '7.5176'}
2025-02-26 15:16:26,503 - {'Epoch': 4, 'HR@5': '0.0721', 'NDCG@5': '0.0500', 'HR@10': '0.1007', 'NDCG@10': '0.0592', 'HR@20': '0.1397', 'NDCG@20': '0.0690'}
2025-02-26 15:16:26,505 - Validation score increased.  Saving model ...
2025-02-26 15:17:03,929 - {'epoch': 5, 'rec_loss': '7.3991'}
2025-02-26 15:17:13,605 - {'Epoch': 5, 'HR@5': '0.0762', 'NDCG@5': '0.0536', 'HR@10': '0.1056', 'NDCG@10': '0.0630', 'HR@20': '0.1459', 'NDCG@20': '0.0732'}
2025-02-26 15:17:13,607 - Validation score increased.  Saving model ...
2025-02-26 15:17:50,980 - {'epoch': 6, 'rec_loss': '7.2999'}
2025-02-26 15:18:00,830 - {'Epoch': 6, 'HR@5': '0.0787', 'NDCG@5': '0.0554', 'HR@10': '0.1105', 'NDCG@10': '0.0657', 'HR@20': '0.1499', 'NDCG@20': '0.0756'}
2025-02-26 15:18:00,832 - Validation score increased.  Saving model ...
2025-02-26 15:18:37,559 - {'epoch': 7, 'rec_loss': '7.2206'}
2025-02-26 15:18:47,198 - {'Epoch': 7, 'HR@5': '0.0823', 'NDCG@5': '0.0574', 'HR@10': '0.1130', 'NDCG@10': '0.0672', 'HR@20': '0.1531', 'NDCG@20': '0.0773'}
2025-02-26 15:18:47,200 - Validation score increased.  Saving model ...
2025-02-26 15:19:24,465 - {'epoch': 8, 'rec_loss': '7.1634'}
2025-02-26 15:19:34,064 - {'Epoch': 8, 'HR@5': '0.0813', 'NDCG@5': '0.0570', 'HR@10': '0.1126', 'NDCG@10': '0.0671', 'HR@20': '0.1538', 'NDCG@20': '0.0775'}
2025-02-26 15:19:34,065 - Validation score increased.  Saving model ...
2025-02-26 15:20:10,807 - {'epoch': 9, 'rec_loss': '7.1152'}
2025-02-26 15:20:20,719 - {'Epoch': 9, 'HR@5': '0.0836', 'NDCG@5': '0.0590', 'HR@10': '0.1160', 'NDCG@10': '0.0695', 'HR@20': '0.1574', 'NDCG@20': '0.0799'}
2025-02-26 15:20:20,721 - Validation score increased.  Saving model ...
2025-02-26 15:20:56,878 - {'epoch': 10, 'rec_loss': '7.0706'}
2025-02-26 15:21:06,282 - {'Epoch': 10, 'HR@5': '0.0839', 'NDCG@5': '0.0585', 'HR@10': '0.1148', 'NDCG@10': '0.0684', 'HR@20': '0.1584', 'NDCG@20': '0.0794'}
2025-02-26 15:21:06,290 - EarlyStopping counter: 1 out of 10
2025-02-26 15:21:43,739 - {'epoch': 11, 'rec_loss': '7.0332'}
2025-02-26 15:21:53,555 - {'Epoch': 11, 'HR@5': '0.0850', 'NDCG@5': '0.0603', 'HR@10': '0.1161', 'NDCG@10': '0.0703', 'HR@20': '0.1576', 'NDCG@20': '0.0808'}
2025-02-26 15:21:53,557 - Validation score increased.  Saving model ...
2025-02-26 15:22:30,246 - {'epoch': 12, 'rec_loss': '6.9994'}
2025-02-26 15:22:39,978 - {'Epoch': 12, 'HR@5': '0.0828', 'NDCG@5': '0.0584', 'HR@10': '0.1156', 'NDCG@10': '0.0691', 'HR@20': '0.1566', 'NDCG@20': '0.0794'}
2025-02-26 15:22:39,979 - EarlyStopping counter: 1 out of 10
2025-02-26 15:23:16,960 - {'epoch': 13, 'rec_loss': '6.9721'}
2025-02-26 15:23:26,401 - {'Epoch': 13, 'HR@5': '0.0835', 'NDCG@5': '0.0601', 'HR@10': '0.1167', 'NDCG@10': '0.0708', 'HR@20': '0.1595', 'NDCG@20': '0.0816'}
2025-02-26 15:23:26,404 - Validation score increased.  Saving model ...
2025-02-26 15:24:03,528 - {'epoch': 14, 'rec_loss': '6.9484'}
2025-02-26 15:24:12,888 - {'Epoch': 14, 'HR@5': '0.0853', 'NDCG@5': '0.0601', 'HR@10': '0.1173', 'NDCG@10': '0.0704', 'HR@20': '0.1583', 'NDCG@20': '0.0808'}
2025-02-26 15:24:12,890 - EarlyStopping counter: 1 out of 10
2025-02-26 15:24:49,716 - {'epoch': 15, 'rec_loss': '6.9236'}
2025-02-26 15:24:59,246 - {'Epoch': 15, 'HR@5': '0.0850', 'NDCG@5': '0.0598', 'HR@10': '0.1197', 'NDCG@10': '0.0710', 'HR@20': '0.1609', 'NDCG@20': '0.0814'}
2025-02-26 15:24:59,247 - EarlyStopping counter: 2 out of 10
2025-02-26 15:25:36,465 - {'epoch': 16, 'rec_loss': '6.9008'}
2025-02-26 15:25:46,251 - {'Epoch': 16, 'HR@5': '0.0834', 'NDCG@5': '0.0591', 'HR@10': '0.1166', 'NDCG@10': '0.0698', 'HR@20': '0.1591', 'NDCG@20': '0.0805'}
2025-02-26 15:25:46,253 - EarlyStopping counter: 3 out of 10
2025-02-26 15:26:23,035 - {'epoch': 17, 'rec_loss': '6.8886'}
2025-02-26 15:26:31,495 - {'Epoch': 17, 'HR@5': '0.0853', 'NDCG@5': '0.0599', 'HR@10': '0.1202', 'NDCG@10': '0.0711', 'HR@20': '0.1619', 'NDCG@20': '0.0816'}
2025-02-26 15:26:31,497 - Validation score increased.  Saving model ...
2025-02-26 15:27:05,849 - {'epoch': 18, 'rec_loss': '6.8642'}
2025-02-26 15:27:14,094 - {'Epoch': 18, 'HR@5': '0.0857', 'NDCG@5': '0.0605', 'HR@10': '0.1183', 'NDCG@10': '0.0710', 'HR@20': '0.1597', 'NDCG@20': '0.0814'}
2025-02-26 15:27:14,096 - EarlyStopping counter: 1 out of 10
2025-02-26 15:27:48,291 - {'epoch': 19, 'rec_loss': '6.8445'}
2025-02-26 15:27:57,025 - {'Epoch': 19, 'HR@5': '0.0869', 'NDCG@5': '0.0609', 'HR@10': '0.1178', 'NDCG@10': '0.0709', 'HR@20': '0.1588', 'NDCG@20': '0.0812'}
2025-02-26 15:27:57,026 - EarlyStopping counter: 2 out of 10
2025-02-26 15:28:34,233 - {'epoch': 20, 'rec_loss': '6.8393'}
2025-02-26 15:28:43,111 - {'Epoch': 20, 'HR@5': '0.0866', 'NDCG@5': '0.0611', 'HR@10': '0.1188', 'NDCG@10': '0.0714', 'HR@20': '0.1618', 'NDCG@20': '0.0822'}
2025-02-26 15:28:43,113 - Validation score increased.  Saving model ...
2025-02-26 15:29:19,379 - {'epoch': 21, 'rec_loss': '6.8233'}
2025-02-26 15:29:28,400 - {'Epoch': 21, 'HR@5': '0.0856', 'NDCG@5': '0.0600', 'HR@10': '0.1205', 'NDCG@10': '0.0712', 'HR@20': '0.1611', 'NDCG@20': '0.0814'}
2025-02-26 15:29:28,401 - EarlyStopping counter: 1 out of 10
2025-02-26 15:30:07,104 - {'epoch': 22, 'rec_loss': '6.8096'}
2025-02-26 15:30:15,409 - {'Epoch': 22, 'HR@5': '0.0860', 'NDCG@5': '0.0609', 'HR@10': '0.1194', 'NDCG@10': '0.0717', 'HR@20': '0.1619', 'NDCG@20': '0.0823'}
2025-02-26 15:30:15,411 - Validation score increased.  Saving model ...
2025-02-26 15:30:51,825 - {'epoch': 23, 'rec_loss': '6.7971'}
2025-02-26 15:31:00,491 - {'Epoch': 23, 'HR@5': '0.0855', 'NDCG@5': '0.0601', 'HR@10': '0.1181', 'NDCG@10': '0.0705', 'HR@20': '0.1613', 'NDCG@20': '0.0814'}
2025-02-26 15:31:00,492 - EarlyStopping counter: 1 out of 10
2025-02-26 15:31:34,453 - {'epoch': 24, 'rec_loss': '6.7839'}
2025-02-26 15:31:42,943 - {'Epoch': 24, 'HR@5': '0.0867', 'NDCG@5': '0.0606', 'HR@10': '0.1197', 'NDCG@10': '0.0713', 'HR@20': '0.1637', 'NDCG@20': '0.0824'}
2025-02-26 15:31:42,944 - Validation score increased.  Saving model ...
2025-02-26 15:32:16,475 - {'epoch': 25, 'rec_loss': '6.7768'}
2025-02-26 15:32:24,914 - {'Epoch': 25, 'HR@5': '0.0866', 'NDCG@5': '0.0603', 'HR@10': '0.1189', 'NDCG@10': '0.0707', 'HR@20': '0.1622', 'NDCG@20': '0.0816'}
2025-02-26 15:32:24,916 - EarlyStopping counter: 1 out of 10
2025-02-26 15:33:00,558 - {'epoch': 26, 'rec_loss': '6.7656'}
2025-02-26 15:33:09,079 - {'Epoch': 26, 'HR@5': '0.0861', 'NDCG@5': '0.0612', 'HR@10': '0.1190', 'NDCG@10': '0.0718', 'HR@20': '0.1635', 'NDCG@20': '0.0830'}
2025-02-26 15:33:09,086 - Validation score increased.  Saving model ...
2025-02-26 15:33:45,844 - {'epoch': 27, 'rec_loss': '6.7516'}
2025-02-26 15:33:54,145 - {'Epoch': 27, 'HR@5': '0.0862', 'NDCG@5': '0.0607', 'HR@10': '0.1185', 'NDCG@10': '0.0710', 'HR@20': '0.1615', 'NDCG@20': '0.0819'}
2025-02-26 15:33:54,146 - EarlyStopping counter: 1 out of 10
2025-02-26 15:34:30,811 - {'epoch': 28, 'rec_loss': '6.7461'}
2025-02-26 15:34:39,071 - {'Epoch': 28, 'HR@5': '0.0872', 'NDCG@5': '0.0614', 'HR@10': '0.1182', 'NDCG@10': '0.0714', 'HR@20': '0.1600', 'NDCG@20': '0.0820'}
2025-02-26 15:34:39,073 - EarlyStopping counter: 2 out of 10
2025-02-26 15:35:14,145 - {'epoch': 29, 'rec_loss': '6.7279'}
2025-02-26 15:35:22,577 - {'Epoch': 29, 'HR@5': '0.0868', 'NDCG@5': '0.0610', 'HR@10': '0.1211', 'NDCG@10': '0.0722', 'HR@20': '0.1645', 'NDCG@20': '0.0831'}
2025-02-26 15:35:22,585 - Validation score increased.  Saving model ...
2025-02-26 15:35:59,512 - {'epoch': 30, 'rec_loss': '6.7284'}
2025-02-26 15:36:07,839 - {'Epoch': 30, 'HR@5': '0.0863', 'NDCG@5': '0.0608', 'HR@10': '0.1184', 'NDCG@10': '0.0712', 'HR@20': '0.1618', 'NDCG@20': '0.0821'}
2025-02-26 15:36:07,840 - EarlyStopping counter: 1 out of 10
2025-02-26 15:36:44,850 - {'epoch': 31, 'rec_loss': '6.7139'}
2025-02-26 15:36:53,334 - {'Epoch': 31, 'HR@5': '0.0860', 'NDCG@5': '0.0603', 'HR@10': '0.1208', 'NDCG@10': '0.0716', 'HR@20': '0.1634', 'NDCG@20': '0.0823'}
2025-02-26 15:36:53,342 - EarlyStopping counter: 2 out of 10
2025-02-26 15:37:29,517 - {'epoch': 32, 'rec_loss': '6.7089'}
2025-02-26 15:37:38,143 - {'Epoch': 32, 'HR@5': '0.0851', 'NDCG@5': '0.0597', 'HR@10': '0.1186', 'NDCG@10': '0.0705', 'HR@20': '0.1624', 'NDCG@20': '0.0815'}
2025-02-26 15:37:38,144 - EarlyStopping counter: 3 out of 10
2025-02-26 15:38:15,427 - {'epoch': 33, 'rec_loss': '6.6998'}
2025-02-26 15:38:23,603 - {'Epoch': 33, 'HR@5': '0.0860', 'NDCG@5': '0.0603', 'HR@10': '0.1193', 'NDCG@10': '0.0710', 'HR@20': '0.1612', 'NDCG@20': '0.0815'}
2025-02-26 15:38:23,604 - EarlyStopping counter: 4 out of 10
2025-02-26 15:38:58,396 - {'epoch': 34, 'rec_loss': '6.6893'}
2025-02-26 15:39:06,807 - {'Epoch': 34, 'HR@5': '0.0870', 'NDCG@5': '0.0610', 'HR@10': '0.1203', 'NDCG@10': '0.0717', 'HR@20': '0.1637', 'NDCG@20': '0.0826'}
2025-02-26 15:39:06,809 - EarlyStopping counter: 5 out of 10
2025-02-26 15:39:42,916 - {'epoch': 35, 'rec_loss': '6.6838'}
2025-02-26 15:39:51,179 - {'Epoch': 35, 'HR@5': '0.0865', 'NDCG@5': '0.0609', 'HR@10': '0.1191', 'NDCG@10': '0.0714', 'HR@20': '0.1609', 'NDCG@20': '0.0819'}
2025-02-26 15:39:51,180 - EarlyStopping counter: 6 out of 10
2025-02-26 15:40:27,415 - {'epoch': 36, 'rec_loss': '6.6763'}
2025-02-26 15:40:35,807 - {'Epoch': 36, 'HR@5': '0.0871', 'NDCG@5': '0.0607', 'HR@10': '0.1206', 'NDCG@10': '0.0715', 'HR@20': '0.1628', 'NDCG@20': '0.0821'}
2025-02-26 15:40:35,813 - EarlyStopping counter: 7 out of 10
2025-02-26 15:41:12,886 - {'epoch': 37, 'rec_loss': '6.6709'}
2025-02-26 15:41:21,243 - {'Epoch': 37, 'HR@5': '0.0864', 'NDCG@5': '0.0610', 'HR@10': '0.1186', 'NDCG@10': '0.0713', 'HR@20': '0.1624', 'NDCG@20': '0.0824'}
2025-02-26 15:41:21,245 - EarlyStopping counter: 8 out of 10
2025-02-26 15:41:58,568 - {'epoch': 38, 'rec_loss': '6.6602'}
2025-02-26 15:42:06,853 - {'Epoch': 38, 'HR@5': '0.0852', 'NDCG@5': '0.0601', 'HR@10': '0.1194', 'NDCG@10': '0.0711', 'HR@20': '0.1631', 'NDCG@20': '0.0821'}
2025-02-26 15:42:06,854 - EarlyStopping counter: 9 out of 10
2025-02-26 15:42:42,461 - {'epoch': 39, 'rec_loss': '6.6562'}
2025-02-26 15:42:50,705 - {'Epoch': 39, 'HR@5': '0.0883', 'NDCG@5': '0.0615', 'HR@10': '0.1203', 'NDCG@10': '0.0718', 'HR@20': '0.1625', 'NDCG@20': '0.0824'}
2025-02-26 15:42:50,706 - EarlyStopping counter: 10 out of 10
2025-02-26 15:42:50,707 - Early stopping
2025-02-26 15:42:50,707 - ---------------Test Score---------------
2025-02-26 15:42:59,084 - {'Epoch': 0, 'HR@5': '0.0700', 'NDCG@5': '0.0495', 'HR@10': '0.0996', 'NDCG@10': '0.0591', 'HR@20': '0.1345', 'NDCG@20': '0.0678'}
2025-02-26 15:42:59,085 - Scale_Beauty
2025-02-26 15:42:59,085 - {'Epoch': 0, 'HR@5': '0.0700', 'NDCG@5': '0.0495', 'HR@10': '0.0996', 'NDCG@10': '0.0591', 'HR@20': '0.1345', 'NDCG@20': '0.0678'}
2025-02-26 15:46:38,837 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-26 15:46:41,708 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-26 15:46:41,714 - Total Parameters: 928470
2025-02-26 15:47:10,992 - {'epoch': 0, 'rec_loss': '8.8291'}
2025-02-26 15:47:19,863 - {'Epoch': 0, 'HR@5': '0.0210', 'NDCG@5': '0.0131', 'HR@10': '0.0318', 'NDCG@10': '0.0166', 'HR@20': '0.0477', 'NDCG@20': '0.0206'}
2025-02-26 15:47:19,865 - Validation score increased.  Saving model ...
2025-02-26 15:47:47,041 - {'epoch': 1, 'rec_loss': '8.2978'}
2025-02-26 15:47:55,350 - {'Epoch': 1, 'HR@5': '0.0366', 'NDCG@5': '0.0245', 'HR@10': '0.0568', 'NDCG@10': '0.0310', 'HR@20': '0.0849', 'NDCG@20': '0.0380'}
2025-02-26 15:47:55,351 - Validation score increased.  Saving model ...
2025-02-26 15:48:25,846 - {'epoch': 2, 'rec_loss': '7.9878'}
2025-02-26 15:48:34,279 - {'Epoch': 2, 'HR@5': '0.0524', 'NDCG@5': '0.0344', 'HR@10': '0.0772', 'NDCG@10': '0.0424', 'HR@20': '0.1109', 'NDCG@20': '0.0508'}
2025-02-26 15:48:34,280 - Validation score increased.  Saving model ...
2025-02-26 15:49:02,261 - {'epoch': 3, 'rec_loss': '7.7755'}
2025-02-26 15:49:10,259 - {'Epoch': 3, 'HR@5': '0.0618', 'NDCG@5': '0.0424', 'HR@10': '0.0891', 'NDCG@10': '0.0512', 'HR@20': '0.1259', 'NDCG@20': '0.0604'}
2025-02-26 15:49:10,267 - Validation score increased.  Saving model ...
2025-02-26 15:49:39,250 - {'epoch': 4, 'rec_loss': '7.6265'}
2025-02-26 15:49:47,295 - {'Epoch': 4, 'HR@5': '0.0682', 'NDCG@5': '0.0471', 'HR@10': '0.0979', 'NDCG@10': '0.0567', 'HR@20': '0.1348', 'NDCG@20': '0.0659'}
2025-02-26 15:49:47,297 - Validation score increased.  Saving model ...
2025-02-26 15:50:14,727 - {'epoch': 5, 'rec_loss': '7.5088'}
2025-02-26 15:50:22,827 - {'Epoch': 5, 'HR@5': '0.0725', 'NDCG@5': '0.0514', 'HR@10': '0.1023', 'NDCG@10': '0.0610', 'HR@20': '0.1408', 'NDCG@20': '0.0707'}
2025-02-26 15:50:22,832 - Validation score increased.  Saving model ...
2025-02-26 15:50:50,453 - {'epoch': 6, 'rec_loss': '7.4078'}
2025-02-26 15:50:58,783 - {'Epoch': 6, 'HR@5': '0.0768', 'NDCG@5': '0.0540', 'HR@10': '0.1054', 'NDCG@10': '0.0632', 'HR@20': '0.1457', 'NDCG@20': '0.0734'}
2025-02-26 15:50:58,787 - Validation score increased.  Saving model ...
2025-02-26 15:51:27,775 - {'epoch': 7, 'rec_loss': '7.3362'}
2025-02-26 15:51:36,000 - {'Epoch': 7, 'HR@5': '0.0775', 'NDCG@5': '0.0541', 'HR@10': '0.1077', 'NDCG@10': '0.0638', 'HR@20': '0.1473', 'NDCG@20': '0.0738'}
2025-02-26 15:51:36,001 - Validation score increased.  Saving model ...
2025-02-26 15:52:03,418 - {'epoch': 8, 'rec_loss': '7.2698'}
2025-02-26 15:52:11,608 - {'Epoch': 8, 'HR@5': '0.0804', 'NDCG@5': '0.0571', 'HR@10': '0.1111', 'NDCG@10': '0.0669', 'HR@20': '0.1514', 'NDCG@20': '0.0770'}
2025-02-26 15:52:11,612 - Validation score increased.  Saving model ...
2025-02-26 15:52:39,235 - {'epoch': 9, 'rec_loss': '7.2212'}
2025-02-26 15:52:47,245 - {'Epoch': 9, 'HR@5': '0.0809', 'NDCG@5': '0.0572', 'HR@10': '0.1123', 'NDCG@10': '0.0674', 'HR@20': '0.1535', 'NDCG@20': '0.0778'}
2025-02-26 15:52:47,250 - Validation score increased.  Saving model ...
2025-02-26 15:53:14,956 - {'epoch': 10, 'rec_loss': '7.1756'}
2025-02-26 15:53:22,952 - {'Epoch': 10, 'HR@5': '0.0812', 'NDCG@5': '0.0574', 'HR@10': '0.1147', 'NDCG@10': '0.0682', 'HR@20': '0.1540', 'NDCG@20': '0.0781'}
2025-02-26 15:53:22,953 - Validation score increased.  Saving model ...
2025-02-26 15:53:51,073 - {'epoch': 11, 'rec_loss': '7.1409'}
2025-02-26 15:53:59,196 - {'Epoch': 11, 'HR@5': '0.0831', 'NDCG@5': '0.0584', 'HR@10': '0.1158', 'NDCG@10': '0.0689', 'HR@20': '0.1564', 'NDCG@20': '0.0791'}
2025-02-26 15:53:59,204 - Validation score increased.  Saving model ...
2025-02-26 15:54:27,126 - {'epoch': 12, 'rec_loss': '7.1064'}
2025-02-26 15:54:35,021 - {'Epoch': 12, 'HR@5': '0.0832', 'NDCG@5': '0.0592', 'HR@10': '0.1170', 'NDCG@10': '0.0701', 'HR@20': '0.1580', 'NDCG@20': '0.0804'}
2025-02-26 15:54:35,022 - Validation score increased.  Saving model ...
2025-02-26 15:55:03,781 - {'epoch': 13, 'rec_loss': '7.0723'}
2025-02-26 15:55:11,791 - {'Epoch': 13, 'HR@5': '0.0855', 'NDCG@5': '0.0604', 'HR@10': '0.1160', 'NDCG@10': '0.0702', 'HR@20': '0.1581', 'NDCG@20': '0.0808'}
2025-02-26 15:55:11,796 - Validation score increased.  Saving model ...
2025-02-26 15:55:39,302 - {'epoch': 14, 'rec_loss': '7.0466'}
2025-02-26 15:55:47,499 - {'Epoch': 14, 'HR@5': '0.0839', 'NDCG@5': '0.0600', 'HR@10': '0.1168', 'NDCG@10': '0.0706', 'HR@20': '0.1595', 'NDCG@20': '0.0814'}
2025-02-26 15:55:47,504 - Validation score increased.  Saving model ...
2025-02-26 15:56:16,370 - {'epoch': 15, 'rec_loss': '7.0287'}
2025-02-26 15:56:24,570 - {'Epoch': 15, 'HR@5': '0.0844', 'NDCG@5': '0.0593', 'HR@10': '0.1183', 'NDCG@10': '0.0702', 'HR@20': '0.1602', 'NDCG@20': '0.0807'}
2025-02-26 15:56:24,571 - EarlyStopping counter: 1 out of 10
2025-02-26 15:56:51,970 - {'epoch': 16, 'rec_loss': '7.0003'}
2025-02-26 15:56:59,954 - {'Epoch': 16, 'HR@5': '0.0818', 'NDCG@5': '0.0582', 'HR@10': '0.1163', 'NDCG@10': '0.0694', 'HR@20': '0.1595', 'NDCG@20': '0.0802'}
2025-02-26 15:56:59,955 - EarlyStopping counter: 2 out of 10
2025-02-26 15:57:27,325 - {'epoch': 17, 'rec_loss': '6.9822'}
2025-02-26 15:57:35,713 - {'Epoch': 17, 'HR@5': '0.0856', 'NDCG@5': '0.0602', 'HR@10': '0.1179', 'NDCG@10': '0.0706', 'HR@20': '0.1606', 'NDCG@20': '0.0813'}
2025-02-26 15:57:35,719 - EarlyStopping counter: 3 out of 10
2025-02-26 15:58:02,440 - {'epoch': 18, 'rec_loss': '6.9617'}
2025-02-26 15:58:10,647 - {'Epoch': 18, 'HR@5': '0.0851', 'NDCG@5': '0.0604', 'HR@10': '0.1168', 'NDCG@10': '0.0706', 'HR@20': '0.1612', 'NDCG@20': '0.0818'}
2025-02-26 15:58:10,649 - Validation score increased.  Saving model ...
2025-02-26 15:58:38,619 - {'epoch': 19, 'rec_loss': '6.9528'}
2025-02-26 15:58:46,649 - {'Epoch': 19, 'HR@5': '0.0841', 'NDCG@5': '0.0588', 'HR@10': '0.1176', 'NDCG@10': '0.0696', 'HR@20': '0.1624', 'NDCG@20': '0.0809'}
2025-02-26 15:58:46,655 - EarlyStopping counter: 1 out of 10
2025-02-26 15:59:15,660 - {'epoch': 20, 'rec_loss': '6.9346'}
2025-02-26 15:59:23,726 - {'Epoch': 20, 'HR@5': '0.0845', 'NDCG@5': '0.0590', 'HR@10': '0.1182', 'NDCG@10': '0.0699', 'HR@20': '0.1622', 'NDCG@20': '0.0809'}
2025-02-26 15:59:23,727 - EarlyStopping counter: 2 out of 10
2025-02-26 15:59:52,109 - {'epoch': 21, 'rec_loss': '6.9186'}
2025-02-26 16:00:00,269 - {'Epoch': 21, 'HR@5': '0.0853', 'NDCG@5': '0.0598', 'HR@10': '0.1177', 'NDCG@10': '0.0703', 'HR@20': '0.1608', 'NDCG@20': '0.0811'}
2025-02-26 16:00:00,278 - EarlyStopping counter: 3 out of 10
2025-02-26 16:00:28,438 - {'epoch': 22, 'rec_loss': '6.9093'}
2025-02-26 16:00:36,919 - {'Epoch': 22, 'HR@5': '0.0851', 'NDCG@5': '0.0600', 'HR@10': '0.1188', 'NDCG@10': '0.0708', 'HR@20': '0.1622', 'NDCG@20': '0.0817'}
2025-02-26 16:00:36,920 - EarlyStopping counter: 4 out of 10
2025-02-26 16:01:04,106 - {'epoch': 23, 'rec_loss': '6.8919'}
2025-02-26 16:01:11,958 - {'Epoch': 23, 'HR@5': '0.0861', 'NDCG@5': '0.0606', 'HR@10': '0.1183', 'NDCG@10': '0.0709', 'HR@20': '0.1620', 'NDCG@20': '0.0820'}
2025-02-26 16:01:11,959 - Validation score increased.  Saving model ...
2025-02-26 16:01:39,348 - {'epoch': 24, 'rec_loss': '6.8776'}
2025-02-26 16:01:47,777 - {'Epoch': 24, 'HR@5': '0.0852', 'NDCG@5': '0.0598', 'HR@10': '0.1194', 'NDCG@10': '0.0709', 'HR@20': '0.1604', 'NDCG@20': '0.0812'}
2025-02-26 16:01:47,778 - EarlyStopping counter: 1 out of 10
2025-02-26 16:02:15,660 - {'epoch': 25, 'rec_loss': '6.8697'}
2025-02-26 16:02:23,695 - {'Epoch': 25, 'HR@5': '0.0868', 'NDCG@5': '0.0612', 'HR@10': '0.1192', 'NDCG@10': '0.0716', 'HR@20': '0.1623', 'NDCG@20': '0.0824'}
2025-02-26 16:02:23,696 - Validation score increased.  Saving model ...
2025-02-26 16:02:52,828 - {'epoch': 26, 'rec_loss': '6.8557'}
2025-02-26 16:03:01,027 - {'Epoch': 26, 'HR@5': '0.0876', 'NDCG@5': '0.0618', 'HR@10': '0.1192', 'NDCG@10': '0.0720', 'HR@20': '0.1629', 'NDCG@20': '0.0830'}
2025-02-26 16:03:01,028 - Validation score increased.  Saving model ...
2025-02-26 16:03:30,008 - {'epoch': 27, 'rec_loss': '6.8477'}
2025-02-26 16:03:38,331 - {'Epoch': 27, 'HR@5': '0.0868', 'NDCG@5': '0.0610', 'HR@10': '0.1193', 'NDCG@10': '0.0715', 'HR@20': '0.1621', 'NDCG@20': '0.0822'}
2025-02-26 16:03:38,332 - EarlyStopping counter: 1 out of 10
2025-02-26 16:04:05,781 - {'epoch': 28, 'rec_loss': '6.8378'}
2025-02-26 16:04:13,860 - {'Epoch': 28, 'HR@5': '0.0852', 'NDCG@5': '0.0605', 'HR@10': '0.1176', 'NDCG@10': '0.0709', 'HR@20': '0.1605', 'NDCG@20': '0.0817'}
2025-02-26 16:04:13,861 - EarlyStopping counter: 2 out of 10
2025-02-26 16:04:41,600 - {'epoch': 29, 'rec_loss': '6.8299'}
2025-02-26 16:04:49,873 - {'Epoch': 29, 'HR@5': '0.0864', 'NDCG@5': '0.0611', 'HR@10': '0.1197', 'NDCG@10': '0.0718', 'HR@20': '0.1617', 'NDCG@20': '0.0824'}
2025-02-26 16:04:49,877 - EarlyStopping counter: 3 out of 10
2025-02-26 16:05:17,696 - {'epoch': 30, 'rec_loss': '6.8232'}
2025-02-26 16:05:25,840 - {'Epoch': 30, 'HR@5': '0.0865', 'NDCG@5': '0.0611', 'HR@10': '0.1190', 'NDCG@10': '0.0715', 'HR@20': '0.1625', 'NDCG@20': '0.0825'}
2025-02-26 16:05:25,841 - EarlyStopping counter: 4 out of 10
2025-02-26 16:05:51,400 - {'epoch': 31, 'rec_loss': '6.8112'}
2025-02-26 16:05:59,312 - {'Epoch': 31, 'HR@5': '0.0886', 'NDCG@5': '0.0621', 'HR@10': '0.1196', 'NDCG@10': '0.0721', 'HR@20': '0.1625', 'NDCG@20': '0.0829'}
2025-02-26 16:05:59,313 - EarlyStopping counter: 5 out of 10
2025-02-26 16:06:26,261 - {'epoch': 32, 'rec_loss': '6.8058'}
2025-02-26 16:06:34,517 - {'Epoch': 32, 'HR@5': '0.0869', 'NDCG@5': '0.0616', 'HR@10': '0.1201', 'NDCG@10': '0.0722', 'HR@20': '0.1637', 'NDCG@20': '0.0832'}
2025-02-26 16:06:34,518 - Validation score increased.  Saving model ...
2025-02-26 16:07:02,727 - {'epoch': 33, 'rec_loss': '6.7969'}
2025-02-26 16:07:10,870 - {'Epoch': 33, 'HR@5': '0.0882', 'NDCG@5': '0.0619', 'HR@10': '0.1213', 'NDCG@10': '0.0726', 'HR@20': '0.1640', 'NDCG@20': '0.0833'}
2025-02-26 16:07:10,871 - Validation score increased.  Saving model ...
2025-02-26 16:07:38,047 - {'epoch': 34, 'rec_loss': '6.7851'}
2025-02-26 16:07:46,116 - {'Epoch': 34, 'HR@5': '0.0868', 'NDCG@5': '0.0607', 'HR@10': '0.1174', 'NDCG@10': '0.0705', 'HR@20': '0.1629', 'NDCG@20': '0.0820'}
2025-02-26 16:07:46,122 - EarlyStopping counter: 1 out of 10
2025-02-26 16:08:13,401 - {'epoch': 35, 'rec_loss': '6.7818'}
2025-02-26 16:08:21,551 - {'Epoch': 35, 'HR@5': '0.0876', 'NDCG@5': '0.0614', 'HR@10': '0.1186', 'NDCG@10': '0.0714', 'HR@20': '0.1614', 'NDCG@20': '0.0822'}
2025-02-26 16:08:21,556 - EarlyStopping counter: 2 out of 10
2025-02-26 16:08:48,638 - {'epoch': 36, 'rec_loss': '6.7716'}
2025-02-26 16:08:56,754 - {'Epoch': 36, 'HR@5': '0.0865', 'NDCG@5': '0.0608', 'HR@10': '0.1184', 'NDCG@10': '0.0711', 'HR@20': '0.1627', 'NDCG@20': '0.0822'}
2025-02-26 16:08:56,755 - EarlyStopping counter: 3 out of 10
2025-02-26 16:09:24,576 - {'epoch': 37, 'rec_loss': '6.7636'}
2025-02-26 16:09:33,452 - {'Epoch': 37, 'HR@5': '0.0854', 'NDCG@5': '0.0605', 'HR@10': '0.1169', 'NDCG@10': '0.0707', 'HR@20': '0.1625', 'NDCG@20': '0.0822'}
2025-02-26 16:09:33,453 - EarlyStopping counter: 4 out of 10
2025-02-26 16:10:01,300 - {'epoch': 38, 'rec_loss': '6.7554'}
2025-02-26 16:10:09,265 - {'Epoch': 38, 'HR@5': '0.0855', 'NDCG@5': '0.0600', 'HR@10': '0.1194', 'NDCG@10': '0.0709', 'HR@20': '0.1626', 'NDCG@20': '0.0818'}
2025-02-26 16:10:09,271 - EarlyStopping counter: 5 out of 10
2025-02-26 16:10:39,449 - {'epoch': 39, 'rec_loss': '6.7497'}
2025-02-26 16:10:47,770 - {'Epoch': 39, 'HR@5': '0.0875', 'NDCG@5': '0.0619', 'HR@10': '0.1207', 'NDCG@10': '0.0726', 'HR@20': '0.1632', 'NDCG@20': '0.0833'}
2025-02-26 16:10:47,773 - Validation score increased.  Saving model ...
2025-02-26 16:11:15,648 - {'epoch': 40, 'rec_loss': '6.7432'}
2025-02-26 16:11:23,695 - {'Epoch': 40, 'HR@5': '0.0873', 'NDCG@5': '0.0611', 'HR@10': '0.1208', 'NDCG@10': '0.0719', 'HR@20': '0.1624', 'NDCG@20': '0.0824'}
2025-02-26 16:11:23,697 - EarlyStopping counter: 1 out of 10
2025-02-26 16:11:51,550 - {'epoch': 41, 'rec_loss': '6.7447'}
2025-02-26 16:11:59,555 - {'Epoch': 41, 'HR@5': '0.0867', 'NDCG@5': '0.0608', 'HR@10': '0.1184', 'NDCG@10': '0.0711', 'HR@20': '0.1610', 'NDCG@20': '0.0818'}
2025-02-26 16:11:59,557 - EarlyStopping counter: 2 out of 10
2025-02-26 16:12:28,784 - {'epoch': 42, 'rec_loss': '6.7376'}
2025-02-26 16:12:36,908 - {'Epoch': 42, 'HR@5': '0.0865', 'NDCG@5': '0.0612', 'HR@10': '0.1206', 'NDCG@10': '0.0721', 'HR@20': '0.1623', 'NDCG@20': '0.0826'}
2025-02-26 16:12:36,909 - EarlyStopping counter: 3 out of 10
2025-02-26 16:13:04,551 - {'epoch': 43, 'rec_loss': '6.7324'}
2025-02-26 16:13:12,838 - {'Epoch': 43, 'HR@5': '0.0876', 'NDCG@5': '0.0619', 'HR@10': '0.1193', 'NDCG@10': '0.0721', 'HR@20': '0.1628', 'NDCG@20': '0.0831'}
2025-02-26 16:13:12,844 - EarlyStopping counter: 4 out of 10
2025-02-26 16:13:41,435 - {'epoch': 44, 'rec_loss': '6.7245'}
2025-02-26 16:13:50,027 - {'Epoch': 44, 'HR@5': '0.0876', 'NDCG@5': '0.0614', 'HR@10': '0.1182', 'NDCG@10': '0.0712', 'HR@20': '0.1599', 'NDCG@20': '0.0818'}
2025-02-26 16:13:50,028 - EarlyStopping counter: 5 out of 10
2025-02-26 16:14:22,901 - {'epoch': 45, 'rec_loss': '6.7240'}
2025-02-26 16:14:31,699 - {'Epoch': 45, 'HR@5': '0.0871', 'NDCG@5': '0.0618', 'HR@10': '0.1202', 'NDCG@10': '0.0724', 'HR@20': '0.1624', 'NDCG@20': '0.0830'}
2025-02-26 16:14:31,704 - EarlyStopping counter: 6 out of 10
2025-02-26 16:15:01,016 - {'epoch': 46, 'rec_loss': '6.7105'}
2025-02-26 16:15:09,017 - {'Epoch': 46, 'HR@5': '0.0878', 'NDCG@5': '0.0617', 'HR@10': '0.1204', 'NDCG@10': '0.0722', 'HR@20': '0.1625', 'NDCG@20': '0.0828'}
2025-02-26 16:15:09,018 - EarlyStopping counter: 7 out of 10
2025-02-26 16:15:37,433 - {'epoch': 47, 'rec_loss': '6.7028'}
2025-02-26 16:15:45,499 - {'Epoch': 47, 'HR@5': '0.0872', 'NDCG@5': '0.0616', 'HR@10': '0.1198', 'NDCG@10': '0.0721', 'HR@20': '0.1640', 'NDCG@20': '0.0832'}
2025-02-26 16:15:45,504 - EarlyStopping counter: 8 out of 10
2025-02-26 16:16:14,672 - {'epoch': 48, 'rec_loss': '6.7063'}
2025-02-26 16:16:22,814 - {'Epoch': 48, 'HR@5': '0.0869', 'NDCG@5': '0.0613', 'HR@10': '0.1185', 'NDCG@10': '0.0716', 'HR@20': '0.1616', 'NDCG@20': '0.0825'}
2025-02-26 16:16:22,819 - EarlyStopping counter: 9 out of 10
2025-02-26 16:16:50,424 - {'epoch': 49, 'rec_loss': '6.7010'}
2025-02-26 16:16:58,507 - {'Epoch': 49, 'HR@5': '0.0875', 'NDCG@5': '0.0621', 'HR@10': '0.1195', 'NDCG@10': '0.0725', 'HR@20': '0.1629', 'NDCG@20': '0.0834'}
2025-02-26 16:16:58,511 - Validation score increased.  Saving model ...
2025-02-26 16:17:25,730 - {'epoch': 50, 'rec_loss': '6.6969'}
2025-02-26 16:17:33,915 - {'Epoch': 50, 'HR@5': '0.0867', 'NDCG@5': '0.0612', 'HR@10': '0.1211', 'NDCG@10': '0.0723', 'HR@20': '0.1635', 'NDCG@20': '0.0830'}
2025-02-26 16:17:33,916 - EarlyStopping counter: 1 out of 10
2025-02-26 16:18:01,313 - {'epoch': 51, 'rec_loss': '6.6912'}
2025-02-26 16:18:09,245 - {'Epoch': 51, 'HR@5': '0.0864', 'NDCG@5': '0.0611', 'HR@10': '0.1182', 'NDCG@10': '0.0713', 'HR@20': '0.1608', 'NDCG@20': '0.0820'}
2025-02-26 16:18:09,250 - EarlyStopping counter: 2 out of 10
2025-02-26 16:18:36,766 - {'epoch': 52, 'rec_loss': '6.6818'}
2025-02-26 16:18:45,084 - {'Epoch': 52, 'HR@5': '0.0875', 'NDCG@5': '0.0619', 'HR@10': '0.1187', 'NDCG@10': '0.0719', 'HR@20': '0.1613', 'NDCG@20': '0.0826'}
2025-02-26 16:18:45,086 - EarlyStopping counter: 3 out of 10
2025-02-26 16:19:11,890 - {'epoch': 53, 'rec_loss': '6.6886'}
2025-02-26 16:19:20,322 - {'Epoch': 53, 'HR@5': '0.0885', 'NDCG@5': '0.0622', 'HR@10': '0.1206', 'NDCG@10': '0.0725', 'HR@20': '0.1644', 'NDCG@20': '0.0835'}
2025-02-26 16:19:20,323 - Validation score increased.  Saving model ...
2025-02-26 16:19:48,308 - {'epoch': 54, 'rec_loss': '6.6807'}
2025-02-26 16:19:57,944 - {'Epoch': 54, 'HR@5': '0.0879', 'NDCG@5': '0.0624', 'HR@10': '0.1203', 'NDCG@10': '0.0728', 'HR@20': '0.1629', 'NDCG@20': '0.0835'}
2025-02-26 16:19:57,946 - Validation score increased.  Saving model ...
2025-02-26 16:20:38,159 - {'epoch': 55, 'rec_loss': '6.6781'}
2025-02-26 16:20:47,290 - {'Epoch': 55, 'HR@5': '0.0871', 'NDCG@5': '0.0614', 'HR@10': '0.1196', 'NDCG@10': '0.0720', 'HR@20': '0.1644', 'NDCG@20': '0.0832'}
2025-02-26 16:20:47,291 - EarlyStopping counter: 1 out of 10
2025-02-26 16:21:26,972 - {'epoch': 56, 'rec_loss': '6.6720'}
2025-02-26 16:21:36,435 - {'Epoch': 56, 'HR@5': '0.0874', 'NDCG@5': '0.0624', 'HR@10': '0.1195', 'NDCG@10': '0.0727', 'HR@20': '0.1613', 'NDCG@20': '0.0832'}
2025-02-26 16:21:36,440 - EarlyStopping counter: 2 out of 10
2025-02-26 16:22:16,164 - {'epoch': 57, 'rec_loss': '6.6608'}
2025-02-26 16:22:24,817 - {'Epoch': 57, 'HR@5': '0.0868', 'NDCG@5': '0.0620', 'HR@10': '0.1203', 'NDCG@10': '0.0728', 'HR@20': '0.1633', 'NDCG@20': '0.0836'}
2025-02-26 16:22:24,818 - Validation score increased.  Saving model ...
2025-02-26 16:23:04,011 - {'epoch': 58, 'rec_loss': '6.6573'}
2025-02-26 16:23:14,166 - {'Epoch': 58, 'HR@5': '0.0865', 'NDCG@5': '0.0613', 'HR@10': '0.1191', 'NDCG@10': '0.0718', 'HR@20': '0.1629', 'NDCG@20': '0.0828'}
2025-02-26 16:23:14,171 - EarlyStopping counter: 1 out of 10
2025-02-26 16:23:55,911 - {'epoch': 59, 'rec_loss': '6.6598'}
2025-02-26 16:24:05,465 - {'Epoch': 59, 'HR@5': '0.0873', 'NDCG@5': '0.0621', 'HR@10': '0.1210', 'NDCG@10': '0.0729', 'HR@20': '0.1622', 'NDCG@20': '0.0833'}
2025-02-26 16:24:05,467 - EarlyStopping counter: 2 out of 10
2025-02-26 16:24:45,736 - {'epoch': 60, 'rec_loss': '6.6597'}
2025-02-26 16:24:55,501 - {'Epoch': 60, 'HR@5': '0.0893', 'NDCG@5': '0.0631', 'HR@10': '0.1204', 'NDCG@10': '0.0731', 'HR@20': '0.1638', 'NDCG@20': '0.0841'}
2025-02-26 16:24:55,503 - Validation score increased.  Saving model ...
2025-02-26 16:25:38,343 - {'epoch': 61, 'rec_loss': '6.6492'}
2025-02-26 16:25:48,108 - {'Epoch': 61, 'HR@5': '0.0884', 'NDCG@5': '0.0624', 'HR@10': '0.1210', 'NDCG@10': '0.0729', 'HR@20': '0.1637', 'NDCG@20': '0.0837'}
2025-02-26 16:25:48,115 - EarlyStopping counter: 1 out of 10
2025-02-26 16:26:28,235 - {'epoch': 62, 'rec_loss': '6.6458'}
2025-02-26 16:26:38,123 - {'Epoch': 62, 'HR@5': '0.0883', 'NDCG@5': '0.0628', 'HR@10': '0.1197', 'NDCG@10': '0.0729', 'HR@20': '0.1629', 'NDCG@20': '0.0838'}
2025-02-26 16:26:38,124 - EarlyStopping counter: 2 out of 10
2025-02-26 16:27:18,329 - {'epoch': 63, 'rec_loss': '6.6377'}
2025-02-26 16:27:27,585 - {'Epoch': 63, 'HR@5': '0.0891', 'NDCG@5': '0.0631', 'HR@10': '0.1198', 'NDCG@10': '0.0730', 'HR@20': '0.1625', 'NDCG@20': '0.0838'}
2025-02-26 16:27:27,592 - EarlyStopping counter: 3 out of 10
2025-02-26 16:28:07,397 - {'epoch': 64, 'rec_loss': '6.6401'}
2025-02-26 16:28:16,507 - {'Epoch': 64, 'HR@5': '0.0883', 'NDCG@5': '0.0623', 'HR@10': '0.1203', 'NDCG@10': '0.0727', 'HR@20': '0.1641', 'NDCG@20': '0.0837'}
2025-02-26 16:28:16,509 - EarlyStopping counter: 4 out of 10
2025-02-26 16:28:57,726 - {'epoch': 65, 'rec_loss': '6.6422'}
2025-02-26 16:29:07,181 - {'Epoch': 65, 'HR@5': '0.0869', 'NDCG@5': '0.0617', 'HR@10': '0.1204', 'NDCG@10': '0.0725', 'HR@20': '0.1629', 'NDCG@20': '0.0832'}
2025-02-26 16:29:07,183 - EarlyStopping counter: 5 out of 10
2025-02-26 16:29:46,540 - {'epoch': 66, 'rec_loss': '6.6383'}
2025-02-26 16:29:55,387 - {'Epoch': 66, 'HR@5': '0.0883', 'NDCG@5': '0.0626', 'HR@10': '0.1211', 'NDCG@10': '0.0732', 'HR@20': '0.1634', 'NDCG@20': '0.0838'}
2025-02-26 16:29:55,392 - EarlyStopping counter: 6 out of 10
2025-02-26 16:30:34,399 - {'epoch': 67, 'rec_loss': '6.6382'}
2025-02-26 16:30:44,332 - {'Epoch': 67, 'HR@5': '0.0889', 'NDCG@5': '0.0634', 'HR@10': '0.1206', 'NDCG@10': '0.0736', 'HR@20': '0.1622', 'NDCG@20': '0.0841'}
2025-02-26 16:30:44,337 - Validation score increased.  Saving model ...
2025-02-26 16:31:24,185 - {'epoch': 68, 'rec_loss': '6.6311'}
2025-02-26 16:31:33,634 - {'Epoch': 68, 'HR@5': '0.0894', 'NDCG@5': '0.0628', 'HR@10': '0.1221', 'NDCG@10': '0.0733', 'HR@20': '0.1632', 'NDCG@20': '0.0836'}
2025-02-26 16:31:33,635 - EarlyStopping counter: 1 out of 10
2025-02-26 16:32:13,332 - {'epoch': 69, 'rec_loss': '6.6305'}
2025-02-26 16:32:22,422 - {'Epoch': 69, 'HR@5': '0.0880', 'NDCG@5': '0.0627', 'HR@10': '0.1207', 'NDCG@10': '0.0732', 'HR@20': '0.1630', 'NDCG@20': '0.0838'}
2025-02-26 16:32:22,429 - EarlyStopping counter: 2 out of 10
2025-02-26 16:33:02,464 - {'epoch': 70, 'rec_loss': '6.6326'}
2025-02-26 16:33:11,899 - {'Epoch': 70, 'HR@5': '0.0872', 'NDCG@5': '0.0622', 'HR@10': '0.1205', 'NDCG@10': '0.0729', 'HR@20': '0.1629', 'NDCG@20': '0.0836'}
2025-02-26 16:33:11,901 - EarlyStopping counter: 3 out of 10
2025-02-26 16:33:53,269 - {'epoch': 71, 'rec_loss': '6.6249'}
2025-02-26 16:34:03,108 - {'Epoch': 71, 'HR@5': '0.0884', 'NDCG@5': '0.0627', 'HR@10': '0.1219', 'NDCG@10': '0.0736', 'HR@20': '0.1628', 'NDCG@20': '0.0838'}
2025-02-26 16:34:03,109 - EarlyStopping counter: 4 out of 10
2025-02-26 16:34:44,419 - {'epoch': 72, 'rec_loss': '6.6170'}
2025-02-26 16:34:54,449 - {'Epoch': 72, 'HR@5': '0.0891', 'NDCG@5': '0.0626', 'HR@10': '0.1213', 'NDCG@10': '0.0729', 'HR@20': '0.1648', 'NDCG@20': '0.0839'}
2025-02-26 16:34:54,450 - EarlyStopping counter: 5 out of 10
2025-02-26 16:35:34,638 - {'epoch': 73, 'rec_loss': '6.6179'}
2025-02-26 16:35:43,341 - {'Epoch': 73, 'HR@5': '0.0885', 'NDCG@5': '0.0629', 'HR@10': '0.1198', 'NDCG@10': '0.0729', 'HR@20': '0.1620', 'NDCG@20': '0.0835'}
2025-02-26 16:35:43,346 - EarlyStopping counter: 6 out of 10
2025-02-26 16:36:16,597 - {'epoch': 74, 'rec_loss': '6.6168'}
2025-02-26 16:36:24,607 - {'Epoch': 74, 'HR@5': '0.0889', 'NDCG@5': '0.0627', 'HR@10': '0.1201', 'NDCG@10': '0.0727', 'HR@20': '0.1626', 'NDCG@20': '0.0834'}
2025-02-26 16:36:24,608 - EarlyStopping counter: 7 out of 10
2025-02-26 16:36:52,351 - {'epoch': 75, 'rec_loss': '6.6173'}
2025-02-26 16:37:01,671 - {'Epoch': 75, 'HR@5': '0.0875', 'NDCG@5': '0.0616', 'HR@10': '0.1215', 'NDCG@10': '0.0726', 'HR@20': '0.1621', 'NDCG@20': '0.0828'}
2025-02-26 16:37:01,672 - EarlyStopping counter: 8 out of 10
2025-02-26 16:37:30,059 - {'epoch': 76, 'rec_loss': '6.6052'}
2025-02-26 16:37:39,648 - {'Epoch': 76, 'HR@5': '0.0886', 'NDCG@5': '0.0621', 'HR@10': '0.1197', 'NDCG@10': '0.0721', 'HR@20': '0.1608', 'NDCG@20': '0.0824'}
2025-02-26 16:37:39,649 - EarlyStopping counter: 9 out of 10
2025-02-26 16:38:08,684 - {'epoch': 77, 'rec_loss': '6.6092'}
2025-02-26 16:38:18,195 - {'Epoch': 77, 'HR@5': '0.0885', 'NDCG@5': '0.0628', 'HR@10': '0.1203', 'NDCG@10': '0.0730', 'HR@20': '0.1617', 'NDCG@20': '0.0835'}
2025-02-26 16:38:18,198 - EarlyStopping counter: 10 out of 10
2025-02-26 16:38:18,198 - Early stopping
2025-02-26 16:38:18,198 - ---------------Test Score---------------
2025-02-26 16:38:27,901 - {'Epoch': 0, 'HR@5': '0.0706', 'NDCG@5': '0.0506', 'HR@10': '0.0986', 'NDCG@10': '0.0596', 'HR@20': '0.1359', 'NDCG@20': '0.0690'}
2025-02-26 16:38:27,906 - Scale_Beauty
2025-02-26 16:38:27,906 - {'Epoch': 0, 'HR@5': '0.0706', 'NDCG@5': '0.0506', 'HR@10': '0.0986', 'NDCG@10': '0.0596', 'HR@20': '0.1359', 'NDCG@20': '0.0690'}
2025-02-26 17:12:40,479 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 10], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-26 17:12:43,345 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-26 17:12:43,351 - Total Parameters: 928470
2025-02-26 17:13:11,411 - {'epoch': 0, 'rec_loss': '8.8297'}
2025-02-26 17:13:19,338 - {'Epoch': 0, 'HR@5': '0.0195', 'NDCG@5': '0.0124', 'HR@10': '0.0306', 'NDCG@10': '0.0159', 'HR@20': '0.0465', 'NDCG@20': '0.0199'}
2025-02-26 17:13:19,339 - Validation score increased.  Saving model ...
2025-02-26 17:13:46,750 - {'epoch': 1, 'rec_loss': '8.3130'}
2025-02-26 17:13:54,686 - {'Epoch': 1, 'HR@5': '0.0359', 'NDCG@5': '0.0231', 'HR@10': '0.0557', 'NDCG@10': '0.0295', 'HR@20': '0.0805', 'NDCG@20': '0.0358'}
2025-02-26 17:13:54,688 - Validation score increased.  Saving model ...
2025-02-26 17:14:23,858 - {'epoch': 2, 'rec_loss': '8.0021'}
2025-02-26 17:14:31,421 - {'Epoch': 2, 'HR@5': '0.0523', 'NDCG@5': '0.0350', 'HR@10': '0.0757', 'NDCG@10': '0.0426', 'HR@20': '0.1062', 'NDCG@20': '0.0502'}
2025-02-26 17:14:31,425 - Validation score increased.  Saving model ...
2025-02-26 17:14:59,011 - {'epoch': 3, 'rec_loss': '7.7861'}
2025-02-26 17:15:06,363 - {'Epoch': 3, 'HR@5': '0.0621', 'NDCG@5': '0.0427', 'HR@10': '0.0893', 'NDCG@10': '0.0513', 'HR@20': '0.1250', 'NDCG@20': '0.0603'}
2025-02-26 17:15:06,368 - Validation score increased.  Saving model ...
2025-02-26 17:15:34,889 - {'epoch': 4, 'rec_loss': '7.6344'}
2025-02-26 17:15:42,294 - {'Epoch': 4, 'HR@5': '0.0696', 'NDCG@5': '0.0487', 'HR@10': '0.0968', 'NDCG@10': '0.0575', 'HR@20': '0.1341', 'NDCG@20': '0.0669'}
2025-02-26 17:15:42,298 - Validation score increased.  Saving model ...
2025-02-26 17:16:09,945 - {'epoch': 5, 'rec_loss': '7.5141'}
2025-02-26 17:16:17,659 - {'Epoch': 5, 'HR@5': '0.0745', 'NDCG@5': '0.0516', 'HR@10': '0.1033', 'NDCG@10': '0.0609', 'HR@20': '0.1413', 'NDCG@20': '0.0704'}
2025-02-26 17:16:17,660 - Validation score increased.  Saving model ...
2025-02-26 17:16:45,007 - {'epoch': 6, 'rec_loss': '7.4188'}
2025-02-26 17:16:52,969 - {'Epoch': 6, 'HR@5': '0.0755', 'NDCG@5': '0.0531', 'HR@10': '0.1059', 'NDCG@10': '0.0630', 'HR@20': '0.1457', 'NDCG@20': '0.0730'}
2025-02-26 17:16:52,970 - Validation score increased.  Saving model ...
2025-02-26 17:17:21,429 - {'epoch': 7, 'rec_loss': '7.3394'}
2025-02-26 17:17:28,815 - {'Epoch': 7, 'HR@5': '0.0808', 'NDCG@5': '0.0571', 'HR@10': '0.1109', 'NDCG@10': '0.0668', 'HR@20': '0.1502', 'NDCG@20': '0.0767'}
2025-02-26 17:17:28,816 - Validation score increased.  Saving model ...
2025-02-26 17:17:55,630 - {'epoch': 8, 'rec_loss': '7.2745'}
2025-02-26 17:18:03,104 - {'Epoch': 8, 'HR@5': '0.0803', 'NDCG@5': '0.0567', 'HR@10': '0.1116', 'NDCG@10': '0.0668', 'HR@20': '0.1519', 'NDCG@20': '0.0770'}
2025-02-26 17:18:03,108 - Validation score increased.  Saving model ...
2025-02-26 17:18:33,214 - {'epoch': 9, 'rec_loss': '7.2265'}
2025-02-26 17:18:41,167 - {'Epoch': 9, 'HR@5': '0.0816', 'NDCG@5': '0.0586', 'HR@10': '0.1133', 'NDCG@10': '0.0688', 'HR@20': '0.1540', 'NDCG@20': '0.0790'}
2025-02-26 17:18:41,171 - Validation score increased.  Saving model ...
2025-02-26 17:19:12,344 - {'epoch': 10, 'rec_loss': '7.1785'}
2025-02-26 17:19:22,397 - {'Epoch': 10, 'HR@5': '0.0830', 'NDCG@5': '0.0590', 'HR@10': '0.1134', 'NDCG@10': '0.0688', 'HR@20': '0.1550', 'NDCG@20': '0.0792'}
2025-02-26 17:19:22,398 - Validation score increased.  Saving model ...
2025-02-26 17:19:53,888 - {'epoch': 11, 'rec_loss': '7.1408'}
2025-02-26 17:20:03,658 - {'Epoch': 11, 'HR@5': '0.0832', 'NDCG@5': '0.0591', 'HR@10': '0.1142', 'NDCG@10': '0.0691', 'HR@20': '0.1564', 'NDCG@20': '0.0797'}
2025-02-26 17:20:03,663 - Validation score increased.  Saving model ...
2025-02-26 17:20:34,454 - {'epoch': 12, 'rec_loss': '7.1076'}
2025-02-26 17:20:44,487 - {'Epoch': 12, 'HR@5': '0.0842', 'NDCG@5': '0.0595', 'HR@10': '0.1150', 'NDCG@10': '0.0695', 'HR@20': '0.1570', 'NDCG@20': '0.0800'}
2025-02-26 17:20:44,488 - Validation score increased.  Saving model ...
2025-02-26 17:21:14,993 - {'epoch': 13, 'rec_loss': '7.0809'}
2025-02-26 17:21:24,897 - {'Epoch': 13, 'HR@5': '0.0857', 'NDCG@5': '0.0603', 'HR@10': '0.1155', 'NDCG@10': '0.0699', 'HR@20': '0.1595', 'NDCG@20': '0.0809'}
2025-02-26 17:21:24,899 - Validation score increased.  Saving model ...
2025-02-26 17:21:55,313 - {'epoch': 14, 'rec_loss': '7.0516'}
2025-02-26 17:22:05,443 - {'Epoch': 14, 'HR@5': '0.0846', 'NDCG@5': '0.0598', 'HR@10': '0.1162', 'NDCG@10': '0.0699', 'HR@20': '0.1591', 'NDCG@20': '0.0807'}
2025-02-26 17:22:05,444 - EarlyStopping counter: 1 out of 10
2025-02-26 17:22:36,893 - {'epoch': 15, 'rec_loss': '7.0348'}
2025-02-26 17:22:47,146 - {'Epoch': 15, 'HR@5': '0.0837', 'NDCG@5': '0.0589', 'HR@10': '0.1166', 'NDCG@10': '0.0695', 'HR@20': '0.1604', 'NDCG@20': '0.0806'}
2025-02-26 17:22:47,147 - EarlyStopping counter: 2 out of 10
2025-02-26 17:23:17,735 - {'epoch': 16, 'rec_loss': '7.0110'}
2025-02-26 17:23:27,838 - {'Epoch': 16, 'HR@5': '0.0843', 'NDCG@5': '0.0595', 'HR@10': '0.1166', 'NDCG@10': '0.0699', 'HR@20': '0.1613', 'NDCG@20': '0.0812'}
2025-02-26 17:23:27,842 - Validation score increased.  Saving model ...
2025-02-26 17:24:00,498 - {'epoch': 17, 'rec_loss': '6.9939'}
2025-02-26 17:24:10,153 - {'Epoch': 17, 'HR@5': '0.0857', 'NDCG@5': '0.0608', 'HR@10': '0.1191', 'NDCG@10': '0.0716', 'HR@20': '0.1616', 'NDCG@20': '0.0822'}
2025-02-26 17:24:10,158 - Validation score increased.  Saving model ...
2025-02-26 17:24:40,563 - {'epoch': 18, 'rec_loss': '6.9646'}
2025-02-26 17:24:50,635 - {'Epoch': 18, 'HR@5': '0.0863', 'NDCG@5': '0.0603', 'HR@10': '0.1190', 'NDCG@10': '0.0708', 'HR@20': '0.1624', 'NDCG@20': '0.0817'}
2025-02-26 17:24:50,636 - EarlyStopping counter: 1 out of 10
2025-02-26 17:25:20,714 - {'epoch': 19, 'rec_loss': '6.9516'}
2025-02-26 17:25:30,296 - {'Epoch': 19, 'HR@5': '0.0861', 'NDCG@5': '0.0605', 'HR@10': '0.1193', 'NDCG@10': '0.0711', 'HR@20': '0.1619', 'NDCG@20': '0.0819'}
2025-02-26 17:25:30,298 - EarlyStopping counter: 2 out of 10
2025-02-26 17:26:02,012 - {'epoch': 20, 'rec_loss': '6.9421'}
2025-02-26 17:26:11,318 - {'Epoch': 20, 'HR@5': '0.0873', 'NDCG@5': '0.0615', 'HR@10': '0.1202', 'NDCG@10': '0.0721', 'HR@20': '0.1621', 'NDCG@20': '0.0826'}
2025-02-26 17:26:11,326 - Validation score increased.  Saving model ...
2025-02-26 17:26:41,308 - {'epoch': 21, 'rec_loss': '6.9190'}
2025-02-26 17:26:51,763 - {'Epoch': 21, 'HR@5': '0.0872', 'NDCG@5': '0.0614', 'HR@10': '0.1208', 'NDCG@10': '0.0722', 'HR@20': '0.1637', 'NDCG@20': '0.0829'}
2025-02-26 17:26:51,768 - Validation score increased.  Saving model ...
2025-02-26 17:27:22,012 - {'epoch': 22, 'rec_loss': '6.9106'}
2025-02-26 17:27:31,797 - {'Epoch': 22, 'HR@5': '0.0882', 'NDCG@5': '0.0620', 'HR@10': '0.1210', 'NDCG@10': '0.0725', 'HR@20': '0.1634', 'NDCG@20': '0.0832'}
2025-02-26 17:27:31,799 - Validation score increased.  Saving model ...
2025-02-26 17:28:02,344 - {'epoch': 23, 'rec_loss': '6.8978'}
2025-02-26 17:28:12,389 - {'Epoch': 23, 'HR@5': '0.0889', 'NDCG@5': '0.0619', 'HR@10': '0.1220', 'NDCG@10': '0.0726', 'HR@20': '0.1639', 'NDCG@20': '0.0831'}
2025-02-26 17:28:12,394 - EarlyStopping counter: 1 out of 10
2025-02-26 17:28:43,042 - {'epoch': 24, 'rec_loss': '6.8825'}
2025-02-26 17:28:52,776 - {'Epoch': 24, 'HR@5': '0.0867', 'NDCG@5': '0.0612', 'HR@10': '0.1202', 'NDCG@10': '0.0720', 'HR@20': '0.1636', 'NDCG@20': '0.0829'}
2025-02-26 17:28:52,785 - EarlyStopping counter: 2 out of 10
2025-02-26 17:29:23,331 - {'epoch': 25, 'rec_loss': '6.8670'}
2025-02-26 17:29:33,279 - {'Epoch': 25, 'HR@5': '0.0873', 'NDCG@5': '0.0614', 'HR@10': '0.1206', 'NDCG@10': '0.0721', 'HR@20': '0.1645', 'NDCG@20': '0.0831'}
2025-02-26 17:29:33,286 - EarlyStopping counter: 3 out of 10
2025-02-26 17:30:04,505 - {'epoch': 26, 'rec_loss': '6.8614'}
2025-02-26 17:30:14,453 - {'Epoch': 26, 'HR@5': '0.0865', 'NDCG@5': '0.0611', 'HR@10': '0.1211', 'NDCG@10': '0.0722', 'HR@20': '0.1636', 'NDCG@20': '0.0829'}
2025-02-26 17:30:14,456 - EarlyStopping counter: 4 out of 10
2025-02-26 17:30:46,201 - {'epoch': 27, 'rec_loss': '6.8516'}
2025-02-26 17:30:55,340 - {'Epoch': 27, 'HR@5': '0.0881', 'NDCG@5': '0.0623', 'HR@10': '0.1232', 'NDCG@10': '0.0736', 'HR@20': '0.1664', 'NDCG@20': '0.0845'}
2025-02-26 17:30:55,345 - Validation score increased.  Saving model ...
2025-02-26 17:31:25,435 - {'epoch': 28, 'rec_loss': '6.8374'}
2025-02-26 17:31:35,329 - {'Epoch': 28, 'HR@5': '0.0883', 'NDCG@5': '0.0623', 'HR@10': '0.1217', 'NDCG@10': '0.0730', 'HR@20': '0.1650', 'NDCG@20': '0.0839'}
2025-02-26 17:31:35,331 - EarlyStopping counter: 1 out of 10
2025-02-26 17:32:06,523 - {'epoch': 29, 'rec_loss': '6.8331'}
2025-02-26 17:32:16,495 - {'Epoch': 29, 'HR@5': '0.0880', 'NDCG@5': '0.0620', 'HR@10': '0.1215', 'NDCG@10': '0.0727', 'HR@20': '0.1662', 'NDCG@20': '0.0840'}
2025-02-26 17:32:16,496 - EarlyStopping counter: 2 out of 10
2025-02-26 17:32:47,771 - {'epoch': 30, 'rec_loss': '6.8189'}
2025-02-26 17:32:57,403 - {'Epoch': 30, 'HR@5': '0.0887', 'NDCG@5': '0.0627', 'HR@10': '0.1228', 'NDCG@10': '0.0737', 'HR@20': '0.1676', 'NDCG@20': '0.0849'}
2025-02-26 17:32:57,409 - Validation score increased.  Saving model ...
2025-02-26 17:33:28,452 - {'epoch': 31, 'rec_loss': '6.8124'}
2025-02-26 17:33:38,459 - {'Epoch': 31, 'HR@5': '0.0874', 'NDCG@5': '0.0614', 'HR@10': '0.1216', 'NDCG@10': '0.0724', 'HR@20': '0.1634', 'NDCG@20': '0.0830'}
2025-02-26 17:33:38,465 - EarlyStopping counter: 1 out of 10
2025-02-26 17:34:07,940 - {'epoch': 32, 'rec_loss': '6.8027'}
2025-02-26 17:34:17,708 - {'Epoch': 32, 'HR@5': '0.0882', 'NDCG@5': '0.0617', 'HR@10': '0.1219', 'NDCG@10': '0.0726', 'HR@20': '0.1651', 'NDCG@20': '0.0835'}
2025-02-26 17:34:17,715 - EarlyStopping counter: 2 out of 10
2025-02-26 17:34:47,453 - {'epoch': 33, 'rec_loss': '6.7985'}
2025-02-26 17:34:57,101 - {'Epoch': 33, 'HR@5': '0.0883', 'NDCG@5': '0.0622', 'HR@10': '0.1239', 'NDCG@10': '0.0737', 'HR@20': '0.1664', 'NDCG@20': '0.0844'}
2025-02-26 17:34:57,102 - EarlyStopping counter: 3 out of 10
2025-02-26 17:35:26,621 - {'epoch': 34, 'rec_loss': '6.7838'}
2025-02-26 17:35:36,483 - {'Epoch': 34, 'HR@5': '0.0893', 'NDCG@5': '0.0627', 'HR@10': '0.1235', 'NDCG@10': '0.0737', 'HR@20': '0.1658', 'NDCG@20': '0.0843'}
2025-02-26 17:35:36,485 - EarlyStopping counter: 4 out of 10
2025-02-26 17:36:06,392 - {'epoch': 35, 'rec_loss': '6.7834'}
2025-02-26 17:36:16,204 - {'Epoch': 35, 'HR@5': '0.0879', 'NDCG@5': '0.0622', 'HR@10': '0.1212', 'NDCG@10': '0.0729', 'HR@20': '0.1650', 'NDCG@20': '0.0838'}
2025-02-26 17:36:16,210 - EarlyStopping counter: 5 out of 10
2025-02-26 17:36:48,561 - {'epoch': 36, 'rec_loss': '6.7750'}
2025-02-26 17:36:58,515 - {'Epoch': 36, 'HR@5': '0.0885', 'NDCG@5': '0.0620', 'HR@10': '0.1215', 'NDCG@10': '0.0726', 'HR@20': '0.1648', 'NDCG@20': '0.0836'}
2025-02-26 17:36:58,521 - EarlyStopping counter: 6 out of 10
2025-02-26 17:37:30,048 - {'epoch': 37, 'rec_loss': '6.7687'}
2025-02-26 17:37:39,419 - {'Epoch': 37, 'HR@5': '0.0892', 'NDCG@5': '0.0627', 'HR@10': '0.1234', 'NDCG@10': '0.0737', 'HR@20': '0.1666', 'NDCG@20': '0.0846'}
2025-02-26 17:37:39,421 - EarlyStopping counter: 7 out of 10
2025-02-26 17:38:10,026 - {'epoch': 38, 'rec_loss': '6.7621'}
2025-02-26 17:38:19,740 - {'Epoch': 38, 'HR@5': '0.0899', 'NDCG@5': '0.0625', 'HR@10': '0.1242', 'NDCG@10': '0.0736', 'HR@20': '0.1670', 'NDCG@20': '0.0843'}
2025-02-26 17:38:19,742 - EarlyStopping counter: 8 out of 10
2025-02-26 17:38:50,725 - {'epoch': 39, 'rec_loss': '6.7525'}
2025-02-26 17:39:00,937 - {'Epoch': 39, 'HR@5': '0.0889', 'NDCG@5': '0.0626', 'HR@10': '0.1226', 'NDCG@10': '0.0735', 'HR@20': '0.1658', 'NDCG@20': '0.0844'}
2025-02-26 17:39:00,943 - EarlyStopping counter: 9 out of 10
2025-02-26 17:39:31,387 - {'epoch': 40, 'rec_loss': '6.7454'}
2025-02-26 17:39:41,061 - {'Epoch': 40, 'HR@5': '0.0880', 'NDCG@5': '0.0621', 'HR@10': '0.1229', 'NDCG@10': '0.0734', 'HR@20': '0.1665', 'NDCG@20': '0.0844'}
2025-02-26 17:39:41,067 - EarlyStopping counter: 10 out of 10
2025-02-26 17:39:41,067 - Early stopping
2025-02-26 17:39:41,067 - ---------------Test Score---------------
2025-02-26 17:39:50,981 - {'Epoch': 0, 'HR@5': '0.0705', 'NDCG@5': '0.0492', 'HR@10': '0.0989', 'NDCG@10': '0.0583', 'HR@20': '0.1354', 'NDCG@20': '0.0675'}
2025-02-26 17:39:50,983 - Scale_Beauty
2025-02-26 17:39:50,983 - {'Epoch': 0, 'HR@5': '0.0705', 'NDCG@5': '0.0492', 'HR@10': '0.0989', 'NDCG@10': '0.0583', 'HR@20': '0.1354', 'NDCG@20': '0.0675'}
2025-02-27 13:35:33,402 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[2, 3, 4], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-27 13:35:36,298 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-27 13:35:36,303 - Total Parameters: 929445
2025-02-27 13:36:03,002 - {'epoch': 0, 'rec_loss': '8.8338'}
2025-02-27 13:36:11,118 - {'Epoch': 0, 'HR@5': '0.0192', 'NDCG@5': '0.0119', 'HR@10': '0.0303', 'NDCG@10': '0.0155', 'HR@20': '0.0468', 'NDCG@20': '0.0197'}
2025-02-27 13:36:11,119 - Validation score increased.  Saving model ...
2025-02-27 13:36:36,493 - {'epoch': 1, 'rec_loss': '8.3229'}
2025-02-27 13:36:45,048 - {'Epoch': 1, 'HR@5': '0.0374', 'NDCG@5': '0.0252', 'HR@10': '0.0562', 'NDCG@10': '0.0312', 'HR@20': '0.0820', 'NDCG@20': '0.0376'}
2025-02-27 13:36:45,049 - Validation score increased.  Saving model ...
2025-02-27 13:37:10,736 - {'epoch': 2, 'rec_loss': '8.0123'}
2025-02-27 13:37:18,742 - {'Epoch': 2, 'HR@5': '0.0489', 'NDCG@5': '0.0334', 'HR@10': '0.0721', 'NDCG@10': '0.0408', 'HR@20': '0.1033', 'NDCG@20': '0.0487'}
2025-02-27 13:37:18,744 - Validation score increased.  Saving model ...
2025-02-27 13:37:44,381 - {'epoch': 3, 'rec_loss': '7.7982'}
2025-02-27 13:37:52,398 - {'Epoch': 3, 'HR@5': '0.0595', 'NDCG@5': '0.0401', 'HR@10': '0.0866', 'NDCG@10': '0.0488', 'HR@20': '0.1226', 'NDCG@20': '0.0578'}
2025-02-27 13:37:52,404 - Validation score increased.  Saving model ...
2025-02-27 13:38:17,852 - {'epoch': 4, 'rec_loss': '7.6354'}
2025-02-27 13:38:25,349 - {'Epoch': 4, 'HR@5': '0.0677', 'NDCG@5': '0.0469', 'HR@10': '0.0955', 'NDCG@10': '0.0558', 'HR@20': '0.1319', 'NDCG@20': '0.0649'}
2025-02-27 13:38:25,351 - Validation score increased.  Saving model ...
2025-02-27 13:38:51,074 - {'epoch': 5, 'rec_loss': '7.5208'}
2025-02-27 13:38:59,093 - {'Epoch': 5, 'HR@5': '0.0719', 'NDCG@5': '0.0502', 'HR@10': '0.1017', 'NDCG@10': '0.0599', 'HR@20': '0.1392', 'NDCG@20': '0.0693'}
2025-02-27 13:38:59,094 - Validation score increased.  Saving model ...
2025-02-27 13:39:24,394 - {'epoch': 6, 'rec_loss': '7.4227'}
2025-02-27 13:39:32,611 - {'Epoch': 6, 'HR@5': '0.0756', 'NDCG@5': '0.0531', 'HR@10': '0.1049', 'NDCG@10': '0.0625', 'HR@20': '0.1456', 'NDCG@20': '0.0728'}
2025-02-27 13:39:32,612 - Validation score increased.  Saving model ...
2025-02-27 13:39:57,883 - {'epoch': 7, 'rec_loss': '7.3416'}
2025-02-27 13:40:06,549 - {'Epoch': 7, 'HR@5': '0.0796', 'NDCG@5': '0.0559', 'HR@10': '0.1095', 'NDCG@10': '0.0655', 'HR@20': '0.1482', 'NDCG@20': '0.0753'}
2025-02-27 13:40:06,551 - Validation score increased.  Saving model ...
2025-02-27 13:40:31,846 - {'epoch': 8, 'rec_loss': '7.2728'}
2025-02-27 13:40:40,080 - {'Epoch': 8, 'HR@5': '0.0817', 'NDCG@5': '0.0580', 'HR@10': '0.1113', 'NDCG@10': '0.0676', 'HR@20': '0.1506', 'NDCG@20': '0.0774'}
2025-02-27 13:40:40,081 - Validation score increased.  Saving model ...
2025-02-27 13:41:05,403 - {'epoch': 9, 'rec_loss': '7.2237'}
2025-02-27 13:41:13,354 - {'Epoch': 9, 'HR@5': '0.0821', 'NDCG@5': '0.0573', 'HR@10': '0.1139', 'NDCG@10': '0.0675', 'HR@20': '0.1524', 'NDCG@20': '0.0772'}
2025-02-27 13:41:13,355 - EarlyStopping counter: 1 out of 10
2025-02-27 13:41:38,921 - {'epoch': 10, 'rec_loss': '7.1758'}
2025-02-27 13:41:47,370 - {'Epoch': 10, 'HR@5': '0.0828', 'NDCG@5': '0.0586', 'HR@10': '0.1137', 'NDCG@10': '0.0686', 'HR@20': '0.1525', 'NDCG@20': '0.0783'}
2025-02-27 13:41:47,371 - Validation score increased.  Saving model ...
2025-02-27 13:42:13,213 - {'epoch': 11, 'rec_loss': '7.1384'}
2025-02-27 13:42:20,905 - {'Epoch': 11, 'HR@5': '0.0836', 'NDCG@5': '0.0595', 'HR@10': '0.1140', 'NDCG@10': '0.0693', 'HR@20': '0.1553', 'NDCG@20': '0.0798'}
2025-02-27 13:42:20,907 - Validation score increased.  Saving model ...
2025-02-27 13:42:46,499 - {'epoch': 12, 'rec_loss': '7.1013'}
2025-02-27 13:42:54,078 - {'Epoch': 12, 'HR@5': '0.0845', 'NDCG@5': '0.0598', 'HR@10': '0.1158', 'NDCG@10': '0.0698', 'HR@20': '0.1570', 'NDCG@20': '0.0802'}
2025-02-27 13:42:54,080 - Validation score increased.  Saving model ...
2025-02-27 13:43:19,466 - {'epoch': 13, 'rec_loss': '7.0765'}
2025-02-27 13:43:28,461 - {'Epoch': 13, 'HR@5': '0.0848', 'NDCG@5': '0.0595', 'HR@10': '0.1181', 'NDCG@10': '0.0702', 'HR@20': '0.1582', 'NDCG@20': '0.0802'}
2025-02-27 13:43:28,466 - Validation score increased.  Saving model ...
2025-02-27 13:43:55,459 - {'epoch': 14, 'rec_loss': '7.0476'}
2025-02-27 13:44:03,868 - {'Epoch': 14, 'HR@5': '0.0865', 'NDCG@5': '0.0603', 'HR@10': '0.1185', 'NDCG@10': '0.0707', 'HR@20': '0.1591', 'NDCG@20': '0.0809'}
2025-02-27 13:44:03,870 - Validation score increased.  Saving model ...
2025-02-27 13:44:29,199 - {'epoch': 15, 'rec_loss': '7.0280'}
2025-02-27 13:44:36,930 - {'Epoch': 15, 'HR@5': '0.0856', 'NDCG@5': '0.0603', 'HR@10': '0.1193', 'NDCG@10': '0.0711', 'HR@20': '0.1606', 'NDCG@20': '0.0815'}
2025-02-27 13:44:36,931 - Validation score increased.  Saving model ...
2025-02-27 13:45:03,702 - {'epoch': 16, 'rec_loss': '7.0062'}
2025-02-27 13:45:11,851 - {'Epoch': 16, 'HR@5': '0.0864', 'NDCG@5': '0.0608', 'HR@10': '0.1178', 'NDCG@10': '0.0709', 'HR@20': '0.1601', 'NDCG@20': '0.0815'}
2025-02-27 13:45:11,852 - Validation score increased.  Saving model ...
2025-02-27 13:45:37,282 - {'epoch': 17, 'rec_loss': '6.9897'}
2025-02-27 13:45:45,501 - {'Epoch': 17, 'HR@5': '0.0854', 'NDCG@5': '0.0603', 'HR@10': '0.1180', 'NDCG@10': '0.0708', 'HR@20': '0.1605', 'NDCG@20': '0.0815'}
2025-02-27 13:45:45,502 - EarlyStopping counter: 1 out of 10
2025-02-27 13:46:11,697 - {'epoch': 18, 'rec_loss': '6.9593'}
2025-02-27 13:46:20,413 - {'Epoch': 18, 'HR@5': '0.0874', 'NDCG@5': '0.0613', 'HR@10': '0.1182', 'NDCG@10': '0.0712', 'HR@20': '0.1612', 'NDCG@20': '0.0820'}
2025-02-27 13:46:20,415 - Validation score increased.  Saving model ...
2025-02-27 13:46:45,841 - {'epoch': 19, 'rec_loss': '6.9476'}
2025-02-27 13:46:54,266 - {'Epoch': 19, 'HR@5': '0.0870', 'NDCG@5': '0.0616', 'HR@10': '0.1182', 'NDCG@10': '0.0717', 'HR@20': '0.1620', 'NDCG@20': '0.0827'}
2025-02-27 13:46:54,267 - Validation score increased.  Saving model ...
2025-02-27 13:47:19,651 - {'epoch': 20, 'rec_loss': '6.9263'}
2025-02-27 13:47:27,976 - {'Epoch': 20, 'HR@5': '0.0867', 'NDCG@5': '0.0613', 'HR@10': '0.1206', 'NDCG@10': '0.0723', 'HR@20': '0.1633', 'NDCG@20': '0.0830'}
2025-02-27 13:47:27,977 - Validation score increased.  Saving model ...
2025-02-27 13:47:53,550 - {'epoch': 21, 'rec_loss': '6.9195'}
2025-02-27 13:48:01,394 - {'Epoch': 21, 'HR@5': '0.0871', 'NDCG@5': '0.0610', 'HR@10': '0.1193', 'NDCG@10': '0.0714', 'HR@20': '0.1640', 'NDCG@20': '0.0826'}
2025-02-27 13:48:01,395 - EarlyStopping counter: 1 out of 10
2025-02-27 13:48:26,733 - {'epoch': 22, 'rec_loss': '6.9075'}
2025-02-27 13:48:35,489 - {'Epoch': 22, 'HR@5': '0.0878', 'NDCG@5': '0.0620', 'HR@10': '0.1205', 'NDCG@10': '0.0725', 'HR@20': '0.1634', 'NDCG@20': '0.0833'}
2025-02-27 13:48:35,490 - Validation score increased.  Saving model ...
2025-02-27 13:49:01,042 - {'epoch': 23, 'rec_loss': '6.8924'}
2025-02-27 13:49:09,505 - {'Epoch': 23, 'HR@5': '0.0868', 'NDCG@5': '0.0621', 'HR@10': '0.1205', 'NDCG@10': '0.0729', 'HR@20': '0.1633', 'NDCG@20': '0.0837'}
2025-02-27 13:49:09,510 - Validation score increased.  Saving model ...
2025-02-27 13:49:34,987 - {'epoch': 24, 'rec_loss': '6.8838'}
2025-02-27 13:49:42,880 - {'Epoch': 24, 'HR@5': '0.0863', 'NDCG@5': '0.0612', 'HR@10': '0.1198', 'NDCG@10': '0.0720', 'HR@20': '0.1625', 'NDCG@20': '0.0828'}
2025-02-27 13:49:42,881 - EarlyStopping counter: 1 out of 10
2025-02-27 13:50:09,025 - {'epoch': 25, 'rec_loss': '6.8643'}
2025-02-27 13:50:16,961 - {'Epoch': 25, 'HR@5': '0.0868', 'NDCG@5': '0.0613', 'HR@10': '0.1201', 'NDCG@10': '0.0721', 'HR@20': '0.1640', 'NDCG@20': '0.0832'}
2025-02-27 13:50:16,962 - EarlyStopping counter: 2 out of 10
2025-02-27 13:50:42,837 - {'epoch': 26, 'rec_loss': '6.8599'}
2025-02-27 13:50:50,658 - {'Epoch': 26, 'HR@5': '0.0884', 'NDCG@5': '0.0623', 'HR@10': '0.1219', 'NDCG@10': '0.0731', 'HR@20': '0.1632', 'NDCG@20': '0.0835'}
2025-02-27 13:50:50,660 - EarlyStopping counter: 3 out of 10
2025-02-27 13:51:16,227 - {'epoch': 27, 'rec_loss': '6.8433'}
2025-02-27 13:51:24,701 - {'Epoch': 27, 'HR@5': '0.0872', 'NDCG@5': '0.0618', 'HR@10': '0.1198', 'NDCG@10': '0.0723', 'HR@20': '0.1619', 'NDCG@20': '0.0829'}
2025-02-27 13:51:24,703 - EarlyStopping counter: 4 out of 10
2025-02-27 13:51:50,293 - {'epoch': 28, 'rec_loss': '6.8401'}
2025-02-27 13:51:58,160 - {'Epoch': 28, 'HR@5': '0.0874', 'NDCG@5': '0.0615', 'HR@10': '0.1207', 'NDCG@10': '0.0723', 'HR@20': '0.1631', 'NDCG@20': '0.0829'}
2025-02-27 13:51:58,161 - EarlyStopping counter: 5 out of 10
2025-02-27 13:52:24,047 - {'epoch': 29, 'rec_loss': '6.8321'}
2025-02-27 13:52:32,148 - {'Epoch': 29, 'HR@5': '0.0861', 'NDCG@5': '0.0610', 'HR@10': '0.1214', 'NDCG@10': '0.0724', 'HR@20': '0.1634', 'NDCG@20': '0.0829'}
2025-02-27 13:52:32,149 - EarlyStopping counter: 6 out of 10
2025-02-27 13:52:58,839 - {'epoch': 30, 'rec_loss': '6.8210'}
2025-02-27 13:53:06,808 - {'Epoch': 30, 'HR@5': '0.0873', 'NDCG@5': '0.0621', 'HR@10': '0.1204', 'NDCG@10': '0.0728', 'HR@20': '0.1662', 'NDCG@20': '0.0843'}
2025-02-27 13:53:06,809 - Validation score increased.  Saving model ...
2025-02-27 13:53:33,784 - {'epoch': 31, 'rec_loss': '6.8071'}
2025-02-27 13:53:42,300 - {'Epoch': 31, 'HR@5': '0.0877', 'NDCG@5': '0.0624', 'HR@10': '0.1206', 'NDCG@10': '0.0730', 'HR@20': '0.1645', 'NDCG@20': '0.0841'}
2025-02-27 13:53:42,301 - EarlyStopping counter: 1 out of 10
2025-02-27 13:54:08,735 - {'epoch': 32, 'rec_loss': '6.8049'}
2025-02-27 13:54:16,988 - {'Epoch': 32, 'HR@5': '0.0873', 'NDCG@5': '0.0621', 'HR@10': '0.1202', 'NDCG@10': '0.0727', 'HR@20': '0.1646', 'NDCG@20': '0.0838'}
2025-02-27 13:54:16,990 - EarlyStopping counter: 2 out of 10
2025-02-27 13:54:44,062 - {'epoch': 33, 'rec_loss': '6.8000'}
2025-02-27 13:54:52,766 - {'Epoch': 33, 'HR@5': '0.0880', 'NDCG@5': '0.0625', 'HR@10': '0.1187', 'NDCG@10': '0.0724', 'HR@20': '0.1629', 'NDCG@20': '0.0836'}
2025-02-27 13:54:52,768 - EarlyStopping counter: 3 out of 10
2025-02-27 13:55:18,974 - {'epoch': 34, 'rec_loss': '6.7843'}
2025-02-27 13:55:27,394 - {'Epoch': 34, 'HR@5': '0.0885', 'NDCG@5': '0.0624', 'HR@10': '0.1206', 'NDCG@10': '0.0727', 'HR@20': '0.1630', 'NDCG@20': '0.0833'}
2025-02-27 13:55:27,395 - EarlyStopping counter: 4 out of 10
2025-02-27 13:55:53,096 - {'epoch': 35, 'rec_loss': '6.7805'}
2025-02-27 13:56:01,460 - {'Epoch': 35, 'HR@5': '0.0867', 'NDCG@5': '0.0610', 'HR@10': '0.1195', 'NDCG@10': '0.0716', 'HR@20': '0.1629', 'NDCG@20': '0.0825'}
2025-02-27 13:56:01,461 - EarlyStopping counter: 5 out of 10
2025-02-27 13:56:27,799 - {'epoch': 36, 'rec_loss': '6.7727'}
2025-02-27 13:56:36,029 - {'Epoch': 36, 'HR@5': '0.0877', 'NDCG@5': '0.0625', 'HR@10': '0.1219', 'NDCG@10': '0.0735', 'HR@20': '0.1634', 'NDCG@20': '0.0839'}
2025-02-27 13:56:36,031 - EarlyStopping counter: 6 out of 10
2025-02-27 13:57:02,121 - {'epoch': 37, 'rec_loss': '6.7579'}
2025-02-27 13:57:09,764 - {'Epoch': 37, 'HR@5': '0.0869', 'NDCG@5': '0.0610', 'HR@10': '0.1203', 'NDCG@10': '0.0718', 'HR@20': '0.1656', 'NDCG@20': '0.0832'}
2025-02-27 13:57:09,765 - EarlyStopping counter: 7 out of 10
2025-02-27 13:57:35,894 - {'epoch': 38, 'rec_loss': '6.7582'}
2025-02-27 13:57:43,477 - {'Epoch': 38, 'HR@5': '0.0858', 'NDCG@5': '0.0608', 'HR@10': '0.1203', 'NDCG@10': '0.0718', 'HR@20': '0.1641', 'NDCG@20': '0.0829'}
2025-02-27 13:57:43,478 - EarlyStopping counter: 8 out of 10
2025-02-27 13:58:09,754 - {'epoch': 39, 'rec_loss': '6.7515'}
2025-02-27 13:58:17,412 - {'Epoch': 39, 'HR@5': '0.0858', 'NDCG@5': '0.0606', 'HR@10': '0.1181', 'NDCG@10': '0.0710', 'HR@20': '0.1624', 'NDCG@20': '0.0821'}
2025-02-27 13:58:17,414 - EarlyStopping counter: 9 out of 10
2025-02-27 13:58:43,520 - {'epoch': 40, 'rec_loss': '6.7530'}
2025-02-27 13:58:51,923 - {'Epoch': 40, 'HR@5': '0.0861', 'NDCG@5': '0.0617', 'HR@10': '0.1195', 'NDCG@10': '0.0725', 'HR@20': '0.1646', 'NDCG@20': '0.0839'}
2025-02-27 13:58:51,924 - EarlyStopping counter: 10 out of 10
2025-02-27 13:58:51,925 - Early stopping
2025-02-27 13:58:51,925 - ---------------Test Score---------------
2025-02-27 13:58:59,727 - {'Epoch': 0, 'HR@5': '0.0709', 'NDCG@5': '0.0500', 'HR@10': '0.0978', 'NDCG@10': '0.0586', 'HR@20': '0.1353', 'NDCG@20': '0.0681'}
2025-02-27 13:58:59,728 - Scale_Beauty
2025-02-27 13:58:59,728 - {'Epoch': 0, 'HR@5': '0.0709', 'NDCG@5': '0.0500', 'HR@10': '0.0978', 'NDCG@10': '0.0586', 'HR@20': '0.1353', 'NDCG@20': '0.0681'}
2025-02-27 14:05:25,369 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[2, 4, 6], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-27 14:05:28,364 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-27 14:05:28,369 - Total Parameters: 929445
2025-02-27 14:05:56,296 - {'epoch': 0, 'rec_loss': '8.8323'}
2025-02-27 14:06:05,355 - {'Epoch': 0, 'HR@5': '0.0190', 'NDCG@5': '0.0119', 'HR@10': '0.0302', 'NDCG@10': '0.0155', 'HR@20': '0.0465', 'NDCG@20': '0.0196'}
2025-02-27 14:06:05,357 - Validation score increased.  Saving model ...
2025-02-27 14:06:31,163 - {'epoch': 1, 'rec_loss': '8.3249'}
2025-02-27 14:06:39,636 - {'Epoch': 1, 'HR@5': '0.0370', 'NDCG@5': '0.0251', 'HR@10': '0.0560', 'NDCG@10': '0.0312', 'HR@20': '0.0817', 'NDCG@20': '0.0377'}
2025-02-27 14:06:39,637 - Validation score increased.  Saving model ...
2025-02-27 14:07:06,430 - {'epoch': 2, 'rec_loss': '8.0137'}
2025-02-27 14:07:14,857 - {'Epoch': 2, 'HR@5': '0.0488', 'NDCG@5': '0.0335', 'HR@10': '0.0720', 'NDCG@10': '0.0409', 'HR@20': '0.1033', 'NDCG@20': '0.0488'}
2025-02-27 14:07:14,859 - Validation score increased.  Saving model ...
2025-02-27 14:07:40,813 - {'epoch': 3, 'rec_loss': '7.7982'}
2025-02-27 14:07:48,459 - {'Epoch': 3, 'HR@5': '0.0594', 'NDCG@5': '0.0402', 'HR@10': '0.0861', 'NDCG@10': '0.0488', 'HR@20': '0.1231', 'NDCG@20': '0.0582'}
2025-02-27 14:07:48,460 - Validation score increased.  Saving model ...
2025-02-27 14:08:14,101 - {'epoch': 4, 'rec_loss': '7.6343'}
2025-02-27 14:08:22,251 - {'Epoch': 4, 'HR@5': '0.0674', 'NDCG@5': '0.0468', 'HR@10': '0.0959', 'NDCG@10': '0.0559', 'HR@20': '0.1320', 'NDCG@20': '0.0650'}
2025-02-27 14:08:22,252 - Validation score increased.  Saving model ...
2025-02-27 14:08:48,204 - {'epoch': 5, 'rec_loss': '7.5196'}
2025-02-27 14:08:55,978 - {'Epoch': 5, 'HR@5': '0.0728', 'NDCG@5': '0.0509', 'HR@10': '0.1022', 'NDCG@10': '0.0604', 'HR@20': '0.1397', 'NDCG@20': '0.0698'}
2025-02-27 14:08:55,979 - Validation score increased.  Saving model ...
2025-02-27 14:09:21,835 - {'epoch': 6, 'rec_loss': '7.4212'}
2025-02-27 14:09:30,049 - {'Epoch': 6, 'HR@5': '0.0756', 'NDCG@5': '0.0531', 'HR@10': '0.1056', 'NDCG@10': '0.0628', 'HR@20': '0.1468', 'NDCG@20': '0.0731'}
2025-02-27 14:09:30,050 - Validation score increased.  Saving model ...
2025-02-27 14:09:56,745 - {'epoch': 7, 'rec_loss': '7.3403'}
2025-02-27 14:10:05,494 - {'Epoch': 7, 'HR@5': '0.0797', 'NDCG@5': '0.0561', 'HR@10': '0.1094', 'NDCG@10': '0.0657', 'HR@20': '0.1490', 'NDCG@20': '0.0756'}
2025-02-27 14:10:05,496 - Validation score increased.  Saving model ...
2025-02-27 14:10:31,299 - {'epoch': 8, 'rec_loss': '7.2713'}
2025-02-27 14:10:39,832 - {'Epoch': 8, 'HR@5': '0.0824', 'NDCG@5': '0.0582', 'HR@10': '0.1108', 'NDCG@10': '0.0673', 'HR@20': '0.1511', 'NDCG@20': '0.0775'}
2025-02-27 14:10:39,833 - Validation score increased.  Saving model ...
2025-02-27 14:11:05,339 - {'epoch': 9, 'rec_loss': '7.2227'}
2025-02-27 14:11:13,552 - {'Epoch': 9, 'HR@5': '0.0821', 'NDCG@5': '0.0572', 'HR@10': '0.1134', 'NDCG@10': '0.0674', 'HR@20': '0.1518', 'NDCG@20': '0.0770'}
2025-02-27 14:11:13,553 - EarlyStopping counter: 1 out of 10
2025-02-27 14:11:39,353 - {'epoch': 10, 'rec_loss': '7.1749'}
2025-02-27 14:11:47,828 - {'Epoch': 10, 'HR@5': '0.0829', 'NDCG@5': '0.0586', 'HR@10': '0.1144', 'NDCG@10': '0.0688', 'HR@20': '0.1527', 'NDCG@20': '0.0784'}
2025-02-27 14:11:47,829 - Validation score increased.  Saving model ...
2025-02-27 14:12:13,804 - {'epoch': 11, 'rec_loss': '7.1372'}
2025-02-27 14:12:22,900 - {'Epoch': 11, 'HR@5': '0.0843', 'NDCG@5': '0.0600', 'HR@10': '0.1139', 'NDCG@10': '0.0696', 'HR@20': '0.1547', 'NDCG@20': '0.0798'}
2025-02-27 14:12:22,902 - Validation score increased.  Saving model ...
2025-02-27 14:12:49,722 - {'epoch': 12, 'rec_loss': '7.1006'}
2025-02-27 14:12:57,857 - {'Epoch': 12, 'HR@5': '0.0846', 'NDCG@5': '0.0598', 'HR@10': '0.1163', 'NDCG@10': '0.0700', 'HR@20': '0.1573', 'NDCG@20': '0.0803'}
2025-02-27 14:12:57,858 - Validation score increased.  Saving model ...
2025-02-27 14:13:24,320 - {'epoch': 13, 'rec_loss': '7.0754'}
2025-02-27 14:13:32,798 - {'Epoch': 13, 'HR@5': '0.0850', 'NDCG@5': '0.0597', 'HR@10': '0.1183', 'NDCG@10': '0.0704', 'HR@20': '0.1579', 'NDCG@20': '0.0804'}
2025-02-27 14:13:32,800 - Validation score increased.  Saving model ...
2025-02-27 14:13:59,780 - {'epoch': 14, 'rec_loss': '7.0458'}
2025-02-27 14:14:08,131 - {'Epoch': 14, 'HR@5': '0.0868', 'NDCG@5': '0.0607', 'HR@10': '0.1186', 'NDCG@10': '0.0710', 'HR@20': '0.1593', 'NDCG@20': '0.0812'}
2025-02-27 14:14:08,132 - Validation score increased.  Saving model ...
2025-02-27 14:14:34,264 - {'epoch': 15, 'rec_loss': '7.0263'}
2025-02-27 14:14:42,122 - {'Epoch': 15, 'HR@5': '0.0859', 'NDCG@5': '0.0605', 'HR@10': '0.1187', 'NDCG@10': '0.0710', 'HR@20': '0.1606', 'NDCG@20': '0.0816'}
2025-02-27 14:14:42,124 - Validation score increased.  Saving model ...
2025-02-27 14:15:09,674 - {'epoch': 16, 'rec_loss': '7.0046'}
2025-02-27 14:15:18,445 - {'Epoch': 16, 'HR@5': '0.0867', 'NDCG@5': '0.0607', 'HR@10': '0.1177', 'NDCG@10': '0.0707', 'HR@20': '0.1611', 'NDCG@20': '0.0816'}
2025-02-27 14:15:18,453 - EarlyStopping counter: 1 out of 10
2025-02-27 14:15:45,172 - {'epoch': 17, 'rec_loss': '6.9881'}
2025-02-27 14:15:53,252 - {'Epoch': 17, 'HR@5': '0.0858', 'NDCG@5': '0.0606', 'HR@10': '0.1183', 'NDCG@10': '0.0710', 'HR@20': '0.1601', 'NDCG@20': '0.0815'}
2025-02-27 14:15:53,254 - EarlyStopping counter: 2 out of 10
2025-02-27 14:16:19,683 - {'epoch': 18, 'rec_loss': '6.9580'}
2025-02-27 14:16:27,828 - {'Epoch': 18, 'HR@5': '0.0876', 'NDCG@5': '0.0613', 'HR@10': '0.1186', 'NDCG@10': '0.0713', 'HR@20': '0.1612', 'NDCG@20': '0.0820'}
2025-02-27 14:16:27,830 - Validation score increased.  Saving model ...
2025-02-27 14:16:55,282 - {'epoch': 19, 'rec_loss': '6.9460'}
2025-02-27 14:17:03,633 - {'Epoch': 19, 'HR@5': '0.0870', 'NDCG@5': '0.0616', 'HR@10': '0.1188', 'NDCG@10': '0.0718', 'HR@20': '0.1622', 'NDCG@20': '0.0827'}
2025-02-27 14:17:03,634 - Validation score increased.  Saving model ...
2025-02-27 14:17:30,567 - {'epoch': 20, 'rec_loss': '6.9250'}
2025-02-27 14:17:39,313 - {'Epoch': 20, 'HR@5': '0.0864', 'NDCG@5': '0.0613', 'HR@10': '0.1203', 'NDCG@10': '0.0723', 'HR@20': '0.1633', 'NDCG@20': '0.0831'}
2025-02-27 14:17:39,314 - Validation score increased.  Saving model ...
2025-02-27 14:18:06,760 - {'epoch': 21, 'rec_loss': '6.9175'}
2025-02-27 14:18:15,465 - {'Epoch': 21, 'HR@5': '0.0880', 'NDCG@5': '0.0616', 'HR@10': '0.1208', 'NDCG@10': '0.0721', 'HR@20': '0.1625', 'NDCG@20': '0.0825'}
2025-02-27 14:18:15,467 - EarlyStopping counter: 1 out of 10
2025-02-27 14:18:41,410 - {'epoch': 22, 'rec_loss': '6.9061'}
2025-02-27 14:18:49,278 - {'Epoch': 22, 'HR@5': '0.0872', 'NDCG@5': '0.0623', 'HR@10': '0.1210', 'NDCG@10': '0.0732', 'HR@20': '0.1633', 'NDCG@20': '0.0838'}
2025-02-27 14:18:49,283 - Validation score increased.  Saving model ...
2025-02-27 14:19:16,237 - {'epoch': 23, 'rec_loss': '6.8907'}
2025-02-27 14:19:24,013 - {'Epoch': 23, 'HR@5': '0.0872', 'NDCG@5': '0.0624', 'HR@10': '0.1205', 'NDCG@10': '0.0731', 'HR@20': '0.1633', 'NDCG@20': '0.0839'}
2025-02-27 14:19:24,015 - Validation score increased.  Saving model ...
2025-02-27 14:19:51,718 - {'epoch': 24, 'rec_loss': '6.8829'}
2025-02-27 14:19:59,696 - {'Epoch': 24, 'HR@5': '0.0868', 'NDCG@5': '0.0616', 'HR@10': '0.1203', 'NDCG@10': '0.0723', 'HR@20': '0.1629', 'NDCG@20': '0.0831'}
2025-02-27 14:19:59,697 - EarlyStopping counter: 1 out of 10
2025-02-27 14:20:27,055 - {'epoch': 25, 'rec_loss': '6.8627'}
2025-02-27 14:20:35,107 - {'Epoch': 25, 'HR@5': '0.0868', 'NDCG@5': '0.0614', 'HR@10': '0.1204', 'NDCG@10': '0.0723', 'HR@20': '0.1639', 'NDCG@20': '0.0833'}
2025-02-27 14:20:35,108 - EarlyStopping counter: 2 out of 10
2025-02-27 14:21:02,046 - {'epoch': 26, 'rec_loss': '6.8589'}
2025-02-27 14:21:09,727 - {'Epoch': 26, 'HR@5': '0.0888', 'NDCG@5': '0.0626', 'HR@10': '0.1217', 'NDCG@10': '0.0732', 'HR@20': '0.1629', 'NDCG@20': '0.0835'}
2025-02-27 14:21:09,729 - EarlyStopping counter: 3 out of 10
2025-02-27 14:21:36,594 - {'epoch': 27, 'rec_loss': '6.8425'}
2025-02-27 14:21:44,186 - {'Epoch': 27, 'HR@5': '0.0874', 'NDCG@5': '0.0622', 'HR@10': '0.1203', 'NDCG@10': '0.0728', 'HR@20': '0.1628', 'NDCG@20': '0.0835'}
2025-02-27 14:21:44,187 - EarlyStopping counter: 4 out of 10
2025-02-27 14:22:11,188 - {'epoch': 28, 'rec_loss': '6.8392'}
2025-02-27 14:22:19,328 - {'Epoch': 28, 'HR@5': '0.0880', 'NDCG@5': '0.0619', 'HR@10': '0.1216', 'NDCG@10': '0.0727', 'HR@20': '0.1626', 'NDCG@20': '0.0830'}
2025-02-27 14:22:19,329 - EarlyStopping counter: 5 out of 10
2025-02-27 14:22:46,634 - {'epoch': 29, 'rec_loss': '6.8308'}
2025-02-27 14:22:54,644 - {'Epoch': 29, 'HR@5': '0.0869', 'NDCG@5': '0.0613', 'HR@10': '0.1218', 'NDCG@10': '0.0725', 'HR@20': '0.1629', 'NDCG@20': '0.0828'}
2025-02-27 14:22:54,646 - EarlyStopping counter: 6 out of 10
2025-02-27 14:23:21,546 - {'epoch': 30, 'rec_loss': '6.8201'}
2025-02-27 14:23:29,536 - {'Epoch': 30, 'HR@5': '0.0878', 'NDCG@5': '0.0623', 'HR@10': '0.1208', 'NDCG@10': '0.0729', 'HR@20': '0.1648', 'NDCG@20': '0.0840'}
2025-02-27 14:23:29,537 - Validation score increased.  Saving model ...
2025-02-27 14:23:57,833 - {'epoch': 31, 'rec_loss': '6.8057'}
2025-02-27 14:24:05,720 - {'Epoch': 31, 'HR@5': '0.0882', 'NDCG@5': '0.0628', 'HR@10': '0.1205', 'NDCG@10': '0.0732', 'HR@20': '0.1643', 'NDCG@20': '0.0843'}
2025-02-27 14:24:05,722 - Validation score increased.  Saving model ...
2025-02-27 14:24:33,879 - {'epoch': 32, 'rec_loss': '6.8039'}
2025-02-27 14:24:41,700 - {'Epoch': 32, 'HR@5': '0.0879', 'NDCG@5': '0.0622', 'HR@10': '0.1210', 'NDCG@10': '0.0729', 'HR@20': '0.1640', 'NDCG@20': '0.0837'}
2025-02-27 14:24:41,702 - EarlyStopping counter: 1 out of 10
2025-02-27 14:25:09,800 - {'epoch': 33, 'rec_loss': '6.7990'}
2025-02-27 14:25:17,698 - {'Epoch': 33, 'HR@5': '0.0885', 'NDCG@5': '0.0627', 'HR@10': '0.1195', 'NDCG@10': '0.0727', 'HR@20': '0.1630', 'NDCG@20': '0.0837'}
2025-02-27 14:25:17,699 - EarlyStopping counter: 2 out of 10
2025-02-27 14:25:45,936 - {'epoch': 34, 'rec_loss': '6.7833'}
2025-02-27 14:25:54,363 - {'Epoch': 34, 'HR@5': '0.0880', 'NDCG@5': '0.0621', 'HR@10': '0.1199', 'NDCG@10': '0.0723', 'HR@20': '0.1629', 'NDCG@20': '0.0831'}
2025-02-27 14:25:54,364 - EarlyStopping counter: 3 out of 10
2025-02-27 14:26:21,751 - {'epoch': 35, 'rec_loss': '6.7790'}
2025-02-27 14:26:29,301 - {'Epoch': 35, 'HR@5': '0.0869', 'NDCG@5': '0.0611', 'HR@10': '0.1193', 'NDCG@10': '0.0715', 'HR@20': '0.1636', 'NDCG@20': '0.0827'}
2025-02-27 14:26:29,302 - EarlyStopping counter: 4 out of 10
2025-02-27 14:26:58,292 - {'epoch': 36, 'rec_loss': '6.7715'}
2025-02-27 14:27:06,262 - {'Epoch': 36, 'HR@5': '0.0875', 'NDCG@5': '0.0625', 'HR@10': '0.1215', 'NDCG@10': '0.0734', 'HR@20': '0.1639', 'NDCG@20': '0.0841'}
2025-02-27 14:27:06,263 - EarlyStopping counter: 5 out of 10
2025-02-27 14:27:33,862 - {'epoch': 37, 'rec_loss': '6.7569'}
2025-02-27 14:27:41,957 - {'Epoch': 37, 'HR@5': '0.0870', 'NDCG@5': '0.0614', 'HR@10': '0.1202', 'NDCG@10': '0.0721', 'HR@20': '0.1656', 'NDCG@20': '0.0835'}
2025-02-27 14:27:41,958 - EarlyStopping counter: 6 out of 10
2025-02-27 14:28:10,010 - {'epoch': 38, 'rec_loss': '6.7574'}
2025-02-27 14:28:17,950 - {'Epoch': 38, 'HR@5': '0.0864', 'NDCG@5': '0.0613', 'HR@10': '0.1211', 'NDCG@10': '0.0724', 'HR@20': '0.1641', 'NDCG@20': '0.0833'}
2025-02-27 14:28:17,952 - EarlyStopping counter: 7 out of 10
2025-02-27 14:28:45,734 - {'epoch': 39, 'rec_loss': '6.7510'}
2025-02-27 14:28:53,578 - {'Epoch': 39, 'HR@5': '0.0859', 'NDCG@5': '0.0607', 'HR@10': '0.1176', 'NDCG@10': '0.0709', 'HR@20': '0.1612', 'NDCG@20': '0.0819'}
2025-02-27 14:28:53,579 - EarlyStopping counter: 8 out of 10
2025-02-27 14:29:21,466 - {'epoch': 40, 'rec_loss': '6.7519'}
2025-02-27 14:29:29,362 - {'Epoch': 40, 'HR@5': '0.0866', 'NDCG@5': '0.0615', 'HR@10': '0.1203', 'NDCG@10': '0.0723', 'HR@20': '0.1640', 'NDCG@20': '0.0833'}
2025-02-27 14:29:29,363 - EarlyStopping counter: 9 out of 10
2025-02-27 14:29:57,112 - {'epoch': 41, 'rec_loss': '6.7391'}
2025-02-27 14:30:04,945 - {'Epoch': 41, 'HR@5': '0.0881', 'NDCG@5': '0.0628', 'HR@10': '0.1193', 'NDCG@10': '0.0728', 'HR@20': '0.1646', 'NDCG@20': '0.0842'}
2025-02-27 14:30:04,946 - EarlyStopping counter: 10 out of 10
2025-02-27 14:30:04,946 - Early stopping
2025-02-27 14:30:04,946 - ---------------Test Score---------------
2025-02-27 14:30:12,919 - {'Epoch': 0, 'HR@5': '0.0724', 'NDCG@5': '0.0502', 'HR@10': '0.1007', 'NDCG@10': '0.0593', 'HR@20': '0.1375', 'NDCG@20': '0.0686'}
2025-02-27 14:30:12,920 - Scale_Beauty
2025-02-27 14:30:12,920 - {'Epoch': 0, 'HR@5': '0.0724', 'NDCG@5': '0.0502', 'HR@10': '0.1007', 'NDCG@10': '0.0593', 'HR@20': '0.1375', 'NDCG@20': '0.0686'}
2025-02-27 14:34:17,869 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 6, 8], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-27 14:34:20,709 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-27 14:34:20,714 - Total Parameters: 929445
2025-02-27 14:34:49,733 - {'epoch': 0, 'rec_loss': '8.8321'}
2025-02-27 14:34:58,045 - {'Epoch': 0, 'HR@5': '0.0188', 'NDCG@5': '0.0118', 'HR@10': '0.0303', 'NDCG@10': '0.0155', 'HR@20': '0.0467', 'NDCG@20': '0.0196'}
2025-02-27 14:34:58,047 - Validation score increased.  Saving model ...
2025-02-27 14:35:25,225 - {'epoch': 1, 'rec_loss': '8.3256'}
2025-02-27 14:35:33,532 - {'Epoch': 1, 'HR@5': '0.0374', 'NDCG@5': '0.0251', 'HR@10': '0.0558', 'NDCG@10': '0.0310', 'HR@20': '0.0817', 'NDCG@20': '0.0375'}
2025-02-27 14:35:33,534 - Validation score increased.  Saving model ...
2025-02-27 14:36:01,772 - {'epoch': 2, 'rec_loss': '8.0140'}
2025-02-27 14:36:09,654 - {'Epoch': 2, 'HR@5': '0.0491', 'NDCG@5': '0.0335', 'HR@10': '0.0719', 'NDCG@10': '0.0408', 'HR@20': '0.1035', 'NDCG@20': '0.0488'}
2025-02-27 14:36:09,655 - Validation score increased.  Saving model ...
2025-02-27 14:36:38,647 - {'epoch': 3, 'rec_loss': '7.7981'}
2025-02-27 14:36:46,557 - {'Epoch': 3, 'HR@5': '0.0586', 'NDCG@5': '0.0400', 'HR@10': '0.0862', 'NDCG@10': '0.0488', 'HR@20': '0.1235', 'NDCG@20': '0.0583'}
2025-02-27 14:36:46,558 - Validation score increased.  Saving model ...
2025-02-27 14:37:14,498 - {'epoch': 4, 'rec_loss': '7.6346'}
2025-02-27 14:37:22,498 - {'Epoch': 4, 'HR@5': '0.0679', 'NDCG@5': '0.0470', 'HR@10': '0.0960', 'NDCG@10': '0.0560', 'HR@20': '0.1319', 'NDCG@20': '0.0650'}
2025-02-27 14:37:22,500 - Validation score increased.  Saving model ...
2025-02-27 14:37:50,401 - {'epoch': 5, 'rec_loss': '7.5194'}
2025-02-27 14:37:58,422 - {'Epoch': 5, 'HR@5': '0.0730', 'NDCG@5': '0.0511', 'HR@10': '0.1028', 'NDCG@10': '0.0607', 'HR@20': '0.1397', 'NDCG@20': '0.0699'}
2025-02-27 14:37:58,423 - Validation score increased.  Saving model ...
2025-02-27 14:38:25,901 - {'epoch': 6, 'rec_loss': '7.4215'}
2025-02-27 14:38:34,004 - {'Epoch': 6, 'HR@5': '0.0757', 'NDCG@5': '0.0533', 'HR@10': '0.1053', 'NDCG@10': '0.0628', 'HR@20': '0.1459', 'NDCG@20': '0.0730'}
2025-02-27 14:38:34,011 - Validation score increased.  Saving model ...
2025-02-27 14:39:02,101 - {'epoch': 7, 'rec_loss': '7.3411'}
2025-02-27 14:39:10,400 - {'Epoch': 7, 'HR@5': '0.0800', 'NDCG@5': '0.0561', 'HR@10': '0.1092', 'NDCG@10': '0.0655', 'HR@20': '0.1490', 'NDCG@20': '0.0755'}
2025-02-27 14:39:10,402 - Validation score increased.  Saving model ...
2025-02-27 14:39:40,034 - {'epoch': 8, 'rec_loss': '7.2717'}
2025-02-27 14:39:47,999 - {'Epoch': 8, 'HR@5': '0.0820', 'NDCG@5': '0.0579', 'HR@10': '0.1114', 'NDCG@10': '0.0674', 'HR@20': '0.1504', 'NDCG@20': '0.0772'}
2025-02-27 14:39:48,000 - Validation score increased.  Saving model ...
2025-02-27 14:40:16,271 - {'epoch': 9, 'rec_loss': '7.2233'}
2025-02-27 14:40:24,399 - {'Epoch': 9, 'HR@5': '0.0817', 'NDCG@5': '0.0572', 'HR@10': '0.1132', 'NDCG@10': '0.0673', 'HR@20': '0.1521', 'NDCG@20': '0.0771'}
2025-02-27 14:40:24,400 - EarlyStopping counter: 1 out of 10
2025-02-27 14:40:51,238 - {'epoch': 10, 'rec_loss': '7.1755'}
2025-02-27 14:40:59,509 - {'Epoch': 10, 'HR@5': '0.0829', 'NDCG@5': '0.0586', 'HR@10': '0.1139', 'NDCG@10': '0.0686', 'HR@20': '0.1521', 'NDCG@20': '0.0781'}
2025-02-27 14:40:59,511 - Validation score increased.  Saving model ...
2025-02-27 14:41:28,121 - {'epoch': 11, 'rec_loss': '7.1377'}
2025-02-27 14:41:36,055 - {'Epoch': 11, 'HR@5': '0.0844', 'NDCG@5': '0.0599', 'HR@10': '0.1138', 'NDCG@10': '0.0694', 'HR@20': '0.1540', 'NDCG@20': '0.0795'}
2025-02-27 14:41:36,056 - Validation score increased.  Saving model ...
2025-02-27 14:42:04,175 - {'epoch': 12, 'rec_loss': '7.1008'}
2025-02-27 14:42:12,136 - {'Epoch': 12, 'HR@5': '0.0844', 'NDCG@5': '0.0598', 'HR@10': '0.1161', 'NDCG@10': '0.0699', 'HR@20': '0.1570', 'NDCG@20': '0.0802'}
2025-02-27 14:42:12,138 - Validation score increased.  Saving model ...
2025-02-27 14:42:39,902 - {'epoch': 13, 'rec_loss': '7.0751'}
2025-02-27 14:42:48,009 - {'Epoch': 13, 'HR@5': '0.0851', 'NDCG@5': '0.0596', 'HR@10': '0.1181', 'NDCG@10': '0.0702', 'HR@20': '0.1583', 'NDCG@20': '0.0803'}
2025-02-27 14:42:48,010 - Validation score increased.  Saving model ...
2025-02-27 14:43:15,821 - {'epoch': 14, 'rec_loss': '7.0448'}
2025-02-27 14:43:24,224 - {'Epoch': 14, 'HR@5': '0.0865', 'NDCG@5': '0.0607', 'HR@10': '0.1181', 'NDCG@10': '0.0709', 'HR@20': '0.1599', 'NDCG@20': '0.0814'}
2025-02-27 14:43:24,226 - Validation score increased.  Saving model ...
2025-02-27 14:43:52,613 - {'epoch': 15, 'rec_loss': '7.0249'}
2025-02-27 14:44:00,512 - {'Epoch': 15, 'HR@5': '0.0864', 'NDCG@5': '0.0605', 'HR@10': '0.1186', 'NDCG@10': '0.0709', 'HR@20': '0.1608', 'NDCG@20': '0.0815'}
2025-02-27 14:44:00,513 - Validation score increased.  Saving model ...
2025-02-27 14:44:28,176 - {'epoch': 16, 'rec_loss': '7.0029'}
2025-02-27 14:44:36,864 - {'Epoch': 16, 'HR@5': '0.0864', 'NDCG@5': '0.0606', 'HR@10': '0.1184', 'NDCG@10': '0.0709', 'HR@20': '0.1617', 'NDCG@20': '0.0818'}
2025-02-27 14:44:36,865 - Validation score increased.  Saving model ...
2025-02-27 14:45:04,199 - {'epoch': 17, 'rec_loss': '6.9869'}
2025-02-27 14:45:13,786 - {'Epoch': 17, 'HR@5': '0.0849', 'NDCG@5': '0.0605', 'HR@10': '0.1185', 'NDCG@10': '0.0713', 'HR@20': '0.1604', 'NDCG@20': '0.0818'}
2025-02-27 14:45:13,787 - Validation score increased.  Saving model ...
2025-02-27 14:45:41,417 - {'epoch': 18, 'rec_loss': '6.9555'}
2025-02-27 14:45:50,930 - {'Epoch': 18, 'HR@5': '0.0866', 'NDCG@5': '0.0608', 'HR@10': '0.1182', 'NDCG@10': '0.0710', 'HR@20': '0.1611', 'NDCG@20': '0.0818'}
2025-02-27 14:45:50,932 - EarlyStopping counter: 1 out of 10
2025-02-27 14:46:18,804 - {'epoch': 19, 'rec_loss': '6.9447'}
2025-02-27 14:46:28,559 - {'Epoch': 19, 'HR@5': '0.0872', 'NDCG@5': '0.0617', 'HR@10': '0.1185', 'NDCG@10': '0.0718', 'HR@20': '0.1626', 'NDCG@20': '0.0829'}
2025-02-27 14:46:28,560 - Validation score increased.  Saving model ...
2025-02-27 14:46:56,746 - {'epoch': 20, 'rec_loss': '6.9238'}
2025-02-27 14:47:06,486 - {'Epoch': 20, 'HR@5': '0.0869', 'NDCG@5': '0.0616', 'HR@10': '0.1202', 'NDCG@10': '0.0724', 'HR@20': '0.1631', 'NDCG@20': '0.0832'}
2025-02-27 14:47:06,487 - Validation score increased.  Saving model ...
2025-02-27 14:47:35,453 - {'epoch': 21, 'rec_loss': '6.9158'}
2025-02-27 14:47:45,264 - {'Epoch': 21, 'HR@5': '0.0875', 'NDCG@5': '0.0614', 'HR@10': '0.1210', 'NDCG@10': '0.0722', 'HR@20': '0.1625', 'NDCG@20': '0.0826'}
2025-02-27 14:47:45,265 - EarlyStopping counter: 1 out of 10
2025-02-27 14:48:13,328 - {'epoch': 22, 'rec_loss': '6.9046'}
2025-02-27 14:48:23,456 - {'Epoch': 22, 'HR@5': '0.0880', 'NDCG@5': '0.0625', 'HR@10': '0.1218', 'NDCG@10': '0.0733', 'HR@20': '0.1638', 'NDCG@20': '0.0839'}
2025-02-27 14:48:23,458 - Validation score increased.  Saving model ...
2025-02-27 14:48:52,073 - {'epoch': 23, 'rec_loss': '6.8882'}
2025-02-27 14:49:01,500 - {'Epoch': 23, 'HR@5': '0.0874', 'NDCG@5': '0.0624', 'HR@10': '0.1208', 'NDCG@10': '0.0732', 'HR@20': '0.1640', 'NDCG@20': '0.0840'}
2025-02-27 14:49:01,502 - Validation score increased.  Saving model ...
2025-02-27 14:49:29,540 - {'epoch': 24, 'rec_loss': '6.8810'}
2025-02-27 14:49:38,560 - {'Epoch': 24, 'HR@5': '0.0868', 'NDCG@5': '0.0616', 'HR@10': '0.1202', 'NDCG@10': '0.0724', 'HR@20': '0.1624', 'NDCG@20': '0.0830'}
2025-02-27 14:49:38,569 - EarlyStopping counter: 1 out of 10
2025-02-27 14:50:06,791 - {'epoch': 25, 'rec_loss': '6.8610'}
2025-02-27 14:50:16,032 - {'Epoch': 25, 'HR@5': '0.0875', 'NDCG@5': '0.0616', 'HR@10': '0.1209', 'NDCG@10': '0.0723', 'HR@20': '0.1644', 'NDCG@20': '0.0833'}
2025-02-27 14:50:16,034 - EarlyStopping counter: 2 out of 10
2025-02-27 14:50:44,365 - {'epoch': 26, 'rec_loss': '6.8565'}
2025-02-27 14:50:53,659 - {'Epoch': 26, 'HR@5': '0.0885', 'NDCG@5': '0.0625', 'HR@10': '0.1219', 'NDCG@10': '0.0732', 'HR@20': '0.1638', 'NDCG@20': '0.0838'}
2025-02-27 14:50:53,661 - EarlyStopping counter: 3 out of 10
2025-02-27 14:51:21,805 - {'epoch': 27, 'rec_loss': '6.8405'}
2025-02-27 14:51:31,150 - {'Epoch': 27, 'HR@5': '0.0878', 'NDCG@5': '0.0624', 'HR@10': '0.1199', 'NDCG@10': '0.0727', 'HR@20': '0.1624', 'NDCG@20': '0.0835'}
2025-02-27 14:51:31,151 - EarlyStopping counter: 4 out of 10
2025-02-27 14:52:00,057 - {'epoch': 28, 'rec_loss': '6.8372'}
2025-02-27 14:52:09,871 - {'Epoch': 28, 'HR@5': '0.0881', 'NDCG@5': '0.0620', 'HR@10': '0.1214', 'NDCG@10': '0.0727', 'HR@20': '0.1617', 'NDCG@20': '0.0828'}
2025-02-27 14:52:09,872 - EarlyStopping counter: 5 out of 10
2025-02-27 14:52:38,288 - {'epoch': 29, 'rec_loss': '6.8284'}
2025-02-27 14:52:47,472 - {'Epoch': 29, 'HR@5': '0.0867', 'NDCG@5': '0.0609', 'HR@10': '0.1211', 'NDCG@10': '0.0720', 'HR@20': '0.1633', 'NDCG@20': '0.0826'}
2025-02-27 14:52:47,473 - EarlyStopping counter: 6 out of 10
2025-02-27 14:53:15,530 - {'epoch': 30, 'rec_loss': '6.8181'}
2025-02-27 14:53:25,751 - {'Epoch': 30, 'HR@5': '0.0877', 'NDCG@5': '0.0620', 'HR@10': '0.1213', 'NDCG@10': '0.0728', 'HR@20': '0.1642', 'NDCG@20': '0.0836'}
2025-02-27 14:53:25,752 - EarlyStopping counter: 7 out of 10
2025-02-27 14:53:54,706 - {'epoch': 31, 'rec_loss': '6.8036'}
2025-02-27 14:54:04,101 - {'Epoch': 31, 'HR@5': '0.0876', 'NDCG@5': '0.0625', 'HR@10': '0.1202', 'NDCG@10': '0.0730', 'HR@20': '0.1635', 'NDCG@20': '0.0839'}
2025-02-27 14:54:04,102 - EarlyStopping counter: 8 out of 10
2025-02-27 14:54:34,231 - {'epoch': 32, 'rec_loss': '6.8011'}
2025-02-27 14:54:44,000 - {'Epoch': 32, 'HR@5': '0.0887', 'NDCG@5': '0.0630', 'HR@10': '0.1205', 'NDCG@10': '0.0732', 'HR@20': '0.1640', 'NDCG@20': '0.0842'}
2025-02-27 14:54:44,002 - Validation score increased.  Saving model ...
2025-02-27 14:55:13,829 - {'epoch': 33, 'rec_loss': '6.7975'}
2025-02-27 14:55:23,567 - {'Epoch': 33, 'HR@5': '0.0879', 'NDCG@5': '0.0622', 'HR@10': '0.1189', 'NDCG@10': '0.0723', 'HR@20': '0.1629', 'NDCG@20': '0.0833'}
2025-02-27 14:55:23,568 - EarlyStopping counter: 1 out of 10
2025-02-27 14:55:53,469 - {'epoch': 34, 'rec_loss': '6.7810'}
2025-02-27 14:56:03,785 - {'Epoch': 34, 'HR@5': '0.0880', 'NDCG@5': '0.0621', 'HR@10': '0.1194', 'NDCG@10': '0.0722', 'HR@20': '0.1624', 'NDCG@20': '0.0831'}
2025-02-27 14:56:03,788 - EarlyStopping counter: 2 out of 10
2025-02-27 14:56:33,216 - {'epoch': 35, 'rec_loss': '6.7775'}
2025-02-27 14:56:42,734 - {'Epoch': 35, 'HR@5': '0.0868', 'NDCG@5': '0.0612', 'HR@10': '0.1194', 'NDCG@10': '0.0716', 'HR@20': '0.1634', 'NDCG@20': '0.0827'}
2025-02-27 14:56:42,735 - EarlyStopping counter: 3 out of 10
2025-02-27 14:57:11,916 - {'epoch': 36, 'rec_loss': '6.7692'}
2025-02-27 14:57:21,317 - {'Epoch': 36, 'HR@5': '0.0872', 'NDCG@5': '0.0625', 'HR@10': '0.1212', 'NDCG@10': '0.0734', 'HR@20': '0.1636', 'NDCG@20': '0.0841'}
2025-02-27 14:57:21,318 - EarlyStopping counter: 4 out of 10
2025-02-27 14:57:51,137 - {'epoch': 37, 'rec_loss': '6.7546'}
2025-02-27 14:58:01,268 - {'Epoch': 37, 'HR@5': '0.0862', 'NDCG@5': '0.0611', 'HR@10': '0.1205', 'NDCG@10': '0.0722', 'HR@20': '0.1653', 'NDCG@20': '0.0835'}
2025-02-27 14:58:01,276 - EarlyStopping counter: 5 out of 10
2025-02-27 14:58:30,877 - {'epoch': 38, 'rec_loss': '6.7553'}
2025-02-27 14:58:40,913 - {'Epoch': 38, 'HR@5': '0.0866', 'NDCG@5': '0.0618', 'HR@10': '0.1203', 'NDCG@10': '0.0727', 'HR@20': '0.1640', 'NDCG@20': '0.0837'}
2025-02-27 14:58:40,914 - EarlyStopping counter: 6 out of 10
2025-02-27 14:59:10,457 - {'epoch': 39, 'rec_loss': '6.7483'}
2025-02-27 14:59:20,016 - {'Epoch': 39, 'HR@5': '0.0858', 'NDCG@5': '0.0607', 'HR@10': '0.1186', 'NDCG@10': '0.0712', 'HR@20': '0.1614', 'NDCG@20': '0.0819'}
2025-02-27 14:59:20,018 - EarlyStopping counter: 7 out of 10
2025-02-27 14:59:48,946 - {'epoch': 40, 'rec_loss': '6.7496'}
2025-02-27 14:59:58,288 - {'Epoch': 40, 'HR@5': '0.0869', 'NDCG@5': '0.0618', 'HR@10': '0.1197', 'NDCG@10': '0.0724', 'HR@20': '0.1641', 'NDCG@20': '0.0836'}
2025-02-27 14:59:58,290 - EarlyStopping counter: 8 out of 10
2025-02-27 15:00:28,298 - {'epoch': 41, 'rec_loss': '6.7364'}
2025-02-27 15:00:38,440 - {'Epoch': 41, 'HR@5': '0.0877', 'NDCG@5': '0.0626', 'HR@10': '0.1197', 'NDCG@10': '0.0729', 'HR@20': '0.1639', 'NDCG@20': '0.0841'}
2025-02-27 15:00:38,441 - EarlyStopping counter: 9 out of 10
2025-02-27 15:01:08,764 - {'epoch': 42, 'rec_loss': '6.7328'}
2025-02-27 15:01:19,074 - {'Epoch': 42, 'HR@5': '0.0885', 'NDCG@5': '0.0626', 'HR@10': '0.1208', 'NDCG@10': '0.0729', 'HR@20': '0.1633', 'NDCG@20': '0.0836'}
2025-02-27 15:01:19,076 - EarlyStopping counter: 10 out of 10
2025-02-27 15:01:19,076 - Early stopping
2025-02-27 15:01:19,076 - ---------------Test Score---------------
2025-02-27 15:01:29,350 - {'Epoch': 0, 'HR@5': '0.0721', 'NDCG@5': '0.0506', 'HR@10': '0.0996', 'NDCG@10': '0.0595', 'HR@20': '0.1369', 'NDCG@20': '0.0689'}
2025-02-27 15:01:29,351 - Scale_Beauty
2025-02-27 15:01:29,352 - {'Epoch': 0, 'HR@5': '0.0721', 'NDCG@5': '0.0506', 'HR@10': '0.0996', 'NDCG@10': '0.0595', 'HR@20': '0.1369', 'NDCG@20': '0.0689'}
2025-02-27 15:31:29,183 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[2, 4, 6, 8], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-27 15:31:32,643 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=4, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=4, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-27 15:31:32,654 - Total Parameters: 929449
2025-02-27 15:32:02,641 - {'epoch': 0, 'rec_loss': '8.8331'}
2025-02-27 15:32:12,111 - {'Epoch': 0, 'HR@5': '0.0173', 'NDCG@5': '0.0109', 'HR@10': '0.0279', 'NDCG@10': '0.0143', 'HR@20': '0.0459', 'NDCG@20': '0.0188'}
2025-02-27 15:32:12,114 - Validation score increased.  Saving model ...
2025-02-27 15:32:41,164 - {'epoch': 1, 'rec_loss': '8.3132'}
2025-02-27 15:32:51,114 - {'Epoch': 1, 'HR@5': '0.0365', 'NDCG@5': '0.0241', 'HR@10': '0.0580', 'NDCG@10': '0.0310', 'HR@20': '0.0829', 'NDCG@20': '0.0372'}
2025-02-27 15:32:51,116 - Validation score increased.  Saving model ...
2025-02-27 15:33:19,658 - {'epoch': 2, 'rec_loss': '8.0105'}
2025-02-27 15:33:29,420 - {'Epoch': 2, 'HR@5': '0.0495', 'NDCG@5': '0.0334', 'HR@10': '0.0723', 'NDCG@10': '0.0407', 'HR@20': '0.1061', 'NDCG@20': '0.0492'}
2025-02-27 15:33:29,421 - Validation score increased.  Saving model ...
2025-02-27 15:33:57,514 - {'epoch': 3, 'rec_loss': '7.7921'}
2025-02-27 15:34:06,906 - {'Epoch': 3, 'HR@5': '0.0618', 'NDCG@5': '0.0425', 'HR@10': '0.0880', 'NDCG@10': '0.0510', 'HR@20': '0.1235', 'NDCG@20': '0.0599'}
2025-02-27 15:34:06,908 - Validation score increased.  Saving model ...
2025-02-27 15:34:35,395 - {'epoch': 4, 'rec_loss': '7.6350'}
2025-02-27 15:34:44,907 - {'Epoch': 4, 'HR@5': '0.0687', 'NDCG@5': '0.0481', 'HR@10': '0.0998', 'NDCG@10': '0.0581', 'HR@20': '0.1361', 'NDCG@20': '0.0672'}
2025-02-27 15:34:44,908 - Validation score increased.  Saving model ...
2025-02-27 15:35:13,056 - {'epoch': 5, 'rec_loss': '7.5116'}
2025-02-27 15:35:20,649 - {'Epoch': 5, 'HR@5': '0.0765', 'NDCG@5': '0.0534', 'HR@10': '0.1056', 'NDCG@10': '0.0628', 'HR@20': '0.1446', 'NDCG@20': '0.0726'}
2025-02-27 15:35:20,650 - Validation score increased.  Saving model ...
2025-02-27 15:35:49,589 - {'epoch': 6, 'rec_loss': '7.4115'}
2025-02-27 15:35:57,839 - {'Epoch': 6, 'HR@5': '0.0770', 'NDCG@5': '0.0540', 'HR@10': '0.1089', 'NDCG@10': '0.0643', 'HR@20': '0.1471', 'NDCG@20': '0.0740'}
2025-02-27 15:35:57,840 - Validation score increased.  Saving model ...
2025-02-27 15:36:26,514 - {'epoch': 7, 'rec_loss': '7.3333'}
2025-02-27 15:36:34,328 - {'Epoch': 7, 'HR@5': '0.0792', 'NDCG@5': '0.0557', 'HR@10': '0.1116', 'NDCG@10': '0.0662', 'HR@20': '0.1521', 'NDCG@20': '0.0763'}
2025-02-27 15:36:34,330 - Validation score increased.  Saving model ...
2025-02-27 15:37:03,263 - {'epoch': 8, 'rec_loss': '7.2670'}
2025-02-27 15:37:10,866 - {'Epoch': 8, 'HR@5': '0.0805', 'NDCG@5': '0.0570', 'HR@10': '0.1115', 'NDCG@10': '0.0669', 'HR@20': '0.1523', 'NDCG@20': '0.0772'}
2025-02-27 15:37:10,867 - Validation score increased.  Saving model ...
2025-02-27 15:37:39,438 - {'epoch': 9, 'rec_loss': '7.2136'}
2025-02-27 15:37:47,134 - {'Epoch': 9, 'HR@5': '0.0837', 'NDCG@5': '0.0583', 'HR@10': '0.1130', 'NDCG@10': '0.0678', 'HR@20': '0.1549', 'NDCG@20': '0.0784'}
2025-02-27 15:37:47,136 - Validation score increased.  Saving model ...
2025-02-27 15:38:16,394 - {'epoch': 10, 'rec_loss': '7.1647'}
2025-02-27 15:38:24,397 - {'Epoch': 10, 'HR@5': '0.0835', 'NDCG@5': '0.0583', 'HR@10': '0.1164', 'NDCG@10': '0.0689', 'HR@20': '0.1553', 'NDCG@20': '0.0787'}
2025-02-27 15:38:24,403 - Validation score increased.  Saving model ...
2025-02-27 15:38:53,244 - {'epoch': 11, 'rec_loss': '7.1256'}
2025-02-27 15:39:00,885 - {'Epoch': 11, 'HR@5': '0.0844', 'NDCG@5': '0.0590', 'HR@10': '0.1152', 'NDCG@10': '0.0689', 'HR@20': '0.1552', 'NDCG@20': '0.0790'}
2025-02-27 15:39:00,886 - Validation score increased.  Saving model ...
2025-02-27 15:39:29,219 - {'epoch': 12, 'rec_loss': '7.0916'}
2025-02-27 15:39:37,358 - {'Epoch': 12, 'HR@5': '0.0849', 'NDCG@5': '0.0594', 'HR@10': '0.1165', 'NDCG@10': '0.0696', 'HR@20': '0.1552', 'NDCG@20': '0.0793'}
2025-02-27 15:39:37,364 - Validation score increased.  Saving model ...
2025-02-27 15:40:05,995 - {'epoch': 13, 'rec_loss': '7.0698'}
2025-02-27 15:40:13,485 - {'Epoch': 13, 'HR@5': '0.0845', 'NDCG@5': '0.0598', 'HR@10': '0.1162', 'NDCG@10': '0.0700', 'HR@20': '0.1572', 'NDCG@20': '0.0803'}
2025-02-27 15:40:13,487 - Validation score increased.  Saving model ...
2025-02-27 15:40:41,170 - {'epoch': 14, 'rec_loss': '7.0369'}
2025-02-27 15:40:49,060 - {'Epoch': 14, 'HR@5': '0.0852', 'NDCG@5': '0.0595', 'HR@10': '0.1178', 'NDCG@10': '0.0701', 'HR@20': '0.1610', 'NDCG@20': '0.0809'}
2025-02-27 15:40:49,061 - Validation score increased.  Saving model ...
2025-02-27 15:41:17,317 - {'epoch': 15, 'rec_loss': '7.0168'}
2025-02-27 15:41:24,776 - {'Epoch': 15, 'HR@5': '0.0840', 'NDCG@5': '0.0590', 'HR@10': '0.1189', 'NDCG@10': '0.0702', 'HR@20': '0.1610', 'NDCG@20': '0.0808'}
2025-02-27 15:41:24,777 - EarlyStopping counter: 1 out of 10
2025-02-27 15:41:52,924 - {'epoch': 16, 'rec_loss': '6.9933'}
2025-02-27 15:42:00,980 - {'Epoch': 16, 'HR@5': '0.0863', 'NDCG@5': '0.0607', 'HR@10': '0.1192', 'NDCG@10': '0.0712', 'HR@20': '0.1618', 'NDCG@20': '0.0820'}
2025-02-27 15:42:00,987 - Validation score increased.  Saving model ...
2025-02-27 15:42:29,720 - {'epoch': 17, 'rec_loss': '6.9763'}
2025-02-27 15:42:37,448 - {'Epoch': 17, 'HR@5': '0.0863', 'NDCG@5': '0.0611', 'HR@10': '0.1192', 'NDCG@10': '0.0716', 'HR@20': '0.1617', 'NDCG@20': '0.0823'}
2025-02-27 15:42:37,449 - Validation score increased.  Saving model ...
2025-02-27 15:43:05,639 - {'epoch': 18, 'rec_loss': '6.9533'}
2025-02-27 15:43:13,348 - {'Epoch': 18, 'HR@5': '0.0859', 'NDCG@5': '0.0605', 'HR@10': '0.1180', 'NDCG@10': '0.0709', 'HR@20': '0.1614', 'NDCG@20': '0.0819'}
2025-02-27 15:43:13,349 - EarlyStopping counter: 1 out of 10
2025-02-27 15:43:41,013 - {'epoch': 19, 'rec_loss': '6.9365'}
2025-02-27 15:43:48,899 - {'Epoch': 19, 'HR@5': '0.0868', 'NDCG@5': '0.0608', 'HR@10': '0.1180', 'NDCG@10': '0.0709', 'HR@20': '0.1605', 'NDCG@20': '0.0816'}
2025-02-27 15:43:48,900 - EarlyStopping counter: 2 out of 10
2025-02-27 15:44:17,097 - {'epoch': 20, 'rec_loss': '6.9241'}
2025-02-27 15:44:24,750 - {'Epoch': 20, 'HR@5': '0.0857', 'NDCG@5': '0.0598', 'HR@10': '0.1195', 'NDCG@10': '0.0707', 'HR@20': '0.1616', 'NDCG@20': '0.0813'}
2025-02-27 15:44:24,752 - EarlyStopping counter: 3 out of 10
2025-02-27 15:44:52,217 - {'epoch': 21, 'rec_loss': '6.9090'}
2025-02-27 15:45:00,287 - {'Epoch': 21, 'HR@5': '0.0880', 'NDCG@5': '0.0610', 'HR@10': '0.1201', 'NDCG@10': '0.0714', 'HR@20': '0.1631', 'NDCG@20': '0.0822'}
2025-02-27 15:45:00,288 - EarlyStopping counter: 4 out of 10
2025-02-27 15:45:28,353 - {'epoch': 22, 'rec_loss': '6.8929'}
2025-02-27 15:45:36,279 - {'Epoch': 22, 'HR@5': '0.0867', 'NDCG@5': '0.0609', 'HR@10': '0.1205', 'NDCG@10': '0.0718', 'HR@20': '0.1604', 'NDCG@20': '0.0819'}
2025-02-27 15:45:36,280 - EarlyStopping counter: 5 out of 10
2025-02-27 15:46:03,475 - {'epoch': 23, 'rec_loss': '6.8774'}
2025-02-27 15:46:11,079 - {'Epoch': 23, 'HR@5': '0.0875', 'NDCG@5': '0.0614', 'HR@10': '0.1197', 'NDCG@10': '0.0717', 'HR@20': '0.1615', 'NDCG@20': '0.0822'}
2025-02-27 15:46:11,081 - EarlyStopping counter: 6 out of 10
2025-02-27 15:46:39,434 - {'epoch': 24, 'rec_loss': '6.8714'}
2025-02-27 15:46:47,364 - {'Epoch': 24, 'HR@5': '0.0869', 'NDCG@5': '0.0616', 'HR@10': '0.1196', 'NDCG@10': '0.0721', 'HR@20': '0.1610', 'NDCG@20': '0.0825'}
2025-02-27 15:46:47,369 - Validation score increased.  Saving model ...
2025-02-27 15:47:15,332 - {'epoch': 25, 'rec_loss': '6.8579'}
2025-02-27 15:47:22,899 - {'Epoch': 25, 'HR@5': '0.0882', 'NDCG@5': '0.0621', 'HR@10': '0.1204', 'NDCG@10': '0.0724', 'HR@20': '0.1624', 'NDCG@20': '0.0830'}
2025-02-27 15:47:22,900 - Validation score increased.  Saving model ...
2025-02-27 15:47:51,059 - {'epoch': 26, 'rec_loss': '6.8490'}
2025-02-27 15:47:59,141 - {'Epoch': 26, 'HR@5': '0.0868', 'NDCG@5': '0.0613', 'HR@10': '0.1203', 'NDCG@10': '0.0721', 'HR@20': '0.1608', 'NDCG@20': '0.0823'}
2025-02-27 15:47:59,143 - EarlyStopping counter: 1 out of 10
2025-02-27 15:48:27,608 - {'epoch': 27, 'rec_loss': '6.8397'}
2025-02-27 15:48:35,311 - {'Epoch': 27, 'HR@5': '0.0876', 'NDCG@5': '0.0611', 'HR@10': '0.1195', 'NDCG@10': '0.0714', 'HR@20': '0.1612', 'NDCG@20': '0.0819'}
2025-02-27 15:48:35,312 - EarlyStopping counter: 2 out of 10
2025-02-27 15:49:02,914 - {'epoch': 28, 'rec_loss': '6.8270'}
2025-02-27 15:49:11,086 - {'Epoch': 28, 'HR@5': '0.0889', 'NDCG@5': '0.0621', 'HR@10': '0.1204', 'NDCG@10': '0.0722', 'HR@20': '0.1638', 'NDCG@20': '0.0832'}
2025-02-27 15:49:11,093 - Validation score increased.  Saving model ...
2025-02-27 15:49:39,276 - {'epoch': 29, 'rec_loss': '6.8169'}
2025-02-27 15:49:46,822 - {'Epoch': 29, 'HR@5': '0.0864', 'NDCG@5': '0.0609', 'HR@10': '0.1202', 'NDCG@10': '0.0718', 'HR@20': '0.1612', 'NDCG@20': '0.0821'}
2025-02-27 15:49:46,823 - EarlyStopping counter: 1 out of 10
2025-02-27 15:50:15,172 - {'epoch': 30, 'rec_loss': '6.8057'}
2025-02-27 15:50:22,864 - {'Epoch': 30, 'HR@5': '0.0880', 'NDCG@5': '0.0617', 'HR@10': '0.1216', 'NDCG@10': '0.0725', 'HR@20': '0.1624', 'NDCG@20': '0.0827'}
2025-02-27 15:50:22,866 - EarlyStopping counter: 2 out of 10
2025-02-27 15:50:49,713 - {'epoch': 31, 'rec_loss': '6.8048'}
2025-02-27 15:50:57,245 - {'Epoch': 31, 'HR@5': '0.0863', 'NDCG@5': '0.0606', 'HR@10': '0.1197', 'NDCG@10': '0.0713', 'HR@20': '0.1634', 'NDCG@20': '0.0824'}
2025-02-27 15:50:57,246 - EarlyStopping counter: 3 out of 10
2025-02-27 15:51:23,759 - {'epoch': 32, 'rec_loss': '6.7904'}
2025-02-27 15:51:32,180 - {'Epoch': 32, 'HR@5': '0.0880', 'NDCG@5': '0.0611', 'HR@10': '0.1208', 'NDCG@10': '0.0717', 'HR@20': '0.1646', 'NDCG@20': '0.0827'}
2025-02-27 15:51:32,182 - EarlyStopping counter: 4 out of 10
2025-02-27 15:51:59,686 - {'epoch': 33, 'rec_loss': '6.7843'}
2025-02-27 15:52:08,198 - {'Epoch': 33, 'HR@5': '0.0865', 'NDCG@5': '0.0612', 'HR@10': '0.1210', 'NDCG@10': '0.0724', 'HR@20': '0.1626', 'NDCG@20': '0.0828'}
2025-02-27 15:52:08,199 - EarlyStopping counter: 5 out of 10
2025-02-27 15:52:36,177 - {'epoch': 34, 'rec_loss': '6.7791'}
2025-02-27 15:52:44,416 - {'Epoch': 34, 'HR@5': '0.0868', 'NDCG@5': '0.0617', 'HR@10': '0.1216', 'NDCG@10': '0.0729', 'HR@20': '0.1640', 'NDCG@20': '0.0836'}
2025-02-27 15:52:44,418 - Validation score increased.  Saving model ...
2025-02-27 15:53:10,099 - {'epoch': 35, 'rec_loss': '6.7667'}
2025-02-27 15:53:17,842 - {'Epoch': 35, 'HR@5': '0.0856', 'NDCG@5': '0.0610', 'HR@10': '0.1211', 'NDCG@10': '0.0725', 'HR@20': '0.1636', 'NDCG@20': '0.0832'}
2025-02-27 15:53:17,843 - EarlyStopping counter: 1 out of 10
2025-02-27 15:53:43,866 - {'epoch': 36, 'rec_loss': '6.7656'}
2025-02-27 15:53:51,559 - {'Epoch': 36, 'HR@5': '0.0868', 'NDCG@5': '0.0612', 'HR@10': '0.1205', 'NDCG@10': '0.0720', 'HR@20': '0.1625', 'NDCG@20': '0.0826'}
2025-02-27 15:53:51,560 - EarlyStopping counter: 2 out of 10
2025-02-27 15:54:17,308 - {'epoch': 37, 'rec_loss': '6.7560'}
2025-02-27 15:54:26,119 - {'Epoch': 37, 'HR@5': '0.0877', 'NDCG@5': '0.0613', 'HR@10': '0.1207', 'NDCG@10': '0.0719', 'HR@20': '0.1627', 'NDCG@20': '0.0825'}
2025-02-27 15:54:26,124 - EarlyStopping counter: 3 out of 10
2025-02-27 15:54:52,120 - {'epoch': 38, 'rec_loss': '6.7494'}
2025-02-27 15:55:00,929 - {'Epoch': 38, 'HR@5': '0.0876', 'NDCG@5': '0.0613', 'HR@10': '0.1216', 'NDCG@10': '0.0723', 'HR@20': '0.1663', 'NDCG@20': '0.0836'}
2025-02-27 15:55:00,930 - EarlyStopping counter: 4 out of 10
2025-02-27 15:55:27,724 - {'epoch': 39, 'rec_loss': '6.7435'}
2025-02-27 15:55:36,238 - {'Epoch': 39, 'HR@5': '0.0866', 'NDCG@5': '0.0609', 'HR@10': '0.1215', 'NDCG@10': '0.0721', 'HR@20': '0.1650', 'NDCG@20': '0.0831'}
2025-02-27 15:55:36,239 - EarlyStopping counter: 5 out of 10
2025-02-27 15:56:03,209 - {'epoch': 40, 'rec_loss': '6.7427'}
2025-02-27 15:56:11,791 - {'Epoch': 40, 'HR@5': '0.0876', 'NDCG@5': '0.0615', 'HR@10': '0.1206', 'NDCG@10': '0.0721', 'HR@20': '0.1650', 'NDCG@20': '0.0833'}
2025-02-27 15:56:11,792 - EarlyStopping counter: 6 out of 10
2025-02-27 15:56:37,486 - {'epoch': 41, 'rec_loss': '6.7317'}
2025-02-27 15:56:46,523 - {'Epoch': 41, 'HR@5': '0.0877', 'NDCG@5': '0.0617', 'HR@10': '0.1209', 'NDCG@10': '0.0724', 'HR@20': '0.1646', 'NDCG@20': '0.0834'}
2025-02-27 15:56:46,528 - EarlyStopping counter: 7 out of 10
2025-02-27 15:57:13,445 - {'epoch': 42, 'rec_loss': '6.7268'}
2025-02-27 15:57:21,010 - {'Epoch': 42, 'HR@5': '0.0863', 'NDCG@5': '0.0611', 'HR@10': '0.1195', 'NDCG@10': '0.0718', 'HR@20': '0.1649', 'NDCG@20': '0.0832'}
2025-02-27 15:57:21,012 - EarlyStopping counter: 8 out of 10
2025-02-27 15:57:47,551 - {'epoch': 43, 'rec_loss': '6.7157'}
2025-02-27 15:57:55,517 - {'Epoch': 43, 'HR@5': '0.0866', 'NDCG@5': '0.0610', 'HR@10': '0.1219', 'NDCG@10': '0.0724', 'HR@20': '0.1650', 'NDCG@20': '0.0832'}
2025-02-27 15:57:55,519 - EarlyStopping counter: 9 out of 10
2025-02-27 15:58:22,193 - {'epoch': 44, 'rec_loss': '6.7202'}
2025-02-27 15:58:30,734 - {'Epoch': 44, 'HR@5': '0.0865', 'NDCG@5': '0.0614', 'HR@10': '0.1217', 'NDCG@10': '0.0727', 'HR@20': '0.1638', 'NDCG@20': '0.0834'}
2025-02-27 15:58:30,735 - EarlyStopping counter: 10 out of 10
2025-02-27 15:58:30,736 - Early stopping
2025-02-27 15:58:30,736 - ---------------Test Score---------------
2025-02-27 15:58:38,583 - {'Epoch': 0, 'HR@5': '0.0717', 'NDCG@5': '0.0507', 'HR@10': '0.0978', 'NDCG@10': '0.0591', 'HR@20': '0.1357', 'NDCG@20': '0.0686'}
2025-02-27 15:58:38,589 - Scale_Beauty
2025-02-27 15:58:38,589 - {'Epoch': 0, 'HR@5': '0.0717', 'NDCG@5': '0.0507', 'HR@10': '0.0978', 'NDCG@10': '0.0591', 'HR@20': '0.1357', 'NDCG@20': '0.0686'}
2025-02-27 16:03:54,803 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[2], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-27 16:03:57,665 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=1, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=1, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-27 16:03:57,671 - Total Parameters: 929437
2025-02-27 16:04:26,433 - {'epoch': 0, 'rec_loss': '8.8447'}
2025-02-27 16:04:34,541 - {'Epoch': 0, 'HR@5': '0.0184', 'NDCG@5': '0.0121', 'HR@10': '0.0298', 'NDCG@10': '0.0157', 'HR@20': '0.0469', 'NDCG@20': '0.0200'}
2025-02-27 16:04:34,542 - Validation score increased.  Saving model ...
2025-02-27 16:05:01,517 - {'epoch': 1, 'rec_loss': '8.3157'}
2025-02-27 16:05:10,628 - {'Epoch': 1, 'HR@5': '0.0356', 'NDCG@5': '0.0231', 'HR@10': '0.0554', 'NDCG@10': '0.0295', 'HR@20': '0.0811', 'NDCG@20': '0.0359'}
2025-02-27 16:05:10,629 - Validation score increased.  Saving model ...
2025-02-27 16:05:35,244 - {'epoch': 2, 'rec_loss': '8.0065'}
2025-02-27 16:05:44,177 - {'Epoch': 2, 'HR@5': '0.0490', 'NDCG@5': '0.0335', 'HR@10': '0.0726', 'NDCG@10': '0.0410', 'HR@20': '0.1058', 'NDCG@20': '0.0493'}
2025-02-27 16:05:44,178 - Validation score increased.  Saving model ...
2025-02-27 16:06:08,358 - {'epoch': 3, 'rec_loss': '7.7919'}
2025-02-27 16:06:16,948 - {'Epoch': 3, 'HR@5': '0.0620', 'NDCG@5': '0.0429', 'HR@10': '0.0885', 'NDCG@10': '0.0514', 'HR@20': '0.1226', 'NDCG@20': '0.0599'}
2025-02-27 16:06:16,949 - Validation score increased.  Saving model ...
2025-02-27 16:06:43,371 - {'epoch': 4, 'rec_loss': '7.6368'}
2025-02-27 16:06:51,858 - {'Epoch': 4, 'HR@5': '0.0689', 'NDCG@5': '0.0479', 'HR@10': '0.0947', 'NDCG@10': '0.0563', 'HR@20': '0.1317', 'NDCG@20': '0.0656'}
2025-02-27 16:06:51,859 - Validation score increased.  Saving model ...
2025-02-27 16:07:19,987 - {'epoch': 5, 'rec_loss': '7.5171'}
2025-02-27 16:07:28,498 - {'Epoch': 5, 'HR@5': '0.0722', 'NDCG@5': '0.0507', 'HR@10': '0.1002', 'NDCG@10': '0.0597', 'HR@20': '0.1392', 'NDCG@20': '0.0696'}
2025-02-27 16:07:28,499 - Validation score increased.  Saving model ...
2025-02-27 16:07:59,792 - {'epoch': 6, 'rec_loss': '7.4159'}
2025-02-27 16:08:08,573 - {'Epoch': 6, 'HR@5': '0.0770', 'NDCG@5': '0.0545', 'HR@10': '0.1065', 'NDCG@10': '0.0640', 'HR@20': '0.1449', 'NDCG@20': '0.0737'}
2025-02-27 16:08:08,574 - Validation score increased.  Saving model ...
2025-02-27 16:08:39,107 - {'epoch': 7, 'rec_loss': '7.3336'}
2025-02-27 16:08:46,915 - {'Epoch': 7, 'HR@5': '0.0783', 'NDCG@5': '0.0562', 'HR@10': '0.1096', 'NDCG@10': '0.0662', 'HR@20': '0.1486', 'NDCG@20': '0.0760'}
2025-02-27 16:08:46,916 - Validation score increased.  Saving model ...
2025-02-27 16:09:11,727 - {'epoch': 8, 'rec_loss': '7.2716'}
2025-02-27 16:09:19,470 - {'Epoch': 8, 'HR@5': '0.0811', 'NDCG@5': '0.0572', 'HR@10': '0.1105', 'NDCG@10': '0.0666', 'HR@20': '0.1504', 'NDCG@20': '0.0767'}
2025-02-27 16:09:19,472 - Validation score increased.  Saving model ...
2025-02-27 16:09:45,241 - {'epoch': 9, 'rec_loss': '7.2172'}
2025-02-27 16:09:54,078 - {'Epoch': 9, 'HR@5': '0.0814', 'NDCG@5': '0.0588', 'HR@10': '0.1120', 'NDCG@10': '0.0687', 'HR@20': '0.1504', 'NDCG@20': '0.0783'}
2025-02-27 16:09:54,079 - Validation score increased.  Saving model ...
2025-02-27 16:10:19,599 - {'epoch': 10, 'rec_loss': '7.1721'}
2025-02-27 16:10:27,022 - {'Epoch': 10, 'HR@5': '0.0825', 'NDCG@5': '0.0584', 'HR@10': '0.1127', 'NDCG@10': '0.0682', 'HR@20': '0.1541', 'NDCG@20': '0.0786'}
2025-02-27 16:10:27,023 - Validation score increased.  Saving model ...
2025-02-27 16:10:52,008 - {'epoch': 11, 'rec_loss': '7.1314'}
2025-02-27 16:11:00,442 - {'Epoch': 11, 'HR@5': '0.0842', 'NDCG@5': '0.0597', 'HR@10': '0.1128', 'NDCG@10': '0.0690', 'HR@20': '0.1563', 'NDCG@20': '0.0799'}
2025-02-27 16:11:00,443 - Validation score increased.  Saving model ...
2025-02-27 16:11:25,758 - {'epoch': 12, 'rec_loss': '7.0981'}
2025-02-27 16:11:34,266 - {'Epoch': 12, 'HR@5': '0.0818', 'NDCG@5': '0.0582', 'HR@10': '0.1148', 'NDCG@10': '0.0688', 'HR@20': '0.1565', 'NDCG@20': '0.0793'}
2025-02-27 16:11:34,268 - EarlyStopping counter: 1 out of 10
2025-02-27 16:11:59,738 - {'epoch': 13, 'rec_loss': '7.0726'}
2025-02-27 16:12:08,416 - {'Epoch': 13, 'HR@5': '0.0843', 'NDCG@5': '0.0596', 'HR@10': '0.1160', 'NDCG@10': '0.0698', 'HR@20': '0.1550', 'NDCG@20': '0.0797'}
2025-02-27 16:12:08,418 - EarlyStopping counter: 2 out of 10
2025-02-27 16:12:32,684 - {'epoch': 14, 'rec_loss': '7.0433'}
2025-02-27 16:12:40,911 - {'Epoch': 14, 'HR@5': '0.0843', 'NDCG@5': '0.0600', 'HR@10': '0.1162', 'NDCG@10': '0.0703', 'HR@20': '0.1575', 'NDCG@20': '0.0807'}
2025-02-27 16:12:40,916 - Validation score increased.  Saving model ...
2025-02-27 16:13:06,746 - {'epoch': 15, 'rec_loss': '7.0231'}
2025-02-27 16:13:14,195 - {'Epoch': 15, 'HR@5': '0.0848', 'NDCG@5': '0.0596', 'HR@10': '0.1185', 'NDCG@10': '0.0704', 'HR@20': '0.1580', 'NDCG@20': '0.0804'}
2025-02-27 16:13:14,196 - EarlyStopping counter: 1 out of 10
2025-02-27 16:13:38,086 - {'epoch': 16, 'rec_loss': '6.9963'}
2025-02-27 16:13:46,030 - {'Epoch': 16, 'HR@5': '0.0842', 'NDCG@5': '0.0600', 'HR@10': '0.1178', 'NDCG@10': '0.0708', 'HR@20': '0.1600', 'NDCG@20': '0.0815'}
2025-02-27 16:13:46,031 - Validation score increased.  Saving model ...
2025-02-27 16:14:11,188 - {'epoch': 17, 'rec_loss': '6.9830'}
2025-02-27 16:14:19,040 - {'Epoch': 17, 'HR@5': '0.0853', 'NDCG@5': '0.0613', 'HR@10': '0.1179', 'NDCG@10': '0.0717', 'HR@20': '0.1587', 'NDCG@20': '0.0820'}
2025-02-27 16:14:19,045 - Validation score increased.  Saving model ...
2025-02-27 16:14:44,346 - {'epoch': 18, 'rec_loss': '6.9533'}
2025-02-27 16:14:52,226 - {'Epoch': 18, 'HR@5': '0.0853', 'NDCG@5': '0.0603', 'HR@10': '0.1166', 'NDCG@10': '0.0704', 'HR@20': '0.1583', 'NDCG@20': '0.0808'}
2025-02-27 16:14:52,227 - EarlyStopping counter: 1 out of 10
2025-02-27 16:15:16,019 - {'epoch': 19, 'rec_loss': '6.9422'}
2025-02-27 16:15:23,695 - {'Epoch': 19, 'HR@5': '0.0845', 'NDCG@5': '0.0602', 'HR@10': '0.1182', 'NDCG@10': '0.0710', 'HR@20': '0.1600', 'NDCG@20': '0.0815'}
2025-02-27 16:15:23,697 - EarlyStopping counter: 2 out of 10
2025-02-27 16:15:48,066 - {'epoch': 20, 'rec_loss': '6.9219'}
2025-02-27 16:15:56,246 - {'Epoch': 20, 'HR@5': '0.0848', 'NDCG@5': '0.0609', 'HR@10': '0.1176', 'NDCG@10': '0.0714', 'HR@20': '0.1604', 'NDCG@20': '0.0822'}
2025-02-27 16:15:56,247 - Validation score increased.  Saving model ...
2025-02-27 16:16:21,259 - {'epoch': 21, 'rec_loss': '6.9111'}
2025-02-27 16:16:29,646 - {'Epoch': 21, 'HR@5': '0.0862', 'NDCG@5': '0.0613', 'HR@10': '0.1177', 'NDCG@10': '0.0715', 'HR@20': '0.1621', 'NDCG@20': '0.0827'}
2025-02-27 16:16:29,648 - Validation score increased.  Saving model ...
2025-02-27 16:16:54,327 - {'epoch': 22, 'rec_loss': '6.8981'}
2025-02-27 16:17:02,321 - {'Epoch': 22, 'HR@5': '0.0847', 'NDCG@5': '0.0604', 'HR@10': '0.1183', 'NDCG@10': '0.0712', 'HR@20': '0.1610', 'NDCG@20': '0.0819'}
2025-02-27 16:17:02,322 - EarlyStopping counter: 1 out of 10
2025-02-27 16:17:26,410 - {'epoch': 23, 'rec_loss': '6.8798'}
2025-02-27 16:17:34,307 - {'Epoch': 23, 'HR@5': '0.0860', 'NDCG@5': '0.0613', 'HR@10': '0.1192', 'NDCG@10': '0.0720', 'HR@20': '0.1615', 'NDCG@20': '0.0827'}
2025-02-27 16:17:34,309 - Validation score increased.  Saving model ...
2025-02-27 16:17:59,487 - {'epoch': 24, 'rec_loss': '6.8735'}
2025-02-27 16:18:08,595 - {'Epoch': 24, 'HR@5': '0.0853', 'NDCG@5': '0.0612', 'HR@10': '0.1187', 'NDCG@10': '0.0720', 'HR@20': '0.1614', 'NDCG@20': '0.0828'}
2025-02-27 16:18:08,596 - Validation score increased.  Saving model ...
2025-02-27 16:18:34,956 - {'epoch': 25, 'rec_loss': '6.8602'}
2025-02-27 16:18:43,584 - {'Epoch': 25, 'HR@5': '0.0862', 'NDCG@5': '0.0613', 'HR@10': '0.1203', 'NDCG@10': '0.0723', 'HR@20': '0.1620', 'NDCG@20': '0.0828'}
2025-02-27 16:18:43,585 - Validation score increased.  Saving model ...
2025-02-27 16:19:11,492 - {'epoch': 26, 'rec_loss': '6.8491'}
2025-02-27 16:19:19,641 - {'Epoch': 26, 'HR@5': '0.0861', 'NDCG@5': '0.0613', 'HR@10': '0.1192', 'NDCG@10': '0.0720', 'HR@20': '0.1628', 'NDCG@20': '0.0830'}
2025-02-27 16:19:19,642 - Validation score increased.  Saving model ...
2025-02-27 16:19:45,466 - {'epoch': 27, 'rec_loss': '6.8400'}
2025-02-27 16:19:54,138 - {'Epoch': 27, 'HR@5': '0.0876', 'NDCG@5': '0.0619', 'HR@10': '0.1187', 'NDCG@10': '0.0719', 'HR@20': '0.1608', 'NDCG@20': '0.0825'}
2025-02-27 16:19:54,140 - EarlyStopping counter: 1 out of 10
2025-02-27 16:20:19,364 - {'epoch': 28, 'rec_loss': '6.8325'}
2025-02-27 16:20:27,569 - {'Epoch': 28, 'HR@5': '0.0855', 'NDCG@5': '0.0616', 'HR@10': '0.1197', 'NDCG@10': '0.0726', 'HR@20': '0.1614', 'NDCG@20': '0.0831'}
2025-02-27 16:20:27,571 - Validation score increased.  Saving model ...
2025-02-27 16:20:51,434 - {'epoch': 29, 'rec_loss': '6.8249'}
2025-02-27 16:20:59,880 - {'Epoch': 29, 'HR@5': '0.0851', 'NDCG@5': '0.0609', 'HR@10': '0.1205', 'NDCG@10': '0.0724', 'HR@20': '0.1633', 'NDCG@20': '0.0832'}
2025-02-27 16:20:59,882 - Validation score increased.  Saving model ...
2025-02-27 16:21:23,646 - {'epoch': 30, 'rec_loss': '6.8142'}
2025-02-27 16:21:32,117 - {'Epoch': 30, 'HR@5': '0.0860', 'NDCG@5': '0.0608', 'HR@10': '0.1193', 'NDCG@10': '0.0715', 'HR@20': '0.1610', 'NDCG@20': '0.0820'}
2025-02-27 16:21:32,122 - EarlyStopping counter: 1 out of 10
2025-02-27 16:21:56,880 - {'epoch': 31, 'rec_loss': '6.8023'}
2025-02-27 16:22:04,867 - {'Epoch': 31, 'HR@5': '0.0850', 'NDCG@5': '0.0604', 'HR@10': '0.1187', 'NDCG@10': '0.0713', 'HR@20': '0.1626', 'NDCG@20': '0.0824'}
2025-02-27 16:22:04,869 - EarlyStopping counter: 2 out of 10
2025-02-27 16:22:29,034 - {'epoch': 32, 'rec_loss': '6.7944'}
2025-02-27 16:22:37,533 - {'Epoch': 32, 'HR@5': '0.0870', 'NDCG@5': '0.0619', 'HR@10': '0.1198', 'NDCG@10': '0.0724', 'HR@20': '0.1637', 'NDCG@20': '0.0834'}
2025-02-27 16:22:37,534 - Validation score increased.  Saving model ...
2025-02-27 16:23:00,984 - {'epoch': 33, 'rec_loss': '6.7907'}
2025-02-27 16:23:09,560 - {'Epoch': 33, 'HR@5': '0.0852', 'NDCG@5': '0.0606', 'HR@10': '0.1176', 'NDCG@10': '0.0711', 'HR@20': '0.1617', 'NDCG@20': '0.0822'}
2025-02-27 16:23:09,561 - EarlyStopping counter: 1 out of 10
2025-02-27 16:23:32,894 - {'epoch': 34, 'rec_loss': '6.7765'}
2025-02-27 16:23:41,541 - {'Epoch': 34, 'HR@5': '0.0868', 'NDCG@5': '0.0612', 'HR@10': '0.1198', 'NDCG@10': '0.0718', 'HR@20': '0.1623', 'NDCG@20': '0.0825'}
2025-02-27 16:23:41,542 - EarlyStopping counter: 2 out of 10
2025-02-27 16:24:04,956 - {'epoch': 35, 'rec_loss': '6.7741'}
2025-02-27 16:24:13,514 - {'Epoch': 35, 'HR@5': '0.0882', 'NDCG@5': '0.0626', 'HR@10': '0.1207', 'NDCG@10': '0.0731', 'HR@20': '0.1624', 'NDCG@20': '0.0836'}
2025-02-27 16:24:13,515 - Validation score increased.  Saving model ...
2025-02-27 16:24:36,826 - {'epoch': 36, 'rec_loss': '6.7712'}
2025-02-27 16:24:44,799 - {'Epoch': 36, 'HR@5': '0.0862', 'NDCG@5': '0.0616', 'HR@10': '0.1209', 'NDCG@10': '0.0728', 'HR@20': '0.1609', 'NDCG@20': '0.0828'}
2025-02-27 16:24:44,800 - EarlyStopping counter: 1 out of 10
2025-02-27 16:25:08,293 - {'epoch': 37, 'rec_loss': '6.7601'}
2025-02-27 16:25:17,043 - {'Epoch': 37, 'HR@5': '0.0877', 'NDCG@5': '0.0623', 'HR@10': '0.1194', 'NDCG@10': '0.0726', 'HR@20': '0.1615', 'NDCG@20': '0.0832'}
2025-02-27 16:25:17,050 - EarlyStopping counter: 2 out of 10
2025-02-27 16:25:40,329 - {'epoch': 38, 'rec_loss': '6.7525'}
2025-02-27 16:25:48,838 - {'Epoch': 38, 'HR@5': '0.0869', 'NDCG@5': '0.0617', 'HR@10': '0.1215', 'NDCG@10': '0.0728', 'HR@20': '0.1620', 'NDCG@20': '0.0830'}
2025-02-27 16:25:48,844 - EarlyStopping counter: 3 out of 10
2025-02-27 16:26:12,080 - {'epoch': 39, 'rec_loss': '6.7481'}
2025-02-27 16:26:20,623 - {'Epoch': 39, 'HR@5': '0.0863', 'NDCG@5': '0.0616', 'HR@10': '0.1210', 'NDCG@10': '0.0728', 'HR@20': '0.1616', 'NDCG@20': '0.0830'}
2025-02-27 16:26:20,629 - EarlyStopping counter: 4 out of 10
2025-02-27 16:26:44,006 - {'epoch': 40, 'rec_loss': '6.7461'}
2025-02-27 16:26:52,380 - {'Epoch': 40, 'HR@5': '0.0883', 'NDCG@5': '0.0624', 'HR@10': '0.1197', 'NDCG@10': '0.0725', 'HR@20': '0.1621', 'NDCG@20': '0.0832'}
2025-02-27 16:26:52,381 - EarlyStopping counter: 5 out of 10
2025-02-27 16:27:15,757 - {'epoch': 41, 'rec_loss': '6.7372'}
2025-02-27 16:27:23,624 - {'Epoch': 41, 'HR@5': '0.0868', 'NDCG@5': '0.0618', 'HR@10': '0.1206', 'NDCG@10': '0.0727', 'HR@20': '0.1638', 'NDCG@20': '0.0836'}
2025-02-27 16:27:23,625 - Validation score increased.  Saving model ...
2025-02-27 16:27:47,044 - {'epoch': 42, 'rec_loss': '6.7297'}
2025-02-27 16:27:55,725 - {'Epoch': 42, 'HR@5': '0.0870', 'NDCG@5': '0.0620', 'HR@10': '0.1215', 'NDCG@10': '0.0731', 'HR@20': '0.1630', 'NDCG@20': '0.0836'}
2025-02-27 16:27:55,727 - EarlyStopping counter: 1 out of 10
2025-02-27 16:28:19,119 - {'epoch': 43, 'rec_loss': '6.7201'}
2025-02-27 16:28:26,788 - {'Epoch': 43, 'HR@5': '0.0874', 'NDCG@5': '0.0622', 'HR@10': '0.1210', 'NDCG@10': '0.0730', 'HR@20': '0.1619', 'NDCG@20': '0.0833'}
2025-02-27 16:28:26,789 - EarlyStopping counter: 2 out of 10
2025-02-27 16:28:50,135 - {'epoch': 44, 'rec_loss': '6.7231'}
2025-02-27 16:28:58,538 - {'Epoch': 44, 'HR@5': '0.0873', 'NDCG@5': '0.0617', 'HR@10': '0.1225', 'NDCG@10': '0.0731', 'HR@20': '0.1625', 'NDCG@20': '0.0831'}
2025-02-27 16:28:58,539 - EarlyStopping counter: 3 out of 10
2025-02-27 16:29:21,762 - {'epoch': 45, 'rec_loss': '6.7176'}
2025-02-27 16:29:30,354 - {'Epoch': 45, 'HR@5': '0.0880', 'NDCG@5': '0.0621', 'HR@10': '0.1218', 'NDCG@10': '0.0730', 'HR@20': '0.1621', 'NDCG@20': '0.0832'}
2025-02-27 16:29:30,355 - EarlyStopping counter: 4 out of 10
2025-02-27 16:29:54,767 - {'epoch': 46, 'rec_loss': '6.7108'}
2025-02-27 16:30:03,226 - {'Epoch': 46, 'HR@5': '0.0871', 'NDCG@5': '0.0617', 'HR@10': '0.1209', 'NDCG@10': '0.0726', 'HR@20': '0.1630', 'NDCG@20': '0.0832'}
2025-02-27 16:30:03,232 - EarlyStopping counter: 5 out of 10
2025-02-27 16:30:26,489 - {'epoch': 47, 'rec_loss': '6.7090'}
2025-02-27 16:30:34,398 - {'Epoch': 47, 'HR@5': '0.0881', 'NDCG@5': '0.0624', 'HR@10': '0.1220', 'NDCG@10': '0.0733', 'HR@20': '0.1625', 'NDCG@20': '0.0835'}
2025-02-27 16:30:34,399 - EarlyStopping counter: 6 out of 10
2025-02-27 16:30:57,899 - {'epoch': 48, 'rec_loss': '6.7032'}
2025-02-27 16:31:06,445 - {'Epoch': 48, 'HR@5': '0.0867', 'NDCG@5': '0.0613', 'HR@10': '0.1211', 'NDCG@10': '0.0724', 'HR@20': '0.1620', 'NDCG@20': '0.0827'}
2025-02-27 16:31:06,450 - EarlyStopping counter: 7 out of 10
2025-02-27 16:31:30,370 - {'epoch': 49, 'rec_loss': '6.6979'}
2025-02-27 16:31:37,956 - {'Epoch': 49, 'HR@5': '0.0883', 'NDCG@5': '0.0623', 'HR@10': '0.1212', 'NDCG@10': '0.0728', 'HR@20': '0.1637', 'NDCG@20': '0.0835'}
2025-02-27 16:31:37,961 - EarlyStopping counter: 8 out of 10
2025-02-27 16:32:01,172 - {'epoch': 50, 'rec_loss': '6.6947'}
2025-02-27 16:32:09,934 - {'Epoch': 50, 'HR@5': '0.0876', 'NDCG@5': '0.0618', 'HR@10': '0.1206', 'NDCG@10': '0.0724', 'HR@20': '0.1627', 'NDCG@20': '0.0830'}
2025-02-27 16:32:09,935 - EarlyStopping counter: 9 out of 10
2025-02-27 16:32:33,427 - {'epoch': 51, 'rec_loss': '6.6916'}
2025-02-27 16:32:41,119 - {'Epoch': 51, 'HR@5': '0.0883', 'NDCG@5': '0.0624', 'HR@10': '0.1211', 'NDCG@10': '0.0730', 'HR@20': '0.1621', 'NDCG@20': '0.0833'}
2025-02-27 16:32:41,120 - EarlyStopping counter: 10 out of 10
2025-02-27 16:32:41,120 - Early stopping
2025-02-27 16:32:41,120 - ---------------Test Score---------------
2025-02-27 16:32:49,628 - {'Epoch': 0, 'HR@5': '0.0712', 'NDCG@5': '0.0510', 'HR@10': '0.0982', 'NDCG@10': '0.0597', 'HR@20': '0.1377', 'NDCG@20': '0.0697'}
2025-02-27 16:32:49,630 - Scale_Beauty
2025-02-27 16:32:49,630 - {'Epoch': 0, 'HR@5': '0.0712', 'NDCG@5': '0.0510', 'HR@10': '0.0982', 'NDCG@10': '0.0597', 'HR@20': '0.1377', 'NDCG@20': '0.0697'}
2025-02-27 17:25:05,201 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-27 17:25:08,268 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=50, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-27 17:25:08,281 - Total Parameters: 931070
2025-02-27 17:25:28,233 - {'epoch': 0, 'rec_loss': '8.9120'}
2025-02-27 17:25:36,492 - {'Epoch': 0, 'HR@5': '0.0134', 'NDCG@5': '0.0082', 'HR@10': '0.0214', 'NDCG@10': '0.0108', 'HR@20': '0.0348', 'NDCG@20': '0.0141'}
2025-02-27 17:25:36,495 - Validation score increased.  Saving model ...
2025-02-27 17:25:57,456 - {'epoch': 1, 'rec_loss': '8.5227'}
2025-02-27 17:26:05,363 - {'Epoch': 1, 'HR@5': '0.0243', 'NDCG@5': '0.0156', 'HR@10': '0.0377', 'NDCG@10': '0.0199', 'HR@20': '0.0568', 'NDCG@20': '0.0247'}
2025-02-27 17:26:05,364 - Validation score increased.  Saving model ...
2025-02-27 17:26:24,750 - {'epoch': 2, 'rec_loss': '8.2827'}
2025-02-27 17:26:32,822 - {'Epoch': 2, 'HR@5': '0.0309', 'NDCG@5': '0.0200', 'HR@10': '0.0521', 'NDCG@10': '0.0268', 'HR@20': '0.0763', 'NDCG@20': '0.0329'}
2025-02-27 17:26:32,823 - Validation score increased.  Saving model ...
2025-02-27 17:26:51,990 - {'epoch': 3, 'rec_loss': '8.0714'}
2025-02-27 17:26:59,677 - {'Epoch': 3, 'HR@5': '0.0437', 'NDCG@5': '0.0287', 'HR@10': '0.0661', 'NDCG@10': '0.0359', 'HR@20': '0.0956', 'NDCG@20': '0.0433'}
2025-02-27 17:26:59,678 - Validation score increased.  Saving model ...
2025-02-27 17:27:17,662 - {'epoch': 4, 'rec_loss': '7.9175'}
2025-02-27 17:27:25,646 - {'Epoch': 4, 'HR@5': '0.0517', 'NDCG@5': '0.0352', 'HR@10': '0.0762', 'NDCG@10': '0.0431', 'HR@20': '0.1105', 'NDCG@20': '0.0517'}
2025-02-27 17:27:25,647 - Validation score increased.  Saving model ...
2025-02-27 17:27:44,125 - {'epoch': 5, 'rec_loss': '7.8012'}
2025-02-27 17:27:51,676 - {'Epoch': 5, 'HR@5': '0.0575', 'NDCG@5': '0.0386', 'HR@10': '0.0845', 'NDCG@10': '0.0473', 'HR@20': '0.1195', 'NDCG@20': '0.0561'}
2025-02-27 17:27:51,677 - Validation score increased.  Saving model ...
2025-02-27 17:28:11,163 - {'epoch': 6, 'rec_loss': '7.7080'}
2025-02-27 17:28:19,134 - {'Epoch': 6, 'HR@5': '0.0644', 'NDCG@5': '0.0439', 'HR@10': '0.0911', 'NDCG@10': '0.0525', 'HR@20': '0.1282', 'NDCG@20': '0.0618'}
2025-02-27 17:28:19,136 - Validation score increased.  Saving model ...
2025-02-27 17:28:38,390 - {'epoch': 7, 'rec_loss': '7.6239'}
2025-02-27 17:28:46,204 - {'Epoch': 7, 'HR@5': '0.0675', 'NDCG@5': '0.0468', 'HR@10': '0.0959', 'NDCG@10': '0.0559', 'HR@20': '0.1340', 'NDCG@20': '0.0654'}
2025-02-27 17:28:46,205 - Validation score increased.  Saving model ...
2025-02-27 17:29:05,972 - {'epoch': 8, 'rec_loss': '7.5636'}
2025-02-27 17:29:13,447 - {'Epoch': 8, 'HR@5': '0.0704', 'NDCG@5': '0.0490', 'HR@10': '0.1011', 'NDCG@10': '0.0589', 'HR@20': '0.1383', 'NDCG@20': '0.0682'}
2025-02-27 17:29:13,448 - Validation score increased.  Saving model ...
2025-02-27 17:29:31,139 - {'epoch': 9, 'rec_loss': '7.5036'}
2025-02-27 17:29:39,063 - {'Epoch': 9, 'HR@5': '0.0724', 'NDCG@5': '0.0505', 'HR@10': '0.1025', 'NDCG@10': '0.0601', 'HR@20': '0.1431', 'NDCG@20': '0.0704'}
2025-02-27 17:29:39,064 - Validation score increased.  Saving model ...
2025-02-27 17:29:58,180 - {'epoch': 10, 'rec_loss': '7.4560'}
2025-02-27 17:30:05,751 - {'Epoch': 10, 'HR@5': '0.0758', 'NDCG@5': '0.0529', 'HR@10': '0.1052', 'NDCG@10': '0.0623', 'HR@20': '0.1457', 'NDCG@20': '0.0725'}
2025-02-27 17:30:05,752 - Validation score increased.  Saving model ...
2025-02-27 17:30:25,021 - {'epoch': 11, 'rec_loss': '7.4087'}
2025-02-27 17:30:32,638 - {'Epoch': 11, 'HR@5': '0.0770', 'NDCG@5': '0.0548', 'HR@10': '0.1083', 'NDCG@10': '0.0648', 'HR@20': '0.1480', 'NDCG@20': '0.0748'}
2025-02-27 17:30:32,639 - Validation score increased.  Saving model ...
2025-02-27 17:30:52,695 - {'epoch': 12, 'rec_loss': '7.3744'}
2025-02-27 17:31:00,776 - {'Epoch': 12, 'HR@5': '0.0773', 'NDCG@5': '0.0539', 'HR@10': '0.1086', 'NDCG@10': '0.0640', 'HR@20': '0.1483', 'NDCG@20': '0.0740'}
2025-02-27 17:31:00,777 - EarlyStopping counter: 1 out of 10
2025-02-27 17:31:21,628 - {'epoch': 13, 'rec_loss': '7.3412'}
2025-02-27 17:31:29,309 - {'Epoch': 13, 'HR@5': '0.0787', 'NDCG@5': '0.0556', 'HR@10': '0.1100', 'NDCG@10': '0.0657', 'HR@20': '0.1502', 'NDCG@20': '0.0758'}
2025-02-27 17:31:29,310 - Validation score increased.  Saving model ...
2025-02-27 17:31:46,896 - {'epoch': 14, 'rec_loss': '7.3084'}
2025-02-27 17:31:54,025 - {'Epoch': 14, 'HR@5': '0.0814', 'NDCG@5': '0.0574', 'HR@10': '0.1119', 'NDCG@10': '0.0672', 'HR@20': '0.1522', 'NDCG@20': '0.0773'}
2025-02-27 17:31:54,026 - Validation score increased.  Saving model ...
2025-02-27 17:32:11,678 - {'epoch': 15, 'rec_loss': '7.2830'}
2025-02-27 17:32:19,177 - {'Epoch': 15, 'HR@5': '0.0808', 'NDCG@5': '0.0567', 'HR@10': '0.1128', 'NDCG@10': '0.0670', 'HR@20': '0.1538', 'NDCG@20': '0.0773'}
2025-02-27 17:32:19,178 - EarlyStopping counter: 1 out of 10
2025-02-27 17:32:36,143 - {'epoch': 16, 'rec_loss': '7.2576'}
2025-02-27 17:32:43,301 - {'Epoch': 16, 'HR@5': '0.0816', 'NDCG@5': '0.0570', 'HR@10': '0.1130', 'NDCG@10': '0.0671', 'HR@20': '0.1552', 'NDCG@20': '0.0777'}
2025-02-27 17:32:43,302 - Validation score increased.  Saving model ...
2025-02-27 17:33:01,632 - {'epoch': 17, 'rec_loss': '7.2311'}
2025-02-27 17:33:08,520 - {'Epoch': 17, 'HR@5': '0.0832', 'NDCG@5': '0.0581', 'HR@10': '0.1151', 'NDCG@10': '0.0684', 'HR@20': '0.1562', 'NDCG@20': '0.0787'}
2025-02-27 17:33:08,521 - Validation score increased.  Saving model ...
2025-02-27 17:33:26,249 - {'epoch': 18, 'rec_loss': '7.2199'}
2025-02-27 17:33:33,463 - {'Epoch': 18, 'HR@5': '0.0831', 'NDCG@5': '0.0581', 'HR@10': '0.1153', 'NDCG@10': '0.0684', 'HR@20': '0.1564', 'NDCG@20': '0.0788'}
2025-02-27 17:33:33,464 - Validation score increased.  Saving model ...
2025-02-27 17:33:52,310 - {'epoch': 19, 'rec_loss': '7.1958'}
2025-02-27 17:33:59,431 - {'Epoch': 19, 'HR@5': '0.0831', 'NDCG@5': '0.0592', 'HR@10': '0.1161', 'NDCG@10': '0.0698', 'HR@20': '0.1574', 'NDCG@20': '0.0802'}
2025-02-27 17:33:59,431 - Validation score increased.  Saving model ...
2025-02-27 17:34:19,645 - {'epoch': 20, 'rec_loss': '7.1707'}
2025-02-27 17:34:26,648 - {'Epoch': 20, 'HR@5': '0.0842', 'NDCG@5': '0.0587', 'HR@10': '0.1164', 'NDCG@10': '0.0690', 'HR@20': '0.1600', 'NDCG@20': '0.0800'}
2025-02-27 17:34:26,649 - EarlyStopping counter: 1 out of 10
2025-02-27 17:34:47,355 - {'epoch': 21, 'rec_loss': '7.1628'}
2025-02-27 17:34:54,471 - {'Epoch': 21, 'HR@5': '0.0848', 'NDCG@5': '0.0596', 'HR@10': '0.1190', 'NDCG@10': '0.0706', 'HR@20': '0.1594', 'NDCG@20': '0.0807'}
2025-02-27 17:34:54,472 - Validation score increased.  Saving model ...
2025-02-27 17:35:12,865 - {'epoch': 22, 'rec_loss': '7.1385'}
2025-02-27 17:35:19,841 - {'Epoch': 22, 'HR@5': '0.0850', 'NDCG@5': '0.0600', 'HR@10': '0.1182', 'NDCG@10': '0.0707', 'HR@20': '0.1596', 'NDCG@20': '0.0811'}
2025-02-27 17:35:19,842 - Validation score increased.  Saving model ...
2025-02-27 17:35:37,981 - {'epoch': 23, 'rec_loss': '7.1331'}
2025-02-27 17:35:44,970 - {'Epoch': 23, 'HR@5': '0.0853', 'NDCG@5': '0.0594', 'HR@10': '0.1172', 'NDCG@10': '0.0697', 'HR@20': '0.1609', 'NDCG@20': '0.0807'}
2025-02-27 17:35:44,971 - EarlyStopping counter: 1 out of 10
2025-02-27 17:36:02,297 - {'epoch': 24, 'rec_loss': '7.1220'}
2025-02-27 17:36:10,084 - {'Epoch': 24, 'HR@5': '0.0845', 'NDCG@5': '0.0594', 'HR@10': '0.1188', 'NDCG@10': '0.0705', 'HR@20': '0.1626', 'NDCG@20': '0.0815'}
2025-02-27 17:36:10,085 - Validation score increased.  Saving model ...
2025-02-27 17:36:29,165 - {'epoch': 25, 'rec_loss': '7.1045'}
2025-02-27 17:36:37,447 - {'Epoch': 25, 'HR@5': '0.0851', 'NDCG@5': '0.0598', 'HR@10': '0.1189', 'NDCG@10': '0.0707', 'HR@20': '0.1622', 'NDCG@20': '0.0816'}
2025-02-27 17:36:37,448 - Validation score increased.  Saving model ...
2025-02-27 17:36:56,228 - {'epoch': 26, 'rec_loss': '7.0988'}
2025-02-27 17:37:04,945 - {'Epoch': 26, 'HR@5': '0.0866', 'NDCG@5': '0.0604', 'HR@10': '0.1191', 'NDCG@10': '0.0708', 'HR@20': '0.1624', 'NDCG@20': '0.0817'}
2025-02-27 17:37:04,946 - Validation score increased.  Saving model ...
2025-02-27 17:37:24,032 - {'epoch': 27, 'rec_loss': '7.0841'}
2025-02-27 17:37:32,707 - {'Epoch': 27, 'HR@5': '0.0844', 'NDCG@5': '0.0597', 'HR@10': '0.1202', 'NDCG@10': '0.0713', 'HR@20': '0.1629', 'NDCG@20': '0.0820'}
2025-02-27 17:37:32,708 - Validation score increased.  Saving model ...
2025-02-27 17:37:52,394 - {'epoch': 28, 'rec_loss': '7.0765'}
2025-02-27 17:38:00,742 - {'Epoch': 28, 'HR@5': '0.0848', 'NDCG@5': '0.0599', 'HR@10': '0.1198', 'NDCG@10': '0.0712', 'HR@20': '0.1616', 'NDCG@20': '0.0817'}
2025-02-27 17:38:00,743 - EarlyStopping counter: 1 out of 10
2025-02-27 17:38:19,356 - {'epoch': 29, 'rec_loss': '7.0726'}
2025-02-27 17:38:27,925 - {'Epoch': 29, 'HR@5': '0.0861', 'NDCG@5': '0.0608', 'HR@10': '0.1188', 'NDCG@10': '0.0713', 'HR@20': '0.1621', 'NDCG@20': '0.0822'}
2025-02-27 17:38:27,927 - Validation score increased.  Saving model ...
2025-02-27 17:38:46,761 - {'epoch': 30, 'rec_loss': '7.0591'}
2025-02-27 17:38:55,350 - {'Epoch': 30, 'HR@5': '0.0860', 'NDCG@5': '0.0608', 'HR@10': '0.1193', 'NDCG@10': '0.0715', 'HR@20': '0.1632', 'NDCG@20': '0.0825'}
2025-02-27 17:38:55,351 - Validation score increased.  Saving model ...
2025-02-27 17:39:14,932 - {'epoch': 31, 'rec_loss': '7.0511'}
2025-02-27 17:39:23,646 - {'Epoch': 31, 'HR@5': '0.0863', 'NDCG@5': '0.0607', 'HR@10': '0.1203', 'NDCG@10': '0.0717', 'HR@20': '0.1629', 'NDCG@20': '0.0824'}
2025-02-27 17:39:23,654 - EarlyStopping counter: 1 out of 10
2025-02-27 17:39:42,487 - {'epoch': 32, 'rec_loss': '7.0456'}
2025-02-27 17:39:50,882 - {'Epoch': 32, 'HR@5': '0.0862', 'NDCG@5': '0.0610', 'HR@10': '0.1203', 'NDCG@10': '0.0720', 'HR@20': '0.1627', 'NDCG@20': '0.0826'}
2025-02-27 17:39:50,883 - Validation score increased.  Saving model ...
2025-02-27 17:40:10,157 - {'epoch': 33, 'rec_loss': '7.0359'}
2025-02-27 17:40:18,627 - {'Epoch': 33, 'HR@5': '0.0867', 'NDCG@5': '0.0610', 'HR@10': '0.1199', 'NDCG@10': '0.0717', 'HR@20': '0.1638', 'NDCG@20': '0.0827'}
2025-02-27 17:40:18,629 - Validation score increased.  Saving model ...
2025-02-27 17:40:37,958 - {'epoch': 34, 'rec_loss': '7.0193'}
2025-02-27 17:40:46,599 - {'Epoch': 34, 'HR@5': '0.0873', 'NDCG@5': '0.0611', 'HR@10': '0.1206', 'NDCG@10': '0.0718', 'HR@20': '0.1622', 'NDCG@20': '0.0823'}
2025-02-27 17:40:46,600 - EarlyStopping counter: 1 out of 10
2025-02-27 17:41:05,362 - {'epoch': 35, 'rec_loss': '7.0297'}
2025-02-27 17:41:13,733 - {'Epoch': 35, 'HR@5': '0.0873', 'NDCG@5': '0.0611', 'HR@10': '0.1211', 'NDCG@10': '0.0720', 'HR@20': '0.1639', 'NDCG@20': '0.0827'}
2025-02-27 17:41:13,735 - EarlyStopping counter: 2 out of 10
2025-02-27 17:41:33,659 - {'epoch': 36, 'rec_loss': '7.0148'}
2025-02-27 17:41:41,872 - {'Epoch': 36, 'HR@5': '0.0872', 'NDCG@5': '0.0611', 'HR@10': '0.1189', 'NDCG@10': '0.0713', 'HR@20': '0.1637', 'NDCG@20': '0.0826'}
2025-02-27 17:41:41,873 - EarlyStopping counter: 3 out of 10
2025-02-27 17:42:01,170 - {'epoch': 37, 'rec_loss': '7.0129'}
2025-02-27 17:42:09,637 - {'Epoch': 37, 'HR@5': '0.0863', 'NDCG@5': '0.0606', 'HR@10': '0.1211', 'NDCG@10': '0.0718', 'HR@20': '0.1636', 'NDCG@20': '0.0825'}
2025-02-27 17:42:09,638 - EarlyStopping counter: 4 out of 10
2025-02-27 17:42:28,824 - {'epoch': 38, 'rec_loss': '7.0039'}
2025-02-27 17:42:37,240 - {'Epoch': 38, 'HR@5': '0.0852', 'NDCG@5': '0.0605', 'HR@10': '0.1203', 'NDCG@10': '0.0719', 'HR@20': '0.1638', 'NDCG@20': '0.0828'}
2025-02-27 17:42:37,241 - Validation score increased.  Saving model ...
2025-02-27 17:42:56,578 - {'epoch': 39, 'rec_loss': '7.0078'}
2025-02-27 17:43:05,148 - {'Epoch': 39, 'HR@5': '0.0859', 'NDCG@5': '0.0607', 'HR@10': '0.1210', 'NDCG@10': '0.0721', 'HR@20': '0.1636', 'NDCG@20': '0.0828'}
2025-02-27 17:43:05,150 - Validation score increased.  Saving model ...
2025-02-27 17:43:24,513 - {'epoch': 40, 'rec_loss': '6.9888'}
2025-02-27 17:43:33,356 - {'Epoch': 40, 'HR@5': '0.0855', 'NDCG@5': '0.0608', 'HR@10': '0.1209', 'NDCG@10': '0.0721', 'HR@20': '0.1644', 'NDCG@20': '0.0831'}
2025-02-27 17:43:33,357 - Validation score increased.  Saving model ...
2025-02-27 17:43:51,778 - {'epoch': 41, 'rec_loss': '6.9838'}
2025-02-27 17:44:00,763 - {'Epoch': 41, 'HR@5': '0.0870', 'NDCG@5': '0.0617', 'HR@10': '0.1198', 'NDCG@10': '0.0723', 'HR@20': '0.1641', 'NDCG@20': '0.0835'}
2025-02-27 17:44:00,771 - Validation score increased.  Saving model ...
2025-02-27 17:44:19,684 - {'epoch': 42, 'rec_loss': '6.9859'}
2025-02-27 17:44:28,232 - {'Epoch': 42, 'HR@5': '0.0882', 'NDCG@5': '0.0617', 'HR@10': '0.1202', 'NDCG@10': '0.0720', 'HR@20': '0.1650', 'NDCG@20': '0.0832'}
2025-02-27 17:44:28,233 - EarlyStopping counter: 1 out of 10
2025-02-27 17:44:46,825 - {'epoch': 43, 'rec_loss': '6.9729'}
2025-02-27 17:44:55,451 - {'Epoch': 43, 'HR@5': '0.0881', 'NDCG@5': '0.0615', 'HR@10': '0.1216', 'NDCG@10': '0.0722', 'HR@20': '0.1651', 'NDCG@20': '0.0831'}
2025-02-27 17:44:55,452 - EarlyStopping counter: 2 out of 10
2025-02-27 17:45:14,154 - {'epoch': 44, 'rec_loss': '6.9695'}
2025-02-27 17:45:22,683 - {'Epoch': 44, 'HR@5': '0.0863', 'NDCG@5': '0.0605', 'HR@10': '0.1216', 'NDCG@10': '0.0719', 'HR@20': '0.1642', 'NDCG@20': '0.0826'}
2025-02-27 17:45:22,684 - EarlyStopping counter: 3 out of 10
2025-02-27 17:45:42,081 - {'epoch': 45, 'rec_loss': '6.9643'}
2025-02-27 17:45:50,380 - {'Epoch': 45, 'HR@5': '0.0872', 'NDCG@5': '0.0615', 'HR@10': '0.1216', 'NDCG@10': '0.0725', 'HR@20': '0.1652', 'NDCG@20': '0.0835'}
2025-02-27 17:45:50,381 - Validation score increased.  Saving model ...
2025-02-27 17:46:09,538 - {'epoch': 46, 'rec_loss': '6.9622'}
2025-02-27 17:46:18,426 - {'Epoch': 46, 'HR@5': '0.0862', 'NDCG@5': '0.0615', 'HR@10': '0.1210', 'NDCG@10': '0.0728', 'HR@20': '0.1659', 'NDCG@20': '0.0841'}
2025-02-27 17:46:18,428 - Validation score increased.  Saving model ...
2025-02-27 17:46:37,084 - {'epoch': 47, 'rec_loss': '6.9550'}
2025-02-27 17:46:45,590 - {'Epoch': 47, 'HR@5': '0.0866', 'NDCG@5': '0.0619', 'HR@10': '0.1205', 'NDCG@10': '0.0728', 'HR@20': '0.1653', 'NDCG@20': '0.0841'}
2025-02-27 17:46:45,592 - Validation score increased.  Saving model ...
2025-02-27 17:47:04,524 - {'epoch': 48, 'rec_loss': '6.9526'}
2025-02-27 17:47:12,944 - {'Epoch': 48, 'HR@5': '0.0878', 'NDCG@5': '0.0618', 'HR@10': '0.1217', 'NDCG@10': '0.0727', 'HR@20': '0.1664', 'NDCG@20': '0.0840'}
2025-02-27 17:47:12,945 - EarlyStopping counter: 1 out of 10
2025-02-27 17:47:31,635 - {'epoch': 49, 'rec_loss': '6.9553'}
2025-02-27 17:47:40,161 - {'Epoch': 49, 'HR@5': '0.0877', 'NDCG@5': '0.0619', 'HR@10': '0.1199', 'NDCG@10': '0.0723', 'HR@20': '0.1637', 'NDCG@20': '0.0833'}
2025-02-27 17:47:40,162 - EarlyStopping counter: 2 out of 10
2025-02-27 17:47:58,921 - {'epoch': 50, 'rec_loss': '6.9447'}
2025-02-27 17:48:07,109 - {'Epoch': 50, 'HR@5': '0.0874', 'NDCG@5': '0.0621', 'HR@10': '0.1205', 'NDCG@10': '0.0728', 'HR@20': '0.1638', 'NDCG@20': '0.0837'}
2025-02-27 17:48:07,110 - EarlyStopping counter: 3 out of 10
2025-02-27 17:48:26,327 - {'epoch': 51, 'rec_loss': '6.9470'}
2025-02-27 17:48:34,865 - {'Epoch': 51, 'HR@5': '0.0876', 'NDCG@5': '0.0623', 'HR@10': '0.1203', 'NDCG@10': '0.0728', 'HR@20': '0.1643', 'NDCG@20': '0.0839'}
2025-02-27 17:48:34,866 - EarlyStopping counter: 4 out of 10
2025-02-27 17:48:53,782 - {'epoch': 52, 'rec_loss': '6.9455'}
2025-02-27 17:49:02,567 - {'Epoch': 52, 'HR@5': '0.0874', 'NDCG@5': '0.0620', 'HR@10': '0.1210', 'NDCG@10': '0.0728', 'HR@20': '0.1652', 'NDCG@20': '0.0840'}
2025-02-27 17:49:02,568 - EarlyStopping counter: 5 out of 10
2025-02-27 17:49:21,512 - {'epoch': 53, 'rec_loss': '6.9391'}
2025-02-27 17:49:30,528 - {'Epoch': 53, 'HR@5': '0.0876', 'NDCG@5': '0.0625', 'HR@10': '0.1212', 'NDCG@10': '0.0732', 'HR@20': '0.1633', 'NDCG@20': '0.0839'}
2025-02-27 17:49:30,533 - EarlyStopping counter: 6 out of 10
2025-02-27 17:49:49,607 - {'epoch': 54, 'rec_loss': '6.9352'}
2025-02-27 17:49:57,978 - {'Epoch': 54, 'HR@5': '0.0876', 'NDCG@5': '0.0621', 'HR@10': '0.1206', 'NDCG@10': '0.0727', 'HR@20': '0.1646', 'NDCG@20': '0.0838'}
2025-02-27 17:49:57,979 - EarlyStopping counter: 7 out of 10
2025-02-27 17:50:16,984 - {'epoch': 55, 'rec_loss': '6.9372'}
2025-02-27 17:50:25,385 - {'Epoch': 55, 'HR@5': '0.0889', 'NDCG@5': '0.0628', 'HR@10': '0.1206', 'NDCG@10': '0.0730', 'HR@20': '0.1639', 'NDCG@20': '0.0839'}
2025-02-27 17:50:25,386 - EarlyStopping counter: 8 out of 10
2025-02-27 17:50:44,351 - {'epoch': 56, 'rec_loss': '6.9245'}
2025-02-27 17:50:53,076 - {'Epoch': 56, 'HR@5': '0.0877', 'NDCG@5': '0.0620', 'HR@10': '0.1211', 'NDCG@10': '0.0727', 'HR@20': '0.1634', 'NDCG@20': '0.0833'}
2025-02-27 17:50:53,077 - EarlyStopping counter: 9 out of 10
2025-02-27 17:51:11,641 - {'epoch': 57, 'rec_loss': '6.9248'}
2025-02-27 17:51:19,732 - {'Epoch': 57, 'HR@5': '0.0865', 'NDCG@5': '0.0608', 'HR@10': '0.1199', 'NDCG@10': '0.0716', 'HR@20': '0.1640', 'NDCG@20': '0.0827'}
2025-02-27 17:51:19,733 - EarlyStopping counter: 10 out of 10
2025-02-27 17:51:19,733 - Early stopping
2025-02-27 17:51:19,733 - ---------------Test Score---------------
2025-02-27 17:51:28,641 - {'Epoch': 0, 'HR@5': '0.0711', 'NDCG@5': '0.0504', 'HR@10': '0.0979', 'NDCG@10': '0.0590', 'HR@20': '0.1363', 'NDCG@20': '0.0686'}
2025-02-27 17:51:28,642 - Scale_Beauty
2025-02-27 17:51:28,642 - {'Epoch': 0, 'HR@5': '0.0711', 'NDCG@5': '0.0504', 'HR@10': '0.0979', 'NDCG@10': '0.0590', 'HR@20': '0.1363', 'NDCG@20': '0.0686'}
2025-02-27 19:29:45,856 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 16, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-27 19:29:52,256 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-27 19:29:52,282 - Total Parameters: 929445
2025-02-27 19:30:26,704 - {'epoch': 0, 'rec_loss': '8.8357'}
2025-02-27 19:30:35,692 - {'Epoch': 0, 'HR@5': '0.0204', 'NDCG@5': '0.0128', 'HR@10': '0.0309', 'NDCG@10': '0.0162', 'HR@20': '0.0474', 'NDCG@20': '0.0203'}
2025-02-27 19:30:35,693 - Validation score increased.  Saving model ...
2025-02-27 19:31:06,647 - {'epoch': 1, 'rec_loss': '8.3282'}
2025-02-27 19:31:16,211 - {'Epoch': 1, 'HR@5': '0.0374', 'NDCG@5': '0.0253', 'HR@10': '0.0566', 'NDCG@10': '0.0315', 'HR@20': '0.0823', 'NDCG@20': '0.0379'}
2025-02-27 19:31:16,212 - Validation score increased.  Saving model ...
2025-02-27 19:31:48,944 - {'epoch': 2, 'rec_loss': '8.0164'}
2025-02-27 19:31:57,501 - {'Epoch': 2, 'HR@5': '0.0490', 'NDCG@5': '0.0331', 'HR@10': '0.0726', 'NDCG@10': '0.0407', 'HR@20': '0.1046', 'NDCG@20': '0.0487'}
2025-02-27 19:31:57,502 - Validation score increased.  Saving model ...
2025-02-27 19:32:27,020 - {'epoch': 3, 'rec_loss': '7.7998'}
2025-02-27 19:32:35,594 - {'Epoch': 3, 'HR@5': '0.0594', 'NDCG@5': '0.0405', 'HR@10': '0.0859', 'NDCG@10': '0.0490', 'HR@20': '0.1231', 'NDCG@20': '0.0585'}
2025-02-27 19:32:35,595 - Validation score increased.  Saving model ...
2025-02-27 19:33:09,355 - {'epoch': 4, 'rec_loss': '7.6365'}
2025-02-27 19:33:17,659 - {'Epoch': 4, 'HR@5': '0.0683', 'NDCG@5': '0.0473', 'HR@10': '0.0951', 'NDCG@10': '0.0559', 'HR@20': '0.1329', 'NDCG@20': '0.0654'}
2025-02-27 19:33:17,665 - Validation score increased.  Saving model ...
2025-02-27 19:33:47,279 - {'epoch': 5, 'rec_loss': '7.5211'}
2025-02-27 19:33:55,680 - {'Epoch': 5, 'HR@5': '0.0730', 'NDCG@5': '0.0508', 'HR@10': '0.1028', 'NDCG@10': '0.0604', 'HR@20': '0.1404', 'NDCG@20': '0.0698'}
2025-02-27 19:33:55,681 - Validation score increased.  Saving model ...
2025-02-27 19:34:27,456 - {'epoch': 6, 'rec_loss': '7.4233'}
2025-02-27 19:34:36,140 - {'Epoch': 6, 'HR@5': '0.0760', 'NDCG@5': '0.0534', 'HR@10': '0.1054', 'NDCG@10': '0.0629', 'HR@20': '0.1444', 'NDCG@20': '0.0727'}
2025-02-27 19:34:36,142 - Validation score increased.  Saving model ...
2025-02-27 19:35:05,926 - {'epoch': 7, 'rec_loss': '7.3446'}
2025-02-27 19:35:14,529 - {'Epoch': 7, 'HR@5': '0.0800', 'NDCG@5': '0.0563', 'HR@10': '0.1078', 'NDCG@10': '0.0652', 'HR@20': '0.1482', 'NDCG@20': '0.0754'}
2025-02-27 19:35:14,530 - Validation score increased.  Saving model ...
2025-02-27 19:35:46,639 - {'epoch': 8, 'rec_loss': '7.2736'}
2025-02-27 19:35:54,991 - {'Epoch': 8, 'HR@5': '0.0820', 'NDCG@5': '0.0578', 'HR@10': '0.1109', 'NDCG@10': '0.0671', 'HR@20': '0.1499', 'NDCG@20': '0.0769'}
2025-02-27 19:35:54,994 - Validation score increased.  Saving model ...
2025-02-27 19:36:25,188 - {'epoch': 9, 'rec_loss': '7.2244'}
2025-02-27 19:36:33,603 - {'Epoch': 9, 'HR@5': '0.0811', 'NDCG@5': '0.0569', 'HR@10': '0.1128', 'NDCG@10': '0.0671', 'HR@20': '0.1518', 'NDCG@20': '0.0769'}
2025-02-27 19:36:33,604 - EarlyStopping counter: 1 out of 10
2025-02-27 19:37:06,906 - {'epoch': 10, 'rec_loss': '7.1772'}
2025-02-27 19:37:15,662 - {'Epoch': 10, 'HR@5': '0.0832', 'NDCG@5': '0.0588', 'HR@10': '0.1130', 'NDCG@10': '0.0684', 'HR@20': '0.1524', 'NDCG@20': '0.0783'}
2025-02-27 19:37:15,663 - Validation score increased.  Saving model ...
2025-02-27 19:37:46,237 - {'epoch': 11, 'rec_loss': '7.1377'}
2025-02-27 19:37:55,411 - {'Epoch': 11, 'HR@5': '0.0836', 'NDCG@5': '0.0595', 'HR@10': '0.1141', 'NDCG@10': '0.0694', 'HR@20': '0.1538', 'NDCG@20': '0.0794'}
2025-02-27 19:37:55,412 - Validation score increased.  Saving model ...
2025-02-27 19:38:28,485 - {'epoch': 12, 'rec_loss': '7.1006'}
2025-02-27 19:38:37,008 - {'Epoch': 12, 'HR@5': '0.0842', 'NDCG@5': '0.0596', 'HR@10': '0.1150', 'NDCG@10': '0.0695', 'HR@20': '0.1570', 'NDCG@20': '0.0801'}
2025-02-27 19:38:37,010 - Validation score increased.  Saving model ...
2025-02-27 19:39:13,605 - {'epoch': 13, 'rec_loss': '7.0746'}
2025-02-27 19:39:22,117 - {'Epoch': 13, 'HR@5': '0.0844', 'NDCG@5': '0.0593', 'HR@10': '0.1182', 'NDCG@10': '0.0703', 'HR@20': '0.1584', 'NDCG@20': '0.0804'}
2025-02-27 19:39:22,119 - Validation score increased.  Saving model ...
2025-02-27 19:39:56,513 - {'epoch': 14, 'rec_loss': '7.0429'}
2025-02-27 19:40:05,492 - {'Epoch': 14, 'HR@5': '0.0868', 'NDCG@5': '0.0604', 'HR@10': '0.1183', 'NDCG@10': '0.0705', 'HR@20': '0.1599', 'NDCG@20': '0.0810'}
2025-02-27 19:40:05,494 - Validation score increased.  Saving model ...
2025-02-27 19:40:36,686 - {'epoch': 15, 'rec_loss': '7.0236'}
2025-02-27 19:40:45,316 - {'Epoch': 15, 'HR@5': '0.0859', 'NDCG@5': '0.0603', 'HR@10': '0.1187', 'NDCG@10': '0.0709', 'HR@20': '0.1606', 'NDCG@20': '0.0814'}
2025-02-27 19:40:45,318 - Validation score increased.  Saving model ...
2025-02-27 19:41:20,050 - {'epoch': 16, 'rec_loss': '7.0005'}
2025-02-27 19:41:28,753 - {'Epoch': 16, 'HR@5': '0.0866', 'NDCG@5': '0.0605', 'HR@10': '0.1188', 'NDCG@10': '0.0709', 'HR@20': '0.1611', 'NDCG@20': '0.0815'}
2025-02-27 19:41:28,755 - Validation score increased.  Saving model ...
2025-02-27 19:41:59,367 - {'epoch': 17, 'rec_loss': '6.9850'}
2025-02-27 19:42:08,385 - {'Epoch': 17, 'HR@5': '0.0844', 'NDCG@5': '0.0606', 'HR@10': '0.1195', 'NDCG@10': '0.0719', 'HR@20': '0.1612', 'NDCG@20': '0.0824'}
2025-02-27 19:42:08,392 - Validation score increased.  Saving model ...
2025-02-27 19:42:45,232 - {'epoch': 18, 'rec_loss': '6.9522'}
2025-02-27 19:42:53,755 - {'Epoch': 18, 'HR@5': '0.0863', 'NDCG@5': '0.0606', 'HR@10': '0.1189', 'NDCG@10': '0.0711', 'HR@20': '0.1612', 'NDCG@20': '0.0818'}
2025-02-27 19:42:53,756 - EarlyStopping counter: 1 out of 10
2025-02-27 19:43:28,932 - {'epoch': 19, 'rec_loss': '6.9423'}
2025-02-27 19:43:37,298 - {'Epoch': 19, 'HR@5': '0.0860', 'NDCG@5': '0.0615', 'HR@10': '0.1183', 'NDCG@10': '0.0719', 'HR@20': '0.1617', 'NDCG@20': '0.0828'}
2025-02-27 19:43:37,300 - Validation score increased.  Saving model ...
2025-02-27 19:44:12,697 - {'epoch': 20, 'rec_loss': '6.9223'}
2025-02-27 19:44:21,243 - {'Epoch': 20, 'HR@5': '0.0863', 'NDCG@5': '0.0613', 'HR@10': '0.1204', 'NDCG@10': '0.0724', 'HR@20': '0.1625', 'NDCG@20': '0.0830'}
2025-02-27 19:44:21,244 - Validation score increased.  Saving model ...
2025-02-27 19:45:00,206 - {'epoch': 21, 'rec_loss': '6.9133'}
2025-02-27 19:45:08,827 - {'Epoch': 21, 'HR@5': '0.0872', 'NDCG@5': '0.0617', 'HR@10': '0.1206', 'NDCG@10': '0.0725', 'HR@20': '0.1625', 'NDCG@20': '0.0830'}
2025-02-27 19:45:08,828 - Validation score increased.  Saving model ...
2025-02-27 19:45:44,253 - {'epoch': 22, 'rec_loss': '6.9027'}
2025-02-27 19:45:53,049 - {'Epoch': 22, 'HR@5': '0.0874', 'NDCG@5': '0.0619', 'HR@10': '0.1213', 'NDCG@10': '0.0728', 'HR@20': '0.1636', 'NDCG@20': '0.0834'}
2025-02-27 19:45:53,055 - Validation score increased.  Saving model ...
2025-02-27 19:46:29,973 - {'epoch': 23, 'rec_loss': '6.8853'}
2025-02-27 19:46:38,737 - {'Epoch': 23, 'HR@5': '0.0884', 'NDCG@5': '0.0626', 'HR@10': '0.1212', 'NDCG@10': '0.0731', 'HR@20': '0.1624', 'NDCG@20': '0.0834'}
2025-02-27 19:46:38,743 - EarlyStopping counter: 1 out of 10
2025-02-27 19:47:10,582 - {'epoch': 24, 'rec_loss': '6.8781'}
2025-02-27 19:47:20,274 - {'Epoch': 24, 'HR@5': '0.0884', 'NDCG@5': '0.0620', 'HR@10': '0.1203', 'NDCG@10': '0.0722', 'HR@20': '0.1627', 'NDCG@20': '0.0829'}
2025-02-27 19:47:20,275 - EarlyStopping counter: 2 out of 10
2025-02-27 19:47:58,572 - {'epoch': 25, 'rec_loss': '6.8581'}
2025-02-27 19:48:07,328 - {'Epoch': 25, 'HR@5': '0.0873', 'NDCG@5': '0.0614', 'HR@10': '0.1210', 'NDCG@10': '0.0723', 'HR@20': '0.1634', 'NDCG@20': '0.0830'}
2025-02-27 19:48:07,330 - EarlyStopping counter: 3 out of 10
2025-02-27 19:48:41,598 - {'epoch': 26, 'rec_loss': '6.8536'}
2025-02-27 19:48:50,245 - {'Epoch': 26, 'HR@5': '0.0878', 'NDCG@5': '0.0619', 'HR@10': '0.1212', 'NDCG@10': '0.0727', 'HR@20': '0.1634', 'NDCG@20': '0.0833'}
2025-02-27 19:48:50,246 - EarlyStopping counter: 4 out of 10
2025-02-27 19:49:26,565 - {'epoch': 27, 'rec_loss': '6.8385'}
2025-02-27 19:49:34,869 - {'Epoch': 27, 'HR@5': '0.0872', 'NDCG@5': '0.0619', 'HR@10': '0.1200', 'NDCG@10': '0.0725', 'HR@20': '0.1623', 'NDCG@20': '0.0831'}
2025-02-27 19:49:34,870 - EarlyStopping counter: 5 out of 10
2025-02-27 19:50:08,557 - {'epoch': 28, 'rec_loss': '6.8341'}
2025-02-27 19:50:17,320 - {'Epoch': 28, 'HR@5': '0.0878', 'NDCG@5': '0.0619', 'HR@10': '0.1219', 'NDCG@10': '0.0728', 'HR@20': '0.1628', 'NDCG@20': '0.0831'}
2025-02-27 19:50:17,322 - EarlyStopping counter: 6 out of 10
2025-02-27 19:50:53,033 - {'epoch': 29, 'rec_loss': '6.8257'}
2025-02-27 19:51:01,880 - {'Epoch': 29, 'HR@5': '0.0862', 'NDCG@5': '0.0606', 'HR@10': '0.1212', 'NDCG@10': '0.0719', 'HR@20': '0.1635', 'NDCG@20': '0.0825'}
2025-02-27 19:51:01,882 - EarlyStopping counter: 7 out of 10
2025-02-27 19:51:37,872 - {'epoch': 30, 'rec_loss': '6.8152'}
2025-02-27 19:51:46,718 - {'Epoch': 30, 'HR@5': '0.0871', 'NDCG@5': '0.0615', 'HR@10': '0.1207', 'NDCG@10': '0.0723', 'HR@20': '0.1650', 'NDCG@20': '0.0835'}
2025-02-27 19:51:46,720 - Validation score increased.  Saving model ...
2025-02-27 19:52:21,324 - {'epoch': 31, 'rec_loss': '6.8008'}
2025-02-27 19:52:30,448 - {'Epoch': 31, 'HR@5': '0.0888', 'NDCG@5': '0.0626', 'HR@10': '0.1208', 'NDCG@10': '0.0729', 'HR@20': '0.1645', 'NDCG@20': '0.0839'}
2025-02-27 19:52:30,449 - Validation score increased.  Saving model ...
2025-02-27 19:53:06,657 - {'epoch': 32, 'rec_loss': '6.7973'}
2025-02-27 19:53:14,933 - {'Epoch': 32, 'HR@5': '0.0889', 'NDCG@5': '0.0630', 'HR@10': '0.1217', 'NDCG@10': '0.0735', 'HR@20': '0.1636', 'NDCG@20': '0.0841'}
2025-02-27 19:53:14,935 - Validation score increased.  Saving model ...
2025-02-27 19:53:48,923 - {'epoch': 33, 'rec_loss': '6.7949'}
2025-02-27 19:53:57,592 - {'Epoch': 33, 'HR@5': '0.0882', 'NDCG@5': '0.0629', 'HR@10': '0.1193', 'NDCG@10': '0.0729', 'HR@20': '0.1621', 'NDCG@20': '0.0837'}
2025-02-27 19:53:57,593 - EarlyStopping counter: 1 out of 10
2025-02-27 19:54:34,892 - {'epoch': 34, 'rec_loss': '6.7779'}
2025-02-27 19:54:43,471 - {'Epoch': 34, 'HR@5': '0.0886', 'NDCG@5': '0.0626', 'HR@10': '0.1201', 'NDCG@10': '0.0727', 'HR@20': '0.1625', 'NDCG@20': '0.0834'}
2025-02-27 19:54:43,476 - EarlyStopping counter: 2 out of 10
2025-02-27 19:55:18,258 - {'epoch': 35, 'rec_loss': '6.7742'}
2025-02-27 19:55:26,828 - {'Epoch': 35, 'HR@5': '0.0865', 'NDCG@5': '0.0613', 'HR@10': '0.1185', 'NDCG@10': '0.0716', 'HR@20': '0.1635', 'NDCG@20': '0.0829'}
2025-02-27 19:55:26,829 - EarlyStopping counter: 3 out of 10
2025-02-27 19:56:06,391 - {'epoch': 36, 'rec_loss': '6.7661'}
2025-02-27 19:56:14,976 - {'Epoch': 36, 'HR@5': '0.0868', 'NDCG@5': '0.0620', 'HR@10': '0.1215', 'NDCG@10': '0.0732', 'HR@20': '0.1635', 'NDCG@20': '0.0838'}
2025-02-27 19:56:14,977 - EarlyStopping counter: 4 out of 10
2025-02-27 19:56:50,266 - {'epoch': 37, 'rec_loss': '6.7499'}
2025-02-27 19:56:58,414 - {'Epoch': 37, 'HR@5': '0.0865', 'NDCG@5': '0.0614', 'HR@10': '0.1216', 'NDCG@10': '0.0727', 'HR@20': '0.1658', 'NDCG@20': '0.0838'}
2025-02-27 19:56:58,415 - EarlyStopping counter: 5 out of 10
2025-02-27 19:57:35,790 - {'epoch': 38, 'rec_loss': '6.7517'}
2025-02-27 19:57:44,458 - {'Epoch': 38, 'HR@5': '0.0869', 'NDCG@5': '0.0613', 'HR@10': '0.1209', 'NDCG@10': '0.0723', 'HR@20': '0.1639', 'NDCG@20': '0.0832'}
2025-02-27 19:57:44,459 - EarlyStopping counter: 6 out of 10
2025-02-27 19:58:18,526 - {'epoch': 39, 'rec_loss': '6.7450'}
2025-02-27 19:58:27,147 - {'Epoch': 39, 'HR@5': '0.0852', 'NDCG@5': '0.0603', 'HR@10': '0.1193', 'NDCG@10': '0.0713', 'HR@20': '0.1625', 'NDCG@20': '0.0821'}
2025-02-27 19:58:27,149 - EarlyStopping counter: 7 out of 10
2025-02-27 19:59:03,933 - {'epoch': 40, 'rec_loss': '6.7459'}
2025-02-27 19:59:13,938 - {'Epoch': 40, 'HR@5': '0.0864', 'NDCG@5': '0.0614', 'HR@10': '0.1211', 'NDCG@10': '0.0726', 'HR@20': '0.1637', 'NDCG@20': '0.0833'}
2025-02-27 19:59:13,943 - EarlyStopping counter: 8 out of 10
2025-02-27 19:59:51,485 - {'epoch': 41, 'rec_loss': '6.7342'}
2025-02-27 20:00:00,417 - {'Epoch': 41, 'HR@5': '0.0878', 'NDCG@5': '0.0624', 'HR@10': '0.1204', 'NDCG@10': '0.0729', 'HR@20': '0.1638', 'NDCG@20': '0.0838'}
2025-02-27 20:00:00,418 - EarlyStopping counter: 9 out of 10
2025-02-27 20:00:35,426 - {'epoch': 42, 'rec_loss': '6.7304'}
2025-02-27 20:00:44,412 - {'Epoch': 42, 'HR@5': '0.0888', 'NDCG@5': '0.0629', 'HR@10': '0.1204', 'NDCG@10': '0.0731', 'HR@20': '0.1643', 'NDCG@20': '0.0841'}
2025-02-27 20:00:44,413 - Validation score increased.  Saving model ...
2025-02-27 20:01:21,604 - {'epoch': 43, 'rec_loss': '6.7170'}
2025-02-27 20:01:30,628 - {'Epoch': 43, 'HR@5': '0.0889', 'NDCG@5': '0.0620', 'HR@10': '0.1200', 'NDCG@10': '0.0720', 'HR@20': '0.1638', 'NDCG@20': '0.0830'}
2025-02-27 20:01:30,629 - EarlyStopping counter: 1 out of 10
2025-02-27 20:02:05,681 - {'epoch': 44, 'rec_loss': '6.7186'}
2025-02-27 20:02:14,155 - {'Epoch': 44, 'HR@5': '0.0872', 'NDCG@5': '0.0620', 'HR@10': '0.1198', 'NDCG@10': '0.0725', 'HR@20': '0.1630', 'NDCG@20': '0.0834'}
2025-02-27 20:02:14,156 - EarlyStopping counter: 2 out of 10
2025-02-27 20:02:50,526 - {'epoch': 45, 'rec_loss': '6.7123'}
2025-02-27 20:02:59,161 - {'Epoch': 45, 'HR@5': '0.0882', 'NDCG@5': '0.0623', 'HR@10': '0.1209', 'NDCG@10': '0.0728', 'HR@20': '0.1646', 'NDCG@20': '0.0839'}
2025-02-27 20:02:59,162 - EarlyStopping counter: 3 out of 10
2025-02-27 20:03:35,496 - {'epoch': 46, 'rec_loss': '6.7024'}
2025-02-27 20:03:44,646 - {'Epoch': 46, 'HR@5': '0.0889', 'NDCG@5': '0.0632', 'HR@10': '0.1209', 'NDCG@10': '0.0734', 'HR@20': '0.1654', 'NDCG@20': '0.0847'}
2025-02-27 20:03:44,648 - Validation score increased.  Saving model ...
2025-02-27 20:04:23,196 - {'epoch': 47, 'rec_loss': '6.6975'}
2025-02-27 20:04:32,167 - {'Epoch': 47, 'HR@5': '0.0874', 'NDCG@5': '0.0620', 'HR@10': '0.1208', 'NDCG@10': '0.0727', 'HR@20': '0.1631', 'NDCG@20': '0.0834'}
2025-02-27 20:04:32,169 - EarlyStopping counter: 1 out of 10
2025-02-27 20:05:09,512 - {'epoch': 48, 'rec_loss': '6.6953'}
2025-02-27 20:05:18,242 - {'Epoch': 48, 'HR@5': '0.0872', 'NDCG@5': '0.0620', 'HR@10': '0.1208', 'NDCG@10': '0.0728', 'HR@20': '0.1644', 'NDCG@20': '0.0838'}
2025-02-27 20:05:18,245 - EarlyStopping counter: 2 out of 10
2025-02-27 20:05:52,536 - {'epoch': 49, 'rec_loss': '6.6875'}
2025-02-27 20:06:01,744 - {'Epoch': 49, 'HR@5': '0.0877', 'NDCG@5': '0.0619', 'HR@10': '0.1203', 'NDCG@10': '0.0724', 'HR@20': '0.1642', 'NDCG@20': '0.0835'}
2025-02-27 20:06:01,746 - EarlyStopping counter: 3 out of 10
2025-02-27 20:06:36,641 - {'epoch': 50, 'rec_loss': '6.6893'}
2025-02-27 20:06:45,424 - {'Epoch': 50, 'HR@5': '0.0885', 'NDCG@5': '0.0626', 'HR@10': '0.1207', 'NDCG@10': '0.0730', 'HR@20': '0.1644', 'NDCG@20': '0.0840'}
2025-02-27 20:06:45,425 - EarlyStopping counter: 4 out of 10
2025-02-27 20:07:20,254 - {'epoch': 51, 'rec_loss': '6.6834'}
2025-02-27 20:07:29,016 - {'Epoch': 51, 'HR@5': '0.0877', 'NDCG@5': '0.0624', 'HR@10': '0.1196', 'NDCG@10': '0.0727', 'HR@20': '0.1656', 'NDCG@20': '0.0843'}
2025-02-27 20:07:29,018 - EarlyStopping counter: 5 out of 10
2025-02-27 20:08:05,382 - {'epoch': 52, 'rec_loss': '6.6730'}
2025-02-27 20:08:14,064 - {'Epoch': 52, 'HR@5': '0.0867', 'NDCG@5': '0.0621', 'HR@10': '0.1189', 'NDCG@10': '0.0724', 'HR@20': '0.1636', 'NDCG@20': '0.0837'}
2025-02-27 20:08:14,066 - EarlyStopping counter: 6 out of 10
2025-02-27 20:08:49,293 - {'epoch': 53, 'rec_loss': '6.6759'}
2025-02-27 20:08:58,501 - {'Epoch': 53, 'HR@5': '0.0879', 'NDCG@5': '0.0624', 'HR@10': '0.1219', 'NDCG@10': '0.0733', 'HR@20': '0.1650', 'NDCG@20': '0.0842'}
2025-02-27 20:08:58,502 - EarlyStopping counter: 7 out of 10
2025-02-27 20:09:33,366 - {'epoch': 54, 'rec_loss': '6.6684'}
2025-02-27 20:09:42,332 - {'Epoch': 54, 'HR@5': '0.0882', 'NDCG@5': '0.0627', 'HR@10': '0.1202', 'NDCG@10': '0.0730', 'HR@20': '0.1630', 'NDCG@20': '0.0838'}
2025-02-27 20:09:42,339 - EarlyStopping counter: 8 out of 10
2025-02-27 20:10:17,811 - {'epoch': 55, 'rec_loss': '6.6649'}
2025-02-27 20:10:26,904 - {'Epoch': 55, 'HR@5': '0.0884', 'NDCG@5': '0.0629', 'HR@10': '0.1205', 'NDCG@10': '0.0733', 'HR@20': '0.1643', 'NDCG@20': '0.0843'}
2025-02-27 20:10:26,906 - EarlyStopping counter: 9 out of 10
2025-02-27 20:11:03,074 - {'epoch': 56, 'rec_loss': '6.6615'}
2025-02-27 20:11:11,820 - {'Epoch': 56, 'HR@5': '0.0878', 'NDCG@5': '0.0629', 'HR@10': '0.1201', 'NDCG@10': '0.0733', 'HR@20': '0.1637', 'NDCG@20': '0.0843'}
2025-02-27 20:11:11,821 - EarlyStopping counter: 10 out of 10
2025-02-27 20:11:11,821 - Early stopping
2025-02-27 20:11:11,821 - ---------------Test Score---------------
2025-02-27 20:11:20,804 - {'Epoch': 0, 'HR@5': '0.0718', 'NDCG@5': '0.0517', 'HR@10': '0.0991', 'NDCG@10': '0.0604', 'HR@20': '0.1365', 'NDCG@20': '0.0699'}
2025-02-27 20:11:20,807 - Scale_Beauty
2025-02-27 20:11:20,807 - {'Epoch': 0, 'HR@5': '0.0718', 'NDCG@5': '0.0517', 'HR@10': '0.0991', 'NDCG@10': '0.0604', 'HR@20': '0.1365', 'NDCG@20': '0.0699'}
2025-02-27 20:18:43,033 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 16], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-27 20:18:49,244 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-27 20:18:49,370 - Total Parameters: 929445
2025-02-27 20:19:24,182 - {'epoch': 0, 'rec_loss': '8.8326'}
2025-02-27 20:19:33,293 - {'Epoch': 0, 'HR@5': '0.0190', 'NDCG@5': '0.0120', 'HR@10': '0.0305', 'NDCG@10': '0.0157', 'HR@20': '0.0466', 'NDCG@20': '0.0198'}
2025-02-27 20:19:33,297 - Validation score increased.  Saving model ...
2025-02-27 20:20:10,873 - {'epoch': 1, 'rec_loss': '8.3260'}
2025-02-27 20:20:20,349 - {'Epoch': 1, 'HR@5': '0.0375', 'NDCG@5': '0.0252', 'HR@10': '0.0558', 'NDCG@10': '0.0311', 'HR@20': '0.0817', 'NDCG@20': '0.0376'}
2025-02-27 20:20:20,351 - Validation score increased.  Saving model ...
2025-02-27 20:20:55,590 - {'epoch': 2, 'rec_loss': '8.0146'}
2025-02-27 20:21:04,315 - {'Epoch': 2, 'HR@5': '0.0489', 'NDCG@5': '0.0335', 'HR@10': '0.0719', 'NDCG@10': '0.0409', 'HR@20': '0.1034', 'NDCG@20': '0.0488'}
2025-02-27 20:21:04,316 - Validation score increased.  Saving model ...
2025-02-27 20:21:38,362 - {'epoch': 3, 'rec_loss': '7.7986'}
2025-02-27 20:21:47,421 - {'Epoch': 3, 'HR@5': '0.0586', 'NDCG@5': '0.0400', 'HR@10': '0.0860', 'NDCG@10': '0.0488', 'HR@20': '0.1236', 'NDCG@20': '0.0583'}
2025-02-27 20:21:47,422 - Validation score increased.  Saving model ...
2025-02-27 20:22:22,528 - {'epoch': 4, 'rec_loss': '7.6353'}
2025-02-27 20:22:32,663 - {'Epoch': 4, 'HR@5': '0.0674', 'NDCG@5': '0.0468', 'HR@10': '0.0958', 'NDCG@10': '0.0559', 'HR@20': '0.1325', 'NDCG@20': '0.0651'}
2025-02-27 20:22:32,665 - Validation score increased.  Saving model ...
2025-02-27 20:23:06,752 - {'epoch': 5, 'rec_loss': '7.5198'}
2025-02-27 20:23:15,487 - {'Epoch': 5, 'HR@5': '0.0727', 'NDCG@5': '0.0510', 'HR@10': '0.1028', 'NDCG@10': '0.0607', 'HR@20': '0.1396', 'NDCG@20': '0.0699'}
2025-02-27 20:23:15,488 - Validation score increased.  Saving model ...
2025-02-27 20:23:53,318 - {'epoch': 6, 'rec_loss': '7.4217'}
2025-02-27 20:24:02,193 - {'Epoch': 6, 'HR@5': '0.0755', 'NDCG@5': '0.0531', 'HR@10': '0.1053', 'NDCG@10': '0.0627', 'HR@20': '0.1460', 'NDCG@20': '0.0730'}
2025-02-27 20:24:02,194 - Validation score increased.  Saving model ...
2025-02-27 20:24:36,869 - {'epoch': 7, 'rec_loss': '7.3413'}
2025-02-27 20:24:45,515 - {'Epoch': 7, 'HR@5': '0.0802', 'NDCG@5': '0.0562', 'HR@10': '0.1092', 'NDCG@10': '0.0655', 'HR@20': '0.1490', 'NDCG@20': '0.0756'}
2025-02-27 20:24:45,516 - Validation score increased.  Saving model ...
2025-02-27 20:25:24,717 - {'epoch': 8, 'rec_loss': '7.2716'}
2025-02-27 20:25:33,810 - {'Epoch': 8, 'HR@5': '0.0821', 'NDCG@5': '0.0581', 'HR@10': '0.1111', 'NDCG@10': '0.0674', 'HR@20': '0.1501', 'NDCG@20': '0.0772'}
2025-02-27 20:25:33,812 - Validation score increased.  Saving model ...
2025-02-27 20:26:09,562 - {'epoch': 9, 'rec_loss': '7.2232'}
2025-02-27 20:26:18,678 - {'Epoch': 9, 'HR@5': '0.0815', 'NDCG@5': '0.0569', 'HR@10': '0.1134', 'NDCG@10': '0.0672', 'HR@20': '0.1525', 'NDCG@20': '0.0771'}
2025-02-27 20:26:18,679 - EarlyStopping counter: 1 out of 10
2025-02-27 20:26:54,643 - {'epoch': 10, 'rec_loss': '7.1752'}
2025-02-27 20:27:04,203 - {'Epoch': 10, 'HR@5': '0.0833', 'NDCG@5': '0.0588', 'HR@10': '0.1134', 'NDCG@10': '0.0685', 'HR@20': '0.1525', 'NDCG@20': '0.0783'}
2025-02-27 20:27:04,211 - Validation score increased.  Saving model ...
2025-02-27 20:27:38,056 - {'epoch': 11, 'rec_loss': '7.1372'}
2025-02-27 20:27:46,787 - {'Epoch': 11, 'HR@5': '0.0844', 'NDCG@5': '0.0598', 'HR@10': '0.1136', 'NDCG@10': '0.0692', 'HR@20': '0.1539', 'NDCG@20': '0.0794'}
2025-02-27 20:27:46,788 - Validation score increased.  Saving model ...
2025-02-27 20:28:23,281 - {'epoch': 12, 'rec_loss': '7.1004'}
2025-02-27 20:28:32,382 - {'Epoch': 12, 'HR@5': '0.0839', 'NDCG@5': '0.0596', 'HR@10': '0.1164', 'NDCG@10': '0.0700', 'HR@20': '0.1564', 'NDCG@20': '0.0801'}
2025-02-27 20:28:32,383 - Validation score increased.  Saving model ...
2025-02-27 20:29:08,785 - {'epoch': 13, 'rec_loss': '7.0745'}
2025-02-27 20:29:17,370 - {'Epoch': 13, 'HR@5': '0.0849', 'NDCG@5': '0.0595', 'HR@10': '0.1178', 'NDCG@10': '0.0701', 'HR@20': '0.1577', 'NDCG@20': '0.0802'}
2025-02-27 20:29:17,372 - Validation score increased.  Saving model ...
2025-02-27 20:29:51,656 - {'epoch': 14, 'rec_loss': '7.0441'}
2025-02-27 20:30:00,701 - {'Epoch': 14, 'HR@5': '0.0870', 'NDCG@5': '0.0608', 'HR@10': '0.1181', 'NDCG@10': '0.0708', 'HR@20': '0.1597', 'NDCG@20': '0.0813'}
2025-02-27 20:30:00,702 - Validation score increased.  Saving model ...
2025-02-27 20:30:37,553 - {'epoch': 15, 'rec_loss': '7.0245'}
2025-02-27 20:30:46,781 - {'Epoch': 15, 'HR@5': '0.0863', 'NDCG@5': '0.0605', 'HR@10': '0.1184', 'NDCG@10': '0.0708', 'HR@20': '0.1607', 'NDCG@20': '0.0815'}
2025-02-27 20:30:46,783 - Validation score increased.  Saving model ...
2025-02-27 20:31:20,810 - {'epoch': 16, 'rec_loss': '7.0023'}
2025-02-27 20:31:30,144 - {'Epoch': 16, 'HR@5': '0.0859', 'NDCG@5': '0.0604', 'HR@10': '0.1184', 'NDCG@10': '0.0709', 'HR@20': '0.1609', 'NDCG@20': '0.0816'}
2025-02-27 20:31:30,146 - Validation score increased.  Saving model ...
2025-02-27 20:32:06,899 - {'epoch': 17, 'rec_loss': '6.9863'}
2025-02-27 20:32:15,550 - {'Epoch': 17, 'HR@5': '0.0849', 'NDCG@5': '0.0606', 'HR@10': '0.1184', 'NDCG@10': '0.0714', 'HR@20': '0.1606', 'NDCG@20': '0.0821'}
2025-02-27 20:32:15,551 - Validation score increased.  Saving model ...
2025-02-27 20:32:50,598 - {'epoch': 18, 'rec_loss': '6.9548'}
2025-02-27 20:32:59,149 - {'Epoch': 18, 'HR@5': '0.0870', 'NDCG@5': '0.0611', 'HR@10': '0.1186', 'NDCG@10': '0.0712', 'HR@20': '0.1613', 'NDCG@20': '0.0820'}
2025-02-27 20:32:59,150 - EarlyStopping counter: 1 out of 10
2025-02-27 20:33:35,174 - {'epoch': 19, 'rec_loss': '6.9440'}
2025-02-27 20:33:43,963 - {'Epoch': 19, 'HR@5': '0.0870', 'NDCG@5': '0.0617', 'HR@10': '0.1184', 'NDCG@10': '0.0717', 'HR@20': '0.1626', 'NDCG@20': '0.0828'}
2025-02-27 20:33:43,971 - Validation score increased.  Saving model ...
2025-02-27 20:34:19,778 - {'epoch': 20, 'rec_loss': '6.9232'}
2025-02-27 20:34:29,556 - {'Epoch': 20, 'HR@5': '0.0868', 'NDCG@5': '0.0614', 'HR@10': '0.1199', 'NDCG@10': '0.0722', 'HR@20': '0.1636', 'NDCG@20': '0.0832'}
2025-02-27 20:34:29,557 - Validation score increased.  Saving model ...
2025-02-27 20:35:05,067 - {'epoch': 21, 'rec_loss': '6.9149'}
2025-02-27 20:35:14,837 - {'Epoch': 21, 'HR@5': '0.0876', 'NDCG@5': '0.0618', 'HR@10': '0.1205', 'NDCG@10': '0.0723', 'HR@20': '0.1625', 'NDCG@20': '0.0829'}
2025-02-27 20:35:14,839 - EarlyStopping counter: 1 out of 10
2025-02-27 20:35:52,688 - {'epoch': 22, 'rec_loss': '6.9037'}
2025-02-27 20:36:01,826 - {'Epoch': 22, 'HR@5': '0.0877', 'NDCG@5': '0.0622', 'HR@10': '0.1215', 'NDCG@10': '0.0730', 'HR@20': '0.1637', 'NDCG@20': '0.0837'}
2025-02-27 20:36:01,827 - Validation score increased.  Saving model ...
2025-02-27 20:36:38,864 - {'epoch': 23, 'rec_loss': '6.8872'}
2025-02-27 20:36:47,386 - {'Epoch': 23, 'HR@5': '0.0873', 'NDCG@5': '0.0623', 'HR@10': '0.1211', 'NDCG@10': '0.0732', 'HR@20': '0.1634', 'NDCG@20': '0.0838'}
2025-02-27 20:36:47,388 - Validation score increased.  Saving model ...
2025-02-27 20:37:24,187 - {'epoch': 24, 'rec_loss': '6.8800'}
2025-02-27 20:37:34,374 - {'Epoch': 24, 'HR@5': '0.0874', 'NDCG@5': '0.0618', 'HR@10': '0.1201', 'NDCG@10': '0.0723', 'HR@20': '0.1626', 'NDCG@20': '0.0830'}
2025-02-27 20:37:34,375 - EarlyStopping counter: 1 out of 10
2025-02-27 20:38:09,129 - {'epoch': 25, 'rec_loss': '6.8605'}
2025-02-27 20:38:18,570 - {'Epoch': 25, 'HR@5': '0.0872', 'NDCG@5': '0.0614', 'HR@10': '0.1209', 'NDCG@10': '0.0723', 'HR@20': '0.1638', 'NDCG@20': '0.0831'}
2025-02-27 20:38:18,571 - EarlyStopping counter: 2 out of 10
2025-02-27 20:38:53,496 - {'epoch': 26, 'rec_loss': '6.8557'}
2025-02-27 20:39:02,501 - {'Epoch': 26, 'HR@5': '0.0887', 'NDCG@5': '0.0625', 'HR@10': '0.1221', 'NDCG@10': '0.0733', 'HR@20': '0.1640', 'NDCG@20': '0.0838'}
2025-02-27 20:39:02,502 - EarlyStopping counter: 3 out of 10
2025-02-27 20:39:38,385 - {'epoch': 27, 'rec_loss': '6.8398'}
2025-02-27 20:39:46,759 - {'Epoch': 27, 'HR@5': '0.0877', 'NDCG@5': '0.0623', 'HR@10': '0.1204', 'NDCG@10': '0.0727', 'HR@20': '0.1626', 'NDCG@20': '0.0834'}
2025-02-27 20:39:46,760 - EarlyStopping counter: 4 out of 10
2025-02-27 20:40:21,786 - {'epoch': 28, 'rec_loss': '6.8360'}
2025-02-27 20:40:30,252 - {'Epoch': 28, 'HR@5': '0.0882', 'NDCG@5': '0.0621', 'HR@10': '0.1215', 'NDCG@10': '0.0728', 'HR@20': '0.1617', 'NDCG@20': '0.0829'}
2025-02-27 20:40:30,253 - EarlyStopping counter: 5 out of 10
2025-02-27 20:41:07,532 - {'epoch': 29, 'rec_loss': '6.8274'}
2025-02-27 20:41:16,484 - {'Epoch': 29, 'HR@5': '0.0872', 'NDCG@5': '0.0613', 'HR@10': '0.1214', 'NDCG@10': '0.0723', 'HR@20': '0.1633', 'NDCG@20': '0.0828'}
2025-02-27 20:41:16,485 - EarlyStopping counter: 6 out of 10
2025-02-27 20:41:50,919 - {'epoch': 30, 'rec_loss': '6.8171'}
2025-02-27 20:41:59,716 - {'Epoch': 30, 'HR@5': '0.0884', 'NDCG@5': '0.0622', 'HR@10': '0.1212', 'NDCG@10': '0.0727', 'HR@20': '0.1640', 'NDCG@20': '0.0834'}
2025-02-27 20:41:59,717 - EarlyStopping counter: 7 out of 10
2025-02-27 20:42:36,978 - {'epoch': 31, 'rec_loss': '6.8027'}
2025-02-27 20:42:46,142 - {'Epoch': 31, 'HR@5': '0.0879', 'NDCG@5': '0.0625', 'HR@10': '0.1206', 'NDCG@10': '0.0730', 'HR@20': '0.1633', 'NDCG@20': '0.0838'}
2025-02-27 20:42:46,143 - EarlyStopping counter: 8 out of 10
2025-02-27 20:43:21,159 - {'epoch': 32, 'rec_loss': '6.7997'}
2025-02-27 20:43:30,419 - {'Epoch': 32, 'HR@5': '0.0887', 'NDCG@5': '0.0630', 'HR@10': '0.1213', 'NDCG@10': '0.0735', 'HR@20': '0.1635', 'NDCG@20': '0.0841'}
2025-02-27 20:43:30,427 - Validation score increased.  Saving model ...
2025-02-27 20:44:06,842 - {'epoch': 33, 'rec_loss': '6.7964'}
2025-02-27 20:44:16,269 - {'Epoch': 33, 'HR@5': '0.0880', 'NDCG@5': '0.0625', 'HR@10': '0.1191', 'NDCG@10': '0.0725', 'HR@20': '0.1631', 'NDCG@20': '0.0836'}
2025-02-27 20:44:16,271 - EarlyStopping counter: 1 out of 10
2025-02-27 20:44:54,614 - {'epoch': 34, 'rec_loss': '6.7799'}
2025-02-27 20:45:04,078 - {'Epoch': 34, 'HR@5': '0.0880', 'NDCG@5': '0.0623', 'HR@10': '0.1203', 'NDCG@10': '0.0726', 'HR@20': '0.1625', 'NDCG@20': '0.0833'}
2025-02-27 20:45:04,079 - EarlyStopping counter: 2 out of 10
2025-02-27 20:45:39,314 - {'epoch': 35, 'rec_loss': '6.7763'}
2025-02-27 20:45:48,831 - {'Epoch': 35, 'HR@5': '0.0872', 'NDCG@5': '0.0612', 'HR@10': '0.1188', 'NDCG@10': '0.0714', 'HR@20': '0.1638', 'NDCG@20': '0.0828'}
2025-02-27 20:45:48,833 - EarlyStopping counter: 3 out of 10
2025-02-27 20:46:25,113 - {'epoch': 36, 'rec_loss': '6.7678'}
2025-02-27 20:46:34,279 - {'Epoch': 36, 'HR@5': '0.0873', 'NDCG@5': '0.0625', 'HR@10': '0.1214', 'NDCG@10': '0.0734', 'HR@20': '0.1633', 'NDCG@20': '0.0839'}
2025-02-27 20:46:34,280 - EarlyStopping counter: 4 out of 10
2025-02-27 20:47:07,469 - {'epoch': 37, 'rec_loss': '6.7534'}
2025-02-27 20:47:16,402 - {'Epoch': 37, 'HR@5': '0.0868', 'NDCG@5': '0.0614', 'HR@10': '0.1199', 'NDCG@10': '0.0721', 'HR@20': '0.1659', 'NDCG@20': '0.0837'}
2025-02-27 20:47:16,404 - EarlyStopping counter: 5 out of 10
2025-02-27 20:47:54,583 - {'epoch': 38, 'rec_loss': '6.7540'}
2025-02-27 20:48:03,711 - {'Epoch': 38, 'HR@5': '0.0872', 'NDCG@5': '0.0617', 'HR@10': '0.1205', 'NDCG@10': '0.0724', 'HR@20': '0.1634', 'NDCG@20': '0.0832'}
2025-02-27 20:48:03,712 - EarlyStopping counter: 6 out of 10
2025-02-27 20:48:37,370 - {'epoch': 39, 'rec_loss': '6.7469'}
2025-02-27 20:48:45,998 - {'Epoch': 39, 'HR@5': '0.0853', 'NDCG@5': '0.0606', 'HR@10': '0.1185', 'NDCG@10': '0.0713', 'HR@20': '0.1617', 'NDCG@20': '0.0822'}
2025-02-27 20:48:45,999 - EarlyStopping counter: 7 out of 10
2025-02-27 20:49:21,934 - {'epoch': 40, 'rec_loss': '6.7482'}
2025-02-27 20:49:30,889 - {'Epoch': 40, 'HR@5': '0.0869', 'NDCG@5': '0.0618', 'HR@10': '0.1197', 'NDCG@10': '0.0724', 'HR@20': '0.1646', 'NDCG@20': '0.0837'}
2025-02-27 20:49:30,890 - EarlyStopping counter: 8 out of 10
2025-02-27 20:50:04,132 - {'epoch': 41, 'rec_loss': '6.7356'}
2025-02-27 20:50:13,916 - {'Epoch': 41, 'HR@5': '0.0877', 'NDCG@5': '0.0623', 'HR@10': '0.1205', 'NDCG@10': '0.0729', 'HR@20': '0.1640', 'NDCG@20': '0.0839'}
2025-02-27 20:50:13,917 - EarlyStopping counter: 9 out of 10
2025-02-27 20:50:51,203 - {'epoch': 42, 'rec_loss': '6.7322'}
2025-02-27 20:51:00,070 - {'Epoch': 42, 'HR@5': '0.0893', 'NDCG@5': '0.0629', 'HR@10': '0.1205', 'NDCG@10': '0.0730', 'HR@20': '0.1644', 'NDCG@20': '0.0840'}
2025-02-27 20:51:00,071 - EarlyStopping counter: 10 out of 10
2025-02-27 20:51:00,071 - Early stopping
2025-02-27 20:51:00,071 - ---------------Test Score---------------
2025-02-27 20:51:09,745 - {'Epoch': 0, 'HR@5': '0.0728', 'NDCG@5': '0.0509', 'HR@10': '0.1002', 'NDCG@10': '0.0598', 'HR@20': '0.1367', 'NDCG@20': '0.0689'}
2025-02-27 20:51:09,751 - Scale_Beauty
2025-02-27 20:51:09,752 - {'Epoch': 0, 'HR@5': '0.0728', 'NDCG@5': '0.0509', 'HR@10': '0.1002', 'NDCG@10': '0.0598', 'HR@20': '0.1367', 'NDCG@20': '0.0689'}
2025-02-27 21:06:16,914 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-27 21:06:24,210 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=2, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=2, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-27 21:06:24,217 - Total Parameters: 929441
2025-02-27 21:06:59,063 - {'epoch': 0, 'rec_loss': '8.8280'}
2025-02-27 21:07:08,731 - {'Epoch': 0, 'HR@5': '0.0174', 'NDCG@5': '0.0109', 'HR@10': '0.0292', 'NDCG@10': '0.0146', 'HR@20': '0.0476', 'NDCG@20': '0.0193'}
2025-02-27 21:07:08,732 - Validation score increased.  Saving model ...
2025-02-27 21:07:43,843 - {'epoch': 1, 'rec_loss': '8.3020'}
2025-02-27 21:07:53,564 - {'Epoch': 1, 'HR@5': '0.0364', 'NDCG@5': '0.0249', 'HR@10': '0.0542', 'NDCG@10': '0.0306', 'HR@20': '0.0799', 'NDCG@20': '0.0371'}
2025-02-27 21:07:53,565 - Validation score increased.  Saving model ...
2025-02-27 21:08:26,161 - {'epoch': 2, 'rec_loss': '8.0092'}
2025-02-27 21:08:35,730 - {'Epoch': 2, 'HR@5': '0.0515', 'NDCG@5': '0.0349', 'HR@10': '0.0732', 'NDCG@10': '0.0418', 'HR@20': '0.1042', 'NDCG@20': '0.0497'}
2025-02-27 21:08:35,732 - Validation score increased.  Saving model ...
2025-02-27 21:09:10,437 - {'epoch': 3, 'rec_loss': '7.8002'}
2025-02-27 21:09:19,666 - {'Epoch': 3, 'HR@5': '0.0609', 'NDCG@5': '0.0411', 'HR@10': '0.0872', 'NDCG@10': '0.0496', 'HR@20': '0.1224', 'NDCG@20': '0.0585'}
2025-02-27 21:09:19,667 - Validation score increased.  Saving model ...
2025-02-27 21:09:54,053 - {'epoch': 4, 'rec_loss': '7.6444'}
2025-02-27 21:10:03,583 - {'Epoch': 4, 'HR@5': '0.0705', 'NDCG@5': '0.0488', 'HR@10': '0.0980', 'NDCG@10': '0.0577', 'HR@20': '0.1366', 'NDCG@20': '0.0673'}
2025-02-27 21:10:03,584 - Validation score increased.  Saving model ...
2025-02-27 21:10:37,281 - {'epoch': 5, 'rec_loss': '7.5236'}
2025-02-27 21:10:46,835 - {'Epoch': 5, 'HR@5': '0.0743', 'NDCG@5': '0.0516', 'HR@10': '0.1063', 'NDCG@10': '0.0619', 'HR@20': '0.1427', 'NDCG@20': '0.0711'}
2025-02-27 21:10:46,836 - Validation score increased.  Saving model ...
2025-02-27 21:11:24,451 - {'epoch': 6, 'rec_loss': '7.4215'}
2025-02-27 21:11:33,499 - {'Epoch': 6, 'HR@5': '0.0773', 'NDCG@5': '0.0539', 'HR@10': '0.1079', 'NDCG@10': '0.0638', 'HR@20': '0.1471', 'NDCG@20': '0.0736'}
2025-02-27 21:11:33,501 - Validation score increased.  Saving model ...
2025-02-27 21:12:07,067 - {'epoch': 7, 'rec_loss': '7.3393'}
2025-02-27 21:12:16,594 - {'Epoch': 7, 'HR@5': '0.0785', 'NDCG@5': '0.0559', 'HR@10': '0.1099', 'NDCG@10': '0.0661', 'HR@20': '0.1490', 'NDCG@20': '0.0759'}
2025-02-27 21:12:16,595 - Validation score increased.  Saving model ...
2025-02-27 21:12:52,089 - {'epoch': 8, 'rec_loss': '7.2740'}
2025-02-27 21:13:01,625 - {'Epoch': 8, 'HR@5': '0.0802', 'NDCG@5': '0.0568', 'HR@10': '0.1094', 'NDCG@10': '0.0662', 'HR@20': '0.1515', 'NDCG@20': '0.0769'}
2025-02-27 21:13:01,626 - Validation score increased.  Saving model ...
2025-02-27 21:13:32,865 - {'epoch': 9, 'rec_loss': '7.2190'}
2025-02-27 21:13:41,436 - {'Epoch': 9, 'HR@5': '0.0821', 'NDCG@5': '0.0582', 'HR@10': '0.1128', 'NDCG@10': '0.0681', 'HR@20': '0.1557', 'NDCG@20': '0.0789'}
2025-02-27 21:13:41,438 - Validation score increased.  Saving model ...
2025-02-27 21:14:17,175 - {'epoch': 10, 'rec_loss': '7.1727'}
2025-02-27 21:14:25,989 - {'Epoch': 10, 'HR@5': '0.0817', 'NDCG@5': '0.0574', 'HR@10': '0.1124', 'NDCG@10': '0.0673', 'HR@20': '0.1534', 'NDCG@20': '0.0777'}
2025-02-27 21:14:25,990 - EarlyStopping counter: 1 out of 10
2025-02-27 21:14:58,385 - {'epoch': 11, 'rec_loss': '7.1301'}
2025-02-27 21:15:07,486 - {'Epoch': 11, 'HR@5': '0.0826', 'NDCG@5': '0.0584', 'HR@10': '0.1146', 'NDCG@10': '0.0688', 'HR@20': '0.1561', 'NDCG@20': '0.0792'}
2025-02-27 21:15:07,487 - Validation score increased.  Saving model ...
2025-02-27 21:15:43,293 - {'epoch': 12, 'rec_loss': '7.0962'}
2025-02-27 21:15:52,633 - {'Epoch': 12, 'HR@5': '0.0844', 'NDCG@5': '0.0600', 'HR@10': '0.1169', 'NDCG@10': '0.0705', 'HR@20': '0.1573', 'NDCG@20': '0.0806'}
2025-02-27 21:15:52,635 - Validation score increased.  Saving model ...
2025-02-27 21:16:25,129 - {'epoch': 13, 'rec_loss': '7.0738'}
2025-02-27 21:16:34,557 - {'Epoch': 13, 'HR@5': '0.0847', 'NDCG@5': '0.0599', 'HR@10': '0.1158', 'NDCG@10': '0.0699', 'HR@20': '0.1576', 'NDCG@20': '0.0804'}
2025-02-27 21:16:34,559 - EarlyStopping counter: 1 out of 10
2025-02-27 21:17:08,777 - {'epoch': 14, 'rec_loss': '7.0443'}
2025-02-27 21:17:18,542 - {'Epoch': 14, 'HR@5': '0.0845', 'NDCG@5': '0.0596', 'HR@10': '0.1162', 'NDCG@10': '0.0699', 'HR@20': '0.1616', 'NDCG@20': '0.0813'}
2025-02-27 21:17:18,544 - Validation score increased.  Saving model ...
2025-02-27 21:17:53,019 - {'epoch': 15, 'rec_loss': '7.0178'}
2025-02-27 21:18:02,216 - {'Epoch': 15, 'HR@5': '0.0855', 'NDCG@5': '0.0605', 'HR@10': '0.1165', 'NDCG@10': '0.0705', 'HR@20': '0.1603', 'NDCG@20': '0.0816'}
2025-02-27 21:18:02,217 - Validation score increased.  Saving model ...
2025-02-27 21:18:36,585 - {'epoch': 16, 'rec_loss': '6.9957'}
2025-02-27 21:18:46,238 - {'Epoch': 16, 'HR@5': '0.0855', 'NDCG@5': '0.0602', 'HR@10': '0.1187', 'NDCG@10': '0.0709', 'HR@20': '0.1618', 'NDCG@20': '0.0818'}
2025-02-27 21:18:46,240 - Validation score increased.  Saving model ...
2025-02-27 21:19:23,389 - {'epoch': 17, 'rec_loss': '6.9781'}
2025-02-27 21:19:32,387 - {'Epoch': 17, 'HR@5': '0.0869', 'NDCG@5': '0.0615', 'HR@10': '0.1182', 'NDCG@10': '0.0716', 'HR@20': '0.1610', 'NDCG@20': '0.0824'}
2025-02-27 21:19:32,388 - Validation score increased.  Saving model ...
2025-02-27 21:20:05,632 - {'epoch': 18, 'rec_loss': '6.9530'}
2025-02-27 21:20:14,961 - {'Epoch': 18, 'HR@5': '0.0859', 'NDCG@5': '0.0608', 'HR@10': '0.1190', 'NDCG@10': '0.0714', 'HR@20': '0.1615', 'NDCG@20': '0.0821'}
2025-02-27 21:20:14,962 - EarlyStopping counter: 1 out of 10
2025-02-27 21:20:50,081 - {'epoch': 19, 'rec_loss': '6.9479'}
2025-02-27 21:20:59,072 - {'Epoch': 19, 'HR@5': '0.0859', 'NDCG@5': '0.0608', 'HR@10': '0.1191', 'NDCG@10': '0.0715', 'HR@20': '0.1633', 'NDCG@20': '0.0826'}
2025-02-27 21:20:59,073 - Validation score increased.  Saving model ...
2025-02-27 21:21:29,983 - {'epoch': 20, 'rec_loss': '6.9261'}
2025-02-27 21:21:39,389 - {'Epoch': 20, 'HR@5': '0.0859', 'NDCG@5': '0.0606', 'HR@10': '0.1184', 'NDCG@10': '0.0711', 'HR@20': '0.1630', 'NDCG@20': '0.0824'}
2025-02-27 21:21:39,391 - EarlyStopping counter: 1 out of 10
2025-02-27 21:22:15,557 - {'epoch': 21, 'rec_loss': '6.9096'}
2025-02-27 21:22:24,230 - {'Epoch': 21, 'HR@5': '0.0874', 'NDCG@5': '0.0617', 'HR@10': '0.1213', 'NDCG@10': '0.0726', 'HR@20': '0.1628', 'NDCG@20': '0.0830'}
2025-02-27 21:22:24,233 - Validation score increased.  Saving model ...
2025-02-27 21:22:57,798 - {'epoch': 22, 'rec_loss': '6.9004'}
2025-02-27 21:23:07,235 - {'Epoch': 22, 'HR@5': '0.0877', 'NDCG@5': '0.0621', 'HR@10': '0.1207', 'NDCG@10': '0.0727', 'HR@20': '0.1638', 'NDCG@20': '0.0835'}
2025-02-27 21:23:07,236 - Validation score increased.  Saving model ...
2025-02-27 21:23:37,945 - {'epoch': 23, 'rec_loss': '6.8839'}
2025-02-27 21:23:47,732 - {'Epoch': 23, 'HR@5': '0.0876', 'NDCG@5': '0.0622', 'HR@10': '0.1208', 'NDCG@10': '0.0729', 'HR@20': '0.1634', 'NDCG@20': '0.0837'}
2025-02-27 21:23:47,733 - Validation score increased.  Saving model ...
2025-02-27 21:24:14,308 - {'epoch': 24, 'rec_loss': '6.8748'}
2025-02-27 21:24:23,720 - {'Epoch': 24, 'HR@5': '0.0875', 'NDCG@5': '0.0609', 'HR@10': '0.1207', 'NDCG@10': '0.0716', 'HR@20': '0.1624', 'NDCG@20': '0.0821'}
2025-02-27 21:24:23,722 - EarlyStopping counter: 1 out of 10
2025-02-27 21:24:50,514 - {'epoch': 25, 'rec_loss': '6.8630'}
2025-02-27 21:24:59,998 - {'Epoch': 25, 'HR@5': '0.0877', 'NDCG@5': '0.0625', 'HR@10': '0.1215', 'NDCG@10': '0.0734', 'HR@20': '0.1639', 'NDCG@20': '0.0841'}
2025-02-27 21:24:59,999 - Validation score increased.  Saving model ...
2025-02-27 21:25:26,662 - {'epoch': 26, 'rec_loss': '6.8515'}
2025-02-27 21:25:35,893 - {'Epoch': 26, 'HR@5': '0.0876', 'NDCG@5': '0.0613', 'HR@10': '0.1199', 'NDCG@10': '0.0717', 'HR@20': '0.1621', 'NDCG@20': '0.0823'}
2025-02-27 21:25:35,895 - EarlyStopping counter: 1 out of 10
2025-02-27 21:26:02,557 - {'epoch': 27, 'rec_loss': '6.8433'}
2025-02-27 21:26:11,786 - {'Epoch': 27, 'HR@5': '0.0871', 'NDCG@5': '0.0618', 'HR@10': '0.1209', 'NDCG@10': '0.0727', 'HR@20': '0.1632', 'NDCG@20': '0.0834'}
2025-02-27 21:26:11,788 - EarlyStopping counter: 2 out of 10
2025-02-27 21:26:38,130 - {'epoch': 28, 'rec_loss': '6.8276'}
2025-02-27 21:26:47,535 - {'Epoch': 28, 'HR@5': '0.0868', 'NDCG@5': '0.0616', 'HR@10': '0.1211', 'NDCG@10': '0.0728', 'HR@20': '0.1631', 'NDCG@20': '0.0833'}
2025-02-27 21:26:47,536 - EarlyStopping counter: 3 out of 10
2025-02-27 21:27:13,990 - {'epoch': 29, 'rec_loss': '6.8189'}
2025-02-27 21:27:23,177 - {'Epoch': 29, 'HR@5': '0.0874', 'NDCG@5': '0.0619', 'HR@10': '0.1219', 'NDCG@10': '0.0731', 'HR@20': '0.1653', 'NDCG@20': '0.0840'}
2025-02-27 21:27:23,178 - EarlyStopping counter: 4 out of 10
2025-02-27 21:27:49,332 - {'epoch': 30, 'rec_loss': '6.8098'}
2025-02-27 21:27:58,760 - {'Epoch': 30, 'HR@5': '0.0860', 'NDCG@5': '0.0614', 'HR@10': '0.1205', 'NDCG@10': '0.0725', 'HR@20': '0.1638', 'NDCG@20': '0.0834'}
2025-02-27 21:27:58,762 - EarlyStopping counter: 5 out of 10
2025-02-27 21:28:25,267 - {'epoch': 31, 'rec_loss': '6.8039'}
2025-02-27 21:28:34,024 - {'Epoch': 31, 'HR@5': '0.0878', 'NDCG@5': '0.0620', 'HR@10': '0.1207', 'NDCG@10': '0.0725', 'HR@20': '0.1622', 'NDCG@20': '0.0830'}
2025-02-27 21:28:34,026 - EarlyStopping counter: 6 out of 10
2025-02-27 21:29:01,268 - {'epoch': 32, 'rec_loss': '6.7912'}
2025-02-27 21:29:10,754 - {'Epoch': 32, 'HR@5': '0.0878', 'NDCG@5': '0.0626', 'HR@10': '0.1211', 'NDCG@10': '0.0734', 'HR@20': '0.1635', 'NDCG@20': '0.0841'}
2025-02-27 21:29:10,756 - Validation score increased.  Saving model ...
2025-02-27 21:29:37,311 - {'epoch': 33, 'rec_loss': '6.7893'}
2025-02-27 21:29:46,778 - {'Epoch': 33, 'HR@5': '0.0887', 'NDCG@5': '0.0633', 'HR@10': '0.1219', 'NDCG@10': '0.0740', 'HR@20': '0.1645', 'NDCG@20': '0.0847'}
2025-02-27 21:29:46,780 - Validation score increased.  Saving model ...
2025-02-27 21:30:13,387 - {'epoch': 34, 'rec_loss': '6.7775'}
2025-02-27 21:30:22,858 - {'Epoch': 34, 'HR@5': '0.0882', 'NDCG@5': '0.0627', 'HR@10': '0.1213', 'NDCG@10': '0.0734', 'HR@20': '0.1632', 'NDCG@20': '0.0840'}
2025-02-27 21:30:22,860 - EarlyStopping counter: 1 out of 10
2025-02-27 21:30:49,095 - {'epoch': 35, 'rec_loss': '6.7724'}
2025-02-27 21:30:58,351 - {'Epoch': 35, 'HR@5': '0.0894', 'NDCG@5': '0.0623', 'HR@10': '0.1224', 'NDCG@10': '0.0729', 'HR@20': '0.1642', 'NDCG@20': '0.0834'}
2025-02-27 21:30:58,352 - EarlyStopping counter: 2 out of 10
2025-02-27 21:31:24,722 - {'epoch': 36, 'rec_loss': '6.7633'}
2025-02-27 21:31:33,969 - {'Epoch': 36, 'HR@5': '0.0869', 'NDCG@5': '0.0617', 'HR@10': '0.1210', 'NDCG@10': '0.0727', 'HR@20': '0.1649', 'NDCG@20': '0.0838'}
2025-02-27 21:31:33,976 - EarlyStopping counter: 3 out of 10
2025-02-27 21:32:00,457 - {'epoch': 37, 'rec_loss': '6.7563'}
2025-02-27 21:32:10,401 - {'Epoch': 37, 'HR@5': '0.0873', 'NDCG@5': '0.0625', 'HR@10': '0.1206', 'NDCG@10': '0.0732', 'HR@20': '0.1617', 'NDCG@20': '0.0836'}
2025-02-27 21:32:10,403 - EarlyStopping counter: 4 out of 10
2025-02-27 21:32:37,256 - {'epoch': 38, 'rec_loss': '6.7522'}
2025-02-27 21:32:46,656 - {'Epoch': 38, 'HR@5': '0.0880', 'NDCG@5': '0.0623', 'HR@10': '0.1219', 'NDCG@10': '0.0733', 'HR@20': '0.1642', 'NDCG@20': '0.0839'}
2025-02-27 21:32:46,665 - EarlyStopping counter: 5 out of 10
2025-02-27 21:33:13,603 - {'epoch': 39, 'rec_loss': '6.7438'}
2025-02-27 21:33:22,986 - {'Epoch': 39, 'HR@5': '0.0879', 'NDCG@5': '0.0623', 'HR@10': '0.1220', 'NDCG@10': '0.0733', 'HR@20': '0.1629', 'NDCG@20': '0.0836'}
2025-02-27 21:33:22,988 - EarlyStopping counter: 6 out of 10
2025-02-27 21:33:49,528 - {'epoch': 40, 'rec_loss': '6.7359'}
2025-02-27 21:33:58,846 - {'Epoch': 40, 'HR@5': '0.0882', 'NDCG@5': '0.0627', 'HR@10': '0.1227', 'NDCG@10': '0.0738', 'HR@20': '0.1642', 'NDCG@20': '0.0842'}
2025-02-27 21:33:58,855 - EarlyStopping counter: 7 out of 10
2025-02-27 21:34:25,031 - {'epoch': 41, 'rec_loss': '6.7268'}
2025-02-27 21:34:34,282 - {'Epoch': 41, 'HR@5': '0.0895', 'NDCG@5': '0.0633', 'HR@10': '0.1227', 'NDCG@10': '0.0740', 'HR@20': '0.1645', 'NDCG@20': '0.0846'}
2025-02-27 21:34:34,284 - EarlyStopping counter: 8 out of 10
2025-02-27 21:35:01,065 - {'epoch': 42, 'rec_loss': '6.7266'}
2025-02-27 21:35:10,154 - {'Epoch': 42, 'HR@5': '0.0880', 'NDCG@5': '0.0619', 'HR@10': '0.1207', 'NDCG@10': '0.0725', 'HR@20': '0.1634', 'NDCG@20': '0.0832'}
2025-02-27 21:35:10,156 - EarlyStopping counter: 9 out of 10
2025-02-27 21:35:36,959 - {'epoch': 43, 'rec_loss': '6.7124'}
2025-02-27 21:35:46,465 - {'Epoch': 43, 'HR@5': '0.0889', 'NDCG@5': '0.0628', 'HR@10': '0.1234', 'NDCG@10': '0.0740', 'HR@20': '0.1663', 'NDCG@20': '0.0848'}
2025-02-27 21:35:46,473 - Validation score increased.  Saving model ...
2025-02-27 21:36:13,071 - {'epoch': 44, 'rec_loss': '6.7150'}
2025-02-27 21:36:22,722 - {'Epoch': 44, 'HR@5': '0.0880', 'NDCG@5': '0.0620', 'HR@10': '0.1225', 'NDCG@10': '0.0730', 'HR@20': '0.1638', 'NDCG@20': '0.0834'}
2025-02-27 21:36:22,724 - EarlyStopping counter: 1 out of 10
2025-02-27 21:36:49,483 - {'epoch': 45, 'rec_loss': '6.7102'}
2025-02-27 21:36:58,863 - {'Epoch': 45, 'HR@5': '0.0888', 'NDCG@5': '0.0625', 'HR@10': '0.1223', 'NDCG@10': '0.0733', 'HR@20': '0.1654', 'NDCG@20': '0.0842'}
2025-02-27 21:36:58,864 - EarlyStopping counter: 2 out of 10
2025-02-27 21:37:25,085 - {'epoch': 46, 'rec_loss': '6.7037'}
2025-02-27 21:37:34,402 - {'Epoch': 46, 'HR@5': '0.0896', 'NDCG@5': '0.0634', 'HR@10': '0.1225', 'NDCG@10': '0.0741', 'HR@20': '0.1650', 'NDCG@20': '0.0848'}
2025-02-27 21:37:34,403 - EarlyStopping counter: 3 out of 10
2025-02-27 21:38:01,106 - {'epoch': 47, 'rec_loss': '6.6989'}
2025-02-27 21:38:10,612 - {'Epoch': 47, 'HR@5': '0.0901', 'NDCG@5': '0.0631', 'HR@10': '0.1228', 'NDCG@10': '0.0737', 'HR@20': '0.1653', 'NDCG@20': '0.0844'}
2025-02-27 21:38:10,613 - EarlyStopping counter: 4 out of 10
2025-02-27 21:38:37,210 - {'epoch': 48, 'rec_loss': '6.6932'}
2025-02-27 21:38:46,512 - {'Epoch': 48, 'HR@5': '0.0891', 'NDCG@5': '0.0636', 'HR@10': '0.1219', 'NDCG@10': '0.0741', 'HR@20': '0.1645', 'NDCG@20': '0.0849'}
2025-02-27 21:38:46,514 - Validation score increased.  Saving model ...
2025-02-27 21:39:13,502 - {'epoch': 49, 'rec_loss': '6.6855'}
2025-02-27 21:39:22,772 - {'Epoch': 49, 'HR@5': '0.0892', 'NDCG@5': '0.0628', 'HR@10': '0.1217', 'NDCG@10': '0.0733', 'HR@20': '0.1631', 'NDCG@20': '0.0838'}
2025-02-27 21:39:22,773 - EarlyStopping counter: 1 out of 10
2025-02-27 21:39:49,379 - {'epoch': 50, 'rec_loss': '6.6880'}
2025-02-27 21:39:58,583 - {'Epoch': 50, 'HR@5': '0.0888', 'NDCG@5': '0.0629', 'HR@10': '0.1211', 'NDCG@10': '0.0733', 'HR@20': '0.1630', 'NDCG@20': '0.0839'}
2025-02-27 21:39:58,585 - EarlyStopping counter: 2 out of 10
2025-02-27 21:40:24,767 - {'epoch': 51, 'rec_loss': '6.6869'}
2025-02-27 21:40:34,735 - {'Epoch': 51, 'HR@5': '0.0868', 'NDCG@5': '0.0615', 'HR@10': '0.1210', 'NDCG@10': '0.0725', 'HR@20': '0.1618', 'NDCG@20': '0.0828'}
2025-02-27 21:40:34,737 - EarlyStopping counter: 3 out of 10
2025-02-27 21:41:00,930 - {'epoch': 52, 'rec_loss': '6.6780'}
2025-02-27 21:41:10,346 - {'Epoch': 52, 'HR@5': '0.0891', 'NDCG@5': '0.0627', 'HR@10': '0.1221', 'NDCG@10': '0.0733', 'HR@20': '0.1650', 'NDCG@20': '0.0841'}
2025-02-27 21:41:10,347 - EarlyStopping counter: 4 out of 10
2025-02-27 21:41:36,355 - {'epoch': 53, 'rec_loss': '6.6736'}
2025-02-27 21:41:46,022 - {'Epoch': 53, 'HR@5': '0.0886', 'NDCG@5': '0.0625', 'HR@10': '0.1215', 'NDCG@10': '0.0731', 'HR@20': '0.1640', 'NDCG@20': '0.0838'}
2025-02-27 21:41:46,024 - EarlyStopping counter: 5 out of 10
2025-02-27 21:42:12,626 - {'epoch': 54, 'rec_loss': '6.6664'}
2025-02-27 21:42:22,230 - {'Epoch': 54, 'HR@5': '0.0881', 'NDCG@5': '0.0626', 'HR@10': '0.1212', 'NDCG@10': '0.0732', 'HR@20': '0.1631', 'NDCG@20': '0.0837'}
2025-02-27 21:42:22,232 - EarlyStopping counter: 6 out of 10
2025-02-27 21:42:48,501 - {'epoch': 55, 'rec_loss': '6.6625'}
2025-02-27 21:42:57,731 - {'Epoch': 55, 'HR@5': '0.0875', 'NDCG@5': '0.0620', 'HR@10': '0.1207', 'NDCG@10': '0.0727', 'HR@20': '0.1629', 'NDCG@20': '0.0834'}
2025-02-27 21:42:57,732 - EarlyStopping counter: 7 out of 10
2025-02-27 21:43:24,108 - {'epoch': 56, 'rec_loss': '6.6573'}
2025-02-27 21:43:33,545 - {'Epoch': 56, 'HR@5': '0.0888', 'NDCG@5': '0.0630', 'HR@10': '0.1219', 'NDCG@10': '0.0736', 'HR@20': '0.1636', 'NDCG@20': '0.0841'}
2025-02-27 21:43:33,547 - EarlyStopping counter: 8 out of 10
2025-02-27 21:44:00,348 - {'epoch': 57, 'rec_loss': '6.6547'}
2025-02-27 21:44:09,977 - {'Epoch': 57, 'HR@5': '0.0892', 'NDCG@5': '0.0628', 'HR@10': '0.1234', 'NDCG@10': '0.0738', 'HR@20': '0.1657', 'NDCG@20': '0.0844'}
2025-02-27 21:44:09,978 - EarlyStopping counter: 9 out of 10
2025-02-27 21:44:35,989 - {'epoch': 58, 'rec_loss': '6.6524'}
2025-02-27 21:44:45,709 - {'Epoch': 58, 'HR@5': '0.0875', 'NDCG@5': '0.0618', 'HR@10': '0.1211', 'NDCG@10': '0.0727', 'HR@20': '0.1640', 'NDCG@20': '0.0835'}
2025-02-27 21:44:45,711 - EarlyStopping counter: 10 out of 10
2025-02-27 21:44:45,711 - Early stopping
2025-02-27 21:44:45,711 - ---------------Test Score---------------
2025-02-27 21:44:54,460 - {'Epoch': 0, 'HR@5': '0.0702', 'NDCG@5': '0.0494', 'HR@10': '0.1003', 'NDCG@10': '0.0591', 'HR@20': '0.1395', 'NDCG@20': '0.0689'}
2025-02-27 21:44:54,462 - Scale_Beauty
2025-02-27 21:44:54,462 - {'Epoch': 0, 'HR@5': '0.0702', 'NDCG@5': '0.0494', 'HR@10': '0.1003', 'NDCG@10': '0.0591', 'HR@20': '0.1395', 'NDCG@20': '0.0689'}
2025-02-27 21:50:36,580 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[2, 4, 8], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-02-27 21:50:39,424 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-27 21:50:39,429 - Total Parameters: 929445
2025-02-27 21:51:08,391 - {'epoch': 0, 'rec_loss': '8.8323'}
2025-02-27 21:51:16,265 - {'Epoch': 0, 'HR@5': '0.0190', 'NDCG@5': '0.0119', 'HR@10': '0.0302', 'NDCG@10': '0.0155', 'HR@20': '0.0466', 'NDCG@20': '0.0196'}
2025-02-27 21:51:16,267 - Validation score increased.  Saving model ...
2025-02-27 21:51:44,660 - {'epoch': 1, 'rec_loss': '8.3249'}
2025-02-27 21:51:52,476 - {'Epoch': 1, 'HR@5': '0.0371', 'NDCG@5': '0.0251', 'HR@10': '0.0560', 'NDCG@10': '0.0312', 'HR@20': '0.0819', 'NDCG@20': '0.0377'}
2025-02-27 21:51:52,481 - Validation score increased.  Saving model ...
2025-02-27 21:52:20,028 - {'epoch': 2, 'rec_loss': '8.0137'}
2025-02-27 21:52:27,429 - {'Epoch': 2, 'HR@5': '0.0490', 'NDCG@5': '0.0335', 'HR@10': '0.0716', 'NDCG@10': '0.0408', 'HR@20': '0.1031', 'NDCG@20': '0.0488'}
2025-02-27 21:52:27,430 - Validation score increased.  Saving model ...
2025-02-27 21:52:54,782 - {'epoch': 3, 'rec_loss': '7.7983'}
2025-02-27 21:53:02,089 - {'Epoch': 3, 'HR@5': '0.0595', 'NDCG@5': '0.0403', 'HR@10': '0.0862', 'NDCG@10': '0.0489', 'HR@20': '0.1237', 'NDCG@20': '0.0583'}
2025-02-27 21:53:02,091 - Validation score increased.  Saving model ...
2025-02-27 21:53:30,091 - {'epoch': 4, 'rec_loss': '7.6344'}
2025-02-27 21:53:37,265 - {'Epoch': 4, 'HR@5': '0.0675', 'NDCG@5': '0.0468', 'HR@10': '0.0958', 'NDCG@10': '0.0559', 'HR@20': '0.1318', 'NDCG@20': '0.0649'}
2025-02-27 21:53:37,266 - Validation score increased.  Saving model ...
2025-02-27 21:54:04,895 - {'epoch': 5, 'rec_loss': '7.5197'}
2025-02-27 21:54:12,401 - {'Epoch': 5, 'HR@5': '0.0727', 'NDCG@5': '0.0509', 'HR@10': '0.1025', 'NDCG@10': '0.0605', 'HR@20': '0.1396', 'NDCG@20': '0.0698'}
2025-02-27 21:54:12,402 - Validation score increased.  Saving model ...
2025-02-27 21:54:41,467 - {'epoch': 6, 'rec_loss': '7.4213'}
2025-02-27 21:54:48,675 - {'Epoch': 6, 'HR@5': '0.0756', 'NDCG@5': '0.0532', 'HR@10': '0.1055', 'NDCG@10': '0.0628', 'HR@20': '0.1461', 'NDCG@20': '0.0730'}
2025-02-27 21:54:48,682 - Validation score increased.  Saving model ...
2025-02-27 21:55:15,395 - {'epoch': 7, 'rec_loss': '7.3404'}
2025-02-27 21:55:22,613 - {'Epoch': 7, 'HR@5': '0.0796', 'NDCG@5': '0.0560', 'HR@10': '0.1095', 'NDCG@10': '0.0656', 'HR@20': '0.1490', 'NDCG@20': '0.0756'}
2025-02-27 21:55:22,614 - Validation score increased.  Saving model ...
2025-02-27 21:55:50,993 - {'epoch': 8, 'rec_loss': '7.2713'}
2025-02-27 21:55:58,948 - {'Epoch': 8, 'HR@5': '0.0822', 'NDCG@5': '0.0581', 'HR@10': '0.1111', 'NDCG@10': '0.0674', 'HR@20': '0.1509', 'NDCG@20': '0.0774'}
2025-02-27 21:55:58,949 - Validation score increased.  Saving model ...
2025-02-27 21:56:26,025 - {'epoch': 9, 'rec_loss': '7.2227'}
2025-02-27 21:56:33,327 - {'Epoch': 9, 'HR@5': '0.0820', 'NDCG@5': '0.0571', 'HR@10': '0.1133', 'NDCG@10': '0.0672', 'HR@20': '0.1518', 'NDCG@20': '0.0769'}
2025-02-27 21:56:33,328 - EarlyStopping counter: 1 out of 10
2025-02-27 21:57:00,169 - {'epoch': 10, 'rec_loss': '7.1749'}
2025-02-27 21:57:07,497 - {'Epoch': 10, 'HR@5': '0.0829', 'NDCG@5': '0.0586', 'HR@10': '0.1144', 'NDCG@10': '0.0688', 'HR@20': '0.1525', 'NDCG@20': '0.0783'}
2025-02-27 21:57:07,498 - Validation score increased.  Saving model ...
2025-02-27 21:57:35,492 - {'epoch': 11, 'rec_loss': '7.1371'}
2025-02-27 21:57:42,972 - {'Epoch': 11, 'HR@5': '0.0840', 'NDCG@5': '0.0599', 'HR@10': '0.1140', 'NDCG@10': '0.0696', 'HR@20': '0.1542', 'NDCG@20': '0.0797'}
2025-02-27 21:57:42,973 - Validation score increased.  Saving model ...
2025-02-27 21:58:11,271 - {'epoch': 12, 'rec_loss': '7.1006'}
2025-02-27 21:58:18,847 - {'Epoch': 12, 'HR@5': '0.0848', 'NDCG@5': '0.0598', 'HR@10': '0.1161', 'NDCG@10': '0.0699', 'HR@20': '0.1571', 'NDCG@20': '0.0802'}
2025-02-27 21:58:18,848 - Validation score increased.  Saving model ...
2025-02-27 21:58:45,727 - {'epoch': 13, 'rec_loss': '7.0752'}
2025-02-27 21:58:53,433 - {'Epoch': 13, 'HR@5': '0.0849', 'NDCG@5': '0.0596', 'HR@10': '0.1181', 'NDCG@10': '0.0703', 'HR@20': '0.1580', 'NDCG@20': '0.0804'}
2025-02-27 21:58:53,434 - Validation score increased.  Saving model ...
2025-02-27 21:59:20,566 - {'epoch': 14, 'rec_loss': '7.0457'}
2025-02-27 21:59:27,871 - {'Epoch': 14, 'HR@5': '0.0867', 'NDCG@5': '0.0607', 'HR@10': '0.1187', 'NDCG@10': '0.0710', 'HR@20': '0.1591', 'NDCG@20': '0.0812'}
2025-02-27 21:59:27,872 - Validation score increased.  Saving model ...
2025-02-27 21:59:55,792 - {'epoch': 15, 'rec_loss': '7.0261'}
2025-02-27 22:00:03,223 - {'Epoch': 15, 'HR@5': '0.0858', 'NDCG@5': '0.0605', 'HR@10': '0.1186', 'NDCG@10': '0.0711', 'HR@20': '0.1608', 'NDCG@20': '0.0817'}
2025-02-27 22:00:03,224 - Validation score increased.  Saving model ...
2025-02-27 22:00:31,309 - {'epoch': 16, 'rec_loss': '7.0044'}
2025-02-27 22:00:39,030 - {'Epoch': 16, 'HR@5': '0.0869', 'NDCG@5': '0.0607', 'HR@10': '0.1176', 'NDCG@10': '0.0706', 'HR@20': '0.1612', 'NDCG@20': '0.0816'}
2025-02-27 22:00:39,031 - EarlyStopping counter: 1 out of 10
2025-02-27 22:01:06,938 - {'epoch': 17, 'rec_loss': '6.9879'}
2025-02-27 22:01:14,696 - {'Epoch': 17, 'HR@5': '0.0854', 'NDCG@5': '0.0605', 'HR@10': '0.1183', 'NDCG@10': '0.0710', 'HR@20': '0.1602', 'NDCG@20': '0.0816'}
2025-02-27 22:01:14,701 - EarlyStopping counter: 2 out of 10
2025-02-27 22:01:42,061 - {'epoch': 18, 'rec_loss': '6.9578'}
2025-02-27 22:01:49,406 - {'Epoch': 18, 'HR@5': '0.0876', 'NDCG@5': '0.0615', 'HR@10': '0.1181', 'NDCG@10': '0.0713', 'HR@20': '0.1609', 'NDCG@20': '0.0820'}
2025-02-27 22:01:49,407 - Validation score increased.  Saving model ...
2025-02-27 22:02:16,812 - {'epoch': 19, 'rec_loss': '6.9458'}
2025-02-27 22:02:24,178 - {'Epoch': 19, 'HR@5': '0.0869', 'NDCG@5': '0.0617', 'HR@10': '0.1186', 'NDCG@10': '0.0718', 'HR@20': '0.1623', 'NDCG@20': '0.0828'}
2025-02-27 22:02:24,185 - Validation score increased.  Saving model ...
2025-02-27 22:02:51,636 - {'epoch': 20, 'rec_loss': '6.9248'}
2025-02-27 22:02:59,364 - {'Epoch': 20, 'HR@5': '0.0864', 'NDCG@5': '0.0612', 'HR@10': '0.1202', 'NDCG@10': '0.0722', 'HR@20': '0.1634', 'NDCG@20': '0.0830'}
2025-02-27 22:02:59,366 - Validation score increased.  Saving model ...
2025-02-27 22:03:26,807 - {'epoch': 21, 'rec_loss': '6.9173'}
2025-02-27 22:03:34,738 - {'Epoch': 21, 'HR@5': '0.0880', 'NDCG@5': '0.0616', 'HR@10': '0.1209', 'NDCG@10': '0.0721', 'HR@20': '0.1630', 'NDCG@20': '0.0827'}
2025-02-27 22:03:34,739 - EarlyStopping counter: 1 out of 10
2025-02-27 22:04:01,247 - {'epoch': 22, 'rec_loss': '6.9060'}
2025-02-27 22:04:08,629 - {'Epoch': 22, 'HR@5': '0.0876', 'NDCG@5': '0.0623', 'HR@10': '0.1210', 'NDCG@10': '0.0731', 'HR@20': '0.1629', 'NDCG@20': '0.0836'}
2025-02-27 22:04:08,631 - Validation score increased.  Saving model ...
2025-02-27 22:04:36,596 - {'epoch': 23, 'rec_loss': '6.8904'}
2025-02-27 22:04:44,032 - {'Epoch': 23, 'HR@5': '0.0873', 'NDCG@5': '0.0626', 'HR@10': '0.1205', 'NDCG@10': '0.0732', 'HR@20': '0.1635', 'NDCG@20': '0.0841'}
2025-02-27 22:04:44,033 - Validation score increased.  Saving model ...
2025-02-27 22:05:10,821 - {'epoch': 24, 'rec_loss': '6.8826'}
2025-02-27 22:05:18,259 - {'Epoch': 24, 'HR@5': '0.0869', 'NDCG@5': '0.0617', 'HR@10': '0.1204', 'NDCG@10': '0.0724', 'HR@20': '0.1626', 'NDCG@20': '0.0830'}
2025-02-27 22:05:18,260 - EarlyStopping counter: 1 out of 10
2025-02-27 22:05:44,719 - {'epoch': 25, 'rec_loss': '6.8625'}
2025-02-27 22:05:52,177 - {'Epoch': 25, 'HR@5': '0.0865', 'NDCG@5': '0.0612', 'HR@10': '0.1202', 'NDCG@10': '0.0721', 'HR@20': '0.1643', 'NDCG@20': '0.0832'}
2025-02-27 22:05:52,178 - EarlyStopping counter: 2 out of 10
2025-02-27 22:06:20,088 - {'epoch': 26, 'rec_loss': '6.8587'}
2025-02-27 22:06:27,314 - {'Epoch': 26, 'HR@5': '0.0887', 'NDCG@5': '0.0625', 'HR@10': '0.1216', 'NDCG@10': '0.0731', 'HR@20': '0.1626', 'NDCG@20': '0.0834'}
2025-02-27 22:06:27,315 - EarlyStopping counter: 3 out of 10
2025-02-27 22:06:55,209 - {'epoch': 27, 'rec_loss': '6.8421'}
2025-02-27 22:07:02,618 - {'Epoch': 27, 'HR@5': '0.0877', 'NDCG@5': '0.0623', 'HR@10': '0.1206', 'NDCG@10': '0.0728', 'HR@20': '0.1625', 'NDCG@20': '0.0833'}
2025-02-27 22:07:02,620 - EarlyStopping counter: 4 out of 10
2025-02-27 22:07:29,942 - {'epoch': 28, 'rec_loss': '6.8389'}
2025-02-27 22:07:38,029 - {'Epoch': 28, 'HR@5': '0.0878', 'NDCG@5': '0.0618', 'HR@10': '0.1212', 'NDCG@10': '0.0726', 'HR@20': '0.1626', 'NDCG@20': '0.0830'}
2025-02-27 22:07:38,030 - EarlyStopping counter: 5 out of 10
2025-02-27 22:08:05,937 - {'epoch': 29, 'rec_loss': '6.8306'}
2025-02-27 22:08:13,351 - {'Epoch': 29, 'HR@5': '0.0864', 'NDCG@5': '0.0610', 'HR@10': '0.1219', 'NDCG@10': '0.0724', 'HR@20': '0.1625', 'NDCG@20': '0.0826'}
2025-02-27 22:08:13,353 - EarlyStopping counter: 6 out of 10
2025-02-27 22:08:41,288 - {'epoch': 30, 'rec_loss': '6.8198'}
2025-02-27 22:08:49,052 - {'Epoch': 30, 'HR@5': '0.0879', 'NDCG@5': '0.0624', 'HR@10': '0.1207', 'NDCG@10': '0.0730', 'HR@20': '0.1647', 'NDCG@20': '0.0840'}
2025-02-27 22:08:49,056 - EarlyStopping counter: 7 out of 10
2025-02-27 22:09:17,213 - {'epoch': 31, 'rec_loss': '6.8055'}
2025-02-27 22:09:24,720 - {'Epoch': 31, 'HR@5': '0.0880', 'NDCG@5': '0.0628', 'HR@10': '0.1206', 'NDCG@10': '0.0733', 'HR@20': '0.1644', 'NDCG@20': '0.0843'}
2025-02-27 22:09:24,721 - Validation score increased.  Saving model ...
2025-02-27 22:09:52,339 - {'epoch': 32, 'rec_loss': '6.8035'}
2025-02-27 22:09:59,722 - {'Epoch': 32, 'HR@5': '0.0882', 'NDCG@5': '0.0623', 'HR@10': '0.1210', 'NDCG@10': '0.0729', 'HR@20': '0.1639', 'NDCG@20': '0.0837'}
2025-02-27 22:09:59,723 - EarlyStopping counter: 1 out of 10
2025-02-27 22:10:27,435 - {'epoch': 33, 'rec_loss': '6.7988'}
2025-02-27 22:10:34,863 - {'Epoch': 33, 'HR@5': '0.0885', 'NDCG@5': '0.0627', 'HR@10': '0.1193', 'NDCG@10': '0.0727', 'HR@20': '0.1634', 'NDCG@20': '0.0838'}
2025-02-27 22:10:34,864 - EarlyStopping counter: 2 out of 10
2025-02-27 22:11:02,728 - {'epoch': 34, 'rec_loss': '6.7830'}
2025-02-27 22:11:10,392 - {'Epoch': 34, 'HR@5': '0.0879', 'NDCG@5': '0.0620', 'HR@10': '0.1199', 'NDCG@10': '0.0723', 'HR@20': '0.1629', 'NDCG@20': '0.0831'}
2025-02-27 22:11:10,393 - EarlyStopping counter: 3 out of 10
2025-02-27 22:11:38,891 - {'epoch': 35, 'rec_loss': '6.7789'}
2025-02-27 22:11:46,196 - {'Epoch': 35, 'HR@5': '0.0869', 'NDCG@5': '0.0611', 'HR@10': '0.1193', 'NDCG@10': '0.0715', 'HR@20': '0.1638', 'NDCG@20': '0.0827'}
2025-02-27 22:11:46,203 - EarlyStopping counter: 4 out of 10
2025-02-27 22:12:13,450 - {'epoch': 36, 'rec_loss': '6.7711'}
2025-02-27 22:12:21,043 - {'Epoch': 36, 'HR@5': '0.0875', 'NDCG@5': '0.0625', 'HR@10': '0.1216', 'NDCG@10': '0.0735', 'HR@20': '0.1640', 'NDCG@20': '0.0841'}
2025-02-27 22:12:21,044 - EarlyStopping counter: 5 out of 10
2025-02-27 22:12:50,025 - {'epoch': 37, 'rec_loss': '6.7567'}
2025-02-27 22:12:57,336 - {'Epoch': 37, 'HR@5': '0.0870', 'NDCG@5': '0.0613', 'HR@10': '0.1202', 'NDCG@10': '0.0720', 'HR@20': '0.1655', 'NDCG@20': '0.0834'}
2025-02-27 22:12:57,338 - EarlyStopping counter: 6 out of 10
2025-02-27 22:13:25,335 - {'epoch': 38, 'rec_loss': '6.7572'}
2025-02-27 22:13:32,869 - {'Epoch': 38, 'HR@5': '0.0863', 'NDCG@5': '0.0614', 'HR@10': '0.1213', 'NDCG@10': '0.0725', 'HR@20': '0.1642', 'NDCG@20': '0.0833'}
2025-02-27 22:13:32,874 - EarlyStopping counter: 7 out of 10
2025-02-27 22:14:00,647 - {'epoch': 39, 'rec_loss': '6.7509'}
2025-02-27 22:14:08,426 - {'Epoch': 39, 'HR@5': '0.0859', 'NDCG@5': '0.0606', 'HR@10': '0.1176', 'NDCG@10': '0.0708', 'HR@20': '0.1611', 'NDCG@20': '0.0818'}
2025-02-27 22:14:08,427 - EarlyStopping counter: 8 out of 10
2025-02-27 22:14:37,890 - {'epoch': 40, 'rec_loss': '6.7517'}
2025-02-27 22:14:45,259 - {'Epoch': 40, 'HR@5': '0.0866', 'NDCG@5': '0.0617', 'HR@10': '0.1202', 'NDCG@10': '0.0725', 'HR@20': '0.1641', 'NDCG@20': '0.0836'}
2025-02-27 22:14:45,260 - EarlyStopping counter: 9 out of 10
2025-02-27 22:15:13,038 - {'epoch': 41, 'rec_loss': '6.7389'}
2025-02-27 22:15:20,376 - {'Epoch': 41, 'HR@5': '0.0880', 'NDCG@5': '0.0626', 'HR@10': '0.1193', 'NDCG@10': '0.0727', 'HR@20': '0.1646', 'NDCG@20': '0.0841'}
2025-02-27 22:15:20,378 - EarlyStopping counter: 10 out of 10
2025-02-27 22:15:20,378 - Early stopping
2025-02-27 22:15:20,378 - ---------------Test Score---------------
2025-02-27 22:15:27,809 - {'Epoch': 0, 'HR@5': '0.0726', 'NDCG@5': '0.0503', 'HR@10': '0.1004', 'NDCG@10': '0.0592', 'HR@20': '0.1377', 'NDCG@20': '0.0685'}
2025-02-27 22:15:27,810 - Scale_Beauty
2025-02-27 22:15:27,810 - {'Epoch': 0, 'HR@5': '0.0726', 'NDCG@5': '0.0503', 'HR@10': '0.1004', 'NDCG@10': '0.0592', 'HR@20': '0.1377', 'NDCG@20': '0.0685'}
2025-03-01 22:16:43,607 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 24], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-01 22:16:46,626 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-01 22:16:46,631 - Total Parameters: 929445
2025-03-01 22:17:14,785 - {'epoch': 0, 'rec_loss': '8.8326'}
2025-03-01 22:17:23,976 - {'Epoch': 0, 'HR@5': '0.0189', 'NDCG@5': '0.0120', 'HR@10': '0.0305', 'NDCG@10': '0.0158', 'HR@20': '0.0468', 'NDCG@20': '0.0198'}
2025-03-01 22:17:23,983 - Validation score increased.  Saving model ...
2025-03-01 22:17:50,585 - {'epoch': 1, 'rec_loss': '8.3257'}
2025-03-01 22:17:58,958 - {'Epoch': 1, 'HR@5': '0.0372', 'NDCG@5': '0.0250', 'HR@10': '0.0560', 'NDCG@10': '0.0311', 'HR@20': '0.0817', 'NDCG@20': '0.0375'}
2025-03-01 22:17:58,960 - Validation score increased.  Saving model ...
2025-03-01 22:18:29,324 - {'epoch': 2, 'rec_loss': '8.0144'}
2025-03-01 22:18:37,538 - {'Epoch': 2, 'HR@5': '0.0487', 'NDCG@5': '0.0334', 'HR@10': '0.0723', 'NDCG@10': '0.0410', 'HR@20': '0.1037', 'NDCG@20': '0.0489'}
2025-03-01 22:18:37,540 - Validation score increased.  Saving model ...
2025-03-01 22:19:06,897 - {'epoch': 3, 'rec_loss': '7.7982'}
2025-03-01 22:19:14,996 - {'Epoch': 3, 'HR@5': '0.0588', 'NDCG@5': '0.0400', 'HR@10': '0.0856', 'NDCG@10': '0.0486', 'HR@20': '0.1237', 'NDCG@20': '0.0583'}
2025-03-01 22:19:14,997 - Validation score increased.  Saving model ...
2025-03-01 22:19:42,771 - {'epoch': 4, 'rec_loss': '7.6346'}
2025-03-01 22:19:50,737 - {'Epoch': 4, 'HR@5': '0.0676', 'NDCG@5': '0.0470', 'HR@10': '0.0957', 'NDCG@10': '0.0560', 'HR@20': '0.1324', 'NDCG@20': '0.0652'}
2025-03-01 22:19:50,743 - Validation score increased.  Saving model ...
2025-03-01 22:20:19,741 - {'epoch': 5, 'rec_loss': '7.5190'}
2025-03-01 22:20:28,748 - {'Epoch': 5, 'HR@5': '0.0728', 'NDCG@5': '0.0510', 'HR@10': '0.1024', 'NDCG@10': '0.0605', 'HR@20': '0.1390', 'NDCG@20': '0.0697'}
2025-03-01 22:20:28,750 - Validation score increased.  Saving model ...
2025-03-01 22:20:56,232 - {'epoch': 6, 'rec_loss': '7.4214'}
2025-03-01 22:21:04,563 - {'Epoch': 6, 'HR@5': '0.0755', 'NDCG@5': '0.0532', 'HR@10': '0.1054', 'NDCG@10': '0.0628', 'HR@20': '0.1457', 'NDCG@20': '0.0729'}
2025-03-01 22:21:04,565 - Validation score increased.  Saving model ...
2025-03-01 22:21:31,680 - {'epoch': 7, 'rec_loss': '7.3414'}
2025-03-01 22:21:39,950 - {'Epoch': 7, 'HR@5': '0.0799', 'NDCG@5': '0.0562', 'HR@10': '0.1092', 'NDCG@10': '0.0656', 'HR@20': '0.1492', 'NDCG@20': '0.0756'}
2025-03-01 22:21:39,960 - Validation score increased.  Saving model ...
2025-03-01 22:22:07,140 - {'epoch': 8, 'rec_loss': '7.2714'}
2025-03-01 22:22:14,760 - {'Epoch': 8, 'HR@5': '0.0824', 'NDCG@5': '0.0581', 'HR@10': '0.1104', 'NDCG@10': '0.0671', 'HR@20': '0.1503', 'NDCG@20': '0.0772'}
2025-03-01 22:22:14,762 - Validation score increased.  Saving model ...
2025-03-01 22:22:43,128 - {'epoch': 9, 'rec_loss': '7.2229'}
2025-03-01 22:22:51,637 - {'Epoch': 9, 'HR@5': '0.0814', 'NDCG@5': '0.0571', 'HR@10': '0.1134', 'NDCG@10': '0.0674', 'HR@20': '0.1523', 'NDCG@20': '0.0772'}
2025-03-01 22:22:51,639 - EarlyStopping counter: 1 out of 10
2025-03-01 22:23:19,458 - {'epoch': 10, 'rec_loss': '7.1749'}
2025-03-01 22:23:27,331 - {'Epoch': 10, 'HR@5': '0.0837', 'NDCG@5': '0.0591', 'HR@10': '0.1132', 'NDCG@10': '0.0686', 'HR@20': '0.1525', 'NDCG@20': '0.0785'}
2025-03-01 22:23:27,332 - Validation score increased.  Saving model ...
2025-03-01 22:23:54,224 - {'epoch': 11, 'rec_loss': '7.1364'}
2025-03-01 22:24:01,914 - {'Epoch': 11, 'HR@5': '0.0843', 'NDCG@5': '0.0598', 'HR@10': '0.1145', 'NDCG@10': '0.0696', 'HR@20': '0.1536', 'NDCG@20': '0.0794'}
2025-03-01 22:24:01,915 - Validation score increased.  Saving model ...
2025-03-01 22:24:29,411 - {'epoch': 12, 'rec_loss': '7.0997'}
2025-03-01 22:24:37,141 - {'Epoch': 12, 'HR@5': '0.0844', 'NDCG@5': '0.0597', 'HR@10': '0.1165', 'NDCG@10': '0.0700', 'HR@20': '0.1561', 'NDCG@20': '0.0800'}
2025-03-01 22:24:37,143 - Validation score increased.  Saving model ...
2025-03-01 22:25:06,108 - {'epoch': 13, 'rec_loss': '7.0738'}
2025-03-01 22:25:13,710 - {'Epoch': 13, 'HR@5': '0.0852', 'NDCG@5': '0.0596', 'HR@10': '0.1179', 'NDCG@10': '0.0702', 'HR@20': '0.1584', 'NDCG@20': '0.0804'}
2025-03-01 22:25:13,711 - Validation score increased.  Saving model ...
2025-03-01 22:25:41,348 - {'epoch': 14, 'rec_loss': '7.0435'}
2025-03-01 22:25:50,147 - {'Epoch': 14, 'HR@5': '0.0870', 'NDCG@5': '0.0607', 'HR@10': '0.1177', 'NDCG@10': '0.0706', 'HR@20': '0.1597', 'NDCG@20': '0.0812'}
2025-03-01 22:25:50,148 - Validation score increased.  Saving model ...
2025-03-01 22:26:17,490 - {'epoch': 15, 'rec_loss': '7.0238'}
2025-03-01 22:26:26,352 - {'Epoch': 15, 'HR@5': '0.0865', 'NDCG@5': '0.0606', 'HR@10': '0.1180', 'NDCG@10': '0.0708', 'HR@20': '0.1609', 'NDCG@20': '0.0816'}
2025-03-01 22:26:26,354 - Validation score increased.  Saving model ...
2025-03-01 22:26:53,909 - {'epoch': 16, 'rec_loss': '7.0016'}
2025-03-01 22:27:01,944 - {'Epoch': 16, 'HR@5': '0.0857', 'NDCG@5': '0.0603', 'HR@10': '0.1183', 'NDCG@10': '0.0708', 'HR@20': '0.1611', 'NDCG@20': '0.0815'}
2025-03-01 22:27:01,945 - EarlyStopping counter: 1 out of 10
2025-03-01 22:27:29,309 - {'epoch': 17, 'rec_loss': '6.9855'}
2025-03-01 22:27:37,708 - {'Epoch': 17, 'HR@5': '0.0849', 'NDCG@5': '0.0606', 'HR@10': '0.1179', 'NDCG@10': '0.0712', 'HR@20': '0.1609', 'NDCG@20': '0.0821'}
2025-03-01 22:27:37,710 - Validation score increased.  Saving model ...
2025-03-01 22:28:04,789 - {'epoch': 18, 'rec_loss': '6.9540'}
2025-03-01 22:28:12,922 - {'Epoch': 18, 'HR@5': '0.0870', 'NDCG@5': '0.0611', 'HR@10': '0.1185', 'NDCG@10': '0.0712', 'HR@20': '0.1609', 'NDCG@20': '0.0818'}
2025-03-01 22:28:12,923 - EarlyStopping counter: 1 out of 10
2025-03-01 22:28:40,516 - {'epoch': 19, 'rec_loss': '6.9431'}
2025-03-01 22:28:48,405 - {'Epoch': 19, 'HR@5': '0.0869', 'NDCG@5': '0.0617', 'HR@10': '0.1183', 'NDCG@10': '0.0718', 'HR@20': '0.1628', 'NDCG@20': '0.0829'}
2025-03-01 22:28:48,406 - Validation score increased.  Saving model ...
2025-03-01 22:29:16,090 - {'epoch': 20, 'rec_loss': '6.9225'}
2025-03-01 22:29:24,344 - {'Epoch': 20, 'HR@5': '0.0866', 'NDCG@5': '0.0616', 'HR@10': '0.1200', 'NDCG@10': '0.0724', 'HR@20': '0.1640', 'NDCG@20': '0.0834'}
2025-03-01 22:29:24,346 - Validation score increased.  Saving model ...
2025-03-01 22:29:52,224 - {'epoch': 21, 'rec_loss': '6.9141'}
2025-03-01 22:30:00,342 - {'Epoch': 21, 'HR@5': '0.0879', 'NDCG@5': '0.0619', 'HR@10': '0.1206', 'NDCG@10': '0.0724', 'HR@20': '0.1624', 'NDCG@20': '0.0829'}
2025-03-01 22:30:00,344 - EarlyStopping counter: 1 out of 10
2025-03-01 22:30:27,702 - {'epoch': 22, 'rec_loss': '6.9032'}
2025-03-01 22:30:35,805 - {'Epoch': 22, 'HR@5': '0.0879', 'NDCG@5': '0.0622', 'HR@10': '0.1208', 'NDCG@10': '0.0729', 'HR@20': '0.1630', 'NDCG@20': '0.0835'}
2025-03-01 22:30:35,807 - Validation score increased.  Saving model ...
2025-03-01 22:31:03,054 - {'epoch': 23, 'rec_loss': '6.8865'}
2025-03-01 22:31:10,993 - {'Epoch': 23, 'HR@5': '0.0878', 'NDCG@5': '0.0624', 'HR@10': '0.1208', 'NDCG@10': '0.0731', 'HR@20': '0.1632', 'NDCG@20': '0.0837'}
2025-03-01 22:31:10,994 - Validation score increased.  Saving model ...
2025-03-01 22:31:40,510 - {'epoch': 24, 'rec_loss': '6.8792'}
2025-03-01 22:31:50,263 - {'Epoch': 24, 'HR@5': '0.0870', 'NDCG@5': '0.0615', 'HR@10': '0.1206', 'NDCG@10': '0.0723', 'HR@20': '0.1627', 'NDCG@20': '0.0829'}
2025-03-01 22:31:50,265 - EarlyStopping counter: 1 out of 10
2025-03-01 22:32:21,533 - {'epoch': 25, 'rec_loss': '6.8593'}
2025-03-01 22:32:29,721 - {'Epoch': 25, 'HR@5': '0.0876', 'NDCG@5': '0.0616', 'HR@10': '0.1210', 'NDCG@10': '0.0723', 'HR@20': '0.1636', 'NDCG@20': '0.0830'}
2025-03-01 22:32:29,722 - EarlyStopping counter: 2 out of 10
2025-03-01 22:32:57,263 - {'epoch': 26, 'rec_loss': '6.8549'}
2025-03-01 22:33:06,339 - {'Epoch': 26, 'HR@5': '0.0890', 'NDCG@5': '0.0626', 'HR@10': '0.1220', 'NDCG@10': '0.0731', 'HR@20': '0.1643', 'NDCG@20': '0.0838'}
2025-03-01 22:33:06,340 - Validation score increased.  Saving model ...
2025-03-01 22:33:36,436 - {'epoch': 27, 'rec_loss': '6.8389'}
2025-03-01 22:33:45,630 - {'Epoch': 27, 'HR@5': '0.0874', 'NDCG@5': '0.0622', 'HR@10': '0.1203', 'NDCG@10': '0.0728', 'HR@20': '0.1628', 'NDCG@20': '0.0834'}
2025-03-01 22:33:45,631 - EarlyStopping counter: 1 out of 10
2025-03-01 22:34:16,434 - {'epoch': 28, 'rec_loss': '6.8348'}
2025-03-01 22:34:25,503 - {'Epoch': 28, 'HR@5': '0.0884', 'NDCG@5': '0.0622', 'HR@10': '0.1213', 'NDCG@10': '0.0727', 'HR@20': '0.1624', 'NDCG@20': '0.0831'}
2025-03-01 22:34:25,504 - EarlyStopping counter: 2 out of 10
2025-03-01 22:34:51,149 - {'epoch': 29, 'rec_loss': '6.8263'}
2025-03-01 22:35:00,086 - {'Epoch': 29, 'HR@5': '0.0874', 'NDCG@5': '0.0613', 'HR@10': '0.1205', 'NDCG@10': '0.0720', 'HR@20': '0.1628', 'NDCG@20': '0.0826'}
2025-03-01 22:35:00,087 - EarlyStopping counter: 3 out of 10
2025-03-01 22:35:31,462 - {'epoch': 30, 'rec_loss': '6.8160'}
2025-03-01 22:35:40,491 - {'Epoch': 30, 'HR@5': '0.0880', 'NDCG@5': '0.0621', 'HR@10': '0.1207', 'NDCG@10': '0.0726', 'HR@20': '0.1645', 'NDCG@20': '0.0837'}
2025-03-01 22:35:40,492 - EarlyStopping counter: 4 out of 10
2025-03-01 22:36:10,431 - {'epoch': 31, 'rec_loss': '6.8018'}
2025-03-01 22:36:19,094 - {'Epoch': 31, 'HR@5': '0.0880', 'NDCG@5': '0.0626', 'HR@10': '0.1208', 'NDCG@10': '0.0732', 'HR@20': '0.1635', 'NDCG@20': '0.0840'}
2025-03-01 22:36:19,095 - Validation score increased.  Saving model ...
2025-03-01 22:36:48,010 - {'epoch': 32, 'rec_loss': '6.7988'}
2025-03-01 22:36:57,126 - {'Epoch': 32, 'HR@5': '0.0891', 'NDCG@5': '0.0633', 'HR@10': '0.1215', 'NDCG@10': '0.0737', 'HR@20': '0.1634', 'NDCG@20': '0.0843'}
2025-03-01 22:36:57,128 - Validation score increased.  Saving model ...
2025-03-01 22:37:28,897 - {'epoch': 33, 'rec_loss': '6.7953'}
2025-03-01 22:37:38,482 - {'Epoch': 33, 'HR@5': '0.0885', 'NDCG@5': '0.0627', 'HR@10': '0.1192', 'NDCG@10': '0.0726', 'HR@20': '0.1631', 'NDCG@20': '0.0836'}
2025-03-01 22:37:38,483 - EarlyStopping counter: 1 out of 10
2025-03-01 22:38:06,579 - {'epoch': 34, 'rec_loss': '6.7792'}
2025-03-01 22:38:16,066 - {'Epoch': 34, 'HR@5': '0.0886', 'NDCG@5': '0.0624', 'HR@10': '0.1203', 'NDCG@10': '0.0726', 'HR@20': '0.1628', 'NDCG@20': '0.0833'}
2025-03-01 22:38:16,069 - EarlyStopping counter: 2 out of 10
2025-03-01 22:38:44,591 - {'epoch': 35, 'rec_loss': '6.7753'}
2025-03-01 22:38:53,925 - {'Epoch': 35, 'HR@5': '0.0875', 'NDCG@5': '0.0613', 'HR@10': '0.1191', 'NDCG@10': '0.0714', 'HR@20': '0.1639', 'NDCG@20': '0.0827'}
2025-03-01 22:38:53,928 - EarlyStopping counter: 3 out of 10
2025-03-01 22:39:26,033 - {'epoch': 36, 'rec_loss': '6.7668'}
2025-03-01 22:39:35,363 - {'Epoch': 36, 'HR@5': '0.0876', 'NDCG@5': '0.0626', 'HR@10': '0.1216', 'NDCG@10': '0.0735', 'HR@20': '0.1634', 'NDCG@20': '0.0840'}
2025-03-01 22:39:35,369 - EarlyStopping counter: 4 out of 10
2025-03-01 22:40:00,742 - {'epoch': 37, 'rec_loss': '6.7526'}
2025-03-01 22:40:09,280 - {'Epoch': 37, 'HR@5': '0.0872', 'NDCG@5': '0.0615', 'HR@10': '0.1204', 'NDCG@10': '0.0722', 'HR@20': '0.1659', 'NDCG@20': '0.0837'}
2025-03-01 22:40:09,281 - EarlyStopping counter: 5 out of 10
2025-03-01 22:40:39,338 - {'epoch': 38, 'rec_loss': '6.7534'}
2025-03-01 22:40:48,415 - {'Epoch': 38, 'HR@5': '0.0864', 'NDCG@5': '0.0615', 'HR@10': '0.1210', 'NDCG@10': '0.0726', 'HR@20': '0.1640', 'NDCG@20': '0.0834'}
2025-03-01 22:40:48,417 - EarlyStopping counter: 6 out of 10
2025-03-01 22:41:19,401 - {'epoch': 39, 'rec_loss': '6.7465'}
2025-03-01 22:41:28,272 - {'Epoch': 39, 'HR@5': '0.0853', 'NDCG@5': '0.0606', 'HR@10': '0.1178', 'NDCG@10': '0.0711', 'HR@20': '0.1617', 'NDCG@20': '0.0822'}
2025-03-01 22:41:28,273 - EarlyStopping counter: 7 out of 10
2025-03-01 22:41:56,499 - {'epoch': 40, 'rec_loss': '6.7473'}
2025-03-01 22:42:05,673 - {'Epoch': 40, 'HR@5': '0.0872', 'NDCG@5': '0.0620', 'HR@10': '0.1193', 'NDCG@10': '0.0723', 'HR@20': '0.1647', 'NDCG@20': '0.0838'}
2025-03-01 22:42:05,674 - EarlyStopping counter: 8 out of 10
2025-03-01 22:42:36,991 - {'epoch': 41, 'rec_loss': '6.7350'}
2025-03-01 22:42:46,525 - {'Epoch': 41, 'HR@5': '0.0880', 'NDCG@5': '0.0625', 'HR@10': '0.1206', 'NDCG@10': '0.0730', 'HR@20': '0.1643', 'NDCG@20': '0.0840'}
2025-03-01 22:42:46,526 - EarlyStopping counter: 9 out of 10
2025-03-01 22:43:14,446 - {'epoch': 42, 'rec_loss': '6.7314'}
2025-03-01 22:43:23,590 - {'Epoch': 42, 'HR@5': '0.0893', 'NDCG@5': '0.0632', 'HR@10': '0.1201', 'NDCG@10': '0.0731', 'HR@20': '0.1641', 'NDCG@20': '0.0842'}
2025-03-01 22:43:23,592 - EarlyStopping counter: 10 out of 10
2025-03-01 22:43:23,592 - Early stopping
2025-03-01 22:43:23,592 - ---------------Test Score---------------
2025-03-01 22:43:32,009 - {'Epoch': 0, 'HR@5': '0.0728', 'NDCG@5': '0.0509', 'HR@10': '0.0999', 'NDCG@10': '0.0596', 'HR@20': '0.1366', 'NDCG@20': '0.0689'}
2025-03-01 22:43:32,010 - Scale_Beauty
2025-03-01 22:43:32,011 - {'Epoch': 0, 'HR@5': '0.0728', 'NDCG@5': '0.0509', 'HR@10': '0.0999', 'NDCG@10': '0.0596', 'HR@20': '0.1366', 'NDCG@20': '0.0689'}
2025-03-01 22:45:51,027 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 8, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-01 22:45:53,999 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-01 22:45:54,005 - Total Parameters: 929445
2025-03-01 22:46:25,661 - {'epoch': 0, 'rec_loss': '8.8328'}
2025-03-01 22:46:34,967 - {'Epoch': 0, 'HR@5': '0.0189', 'NDCG@5': '0.0120', 'HR@10': '0.0305', 'NDCG@10': '0.0157', 'HR@20': '0.0468', 'NDCG@20': '0.0198'}
2025-03-01 22:46:34,968 - Validation score increased.  Saving model ...
2025-03-01 22:47:08,066 - {'epoch': 1, 'rec_loss': '8.3259'}
2025-03-01 22:47:16,358 - {'Epoch': 1, 'HR@5': '0.0373', 'NDCG@5': '0.0251', 'HR@10': '0.0560', 'NDCG@10': '0.0311', 'HR@20': '0.0818', 'NDCG@20': '0.0376'}
2025-03-01 22:47:16,360 - Validation score increased.  Saving model ...
2025-03-01 22:47:44,124 - {'epoch': 2, 'rec_loss': '8.0145'}
2025-03-01 22:47:52,690 - {'Epoch': 2, 'HR@5': '0.0485', 'NDCG@5': '0.0333', 'HR@10': '0.0722', 'NDCG@10': '0.0410', 'HR@20': '0.1037', 'NDCG@20': '0.0489'}
2025-03-01 22:47:52,691 - Validation score increased.  Saving model ...
2025-03-01 22:48:23,620 - {'epoch': 3, 'rec_loss': '7.7983'}
2025-03-01 22:48:32,733 - {'Epoch': 3, 'HR@5': '0.0587', 'NDCG@5': '0.0400', 'HR@10': '0.0856', 'NDCG@10': '0.0487', 'HR@20': '0.1240', 'NDCG@20': '0.0583'}
2025-03-01 22:48:32,735 - Validation score increased.  Saving model ...
2025-03-01 22:49:04,578 - {'epoch': 4, 'rec_loss': '7.6347'}
2025-03-01 22:49:12,298 - {'Epoch': 4, 'HR@5': '0.0676', 'NDCG@5': '0.0469', 'HR@10': '0.0956', 'NDCG@10': '0.0560', 'HR@20': '0.1326', 'NDCG@20': '0.0653'}
2025-03-01 22:49:12,299 - Validation score increased.  Saving model ...
2025-03-01 22:49:40,518 - {'epoch': 5, 'rec_loss': '7.5191'}
2025-03-01 22:49:48,209 - {'Epoch': 5, 'HR@5': '0.0728', 'NDCG@5': '0.0509', 'HR@10': '0.1026', 'NDCG@10': '0.0605', 'HR@20': '0.1388', 'NDCG@20': '0.0696'}
2025-03-01 22:49:48,210 - Validation score increased.  Saving model ...
2025-03-01 22:50:20,610 - {'epoch': 6, 'rec_loss': '7.4215'}
2025-03-01 22:50:30,115 - {'Epoch': 6, 'HR@5': '0.0756', 'NDCG@5': '0.0533', 'HR@10': '0.1052', 'NDCG@10': '0.0628', 'HR@20': '0.1455', 'NDCG@20': '0.0729'}
2025-03-01 22:50:30,117 - Validation score increased.  Saving model ...
2025-03-01 22:51:00,029 - {'epoch': 7, 'rec_loss': '7.3414'}
2025-03-01 22:51:07,856 - {'Epoch': 7, 'HR@5': '0.0800', 'NDCG@5': '0.0562', 'HR@10': '0.1092', 'NDCG@10': '0.0656', 'HR@20': '0.1491', 'NDCG@20': '0.0757'}
2025-03-01 22:51:07,858 - Validation score increased.  Saving model ...
2025-03-01 22:51:36,906 - {'epoch': 8, 'rec_loss': '7.2714'}
2025-03-01 22:51:46,210 - {'Epoch': 8, 'HR@5': '0.0824', 'NDCG@5': '0.0581', 'HR@10': '0.1105', 'NDCG@10': '0.0671', 'HR@20': '0.1504', 'NDCG@20': '0.0772'}
2025-03-01 22:51:46,212 - Validation score increased.  Saving model ...
2025-03-01 22:52:16,350 - {'epoch': 9, 'rec_loss': '7.2229'}
2025-03-01 22:52:25,477 - {'Epoch': 9, 'HR@5': '0.0813', 'NDCG@5': '0.0570', 'HR@10': '0.1131', 'NDCG@10': '0.0673', 'HR@20': '0.1526', 'NDCG@20': '0.0772'}
2025-03-01 22:52:25,478 - Validation score increased.  Saving model ...
2025-03-01 22:52:53,498 - {'epoch': 10, 'rec_loss': '7.1748'}
2025-03-01 22:53:01,396 - {'Epoch': 10, 'HR@5': '0.0837', 'NDCG@5': '0.0590', 'HR@10': '0.1132', 'NDCG@10': '0.0685', 'HR@20': '0.1527', 'NDCG@20': '0.0784'}
2025-03-01 22:53:01,397 - Validation score increased.  Saving model ...
2025-03-01 22:53:32,098 - {'epoch': 11, 'rec_loss': '7.1364'}
2025-03-01 22:53:41,444 - {'Epoch': 11, 'HR@5': '0.0842', 'NDCG@5': '0.0598', 'HR@10': '0.1145', 'NDCG@10': '0.0696', 'HR@20': '0.1536', 'NDCG@20': '0.0794'}
2025-03-01 22:53:41,445 - Validation score increased.  Saving model ...
2025-03-01 22:54:12,719 - {'epoch': 12, 'rec_loss': '7.0996'}
2025-03-01 22:54:20,652 - {'Epoch': 12, 'HR@5': '0.0844', 'NDCG@5': '0.0598', 'HR@10': '0.1164', 'NDCG@10': '0.0700', 'HR@20': '0.1563', 'NDCG@20': '0.0801'}
2025-03-01 22:54:20,653 - Validation score increased.  Saving model ...
2025-03-01 22:54:48,486 - {'epoch': 13, 'rec_loss': '7.0738'}
2025-03-01 22:54:56,892 - {'Epoch': 13, 'HR@5': '0.0851', 'NDCG@5': '0.0595', 'HR@10': '0.1181', 'NDCG@10': '0.0702', 'HR@20': '0.1582', 'NDCG@20': '0.0803'}
2025-03-01 22:54:56,893 - Validation score increased.  Saving model ...
2025-03-01 22:55:29,498 - {'epoch': 14, 'rec_loss': '7.0434'}
2025-03-01 22:55:38,623 - {'Epoch': 14, 'HR@5': '0.0870', 'NDCG@5': '0.0608', 'HR@10': '0.1181', 'NDCG@10': '0.0708', 'HR@20': '0.1598', 'NDCG@20': '0.0813'}
2025-03-01 22:55:38,625 - Validation score increased.  Saving model ...
2025-03-01 22:56:10,003 - {'epoch': 15, 'rec_loss': '7.0238'}
2025-03-01 22:56:18,059 - {'Epoch': 15, 'HR@5': '0.0865', 'NDCG@5': '0.0607', 'HR@10': '0.1180', 'NDCG@10': '0.0708', 'HR@20': '0.1610', 'NDCG@20': '0.0817'}
2025-03-01 22:56:18,061 - Validation score increased.  Saving model ...
2025-03-01 22:56:44,922 - {'epoch': 16, 'rec_loss': '7.0015'}
2025-03-01 22:56:55,317 - {'Epoch': 16, 'HR@5': '0.0859', 'NDCG@5': '0.0603', 'HR@10': '0.1183', 'NDCG@10': '0.0708', 'HR@20': '0.1612', 'NDCG@20': '0.0816'}
2025-03-01 22:56:55,319 - EarlyStopping counter: 1 out of 10
2025-03-01 22:57:27,297 - {'epoch': 17, 'rec_loss': '6.9854'}
2025-03-01 22:57:36,696 - {'Epoch': 17, 'HR@5': '0.0848', 'NDCG@5': '0.0605', 'HR@10': '0.1181', 'NDCG@10': '0.0713', 'HR@20': '0.1611', 'NDCG@20': '0.0821'}
2025-03-01 22:57:36,698 - Validation score increased.  Saving model ...
2025-03-01 22:58:04,898 - {'epoch': 18, 'rec_loss': '6.9539'}
2025-03-01 22:58:12,945 - {'Epoch': 18, 'HR@5': '0.0867', 'NDCG@5': '0.0610', 'HR@10': '0.1187', 'NDCG@10': '0.0713', 'HR@20': '0.1609', 'NDCG@20': '0.0819'}
2025-03-01 22:58:12,947 - EarlyStopping counter: 1 out of 10
2025-03-01 22:58:42,940 - {'epoch': 19, 'rec_loss': '6.9429'}
2025-03-01 22:58:52,456 - {'Epoch': 19, 'HR@5': '0.0869', 'NDCG@5': '0.0618', 'HR@10': '0.1181', 'NDCG@10': '0.0718', 'HR@20': '0.1630', 'NDCG@20': '0.0830'}
2025-03-01 22:58:52,458 - Validation score increased.  Saving model ...
2025-03-01 22:59:25,552 - {'epoch': 20, 'rec_loss': '6.9224'}
2025-03-01 22:59:34,545 - {'Epoch': 20, 'HR@5': '0.0864', 'NDCG@5': '0.0615', 'HR@10': '0.1202', 'NDCG@10': '0.0724', 'HR@20': '0.1642', 'NDCG@20': '0.0834'}
2025-03-01 22:59:34,547 - Validation score increased.  Saving model ...
2025-03-01 23:00:01,905 - {'epoch': 21, 'rec_loss': '6.9139'}
2025-03-01 23:00:10,887 - {'Epoch': 21, 'HR@5': '0.0880', 'NDCG@5': '0.0619', 'HR@10': '0.1207', 'NDCG@10': '0.0724', 'HR@20': '0.1626', 'NDCG@20': '0.0829'}
2025-03-01 23:00:10,888 - EarlyStopping counter: 1 out of 10
2025-03-01 23:00:40,546 - {'epoch': 22, 'rec_loss': '6.9030'}
2025-03-01 23:00:49,367 - {'Epoch': 22, 'HR@5': '0.0878', 'NDCG@5': '0.0622', 'HR@10': '0.1209', 'NDCG@10': '0.0729', 'HR@20': '0.1634', 'NDCG@20': '0.0836'}
2025-03-01 23:00:49,368 - Validation score increased.  Saving model ...
2025-03-01 23:01:17,514 - {'epoch': 23, 'rec_loss': '6.8864'}
2025-03-01 23:01:25,123 - {'Epoch': 23, 'HR@5': '0.0877', 'NDCG@5': '0.0624', 'HR@10': '0.1212', 'NDCG@10': '0.0732', 'HR@20': '0.1631', 'NDCG@20': '0.0837'}
2025-03-01 23:01:25,124 - Validation score increased.  Saving model ...
2025-03-01 23:01:51,121 - {'epoch': 24, 'rec_loss': '6.8791'}
2025-03-01 23:01:59,051 - {'Epoch': 24, 'HR@5': '0.0872', 'NDCG@5': '0.0616', 'HR@10': '0.1208', 'NDCG@10': '0.0724', 'HR@20': '0.1625', 'NDCG@20': '0.0829'}
2025-03-01 23:01:59,053 - EarlyStopping counter: 1 out of 10
2025-03-01 23:02:28,626 - {'epoch': 25, 'rec_loss': '6.8591'}
2025-03-01 23:02:37,990 - {'Epoch': 25, 'HR@5': '0.0875', 'NDCG@5': '0.0615', 'HR@10': '0.1208', 'NDCG@10': '0.0722', 'HR@20': '0.1638', 'NDCG@20': '0.0831'}
2025-03-01 23:02:37,991 - EarlyStopping counter: 2 out of 10
2025-03-01 23:03:05,638 - {'epoch': 26, 'rec_loss': '6.8548'}
2025-03-01 23:03:13,310 - {'Epoch': 26, 'HR@5': '0.0889', 'NDCG@5': '0.0626', 'HR@10': '0.1217', 'NDCG@10': '0.0731', 'HR@20': '0.1642', 'NDCG@20': '0.0837'}
2025-03-01 23:03:13,311 - Validation score increased.  Saving model ...
2025-03-01 23:03:40,010 - {'epoch': 27, 'rec_loss': '6.8388'}
2025-03-01 23:03:48,793 - {'Epoch': 27, 'HR@5': '0.0873', 'NDCG@5': '0.0621', 'HR@10': '0.1200', 'NDCG@10': '0.0726', 'HR@20': '0.1630', 'NDCG@20': '0.0834'}
2025-03-01 23:03:48,794 - EarlyStopping counter: 1 out of 10
2025-03-01 23:04:19,939 - {'epoch': 28, 'rec_loss': '6.8346'}
2025-03-01 23:04:28,890 - {'Epoch': 28, 'HR@5': '0.0882', 'NDCG@5': '0.0622', 'HR@10': '0.1216', 'NDCG@10': '0.0729', 'HR@20': '0.1626', 'NDCG@20': '0.0832'}
2025-03-01 23:04:28,892 - EarlyStopping counter: 2 out of 10
2025-03-01 23:04:57,022 - {'epoch': 29, 'rec_loss': '6.8262'}
2025-03-01 23:05:05,946 - {'Epoch': 29, 'HR@5': '0.0873', 'NDCG@5': '0.0613', 'HR@10': '0.1208', 'NDCG@10': '0.0721', 'HR@20': '0.1628', 'NDCG@20': '0.0826'}
2025-03-01 23:05:05,947 - EarlyStopping counter: 3 out of 10
2025-03-01 23:05:31,409 - {'epoch': 30, 'rec_loss': '6.8160'}
2025-03-01 23:05:39,928 - {'Epoch': 30, 'HR@5': '0.0881', 'NDCG@5': '0.0622', 'HR@10': '0.1207', 'NDCG@10': '0.0726', 'HR@20': '0.1649', 'NDCG@20': '0.0838'}
2025-03-01 23:05:39,930 - Validation score increased.  Saving model ...
2025-03-01 23:06:09,312 - {'epoch': 31, 'rec_loss': '6.8017'}
2025-03-01 23:06:18,692 - {'Epoch': 31, 'HR@5': '0.0882', 'NDCG@5': '0.0628', 'HR@10': '0.1210', 'NDCG@10': '0.0733', 'HR@20': '0.1638', 'NDCG@20': '0.0841'}
2025-03-01 23:06:18,694 - Validation score increased.  Saving model ...
2025-03-01 23:06:46,925 - {'epoch': 32, 'rec_loss': '6.7986'}
2025-03-01 23:06:55,707 - {'Epoch': 32, 'HR@5': '0.0891', 'NDCG@5': '0.0633', 'HR@10': '0.1216', 'NDCG@10': '0.0737', 'HR@20': '0.1638', 'NDCG@20': '0.0843'}
2025-03-01 23:06:55,708 - Validation score increased.  Saving model ...
2025-03-01 23:07:22,122 - {'epoch': 33, 'rec_loss': '6.7951'}
2025-03-01 23:07:31,193 - {'Epoch': 33, 'HR@5': '0.0884', 'NDCG@5': '0.0627', 'HR@10': '0.1195', 'NDCG@10': '0.0726', 'HR@20': '0.1628', 'NDCG@20': '0.0835'}
2025-03-01 23:07:31,195 - EarlyStopping counter: 1 out of 10
2025-03-01 23:08:01,995 - {'epoch': 34, 'rec_loss': '6.7792'}
2025-03-01 23:08:11,311 - {'Epoch': 34, 'HR@5': '0.0889', 'NDCG@5': '0.0625', 'HR@10': '0.1202', 'NDCG@10': '0.0726', 'HR@20': '0.1625', 'NDCG@20': '0.0832'}
2025-03-01 23:08:11,313 - EarlyStopping counter: 2 out of 10
2025-03-01 23:08:39,092 - {'epoch': 35, 'rec_loss': '6.7751'}
2025-03-01 23:08:47,595 - {'Epoch': 35, 'HR@5': '0.0877', 'NDCG@5': '0.0614', 'HR@10': '0.1192', 'NDCG@10': '0.0715', 'HR@20': '0.1641', 'NDCG@20': '0.0828'}
2025-03-01 23:08:47,597 - EarlyStopping counter: 3 out of 10
2025-03-01 23:09:15,826 - {'epoch': 36, 'rec_loss': '6.7667'}
2025-03-01 23:09:25,205 - {'Epoch': 36, 'HR@5': '0.0877', 'NDCG@5': '0.0626', 'HR@10': '0.1219', 'NDCG@10': '0.0736', 'HR@20': '0.1635', 'NDCG@20': '0.0840'}
2025-03-01 23:09:25,206 - EarlyStopping counter: 4 out of 10
2025-03-01 23:09:55,090 - {'epoch': 37, 'rec_loss': '6.7525'}
2025-03-01 23:10:03,888 - {'Epoch': 37, 'HR@5': '0.0871', 'NDCG@5': '0.0615', 'HR@10': '0.1202', 'NDCG@10': '0.0722', 'HR@20': '0.1662', 'NDCG@20': '0.0837'}
2025-03-01 23:10:03,889 - EarlyStopping counter: 5 out of 10
2025-03-01 23:10:31,453 - {'epoch': 38, 'rec_loss': '6.7532'}
2025-03-01 23:10:39,609 - {'Epoch': 38, 'HR@5': '0.0865', 'NDCG@5': '0.0616', 'HR@10': '0.1209', 'NDCG@10': '0.0726', 'HR@20': '0.1642', 'NDCG@20': '0.0835'}
2025-03-01 23:10:39,611 - EarlyStopping counter: 6 out of 10
2025-03-01 23:11:07,152 - {'epoch': 39, 'rec_loss': '6.7464'}
2025-03-01 23:11:16,698 - {'Epoch': 39, 'HR@5': '0.0853', 'NDCG@5': '0.0606', 'HR@10': '0.1181', 'NDCG@10': '0.0712', 'HR@20': '0.1617', 'NDCG@20': '0.0821'}
2025-03-01 23:11:16,699 - EarlyStopping counter: 7 out of 10
2025-03-01 23:11:44,919 - {'epoch': 40, 'rec_loss': '6.7472'}
2025-03-01 23:11:53,335 - {'Epoch': 40, 'HR@5': '0.0871', 'NDCG@5': '0.0620', 'HR@10': '0.1194', 'NDCG@10': '0.0724', 'HR@20': '0.1649', 'NDCG@20': '0.0838'}
2025-03-01 23:11:53,337 - EarlyStopping counter: 8 out of 10
2025-03-01 23:12:19,107 - {'epoch': 41, 'rec_loss': '6.7348'}
2025-03-01 23:12:26,814 - {'Epoch': 41, 'HR@5': '0.0879', 'NDCG@5': '0.0624', 'HR@10': '0.1207', 'NDCG@10': '0.0730', 'HR@20': '0.1643', 'NDCG@20': '0.0840'}
2025-03-01 23:12:26,815 - EarlyStopping counter: 9 out of 10
2025-03-01 23:12:55,128 - {'epoch': 42, 'rec_loss': '6.7314'}
2025-03-01 23:13:04,105 - {'Epoch': 42, 'HR@5': '0.0889', 'NDCG@5': '0.0631', 'HR@10': '0.1205', 'NDCG@10': '0.0732', 'HR@20': '0.1640', 'NDCG@20': '0.0842'}
2025-03-01 23:13:04,106 - EarlyStopping counter: 10 out of 10
2025-03-01 23:13:04,106 - Early stopping
2025-03-01 23:13:04,106 - ---------------Test Score---------------
2025-03-01 23:13:13,261 - {'Epoch': 0, 'HR@5': '0.0728', 'NDCG@5': '0.0510', 'HR@10': '0.1001', 'NDCG@10': '0.0597', 'HR@20': '0.1362', 'NDCG@20': '0.0688'}
2025-03-01 23:13:13,263 - Scale_Beauty
2025-03-01 23:13:13,263 - {'Epoch': 0, 'HR@5': '0.0728', 'NDCG@5': '0.0510', 'HR@10': '0.1001', 'NDCG@10': '0.0597', 'HR@20': '0.1362', 'NDCG@20': '0.0688'}
2025-03-01 23:32:51,728 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 12, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-01 23:33:00,850 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-01 23:33:00,857 - Total Parameters: 929445
2025-03-01 23:33:32,228 - {'epoch': 0, 'rec_loss': '8.8352'}
2025-03-01 23:33:41,621 - {'Epoch': 0, 'HR@5': '0.0206', 'NDCG@5': '0.0128', 'HR@10': '0.0310', 'NDCG@10': '0.0162', 'HR@20': '0.0476', 'NDCG@20': '0.0204'}
2025-03-01 23:33:41,622 - Validation score increased.  Saving model ...
2025-03-01 23:34:13,668 - {'epoch': 1, 'rec_loss': '8.3271'}
2025-03-01 23:34:22,450 - {'Epoch': 1, 'HR@5': '0.0373', 'NDCG@5': '0.0251', 'HR@10': '0.0564', 'NDCG@10': '0.0313', 'HR@20': '0.0818', 'NDCG@20': '0.0377'}
2025-03-01 23:34:22,451 - Validation score increased.  Saving model ...
2025-03-01 23:34:48,529 - {'epoch': 2, 'rec_loss': '8.0157'}
2025-03-01 23:34:57,428 - {'Epoch': 2, 'HR@5': '0.0490', 'NDCG@5': '0.0332', 'HR@10': '0.0724', 'NDCG@10': '0.0408', 'HR@20': '0.1046', 'NDCG@20': '0.0488'}
2025-03-01 23:34:57,430 - Validation score increased.  Saving model ...
2025-03-01 23:35:26,440 - {'epoch': 3, 'rec_loss': '7.7993'}
2025-03-01 23:35:35,178 - {'Epoch': 3, 'HR@5': '0.0595', 'NDCG@5': '0.0406', 'HR@10': '0.0854', 'NDCG@10': '0.0489', 'HR@20': '0.1236', 'NDCG@20': '0.0585'}
2025-03-01 23:35:35,180 - Validation score increased.  Saving model ...
2025-03-01 23:36:05,382 - {'epoch': 4, 'rec_loss': '7.6361'}
2025-03-01 23:36:13,006 - {'Epoch': 4, 'HR@5': '0.0683', 'NDCG@5': '0.0474', 'HR@10': '0.0952', 'NDCG@10': '0.0560', 'HR@20': '0.1328', 'NDCG@20': '0.0655'}
2025-03-01 23:36:13,007 - Validation score increased.  Saving model ...
2025-03-01 23:36:38,980 - {'epoch': 5, 'rec_loss': '7.5208'}
2025-03-01 23:36:47,627 - {'Epoch': 5, 'HR@5': '0.0728', 'NDCG@5': '0.0508', 'HR@10': '0.1027', 'NDCG@10': '0.0604', 'HR@20': '0.1403', 'NDCG@20': '0.0698'}
2025-03-01 23:36:47,628 - Validation score increased.  Saving model ...
2025-03-01 23:37:19,076 - {'epoch': 6, 'rec_loss': '7.4234'}
2025-03-01 23:37:28,187 - {'Epoch': 6, 'HR@5': '0.0762', 'NDCG@5': '0.0535', 'HR@10': '0.1052', 'NDCG@10': '0.0628', 'HR@20': '0.1444', 'NDCG@20': '0.0727'}
2025-03-01 23:37:28,188 - Validation score increased.  Saving model ...
2025-03-01 23:37:59,284 - {'epoch': 7, 'rec_loss': '7.3443'}
2025-03-01 23:38:07,483 - {'Epoch': 7, 'HR@5': '0.0802', 'NDCG@5': '0.0563', 'HR@10': '0.1084', 'NDCG@10': '0.0654', 'HR@20': '0.1485', 'NDCG@20': '0.0755'}
2025-03-01 23:38:07,485 - Validation score increased.  Saving model ...
2025-03-01 23:38:36,664 - {'epoch': 8, 'rec_loss': '7.2733'}
2025-03-01 23:38:46,578 - {'Epoch': 8, 'HR@5': '0.0822', 'NDCG@5': '0.0579', 'HR@10': '0.1108', 'NDCG@10': '0.0671', 'HR@20': '0.1507', 'NDCG@20': '0.0771'}
2025-03-01 23:38:46,580 - Validation score increased.  Saving model ...
2025-03-01 23:39:19,171 - {'epoch': 9, 'rec_loss': '7.2247'}
2025-03-01 23:39:28,020 - {'Epoch': 9, 'HR@5': '0.0813', 'NDCG@5': '0.0570', 'HR@10': '0.1131', 'NDCG@10': '0.0673', 'HR@20': '0.1523', 'NDCG@20': '0.0771'}
2025-03-01 23:39:28,021 - Validation score increased.  Saving model ...
2025-03-01 23:39:59,070 - {'epoch': 10, 'rec_loss': '7.1773'}
2025-03-01 23:40:07,619 - {'Epoch': 10, 'HR@5': '0.0831', 'NDCG@5': '0.0589', 'HR@10': '0.1130', 'NDCG@10': '0.0686', 'HR@20': '0.1524', 'NDCG@20': '0.0785'}
2025-03-01 23:40:07,620 - Validation score increased.  Saving model ...
2025-03-01 23:40:38,251 - {'epoch': 11, 'rec_loss': '7.1378'}
2025-03-01 23:40:47,648 - {'Epoch': 11, 'HR@5': '0.0837', 'NDCG@5': '0.0597', 'HR@10': '0.1144', 'NDCG@10': '0.0696', 'HR@20': '0.1544', 'NDCG@20': '0.0796'}
2025-03-01 23:40:47,654 - Validation score increased.  Saving model ...
2025-03-01 23:41:19,020 - {'epoch': 12, 'rec_loss': '7.1008'}
2025-03-01 23:41:27,392 - {'Epoch': 12, 'HR@5': '0.0842', 'NDCG@5': '0.0596', 'HR@10': '0.1150', 'NDCG@10': '0.0695', 'HR@20': '0.1567', 'NDCG@20': '0.0800'}
2025-03-01 23:41:27,393 - Validation score increased.  Saving model ...
2025-03-01 23:41:55,235 - {'epoch': 13, 'rec_loss': '7.0747'}
2025-03-01 23:42:04,147 - {'Epoch': 13, 'HR@5': '0.0845', 'NDCG@5': '0.0596', 'HR@10': '0.1181', 'NDCG@10': '0.0704', 'HR@20': '0.1580', 'NDCG@20': '0.0805'}
2025-03-01 23:42:04,148 - Validation score increased.  Saving model ...
2025-03-01 23:42:32,296 - {'epoch': 14, 'rec_loss': '7.0435'}
2025-03-01 23:42:41,213 - {'Epoch': 14, 'HR@5': '0.0869', 'NDCG@5': '0.0606', 'HR@10': '0.1188', 'NDCG@10': '0.0708', 'HR@20': '0.1599', 'NDCG@20': '0.0812'}
2025-03-01 23:42:41,215 - Validation score increased.  Saving model ...
2025-03-01 23:43:13,787 - {'epoch': 15, 'rec_loss': '7.0237'}
2025-03-01 23:43:22,843 - {'Epoch': 15, 'HR@5': '0.0861', 'NDCG@5': '0.0603', 'HR@10': '0.1189', 'NDCG@10': '0.0709', 'HR@20': '0.1608', 'NDCG@20': '0.0814'}
2025-03-01 23:43:22,845 - Validation score increased.  Saving model ...
2025-03-01 23:43:49,606 - {'epoch': 16, 'rec_loss': '7.0008'}
2025-03-01 23:43:57,610 - {'Epoch': 16, 'HR@5': '0.0868', 'NDCG@5': '0.0606', 'HR@10': '0.1190', 'NDCG@10': '0.0710', 'HR@20': '0.1616', 'NDCG@20': '0.0817'}
2025-03-01 23:43:57,611 - Validation score increased.  Saving model ...
2025-03-01 23:44:27,931 - {'epoch': 17, 'rec_loss': '6.9854'}
2025-03-01 23:44:37,557 - {'Epoch': 17, 'HR@5': '0.0843', 'NDCG@5': '0.0606', 'HR@10': '0.1197', 'NDCG@10': '0.0720', 'HR@20': '0.1623', 'NDCG@20': '0.0827'}
2025-03-01 23:44:37,559 - Validation score increased.  Saving model ...
2025-03-01 23:45:06,579 - {'epoch': 18, 'rec_loss': '6.9526'}
2025-03-01 23:45:14,803 - {'Epoch': 18, 'HR@5': '0.0868', 'NDCG@5': '0.0609', 'HR@10': '0.1188', 'NDCG@10': '0.0712', 'HR@20': '0.1615', 'NDCG@20': '0.0819'}
2025-03-01 23:45:14,804 - EarlyStopping counter: 1 out of 10
2025-03-01 23:45:42,931 - {'epoch': 19, 'rec_loss': '6.9428'}
2025-03-01 23:45:52,477 - {'Epoch': 19, 'HR@5': '0.0863', 'NDCG@5': '0.0615', 'HR@10': '0.1182', 'NDCG@10': '0.0718', 'HR@20': '0.1618', 'NDCG@20': '0.0827'}
2025-03-01 23:45:52,479 - Validation score increased.  Saving model ...
2025-03-01 23:46:23,623 - {'epoch': 20, 'rec_loss': '6.9225'}
2025-03-01 23:46:32,746 - {'Epoch': 20, 'HR@5': '0.0867', 'NDCG@5': '0.0617', 'HR@10': '0.1209', 'NDCG@10': '0.0728', 'HR@20': '0.1631', 'NDCG@20': '0.0834'}
2025-03-01 23:46:32,748 - Validation score increased.  Saving model ...
2025-03-01 23:47:01,823 - {'epoch': 21, 'rec_loss': '6.9136'}
2025-03-01 23:47:11,124 - {'Epoch': 21, 'HR@5': '0.0869', 'NDCG@5': '0.0615', 'HR@10': '0.1206', 'NDCG@10': '0.0723', 'HR@20': '0.1624', 'NDCG@20': '0.0829'}
2025-03-01 23:47:11,131 - EarlyStopping counter: 1 out of 10
2025-03-01 23:47:41,550 - {'epoch': 22, 'rec_loss': '6.9031'}
2025-03-01 23:47:50,691 - {'Epoch': 22, 'HR@5': '0.0874', 'NDCG@5': '0.0618', 'HR@10': '0.1211', 'NDCG@10': '0.0727', 'HR@20': '0.1634', 'NDCG@20': '0.0834'}
2025-03-01 23:47:50,692 - EarlyStopping counter: 2 out of 10
2025-03-01 23:48:22,415 - {'epoch': 23, 'rec_loss': '6.8856'}
2025-03-01 23:48:30,911 - {'Epoch': 23, 'HR@5': '0.0877', 'NDCG@5': '0.0625', 'HR@10': '0.1206', 'NDCG@10': '0.0730', 'HR@20': '0.1629', 'NDCG@20': '0.0837'}
2025-03-01 23:48:30,912 - Validation score increased.  Saving model ...
2025-03-01 23:48:58,904 - {'epoch': 24, 'rec_loss': '6.8784'}
2025-03-01 23:49:07,215 - {'Epoch': 24, 'HR@5': '0.0881', 'NDCG@5': '0.0620', 'HR@10': '0.1203', 'NDCG@10': '0.0723', 'HR@20': '0.1619', 'NDCG@20': '0.0828'}
2025-03-01 23:49:07,216 - EarlyStopping counter: 1 out of 10
2025-03-01 23:49:39,454 - {'epoch': 25, 'rec_loss': '6.8585'}
2025-03-01 23:49:49,497 - {'Epoch': 25, 'HR@5': '0.0875', 'NDCG@5': '0.0615', 'HR@10': '0.1218', 'NDCG@10': '0.0726', 'HR@20': '0.1634', 'NDCG@20': '0.0830'}
2025-03-01 23:49:49,499 - EarlyStopping counter: 2 out of 10
2025-03-01 23:50:18,942 - {'epoch': 26, 'rec_loss': '6.8540'}
2025-03-01 23:50:27,123 - {'Epoch': 26, 'HR@5': '0.0880', 'NDCG@5': '0.0621', 'HR@10': '0.1215', 'NDCG@10': '0.0728', 'HR@20': '0.1634', 'NDCG@20': '0.0834'}
2025-03-01 23:50:27,124 - EarlyStopping counter: 3 out of 10
2025-03-01 23:50:53,522 - {'epoch': 27, 'rec_loss': '6.8386'}
2025-03-01 23:51:02,404 - {'Epoch': 27, 'HR@5': '0.0872', 'NDCG@5': '0.0620', 'HR@10': '0.1204', 'NDCG@10': '0.0727', 'HR@20': '0.1624', 'NDCG@20': '0.0833'}
2025-03-01 23:51:02,405 - EarlyStopping counter: 4 out of 10
2025-03-01 23:51:34,007 - {'epoch': 28, 'rec_loss': '6.8342'}
2025-03-01 23:51:43,405 - {'Epoch': 28, 'HR@5': '0.0881', 'NDCG@5': '0.0620', 'HR@10': '0.1212', 'NDCG@10': '0.0727', 'HR@20': '0.1626', 'NDCG@20': '0.0831'}
2025-03-01 23:51:43,406 - EarlyStopping counter: 5 out of 10
2025-03-01 23:52:10,208 - {'epoch': 29, 'rec_loss': '6.8259'}
2025-03-01 23:52:18,968 - {'Epoch': 29, 'HR@5': '0.0868', 'NDCG@5': '0.0609', 'HR@10': '0.1213', 'NDCG@10': '0.0719', 'HR@20': '0.1638', 'NDCG@20': '0.0826'}
2025-03-01 23:52:18,969 - EarlyStopping counter: 6 out of 10
2025-03-01 23:52:44,957 - {'epoch': 30, 'rec_loss': '6.8152'}
2025-03-01 23:52:54,540 - {'Epoch': 30, 'HR@5': '0.0876', 'NDCG@5': '0.0618', 'HR@10': '0.1205', 'NDCG@10': '0.0724', 'HR@20': '0.1642', 'NDCG@20': '0.0834'}
2025-03-01 23:52:54,541 - EarlyStopping counter: 7 out of 10
2025-03-01 23:53:25,126 - {'epoch': 31, 'rec_loss': '6.8011'}
2025-03-01 23:53:33,881 - {'Epoch': 31, 'HR@5': '0.0885', 'NDCG@5': '0.0627', 'HR@10': '0.1206', 'NDCG@10': '0.0730', 'HR@20': '0.1647', 'NDCG@20': '0.0841'}
2025-03-01 23:53:33,882 - Validation score increased.  Saving model ...
2025-03-01 23:53:59,039 - {'epoch': 32, 'rec_loss': '6.7973'}
2025-03-01 23:54:07,120 - {'Epoch': 32, 'HR@5': '0.0889', 'NDCG@5': '0.0630', 'HR@10': '0.1222', 'NDCG@10': '0.0736', 'HR@20': '0.1638', 'NDCG@20': '0.0841'}
2025-03-01 23:54:07,121 - EarlyStopping counter: 1 out of 10
2025-03-01 23:54:34,913 - {'epoch': 33, 'rec_loss': '6.7952'}
2025-03-01 23:54:44,029 - {'Epoch': 33, 'HR@5': '0.0884', 'NDCG@5': '0.0629', 'HR@10': '0.1193', 'NDCG@10': '0.0729', 'HR@20': '0.1626', 'NDCG@20': '0.0838'}
2025-03-01 23:54:44,030 - EarlyStopping counter: 2 out of 10
2025-03-01 23:55:14,306 - {'epoch': 34, 'rec_loss': '6.7779'}
2025-03-01 23:55:22,781 - {'Epoch': 34, 'HR@5': '0.0884', 'NDCG@5': '0.0625', 'HR@10': '0.1202', 'NDCG@10': '0.0727', 'HR@20': '0.1624', 'NDCG@20': '0.0833'}
2025-03-01 23:55:22,782 - EarlyStopping counter: 3 out of 10
2025-03-01 23:55:50,335 - {'epoch': 35, 'rec_loss': '6.7744'}
2025-03-01 23:55:58,495 - {'Epoch': 35, 'HR@5': '0.0868', 'NDCG@5': '0.0613', 'HR@10': '0.1186', 'NDCG@10': '0.0715', 'HR@20': '0.1643', 'NDCG@20': '0.0830'}
2025-03-01 23:55:58,497 - EarlyStopping counter: 4 out of 10
2025-03-01 23:56:27,447 - {'epoch': 36, 'rec_loss': '6.7662'}
2025-03-01 23:56:36,616 - {'Epoch': 36, 'HR@5': '0.0872', 'NDCG@5': '0.0623', 'HR@10': '0.1215', 'NDCG@10': '0.0733', 'HR@20': '0.1634', 'NDCG@20': '0.0839'}
2025-03-01 23:56:36,617 - EarlyStopping counter: 5 out of 10
2025-03-01 23:57:05,222 - {'epoch': 37, 'rec_loss': '6.7500'}
2025-03-01 23:57:13,190 - {'Epoch': 37, 'HR@5': '0.0865', 'NDCG@5': '0.0614', 'HR@10': '0.1212', 'NDCG@10': '0.0726', 'HR@20': '0.1651', 'NDCG@20': '0.0836'}
2025-03-01 23:57:13,191 - EarlyStopping counter: 6 out of 10
2025-03-01 23:57:39,320 - {'epoch': 38, 'rec_loss': '6.7522'}
2025-03-01 23:57:48,309 - {'Epoch': 38, 'HR@5': '0.0870', 'NDCG@5': '0.0616', 'HR@10': '0.1211', 'NDCG@10': '0.0727', 'HR@20': '0.1641', 'NDCG@20': '0.0835'}
2025-03-01 23:57:48,310 - EarlyStopping counter: 7 out of 10
2025-03-01 23:58:16,155 - {'epoch': 39, 'rec_loss': '6.7450'}
2025-03-01 23:58:25,628 - {'Epoch': 39, 'HR@5': '0.0851', 'NDCG@5': '0.0603', 'HR@10': '0.1190', 'NDCG@10': '0.0713', 'HR@20': '0.1618', 'NDCG@20': '0.0820'}
2025-03-01 23:58:25,630 - EarlyStopping counter: 8 out of 10
2025-03-01 23:58:54,585 - {'epoch': 40, 'rec_loss': '6.7462'}
2025-03-01 23:59:02,568 - {'Epoch': 40, 'HR@5': '0.0863', 'NDCG@5': '0.0614', 'HR@10': '0.1208', 'NDCG@10': '0.0726', 'HR@20': '0.1644', 'NDCG@20': '0.0835'}
2025-03-01 23:59:02,570 - EarlyStopping counter: 9 out of 10
2025-03-01 23:59:29,255 - {'epoch': 41, 'rec_loss': '6.7342'}
2025-03-01 23:59:38,483 - {'Epoch': 41, 'HR@5': '0.0879', 'NDCG@5': '0.0625', 'HR@10': '0.1204', 'NDCG@10': '0.0730', 'HR@20': '0.1642', 'NDCG@20': '0.0840'}
2025-03-01 23:59:38,484 - EarlyStopping counter: 10 out of 10
2025-03-01 23:59:38,485 - Early stopping
2025-03-01 23:59:38,485 - ---------------Test Score---------------
2025-03-01 23:59:47,519 - {'Epoch': 0, 'HR@5': '0.0736', 'NDCG@5': '0.0509', 'HR@10': '0.1003', 'NDCG@10': '0.0594', 'HR@20': '0.1375', 'NDCG@20': '0.0688'}
2025-03-01 23:59:47,521 - Scale_Beauty
2025-03-01 23:59:47,521 - {'Epoch': 0, 'HR@5': '0.0736', 'NDCG@5': '0.0509', 'HR@10': '0.1003', 'NDCG@10': '0.0594', 'HR@20': '0.1375', 'NDCG@20': '0.0688'}
2025-03-02 00:53:37,382 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[4, 12, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-02 00:53:40,242 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-02 00:53:40,246 - Total Parameters: 929445
2025-03-02 00:54:10,727 - {'epoch': 0, 'rec_loss': '8.8336'}
2025-03-02 00:54:19,851 - {'Epoch': 0, 'HR@5': '0.0195', 'NDCG@5': '0.0123', 'HR@10': '0.0308', 'NDCG@10': '0.0159', 'HR@20': '0.0474', 'NDCG@20': '0.0201'}
2025-03-02 00:54:19,853 - Validation score increased.  Saving model ...
2025-03-02 00:54:51,249 - {'epoch': 1, 'rec_loss': '8.3259'}
2025-03-02 00:54:59,460 - {'Epoch': 1, 'HR@5': '0.0376', 'NDCG@5': '0.0252', 'HR@10': '0.0559', 'NDCG@10': '0.0310', 'HR@20': '0.0821', 'NDCG@20': '0.0376'}
2025-03-02 00:54:59,466 - Validation score increased.  Saving model ...
2025-03-02 00:55:27,907 - {'epoch': 2, 'rec_loss': '8.0145'}
2025-03-02 00:55:36,756 - {'Epoch': 2, 'HR@5': '0.0485', 'NDCG@5': '0.0331', 'HR@10': '0.0725', 'NDCG@10': '0.0409', 'HR@20': '0.1037', 'NDCG@20': '0.0487'}
2025-03-02 00:55:36,758 - Validation score increased.  Saving model ...
2025-03-02 00:56:08,019 - {'epoch': 3, 'rec_loss': '7.7984'}
2025-03-02 00:56:16,975 - {'Epoch': 3, 'HR@5': '0.0591', 'NDCG@5': '0.0402', 'HR@10': '0.0855', 'NDCG@10': '0.0487', 'HR@20': '0.1239', 'NDCG@20': '0.0584'}
2025-03-02 00:56:16,976 - Validation score increased.  Saving model ...
2025-03-02 00:56:42,897 - {'epoch': 4, 'rec_loss': '7.6348'}
2025-03-02 00:56:50,703 - {'Epoch': 4, 'HR@5': '0.0677', 'NDCG@5': '0.0471', 'HR@10': '0.0955', 'NDCG@10': '0.0560', 'HR@20': '0.1325', 'NDCG@20': '0.0653'}
2025-03-02 00:56:50,705 - Validation score increased.  Saving model ...
2025-03-02 00:57:17,770 - {'epoch': 5, 'rec_loss': '7.5194'}
2025-03-02 00:57:25,388 - {'Epoch': 5, 'HR@5': '0.0727', 'NDCG@5': '0.0508', 'HR@10': '0.1026', 'NDCG@10': '0.0604', 'HR@20': '0.1386', 'NDCG@20': '0.0695'}
2025-03-02 00:57:25,394 - Validation score increased.  Saving model ...
2025-03-02 00:57:52,738 - {'epoch': 6, 'rec_loss': '7.4215'}
2025-03-02 00:58:00,574 - {'Epoch': 6, 'HR@5': '0.0757', 'NDCG@5': '0.0533', 'HR@10': '0.1054', 'NDCG@10': '0.0629', 'HR@20': '0.1456', 'NDCG@20': '0.0729'}
2025-03-02 00:58:00,575 - Validation score increased.  Saving model ...
2025-03-02 00:58:27,551 - {'epoch': 7, 'rec_loss': '7.3418'}
2025-03-02 00:58:35,443 - {'Epoch': 7, 'HR@5': '0.0796', 'NDCG@5': '0.0561', 'HR@10': '0.1089', 'NDCG@10': '0.0655', 'HR@20': '0.1487', 'NDCG@20': '0.0755'}
2025-03-02 00:58:35,449 - Validation score increased.  Saving model ...
2025-03-02 00:59:02,355 - {'epoch': 8, 'rec_loss': '7.2717'}
2025-03-02 00:59:10,276 - {'Epoch': 8, 'HR@5': '0.0825', 'NDCG@5': '0.0582', 'HR@10': '0.1102', 'NDCG@10': '0.0671', 'HR@20': '0.1506', 'NDCG@20': '0.0773'}
2025-03-02 00:59:10,282 - Validation score increased.  Saving model ...
2025-03-02 00:59:37,350 - {'epoch': 9, 'rec_loss': '7.2227'}
2025-03-02 00:59:44,918 - {'Epoch': 9, 'HR@5': '0.0806', 'NDCG@5': '0.0568', 'HR@10': '0.1134', 'NDCG@10': '0.0674', 'HR@20': '0.1521', 'NDCG@20': '0.0771'}
2025-03-02 00:59:44,919 - EarlyStopping counter: 1 out of 10
2025-03-02 01:00:12,145 - {'epoch': 10, 'rec_loss': '7.1751'}
2025-03-02 01:00:19,894 - {'Epoch': 10, 'HR@5': '0.0834', 'NDCG@5': '0.0590', 'HR@10': '0.1132', 'NDCG@10': '0.0686', 'HR@20': '0.1528', 'NDCG@20': '0.0785'}
2025-03-02 01:00:19,895 - Validation score increased.  Saving model ...
2025-03-02 01:00:46,767 - {'epoch': 11, 'rec_loss': '7.1365'}
2025-03-02 01:00:54,649 - {'Epoch': 11, 'HR@5': '0.0841', 'NDCG@5': '0.0596', 'HR@10': '0.1141', 'NDCG@10': '0.0693', 'HR@20': '0.1537', 'NDCG@20': '0.0793'}
2025-03-02 01:00:54,650 - Validation score increased.  Saving model ...
2025-03-02 01:01:22,505 - {'epoch': 12, 'rec_loss': '7.0996'}
2025-03-02 01:01:30,292 - {'Epoch': 12, 'HR@5': '0.0841', 'NDCG@5': '0.0596', 'HR@10': '0.1155', 'NDCG@10': '0.0697', 'HR@20': '0.1565', 'NDCG@20': '0.0800'}
2025-03-02 01:01:30,293 - Validation score increased.  Saving model ...
2025-03-02 01:01:59,100 - {'epoch': 13, 'rec_loss': '7.0738'}
2025-03-02 01:02:07,114 - {'Epoch': 13, 'HR@5': '0.0849', 'NDCG@5': '0.0595', 'HR@10': '0.1178', 'NDCG@10': '0.0701', 'HR@20': '0.1587', 'NDCG@20': '0.0804'}
2025-03-02 01:02:07,115 - Validation score increased.  Saving model ...
2025-03-02 01:02:34,519 - {'epoch': 14, 'rec_loss': '7.0433'}
2025-03-02 01:02:42,403 - {'Epoch': 14, 'HR@5': '0.0869', 'NDCG@5': '0.0606', 'HR@10': '0.1183', 'NDCG@10': '0.0708', 'HR@20': '0.1597', 'NDCG@20': '0.0812'}
2025-03-02 01:02:42,404 - Validation score increased.  Saving model ...
2025-03-02 01:03:09,472 - {'epoch': 15, 'rec_loss': '7.0240'}
2025-03-02 01:03:17,007 - {'Epoch': 15, 'HR@5': '0.0864', 'NDCG@5': '0.0606', 'HR@10': '0.1181', 'NDCG@10': '0.0708', 'HR@20': '0.1608', 'NDCG@20': '0.0816'}
2025-03-02 01:03:17,008 - Validation score increased.  Saving model ...
2025-03-02 01:03:44,757 - {'epoch': 16, 'rec_loss': '7.0017'}
2025-03-02 01:03:52,632 - {'Epoch': 16, 'HR@5': '0.0863', 'NDCG@5': '0.0604', 'HR@10': '0.1180', 'NDCG@10': '0.0706', 'HR@20': '0.1613', 'NDCG@20': '0.0815'}
2025-03-02 01:03:52,634 - EarlyStopping counter: 1 out of 10
2025-03-02 01:04:19,953 - {'epoch': 17, 'rec_loss': '6.9853'}
2025-03-02 01:04:27,758 - {'Epoch': 17, 'HR@5': '0.0852', 'NDCG@5': '0.0608', 'HR@10': '0.1184', 'NDCG@10': '0.0714', 'HR@20': '0.1609', 'NDCG@20': '0.0822'}
2025-03-02 01:04:27,759 - Validation score increased.  Saving model ...
2025-03-02 01:04:54,947 - {'epoch': 18, 'rec_loss': '6.9540'}
2025-03-02 01:05:02,628 - {'Epoch': 18, 'HR@5': '0.0866', 'NDCG@5': '0.0609', 'HR@10': '0.1184', 'NDCG@10': '0.0711', 'HR@20': '0.1602', 'NDCG@20': '0.0817'}
2025-03-02 01:05:02,629 - EarlyStopping counter: 1 out of 10
2025-03-02 01:05:29,390 - {'epoch': 19, 'rec_loss': '6.9428'}
2025-03-02 01:05:37,367 - {'Epoch': 19, 'HR@5': '0.0866', 'NDCG@5': '0.0617', 'HR@10': '0.1180', 'NDCG@10': '0.0717', 'HR@20': '0.1632', 'NDCG@20': '0.0831'}
2025-03-02 01:05:37,369 - Validation score increased.  Saving model ...
2025-03-02 01:06:03,978 - {'epoch': 20, 'rec_loss': '6.9223'}
2025-03-02 01:06:11,851 - {'Epoch': 20, 'HR@5': '0.0863', 'NDCG@5': '0.0613', 'HR@10': '0.1197', 'NDCG@10': '0.0721', 'HR@20': '0.1633', 'NDCG@20': '0.0831'}
2025-03-02 01:06:11,852 - Validation score increased.  Saving model ...
2025-03-02 01:06:38,518 - {'epoch': 21, 'rec_loss': '6.9139'}
2025-03-02 01:06:46,294 - {'Epoch': 21, 'HR@5': '0.0876', 'NDCG@5': '0.0618', 'HR@10': '0.1203', 'NDCG@10': '0.0723', 'HR@20': '0.1628', 'NDCG@20': '0.0830'}
2025-03-02 01:06:46,296 - EarlyStopping counter: 1 out of 10
2025-03-02 01:07:13,385 - {'epoch': 22, 'rec_loss': '6.9032'}
2025-03-02 01:07:21,402 - {'Epoch': 22, 'HR@5': '0.0878', 'NDCG@5': '0.0622', 'HR@10': '0.1214', 'NDCG@10': '0.0731', 'HR@20': '0.1627', 'NDCG@20': '0.0835'}
2025-03-02 01:07:21,409 - Validation score increased.  Saving model ...
2025-03-02 01:07:48,120 - {'epoch': 23, 'rec_loss': '6.8864'}
2025-03-02 01:07:55,958 - {'Epoch': 23, 'HR@5': '0.0881', 'NDCG@5': '0.0626', 'HR@10': '0.1210', 'NDCG@10': '0.0731', 'HR@20': '0.1636', 'NDCG@20': '0.0839'}
2025-03-02 01:07:55,959 - Validation score increased.  Saving model ...
2025-03-02 01:08:22,921 - {'epoch': 24, 'rec_loss': '6.8790'}
2025-03-02 01:08:30,798 - {'Epoch': 24, 'HR@5': '0.0880', 'NDCG@5': '0.0620', 'HR@10': '0.1210', 'NDCG@10': '0.0726', 'HR@20': '0.1621', 'NDCG@20': '0.0829'}
2025-03-02 01:08:30,799 - EarlyStopping counter: 1 out of 10
2025-03-02 01:08:57,764 - {'epoch': 25, 'rec_loss': '6.8591'}
2025-03-02 01:09:05,665 - {'Epoch': 25, 'HR@5': '0.0876', 'NDCG@5': '0.0615', 'HR@10': '0.1210', 'NDCG@10': '0.0723', 'HR@20': '0.1634', 'NDCG@20': '0.0830'}
2025-03-02 01:09:05,666 - EarlyStopping counter: 2 out of 10
2025-03-02 01:09:31,525 - {'epoch': 26, 'rec_loss': '6.8551'}
2025-03-02 01:09:39,507 - {'Epoch': 26, 'HR@5': '0.0889', 'NDCG@5': '0.0624', 'HR@10': '0.1217', 'NDCG@10': '0.0729', 'HR@20': '0.1639', 'NDCG@20': '0.0835'}
2025-03-02 01:09:39,508 - EarlyStopping counter: 3 out of 10
2025-03-02 01:10:07,060 - {'epoch': 27, 'rec_loss': '6.8388'}
2025-03-02 01:10:14,956 - {'Epoch': 27, 'HR@5': '0.0873', 'NDCG@5': '0.0622', 'HR@10': '0.1201', 'NDCG@10': '0.0727', 'HR@20': '0.1632', 'NDCG@20': '0.0835'}
2025-03-02 01:10:14,964 - EarlyStopping counter: 4 out of 10
2025-03-02 01:10:41,638 - {'epoch': 28, 'rec_loss': '6.8346'}
2025-03-02 01:10:49,412 - {'Epoch': 28, 'HR@5': '0.0881', 'NDCG@5': '0.0621', 'HR@10': '0.1218', 'NDCG@10': '0.0730', 'HR@20': '0.1629', 'NDCG@20': '0.0833'}
2025-03-02 01:10:49,413 - EarlyStopping counter: 5 out of 10
2025-03-02 01:11:16,381 - {'epoch': 29, 'rec_loss': '6.8265'}
2025-03-02 01:11:24,107 - {'Epoch': 29, 'HR@5': '0.0871', 'NDCG@5': '0.0612', 'HR@10': '0.1206', 'NDCG@10': '0.0719', 'HR@20': '0.1633', 'NDCG@20': '0.0827'}
2025-03-02 01:11:24,109 - EarlyStopping counter: 6 out of 10
2025-03-02 01:11:50,879 - {'epoch': 30, 'rec_loss': '6.8161'}
2025-03-02 01:11:58,802 - {'Epoch': 30, 'HR@5': '0.0881', 'NDCG@5': '0.0620', 'HR@10': '0.1202', 'NDCG@10': '0.0722', 'HR@20': '0.1647', 'NDCG@20': '0.0835'}
2025-03-02 01:11:58,804 - EarlyStopping counter: 7 out of 10
2025-03-02 01:12:25,880 - {'epoch': 31, 'rec_loss': '6.8018'}
2025-03-02 01:12:33,668 - {'Epoch': 31, 'HR@5': '0.0882', 'NDCG@5': '0.0626', 'HR@10': '0.1207', 'NDCG@10': '0.0730', 'HR@20': '0.1637', 'NDCG@20': '0.0839'}
2025-03-02 01:12:33,670 - Validation score increased.  Saving model ...
2025-03-02 01:13:01,421 - {'epoch': 32, 'rec_loss': '6.7985'}
2025-03-02 01:13:09,352 - {'Epoch': 32, 'HR@5': '0.0893', 'NDCG@5': '0.0632', 'HR@10': '0.1212', 'NDCG@10': '0.0735', 'HR@20': '0.1644', 'NDCG@20': '0.0844'}
2025-03-02 01:13:09,353 - Validation score increased.  Saving model ...
2025-03-02 01:13:36,142 - {'epoch': 33, 'rec_loss': '6.7951'}
2025-03-02 01:13:43,780 - {'Epoch': 33, 'HR@5': '0.0885', 'NDCG@5': '0.0627', 'HR@10': '0.1192', 'NDCG@10': '0.0726', 'HR@20': '0.1629', 'NDCG@20': '0.0836'}
2025-03-02 01:13:43,781 - EarlyStopping counter: 1 out of 10
2025-03-02 01:14:11,121 - {'epoch': 34, 'rec_loss': '6.7789'}
2025-03-02 01:14:18,874 - {'Epoch': 34, 'HR@5': '0.0888', 'NDCG@5': '0.0625', 'HR@10': '0.1193', 'NDCG@10': '0.0724', 'HR@20': '0.1617', 'NDCG@20': '0.0831'}
2025-03-02 01:14:18,875 - EarlyStopping counter: 2 out of 10
2025-03-02 01:14:46,012 - {'epoch': 35, 'rec_loss': '6.7749'}
2025-03-02 01:14:54,008 - {'Epoch': 35, 'HR@5': '0.0876', 'NDCG@5': '0.0614', 'HR@10': '0.1189', 'NDCG@10': '0.0714', 'HR@20': '0.1638', 'NDCG@20': '0.0827'}
2025-03-02 01:14:54,009 - EarlyStopping counter: 3 out of 10
2025-03-02 01:15:21,107 - {'epoch': 36, 'rec_loss': '6.7668'}
2025-03-02 01:15:29,130 - {'Epoch': 36, 'HR@5': '0.0876', 'NDCG@5': '0.0624', 'HR@10': '0.1210', 'NDCG@10': '0.0731', 'HR@20': '0.1632', 'NDCG@20': '0.0837'}
2025-03-02 01:15:29,131 - EarlyStopping counter: 4 out of 10
2025-03-02 01:15:56,300 - {'epoch': 37, 'rec_loss': '6.7522'}
2025-03-02 01:16:04,208 - {'Epoch': 37, 'HR@5': '0.0868', 'NDCG@5': '0.0613', 'HR@10': '0.1202', 'NDCG@10': '0.0720', 'HR@20': '0.1659', 'NDCG@20': '0.0835'}
2025-03-02 01:16:04,209 - EarlyStopping counter: 5 out of 10
2025-03-02 01:16:31,728 - {'epoch': 38, 'rec_loss': '6.7531'}
2025-03-02 01:16:39,861 - {'Epoch': 38, 'HR@5': '0.0866', 'NDCG@5': '0.0615', 'HR@10': '0.1205', 'NDCG@10': '0.0724', 'HR@20': '0.1641', 'NDCG@20': '0.0834'}
2025-03-02 01:16:39,862 - EarlyStopping counter: 6 out of 10
2025-03-02 01:17:07,464 - {'epoch': 39, 'rec_loss': '6.7461'}
2025-03-02 01:17:15,373 - {'Epoch': 39, 'HR@5': '0.0855', 'NDCG@5': '0.0606', 'HR@10': '0.1179', 'NDCG@10': '0.0711', 'HR@20': '0.1617', 'NDCG@20': '0.0821'}
2025-03-02 01:17:15,375 - EarlyStopping counter: 7 out of 10
2025-03-02 01:17:42,655 - {'epoch': 40, 'rec_loss': '6.7468'}
2025-03-02 01:17:50,515 - {'Epoch': 40, 'HR@5': '0.0870', 'NDCG@5': '0.0620', 'HR@10': '0.1194', 'NDCG@10': '0.0724', 'HR@20': '0.1643', 'NDCG@20': '0.0837'}
2025-03-02 01:17:50,516 - EarlyStopping counter: 8 out of 10
2025-03-02 01:18:18,059 - {'epoch': 41, 'rec_loss': '6.7350'}
2025-03-02 01:18:26,041 - {'Epoch': 41, 'HR@5': '0.0876', 'NDCG@5': '0.0623', 'HR@10': '0.1204', 'NDCG@10': '0.0729', 'HR@20': '0.1645', 'NDCG@20': '0.0840'}
2025-03-02 01:18:26,043 - EarlyStopping counter: 9 out of 10
2025-03-02 01:18:53,767 - {'epoch': 42, 'rec_loss': '6.7313'}
2025-03-02 01:19:01,693 - {'Epoch': 42, 'HR@5': '0.0889', 'NDCG@5': '0.0631', 'HR@10': '0.1202', 'NDCG@10': '0.0731', 'HR@20': '0.1637', 'NDCG@20': '0.0841'}
2025-03-02 01:19:01,694 - EarlyStopping counter: 10 out of 10
2025-03-02 01:19:01,694 - Early stopping
2025-03-02 01:19:01,694 - ---------------Test Score---------------
2025-03-02 01:19:09,681 - {'Epoch': 0, 'HR@5': '0.0729', 'NDCG@5': '0.0512', 'HR@10': '0.0995', 'NDCG@10': '0.0597', 'HR@20': '0.1365', 'NDCG@20': '0.0690'}
2025-03-02 01:19:09,683 - Scale_Beauty
2025-03-02 01:19:09,683 - {'Epoch': 0, 'HR@5': '0.0729', 'NDCG@5': '0.0512', 'HR@10': '0.0995', 'NDCG@10': '0.0597', 'HR@20': '0.1365', 'NDCG@20': '0.0690'}
2025-03-02 10:43:20,989 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25, 10, 5], kernels=[8, 12, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-02 10:43:23,855 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-02 10:43:23,864 - Total Parameters: 928145
2025-03-02 10:44:09,628 - {'epoch': 0, 'rec_loss': '8.8206'}
2025-03-02 10:44:19,374 - {'Epoch': 0, 'HR@5': '0.0258', 'NDCG@5': '0.0166', 'HR@10': '0.0398', 'NDCG@10': '0.0211', 'HR@20': '0.0585', 'NDCG@20': '0.0258'}
2025-03-02 10:44:19,376 - Validation score increased.  Saving model ...
2025-03-02 10:45:03,955 - {'epoch': 1, 'rec_loss': '8.1942'}
2025-03-02 10:45:12,500 - {'Epoch': 1, 'HR@5': '0.0456', 'NDCG@5': '0.0308', 'HR@10': '0.0661', 'NDCG@10': '0.0374', 'HR@20': '0.0956', 'NDCG@20': '0.0448'}
2025-03-02 10:45:12,502 - Validation score increased.  Saving model ...
2025-03-02 10:45:57,303 - {'epoch': 2, 'rec_loss': '7.8703'}
2025-03-02 10:46:06,070 - {'Epoch': 2, 'HR@5': '0.0607', 'NDCG@5': '0.0412', 'HR@10': '0.0869', 'NDCG@10': '0.0497', 'HR@20': '0.1199', 'NDCG@20': '0.0580'}
2025-03-02 10:46:06,072 - Validation score increased.  Saving model ...
2025-03-02 10:46:52,008 - {'epoch': 3, 'rec_loss': '7.6389'}
2025-03-02 10:47:00,771 - {'Epoch': 3, 'HR@5': '0.0698', 'NDCG@5': '0.0487', 'HR@10': '0.0969', 'NDCG@10': '0.0574', 'HR@20': '0.1325', 'NDCG@20': '0.0663'}
2025-03-02 10:47:00,772 - Validation score increased.  Saving model ...
2025-03-02 10:47:45,706 - {'epoch': 4, 'rec_loss': '7.4701'}
2025-03-02 10:47:54,402 - {'Epoch': 4, 'HR@5': '0.0745', 'NDCG@5': '0.0522', 'HR@10': '0.1042', 'NDCG@10': '0.0618', 'HR@20': '0.1413', 'NDCG@20': '0.0711'}
2025-03-02 10:47:54,404 - Validation score increased.  Saving model ...
2025-03-02 10:48:38,530 - {'epoch': 5, 'rec_loss': '7.3393'}
2025-03-02 10:48:47,091 - {'Epoch': 5, 'HR@5': '0.0781', 'NDCG@5': '0.0551', 'HR@10': '0.1072', 'NDCG@10': '0.0645', 'HR@20': '0.1439', 'NDCG@20': '0.0737'}
2025-03-02 10:48:47,092 - Validation score increased.  Saving model ...
2025-03-02 10:49:31,242 - {'epoch': 6, 'rec_loss': '7.2436'}
2025-03-02 10:49:40,542 - {'Epoch': 6, 'HR@5': '0.0796', 'NDCG@5': '0.0553', 'HR@10': '0.1093', 'NDCG@10': '0.0649', 'HR@20': '0.1460', 'NDCG@20': '0.0741'}
2025-03-02 10:49:40,543 - Validation score increased.  Saving model ...
2025-03-02 10:50:25,864 - {'epoch': 7, 'rec_loss': '7.1692'}
2025-03-02 10:50:34,753 - {'Epoch': 7, 'HR@5': '0.0817', 'NDCG@5': '0.0573', 'HR@10': '0.1125', 'NDCG@10': '0.0672', 'HR@20': '0.1519', 'NDCG@20': '0.0771'}
2025-03-02 10:50:34,755 - Validation score increased.  Saving model ...
2025-03-02 10:51:20,017 - {'epoch': 8, 'rec_loss': '7.1148'}
2025-03-02 10:51:28,967 - {'Epoch': 8, 'HR@5': '0.0824', 'NDCG@5': '0.0582', 'HR@10': '0.1142', 'NDCG@10': '0.0684', 'HR@20': '0.1540', 'NDCG@20': '0.0784'}
2025-03-02 10:51:28,969 - Validation score increased.  Saving model ...
2025-03-02 10:52:12,396 - {'epoch': 9, 'rec_loss': '7.0618'}
2025-03-02 10:52:21,689 - {'Epoch': 9, 'HR@5': '0.0811', 'NDCG@5': '0.0575', 'HR@10': '0.1145', 'NDCG@10': '0.0682', 'HR@20': '0.1564', 'NDCG@20': '0.0787'}
2025-03-02 10:52:21,691 - Validation score increased.  Saving model ...
2025-03-02 10:53:05,632 - {'epoch': 10, 'rec_loss': '7.0157'}
2025-03-02 10:53:14,235 - {'Epoch': 10, 'HR@5': '0.0833', 'NDCG@5': '0.0588', 'HR@10': '0.1150', 'NDCG@10': '0.0690', 'HR@20': '0.1551', 'NDCG@20': '0.0791'}
2025-03-02 10:53:14,237 - Validation score increased.  Saving model ...
2025-03-02 10:53:57,404 - {'epoch': 11, 'rec_loss': '6.9814'}
2025-03-02 10:54:06,603 - {'Epoch': 11, 'HR@5': '0.0849', 'NDCG@5': '0.0596', 'HR@10': '0.1155', 'NDCG@10': '0.0693', 'HR@20': '0.1562', 'NDCG@20': '0.0796'}
2025-03-02 10:54:06,605 - Validation score increased.  Saving model ...
2025-03-02 10:54:51,235 - {'epoch': 12, 'rec_loss': '6.9515'}
2025-03-02 10:54:59,921 - {'Epoch': 12, 'HR@5': '0.0844', 'NDCG@5': '0.0595', 'HR@10': '0.1164', 'NDCG@10': '0.0698', 'HR@20': '0.1577', 'NDCG@20': '0.0802'}
2025-03-02 10:54:59,923 - Validation score increased.  Saving model ...
2025-03-02 10:55:44,046 - {'epoch': 13, 'rec_loss': '6.9213'}
2025-03-02 10:55:52,735 - {'Epoch': 13, 'HR@5': '0.0842', 'NDCG@5': '0.0589', 'HR@10': '0.1153', 'NDCG@10': '0.0689', 'HR@20': '0.1564', 'NDCG@20': '0.0792'}
2025-03-02 10:55:52,737 - EarlyStopping counter: 1 out of 10
2025-03-02 10:56:35,767 - {'epoch': 14, 'rec_loss': '6.8954'}
2025-03-02 10:56:45,003 - {'Epoch': 14, 'HR@5': '0.0825', 'NDCG@5': '0.0589', 'HR@10': '0.1155', 'NDCG@10': '0.0695', 'HR@20': '0.1572', 'NDCG@20': '0.0800'}
2025-03-02 10:56:45,005 - EarlyStopping counter: 2 out of 10
2025-03-02 10:57:31,837 - {'epoch': 15, 'rec_loss': '6.8716'}
2025-03-02 10:57:40,891 - {'Epoch': 15, 'HR@5': '0.0832', 'NDCG@5': '0.0590', 'HR@10': '0.1165', 'NDCG@10': '0.0697', 'HR@20': '0.1570', 'NDCG@20': '0.0799'}
2025-03-02 10:57:40,893 - EarlyStopping counter: 3 out of 10
2025-03-02 10:58:27,917 - {'epoch': 16, 'rec_loss': '6.8499'}
2025-03-02 10:58:36,735 - {'Epoch': 16, 'HR@5': '0.0854', 'NDCG@5': '0.0607', 'HR@10': '0.1169', 'NDCG@10': '0.0709', 'HR@20': '0.1590', 'NDCG@20': '0.0815'}
2025-03-02 10:58:36,736 - Validation score increased.  Saving model ...
2025-03-02 10:59:21,698 - {'epoch': 17, 'rec_loss': '6.8331'}
2025-03-02 10:59:31,388 - {'Epoch': 17, 'HR@5': '0.0831', 'NDCG@5': '0.0591', 'HR@10': '0.1176', 'NDCG@10': '0.0702', 'HR@20': '0.1587', 'NDCG@20': '0.0806'}
2025-03-02 10:59:31,389 - EarlyStopping counter: 1 out of 10
2025-03-02 11:00:16,174 - {'epoch': 18, 'rec_loss': '6.8159'}
2025-03-02 11:00:25,752 - {'Epoch': 18, 'HR@5': '0.0855', 'NDCG@5': '0.0605', 'HR@10': '0.1177', 'NDCG@10': '0.0708', 'HR@20': '0.1617', 'NDCG@20': '0.0818'}
2025-03-02 11:00:25,753 - Validation score increased.  Saving model ...
2025-03-02 11:01:08,412 - {'epoch': 19, 'rec_loss': '6.7907'}
2025-03-02 11:01:17,125 - {'Epoch': 19, 'HR@5': '0.0854', 'NDCG@5': '0.0610', 'HR@10': '0.1197', 'NDCG@10': '0.0721', 'HR@20': '0.1621', 'NDCG@20': '0.0827'}
2025-03-02 11:01:17,127 - Validation score increased.  Saving model ...
2025-03-02 11:02:00,321 - {'epoch': 20, 'rec_loss': '6.7780'}
2025-03-02 11:02:09,174 - {'Epoch': 20, 'HR@5': '0.0846', 'NDCG@5': '0.0598', 'HR@10': '0.1172', 'NDCG@10': '0.0703', 'HR@20': '0.1599', 'NDCG@20': '0.0810'}
2025-03-02 11:02:09,175 - EarlyStopping counter: 1 out of 10
2025-03-02 11:02:50,865 - {'epoch': 21, 'rec_loss': '6.7626'}
2025-03-02 11:02:59,514 - {'Epoch': 21, 'HR@5': '0.0838', 'NDCG@5': '0.0591', 'HR@10': '0.1187', 'NDCG@10': '0.0705', 'HR@20': '0.1606', 'NDCG@20': '0.0810'}
2025-03-02 11:02:59,516 - EarlyStopping counter: 2 out of 10
2025-03-02 11:03:42,878 - {'epoch': 22, 'rec_loss': '6.7533'}
2025-03-02 11:03:51,523 - {'Epoch': 22, 'HR@5': '0.0837', 'NDCG@5': '0.0592', 'HR@10': '0.1161', 'NDCG@10': '0.0696', 'HR@20': '0.1587', 'NDCG@20': '0.0803'}
2025-03-02 11:03:51,525 - EarlyStopping counter: 3 out of 10
2025-03-02 11:04:35,316 - {'epoch': 23, 'rec_loss': '6.7384'}
2025-03-02 11:04:44,141 - {'Epoch': 23, 'HR@5': '0.0853', 'NDCG@5': '0.0598', 'HR@10': '0.1159', 'NDCG@10': '0.0697', 'HR@20': '0.1590', 'NDCG@20': '0.0806'}
2025-03-02 11:04:44,142 - EarlyStopping counter: 4 out of 10
2025-03-02 11:05:29,172 - {'epoch': 24, 'rec_loss': '6.7265'}
2025-03-02 11:05:37,884 - {'Epoch': 24, 'HR@5': '0.0863', 'NDCG@5': '0.0603', 'HR@10': '0.1168', 'NDCG@10': '0.0702', 'HR@20': '0.1585', 'NDCG@20': '0.0807'}
2025-03-02 11:05:37,885 - EarlyStopping counter: 5 out of 10
2025-03-02 11:06:22,237 - {'epoch': 25, 'rec_loss': '6.7132'}
2025-03-02 11:06:30,928 - {'Epoch': 25, 'HR@5': '0.0855', 'NDCG@5': '0.0600', 'HR@10': '0.1184', 'NDCG@10': '0.0705', 'HR@20': '0.1604', 'NDCG@20': '0.0811'}
2025-03-02 11:06:30,929 - EarlyStopping counter: 6 out of 10
2025-03-02 11:07:13,096 - {'epoch': 26, 'rec_loss': '6.7012'}
2025-03-02 11:07:21,630 - {'Epoch': 26, 'HR@5': '0.0839', 'NDCG@5': '0.0591', 'HR@10': '0.1182', 'NDCG@10': '0.0702', 'HR@20': '0.1608', 'NDCG@20': '0.0809'}
2025-03-02 11:07:21,632 - EarlyStopping counter: 7 out of 10
2025-03-02 11:08:03,458 - {'epoch': 27, 'rec_loss': '6.6889'}
2025-03-02 11:08:12,107 - {'Epoch': 27, 'HR@5': '0.0861', 'NDCG@5': '0.0610', 'HR@10': '0.1190', 'NDCG@10': '0.0716', 'HR@20': '0.1609', 'NDCG@20': '0.0822'}
2025-03-02 11:08:12,109 - EarlyStopping counter: 8 out of 10
2025-03-02 11:08:54,153 - {'epoch': 28, 'rec_loss': '6.6830'}
2025-03-02 11:09:02,752 - {'Epoch': 28, 'HR@5': '0.0856', 'NDCG@5': '0.0607', 'HR@10': '0.1186', 'NDCG@10': '0.0713', 'HR@20': '0.1592', 'NDCG@20': '0.0816'}
2025-03-02 11:09:02,753 - EarlyStopping counter: 9 out of 10
2025-03-02 11:09:43,848 - {'epoch': 29, 'rec_loss': '6.6672'}
2025-03-02 11:09:52,458 - {'Epoch': 29, 'HR@5': '0.0850', 'NDCG@5': '0.0594', 'HR@10': '0.1183', 'NDCG@10': '0.0701', 'HR@20': '0.1595', 'NDCG@20': '0.0805'}
2025-03-02 11:09:52,459 - EarlyStopping counter: 10 out of 10
2025-03-02 11:09:52,459 - Early stopping
2025-03-02 11:09:52,459 - ---------------Test Score---------------
2025-03-02 11:10:01,727 - {'Epoch': 0, 'HR@5': '0.0717', 'NDCG@5': '0.0508', 'HR@10': '0.0997', 'NDCG@10': '0.0598', 'HR@20': '0.1356', 'NDCG@20': '0.0688'}
2025-03-02 11:10:01,729 - Scale_Beauty
2025-03-02 11:10:01,729 - {'Epoch': 0, 'HR@5': '0.0717', 'NDCG@5': '0.0508', 'HR@10': '0.0997', 'NDCG@10': '0.0598', 'HR@20': '0.1356', 'NDCG@20': '0.0688'}
2025-03-02 11:21:44,406 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 24, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-02 11:21:47,245 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-02 11:21:47,250 - Total Parameters: 929445
2025-03-02 11:22:19,404 - {'epoch': 0, 'rec_loss': '8.8368'}
2025-03-02 11:22:27,608 - {'Epoch': 0, 'HR@5': '0.0205', 'NDCG@5': '0.0129', 'HR@10': '0.0309', 'NDCG@10': '0.0163', 'HR@20': '0.0474', 'NDCG@20': '0.0204'}
2025-03-02 11:22:27,609 - Validation score increased.  Saving model ...
2025-03-02 11:22:57,105 - {'epoch': 1, 'rec_loss': '8.3286'}
2025-03-02 11:23:05,384 - {'Epoch': 1, 'HR@5': '0.0369', 'NDCG@5': '0.0251', 'HR@10': '0.0568', 'NDCG@10': '0.0315', 'HR@20': '0.0825', 'NDCG@20': '0.0379'}
2025-03-02 11:23:05,385 - Validation score increased.  Saving model ...
2025-03-02 11:23:36,250 - {'epoch': 2, 'rec_loss': '8.0168'}
2025-03-02 11:23:44,269 - {'Epoch': 2, 'HR@5': '0.0487', 'NDCG@5': '0.0330', 'HR@10': '0.0728', 'NDCG@10': '0.0407', 'HR@20': '0.1050', 'NDCG@20': '0.0488'}
2025-03-02 11:23:44,270 - Validation score increased.  Saving model ...
2025-03-02 11:24:11,426 - {'epoch': 3, 'rec_loss': '7.8002'}
2025-03-02 11:24:19,394 - {'Epoch': 3, 'HR@5': '0.0596', 'NDCG@5': '0.0407', 'HR@10': '0.0859', 'NDCG@10': '0.0491', 'HR@20': '0.1231', 'NDCG@20': '0.0585'}
2025-03-02 11:24:19,395 - Validation score increased.  Saving model ...
2025-03-02 11:24:47,674 - {'epoch': 4, 'rec_loss': '7.6366'}
2025-03-02 11:24:55,433 - {'Epoch': 4, 'HR@5': '0.0686', 'NDCG@5': '0.0474', 'HR@10': '0.0956', 'NDCG@10': '0.0561', 'HR@20': '0.1324', 'NDCG@20': '0.0653'}
2025-03-02 11:24:55,439 - Validation score increased.  Saving model ...
2025-03-02 11:25:23,291 - {'epoch': 5, 'rec_loss': '7.5211'}
2025-03-02 11:25:31,105 - {'Epoch': 5, 'HR@5': '0.0731', 'NDCG@5': '0.0508', 'HR@10': '0.1025', 'NDCG@10': '0.0603', 'HR@20': '0.1396', 'NDCG@20': '0.0696'}
2025-03-02 11:25:31,106 - Validation score increased.  Saving model ...
2025-03-02 11:25:59,979 - {'epoch': 6, 'rec_loss': '7.4234'}
2025-03-02 11:26:08,309 - {'Epoch': 6, 'HR@5': '0.0751', 'NDCG@5': '0.0531', 'HR@10': '0.1057', 'NDCG@10': '0.0629', 'HR@20': '0.1442', 'NDCG@20': '0.0726'}
2025-03-02 11:26:08,311 - Validation score increased.  Saving model ...
2025-03-02 11:26:36,980 - {'epoch': 7, 'rec_loss': '7.3446'}
2025-03-02 11:26:44,829 - {'Epoch': 7, 'HR@5': '0.0798', 'NDCG@5': '0.0561', 'HR@10': '0.1079', 'NDCG@10': '0.0651', 'HR@20': '0.1480', 'NDCG@20': '0.0752'}
2025-03-02 11:26:44,830 - Validation score increased.  Saving model ...
2025-03-02 11:27:12,324 - {'epoch': 8, 'rec_loss': '7.2734'}
2025-03-02 11:27:20,433 - {'Epoch': 8, 'HR@5': '0.0819', 'NDCG@5': '0.0579', 'HR@10': '0.1106', 'NDCG@10': '0.0672', 'HR@20': '0.1506', 'NDCG@20': '0.0772'}
2025-03-02 11:27:20,435 - Validation score increased.  Saving model ...
2025-03-02 11:27:48,397 - {'epoch': 9, 'rec_loss': '7.2239'}
2025-03-02 11:27:56,124 - {'Epoch': 9, 'HR@5': '0.0809', 'NDCG@5': '0.0567', 'HR@10': '0.1129', 'NDCG@10': '0.0670', 'HR@20': '0.1521', 'NDCG@20': '0.0769'}
2025-03-02 11:27:56,130 - EarlyStopping counter: 1 out of 10
2025-03-02 11:28:26,726 - {'epoch': 10, 'rec_loss': '7.1773'}
2025-03-02 11:28:34,562 - {'Epoch': 10, 'HR@5': '0.0836', 'NDCG@5': '0.0589', 'HR@10': '0.1132', 'NDCG@10': '0.0684', 'HR@20': '0.1529', 'NDCG@20': '0.0784'}
2025-03-02 11:28:34,563 - Validation score increased.  Saving model ...
2025-03-02 11:29:04,450 - {'epoch': 11, 'rec_loss': '7.1374'}
2025-03-02 11:29:12,314 - {'Epoch': 11, 'HR@5': '0.0837', 'NDCG@5': '0.0595', 'HR@10': '0.1140', 'NDCG@10': '0.0693', 'HR@20': '0.1537', 'NDCG@20': '0.0793'}
2025-03-02 11:29:12,316 - Validation score increased.  Saving model ...
2025-03-02 11:29:40,709 - {'epoch': 12, 'rec_loss': '7.1003'}
2025-03-02 11:29:48,408 - {'Epoch': 12, 'HR@5': '0.0839', 'NDCG@5': '0.0593', 'HR@10': '0.1145', 'NDCG@10': '0.0692', 'HR@20': '0.1571', 'NDCG@20': '0.0800'}
2025-03-02 11:29:48,409 - Validation score increased.  Saving model ...
2025-03-02 11:30:17,441 - {'epoch': 13, 'rec_loss': '7.0745'}
2025-03-02 11:30:25,312 - {'Epoch': 13, 'HR@5': '0.0846', 'NDCG@5': '0.0595', 'HR@10': '0.1177', 'NDCG@10': '0.0702', 'HR@20': '0.1588', 'NDCG@20': '0.0806'}
2025-03-02 11:30:25,313 - Validation score increased.  Saving model ...
2025-03-02 11:30:54,146 - {'epoch': 14, 'rec_loss': '7.0426'}
2025-03-02 11:31:01,920 - {'Epoch': 14, 'HR@5': '0.0868', 'NDCG@5': '0.0604', 'HR@10': '0.1180', 'NDCG@10': '0.0704', 'HR@20': '0.1597', 'NDCG@20': '0.0810'}
2025-03-02 11:31:01,921 - Validation score increased.  Saving model ...
2025-03-02 11:31:29,695 - {'epoch': 15, 'rec_loss': '7.0233'}
2025-03-02 11:31:37,573 - {'Epoch': 15, 'HR@5': '0.0863', 'NDCG@5': '0.0605', 'HR@10': '0.1181', 'NDCG@10': '0.0708', 'HR@20': '0.1604', 'NDCG@20': '0.0815'}
2025-03-02 11:31:37,578 - Validation score increased.  Saving model ...
2025-03-02 11:32:06,275 - {'epoch': 16, 'rec_loss': '7.0003'}
2025-03-02 11:32:14,151 - {'Epoch': 16, 'HR@5': '0.0863', 'NDCG@5': '0.0604', 'HR@10': '0.1191', 'NDCG@10': '0.0710', 'HR@20': '0.1614', 'NDCG@20': '0.0816'}
2025-03-02 11:32:14,155 - Validation score increased.  Saving model ...
2025-03-02 11:32:42,990 - {'epoch': 17, 'rec_loss': '6.9849'}
2025-03-02 11:32:50,725 - {'Epoch': 17, 'HR@5': '0.0846', 'NDCG@5': '0.0606', 'HR@10': '0.1189', 'NDCG@10': '0.0717', 'HR@20': '0.1620', 'NDCG@20': '0.0825'}
2025-03-02 11:32:50,726 - Validation score increased.  Saving model ...
2025-03-02 11:33:17,019 - {'epoch': 18, 'rec_loss': '6.9519'}
2025-03-02 11:33:24,719 - {'Epoch': 18, 'HR@5': '0.0862', 'NDCG@5': '0.0606', 'HR@10': '0.1189', 'NDCG@10': '0.0711', 'HR@20': '0.1612', 'NDCG@20': '0.0818'}
2025-03-02 11:33:24,726 - EarlyStopping counter: 1 out of 10
2025-03-02 11:33:51,231 - {'epoch': 19, 'rec_loss': '6.9418'}
2025-03-02 11:33:58,957 - {'Epoch': 19, 'HR@5': '0.0865', 'NDCG@5': '0.0616', 'HR@10': '0.1186', 'NDCG@10': '0.0720', 'HR@20': '0.1621', 'NDCG@20': '0.0829'}
2025-03-02 11:33:58,958 - Validation score increased.  Saving model ...
2025-03-02 11:34:28,064 - {'epoch': 20, 'rec_loss': '6.9221'}
2025-03-02 11:34:36,401 - {'Epoch': 20, 'HR@5': '0.0863', 'NDCG@5': '0.0613', 'HR@10': '0.1199', 'NDCG@10': '0.0722', 'HR@20': '0.1619', 'NDCG@20': '0.0828'}
2025-03-02 11:34:36,407 - EarlyStopping counter: 1 out of 10
2025-03-02 11:35:04,778 - {'epoch': 21, 'rec_loss': '6.9131'}
2025-03-02 11:35:12,731 - {'Epoch': 21, 'HR@5': '0.0869', 'NDCG@5': '0.0615', 'HR@10': '0.1206', 'NDCG@10': '0.0723', 'HR@20': '0.1628', 'NDCG@20': '0.0830'}
2025-03-02 11:35:12,732 - Validation score increased.  Saving model ...
2025-03-02 11:35:43,964 - {'epoch': 22, 'rec_loss': '6.9023'}
2025-03-02 11:35:51,728 - {'Epoch': 22, 'HR@5': '0.0872', 'NDCG@5': '0.0620', 'HR@10': '0.1211', 'NDCG@10': '0.0729', 'HR@20': '0.1634', 'NDCG@20': '0.0836'}
2025-03-02 11:35:51,729 - Validation score increased.  Saving model ...
2025-03-02 11:36:19,998 - {'epoch': 23, 'rec_loss': '6.8851'}
2025-03-02 11:36:27,845 - {'Epoch': 23, 'HR@5': '0.0877', 'NDCG@5': '0.0623', 'HR@10': '0.1208', 'NDCG@10': '0.0728', 'HR@20': '0.1629', 'NDCG@20': '0.0834'}
2025-03-02 11:36:27,846 - EarlyStopping counter: 1 out of 10
2025-03-02 11:36:55,444 - {'epoch': 24, 'rec_loss': '6.8779'}
2025-03-02 11:37:03,234 - {'Epoch': 24, 'HR@5': '0.0882', 'NDCG@5': '0.0618', 'HR@10': '0.1205', 'NDCG@10': '0.0722', 'HR@20': '0.1624', 'NDCG@20': '0.0828'}
2025-03-02 11:37:03,241 - EarlyStopping counter: 2 out of 10
2025-03-02 11:37:31,250 - {'epoch': 25, 'rec_loss': '6.8578'}
2025-03-02 11:37:38,885 - {'Epoch': 25, 'HR@5': '0.0872', 'NDCG@5': '0.0614', 'HR@10': '0.1210', 'NDCG@10': '0.0723', 'HR@20': '0.1642', 'NDCG@20': '0.0831'}
2025-03-02 11:37:38,886 - EarlyStopping counter: 3 out of 10
2025-03-02 11:38:08,016 - {'epoch': 26, 'rec_loss': '6.8535'}
2025-03-02 11:38:15,952 - {'Epoch': 26, 'HR@5': '0.0882', 'NDCG@5': '0.0621', 'HR@10': '0.1205', 'NDCG@10': '0.0725', 'HR@20': '0.1638', 'NDCG@20': '0.0835'}
2025-03-02 11:38:15,953 - EarlyStopping counter: 4 out of 10
2025-03-02 11:38:43,265 - {'epoch': 27, 'rec_loss': '6.8386'}
2025-03-02 11:38:51,505 - {'Epoch': 27, 'HR@5': '0.0870', 'NDCG@5': '0.0618', 'HR@10': '0.1199', 'NDCG@10': '0.0725', 'HR@20': '0.1622', 'NDCG@20': '0.0831'}
2025-03-02 11:38:51,507 - EarlyStopping counter: 5 out of 10
2025-03-02 11:39:18,945 - {'epoch': 28, 'rec_loss': '6.8340'}
2025-03-02 11:39:27,027 - {'Epoch': 28, 'HR@5': '0.0881', 'NDCG@5': '0.0619', 'HR@10': '0.1213', 'NDCG@10': '0.0726', 'HR@20': '0.1629', 'NDCG@20': '0.0830'}
2025-03-02 11:39:27,029 - EarlyStopping counter: 6 out of 10
2025-03-02 11:39:54,882 - {'epoch': 29, 'rec_loss': '6.8259'}
2025-03-02 11:40:03,113 - {'Epoch': 29, 'HR@5': '0.0860', 'NDCG@5': '0.0606', 'HR@10': '0.1206', 'NDCG@10': '0.0717', 'HR@20': '0.1635', 'NDCG@20': '0.0825'}
2025-03-02 11:40:03,114 - EarlyStopping counter: 7 out of 10
2025-03-02 11:40:31,174 - {'epoch': 30, 'rec_loss': '6.8149'}
2025-03-02 11:40:39,208 - {'Epoch': 30, 'HR@5': '0.0869', 'NDCG@5': '0.0615', 'HR@10': '0.1203', 'NDCG@10': '0.0723', 'HR@20': '0.1650', 'NDCG@20': '0.0836'}
2025-03-02 11:40:39,209 - Validation score increased.  Saving model ...
2025-03-02 11:41:07,864 - {'epoch': 31, 'rec_loss': '6.8008'}
2025-03-02 11:41:15,718 - {'Epoch': 31, 'HR@5': '0.0883', 'NDCG@5': '0.0625', 'HR@10': '0.1204', 'NDCG@10': '0.0728', 'HR@20': '0.1639', 'NDCG@20': '0.0839'}
2025-03-02 11:41:15,719 - Validation score increased.  Saving model ...
2025-03-02 11:41:43,831 - {'epoch': 32, 'rec_loss': '6.7971'}
2025-03-02 11:41:51,835 - {'Epoch': 32, 'HR@5': '0.0889', 'NDCG@5': '0.0629', 'HR@10': '0.1213', 'NDCG@10': '0.0733', 'HR@20': '0.1638', 'NDCG@20': '0.0840'}
2025-03-02 11:41:51,836 - Validation score increased.  Saving model ...
2025-03-02 11:42:23,009 - {'epoch': 33, 'rec_loss': '6.7947'}
2025-03-02 11:42:30,953 - {'Epoch': 33, 'HR@5': '0.0882', 'NDCG@5': '0.0627', 'HR@10': '0.1192', 'NDCG@10': '0.0727', 'HR@20': '0.1623', 'NDCG@20': '0.0835'}
2025-03-02 11:42:30,958 - EarlyStopping counter: 1 out of 10
2025-03-02 11:42:59,136 - {'epoch': 34, 'rec_loss': '6.7783'}
2025-03-02 11:43:07,229 - {'Epoch': 34, 'HR@5': '0.0885', 'NDCG@5': '0.0624', 'HR@10': '0.1198', 'NDCG@10': '0.0724', 'HR@20': '0.1619', 'NDCG@20': '0.0831'}
2025-03-02 11:43:07,235 - EarlyStopping counter: 2 out of 10
2025-03-02 11:43:35,172 - {'epoch': 35, 'rec_loss': '6.7742'}
2025-03-02 11:43:42,944 - {'Epoch': 35, 'HR@5': '0.0868', 'NDCG@5': '0.0612', 'HR@10': '0.1185', 'NDCG@10': '0.0715', 'HR@20': '0.1634', 'NDCG@20': '0.0827'}
2025-03-02 11:43:42,950 - EarlyStopping counter: 3 out of 10
2025-03-02 11:44:11,229 - {'epoch': 36, 'rec_loss': '6.7663'}
2025-03-02 11:44:19,182 - {'Epoch': 36, 'HR@5': '0.0867', 'NDCG@5': '0.0618', 'HR@10': '0.1206', 'NDCG@10': '0.0728', 'HR@20': '0.1638', 'NDCG@20': '0.0836'}
2025-03-02 11:44:19,187 - EarlyStopping counter: 4 out of 10
2025-03-02 11:44:47,111 - {'epoch': 37, 'rec_loss': '6.7503'}
2025-03-02 11:44:55,140 - {'Epoch': 37, 'HR@5': '0.0869', 'NDCG@5': '0.0612', 'HR@10': '0.1203', 'NDCG@10': '0.0719', 'HR@20': '0.1653', 'NDCG@20': '0.0833'}
2025-03-02 11:44:55,146 - EarlyStopping counter: 5 out of 10
2025-03-02 11:45:23,181 - {'epoch': 38, 'rec_loss': '6.7516'}
2025-03-02 11:45:30,971 - {'Epoch': 38, 'HR@5': '0.0868', 'NDCG@5': '0.0611', 'HR@10': '0.1206', 'NDCG@10': '0.0721', 'HR@20': '0.1634', 'NDCG@20': '0.0828'}
2025-03-02 11:45:30,972 - EarlyStopping counter: 6 out of 10
2025-03-02 11:45:58,343 - {'epoch': 39, 'rec_loss': '6.7452'}
2025-03-02 11:46:06,596 - {'Epoch': 39, 'HR@5': '0.0848', 'NDCG@5': '0.0599', 'HR@10': '0.1193', 'NDCG@10': '0.0710', 'HR@20': '0.1615', 'NDCG@20': '0.0816'}
2025-03-02 11:46:06,598 - EarlyStopping counter: 7 out of 10
2025-03-02 11:46:34,606 - {'epoch': 40, 'rec_loss': '6.7463'}
2025-03-02 11:46:42,543 - {'Epoch': 40, 'HR@5': '0.0864', 'NDCG@5': '0.0613', 'HR@10': '0.1205', 'NDCG@10': '0.0722', 'HR@20': '0.1644', 'NDCG@20': '0.0833'}
2025-03-02 11:46:42,544 - EarlyStopping counter: 8 out of 10
2025-03-02 11:47:12,793 - {'epoch': 41, 'rec_loss': '6.7345'}
2025-03-02 11:47:21,081 - {'Epoch': 41, 'HR@5': '0.0874', 'NDCG@5': '0.0621', 'HR@10': '0.1203', 'NDCG@10': '0.0727', 'HR@20': '0.1639', 'NDCG@20': '0.0837'}
2025-03-02 11:47:21,082 - EarlyStopping counter: 9 out of 10
2025-03-02 11:47:50,271 - {'epoch': 42, 'rec_loss': '6.7306'}
2025-03-02 11:47:58,249 - {'Epoch': 42, 'HR@5': '0.0886', 'NDCG@5': '0.0630', 'HR@10': '0.1208', 'NDCG@10': '0.0733', 'HR@20': '0.1642', 'NDCG@20': '0.0843'}
2025-03-02 11:47:58,250 - Validation score increased.  Saving model ...
2025-03-02 11:48:28,716 - {'epoch': 43, 'rec_loss': '6.7167'}
2025-03-02 11:48:36,504 - {'Epoch': 43, 'HR@5': '0.0880', 'NDCG@5': '0.0615', 'HR@10': '0.1206', 'NDCG@10': '0.0720', 'HR@20': '0.1635', 'NDCG@20': '0.0828'}
2025-03-02 11:48:36,506 - EarlyStopping counter: 1 out of 10
2025-03-02 11:49:04,683 - {'epoch': 44, 'rec_loss': '6.7191'}
2025-03-02 11:49:12,523 - {'Epoch': 44, 'HR@5': '0.0869', 'NDCG@5': '0.0618', 'HR@10': '0.1202', 'NDCG@10': '0.0726', 'HR@20': '0.1635', 'NDCG@20': '0.0834'}
2025-03-02 11:49:12,524 - EarlyStopping counter: 2 out of 10
2025-03-02 11:49:39,973 - {'epoch': 45, 'rec_loss': '6.7123'}
2025-03-02 11:49:47,874 - {'Epoch': 45, 'HR@5': '0.0882', 'NDCG@5': '0.0622', 'HR@10': '0.1211', 'NDCG@10': '0.0728', 'HR@20': '0.1648', 'NDCG@20': '0.0838'}
2025-03-02 11:49:47,880 - EarlyStopping counter: 3 out of 10
2025-03-02 11:50:16,047 - {'epoch': 46, 'rec_loss': '6.7020'}
2025-03-02 11:50:23,970 - {'Epoch': 46, 'HR@5': '0.0888', 'NDCG@5': '0.0629', 'HR@10': '0.1202', 'NDCG@10': '0.0730', 'HR@20': '0.1655', 'NDCG@20': '0.0844'}
2025-03-02 11:50:23,971 - Validation score increased.  Saving model ...
2025-03-02 11:50:51,950 - {'epoch': 47, 'rec_loss': '6.6976'}
2025-03-02 11:51:00,206 - {'Epoch': 47, 'HR@5': '0.0868', 'NDCG@5': '0.0617', 'HR@10': '0.1202', 'NDCG@10': '0.0724', 'HR@20': '0.1629', 'NDCG@20': '0.0832'}
2025-03-02 11:51:00,211 - EarlyStopping counter: 1 out of 10
2025-03-02 11:51:29,488 - {'epoch': 48, 'rec_loss': '6.6954'}
2025-03-02 11:51:37,545 - {'Epoch': 48, 'HR@5': '0.0878', 'NDCG@5': '0.0620', 'HR@10': '0.1205', 'NDCG@10': '0.0725', 'HR@20': '0.1636', 'NDCG@20': '0.0834'}
2025-03-02 11:51:37,552 - EarlyStopping counter: 2 out of 10
2025-03-02 11:52:06,918 - {'epoch': 49, 'rec_loss': '6.6878'}
2025-03-02 11:52:14,842 - {'Epoch': 49, 'HR@5': '0.0874', 'NDCG@5': '0.0617', 'HR@10': '0.1199', 'NDCG@10': '0.0722', 'HR@20': '0.1646', 'NDCG@20': '0.0835'}
2025-03-02 11:52:14,847 - EarlyStopping counter: 3 out of 10
2025-03-02 11:52:42,613 - {'epoch': 50, 'rec_loss': '6.6891'}
2025-03-02 11:52:50,510 - {'Epoch': 50, 'HR@5': '0.0879', 'NDCG@5': '0.0625', 'HR@10': '0.1205', 'NDCG@10': '0.0731', 'HR@20': '0.1641', 'NDCG@20': '0.0841'}
2025-03-02 11:52:50,515 - EarlyStopping counter: 4 out of 10
2025-03-02 11:53:18,381 - {'epoch': 51, 'rec_loss': '6.6836'}
2025-03-02 11:53:26,419 - {'Epoch': 51, 'HR@5': '0.0877', 'NDCG@5': '0.0625', 'HR@10': '0.1198', 'NDCG@10': '0.0728', 'HR@20': '0.1645', 'NDCG@20': '0.0841'}
2025-03-02 11:53:26,421 - EarlyStopping counter: 5 out of 10
2025-03-02 11:53:54,280 - {'epoch': 52, 'rec_loss': '6.6732'}
2025-03-02 11:54:02,274 - {'Epoch': 52, 'HR@5': '0.0867', 'NDCG@5': '0.0621', 'HR@10': '0.1190', 'NDCG@10': '0.0725', 'HR@20': '0.1633', 'NDCG@20': '0.0836'}
2025-03-02 11:54:02,275 - EarlyStopping counter: 6 out of 10
2025-03-02 11:54:31,885 - {'epoch': 53, 'rec_loss': '6.6761'}
2025-03-02 11:54:40,194 - {'Epoch': 53, 'HR@5': '0.0875', 'NDCG@5': '0.0623', 'HR@10': '0.1216', 'NDCG@10': '0.0733', 'HR@20': '0.1646', 'NDCG@20': '0.0841'}
2025-03-02 11:54:40,195 - EarlyStopping counter: 7 out of 10
2025-03-02 11:55:09,005 - {'epoch': 54, 'rec_loss': '6.6686'}
2025-03-02 11:55:17,339 - {'Epoch': 54, 'HR@5': '0.0881', 'NDCG@5': '0.0629', 'HR@10': '0.1205', 'NDCG@10': '0.0734', 'HR@20': '0.1636', 'NDCG@20': '0.0841'}
2025-03-02 11:55:17,340 - EarlyStopping counter: 8 out of 10
2025-03-02 11:55:45,906 - {'epoch': 55, 'rec_loss': '6.6653'}
2025-03-02 11:55:53,838 - {'Epoch': 55, 'HR@5': '0.0884', 'NDCG@5': '0.0630', 'HR@10': '0.1207', 'NDCG@10': '0.0734', 'HR@20': '0.1652', 'NDCG@20': '0.0846'}
2025-03-02 11:55:53,839 - Validation score increased.  Saving model ...
2025-03-02 11:56:22,212 - {'epoch': 56, 'rec_loss': '6.6617'}
2025-03-02 11:56:30,072 - {'Epoch': 56, 'HR@5': '0.0880', 'NDCG@5': '0.0630', 'HR@10': '0.1203', 'NDCG@10': '0.0734', 'HR@20': '0.1636', 'NDCG@20': '0.0843'}
2025-03-02 11:56:30,073 - EarlyStopping counter: 1 out of 10
2025-03-02 11:56:57,713 - {'epoch': 57, 'rec_loss': '6.6561'}
2025-03-02 11:57:05,698 - {'Epoch': 57, 'HR@5': '0.0882', 'NDCG@5': '0.0629', 'HR@10': '0.1201', 'NDCG@10': '0.0732', 'HR@20': '0.1639', 'NDCG@20': '0.0842'}
2025-03-02 11:57:05,703 - EarlyStopping counter: 2 out of 10
2025-03-02 11:57:34,014 - {'epoch': 58, 'rec_loss': '6.6554'}
2025-03-02 11:57:41,987 - {'Epoch': 58, 'HR@5': '0.0867', 'NDCG@5': '0.0619', 'HR@10': '0.1209', 'NDCG@10': '0.0730', 'HR@20': '0.1651', 'NDCG@20': '0.0841'}
2025-03-02 11:57:41,993 - EarlyStopping counter: 3 out of 10
2025-03-02 11:58:10,390 - {'epoch': 59, 'rec_loss': '6.6511'}
2025-03-02 11:58:18,791 - {'Epoch': 59, 'HR@5': '0.0874', 'NDCG@5': '0.0622', 'HR@10': '0.1214', 'NDCG@10': '0.0732', 'HR@20': '0.1661', 'NDCG@20': '0.0845'}
2025-03-02 11:58:18,792 - EarlyStopping counter: 4 out of 10
2025-03-02 11:58:47,156 - {'epoch': 60, 'rec_loss': '6.6415'}
2025-03-02 11:58:54,996 - {'Epoch': 60, 'HR@5': '0.0880', 'NDCG@5': '0.0627', 'HR@10': '0.1212', 'NDCG@10': '0.0733', 'HR@20': '0.1655', 'NDCG@20': '0.0845'}
2025-03-02 11:58:54,998 - EarlyStopping counter: 5 out of 10
2025-03-02 11:59:23,005 - {'epoch': 61, 'rec_loss': '6.6427'}
2025-03-02 11:59:31,010 - {'Epoch': 61, 'HR@5': '0.0880', 'NDCG@5': '0.0629', 'HR@10': '0.1197', 'NDCG@10': '0.0731', 'HR@20': '0.1649', 'NDCG@20': '0.0845'}
2025-03-02 11:59:31,011 - EarlyStopping counter: 6 out of 10
2025-03-02 11:59:58,372 - {'epoch': 62, 'rec_loss': '6.6381'}
2025-03-02 12:00:06,442 - {'Epoch': 62, 'HR@5': '0.0884', 'NDCG@5': '0.0631', 'HR@10': '0.1222', 'NDCG@10': '0.0740', 'HR@20': '0.1657', 'NDCG@20': '0.0850'}
2025-03-02 12:00:06,443 - Validation score increased.  Saving model ...
2025-03-02 12:00:34,868 - {'epoch': 63, 'rec_loss': '6.6342'}
2025-03-02 12:00:42,763 - {'Epoch': 63, 'HR@5': '0.0886', 'NDCG@5': '0.0623', 'HR@10': '0.1224', 'NDCG@10': '0.0732', 'HR@20': '0.1663', 'NDCG@20': '0.0842'}
2025-03-02 12:00:42,764 - EarlyStopping counter: 1 out of 10
2025-03-02 12:01:10,195 - {'epoch': 64, 'rec_loss': '6.6299'}
2025-03-02 12:01:18,053 - {'Epoch': 64, 'HR@5': '0.0881', 'NDCG@5': '0.0631', 'HR@10': '0.1210', 'NDCG@10': '0.0737', 'HR@20': '0.1642', 'NDCG@20': '0.0846'}
2025-03-02 12:01:18,054 - EarlyStopping counter: 2 out of 10
2025-03-02 12:01:46,385 - {'epoch': 65, 'rec_loss': '6.6281'}
2025-03-02 12:01:54,409 - {'Epoch': 65, 'HR@5': '0.0880', 'NDCG@5': '0.0625', 'HR@10': '0.1226', 'NDCG@10': '0.0736', 'HR@20': '0.1651', 'NDCG@20': '0.0843'}
2025-03-02 12:01:54,414 - EarlyStopping counter: 3 out of 10
2025-03-02 12:02:22,558 - {'epoch': 66, 'rec_loss': '6.6296'}
2025-03-02 12:02:30,662 - {'Epoch': 66, 'HR@5': '0.0877', 'NDCG@5': '0.0625', 'HR@10': '0.1218', 'NDCG@10': '0.0735', 'HR@20': '0.1655', 'NDCG@20': '0.0845'}
2025-03-02 12:02:30,667 - EarlyStopping counter: 4 out of 10
2025-03-02 12:02:59,037 - {'epoch': 67, 'rec_loss': '6.6229'}
2025-03-02 12:03:07,109 - {'Epoch': 67, 'HR@5': '0.0879', 'NDCG@5': '0.0617', 'HR@10': '0.1208', 'NDCG@10': '0.0723', 'HR@20': '0.1654', 'NDCG@20': '0.0835'}
2025-03-02 12:03:07,115 - EarlyStopping counter: 5 out of 10
2025-03-02 12:03:34,124 - {'epoch': 68, 'rec_loss': '6.6206'}
2025-03-02 12:03:42,150 - {'Epoch': 68, 'HR@5': '0.0888', 'NDCG@5': '0.0629', 'HR@10': '0.1214', 'NDCG@10': '0.0734', 'HR@20': '0.1646', 'NDCG@20': '0.0843'}
2025-03-02 12:03:42,151 - EarlyStopping counter: 6 out of 10
2025-03-02 12:04:10,135 - {'epoch': 69, 'rec_loss': '6.6111'}
2025-03-02 12:04:18,074 - {'Epoch': 69, 'HR@5': '0.0889', 'NDCG@5': '0.0637', 'HR@10': '0.1214', 'NDCG@10': '0.0742', 'HR@20': '0.1643', 'NDCG@20': '0.0850'}
2025-03-02 12:04:18,080 - Validation score increased.  Saving model ...
2025-03-02 12:04:47,638 - {'epoch': 70, 'rec_loss': '6.6107'}
2025-03-02 12:04:55,504 - {'Epoch': 70, 'HR@5': '0.0878', 'NDCG@5': '0.0625', 'HR@10': '0.1208', 'NDCG@10': '0.0731', 'HR@20': '0.1652', 'NDCG@20': '0.0843'}
2025-03-02 12:04:55,505 - EarlyStopping counter: 1 out of 10
2025-03-02 12:05:23,670 - {'epoch': 71, 'rec_loss': '6.6112'}
2025-03-02 12:05:31,599 - {'Epoch': 71, 'HR@5': '0.0873', 'NDCG@5': '0.0620', 'HR@10': '0.1200', 'NDCG@10': '0.0724', 'HR@20': '0.1652', 'NDCG@20': '0.0839'}
2025-03-02 12:05:31,600 - EarlyStopping counter: 2 out of 10
2025-03-02 12:06:02,143 - {'epoch': 72, 'rec_loss': '6.6088'}
2025-03-02 12:06:10,405 - {'Epoch': 72, 'HR@5': '0.0885', 'NDCG@5': '0.0635', 'HR@10': '0.1219', 'NDCG@10': '0.0743', 'HR@20': '0.1651', 'NDCG@20': '0.0852'}
2025-03-02 12:06:10,411 - Validation score increased.  Saving model ...
2025-03-02 12:06:38,453 - {'epoch': 73, 'rec_loss': '6.6092'}
2025-03-02 12:06:46,350 - {'Epoch': 73, 'HR@5': '0.0877', 'NDCG@5': '0.0621', 'HR@10': '0.1214', 'NDCG@10': '0.0729', 'HR@20': '0.1650', 'NDCG@20': '0.0839'}
2025-03-02 12:06:46,355 - EarlyStopping counter: 1 out of 10
2025-03-02 12:07:13,934 - {'epoch': 74, 'rec_loss': '6.6087'}
2025-03-02 12:07:21,841 - {'Epoch': 74, 'HR@5': '0.0874', 'NDCG@5': '0.0623', 'HR@10': '0.1202', 'NDCG@10': '0.0729', 'HR@20': '0.1646', 'NDCG@20': '0.0841'}
2025-03-02 12:07:21,846 - EarlyStopping counter: 2 out of 10
2025-03-02 12:07:49,215 - {'epoch': 75, 'rec_loss': '6.6010'}
2025-03-02 12:07:57,108 - {'Epoch': 75, 'HR@5': '0.0871', 'NDCG@5': '0.0625', 'HR@10': '0.1200', 'NDCG@10': '0.0731', 'HR@20': '0.1644', 'NDCG@20': '0.0843'}
2025-03-02 12:07:57,114 - EarlyStopping counter: 3 out of 10
2025-03-02 12:08:24,590 - {'epoch': 76, 'rec_loss': '6.5946'}
2025-03-02 12:08:32,451 - {'Epoch': 76, 'HR@5': '0.0867', 'NDCG@5': '0.0620', 'HR@10': '0.1193', 'NDCG@10': '0.0724', 'HR@20': '0.1633', 'NDCG@20': '0.0835'}
2025-03-02 12:08:32,452 - EarlyStopping counter: 4 out of 10
2025-03-02 12:09:02,487 - {'epoch': 77, 'rec_loss': '6.5919'}
2025-03-02 12:09:10,574 - {'Epoch': 77, 'HR@5': '0.0861', 'NDCG@5': '0.0618', 'HR@10': '0.1206', 'NDCG@10': '0.0729', 'HR@20': '0.1652', 'NDCG@20': '0.0842'}
2025-03-02 12:09:10,575 - EarlyStopping counter: 5 out of 10
2025-03-02 12:09:38,237 - {'epoch': 78, 'rec_loss': '6.5969'}
2025-03-02 12:09:46,145 - {'Epoch': 78, 'HR@5': '0.0895', 'NDCG@5': '0.0639', 'HR@10': '0.1211', 'NDCG@10': '0.0741', 'HR@20': '0.1658', 'NDCG@20': '0.0853'}
2025-03-02 12:09:46,146 - Validation score increased.  Saving model ...
2025-03-02 12:10:14,457 - {'epoch': 79, 'rec_loss': '6.5901'}
2025-03-02 12:10:22,587 - {'Epoch': 79, 'HR@5': '0.0880', 'NDCG@5': '0.0625', 'HR@10': '0.1186', 'NDCG@10': '0.0723', 'HR@20': '0.1654', 'NDCG@20': '0.0841'}
2025-03-02 12:10:22,593 - EarlyStopping counter: 1 out of 10
2025-03-02 12:10:50,540 - {'epoch': 80, 'rec_loss': '6.5820'}
2025-03-02 12:10:58,539 - {'Epoch': 80, 'HR@5': '0.0875', 'NDCG@5': '0.0620', 'HR@10': '0.1200', 'NDCG@10': '0.0724', 'HR@20': '0.1639', 'NDCG@20': '0.0835'}
2025-03-02 12:10:58,540 - EarlyStopping counter: 2 out of 10
2025-03-02 12:11:26,754 - {'epoch': 81, 'rec_loss': '6.5846'}
2025-03-02 12:11:35,003 - {'Epoch': 81, 'HR@5': '0.0879', 'NDCG@5': '0.0626', 'HR@10': '0.1199', 'NDCG@10': '0.0729', 'HR@20': '0.1650', 'NDCG@20': '0.0843'}
2025-03-02 12:11:35,005 - EarlyStopping counter: 3 out of 10
2025-03-02 12:12:03,316 - {'epoch': 82, 'rec_loss': '6.5820'}
2025-03-02 12:12:11,318 - {'Epoch': 82, 'HR@5': '0.0866', 'NDCG@5': '0.0609', 'HR@10': '0.1200', 'NDCG@10': '0.0716', 'HR@20': '0.1629', 'NDCG@20': '0.0824'}
2025-03-02 12:12:11,320 - EarlyStopping counter: 4 out of 10
2025-03-02 12:12:38,400 - {'epoch': 83, 'rec_loss': '6.5722'}
2025-03-02 12:12:46,479 - {'Epoch': 83, 'HR@5': '0.0872', 'NDCG@5': '0.0622', 'HR@10': '0.1207', 'NDCG@10': '0.0730', 'HR@20': '0.1634', 'NDCG@20': '0.0838'}
2025-03-02 12:12:46,480 - EarlyStopping counter: 5 out of 10
2025-03-02 12:13:14,973 - {'epoch': 84, 'rec_loss': '6.5761'}
2025-03-02 12:13:22,892 - {'Epoch': 84, 'HR@5': '0.0874', 'NDCG@5': '0.0626', 'HR@10': '0.1212', 'NDCG@10': '0.0735', 'HR@20': '0.1649', 'NDCG@20': '0.0845'}
2025-03-02 12:13:22,898 - EarlyStopping counter: 6 out of 10
2025-03-02 12:13:51,009 - {'epoch': 85, 'rec_loss': '6.5773'}
2025-03-02 12:13:59,058 - {'Epoch': 85, 'HR@5': '0.0888', 'NDCG@5': '0.0630', 'HR@10': '0.1210', 'NDCG@10': '0.0733', 'HR@20': '0.1650', 'NDCG@20': '0.0844'}
2025-03-02 12:13:59,064 - EarlyStopping counter: 7 out of 10
2025-03-02 12:14:27,455 - {'epoch': 86, 'rec_loss': '6.5747'}
2025-03-02 12:14:35,468 - {'Epoch': 86, 'HR@5': '0.0894', 'NDCG@5': '0.0637', 'HR@10': '0.1210', 'NDCG@10': '0.0738', 'HR@20': '0.1655', 'NDCG@20': '0.0851'}
2025-03-02 12:14:35,473 - EarlyStopping counter: 8 out of 10
2025-03-02 12:15:03,876 - {'epoch': 87, 'rec_loss': '6.5737'}
2025-03-02 12:15:11,947 - {'Epoch': 87, 'HR@5': '0.0880', 'NDCG@5': '0.0630', 'HR@10': '0.1205', 'NDCG@10': '0.0735', 'HR@20': '0.1638', 'NDCG@20': '0.0844'}
2025-03-02 12:15:11,953 - EarlyStopping counter: 9 out of 10
2025-03-02 12:15:40,168 - {'epoch': 88, 'rec_loss': '6.5732'}
2025-03-02 12:15:47,935 - {'Epoch': 88, 'HR@5': '0.0882', 'NDCG@5': '0.0633', 'HR@10': '0.1213', 'NDCG@10': '0.0739', 'HR@20': '0.1636', 'NDCG@20': '0.0845'}
2025-03-02 12:15:47,936 - EarlyStopping counter: 10 out of 10
2025-03-02 12:15:47,936 - Early stopping
2025-03-02 12:15:47,936 - ---------------Test Score---------------
2025-03-02 12:15:55,768 - {'Epoch': 0, 'HR@5': '0.0709', 'NDCG@5': '0.0500', 'HR@10': '0.1003', 'NDCG@10': '0.0594', 'HR@20': '0.1368', 'NDCG@20': '0.0686'}
2025-03-02 12:15:55,773 - Scale_Beauty
2025-03-02 12:15:55,773 - {'Epoch': 0, 'HR@5': '0.0709', 'NDCG@5': '0.0500', 'HR@10': '0.1003', 'NDCG@10': '0.0594', 'HR@20': '0.1368', 'NDCG@20': '0.0686'}
2025-03-02 12:19:58,661 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 12, 24], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-02 12:20:01,508 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-02 12:20:01,513 - Total Parameters: 929445
2025-03-02 12:20:30,425 - {'epoch': 0, 'rec_loss': '8.8350'}
2025-03-02 12:20:38,284 - {'Epoch': 0, 'HR@5': '0.0206', 'NDCG@5': '0.0128', 'HR@10': '0.0310', 'NDCG@10': '0.0162', 'HR@20': '0.0475', 'NDCG@20': '0.0204'}
2025-03-02 12:20:38,285 - Validation score increased.  Saving model ...
2025-03-02 12:21:05,824 - {'epoch': 1, 'rec_loss': '8.3270'}
2025-03-02 12:21:13,885 - {'Epoch': 1, 'HR@5': '0.0373', 'NDCG@5': '0.0251', 'HR@10': '0.0565', 'NDCG@10': '0.0313', 'HR@20': '0.0820', 'NDCG@20': '0.0377'}
2025-03-02 12:21:13,886 - Validation score increased.  Saving model ...
2025-03-02 12:21:41,980 - {'epoch': 2, 'rec_loss': '8.0157'}
2025-03-02 12:21:49,620 - {'Epoch': 2, 'HR@5': '0.0491', 'NDCG@5': '0.0332', 'HR@10': '0.0725', 'NDCG@10': '0.0408', 'HR@20': '0.1047', 'NDCG@20': '0.0488'}
2025-03-02 12:21:49,621 - Validation score increased.  Saving model ...
2025-03-02 12:22:17,664 - {'epoch': 3, 'rec_loss': '7.7994'}
2025-03-02 12:22:25,595 - {'Epoch': 3, 'HR@5': '0.0593', 'NDCG@5': '0.0405', 'HR@10': '0.0855', 'NDCG@10': '0.0489', 'HR@20': '0.1236', 'NDCG@20': '0.0585'}
2025-03-02 12:22:25,596 - Validation score increased.  Saving model ...
2025-03-02 12:22:55,096 - {'epoch': 4, 'rec_loss': '7.6362'}
2025-03-02 12:23:02,681 - {'Epoch': 4, 'HR@5': '0.0683', 'NDCG@5': '0.0474', 'HR@10': '0.0954', 'NDCG@10': '0.0561', 'HR@20': '0.1329', 'NDCG@20': '0.0656'}
2025-03-02 12:23:02,682 - Validation score increased.  Saving model ...
2025-03-02 12:23:30,598 - {'epoch': 5, 'rec_loss': '7.5209'}
2025-03-02 12:23:37,972 - {'Epoch': 5, 'HR@5': '0.0727', 'NDCG@5': '0.0507', 'HR@10': '0.1028', 'NDCG@10': '0.0604', 'HR@20': '0.1402', 'NDCG@20': '0.0698'}
2025-03-02 12:23:37,973 - Validation score increased.  Saving model ...
2025-03-02 12:24:05,675 - {'epoch': 6, 'rec_loss': '7.4235'}
2025-03-02 12:24:13,316 - {'Epoch': 6, 'HR@5': '0.0762', 'NDCG@5': '0.0536', 'HR@10': '0.1052', 'NDCG@10': '0.0629', 'HR@20': '0.1444', 'NDCG@20': '0.0727'}
2025-03-02 12:24:13,317 - Validation score increased.  Saving model ...
2025-03-02 12:24:39,803 - {'epoch': 7, 'rec_loss': '7.3443'}
2025-03-02 12:24:47,520 - {'Epoch': 7, 'HR@5': '0.0803', 'NDCG@5': '0.0563', 'HR@10': '0.1084', 'NDCG@10': '0.0654', 'HR@20': '0.1485', 'NDCG@20': '0.0755'}
2025-03-02 12:24:47,521 - Validation score increased.  Saving model ...
2025-03-02 12:25:15,678 - {'epoch': 8, 'rec_loss': '7.2734'}
2025-03-02 12:25:23,526 - {'Epoch': 8, 'HR@5': '0.0824', 'NDCG@5': '0.0580', 'HR@10': '0.1108', 'NDCG@10': '0.0672', 'HR@20': '0.1504', 'NDCG@20': '0.0771'}
2025-03-02 12:25:23,527 - Validation score increased.  Saving model ...
2025-03-02 12:25:51,232 - {'epoch': 9, 'rec_loss': '7.2248'}
2025-03-02 12:25:59,015 - {'Epoch': 9, 'HR@5': '0.0817', 'NDCG@5': '0.0571', 'HR@10': '0.1130', 'NDCG@10': '0.0672', 'HR@20': '0.1522', 'NDCG@20': '0.0771'}
2025-03-02 12:25:59,016 - EarlyStopping counter: 1 out of 10
2025-03-02 12:26:28,035 - {'epoch': 10, 'rec_loss': '7.1774'}
2025-03-02 12:26:35,731 - {'Epoch': 10, 'HR@5': '0.0831', 'NDCG@5': '0.0589', 'HR@10': '0.1130', 'NDCG@10': '0.0685', 'HR@20': '0.1522', 'NDCG@20': '0.0784'}
2025-03-02 12:26:35,732 - Validation score increased.  Saving model ...
2025-03-02 12:27:03,942 - {'epoch': 11, 'rec_loss': '7.1378'}
2025-03-02 12:27:11,918 - {'Epoch': 11, 'HR@5': '0.0838', 'NDCG@5': '0.0597', 'HR@10': '0.1143', 'NDCG@10': '0.0695', 'HR@20': '0.1543', 'NDCG@20': '0.0796'}
2025-03-02 12:27:11,919 - Validation score increased.  Saving model ...
2025-03-02 12:27:39,628 - {'epoch': 12, 'rec_loss': '7.1009'}
2025-03-02 12:27:47,676 - {'Epoch': 12, 'HR@5': '0.0844', 'NDCG@5': '0.0596', 'HR@10': '0.1148', 'NDCG@10': '0.0694', 'HR@20': '0.1567', 'NDCG@20': '0.0800'}
2025-03-02 12:27:47,677 - Validation score increased.  Saving model ...
2025-03-02 12:28:16,174 - {'epoch': 13, 'rec_loss': '7.0748'}
2025-03-02 12:28:23,697 - {'Epoch': 13, 'HR@5': '0.0845', 'NDCG@5': '0.0595', 'HR@10': '0.1181', 'NDCG@10': '0.0704', 'HR@20': '0.1578', 'NDCG@20': '0.0804'}
2025-03-02 12:28:23,699 - Validation score increased.  Saving model ...
2025-03-02 12:28:52,113 - {'epoch': 14, 'rec_loss': '7.0436'}
2025-03-02 12:29:00,013 - {'Epoch': 14, 'HR@5': '0.0870', 'NDCG@5': '0.0606', 'HR@10': '0.1191', 'NDCG@10': '0.0709', 'HR@20': '0.1601', 'NDCG@20': '0.0812'}
2025-03-02 12:29:00,015 - Validation score increased.  Saving model ...
2025-03-02 12:29:27,564 - {'epoch': 15, 'rec_loss': '7.0238'}
2025-03-02 12:29:35,201 - {'Epoch': 15, 'HR@5': '0.0862', 'NDCG@5': '0.0603', 'HR@10': '0.1189', 'NDCG@10': '0.0709', 'HR@20': '0.1607', 'NDCG@20': '0.0814'}
2025-03-02 12:29:35,202 - Validation score increased.  Saving model ...
2025-03-02 12:30:03,145 - {'epoch': 16, 'rec_loss': '7.0009'}
2025-03-02 12:30:10,856 - {'Epoch': 16, 'HR@5': '0.0870', 'NDCG@5': '0.0607', 'HR@10': '0.1187', 'NDCG@10': '0.0709', 'HR@20': '0.1617', 'NDCG@20': '0.0817'}
2025-03-02 12:30:10,862 - Validation score increased.  Saving model ...
2025-03-02 12:30:38,996 - {'epoch': 17, 'rec_loss': '6.9855'}
2025-03-02 12:30:46,687 - {'Epoch': 17, 'HR@5': '0.0846', 'NDCG@5': '0.0606', 'HR@10': '0.1194', 'NDCG@10': '0.0718', 'HR@20': '0.1619', 'NDCG@20': '0.0825'}
2025-03-02 12:30:46,688 - Validation score increased.  Saving model ...
2025-03-02 12:31:15,855 - {'epoch': 18, 'rec_loss': '6.9527'}
2025-03-02 12:31:23,743 - {'Epoch': 18, 'HR@5': '0.0865', 'NDCG@5': '0.0608', 'HR@10': '0.1188', 'NDCG@10': '0.0711', 'HR@20': '0.1615', 'NDCG@20': '0.0819'}
2025-03-02 12:31:23,744 - EarlyStopping counter: 1 out of 10
2025-03-02 12:31:55,306 - {'epoch': 19, 'rec_loss': '6.9430'}
2025-03-02 12:32:03,170 - {'Epoch': 19, 'HR@5': '0.0864', 'NDCG@5': '0.0615', 'HR@10': '0.1181', 'NDCG@10': '0.0717', 'HR@20': '0.1622', 'NDCG@20': '0.0828'}
2025-03-02 12:32:03,172 - Validation score increased.  Saving model ...
2025-03-02 12:32:33,588 - {'epoch': 20, 'rec_loss': '6.9226'}
2025-03-02 12:32:41,326 - {'Epoch': 20, 'HR@5': '0.0870', 'NDCG@5': '0.0618', 'HR@10': '0.1208', 'NDCG@10': '0.0727', 'HR@20': '0.1632', 'NDCG@20': '0.0833'}
2025-03-02 12:32:41,327 - Validation score increased.  Saving model ...
2025-03-02 12:33:08,488 - {'epoch': 21, 'rec_loss': '6.9137'}
2025-03-02 12:33:16,317 - {'Epoch': 21, 'HR@5': '0.0870', 'NDCG@5': '0.0615', 'HR@10': '0.1207', 'NDCG@10': '0.0724', 'HR@20': '0.1626', 'NDCG@20': '0.0829'}
2025-03-02 12:33:16,318 - EarlyStopping counter: 1 out of 10
2025-03-02 12:33:44,228 - {'epoch': 22, 'rec_loss': '6.9033'}
2025-03-02 12:33:52,058 - {'Epoch': 22, 'HR@5': '0.0874', 'NDCG@5': '0.0618', 'HR@10': '0.1212', 'NDCG@10': '0.0728', 'HR@20': '0.1637', 'NDCG@20': '0.0835'}
2025-03-02 12:33:52,059 - Validation score increased.  Saving model ...
2025-03-02 12:34:20,724 - {'epoch': 23, 'rec_loss': '6.8857'}
2025-03-02 12:34:28,579 - {'Epoch': 23, 'HR@5': '0.0876', 'NDCG@5': '0.0625', 'HR@10': '0.1207', 'NDCG@10': '0.0731', 'HR@20': '0.1627', 'NDCG@20': '0.0837'}
2025-03-02 12:34:28,581 - Validation score increased.  Saving model ...
2025-03-02 12:34:56,304 - {'epoch': 24, 'rec_loss': '6.8785'}
2025-03-02 12:35:04,366 - {'Epoch': 24, 'HR@5': '0.0883', 'NDCG@5': '0.0621', 'HR@10': '0.1204', 'NDCG@10': '0.0724', 'HR@20': '0.1621', 'NDCG@20': '0.0829'}
2025-03-02 12:35:04,367 - EarlyStopping counter: 1 out of 10
2025-03-02 12:35:32,651 - {'epoch': 25, 'rec_loss': '6.8586'}
2025-03-02 12:35:40,361 - {'Epoch': 25, 'HR@5': '0.0872', 'NDCG@5': '0.0614', 'HR@10': '0.1215', 'NDCG@10': '0.0725', 'HR@20': '0.1635', 'NDCG@20': '0.0831'}
2025-03-02 12:35:40,362 - EarlyStopping counter: 2 out of 10
2025-03-02 12:36:08,044 - {'epoch': 26, 'rec_loss': '6.8542'}
2025-03-02 12:36:15,937 - {'Epoch': 26, 'HR@5': '0.0880', 'NDCG@5': '0.0621', 'HR@10': '0.1212', 'NDCG@10': '0.0728', 'HR@20': '0.1633', 'NDCG@20': '0.0834'}
2025-03-02 12:36:15,938 - EarlyStopping counter: 3 out of 10
2025-03-02 12:36:43,559 - {'epoch': 27, 'rec_loss': '6.8387'}
2025-03-02 12:36:51,350 - {'Epoch': 27, 'HR@5': '0.0872', 'NDCG@5': '0.0620', 'HR@10': '0.1202', 'NDCG@10': '0.0726', 'HR@20': '0.1621', 'NDCG@20': '0.0831'}
2025-03-02 12:36:51,352 - EarlyStopping counter: 4 out of 10
2025-03-02 12:37:19,273 - {'epoch': 28, 'rec_loss': '6.8344'}
2025-03-02 12:37:26,977 - {'Epoch': 28, 'HR@5': '0.0882', 'NDCG@5': '0.0620', 'HR@10': '0.1213', 'NDCG@10': '0.0727', 'HR@20': '0.1625', 'NDCG@20': '0.0830'}
2025-03-02 12:37:26,978 - EarlyStopping counter: 5 out of 10
2025-03-02 12:37:56,387 - {'epoch': 29, 'rec_loss': '6.8260'}
2025-03-02 12:38:03,974 - {'Epoch': 29, 'HR@5': '0.0867', 'NDCG@5': '0.0608', 'HR@10': '0.1210', 'NDCG@10': '0.0719', 'HR@20': '0.1637', 'NDCG@20': '0.0826'}
2025-03-02 12:38:03,979 - EarlyStopping counter: 6 out of 10
2025-03-02 12:38:31,441 - {'epoch': 30, 'rec_loss': '6.8153'}
2025-03-02 12:38:39,077 - {'Epoch': 30, 'HR@5': '0.0876', 'NDCG@5': '0.0619', 'HR@10': '0.1205', 'NDCG@10': '0.0724', 'HR@20': '0.1646', 'NDCG@20': '0.0836'}
2025-03-02 12:38:39,079 - EarlyStopping counter: 7 out of 10
2025-03-02 12:39:06,297 - {'epoch': 31, 'rec_loss': '6.8012'}
2025-03-02 12:39:14,242 - {'Epoch': 31, 'HR@5': '0.0882', 'NDCG@5': '0.0625', 'HR@10': '0.1206', 'NDCG@10': '0.0730', 'HR@20': '0.1645', 'NDCG@20': '0.0840'}
2025-03-02 12:39:14,243 - Validation score increased.  Saving model ...
2025-03-02 12:39:43,057 - {'epoch': 32, 'rec_loss': '6.7974'}
2025-03-02 12:39:51,270 - {'Epoch': 32, 'HR@5': '0.0889', 'NDCG@5': '0.0629', 'HR@10': '0.1221', 'NDCG@10': '0.0736', 'HR@20': '0.1637', 'NDCG@20': '0.0840'}
2025-03-02 12:39:51,273 - Validation score increased.  Saving model ...
2025-03-02 12:40:19,650 - {'epoch': 33, 'rec_loss': '6.7953'}
2025-03-02 12:40:28,071 - {'Epoch': 33, 'HR@5': '0.0886', 'NDCG@5': '0.0630', 'HR@10': '0.1194', 'NDCG@10': '0.0729', 'HR@20': '0.1620', 'NDCG@20': '0.0836'}
2025-03-02 12:40:28,072 - EarlyStopping counter: 1 out of 10
2025-03-02 12:40:55,233 - {'epoch': 34, 'rec_loss': '6.7779'}
2025-03-02 12:41:03,350 - {'Epoch': 34, 'HR@5': '0.0888', 'NDCG@5': '0.0626', 'HR@10': '0.1204', 'NDCG@10': '0.0727', 'HR@20': '0.1622', 'NDCG@20': '0.0833'}
2025-03-02 12:41:03,352 - EarlyStopping counter: 2 out of 10
2025-03-02 12:41:31,093 - {'epoch': 35, 'rec_loss': '6.7745'}
2025-03-02 12:41:39,037 - {'Epoch': 35, 'HR@5': '0.0869', 'NDCG@5': '0.0612', 'HR@10': '0.1186', 'NDCG@10': '0.0714', 'HR@20': '0.1641', 'NDCG@20': '0.0829'}
2025-03-02 12:41:39,042 - EarlyStopping counter: 3 out of 10
2025-03-02 12:42:06,650 - {'epoch': 36, 'rec_loss': '6.7662'}
2025-03-02 12:42:15,034 - {'Epoch': 36, 'HR@5': '0.0871', 'NDCG@5': '0.0623', 'HR@10': '0.1217', 'NDCG@10': '0.0734', 'HR@20': '0.1632', 'NDCG@20': '0.0839'}
2025-03-02 12:42:15,035 - EarlyStopping counter: 4 out of 10
2025-03-02 12:42:42,861 - {'epoch': 37, 'rec_loss': '6.7502'}
2025-03-02 12:42:50,847 - {'Epoch': 37, 'HR@5': '0.0866', 'NDCG@5': '0.0614', 'HR@10': '0.1214', 'NDCG@10': '0.0726', 'HR@20': '0.1653', 'NDCG@20': '0.0837'}
2025-03-02 12:42:50,848 - EarlyStopping counter: 5 out of 10
2025-03-02 12:43:20,003 - {'epoch': 38, 'rec_loss': '6.7523'}
2025-03-02 12:43:28,105 - {'Epoch': 38, 'HR@5': '0.0872', 'NDCG@5': '0.0617', 'HR@10': '0.1210', 'NDCG@10': '0.0726', 'HR@20': '0.1641', 'NDCG@20': '0.0835'}
2025-03-02 12:43:28,106 - EarlyStopping counter: 6 out of 10
2025-03-02 12:43:57,291 - {'epoch': 39, 'rec_loss': '6.7451'}
2025-03-02 12:44:05,536 - {'Epoch': 39, 'HR@5': '0.0851', 'NDCG@5': '0.0604', 'HR@10': '0.1189', 'NDCG@10': '0.0713', 'HR@20': '0.1619', 'NDCG@20': '0.0821'}
2025-03-02 12:44:05,537 - EarlyStopping counter: 7 out of 10
2025-03-02 12:44:31,679 - {'epoch': 40, 'rec_loss': '6.7463'}
2025-03-02 12:44:39,920 - {'Epoch': 40, 'HR@5': '0.0866', 'NDCG@5': '0.0615', 'HR@10': '0.1212', 'NDCG@10': '0.0727', 'HR@20': '0.1643', 'NDCG@20': '0.0835'}
2025-03-02 12:44:39,921 - EarlyStopping counter: 8 out of 10
2025-03-02 12:45:07,486 - {'epoch': 41, 'rec_loss': '6.7344'}
2025-03-02 12:45:15,272 - {'Epoch': 41, 'HR@5': '0.0881', 'NDCG@5': '0.0626', 'HR@10': '0.1204', 'NDCG@10': '0.0730', 'HR@20': '0.1643', 'NDCG@20': '0.0841'}
2025-03-02 12:45:15,274 - Validation score increased.  Saving model ...
2025-03-02 12:45:44,259 - {'epoch': 42, 'rec_loss': '6.7307'}
2025-03-02 12:45:52,193 - {'Epoch': 42, 'HR@5': '0.0891', 'NDCG@5': '0.0631', 'HR@10': '0.1205', 'NDCG@10': '0.0732', 'HR@20': '0.1645', 'NDCG@20': '0.0843'}
2025-03-02 12:45:52,194 - Validation score increased.  Saving model ...
2025-03-02 12:46:21,129 - {'epoch': 43, 'rec_loss': '6.7178'}
2025-03-02 12:46:29,012 - {'Epoch': 43, 'HR@5': '0.0888', 'NDCG@5': '0.0620', 'HR@10': '0.1199', 'NDCG@10': '0.0721', 'HR@20': '0.1636', 'NDCG@20': '0.0831'}
2025-03-02 12:46:29,013 - EarlyStopping counter: 1 out of 10
2025-03-02 12:46:56,346 - {'epoch': 44, 'rec_loss': '6.7185'}
2025-03-02 12:47:04,269 - {'Epoch': 44, 'HR@5': '0.0874', 'NDCG@5': '0.0620', 'HR@10': '0.1201', 'NDCG@10': '0.0726', 'HR@20': '0.1631', 'NDCG@20': '0.0834'}
2025-03-02 12:47:04,270 - EarlyStopping counter: 2 out of 10
2025-03-02 12:47:32,037 - {'epoch': 45, 'rec_loss': '6.7126'}
2025-03-02 12:47:40,301 - {'Epoch': 45, 'HR@5': '0.0885', 'NDCG@5': '0.0625', 'HR@10': '0.1207', 'NDCG@10': '0.0728', 'HR@20': '0.1649', 'NDCG@20': '0.0840'}
2025-03-02 12:47:40,303 - EarlyStopping counter: 3 out of 10
2025-03-02 12:48:07,930 - {'epoch': 46, 'rec_loss': '6.7029'}
2025-03-02 12:48:15,654 - {'Epoch': 46, 'HR@5': '0.0889', 'NDCG@5': '0.0632', 'HR@10': '0.1216', 'NDCG@10': '0.0737', 'HR@20': '0.1657', 'NDCG@20': '0.0848'}
2025-03-02 12:48:15,655 - Validation score increased.  Saving model ...
2025-03-02 12:48:42,335 - {'epoch': 47, 'rec_loss': '6.6975'}
2025-03-02 12:48:50,363 - {'Epoch': 47, 'HR@5': '0.0876', 'NDCG@5': '0.0622', 'HR@10': '0.1205', 'NDCG@10': '0.0727', 'HR@20': '0.1638', 'NDCG@20': '0.0836'}
2025-03-02 12:48:50,364 - EarlyStopping counter: 1 out of 10
2025-03-02 12:49:17,591 - {'epoch': 48, 'rec_loss': '6.6957'}
2025-03-02 12:49:25,583 - {'Epoch': 48, 'HR@5': '0.0871', 'NDCG@5': '0.0620', 'HR@10': '0.1210', 'NDCG@10': '0.0729', 'HR@20': '0.1644', 'NDCG@20': '0.0839'}
2025-03-02 12:49:25,584 - EarlyStopping counter: 2 out of 10
2025-03-02 12:49:53,297 - {'epoch': 49, 'rec_loss': '6.6874'}
2025-03-02 12:50:01,321 - {'Epoch': 49, 'HR@5': '0.0873', 'NDCG@5': '0.0618', 'HR@10': '0.1201', 'NDCG@10': '0.0724', 'HR@20': '0.1642', 'NDCG@20': '0.0835'}
2025-03-02 12:50:01,322 - EarlyStopping counter: 3 out of 10
2025-03-02 12:50:26,962 - {'epoch': 50, 'rec_loss': '6.6894'}
2025-03-02 12:50:34,865 - {'Epoch': 50, 'HR@5': '0.0893', 'NDCG@5': '0.0629', 'HR@10': '0.1210', 'NDCG@10': '0.0731', 'HR@20': '0.1640', 'NDCG@20': '0.0839'}
2025-03-02 12:50:34,867 - EarlyStopping counter: 4 out of 10
2025-03-02 12:51:02,836 - {'epoch': 51, 'rec_loss': '6.6835'}
2025-03-02 12:51:10,744 - {'Epoch': 51, 'HR@5': '0.0874', 'NDCG@5': '0.0623', 'HR@10': '0.1195', 'NDCG@10': '0.0727', 'HR@20': '0.1652', 'NDCG@20': '0.0842'}
2025-03-02 12:51:10,745 - EarlyStopping counter: 5 out of 10
2025-03-02 12:51:38,485 - {'epoch': 52, 'rec_loss': '6.6734'}
2025-03-02 12:51:46,752 - {'Epoch': 52, 'HR@5': '0.0865', 'NDCG@5': '0.0620', 'HR@10': '0.1195', 'NDCG@10': '0.0726', 'HR@20': '0.1642', 'NDCG@20': '0.0838'}
2025-03-02 12:51:46,753 - EarlyStopping counter: 6 out of 10
2025-03-02 12:52:14,876 - {'epoch': 53, 'rec_loss': '6.6760'}
2025-03-02 12:52:22,736 - {'Epoch': 53, 'HR@5': '0.0878', 'NDCG@5': '0.0625', 'HR@10': '0.1222', 'NDCG@10': '0.0736', 'HR@20': '0.1646', 'NDCG@20': '0.0843'}
2025-03-02 12:52:22,737 - EarlyStopping counter: 7 out of 10
2025-03-02 12:52:50,867 - {'epoch': 54, 'rec_loss': '6.6688'}
2025-03-02 12:52:58,660 - {'Epoch': 54, 'HR@5': '0.0886', 'NDCG@5': '0.0627', 'HR@10': '0.1205', 'NDCG@10': '0.0729', 'HR@20': '0.1634', 'NDCG@20': '0.0837'}
2025-03-02 12:52:58,661 - EarlyStopping counter: 8 out of 10
2025-03-02 12:53:26,324 - {'epoch': 55, 'rec_loss': '6.6651'}
2025-03-02 12:53:34,316 - {'Epoch': 55, 'HR@5': '0.0880', 'NDCG@5': '0.0630', 'HR@10': '0.1210', 'NDCG@10': '0.0736', 'HR@20': '0.1646', 'NDCG@20': '0.0846'}
2025-03-02 12:53:34,317 - EarlyStopping counter: 9 out of 10
2025-03-02 12:54:02,141 - {'epoch': 56, 'rec_loss': '6.6614'}
2025-03-02 12:54:09,914 - {'Epoch': 56, 'HR@5': '0.0884', 'NDCG@5': '0.0631', 'HR@10': '0.1202', 'NDCG@10': '0.0733', 'HR@20': '0.1638', 'NDCG@20': '0.0843'}
2025-03-02 12:54:09,915 - EarlyStopping counter: 10 out of 10
2025-03-02 12:54:09,916 - Early stopping
2025-03-02 12:54:09,916 - ---------------Test Score---------------
2025-03-02 12:54:17,654 - {'Epoch': 0, 'HR@5': '0.0720', 'NDCG@5': '0.0519', 'HR@10': '0.0983', 'NDCG@10': '0.0604', 'HR@20': '0.1369', 'NDCG@20': '0.0701'}
2025-03-02 12:54:17,655 - Scale_Beauty
2025-03-02 12:54:17,655 - {'Epoch': 0, 'HR@5': '0.0720', 'NDCG@5': '0.0519', 'HR@10': '0.0983', 'NDCG@10': '0.0604', 'HR@20': '0.1369', 'NDCG@20': '0.0701'}
2025-03-02 13:15:56,404 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25, 10], kernels=[8, 12, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-02 13:15:59,269 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-02 13:15:59,274 - Total Parameters: 928470
2025-03-02 13:16:36,275 - {'epoch': 0, 'rec_loss': '8.8088'}
2025-03-02 13:16:44,949 - {'Epoch': 0, 'HR@5': '0.0241', 'NDCG@5': '0.0157', 'HR@10': '0.0369', 'NDCG@10': '0.0198', 'HR@20': '0.0554', 'NDCG@20': '0.0245'}
2025-03-02 13:16:44,952 - Validation score increased.  Saving model ...
2025-03-02 13:17:22,760 - {'epoch': 1, 'rec_loss': '8.2340'}
2025-03-02 13:17:31,340 - {'Epoch': 1, 'HR@5': '0.0419', 'NDCG@5': '0.0282', 'HR@10': '0.0636', 'NDCG@10': '0.0352', 'HR@20': '0.0913', 'NDCG@20': '0.0421'}
2025-03-02 13:17:31,345 - Validation score increased.  Saving model ...
2025-03-02 13:18:10,395 - {'epoch': 2, 'rec_loss': '7.9210'}
2025-03-02 13:18:18,975 - {'Epoch': 2, 'HR@5': '0.0578', 'NDCG@5': '0.0400', 'HR@10': '0.0821', 'NDCG@10': '0.0478', 'HR@20': '0.1158', 'NDCG@20': '0.0562'}
2025-03-02 13:18:18,980 - Validation score increased.  Saving model ...
2025-03-02 13:18:56,253 - {'epoch': 3, 'rec_loss': '7.6977'}
2025-03-02 13:19:04,676 - {'Epoch': 3, 'HR@5': '0.0669', 'NDCG@5': '0.0463', 'HR@10': '0.0961', 'NDCG@10': '0.0557', 'HR@20': '0.1337', 'NDCG@20': '0.0652'}
2025-03-02 13:19:04,680 - Validation score increased.  Saving model ...
2025-03-02 13:19:41,000 - {'epoch': 4, 'rec_loss': '7.5323'}
2025-03-02 13:19:49,501 - {'Epoch': 4, 'HR@5': '0.0729', 'NDCG@5': '0.0508', 'HR@10': '0.1025', 'NDCG@10': '0.0603', 'HR@20': '0.1407', 'NDCG@20': '0.0699'}
2025-03-02 13:19:49,502 - Validation score increased.  Saving model ...
2025-03-02 13:20:24,149 - {'epoch': 5, 'rec_loss': '7.4047'}
2025-03-02 13:20:32,334 - {'Epoch': 5, 'HR@5': '0.0766', 'NDCG@5': '0.0542', 'HR@10': '0.1054', 'NDCG@10': '0.0635', 'HR@20': '0.1437', 'NDCG@20': '0.0731'}
2025-03-02 13:20:32,336 - Validation score increased.  Saving model ...
2025-03-02 13:21:06,606 - {'epoch': 6, 'rec_loss': '7.3067'}
2025-03-02 13:21:14,901 - {'Epoch': 6, 'HR@5': '0.0791', 'NDCG@5': '0.0549', 'HR@10': '0.1083', 'NDCG@10': '0.0642', 'HR@20': '0.1485', 'NDCG@20': '0.0744'}
2025-03-02 13:21:14,906 - Validation score increased.  Saving model ...
2025-03-02 13:21:51,160 - {'epoch': 7, 'rec_loss': '7.2247'}
2025-03-02 13:21:59,438 - {'Epoch': 7, 'HR@5': '0.0799', 'NDCG@5': '0.0561', 'HR@10': '0.1099', 'NDCG@10': '0.0658', 'HR@20': '0.1502', 'NDCG@20': '0.0759'}
2025-03-02 13:21:59,439 - Validation score increased.  Saving model ...
2025-03-02 13:22:36,904 - {'epoch': 8, 'rec_loss': '7.1654'}
2025-03-02 13:22:45,439 - {'Epoch': 8, 'HR@5': '0.0832', 'NDCG@5': '0.0586', 'HR@10': '0.1140', 'NDCG@10': '0.0685', 'HR@20': '0.1536', 'NDCG@20': '0.0785'}
2025-03-02 13:22:45,441 - Validation score increased.  Saving model ...
2025-03-02 13:23:20,744 - {'epoch': 9, 'rec_loss': '7.1145'}
2025-03-02 13:23:29,175 - {'Epoch': 9, 'HR@5': '0.0818', 'NDCG@5': '0.0587', 'HR@10': '0.1111', 'NDCG@10': '0.0681', 'HR@20': '0.1531', 'NDCG@20': '0.0787'}
2025-03-02 13:23:29,177 - Validation score increased.  Saving model ...
2025-03-02 13:24:03,490 - {'epoch': 10, 'rec_loss': '7.0688'}
2025-03-02 13:24:12,135 - {'Epoch': 10, 'HR@5': '0.0843', 'NDCG@5': '0.0602', 'HR@10': '0.1164', 'NDCG@10': '0.0706', 'HR@20': '0.1553', 'NDCG@20': '0.0803'}
2025-03-02 13:24:12,136 - Validation score increased.  Saving model ...
2025-03-02 13:24:48,392 - {'epoch': 11, 'rec_loss': '7.0346'}
2025-03-02 13:24:56,845 - {'Epoch': 11, 'HR@5': '0.0855', 'NDCG@5': '0.0602', 'HR@10': '0.1168', 'NDCG@10': '0.0702', 'HR@20': '0.1577', 'NDCG@20': '0.0805'}
2025-03-02 13:24:56,850 - Validation score increased.  Saving model ...
2025-03-02 13:25:35,451 - {'epoch': 12, 'rec_loss': '6.9996'}
2025-03-02 13:25:44,378 - {'Epoch': 12, 'HR@5': '0.0857', 'NDCG@5': '0.0611', 'HR@10': '0.1146', 'NDCG@10': '0.0704', 'HR@20': '0.1570', 'NDCG@20': '0.0810'}
2025-03-02 13:25:44,383 - Validation score increased.  Saving model ...
2025-03-02 13:26:19,878 - {'epoch': 13, 'rec_loss': '6.9690'}
2025-03-02 13:26:28,242 - {'Epoch': 13, 'HR@5': '0.0838', 'NDCG@5': '0.0593', 'HR@10': '0.1162', 'NDCG@10': '0.0697', 'HR@20': '0.1599', 'NDCG@20': '0.0807'}
2025-03-02 13:26:28,247 - EarlyStopping counter: 1 out of 10
2025-03-02 13:27:04,936 - {'epoch': 14, 'rec_loss': '6.9448'}
2025-03-02 13:27:13,216 - {'Epoch': 14, 'HR@5': '0.0839', 'NDCG@5': '0.0596', 'HR@10': '0.1156', 'NDCG@10': '0.0697', 'HR@20': '0.1571', 'NDCG@20': '0.0802'}
2025-03-02 13:27:13,221 - EarlyStopping counter: 2 out of 10
2025-03-02 13:27:47,308 - {'epoch': 15, 'rec_loss': '6.9214'}
2025-03-02 13:27:55,713 - {'Epoch': 15, 'HR@5': '0.0857', 'NDCG@5': '0.0604', 'HR@10': '0.1173', 'NDCG@10': '0.0705', 'HR@20': '0.1578', 'NDCG@20': '0.0807'}
2025-03-02 13:27:55,714 - EarlyStopping counter: 3 out of 10
2025-03-02 13:28:33,244 - {'epoch': 16, 'rec_loss': '6.8986'}
2025-03-02 13:28:41,645 - {'Epoch': 16, 'HR@5': '0.0851', 'NDCG@5': '0.0599', 'HR@10': '0.1176', 'NDCG@10': '0.0704', 'HR@20': '0.1578', 'NDCG@20': '0.0805'}
2025-03-02 13:28:41,650 - EarlyStopping counter: 4 out of 10
2025-03-02 13:29:17,236 - {'epoch': 17, 'rec_loss': '6.8835'}
2025-03-02 13:29:25,610 - {'Epoch': 17, 'HR@5': '0.0844', 'NDCG@5': '0.0597', 'HR@10': '0.1185', 'NDCG@10': '0.0707', 'HR@20': '0.1587', 'NDCG@20': '0.0807'}
2025-03-02 13:29:25,612 - EarlyStopping counter: 5 out of 10
2025-03-02 13:30:02,227 - {'epoch': 18, 'rec_loss': '6.8643'}
2025-03-02 13:30:10,627 - {'Epoch': 18, 'HR@5': '0.0857', 'NDCG@5': '0.0609', 'HR@10': '0.1192', 'NDCG@10': '0.0716', 'HR@20': '0.1604', 'NDCG@20': '0.0820'}
2025-03-02 13:30:10,632 - Validation score increased.  Saving model ...
2025-03-02 13:30:47,111 - {'epoch': 19, 'rec_loss': '6.8469'}
2025-03-02 13:30:55,492 - {'Epoch': 19, 'HR@5': '0.0848', 'NDCG@5': '0.0608', 'HR@10': '0.1184', 'NDCG@10': '0.0716', 'HR@20': '0.1603', 'NDCG@20': '0.0822'}
2025-03-02 13:30:55,497 - Validation score increased.  Saving model ...
2025-03-02 13:31:32,365 - {'epoch': 20, 'rec_loss': '6.8300'}
2025-03-02 13:31:40,764 - {'Epoch': 20, 'HR@5': '0.0860', 'NDCG@5': '0.0613', 'HR@10': '0.1192', 'NDCG@10': '0.0719', 'HR@20': '0.1608', 'NDCG@20': '0.0824'}
2025-03-02 13:31:40,765 - Validation score increased.  Saving model ...
2025-03-02 13:32:15,332 - {'epoch': 21, 'rec_loss': '6.8178'}
2025-03-02 13:32:23,667 - {'Epoch': 21, 'HR@5': '0.0846', 'NDCG@5': '0.0605', 'HR@10': '0.1182', 'NDCG@10': '0.0713', 'HR@20': '0.1600', 'NDCG@20': '0.0818'}
2025-03-02 13:32:23,672 - EarlyStopping counter: 1 out of 10
2025-03-02 13:32:57,063 - {'epoch': 22, 'rec_loss': '6.8035'}
2025-03-02 13:33:05,429 - {'Epoch': 22, 'HR@5': '0.0850', 'NDCG@5': '0.0606', 'HR@10': '0.1191', 'NDCG@10': '0.0715', 'HR@20': '0.1603', 'NDCG@20': '0.0819'}
2025-03-02 13:33:05,434 - EarlyStopping counter: 2 out of 10
2025-03-02 13:33:45,319 - {'epoch': 23, 'rec_loss': '6.7900'}
2025-03-02 13:33:53,662 - {'Epoch': 23, 'HR@5': '0.0855', 'NDCG@5': '0.0605', 'HR@10': '0.1194', 'NDCG@10': '0.0714', 'HR@20': '0.1600', 'NDCG@20': '0.0816'}
2025-03-02 13:33:53,666 - EarlyStopping counter: 3 out of 10
2025-03-02 13:34:28,649 - {'epoch': 24, 'rec_loss': '6.7743'}
2025-03-02 13:34:37,126 - {'Epoch': 24, 'HR@5': '0.0863', 'NDCG@5': '0.0608', 'HR@10': '0.1208', 'NDCG@10': '0.0719', 'HR@20': '0.1628', 'NDCG@20': '0.0824'}
2025-03-02 13:34:37,127 - Validation score increased.  Saving model ...
2025-03-02 13:35:10,103 - {'epoch': 25, 'rec_loss': '6.7619'}
2025-03-02 13:35:18,406 - {'Epoch': 25, 'HR@5': '0.0861', 'NDCG@5': '0.0609', 'HR@10': '0.1207', 'NDCG@10': '0.0721', 'HR@20': '0.1621', 'NDCG@20': '0.0825'}
2025-03-02 13:35:18,407 - Validation score increased.  Saving model ...
2025-03-02 13:35:53,518 - {'epoch': 26, 'rec_loss': '6.7595'}
2025-03-02 13:36:01,768 - {'Epoch': 26, 'HR@5': '0.0878', 'NDCG@5': '0.0622', 'HR@10': '0.1189', 'NDCG@10': '0.0722', 'HR@20': '0.1621', 'NDCG@20': '0.0831'}
2025-03-02 13:36:01,770 - Validation score increased.  Saving model ...
2025-03-02 13:36:37,970 - {'epoch': 27, 'rec_loss': '6.7382'}
2025-03-02 13:36:46,354 - {'Epoch': 27, 'HR@5': '0.0874', 'NDCG@5': '0.0609', 'HR@10': '0.1202', 'NDCG@10': '0.0714', 'HR@20': '0.1617', 'NDCG@20': '0.0818'}
2025-03-02 13:36:46,359 - EarlyStopping counter: 1 out of 10
2025-03-02 13:37:24,590 - {'epoch': 28, 'rec_loss': '6.7318'}
2025-03-02 13:37:33,018 - {'Epoch': 28, 'HR@5': '0.0851', 'NDCG@5': '0.0603', 'HR@10': '0.1196', 'NDCG@10': '0.0715', 'HR@20': '0.1626', 'NDCG@20': '0.0823'}
2025-03-02 13:37:33,024 - EarlyStopping counter: 2 out of 10
2025-03-02 13:38:08,453 - {'epoch': 29, 'rec_loss': '6.7194'}
2025-03-02 13:38:16,894 - {'Epoch': 29, 'HR@5': '0.0867', 'NDCG@5': '0.0613', 'HR@10': '0.1211', 'NDCG@10': '0.0724', 'HR@20': '0.1631', 'NDCG@20': '0.0830'}
2025-03-02 13:38:16,899 - EarlyStopping counter: 3 out of 10
2025-03-02 13:38:52,750 - {'epoch': 30, 'rec_loss': '6.7150'}
2025-03-02 13:39:01,130 - {'Epoch': 30, 'HR@5': '0.0864', 'NDCG@5': '0.0609', 'HR@10': '0.1195', 'NDCG@10': '0.0716', 'HR@20': '0.1621', 'NDCG@20': '0.0823'}
2025-03-02 13:39:01,132 - EarlyStopping counter: 4 out of 10
2025-03-02 13:39:35,831 - {'epoch': 31, 'rec_loss': '6.7048'}
2025-03-02 13:39:44,224 - {'Epoch': 31, 'HR@5': '0.0861', 'NDCG@5': '0.0612', 'HR@10': '0.1201', 'NDCG@10': '0.0722', 'HR@20': '0.1629', 'NDCG@20': '0.0830'}
2025-03-02 13:39:44,226 - EarlyStopping counter: 5 out of 10
2025-03-02 13:40:20,357 - {'epoch': 32, 'rec_loss': '6.6947'}
2025-03-02 13:40:28,454 - {'Epoch': 32, 'HR@5': '0.0855', 'NDCG@5': '0.0600', 'HR@10': '0.1192', 'NDCG@10': '0.0708', 'HR@20': '0.1619', 'NDCG@20': '0.0816'}
2025-03-02 13:40:28,455 - EarlyStopping counter: 6 out of 10
2025-03-02 13:41:03,539 - {'epoch': 33, 'rec_loss': '6.6900'}
2025-03-02 13:41:12,302 - {'Epoch': 33, 'HR@5': '0.0858', 'NDCG@5': '0.0608', 'HR@10': '0.1193', 'NDCG@10': '0.0716', 'HR@20': '0.1613', 'NDCG@20': '0.0821'}
2025-03-02 13:41:12,306 - EarlyStopping counter: 7 out of 10
2025-03-02 13:41:51,851 - {'epoch': 34, 'rec_loss': '6.6830'}
2025-03-02 13:42:00,217 - {'Epoch': 34, 'HR@5': '0.0888', 'NDCG@5': '0.0622', 'HR@10': '0.1209', 'NDCG@10': '0.0726', 'HR@20': '0.1640', 'NDCG@20': '0.0834'}
2025-03-02 13:42:00,221 - Validation score increased.  Saving model ...
2025-03-02 13:42:37,891 - {'epoch': 35, 'rec_loss': '6.6682'}
2025-03-02 13:42:46,431 - {'Epoch': 35, 'HR@5': '0.0872', 'NDCG@5': '0.0615', 'HR@10': '0.1204', 'NDCG@10': '0.0721', 'HR@20': '0.1620', 'NDCG@20': '0.0827'}
2025-03-02 13:42:46,432 - EarlyStopping counter: 1 out of 10
2025-03-02 13:43:25,670 - {'epoch': 36, 'rec_loss': '6.6665'}
2025-03-02 13:43:33,980 - {'Epoch': 36, 'HR@5': '0.0858', 'NDCG@5': '0.0605', 'HR@10': '0.1199', 'NDCG@10': '0.0715', 'HR@20': '0.1621', 'NDCG@20': '0.0821'}
2025-03-02 13:43:33,981 - EarlyStopping counter: 2 out of 10
2025-03-02 13:44:11,349 - {'epoch': 37, 'rec_loss': '6.6571'}
2025-03-02 13:44:19,827 - {'Epoch': 37, 'HR@5': '0.0868', 'NDCG@5': '0.0610', 'HR@10': '0.1219', 'NDCG@10': '0.0724', 'HR@20': '0.1635', 'NDCG@20': '0.0828'}
2025-03-02 13:44:19,832 - EarlyStopping counter: 3 out of 10
2025-03-02 13:44:56,569 - {'epoch': 38, 'rec_loss': '6.6479'}
2025-03-02 13:45:04,977 - {'Epoch': 38, 'HR@5': '0.0872', 'NDCG@5': '0.0611', 'HR@10': '0.1219', 'NDCG@10': '0.0723', 'HR@20': '0.1649', 'NDCG@20': '0.0831'}
2025-03-02 13:45:04,979 - EarlyStopping counter: 4 out of 10
2025-03-02 13:45:39,870 - {'epoch': 39, 'rec_loss': '6.6417'}
2025-03-02 13:45:48,450 - {'Epoch': 39, 'HR@5': '0.0874', 'NDCG@5': '0.0615', 'HR@10': '0.1225', 'NDCG@10': '0.0728', 'HR@20': '0.1637', 'NDCG@20': '0.0831'}
2025-03-02 13:45:48,452 - EarlyStopping counter: 5 out of 10
2025-03-02 13:46:24,003 - {'epoch': 40, 'rec_loss': '6.6337'}
2025-03-02 13:46:32,305 - {'Epoch': 40, 'HR@5': '0.0864', 'NDCG@5': '0.0609', 'HR@10': '0.1210', 'NDCG@10': '0.0721', 'HR@20': '0.1640', 'NDCG@20': '0.0830'}
2025-03-02 13:46:32,307 - EarlyStopping counter: 6 out of 10
2025-03-02 13:47:05,002 - {'epoch': 41, 'rec_loss': '6.6284'}
2025-03-02 13:47:13,512 - {'Epoch': 41, 'HR@5': '0.0855', 'NDCG@5': '0.0604', 'HR@10': '0.1216', 'NDCG@10': '0.0721', 'HR@20': '0.1642', 'NDCG@20': '0.0827'}
2025-03-02 13:47:13,517 - EarlyStopping counter: 7 out of 10
2025-03-02 13:47:48,426 - {'epoch': 42, 'rec_loss': '6.6273'}
2025-03-02 13:47:56,831 - {'Epoch': 42, 'HR@5': '0.0876', 'NDCG@5': '0.0615', 'HR@10': '0.1213', 'NDCG@10': '0.0723', 'HR@20': '0.1638', 'NDCG@20': '0.0831'}
2025-03-02 13:47:56,836 - EarlyStopping counter: 8 out of 10
2025-03-02 13:48:33,211 - {'epoch': 43, 'rec_loss': '6.6194'}
2025-03-02 13:48:41,612 - {'Epoch': 43, 'HR@5': '0.0880', 'NDCG@5': '0.0620', 'HR@10': '0.1217', 'NDCG@10': '0.0728', 'HR@20': '0.1641', 'NDCG@20': '0.0835'}
2025-03-02 13:48:41,614 - Validation score increased.  Saving model ...
2025-03-02 13:49:15,399 - {'epoch': 44, 'rec_loss': '6.6148'}
2025-03-02 13:49:23,811 - {'Epoch': 44, 'HR@5': '0.0864', 'NDCG@5': '0.0614', 'HR@10': '0.1215', 'NDCG@10': '0.0727', 'HR@20': '0.1643', 'NDCG@20': '0.0835'}
2025-03-02 13:49:23,813 - EarlyStopping counter: 1 out of 10
2025-03-02 13:49:57,811 - {'epoch': 45, 'rec_loss': '6.6090'}
2025-03-02 13:50:06,267 - {'Epoch': 45, 'HR@5': '0.0880', 'NDCG@5': '0.0621', 'HR@10': '0.1222', 'NDCG@10': '0.0731', 'HR@20': '0.1637', 'NDCG@20': '0.0836'}
2025-03-02 13:50:06,273 - Validation score increased.  Saving model ...
2025-03-02 13:50:41,687 - {'epoch': 46, 'rec_loss': '6.6030'}
2025-03-02 13:50:50,068 - {'Epoch': 46, 'HR@5': '0.0868', 'NDCG@5': '0.0613', 'HR@10': '0.1196', 'NDCG@10': '0.0719', 'HR@20': '0.1625', 'NDCG@20': '0.0827'}
2025-03-02 13:50:50,073 - EarlyStopping counter: 1 out of 10
2025-03-02 13:51:26,002 - {'epoch': 47, 'rec_loss': '6.6001'}
2025-03-02 13:51:34,466 - {'Epoch': 47, 'HR@5': '0.0862', 'NDCG@5': '0.0603', 'HR@10': '0.1209', 'NDCG@10': '0.0715', 'HR@20': '0.1642', 'NDCG@20': '0.0825'}
2025-03-02 13:51:34,471 - EarlyStopping counter: 2 out of 10
2025-03-02 13:52:07,756 - {'epoch': 48, 'rec_loss': '6.5904'}
2025-03-02 13:52:16,254 - {'Epoch': 48, 'HR@5': '0.0870', 'NDCG@5': '0.0606', 'HR@10': '0.1217', 'NDCG@10': '0.0718', 'HR@20': '0.1649', 'NDCG@20': '0.0827'}
2025-03-02 13:52:16,255 - EarlyStopping counter: 3 out of 10
2025-03-02 13:52:52,998 - {'epoch': 49, 'rec_loss': '6.5847'}
2025-03-02 13:53:01,405 - {'Epoch': 49, 'HR@5': '0.0871', 'NDCG@5': '0.0618', 'HR@10': '0.1206', 'NDCG@10': '0.0726', 'HR@20': '0.1604', 'NDCG@20': '0.0827'}
2025-03-02 13:53:01,410 - EarlyStopping counter: 4 out of 10
2025-03-02 13:53:35,784 - {'epoch': 50, 'rec_loss': '6.5828'}
2025-03-02 13:53:44,256 - {'Epoch': 50, 'HR@5': '0.0894', 'NDCG@5': '0.0626', 'HR@10': '0.1221', 'NDCG@10': '0.0731', 'HR@20': '0.1639', 'NDCG@20': '0.0837'}
2025-03-02 13:53:44,258 - Validation score increased.  Saving model ...
2025-03-02 13:54:21,367 - {'epoch': 51, 'rec_loss': '6.5787'}
2025-03-02 13:54:29,940 - {'Epoch': 51, 'HR@5': '0.0864', 'NDCG@5': '0.0609', 'HR@10': '0.1208', 'NDCG@10': '0.0720', 'HR@20': '0.1626', 'NDCG@20': '0.0825'}
2025-03-02 13:54:29,941 - EarlyStopping counter: 1 out of 10
2025-03-02 13:55:05,624 - {'epoch': 52, 'rec_loss': '6.5665'}
2025-03-02 13:55:14,010 - {'Epoch': 52, 'HR@5': '0.0890', 'NDCG@5': '0.0629', 'HR@10': '0.1220', 'NDCG@10': '0.0736', 'HR@20': '0.1640', 'NDCG@20': '0.0842'}
2025-03-02 13:55:14,011 - Validation score increased.  Saving model ...
2025-03-02 13:55:48,687 - {'epoch': 53, 'rec_loss': '6.5669'}
2025-03-02 13:55:57,716 - {'Epoch': 53, 'HR@5': '0.0885', 'NDCG@5': '0.0625', 'HR@10': '0.1223', 'NDCG@10': '0.0734', 'HR@20': '0.1634', 'NDCG@20': '0.0838'}
2025-03-02 13:55:57,718 - EarlyStopping counter: 1 out of 10
2025-03-02 13:56:39,487 - {'epoch': 54, 'rec_loss': '6.5586'}
2025-03-02 13:56:47,882 - {'Epoch': 54, 'HR@5': '0.0894', 'NDCG@5': '0.0622', 'HR@10': '0.1221', 'NDCG@10': '0.0727', 'HR@20': '0.1624', 'NDCG@20': '0.0829'}
2025-03-02 13:56:47,884 - EarlyStopping counter: 2 out of 10
2025-03-02 13:57:22,191 - {'epoch': 55, 'rec_loss': '6.5549'}
2025-03-02 13:57:30,830 - {'Epoch': 55, 'HR@5': '0.0885', 'NDCG@5': '0.0625', 'HR@10': '0.1215', 'NDCG@10': '0.0731', 'HR@20': '0.1628', 'NDCG@20': '0.0835'}
2025-03-02 13:57:30,832 - EarlyStopping counter: 3 out of 10
2025-03-02 13:58:06,128 - {'epoch': 56, 'rec_loss': '6.5495'}
2025-03-02 13:58:14,769 - {'Epoch': 56, 'HR@5': '0.0883', 'NDCG@5': '0.0623', 'HR@10': '0.1217', 'NDCG@10': '0.0731', 'HR@20': '0.1645', 'NDCG@20': '0.0838'}
2025-03-02 13:58:14,770 - EarlyStopping counter: 4 out of 10
2025-03-02 13:58:50,975 - {'epoch': 57, 'rec_loss': '6.5468'}
2025-03-02 13:58:59,461 - {'Epoch': 57, 'HR@5': '0.0893', 'NDCG@5': '0.0622', 'HR@10': '0.1211', 'NDCG@10': '0.0724', 'HR@20': '0.1634', 'NDCG@20': '0.0831'}
2025-03-02 13:58:59,463 - EarlyStopping counter: 5 out of 10
2025-03-02 13:59:35,044 - {'epoch': 58, 'rec_loss': '6.5426'}
2025-03-02 13:59:43,767 - {'Epoch': 58, 'HR@5': '0.0870', 'NDCG@5': '0.0618', 'HR@10': '0.1198', 'NDCG@10': '0.0724', 'HR@20': '0.1606', 'NDCG@20': '0.0827'}
2025-03-02 13:59:43,768 - EarlyStopping counter: 6 out of 10
2025-03-02 14:00:17,875 - {'epoch': 59, 'rec_loss': '6.5451'}
2025-03-02 14:00:26,931 - {'Epoch': 59, 'HR@5': '0.0874', 'NDCG@5': '0.0618', 'HR@10': '0.1212', 'NDCG@10': '0.0727', 'HR@20': '0.1628', 'NDCG@20': '0.0831'}
2025-03-02 14:00:26,937 - EarlyStopping counter: 7 out of 10
2025-03-02 14:01:06,131 - {'epoch': 60, 'rec_loss': '6.5399'}
2025-03-02 14:01:14,640 - {'Epoch': 60, 'HR@5': '0.0859', 'NDCG@5': '0.0606', 'HR@10': '0.1201', 'NDCG@10': '0.0716', 'HR@20': '0.1639', 'NDCG@20': '0.0827'}
2025-03-02 14:01:14,645 - EarlyStopping counter: 8 out of 10
2025-03-02 14:01:51,620 - {'epoch': 61, 'rec_loss': '6.5297'}
2025-03-02 14:02:00,065 - {'Epoch': 61, 'HR@5': '0.0880', 'NDCG@5': '0.0624', 'HR@10': '0.1215', 'NDCG@10': '0.0732', 'HR@20': '0.1628', 'NDCG@20': '0.0837'}
2025-03-02 14:02:00,069 - EarlyStopping counter: 9 out of 10
2025-03-02 14:02:33,560 - {'epoch': 62, 'rec_loss': '6.5261'}
2025-03-02 14:02:42,141 - {'Epoch': 62, 'HR@5': '0.0872', 'NDCG@5': '0.0619', 'HR@10': '0.1212', 'NDCG@10': '0.0729', 'HR@20': '0.1629', 'NDCG@20': '0.0833'}
2025-03-02 14:02:42,146 - EarlyStopping counter: 10 out of 10
2025-03-02 14:02:42,146 - Early stopping
2025-03-02 14:02:42,146 - ---------------Test Score---------------
2025-03-02 14:02:50,706 - {'Epoch': 0, 'HR@5': '0.0707', 'NDCG@5': '0.0500', 'HR@10': '0.0986', 'NDCG@10': '0.0590', 'HR@20': '0.1363', 'NDCG@20': '0.0685'}
2025-03-02 14:02:50,710 - Scale_Beauty
2025-03-02 14:02:50,710 - {'Epoch': 0, 'HR@5': '0.0707', 'NDCG@5': '0.0500', 'HR@10': '0.0986', 'NDCG@10': '0.0590', 'HR@20': '0.1363', 'NDCG@20': '0.0685'}
2025-03-02 14:31:14,271 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50], kernels=[8, 12, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-02 14:31:17,107 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=50, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-02 14:31:17,113 - Total Parameters: 931070
2025-03-02 14:31:36,332 - {'epoch': 0, 'rec_loss': '8.9120'}
2025-03-02 14:31:43,529 - {'Epoch': 0, 'HR@5': '0.0134', 'NDCG@5': '0.0082', 'HR@10': '0.0218', 'NDCG@10': '0.0109', 'HR@20': '0.0350', 'NDCG@20': '0.0141'}
2025-03-02 14:31:43,529 - Validation score increased.  Saving model ...
2025-03-02 14:32:01,353 - {'epoch': 1, 'rec_loss': '8.5235'}
2025-03-02 14:32:08,423 - {'Epoch': 1, 'HR@5': '0.0240', 'NDCG@5': '0.0154', 'HR@10': '0.0376', 'NDCG@10': '0.0198', 'HR@20': '0.0567', 'NDCG@20': '0.0246'}
2025-03-02 14:32:08,424 - Validation score increased.  Saving model ...
2025-03-02 14:32:25,791 - {'epoch': 2, 'rec_loss': '8.2841'}
2025-03-02 14:32:33,023 - {'Epoch': 2, 'HR@5': '0.0314', 'NDCG@5': '0.0203', 'HR@10': '0.0520', 'NDCG@10': '0.0270', 'HR@20': '0.0766', 'NDCG@20': '0.0331'}
2025-03-02 14:32:33,024 - Validation score increased.  Saving model ...
2025-03-02 14:32:50,425 - {'epoch': 3, 'rec_loss': '8.0724'}
2025-03-02 14:32:57,405 - {'Epoch': 3, 'HR@5': '0.0434', 'NDCG@5': '0.0287', 'HR@10': '0.0665', 'NDCG@10': '0.0361', 'HR@20': '0.0957', 'NDCG@20': '0.0434'}
2025-03-02 14:32:57,406 - Validation score increased.  Saving model ...
2025-03-02 14:33:16,566 - {'epoch': 4, 'rec_loss': '7.9183'}
2025-03-02 14:33:23,451 - {'Epoch': 4, 'HR@5': '0.0523', 'NDCG@5': '0.0355', 'HR@10': '0.0758', 'NDCG@10': '0.0431', 'HR@20': '0.1100', 'NDCG@20': '0.0517'}
2025-03-02 14:33:23,452 - Validation score increased.  Saving model ...
2025-03-02 14:33:43,011 - {'epoch': 5, 'rec_loss': '7.8034'}
2025-03-02 14:33:49,969 - {'Epoch': 5, 'HR@5': '0.0576', 'NDCG@5': '0.0387', 'HR@10': '0.0844', 'NDCG@10': '0.0473', 'HR@20': '0.1186', 'NDCG@20': '0.0559'}
2025-03-02 14:33:49,970 - Validation score increased.  Saving model ...
2025-03-02 14:34:07,226 - {'epoch': 6, 'rec_loss': '7.7099'}
2025-03-02 14:34:13,972 - {'Epoch': 6, 'HR@5': '0.0651', 'NDCG@5': '0.0444', 'HR@10': '0.0921', 'NDCG@10': '0.0531', 'HR@20': '0.1278', 'NDCG@20': '0.0620'}
2025-03-02 14:34:13,976 - Validation score increased.  Saving model ...
2025-03-02 14:34:32,540 - {'epoch': 7, 'rec_loss': '7.6266'}
2025-03-02 14:34:39,393 - {'Epoch': 7, 'HR@5': '0.0673', 'NDCG@5': '0.0465', 'HR@10': '0.0961', 'NDCG@10': '0.0558', 'HR@20': '0.1340', 'NDCG@20': '0.0653'}
2025-03-02 14:34:39,394 - Validation score increased.  Saving model ...
2025-03-02 14:34:56,807 - {'epoch': 8, 'rec_loss': '7.5661'}
2025-03-02 14:35:03,605 - {'Epoch': 8, 'HR@5': '0.0702', 'NDCG@5': '0.0491', 'HR@10': '0.1008', 'NDCG@10': '0.0589', 'HR@20': '0.1382', 'NDCG@20': '0.0683'}
2025-03-02 14:35:03,606 - Validation score increased.  Saving model ...
2025-03-02 14:35:20,587 - {'epoch': 9, 'rec_loss': '7.5065'}
2025-03-02 14:35:27,394 - {'Epoch': 9, 'HR@5': '0.0725', 'NDCG@5': '0.0503', 'HR@10': '0.1030', 'NDCG@10': '0.0602', 'HR@20': '0.1431', 'NDCG@20': '0.0702'}
2025-03-02 14:35:27,395 - Validation score increased.  Saving model ...
2025-03-02 14:35:44,803 - {'epoch': 10, 'rec_loss': '7.4579'}
2025-03-02 14:35:51,631 - {'Epoch': 10, 'HR@5': '0.0764', 'NDCG@5': '0.0531', 'HR@10': '0.1057', 'NDCG@10': '0.0625', 'HR@20': '0.1462', 'NDCG@20': '0.0727'}
2025-03-02 14:35:51,632 - Validation score increased.  Saving model ...
2025-03-02 14:36:09,082 - {'epoch': 11, 'rec_loss': '7.4107'}
2025-03-02 14:36:15,879 - {'Epoch': 11, 'HR@5': '0.0770', 'NDCG@5': '0.0548', 'HR@10': '0.1077', 'NDCG@10': '0.0647', 'HR@20': '0.1478', 'NDCG@20': '0.0748'}
2025-03-02 14:36:15,880 - Validation score increased.  Saving model ...
2025-03-02 14:36:36,012 - {'epoch': 12, 'rec_loss': '7.3764'}
2025-03-02 14:36:42,782 - {'Epoch': 12, 'HR@5': '0.0778', 'NDCG@5': '0.0542', 'HR@10': '0.1085', 'NDCG@10': '0.0641', 'HR@20': '0.1490', 'NDCG@20': '0.0743'}
2025-03-02 14:36:42,783 - EarlyStopping counter: 1 out of 10
2025-03-02 14:37:00,380 - {'epoch': 13, 'rec_loss': '7.3417'}
2025-03-02 14:37:07,138 - {'Epoch': 13, 'HR@5': '0.0783', 'NDCG@5': '0.0553', 'HR@10': '0.1102', 'NDCG@10': '0.0656', 'HR@20': '0.1506', 'NDCG@20': '0.0757'}
2025-03-02 14:37:07,144 - Validation score increased.  Saving model ...
2025-03-02 14:37:26,255 - {'epoch': 14, 'rec_loss': '7.3079'}
2025-03-02 14:37:32,877 - {'Epoch': 14, 'HR@5': '0.0811', 'NDCG@5': '0.0573', 'HR@10': '0.1126', 'NDCG@10': '0.0674', 'HR@20': '0.1520', 'NDCG@20': '0.0773'}
2025-03-02 14:37:32,877 - Validation score increased.  Saving model ...
2025-03-02 14:37:51,478 - {'epoch': 15, 'rec_loss': '7.2826'}
2025-03-02 14:37:58,190 - {'Epoch': 15, 'HR@5': '0.0805', 'NDCG@5': '0.0566', 'HR@10': '0.1126', 'NDCG@10': '0.0670', 'HR@20': '0.1530', 'NDCG@20': '0.0771'}
2025-03-02 14:37:58,191 - EarlyStopping counter: 1 out of 10
2025-03-02 14:38:17,953 - {'epoch': 16, 'rec_loss': '7.2584'}
2025-03-02 14:38:24,918 - {'Epoch': 16, 'HR@5': '0.0818', 'NDCG@5': '0.0574', 'HR@10': '0.1137', 'NDCG@10': '0.0676', 'HR@20': '0.1547', 'NDCG@20': '0.0780'}
2025-03-02 14:38:24,919 - Validation score increased.  Saving model ...
2025-03-02 14:38:44,080 - {'epoch': 17, 'rec_loss': '7.2309'}
2025-03-02 14:38:51,101 - {'Epoch': 17, 'HR@5': '0.0834', 'NDCG@5': '0.0582', 'HR@10': '0.1154', 'NDCG@10': '0.0685', 'HR@20': '0.1563', 'NDCG@20': '0.0788'}
2025-03-02 14:38:51,102 - Validation score increased.  Saving model ...
2025-03-02 14:39:08,857 - {'epoch': 18, 'rec_loss': '7.2188'}
2025-03-02 14:39:15,553 - {'Epoch': 18, 'HR@5': '0.0831', 'NDCG@5': '0.0582', 'HR@10': '0.1153', 'NDCG@10': '0.0685', 'HR@20': '0.1563', 'NDCG@20': '0.0788'}
2025-03-02 14:39:15,554 - Validation score increased.  Saving model ...
2025-03-02 14:39:34,715 - {'epoch': 19, 'rec_loss': '7.1943'}
2025-03-02 14:39:41,736 - {'Epoch': 19, 'HR@5': '0.0833', 'NDCG@5': '0.0594', 'HR@10': '0.1151', 'NDCG@10': '0.0696', 'HR@20': '0.1570', 'NDCG@20': '0.0801'}
2025-03-02 14:39:41,737 - Validation score increased.  Saving model ...
2025-03-02 14:39:59,098 - {'epoch': 20, 'rec_loss': '7.1683'}
2025-03-02 14:40:05,904 - {'Epoch': 20, 'HR@5': '0.0846', 'NDCG@5': '0.0588', 'HR@10': '0.1168', 'NDCG@10': '0.0692', 'HR@20': '0.1586', 'NDCG@20': '0.0797'}
2025-03-02 14:40:05,905 - EarlyStopping counter: 1 out of 10
2025-03-02 14:40:23,082 - {'epoch': 21, 'rec_loss': '7.1607'}
2025-03-02 14:40:29,741 - {'Epoch': 21, 'HR@5': '0.0846', 'NDCG@5': '0.0594', 'HR@10': '0.1183', 'NDCG@10': '0.0702', 'HR@20': '0.1587', 'NDCG@20': '0.0804'}
2025-03-02 14:40:29,742 - Validation score increased.  Saving model ...
2025-03-02 14:40:47,191 - {'epoch': 22, 'rec_loss': '7.1358'}
2025-03-02 14:40:54,025 - {'Epoch': 22, 'HR@5': '0.0855', 'NDCG@5': '0.0600', 'HR@10': '0.1175', 'NDCG@10': '0.0704', 'HR@20': '0.1606', 'NDCG@20': '0.0812'}
2025-03-02 14:40:54,026 - Validation score increased.  Saving model ...
2025-03-02 14:41:11,629 - {'epoch': 23, 'rec_loss': '7.1303'}
2025-03-02 14:41:18,325 - {'Epoch': 23, 'HR@5': '0.0851', 'NDCG@5': '0.0595', 'HR@10': '0.1176', 'NDCG@10': '0.0700', 'HR@20': '0.1601', 'NDCG@20': '0.0807'}
2025-03-02 14:41:18,326 - EarlyStopping counter: 1 out of 10
2025-03-02 14:41:35,529 - {'epoch': 24, 'rec_loss': '7.1188'}
2025-03-02 14:41:42,246 - {'Epoch': 24, 'HR@5': '0.0851', 'NDCG@5': '0.0600', 'HR@10': '0.1183', 'NDCG@10': '0.0708', 'HR@20': '0.1612', 'NDCG@20': '0.0816'}
2025-03-02 14:41:42,247 - Validation score increased.  Saving model ...
2025-03-02 14:41:59,942 - {'epoch': 25, 'rec_loss': '7.1022'}
2025-03-02 14:42:06,840 - {'Epoch': 25, 'HR@5': '0.0849', 'NDCG@5': '0.0599', 'HR@10': '0.1189', 'NDCG@10': '0.0708', 'HR@20': '0.1628', 'NDCG@20': '0.0819'}
2025-03-02 14:42:06,840 - Validation score increased.  Saving model ...
2025-03-02 14:42:24,328 - {'epoch': 26, 'rec_loss': '7.0960'}
2025-03-02 14:42:31,099 - {'Epoch': 26, 'HR@5': '0.0870', 'NDCG@5': '0.0607', 'HR@10': '0.1193', 'NDCG@10': '0.0711', 'HR@20': '0.1621', 'NDCG@20': '0.0819'}
2025-03-02 14:42:31,104 - Validation score increased.  Saving model ...
2025-03-02 14:42:49,677 - {'epoch': 27, 'rec_loss': '7.0807'}
2025-03-02 14:42:56,434 - {'Epoch': 27, 'HR@5': '0.0848', 'NDCG@5': '0.0600', 'HR@10': '0.1212', 'NDCG@10': '0.0716', 'HR@20': '0.1628', 'NDCG@20': '0.0821'}
2025-03-02 14:42:56,434 - Validation score increased.  Saving model ...
2025-03-02 14:43:14,159 - {'epoch': 28, 'rec_loss': '7.0741'}
2025-03-02 14:43:21,254 - {'Epoch': 28, 'HR@5': '0.0852', 'NDCG@5': '0.0604', 'HR@10': '0.1196', 'NDCG@10': '0.0715', 'HR@20': '0.1623', 'NDCG@20': '0.0823'}
2025-03-02 14:43:21,261 - Validation score increased.  Saving model ...
2025-03-02 14:43:39,282 - {'epoch': 29, 'rec_loss': '7.0694'}
2025-03-02 14:43:46,008 - {'Epoch': 29, 'HR@5': '0.0853', 'NDCG@5': '0.0607', 'HR@10': '0.1189', 'NDCG@10': '0.0715', 'HR@20': '0.1624', 'NDCG@20': '0.0825'}
2025-03-02 14:43:46,009 - Validation score increased.  Saving model ...
2025-03-02 14:44:03,355 - {'epoch': 30, 'rec_loss': '7.0561'}
2025-03-02 14:44:10,186 - {'Epoch': 30, 'HR@5': '0.0864', 'NDCG@5': '0.0611', 'HR@10': '0.1197', 'NDCG@10': '0.0718', 'HR@20': '0.1623', 'NDCG@20': '0.0826'}
2025-03-02 14:44:10,187 - Validation score increased.  Saving model ...
2025-03-02 14:44:27,451 - {'epoch': 31, 'rec_loss': '7.0480'}
2025-03-02 14:44:34,308 - {'Epoch': 31, 'HR@5': '0.0868', 'NDCG@5': '0.0611', 'HR@10': '0.1212', 'NDCG@10': '0.0721', 'HR@20': '0.1636', 'NDCG@20': '0.0828'}
2025-03-02 14:44:34,309 - Validation score increased.  Saving model ...
2025-03-02 14:44:52,770 - {'epoch': 32, 'rec_loss': '7.0431'}
2025-03-02 14:44:59,608 - {'Epoch': 32, 'HR@5': '0.0864', 'NDCG@5': '0.0611', 'HR@10': '0.1206', 'NDCG@10': '0.0721', 'HR@20': '0.1621', 'NDCG@20': '0.0826'}
2025-03-02 14:44:59,609 - EarlyStopping counter: 1 out of 10
2025-03-02 14:45:16,987 - {'epoch': 33, 'rec_loss': '7.0335'}
2025-03-02 14:45:23,821 - {'Epoch': 33, 'HR@5': '0.0868', 'NDCG@5': '0.0611', 'HR@10': '0.1201', 'NDCG@10': '0.0718', 'HR@20': '0.1640', 'NDCG@20': '0.0829'}
2025-03-02 14:45:23,822 - Validation score increased.  Saving model ...
2025-03-02 14:45:41,418 - {'epoch': 34, 'rec_loss': '7.0165'}
2025-03-02 14:45:48,204 - {'Epoch': 34, 'HR@5': '0.0874', 'NDCG@5': '0.0614', 'HR@10': '0.1204', 'NDCG@10': '0.0720', 'HR@20': '0.1630', 'NDCG@20': '0.0828'}
2025-03-02 14:45:48,205 - EarlyStopping counter: 1 out of 10
2025-03-02 14:46:05,498 - {'epoch': 35, 'rec_loss': '7.0263'}
2025-03-02 14:46:12,321 - {'Epoch': 35, 'HR@5': '0.0879', 'NDCG@5': '0.0617', 'HR@10': '0.1213', 'NDCG@10': '0.0724', 'HR@20': '0.1639', 'NDCG@20': '0.0831'}
2025-03-02 14:46:12,322 - Validation score increased.  Saving model ...
2025-03-02 14:46:29,930 - {'epoch': 36, 'rec_loss': '7.0113'}
2025-03-02 14:46:36,721 - {'Epoch': 36, 'HR@5': '0.0869', 'NDCG@5': '0.0615', 'HR@10': '0.1206', 'NDCG@10': '0.0723', 'HR@20': '0.1642', 'NDCG@20': '0.0832'}
2025-03-02 14:46:36,722 - Validation score increased.  Saving model ...
2025-03-02 14:46:54,344 - {'epoch': 37, 'rec_loss': '7.0103'}
2025-03-02 14:47:01,140 - {'Epoch': 37, 'HR@5': '0.0868', 'NDCG@5': '0.0609', 'HR@10': '0.1215', 'NDCG@10': '0.0720', 'HR@20': '0.1641', 'NDCG@20': '0.0828'}
2025-03-02 14:47:01,141 - EarlyStopping counter: 1 out of 10
2025-03-02 14:47:18,768 - {'epoch': 38, 'rec_loss': '7.0015'}
2025-03-02 14:47:25,810 - {'Epoch': 38, 'HR@5': '0.0855', 'NDCG@5': '0.0607', 'HR@10': '0.1198', 'NDCG@10': '0.0718', 'HR@20': '0.1640', 'NDCG@20': '0.0829'}
2025-03-02 14:47:25,811 - EarlyStopping counter: 2 out of 10
2025-03-02 14:47:43,353 - {'epoch': 39, 'rec_loss': '7.0055'}
2025-03-02 14:47:50,238 - {'Epoch': 39, 'HR@5': '0.0870', 'NDCG@5': '0.0612', 'HR@10': '0.1207', 'NDCG@10': '0.0721', 'HR@20': '0.1637', 'NDCG@20': '0.0829'}
2025-03-02 14:47:50,239 - EarlyStopping counter: 3 out of 10
2025-03-02 14:48:07,584 - {'epoch': 40, 'rec_loss': '6.9865'}
2025-03-02 14:48:14,448 - {'Epoch': 40, 'HR@5': '0.0856', 'NDCG@5': '0.0606', 'HR@10': '0.1208', 'NDCG@10': '0.0720', 'HR@20': '0.1652', 'NDCG@20': '0.0832'}
2025-03-02 14:48:14,449 - EarlyStopping counter: 4 out of 10
2025-03-02 14:48:33,578 - {'epoch': 41, 'rec_loss': '6.9815'}
2025-03-02 14:48:40,533 - {'Epoch': 41, 'HR@5': '0.0875', 'NDCG@5': '0.0619', 'HR@10': '0.1199', 'NDCG@10': '0.0723', 'HR@20': '0.1642', 'NDCG@20': '0.0835'}
2025-03-02 14:48:40,534 - Validation score increased.  Saving model ...
2025-03-02 14:48:58,459 - {'epoch': 42, 'rec_loss': '6.9830'}
2025-03-02 14:49:05,262 - {'Epoch': 42, 'HR@5': '0.0876', 'NDCG@5': '0.0615', 'HR@10': '0.1209', 'NDCG@10': '0.0722', 'HR@20': '0.1649', 'NDCG@20': '0.0833'}
2025-03-02 14:49:05,263 - EarlyStopping counter: 1 out of 10
2025-03-02 14:49:22,827 - {'epoch': 43, 'rec_loss': '6.9710'}
2025-03-02 14:49:29,628 - {'Epoch': 43, 'HR@5': '0.0884', 'NDCG@5': '0.0615', 'HR@10': '0.1219', 'NDCG@10': '0.0722', 'HR@20': '0.1650', 'NDCG@20': '0.0831'}
2025-03-02 14:49:29,629 - EarlyStopping counter: 2 out of 10
2025-03-02 14:49:47,181 - {'epoch': 44, 'rec_loss': '6.9675'}
2025-03-02 14:49:54,009 - {'Epoch': 44, 'HR@5': '0.0862', 'NDCG@5': '0.0606', 'HR@10': '0.1210', 'NDCG@10': '0.0718', 'HR@20': '0.1643', 'NDCG@20': '0.0827'}
2025-03-02 14:49:54,010 - EarlyStopping counter: 3 out of 10
2025-03-02 14:50:11,709 - {'epoch': 45, 'rec_loss': '6.9614'}
2025-03-02 14:50:18,794 - {'Epoch': 45, 'HR@5': '0.0875', 'NDCG@5': '0.0617', 'HR@10': '0.1217', 'NDCG@10': '0.0727', 'HR@20': '0.1651', 'NDCG@20': '0.0836'}
2025-03-02 14:50:18,795 - Validation score increased.  Saving model ...
2025-03-02 14:50:35,826 - {'epoch': 46, 'rec_loss': '6.9594'}
2025-03-02 14:50:42,696 - {'Epoch': 46, 'HR@5': '0.0868', 'NDCG@5': '0.0614', 'HR@10': '0.1210', 'NDCG@10': '0.0724', 'HR@20': '0.1667', 'NDCG@20': '0.0840'}
2025-03-02 14:50:42,697 - Validation score increased.  Saving model ...
2025-03-02 14:51:00,641 - {'epoch': 47, 'rec_loss': '6.9534'}
2025-03-02 14:51:07,636 - {'Epoch': 47, 'HR@5': '0.0868', 'NDCG@5': '0.0620', 'HR@10': '0.1204', 'NDCG@10': '0.0728', 'HR@20': '0.1650', 'NDCG@20': '0.0841'}
2025-03-02 14:51:07,637 - Validation score increased.  Saving model ...
2025-03-02 14:51:24,832 - {'epoch': 48, 'rec_loss': '6.9499'}
2025-03-02 14:51:31,752 - {'Epoch': 48, 'HR@5': '0.0873', 'NDCG@5': '0.0616', 'HR@10': '0.1226', 'NDCG@10': '0.0730', 'HR@20': '0.1659', 'NDCG@20': '0.0839'}
2025-03-02 14:51:31,753 - EarlyStopping counter: 1 out of 10
2025-03-02 14:51:49,067 - {'epoch': 49, 'rec_loss': '6.9532'}
2025-03-02 14:51:55,902 - {'Epoch': 49, 'HR@5': '0.0876', 'NDCG@5': '0.0622', 'HR@10': '0.1208', 'NDCG@10': '0.0729', 'HR@20': '0.1633', 'NDCG@20': '0.0836'}
2025-03-02 14:51:55,903 - EarlyStopping counter: 2 out of 10
2025-03-02 14:52:13,574 - {'epoch': 50, 'rec_loss': '6.9426'}
2025-03-02 14:52:20,508 - {'Epoch': 50, 'HR@5': '0.0872', 'NDCG@5': '0.0622', 'HR@10': '0.1201', 'NDCG@10': '0.0727', 'HR@20': '0.1635', 'NDCG@20': '0.0837'}
2025-03-02 14:52:20,509 - EarlyStopping counter: 3 out of 10
2025-03-02 14:52:37,887 - {'epoch': 51, 'rec_loss': '6.9445'}
2025-03-02 14:52:44,816 - {'Epoch': 51, 'HR@5': '0.0879', 'NDCG@5': '0.0626', 'HR@10': '0.1210', 'NDCG@10': '0.0732', 'HR@20': '0.1645', 'NDCG@20': '0.0842'}
2025-03-02 14:52:44,817 - Validation score increased.  Saving model ...
2025-03-02 14:53:02,078 - {'epoch': 52, 'rec_loss': '6.9446'}
2025-03-02 14:53:08,961 - {'Epoch': 52, 'HR@5': '0.0877', 'NDCG@5': '0.0622', 'HR@10': '0.1214', 'NDCG@10': '0.0731', 'HR@20': '0.1656', 'NDCG@20': '0.0842'}
2025-03-02 14:53:08,962 - EarlyStopping counter: 1 out of 10
2025-03-02 14:53:29,572 - {'epoch': 53, 'rec_loss': '6.9376'}
2025-03-02 14:53:36,389 - {'Epoch': 53, 'HR@5': '0.0881', 'NDCG@5': '0.0626', 'HR@10': '0.1214', 'NDCG@10': '0.0733', 'HR@20': '0.1639', 'NDCG@20': '0.0840'}
2025-03-02 14:53:36,390 - EarlyStopping counter: 2 out of 10
2025-03-02 14:53:55,508 - {'epoch': 54, 'rec_loss': '6.9327'}
2025-03-02 14:54:02,461 - {'Epoch': 54, 'HR@5': '0.0880', 'NDCG@5': '0.0625', 'HR@10': '0.1221', 'NDCG@10': '0.0735', 'HR@20': '0.1649', 'NDCG@20': '0.0843'}
2025-03-02 14:54:02,462 - Validation score increased.  Saving model ...
2025-03-02 14:54:20,417 - {'epoch': 55, 'rec_loss': '6.9331'}
2025-03-02 14:54:27,395 - {'Epoch': 55, 'HR@5': '0.0882', 'NDCG@5': '0.0626', 'HR@10': '0.1206', 'NDCG@10': '0.0731', 'HR@20': '0.1637', 'NDCG@20': '0.0839'}
2025-03-02 14:54:27,400 - EarlyStopping counter: 1 out of 10
2025-03-02 14:54:44,988 - {'epoch': 56, 'rec_loss': '6.9215'}
2025-03-02 14:54:51,909 - {'Epoch': 56, 'HR@5': '0.0884', 'NDCG@5': '0.0624', 'HR@10': '0.1212', 'NDCG@10': '0.0729', 'HR@20': '0.1644', 'NDCG@20': '0.0837'}
2025-03-02 14:54:51,910 - EarlyStopping counter: 2 out of 10
2025-03-02 14:55:09,965 - {'epoch': 57, 'rec_loss': '6.9230'}
2025-03-02 14:55:16,781 - {'Epoch': 57, 'HR@5': '0.0870', 'NDCG@5': '0.0612', 'HR@10': '0.1198', 'NDCG@10': '0.0717', 'HR@20': '0.1643', 'NDCG@20': '0.0829'}
2025-03-02 14:55:16,782 - EarlyStopping counter: 3 out of 10
2025-03-02 14:55:34,386 - {'epoch': 58, 'rec_loss': '6.9100'}
2025-03-02 14:55:41,263 - {'Epoch': 58, 'HR@5': '0.0868', 'NDCG@5': '0.0618', 'HR@10': '0.1202', 'NDCG@10': '0.0725', 'HR@20': '0.1652', 'NDCG@20': '0.0838'}
2025-03-02 14:55:41,269 - EarlyStopping counter: 4 out of 10
2025-03-02 14:55:58,520 - {'epoch': 59, 'rec_loss': '6.9146'}
2025-03-02 14:56:05,438 - {'Epoch': 59, 'HR@5': '0.0873', 'NDCG@5': '0.0615', 'HR@10': '0.1209', 'NDCG@10': '0.0723', 'HR@20': '0.1647', 'NDCG@20': '0.0833'}
2025-03-02 14:56:05,438 - EarlyStopping counter: 5 out of 10
2025-03-02 14:56:22,837 - {'epoch': 60, 'rec_loss': '6.9117'}
2025-03-02 14:56:29,842 - {'Epoch': 60, 'HR@5': '0.0865', 'NDCG@5': '0.0612', 'HR@10': '0.1202', 'NDCG@10': '0.0721', 'HR@20': '0.1633', 'NDCG@20': '0.0829'}
2025-03-02 14:56:29,843 - EarlyStopping counter: 6 out of 10
2025-03-02 14:56:48,719 - {'epoch': 61, 'rec_loss': '6.9067'}
2025-03-02 14:56:55,609 - {'Epoch': 61, 'HR@5': '0.0871', 'NDCG@5': '0.0614', 'HR@10': '0.1219', 'NDCG@10': '0.0726', 'HR@20': '0.1653', 'NDCG@20': '0.0835'}
2025-03-02 14:56:55,610 - EarlyStopping counter: 7 out of 10
2025-03-02 14:57:13,162 - {'epoch': 62, 'rec_loss': '6.9099'}
2025-03-02 14:57:20,149 - {'Epoch': 62, 'HR@5': '0.0881', 'NDCG@5': '0.0624', 'HR@10': '0.1221', 'NDCG@10': '0.0734', 'HR@20': '0.1651', 'NDCG@20': '0.0842'}
2025-03-02 14:57:20,150 - EarlyStopping counter: 8 out of 10
2025-03-02 14:57:37,058 - {'epoch': 63, 'rec_loss': '6.8960'}
2025-03-02 14:57:43,919 - {'Epoch': 63, 'HR@5': '0.0869', 'NDCG@5': '0.0621', 'HR@10': '0.1210', 'NDCG@10': '0.0731', 'HR@20': '0.1642', 'NDCG@20': '0.0839'}
2025-03-02 14:57:43,920 - EarlyStopping counter: 9 out of 10
2025-03-02 14:58:03,168 - {'epoch': 64, 'rec_loss': '6.8977'}
2025-03-02 14:58:10,084 - {'Epoch': 64, 'HR@5': '0.0880', 'NDCG@5': '0.0617', 'HR@10': '0.1205', 'NDCG@10': '0.0721', 'HR@20': '0.1649', 'NDCG@20': '0.0833'}
2025-03-02 14:58:10,085 - EarlyStopping counter: 10 out of 10
2025-03-02 14:58:10,085 - Early stopping
2025-03-02 14:58:10,085 - ---------------Test Score---------------
2025-03-02 14:58:16,852 - {'Epoch': 0, 'HR@5': '0.0702', 'NDCG@5': '0.0499', 'HR@10': '0.0978', 'NDCG@10': '0.0588', 'HR@20': '0.1348', 'NDCG@20': '0.0682'}
2025-03-02 14:58:16,852 - Scale_Beauty
2025-03-02 14:58:16,853 - {'Epoch': 0, 'HR@5': '0.0702', 'NDCG@5': '0.0499', 'HR@10': '0.0978', 'NDCG@10': '0.0588', 'HR@20': '0.1348', 'NDCG@20': '0.0682'}
2025-03-02 15:06:42,546 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25, 5], kernels=[8, 12, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-02 15:06:45,405 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-02 15:06:45,410 - Total Parameters: 928145
2025-03-02 15:07:20,835 - {'epoch': 0, 'rec_loss': '8.8039'}
2025-03-02 15:07:29,631 - {'Epoch': 0, 'HR@5': '0.0232', 'NDCG@5': '0.0150', 'HR@10': '0.0363', 'NDCG@10': '0.0192', 'HR@20': '0.0577', 'NDCG@20': '0.0246'}
2025-03-02 15:07:29,632 - Validation score increased.  Saving model ...
2025-03-02 15:08:03,224 - {'epoch': 1, 'rec_loss': '8.2207'}
2025-03-02 15:08:12,013 - {'Epoch': 1, 'HR@5': '0.0440', 'NDCG@5': '0.0297', 'HR@10': '0.0654', 'NDCG@10': '0.0366', 'HR@20': '0.0935', 'NDCG@20': '0.0437'}
2025-03-02 15:08:12,015 - Validation score increased.  Saving model ...
2025-03-02 15:08:48,072 - {'epoch': 2, 'rec_loss': '7.9028'}
2025-03-02 15:08:56,431 - {'Epoch': 2, 'HR@5': '0.0577', 'NDCG@5': '0.0396', 'HR@10': '0.0822', 'NDCG@10': '0.0475', 'HR@20': '0.1153', 'NDCG@20': '0.0558'}
2025-03-02 15:08:56,440 - Validation score increased.  Saving model ...
2025-03-02 15:09:32,743 - {'epoch': 3, 'rec_loss': '7.6860'}
2025-03-02 15:09:40,863 - {'Epoch': 3, 'HR@5': '0.0662', 'NDCG@5': '0.0455', 'HR@10': '0.0938', 'NDCG@10': '0.0544', 'HR@20': '0.1307', 'NDCG@20': '0.0636'}
2025-03-02 15:09:40,865 - Validation score increased.  Saving model ...
2025-03-02 15:10:15,068 - {'epoch': 4, 'rec_loss': '7.5229'}
2025-03-02 15:10:23,834 - {'Epoch': 4, 'HR@5': '0.0728', 'NDCG@5': '0.0504', 'HR@10': '0.1007', 'NDCG@10': '0.0594', 'HR@20': '0.1395', 'NDCG@20': '0.0691'}
2025-03-02 15:10:23,838 - Validation score increased.  Saving model ...
2025-03-02 15:10:57,605 - {'epoch': 5, 'rec_loss': '7.4038'}
2025-03-02 15:11:05,946 - {'Epoch': 5, 'HR@5': '0.0765', 'NDCG@5': '0.0536', 'HR@10': '0.1064', 'NDCG@10': '0.0632', 'HR@20': '0.1455', 'NDCG@20': '0.0730'}
2025-03-02 15:11:05,948 - Validation score increased.  Saving model ...
2025-03-02 15:11:39,834 - {'epoch': 6, 'rec_loss': '7.3050'}
2025-03-02 15:11:48,192 - {'Epoch': 6, 'HR@5': '0.0795', 'NDCG@5': '0.0554', 'HR@10': '0.1099', 'NDCG@10': '0.0652', 'HR@20': '0.1489', 'NDCG@20': '0.0751'}
2025-03-02 15:11:48,193 - Validation score increased.  Saving model ...
2025-03-02 15:12:23,608 - {'epoch': 7, 'rec_loss': '7.2252'}
2025-03-02 15:12:32,652 - {'Epoch': 7, 'HR@5': '0.0821', 'NDCG@5': '0.0572', 'HR@10': '0.1119', 'NDCG@10': '0.0669', 'HR@20': '0.1527', 'NDCG@20': '0.0771'}
2025-03-02 15:12:32,659 - Validation score increased.  Saving model ...
2025-03-02 15:13:08,334 - {'epoch': 8, 'rec_loss': '7.1681'}
2025-03-02 15:13:16,468 - {'Epoch': 8, 'HR@5': '0.0809', 'NDCG@5': '0.0569', 'HR@10': '0.1116', 'NDCG@10': '0.0668', 'HR@20': '0.1532', 'NDCG@20': '0.0773'}
2025-03-02 15:13:16,470 - Validation score increased.  Saving model ...
2025-03-02 15:13:50,808 - {'epoch': 9, 'rec_loss': '7.1198'}
2025-03-02 15:13:59,111 - {'Epoch': 9, 'HR@5': '0.0835', 'NDCG@5': '0.0589', 'HR@10': '0.1152', 'NDCG@10': '0.0691', 'HR@20': '0.1576', 'NDCG@20': '0.0797'}
2025-03-02 15:13:59,112 - Validation score increased.  Saving model ...
2025-03-02 15:14:35,582 - {'epoch': 10, 'rec_loss': '7.0724'}
2025-03-02 15:14:43,976 - {'Epoch': 10, 'HR@5': '0.0834', 'NDCG@5': '0.0580', 'HR@10': '0.1142', 'NDCG@10': '0.0679', 'HR@20': '0.1569', 'NDCG@20': '0.0787'}
2025-03-02 15:14:43,977 - EarlyStopping counter: 1 out of 10
2025-03-02 15:15:17,729 - {'epoch': 11, 'rec_loss': '7.0356'}
2025-03-02 15:15:25,978 - {'Epoch': 11, 'HR@5': '0.0851', 'NDCG@5': '0.0604', 'HR@10': '0.1172', 'NDCG@10': '0.0707', 'HR@20': '0.1579', 'NDCG@20': '0.0810'}
2025-03-02 15:15:25,983 - Validation score increased.  Saving model ...
2025-03-02 15:16:02,758 - {'epoch': 12, 'rec_loss': '7.0014'}
2025-03-02 15:16:11,222 - {'Epoch': 12, 'HR@5': '0.0833', 'NDCG@5': '0.0584', 'HR@10': '0.1146', 'NDCG@10': '0.0685', 'HR@20': '0.1573', 'NDCG@20': '0.0793'}
2025-03-02 15:16:11,227 - EarlyStopping counter: 1 out of 10
2025-03-02 15:16:49,084 - {'epoch': 13, 'rec_loss': '6.9720'}
2025-03-02 15:16:58,629 - {'Epoch': 13, 'HR@5': '0.0842', 'NDCG@5': '0.0603', 'HR@10': '0.1175', 'NDCG@10': '0.0710', 'HR@20': '0.1607', 'NDCG@20': '0.0818'}
2025-03-02 15:16:58,630 - Validation score increased.  Saving model ...
2025-03-02 15:17:37,459 - {'epoch': 14, 'rec_loss': '6.9495'}
2025-03-02 15:17:47,153 - {'Epoch': 14, 'HR@5': '0.0846', 'NDCG@5': '0.0600', 'HR@10': '0.1180', 'NDCG@10': '0.0707', 'HR@20': '0.1594', 'NDCG@20': '0.0811'}
2025-03-02 15:17:47,158 - EarlyStopping counter: 1 out of 10
2025-03-02 15:18:25,227 - {'epoch': 15, 'rec_loss': '6.9237'}
2025-03-02 15:18:35,266 - {'Epoch': 15, 'HR@5': '0.0851', 'NDCG@5': '0.0602', 'HR@10': '0.1195', 'NDCG@10': '0.0713', 'HR@20': '0.1600', 'NDCG@20': '0.0816'}
2025-03-02 15:18:35,267 - EarlyStopping counter: 2 out of 10
2025-03-02 15:19:12,737 - {'epoch': 16, 'rec_loss': '6.9015'}
2025-03-02 15:19:22,175 - {'Epoch': 16, 'HR@5': '0.0825', 'NDCG@5': '0.0588', 'HR@10': '0.1160', 'NDCG@10': '0.0697', 'HR@20': '0.1592', 'NDCG@20': '0.0805'}
2025-03-02 15:19:22,177 - EarlyStopping counter: 3 out of 10
2025-03-02 15:20:06,022 - {'epoch': 17, 'rec_loss': '6.8894'}
2025-03-02 15:20:16,617 - {'Epoch': 17, 'HR@5': '0.0849', 'NDCG@5': '0.0597', 'HR@10': '0.1198', 'NDCG@10': '0.0709', 'HR@20': '0.1617', 'NDCG@20': '0.0815'}
2025-03-02 15:20:16,619 - EarlyStopping counter: 4 out of 10
2025-03-02 15:20:53,381 - {'epoch': 18, 'rec_loss': '6.8645'}
2025-03-02 15:21:02,938 - {'Epoch': 18, 'HR@5': '0.0863', 'NDCG@5': '0.0606', 'HR@10': '0.1173', 'NDCG@10': '0.0706', 'HR@20': '0.1603', 'NDCG@20': '0.0815'}
2025-03-02 15:21:02,940 - EarlyStopping counter: 5 out of 10
2025-03-02 15:21:44,472 - {'epoch': 19, 'rec_loss': '6.8447'}
2025-03-02 15:21:53,820 - {'Epoch': 19, 'HR@5': '0.0864', 'NDCG@5': '0.0609', 'HR@10': '0.1183', 'NDCG@10': '0.0713', 'HR@20': '0.1587', 'NDCG@20': '0.0814'}
2025-03-02 15:21:53,822 - EarlyStopping counter: 6 out of 10
2025-03-02 15:22:29,450 - {'epoch': 20, 'rec_loss': '6.8390'}
2025-03-02 15:22:38,098 - {'Epoch': 20, 'HR@5': '0.0863', 'NDCG@5': '0.0609', 'HR@10': '0.1181', 'NDCG@10': '0.0711', 'HR@20': '0.1612', 'NDCG@20': '0.0819'}
2025-03-02 15:22:38,099 - Validation score increased.  Saving model ...
2025-03-02 15:23:18,201 - {'epoch': 21, 'rec_loss': '6.8225'}
2025-03-02 15:23:26,771 - {'Epoch': 21, 'HR@5': '0.0852', 'NDCG@5': '0.0598', 'HR@10': '0.1189', 'NDCG@10': '0.0707', 'HR@20': '0.1609', 'NDCG@20': '0.0813'}
2025-03-02 15:23:26,779 - EarlyStopping counter: 1 out of 10
2025-03-02 15:24:02,024 - {'epoch': 22, 'rec_loss': '6.8089'}
2025-03-02 15:24:11,706 - {'Epoch': 22, 'HR@5': '0.0863', 'NDCG@5': '0.0611', 'HR@10': '0.1197', 'NDCG@10': '0.0718', 'HR@20': '0.1618', 'NDCG@20': '0.0824'}
2025-03-02 15:24:11,707 - Validation score increased.  Saving model ...
2025-03-02 15:24:50,823 - {'epoch': 23, 'rec_loss': '6.7962'}
2025-03-02 15:25:00,379 - {'Epoch': 23, 'HR@5': '0.0854', 'NDCG@5': '0.0602', 'HR@10': '0.1181', 'NDCG@10': '0.0707', 'HR@20': '0.1607', 'NDCG@20': '0.0814'}
2025-03-02 15:25:00,381 - EarlyStopping counter: 1 out of 10
2025-03-02 15:25:36,728 - {'epoch': 24, 'rec_loss': '6.7845'}
2025-03-02 15:25:47,106 - {'Epoch': 24, 'HR@5': '0.0869', 'NDCG@5': '0.0606', 'HR@10': '0.1196', 'NDCG@10': '0.0711', 'HR@20': '0.1629', 'NDCG@20': '0.0821'}
2025-03-02 15:25:47,108 - EarlyStopping counter: 2 out of 10
2025-03-02 15:26:27,397 - {'epoch': 25, 'rec_loss': '6.7773'}
2025-03-02 15:26:36,752 - {'Epoch': 25, 'HR@5': '0.0861', 'NDCG@5': '0.0605', 'HR@10': '0.1192', 'NDCG@10': '0.0712', 'HR@20': '0.1614', 'NDCG@20': '0.0818'}
2025-03-02 15:26:36,753 - EarlyStopping counter: 3 out of 10
2025-03-02 15:27:13,962 - {'epoch': 26, 'rec_loss': '6.7653'}
2025-03-02 15:27:24,003 - {'Epoch': 26, 'HR@5': '0.0867', 'NDCG@5': '0.0612', 'HR@10': '0.1183', 'NDCG@10': '0.0714', 'HR@20': '0.1624', 'NDCG@20': '0.0825'}
2025-03-02 15:27:24,004 - Validation score increased.  Saving model ...
2025-03-02 15:28:01,008 - {'epoch': 27, 'rec_loss': '6.7524'}
2025-03-02 15:28:10,011 - {'Epoch': 27, 'HR@5': '0.0863', 'NDCG@5': '0.0608', 'HR@10': '0.1180', 'NDCG@10': '0.0710', 'HR@20': '0.1620', 'NDCG@20': '0.0821'}
2025-03-02 15:28:10,013 - EarlyStopping counter: 1 out of 10
2025-03-02 15:28:47,584 - {'epoch': 28, 'rec_loss': '6.7452'}
2025-03-02 15:28:57,786 - {'Epoch': 28, 'HR@5': '0.0860', 'NDCG@5': '0.0606', 'HR@10': '0.1181', 'NDCG@10': '0.0709', 'HR@20': '0.1605', 'NDCG@20': '0.0816'}
2025-03-02 15:28:57,790 - EarlyStopping counter: 2 out of 10
2025-03-02 15:29:33,948 - {'epoch': 29, 'rec_loss': '6.7271'}
2025-03-02 15:29:42,517 - {'Epoch': 29, 'HR@5': '0.0869', 'NDCG@5': '0.0609', 'HR@10': '0.1203', 'NDCG@10': '0.0717', 'HR@20': '0.1645', 'NDCG@20': '0.0828'}
2025-03-02 15:29:42,524 - Validation score increased.  Saving model ...
2025-03-02 15:30:21,314 - {'epoch': 30, 'rec_loss': '6.7270'}
2025-03-02 15:30:31,462 - {'Epoch': 30, 'HR@5': '0.0856', 'NDCG@5': '0.0604', 'HR@10': '0.1188', 'NDCG@10': '0.0712', 'HR@20': '0.1622', 'NDCG@20': '0.0821'}
2025-03-02 15:30:31,468 - EarlyStopping counter: 1 out of 10
2025-03-02 15:31:06,775 - {'epoch': 31, 'rec_loss': '6.7135'}
2025-03-02 15:31:15,275 - {'Epoch': 31, 'HR@5': '0.0860', 'NDCG@5': '0.0604', 'HR@10': '0.1210', 'NDCG@10': '0.0716', 'HR@20': '0.1636', 'NDCG@20': '0.0824'}
2025-03-02 15:31:15,277 - EarlyStopping counter: 2 out of 10
2025-03-02 15:31:56,017 - {'epoch': 32, 'rec_loss': '6.7077'}
2025-03-02 15:32:05,952 - {'Epoch': 32, 'HR@5': '0.0857', 'NDCG@5': '0.0601', 'HR@10': '0.1185', 'NDCG@10': '0.0707', 'HR@20': '0.1625', 'NDCG@20': '0.0818'}
2025-03-02 15:32:05,955 - EarlyStopping counter: 3 out of 10
2025-03-02 15:32:42,811 - {'epoch': 33, 'rec_loss': '6.6987'}
2025-03-02 15:32:52,342 - {'Epoch': 33, 'HR@5': '0.0856', 'NDCG@5': '0.0604', 'HR@10': '0.1190', 'NDCG@10': '0.0711', 'HR@20': '0.1615', 'NDCG@20': '0.0818'}
2025-03-02 15:32:52,343 - EarlyStopping counter: 4 out of 10
2025-03-02 15:33:33,230 - {'epoch': 34, 'rec_loss': '6.6897'}
2025-03-02 15:33:42,797 - {'Epoch': 34, 'HR@5': '0.0863', 'NDCG@5': '0.0610', 'HR@10': '0.1203', 'NDCG@10': '0.0720', 'HR@20': '0.1633', 'NDCG@20': '0.0828'}
2025-03-02 15:33:42,804 - EarlyStopping counter: 5 out of 10
2025-03-02 15:34:24,433 - {'epoch': 35, 'rec_loss': '6.6826'}
2025-03-02 15:34:34,933 - {'Epoch': 35, 'HR@5': '0.0856', 'NDCG@5': '0.0606', 'HR@10': '0.1191', 'NDCG@10': '0.0714', 'HR@20': '0.1595', 'NDCG@20': '0.0816'}
2025-03-02 15:34:34,939 - EarlyStopping counter: 6 out of 10
2025-03-02 15:35:14,372 - {'epoch': 36, 'rec_loss': '6.6767'}
2025-03-02 15:35:23,937 - {'Epoch': 36, 'HR@5': '0.0871', 'NDCG@5': '0.0607', 'HR@10': '0.1199', 'NDCG@10': '0.0713', 'HR@20': '0.1637', 'NDCG@20': '0.0823'}
2025-03-02 15:35:23,938 - EarlyStopping counter: 7 out of 10
2025-03-02 15:36:00,641 - {'epoch': 37, 'rec_loss': '6.6703'}
2025-03-02 15:36:10,768 - {'Epoch': 37, 'HR@5': '0.0856', 'NDCG@5': '0.0603', 'HR@10': '0.1194', 'NDCG@10': '0.0712', 'HR@20': '0.1625', 'NDCG@20': '0.0821'}
2025-03-02 15:36:10,770 - EarlyStopping counter: 8 out of 10
2025-03-02 15:36:49,227 - {'epoch': 38, 'rec_loss': '6.6599'}
2025-03-02 15:36:58,754 - {'Epoch': 38, 'HR@5': '0.0850', 'NDCG@5': '0.0599', 'HR@10': '0.1193', 'NDCG@10': '0.0710', 'HR@20': '0.1626', 'NDCG@20': '0.0819'}
2025-03-02 15:36:58,756 - EarlyStopping counter: 9 out of 10
2025-03-02 15:37:37,276 - {'epoch': 39, 'rec_loss': '6.6561'}
2025-03-02 15:37:47,464 - {'Epoch': 39, 'HR@5': '0.0876', 'NDCG@5': '0.0611', 'HR@10': '0.1198', 'NDCG@10': '0.0715', 'HR@20': '0.1638', 'NDCG@20': '0.0826'}
2025-03-02 15:37:47,472 - EarlyStopping counter: 10 out of 10
2025-03-02 15:37:47,472 - Early stopping
2025-03-02 15:37:47,472 - ---------------Test Score---------------
2025-03-02 15:37:57,030 - {'Epoch': 0, 'HR@5': '0.0707', 'NDCG@5': '0.0497', 'HR@10': '0.0990', 'NDCG@10': '0.0588', 'HR@20': '0.1352', 'NDCG@20': '0.0679'}
2025-03-02 15:37:57,036 - Scale_Beauty
2025-03-02 15:37:57,036 - {'Epoch': 0, 'HR@5': '0.0707', 'NDCG@5': '0.0497', 'HR@10': '0.0990', 'NDCG@10': '0.0588', 'HR@20': '0.1352', 'NDCG@20': '0.0679'}
2025-03-02 17:37:53,233 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[12, 24, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-02 17:37:56,117 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-02 17:37:56,122 - Total Parameters: 929445
2025-03-02 17:38:25,990 - {'epoch': 0, 'rec_loss': '8.8381'}
2025-03-02 17:38:34,615 - {'Epoch': 0, 'HR@5': '0.0207', 'NDCG@5': '0.0130', 'HR@10': '0.0311', 'NDCG@10': '0.0163', 'HR@20': '0.0476', 'NDCG@20': '0.0205'}
2025-03-02 17:38:34,617 - Validation score increased.  Saving model ...
2025-03-02 17:39:00,781 - {'epoch': 1, 'rec_loss': '8.3300'}
2025-03-02 17:39:09,881 - {'Epoch': 1, 'HR@5': '0.0379', 'NDCG@5': '0.0255', 'HR@10': '0.0566', 'NDCG@10': '0.0315', 'HR@20': '0.0822', 'NDCG@20': '0.0379'}
2025-03-02 17:39:09,886 - Validation score increased.  Saving model ...
2025-03-02 17:39:36,450 - {'epoch': 2, 'rec_loss': '8.0180'}
2025-03-02 17:39:44,547 - {'Epoch': 2, 'HR@5': '0.0491', 'NDCG@5': '0.0333', 'HR@10': '0.0727', 'NDCG@10': '0.0408', 'HR@20': '0.1045', 'NDCG@20': '0.0488'}
2025-03-02 17:39:44,551 - Validation score increased.  Saving model ...
2025-03-02 17:40:13,244 - {'epoch': 3, 'rec_loss': '7.8018'}
2025-03-02 17:40:21,165 - {'Epoch': 3, 'HR@5': '0.0593', 'NDCG@5': '0.0408', 'HR@10': '0.0859', 'NDCG@10': '0.0493', 'HR@20': '0.1230', 'NDCG@20': '0.0587'}
2025-03-02 17:40:21,167 - Validation score increased.  Saving model ...
2025-03-02 17:40:49,471 - {'epoch': 4, 'rec_loss': '7.6383'}
2025-03-02 17:40:57,917 - {'Epoch': 4, 'HR@5': '0.0685', 'NDCG@5': '0.0474', 'HR@10': '0.0955', 'NDCG@10': '0.0561', 'HR@20': '0.1331', 'NDCG@20': '0.0655'}
2025-03-02 17:40:57,919 - Validation score increased.  Saving model ...
2025-03-02 17:41:25,975 - {'epoch': 5, 'rec_loss': '7.5226'}
2025-03-02 17:41:34,008 - {'Epoch': 5, 'HR@5': '0.0731', 'NDCG@5': '0.0510', 'HR@10': '0.1024', 'NDCG@10': '0.0604', 'HR@20': '0.1397', 'NDCG@20': '0.0697'}
2025-03-02 17:41:34,015 - Validation score increased.  Saving model ...
2025-03-02 17:42:02,296 - {'epoch': 6, 'rec_loss': '7.4251'}
2025-03-02 17:42:10,415 - {'Epoch': 6, 'HR@5': '0.0756', 'NDCG@5': '0.0533', 'HR@10': '0.1056', 'NDCG@10': '0.0630', 'HR@20': '0.1433', 'NDCG@20': '0.0724'}
2025-03-02 17:42:10,416 - Validation score increased.  Saving model ...
2025-03-02 17:42:41,332 - {'epoch': 7, 'rec_loss': '7.3469'}
2025-03-02 17:42:49,922 - {'Epoch': 7, 'HR@5': '0.0800', 'NDCG@5': '0.0561', 'HR@10': '0.1078', 'NDCG@10': '0.0651', 'HR@20': '0.1476', 'NDCG@20': '0.0751'}
2025-03-02 17:42:49,923 - Validation score increased.  Saving model ...
2025-03-02 17:43:18,386 - {'epoch': 8, 'rec_loss': '7.2754'}
2025-03-02 17:43:26,843 - {'Epoch': 8, 'HR@5': '0.0812', 'NDCG@5': '0.0576', 'HR@10': '0.1105', 'NDCG@10': '0.0671', 'HR@20': '0.1508', 'NDCG@20': '0.0772'}
2025-03-02 17:43:26,851 - Validation score increased.  Saving model ...
2025-03-02 17:43:54,376 - {'epoch': 9, 'rec_loss': '7.2255'}
2025-03-02 17:44:03,008 - {'Epoch': 9, 'HR@5': '0.0814', 'NDCG@5': '0.0570', 'HR@10': '0.1127', 'NDCG@10': '0.0671', 'HR@20': '0.1525', 'NDCG@20': '0.0771'}
2025-03-02 17:44:03,009 - EarlyStopping counter: 1 out of 10
2025-03-02 17:44:28,784 - {'epoch': 10, 'rec_loss': '7.1794'}
2025-03-02 17:44:37,697 - {'Epoch': 10, 'HR@5': '0.0831', 'NDCG@5': '0.0585', 'HR@10': '0.1132', 'NDCG@10': '0.0682', 'HR@20': '0.1528', 'NDCG@20': '0.0782'}
2025-03-02 17:44:37,704 - Validation score increased.  Saving model ...
2025-03-02 17:45:02,930 - {'epoch': 11, 'rec_loss': '7.1388'}
2025-03-02 17:45:11,417 - {'Epoch': 11, 'HR@5': '0.0842', 'NDCG@5': '0.0596', 'HR@10': '0.1141', 'NDCG@10': '0.0693', 'HR@20': '0.1538', 'NDCG@20': '0.0793'}
2025-03-02 17:45:11,418 - Validation score increased.  Saving model ...
2025-03-02 17:45:36,873 - {'epoch': 12, 'rec_loss': '7.1017'}
2025-03-02 17:45:45,520 - {'Epoch': 12, 'HR@5': '0.0839', 'NDCG@5': '0.0593', 'HR@10': '0.1149', 'NDCG@10': '0.0693', 'HR@20': '0.1567', 'NDCG@20': '0.0799'}
2025-03-02 17:45:45,526 - Validation score increased.  Saving model ...
2025-03-02 17:46:13,543 - {'epoch': 13, 'rec_loss': '7.0762'}
2025-03-02 17:46:22,233 - {'Epoch': 13, 'HR@5': '0.0848', 'NDCG@5': '0.0597', 'HR@10': '0.1181', 'NDCG@10': '0.0705', 'HR@20': '0.1586', 'NDCG@20': '0.0807'}
2025-03-02 17:46:22,235 - Validation score increased.  Saving model ...
2025-03-02 17:46:50,667 - {'epoch': 14, 'rec_loss': '7.0442'}
2025-03-02 17:46:58,794 - {'Epoch': 14, 'HR@5': '0.0865', 'NDCG@5': '0.0603', 'HR@10': '0.1187', 'NDCG@10': '0.0707', 'HR@20': '0.1596', 'NDCG@20': '0.0810'}
2025-03-02 17:46:58,795 - Validation score increased.  Saving model ...
2025-03-02 17:47:26,686 - {'epoch': 15, 'rec_loss': '7.0242'}
2025-03-02 17:47:35,831 - {'Epoch': 15, 'HR@5': '0.0859', 'NDCG@5': '0.0604', 'HR@10': '0.1187', 'NDCG@10': '0.0709', 'HR@20': '0.1613', 'NDCG@20': '0.0816'}
2025-03-02 17:47:35,833 - Validation score increased.  Saving model ...
2025-03-02 17:48:02,636 - {'epoch': 16, 'rec_loss': '7.0009'}
2025-03-02 17:48:11,428 - {'Epoch': 16, 'HR@5': '0.0861', 'NDCG@5': '0.0603', 'HR@10': '0.1189', 'NDCG@10': '0.0709', 'HR@20': '0.1617', 'NDCG@20': '0.0816'}
2025-03-02 17:48:11,434 - Validation score increased.  Saving model ...
2025-03-02 17:48:42,206 - {'epoch': 17, 'rec_loss': '6.9861'}
2025-03-02 17:48:51,297 - {'Epoch': 17, 'HR@5': '0.0848', 'NDCG@5': '0.0607', 'HR@10': '0.1189', 'NDCG@10': '0.0717', 'HR@20': '0.1618', 'NDCG@20': '0.0825'}
2025-03-02 17:48:51,299 - Validation score increased.  Saving model ...
2025-03-02 17:49:19,535 - {'epoch': 18, 'rec_loss': '6.9525'}
2025-03-02 17:49:28,379 - {'Epoch': 18, 'HR@5': '0.0859', 'NDCG@5': '0.0607', 'HR@10': '0.1185', 'NDCG@10': '0.0712', 'HR@20': '0.1617', 'NDCG@20': '0.0820'}
2025-03-02 17:49:28,386 - EarlyStopping counter: 1 out of 10
2025-03-02 17:49:56,706 - {'epoch': 19, 'rec_loss': '6.9429'}
2025-03-02 17:50:05,057 - {'Epoch': 19, 'HR@5': '0.0865', 'NDCG@5': '0.0616', 'HR@10': '0.1186', 'NDCG@10': '0.0719', 'HR@20': '0.1615', 'NDCG@20': '0.0827'}
2025-03-02 17:50:05,063 - Validation score increased.  Saving model ...
2025-03-02 17:50:31,789 - {'epoch': 20, 'rec_loss': '6.9235'}
2025-03-02 17:50:40,678 - {'Epoch': 20, 'HR@5': '0.0856', 'NDCG@5': '0.0612', 'HR@10': '0.1206', 'NDCG@10': '0.0725', 'HR@20': '0.1625', 'NDCG@20': '0.0830'}
2025-03-02 17:50:40,684 - Validation score increased.  Saving model ...
2025-03-02 17:51:05,971 - {'epoch': 21, 'rec_loss': '6.9142'}
2025-03-02 17:51:15,249 - {'Epoch': 21, 'HR@5': '0.0871', 'NDCG@5': '0.0614', 'HR@10': '0.1203', 'NDCG@10': '0.0721', 'HR@20': '0.1633', 'NDCG@20': '0.0829'}
2025-03-02 17:51:15,251 - EarlyStopping counter: 1 out of 10
2025-03-02 17:51:40,976 - {'epoch': 22, 'rec_loss': '6.9033'}
2025-03-02 17:51:49,325 - {'Epoch': 22, 'HR@5': '0.0874', 'NDCG@5': '0.0622', 'HR@10': '0.1216', 'NDCG@10': '0.0732', 'HR@20': '0.1640', 'NDCG@20': '0.0839'}
2025-03-02 17:51:49,327 - Validation score increased.  Saving model ...
2025-03-02 17:52:18,279 - {'epoch': 23, 'rec_loss': '6.8861'}
2025-03-02 17:52:27,066 - {'Epoch': 23, 'HR@5': '0.0872', 'NDCG@5': '0.0619', 'HR@10': '0.1208', 'NDCG@10': '0.0727', 'HR@20': '0.1627', 'NDCG@20': '0.0832'}
2025-03-02 17:52:27,067 - EarlyStopping counter: 1 out of 10
2025-03-02 17:52:55,416 - {'epoch': 24, 'rec_loss': '6.8787'}
2025-03-02 17:53:04,388 - {'Epoch': 24, 'HR@5': '0.0874', 'NDCG@5': '0.0616', 'HR@10': '0.1206', 'NDCG@10': '0.0722', 'HR@20': '0.1616', 'NDCG@20': '0.0825'}
2025-03-02 17:53:04,390 - EarlyStopping counter: 2 out of 10
2025-03-02 17:53:31,057 - {'epoch': 25, 'rec_loss': '6.8582'}
2025-03-02 17:53:39,955 - {'Epoch': 25, 'HR@5': '0.0871', 'NDCG@5': '0.0613', 'HR@10': '0.1214', 'NDCG@10': '0.0724', 'HR@20': '0.1645', 'NDCG@20': '0.0832'}
2025-03-02 17:53:39,962 - EarlyStopping counter: 3 out of 10
2025-03-02 17:54:07,729 - {'epoch': 26, 'rec_loss': '6.8545'}
2025-03-02 17:54:16,311 - {'Epoch': 26, 'HR@5': '0.0884', 'NDCG@5': '0.0623', 'HR@10': '0.1204', 'NDCG@10': '0.0726', 'HR@20': '0.1647', 'NDCG@20': '0.0838'}
2025-03-02 17:54:16,312 - EarlyStopping counter: 4 out of 10
2025-03-02 17:54:42,038 - {'epoch': 27, 'rec_loss': '6.8399'}
2025-03-02 17:54:51,071 - {'Epoch': 27, 'HR@5': '0.0873', 'NDCG@5': '0.0621', 'HR@10': '0.1193', 'NDCG@10': '0.0725', 'HR@20': '0.1618', 'NDCG@20': '0.0832'}
2025-03-02 17:54:51,073 - EarlyStopping counter: 5 out of 10
2025-03-02 17:55:19,894 - {'epoch': 28, 'rec_loss': '6.8345'}
2025-03-02 17:55:28,818 - {'Epoch': 28, 'HR@5': '0.0881', 'NDCG@5': '0.0620', 'HR@10': '0.1218', 'NDCG@10': '0.0728', 'HR@20': '0.1624', 'NDCG@20': '0.0830'}
2025-03-02 17:55:28,824 - EarlyStopping counter: 6 out of 10
2025-03-02 17:55:57,086 - {'epoch': 29, 'rec_loss': '6.8271'}
2025-03-02 17:56:05,671 - {'Epoch': 29, 'HR@5': '0.0860', 'NDCG@5': '0.0607', 'HR@10': '0.1215', 'NDCG@10': '0.0722', 'HR@20': '0.1639', 'NDCG@20': '0.0828'}
2025-03-02 17:56:05,672 - EarlyStopping counter: 7 out of 10
2025-03-02 17:56:30,754 - {'epoch': 30, 'rec_loss': '6.8159'}
2025-03-02 17:56:39,489 - {'Epoch': 30, 'HR@5': '0.0874', 'NDCG@5': '0.0618', 'HR@10': '0.1201', 'NDCG@10': '0.0723', 'HR@20': '0.1651', 'NDCG@20': '0.0837'}
2025-03-02 17:56:39,491 - EarlyStopping counter: 8 out of 10
2025-03-02 17:57:06,677 - {'epoch': 31, 'rec_loss': '6.8016'}
2025-03-02 17:57:16,044 - {'Epoch': 31, 'HR@5': '0.0878', 'NDCG@5': '0.0622', 'HR@10': '0.1203', 'NDCG@10': '0.0727', 'HR@20': '0.1644', 'NDCG@20': '0.0838'}
2025-03-02 17:57:16,045 - EarlyStopping counter: 9 out of 10
2025-03-02 17:57:44,380 - {'epoch': 32, 'rec_loss': '6.7981'}
2025-03-02 17:57:53,288 - {'Epoch': 32, 'HR@5': '0.0882', 'NDCG@5': '0.0627', 'HR@10': '0.1205', 'NDCG@10': '0.0730', 'HR@20': '0.1638', 'NDCG@20': '0.0840'}
2025-03-02 17:57:53,289 - Validation score increased.  Saving model ...
2025-03-02 17:58:21,949 - {'epoch': 33, 'rec_loss': '6.7953'}
2025-03-02 17:58:30,981 - {'Epoch': 33, 'HR@5': '0.0875', 'NDCG@5': '0.0621', 'HR@10': '0.1189', 'NDCG@10': '0.0722', 'HR@20': '0.1626', 'NDCG@20': '0.0832'}
2025-03-02 17:58:30,982 - EarlyStopping counter: 1 out of 10
2025-03-02 17:58:58,503 - {'epoch': 34, 'rec_loss': '6.7790'}
2025-03-02 17:59:07,701 - {'Epoch': 34, 'HR@5': '0.0889', 'NDCG@5': '0.0623', 'HR@10': '0.1197', 'NDCG@10': '0.0721', 'HR@20': '0.1621', 'NDCG@20': '0.0828'}
2025-03-02 17:59:07,708 - EarlyStopping counter: 2 out of 10
2025-03-02 17:59:36,141 - {'epoch': 35, 'rec_loss': '6.7751'}
2025-03-02 17:59:44,620 - {'Epoch': 35, 'HR@5': '0.0863', 'NDCG@5': '0.0612', 'HR@10': '0.1182', 'NDCG@10': '0.0714', 'HR@20': '0.1636', 'NDCG@20': '0.0828'}
2025-03-02 17:59:44,621 - EarlyStopping counter: 3 out of 10
2025-03-02 18:00:10,543 - {'epoch': 36, 'rec_loss': '6.7673'}
2025-03-02 18:00:19,056 - {'Epoch': 36, 'HR@5': '0.0864', 'NDCG@5': '0.0616', 'HR@10': '0.1202', 'NDCG@10': '0.0726', 'HR@20': '0.1645', 'NDCG@20': '0.0837'}
2025-03-02 18:00:19,057 - EarlyStopping counter: 4 out of 10
2025-03-02 18:00:47,605 - {'epoch': 37, 'rec_loss': '6.7510'}
2025-03-02 18:00:56,176 - {'Epoch': 37, 'HR@5': '0.0868', 'NDCG@5': '0.0613', 'HR@10': '0.1208', 'NDCG@10': '0.0723', 'HR@20': '0.1652', 'NDCG@20': '0.0835'}
2025-03-02 18:00:56,178 - EarlyStopping counter: 5 out of 10
2025-03-02 18:01:23,749 - {'epoch': 38, 'rec_loss': '6.7525'}
2025-03-02 18:01:33,359 - {'Epoch': 38, 'HR@5': '0.0868', 'NDCG@5': '0.0610', 'HR@10': '0.1209', 'NDCG@10': '0.0720', 'HR@20': '0.1632', 'NDCG@20': '0.0827'}
2025-03-02 18:01:33,361 - EarlyStopping counter: 6 out of 10
2025-03-02 18:01:59,617 - {'epoch': 39, 'rec_loss': '6.7464'}
2025-03-02 18:02:08,459 - {'Epoch': 39, 'HR@5': '0.0845', 'NDCG@5': '0.0599', 'HR@10': '0.1196', 'NDCG@10': '0.0712', 'HR@20': '0.1617', 'NDCG@20': '0.0818'}
2025-03-02 18:02:08,464 - EarlyStopping counter: 7 out of 10
2025-03-02 18:02:37,031 - {'epoch': 40, 'rec_loss': '6.7477'}
2025-03-02 18:02:45,936 - {'Epoch': 40, 'HR@5': '0.0872', 'NDCG@5': '0.0616', 'HR@10': '0.1206', 'NDCG@10': '0.0724', 'HR@20': '0.1643', 'NDCG@20': '0.0834'}
2025-03-02 18:02:45,942 - EarlyStopping counter: 8 out of 10
2025-03-02 18:03:14,165 - {'epoch': 41, 'rec_loss': '6.7359'}
2025-03-02 18:03:22,973 - {'Epoch': 41, 'HR@5': '0.0878', 'NDCG@5': '0.0621', 'HR@10': '0.1203', 'NDCG@10': '0.0726', 'HR@20': '0.1637', 'NDCG@20': '0.0835'}
2025-03-02 18:03:22,979 - EarlyStopping counter: 9 out of 10
2025-03-02 18:03:51,285 - {'epoch': 42, 'rec_loss': '6.7321'}
2025-03-02 18:04:00,917 - {'Epoch': 42, 'HR@5': '0.0887', 'NDCG@5': '0.0631', 'HR@10': '0.1210', 'NDCG@10': '0.0734', 'HR@20': '0.1642', 'NDCG@20': '0.0843'}
2025-03-02 18:04:00,924 - Validation score increased.  Saving model ...
2025-03-02 18:04:29,012 - {'epoch': 43, 'rec_loss': '6.7176'}
2025-03-02 18:04:37,450 - {'Epoch': 43, 'HR@5': '0.0870', 'NDCG@5': '0.0612', 'HR@10': '0.1197', 'NDCG@10': '0.0717', 'HR@20': '0.1629', 'NDCG@20': '0.0827'}
2025-03-02 18:04:37,455 - EarlyStopping counter: 1 out of 10
2025-03-02 18:05:05,604 - {'epoch': 44, 'rec_loss': '6.7204'}
2025-03-02 18:05:13,705 - {'Epoch': 44, 'HR@5': '0.0875', 'NDCG@5': '0.0621', 'HR@10': '0.1193', 'NDCG@10': '0.0723', 'HR@20': '0.1637', 'NDCG@20': '0.0835'}
2025-03-02 18:05:13,707 - EarlyStopping counter: 2 out of 10
2025-03-02 18:05:41,593 - {'epoch': 45, 'rec_loss': '6.7136'}
2025-03-02 18:05:50,377 - {'Epoch': 45, 'HR@5': '0.0880', 'NDCG@5': '0.0623', 'HR@10': '0.1209', 'NDCG@10': '0.0729', 'HR@20': '0.1647', 'NDCG@20': '0.0840'}
2025-03-02 18:05:50,378 - EarlyStopping counter: 3 out of 10
2025-03-02 18:06:18,070 - {'epoch': 46, 'rec_loss': '6.7027'}
2025-03-02 18:06:27,614 - {'Epoch': 46, 'HR@5': '0.0887', 'NDCG@5': '0.0629', 'HR@10': '0.1210', 'NDCG@10': '0.0732', 'HR@20': '0.1659', 'NDCG@20': '0.0845'}
2025-03-02 18:06:27,615 - Validation score increased.  Saving model ...
2025-03-02 18:06:54,509 - {'epoch': 47, 'rec_loss': '6.6990'}
2025-03-02 18:07:03,613 - {'Epoch': 47, 'HR@5': '0.0876', 'NDCG@5': '0.0623', 'HR@10': '0.1213', 'NDCG@10': '0.0731', 'HR@20': '0.1638', 'NDCG@20': '0.0838'}
2025-03-02 18:07:03,618 - EarlyStopping counter: 1 out of 10
2025-03-02 18:07:31,625 - {'epoch': 48, 'rec_loss': '6.6962'}
2025-03-02 18:07:40,384 - {'Epoch': 48, 'HR@5': '0.0878', 'NDCG@5': '0.0619', 'HR@10': '0.1202', 'NDCG@10': '0.0724', 'HR@20': '0.1633', 'NDCG@20': '0.0833'}
2025-03-02 18:07:40,386 - EarlyStopping counter: 2 out of 10
2025-03-02 18:08:11,058 - {'epoch': 49, 'rec_loss': '6.6888'}
2025-03-02 18:08:20,019 - {'Epoch': 49, 'HR@5': '0.0876', 'NDCG@5': '0.0618', 'HR@10': '0.1198', 'NDCG@10': '0.0722', 'HR@20': '0.1641', 'NDCG@20': '0.0834'}
2025-03-02 18:08:20,025 - EarlyStopping counter: 3 out of 10
2025-03-02 18:08:49,646 - {'epoch': 50, 'rec_loss': '6.6896'}
2025-03-02 18:08:58,317 - {'Epoch': 50, 'HR@5': '0.0883', 'NDCG@5': '0.0625', 'HR@10': '0.1202', 'NDCG@10': '0.0729', 'HR@20': '0.1647', 'NDCG@20': '0.0841'}
2025-03-02 18:08:58,318 - EarlyStopping counter: 4 out of 10
2025-03-02 18:09:26,220 - {'epoch': 51, 'rec_loss': '6.6850'}
2025-03-02 18:09:35,197 - {'Epoch': 51, 'HR@5': '0.0875', 'NDCG@5': '0.0623', 'HR@10': '0.1189', 'NDCG@10': '0.0725', 'HR@20': '0.1642', 'NDCG@20': '0.0839'}
2025-03-02 18:09:35,202 - EarlyStopping counter: 5 out of 10
2025-03-02 18:10:03,741 - {'epoch': 52, 'rec_loss': '6.6743'}
2025-03-02 18:10:12,946 - {'Epoch': 52, 'HR@5': '0.0863', 'NDCG@5': '0.0620', 'HR@10': '0.1185', 'NDCG@10': '0.0723', 'HR@20': '0.1635', 'NDCG@20': '0.0837'}
2025-03-02 18:10:12,950 - EarlyStopping counter: 6 out of 10
2025-03-02 18:10:43,366 - {'epoch': 53, 'rec_loss': '6.6780'}
2025-03-02 18:10:52,292 - {'Epoch': 53, 'HR@5': '0.0878', 'NDCG@5': '0.0624', 'HR@10': '0.1207', 'NDCG@10': '0.0730', 'HR@20': '0.1646', 'NDCG@20': '0.0840'}
2025-03-02 18:10:52,297 - EarlyStopping counter: 7 out of 10
2025-03-02 18:11:22,817 - {'epoch': 54, 'rec_loss': '6.6702'}
2025-03-02 18:11:32,011 - {'Epoch': 54, 'HR@5': '0.0883', 'NDCG@5': '0.0626', 'HR@10': '0.1201', 'NDCG@10': '0.0729', 'HR@20': '0.1637', 'NDCG@20': '0.0838'}
2025-03-02 18:11:32,015 - EarlyStopping counter: 8 out of 10
2025-03-02 18:12:02,044 - {'epoch': 55, 'rec_loss': '6.6664'}
2025-03-02 18:12:11,387 - {'Epoch': 55, 'HR@5': '0.0883', 'NDCG@5': '0.0629', 'HR@10': '0.1214', 'NDCG@10': '0.0736', 'HR@20': '0.1648', 'NDCG@20': '0.0845'}
2025-03-02 18:12:11,388 - EarlyStopping counter: 9 out of 10
2025-03-02 18:12:39,960 - {'epoch': 56, 'rec_loss': '6.6630'}
2025-03-02 18:12:48,973 - {'Epoch': 56, 'HR@5': '0.0877', 'NDCG@5': '0.0627', 'HR@10': '0.1205', 'NDCG@10': '0.0732', 'HR@20': '0.1634', 'NDCG@20': '0.0840'}
2025-03-02 18:12:48,974 - EarlyStopping counter: 10 out of 10
2025-03-02 18:12:48,975 - Early stopping
2025-03-02 18:12:48,975 - ---------------Test Score---------------
2025-03-02 18:12:57,925 - {'Epoch': 0, 'HR@5': '0.0722', 'NDCG@5': '0.0516', 'HR@10': '0.0990', 'NDCG@10': '0.0602', 'HR@20': '0.1368', 'NDCG@20': '0.0697'}
2025-03-02 18:12:57,926 - Scale_Beauty
2025-03-02 18:12:57,926 - {'Epoch': 0, 'HR@5': '0.0722', 'NDCG@5': '0.0516', 'HR@10': '0.0990', 'NDCG@10': '0.0602', 'HR@20': '0.1368', 'NDCG@20': '0.0697'}
2025-03-02 18:36:58,596 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 16, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-02 18:37:02,062 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-02 18:37:02,067 - Total Parameters: 929445
2025-03-02 18:37:34,238 - {'epoch': 0, 'rec_loss': '8.8357'}
2025-03-02 18:37:43,314 - {'Epoch': 0, 'HR@5': '0.0204', 'NDCG@5': '0.0128', 'HR@10': '0.0309', 'NDCG@10': '0.0162', 'HR@20': '0.0474', 'NDCG@20': '0.0203'}
2025-03-02 18:37:43,315 - Validation score increased.  Saving model ...
2025-03-02 18:38:13,240 - {'epoch': 1, 'rec_loss': '8.3282'}
2025-03-02 18:38:22,888 - {'Epoch': 1, 'HR@5': '0.0374', 'NDCG@5': '0.0253', 'HR@10': '0.0566', 'NDCG@10': '0.0315', 'HR@20': '0.0823', 'NDCG@20': '0.0379'}
2025-03-02 18:38:22,893 - Validation score increased.  Saving model ...
2025-03-02 18:38:57,193 - {'epoch': 2, 'rec_loss': '8.0164'}
2025-03-02 18:39:06,526 - {'Epoch': 2, 'HR@5': '0.0490', 'NDCG@5': '0.0331', 'HR@10': '0.0726', 'NDCG@10': '0.0407', 'HR@20': '0.1046', 'NDCG@20': '0.0487'}
2025-03-02 18:39:06,532 - Validation score increased.  Saving model ...
2025-03-02 18:39:41,169 - {'epoch': 3, 'rec_loss': '7.7998'}
2025-03-02 18:39:50,141 - {'Epoch': 3, 'HR@5': '0.0594', 'NDCG@5': '0.0405', 'HR@10': '0.0859', 'NDCG@10': '0.0490', 'HR@20': '0.1231', 'NDCG@20': '0.0585'}
2025-03-02 18:39:50,147 - Validation score increased.  Saving model ...
2025-03-02 18:40:27,077 - {'epoch': 4, 'rec_loss': '7.6365'}
2025-03-02 18:40:36,137 - {'Epoch': 4, 'HR@5': '0.0683', 'NDCG@5': '0.0473', 'HR@10': '0.0951', 'NDCG@10': '0.0559', 'HR@20': '0.1329', 'NDCG@20': '0.0654'}
2025-03-02 18:40:36,145 - Validation score increased.  Saving model ...
2025-03-02 18:41:10,568 - {'epoch': 5, 'rec_loss': '7.5211'}
2025-03-02 18:41:18,888 - {'Epoch': 5, 'HR@5': '0.0730', 'NDCG@5': '0.0508', 'HR@10': '0.1028', 'NDCG@10': '0.0604', 'HR@20': '0.1404', 'NDCG@20': '0.0698'}
2025-03-02 18:41:18,890 - Validation score increased.  Saving model ...
2025-03-02 18:41:49,768 - {'epoch': 6, 'rec_loss': '7.4233'}
2025-03-02 18:41:57,720 - {'Epoch': 6, 'HR@5': '0.0760', 'NDCG@5': '0.0534', 'HR@10': '0.1054', 'NDCG@10': '0.0629', 'HR@20': '0.1444', 'NDCG@20': '0.0727'}
2025-03-02 18:41:57,725 - Validation score increased.  Saving model ...
2025-03-02 18:42:28,064 - {'epoch': 7, 'rec_loss': '7.3446'}
2025-03-02 18:42:37,131 - {'Epoch': 7, 'HR@5': '0.0800', 'NDCG@5': '0.0563', 'HR@10': '0.1078', 'NDCG@10': '0.0652', 'HR@20': '0.1482', 'NDCG@20': '0.0754'}
2025-03-02 18:42:37,133 - Validation score increased.  Saving model ...
2025-03-02 18:43:12,015 - {'epoch': 8, 'rec_loss': '7.2736'}
2025-03-02 18:43:21,195 - {'Epoch': 8, 'HR@5': '0.0820', 'NDCG@5': '0.0578', 'HR@10': '0.1109', 'NDCG@10': '0.0671', 'HR@20': '0.1499', 'NDCG@20': '0.0769'}
2025-03-02 18:43:21,196 - Validation score increased.  Saving model ...
2025-03-02 18:43:55,955 - {'epoch': 9, 'rec_loss': '7.2244'}
2025-03-02 18:44:05,190 - {'Epoch': 9, 'HR@5': '0.0811', 'NDCG@5': '0.0569', 'HR@10': '0.1128', 'NDCG@10': '0.0671', 'HR@20': '0.1518', 'NDCG@20': '0.0769'}
2025-03-02 18:44:05,197 - EarlyStopping counter: 1 out of 10
2025-03-02 18:44:41,843 - {'epoch': 10, 'rec_loss': '7.1772'}
2025-03-02 18:44:51,245 - {'Epoch': 10, 'HR@5': '0.0832', 'NDCG@5': '0.0588', 'HR@10': '0.1130', 'NDCG@10': '0.0684', 'HR@20': '0.1524', 'NDCG@20': '0.0783'}
2025-03-02 18:44:51,251 - Validation score increased.  Saving model ...
2025-03-02 18:45:25,300 - {'epoch': 11, 'rec_loss': '7.1377'}
2025-03-02 18:45:34,298 - {'Epoch': 11, 'HR@5': '0.0836', 'NDCG@5': '0.0595', 'HR@10': '0.1141', 'NDCG@10': '0.0694', 'HR@20': '0.1538', 'NDCG@20': '0.0794'}
2025-03-02 18:45:34,305 - Validation score increased.  Saving model ...
2025-03-02 18:46:08,935 - {'epoch': 12, 'rec_loss': '7.1006'}
2025-03-02 18:46:18,432 - {'Epoch': 12, 'HR@5': '0.0842', 'NDCG@5': '0.0596', 'HR@10': '0.1150', 'NDCG@10': '0.0695', 'HR@20': '0.1570', 'NDCG@20': '0.0801'}
2025-03-02 18:46:18,433 - Validation score increased.  Saving model ...
2025-03-02 18:46:54,658 - {'epoch': 13, 'rec_loss': '7.0746'}
2025-03-02 18:47:04,214 - {'Epoch': 13, 'HR@5': '0.0844', 'NDCG@5': '0.0593', 'HR@10': '0.1182', 'NDCG@10': '0.0703', 'HR@20': '0.1584', 'NDCG@20': '0.0804'}
2025-03-02 18:47:04,221 - Validation score increased.  Saving model ...
2025-03-02 18:47:40,616 - {'epoch': 14, 'rec_loss': '7.0429'}
2025-03-02 18:47:49,455 - {'Epoch': 14, 'HR@5': '0.0868', 'NDCG@5': '0.0604', 'HR@10': '0.1183', 'NDCG@10': '0.0705', 'HR@20': '0.1599', 'NDCG@20': '0.0810'}
2025-03-02 18:47:49,463 - Validation score increased.  Saving model ...
2025-03-02 18:48:19,281 - {'epoch': 15, 'rec_loss': '7.0236'}
2025-03-02 18:48:28,002 - {'Epoch': 15, 'HR@5': '0.0859', 'NDCG@5': '0.0603', 'HR@10': '0.1187', 'NDCG@10': '0.0709', 'HR@20': '0.1606', 'NDCG@20': '0.0814'}
2025-03-02 18:48:28,004 - Validation score increased.  Saving model ...
2025-03-02 18:48:58,114 - {'epoch': 16, 'rec_loss': '7.0005'}
2025-03-02 18:49:07,068 - {'Epoch': 16, 'HR@5': '0.0866', 'NDCG@5': '0.0605', 'HR@10': '0.1188', 'NDCG@10': '0.0709', 'HR@20': '0.1611', 'NDCG@20': '0.0815'}
2025-03-02 18:49:07,074 - Validation score increased.  Saving model ...
2025-03-02 18:49:40,161 - {'epoch': 17, 'rec_loss': '6.9850'}
2025-03-02 18:49:49,331 - {'Epoch': 17, 'HR@5': '0.0844', 'NDCG@5': '0.0606', 'HR@10': '0.1195', 'NDCG@10': '0.0719', 'HR@20': '0.1612', 'NDCG@20': '0.0824'}
2025-03-02 18:49:49,338 - Validation score increased.  Saving model ...
2025-03-02 18:50:23,122 - {'epoch': 18, 'rec_loss': '6.9522'}
2025-03-02 18:50:32,654 - {'Epoch': 18, 'HR@5': '0.0863', 'NDCG@5': '0.0606', 'HR@10': '0.1189', 'NDCG@10': '0.0711', 'HR@20': '0.1612', 'NDCG@20': '0.0818'}
2025-03-02 18:50:32,664 - EarlyStopping counter: 1 out of 10
2025-03-02 18:51:06,810 - {'epoch': 19, 'rec_loss': '6.9423'}
2025-03-02 18:51:15,888 - {'Epoch': 19, 'HR@5': '0.0860', 'NDCG@5': '0.0615', 'HR@10': '0.1183', 'NDCG@10': '0.0719', 'HR@20': '0.1617', 'NDCG@20': '0.0828'}
2025-03-02 18:51:15,889 - Validation score increased.  Saving model ...
2025-03-02 18:51:51,730 - {'epoch': 20, 'rec_loss': '6.9223'}
2025-03-02 18:52:01,258 - {'Epoch': 20, 'HR@5': '0.0863', 'NDCG@5': '0.0613', 'HR@10': '0.1204', 'NDCG@10': '0.0724', 'HR@20': '0.1625', 'NDCG@20': '0.0830'}
2025-03-02 18:52:01,260 - Validation score increased.  Saving model ...
2025-03-02 18:52:33,140 - {'epoch': 21, 'rec_loss': '6.9133'}
2025-03-02 18:52:42,331 - {'Epoch': 21, 'HR@5': '0.0872', 'NDCG@5': '0.0617', 'HR@10': '0.1206', 'NDCG@10': '0.0725', 'HR@20': '0.1625', 'NDCG@20': '0.0830'}
2025-03-02 18:52:42,338 - Validation score increased.  Saving model ...
2025-03-02 18:53:11,801 - {'epoch': 22, 'rec_loss': '6.9027'}
2025-03-02 18:53:21,258 - {'Epoch': 22, 'HR@5': '0.0874', 'NDCG@5': '0.0619', 'HR@10': '0.1213', 'NDCG@10': '0.0728', 'HR@20': '0.1636', 'NDCG@20': '0.0834'}
2025-03-02 18:53:21,265 - Validation score increased.  Saving model ...
2025-03-02 18:53:51,528 - {'epoch': 23, 'rec_loss': '6.8853'}
2025-03-02 18:54:00,205 - {'Epoch': 23, 'HR@5': '0.0884', 'NDCG@5': '0.0626', 'HR@10': '0.1212', 'NDCG@10': '0.0731', 'HR@20': '0.1624', 'NDCG@20': '0.0834'}
2025-03-02 18:54:00,207 - EarlyStopping counter: 1 out of 10
2025-03-02 18:54:29,238 - {'epoch': 24, 'rec_loss': '6.8781'}
2025-03-02 18:54:38,116 - {'Epoch': 24, 'HR@5': '0.0884', 'NDCG@5': '0.0620', 'HR@10': '0.1203', 'NDCG@10': '0.0722', 'HR@20': '0.1627', 'NDCG@20': '0.0829'}
2025-03-02 18:54:38,122 - EarlyStopping counter: 2 out of 10
2025-03-02 18:55:10,425 - {'epoch': 25, 'rec_loss': '6.8581'}
2025-03-02 18:55:18,812 - {'Epoch': 25, 'HR@5': '0.0873', 'NDCG@5': '0.0614', 'HR@10': '0.1210', 'NDCG@10': '0.0723', 'HR@20': '0.1634', 'NDCG@20': '0.0830'}
2025-03-02 18:55:18,813 - EarlyStopping counter: 3 out of 10
2025-03-02 18:55:48,525 - {'epoch': 26, 'rec_loss': '6.8536'}
2025-03-02 18:55:57,275 - {'Epoch': 26, 'HR@5': '0.0878', 'NDCG@5': '0.0619', 'HR@10': '0.1212', 'NDCG@10': '0.0727', 'HR@20': '0.1634', 'NDCG@20': '0.0833'}
2025-03-02 18:55:57,276 - EarlyStopping counter: 4 out of 10
2025-03-02 18:56:26,366 - {'epoch': 27, 'rec_loss': '6.8385'}
2025-03-02 18:56:34,821 - {'Epoch': 27, 'HR@5': '0.0872', 'NDCG@5': '0.0619', 'HR@10': '0.1200', 'NDCG@10': '0.0725', 'HR@20': '0.1623', 'NDCG@20': '0.0831'}
2025-03-02 18:56:34,823 - EarlyStopping counter: 5 out of 10
2025-03-02 18:57:05,009 - {'epoch': 28, 'rec_loss': '6.8341'}
2025-03-02 18:57:13,441 - {'Epoch': 28, 'HR@5': '0.0878', 'NDCG@5': '0.0619', 'HR@10': '0.1219', 'NDCG@10': '0.0728', 'HR@20': '0.1628', 'NDCG@20': '0.0831'}
2025-03-02 18:57:13,442 - EarlyStopping counter: 6 out of 10
2025-03-02 18:57:45,257 - {'epoch': 29, 'rec_loss': '6.8257'}
2025-03-02 18:57:54,339 - {'Epoch': 29, 'HR@5': '0.0862', 'NDCG@5': '0.0606', 'HR@10': '0.1212', 'NDCG@10': '0.0719', 'HR@20': '0.1635', 'NDCG@20': '0.0825'}
2025-03-02 18:57:54,341 - EarlyStopping counter: 7 out of 10
2025-03-02 18:58:22,704 - {'epoch': 30, 'rec_loss': '6.8152'}
2025-03-02 18:58:31,406 - {'Epoch': 30, 'HR@5': '0.0871', 'NDCG@5': '0.0615', 'HR@10': '0.1207', 'NDCG@10': '0.0723', 'HR@20': '0.1650', 'NDCG@20': '0.0835'}
2025-03-02 18:58:31,411 - Validation score increased.  Saving model ...
2025-03-02 18:59:02,953 - {'epoch': 31, 'rec_loss': '6.8008'}
2025-03-02 18:59:12,408 - {'Epoch': 31, 'HR@5': '0.0888', 'NDCG@5': '0.0626', 'HR@10': '0.1208', 'NDCG@10': '0.0729', 'HR@20': '0.1645', 'NDCG@20': '0.0839'}
2025-03-02 18:59:12,409 - Validation score increased.  Saving model ...
2025-03-02 18:59:42,221 - {'epoch': 32, 'rec_loss': '6.7973'}
2025-03-02 18:59:51,051 - {'Epoch': 32, 'HR@5': '0.0889', 'NDCG@5': '0.0630', 'HR@10': '0.1217', 'NDCG@10': '0.0735', 'HR@20': '0.1636', 'NDCG@20': '0.0841'}
2025-03-02 18:59:51,053 - Validation score increased.  Saving model ...
2025-03-02 19:00:19,867 - {'epoch': 33, 'rec_loss': '6.7949'}
2025-03-02 19:00:28,878 - {'Epoch': 33, 'HR@5': '0.0882', 'NDCG@5': '0.0629', 'HR@10': '0.1193', 'NDCG@10': '0.0729', 'HR@20': '0.1621', 'NDCG@20': '0.0837'}
2025-03-02 19:00:28,879 - EarlyStopping counter: 1 out of 10
2025-03-02 19:01:00,677 - {'epoch': 34, 'rec_loss': '6.7779'}
2025-03-02 19:01:09,439 - {'Epoch': 34, 'HR@5': '0.0886', 'NDCG@5': '0.0626', 'HR@10': '0.1201', 'NDCG@10': '0.0727', 'HR@20': '0.1625', 'NDCG@20': '0.0834'}
2025-03-02 19:01:09,440 - EarlyStopping counter: 2 out of 10
2025-03-02 19:01:42,627 - {'epoch': 35, 'rec_loss': '6.7742'}
2025-03-02 19:01:51,896 - {'Epoch': 35, 'HR@5': '0.0865', 'NDCG@5': '0.0613', 'HR@10': '0.1185', 'NDCG@10': '0.0716', 'HR@20': '0.1635', 'NDCG@20': '0.0829'}
2025-03-02 19:01:51,897 - EarlyStopping counter: 3 out of 10
2025-03-02 19:02:21,574 - {'epoch': 36, 'rec_loss': '6.7661'}
2025-03-02 19:02:30,598 - {'Epoch': 36, 'HR@5': '0.0868', 'NDCG@5': '0.0620', 'HR@10': '0.1215', 'NDCG@10': '0.0732', 'HR@20': '0.1635', 'NDCG@20': '0.0838'}
2025-03-02 19:02:30,599 - EarlyStopping counter: 4 out of 10
2025-03-02 19:03:02,291 - {'epoch': 37, 'rec_loss': '6.7499'}
2025-03-02 19:03:10,785 - {'Epoch': 37, 'HR@5': '0.0865', 'NDCG@5': '0.0614', 'HR@10': '0.1216', 'NDCG@10': '0.0727', 'HR@20': '0.1658', 'NDCG@20': '0.0838'}
2025-03-02 19:03:10,787 - EarlyStopping counter: 5 out of 10
2025-03-02 19:03:39,358 - {'epoch': 38, 'rec_loss': '6.7517'}
2025-03-02 19:03:48,178 - {'Epoch': 38, 'HR@5': '0.0869', 'NDCG@5': '0.0613', 'HR@10': '0.1209', 'NDCG@10': '0.0723', 'HR@20': '0.1639', 'NDCG@20': '0.0832'}
2025-03-02 19:03:48,185 - EarlyStopping counter: 6 out of 10
2025-03-02 19:04:19,349 - {'epoch': 39, 'rec_loss': '6.7450'}
2025-03-02 19:04:28,174 - {'Epoch': 39, 'HR@5': '0.0852', 'NDCG@5': '0.0603', 'HR@10': '0.1193', 'NDCG@10': '0.0713', 'HR@20': '0.1625', 'NDCG@20': '0.0821'}
2025-03-02 19:04:28,176 - EarlyStopping counter: 7 out of 10
2025-03-02 19:05:00,218 - {'epoch': 40, 'rec_loss': '6.7459'}
2025-03-02 19:05:08,992 - {'Epoch': 40, 'HR@5': '0.0864', 'NDCG@5': '0.0614', 'HR@10': '0.1211', 'NDCG@10': '0.0726', 'HR@20': '0.1637', 'NDCG@20': '0.0833'}
2025-03-02 19:05:08,993 - EarlyStopping counter: 8 out of 10
2025-03-02 19:05:39,407 - {'epoch': 41, 'rec_loss': '6.7342'}
2025-03-02 19:05:48,452 - {'Epoch': 41, 'HR@5': '0.0878', 'NDCG@5': '0.0624', 'HR@10': '0.1204', 'NDCG@10': '0.0729', 'HR@20': '0.1638', 'NDCG@20': '0.0838'}
2025-03-02 19:05:48,458 - EarlyStopping counter: 9 out of 10
2025-03-02 19:06:15,870 - {'epoch': 42, 'rec_loss': '6.7304'}
2025-03-02 19:06:24,674 - {'Epoch': 42, 'HR@5': '0.0888', 'NDCG@5': '0.0629', 'HR@10': '0.1204', 'NDCG@10': '0.0731', 'HR@20': '0.1643', 'NDCG@20': '0.0841'}
2025-03-02 19:06:24,676 - Validation score increased.  Saving model ...
2025-03-02 19:06:52,831 - {'epoch': 43, 'rec_loss': '6.7170'}
2025-03-02 19:07:00,658 - {'Epoch': 43, 'HR@5': '0.0889', 'NDCG@5': '0.0620', 'HR@10': '0.1200', 'NDCG@10': '0.0720', 'HR@20': '0.1638', 'NDCG@20': '0.0830'}
2025-03-02 19:07:00,659 - EarlyStopping counter: 1 out of 10
2025-03-02 19:07:30,473 - {'epoch': 44, 'rec_loss': '6.7186'}
2025-03-02 19:07:39,414 - {'Epoch': 44, 'HR@5': '0.0872', 'NDCG@5': '0.0620', 'HR@10': '0.1198', 'NDCG@10': '0.0725', 'HR@20': '0.1630', 'NDCG@20': '0.0834'}
2025-03-02 19:07:39,420 - EarlyStopping counter: 2 out of 10
2025-03-02 19:08:10,164 - {'epoch': 45, 'rec_loss': '6.7123'}
2025-03-02 19:08:18,837 - {'Epoch': 45, 'HR@5': '0.0882', 'NDCG@5': '0.0623', 'HR@10': '0.1209', 'NDCG@10': '0.0728', 'HR@20': '0.1646', 'NDCG@20': '0.0839'}
2025-03-02 19:08:18,843 - EarlyStopping counter: 3 out of 10
2025-03-02 19:08:48,498 - {'epoch': 46, 'rec_loss': '6.7024'}
2025-03-02 19:08:57,117 - {'Epoch': 46, 'HR@5': '0.0889', 'NDCG@5': '0.0632', 'HR@10': '0.1209', 'NDCG@10': '0.0734', 'HR@20': '0.1654', 'NDCG@20': '0.0847'}
2025-03-02 19:08:57,124 - Validation score increased.  Saving model ...
2025-03-02 19:09:26,919 - {'epoch': 47, 'rec_loss': '6.6975'}
2025-03-02 19:09:36,011 - {'Epoch': 47, 'HR@5': '0.0874', 'NDCG@5': '0.0620', 'HR@10': '0.1208', 'NDCG@10': '0.0727', 'HR@20': '0.1631', 'NDCG@20': '0.0834'}
2025-03-02 19:09:36,013 - EarlyStopping counter: 1 out of 10
2025-03-02 19:10:06,599 - {'epoch': 48, 'rec_loss': '6.6953'}
2025-03-02 19:10:15,368 - {'Epoch': 48, 'HR@5': '0.0872', 'NDCG@5': '0.0620', 'HR@10': '0.1208', 'NDCG@10': '0.0728', 'HR@20': '0.1644', 'NDCG@20': '0.0838'}
2025-03-02 19:10:15,374 - EarlyStopping counter: 2 out of 10
2025-03-02 19:10:44,537 - {'epoch': 49, 'rec_loss': '6.6875'}
2025-03-02 19:10:56,114 - {'Epoch': 49, 'HR@5': '0.0877', 'NDCG@5': '0.0619', 'HR@10': '0.1203', 'NDCG@10': '0.0724', 'HR@20': '0.1642', 'NDCG@20': '0.0835'}
2025-03-02 19:10:56,129 - EarlyStopping counter: 3 out of 10
2025-03-02 19:11:28,782 - {'epoch': 50, 'rec_loss': '6.6893'}
2025-03-02 19:11:37,693 - {'Epoch': 50, 'HR@5': '0.0885', 'NDCG@5': '0.0626', 'HR@10': '0.1207', 'NDCG@10': '0.0730', 'HR@20': '0.1644', 'NDCG@20': '0.0840'}
2025-03-02 19:11:37,700 - EarlyStopping counter: 4 out of 10
2025-03-02 19:12:08,679 - {'epoch': 51, 'rec_loss': '6.6834'}
2025-03-02 19:12:17,113 - {'Epoch': 51, 'HR@5': '0.0877', 'NDCG@5': '0.0624', 'HR@10': '0.1196', 'NDCG@10': '0.0727', 'HR@20': '0.1656', 'NDCG@20': '0.0843'}
2025-03-02 19:12:17,114 - EarlyStopping counter: 5 out of 10
2025-03-02 19:12:48,318 - {'epoch': 52, 'rec_loss': '6.6730'}
2025-03-02 19:12:56,879 - {'Epoch': 52, 'HR@5': '0.0867', 'NDCG@5': '0.0621', 'HR@10': '0.1189', 'NDCG@10': '0.0724', 'HR@20': '0.1636', 'NDCG@20': '0.0837'}
2025-03-02 19:12:56,880 - EarlyStopping counter: 6 out of 10
2025-03-02 19:13:26,556 - {'epoch': 53, 'rec_loss': '6.6759'}
2025-03-02 19:13:35,478 - {'Epoch': 53, 'HR@5': '0.0879', 'NDCG@5': '0.0624', 'HR@10': '0.1219', 'NDCG@10': '0.0733', 'HR@20': '0.1650', 'NDCG@20': '0.0842'}
2025-03-02 19:13:35,480 - EarlyStopping counter: 7 out of 10
2025-03-02 19:14:04,925 - {'epoch': 54, 'rec_loss': '6.6684'}
2025-03-02 19:14:14,227 - {'Epoch': 54, 'HR@5': '0.0882', 'NDCG@5': '0.0627', 'HR@10': '0.1202', 'NDCG@10': '0.0730', 'HR@20': '0.1630', 'NDCG@20': '0.0838'}
2025-03-02 19:14:14,229 - EarlyStopping counter: 8 out of 10
2025-03-02 19:14:44,887 - {'epoch': 55, 'rec_loss': '6.6649'}
2025-03-02 19:14:54,000 - {'Epoch': 55, 'HR@5': '0.0884', 'NDCG@5': '0.0629', 'HR@10': '0.1205', 'NDCG@10': '0.0733', 'HR@20': '0.1643', 'NDCG@20': '0.0843'}
2025-03-02 19:14:54,007 - EarlyStopping counter: 9 out of 10
2025-03-02 19:15:25,043 - {'epoch': 56, 'rec_loss': '6.6615'}
2025-03-02 19:15:34,234 - {'Epoch': 56, 'HR@5': '0.0878', 'NDCG@5': '0.0629', 'HR@10': '0.1201', 'NDCG@10': '0.0733', 'HR@20': '0.1637', 'NDCG@20': '0.0843'}
2025-03-02 19:15:34,244 - EarlyStopping counter: 10 out of 10
2025-03-02 19:15:34,244 - Early stopping
2025-03-02 19:15:34,244 - ---------------Test Score---------------
2025-03-02 19:15:43,292 - {'Epoch': 0, 'HR@5': '0.0718', 'NDCG@5': '0.0517', 'HR@10': '0.0991', 'NDCG@10': '0.0604', 'HR@20': '0.1365', 'NDCG@20': '0.0699'}
2025-03-02 19:15:43,294 - Scale_Beauty
2025-03-02 19:15:43,294 - {'Epoch': 0, 'HR@5': '0.0718', 'NDCG@5': '0.0517', 'HR@10': '0.0991', 'NDCG@10': '0.0604', 'HR@20': '0.1365', 'NDCG@20': '0.0699'}
2025-03-02 19:23:34,435 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 12, 36], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-02 19:23:37,629 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-02 19:23:37,635 - Total Parameters: 929445
2025-03-02 19:24:09,965 - {'epoch': 0, 'rec_loss': '8.8353'}
2025-03-02 19:24:18,829 - {'Epoch': 0, 'HR@5': '0.0205', 'NDCG@5': '0.0128', 'HR@10': '0.0309', 'NDCG@10': '0.0162', 'HR@20': '0.0477', 'NDCG@20': '0.0204'}
2025-03-02 19:24:18,830 - Validation score increased.  Saving model ...
2025-03-02 19:24:51,248 - {'epoch': 1, 'rec_loss': '8.3271'}
2025-03-02 19:25:00,708 - {'Epoch': 1, 'HR@5': '0.0372', 'NDCG@5': '0.0251', 'HR@10': '0.0564', 'NDCG@10': '0.0313', 'HR@20': '0.0819', 'NDCG@20': '0.0377'}
2025-03-02 19:25:00,710 - Validation score increased.  Saving model ...
2025-03-02 19:25:29,915 - {'epoch': 2, 'rec_loss': '8.0157'}
2025-03-02 19:25:38,752 - {'Epoch': 2, 'HR@5': '0.0491', 'NDCG@5': '0.0332', 'HR@10': '0.0723', 'NDCG@10': '0.0407', 'HR@20': '0.1046', 'NDCG@20': '0.0488'}
2025-03-02 19:25:38,753 - Validation score increased.  Saving model ...
2025-03-02 19:26:08,571 - {'epoch': 3, 'rec_loss': '7.7993'}
2025-03-02 19:26:17,390 - {'Epoch': 3, 'HR@5': '0.0594', 'NDCG@5': '0.0405', 'HR@10': '0.0856', 'NDCG@10': '0.0490', 'HR@20': '0.1237', 'NDCG@20': '0.0586'}
2025-03-02 19:26:17,391 - Validation score increased.  Saving model ...
2025-03-02 19:26:48,899 - {'epoch': 4, 'rec_loss': '7.6361'}
2025-03-02 19:26:57,464 - {'Epoch': 4, 'HR@5': '0.0683', 'NDCG@5': '0.0474', 'HR@10': '0.0950', 'NDCG@10': '0.0560', 'HR@20': '0.1329', 'NDCG@20': '0.0655'}
2025-03-02 19:26:57,465 - Validation score increased.  Saving model ...
2025-03-02 19:27:27,632 - {'epoch': 5, 'rec_loss': '7.5209'}
2025-03-02 19:27:36,221 - {'Epoch': 5, 'HR@5': '0.0727', 'NDCG@5': '0.0507', 'HR@10': '0.1029', 'NDCG@10': '0.0604', 'HR@20': '0.1404', 'NDCG@20': '0.0698'}
2025-03-02 19:27:36,228 - Validation score increased.  Saving model ...
2025-03-02 19:28:05,215 - {'epoch': 6, 'rec_loss': '7.4234'}
2025-03-02 19:28:13,550 - {'Epoch': 6, 'HR@5': '0.0762', 'NDCG@5': '0.0535', 'HR@10': '0.1053', 'NDCG@10': '0.0629', 'HR@20': '0.1444', 'NDCG@20': '0.0727'}
2025-03-02 19:28:13,555 - Validation score increased.  Saving model ...
2025-03-02 19:28:41,509 - {'epoch': 7, 'rec_loss': '7.3443'}
2025-03-02 19:28:50,204 - {'Epoch': 7, 'HR@5': '0.0802', 'NDCG@5': '0.0563', 'HR@10': '0.1083', 'NDCG@10': '0.0654', 'HR@20': '0.1486', 'NDCG@20': '0.0755'}
2025-03-02 19:28:50,210 - Validation score increased.  Saving model ...
2025-03-02 19:29:19,418 - {'epoch': 8, 'rec_loss': '7.2733'}
2025-03-02 19:29:28,102 - {'Epoch': 8, 'HR@5': '0.0822', 'NDCG@5': '0.0579', 'HR@10': '0.1106', 'NDCG@10': '0.0671', 'HR@20': '0.1506', 'NDCG@20': '0.0771'}
2025-03-02 19:29:28,108 - Validation score increased.  Saving model ...
2025-03-02 19:29:57,091 - {'epoch': 9, 'rec_loss': '7.2246'}
2025-03-02 19:30:05,957 - {'Epoch': 9, 'HR@5': '0.0813', 'NDCG@5': '0.0570', 'HR@10': '0.1132', 'NDCG@10': '0.0673', 'HR@20': '0.1527', 'NDCG@20': '0.0772'}
2025-03-02 19:30:05,962 - Validation score increased.  Saving model ...
2025-03-02 19:30:35,736 - {'epoch': 10, 'rec_loss': '7.1773'}
2025-03-02 19:30:44,677 - {'Epoch': 10, 'HR@5': '0.0832', 'NDCG@5': '0.0589', 'HR@10': '0.1130', 'NDCG@10': '0.0685', 'HR@20': '0.1525', 'NDCG@20': '0.0785'}
2025-03-02 19:30:44,679 - Validation score increased.  Saving model ...
2025-03-02 19:31:13,397 - {'epoch': 11, 'rec_loss': '7.1377'}
2025-03-02 19:31:22,223 - {'Epoch': 11, 'HR@5': '0.0840', 'NDCG@5': '0.0598', 'HR@10': '0.1144', 'NDCG@10': '0.0696', 'HR@20': '0.1542', 'NDCG@20': '0.0796'}
2025-03-02 19:31:22,224 - Validation score increased.  Saving model ...
2025-03-02 19:31:53,787 - {'epoch': 12, 'rec_loss': '7.1008'}
2025-03-02 19:32:02,308 - {'Epoch': 12, 'HR@5': '0.0841', 'NDCG@5': '0.0595', 'HR@10': '0.1150', 'NDCG@10': '0.0695', 'HR@20': '0.1568', 'NDCG@20': '0.0800'}
2025-03-02 19:32:02,315 - Validation score increased.  Saving model ...
2025-03-02 19:32:32,140 - {'epoch': 13, 'rec_loss': '7.0747'}
2025-03-02 19:32:41,434 - {'Epoch': 13, 'HR@5': '0.0846', 'NDCG@5': '0.0595', 'HR@10': '0.1183', 'NDCG@10': '0.0705', 'HR@20': '0.1581', 'NDCG@20': '0.0805'}
2025-03-02 19:32:41,440 - Validation score increased.  Saving model ...
2025-03-02 19:33:10,238 - {'epoch': 14, 'rec_loss': '7.0435'}
2025-03-02 19:33:19,346 - {'Epoch': 14, 'HR@5': '0.0870', 'NDCG@5': '0.0605', 'HR@10': '0.1188', 'NDCG@10': '0.0708', 'HR@20': '0.1599', 'NDCG@20': '0.0811'}
2025-03-02 19:33:19,347 - Validation score increased.  Saving model ...
2025-03-02 19:33:51,280 - {'epoch': 15, 'rec_loss': '7.0236'}
2025-03-02 19:34:00,424 - {'Epoch': 15, 'HR@5': '0.0863', 'NDCG@5': '0.0604', 'HR@10': '0.1189', 'NDCG@10': '0.0709', 'HR@20': '0.1608', 'NDCG@20': '0.0814'}
2025-03-02 19:34:00,425 - Validation score increased.  Saving model ...
2025-03-02 19:34:29,913 - {'epoch': 16, 'rec_loss': '7.0007'}
2025-03-02 19:34:37,595 - {'Epoch': 16, 'HR@5': '0.0869', 'NDCG@5': '0.0606', 'HR@10': '0.1191', 'NDCG@10': '0.0710', 'HR@20': '0.1617', 'NDCG@20': '0.0817'}
2025-03-02 19:34:37,596 - Validation score increased.  Saving model ...
2025-03-02 19:35:06,267 - {'epoch': 17, 'rec_loss': '6.9854'}
2025-03-02 19:35:16,047 - {'Epoch': 17, 'HR@5': '0.0843', 'NDCG@5': '0.0606', 'HR@10': '0.1196', 'NDCG@10': '0.0720', 'HR@20': '0.1625', 'NDCG@20': '0.0827'}
2025-03-02 19:35:16,048 - Validation score increased.  Saving model ...
2025-03-02 19:35:49,284 - {'epoch': 18, 'rec_loss': '6.9525'}
2025-03-02 19:35:58,434 - {'Epoch': 18, 'HR@5': '0.0868', 'NDCG@5': '0.0609', 'HR@10': '0.1187', 'NDCG@10': '0.0712', 'HR@20': '0.1616', 'NDCG@20': '0.0820'}
2025-03-02 19:35:58,435 - EarlyStopping counter: 1 out of 10
2025-03-02 19:36:27,787 - {'epoch': 19, 'rec_loss': '6.9427'}
2025-03-02 19:36:36,908 - {'Epoch': 19, 'HR@5': '0.0862', 'NDCG@5': '0.0614', 'HR@10': '0.1182', 'NDCG@10': '0.0718', 'HR@20': '0.1621', 'NDCG@20': '0.0828'}
2025-03-02 19:36:36,909 - Validation score increased.  Saving model ...
2025-03-02 19:37:06,348 - {'epoch': 20, 'rec_loss': '6.9225'}
2025-03-02 19:37:15,489 - {'Epoch': 20, 'HR@5': '0.0867', 'NDCG@5': '0.0617', 'HR@10': '0.1209', 'NDCG@10': '0.0728', 'HR@20': '0.1631', 'NDCG@20': '0.0834'}
2025-03-02 19:37:15,496 - Validation score increased.  Saving model ...
2025-03-02 19:37:45,970 - {'epoch': 21, 'rec_loss': '6.9136'}
2025-03-02 19:37:55,177 - {'Epoch': 21, 'HR@5': '0.0871', 'NDCG@5': '0.0615', 'HR@10': '0.1207', 'NDCG@10': '0.0724', 'HR@20': '0.1626', 'NDCG@20': '0.0829'}
2025-03-02 19:37:55,183 - EarlyStopping counter: 1 out of 10
2025-03-02 19:38:25,783 - {'epoch': 22, 'rec_loss': '6.9031'}
2025-03-02 19:38:35,016 - {'Epoch': 22, 'HR@5': '0.0873', 'NDCG@5': '0.0618', 'HR@10': '0.1210', 'NDCG@10': '0.0727', 'HR@20': '0.1637', 'NDCG@20': '0.0835'}
2025-03-02 19:38:35,018 - Validation score increased.  Saving model ...
2025-03-02 19:39:03,870 - {'epoch': 23, 'rec_loss': '6.8856'}
2025-03-02 19:39:13,238 - {'Epoch': 23, 'HR@5': '0.0879', 'NDCG@5': '0.0625', 'HR@10': '0.1206', 'NDCG@10': '0.0730', 'HR@20': '0.1629', 'NDCG@20': '0.0836'}
2025-03-02 19:39:13,239 - Validation score increased.  Saving model ...
2025-03-02 19:39:42,331 - {'epoch': 24, 'rec_loss': '6.8784'}
2025-03-02 19:39:50,952 - {'Epoch': 24, 'HR@5': '0.0882', 'NDCG@5': '0.0620', 'HR@10': '0.1202', 'NDCG@10': '0.0722', 'HR@20': '0.1619', 'NDCG@20': '0.0828'}
2025-03-02 19:39:50,954 - EarlyStopping counter: 1 out of 10
2025-03-02 19:40:18,073 - {'epoch': 25, 'rec_loss': '6.8584'}
2025-03-02 19:40:26,878 - {'Epoch': 25, 'HR@5': '0.0874', 'NDCG@5': '0.0615', 'HR@10': '0.1215', 'NDCG@10': '0.0725', 'HR@20': '0.1635', 'NDCG@20': '0.0830'}
2025-03-02 19:40:26,884 - EarlyStopping counter: 2 out of 10
2025-03-02 19:40:55,390 - {'epoch': 26, 'rec_loss': '6.8539'}
2025-03-02 19:41:04,258 - {'Epoch': 26, 'HR@5': '0.0879', 'NDCG@5': '0.0620', 'HR@10': '0.1214', 'NDCG@10': '0.0728', 'HR@20': '0.1634', 'NDCG@20': '0.0834'}
2025-03-02 19:41:04,259 - EarlyStopping counter: 3 out of 10
2025-03-02 19:41:34,780 - {'epoch': 27, 'rec_loss': '6.8385'}
2025-03-02 19:41:43,282 - {'Epoch': 27, 'HR@5': '0.0872', 'NDCG@5': '0.0620', 'HR@10': '0.1204', 'NDCG@10': '0.0727', 'HR@20': '0.1622', 'NDCG@20': '0.0832'}
2025-03-02 19:41:43,288 - EarlyStopping counter: 4 out of 10
2025-03-02 19:42:14,679 - {'epoch': 28, 'rec_loss': '6.8341'}
2025-03-02 19:42:23,124 - {'Epoch': 28, 'HR@5': '0.0881', 'NDCG@5': '0.0620', 'HR@10': '0.1210', 'NDCG@10': '0.0726', 'HR@20': '0.1626', 'NDCG@20': '0.0830'}
2025-03-02 19:42:23,125 - EarlyStopping counter: 5 out of 10
2025-03-02 19:42:53,451 - {'epoch': 29, 'rec_loss': '6.8259'}
2025-03-02 19:43:02,252 - {'Epoch': 29, 'HR@5': '0.0868', 'NDCG@5': '0.0609', 'HR@10': '0.1212', 'NDCG@10': '0.0719', 'HR@20': '0.1639', 'NDCG@20': '0.0826'}
2025-03-02 19:43:02,258 - EarlyStopping counter: 6 out of 10
2025-03-02 19:43:31,461 - {'epoch': 30, 'rec_loss': '6.8152'}
2025-03-02 19:43:40,744 - {'Epoch': 30, 'HR@5': '0.0875', 'NDCG@5': '0.0618', 'HR@10': '0.1205', 'NDCG@10': '0.0724', 'HR@20': '0.1643', 'NDCG@20': '0.0835'}
2025-03-02 19:43:40,746 - EarlyStopping counter: 7 out of 10
2025-03-02 19:44:09,718 - {'epoch': 31, 'rec_loss': '6.8010'}
2025-03-02 19:44:18,538 - {'Epoch': 31, 'HR@5': '0.0885', 'NDCG@5': '0.0626', 'HR@10': '0.1206', 'NDCG@10': '0.0729', 'HR@20': '0.1646', 'NDCG@20': '0.0840'}
2025-03-02 19:44:18,539 - Validation score increased.  Saving model ...
2025-03-02 19:44:50,653 - {'epoch': 32, 'rec_loss': '6.7971'}
2025-03-02 19:44:59,703 - {'Epoch': 32, 'HR@5': '0.0891', 'NDCG@5': '0.0630', 'HR@10': '0.1219', 'NDCG@10': '0.0735', 'HR@20': '0.1636', 'NDCG@20': '0.0840'}
2025-03-02 19:44:59,704 - Validation score increased.  Saving model ...
2025-03-02 19:45:28,706 - {'epoch': 33, 'rec_loss': '6.7950'}
2025-03-02 19:45:37,983 - {'Epoch': 33, 'HR@5': '0.0884', 'NDCG@5': '0.0629', 'HR@10': '0.1194', 'NDCG@10': '0.0728', 'HR@20': '0.1625', 'NDCG@20': '0.0837'}
2025-03-02 19:45:37,984 - EarlyStopping counter: 1 out of 10
2025-03-02 19:46:05,144 - {'epoch': 34, 'rec_loss': '6.7778'}
2025-03-02 19:46:13,992 - {'Epoch': 34, 'HR@5': '0.0883', 'NDCG@5': '0.0625', 'HR@10': '0.1202', 'NDCG@10': '0.0727', 'HR@20': '0.1627', 'NDCG@20': '0.0834'}
2025-03-02 19:46:13,994 - EarlyStopping counter: 2 out of 10
2025-03-02 19:46:41,733 - {'epoch': 35, 'rec_loss': '6.7743'}
2025-03-02 19:46:50,785 - {'Epoch': 35, 'HR@5': '0.0868', 'NDCG@5': '0.0612', 'HR@10': '0.1184', 'NDCG@10': '0.0714', 'HR@20': '0.1644', 'NDCG@20': '0.0830'}
2025-03-02 19:46:50,787 - EarlyStopping counter: 3 out of 10
2025-03-02 19:47:20,590 - {'epoch': 36, 'rec_loss': '6.7661'}
2025-03-02 19:47:29,711 - {'Epoch': 36, 'HR@5': '0.0871', 'NDCG@5': '0.0623', 'HR@10': '0.1215', 'NDCG@10': '0.0733', 'HR@20': '0.1634', 'NDCG@20': '0.0839'}
2025-03-02 19:47:29,716 - EarlyStopping counter: 4 out of 10
2025-03-02 19:48:00,131 - {'epoch': 37, 'rec_loss': '6.7499'}
2025-03-02 19:48:09,036 - {'Epoch': 37, 'HR@5': '0.0868', 'NDCG@5': '0.0616', 'HR@10': '0.1210', 'NDCG@10': '0.0726', 'HR@20': '0.1654', 'NDCG@20': '0.0838'}
2025-03-02 19:48:09,043 - EarlyStopping counter: 5 out of 10
2025-03-02 19:48:40,411 - {'epoch': 38, 'rec_loss': '6.7522'}
2025-03-02 19:48:49,822 - {'Epoch': 38, 'HR@5': '0.0871', 'NDCG@5': '0.0617', 'HR@10': '0.1210', 'NDCG@10': '0.0726', 'HR@20': '0.1638', 'NDCG@20': '0.0834'}
2025-03-02 19:48:49,829 - EarlyStopping counter: 6 out of 10
2025-03-02 19:49:21,395 - {'epoch': 39, 'rec_loss': '6.7449'}
2025-03-02 19:49:30,285 - {'Epoch': 39, 'HR@5': '0.0851', 'NDCG@5': '0.0603', 'HR@10': '0.1189', 'NDCG@10': '0.0712', 'HR@20': '0.1619', 'NDCG@20': '0.0820'}
2025-03-02 19:49:30,292 - EarlyStopping counter: 7 out of 10
2025-03-02 19:50:00,052 - {'epoch': 40, 'rec_loss': '6.7462'}
2025-03-02 19:50:09,132 - {'Epoch': 40, 'HR@5': '0.0865', 'NDCG@5': '0.0614', 'HR@10': '0.1207', 'NDCG@10': '0.0725', 'HR@20': '0.1646', 'NDCG@20': '0.0835'}
2025-03-02 19:50:09,134 - EarlyStopping counter: 8 out of 10
2025-03-02 19:50:39,090 - {'epoch': 41, 'rec_loss': '6.7342'}
2025-03-02 19:50:47,983 - {'Epoch': 41, 'HR@5': '0.0880', 'NDCG@5': '0.0625', 'HR@10': '0.1205', 'NDCG@10': '0.0730', 'HR@20': '0.1642', 'NDCG@20': '0.0840'}
2025-03-02 19:50:47,990 - EarlyStopping counter: 9 out of 10
2025-03-02 19:51:19,913 - {'epoch': 42, 'rec_loss': '6.7305'}
2025-03-02 19:51:29,321 - {'Epoch': 42, 'HR@5': '0.0888', 'NDCG@5': '0.0630', 'HR@10': '0.1208', 'NDCG@10': '0.0733', 'HR@20': '0.1646', 'NDCG@20': '0.0844'}
2025-03-02 19:51:29,322 - Validation score increased.  Saving model ...
2025-03-02 19:51:59,581 - {'epoch': 43, 'rec_loss': '6.7176'}
2025-03-02 19:52:07,820 - {'Epoch': 43, 'HR@5': '0.0890', 'NDCG@5': '0.0621', 'HR@10': '0.1204', 'NDCG@10': '0.0722', 'HR@20': '0.1632', 'NDCG@20': '0.0830'}
2025-03-02 19:52:07,822 - EarlyStopping counter: 1 out of 10
2025-03-02 19:52:37,069 - {'epoch': 44, 'rec_loss': '6.7185'}
2025-03-02 19:52:45,761 - {'Epoch': 44, 'HR@5': '0.0879', 'NDCG@5': '0.0622', 'HR@10': '0.1199', 'NDCG@10': '0.0726', 'HR@20': '0.1630', 'NDCG@20': '0.0834'}
2025-03-02 19:52:45,763 - EarlyStopping counter: 2 out of 10
2025-03-02 19:53:14,994 - {'epoch': 45, 'rec_loss': '6.7126'}
2025-03-02 19:53:23,965 - {'Epoch': 45, 'HR@5': '0.0883', 'NDCG@5': '0.0625', 'HR@10': '0.1206', 'NDCG@10': '0.0729', 'HR@20': '0.1648', 'NDCG@20': '0.0840'}
2025-03-02 19:53:23,973 - EarlyStopping counter: 3 out of 10
2025-03-02 19:53:54,010 - {'epoch': 46, 'rec_loss': '6.7027'}
2025-03-02 19:54:03,054 - {'Epoch': 46, 'HR@5': '0.0889', 'NDCG@5': '0.0631', 'HR@10': '0.1210', 'NDCG@10': '0.0734', 'HR@20': '0.1656', 'NDCG@20': '0.0847'}
2025-03-02 19:54:03,061 - Validation score increased.  Saving model ...
2025-03-02 19:54:32,417 - {'epoch': 47, 'rec_loss': '6.6974'}
2025-03-02 19:54:41,815 - {'Epoch': 47, 'HR@5': '0.0873', 'NDCG@5': '0.0622', 'HR@10': '0.1203', 'NDCG@10': '0.0727', 'HR@20': '0.1636', 'NDCG@20': '0.0836'}
2025-03-02 19:54:41,821 - EarlyStopping counter: 1 out of 10
2025-03-02 19:55:13,452 - {'epoch': 48, 'rec_loss': '6.6956'}
2025-03-02 19:55:22,258 - {'Epoch': 48, 'HR@5': '0.0869', 'NDCG@5': '0.0619', 'HR@10': '0.1208', 'NDCG@10': '0.0728', 'HR@20': '0.1645', 'NDCG@20': '0.0838'}
2025-03-02 19:55:22,260 - EarlyStopping counter: 2 out of 10
2025-03-02 19:55:54,272 - {'epoch': 49, 'rec_loss': '6.6874'}
2025-03-02 19:56:03,315 - {'Epoch': 49, 'HR@5': '0.0878', 'NDCG@5': '0.0619', 'HR@10': '0.1200', 'NDCG@10': '0.0723', 'HR@20': '0.1642', 'NDCG@20': '0.0835'}
2025-03-02 19:56:03,316 - EarlyStopping counter: 3 out of 10
2025-03-02 19:56:31,423 - {'epoch': 50, 'rec_loss': '6.6893'}
2025-03-02 19:56:40,718 - {'Epoch': 50, 'HR@5': '0.0893', 'NDCG@5': '0.0629', 'HR@10': '0.1208', 'NDCG@10': '0.0730', 'HR@20': '0.1640', 'NDCG@20': '0.0839'}
2025-03-02 19:56:40,719 - EarlyStopping counter: 4 out of 10
2025-03-02 19:57:10,041 - {'epoch': 51, 'rec_loss': '6.6834'}
2025-03-02 19:57:19,210 - {'Epoch': 51, 'HR@5': '0.0875', 'NDCG@5': '0.0623', 'HR@10': '0.1196', 'NDCG@10': '0.0726', 'HR@20': '0.1649', 'NDCG@20': '0.0840'}
2025-03-02 19:57:19,217 - EarlyStopping counter: 5 out of 10
2025-03-02 19:57:46,937 - {'epoch': 52, 'rec_loss': '6.6733'}
2025-03-02 19:57:55,569 - {'Epoch': 52, 'HR@5': '0.0867', 'NDCG@5': '0.0621', 'HR@10': '0.1196', 'NDCG@10': '0.0726', 'HR@20': '0.1645', 'NDCG@20': '0.0839'}
2025-03-02 19:57:55,571 - EarlyStopping counter: 6 out of 10
2025-03-02 19:58:22,434 - {'epoch': 53, 'rec_loss': '6.6759'}
2025-03-02 19:58:31,650 - {'Epoch': 53, 'HR@5': '0.0876', 'NDCG@5': '0.0623', 'HR@10': '0.1217', 'NDCG@10': '0.0733', 'HR@20': '0.1644', 'NDCG@20': '0.0841'}
2025-03-02 19:58:31,652 - EarlyStopping counter: 7 out of 10
2025-03-02 19:59:03,768 - {'epoch': 54, 'rec_loss': '6.6687'}
2025-03-02 19:59:13,319 - {'Epoch': 54, 'HR@5': '0.0885', 'NDCG@5': '0.0625', 'HR@10': '0.1205', 'NDCG@10': '0.0728', 'HR@20': '0.1633', 'NDCG@20': '0.0836'}
2025-03-02 19:59:13,321 - EarlyStopping counter: 8 out of 10
2025-03-02 19:59:46,283 - {'epoch': 55, 'rec_loss': '6.6651'}
2025-03-02 19:59:55,046 - {'Epoch': 55, 'HR@5': '0.0879', 'NDCG@5': '0.0629', 'HR@10': '0.1215', 'NDCG@10': '0.0737', 'HR@20': '0.1648', 'NDCG@20': '0.0846'}
2025-03-02 19:59:55,047 - EarlyStopping counter: 9 out of 10
2025-03-02 20:00:24,478 - {'epoch': 56, 'rec_loss': '6.6613'}
2025-03-02 20:00:33,525 - {'Epoch': 56, 'HR@5': '0.0884', 'NDCG@5': '0.0631', 'HR@10': '0.1202', 'NDCG@10': '0.0733', 'HR@20': '0.1635', 'NDCG@20': '0.0842'}
2025-03-02 20:00:33,526 - EarlyStopping counter: 10 out of 10
2025-03-02 20:00:33,527 - Early stopping
2025-03-02 20:00:33,527 - ---------------Test Score---------------
2025-03-02 20:00:42,593 - {'Epoch': 0, 'HR@5': '0.0719', 'NDCG@5': '0.0519', 'HR@10': '0.0980', 'NDCG@10': '0.0603', 'HR@20': '0.1367', 'NDCG@20': '0.0701'}
2025-03-02 20:00:42,594 - Scale_Beauty
2025-03-02 20:00:42,595 - {'Epoch': 0, 'HR@5': '0.0719', 'NDCG@5': '0.0519', 'HR@10': '0.0980', 'NDCG@10': '0.0603', 'HR@20': '0.1367', 'NDCG@20': '0.0701'}
2025-03-02 21:22:20,412 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 12, 32], start_prob=0.1, end_prob=0.4, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-02 21:22:23,281 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-02 21:22:23,287 - Total Parameters: 929445
2025-03-02 21:22:53,688 - {'epoch': 0, 'rec_loss': '8.8137'}
2025-03-02 21:23:01,485 - {'Epoch': 0, 'HR@5': '0.0227', 'NDCG@5': '0.0146', 'HR@10': '0.0344', 'NDCG@10': '0.0183', 'HR@20': '0.0520', 'NDCG@20': '0.0227'}
2025-03-02 21:23:01,489 - Validation score increased.  Saving model ...
2025-03-02 21:23:28,615 - {'epoch': 1, 'rec_loss': '8.2641'}
2025-03-02 21:23:36,652 - {'Epoch': 1, 'HR@5': '0.0411', 'NDCG@5': '0.0276', 'HR@10': '0.0611', 'NDCG@10': '0.0340', 'HR@20': '0.0868', 'NDCG@20': '0.0405'}
2025-03-02 21:23:36,653 - Validation score increased.  Saving model ...
2025-03-02 21:24:04,110 - {'epoch': 2, 'rec_loss': '7.9391'}
2025-03-02 21:24:12,011 - {'Epoch': 2, 'HR@5': '0.0533', 'NDCG@5': '0.0366', 'HR@10': '0.0794', 'NDCG@10': '0.0450', 'HR@20': '0.1117', 'NDCG@20': '0.0532'}
2025-03-02 21:24:12,012 - Validation score increased.  Saving model ...
2025-03-02 21:24:39,775 - {'epoch': 3, 'rec_loss': '7.7160'}
2025-03-02 21:24:47,630 - {'Epoch': 3, 'HR@5': '0.0647', 'NDCG@5': '0.0440', 'HR@10': '0.0917', 'NDCG@10': '0.0527', 'HR@20': '0.1287', 'NDCG@20': '0.0620'}
2025-03-02 21:24:47,631 - Validation score increased.  Saving model ...
2025-03-02 21:25:16,635 - {'epoch': 4, 'rec_loss': '7.5445'}
2025-03-02 21:25:24,364 - {'Epoch': 4, 'HR@5': '0.0722', 'NDCG@5': '0.0507', 'HR@10': '0.1009', 'NDCG@10': '0.0599', 'HR@20': '0.1375', 'NDCG@20': '0.0691'}
2025-03-02 21:25:24,366 - Validation score increased.  Saving model ...
2025-03-02 21:25:54,031 - {'epoch': 5, 'rec_loss': '7.4216'}
2025-03-02 21:26:02,295 - {'Epoch': 5, 'HR@5': '0.0766', 'NDCG@5': '0.0537', 'HR@10': '0.1062', 'NDCG@10': '0.0632', 'HR@20': '0.1447', 'NDCG@20': '0.0728'}
2025-03-02 21:26:02,296 - Validation score increased.  Saving model ...
2025-03-02 21:26:31,577 - {'epoch': 6, 'rec_loss': '7.3201'}
2025-03-02 21:26:39,404 - {'Epoch': 6, 'HR@5': '0.0784', 'NDCG@5': '0.0555', 'HR@10': '0.1072', 'NDCG@10': '0.0648', 'HR@20': '0.1478', 'NDCG@20': '0.0750'}
2025-03-02 21:26:39,410 - Validation score increased.  Saving model ...
2025-03-02 21:27:07,880 - {'epoch': 7, 'rec_loss': '7.2418'}
2025-03-02 21:27:15,634 - {'Epoch': 7, 'HR@5': '0.0822', 'NDCG@5': '0.0580', 'HR@10': '0.1116', 'NDCG@10': '0.0674', 'HR@20': '0.1511', 'NDCG@20': '0.0773'}
2025-03-02 21:27:15,635 - Validation score increased.  Saving model ...
2025-03-02 21:27:43,164 - {'epoch': 8, 'rec_loss': '7.1702'}
2025-03-02 21:27:51,119 - {'Epoch': 8, 'HR@5': '0.0819', 'NDCG@5': '0.0586', 'HR@10': '0.1118', 'NDCG@10': '0.0682', 'HR@20': '0.1525', 'NDCG@20': '0.0784'}
2025-03-02 21:27:51,125 - Validation score increased.  Saving model ...
2025-03-02 21:28:18,284 - {'epoch': 9, 'rec_loss': '7.1236'}
2025-03-02 21:28:25,917 - {'Epoch': 9, 'HR@5': '0.0840', 'NDCG@5': '0.0586', 'HR@10': '0.1146', 'NDCG@10': '0.0685', 'HR@20': '0.1519', 'NDCG@20': '0.0778'}
2025-03-02 21:28:25,918 - EarlyStopping counter: 1 out of 10
2025-03-02 21:28:53,126 - {'epoch': 10, 'rec_loss': '7.0747'}
2025-03-02 21:29:00,871 - {'Epoch': 10, 'HR@5': '0.0839', 'NDCG@5': '0.0593', 'HR@10': '0.1128', 'NDCG@10': '0.0686', 'HR@20': '0.1526', 'NDCG@20': '0.0786'}
2025-03-02 21:29:00,872 - Validation score increased.  Saving model ...
2025-03-02 21:29:28,232 - {'epoch': 11, 'rec_loss': '7.0350'}
2025-03-02 21:29:36,769 - {'Epoch': 11, 'HR@5': '0.0845', 'NDCG@5': '0.0599', 'HR@10': '0.1164', 'NDCG@10': '0.0701', 'HR@20': '0.1548', 'NDCG@20': '0.0798'}
2025-03-02 21:29:36,775 - Validation score increased.  Saving model ...
2025-03-02 21:30:04,007 - {'epoch': 12, 'rec_loss': '7.0021'}
2025-03-02 21:30:11,684 - {'Epoch': 12, 'HR@5': '0.0853', 'NDCG@5': '0.0599', 'HR@10': '0.1164', 'NDCG@10': '0.0699', 'HR@20': '0.1573', 'NDCG@20': '0.0802'}
2025-03-02 21:30:11,685 - Validation score increased.  Saving model ...
2025-03-02 21:30:39,868 - {'epoch': 13, 'rec_loss': '6.9739'}
2025-03-02 21:30:47,626 - {'Epoch': 13, 'HR@5': '0.0852', 'NDCG@5': '0.0602', 'HR@10': '0.1189', 'NDCG@10': '0.0711', 'HR@20': '0.1603', 'NDCG@20': '0.0815'}
2025-03-02 21:30:47,631 - Validation score increased.  Saving model ...
2025-03-02 21:31:18,555 - {'epoch': 14, 'rec_loss': '6.9443'}
2025-03-02 21:31:26,242 - {'Epoch': 14, 'HR@5': '0.0866', 'NDCG@5': '0.0608', 'HR@10': '0.1187', 'NDCG@10': '0.0712', 'HR@20': '0.1595', 'NDCG@20': '0.0815'}
2025-03-02 21:31:26,243 - EarlyStopping counter: 1 out of 10
2025-03-02 21:31:55,381 - {'epoch': 15, 'rec_loss': '6.9231'}
2025-03-02 21:32:03,121 - {'Epoch': 15, 'HR@5': '0.0869', 'NDCG@5': '0.0609', 'HR@10': '0.1193', 'NDCG@10': '0.0713', 'HR@20': '0.1604', 'NDCG@20': '0.0817'}
2025-03-02 21:32:03,126 - Validation score increased.  Saving model ...
2025-03-02 21:32:30,479 - {'epoch': 16, 'rec_loss': '6.9000'}
2025-03-02 21:32:38,411 - {'Epoch': 16, 'HR@5': '0.0863', 'NDCG@5': '0.0604', 'HR@10': '0.1193', 'NDCG@10': '0.0710', 'HR@20': '0.1612', 'NDCG@20': '0.0816'}
2025-03-02 21:32:38,412 - EarlyStopping counter: 1 out of 10
2025-03-02 21:33:05,479 - {'epoch': 17, 'rec_loss': '6.8831'}
2025-03-02 21:33:13,575 - {'Epoch': 17, 'HR@5': '0.0859', 'NDCG@5': '0.0603', 'HR@10': '0.1189', 'NDCG@10': '0.0709', 'HR@20': '0.1614', 'NDCG@20': '0.0816'}
2025-03-02 21:33:13,576 - EarlyStopping counter: 2 out of 10
2025-03-02 21:33:42,770 - {'epoch': 18, 'rec_loss': '6.8583'}
2025-03-02 21:33:50,611 - {'Epoch': 18, 'HR@5': '0.0867', 'NDCG@5': '0.0607', 'HR@10': '0.1192', 'NDCG@10': '0.0712', 'HR@20': '0.1609', 'NDCG@20': '0.0817'}
2025-03-02 21:33:50,613 - Validation score increased.  Saving model ...
2025-03-02 21:34:18,043 - {'epoch': 19, 'rec_loss': '6.8457'}
2025-03-02 21:34:25,744 - {'Epoch': 19, 'HR@5': '0.0862', 'NDCG@5': '0.0606', 'HR@10': '0.1181', 'NDCG@10': '0.0708', 'HR@20': '0.1606', 'NDCG@20': '0.0816'}
2025-03-02 21:34:25,746 - EarlyStopping counter: 1 out of 10
2025-03-02 21:34:53,039 - {'epoch': 20, 'rec_loss': '6.8243'}
2025-03-02 21:35:00,730 - {'Epoch': 20, 'HR@5': '0.0875', 'NDCG@5': '0.0617', 'HR@10': '0.1213', 'NDCG@10': '0.0726', 'HR@20': '0.1618', 'NDCG@20': '0.0828'}
2025-03-02 21:35:00,731 - Validation score increased.  Saving model ...
2025-03-02 21:35:27,804 - {'epoch': 21, 'rec_loss': '6.8158'}
2025-03-02 21:35:35,292 - {'Epoch': 21, 'HR@5': '0.0882', 'NDCG@5': '0.0618', 'HR@10': '0.1204', 'NDCG@10': '0.0722', 'HR@20': '0.1619', 'NDCG@20': '0.0826'}
2025-03-02 21:35:35,298 - EarlyStopping counter: 1 out of 10
2025-03-02 21:36:07,310 - {'epoch': 22, 'rec_loss': '6.7996'}
2025-03-02 21:36:15,737 - {'Epoch': 22, 'HR@5': '0.0873', 'NDCG@5': '0.0620', 'HR@10': '0.1216', 'NDCG@10': '0.0729', 'HR@20': '0.1634', 'NDCG@20': '0.0835'}
2025-03-02 21:36:15,739 - Validation score increased.  Saving model ...
2025-03-02 21:36:45,097 - {'epoch': 23, 'rec_loss': '6.7889'}
2025-03-02 21:36:53,214 - {'Epoch': 23, 'HR@5': '0.0878', 'NDCG@5': '0.0616', 'HR@10': '0.1194', 'NDCG@10': '0.0717', 'HR@20': '0.1608', 'NDCG@20': '0.0822'}
2025-03-02 21:36:53,215 - EarlyStopping counter: 1 out of 10
2025-03-02 21:37:20,405 - {'epoch': 24, 'rec_loss': '6.7768'}
2025-03-02 21:37:28,760 - {'Epoch': 24, 'HR@5': '0.0863', 'NDCG@5': '0.0607', 'HR@10': '0.1199', 'NDCG@10': '0.0716', 'HR@20': '0.1621', 'NDCG@20': '0.0822'}
2025-03-02 21:37:28,762 - EarlyStopping counter: 2 out of 10
2025-03-02 21:37:56,197 - {'epoch': 25, 'rec_loss': '6.7631'}
2025-03-02 21:38:04,085 - {'Epoch': 25, 'HR@5': '0.0875', 'NDCG@5': '0.0614', 'HR@10': '0.1204', 'NDCG@10': '0.0720', 'HR@20': '0.1633', 'NDCG@20': '0.0828'}
2025-03-02 21:38:04,087 - EarlyStopping counter: 3 out of 10
2025-03-02 21:38:31,553 - {'epoch': 26, 'rec_loss': '6.7546'}
2025-03-02 21:38:39,439 - {'Epoch': 26, 'HR@5': '0.0887', 'NDCG@5': '0.0619', 'HR@10': '0.1197', 'NDCG@10': '0.0719', 'HR@20': '0.1620', 'NDCG@20': '0.0826'}
2025-03-02 21:38:39,445 - EarlyStopping counter: 4 out of 10
2025-03-02 21:39:06,380 - {'epoch': 27, 'rec_loss': '6.7424'}
2025-03-02 21:39:14,169 - {'Epoch': 27, 'HR@5': '0.0874', 'NDCG@5': '0.0616', 'HR@10': '0.1197', 'NDCG@10': '0.0720', 'HR@20': '0.1617', 'NDCG@20': '0.0826'}
2025-03-02 21:39:14,170 - EarlyStopping counter: 5 out of 10
2025-03-02 21:39:40,945 - {'epoch': 28, 'rec_loss': '6.7325'}
2025-03-02 21:39:48,652 - {'Epoch': 28, 'HR@5': '0.0868', 'NDCG@5': '0.0611', 'HR@10': '0.1208', 'NDCG@10': '0.0721', 'HR@20': '0.1625', 'NDCG@20': '0.0826'}
2025-03-02 21:39:48,657 - EarlyStopping counter: 6 out of 10
2025-03-02 21:40:17,091 - {'epoch': 29, 'rec_loss': '6.7250'}
2025-03-02 21:40:24,980 - {'Epoch': 29, 'HR@5': '0.0863', 'NDCG@5': '0.0607', 'HR@10': '0.1198', 'NDCG@10': '0.0715', 'HR@20': '0.1638', 'NDCG@20': '0.0825'}
2025-03-02 21:40:24,981 - EarlyStopping counter: 7 out of 10
2025-03-02 21:40:55,111 - {'epoch': 30, 'rec_loss': '6.7157'}
2025-03-02 21:41:03,352 - {'Epoch': 30, 'HR@5': '0.0872', 'NDCG@5': '0.0615', 'HR@10': '0.1204', 'NDCG@10': '0.0723', 'HR@20': '0.1651', 'NDCG@20': '0.0836'}
2025-03-02 21:41:03,358 - Validation score increased.  Saving model ...
2025-03-02 21:41:30,310 - {'epoch': 31, 'rec_loss': '6.7035'}
2025-03-02 21:41:38,121 - {'Epoch': 31, 'HR@5': '0.0880', 'NDCG@5': '0.0619', 'HR@10': '0.1208', 'NDCG@10': '0.0725', 'HR@20': '0.1642', 'NDCG@20': '0.0834'}
2025-03-02 21:41:38,122 - EarlyStopping counter: 1 out of 10
2025-03-02 21:42:05,321 - {'epoch': 32, 'rec_loss': '6.7012'}
2025-03-02 21:42:13,252 - {'Epoch': 32, 'HR@5': '0.0876', 'NDCG@5': '0.0618', 'HR@10': '0.1211', 'NDCG@10': '0.0726', 'HR@20': '0.1629', 'NDCG@20': '0.0831'}
2025-03-02 21:42:13,253 - EarlyStopping counter: 2 out of 10
2025-03-02 21:42:40,977 - {'epoch': 33, 'rec_loss': '6.6948'}
2025-03-02 21:42:49,123 - {'Epoch': 33, 'HR@5': '0.0871', 'NDCG@5': '0.0614', 'HR@10': '0.1201', 'NDCG@10': '0.0721', 'HR@20': '0.1623', 'NDCG@20': '0.0827'}
2025-03-02 21:42:49,124 - EarlyStopping counter: 3 out of 10
2025-03-02 21:43:19,340 - {'epoch': 34, 'rec_loss': '6.6808'}
2025-03-02 21:43:27,225 - {'Epoch': 34, 'HR@5': '0.0871', 'NDCG@5': '0.0612', 'HR@10': '0.1200', 'NDCG@10': '0.0718', 'HR@20': '0.1597', 'NDCG@20': '0.0819'}
2025-03-02 21:43:27,230 - EarlyStopping counter: 4 out of 10
2025-03-02 21:43:55,101 - {'epoch': 35, 'rec_loss': '6.6780'}
2025-03-02 21:44:02,974 - {'Epoch': 35, 'HR@5': '0.0868', 'NDCG@5': '0.0614', 'HR@10': '0.1187', 'NDCG@10': '0.0717', 'HR@20': '0.1634', 'NDCG@20': '0.0829'}
2025-03-02 21:44:02,975 - EarlyStopping counter: 5 out of 10
2025-03-02 21:44:30,689 - {'epoch': 36, 'rec_loss': '6.6652'}
2025-03-02 21:44:38,804 - {'Epoch': 36, 'HR@5': '0.0872', 'NDCG@5': '0.0616', 'HR@10': '0.1211', 'NDCG@10': '0.0726', 'HR@20': '0.1618', 'NDCG@20': '0.0828'}
2025-03-02 21:44:38,809 - EarlyStopping counter: 6 out of 10
2025-03-02 21:45:06,197 - {'epoch': 37, 'rec_loss': '6.6532'}
2025-03-02 21:45:14,144 - {'Epoch': 37, 'HR@5': '0.0884', 'NDCG@5': '0.0620', 'HR@10': '0.1204', 'NDCG@10': '0.0723', 'HR@20': '0.1636', 'NDCG@20': '0.0832'}
2025-03-02 21:45:14,145 - EarlyStopping counter: 7 out of 10
2025-03-02 21:45:43,131 - {'epoch': 38, 'rec_loss': '6.6485'}
2025-03-02 21:45:50,986 - {'Epoch': 38, 'HR@5': '0.0866', 'NDCG@5': '0.0614', 'HR@10': '0.1201', 'NDCG@10': '0.0722', 'HR@20': '0.1621', 'NDCG@20': '0.0827'}
2025-03-02 21:45:50,987 - EarlyStopping counter: 8 out of 10
2025-03-02 21:46:18,079 - {'epoch': 39, 'rec_loss': '6.6445'}
2025-03-02 21:46:26,450 - {'Epoch': 39, 'HR@5': '0.0853', 'NDCG@5': '0.0605', 'HR@10': '0.1176', 'NDCG@10': '0.0709', 'HR@20': '0.1594', 'NDCG@20': '0.0815'}
2025-03-02 21:46:26,452 - EarlyStopping counter: 9 out of 10
2025-03-02 21:46:54,384 - {'epoch': 40, 'rec_loss': '6.6436'}
2025-03-02 21:47:02,282 - {'Epoch': 40, 'HR@5': '0.0869', 'NDCG@5': '0.0609', 'HR@10': '0.1189', 'NDCG@10': '0.0712', 'HR@20': '0.1606', 'NDCG@20': '0.0818'}
2025-03-02 21:47:02,284 - EarlyStopping counter: 10 out of 10
2025-03-02 21:47:02,284 - Early stopping
2025-03-02 21:47:02,284 - ---------------Test Score---------------
2025-03-02 21:47:10,309 - {'Epoch': 0, 'HR@5': '0.0706', 'NDCG@5': '0.0495', 'HR@10': '0.0978', 'NDCG@10': '0.0583', 'HR@20': '0.1351', 'NDCG@20': '0.0677'}
2025-03-02 21:47:10,310 - Scale_Beauty
2025-03-02 21:47:10,310 - {'Epoch': 0, 'HR@5': '0.0706', 'NDCG@5': '0.0495', 'HR@10': '0.0978', 'NDCG@10': '0.0583', 'HR@20': '0.1351', 'NDCG@20': '0.0677'}
2025-03-02 21:56:39,789 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 12, 32], start_prob=0.0, end_prob=0.3, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-02 21:56:42,624 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-02 21:56:42,628 - Total Parameters: 929445
2025-03-02 21:57:13,905 - {'epoch': 0, 'rec_loss': '8.7965'}
2025-03-02 21:57:21,715 - {'Epoch': 0, 'HR@5': '0.0245', 'NDCG@5': '0.0158', 'HR@10': '0.0374', 'NDCG@10': '0.0200', 'HR@20': '0.0562', 'NDCG@20': '0.0247'}
2025-03-02 21:57:21,719 - Validation score increased.  Saving model ...
2025-03-02 21:57:49,550 - {'epoch': 1, 'rec_loss': '8.2101'}
2025-03-02 21:57:57,495 - {'Epoch': 1, 'HR@5': '0.0441', 'NDCG@5': '0.0300', 'HR@10': '0.0644', 'NDCG@10': '0.0366', 'HR@20': '0.0926', 'NDCG@20': '0.0437'}
2025-03-02 21:57:57,496 - Validation score increased.  Saving model ...
2025-03-02 21:58:25,140 - {'epoch': 2, 'rec_loss': '7.8722'}
2025-03-02 21:58:32,779 - {'Epoch': 2, 'HR@5': '0.0580', 'NDCG@5': '0.0404', 'HR@10': '0.0838', 'NDCG@10': '0.0487', 'HR@20': '0.1161', 'NDCG@20': '0.0568'}
2025-03-02 21:58:32,780 - Validation score increased.  Saving model ...
2025-03-02 21:59:01,301 - {'epoch': 3, 'rec_loss': '7.6396'}
2025-03-02 21:59:09,658 - {'Epoch': 3, 'HR@5': '0.0672', 'NDCG@5': '0.0464', 'HR@10': '0.0955', 'NDCG@10': '0.0555', 'HR@20': '0.1329', 'NDCG@20': '0.0649'}
2025-03-02 21:59:09,659 - Validation score increased.  Saving model ...
2025-03-02 21:59:39,530 - {'epoch': 4, 'rec_loss': '7.4610'}
2025-03-02 21:59:47,215 - {'Epoch': 4, 'HR@5': '0.0751', 'NDCG@5': '0.0526', 'HR@10': '0.1032', 'NDCG@10': '0.0617', 'HR@20': '0.1399', 'NDCG@20': '0.0709'}
2025-03-02 21:59:47,221 - Validation score increased.  Saving model ...
2025-03-02 22:00:15,023 - {'epoch': 5, 'rec_loss': '7.3314'}
2025-03-02 22:00:22,699 - {'Epoch': 5, 'HR@5': '0.0774', 'NDCG@5': '0.0548', 'HR@10': '0.1081', 'NDCG@10': '0.0647', 'HR@20': '0.1477', 'NDCG@20': '0.0747'}
2025-03-02 22:00:22,700 - Validation score increased.  Saving model ...
2025-03-02 22:00:49,830 - {'epoch': 6, 'rec_loss': '7.2292'}
2025-03-02 22:00:57,509 - {'Epoch': 6, 'HR@5': '0.0796', 'NDCG@5': '0.0565', 'HR@10': '0.1103', 'NDCG@10': '0.0664', 'HR@20': '0.1507', 'NDCG@20': '0.0765'}
2025-03-02 22:00:57,510 - Validation score increased.  Saving model ...
2025-03-02 22:01:25,520 - {'epoch': 7, 'rec_loss': '7.1521'}
2025-03-02 22:01:33,221 - {'Epoch': 7, 'HR@5': '0.0818', 'NDCG@5': '0.0581', 'HR@10': '0.1124', 'NDCG@10': '0.0679', 'HR@20': '0.1528', 'NDCG@20': '0.0781'}
2025-03-02 22:01:33,222 - Validation score increased.  Saving model ...
2025-03-02 22:02:01,047 - {'epoch': 8, 'rec_loss': '7.0816'}
2025-03-02 22:02:08,830 - {'Epoch': 8, 'HR@5': '0.0826', 'NDCG@5': '0.0587', 'HR@10': '0.1133', 'NDCG@10': '0.0686', 'HR@20': '0.1532', 'NDCG@20': '0.0786'}
2025-03-02 22:02:08,831 - Validation score increased.  Saving model ...
2025-03-02 22:02:36,700 - {'epoch': 9, 'rec_loss': '7.0302'}
2025-03-02 22:02:44,568 - {'Epoch': 9, 'HR@5': '0.0816', 'NDCG@5': '0.0576', 'HR@10': '0.1134', 'NDCG@10': '0.0679', 'HR@20': '0.1546', 'NDCG@20': '0.0783'}
2025-03-02 22:02:44,569 - EarlyStopping counter: 1 out of 10
2025-03-02 22:03:13,626 - {'epoch': 10, 'rec_loss': '6.9856'}
2025-03-02 22:03:22,008 - {'Epoch': 10, 'HR@5': '0.0818', 'NDCG@5': '0.0585', 'HR@10': '0.1128', 'NDCG@10': '0.0686', 'HR@20': '0.1530', 'NDCG@20': '0.0787'}
2025-03-02 22:03:22,014 - Validation score increased.  Saving model ...
2025-03-02 22:03:50,306 - {'epoch': 11, 'rec_loss': '6.9449'}
2025-03-02 22:03:58,081 - {'Epoch': 11, 'HR@5': '0.0840', 'NDCG@5': '0.0601', 'HR@10': '0.1161', 'NDCG@10': '0.0705', 'HR@20': '0.1564', 'NDCG@20': '0.0806'}
2025-03-02 22:03:58,085 - Validation score increased.  Saving model ...
2025-03-02 22:04:25,155 - {'epoch': 12, 'rec_loss': '6.9129'}
2025-03-02 22:04:32,964 - {'Epoch': 12, 'HR@5': '0.0837', 'NDCG@5': '0.0593', 'HR@10': '0.1160', 'NDCG@10': '0.0697', 'HR@20': '0.1570', 'NDCG@20': '0.0800'}
2025-03-02 22:04:32,965 - EarlyStopping counter: 1 out of 10
2025-03-02 22:05:00,810 - {'epoch': 13, 'rec_loss': '6.8834'}
2025-03-02 22:05:08,690 - {'Epoch': 13, 'HR@5': '0.0847', 'NDCG@5': '0.0597', 'HR@10': '0.1190', 'NDCG@10': '0.0708', 'HR@20': '0.1587', 'NDCG@20': '0.0808'}
2025-03-02 22:05:08,697 - Validation score increased.  Saving model ...
2025-03-02 22:05:37,022 - {'epoch': 14, 'rec_loss': '6.8517'}
2025-03-02 22:05:45,599 - {'Epoch': 14, 'HR@5': '0.0851', 'NDCG@5': '0.0598', 'HR@10': '0.1181', 'NDCG@10': '0.0704', 'HR@20': '0.1580', 'NDCG@20': '0.0805'}
2025-03-02 22:05:45,600 - EarlyStopping counter: 1 out of 10
2025-03-02 22:06:17,161 - {'epoch': 15, 'rec_loss': '6.8334'}
2025-03-02 22:06:25,661 - {'Epoch': 15, 'HR@5': '0.0847', 'NDCG@5': '0.0598', 'HR@10': '0.1185', 'NDCG@10': '0.0707', 'HR@20': '0.1596', 'NDCG@20': '0.0810'}
2025-03-02 22:06:25,662 - Validation score increased.  Saving model ...
2025-03-02 22:06:55,188 - {'epoch': 16, 'rec_loss': '6.8097'}
2025-03-02 22:07:03,187 - {'Epoch': 16, 'HR@5': '0.0853', 'NDCG@5': '0.0600', 'HR@10': '0.1177', 'NDCG@10': '0.0704', 'HR@20': '0.1598', 'NDCG@20': '0.0810'}
2025-03-02 22:07:03,189 - Validation score increased.  Saving model ...
2025-03-02 22:07:30,273 - {'epoch': 17, 'rec_loss': '6.7947'}
2025-03-02 22:07:38,078 - {'Epoch': 17, 'HR@5': '0.0852', 'NDCG@5': '0.0592', 'HR@10': '0.1163', 'NDCG@10': '0.0692', 'HR@20': '0.1608', 'NDCG@20': '0.0804'}
2025-03-02 22:07:38,079 - EarlyStopping counter: 1 out of 10
2025-03-02 22:08:05,650 - {'epoch': 18, 'rec_loss': '6.7677'}
2025-03-02 22:08:14,131 - {'Epoch': 18, 'HR@5': '0.0853', 'NDCG@5': '0.0599', 'HR@10': '0.1174', 'NDCG@10': '0.0702', 'HR@20': '0.1603', 'NDCG@20': '0.0810'}
2025-03-02 22:08:14,133 - EarlyStopping counter: 2 out of 10
2025-03-02 22:08:41,747 - {'epoch': 19, 'rec_loss': '6.7553'}
2025-03-02 22:08:49,428 - {'Epoch': 19, 'HR@5': '0.0840', 'NDCG@5': '0.0595', 'HR@10': '0.1175', 'NDCG@10': '0.0702', 'HR@20': '0.1595', 'NDCG@20': '0.0808'}
2025-03-02 22:08:49,434 - EarlyStopping counter: 3 out of 10
2025-03-02 22:09:16,864 - {'epoch': 20, 'rec_loss': '6.7346'}
2025-03-02 22:09:24,660 - {'Epoch': 20, 'HR@5': '0.0864', 'NDCG@5': '0.0606', 'HR@10': '0.1209', 'NDCG@10': '0.0717', 'HR@20': '0.1627', 'NDCG@20': '0.0822'}
2025-03-02 22:09:24,662 - Validation score increased.  Saving model ...
2025-03-02 22:09:52,921 - {'epoch': 21, 'rec_loss': '6.7252'}
2025-03-02 22:10:00,919 - {'Epoch': 21, 'HR@5': '0.0864', 'NDCG@5': '0.0604', 'HR@10': '0.1185', 'NDCG@10': '0.0708', 'HR@20': '0.1621', 'NDCG@20': '0.0817'}
2025-03-02 22:10:00,920 - EarlyStopping counter: 1 out of 10
2025-03-02 22:10:29,547 - {'epoch': 22, 'rec_loss': '6.7085'}
2025-03-02 22:10:37,336 - {'Epoch': 22, 'HR@5': '0.0861', 'NDCG@5': '0.0611', 'HR@10': '0.1202', 'NDCG@10': '0.0722', 'HR@20': '0.1619', 'NDCG@20': '0.0827'}
2025-03-02 22:10:37,337 - Validation score increased.  Saving model ...
2025-03-02 22:11:04,329 - {'epoch': 23, 'rec_loss': '6.6951'}
2025-03-02 22:11:12,576 - {'Epoch': 23, 'HR@5': '0.0856', 'NDCG@5': '0.0604', 'HR@10': '0.1164', 'NDCG@10': '0.0704', 'HR@20': '0.1600', 'NDCG@20': '0.0813'}
2025-03-02 22:11:12,577 - EarlyStopping counter: 1 out of 10
2025-03-02 22:11:39,767 - {'epoch': 24, 'rec_loss': '6.6866'}
2025-03-02 22:11:47,585 - {'Epoch': 24, 'HR@5': '0.0847', 'NDCG@5': '0.0594', 'HR@10': '0.1191', 'NDCG@10': '0.0705', 'HR@20': '0.1608', 'NDCG@20': '0.0811'}
2025-03-02 22:11:47,586 - EarlyStopping counter: 2 out of 10
2025-03-02 22:12:16,138 - {'epoch': 25, 'rec_loss': '6.6676'}
2025-03-02 22:12:23,784 - {'Epoch': 25, 'HR@5': '0.0854', 'NDCG@5': '0.0604', 'HR@10': '0.1194', 'NDCG@10': '0.0713', 'HR@20': '0.1606', 'NDCG@20': '0.0817'}
2025-03-02 22:12:23,785 - EarlyStopping counter: 3 out of 10
2025-03-02 22:12:52,478 - {'epoch': 26, 'rec_loss': '6.6624'}
2025-03-02 22:13:00,376 - {'Epoch': 26, 'HR@5': '0.0853', 'NDCG@5': '0.0600', 'HR@10': '0.1183', 'NDCG@10': '0.0706', 'HR@20': '0.1607', 'NDCG@20': '0.0813'}
2025-03-02 22:13:00,378 - EarlyStopping counter: 4 out of 10
2025-03-02 22:13:28,386 - {'epoch': 27, 'rec_loss': '6.6471'}
2025-03-02 22:13:36,258 - {'Epoch': 27, 'HR@5': '0.0845', 'NDCG@5': '0.0606', 'HR@10': '0.1172', 'NDCG@10': '0.0711', 'HR@20': '0.1604', 'NDCG@20': '0.0820'}
2025-03-02 22:13:36,259 - EarlyStopping counter: 5 out of 10
2025-03-02 22:14:03,846 - {'epoch': 28, 'rec_loss': '6.6374'}
2025-03-02 22:14:11,607 - {'Epoch': 28, 'HR@5': '0.0850', 'NDCG@5': '0.0597', 'HR@10': '0.1194', 'NDCG@10': '0.0708', 'HR@20': '0.1604', 'NDCG@20': '0.0811'}
2025-03-02 22:14:11,609 - EarlyStopping counter: 6 out of 10
2025-03-02 22:14:38,699 - {'epoch': 29, 'rec_loss': '6.6279'}
2025-03-02 22:14:46,820 - {'Epoch': 29, 'HR@5': '0.0854', 'NDCG@5': '0.0599', 'HR@10': '0.1180', 'NDCG@10': '0.0704', 'HR@20': '0.1602', 'NDCG@20': '0.0810'}
2025-03-02 22:14:46,821 - EarlyStopping counter: 7 out of 10
2025-03-02 22:15:14,986 - {'epoch': 30, 'rec_loss': '6.6205'}
2025-03-02 22:15:22,777 - {'Epoch': 30, 'HR@5': '0.0851', 'NDCG@5': '0.0606', 'HR@10': '0.1196', 'NDCG@10': '0.0717', 'HR@20': '0.1619', 'NDCG@20': '0.0823'}
2025-03-02 22:15:22,778 - EarlyStopping counter: 8 out of 10
2025-03-02 22:15:50,740 - {'epoch': 31, 'rec_loss': '6.6062'}
2025-03-02 22:15:58,716 - {'Epoch': 31, 'HR@5': '0.0859', 'NDCG@5': '0.0602', 'HR@10': '0.1202', 'NDCG@10': '0.0712', 'HR@20': '0.1609', 'NDCG@20': '0.0815'}
2025-03-02 22:15:58,718 - EarlyStopping counter: 9 out of 10
2025-03-02 22:16:26,210 - {'epoch': 32, 'rec_loss': '6.6043'}
2025-03-02 22:16:33,832 - {'Epoch': 32, 'HR@5': '0.0871', 'NDCG@5': '0.0613', 'HR@10': '0.1192', 'NDCG@10': '0.0717', 'HR@20': '0.1617', 'NDCG@20': '0.0824'}
2025-03-02 22:16:33,833 - EarlyStopping counter: 10 out of 10
2025-03-02 22:16:33,833 - Early stopping
2025-03-02 22:16:33,834 - ---------------Test Score---------------
2025-03-02 22:16:41,669 - {'Epoch': 0, 'HR@5': '0.0712', 'NDCG@5': '0.0505', 'HR@10': '0.0988', 'NDCG@10': '0.0594', 'HR@20': '0.1355', 'NDCG@20': '0.0686'}
2025-03-02 22:16:41,670 - Scale_Beauty
2025-03-02 22:16:41,670 - {'Epoch': 0, 'HR@5': '0.0712', 'NDCG@5': '0.0505', 'HR@10': '0.0988', 'NDCG@10': '0.0594', 'HR@20': '0.1355', 'NDCG@20': '0.0686'}
2025-03-02 22:23:14,721 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 12, 32], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-02 22:23:17,612 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-02 22:23:17,617 - Total Parameters: 929445
2025-03-02 22:23:46,483 - {'epoch': 0, 'rec_loss': '8.8607'}
2025-03-02 22:23:54,509 - {'Epoch': 0, 'HR@5': '0.0161', 'NDCG@5': '0.0098', 'HR@10': '0.0259', 'NDCG@10': '0.0130', 'HR@20': '0.0406', 'NDCG@20': '0.0167'}
2025-03-02 22:23:54,512 - Validation score increased.  Saving model ...
2025-03-02 22:24:22,397 - {'epoch': 1, 'rec_loss': '8.4006'}
2025-03-02 22:24:30,118 - {'Epoch': 1, 'HR@5': '0.0334', 'NDCG@5': '0.0222', 'HR@10': '0.0499', 'NDCG@10': '0.0275', 'HR@20': '0.0741', 'NDCG@20': '0.0336'}
2025-03-02 22:24:30,119 - Validation score increased.  Saving model ...
2025-03-02 22:24:59,142 - {'epoch': 2, 'rec_loss': '8.1144'}
2025-03-02 22:25:06,626 - {'Epoch': 2, 'HR@5': '0.0435', 'NDCG@5': '0.0295', 'HR@10': '0.0664', 'NDCG@10': '0.0369', 'HR@20': '0.0943', 'NDCG@20': '0.0439'}
2025-03-02 22:25:06,627 - Validation score increased.  Saving model ...
2025-03-02 22:25:36,195 - {'epoch': 3, 'rec_loss': '7.9067'}
2025-03-02 22:25:43,632 - {'Epoch': 3, 'HR@5': '0.0534', 'NDCG@5': '0.0360', 'HR@10': '0.0796', 'NDCG@10': '0.0444', 'HR@20': '0.1149', 'NDCG@20': '0.0532'}
2025-03-02 22:25:43,634 - Validation score increased.  Saving model ...
2025-03-02 22:26:11,787 - {'epoch': 4, 'rec_loss': '7.7525'}
2025-03-02 22:26:19,193 - {'Epoch': 4, 'HR@5': '0.0611', 'NDCG@5': '0.0424', 'HR@10': '0.0882', 'NDCG@10': '0.0511', 'HR@20': '0.1238', 'NDCG@20': '0.0600'}
2025-03-02 22:26:19,195 - Validation score increased.  Saving model ...
2025-03-02 22:26:46,749 - {'epoch': 5, 'rec_loss': '7.6461'}
2025-03-02 22:26:54,310 - {'Epoch': 5, 'HR@5': '0.0663', 'NDCG@5': '0.0464', 'HR@10': '0.0965', 'NDCG@10': '0.0561', 'HR@20': '0.1332', 'NDCG@20': '0.0654'}
2025-03-02 22:26:54,311 - Validation score increased.  Saving model ...
2025-03-02 22:27:22,375 - {'epoch': 6, 'rec_loss': '7.5517'}
2025-03-02 22:27:30,033 - {'Epoch': 6, 'HR@5': '0.0724', 'NDCG@5': '0.0498', 'HR@10': '0.1004', 'NDCG@10': '0.0588', 'HR@20': '0.1386', 'NDCG@20': '0.0684'}
2025-03-02 22:27:30,034 - Validation score increased.  Saving model ...
2025-03-02 22:27:59,283 - {'epoch': 7, 'rec_loss': '7.4734'}
2025-03-02 22:28:06,872 - {'Epoch': 7, 'HR@5': '0.0758', 'NDCG@5': '0.0530', 'HR@10': '0.1036', 'NDCG@10': '0.0620', 'HR@20': '0.1431', 'NDCG@20': '0.0719'}
2025-03-02 22:28:06,877 - Validation score increased.  Saving model ...
2025-03-02 22:28:35,932 - {'epoch': 8, 'rec_loss': '7.4045'}
2025-03-02 22:28:43,529 - {'Epoch': 8, 'HR@5': '0.0784', 'NDCG@5': '0.0551', 'HR@10': '0.1071', 'NDCG@10': '0.0643', 'HR@20': '0.1474', 'NDCG@20': '0.0744'}
2025-03-02 22:28:43,530 - Validation score increased.  Saving model ...
2025-03-02 22:29:12,609 - {'epoch': 9, 'rec_loss': '7.3589'}
2025-03-02 22:29:20,381 - {'Epoch': 9, 'HR@5': '0.0786', 'NDCG@5': '0.0542', 'HR@10': '0.1103', 'NDCG@10': '0.0644', 'HR@20': '0.1484', 'NDCG@20': '0.0740'}
2025-03-02 22:29:20,382 - EarlyStopping counter: 1 out of 10
2025-03-02 22:29:47,976 - {'epoch': 10, 'rec_loss': '7.3096'}
2025-03-02 22:29:55,348 - {'Epoch': 10, 'HR@5': '0.0813', 'NDCG@5': '0.0569', 'HR@10': '0.1112', 'NDCG@10': '0.0666', 'HR@20': '0.1505', 'NDCG@20': '0.0765'}
2025-03-02 22:29:55,349 - Validation score increased.  Saving model ...
2025-03-02 22:30:23,106 - {'epoch': 11, 'rec_loss': '7.2680'}
2025-03-02 22:30:31,096 - {'Epoch': 11, 'HR@5': '0.0815', 'NDCG@5': '0.0576', 'HR@10': '0.1111', 'NDCG@10': '0.0672', 'HR@20': '0.1515', 'NDCG@20': '0.0774'}
2025-03-02 22:30:31,097 - Validation score increased.  Saving model ...
2025-03-02 22:30:58,223 - {'epoch': 12, 'rec_loss': '7.2301'}
2025-03-02 22:31:05,748 - {'Epoch': 12, 'HR@5': '0.0830', 'NDCG@5': '0.0581', 'HR@10': '0.1131', 'NDCG@10': '0.0679', 'HR@20': '0.1535', 'NDCG@20': '0.0780'}
2025-03-02 22:31:05,749 - Validation score increased.  Saving model ...
2025-03-02 22:31:34,031 - {'epoch': 13, 'rec_loss': '7.2034'}
2025-03-02 22:31:41,834 - {'Epoch': 13, 'HR@5': '0.0840', 'NDCG@5': '0.0580', 'HR@10': '0.1158', 'NDCG@10': '0.0683', 'HR@20': '0.1549', 'NDCG@20': '0.0781'}
2025-03-02 22:31:41,835 - Validation score increased.  Saving model ...
2025-03-02 22:32:09,523 - {'epoch': 14, 'rec_loss': '7.1729'}
2025-03-02 22:32:17,041 - {'Epoch': 14, 'HR@5': '0.0851', 'NDCG@5': '0.0597', 'HR@10': '0.1165', 'NDCG@10': '0.0698', 'HR@20': '0.1569', 'NDCG@20': '0.0799'}
2025-03-02 22:32:17,046 - Validation score increased.  Saving model ...
2025-03-02 22:32:44,843 - {'epoch': 15, 'rec_loss': '7.1487'}
2025-03-02 22:32:52,271 - {'Epoch': 15, 'HR@5': '0.0850', 'NDCG@5': '0.0598', 'HR@10': '0.1163', 'NDCG@10': '0.0699', 'HR@20': '0.1582', 'NDCG@20': '0.0805'}
2025-03-02 22:32:52,272 - Validation score increased.  Saving model ...
2025-03-02 22:33:21,557 - {'epoch': 16, 'rec_loss': '7.1261'}
2025-03-02 22:33:29,034 - {'Epoch': 16, 'HR@5': '0.0841', 'NDCG@5': '0.0595', 'HR@10': '0.1168', 'NDCG@10': '0.0701', 'HR@20': '0.1597', 'NDCG@20': '0.0809'}
2025-03-02 22:33:29,035 - Validation score increased.  Saving model ...
2025-03-02 22:33:56,691 - {'epoch': 17, 'rec_loss': '7.1062'}
2025-03-02 22:34:04,077 - {'Epoch': 17, 'HR@5': '0.0849', 'NDCG@5': '0.0603', 'HR@10': '0.1168', 'NDCG@10': '0.0706', 'HR@20': '0.1587', 'NDCG@20': '0.0811'}
2025-03-02 22:34:04,078 - Validation score increased.  Saving model ...
2025-03-02 22:34:34,337 - {'epoch': 18, 'rec_loss': '7.0779'}
2025-03-02 22:34:42,001 - {'Epoch': 18, 'HR@5': '0.0846', 'NDCG@5': '0.0600', 'HR@10': '0.1170', 'NDCG@10': '0.0705', 'HR@20': '0.1598', 'NDCG@20': '0.0812'}
2025-03-02 22:34:42,002 - Validation score increased.  Saving model ...
2025-03-02 22:35:09,268 - {'epoch': 19, 'rec_loss': '7.0609'}
2025-03-02 22:35:16,899 - {'Epoch': 19, 'HR@5': '0.0863', 'NDCG@5': '0.0607', 'HR@10': '0.1171', 'NDCG@10': '0.0707', 'HR@20': '0.1596', 'NDCG@20': '0.0814'}
2025-03-02 22:35:16,900 - Validation score increased.  Saving model ...
2025-03-02 22:35:45,057 - {'epoch': 20, 'rec_loss': '7.0456'}
2025-03-02 22:35:52,770 - {'Epoch': 20, 'HR@5': '0.0872', 'NDCG@5': '0.0614', 'HR@10': '0.1186', 'NDCG@10': '0.0715', 'HR@20': '0.1610', 'NDCG@20': '0.0821'}
2025-03-02 22:35:52,771 - Validation score increased.  Saving model ...
2025-03-02 22:36:20,823 - {'epoch': 21, 'rec_loss': '7.0335'}
2025-03-02 22:36:28,447 - {'Epoch': 21, 'HR@5': '0.0866', 'NDCG@5': '0.0605', 'HR@10': '0.1188', 'NDCG@10': '0.0709', 'HR@20': '0.1609', 'NDCG@20': '0.0815'}
2025-03-02 22:36:28,448 - EarlyStopping counter: 1 out of 10
2025-03-02 22:36:57,069 - {'epoch': 22, 'rec_loss': '7.0217'}
2025-03-02 22:37:04,776 - {'Epoch': 22, 'HR@5': '0.0861', 'NDCG@5': '0.0610', 'HR@10': '0.1195', 'NDCG@10': '0.0717', 'HR@20': '0.1627', 'NDCG@20': '0.0826'}
2025-03-02 22:37:04,777 - Validation score increased.  Saving model ...
2025-03-02 22:37:32,809 - {'epoch': 23, 'rec_loss': '7.0060'}
2025-03-02 22:37:40,472 - {'Epoch': 23, 'HR@5': '0.0869', 'NDCG@5': '0.0613', 'HR@10': '0.1196', 'NDCG@10': '0.0718', 'HR@20': '0.1615', 'NDCG@20': '0.0823'}
2025-03-02 22:37:40,473 - EarlyStopping counter: 1 out of 10
2025-03-02 22:38:10,307 - {'epoch': 24, 'rec_loss': '6.9987'}
2025-03-02 22:38:17,893 - {'Epoch': 24, 'HR@5': '0.0868', 'NDCG@5': '0.0611', 'HR@10': '0.1183', 'NDCG@10': '0.0712', 'HR@20': '0.1625', 'NDCG@20': '0.0824'}
2025-03-02 22:38:17,894 - EarlyStopping counter: 2 out of 10
2025-03-02 22:38:45,208 - {'epoch': 25, 'rec_loss': '6.9769'}
2025-03-02 22:38:52,707 - {'Epoch': 25, 'HR@5': '0.0858', 'NDCG@5': '0.0604', 'HR@10': '0.1198', 'NDCG@10': '0.0713', 'HR@20': '0.1647', 'NDCG@20': '0.0827'}
2025-03-02 22:38:52,708 - Validation score increased.  Saving model ...
2025-03-02 22:39:21,524 - {'epoch': 26, 'rec_loss': '6.9732'}
2025-03-02 22:39:29,005 - {'Epoch': 26, 'HR@5': '0.0865', 'NDCG@5': '0.0609', 'HR@10': '0.1207', 'NDCG@10': '0.0719', 'HR@20': '0.1650', 'NDCG@20': '0.0831'}
2025-03-02 22:39:29,006 - Validation score increased.  Saving model ...
2025-03-02 22:39:56,525 - {'epoch': 27, 'rec_loss': '6.9556'}
2025-03-02 22:40:04,272 - {'Epoch': 27, 'HR@5': '0.0865', 'NDCG@5': '0.0617', 'HR@10': '0.1202', 'NDCG@10': '0.0726', 'HR@20': '0.1632', 'NDCG@20': '0.0834'}
2025-03-02 22:40:04,273 - Validation score increased.  Saving model ...
2025-03-02 22:40:32,372 - {'epoch': 28, 'rec_loss': '6.9520'}
2025-03-02 22:40:39,912 - {'Epoch': 28, 'HR@5': '0.0861', 'NDCG@5': '0.0602', 'HR@10': '0.1195', 'NDCG@10': '0.0710', 'HR@20': '0.1630', 'NDCG@20': '0.0820'}
2025-03-02 22:40:39,913 - EarlyStopping counter: 1 out of 10
2025-03-02 22:41:07,636 - {'epoch': 29, 'rec_loss': '6.9421'}
2025-03-02 22:41:15,200 - {'Epoch': 29, 'HR@5': '0.0864', 'NDCG@5': '0.0603', 'HR@10': '0.1215', 'NDCG@10': '0.0716', 'HR@20': '0.1642', 'NDCG@20': '0.0824'}
2025-03-02 22:41:15,201 - EarlyStopping counter: 2 out of 10
2025-03-02 22:41:43,111 - {'epoch': 30, 'rec_loss': '6.9363'}
2025-03-02 22:41:50,629 - {'Epoch': 30, 'HR@5': '0.0871', 'NDCG@5': '0.0614', 'HR@10': '0.1217', 'NDCG@10': '0.0725', 'HR@20': '0.1655', 'NDCG@20': '0.0836'}
2025-03-02 22:41:50,631 - Validation score increased.  Saving model ...
2025-03-02 22:42:19,000 - {'epoch': 31, 'rec_loss': '6.9217'}
2025-03-02 22:42:26,839 - {'Epoch': 31, 'HR@5': '0.0872', 'NDCG@5': '0.0614', 'HR@10': '0.1219', 'NDCG@10': '0.0726', 'HR@20': '0.1645', 'NDCG@20': '0.0833'}
2025-03-02 22:42:26,840 - EarlyStopping counter: 1 out of 10
2025-03-02 22:42:54,658 - {'epoch': 32, 'rec_loss': '6.9187'}
2025-03-02 22:43:02,326 - {'Epoch': 32, 'HR@5': '0.0863', 'NDCG@5': '0.0611', 'HR@10': '0.1203', 'NDCG@10': '0.0721', 'HR@20': '0.1629', 'NDCG@20': '0.0828'}
2025-03-02 22:43:02,327 - EarlyStopping counter: 2 out of 10
2025-03-02 22:43:31,409 - {'epoch': 33, 'rec_loss': '6.9157'}
2025-03-02 22:43:39,033 - {'Epoch': 33, 'HR@5': '0.0875', 'NDCG@5': '0.0618', 'HR@10': '0.1205', 'NDCG@10': '0.0724', 'HR@20': '0.1635', 'NDCG@20': '0.0832'}
2025-03-02 22:43:39,034 - EarlyStopping counter: 3 out of 10
2025-03-02 22:44:07,861 - {'epoch': 34, 'rec_loss': '6.8972'}
2025-03-02 22:44:15,476 - {'Epoch': 34, 'HR@5': '0.0879', 'NDCG@5': '0.0619', 'HR@10': '0.1210', 'NDCG@10': '0.0726', 'HR@20': '0.1650', 'NDCG@20': '0.0836'}
2025-03-02 22:44:15,477 - Validation score increased.  Saving model ...
2025-03-02 22:44:48,316 - {'epoch': 35, 'rec_loss': '6.8955'}
2025-03-02 22:44:55,955 - {'Epoch': 35, 'HR@5': '0.0866', 'NDCG@5': '0.0613', 'HR@10': '0.1207', 'NDCG@10': '0.0723', 'HR@20': '0.1650', 'NDCG@20': '0.0834'}
2025-03-02 22:44:55,956 - EarlyStopping counter: 1 out of 10
2025-03-02 22:45:25,501 - {'epoch': 36, 'rec_loss': '6.8899'}
2025-03-02 22:45:33,406 - {'Epoch': 36, 'HR@5': '0.0882', 'NDCG@5': '0.0621', 'HR@10': '0.1218', 'NDCG@10': '0.0729', 'HR@20': '0.1643', 'NDCG@20': '0.0836'}
2025-03-02 22:45:33,408 - EarlyStopping counter: 2 out of 10
2025-03-02 22:46:02,331 - {'epoch': 37, 'rec_loss': '6.8740'}
2025-03-02 22:46:09,945 - {'Epoch': 37, 'HR@5': '0.0877', 'NDCG@5': '0.0618', 'HR@10': '0.1223', 'NDCG@10': '0.0729', 'HR@20': '0.1660', 'NDCG@20': '0.0839'}
2025-03-02 22:46:09,946 - Validation score increased.  Saving model ...
2025-03-02 22:46:38,577 - {'epoch': 38, 'rec_loss': '6.8726'}
2025-03-02 22:46:46,146 - {'Epoch': 38, 'HR@5': '0.0888', 'NDCG@5': '0.0621', 'HR@10': '0.1223', 'NDCG@10': '0.0728', 'HR@20': '0.1654', 'NDCG@20': '0.0837'}
2025-03-02 22:46:46,147 - EarlyStopping counter: 1 out of 10
2025-03-02 22:47:13,562 - {'epoch': 39, 'rec_loss': '6.8663'}
2025-03-02 22:47:21,235 - {'Epoch': 39, 'HR@5': '0.0859', 'NDCG@5': '0.0608', 'HR@10': '0.1206', 'NDCG@10': '0.0719', 'HR@20': '0.1642', 'NDCG@20': '0.0829'}
2025-03-02 22:47:21,236 - EarlyStopping counter: 2 out of 10
2025-03-02 22:47:48,849 - {'epoch': 40, 'rec_loss': '6.8657'}
2025-03-02 22:47:56,533 - {'Epoch': 40, 'HR@5': '0.0873', 'NDCG@5': '0.0618', 'HR@10': '0.1208', 'NDCG@10': '0.0726', 'HR@20': '0.1657', 'NDCG@20': '0.0839'}
2025-03-02 22:47:56,534 - EarlyStopping counter: 3 out of 10
2025-03-02 22:48:23,978 - {'epoch': 41, 'rec_loss': '6.8550'}
2025-03-02 22:48:31,633 - {'Epoch': 41, 'HR@5': '0.0898', 'NDCG@5': '0.0632', 'HR@10': '0.1221', 'NDCG@10': '0.0736', 'HR@20': '0.1655', 'NDCG@20': '0.0845'}
2025-03-02 22:48:31,634 - Validation score increased.  Saving model ...
2025-03-02 22:48:58,521 - {'epoch': 42, 'rec_loss': '6.8530'}
2025-03-02 22:49:06,769 - {'Epoch': 42, 'HR@5': '0.0889', 'NDCG@5': '0.0627', 'HR@10': '0.1222', 'NDCG@10': '0.0734', 'HR@20': '0.1658', 'NDCG@20': '0.0844'}
2025-03-02 22:49:06,770 - EarlyStopping counter: 1 out of 10
2025-03-02 22:49:34,530 - {'epoch': 43, 'rec_loss': '6.8449'}
2025-03-02 22:49:42,099 - {'Epoch': 43, 'HR@5': '0.0877', 'NDCG@5': '0.0620', 'HR@10': '0.1206', 'NDCG@10': '0.0726', 'HR@20': '0.1662', 'NDCG@20': '0.0841'}
2025-03-02 22:49:42,100 - EarlyStopping counter: 2 out of 10
2025-03-02 22:50:09,736 - {'epoch': 44, 'rec_loss': '6.8414'}
2025-03-02 22:50:17,520 - {'Epoch': 44, 'HR@5': '0.0881', 'NDCG@5': '0.0621', 'HR@10': '0.1198', 'NDCG@10': '0.0723', 'HR@20': '0.1634', 'NDCG@20': '0.0834'}
2025-03-02 22:50:17,522 - EarlyStopping counter: 3 out of 10
2025-03-02 22:50:45,625 - {'epoch': 45, 'rec_loss': '6.8332'}
2025-03-02 22:50:53,756 - {'Epoch': 45, 'HR@5': '0.0892', 'NDCG@5': '0.0631', 'HR@10': '0.1219', 'NDCG@10': '0.0736', 'HR@20': '0.1658', 'NDCG@20': '0.0847'}
2025-03-02 22:50:53,761 - Validation score increased.  Saving model ...
2025-03-02 22:51:21,672 - {'epoch': 46, 'rec_loss': '6.8226'}
2025-03-02 22:51:29,414 - {'Epoch': 46, 'HR@5': '0.0889', 'NDCG@5': '0.0634', 'HR@10': '0.1224', 'NDCG@10': '0.0742', 'HR@20': '0.1667', 'NDCG@20': '0.0853'}
2025-03-02 22:51:29,415 - Validation score increased.  Saving model ...
2025-03-02 22:51:56,802 - {'epoch': 47, 'rec_loss': '6.8187'}
2025-03-02 22:52:04,631 - {'Epoch': 47, 'HR@5': '0.0891', 'NDCG@5': '0.0631', 'HR@10': '0.1203', 'NDCG@10': '0.0731', 'HR@20': '0.1652', 'NDCG@20': '0.0844'}
2025-03-02 22:52:04,633 - EarlyStopping counter: 1 out of 10
2025-03-02 22:52:32,166 - {'epoch': 48, 'rec_loss': '6.8191'}
2025-03-02 22:52:40,417 - {'Epoch': 48, 'HR@5': '0.0882', 'NDCG@5': '0.0624', 'HR@10': '0.1210', 'NDCG@10': '0.0730', 'HR@20': '0.1654', 'NDCG@20': '0.0841'}
2025-03-02 22:52:40,418 - EarlyStopping counter: 2 out of 10
2025-03-02 22:53:07,561 - {'epoch': 49, 'rec_loss': '6.8166'}
2025-03-02 22:53:15,336 - {'Epoch': 49, 'HR@5': '0.0891', 'NDCG@5': '0.0625', 'HR@10': '0.1206', 'NDCG@10': '0.0727', 'HR@20': '0.1648', 'NDCG@20': '0.0838'}
2025-03-02 22:53:15,337 - EarlyStopping counter: 3 out of 10
2025-03-02 22:53:42,288 - {'epoch': 50, 'rec_loss': '6.8133'}
2025-03-02 22:53:50,043 - {'Epoch': 50, 'HR@5': '0.0884', 'NDCG@5': '0.0623', 'HR@10': '0.1206', 'NDCG@10': '0.0727', 'HR@20': '0.1655', 'NDCG@20': '0.0840'}
2025-03-02 22:53:50,044 - EarlyStopping counter: 4 out of 10
2025-03-02 22:54:18,188 - {'epoch': 51, 'rec_loss': '6.8061'}
2025-03-02 22:54:26,212 - {'Epoch': 51, 'HR@5': '0.0880', 'NDCG@5': '0.0622', 'HR@10': '0.1217', 'NDCG@10': '0.0731', 'HR@20': '0.1655', 'NDCG@20': '0.0841'}
2025-03-02 22:54:26,214 - EarlyStopping counter: 5 out of 10
2025-03-02 22:54:53,887 - {'epoch': 52, 'rec_loss': '6.8003'}
2025-03-02 22:55:01,491 - {'Epoch': 52, 'HR@5': '0.0879', 'NDCG@5': '0.0622', 'HR@10': '0.1203', 'NDCG@10': '0.0727', 'HR@20': '0.1645', 'NDCG@20': '0.0839'}
2025-03-02 22:55:01,492 - EarlyStopping counter: 6 out of 10
2025-03-02 22:55:29,045 - {'epoch': 53, 'rec_loss': '6.8029'}
2025-03-02 22:55:37,067 - {'Epoch': 53, 'HR@5': '0.0886', 'NDCG@5': '0.0625', 'HR@10': '0.1219', 'NDCG@10': '0.0731', 'HR@20': '0.1663', 'NDCG@20': '0.0843'}
2025-03-02 22:55:37,068 - EarlyStopping counter: 7 out of 10
2025-03-02 22:56:04,989 - {'epoch': 54, 'rec_loss': '6.7934'}
2025-03-02 22:56:12,536 - {'Epoch': 54, 'HR@5': '0.0883', 'NDCG@5': '0.0628', 'HR@10': '0.1215', 'NDCG@10': '0.0735', 'HR@20': '0.1651', 'NDCG@20': '0.0845'}
2025-03-02 22:56:12,537 - EarlyStopping counter: 8 out of 10
2025-03-02 22:56:39,677 - {'epoch': 55, 'rec_loss': '6.7848'}
2025-03-02 22:56:47,584 - {'Epoch': 55, 'HR@5': '0.0896', 'NDCG@5': '0.0636', 'HR@10': '0.1218', 'NDCG@10': '0.0740', 'HR@20': '0.1671', 'NDCG@20': '0.0854'}
2025-03-02 22:56:47,585 - Validation score increased.  Saving model ...
2025-03-02 22:57:15,022 - {'epoch': 56, 'rec_loss': '6.7865'}
2025-03-02 22:57:22,808 - {'Epoch': 56, 'HR@5': '0.0889', 'NDCG@5': '0.0632', 'HR@10': '0.1209', 'NDCG@10': '0.0735', 'HR@20': '0.1656', 'NDCG@20': '0.0848'}
2025-03-02 22:57:22,809 - EarlyStopping counter: 1 out of 10
2025-03-02 22:57:49,968 - {'epoch': 57, 'rec_loss': '6.7837'}
2025-03-02 22:57:57,653 - {'Epoch': 57, 'HR@5': '0.0881', 'NDCG@5': '0.0624', 'HR@10': '0.1213', 'NDCG@10': '0.0731', 'HR@20': '0.1655', 'NDCG@20': '0.0842'}
2025-03-02 22:57:57,654 - EarlyStopping counter: 2 out of 10
2025-03-02 22:58:27,441 - {'epoch': 58, 'rec_loss': '6.7789'}
2025-03-02 22:58:35,304 - {'Epoch': 58, 'HR@5': '0.0872', 'NDCG@5': '0.0622', 'HR@10': '0.1202', 'NDCG@10': '0.0728', 'HR@20': '0.1652', 'NDCG@20': '0.0841'}
2025-03-02 22:58:35,305 - EarlyStopping counter: 3 out of 10
2025-03-02 22:59:03,245 - {'epoch': 59, 'rec_loss': '6.7705'}
2025-03-02 22:59:10,967 - {'Epoch': 59, 'HR@5': '0.0890', 'NDCG@5': '0.0631', 'HR@10': '0.1233', 'NDCG@10': '0.0741', 'HR@20': '0.1667', 'NDCG@20': '0.0850'}
2025-03-02 22:59:10,968 - EarlyStopping counter: 4 out of 10
2025-03-02 22:59:38,895 - {'epoch': 60, 'rec_loss': '6.7663'}
2025-03-02 22:59:46,530 - {'Epoch': 60, 'HR@5': '0.0888', 'NDCG@5': '0.0633', 'HR@10': '0.1217', 'NDCG@10': '0.0739', 'HR@20': '0.1665', 'NDCG@20': '0.0852'}
2025-03-02 22:59:46,531 - EarlyStopping counter: 5 out of 10
2025-03-02 23:00:14,222 - {'epoch': 61, 'rec_loss': '6.7665'}
2025-03-02 23:00:21,962 - {'Epoch': 61, 'HR@5': '0.0887', 'NDCG@5': '0.0634', 'HR@10': '0.1225', 'NDCG@10': '0.0744', 'HR@20': '0.1670', 'NDCG@20': '0.0856'}
2025-03-02 23:00:21,963 - Validation score increased.  Saving model ...
2025-03-02 23:00:49,457 - {'epoch': 62, 'rec_loss': '6.7653'}
2025-03-02 23:00:57,126 - {'Epoch': 62, 'HR@5': '0.0894', 'NDCG@5': '0.0641', 'HR@10': '0.1219', 'NDCG@10': '0.0746', 'HR@20': '0.1666', 'NDCG@20': '0.0858'}
2025-03-02 23:00:57,127 - Validation score increased.  Saving model ...
2025-03-02 23:01:26,378 - {'epoch': 63, 'rec_loss': '6.7591'}
2025-03-02 23:01:34,228 - {'Epoch': 63, 'HR@5': '0.0880', 'NDCG@5': '0.0625', 'HR@10': '0.1212', 'NDCG@10': '0.0733', 'HR@20': '0.1671', 'NDCG@20': '0.0848'}
2025-03-02 23:01:34,229 - EarlyStopping counter: 1 out of 10
2025-03-02 23:02:02,797 - {'epoch': 64, 'rec_loss': '6.7556'}
2025-03-02 23:02:10,499 - {'Epoch': 64, 'HR@5': '0.0893', 'NDCG@5': '0.0633', 'HR@10': '0.1219', 'NDCG@10': '0.0738', 'HR@20': '0.1656', 'NDCG@20': '0.0848'}
2025-03-02 23:02:10,500 - EarlyStopping counter: 2 out of 10
2025-03-02 23:02:38,280 - {'epoch': 65, 'rec_loss': '6.7509'}
2025-03-02 23:02:46,469 - {'Epoch': 65, 'HR@5': '0.0877', 'NDCG@5': '0.0625', 'HR@10': '0.1217', 'NDCG@10': '0.0735', 'HR@20': '0.1656', 'NDCG@20': '0.0846'}
2025-03-02 23:02:46,476 - EarlyStopping counter: 3 out of 10
2025-03-02 23:03:14,178 - {'epoch': 66, 'rec_loss': '6.7516'}
2025-03-02 23:03:21,905 - {'Epoch': 66, 'HR@5': '0.0893', 'NDCG@5': '0.0630', 'HR@10': '0.1206', 'NDCG@10': '0.0731', 'HR@20': '0.1648', 'NDCG@20': '0.0842'}
2025-03-02 23:03:21,906 - EarlyStopping counter: 4 out of 10
2025-03-02 23:03:49,588 - {'epoch': 67, 'rec_loss': '6.7519'}
2025-03-02 23:03:57,462 - {'Epoch': 67, 'HR@5': '0.0875', 'NDCG@5': '0.0618', 'HR@10': '0.1201', 'NDCG@10': '0.0723', 'HR@20': '0.1660', 'NDCG@20': '0.0839'}
2025-03-02 23:03:57,463 - EarlyStopping counter: 5 out of 10
2025-03-02 23:04:25,076 - {'epoch': 68, 'rec_loss': '6.7505'}
2025-03-02 23:04:32,782 - {'Epoch': 68, 'HR@5': '0.0873', 'NDCG@5': '0.0624', 'HR@10': '0.1224', 'NDCG@10': '0.0737', 'HR@20': '0.1667', 'NDCG@20': '0.0848'}
2025-03-02 23:04:32,783 - EarlyStopping counter: 6 out of 10
2025-03-02 23:05:00,727 - {'epoch': 69, 'rec_loss': '6.7322'}
2025-03-02 23:05:08,646 - {'Epoch': 69, 'HR@5': '0.0895', 'NDCG@5': '0.0638', 'HR@10': '0.1219', 'NDCG@10': '0.0743', 'HR@20': '0.1667', 'NDCG@20': '0.0856'}
2025-03-02 23:05:08,647 - EarlyStopping counter: 7 out of 10
2025-03-02 23:05:36,094 - {'epoch': 70, 'rec_loss': '6.7364'}
2025-03-02 23:05:43,830 - {'Epoch': 70, 'HR@5': '0.0871', 'NDCG@5': '0.0618', 'HR@10': '0.1217', 'NDCG@10': '0.0729', 'HR@20': '0.1667', 'NDCG@20': '0.0842'}
2025-03-02 23:05:43,831 - EarlyStopping counter: 8 out of 10
2025-03-02 23:06:13,186 - {'epoch': 71, 'rec_loss': '6.7397'}
2025-03-02 23:06:20,916 - {'Epoch': 71, 'HR@5': '0.0889', 'NDCG@5': '0.0629', 'HR@10': '0.1211', 'NDCG@10': '0.0732', 'HR@20': '0.1667', 'NDCG@20': '0.0847'}
2025-03-02 23:06:20,918 - EarlyStopping counter: 9 out of 10
2025-03-02 23:06:48,323 - {'epoch': 72, 'rec_loss': '6.7355'}
2025-03-02 23:06:56,152 - {'Epoch': 72, 'HR@5': '0.0890', 'NDCG@5': '0.0636', 'HR@10': '0.1221', 'NDCG@10': '0.0743', 'HR@20': '0.1661', 'NDCG@20': '0.0853'}
2025-03-02 23:06:56,153 - EarlyStopping counter: 10 out of 10
2025-03-02 23:06:56,154 - Early stopping
2025-03-02 23:06:56,154 - ---------------Test Score---------------
2025-03-02 23:07:03,744 - {'Epoch': 0, 'HR@5': '0.0715', 'NDCG@5': '0.0506', 'HR@10': '0.1000', 'NDCG@10': '0.0598', 'HR@20': '0.1380', 'NDCG@20': '0.0694'}
2025-03-02 23:07:03,745 - Scale_Beauty
2025-03-02 23:07:03,746 - {'Epoch': 0, 'HR@5': '0.0715', 'NDCG@5': '0.0506', 'HR@10': '0.1000', 'NDCG@10': '0.0598', 'HR@20': '0.1380', 'NDCG@20': '0.0694'}
2025-03-02 23:13:18,619 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 12, 32], start_prob=0.4, end_prob=0.7, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-02 23:13:21,507 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-02 23:13:21,511 - Total Parameters: 929445
2025-03-02 23:13:50,935 - {'epoch': 0, 'rec_loss': '8.8884'}
2025-03-02 23:13:59,960 - {'Epoch': 0, 'HR@5': '0.0133', 'NDCG@5': '0.0083', 'HR@10': '0.0232', 'NDCG@10': '0.0115', 'HR@20': '0.0375', 'NDCG@20': '0.0151'}
2025-03-02 23:13:59,961 - Validation score increased.  Saving model ...
2025-03-02 23:14:27,277 - {'epoch': 1, 'rec_loss': '8.4800'}
2025-03-02 23:14:35,227 - {'Epoch': 1, 'HR@5': '0.0280', 'NDCG@5': '0.0181', 'HR@10': '0.0443', 'NDCG@10': '0.0234', 'HR@20': '0.0643', 'NDCG@20': '0.0284'}
2025-03-02 23:14:35,228 - Validation score increased.  Saving model ...
2025-03-02 23:15:03,204 - {'epoch': 2, 'rec_loss': '8.2275'}
2025-03-02 23:15:12,067 - {'Epoch': 2, 'HR@5': '0.0382', 'NDCG@5': '0.0254', 'HR@10': '0.0574', 'NDCG@10': '0.0316', 'HR@20': '0.0832', 'NDCG@20': '0.0381'}
2025-03-02 23:15:12,068 - Validation score increased.  Saving model ...
2025-03-02 23:15:40,503 - {'epoch': 3, 'rec_loss': '8.0291'}
2025-03-02 23:15:49,248 - {'Epoch': 3, 'HR@5': '0.0461', 'NDCG@5': '0.0305', 'HR@10': '0.0690', 'NDCG@10': '0.0379', 'HR@20': '0.1041', 'NDCG@20': '0.0467'}
2025-03-02 23:15:49,250 - Validation score increased.  Saving model ...
2025-03-02 23:16:14,627 - {'epoch': 4, 'rec_loss': '7.8813'}
2025-03-02 23:16:22,920 - {'Epoch': 4, 'HR@5': '0.0549', 'NDCG@5': '0.0377', 'HR@10': '0.0803', 'NDCG@10': '0.0459', 'HR@20': '0.1142', 'NDCG@20': '0.0544'}
2025-03-02 23:16:22,921 - Validation score increased.  Saving model ...
2025-03-02 23:16:49,623 - {'epoch': 5, 'rec_loss': '7.7739'}
2025-03-02 23:16:57,231 - {'Epoch': 5, 'HR@5': '0.0608', 'NDCG@5': '0.0418', 'HR@10': '0.0894', 'NDCG@10': '0.0510', 'HR@20': '0.1248', 'NDCG@20': '0.0599'}
2025-03-02 23:16:57,232 - Validation score increased.  Saving model ...
2025-03-02 23:17:22,673 - {'epoch': 6, 'rec_loss': '7.6901'}
2025-03-02 23:17:30,141 - {'Epoch': 6, 'HR@5': '0.0651', 'NDCG@5': '0.0449', 'HR@10': '0.0935', 'NDCG@10': '0.0541', 'HR@20': '0.1293', 'NDCG@20': '0.0631'}
2025-03-02 23:17:30,147 - Validation score increased.  Saving model ...
2025-03-02 23:17:55,801 - {'epoch': 7, 'rec_loss': '7.6190'}
2025-03-02 23:18:04,444 - {'Epoch': 7, 'HR@5': '0.0684', 'NDCG@5': '0.0477', 'HR@10': '0.0975', 'NDCG@10': '0.0571', 'HR@20': '0.1355', 'NDCG@20': '0.0666'}
2025-03-02 23:18:04,446 - Validation score increased.  Saving model ...
2025-03-02 23:18:30,315 - {'epoch': 8, 'rec_loss': '7.5517'}
2025-03-02 23:18:38,419 - {'Epoch': 8, 'HR@5': '0.0720', 'NDCG@5': '0.0501', 'HR@10': '0.1017', 'NDCG@10': '0.0596', 'HR@20': '0.1406', 'NDCG@20': '0.0694'}
2025-03-02 23:18:38,421 - Validation score increased.  Saving model ...
2025-03-02 23:19:03,965 - {'epoch': 9, 'rec_loss': '7.5065'}
2025-03-02 23:19:12,995 - {'Epoch': 9, 'HR@5': '0.0725', 'NDCG@5': '0.0498', 'HR@10': '0.1043', 'NDCG@10': '0.0600', 'HR@20': '0.1437', 'NDCG@20': '0.0699'}
2025-03-02 23:19:12,997 - Validation score increased.  Saving model ...
2025-03-02 23:19:39,514 - {'epoch': 10, 'rec_loss': '7.4576'}
2025-03-02 23:19:47,410 - {'Epoch': 10, 'HR@5': '0.0762', 'NDCG@5': '0.0528', 'HR@10': '0.1063', 'NDCG@10': '0.0625', 'HR@20': '0.1468', 'NDCG@20': '0.0727'}
2025-03-02 23:19:47,411 - Validation score increased.  Saving model ...
2025-03-02 23:20:14,165 - {'epoch': 11, 'rec_loss': '7.4175'}
2025-03-02 23:20:22,677 - {'Epoch': 11, 'HR@5': '0.0776', 'NDCG@5': '0.0538', 'HR@10': '0.1083', 'NDCG@10': '0.0637', 'HR@20': '0.1478', 'NDCG@20': '0.0736'}
2025-03-02 23:20:22,678 - Validation score increased.  Saving model ...
2025-03-02 23:20:50,065 - {'epoch': 12, 'rec_loss': '7.3828'}
2025-03-02 23:20:58,055 - {'Epoch': 12, 'HR@5': '0.0788', 'NDCG@5': '0.0548', 'HR@10': '0.1100', 'NDCG@10': '0.0649', 'HR@20': '0.1506', 'NDCG@20': '0.0751'}
2025-03-02 23:20:58,057 - Validation score increased.  Saving model ...
2025-03-02 23:21:24,476 - {'epoch': 13, 'rec_loss': '7.3574'}
2025-03-02 23:21:33,381 - {'Epoch': 13, 'HR@5': '0.0783', 'NDCG@5': '0.0547', 'HR@10': '0.1118', 'NDCG@10': '0.0655', 'HR@20': '0.1525', 'NDCG@20': '0.0757'}
2025-03-02 23:21:33,382 - Validation score increased.  Saving model ...
2025-03-02 23:21:59,431 - {'epoch': 14, 'rec_loss': '7.3272'}
2025-03-02 23:22:07,702 - {'Epoch': 14, 'HR@5': '0.0812', 'NDCG@5': '0.0561', 'HR@10': '0.1147', 'NDCG@10': '0.0669', 'HR@20': '0.1559', 'NDCG@20': '0.0772'}
2025-03-02 23:22:07,703 - Validation score increased.  Saving model ...
2025-03-02 23:22:34,124 - {'epoch': 15, 'rec_loss': '7.2981'}
2025-03-02 23:22:42,780 - {'Epoch': 15, 'HR@5': '0.0815', 'NDCG@5': '0.0561', 'HR@10': '0.1142', 'NDCG@10': '0.0666', 'HR@20': '0.1562', 'NDCG@20': '0.0772'}
2025-03-02 23:22:42,781 - EarlyStopping counter: 1 out of 10
2025-03-02 23:23:10,991 - {'epoch': 16, 'rec_loss': '7.2752'}
2025-03-02 23:23:18,813 - {'Epoch': 16, 'HR@5': '0.0812', 'NDCG@5': '0.0567', 'HR@10': '0.1151', 'NDCG@10': '0.0675', 'HR@20': '0.1569', 'NDCG@20': '0.0780'}
2025-03-02 23:23:18,814 - Validation score increased.  Saving model ...
2025-03-02 23:23:45,990 - {'epoch': 17, 'rec_loss': '7.2558'}
2025-03-02 23:23:55,298 - {'Epoch': 17, 'HR@5': '0.0820', 'NDCG@5': '0.0571', 'HR@10': '0.1152', 'NDCG@10': '0.0677', 'HR@20': '0.1575', 'NDCG@20': '0.0784'}
2025-03-02 23:23:55,300 - Validation score increased.  Saving model ...
2025-03-02 23:24:23,040 - {'epoch': 18, 'rec_loss': '7.2351'}
2025-03-02 23:24:32,014 - {'Epoch': 18, 'HR@5': '0.0823', 'NDCG@5': '0.0582', 'HR@10': '0.1142', 'NDCG@10': '0.0685', 'HR@20': '0.1593', 'NDCG@20': '0.0798'}
2025-03-02 23:24:32,016 - Validation score increased.  Saving model ...
2025-03-02 23:25:01,992 - {'epoch': 19, 'rec_loss': '7.2141'}
2025-03-02 23:25:12,121 - {'Epoch': 19, 'HR@5': '0.0837', 'NDCG@5': '0.0593', 'HR@10': '0.1156', 'NDCG@10': '0.0696', 'HR@20': '0.1582', 'NDCG@20': '0.0803'}
2025-03-02 23:25:12,128 - Validation score increased.  Saving model ...
2025-03-02 23:25:42,800 - {'epoch': 20, 'rec_loss': '7.1964'}
2025-03-02 23:25:52,227 - {'Epoch': 20, 'HR@5': '0.0837', 'NDCG@5': '0.0587', 'HR@10': '0.1167', 'NDCG@10': '0.0693', 'HR@20': '0.1606', 'NDCG@20': '0.0804'}
2025-03-02 23:25:52,229 - Validation score increased.  Saving model ...
2025-03-02 23:26:21,729 - {'epoch': 21, 'rec_loss': '7.1815'}
2025-03-02 23:26:30,434 - {'Epoch': 21, 'HR@5': '0.0849', 'NDCG@5': '0.0598', 'HR@10': '0.1176', 'NDCG@10': '0.0704', 'HR@20': '0.1619', 'NDCG@20': '0.0815'}
2025-03-02 23:26:30,436 - Validation score increased.  Saving model ...
2025-03-02 23:26:57,472 - {'epoch': 22, 'rec_loss': '7.1702'}
2025-03-02 23:27:05,639 - {'Epoch': 22, 'HR@5': '0.0854', 'NDCG@5': '0.0599', 'HR@10': '0.1182', 'NDCG@10': '0.0705', 'HR@20': '0.1600', 'NDCG@20': '0.0810'}
2025-03-02 23:27:05,640 - EarlyStopping counter: 1 out of 10
2025-03-02 23:27:32,693 - {'epoch': 23, 'rec_loss': '7.1575'}
2025-03-02 23:27:41,442 - {'Epoch': 23, 'HR@5': '0.0855', 'NDCG@5': '0.0595', 'HR@10': '0.1167', 'NDCG@10': '0.0696', 'HR@20': '0.1625', 'NDCG@20': '0.0811'}
2025-03-02 23:27:41,443 - EarlyStopping counter: 2 out of 10
2025-03-02 23:28:06,784 - {'epoch': 24, 'rec_loss': '7.1444'}
2025-03-02 23:28:15,176 - {'Epoch': 24, 'HR@5': '0.0846', 'NDCG@5': '0.0596', 'HR@10': '0.1177', 'NDCG@10': '0.0702', 'HR@20': '0.1617', 'NDCG@20': '0.0813'}
2025-03-02 23:28:15,178 - EarlyStopping counter: 3 out of 10
2025-03-02 23:28:40,945 - {'epoch': 25, 'rec_loss': '7.1305'}
2025-03-02 23:28:48,436 - {'Epoch': 25, 'HR@5': '0.0847', 'NDCG@5': '0.0594', 'HR@10': '0.1179', 'NDCG@10': '0.0701', 'HR@20': '0.1620', 'NDCG@20': '0.0812'}
2025-03-02 23:28:48,437 - EarlyStopping counter: 4 out of 10
2025-03-02 23:29:16,039 - {'epoch': 26, 'rec_loss': '7.1218'}
2025-03-02 23:29:23,863 - {'Epoch': 26, 'HR@5': '0.0853', 'NDCG@5': '0.0598', 'HR@10': '0.1176', 'NDCG@10': '0.0702', 'HR@20': '0.1625', 'NDCG@20': '0.0815'}
2025-03-02 23:29:23,865 - Validation score increased.  Saving model ...
2025-03-02 23:29:50,090 - {'epoch': 27, 'rec_loss': '7.1066'}
2025-03-02 23:29:57,992 - {'Epoch': 27, 'HR@5': '0.0855', 'NDCG@5': '0.0608', 'HR@10': '0.1177', 'NDCG@10': '0.0713', 'HR@20': '0.1614', 'NDCG@20': '0.0823'}
2025-03-02 23:29:57,993 - Validation score increased.  Saving model ...
2025-03-02 23:30:25,575 - {'epoch': 28, 'rec_loss': '7.1040'}
2025-03-02 23:30:33,019 - {'Epoch': 28, 'HR@5': '0.0842', 'NDCG@5': '0.0588', 'HR@10': '0.1176', 'NDCG@10': '0.0695', 'HR@20': '0.1616', 'NDCG@20': '0.0806'}
2025-03-02 23:30:33,020 - EarlyStopping counter: 1 out of 10
2025-03-02 23:31:00,261 - {'epoch': 29, 'rec_loss': '7.0917'}
2025-03-02 23:31:08,143 - {'Epoch': 29, 'HR@5': '0.0848', 'NDCG@5': '0.0592', 'HR@10': '0.1194', 'NDCG@10': '0.0703', 'HR@20': '0.1629', 'NDCG@20': '0.0812'}
2025-03-02 23:31:08,145 - EarlyStopping counter: 2 out of 10
2025-03-02 23:31:35,864 - {'epoch': 30, 'rec_loss': '7.0906'}
2025-03-02 23:31:43,650 - {'Epoch': 30, 'HR@5': '0.0857', 'NDCG@5': '0.0600', 'HR@10': '0.1203', 'NDCG@10': '0.0712', 'HR@20': '0.1646', 'NDCG@20': '0.0823'}
2025-03-02 23:31:43,651 - Validation score increased.  Saving model ...
2025-03-02 23:32:10,989 - {'epoch': 31, 'rec_loss': '7.0741'}
2025-03-02 23:32:18,599 - {'Epoch': 31, 'HR@5': '0.0867', 'NDCG@5': '0.0609', 'HR@10': '0.1195', 'NDCG@10': '0.0715', 'HR@20': '0.1647', 'NDCG@20': '0.0829'}
2025-03-02 23:32:18,601 - Validation score increased.  Saving model ...
2025-03-02 23:32:45,629 - {'epoch': 32, 'rec_loss': '7.0725'}
2025-03-02 23:32:53,790 - {'Epoch': 32, 'HR@5': '0.0861', 'NDCG@5': '0.0607', 'HR@10': '0.1199', 'NDCG@10': '0.0716', 'HR@20': '0.1622', 'NDCG@20': '0.0823'}
2025-03-02 23:32:53,792 - EarlyStopping counter: 1 out of 10
2025-03-02 23:33:21,169 - {'epoch': 33, 'rec_loss': '7.0612'}
2025-03-02 23:33:28,877 - {'Epoch': 33, 'HR@5': '0.0871', 'NDCG@5': '0.0612', 'HR@10': '0.1206', 'NDCG@10': '0.0720', 'HR@20': '0.1646', 'NDCG@20': '0.0831'}
2025-03-02 23:33:28,878 - Validation score increased.  Saving model ...
2025-03-02 23:33:56,004 - {'epoch': 34, 'rec_loss': '7.0478'}
2025-03-02 23:34:03,682 - {'Epoch': 34, 'HR@5': '0.0865', 'NDCG@5': '0.0608', 'HR@10': '0.1203', 'NDCG@10': '0.0716', 'HR@20': '0.1640', 'NDCG@20': '0.0826'}
2025-03-02 23:34:03,683 - EarlyStopping counter: 1 out of 10
2025-03-02 23:34:31,492 - {'epoch': 35, 'rec_loss': '7.0444'}
2025-03-02 23:34:39,391 - {'Epoch': 35, 'HR@5': '0.0848', 'NDCG@5': '0.0599', 'HR@10': '0.1189', 'NDCG@10': '0.0709', 'HR@20': '0.1655', 'NDCG@20': '0.0826'}
2025-03-02 23:34:39,392 - EarlyStopping counter: 2 out of 10
2025-03-02 23:35:06,747 - {'epoch': 36, 'rec_loss': '7.0424'}
2025-03-02 23:35:14,604 - {'Epoch': 36, 'HR@5': '0.0871', 'NDCG@5': '0.0610', 'HR@10': '0.1198', 'NDCG@10': '0.0715', 'HR@20': '0.1650', 'NDCG@20': '0.0829'}
2025-03-02 23:35:14,605 - EarlyStopping counter: 3 out of 10
2025-03-02 23:35:41,596 - {'epoch': 37, 'rec_loss': '7.0284'}
2025-03-02 23:35:49,391 - {'Epoch': 37, 'HR@5': '0.0867', 'NDCG@5': '0.0609', 'HR@10': '0.1202', 'NDCG@10': '0.0717', 'HR@20': '0.1653', 'NDCG@20': '0.0830'}
2025-03-02 23:35:49,392 - EarlyStopping counter: 4 out of 10
2025-03-02 23:36:17,493 - {'epoch': 38, 'rec_loss': '7.0255'}
2025-03-02 23:36:25,058 - {'Epoch': 38, 'HR@5': '0.0863', 'NDCG@5': '0.0607', 'HR@10': '0.1211', 'NDCG@10': '0.0719', 'HR@20': '0.1643', 'NDCG@20': '0.0827'}
2025-03-02 23:36:25,059 - EarlyStopping counter: 5 out of 10
2025-03-02 23:36:52,149 - {'epoch': 39, 'rec_loss': '7.0147'}
2025-03-02 23:36:59,858 - {'Epoch': 39, 'HR@5': '0.0849', 'NDCG@5': '0.0599', 'HR@10': '0.1192', 'NDCG@10': '0.0709', 'HR@20': '0.1631', 'NDCG@20': '0.0820'}
2025-03-02 23:36:59,859 - EarlyStopping counter: 6 out of 10
2025-03-02 23:37:27,770 - {'epoch': 40, 'rec_loss': '7.0149'}
2025-03-02 23:37:35,605 - {'Epoch': 40, 'HR@5': '0.0853', 'NDCG@5': '0.0606', 'HR@10': '0.1209', 'NDCG@10': '0.0721', 'HR@20': '0.1644', 'NDCG@20': '0.0830'}
2025-03-02 23:37:35,606 - EarlyStopping counter: 7 out of 10
2025-03-02 23:38:02,633 - {'epoch': 41, 'rec_loss': '7.0090'}
2025-03-02 23:38:10,457 - {'Epoch': 41, 'HR@5': '0.0879', 'NDCG@5': '0.0620', 'HR@10': '0.1217', 'NDCG@10': '0.0729', 'HR@20': '0.1643', 'NDCG@20': '0.0837'}
2025-03-02 23:38:10,458 - Validation score increased.  Saving model ...
2025-03-02 23:38:38,084 - {'epoch': 42, 'rec_loss': '7.0007'}
2025-03-02 23:38:45,859 - {'Epoch': 42, 'HR@5': '0.0862', 'NDCG@5': '0.0613', 'HR@10': '0.1220', 'NDCG@10': '0.0729', 'HR@20': '0.1651', 'NDCG@20': '0.0837'}
2025-03-02 23:38:45,861 - Validation score increased.  Saving model ...
2025-03-02 23:39:13,376 - {'epoch': 43, 'rec_loss': '6.9964'}
2025-03-02 23:39:21,601 - {'Epoch': 43, 'HR@5': '0.0866', 'NDCG@5': '0.0604', 'HR@10': '0.1204', 'NDCG@10': '0.0713', 'HR@20': '0.1647', 'NDCG@20': '0.0825'}
2025-03-02 23:39:21,602 - EarlyStopping counter: 1 out of 10
2025-03-02 23:39:49,295 - {'epoch': 44, 'rec_loss': '6.9921'}
2025-03-02 23:39:57,294 - {'Epoch': 44, 'HR@5': '0.0866', 'NDCG@5': '0.0610', 'HR@10': '0.1199', 'NDCG@10': '0.0717', 'HR@20': '0.1628', 'NDCG@20': '0.0825'}
2025-03-02 23:39:57,295 - EarlyStopping counter: 2 out of 10
2025-03-02 23:40:25,097 - {'epoch': 45, 'rec_loss': '6.9881'}
2025-03-02 23:40:32,936 - {'Epoch': 45, 'HR@5': '0.0876', 'NDCG@5': '0.0616', 'HR@10': '0.1200', 'NDCG@10': '0.0720', 'HR@20': '0.1661', 'NDCG@20': '0.0836'}
2025-03-02 23:40:32,937 - EarlyStopping counter: 3 out of 10
2025-03-02 23:41:00,241 - {'epoch': 46, 'rec_loss': '6.9732'}
2025-03-02 23:41:08,088 - {'Epoch': 46, 'HR@5': '0.0873', 'NDCG@5': '0.0618', 'HR@10': '0.1216', 'NDCG@10': '0.0728', 'HR@20': '0.1650', 'NDCG@20': '0.0837'}
2025-03-02 23:41:08,090 - Validation score increased.  Saving model ...
2025-03-02 23:41:35,451 - {'epoch': 47, 'rec_loss': '6.9691'}
2025-03-02 23:41:43,720 - {'Epoch': 47, 'HR@5': '0.0880', 'NDCG@5': '0.0617', 'HR@10': '0.1216', 'NDCG@10': '0.0724', 'HR@20': '0.1656', 'NDCG@20': '0.0835'}
2025-03-02 23:41:43,722 - EarlyStopping counter: 1 out of 10
2025-03-02 23:42:11,098 - {'epoch': 48, 'rec_loss': '6.9719'}
2025-03-02 23:42:19,043 - {'Epoch': 48, 'HR@5': '0.0884', 'NDCG@5': '0.0624', 'HR@10': '0.1227', 'NDCG@10': '0.0734', 'HR@20': '0.1651', 'NDCG@20': '0.0841'}
2025-03-02 23:42:19,044 - Validation score increased.  Saving model ...
2025-03-02 23:42:46,644 - {'epoch': 49, 'rec_loss': '6.9681'}
2025-03-02 23:42:54,198 - {'Epoch': 49, 'HR@5': '0.0873', 'NDCG@5': '0.0613', 'HR@10': '0.1220', 'NDCG@10': '0.0725', 'HR@20': '0.1655', 'NDCG@20': '0.0834'}
2025-03-02 23:42:54,199 - EarlyStopping counter: 1 out of 10
2025-03-02 23:43:21,437 - {'epoch': 50, 'rec_loss': '6.9639'}
2025-03-02 23:43:29,293 - {'Epoch': 50, 'HR@5': '0.0870', 'NDCG@5': '0.0613', 'HR@10': '0.1208', 'NDCG@10': '0.0722', 'HR@20': '0.1672', 'NDCG@20': '0.0839'}
2025-03-02 23:43:29,294 - EarlyStopping counter: 2 out of 10
2025-03-02 23:43:55,701 - {'epoch': 51, 'rec_loss': '6.9630'}
2025-03-02 23:44:04,105 - {'Epoch': 51, 'HR@5': '0.0868', 'NDCG@5': '0.0603', 'HR@10': '0.1213', 'NDCG@10': '0.0715', 'HR@20': '0.1662', 'NDCG@20': '0.0827'}
2025-03-02 23:44:04,107 - EarlyStopping counter: 3 out of 10
2025-03-02 23:44:30,770 - {'epoch': 52, 'rec_loss': '6.9488'}
2025-03-02 23:44:38,841 - {'Epoch': 52, 'HR@5': '0.0868', 'NDCG@5': '0.0609', 'HR@10': '0.1207', 'NDCG@10': '0.0719', 'HR@20': '0.1669', 'NDCG@20': '0.0835'}
2025-03-02 23:44:38,842 - EarlyStopping counter: 4 out of 10
2025-03-02 23:45:06,489 - {'epoch': 53, 'rec_loss': '6.9564'}
2025-03-02 23:45:14,394 - {'Epoch': 53, 'HR@5': '0.0869', 'NDCG@5': '0.0613', 'HR@10': '0.1210', 'NDCG@10': '0.0723', 'HR@20': '0.1653', 'NDCG@20': '0.0835'}
2025-03-02 23:45:14,395 - EarlyStopping counter: 5 out of 10
2025-03-02 23:45:42,536 - {'epoch': 54, 'rec_loss': '6.9471'}
2025-03-02 23:45:50,233 - {'Epoch': 54, 'HR@5': '0.0882', 'NDCG@5': '0.0616', 'HR@10': '0.1211', 'NDCG@10': '0.0722', 'HR@20': '0.1658', 'NDCG@20': '0.0834'}
2025-03-02 23:45:50,234 - EarlyStopping counter: 6 out of 10
2025-03-02 23:46:18,150 - {'epoch': 55, 'rec_loss': '6.9363'}
2025-03-02 23:46:25,929 - {'Epoch': 55, 'HR@5': '0.0864', 'NDCG@5': '0.0614', 'HR@10': '0.1219', 'NDCG@10': '0.0728', 'HR@20': '0.1663', 'NDCG@20': '0.0840'}
2025-03-02 23:46:25,931 - EarlyStopping counter: 7 out of 10
2025-03-02 23:46:54,308 - {'epoch': 56, 'rec_loss': '6.9410'}
2025-03-02 23:47:02,246 - {'Epoch': 56, 'HR@5': '0.0880', 'NDCG@5': '0.0622', 'HR@10': '0.1210', 'NDCG@10': '0.0728', 'HR@20': '0.1665', 'NDCG@20': '0.0843'}
2025-03-02 23:47:02,247 - Validation score increased.  Saving model ...
2025-03-02 23:47:29,276 - {'epoch': 57, 'rec_loss': '6.9445'}
2025-03-02 23:47:37,066 - {'Epoch': 57, 'HR@5': '0.0872', 'NDCG@5': '0.0617', 'HR@10': '0.1220', 'NDCG@10': '0.0729', 'HR@20': '0.1651', 'NDCG@20': '0.0837'}
2025-03-02 23:47:37,068 - EarlyStopping counter: 1 out of 10
2025-03-02 23:48:04,580 - {'epoch': 58, 'rec_loss': '6.9362'}
2025-03-02 23:48:12,629 - {'Epoch': 58, 'HR@5': '0.0872', 'NDCG@5': '0.0615', 'HR@10': '0.1212', 'NDCG@10': '0.0724', 'HR@20': '0.1664', 'NDCG@20': '0.0838'}
2025-03-02 23:48:12,630 - EarlyStopping counter: 2 out of 10
2025-03-02 23:48:40,321 - {'epoch': 59, 'rec_loss': '6.9237'}
2025-03-02 23:48:48,269 - {'Epoch': 59, 'HR@5': '0.0880', 'NDCG@5': '0.0618', 'HR@10': '0.1214', 'NDCG@10': '0.0725', 'HR@20': '0.1676', 'NDCG@20': '0.0841'}
2025-03-02 23:48:48,270 - EarlyStopping counter: 3 out of 10
2025-03-02 23:49:15,662 - {'epoch': 60, 'rec_loss': '6.9215'}
2025-03-02 23:49:23,489 - {'Epoch': 60, 'HR@5': '0.0880', 'NDCG@5': '0.0627', 'HR@10': '0.1216', 'NDCG@10': '0.0735', 'HR@20': '0.1677', 'NDCG@20': '0.0851'}
2025-03-02 23:49:23,490 - Validation score increased.  Saving model ...
2025-03-02 23:49:51,429 - {'epoch': 61, 'rec_loss': '6.9193'}
2025-03-02 23:49:59,323 - {'Epoch': 61, 'HR@5': '0.0880', 'NDCG@5': '0.0626', 'HR@10': '0.1223', 'NDCG@10': '0.0736', 'HR@20': '0.1681', 'NDCG@20': '0.0852'}
2025-03-02 23:49:59,324 - Validation score increased.  Saving model ...
2025-03-02 23:50:27,025 - {'epoch': 62, 'rec_loss': '6.9240'}
2025-03-02 23:50:35,094 - {'Epoch': 62, 'HR@5': '0.0885', 'NDCG@5': '0.0633', 'HR@10': '0.1211', 'NDCG@10': '0.0738', 'HR@20': '0.1663', 'NDCG@20': '0.0851'}
2025-03-02 23:50:35,095 - EarlyStopping counter: 1 out of 10
2025-03-02 23:51:04,078 - {'epoch': 63, 'rec_loss': '6.9102'}
2025-03-02 23:51:11,806 - {'Epoch': 63, 'HR@5': '0.0879', 'NDCG@5': '0.0622', 'HR@10': '0.1221', 'NDCG@10': '0.0732', 'HR@20': '0.1664', 'NDCG@20': '0.0844'}
2025-03-02 23:51:11,807 - EarlyStopping counter: 2 out of 10
2025-03-02 23:51:38,722 - {'epoch': 64, 'rec_loss': '6.9073'}
2025-03-02 23:51:46,591 - {'Epoch': 64, 'HR@5': '0.0887', 'NDCG@5': '0.0630', 'HR@10': '0.1210', 'NDCG@10': '0.0734', 'HR@20': '0.1654', 'NDCG@20': '0.0845'}
2025-03-02 23:51:46,592 - EarlyStopping counter: 3 out of 10
2025-03-02 23:52:14,653 - {'epoch': 65, 'rec_loss': '6.9125'}
2025-03-02 23:52:22,332 - {'Epoch': 65, 'HR@5': '0.0881', 'NDCG@5': '0.0619', 'HR@10': '0.1208', 'NDCG@10': '0.0724', 'HR@20': '0.1655', 'NDCG@20': '0.0836'}
2025-03-02 23:52:22,334 - EarlyStopping counter: 4 out of 10
2025-03-02 23:52:50,101 - {'epoch': 66, 'rec_loss': '6.9045'}
2025-03-02 23:52:57,866 - {'Epoch': 66, 'HR@5': '0.0894', 'NDCG@5': '0.0626', 'HR@10': '0.1211', 'NDCG@10': '0.0728', 'HR@20': '0.1658', 'NDCG@20': '0.0840'}
2025-03-02 23:52:57,868 - EarlyStopping counter: 5 out of 10
2025-03-02 23:53:25,896 - {'epoch': 67, 'rec_loss': '6.9054'}
2025-03-02 23:53:33,726 - {'Epoch': 67, 'HR@5': '0.0873', 'NDCG@5': '0.0615', 'HR@10': '0.1219', 'NDCG@10': '0.0727', 'HR@20': '0.1658', 'NDCG@20': '0.0837'}
2025-03-02 23:53:33,727 - EarlyStopping counter: 6 out of 10
2025-03-02 23:54:01,492 - {'epoch': 68, 'rec_loss': '6.9064'}
2025-03-02 23:54:09,334 - {'Epoch': 68, 'HR@5': '0.0883', 'NDCG@5': '0.0625', 'HR@10': '0.1227', 'NDCG@10': '0.0735', 'HR@20': '0.1670', 'NDCG@20': '0.0847'}
2025-03-02 23:54:09,335 - EarlyStopping counter: 7 out of 10
2025-03-02 23:54:36,279 - {'epoch': 69, 'rec_loss': '6.8921'}
2025-03-02 23:54:44,280 - {'Epoch': 69, 'HR@5': '0.0891', 'NDCG@5': '0.0628', 'HR@10': '0.1218', 'NDCG@10': '0.0734', 'HR@20': '0.1657', 'NDCG@20': '0.0844'}
2025-03-02 23:54:44,281 - EarlyStopping counter: 8 out of 10
2025-03-02 23:55:14,704 - {'epoch': 70, 'rec_loss': '6.8930'}
2025-03-02 23:55:22,971 - {'Epoch': 70, 'HR@5': '0.0874', 'NDCG@5': '0.0615', 'HR@10': '0.1207', 'NDCG@10': '0.0722', 'HR@20': '0.1657', 'NDCG@20': '0.0836'}
2025-03-02 23:55:22,972 - EarlyStopping counter: 9 out of 10
2025-03-02 23:55:50,709 - {'epoch': 71, 'rec_loss': '6.8953'}
2025-03-02 23:55:58,308 - {'Epoch': 71, 'HR@5': '0.0888', 'NDCG@5': '0.0624', 'HR@10': '0.1218', 'NDCG@10': '0.0730', 'HR@20': '0.1665', 'NDCG@20': '0.0843'}
2025-03-02 23:55:58,309 - EarlyStopping counter: 10 out of 10
2025-03-02 23:55:58,310 - Early stopping
2025-03-02 23:55:58,310 - ---------------Test Score---------------
2025-03-02 23:56:06,042 - {'Epoch': 0, 'HR@5': '0.0707', 'NDCG@5': '0.0503', 'HR@10': '0.0990', 'NDCG@10': '0.0594', 'HR@20': '0.1380', 'NDCG@20': '0.0692'}
2025-03-02 23:56:06,044 - Scale_Beauty
2025-03-02 23:56:06,044 - {'Epoch': 0, 'HR@5': '0.0707', 'NDCG@5': '0.0503', 'HR@10': '0.0990', 'NDCG@10': '0.0594', 'HR@20': '0.1380', 'NDCG@20': '0.0692'}
2025-03-03 00:01:03,984 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 12, 32], start_prob=0.5, end_prob=0.8, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-03 00:01:06,855 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-03 00:01:06,861 - Total Parameters: 929445
2025-03-03 00:01:35,695 - {'epoch': 0, 'rec_loss': '8.9267'}
2025-03-03 00:01:44,025 - {'Epoch': 0, 'HR@5': '0.0124', 'NDCG@5': '0.0077', 'HR@10': '0.0221', 'NDCG@10': '0.0109', 'HR@20': '0.0355', 'NDCG@20': '0.0142'}
2025-03-03 00:01:44,026 - Validation score increased.  Saving model ...
2025-03-03 00:02:11,789 - {'epoch': 1, 'rec_loss': '8.5667'}
2025-03-03 00:02:19,922 - {'Epoch': 1, 'HR@5': '0.0242', 'NDCG@5': '0.0157', 'HR@10': '0.0361', 'NDCG@10': '0.0195', 'HR@20': '0.0524', 'NDCG@20': '0.0236'}
2025-03-03 00:02:19,923 - Validation score increased.  Saving model ...
2025-03-03 00:02:47,687 - {'epoch': 2, 'rec_loss': '8.3591'}
2025-03-03 00:02:56,218 - {'Epoch': 2, 'HR@5': '0.0324', 'NDCG@5': '0.0207', 'HR@10': '0.0508', 'NDCG@10': '0.0267', 'HR@20': '0.0734', 'NDCG@20': '0.0323'}
2025-03-03 00:02:56,219 - Validation score increased.  Saving model ...
2025-03-03 00:03:23,436 - {'epoch': 3, 'rec_loss': '8.1848'}
2025-03-03 00:03:31,795 - {'Epoch': 3, 'HR@5': '0.0373', 'NDCG@5': '0.0247', 'HR@10': '0.0573', 'NDCG@10': '0.0312', 'HR@20': '0.0876', 'NDCG@20': '0.0388'}
2025-03-03 00:03:31,796 - Validation score increased.  Saving model ...
2025-03-03 00:04:01,287 - {'epoch': 4, 'rec_loss': '8.0441'}
2025-03-03 00:04:09,121 - {'Epoch': 4, 'HR@5': '0.0458', 'NDCG@5': '0.0319', 'HR@10': '0.0672', 'NDCG@10': '0.0387', 'HR@20': '0.0995', 'NDCG@20': '0.0469'}
2025-03-03 00:04:09,122 - Validation score increased.  Saving model ...
2025-03-03 00:04:36,951 - {'epoch': 5, 'rec_loss': '7.9345'}
2025-03-03 00:04:44,565 - {'Epoch': 5, 'HR@5': '0.0516', 'NDCG@5': '0.0344', 'HR@10': '0.0770', 'NDCG@10': '0.0426', 'HR@20': '0.1121', 'NDCG@20': '0.0514'}
2025-03-03 00:04:44,566 - Validation score increased.  Saving model ...
2025-03-03 00:05:12,526 - {'epoch': 6, 'rec_loss': '7.8526'}
2025-03-03 00:05:20,652 - {'Epoch': 6, 'HR@5': '0.0554', 'NDCG@5': '0.0377', 'HR@10': '0.0807', 'NDCG@10': '0.0458', 'HR@20': '0.1174', 'NDCG@20': '0.0551'}
2025-03-03 00:05:20,653 - Validation score increased.  Saving model ...
2025-03-03 00:05:48,095 - {'epoch': 7, 'rec_loss': '7.7849'}
2025-03-03 00:05:55,698 - {'Epoch': 7, 'HR@5': '0.0601', 'NDCG@5': '0.0411', 'HR@10': '0.0864', 'NDCG@10': '0.0495', 'HR@20': '0.1233', 'NDCG@20': '0.0588'}
2025-03-03 00:05:55,699 - Validation score increased.  Saving model ...
2025-03-03 00:06:23,879 - {'epoch': 8, 'rec_loss': '7.7248'}
2025-03-03 00:06:31,654 - {'Epoch': 8, 'HR@5': '0.0635', 'NDCG@5': '0.0434', 'HR@10': '0.0933', 'NDCG@10': '0.0530', 'HR@20': '0.1289', 'NDCG@20': '0.0620'}
2025-03-03 00:06:31,655 - Validation score increased.  Saving model ...
2025-03-03 00:06:59,021 - {'epoch': 9, 'rec_loss': '7.6837'}
2025-03-03 00:07:06,933 - {'Epoch': 9, 'HR@5': '0.0657', 'NDCG@5': '0.0444', 'HR@10': '0.0948', 'NDCG@10': '0.0537', 'HR@20': '0.1320', 'NDCG@20': '0.0631'}
2025-03-03 00:07:06,935 - Validation score increased.  Saving model ...
2025-03-03 00:07:35,015 - {'epoch': 10, 'rec_loss': '7.6356'}
2025-03-03 00:07:42,900 - {'Epoch': 10, 'HR@5': '0.0691', 'NDCG@5': '0.0472', 'HR@10': '0.0973', 'NDCG@10': '0.0563', 'HR@20': '0.1356', 'NDCG@20': '0.0659'}
2025-03-03 00:07:42,902 - Validation score increased.  Saving model ...
2025-03-03 00:08:09,988 - {'epoch': 11, 'rec_loss': '7.6017'}
2025-03-03 00:08:17,711 - {'Epoch': 11, 'HR@5': '0.0694', 'NDCG@5': '0.0478', 'HR@10': '0.0986', 'NDCG@10': '0.0572', 'HR@20': '0.1363', 'NDCG@20': '0.0667'}
2025-03-03 00:08:17,712 - Validation score increased.  Saving model ...
2025-03-03 00:08:45,813 - {'epoch': 12, 'rec_loss': '7.5671'}
2025-03-03 00:08:54,012 - {'Epoch': 12, 'HR@5': '0.0719', 'NDCG@5': '0.0493', 'HR@10': '0.1020', 'NDCG@10': '0.0591', 'HR@20': '0.1411', 'NDCG@20': '0.0689'}
2025-03-03 00:08:54,014 - Validation score increased.  Saving model ...
2025-03-03 00:09:25,700 - {'epoch': 13, 'rec_loss': '7.5381'}
2025-03-03 00:09:33,432 - {'Epoch': 13, 'HR@5': '0.0717', 'NDCG@5': '0.0493', 'HR@10': '0.1044', 'NDCG@10': '0.0599', 'HR@20': '0.1419', 'NDCG@20': '0.0694'}
2025-03-03 00:09:33,433 - Validation score increased.  Saving model ...
2025-03-03 00:10:01,103 - {'epoch': 14, 'rec_loss': '7.5180'}
2025-03-03 00:10:08,855 - {'Epoch': 14, 'HR@5': '0.0744', 'NDCG@5': '0.0514', 'HR@10': '0.1059', 'NDCG@10': '0.0616', 'HR@20': '0.1447', 'NDCG@20': '0.0713'}
2025-03-03 00:10:08,856 - Validation score increased.  Saving model ...
2025-03-03 00:10:38,184 - {'epoch': 15, 'rec_loss': '7.4883'}
2025-03-03 00:10:46,602 - {'Epoch': 15, 'HR@5': '0.0738', 'NDCG@5': '0.0508', 'HR@10': '0.1048', 'NDCG@10': '0.0608', 'HR@20': '0.1456', 'NDCG@20': '0.0711'}
2025-03-03 00:10:46,603 - EarlyStopping counter: 1 out of 10
2025-03-03 00:11:14,086 - {'epoch': 16, 'rec_loss': '7.4679'}
2025-03-03 00:11:21,803 - {'Epoch': 16, 'HR@5': '0.0748', 'NDCG@5': '0.0521', 'HR@10': '0.1068', 'NDCG@10': '0.0624', 'HR@20': '0.1475', 'NDCG@20': '0.0727'}
2025-03-03 00:11:21,804 - Validation score increased.  Saving model ...
2025-03-03 00:11:49,952 - {'epoch': 17, 'rec_loss': '7.4455'}
2025-03-03 00:11:57,726 - {'Epoch': 17, 'HR@5': '0.0753', 'NDCG@5': '0.0521', 'HR@10': '0.1067', 'NDCG@10': '0.0622', 'HR@20': '0.1475', 'NDCG@20': '0.0725'}
2025-03-03 00:11:57,727 - EarlyStopping counter: 1 out of 10
2025-03-03 00:12:25,776 - {'epoch': 18, 'rec_loss': '7.4327'}
2025-03-03 00:12:33,780 - {'Epoch': 18, 'HR@5': '0.0762', 'NDCG@5': '0.0532', 'HR@10': '0.1089', 'NDCG@10': '0.0637', 'HR@20': '0.1500', 'NDCG@20': '0.0740'}
2025-03-03 00:12:33,781 - Validation score increased.  Saving model ...
2025-03-03 00:13:01,318 - {'epoch': 19, 'rec_loss': '7.4066'}
2025-03-03 00:13:09,104 - {'Epoch': 19, 'HR@5': '0.0771', 'NDCG@5': '0.0542', 'HR@10': '0.1088', 'NDCG@10': '0.0644', 'HR@20': '0.1510', 'NDCG@20': '0.0750'}
2025-03-03 00:13:09,105 - Validation score increased.  Saving model ...
2025-03-03 00:13:37,776 - {'epoch': 20, 'rec_loss': '7.3882'}
2025-03-03 00:13:45,678 - {'Epoch': 20, 'HR@5': '0.0783', 'NDCG@5': '0.0545', 'HR@10': '0.1107', 'NDCG@10': '0.0649', 'HR@20': '0.1505', 'NDCG@20': '0.0749'}
2025-03-03 00:13:45,679 - EarlyStopping counter: 1 out of 10
2025-03-03 00:14:13,308 - {'epoch': 21, 'rec_loss': '7.3722'}
2025-03-03 00:14:21,729 - {'Epoch': 21, 'HR@5': '0.0783', 'NDCG@5': '0.0550', 'HR@10': '0.1124', 'NDCG@10': '0.0660', 'HR@20': '0.1552', 'NDCG@20': '0.0768'}
2025-03-03 00:14:21,730 - Validation score increased.  Saving model ...
2025-03-03 00:14:49,368 - {'epoch': 22, 'rec_loss': '7.3612'}
2025-03-03 00:14:57,558 - {'Epoch': 22, 'HR@5': '0.0797', 'NDCG@5': '0.0556', 'HR@10': '0.1119', 'NDCG@10': '0.0660', 'HR@20': '0.1542', 'NDCG@20': '0.0766'}
2025-03-03 00:14:57,559 - EarlyStopping counter: 1 out of 10
2025-03-03 00:15:25,680 - {'epoch': 23, 'rec_loss': '7.3488'}
2025-03-03 00:15:34,699 - {'Epoch': 23, 'HR@5': '0.0806', 'NDCG@5': '0.0561', 'HR@10': '0.1120', 'NDCG@10': '0.0662', 'HR@20': '0.1559', 'NDCG@20': '0.0772'}
2025-03-03 00:15:34,701 - Validation score increased.  Saving model ...
2025-03-03 00:16:02,384 - {'epoch': 24, 'rec_loss': '7.3343'}
2025-03-03 00:16:10,588 - {'Epoch': 24, 'HR@5': '0.0795', 'NDCG@5': '0.0559', 'HR@10': '0.1119', 'NDCG@10': '0.0663', 'HR@20': '0.1543', 'NDCG@20': '0.0769'}
2025-03-03 00:16:10,589 - EarlyStopping counter: 1 out of 10
2025-03-03 00:16:37,823 - {'epoch': 25, 'rec_loss': '7.3251'}
2025-03-03 00:16:45,835 - {'Epoch': 25, 'HR@5': '0.0798', 'NDCG@5': '0.0558', 'HR@10': '0.1130', 'NDCG@10': '0.0665', 'HR@20': '0.1567', 'NDCG@20': '0.0775'}
2025-03-03 00:16:45,836 - Validation score increased.  Saving model ...
2025-03-03 00:17:13,642 - {'epoch': 26, 'rec_loss': '7.3130'}
2025-03-03 00:17:22,096 - {'Epoch': 26, 'HR@5': '0.0805', 'NDCG@5': '0.0563', 'HR@10': '0.1137', 'NDCG@10': '0.0669', 'HR@20': '0.1568', 'NDCG@20': '0.0778'}
2025-03-03 00:17:22,097 - Validation score increased.  Saving model ...
2025-03-03 00:17:50,059 - {'epoch': 27, 'rec_loss': '7.3012'}
2025-03-03 00:17:58,070 - {'Epoch': 27, 'HR@5': '0.0804', 'NDCG@5': '0.0571', 'HR@10': '0.1146', 'NDCG@10': '0.0681', 'HR@20': '0.1566', 'NDCG@20': '0.0787'}
2025-03-03 00:17:58,075 - Validation score increased.  Saving model ...
2025-03-03 00:18:25,380 - {'epoch': 28, 'rec_loss': '7.2916'}
2025-03-03 00:18:33,319 - {'Epoch': 28, 'HR@5': '0.0812', 'NDCG@5': '0.0565', 'HR@10': '0.1144', 'NDCG@10': '0.0672', 'HR@20': '0.1565', 'NDCG@20': '0.0778'}
2025-03-03 00:18:33,320 - EarlyStopping counter: 1 out of 10
2025-03-03 00:19:01,364 - {'epoch': 29, 'rec_loss': '7.2837'}
2025-03-03 00:19:09,068 - {'Epoch': 29, 'HR@5': '0.0831', 'NDCG@5': '0.0573', 'HR@10': '0.1137', 'NDCG@10': '0.0671', 'HR@20': '0.1576', 'NDCG@20': '0.0782'}
2025-03-03 00:19:09,073 - EarlyStopping counter: 2 out of 10
2025-03-03 00:19:36,874 - {'epoch': 30, 'rec_loss': '7.2827'}
2025-03-03 00:19:44,812 - {'Epoch': 30, 'HR@5': '0.0805', 'NDCG@5': '0.0567', 'HR@10': '0.1148', 'NDCG@10': '0.0678', 'HR@20': '0.1587', 'NDCG@20': '0.0788'}
2025-03-03 00:19:44,813 - Validation score increased.  Saving model ...
2025-03-03 00:20:12,727 - {'epoch': 31, 'rec_loss': '7.2672'}
2025-03-03 00:20:21,173 - {'Epoch': 31, 'HR@5': '0.0819', 'NDCG@5': '0.0578', 'HR@10': '0.1144', 'NDCG@10': '0.0683', 'HR@20': '0.1573', 'NDCG@20': '0.0791'}
2025-03-03 00:20:21,174 - Validation score increased.  Saving model ...
2025-03-03 00:20:49,643 - {'epoch': 32, 'rec_loss': '7.2554'}
2025-03-03 00:20:58,491 - {'Epoch': 32, 'HR@5': '0.0824', 'NDCG@5': '0.0581', 'HR@10': '0.1158', 'NDCG@10': '0.0689', 'HR@20': '0.1594', 'NDCG@20': '0.0798'}
2025-03-03 00:20:58,492 - Validation score increased.  Saving model ...
2025-03-03 00:21:27,394 - {'epoch': 33, 'rec_loss': '7.2533'}
2025-03-03 00:21:36,905 - {'Epoch': 33, 'HR@5': '0.0830', 'NDCG@5': '0.0582', 'HR@10': '0.1163', 'NDCG@10': '0.0689', 'HR@20': '0.1596', 'NDCG@20': '0.0798'}
2025-03-03 00:21:36,906 - EarlyStopping counter: 1 out of 10
2025-03-03 00:22:11,047 - {'epoch': 34, 'rec_loss': '7.2306'}
2025-03-03 00:22:23,048 - {'Epoch': 34, 'HR@5': '0.0824', 'NDCG@5': '0.0581', 'HR@10': '0.1178', 'NDCG@10': '0.0695', 'HR@20': '0.1599', 'NDCG@20': '0.0801'}
2025-03-03 00:22:23,050 - Validation score increased.  Saving model ...
2025-03-03 00:23:03,934 - {'epoch': 35, 'rec_loss': '7.2341'}
2025-03-03 00:23:11,861 - {'Epoch': 35, 'HR@5': '0.0827', 'NDCG@5': '0.0581', 'HR@10': '0.1155', 'NDCG@10': '0.0685', 'HR@20': '0.1597', 'NDCG@20': '0.0797'}
2025-03-03 00:23:11,862 - EarlyStopping counter: 1 out of 10
2025-03-03 00:23:39,344 - {'epoch': 36, 'rec_loss': '7.2363'}
2025-03-03 00:23:47,288 - {'Epoch': 36, 'HR@5': '0.0830', 'NDCG@5': '0.0586', 'HR@10': '0.1157', 'NDCG@10': '0.0691', 'HR@20': '0.1593', 'NDCG@20': '0.0801'}
2025-03-03 00:23:47,289 - Validation score increased.  Saving model ...
2025-03-03 00:24:15,056 - {'epoch': 37, 'rec_loss': '7.2144'}
2025-03-03 00:24:23,035 - {'Epoch': 37, 'HR@5': '0.0842', 'NDCG@5': '0.0582', 'HR@10': '0.1167', 'NDCG@10': '0.0687', 'HR@20': '0.1601', 'NDCG@20': '0.0796'}
2025-03-03 00:24:23,036 - EarlyStopping counter: 1 out of 10
2025-03-03 00:24:49,751 - {'epoch': 38, 'rec_loss': '7.2089'}
2025-03-03 00:24:57,629 - {'Epoch': 38, 'HR@5': '0.0827', 'NDCG@5': '0.0580', 'HR@10': '0.1175', 'NDCG@10': '0.0692', 'HR@20': '0.1599', 'NDCG@20': '0.0799'}
2025-03-03 00:24:57,630 - EarlyStopping counter: 2 out of 10
2025-03-03 00:25:25,743 - {'epoch': 39, 'rec_loss': '7.2056'}
2025-03-03 00:25:34,787 - {'Epoch': 39, 'HR@5': '0.0820', 'NDCG@5': '0.0573', 'HR@10': '0.1159', 'NDCG@10': '0.0682', 'HR@20': '0.1604', 'NDCG@20': '0.0794'}
2025-03-03 00:25:34,788 - EarlyStopping counter: 3 out of 10
2025-03-03 00:26:04,052 - {'epoch': 40, 'rec_loss': '7.2016'}
2025-03-03 00:26:13,009 - {'Epoch': 40, 'HR@5': '0.0842', 'NDCG@5': '0.0590', 'HR@10': '0.1162', 'NDCG@10': '0.0692', 'HR@20': '0.1600', 'NDCG@20': '0.0803'}
2025-03-03 00:26:13,010 - Validation score increased.  Saving model ...
2025-03-03 00:26:48,613 - {'epoch': 41, 'rec_loss': '7.2000'}
2025-03-03 00:27:00,237 - {'Epoch': 41, 'HR@5': '0.0843', 'NDCG@5': '0.0594', 'HR@10': '0.1176', 'NDCG@10': '0.0702', 'HR@20': '0.1601', 'NDCG@20': '0.0809'}
2025-03-03 00:27:00,239 - Validation score increased.  Saving model ...
2025-03-03 00:27:34,986 - {'epoch': 42, 'rec_loss': '7.1849'}
2025-03-03 00:27:43,568 - {'Epoch': 42, 'HR@5': '0.0845', 'NDCG@5': '0.0593', 'HR@10': '0.1168', 'NDCG@10': '0.0697', 'HR@20': '0.1631', 'NDCG@20': '0.0813'}
2025-03-03 00:27:43,574 - Validation score increased.  Saving model ...
2025-03-03 00:28:12,897 - {'epoch': 43, 'rec_loss': '7.1842'}
2025-03-03 00:28:20,979 - {'Epoch': 43, 'HR@5': '0.0838', 'NDCG@5': '0.0586', 'HR@10': '0.1160', 'NDCG@10': '0.0690', 'HR@20': '0.1617', 'NDCG@20': '0.0805'}
2025-03-03 00:28:20,980 - EarlyStopping counter: 1 out of 10
2025-03-03 00:28:52,066 - {'epoch': 44, 'rec_loss': '7.1867'}
2025-03-03 00:29:00,067 - {'Epoch': 44, 'HR@5': '0.0829', 'NDCG@5': '0.0582', 'HR@10': '0.1170', 'NDCG@10': '0.0691', 'HR@20': '0.1594', 'NDCG@20': '0.0798'}
2025-03-03 00:29:00,069 - EarlyStopping counter: 2 out of 10
2025-03-03 00:29:27,949 - {'epoch': 45, 'rec_loss': '7.1731'}
2025-03-03 00:29:35,949 - {'Epoch': 45, 'HR@5': '0.0842', 'NDCG@5': '0.0593', 'HR@10': '0.1181', 'NDCG@10': '0.0703', 'HR@20': '0.1615', 'NDCG@20': '0.0812'}
2025-03-03 00:29:35,950 - EarlyStopping counter: 3 out of 10
2025-03-03 00:30:04,761 - {'epoch': 46, 'rec_loss': '7.1615'}
2025-03-03 00:30:12,874 - {'Epoch': 46, 'HR@5': '0.0850', 'NDCG@5': '0.0595', 'HR@10': '0.1192', 'NDCG@10': '0.0705', 'HR@20': '0.1613', 'NDCG@20': '0.0810'}
2025-03-03 00:30:12,875 - EarlyStopping counter: 4 out of 10
2025-03-03 00:30:40,694 - {'epoch': 47, 'rec_loss': '7.1577'}
2025-03-03 00:30:48,657 - {'Epoch': 47, 'HR@5': '0.0851', 'NDCG@5': '0.0597', 'HR@10': '0.1181', 'NDCG@10': '0.0704', 'HR@20': '0.1617', 'NDCG@20': '0.0813'}
2025-03-03 00:30:48,658 - Validation score increased.  Saving model ...
2025-03-03 00:31:16,826 - {'epoch': 48, 'rec_loss': '7.1643'}
2025-03-03 00:31:24,815 - {'Epoch': 48, 'HR@5': '0.0844', 'NDCG@5': '0.0588', 'HR@10': '0.1180', 'NDCG@10': '0.0697', 'HR@20': '0.1609', 'NDCG@20': '0.0805'}
2025-03-03 00:31:24,816 - EarlyStopping counter: 1 out of 10
2025-03-03 00:31:54,699 - {'epoch': 49, 'rec_loss': '7.1613'}
2025-03-03 00:32:02,508 - {'Epoch': 49, 'HR@5': '0.0846', 'NDCG@5': '0.0593', 'HR@10': '0.1187', 'NDCG@10': '0.0703', 'HR@20': '0.1625', 'NDCG@20': '0.0813'}
2025-03-03 00:32:02,510 - EarlyStopping counter: 2 out of 10
2025-03-03 00:32:31,445 - {'epoch': 50, 'rec_loss': '7.1616'}
2025-03-03 00:32:39,883 - {'Epoch': 50, 'HR@5': '0.0854', 'NDCG@5': '0.0593', 'HR@10': '0.1180', 'NDCG@10': '0.0698', 'HR@20': '0.1619', 'NDCG@20': '0.0808'}
2025-03-03 00:32:39,885 - EarlyStopping counter: 3 out of 10
2025-03-03 00:33:08,287 - {'epoch': 51, 'rec_loss': '7.1500'}
2025-03-03 00:33:16,270 - {'Epoch': 51, 'HR@5': '0.0850', 'NDCG@5': '0.0592', 'HR@10': '0.1165', 'NDCG@10': '0.0694', 'HR@20': '0.1614', 'NDCG@20': '0.0807'}
2025-03-03 00:33:16,271 - EarlyStopping counter: 4 out of 10
2025-03-03 00:33:43,324 - {'epoch': 52, 'rec_loss': '7.1407'}
2025-03-03 00:33:51,166 - {'Epoch': 52, 'HR@5': '0.0835', 'NDCG@5': '0.0588', 'HR@10': '0.1185', 'NDCG@10': '0.0700', 'HR@20': '0.1626', 'NDCG@20': '0.0812'}
2025-03-03 00:33:51,171 - EarlyStopping counter: 5 out of 10
2025-03-03 00:34:20,037 - {'epoch': 53, 'rec_loss': '7.1408'}
2025-03-03 00:34:28,115 - {'Epoch': 53, 'HR@5': '0.0843', 'NDCG@5': '0.0589', 'HR@10': '0.1161', 'NDCG@10': '0.0692', 'HR@20': '0.1623', 'NDCG@20': '0.0808'}
2025-03-03 00:34:28,116 - EarlyStopping counter: 6 out of 10
2025-03-03 00:34:57,006 - {'epoch': 54, 'rec_loss': '7.1403'}
2025-03-03 00:35:04,942 - {'Epoch': 54, 'HR@5': '0.0860', 'NDCG@5': '0.0595', 'HR@10': '0.1186', 'NDCG@10': '0.0700', 'HR@20': '0.1624', 'NDCG@20': '0.0810'}
2025-03-03 00:35:04,943 - EarlyStopping counter: 7 out of 10
2025-03-03 00:35:32,596 - {'epoch': 55, 'rec_loss': '7.1279'}
2025-03-03 00:35:40,561 - {'Epoch': 55, 'HR@5': '0.0839', 'NDCG@5': '0.0591', 'HR@10': '0.1176', 'NDCG@10': '0.0700', 'HR@20': '0.1632', 'NDCG@20': '0.0814'}
2025-03-03 00:35:40,562 - Validation score increased.  Saving model ...
2025-03-03 00:36:09,256 - {'epoch': 56, 'rec_loss': '7.1317'}
2025-03-03 00:36:17,118 - {'Epoch': 56, 'HR@5': '0.0838', 'NDCG@5': '0.0595', 'HR@10': '0.1182', 'NDCG@10': '0.0706', 'HR@20': '0.1625', 'NDCG@20': '0.0817'}
2025-03-03 00:36:17,120 - Validation score increased.  Saving model ...
2025-03-03 00:36:44,909 - {'epoch': 57, 'rec_loss': '7.1324'}
2025-03-03 00:36:53,135 - {'Epoch': 57, 'HR@5': '0.0842', 'NDCG@5': '0.0594', 'HR@10': '0.1180', 'NDCG@10': '0.0703', 'HR@20': '0.1622', 'NDCG@20': '0.0814'}
2025-03-03 00:36:53,136 - EarlyStopping counter: 1 out of 10
2025-03-03 00:37:20,645 - {'epoch': 58, 'rec_loss': '7.1264'}
2025-03-03 00:37:29,061 - {'Epoch': 58, 'HR@5': '0.0834', 'NDCG@5': '0.0588', 'HR@10': '0.1173', 'NDCG@10': '0.0697', 'HR@20': '0.1629', 'NDCG@20': '0.0812'}
2025-03-03 00:37:29,062 - EarlyStopping counter: 2 out of 10
2025-03-03 00:37:56,284 - {'epoch': 59, 'rec_loss': '7.1117'}
2025-03-03 00:38:04,292 - {'Epoch': 59, 'HR@5': '0.0837', 'NDCG@5': '0.0590', 'HR@10': '0.1184', 'NDCG@10': '0.0702', 'HR@20': '0.1635', 'NDCG@20': '0.0815'}
2025-03-03 00:38:04,293 - EarlyStopping counter: 3 out of 10
2025-03-03 00:38:31,993 - {'epoch': 60, 'rec_loss': '7.1140'}
2025-03-03 00:38:40,007 - {'Epoch': 60, 'HR@5': '0.0853', 'NDCG@5': '0.0601', 'HR@10': '0.1186', 'NDCG@10': '0.0708', 'HR@20': '0.1632', 'NDCG@20': '0.0820'}
2025-03-03 00:38:40,009 - Validation score increased.  Saving model ...
2025-03-03 00:39:07,209 - {'epoch': 61, 'rec_loss': '7.1147'}
2025-03-03 00:39:15,201 - {'Epoch': 61, 'HR@5': '0.0855', 'NDCG@5': '0.0603', 'HR@10': '0.1192', 'NDCG@10': '0.0711', 'HR@20': '0.1629', 'NDCG@20': '0.0821'}
2025-03-03 00:39:15,202 - Validation score increased.  Saving model ...
2025-03-03 00:39:42,750 - {'epoch': 62, 'rec_loss': '7.1124'}
2025-03-03 00:39:50,773 - {'Epoch': 62, 'HR@5': '0.0846', 'NDCG@5': '0.0600', 'HR@10': '0.1190', 'NDCG@10': '0.0711', 'HR@20': '0.1632', 'NDCG@20': '0.0822'}
2025-03-03 00:39:50,774 - Validation score increased.  Saving model ...
2025-03-03 00:40:18,531 - {'epoch': 63, 'rec_loss': '7.1069'}
2025-03-03 00:40:26,565 - {'Epoch': 63, 'HR@5': '0.0845', 'NDCG@5': '0.0597', 'HR@10': '0.1178', 'NDCG@10': '0.0704', 'HR@20': '0.1621', 'NDCG@20': '0.0816'}
2025-03-03 00:40:26,566 - EarlyStopping counter: 1 out of 10
2025-03-03 00:40:54,442 - {'epoch': 64, 'rec_loss': '7.1012'}
2025-03-03 00:41:02,440 - {'Epoch': 64, 'HR@5': '0.0850', 'NDCG@5': '0.0599', 'HR@10': '0.1179', 'NDCG@10': '0.0705', 'HR@20': '0.1617', 'NDCG@20': '0.0816'}
2025-03-03 00:41:02,441 - EarlyStopping counter: 2 out of 10
2025-03-03 00:41:30,089 - {'epoch': 65, 'rec_loss': '7.1038'}
2025-03-03 00:41:38,005 - {'Epoch': 65, 'HR@5': '0.0847', 'NDCG@5': '0.0597', 'HR@10': '0.1167', 'NDCG@10': '0.0700', 'HR@20': '0.1620', 'NDCG@20': '0.0814'}
2025-03-03 00:41:38,006 - EarlyStopping counter: 3 out of 10
2025-03-03 00:42:05,798 - {'epoch': 66, 'rec_loss': '7.0940'}
2025-03-03 00:42:13,787 - {'Epoch': 66, 'HR@5': '0.0852', 'NDCG@5': '0.0597', 'HR@10': '0.1173', 'NDCG@10': '0.0700', 'HR@20': '0.1605', 'NDCG@20': '0.0809'}
2025-03-03 00:42:13,789 - EarlyStopping counter: 4 out of 10
2025-03-03 00:42:42,052 - {'epoch': 67, 'rec_loss': '7.0926'}
2025-03-03 00:42:50,185 - {'Epoch': 67, 'HR@5': '0.0851', 'NDCG@5': '0.0598', 'HR@10': '0.1176', 'NDCG@10': '0.0703', 'HR@20': '0.1611', 'NDCG@20': '0.0813'}
2025-03-03 00:42:50,186 - EarlyStopping counter: 5 out of 10
2025-03-03 00:43:17,673 - {'epoch': 68, 'rec_loss': '7.1014'}
2025-03-03 00:43:25,610 - {'Epoch': 68, 'HR@5': '0.0858', 'NDCG@5': '0.0604', 'HR@10': '0.1192', 'NDCG@10': '0.0712', 'HR@20': '0.1638', 'NDCG@20': '0.0824'}
2025-03-03 00:43:25,612 - Validation score increased.  Saving model ...
2025-03-03 00:43:55,231 - {'epoch': 69, 'rec_loss': '7.0886'}
2025-03-03 00:44:03,285 - {'Epoch': 69, 'HR@5': '0.0859', 'NDCG@5': '0.0600', 'HR@10': '0.1189', 'NDCG@10': '0.0706', 'HR@20': '0.1621', 'NDCG@20': '0.0815'}
2025-03-03 00:44:03,287 - EarlyStopping counter: 1 out of 10
2025-03-03 00:44:31,251 - {'epoch': 70, 'rec_loss': '7.0920'}
2025-03-03 00:44:39,743 - {'Epoch': 70, 'HR@5': '0.0854', 'NDCG@5': '0.0598', 'HR@10': '0.1182', 'NDCG@10': '0.0704', 'HR@20': '0.1616', 'NDCG@20': '0.0813'}
2025-03-03 00:44:39,744 - EarlyStopping counter: 2 out of 10
2025-03-03 00:45:09,101 - {'epoch': 71, 'rec_loss': '7.0935'}
2025-03-03 00:45:17,007 - {'Epoch': 71, 'HR@5': '0.0842', 'NDCG@5': '0.0593', 'HR@10': '0.1195', 'NDCG@10': '0.0707', 'HR@20': '0.1635', 'NDCG@20': '0.0818'}
2025-03-03 00:45:17,009 - EarlyStopping counter: 3 out of 10
2025-03-03 00:45:44,516 - {'epoch': 72, 'rec_loss': '7.0838'}
2025-03-03 00:45:52,890 - {'Epoch': 72, 'HR@5': '0.0851', 'NDCG@5': '0.0603', 'HR@10': '0.1181', 'NDCG@10': '0.0709', 'HR@20': '0.1636', 'NDCG@20': '0.0823'}
2025-03-03 00:45:52,891 - EarlyStopping counter: 4 out of 10
2025-03-03 00:46:20,388 - {'epoch': 73, 'rec_loss': '7.0803'}
2025-03-03 00:46:28,365 - {'Epoch': 73, 'HR@5': '0.0859', 'NDCG@5': '0.0604', 'HR@10': '0.1191', 'NDCG@10': '0.0711', 'HR@20': '0.1622', 'NDCG@20': '0.0820'}
2025-03-03 00:46:28,366 - EarlyStopping counter: 5 out of 10
2025-03-03 00:46:55,728 - {'epoch': 74, 'rec_loss': '7.0807'}
2025-03-03 00:47:03,816 - {'Epoch': 74, 'HR@5': '0.0855', 'NDCG@5': '0.0605', 'HR@10': '0.1193', 'NDCG@10': '0.0713', 'HR@20': '0.1623', 'NDCG@20': '0.0822'}
2025-03-03 00:47:03,817 - EarlyStopping counter: 6 out of 10
2025-03-03 00:47:32,958 - {'epoch': 75, 'rec_loss': '7.0784'}
2025-03-03 00:47:40,972 - {'Epoch': 75, 'HR@5': '0.0855', 'NDCG@5': '0.0602', 'HR@10': '0.1183', 'NDCG@10': '0.0707', 'HR@20': '0.1622', 'NDCG@20': '0.0818'}
2025-03-03 00:47:40,973 - EarlyStopping counter: 7 out of 10
2025-03-03 00:48:07,821 - {'epoch': 76, 'rec_loss': '7.0628'}
2025-03-03 00:48:15,709 - {'Epoch': 76, 'HR@5': '0.0856', 'NDCG@5': '0.0607', 'HR@10': '0.1190', 'NDCG@10': '0.0714', 'HR@20': '0.1625', 'NDCG@20': '0.0824'}
2025-03-03 00:48:15,710 - EarlyStopping counter: 8 out of 10
2025-03-03 00:48:44,343 - {'epoch': 77, 'rec_loss': '7.0665'}
2025-03-03 00:48:52,378 - {'Epoch': 77, 'HR@5': '0.0865', 'NDCG@5': '0.0608', 'HR@10': '0.1200', 'NDCG@10': '0.0716', 'HR@20': '0.1633', 'NDCG@20': '0.0825'}
2025-03-03 00:48:52,379 - Validation score increased.  Saving model ...
2025-03-03 00:49:19,698 - {'epoch': 78, 'rec_loss': '7.0628'}
2025-03-03 00:49:27,599 - {'Epoch': 78, 'HR@5': '0.0866', 'NDCG@5': '0.0612', 'HR@10': '0.1188', 'NDCG@10': '0.0716', 'HR@20': '0.1627', 'NDCG@20': '0.0826'}
2025-03-03 00:49:27,600 - Validation score increased.  Saving model ...
2025-03-03 00:49:55,480 - {'epoch': 79, 'rec_loss': '7.0717'}
2025-03-03 00:50:03,441 - {'Epoch': 79, 'HR@5': '0.0863', 'NDCG@5': '0.0605', 'HR@10': '0.1190', 'NDCG@10': '0.0710', 'HR@20': '0.1636', 'NDCG@20': '0.0822'}
2025-03-03 00:50:03,442 - EarlyStopping counter: 1 out of 10
2025-03-03 00:50:31,639 - {'epoch': 80, 'rec_loss': '7.0670'}
2025-03-03 00:50:39,429 - {'Epoch': 80, 'HR@5': '0.0861', 'NDCG@5': '0.0607', 'HR@10': '0.1193', 'NDCG@10': '0.0713', 'HR@20': '0.1629', 'NDCG@20': '0.0823'}
2025-03-03 00:50:39,430 - EarlyStopping counter: 2 out of 10
2025-03-03 00:51:07,167 - {'epoch': 81, 'rec_loss': '7.0593'}
2025-03-03 00:51:15,103 - {'Epoch': 81, 'HR@5': '0.0866', 'NDCG@5': '0.0613', 'HR@10': '0.1196', 'NDCG@10': '0.0720', 'HR@20': '0.1632', 'NDCG@20': '0.0830'}
2025-03-03 00:51:15,104 - Validation score increased.  Saving model ...
2025-03-03 00:51:42,877 - {'epoch': 82, 'rec_loss': '7.0611'}
2025-03-03 00:51:50,831 - {'Epoch': 82, 'HR@5': '0.0851', 'NDCG@5': '0.0594', 'HR@10': '0.1186', 'NDCG@10': '0.0701', 'HR@20': '0.1634', 'NDCG@20': '0.0814'}
2025-03-03 00:51:50,832 - EarlyStopping counter: 1 out of 10
2025-03-03 00:52:18,491 - {'epoch': 83, 'rec_loss': '7.0536'}
2025-03-03 00:52:26,463 - {'Epoch': 83, 'HR@5': '0.0857', 'NDCG@5': '0.0602', 'HR@10': '0.1201', 'NDCG@10': '0.0712', 'HR@20': '0.1633', 'NDCG@20': '0.0821'}
2025-03-03 00:52:26,464 - EarlyStopping counter: 2 out of 10
2025-03-03 00:52:54,890 - {'epoch': 84, 'rec_loss': '7.0622'}
2025-03-03 00:53:03,041 - {'Epoch': 84, 'HR@5': '0.0857', 'NDCG@5': '0.0604', 'HR@10': '0.1174', 'NDCG@10': '0.0707', 'HR@20': '0.1635', 'NDCG@20': '0.0824'}
2025-03-03 00:53:03,042 - EarlyStopping counter: 3 out of 10
2025-03-03 00:53:32,882 - {'epoch': 85, 'rec_loss': '7.0548'}
2025-03-03 00:53:41,207 - {'Epoch': 85, 'HR@5': '0.0860', 'NDCG@5': '0.0604', 'HR@10': '0.1189', 'NDCG@10': '0.0709', 'HR@20': '0.1638', 'NDCG@20': '0.0822'}
2025-03-03 00:53:41,208 - EarlyStopping counter: 4 out of 10
2025-03-03 00:54:09,995 - {'epoch': 86, 'rec_loss': '7.0559'}
2025-03-03 00:54:18,083 - {'Epoch': 86, 'HR@5': '0.0865', 'NDCG@5': '0.0611', 'HR@10': '0.1189', 'NDCG@10': '0.0715', 'HR@20': '0.1627', 'NDCG@20': '0.0825'}
2025-03-03 00:54:18,084 - EarlyStopping counter: 5 out of 10
2025-03-03 00:54:45,637 - {'epoch': 87, 'rec_loss': '7.0555'}
2025-03-03 00:54:53,837 - {'Epoch': 87, 'HR@5': '0.0860', 'NDCG@5': '0.0604', 'HR@10': '0.1189', 'NDCG@10': '0.0711', 'HR@20': '0.1625', 'NDCG@20': '0.0821'}
2025-03-03 00:54:53,843 - EarlyStopping counter: 6 out of 10
2025-03-03 00:55:22,103 - {'epoch': 88, 'rec_loss': '7.0530'}
2025-03-03 00:55:29,813 - {'Epoch': 88, 'HR@5': '0.0881', 'NDCG@5': '0.0616', 'HR@10': '0.1204', 'NDCG@10': '0.0719', 'HR@20': '0.1635', 'NDCG@20': '0.0828'}
2025-03-03 00:55:29,814 - EarlyStopping counter: 7 out of 10
2025-03-03 00:55:58,849 - {'epoch': 89, 'rec_loss': '7.0502'}
2025-03-03 00:56:06,684 - {'Epoch': 89, 'HR@5': '0.0867', 'NDCG@5': '0.0611', 'HR@10': '0.1199', 'NDCG@10': '0.0717', 'HR@20': '0.1642', 'NDCG@20': '0.0829'}
2025-03-03 00:56:06,685 - EarlyStopping counter: 8 out of 10
2025-03-03 00:56:34,517 - {'epoch': 90, 'rec_loss': '7.0521'}
2025-03-03 00:56:42,458 - {'Epoch': 90, 'HR@5': '0.0863', 'NDCG@5': '0.0603', 'HR@10': '0.1189', 'NDCG@10': '0.0708', 'HR@20': '0.1625', 'NDCG@20': '0.0818'}
2025-03-03 00:56:42,459 - EarlyStopping counter: 9 out of 10
2025-03-03 00:57:10,102 - {'epoch': 91, 'rec_loss': '7.0450'}
2025-03-03 00:57:18,070 - {'Epoch': 91, 'HR@5': '0.0875', 'NDCG@5': '0.0617', 'HR@10': '0.1193', 'NDCG@10': '0.0718', 'HR@20': '0.1634', 'NDCG@20': '0.0829'}
2025-03-03 00:57:18,071 - EarlyStopping counter: 10 out of 10
2025-03-03 00:57:18,071 - Early stopping
2025-03-03 00:57:18,071 - ---------------Test Score---------------
2025-03-03 00:57:25,908 - {'Epoch': 0, 'HR@5': '0.0688', 'NDCG@5': '0.0486', 'HR@10': '0.0965', 'NDCG@10': '0.0575', 'HR@20': '0.1346', 'NDCG@20': '0.0671'}
2025-03-03 00:57:25,909 - Scale_Beauty
2025-03-03 00:57:25,910 - {'Epoch': 0, 'HR@5': '0.0688', 'NDCG@5': '0.0486', 'HR@10': '0.0965', 'NDCG@10': '0.0575', 'HR@20': '0.1346', 'NDCG@20': '0.0671'}
2025-03-03 01:01:07,122 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 12, 32], start_prob=0.6, end_prob=0.9, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-03 01:01:09,989 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-03 01:01:09,994 - Total Parameters: 929445
2025-03-03 01:01:40,147 - {'epoch': 0, 'rec_loss': '8.9727'}
2025-03-03 01:01:48,190 - {'Epoch': 0, 'HR@5': '0.0118', 'NDCG@5': '0.0073', 'HR@10': '0.0204', 'NDCG@10': '0.0100', 'HR@20': '0.0328', 'NDCG@20': '0.0132'}
2025-03-03 01:01:48,191 - Validation score increased.  Saving model ...
2025-03-03 01:02:16,581 - {'epoch': 1, 'rec_loss': '8.6786'}
2025-03-03 01:02:24,857 - {'Epoch': 1, 'HR@5': '0.0140', 'NDCG@5': '0.0086', 'HR@10': '0.0269', 'NDCG@10': '0.0127', 'HR@20': '0.0412', 'NDCG@20': '0.0162'}
2025-03-03 01:02:24,858 - Validation score increased.  Saving model ...
2025-03-03 01:02:52,496 - {'epoch': 2, 'rec_loss': '8.5144'}
2025-03-03 01:03:00,361 - {'Epoch': 2, 'HR@5': '0.0254', 'NDCG@5': '0.0160', 'HR@10': '0.0381', 'NDCG@10': '0.0201', 'HR@20': '0.0569', 'NDCG@20': '0.0248'}
2025-03-03 01:03:00,366 - Validation score increased.  Saving model ...
2025-03-03 01:03:28,881 - {'epoch': 3, 'rec_loss': '8.3672'}
2025-03-03 01:03:36,651 - {'Epoch': 3, 'HR@5': '0.0277', 'NDCG@5': '0.0184', 'HR@10': '0.0464', 'NDCG@10': '0.0244', 'HR@20': '0.0700', 'NDCG@20': '0.0303'}
2025-03-03 01:03:36,652 - Validation score increased.  Saving model ...
2025-03-03 01:04:05,424 - {'epoch': 4, 'rec_loss': '8.2456'}
2025-03-03 01:04:13,390 - {'Epoch': 4, 'HR@5': '0.0355', 'NDCG@5': '0.0234', 'HR@10': '0.0538', 'NDCG@10': '0.0293', 'HR@20': '0.0817', 'NDCG@20': '0.0363'}
2025-03-03 01:04:13,394 - Validation score increased.  Saving model ...
2025-03-03 01:04:43,843 - {'epoch': 5, 'rec_loss': '8.1426'}
2025-03-03 01:04:51,827 - {'Epoch': 5, 'HR@5': '0.0382', 'NDCG@5': '0.0251', 'HR@10': '0.0592', 'NDCG@10': '0.0318', 'HR@20': '0.0901', 'NDCG@20': '0.0396'}
2025-03-03 01:04:51,829 - Validation score increased.  Saving model ...
2025-03-03 01:05:18,660 - {'epoch': 6, 'rec_loss': '8.0580'}
2025-03-03 01:05:26,404 - {'Epoch': 6, 'HR@5': '0.0421', 'NDCG@5': '0.0285', 'HR@10': '0.0662', 'NDCG@10': '0.0362', 'HR@20': '0.0970', 'NDCG@20': '0.0439'}
2025-03-03 01:05:26,405 - Validation score increased.  Saving model ...
2025-03-03 01:05:56,621 - {'epoch': 7, 'rec_loss': '7.9890'}
2025-03-03 01:06:04,352 - {'Epoch': 7, 'HR@5': '0.0470', 'NDCG@5': '0.0313', 'HR@10': '0.0697', 'NDCG@10': '0.0387', 'HR@20': '0.1037', 'NDCG@20': '0.0472'}
2025-03-03 01:06:04,353 - Validation score increased.  Saving model ...
2025-03-03 01:06:33,136 - {'epoch': 8, 'rec_loss': '7.9365'}
2025-03-03 01:06:41,309 - {'Epoch': 8, 'HR@5': '0.0497', 'NDCG@5': '0.0329', 'HR@10': '0.0765', 'NDCG@10': '0.0414', 'HR@20': '0.1114', 'NDCG@20': '0.0502'}
2025-03-03 01:06:41,310 - Validation score increased.  Saving model ...
2025-03-03 01:07:09,223 - {'epoch': 9, 'rec_loss': '7.8931'}
2025-03-03 01:07:17,227 - {'Epoch': 9, 'HR@5': '0.0511', 'NDCG@5': '0.0345', 'HR@10': '0.0779', 'NDCG@10': '0.0431', 'HR@20': '0.1135', 'NDCG@20': '0.0521'}
2025-03-03 01:07:17,231 - Validation score increased.  Saving model ...
2025-03-03 01:07:45,832 - {'epoch': 10, 'rec_loss': '7.8511'}
2025-03-03 01:07:53,612 - {'Epoch': 10, 'HR@5': '0.0551', 'NDCG@5': '0.0366', 'HR@10': '0.0820', 'NDCG@10': '0.0452', 'HR@20': '0.1181', 'NDCG@20': '0.0543'}
2025-03-03 01:07:53,613 - Validation score increased.  Saving model ...
2025-03-03 01:08:23,155 - {'epoch': 11, 'rec_loss': '7.8216'}
2025-03-03 01:08:31,447 - {'Epoch': 11, 'HR@5': '0.0576', 'NDCG@5': '0.0386', 'HR@10': '0.0846', 'NDCG@10': '0.0473', 'HR@20': '0.1206', 'NDCG@20': '0.0564'}
2025-03-03 01:08:31,452 - Validation score increased.  Saving model ...
2025-03-03 01:08:59,024 - {'epoch': 12, 'rec_loss': '7.7879'}
2025-03-03 01:09:06,701 - {'Epoch': 12, 'HR@5': '0.0586', 'NDCG@5': '0.0396', 'HR@10': '0.0873', 'NDCG@10': '0.0488', 'HR@20': '0.1240', 'NDCG@20': '0.0581'}
2025-03-03 01:09:06,706 - Validation score increased.  Saving model ...
2025-03-03 01:09:35,625 - {'epoch': 13, 'rec_loss': '7.7604'}
2025-03-03 01:09:43,802 - {'Epoch': 13, 'HR@5': '0.0588', 'NDCG@5': '0.0392', 'HR@10': '0.0893', 'NDCG@10': '0.0490', 'HR@20': '0.1274', 'NDCG@20': '0.0586'}
2025-03-03 01:09:43,803 - Validation score increased.  Saving model ...
2025-03-03 01:10:12,256 - {'epoch': 14, 'rec_loss': '7.7488'}
2025-03-03 01:10:20,015 - {'Epoch': 14, 'HR@5': '0.0629', 'NDCG@5': '0.0422', 'HR@10': '0.0904', 'NDCG@10': '0.0511', 'HR@20': '0.1300', 'NDCG@20': '0.0611'}
2025-03-03 01:10:20,016 - Validation score increased.  Saving model ...
2025-03-03 01:10:49,336 - {'epoch': 15, 'rec_loss': '7.7136'}
2025-03-03 01:10:57,104 - {'Epoch': 15, 'HR@5': '0.0627', 'NDCG@5': '0.0425', 'HR@10': '0.0927', 'NDCG@10': '0.0521', 'HR@20': '0.1312', 'NDCG@20': '0.0618'}
2025-03-03 01:10:57,105 - Validation score increased.  Saving model ...
2025-03-03 01:11:24,801 - {'epoch': 16, 'rec_loss': '7.6959'}
2025-03-03 01:11:32,445 - {'Epoch': 16, 'HR@5': '0.0626', 'NDCG@5': '0.0428', 'HR@10': '0.0940', 'NDCG@10': '0.0530', 'HR@20': '0.1308', 'NDCG@20': '0.0622'}
2025-03-03 01:11:32,447 - Validation score increased.  Saving model ...
2025-03-03 01:12:04,529 - {'epoch': 17, 'rec_loss': '7.6766'}
2025-03-03 01:12:12,590 - {'Epoch': 17, 'HR@5': '0.0631', 'NDCG@5': '0.0430', 'HR@10': '0.0934', 'NDCG@10': '0.0528', 'HR@20': '0.1331', 'NDCG@20': '0.0628'}
2025-03-03 01:12:12,597 - Validation score increased.  Saving model ...
2025-03-03 01:12:39,089 - {'epoch': 18, 'rec_loss': '7.6613'}
2025-03-03 01:12:46,756 - {'Epoch': 18, 'HR@5': '0.0652', 'NDCG@5': '0.0445', 'HR@10': '0.0972', 'NDCG@10': '0.0548', 'HR@20': '0.1362', 'NDCG@20': '0.0646'}
2025-03-03 01:12:46,758 - Validation score increased.  Saving model ...
2025-03-03 01:13:15,652 - {'epoch': 19, 'rec_loss': '7.6371'}
2025-03-03 01:13:23,403 - {'Epoch': 19, 'HR@5': '0.0656', 'NDCG@5': '0.0449', 'HR@10': '0.0971', 'NDCG@10': '0.0551', 'HR@20': '0.1361', 'NDCG@20': '0.0649'}
2025-03-03 01:13:23,408 - Validation score increased.  Saving model ...
2025-03-03 01:13:51,902 - {'epoch': 20, 'rec_loss': '7.6184'}
2025-03-03 01:13:59,815 - {'Epoch': 20, 'HR@5': '0.0672', 'NDCG@5': '0.0460', 'HR@10': '0.0988', 'NDCG@10': '0.0561', 'HR@20': '0.1378', 'NDCG@20': '0.0659'}
2025-03-03 01:13:59,817 - Validation score increased.  Saving model ...
2025-03-03 01:14:27,586 - {'epoch': 21, 'rec_loss': '7.6078'}
2025-03-03 01:14:35,411 - {'Epoch': 21, 'HR@5': '0.0688', 'NDCG@5': '0.0474', 'HR@10': '0.1006', 'NDCG@10': '0.0576', 'HR@20': '0.1397', 'NDCG@20': '0.0674'}
2025-03-03 01:14:35,412 - Validation score increased.  Saving model ...
2025-03-03 01:15:07,105 - {'epoch': 22, 'rec_loss': '7.5909'}
2025-03-03 01:15:15,072 - {'Epoch': 22, 'HR@5': '0.0699', 'NDCG@5': '0.0477', 'HR@10': '0.1011', 'NDCG@10': '0.0578', 'HR@20': '0.1404', 'NDCG@20': '0.0677'}
2025-03-03 01:15:15,073 - Validation score increased.  Saving model ...
2025-03-03 01:15:45,972 - {'epoch': 23, 'rec_loss': '7.5803'}
2025-03-03 01:15:53,764 - {'Epoch': 23, 'HR@5': '0.0702', 'NDCG@5': '0.0484', 'HR@10': '0.1026', 'NDCG@10': '0.0588', 'HR@20': '0.1418', 'NDCG@20': '0.0687'}
2025-03-03 01:15:53,768 - Validation score increased.  Saving model ...
2025-03-03 01:16:22,295 - {'epoch': 24, 'rec_loss': '7.5746'}
2025-03-03 01:16:30,245 - {'Epoch': 24, 'HR@5': '0.0713', 'NDCG@5': '0.0488', 'HR@10': '0.1024', 'NDCG@10': '0.0588', 'HR@20': '0.1408', 'NDCG@20': '0.0684'}
2025-03-03 01:16:30,251 - EarlyStopping counter: 1 out of 10
2025-03-03 01:16:58,525 - {'epoch': 25, 'rec_loss': '7.5598'}
2025-03-03 01:17:06,270 - {'Epoch': 25, 'HR@5': '0.0733', 'NDCG@5': '0.0500', 'HR@10': '0.1023', 'NDCG@10': '0.0593', 'HR@20': '0.1435', 'NDCG@20': '0.0697'}
2025-03-03 01:17:06,275 - Validation score increased.  Saving model ...
2025-03-03 01:17:36,968 - {'epoch': 26, 'rec_loss': '7.5551'}
2025-03-03 01:17:44,907 - {'Epoch': 26, 'HR@5': '0.0726', 'NDCG@5': '0.0493', 'HR@10': '0.1045', 'NDCG@10': '0.0595', 'HR@20': '0.1452', 'NDCG@20': '0.0697'}
2025-03-03 01:17:44,909 - Validation score increased.  Saving model ...
2025-03-03 01:18:12,280 - {'epoch': 27, 'rec_loss': '7.5351'}
2025-03-03 01:18:20,438 - {'Epoch': 27, 'HR@5': '0.0719', 'NDCG@5': '0.0496', 'HR@10': '0.1050', 'NDCG@10': '0.0603', 'HR@20': '0.1446', 'NDCG@20': '0.0703'}
2025-03-03 01:18:20,439 - Validation score increased.  Saving model ...
2025-03-03 01:18:52,289 - {'epoch': 28, 'rec_loss': '7.5276'}
2025-03-03 01:19:00,029 - {'Epoch': 28, 'HR@5': '0.0739', 'NDCG@5': '0.0503', 'HR@10': '0.1041', 'NDCG@10': '0.0600', 'HR@20': '0.1452', 'NDCG@20': '0.0703'}
2025-03-03 01:19:00,031 - Validation score increased.  Saving model ...
2025-03-03 01:19:27,796 - {'epoch': 29, 'rec_loss': '7.5209'}
2025-03-03 01:19:35,585 - {'Epoch': 29, 'HR@5': '0.0738', 'NDCG@5': '0.0507', 'HR@10': '0.1055', 'NDCG@10': '0.0609', 'HR@20': '0.1467', 'NDCG@20': '0.0712'}
2025-03-03 01:19:35,586 - Validation score increased.  Saving model ...
2025-03-03 01:20:02,729 - {'epoch': 30, 'rec_loss': '7.5160'}
2025-03-03 01:20:10,835 - {'Epoch': 30, 'HR@5': '0.0741', 'NDCG@5': '0.0514', 'HR@10': '0.1050', 'NDCG@10': '0.0613', 'HR@20': '0.1465', 'NDCG@20': '0.0718'}
2025-03-03 01:20:10,837 - Validation score increased.  Saving model ...
2025-03-03 01:20:39,025 - {'epoch': 31, 'rec_loss': '7.5066'}
2025-03-03 01:20:46,651 - {'Epoch': 31, 'HR@5': '0.0735', 'NDCG@5': '0.0510', 'HR@10': '0.1045', 'NDCG@10': '0.0609', 'HR@20': '0.1471', 'NDCG@20': '0.0717'}
2025-03-03 01:20:46,652 - EarlyStopping counter: 1 out of 10
2025-03-03 01:21:14,511 - {'epoch': 32, 'rec_loss': '7.4963'}
2025-03-03 01:21:22,426 - {'Epoch': 32, 'HR@5': '0.0754', 'NDCG@5': '0.0521', 'HR@10': '0.1064', 'NDCG@10': '0.0621', 'HR@20': '0.1479', 'NDCG@20': '0.0725'}
2025-03-03 01:21:22,428 - Validation score increased.  Saving model ...
2025-03-03 01:21:50,821 - {'epoch': 33, 'rec_loss': '7.4933'}
2025-03-03 01:21:58,757 - {'Epoch': 33, 'HR@5': '0.0774', 'NDCG@5': '0.0530', 'HR@10': '0.1088', 'NDCG@10': '0.0631', 'HR@20': '0.1476', 'NDCG@20': '0.0729'}
2025-03-03 01:21:58,758 - Validation score increased.  Saving model ...
2025-03-03 01:22:28,248 - {'epoch': 34, 'rec_loss': '7.4814'}
2025-03-03 01:22:36,189 - {'Epoch': 34, 'HR@5': '0.0752', 'NDCG@5': '0.0514', 'HR@10': '0.1069', 'NDCG@10': '0.0617', 'HR@20': '0.1480', 'NDCG@20': '0.0720'}
2025-03-03 01:22:36,190 - EarlyStopping counter: 1 out of 10
2025-03-03 01:23:04,220 - {'epoch': 35, 'rec_loss': '7.4721'}
2025-03-03 01:23:12,035 - {'Epoch': 35, 'HR@5': '0.0758', 'NDCG@5': '0.0522', 'HR@10': '0.1083', 'NDCG@10': '0.0627', 'HR@20': '0.1494', 'NDCG@20': '0.0730'}
2025-03-03 01:23:12,036 - Validation score increased.  Saving model ...
2025-03-03 01:23:40,566 - {'epoch': 36, 'rec_loss': '7.4741'}
2025-03-03 01:23:48,618 - {'Epoch': 36, 'HR@5': '0.0751', 'NDCG@5': '0.0520', 'HR@10': '0.1086', 'NDCG@10': '0.0628', 'HR@20': '0.1495', 'NDCG@20': '0.0731'}
2025-03-03 01:23:48,619 - Validation score increased.  Saving model ...
2025-03-03 01:24:16,145 - {'epoch': 37, 'rec_loss': '7.4501'}
2025-03-03 01:24:23,989 - {'Epoch': 37, 'HR@5': '0.0768', 'NDCG@5': '0.0530', 'HR@10': '0.1107', 'NDCG@10': '0.0638', 'HR@20': '0.1518', 'NDCG@20': '0.0742'}
2025-03-03 01:24:23,990 - Validation score increased.  Saving model ...
2025-03-03 01:24:52,327 - {'epoch': 38, 'rec_loss': '7.4513'}
2025-03-03 01:25:00,325 - {'Epoch': 38, 'HR@5': '0.0766', 'NDCG@5': '0.0529', 'HR@10': '0.1090', 'NDCG@10': '0.0633', 'HR@20': '0.1511', 'NDCG@20': '0.0739'}
2025-03-03 01:25:00,327 - EarlyStopping counter: 1 out of 10
2025-03-03 01:25:29,017 - {'epoch': 39, 'rec_loss': '7.4555'}
2025-03-03 01:25:36,771 - {'Epoch': 39, 'HR@5': '0.0769', 'NDCG@5': '0.0525', 'HR@10': '0.1098', 'NDCG@10': '0.0630', 'HR@20': '0.1510', 'NDCG@20': '0.0734'}
2025-03-03 01:25:36,772 - EarlyStopping counter: 2 out of 10
2025-03-03 01:26:04,123 - {'epoch': 40, 'rec_loss': '7.4415'}
2025-03-03 01:26:12,374 - {'Epoch': 40, 'HR@5': '0.0774', 'NDCG@5': '0.0533', 'HR@10': '0.1093', 'NDCG@10': '0.0636', 'HR@20': '0.1511', 'NDCG@20': '0.0741'}
2025-03-03 01:26:12,376 - EarlyStopping counter: 3 out of 10
2025-03-03 01:26:39,804 - {'epoch': 41, 'rec_loss': '7.4439'}
2025-03-03 01:26:47,763 - {'Epoch': 41, 'HR@5': '0.0793', 'NDCG@5': '0.0545', 'HR@10': '0.1108', 'NDCG@10': '0.0647', 'HR@20': '0.1544', 'NDCG@20': '0.0756'}
2025-03-03 01:26:47,764 - Validation score increased.  Saving model ...
2025-03-03 01:27:17,892 - {'epoch': 42, 'rec_loss': '7.4329'}
2025-03-03 01:27:25,962 - {'Epoch': 42, 'HR@5': '0.0793', 'NDCG@5': '0.0544', 'HR@10': '0.1099', 'NDCG@10': '0.0642', 'HR@20': '0.1523', 'NDCG@20': '0.0749'}
2025-03-03 01:27:25,963 - EarlyStopping counter: 1 out of 10
2025-03-03 01:27:55,729 - {'epoch': 43, 'rec_loss': '7.4267'}
2025-03-03 01:28:03,895 - {'Epoch': 43, 'HR@5': '0.0767', 'NDCG@5': '0.0529', 'HR@10': '0.1095', 'NDCG@10': '0.0635', 'HR@20': '0.1520', 'NDCG@20': '0.0742'}
2025-03-03 01:28:03,899 - EarlyStopping counter: 2 out of 10
2025-03-03 01:28:33,123 - {'epoch': 44, 'rec_loss': '7.4372'}
2025-03-03 01:28:40,959 - {'Epoch': 44, 'HR@5': '0.0772', 'NDCG@5': '0.0535', 'HR@10': '0.1092', 'NDCG@10': '0.0638', 'HR@20': '0.1521', 'NDCG@20': '0.0745'}
2025-03-03 01:28:40,960 - EarlyStopping counter: 3 out of 10
2025-03-03 01:29:09,093 - {'epoch': 45, 'rec_loss': '7.4185'}
2025-03-03 01:29:16,995 - {'Epoch': 45, 'HR@5': '0.0796', 'NDCG@5': '0.0545', 'HR@10': '0.1099', 'NDCG@10': '0.0643', 'HR@20': '0.1532', 'NDCG@20': '0.0752'}
2025-03-03 01:29:16,996 - EarlyStopping counter: 4 out of 10
2025-03-03 01:29:45,508 - {'epoch': 46, 'rec_loss': '7.4172'}
2025-03-03 01:29:53,330 - {'Epoch': 46, 'HR@5': '0.0781', 'NDCG@5': '0.0542', 'HR@10': '0.1109', 'NDCG@10': '0.0648', 'HR@20': '0.1538', 'NDCG@20': '0.0756'}
2025-03-03 01:29:53,331 - EarlyStopping counter: 5 out of 10
2025-03-03 01:30:23,098 - {'epoch': 47, 'rec_loss': '7.4050'}
2025-03-03 01:30:31,067 - {'Epoch': 47, 'HR@5': '0.0791', 'NDCG@5': '0.0547', 'HR@10': '0.1122', 'NDCG@10': '0.0653', 'HR@20': '0.1529', 'NDCG@20': '0.0756'}
2025-03-03 01:30:31,068 - EarlyStopping counter: 6 out of 10
2025-03-03 01:30:59,318 - {'epoch': 48, 'rec_loss': '7.4086'}
2025-03-03 01:31:07,343 - {'Epoch': 48, 'HR@5': '0.0792', 'NDCG@5': '0.0549', 'HR@10': '0.1118', 'NDCG@10': '0.0654', 'HR@20': '0.1539', 'NDCG@20': '0.0760'}
2025-03-03 01:31:07,352 - Validation score increased.  Saving model ...
2025-03-03 01:31:35,942 - {'epoch': 49, 'rec_loss': '7.4095'}
2025-03-03 01:31:43,870 - {'Epoch': 49, 'HR@5': '0.0792', 'NDCG@5': '0.0545', 'HR@10': '0.1115', 'NDCG@10': '0.0649', 'HR@20': '0.1545', 'NDCG@20': '0.0758'}
2025-03-03 01:31:43,874 - EarlyStopping counter: 1 out of 10
2025-03-03 01:32:15,861 - {'epoch': 50, 'rec_loss': '7.4003'}
2025-03-03 01:32:23,756 - {'Epoch': 50, 'HR@5': '0.0785', 'NDCG@5': '0.0538', 'HR@10': '0.1111', 'NDCG@10': '0.0643', 'HR@20': '0.1530', 'NDCG@20': '0.0749'}
2025-03-03 01:32:23,762 - EarlyStopping counter: 2 out of 10
2025-03-03 01:32:52,543 - {'epoch': 51, 'rec_loss': '7.4012'}
2025-03-03 01:33:00,367 - {'Epoch': 51, 'HR@5': '0.0786', 'NDCG@5': '0.0542', 'HR@10': '0.1117', 'NDCG@10': '0.0648', 'HR@20': '0.1540', 'NDCG@20': '0.0755'}
2025-03-03 01:33:00,373 - EarlyStopping counter: 3 out of 10
2025-03-03 01:33:28,124 - {'epoch': 52, 'rec_loss': '7.3859'}
2025-03-03 01:33:36,759 - {'Epoch': 52, 'HR@5': '0.0783', 'NDCG@5': '0.0544', 'HR@10': '0.1115', 'NDCG@10': '0.0651', 'HR@20': '0.1548', 'NDCG@20': '0.0759'}
2025-03-03 01:33:36,761 - EarlyStopping counter: 4 out of 10
2025-03-03 01:34:05,039 - {'epoch': 53, 'rec_loss': '7.3914'}
2025-03-03 01:34:13,452 - {'Epoch': 53, 'HR@5': '0.0792', 'NDCG@5': '0.0549', 'HR@10': '0.1113', 'NDCG@10': '0.0652', 'HR@20': '0.1555', 'NDCG@20': '0.0764'}
2025-03-03 01:34:13,453 - Validation score increased.  Saving model ...
2025-03-03 01:34:42,297 - {'epoch': 54, 'rec_loss': '7.3753'}
2025-03-03 01:34:50,218 - {'Epoch': 54, 'HR@5': '0.0787', 'NDCG@5': '0.0547', 'HR@10': '0.1109', 'NDCG@10': '0.0651', 'HR@20': '0.1538', 'NDCG@20': '0.0759'}
2025-03-03 01:34:50,219 - EarlyStopping counter: 1 out of 10
2025-03-03 01:35:18,531 - {'epoch': 55, 'rec_loss': '7.3782'}
2025-03-03 01:35:26,679 - {'Epoch': 55, 'HR@5': '0.0802', 'NDCG@5': '0.0558', 'HR@10': '0.1109', 'NDCG@10': '0.0657', 'HR@20': '0.1553', 'NDCG@20': '0.0769'}
2025-03-03 01:35:26,681 - Validation score increased.  Saving model ...
2025-03-03 01:35:54,850 - {'epoch': 56, 'rec_loss': '7.3771'}
2025-03-03 01:36:02,898 - {'Epoch': 56, 'HR@5': '0.0778', 'NDCG@5': '0.0549', 'HR@10': '0.1120', 'NDCG@10': '0.0659', 'HR@20': '0.1537', 'NDCG@20': '0.0765'}
2025-03-03 01:36:02,899 - EarlyStopping counter: 1 out of 10
2025-03-03 01:36:33,700 - {'epoch': 57, 'rec_loss': '7.3735'}
2025-03-03 01:36:41,622 - {'Epoch': 57, 'HR@5': '0.0784', 'NDCG@5': '0.0545', 'HR@10': '0.1122', 'NDCG@10': '0.0654', 'HR@20': '0.1541', 'NDCG@20': '0.0759'}
2025-03-03 01:36:41,623 - EarlyStopping counter: 2 out of 10
2025-03-03 01:37:09,184 - {'epoch': 58, 'rec_loss': '7.3719'}
2025-03-03 01:37:17,015 - {'Epoch': 58, 'HR@5': '0.0793', 'NDCG@5': '0.0552', 'HR@10': '0.1113', 'NDCG@10': '0.0655', 'HR@20': '0.1557', 'NDCG@20': '0.0766'}
2025-03-03 01:37:17,016 - EarlyStopping counter: 3 out of 10
2025-03-03 01:37:45,307 - {'epoch': 59, 'rec_loss': '7.3723'}
2025-03-03 01:37:53,421 - {'Epoch': 59, 'HR@5': '0.0801', 'NDCG@5': '0.0557', 'HR@10': '0.1127', 'NDCG@10': '0.0662', 'HR@20': '0.1548', 'NDCG@20': '0.0768'}
2025-03-03 01:37:53,422 - EarlyStopping counter: 4 out of 10
2025-03-03 01:38:21,555 - {'epoch': 60, 'rec_loss': '7.3623'}
2025-03-03 01:38:29,615 - {'Epoch': 60, 'HR@5': '0.0795', 'NDCG@5': '0.0560', 'HR@10': '0.1122', 'NDCG@10': '0.0666', 'HR@20': '0.1556', 'NDCG@20': '0.0775'}
2025-03-03 01:38:29,619 - Validation score increased.  Saving model ...
2025-03-03 01:38:58,111 - {'epoch': 61, 'rec_loss': '7.3612'}
2025-03-03 01:39:06,077 - {'Epoch': 61, 'HR@5': '0.0792', 'NDCG@5': '0.0552', 'HR@10': '0.1131', 'NDCG@10': '0.0661', 'HR@20': '0.1556', 'NDCG@20': '0.0768'}
2025-03-03 01:39:06,078 - EarlyStopping counter: 1 out of 10
2025-03-03 01:39:37,054 - {'epoch': 62, 'rec_loss': '7.3648'}
2025-03-03 01:39:45,646 - {'Epoch': 62, 'HR@5': '0.0791', 'NDCG@5': '0.0558', 'HR@10': '0.1120', 'NDCG@10': '0.0664', 'HR@20': '0.1540', 'NDCG@20': '0.0770'}
2025-03-03 01:39:45,648 - EarlyStopping counter: 2 out of 10
2025-03-03 01:40:14,420 - {'epoch': 63, 'rec_loss': '7.3590'}
2025-03-03 01:40:22,341 - {'Epoch': 63, 'HR@5': '0.0787', 'NDCG@5': '0.0551', 'HR@10': '0.1113', 'NDCG@10': '0.0657', 'HR@20': '0.1553', 'NDCG@20': '0.0767'}
2025-03-03 01:40:22,343 - EarlyStopping counter: 3 out of 10
2025-03-03 01:40:51,072 - {'epoch': 64, 'rec_loss': '7.3462'}
2025-03-03 01:40:59,052 - {'Epoch': 64, 'HR@5': '0.0801', 'NDCG@5': '0.0564', 'HR@10': '0.1115', 'NDCG@10': '0.0665', 'HR@20': '0.1533', 'NDCG@20': '0.0771'}
2025-03-03 01:40:59,054 - EarlyStopping counter: 4 out of 10
2025-03-03 01:41:25,799 - {'epoch': 65, 'rec_loss': '7.3476'}
2025-03-03 01:41:33,897 - {'Epoch': 65, 'HR@5': '0.0790', 'NDCG@5': '0.0545', 'HR@10': '0.1121', 'NDCG@10': '0.0651', 'HR@20': '0.1531', 'NDCG@20': '0.0754'}
2025-03-03 01:41:33,904 - EarlyStopping counter: 5 out of 10
2025-03-03 01:42:01,944 - {'epoch': 66, 'rec_loss': '7.3396'}
2025-03-03 01:42:09,946 - {'Epoch': 66, 'HR@5': '0.0798', 'NDCG@5': '0.0555', 'HR@10': '0.1118', 'NDCG@10': '0.0658', 'HR@20': '0.1539', 'NDCG@20': '0.0764'}
2025-03-03 01:42:09,947 - EarlyStopping counter: 6 out of 10
2025-03-03 01:42:37,203 - {'epoch': 67, 'rec_loss': '7.3426'}
2025-03-03 01:42:45,084 - {'Epoch': 67, 'HR@5': '0.0787', 'NDCG@5': '0.0547', 'HR@10': '0.1123', 'NDCG@10': '0.0655', 'HR@20': '0.1543', 'NDCG@20': '0.0761'}
2025-03-03 01:42:45,085 - EarlyStopping counter: 7 out of 10
2025-03-03 01:43:13,913 - {'epoch': 68, 'rec_loss': '7.3474'}
2025-03-03 01:43:22,460 - {'Epoch': 68, 'HR@5': '0.0804', 'NDCG@5': '0.0564', 'HR@10': '0.1140', 'NDCG@10': '0.0672', 'HR@20': '0.1562', 'NDCG@20': '0.0778'}
2025-03-03 01:43:22,461 - Validation score increased.  Saving model ...
2025-03-03 01:43:53,169 - {'epoch': 69, 'rec_loss': '7.3384'}
2025-03-03 01:44:01,564 - {'Epoch': 69, 'HR@5': '0.0804', 'NDCG@5': '0.0555', 'HR@10': '0.1130', 'NDCG@10': '0.0661', 'HR@20': '0.1548', 'NDCG@20': '0.0766'}
2025-03-03 01:44:01,565 - EarlyStopping counter: 1 out of 10
2025-03-03 01:44:29,872 - {'epoch': 70, 'rec_loss': '7.3414'}
2025-03-03 01:44:37,846 - {'Epoch': 70, 'HR@5': '0.0789', 'NDCG@5': '0.0553', 'HR@10': '0.1122', 'NDCG@10': '0.0660', 'HR@20': '0.1544', 'NDCG@20': '0.0767'}
2025-03-03 01:44:37,847 - EarlyStopping counter: 2 out of 10
2025-03-03 01:45:06,094 - {'epoch': 71, 'rec_loss': '7.3402'}
2025-03-03 01:45:13,994 - {'Epoch': 71, 'HR@5': '0.0800', 'NDCG@5': '0.0558', 'HR@10': '0.1127', 'NDCG@10': '0.0663', 'HR@20': '0.1548', 'NDCG@20': '0.0770'}
2025-03-03 01:45:13,998 - EarlyStopping counter: 3 out of 10
2025-03-03 01:45:43,151 - {'epoch': 72, 'rec_loss': '7.3391'}
2025-03-03 01:45:51,743 - {'Epoch': 72, 'HR@5': '0.0809', 'NDCG@5': '0.0570', 'HR@10': '0.1147', 'NDCG@10': '0.0679', 'HR@20': '0.1555', 'NDCG@20': '0.0782'}
2025-03-03 01:45:51,745 - Validation score increased.  Saving model ...
2025-03-03 01:46:19,800 - {'epoch': 73, 'rec_loss': '7.3278'}
2025-03-03 01:46:27,637 - {'Epoch': 73, 'HR@5': '0.0806', 'NDCG@5': '0.0556', 'HR@10': '0.1146', 'NDCG@10': '0.0666', 'HR@20': '0.1562', 'NDCG@20': '0.0771'}
2025-03-03 01:46:27,638 - EarlyStopping counter: 1 out of 10
2025-03-03 01:46:56,062 - {'epoch': 74, 'rec_loss': '7.3268'}
2025-03-03 01:47:03,985 - {'Epoch': 74, 'HR@5': '0.0804', 'NDCG@5': '0.0561', 'HR@10': '0.1141', 'NDCG@10': '0.0669', 'HR@20': '0.1563', 'NDCG@20': '0.0776'}
2025-03-03 01:47:03,986 - EarlyStopping counter: 2 out of 10
2025-03-03 01:47:33,485 - {'epoch': 75, 'rec_loss': '7.3284'}
2025-03-03 01:47:41,362 - {'Epoch': 75, 'HR@5': '0.0807', 'NDCG@5': '0.0559', 'HR@10': '0.1130', 'NDCG@10': '0.0664', 'HR@20': '0.1556', 'NDCG@20': '0.0771'}
2025-03-03 01:47:41,363 - EarlyStopping counter: 3 out of 10
2025-03-03 01:48:09,472 - {'epoch': 76, 'rec_loss': '7.3138'}
2025-03-03 01:48:17,588 - {'Epoch': 76, 'HR@5': '0.0804', 'NDCG@5': '0.0563', 'HR@10': '0.1143', 'NDCG@10': '0.0672', 'HR@20': '0.1543', 'NDCG@20': '0.0773'}
2025-03-03 01:48:17,593 - EarlyStopping counter: 4 out of 10
2025-03-03 01:48:45,727 - {'epoch': 77, 'rec_loss': '7.3310'}
2025-03-03 01:48:53,725 - {'Epoch': 77, 'HR@5': '0.0809', 'NDCG@5': '0.0562', 'HR@10': '0.1135', 'NDCG@10': '0.0668', 'HR@20': '0.1560', 'NDCG@20': '0.0774'}
2025-03-03 01:48:53,729 - EarlyStopping counter: 5 out of 10
2025-03-03 01:49:22,055 - {'epoch': 78, 'rec_loss': '7.3133'}
2025-03-03 01:49:30,119 - {'Epoch': 78, 'HR@5': '0.0806', 'NDCG@5': '0.0563', 'HR@10': '0.1138', 'NDCG@10': '0.0671', 'HR@20': '0.1561', 'NDCG@20': '0.0777'}
2025-03-03 01:49:30,120 - EarlyStopping counter: 6 out of 10
2025-03-03 01:50:00,459 - {'epoch': 79, 'rec_loss': '7.3212'}
2025-03-03 01:50:08,429 - {'Epoch': 79, 'HR@5': '0.0820', 'NDCG@5': '0.0567', 'HR@10': '0.1144', 'NDCG@10': '0.0671', 'HR@20': '0.1565', 'NDCG@20': '0.0777'}
2025-03-03 01:50:08,433 - EarlyStopping counter: 7 out of 10
2025-03-03 01:50:36,557 - {'epoch': 80, 'rec_loss': '7.3275'}
2025-03-03 01:50:44,470 - {'Epoch': 80, 'HR@5': '0.0806', 'NDCG@5': '0.0563', 'HR@10': '0.1135', 'NDCG@10': '0.0669', 'HR@20': '0.1561', 'NDCG@20': '0.0776'}
2025-03-03 01:50:44,471 - EarlyStopping counter: 8 out of 10
2025-03-03 01:51:12,641 - {'epoch': 81, 'rec_loss': '7.3207'}
2025-03-03 01:51:21,066 - {'Epoch': 81, 'HR@5': '0.0806', 'NDCG@5': '0.0571', 'HR@10': '0.1136', 'NDCG@10': '0.0677', 'HR@20': '0.1577', 'NDCG@20': '0.0788'}
2025-03-03 01:51:21,067 - Validation score increased.  Saving model ...
2025-03-03 01:51:49,549 - {'epoch': 82, 'rec_loss': '7.3230'}
2025-03-03 01:51:57,301 - {'Epoch': 82, 'HR@5': '0.0815', 'NDCG@5': '0.0565', 'HR@10': '0.1137', 'NDCG@10': '0.0668', 'HR@20': '0.1556', 'NDCG@20': '0.0774'}
2025-03-03 01:51:57,302 - EarlyStopping counter: 1 out of 10
2025-03-03 01:52:25,937 - {'epoch': 83, 'rec_loss': '7.3055'}
2025-03-03 01:52:34,128 - {'Epoch': 83, 'HR@5': '0.0809', 'NDCG@5': '0.0563', 'HR@10': '0.1154', 'NDCG@10': '0.0674', 'HR@20': '0.1562', 'NDCG@20': '0.0776'}
2025-03-03 01:52:34,132 - EarlyStopping counter: 2 out of 10
2025-03-03 01:53:02,661 - {'epoch': 84, 'rec_loss': '7.3058'}
2025-03-03 01:53:11,318 - {'Epoch': 84, 'HR@5': '0.0814', 'NDCG@5': '0.0573', 'HR@10': '0.1147', 'NDCG@10': '0.0680', 'HR@20': '0.1561', 'NDCG@20': '0.0784'}
2025-03-03 01:53:11,319 - EarlyStopping counter: 3 out of 10
2025-03-03 01:53:39,458 - {'epoch': 85, 'rec_loss': '7.3077'}
2025-03-03 01:53:47,381 - {'Epoch': 85, 'HR@5': '0.0804', 'NDCG@5': '0.0562', 'HR@10': '0.1126', 'NDCG@10': '0.0666', 'HR@20': '0.1555', 'NDCG@20': '0.0774'}
2025-03-03 01:53:47,382 - EarlyStopping counter: 4 out of 10
2025-03-03 01:54:15,530 - {'epoch': 86, 'rec_loss': '7.3093'}
2025-03-03 01:54:23,377 - {'Epoch': 86, 'HR@5': '0.0819', 'NDCG@5': '0.0566', 'HR@10': '0.1141', 'NDCG@10': '0.0670', 'HR@20': '0.1549', 'NDCG@20': '0.0773'}
2025-03-03 01:54:23,378 - EarlyStopping counter: 5 out of 10
2025-03-03 01:54:51,064 - {'epoch': 87, 'rec_loss': '7.3055'}
2025-03-03 01:54:59,128 - {'Epoch': 87, 'HR@5': '0.0812', 'NDCG@5': '0.0570', 'HR@10': '0.1150', 'NDCG@10': '0.0679', 'HR@20': '0.1560', 'NDCG@20': '0.0782'}
2025-03-03 01:54:59,129 - EarlyStopping counter: 6 out of 10
2025-03-03 01:55:25,866 - {'epoch': 88, 'rec_loss': '7.3041'}
2025-03-03 01:55:34,097 - {'Epoch': 88, 'HR@5': '0.0822', 'NDCG@5': '0.0582', 'HR@10': '0.1138', 'NDCG@10': '0.0684', 'HR@20': '0.1560', 'NDCG@20': '0.0790'}
2025-03-03 01:55:34,098 - Validation score increased.  Saving model ...
2025-03-03 01:56:03,550 - {'epoch': 89, 'rec_loss': '7.3010'}
2025-03-03 01:56:11,700 - {'Epoch': 89, 'HR@5': '0.0815', 'NDCG@5': '0.0567', 'HR@10': '0.1148', 'NDCG@10': '0.0675', 'HR@20': '0.1578', 'NDCG@20': '0.0783'}
2025-03-03 01:56:11,701 - EarlyStopping counter: 1 out of 10
2025-03-03 01:56:40,271 - {'epoch': 90, 'rec_loss': '7.3016'}
2025-03-03 01:56:48,317 - {'Epoch': 90, 'HR@5': '0.0818', 'NDCG@5': '0.0574', 'HR@10': '0.1138', 'NDCG@10': '0.0677', 'HR@20': '0.1571', 'NDCG@20': '0.0786'}
2025-03-03 01:56:48,318 - EarlyStopping counter: 2 out of 10
2025-03-03 01:57:16,549 - {'epoch': 91, 'rec_loss': '7.3006'}
2025-03-03 01:57:24,656 - {'Epoch': 91, 'HR@5': '0.0824', 'NDCG@5': '0.0580', 'HR@10': '0.1144', 'NDCG@10': '0.0683', 'HR@20': '0.1558', 'NDCG@20': '0.0787'}
2025-03-03 01:57:24,657 - EarlyStopping counter: 3 out of 10
2025-03-03 01:57:52,670 - {'epoch': 92, 'rec_loss': '7.3019'}
2025-03-03 01:58:00,988 - {'Epoch': 92, 'HR@5': '0.0826', 'NDCG@5': '0.0573', 'HR@10': '0.1143', 'NDCG@10': '0.0675', 'HR@20': '0.1571', 'NDCG@20': '0.0782'}
2025-03-03 01:58:00,989 - EarlyStopping counter: 4 out of 10
2025-03-03 01:58:30,576 - {'epoch': 93, 'rec_loss': '7.2899'}
2025-03-03 01:58:38,605 - {'Epoch': 93, 'HR@5': '0.0811', 'NDCG@5': '0.0570', 'HR@10': '0.1139', 'NDCG@10': '0.0676', 'HR@20': '0.1550', 'NDCG@20': '0.0779'}
2025-03-03 01:58:38,606 - EarlyStopping counter: 5 out of 10
2025-03-03 01:59:06,850 - {'epoch': 94, 'rec_loss': '7.2968'}
2025-03-03 01:59:14,767 - {'Epoch': 94, 'HR@5': '0.0812', 'NDCG@5': '0.0568', 'HR@10': '0.1146', 'NDCG@10': '0.0676', 'HR@20': '0.1541', 'NDCG@20': '0.0775'}
2025-03-03 01:59:14,768 - EarlyStopping counter: 6 out of 10
2025-03-03 01:59:41,554 - {'epoch': 95, 'rec_loss': '7.2936'}
2025-03-03 01:59:49,549 - {'Epoch': 95, 'HR@5': '0.0820', 'NDCG@5': '0.0573', 'HR@10': '0.1148', 'NDCG@10': '0.0678', 'HR@20': '0.1569', 'NDCG@20': '0.0784'}
2025-03-03 01:59:49,550 - EarlyStopping counter: 7 out of 10
2025-03-03 02:00:17,740 - {'epoch': 96, 'rec_loss': '7.2897'}
2025-03-03 02:00:25,790 - {'Epoch': 96, 'HR@5': '0.0826', 'NDCG@5': '0.0579', 'HR@10': '0.1152', 'NDCG@10': '0.0684', 'HR@20': '0.1574', 'NDCG@20': '0.0790'}
2025-03-03 02:00:25,794 - EarlyStopping counter: 8 out of 10
2025-03-03 02:00:54,069 - {'epoch': 97, 'rec_loss': '7.2866'}
2025-03-03 02:01:01,974 - {'Epoch': 97, 'HR@5': '0.0831', 'NDCG@5': '0.0582', 'HR@10': '0.1154', 'NDCG@10': '0.0686', 'HR@20': '0.1574', 'NDCG@20': '0.0791'}
2025-03-03 02:01:01,976 - Validation score increased.  Saving model ...
2025-03-03 02:01:30,129 - {'epoch': 98, 'rec_loss': '7.2838'}
2025-03-03 02:01:38,123 - {'Epoch': 98, 'HR@5': '0.0814', 'NDCG@5': '0.0572', 'HR@10': '0.1148', 'NDCG@10': '0.0679', 'HR@20': '0.1563', 'NDCG@20': '0.0784'}
2025-03-03 02:01:38,128 - EarlyStopping counter: 1 out of 10
2025-03-03 02:02:06,530 - {'epoch': 99, 'rec_loss': '7.2919'}
2025-03-03 02:02:14,628 - {'Epoch': 99, 'HR@5': '0.0824', 'NDCG@5': '0.0579', 'HR@10': '0.1152', 'NDCG@10': '0.0685', 'HR@20': '0.1574', 'NDCG@20': '0.0791'}
2025-03-03 02:02:14,629 - EarlyStopping counter: 2 out of 10
2025-03-03 02:02:42,513 - {'epoch': 100, 'rec_loss': '7.2760'}
2025-03-03 02:02:50,995 - {'Epoch': 100, 'HR@5': '0.0826', 'NDCG@5': '0.0580', 'HR@10': '0.1141', 'NDCG@10': '0.0682', 'HR@20': '0.1562', 'NDCG@20': '0.0788'}
2025-03-03 02:02:50,996 - EarlyStopping counter: 3 out of 10
2025-03-03 02:03:19,375 - {'epoch': 101, 'rec_loss': '7.2801'}
2025-03-03 02:03:27,548 - {'Epoch': 101, 'HR@5': '0.0831', 'NDCG@5': '0.0582', 'HR@10': '0.1146', 'NDCG@10': '0.0683', 'HR@20': '0.1582', 'NDCG@20': '0.0792'}
2025-03-03 02:03:27,549 - Validation score increased.  Saving model ...
2025-03-03 02:03:55,042 - {'epoch': 102, 'rec_loss': '7.2734'}
2025-03-03 02:04:03,008 - {'Epoch': 102, 'HR@5': '0.0818', 'NDCG@5': '0.0578', 'HR@10': '0.1144', 'NDCG@10': '0.0682', 'HR@20': '0.1566', 'NDCG@20': '0.0788'}
2025-03-03 02:04:03,009 - EarlyStopping counter: 1 out of 10
2025-03-03 02:04:31,473 - {'epoch': 103, 'rec_loss': '7.2705'}
2025-03-03 02:04:39,364 - {'Epoch': 103, 'HR@5': '0.0826', 'NDCG@5': '0.0577', 'HR@10': '0.1160', 'NDCG@10': '0.0685', 'HR@20': '0.1575', 'NDCG@20': '0.0789'}
2025-03-03 02:04:39,365 - EarlyStopping counter: 2 out of 10
2025-03-03 02:05:07,835 - {'epoch': 104, 'rec_loss': '7.2881'}
2025-03-03 02:05:15,765 - {'Epoch': 104, 'HR@5': '0.0817', 'NDCG@5': '0.0567', 'HR@10': '0.1134', 'NDCG@10': '0.0668', 'HR@20': '0.1537', 'NDCG@20': '0.0770'}
2025-03-03 02:05:15,766 - EarlyStopping counter: 3 out of 10
2025-03-03 02:05:43,587 - {'epoch': 105, 'rec_loss': '7.2916'}
2025-03-03 02:05:51,740 - {'Epoch': 105, 'HR@5': '0.0821', 'NDCG@5': '0.0579', 'HR@10': '0.1147', 'NDCG@10': '0.0685', 'HR@20': '0.1568', 'NDCG@20': '0.0791'}
2025-03-03 02:05:51,747 - EarlyStopping counter: 4 out of 10
2025-03-03 02:06:21,023 - {'epoch': 106, 'rec_loss': '7.2743'}
2025-03-03 02:06:29,471 - {'Epoch': 106, 'HR@5': '0.0816', 'NDCG@5': '0.0578', 'HR@10': '0.1142', 'NDCG@10': '0.0684', 'HR@20': '0.1562', 'NDCG@20': '0.0790'}
2025-03-03 02:06:29,473 - EarlyStopping counter: 5 out of 10
2025-03-03 02:06:56,956 - {'epoch': 107, 'rec_loss': '7.2779'}
2025-03-03 02:07:04,947 - {'Epoch': 107, 'HR@5': '0.0822', 'NDCG@5': '0.0574', 'HR@10': '0.1138', 'NDCG@10': '0.0676', 'HR@20': '0.1557', 'NDCG@20': '0.0782'}
2025-03-03 02:07:04,949 - EarlyStopping counter: 6 out of 10
2025-03-03 02:07:33,227 - {'epoch': 108, 'rec_loss': '7.2716'}
2025-03-03 02:07:41,129 - {'Epoch': 108, 'HR@5': '0.0825', 'NDCG@5': '0.0579', 'HR@10': '0.1146', 'NDCG@10': '0.0682', 'HR@20': '0.1575', 'NDCG@20': '0.0789'}
2025-03-03 02:07:41,130 - EarlyStopping counter: 7 out of 10
2025-03-03 02:08:09,790 - {'epoch': 109, 'rec_loss': '7.2669'}
2025-03-03 02:08:17,967 - {'Epoch': 109, 'HR@5': '0.0830', 'NDCG@5': '0.0580', 'HR@10': '0.1147', 'NDCG@10': '0.0682', 'HR@20': '0.1564', 'NDCG@20': '0.0787'}
2025-03-03 02:08:17,968 - EarlyStopping counter: 8 out of 10
2025-03-03 02:08:46,380 - {'epoch': 110, 'rec_loss': '7.2739'}
2025-03-03 02:08:54,243 - {'Epoch': 110, 'HR@5': '0.0818', 'NDCG@5': '0.0565', 'HR@10': '0.1149', 'NDCG@10': '0.0671', 'HR@20': '0.1553', 'NDCG@20': '0.0773'}
2025-03-03 02:08:54,244 - EarlyStopping counter: 9 out of 10
2025-03-03 02:09:22,148 - {'epoch': 111, 'rec_loss': '7.2688'}
2025-03-03 02:09:30,311 - {'Epoch': 111, 'HR@5': '0.0819', 'NDCG@5': '0.0573', 'HR@10': '0.1143', 'NDCG@10': '0.0678', 'HR@20': '0.1557', 'NDCG@20': '0.0782'}
2025-03-03 02:09:30,313 - EarlyStopping counter: 10 out of 10
2025-03-03 02:09:30,313 - Early stopping
2025-03-03 02:09:30,313 - ---------------Test Score---------------
2025-03-03 02:09:38,341 - {'Epoch': 0, 'HR@5': '0.0631', 'NDCG@5': '0.0442', 'HR@10': '0.0918', 'NDCG@10': '0.0535', 'HR@20': '0.1287', 'NDCG@20': '0.0628'}
2025-03-03 02:09:38,342 - Scale_Beauty
2025-03-03 02:09:38,342 - {'Epoch': 0, 'HR@5': '0.0631', 'NDCG@5': '0.0442', 'HR@10': '0.0918', 'NDCG@10': '0.0535', 'HR@20': '0.1287', 'NDCG@20': '0.0628'}
2025-03-04 10:48:49,711 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 10], kernels=[8, 12, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-04 10:48:52,555 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-04 10:48:52,560 - Total Parameters: 928470
2025-03-04 10:49:23,649 - {'epoch': 0, 'rec_loss': '8.8319'}
2025-03-04 10:49:31,325 - {'Epoch': 0, 'HR@5': '0.0194', 'NDCG@5': '0.0123', 'HR@10': '0.0307', 'NDCG@10': '0.0160', 'HR@20': '0.0466', 'NDCG@20': '0.0200'}
2025-03-04 10:49:31,326 - Validation score increased.  Saving model ...
2025-03-04 10:49:59,453 - {'epoch': 1, 'rec_loss': '8.3174'}
2025-03-04 10:50:07,414 - {'Epoch': 1, 'HR@5': '0.0356', 'NDCG@5': '0.0232', 'HR@10': '0.0558', 'NDCG@10': '0.0297', 'HR@20': '0.0800', 'NDCG@20': '0.0358'}
2025-03-04 10:50:07,419 - Validation score increased.  Saving model ...
2025-03-04 10:50:35,598 - {'epoch': 2, 'rec_loss': '8.0070'}
2025-03-04 10:50:43,519 - {'Epoch': 2, 'HR@5': '0.0516', 'NDCG@5': '0.0346', 'HR@10': '0.0760', 'NDCG@10': '0.0425', 'HR@20': '0.1064', 'NDCG@20': '0.0501'}
2025-03-04 10:50:43,520 - Validation score increased.  Saving model ...
2025-03-04 10:51:13,264 - {'epoch': 3, 'rec_loss': '7.7909'}
2025-03-04 10:51:20,976 - {'Epoch': 3, 'HR@5': '0.0622', 'NDCG@5': '0.0428', 'HR@10': '0.0890', 'NDCG@10': '0.0513', 'HR@20': '0.1245', 'NDCG@20': '0.0603'}
2025-03-04 10:51:20,977 - Validation score increased.  Saving model ...
2025-03-04 10:51:47,983 - {'epoch': 4, 'rec_loss': '7.6390'}
2025-03-04 10:51:55,700 - {'Epoch': 4, 'HR@5': '0.0697', 'NDCG@5': '0.0488', 'HR@10': '0.0965', 'NDCG@10': '0.0574', 'HR@20': '0.1334', 'NDCG@20': '0.0667'}
2025-03-04 10:51:55,701 - Validation score increased.  Saving model ...
2025-03-04 10:52:23,397 - {'epoch': 5, 'rec_loss': '7.5177'}
2025-03-04 10:52:31,125 - {'Epoch': 5, 'HR@5': '0.0741', 'NDCG@5': '0.0516', 'HR@10': '0.1036', 'NDCG@10': '0.0611', 'HR@20': '0.1408', 'NDCG@20': '0.0704'}
2025-03-04 10:52:31,127 - Validation score increased.  Saving model ...
2025-03-04 10:52:59,314 - {'epoch': 6, 'rec_loss': '7.4228'}
2025-03-04 10:53:07,076 - {'Epoch': 6, 'HR@5': '0.0755', 'NDCG@5': '0.0533', 'HR@10': '0.1066', 'NDCG@10': '0.0633', 'HR@20': '0.1455', 'NDCG@20': '0.0731'}
2025-03-04 10:53:07,077 - Validation score increased.  Saving model ...
2025-03-04 10:53:33,644 - {'epoch': 7, 'rec_loss': '7.3434'}
2025-03-04 10:53:41,213 - {'Epoch': 7, 'HR@5': '0.0807', 'NDCG@5': '0.0570', 'HR@10': '0.1107', 'NDCG@10': '0.0667', 'HR@20': '0.1507', 'NDCG@20': '0.0767'}
2025-03-04 10:53:41,217 - Validation score increased.  Saving model ...
2025-03-04 10:54:07,842 - {'epoch': 8, 'rec_loss': '7.2785'}
2025-03-04 10:54:15,533 - {'Epoch': 8, 'HR@5': '0.0814', 'NDCG@5': '0.0573', 'HR@10': '0.1112', 'NDCG@10': '0.0668', 'HR@20': '0.1519', 'NDCG@20': '0.0771'}
2025-03-04 10:54:15,538 - Validation score increased.  Saving model ...
2025-03-04 10:54:43,542 - {'epoch': 9, 'rec_loss': '7.2299'}
2025-03-04 10:54:51,131 - {'Epoch': 9, 'HR@5': '0.0817', 'NDCG@5': '0.0584', 'HR@10': '0.1126', 'NDCG@10': '0.0684', 'HR@20': '0.1537', 'NDCG@20': '0.0788'}
2025-03-04 10:54:51,132 - Validation score increased.  Saving model ...
2025-03-04 10:55:17,703 - {'epoch': 10, 'rec_loss': '7.1821'}
2025-03-04 10:55:25,157 - {'Epoch': 10, 'HR@5': '0.0832', 'NDCG@5': '0.0590', 'HR@10': '0.1126', 'NDCG@10': '0.0684', 'HR@20': '0.1540', 'NDCG@20': '0.0789'}
2025-03-04 10:55:25,161 - Validation score increased.  Saving model ...
2025-03-04 10:55:52,978 - {'epoch': 11, 'rec_loss': '7.1447'}
2025-03-04 10:56:00,727 - {'Epoch': 11, 'HR@5': '0.0831', 'NDCG@5': '0.0590', 'HR@10': '0.1139', 'NDCG@10': '0.0689', 'HR@20': '0.1562', 'NDCG@20': '0.0796'}
2025-03-04 10:56:00,728 - Validation score increased.  Saving model ...
2025-03-04 10:56:28,870 - {'epoch': 12, 'rec_loss': '7.1093'}
2025-03-04 10:56:36,429 - {'Epoch': 12, 'HR@5': '0.0840', 'NDCG@5': '0.0593', 'HR@10': '0.1161', 'NDCG@10': '0.0697', 'HR@20': '0.1577', 'NDCG@20': '0.0801'}
2025-03-04 10:56:36,430 - Validation score increased.  Saving model ...
2025-03-04 10:57:04,658 - {'epoch': 13, 'rec_loss': '7.0817'}
2025-03-04 10:57:12,510 - {'Epoch': 13, 'HR@5': '0.0858', 'NDCG@5': '0.0602', 'HR@10': '0.1157', 'NDCG@10': '0.0699', 'HR@20': '0.1591', 'NDCG@20': '0.0808'}
2025-03-04 10:57:12,515 - Validation score increased.  Saving model ...
2025-03-04 10:57:40,372 - {'epoch': 14, 'rec_loss': '7.0512'}
2025-03-04 10:57:47,975 - {'Epoch': 14, 'HR@5': '0.0844', 'NDCG@5': '0.0598', 'HR@10': '0.1154', 'NDCG@10': '0.0698', 'HR@20': '0.1591', 'NDCG@20': '0.0808'}
2025-03-04 10:57:47,976 - Validation score increased.  Saving model ...
2025-03-04 10:58:15,835 - {'epoch': 15, 'rec_loss': '7.0333'}
2025-03-04 10:58:23,451 - {'Epoch': 15, 'HR@5': '0.0828', 'NDCG@5': '0.0586', 'HR@10': '0.1168', 'NDCG@10': '0.0696', 'HR@20': '0.1605', 'NDCG@20': '0.0807'}
2025-03-04 10:58:23,452 - EarlyStopping counter: 1 out of 10
2025-03-04 10:58:50,995 - {'epoch': 16, 'rec_loss': '7.0093'}
2025-03-04 10:58:58,661 - {'Epoch': 16, 'HR@5': '0.0846', 'NDCG@5': '0.0599', 'HR@10': '0.1168', 'NDCG@10': '0.0702', 'HR@20': '0.1616', 'NDCG@20': '0.0815'}
2025-03-04 10:58:58,662 - Validation score increased.  Saving model ...
2025-03-04 10:59:28,877 - {'epoch': 17, 'rec_loss': '6.9914'}
2025-03-04 10:59:36,556 - {'Epoch': 17, 'HR@5': '0.0863', 'NDCG@5': '0.0611', 'HR@10': '0.1196', 'NDCG@10': '0.0718', 'HR@20': '0.1605', 'NDCG@20': '0.0821'}
2025-03-04 10:59:36,557 - Validation score increased.  Saving model ...
2025-03-04 11:00:03,659 - {'epoch': 18, 'rec_loss': '6.9627'}
2025-03-04 11:00:11,314 - {'Epoch': 18, 'HR@5': '0.0858', 'NDCG@5': '0.0602', 'HR@10': '0.1180', 'NDCG@10': '0.0706', 'HR@20': '0.1619', 'NDCG@20': '0.0817'}
2025-03-04 11:00:11,319 - EarlyStopping counter: 1 out of 10
2025-03-04 11:00:38,775 - {'epoch': 19, 'rec_loss': '6.9486'}
2025-03-04 11:00:46,845 - {'Epoch': 19, 'HR@5': '0.0865', 'NDCG@5': '0.0605', 'HR@10': '0.1203', 'NDCG@10': '0.0714', 'HR@20': '0.1631', 'NDCG@20': '0.0821'}
2025-03-04 11:00:46,846 - EarlyStopping counter: 2 out of 10
2025-03-04 11:01:15,248 - {'epoch': 20, 'rec_loss': '6.9393'}
2025-03-04 11:01:22,865 - {'Epoch': 20, 'HR@5': '0.0876', 'NDCG@5': '0.0617', 'HR@10': '0.1195', 'NDCG@10': '0.0720', 'HR@20': '0.1613', 'NDCG@20': '0.0826'}
2025-03-04 11:01:22,866 - Validation score increased.  Saving model ...
2025-03-04 11:01:49,877 - {'epoch': 21, 'rec_loss': '6.9170'}
2025-03-04 11:01:57,635 - {'Epoch': 21, 'HR@5': '0.0871', 'NDCG@5': '0.0610', 'HR@10': '0.1198', 'NDCG@10': '0.0716', 'HR@20': '0.1638', 'NDCG@20': '0.0826'}
2025-03-04 11:01:57,636 - Validation score increased.  Saving model ...
2025-03-04 11:02:26,111 - {'epoch': 22, 'rec_loss': '6.9067'}
2025-03-04 11:02:33,873 - {'Epoch': 22, 'HR@5': '0.0886', 'NDCG@5': '0.0621', 'HR@10': '0.1206', 'NDCG@10': '0.0724', 'HR@20': '0.1631', 'NDCG@20': '0.0831'}
2025-03-04 11:02:33,875 - Validation score increased.  Saving model ...
2025-03-04 11:03:02,505 - {'epoch': 23, 'rec_loss': '6.8952'}
2025-03-04 11:03:10,211 - {'Epoch': 23, 'HR@5': '0.0889', 'NDCG@5': '0.0623', 'HR@10': '0.1215', 'NDCG@10': '0.0728', 'HR@20': '0.1640', 'NDCG@20': '0.0835'}
2025-03-04 11:03:10,212 - Validation score increased.  Saving model ...
2025-03-04 11:03:40,092 - {'epoch': 24, 'rec_loss': '6.8805'}
2025-03-04 11:03:48,158 - {'Epoch': 24, 'HR@5': '0.0874', 'NDCG@5': '0.0615', 'HR@10': '0.1201', 'NDCG@10': '0.0721', 'HR@20': '0.1632', 'NDCG@20': '0.0829'}
2025-03-04 11:03:48,159 - EarlyStopping counter: 1 out of 10
2025-03-04 11:04:18,359 - {'epoch': 25, 'rec_loss': '6.8648'}
2025-03-04 11:04:26,156 - {'Epoch': 25, 'HR@5': '0.0868', 'NDCG@5': '0.0614', 'HR@10': '0.1206', 'NDCG@10': '0.0723', 'HR@20': '0.1647', 'NDCG@20': '0.0834'}
2025-03-04 11:04:26,157 - EarlyStopping counter: 2 out of 10
2025-03-04 11:04:53,519 - {'epoch': 26, 'rec_loss': '6.8595'}
2025-03-04 11:05:01,358 - {'Epoch': 26, 'HR@5': '0.0866', 'NDCG@5': '0.0614', 'HR@10': '0.1204', 'NDCG@10': '0.0722', 'HR@20': '0.1634', 'NDCG@20': '0.0831'}
2025-03-04 11:05:01,359 - EarlyStopping counter: 3 out of 10
2025-03-04 11:05:29,952 - {'epoch': 27, 'rec_loss': '6.8506'}
2025-03-04 11:05:37,648 - {'Epoch': 27, 'HR@5': '0.0874', 'NDCG@5': '0.0622', 'HR@10': '0.1225', 'NDCG@10': '0.0735', 'HR@20': '0.1663', 'NDCG@20': '0.0845'}
2025-03-04 11:05:37,649 - Validation score increased.  Saving model ...
2025-03-04 11:06:07,186 - {'epoch': 28, 'rec_loss': '6.8359'}
2025-03-04 11:06:15,106 - {'Epoch': 28, 'HR@5': '0.0881', 'NDCG@5': '0.0619', 'HR@10': '0.1221', 'NDCG@10': '0.0728', 'HR@20': '0.1642', 'NDCG@20': '0.0834'}
2025-03-04 11:06:15,110 - EarlyStopping counter: 1 out of 10
2025-03-04 11:06:41,614 - {'epoch': 29, 'rec_loss': '6.8312'}
2025-03-04 11:06:49,218 - {'Epoch': 29, 'HR@5': '0.0872', 'NDCG@5': '0.0617', 'HR@10': '0.1216', 'NDCG@10': '0.0728', 'HR@20': '0.1656', 'NDCG@20': '0.0839'}
2025-03-04 11:06:49,219 - EarlyStopping counter: 2 out of 10
2025-03-04 11:07:16,202 - {'epoch': 30, 'rec_loss': '6.8181'}
2025-03-04 11:07:23,895 - {'Epoch': 30, 'HR@5': '0.0884', 'NDCG@5': '0.0623', 'HR@10': '0.1227', 'NDCG@10': '0.0735', 'HR@20': '0.1667', 'NDCG@20': '0.0845'}
2025-03-04 11:07:23,896 - EarlyStopping counter: 3 out of 10
2025-03-04 11:07:51,942 - {'epoch': 31, 'rec_loss': '6.8112'}
2025-03-04 11:07:59,618 - {'Epoch': 31, 'HR@5': '0.0870', 'NDCG@5': '0.0615', 'HR@10': '0.1216', 'NDCG@10': '0.0726', 'HR@20': '0.1627', 'NDCG@20': '0.0830'}
2025-03-04 11:07:59,619 - EarlyStopping counter: 4 out of 10
2025-03-04 11:08:27,877 - {'epoch': 32, 'rec_loss': '6.8006'}
2025-03-04 11:08:35,728 - {'Epoch': 32, 'HR@5': '0.0877', 'NDCG@5': '0.0616', 'HR@10': '0.1220', 'NDCG@10': '0.0727', 'HR@20': '0.1652', 'NDCG@20': '0.0836'}
2025-03-04 11:08:35,729 - EarlyStopping counter: 5 out of 10
2025-03-04 11:09:03,620 - {'epoch': 33, 'rec_loss': '6.7974'}
2025-03-04 11:09:11,653 - {'Epoch': 33, 'HR@5': '0.0876', 'NDCG@5': '0.0617', 'HR@10': '0.1235', 'NDCG@10': '0.0733', 'HR@20': '0.1660', 'NDCG@20': '0.0840'}
2025-03-04 11:09:11,655 - EarlyStopping counter: 6 out of 10
2025-03-04 11:09:41,927 - {'epoch': 34, 'rec_loss': '6.7828'}
2025-03-04 11:09:49,993 - {'Epoch': 34, 'HR@5': '0.0896', 'NDCG@5': '0.0626', 'HR@10': '0.1227', 'NDCG@10': '0.0733', 'HR@20': '0.1658', 'NDCG@20': '0.0842'}
2025-03-04 11:09:49,995 - EarlyStopping counter: 7 out of 10
2025-03-04 11:10:18,093 - {'epoch': 35, 'rec_loss': '6.7827'}
2025-03-04 11:10:25,895 - {'Epoch': 35, 'HR@5': '0.0879', 'NDCG@5': '0.0616', 'HR@10': '0.1206', 'NDCG@10': '0.0721', 'HR@20': '0.1649', 'NDCG@20': '0.0833'}
2025-03-04 11:10:25,900 - EarlyStopping counter: 8 out of 10
2025-03-04 11:10:53,128 - {'epoch': 36, 'rec_loss': '6.7735'}
2025-03-04 11:11:00,875 - {'Epoch': 36, 'HR@5': '0.0885', 'NDCG@5': '0.0621', 'HR@10': '0.1217', 'NDCG@10': '0.0728', 'HR@20': '0.1657', 'NDCG@20': '0.0839'}
2025-03-04 11:11:00,876 - EarlyStopping counter: 9 out of 10
2025-03-04 11:11:29,220 - {'epoch': 37, 'rec_loss': '6.7686'}
2025-03-04 11:11:37,190 - {'Epoch': 37, 'HR@5': '0.0881', 'NDCG@5': '0.0622', 'HR@10': '0.1237', 'NDCG@10': '0.0737', 'HR@20': '0.1672', 'NDCG@20': '0.0846'}
2025-03-04 11:11:37,191 - Validation score increased.  Saving model ...
2025-03-04 11:12:05,054 - {'epoch': 38, 'rec_loss': '6.7604'}
2025-03-04 11:12:12,928 - {'Epoch': 38, 'HR@5': '0.0880', 'NDCG@5': '0.0617', 'HR@10': '0.1236', 'NDCG@10': '0.0732', 'HR@20': '0.1669', 'NDCG@20': '0.0841'}
2025-03-04 11:12:12,932 - EarlyStopping counter: 1 out of 10
2025-03-04 11:12:41,213 - {'epoch': 39, 'rec_loss': '6.7518'}
2025-03-04 11:12:49,047 - {'Epoch': 39, 'HR@5': '0.0884', 'NDCG@5': '0.0627', 'HR@10': '0.1216', 'NDCG@10': '0.0734', 'HR@20': '0.1664', 'NDCG@20': '0.0847'}
2025-03-04 11:12:49,053 - Validation score increased.  Saving model ...
2025-03-04 11:13:17,344 - {'epoch': 40, 'rec_loss': '6.7456'}
2025-03-04 11:13:25,041 - {'Epoch': 40, 'HR@5': '0.0885', 'NDCG@5': '0.0626', 'HR@10': '0.1225', 'NDCG@10': '0.0735', 'HR@20': '0.1668', 'NDCG@20': '0.0847'}
2025-03-04 11:13:25,046 - EarlyStopping counter: 1 out of 10
2025-03-04 11:13:52,535 - {'epoch': 41, 'rec_loss': '6.7411'}
2025-03-04 11:14:00,495 - {'Epoch': 41, 'HR@5': '0.0880', 'NDCG@5': '0.0621', 'HR@10': '0.1227', 'NDCG@10': '0.0732', 'HR@20': '0.1648', 'NDCG@20': '0.0838'}
2025-03-04 11:14:00,500 - EarlyStopping counter: 2 out of 10
2025-03-04 11:14:27,217 - {'epoch': 42, 'rec_loss': '6.7354'}
2025-03-04 11:14:35,056 - {'Epoch': 42, 'HR@5': '0.0876', 'NDCG@5': '0.0620', 'HR@10': '0.1215', 'NDCG@10': '0.0729', 'HR@20': '0.1657', 'NDCG@20': '0.0840'}
2025-03-04 11:14:35,057 - EarlyStopping counter: 3 out of 10
2025-03-04 11:15:01,908 - {'epoch': 43, 'rec_loss': '6.7282'}
2025-03-04 11:15:09,673 - {'Epoch': 43, 'HR@5': '0.0872', 'NDCG@5': '0.0614', 'HR@10': '0.1217', 'NDCG@10': '0.0725', 'HR@20': '0.1658', 'NDCG@20': '0.0837'}
2025-03-04 11:15:09,674 - EarlyStopping counter: 4 out of 10
2025-03-04 11:15:37,398 - {'epoch': 44, 'rec_loss': '6.7276'}
2025-03-04 11:15:45,241 - {'Epoch': 44, 'HR@5': '0.0881', 'NDCG@5': '0.0627', 'HR@10': '0.1238', 'NDCG@10': '0.0741', 'HR@20': '0.1645', 'NDCG@20': '0.0844'}
2025-03-04 11:15:45,242 - EarlyStopping counter: 5 out of 10
2025-03-04 11:16:12,557 - {'epoch': 45, 'rec_loss': '6.7215'}
2025-03-04 11:16:20,352 - {'Epoch': 45, 'HR@5': '0.0897', 'NDCG@5': '0.0635', 'HR@10': '0.1224', 'NDCG@10': '0.0740', 'HR@20': '0.1664', 'NDCG@20': '0.0851'}
2025-03-04 11:16:20,353 - Validation score increased.  Saving model ...
2025-03-04 11:16:48,294 - {'epoch': 46, 'rec_loss': '6.7182'}
2025-03-04 11:16:56,117 - {'Epoch': 46, 'HR@5': '0.0885', 'NDCG@5': '0.0629', 'HR@10': '0.1213', 'NDCG@10': '0.0735', 'HR@20': '0.1678', 'NDCG@20': '0.0852'}
2025-03-04 11:16:56,119 - Validation score increased.  Saving model ...
2025-03-04 11:17:25,663 - {'epoch': 47, 'rec_loss': '6.7109'}
2025-03-04 11:17:33,559 - {'Epoch': 47, 'HR@5': '0.0888', 'NDCG@5': '0.0630', 'HR@10': '0.1236', 'NDCG@10': '0.0742', 'HR@20': '0.1662', 'NDCG@20': '0.0850'}
2025-03-04 11:17:33,564 - EarlyStopping counter: 1 out of 10
2025-03-04 11:18:05,112 - {'epoch': 48, 'rec_loss': '6.7028'}
2025-03-04 11:18:12,982 - {'Epoch': 48, 'HR@5': '0.0892', 'NDCG@5': '0.0630', 'HR@10': '0.1231', 'NDCG@10': '0.0739', 'HR@20': '0.1664', 'NDCG@20': '0.0848'}
2025-03-04 11:18:12,987 - EarlyStopping counter: 2 out of 10
2025-03-04 11:18:41,084 - {'epoch': 49, 'rec_loss': '6.6973'}
2025-03-04 11:18:48,989 - {'Epoch': 49, 'HR@5': '0.0888', 'NDCG@5': '0.0632', 'HR@10': '0.1240', 'NDCG@10': '0.0746', 'HR@20': '0.1668', 'NDCG@20': '0.0853'}
2025-03-04 11:18:48,990 - Validation score increased.  Saving model ...
2025-03-04 11:19:17,268 - {'epoch': 50, 'rec_loss': '6.7013'}
2025-03-04 11:19:25,123 - {'Epoch': 50, 'HR@5': '0.0887', 'NDCG@5': '0.0632', 'HR@10': '0.1238', 'NDCG@10': '0.0745', 'HR@20': '0.1659', 'NDCG@20': '0.0851'}
2025-03-04 11:19:25,124 - EarlyStopping counter: 1 out of 10
2025-03-04 11:19:53,545 - {'epoch': 51, 'rec_loss': '6.6947'}
2025-03-04 11:20:01,367 - {'Epoch': 51, 'HR@5': '0.0902', 'NDCG@5': '0.0637', 'HR@10': '0.1230', 'NDCG@10': '0.0742', 'HR@20': '0.1661', 'NDCG@20': '0.0850'}
2025-03-04 11:20:01,368 - EarlyStopping counter: 2 out of 10
2025-03-04 11:20:29,269 - {'epoch': 52, 'rec_loss': '6.6891'}
2025-03-04 11:20:37,279 - {'Epoch': 52, 'HR@5': '0.0892', 'NDCG@5': '0.0627', 'HR@10': '0.1226', 'NDCG@10': '0.0734', 'HR@20': '0.1665', 'NDCG@20': '0.0844'}
2025-03-04 11:20:37,280 - EarlyStopping counter: 3 out of 10
2025-03-04 11:21:05,547 - {'epoch': 53, 'rec_loss': '6.6829'}
2025-03-04 11:21:13,340 - {'Epoch': 53, 'HR@5': '0.0891', 'NDCG@5': '0.0630', 'HR@10': '0.1232', 'NDCG@10': '0.0740', 'HR@20': '0.1672', 'NDCG@20': '0.0851'}
2025-03-04 11:21:13,341 - EarlyStopping counter: 4 out of 10
2025-03-04 11:21:41,001 - {'epoch': 54, 'rec_loss': '6.6831'}
2025-03-04 11:21:48,799 - {'Epoch': 54, 'HR@5': '0.0900', 'NDCG@5': '0.0634', 'HR@10': '0.1237', 'NDCG@10': '0.0742', 'HR@20': '0.1663', 'NDCG@20': '0.0849'}
2025-03-04 11:21:48,801 - EarlyStopping counter: 5 out of 10
2025-03-04 11:22:16,355 - {'epoch': 55, 'rec_loss': '6.6817'}
2025-03-04 11:22:24,104 - {'Epoch': 55, 'HR@5': '0.0885', 'NDCG@5': '0.0628', 'HR@10': '0.1229', 'NDCG@10': '0.0739', 'HR@20': '0.1669', 'NDCG@20': '0.0850'}
2025-03-04 11:22:24,105 - EarlyStopping counter: 6 out of 10
2025-03-04 11:22:51,803 - {'epoch': 56, 'rec_loss': '6.6780'}
2025-03-04 11:22:59,643 - {'Epoch': 56, 'HR@5': '0.0898', 'NDCG@5': '0.0635', 'HR@10': '0.1243', 'NDCG@10': '0.0746', 'HR@20': '0.1667', 'NDCG@20': '0.0853'}
2025-03-04 11:22:59,644 - EarlyStopping counter: 7 out of 10
2025-03-04 11:23:27,226 - {'epoch': 57, 'rec_loss': '6.6732'}
2025-03-04 11:23:35,053 - {'Epoch': 57, 'HR@5': '0.0881', 'NDCG@5': '0.0627', 'HR@10': '0.1235', 'NDCG@10': '0.0742', 'HR@20': '0.1656', 'NDCG@20': '0.0848'}
2025-03-04 11:23:35,059 - EarlyStopping counter: 8 out of 10
2025-03-04 11:24:02,087 - {'epoch': 58, 'rec_loss': '6.6717'}
2025-03-04 11:24:09,929 - {'Epoch': 58, 'HR@5': '0.0897', 'NDCG@5': '0.0632', 'HR@10': '0.1225', 'NDCG@10': '0.0738', 'HR@20': '0.1669', 'NDCG@20': '0.0850'}
2025-03-04 11:24:09,930 - EarlyStopping counter: 9 out of 10
2025-03-04 11:24:37,672 - {'epoch': 59, 'rec_loss': '6.6624'}
2025-03-04 11:24:45,427 - {'Epoch': 59, 'HR@5': '0.0892', 'NDCG@5': '0.0634', 'HR@10': '0.1235', 'NDCG@10': '0.0744', 'HR@20': '0.1658', 'NDCG@20': '0.0851'}
2025-03-04 11:24:45,429 - EarlyStopping counter: 10 out of 10
2025-03-04 11:24:45,429 - Early stopping
2025-03-04 11:24:45,429 - ---------------Test Score---------------
2025-03-04 11:24:53,261 - {'Epoch': 0, 'HR@5': '0.0712', 'NDCG@5': '0.0499', 'HR@10': '0.1010', 'NDCG@10': '0.0595', 'HR@20': '0.1383', 'NDCG@20': '0.0689'}
2025-03-04 11:24:53,266 - Scale_Beauty
2025-03-04 11:24:53,266 - {'Epoch': 0, 'HR@5': '0.0712', 'NDCG@5': '0.0499', 'HR@10': '0.1010', 'NDCG@10': '0.0595', 'HR@20': '0.1383', 'NDCG@20': '0.0689'}
2025-03-04 11:30:37,915 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 5], kernels=[8, 12, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-04 11:30:40,738 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-04 11:30:40,743 - Total Parameters: 928145
2025-03-04 11:31:09,519 - {'epoch': 0, 'rec_loss': '8.8427'}
2025-03-04 11:31:17,588 - {'Epoch': 0, 'HR@5': '0.0202', 'NDCG@5': '0.0129', 'HR@10': '0.0311', 'NDCG@10': '0.0164', 'HR@20': '0.0493', 'NDCG@20': '0.0210'}
2025-03-04 11:31:17,589 - Validation score increased.  Saving model ...
2025-03-04 11:31:44,982 - {'epoch': 1, 'rec_loss': '8.3113'}
2025-03-04 11:31:53,321 - {'Epoch': 1, 'HR@5': '0.0372', 'NDCG@5': '0.0251', 'HR@10': '0.0567', 'NDCG@10': '0.0313', 'HR@20': '0.0810', 'NDCG@20': '0.0375'}
2025-03-04 11:31:53,325 - Validation score increased.  Saving model ...
2025-03-04 11:32:22,434 - {'epoch': 2, 'rec_loss': '7.9995'}
2025-03-04 11:32:30,133 - {'Epoch': 2, 'HR@5': '0.0506', 'NDCG@5': '0.0342', 'HR@10': '0.0745', 'NDCG@10': '0.0420', 'HR@20': '0.1073', 'NDCG@20': '0.0502'}
2025-03-04 11:32:30,139 - Validation score increased.  Saving model ...
2025-03-04 11:32:58,324 - {'epoch': 3, 'rec_loss': '7.7799'}
2025-03-04 11:33:06,083 - {'Epoch': 3, 'HR@5': '0.0605', 'NDCG@5': '0.0419', 'HR@10': '0.0895', 'NDCG@10': '0.0512', 'HR@20': '0.1233', 'NDCG@20': '0.0598'}
2025-03-04 11:33:06,085 - Validation score increased.  Saving model ...
2025-03-04 11:33:34,699 - {'epoch': 4, 'rec_loss': '7.6256'}
2025-03-04 11:33:42,477 - {'Epoch': 4, 'HR@5': '0.0697', 'NDCG@5': '0.0484', 'HR@10': '0.0989', 'NDCG@10': '0.0578', 'HR@20': '0.1363', 'NDCG@20': '0.0672'}
2025-03-04 11:33:42,482 - Validation score increased.  Saving model ...
2025-03-04 11:34:10,949 - {'epoch': 5, 'rec_loss': '7.5060'}
2025-03-04 11:34:18,584 - {'Epoch': 5, 'HR@5': '0.0728', 'NDCG@5': '0.0511', 'HR@10': '0.1025', 'NDCG@10': '0.0607', 'HR@20': '0.1389', 'NDCG@20': '0.0698'}
2025-03-04 11:34:18,589 - Validation score increased.  Saving model ...
2025-03-04 11:34:46,931 - {'epoch': 6, 'rec_loss': '7.4194'}
2025-03-04 11:34:54,708 - {'Epoch': 6, 'HR@5': '0.0754', 'NDCG@5': '0.0531', 'HR@10': '0.1062', 'NDCG@10': '0.0630', 'HR@20': '0.1455', 'NDCG@20': '0.0729'}
2025-03-04 11:34:54,709 - Validation score increased.  Saving model ...
2025-03-04 11:35:23,248 - {'epoch': 7, 'rec_loss': '7.3413'}
2025-03-04 11:35:30,881 - {'Epoch': 7, 'HR@5': '0.0794', 'NDCG@5': '0.0559', 'HR@10': '0.1087', 'NDCG@10': '0.0654', 'HR@20': '0.1485', 'NDCG@20': '0.0753'}
2025-03-04 11:35:30,882 - Validation score increased.  Saving model ...
2025-03-04 11:35:59,154 - {'epoch': 8, 'rec_loss': '7.2751'}
2025-03-04 11:36:07,214 - {'Epoch': 8, 'HR@5': '0.0814', 'NDCG@5': '0.0576', 'HR@10': '0.1106', 'NDCG@10': '0.0670', 'HR@20': '0.1530', 'NDCG@20': '0.0776'}
2025-03-04 11:36:07,215 - Validation score increased.  Saving model ...
2025-03-04 11:36:35,087 - {'epoch': 9, 'rec_loss': '7.2244'}
2025-03-04 11:36:42,971 - {'Epoch': 9, 'HR@5': '0.0805', 'NDCG@5': '0.0566', 'HR@10': '0.1113', 'NDCG@10': '0.0666', 'HR@20': '0.1532', 'NDCG@20': '0.0771'}
2025-03-04 11:36:42,976 - EarlyStopping counter: 1 out of 10
2025-03-04 11:37:11,997 - {'epoch': 10, 'rec_loss': '7.1796'}
2025-03-04 11:37:19,881 - {'Epoch': 10, 'HR@5': '0.0826', 'NDCG@5': '0.0588', 'HR@10': '0.1145', 'NDCG@10': '0.0691', 'HR@20': '0.1558', 'NDCG@20': '0.0795'}
2025-03-04 11:37:19,882 - Validation score increased.  Saving model ...
2025-03-04 11:37:49,477 - {'epoch': 11, 'rec_loss': '7.1367'}
2025-03-04 11:37:58,020 - {'Epoch': 11, 'HR@5': '0.0828', 'NDCG@5': '0.0578', 'HR@10': '0.1144', 'NDCG@10': '0.0679', 'HR@20': '0.1567', 'NDCG@20': '0.0786'}
2025-03-04 11:37:58,026 - EarlyStopping counter: 1 out of 10
2025-03-04 11:38:28,264 - {'epoch': 12, 'rec_loss': '7.1019'}
2025-03-04 11:38:36,613 - {'Epoch': 12, 'HR@5': '0.0834', 'NDCG@5': '0.0590', 'HR@10': '0.1171', 'NDCG@10': '0.0698', 'HR@20': '0.1584', 'NDCG@20': '0.0803'}
2025-03-04 11:38:36,618 - Validation score increased.  Saving model ...
2025-03-04 11:39:04,927 - {'epoch': 13, 'rec_loss': '7.0748'}
2025-03-04 11:39:13,105 - {'Epoch': 13, 'HR@5': '0.0861', 'NDCG@5': '0.0604', 'HR@10': '0.1172', 'NDCG@10': '0.0705', 'HR@20': '0.1579', 'NDCG@20': '0.0807'}
2025-03-04 11:39:13,106 - Validation score increased.  Saving model ...
2025-03-04 11:39:42,231 - {'epoch': 14, 'rec_loss': '7.0449'}
2025-03-04 11:39:50,201 - {'Epoch': 14, 'HR@5': '0.0858', 'NDCG@5': '0.0599', 'HR@10': '0.1164', 'NDCG@10': '0.0697', 'HR@20': '0.1607', 'NDCG@20': '0.0809'}
2025-03-04 11:39:50,207 - Validation score increased.  Saving model ...
2025-03-04 11:40:18,599 - {'epoch': 15, 'rec_loss': '7.0245'}
2025-03-04 11:40:26,486 - {'Epoch': 15, 'HR@5': '0.0854', 'NDCG@5': '0.0601', 'HR@10': '0.1162', 'NDCG@10': '0.0700', 'HR@20': '0.1587', 'NDCG@20': '0.0807'}
2025-03-04 11:40:26,487 - EarlyStopping counter: 1 out of 10
2025-03-04 11:40:54,913 - {'epoch': 16, 'rec_loss': '7.0046'}
2025-03-04 11:41:02,990 - {'Epoch': 16, 'HR@5': '0.0847', 'NDCG@5': '0.0601', 'HR@10': '0.1186', 'NDCG@10': '0.0710', 'HR@20': '0.1605', 'NDCG@20': '0.0815'}
2025-03-04 11:41:02,991 - Validation score increased.  Saving model ...
2025-03-04 11:41:31,218 - {'epoch': 17, 'rec_loss': '6.9885'}
2025-03-04 11:41:39,243 - {'Epoch': 17, 'HR@5': '0.0884', 'NDCG@5': '0.0619', 'HR@10': '0.1193', 'NDCG@10': '0.0719', 'HR@20': '0.1613', 'NDCG@20': '0.0824'}
2025-03-04 11:41:39,248 - Validation score increased.  Saving model ...
2025-03-04 11:42:08,162 - {'epoch': 18, 'rec_loss': '6.9595'}
2025-03-04 11:42:16,108 - {'Epoch': 18, 'HR@5': '0.0865', 'NDCG@5': '0.0608', 'HR@10': '0.1187', 'NDCG@10': '0.0712', 'HR@20': '0.1599', 'NDCG@20': '0.0815'}
2025-03-04 11:42:16,112 - EarlyStopping counter: 1 out of 10
2025-03-04 11:42:45,485 - {'epoch': 19, 'rec_loss': '6.9479'}
2025-03-04 11:42:53,439 - {'Epoch': 19, 'HR@5': '0.0859', 'NDCG@5': '0.0608', 'HR@10': '0.1201', 'NDCG@10': '0.0718', 'HR@20': '0.1621', 'NDCG@20': '0.0824'}
2025-03-04 11:42:53,444 - Validation score increased.  Saving model ...
2025-03-04 11:43:21,615 - {'epoch': 20, 'rec_loss': '6.9320'}
2025-03-04 11:43:30,021 - {'Epoch': 20, 'HR@5': '0.0869', 'NDCG@5': '0.0616', 'HR@10': '0.1192', 'NDCG@10': '0.0720', 'HR@20': '0.1615', 'NDCG@20': '0.0827'}
2025-03-04 11:43:30,027 - Validation score increased.  Saving model ...
2025-03-04 11:44:01,419 - {'epoch': 21, 'rec_loss': '6.9143'}
2025-03-04 11:44:09,680 - {'Epoch': 21, 'HR@5': '0.0871', 'NDCG@5': '0.0613', 'HR@10': '0.1200', 'NDCG@10': '0.0719', 'HR@20': '0.1629', 'NDCG@20': '0.0827'}
2025-03-04 11:44:09,685 - Validation score increased.  Saving model ...
2025-03-04 11:44:38,266 - {'epoch': 22, 'rec_loss': '6.9064'}
2025-03-04 11:44:46,456 - {'Epoch': 22, 'HR@5': '0.0875', 'NDCG@5': '0.0616', 'HR@10': '0.1215', 'NDCG@10': '0.0726', 'HR@20': '0.1633', 'NDCG@20': '0.0831'}
2025-03-04 11:44:46,457 - Validation score increased.  Saving model ...
2025-03-04 11:45:15,112 - {'epoch': 23, 'rec_loss': '6.8880'}
2025-03-04 11:45:23,284 - {'Epoch': 23, 'HR@5': '0.0870', 'NDCG@5': '0.0609', 'HR@10': '0.1191', 'NDCG@10': '0.0712', 'HR@20': '0.1629', 'NDCG@20': '0.0823'}
2025-03-04 11:45:23,289 - EarlyStopping counter: 1 out of 10
2025-03-04 11:45:52,624 - {'epoch': 24, 'rec_loss': '6.8808'}
2025-03-04 11:46:00,402 - {'Epoch': 24, 'HR@5': '0.0861', 'NDCG@5': '0.0609', 'HR@10': '0.1197', 'NDCG@10': '0.0717', 'HR@20': '0.1604', 'NDCG@20': '0.0819'}
2025-03-04 11:46:00,407 - EarlyStopping counter: 2 out of 10
2025-03-04 11:46:29,041 - {'epoch': 25, 'rec_loss': '6.8691'}
2025-03-04 11:46:36,831 - {'Epoch': 25, 'HR@5': '0.0868', 'NDCG@5': '0.0615', 'HR@10': '0.1202', 'NDCG@10': '0.0722', 'HR@20': '0.1638', 'NDCG@20': '0.0832'}
2025-03-04 11:46:36,835 - Validation score increased.  Saving model ...
2025-03-04 11:47:04,793 - {'epoch': 26, 'rec_loss': '6.8534'}
2025-03-04 11:47:13,089 - {'Epoch': 26, 'HR@5': '0.0865', 'NDCG@5': '0.0617', 'HR@10': '0.1197', 'NDCG@10': '0.0724', 'HR@20': '0.1639', 'NDCG@20': '0.0836'}
2025-03-04 11:47:13,090 - Validation score increased.  Saving model ...
2025-03-04 11:47:40,716 - {'epoch': 27, 'rec_loss': '6.8492'}
2025-03-04 11:47:49,211 - {'Epoch': 27, 'HR@5': '0.0854', 'NDCG@5': '0.0606', 'HR@10': '0.1201', 'NDCG@10': '0.0718', 'HR@20': '0.1627', 'NDCG@20': '0.0825'}
2025-03-04 11:47:49,212 - EarlyStopping counter: 1 out of 10
2025-03-04 11:48:20,156 - {'epoch': 28, 'rec_loss': '6.8367'}
2025-03-04 11:48:28,311 - {'Epoch': 28, 'HR@5': '0.0858', 'NDCG@5': '0.0610', 'HR@10': '0.1189', 'NDCG@10': '0.0717', 'HR@20': '0.1622', 'NDCG@20': '0.0826'}
2025-03-04 11:48:28,317 - EarlyStopping counter: 2 out of 10
2025-03-04 11:48:59,314 - {'epoch': 29, 'rec_loss': '6.8307'}
2025-03-04 11:49:07,186 - {'Epoch': 29, 'HR@5': '0.0869', 'NDCG@5': '0.0619', 'HR@10': '0.1186', 'NDCG@10': '0.0721', 'HR@20': '0.1620', 'NDCG@20': '0.0831'}
2025-03-04 11:49:07,187 - EarlyStopping counter: 3 out of 10
2025-03-04 11:49:36,231 - {'epoch': 30, 'rec_loss': '6.8194'}
2025-03-04 11:49:44,106 - {'Epoch': 30, 'HR@5': '0.0868', 'NDCG@5': '0.0609', 'HR@10': '0.1215', 'NDCG@10': '0.0720', 'HR@20': '0.1624', 'NDCG@20': '0.0823'}
2025-03-04 11:49:44,112 - EarlyStopping counter: 4 out of 10
2025-03-04 11:50:13,745 - {'epoch': 31, 'rec_loss': '6.8095'}
2025-03-04 11:50:21,538 - {'Epoch': 31, 'HR@5': '0.0872', 'NDCG@5': '0.0614', 'HR@10': '0.1194', 'NDCG@10': '0.0718', 'HR@20': '0.1615', 'NDCG@20': '0.0823'}
2025-03-04 11:50:21,543 - EarlyStopping counter: 5 out of 10
2025-03-04 11:50:50,446 - {'epoch': 32, 'rec_loss': '6.7974'}
2025-03-04 11:50:58,431 - {'Epoch': 32, 'HR@5': '0.0860', 'NDCG@5': '0.0615', 'HR@10': '0.1193', 'NDCG@10': '0.0722', 'HR@20': '0.1635', 'NDCG@20': '0.0833'}
2025-03-04 11:50:58,432 - EarlyStopping counter: 6 out of 10
2025-03-04 11:51:28,182 - {'epoch': 33, 'rec_loss': '6.7994'}
2025-03-04 11:51:35,911 - {'Epoch': 33, 'HR@5': '0.0858', 'NDCG@5': '0.0611', 'HR@10': '0.1178', 'NDCG@10': '0.0714', 'HR@20': '0.1627', 'NDCG@20': '0.0828'}
2025-03-04 11:51:35,916 - EarlyStopping counter: 7 out of 10
2025-03-04 11:52:03,915 - {'epoch': 34, 'rec_loss': '6.7863'}
2025-03-04 11:52:11,838 - {'Epoch': 34, 'HR@5': '0.0868', 'NDCG@5': '0.0619', 'HR@10': '0.1184', 'NDCG@10': '0.0721', 'HR@20': '0.1625', 'NDCG@20': '0.0832'}
2025-03-04 11:52:11,844 - EarlyStopping counter: 8 out of 10
2025-03-04 11:52:40,307 - {'epoch': 35, 'rec_loss': '6.7826'}
2025-03-04 11:52:48,079 - {'Epoch': 35, 'HR@5': '0.0856', 'NDCG@5': '0.0612', 'HR@10': '0.1173', 'NDCG@10': '0.0715', 'HR@20': '0.1604', 'NDCG@20': '0.0823'}
2025-03-04 11:52:48,084 - EarlyStopping counter: 9 out of 10
2025-03-04 11:53:16,617 - {'epoch': 36, 'rec_loss': '6.7717'}
2025-03-04 11:53:24,494 - {'Epoch': 36, 'HR@5': '0.0880', 'NDCG@5': '0.0629', 'HR@10': '0.1201', 'NDCG@10': '0.0732', 'HR@20': '0.1639', 'NDCG@20': '0.0842'}
2025-03-04 11:53:24,498 - Validation score increased.  Saving model ...
2025-03-04 11:53:54,073 - {'epoch': 37, 'rec_loss': '6.7634'}
2025-03-04 11:54:02,142 - {'Epoch': 37, 'HR@5': '0.0864', 'NDCG@5': '0.0611', 'HR@10': '0.1190', 'NDCG@10': '0.0716', 'HR@20': '0.1618', 'NDCG@20': '0.0825'}
2025-03-04 11:54:02,146 - EarlyStopping counter: 1 out of 10
2025-03-04 11:54:30,632 - {'epoch': 38, 'rec_loss': '6.7602'}
2025-03-04 11:54:38,373 - {'Epoch': 38, 'HR@5': '0.0863', 'NDCG@5': '0.0615', 'HR@10': '0.1204', 'NDCG@10': '0.0725', 'HR@20': '0.1634', 'NDCG@20': '0.0833'}
2025-03-04 11:54:38,378 - EarlyStopping counter: 2 out of 10
2025-03-04 11:55:06,301 - {'epoch': 39, 'rec_loss': '6.7545'}
2025-03-04 11:55:14,056 - {'Epoch': 39, 'HR@5': '0.0873', 'NDCG@5': '0.0617', 'HR@10': '0.1191', 'NDCG@10': '0.0720', 'HR@20': '0.1634', 'NDCG@20': '0.0832'}
2025-03-04 11:55:14,057 - EarlyStopping counter: 3 out of 10
2025-03-04 11:55:42,581 - {'epoch': 40, 'rec_loss': '6.7512'}
2025-03-04 11:55:50,439 - {'Epoch': 40, 'HR@5': '0.0854', 'NDCG@5': '0.0607', 'HR@10': '0.1197', 'NDCG@10': '0.0718', 'HR@20': '0.1642', 'NDCG@20': '0.0830'}
2025-03-04 11:55:50,444 - EarlyStopping counter: 4 out of 10
2025-03-04 11:56:20,212 - {'epoch': 41, 'rec_loss': '6.7449'}
2025-03-04 11:56:28,037 - {'Epoch': 41, 'HR@5': '0.0878', 'NDCG@5': '0.0622', 'HR@10': '0.1208', 'NDCG@10': '0.0728', 'HR@20': '0.1649', 'NDCG@20': '0.0839'}
2025-03-04 11:56:28,042 - EarlyStopping counter: 5 out of 10
2025-03-04 11:57:00,397 - {'epoch': 42, 'rec_loss': '6.7399'}
2025-03-04 11:57:08,174 - {'Epoch': 42, 'HR@5': '0.0863', 'NDCG@5': '0.0614', 'HR@10': '0.1202', 'NDCG@10': '0.0723', 'HR@20': '0.1628', 'NDCG@20': '0.0830'}
2025-03-04 11:57:08,175 - EarlyStopping counter: 6 out of 10
2025-03-04 11:57:38,342 - {'epoch': 43, 'rec_loss': '6.7308'}
2025-03-04 11:57:46,268 - {'Epoch': 43, 'HR@5': '0.0864', 'NDCG@5': '0.0614', 'HR@10': '0.1198', 'NDCG@10': '0.0721', 'HR@20': '0.1624', 'NDCG@20': '0.0829'}
2025-03-04 11:57:46,273 - EarlyStopping counter: 7 out of 10
2025-03-04 11:58:15,565 - {'epoch': 44, 'rec_loss': '6.7309'}
2025-03-04 11:58:23,350 - {'Epoch': 44, 'HR@5': '0.0861', 'NDCG@5': '0.0615', 'HR@10': '0.1198', 'NDCG@10': '0.0723', 'HR@20': '0.1634', 'NDCG@20': '0.0833'}
2025-03-04 11:58:23,355 - EarlyStopping counter: 8 out of 10
2025-03-04 11:58:53,149 - {'epoch': 45, 'rec_loss': '6.7244'}
2025-03-04 11:59:01,295 - {'Epoch': 45, 'HR@5': '0.0869', 'NDCG@5': '0.0614', 'HR@10': '0.1210', 'NDCG@10': '0.0724', 'HR@20': '0.1638', 'NDCG@20': '0.0831'}
2025-03-04 11:59:01,296 - EarlyStopping counter: 9 out of 10
2025-03-04 11:59:30,673 - {'epoch': 46, 'rec_loss': '6.7177'}
2025-03-04 11:59:38,598 - {'Epoch': 46, 'HR@5': '0.0872', 'NDCG@5': '0.0621', 'HR@10': '0.1193', 'NDCG@10': '0.0724', 'HR@20': '0.1627', 'NDCG@20': '0.0833'}
2025-03-04 11:59:38,604 - EarlyStopping counter: 10 out of 10
2025-03-04 11:59:38,604 - Early stopping
2025-03-04 11:59:38,604 - ---------------Test Score---------------
2025-03-04 11:59:46,245 - {'Epoch': 0, 'HR@5': '0.0715', 'NDCG@5': '0.0504', 'HR@10': '0.1002', 'NDCG@10': '0.0596', 'HR@20': '0.1388', 'NDCG@20': '0.0693'}
2025-03-04 11:59:46,247 - Scale_Beauty
2025-03-04 11:59:46,247 - {'Epoch': 0, 'HR@5': '0.0715', 'NDCG@5': '0.0504', 'HR@10': '0.1002', 'NDCG@10': '0.0596', 'HR@20': '0.1388', 'NDCG@20': '0.0693'}
2025-03-04 12:11:03,864 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[8, 12, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-04 12:11:06,708 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-04 12:11:06,713 - Total Parameters: 928470
2025-03-04 12:11:36,149 - {'epoch': 0, 'rec_loss': '8.8307'}
2025-03-04 12:11:44,012 - {'Epoch': 0, 'HR@5': '0.0207', 'NDCG@5': '0.0129', 'HR@10': '0.0319', 'NDCG@10': '0.0165', 'HR@20': '0.0479', 'NDCG@20': '0.0205'}
2025-03-04 12:11:44,013 - Validation score increased.  Saving model ...
2025-03-04 12:12:11,589 - {'epoch': 1, 'rec_loss': '8.3026'}
2025-03-04 12:12:19,563 - {'Epoch': 1, 'HR@5': '0.0368', 'NDCG@5': '0.0247', 'HR@10': '0.0566', 'NDCG@10': '0.0311', 'HR@20': '0.0848', 'NDCG@20': '0.0382'}
2025-03-04 12:12:19,564 - Validation score increased.  Saving model ...
2025-03-04 12:12:47,503 - {'epoch': 2, 'rec_loss': '7.9933'}
2025-03-04 12:12:55,280 - {'Epoch': 2, 'HR@5': '0.0521', 'NDCG@5': '0.0344', 'HR@10': '0.0768', 'NDCG@10': '0.0423', 'HR@20': '0.1093', 'NDCG@20': '0.0504'}
2025-03-04 12:12:55,282 - Validation score increased.  Saving model ...
2025-03-04 12:13:22,761 - {'epoch': 3, 'rec_loss': '7.7810'}
2025-03-04 12:13:30,188 - {'Epoch': 3, 'HR@5': '0.0620', 'NDCG@5': '0.0424', 'HR@10': '0.0894', 'NDCG@10': '0.0513', 'HR@20': '0.1245', 'NDCG@20': '0.0601'}
2025-03-04 12:13:30,189 - Validation score increased.  Saving model ...
2025-03-04 12:13:57,165 - {'epoch': 4, 'rec_loss': '7.6315'}
2025-03-04 12:14:05,196 - {'Epoch': 4, 'HR@5': '0.0680', 'NDCG@5': '0.0469', 'HR@10': '0.0979', 'NDCG@10': '0.0565', 'HR@20': '0.1342', 'NDCG@20': '0.0657'}
2025-03-04 12:14:05,197 - Validation score increased.  Saving model ...
2025-03-04 12:14:32,628 - {'epoch': 5, 'rec_loss': '7.5143'}
2025-03-04 12:14:40,481 - {'Epoch': 5, 'HR@5': '0.0728', 'NDCG@5': '0.0515', 'HR@10': '0.1024', 'NDCG@10': '0.0611', 'HR@20': '0.1401', 'NDCG@20': '0.0705'}
2025-03-04 12:14:40,482 - Validation score increased.  Saving model ...
2025-03-04 12:15:10,302 - {'epoch': 6, 'rec_loss': '7.4137'}
2025-03-04 12:15:17,726 - {'Epoch': 6, 'HR@5': '0.0757', 'NDCG@5': '0.0535', 'HR@10': '0.1055', 'NDCG@10': '0.0631', 'HR@20': '0.1454', 'NDCG@20': '0.0732'}
2025-03-04 12:15:17,728 - Validation score increased.  Saving model ...
2025-03-04 12:15:45,721 - {'epoch': 7, 'rec_loss': '7.3414'}
2025-03-04 12:15:53,121 - {'Epoch': 7, 'HR@5': '0.0776', 'NDCG@5': '0.0543', 'HR@10': '0.1071', 'NDCG@10': '0.0638', 'HR@20': '0.1468', 'NDCG@20': '0.0738'}
2025-03-04 12:15:53,122 - Validation score increased.  Saving model ...
2025-03-04 12:16:20,949 - {'epoch': 8, 'rec_loss': '7.2744'}
2025-03-04 12:16:28,502 - {'Epoch': 8, 'HR@5': '0.0805', 'NDCG@5': '0.0571', 'HR@10': '0.1105', 'NDCG@10': '0.0668', 'HR@20': '0.1518', 'NDCG@20': '0.0771'}
2025-03-04 12:16:28,503 - Validation score increased.  Saving model ...
2025-03-04 12:16:56,698 - {'epoch': 9, 'rec_loss': '7.2245'}
2025-03-04 12:17:04,350 - {'Epoch': 9, 'HR@5': '0.0804', 'NDCG@5': '0.0570', 'HR@10': '0.1126', 'NDCG@10': '0.0673', 'HR@20': '0.1538', 'NDCG@20': '0.0777'}
2025-03-04 12:17:04,351 - Validation score increased.  Saving model ...
2025-03-04 12:17:34,134 - {'epoch': 10, 'rec_loss': '7.1785'}
2025-03-04 12:17:41,793 - {'Epoch': 10, 'HR@5': '0.0818', 'NDCG@5': '0.0578', 'HR@10': '0.1143', 'NDCG@10': '0.0683', 'HR@20': '0.1547', 'NDCG@20': '0.0784'}
2025-03-04 12:17:41,794 - Validation score increased.  Saving model ...
2025-03-04 12:18:09,642 - {'epoch': 11, 'rec_loss': '7.1422'}
2025-03-04 12:18:17,158 - {'Epoch': 11, 'HR@5': '0.0833', 'NDCG@5': '0.0584', 'HR@10': '0.1154', 'NDCG@10': '0.0688', 'HR@20': '0.1557', 'NDCG@20': '0.0789'}
2025-03-04 12:18:17,159 - Validation score increased.  Saving model ...
2025-03-04 12:18:44,830 - {'epoch': 12, 'rec_loss': '7.1065'}
2025-03-04 12:18:52,463 - {'Epoch': 12, 'HR@5': '0.0835', 'NDCG@5': '0.0593', 'HR@10': '0.1160', 'NDCG@10': '0.0698', 'HR@20': '0.1569', 'NDCG@20': '0.0801'}
2025-03-04 12:18:52,464 - Validation score increased.  Saving model ...
2025-03-04 12:19:20,012 - {'epoch': 13, 'rec_loss': '7.0718'}
2025-03-04 12:19:27,663 - {'Epoch': 13, 'HR@5': '0.0859', 'NDCG@5': '0.0598', 'HR@10': '0.1167', 'NDCG@10': '0.0697', 'HR@20': '0.1576', 'NDCG@20': '0.0800'}
2025-03-04 12:19:27,664 - EarlyStopping counter: 1 out of 10
2025-03-04 12:19:54,853 - {'epoch': 14, 'rec_loss': '7.0460'}
2025-03-04 12:20:02,764 - {'Epoch': 14, 'HR@5': '0.0846', 'NDCG@5': '0.0600', 'HR@10': '0.1177', 'NDCG@10': '0.0707', 'HR@20': '0.1583', 'NDCG@20': '0.0809'}
2025-03-04 12:20:02,765 - Validation score increased.  Saving model ...
2025-03-04 12:20:32,658 - {'epoch': 15, 'rec_loss': '7.0288'}
2025-03-04 12:20:40,220 - {'Epoch': 15, 'HR@5': '0.0842', 'NDCG@5': '0.0596', 'HR@10': '0.1177', 'NDCG@10': '0.0704', 'HR@20': '0.1601', 'NDCG@20': '0.0811'}
2025-03-04 12:20:40,221 - Validation score increased.  Saving model ...
2025-03-04 12:21:09,614 - {'epoch': 16, 'rec_loss': '6.9993'}
2025-03-04 12:21:17,267 - {'Epoch': 16, 'HR@5': '0.0830', 'NDCG@5': '0.0586', 'HR@10': '0.1171', 'NDCG@10': '0.0696', 'HR@20': '0.1597', 'NDCG@20': '0.0803'}
2025-03-04 12:21:17,268 - EarlyStopping counter: 1 out of 10
2025-03-04 12:21:45,537 - {'epoch': 17, 'rec_loss': '6.9824'}
2025-03-04 12:21:53,566 - {'Epoch': 17, 'HR@5': '0.0854', 'NDCG@5': '0.0600', 'HR@10': '0.1182', 'NDCG@10': '0.0706', 'HR@20': '0.1611', 'NDCG@20': '0.0814'}
2025-03-04 12:21:53,571 - Validation score increased.  Saving model ...
2025-03-04 12:22:23,259 - {'epoch': 18, 'rec_loss': '6.9614'}
2025-03-04 12:22:31,161 - {'Epoch': 18, 'HR@5': '0.0858', 'NDCG@5': '0.0606', 'HR@10': '0.1174', 'NDCG@10': '0.0707', 'HR@20': '0.1623', 'NDCG@20': '0.0820'}
2025-03-04 12:22:31,162 - Validation score increased.  Saving model ...
2025-03-04 12:22:59,904 - {'epoch': 19, 'rec_loss': '6.9511'}
2025-03-04 12:23:07,544 - {'Epoch': 19, 'HR@5': '0.0851', 'NDCG@5': '0.0594', 'HR@10': '0.1194', 'NDCG@10': '0.0705', 'HR@20': '0.1623', 'NDCG@20': '0.0812'}
2025-03-04 12:23:07,545 - EarlyStopping counter: 1 out of 10
2025-03-04 12:23:34,599 - {'epoch': 20, 'rec_loss': '6.9332'}
2025-03-04 12:23:42,256 - {'Epoch': 20, 'HR@5': '0.0845', 'NDCG@5': '0.0591', 'HR@10': '0.1185', 'NDCG@10': '0.0701', 'HR@20': '0.1612', 'NDCG@20': '0.0808'}
2025-03-04 12:23:42,257 - EarlyStopping counter: 2 out of 10
2025-03-04 12:24:09,379 - {'epoch': 21, 'rec_loss': '6.9179'}
2025-03-04 12:24:17,548 - {'Epoch': 21, 'HR@5': '0.0855', 'NDCG@5': '0.0599', 'HR@10': '0.1186', 'NDCG@10': '0.0706', 'HR@20': '0.1607', 'NDCG@20': '0.0811'}
2025-03-04 12:24:17,549 - EarlyStopping counter: 3 out of 10
2025-03-04 12:24:46,278 - {'epoch': 22, 'rec_loss': '6.9070'}
2025-03-04 12:24:54,277 - {'Epoch': 22, 'HR@5': '0.0852', 'NDCG@5': '0.0604', 'HR@10': '0.1186', 'NDCG@10': '0.0711', 'HR@20': '0.1624', 'NDCG@20': '0.0822'}
2025-03-04 12:24:54,278 - Validation score increased.  Saving model ...
2025-03-04 12:25:22,474 - {'epoch': 23, 'rec_loss': '6.8906'}
2025-03-04 12:25:30,320 - {'Epoch': 23, 'HR@5': '0.0872', 'NDCG@5': '0.0612', 'HR@10': '0.1193', 'NDCG@10': '0.0715', 'HR@20': '0.1621', 'NDCG@20': '0.0823'}
2025-03-04 12:25:30,321 - Validation score increased.  Saving model ...
2025-03-04 12:25:58,599 - {'epoch': 24, 'rec_loss': '6.8764'}
2025-03-04 12:26:06,220 - {'Epoch': 24, 'HR@5': '0.0861', 'NDCG@5': '0.0601', 'HR@10': '0.1209', 'NDCG@10': '0.0713', 'HR@20': '0.1601', 'NDCG@20': '0.0812'}
2025-03-04 12:26:06,221 - EarlyStopping counter: 1 out of 10
2025-03-04 12:26:36,792 - {'epoch': 25, 'rec_loss': '6.8674'}
2025-03-04 12:26:44,347 - {'Epoch': 25, 'HR@5': '0.0867', 'NDCG@5': '0.0614', 'HR@10': '0.1198', 'NDCG@10': '0.0721', 'HR@20': '0.1624', 'NDCG@20': '0.0828'}
2025-03-04 12:26:44,354 - Validation score increased.  Saving model ...
2025-03-04 12:27:13,038 - {'epoch': 26, 'rec_loss': '6.8548'}
2025-03-04 12:27:20,940 - {'Epoch': 26, 'HR@5': '0.0866', 'NDCG@5': '0.0617', 'HR@10': '0.1194', 'NDCG@10': '0.0723', 'HR@20': '0.1631', 'NDCG@20': '0.0833'}
2025-03-04 12:27:20,941 - Validation score increased.  Saving model ...
2025-03-04 12:27:48,678 - {'epoch': 27, 'rec_loss': '6.8471'}
2025-03-04 12:27:56,343 - {'Epoch': 27, 'HR@5': '0.0862', 'NDCG@5': '0.0608', 'HR@10': '0.1196', 'NDCG@10': '0.0716', 'HR@20': '0.1616', 'NDCG@20': '0.0821'}
2025-03-04 12:27:56,344 - EarlyStopping counter: 1 out of 10
2025-03-04 12:28:26,331 - {'epoch': 28, 'rec_loss': '6.8366'}
2025-03-04 12:28:34,123 - {'Epoch': 28, 'HR@5': '0.0849', 'NDCG@5': '0.0603', 'HR@10': '0.1177', 'NDCG@10': '0.0708', 'HR@20': '0.1602', 'NDCG@20': '0.0815'}
2025-03-04 12:28:34,124 - EarlyStopping counter: 2 out of 10
2025-03-04 12:29:02,346 - {'epoch': 29, 'rec_loss': '6.8289'}
2025-03-04 12:29:09,847 - {'Epoch': 29, 'HR@5': '0.0858', 'NDCG@5': '0.0608', 'HR@10': '0.1199', 'NDCG@10': '0.0718', 'HR@20': '0.1617', 'NDCG@20': '0.0823'}
2025-03-04 12:29:09,848 - EarlyStopping counter: 3 out of 10
2025-03-04 12:29:37,767 - {'epoch': 30, 'rec_loss': '6.8228'}
2025-03-04 12:29:45,442 - {'Epoch': 30, 'HR@5': '0.0872', 'NDCG@5': '0.0613', 'HR@10': '0.1196', 'NDCG@10': '0.0717', 'HR@20': '0.1618', 'NDCG@20': '0.0823'}
2025-03-04 12:29:45,443 - EarlyStopping counter: 4 out of 10
2025-03-04 12:30:15,460 - {'epoch': 31, 'rec_loss': '6.8104'}
2025-03-04 12:30:23,250 - {'Epoch': 31, 'HR@5': '0.0890', 'NDCG@5': '0.0624', 'HR@10': '0.1196', 'NDCG@10': '0.0722', 'HR@20': '0.1636', 'NDCG@20': '0.0832'}
2025-03-04 12:30:23,252 - EarlyStopping counter: 5 out of 10
2025-03-04 12:30:52,426 - {'epoch': 32, 'rec_loss': '6.8039'}
2025-03-04 12:31:00,431 - {'Epoch': 32, 'HR@5': '0.0872', 'NDCG@5': '0.0617', 'HR@10': '0.1204', 'NDCG@10': '0.0724', 'HR@20': '0.1632', 'NDCG@20': '0.0831'}
2025-03-04 12:31:00,432 - EarlyStopping counter: 6 out of 10
2025-03-04 12:31:31,626 - {'epoch': 33, 'rec_loss': '6.7972'}
2025-03-04 12:31:39,402 - {'Epoch': 33, 'HR@5': '0.0884', 'NDCG@5': '0.0617', 'HR@10': '0.1215', 'NDCG@10': '0.0723', 'HR@20': '0.1635', 'NDCG@20': '0.0828'}
2025-03-04 12:31:39,403 - EarlyStopping counter: 7 out of 10
2025-03-04 12:32:10,224 - {'epoch': 34, 'rec_loss': '6.7845'}
2025-03-04 12:32:17,876 - {'Epoch': 34, 'HR@5': '0.0863', 'NDCG@5': '0.0603', 'HR@10': '0.1185', 'NDCG@10': '0.0707', 'HR@20': '0.1623', 'NDCG@20': '0.0817'}
2025-03-04 12:32:17,877 - EarlyStopping counter: 8 out of 10
2025-03-04 12:32:46,082 - {'epoch': 35, 'rec_loss': '6.7819'}
2025-03-04 12:32:53,876 - {'Epoch': 35, 'HR@5': '0.0872', 'NDCG@5': '0.0612', 'HR@10': '0.1183', 'NDCG@10': '0.0713', 'HR@20': '0.1618', 'NDCG@20': '0.0822'}
2025-03-04 12:32:53,877 - EarlyStopping counter: 9 out of 10
2025-03-04 12:33:21,207 - {'epoch': 36, 'rec_loss': '6.7711'}
2025-03-04 12:33:28,799 - {'Epoch': 36, 'HR@5': '0.0871', 'NDCG@5': '0.0611', 'HR@10': '0.1191', 'NDCG@10': '0.0713', 'HR@20': '0.1629', 'NDCG@20': '0.0823'}
2025-03-04 12:33:28,800 - EarlyStopping counter: 10 out of 10
2025-03-04 12:33:28,800 - Early stopping
2025-03-04 12:33:28,800 - ---------------Test Score---------------
2025-03-04 12:33:36,202 - {'Epoch': 0, 'HR@5': '0.0690', 'NDCG@5': '0.0491', 'HR@10': '0.0987', 'NDCG@10': '0.0587', 'HR@20': '0.1348', 'NDCG@20': '0.0677'}
2025-03-04 12:33:36,203 - Scale_Beauty
2025-03-04 12:33:36,203 - {'Epoch': 0, 'HR@5': '0.0690', 'NDCG@5': '0.0491', 'HR@10': '0.0987', 'NDCG@10': '0.0587', 'HR@20': '0.1348', 'NDCG@20': '0.0677'}
2025-03-04 13:07:03,618 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 5], kernels=[8, 12, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-04 13:07:06,454 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-04 13:07:06,459 - Total Parameters: 928145
2025-03-04 13:07:35,118 - {'epoch': 0, 'rec_loss': '8.8367'}
2025-03-04 13:07:43,151 - {'Epoch': 0, 'HR@5': '0.0203', 'NDCG@5': '0.0129', 'HR@10': '0.0317', 'NDCG@10': '0.0166', 'HR@20': '0.0497', 'NDCG@20': '0.0211'}
2025-03-04 13:07:43,152 - Validation score increased.  Saving model ...
2025-03-04 13:08:11,113 - {'epoch': 1, 'rec_loss': '8.3030'}
2025-03-04 13:08:18,712 - {'Epoch': 1, 'HR@5': '0.0389', 'NDCG@5': '0.0262', 'HR@10': '0.0570', 'NDCG@10': '0.0321', 'HR@20': '0.0799', 'NDCG@20': '0.0378'}
2025-03-04 13:08:18,713 - Validation score increased.  Saving model ...
2025-03-04 13:08:46,437 - {'epoch': 2, 'rec_loss': '7.9896'}
2025-03-04 13:08:54,722 - {'Epoch': 2, 'HR@5': '0.0502', 'NDCG@5': '0.0329', 'HR@10': '0.0765', 'NDCG@10': '0.0414', 'HR@20': '0.1102', 'NDCG@20': '0.0499'}
2025-03-04 13:08:54,723 - Validation score increased.  Saving model ...
2025-03-04 13:09:24,905 - {'epoch': 3, 'rec_loss': '7.7764'}
2025-03-04 13:09:33,086 - {'Epoch': 3, 'HR@5': '0.0609', 'NDCG@5': '0.0413', 'HR@10': '0.0886', 'NDCG@10': '0.0502', 'HR@20': '0.1252', 'NDCG@20': '0.0593'}
2025-03-04 13:09:33,087 - Validation score increased.  Saving model ...
2025-03-04 13:10:04,675 - {'epoch': 4, 'rec_loss': '7.6255'}
2025-03-04 13:10:12,380 - {'Epoch': 4, 'HR@5': '0.0706', 'NDCG@5': '0.0491', 'HR@10': '0.0983', 'NDCG@10': '0.0581', 'HR@20': '0.1363', 'NDCG@20': '0.0676'}
2025-03-04 13:10:12,382 - Validation score increased.  Saving model ...
2025-03-04 13:10:42,429 - {'epoch': 5, 'rec_loss': '7.5110'}
2025-03-04 13:10:50,057 - {'Epoch': 5, 'HR@5': '0.0736', 'NDCG@5': '0.0516', 'HR@10': '0.1023', 'NDCG@10': '0.0608', 'HR@20': '0.1412', 'NDCG@20': '0.0706'}
2025-03-04 13:10:50,058 - Validation score increased.  Saving model ...
2025-03-04 13:11:17,775 - {'epoch': 6, 'rec_loss': '7.4093'}
2025-03-04 13:11:25,555 - {'Epoch': 6, 'HR@5': '0.0769', 'NDCG@5': '0.0539', 'HR@10': '0.1063', 'NDCG@10': '0.0633', 'HR@20': '0.1456', 'NDCG@20': '0.0732'}
2025-03-04 13:11:25,556 - Validation score increased.  Saving model ...
2025-03-04 13:11:53,444 - {'epoch': 7, 'rec_loss': '7.3408'}
2025-03-04 13:12:01,272 - {'Epoch': 7, 'HR@5': '0.0784', 'NDCG@5': '0.0553', 'HR@10': '0.1110', 'NDCG@10': '0.0658', 'HR@20': '0.1487', 'NDCG@20': '0.0753'}
2025-03-04 13:12:01,274 - Validation score increased.  Saving model ...
2025-03-04 13:12:28,643 - {'epoch': 8, 'rec_loss': '7.2708'}
2025-03-04 13:12:36,195 - {'Epoch': 8, 'HR@5': '0.0807', 'NDCG@5': '0.0568', 'HR@10': '0.1114', 'NDCG@10': '0.0667', 'HR@20': '0.1508', 'NDCG@20': '0.0766'}
2025-03-04 13:12:36,196 - Validation score increased.  Saving model ...
2025-03-04 13:13:05,034 - {'epoch': 9, 'rec_loss': '7.2207'}
2025-03-04 13:13:13,027 - {'Epoch': 9, 'HR@5': '0.0830', 'NDCG@5': '0.0577', 'HR@10': '0.1137', 'NDCG@10': '0.0675', 'HR@20': '0.1531', 'NDCG@20': '0.0775'}
2025-03-04 13:13:13,028 - Validation score increased.  Saving model ...
2025-03-04 13:13:43,030 - {'epoch': 10, 'rec_loss': '7.1767'}
2025-03-04 13:13:50,642 - {'Epoch': 10, 'HR@5': '0.0823', 'NDCG@5': '0.0579', 'HR@10': '0.1159', 'NDCG@10': '0.0688', 'HR@20': '0.1567', 'NDCG@20': '0.0791'}
2025-03-04 13:13:50,643 - Validation score increased.  Saving model ...
2025-03-04 13:14:18,596 - {'epoch': 11, 'rec_loss': '7.1380'}
2025-03-04 13:14:26,270 - {'Epoch': 11, 'HR@5': '0.0836', 'NDCG@5': '0.0595', 'HR@10': '0.1147', 'NDCG@10': '0.0696', 'HR@20': '0.1570', 'NDCG@20': '0.0802'}
2025-03-04 13:14:26,271 - Validation score increased.  Saving model ...
2025-03-04 13:14:55,101 - {'epoch': 12, 'rec_loss': '7.0999'}
2025-03-04 13:15:02,897 - {'Epoch': 12, 'HR@5': '0.0848', 'NDCG@5': '0.0600', 'HR@10': '0.1186', 'NDCG@10': '0.0709', 'HR@20': '0.1581', 'NDCG@20': '0.0809'}
2025-03-04 13:15:02,898 - Validation score increased.  Saving model ...
2025-03-04 13:15:30,793 - {'epoch': 13, 'rec_loss': '7.0724'}
2025-03-04 13:15:38,606 - {'Epoch': 13, 'HR@5': '0.0851', 'NDCG@5': '0.0597', 'HR@10': '0.1178', 'NDCG@10': '0.0703', 'HR@20': '0.1593', 'NDCG@20': '0.0807'}
2025-03-04 13:15:38,607 - EarlyStopping counter: 1 out of 10
2025-03-04 13:16:06,614 - {'epoch': 14, 'rec_loss': '7.0458'}
2025-03-04 13:16:14,419 - {'Epoch': 14, 'HR@5': '0.0856', 'NDCG@5': '0.0605', 'HR@10': '0.1181', 'NDCG@10': '0.0710', 'HR@20': '0.1606', 'NDCG@20': '0.0817'}
2025-03-04 13:16:14,420 - Validation score increased.  Saving model ...
2025-03-04 13:16:41,958 - {'epoch': 15, 'rec_loss': '7.0190'}
2025-03-04 13:16:49,691 - {'Epoch': 15, 'HR@5': '0.0857', 'NDCG@5': '0.0600', 'HR@10': '0.1188', 'NDCG@10': '0.0707', 'HR@20': '0.1619', 'NDCG@20': '0.0815'}
2025-03-04 13:16:49,692 - EarlyStopping counter: 1 out of 10
2025-03-04 13:17:15,856 - {'epoch': 16, 'rec_loss': '6.9976'}
2025-03-04 13:17:23,752 - {'Epoch': 16, 'HR@5': '0.0856', 'NDCG@5': '0.0602', 'HR@10': '0.1172', 'NDCG@10': '0.0704', 'HR@20': '0.1606', 'NDCG@20': '0.0813'}
2025-03-04 13:17:23,753 - EarlyStopping counter: 2 out of 10
2025-03-04 13:17:51,388 - {'epoch': 17, 'rec_loss': '6.9724'}
2025-03-04 13:17:59,239 - {'Epoch': 17, 'HR@5': '0.0863', 'NDCG@5': '0.0606', 'HR@10': '0.1193', 'NDCG@10': '0.0712', 'HR@20': '0.1625', 'NDCG@20': '0.0821'}
2025-03-04 13:17:59,241 - Validation score increased.  Saving model ...
2025-03-04 13:18:27,362 - {'epoch': 18, 'rec_loss': '6.9624'}
2025-03-04 13:18:35,329 - {'Epoch': 18, 'HR@5': '0.0868', 'NDCG@5': '0.0611', 'HR@10': '0.1192', 'NDCG@10': '0.0715', 'HR@20': '0.1621', 'NDCG@20': '0.0823'}
2025-03-04 13:18:35,330 - Validation score increased.  Saving model ...
2025-03-04 13:19:04,536 - {'epoch': 19, 'rec_loss': '6.9327'}
2025-03-04 13:19:12,321 - {'Epoch': 19, 'HR@5': '0.0875', 'NDCG@5': '0.0621', 'HR@10': '0.1205', 'NDCG@10': '0.0728', 'HR@20': '0.1625', 'NDCG@20': '0.0833'}
2025-03-04 13:19:12,323 - Validation score increased.  Saving model ...
2025-03-04 13:19:42,864 - {'epoch': 20, 'rec_loss': '6.9254'}
2025-03-04 13:19:51,289 - {'Epoch': 20, 'HR@5': '0.0863', 'NDCG@5': '0.0602', 'HR@10': '0.1175', 'NDCG@10': '0.0703', 'HR@20': '0.1623', 'NDCG@20': '0.0815'}
2025-03-04 13:19:51,290 - EarlyStopping counter: 1 out of 10
2025-03-04 13:20:24,020 - {'epoch': 21, 'rec_loss': '6.9152'}
2025-03-04 13:20:32,414 - {'Epoch': 21, 'HR@5': '0.0878', 'NDCG@5': '0.0618', 'HR@10': '0.1198', 'NDCG@10': '0.0721', 'HR@20': '0.1633', 'NDCG@20': '0.0830'}
2025-03-04 13:20:32,415 - EarlyStopping counter: 2 out of 10
2025-03-04 13:21:01,584 - {'epoch': 22, 'rec_loss': '6.8980'}
2025-03-04 13:21:09,233 - {'Epoch': 22, 'HR@5': '0.0868', 'NDCG@5': '0.0612', 'HR@10': '0.1195', 'NDCG@10': '0.0717', 'HR@20': '0.1612', 'NDCG@20': '0.0822'}
2025-03-04 13:21:09,234 - EarlyStopping counter: 3 out of 10
2025-03-04 13:21:36,783 - {'epoch': 23, 'rec_loss': '6.8829'}
2025-03-04 13:21:44,557 - {'Epoch': 23, 'HR@5': '0.0882', 'NDCG@5': '0.0619', 'HR@10': '0.1184', 'NDCG@10': '0.0716', 'HR@20': '0.1630', 'NDCG@20': '0.0828'}
2025-03-04 13:21:44,558 - EarlyStopping counter: 4 out of 10
2025-03-04 13:22:16,093 - {'epoch': 24, 'rec_loss': '6.8707'}
2025-03-04 13:22:23,827 - {'Epoch': 24, 'HR@5': '0.0861', 'NDCG@5': '0.0612', 'HR@10': '0.1191', 'NDCG@10': '0.0719', 'HR@20': '0.1622', 'NDCG@20': '0.0828'}
2025-03-04 13:22:23,828 - EarlyStopping counter: 5 out of 10
2025-03-04 13:22:53,068 - {'epoch': 25, 'rec_loss': '6.8661'}
2025-03-04 13:23:01,085 - {'Epoch': 25, 'HR@5': '0.0874', 'NDCG@5': '0.0612', 'HR@10': '0.1202', 'NDCG@10': '0.0718', 'HR@20': '0.1641', 'NDCG@20': '0.0828'}
2025-03-04 13:23:01,087 - EarlyStopping counter: 6 out of 10
2025-03-04 13:23:29,754 - {'epoch': 26, 'rec_loss': '6.8487'}
2025-03-04 13:23:37,527 - {'Epoch': 26, 'HR@5': '0.0878', 'NDCG@5': '0.0621', 'HR@10': '0.1211', 'NDCG@10': '0.0728', 'HR@20': '0.1622', 'NDCG@20': '0.0832'}
2025-03-04 13:23:37,528 - EarlyStopping counter: 7 out of 10
2025-03-04 13:24:05,708 - {'epoch': 27, 'rec_loss': '6.8374'}
2025-03-04 13:24:13,416 - {'Epoch': 27, 'HR@5': '0.0863', 'NDCG@5': '0.0619', 'HR@10': '0.1219', 'NDCG@10': '0.0733', 'HR@20': '0.1638', 'NDCG@20': '0.0839'}
2025-03-04 13:24:13,418 - Validation score increased.  Saving model ...
2025-03-04 13:24:41,303 - {'epoch': 28, 'rec_loss': '6.8287'}
2025-03-04 13:24:48,982 - {'Epoch': 28, 'HR@5': '0.0885', 'NDCG@5': '0.0620', 'HR@10': '0.1215', 'NDCG@10': '0.0726', 'HR@20': '0.1628', 'NDCG@20': '0.0830'}
2025-03-04 13:24:48,983 - EarlyStopping counter: 1 out of 10
2025-03-04 13:25:17,504 - {'epoch': 29, 'rec_loss': '6.8174'}
2025-03-04 13:25:25,230 - {'Epoch': 29, 'HR@5': '0.0876', 'NDCG@5': '0.0612', 'HR@10': '0.1213', 'NDCG@10': '0.0720', 'HR@20': '0.1627', 'NDCG@20': '0.0825'}
2025-03-04 13:25:25,231 - EarlyStopping counter: 2 out of 10
2025-03-04 13:25:53,108 - {'epoch': 30, 'rec_loss': '6.8164'}
2025-03-04 13:26:00,905 - {'Epoch': 30, 'HR@5': '0.0879', 'NDCG@5': '0.0621', 'HR@10': '0.1214', 'NDCG@10': '0.0728', 'HR@20': '0.1646', 'NDCG@20': '0.0837'}
2025-03-04 13:26:00,906 - EarlyStopping counter: 3 out of 10
2025-03-04 13:26:28,771 - {'epoch': 31, 'rec_loss': '6.8094'}
2025-03-04 13:26:36,451 - {'Epoch': 31, 'HR@5': '0.0883', 'NDCG@5': '0.0624', 'HR@10': '0.1216', 'NDCG@10': '0.0732', 'HR@20': '0.1629', 'NDCG@20': '0.0836'}
2025-03-04 13:26:36,452 - EarlyStopping counter: 4 out of 10
2025-03-04 13:27:04,696 - {'epoch': 32, 'rec_loss': '6.7965'}
2025-03-04 13:27:12,531 - {'Epoch': 32, 'HR@5': '0.0877', 'NDCG@5': '0.0621', 'HR@10': '0.1211', 'NDCG@10': '0.0729', 'HR@20': '0.1645', 'NDCG@20': '0.0838'}
2025-03-04 13:27:12,532 - EarlyStopping counter: 5 out of 10
2025-03-04 13:27:40,560 - {'epoch': 33, 'rec_loss': '6.7931'}
2025-03-04 13:27:48,394 - {'Epoch': 33, 'HR@5': '0.0884', 'NDCG@5': '0.0623', 'HR@10': '0.1214', 'NDCG@10': '0.0729', 'HR@20': '0.1642', 'NDCG@20': '0.0836'}
2025-03-04 13:27:48,396 - EarlyStopping counter: 6 out of 10
2025-03-04 13:28:15,701 - {'epoch': 34, 'rec_loss': '6.7772'}
2025-03-04 13:28:23,683 - {'Epoch': 34, 'HR@5': '0.0878', 'NDCG@5': '0.0626', 'HR@10': '0.1210', 'NDCG@10': '0.0733', 'HR@20': '0.1635', 'NDCG@20': '0.0840'}
2025-03-04 13:28:23,684 - Validation score increased.  Saving model ...
2025-03-04 13:28:51,967 - {'epoch': 35, 'rec_loss': '6.7736'}
2025-03-04 13:28:59,938 - {'Epoch': 35, 'HR@5': '0.0880', 'NDCG@5': '0.0621', 'HR@10': '0.1205', 'NDCG@10': '0.0726', 'HR@20': '0.1634', 'NDCG@20': '0.0833'}
2025-03-04 13:28:59,939 - EarlyStopping counter: 1 out of 10
2025-03-04 13:29:27,879 - {'epoch': 36, 'rec_loss': '6.7665'}
2025-03-04 13:29:35,741 - {'Epoch': 36, 'HR@5': '0.0876', 'NDCG@5': '0.0614', 'HR@10': '0.1204', 'NDCG@10': '0.0720', 'HR@20': '0.1634', 'NDCG@20': '0.0829'}
2025-03-04 13:29:35,742 - EarlyStopping counter: 2 out of 10
2025-03-04 13:30:03,749 - {'epoch': 37, 'rec_loss': '6.7584'}
2025-03-04 13:30:12,004 - {'Epoch': 37, 'HR@5': '0.0887', 'NDCG@5': '0.0621', 'HR@10': '0.1204', 'NDCG@10': '0.0723', 'HR@20': '0.1634', 'NDCG@20': '0.0831'}
2025-03-04 13:30:12,005 - EarlyStopping counter: 3 out of 10
2025-03-04 13:30:39,765 - {'epoch': 38, 'rec_loss': '6.7536'}
2025-03-04 13:30:47,577 - {'Epoch': 38, 'HR@5': '0.0885', 'NDCG@5': '0.0626', 'HR@10': '0.1199', 'NDCG@10': '0.0727', 'HR@20': '0.1625', 'NDCG@20': '0.0834'}
2025-03-04 13:30:47,578 - EarlyStopping counter: 4 out of 10
2025-03-04 13:31:15,495 - {'epoch': 39, 'rec_loss': '6.7455'}
2025-03-04 13:31:23,274 - {'Epoch': 39, 'HR@5': '0.0880', 'NDCG@5': '0.0623', 'HR@10': '0.1214', 'NDCG@10': '0.0730', 'HR@20': '0.1637', 'NDCG@20': '0.0837'}
2025-03-04 13:31:23,275 - EarlyStopping counter: 5 out of 10
2025-03-04 13:31:51,047 - {'epoch': 40, 'rec_loss': '6.7391'}
2025-03-04 13:31:58,554 - {'Epoch': 40, 'HR@5': '0.0870', 'NDCG@5': '0.0623', 'HR@10': '0.1223', 'NDCG@10': '0.0737', 'HR@20': '0.1638', 'NDCG@20': '0.0841'}
2025-03-04 13:31:58,555 - Validation score increased.  Saving model ...
2025-03-04 13:32:26,339 - {'epoch': 41, 'rec_loss': '6.7349'}
2025-03-04 13:32:34,476 - {'Epoch': 41, 'HR@5': '0.0877', 'NDCG@5': '0.0623', 'HR@10': '0.1193', 'NDCG@10': '0.0725', 'HR@20': '0.1635', 'NDCG@20': '0.0837'}
2025-03-04 13:32:34,477 - EarlyStopping counter: 1 out of 10
2025-03-04 13:33:02,958 - {'epoch': 42, 'rec_loss': '6.7292'}
2025-03-04 13:33:10,676 - {'Epoch': 42, 'HR@5': '0.0879', 'NDCG@5': '0.0625', 'HR@10': '0.1217', 'NDCG@10': '0.0733', 'HR@20': '0.1666', 'NDCG@20': '0.0846'}
2025-03-04 13:33:10,677 - Validation score increased.  Saving model ...
2025-03-04 13:33:40,471 - {'epoch': 43, 'rec_loss': '6.7178'}
2025-03-04 13:33:48,358 - {'Epoch': 43, 'HR@5': '0.0886', 'NDCG@5': '0.0627', 'HR@10': '0.1210', 'NDCG@10': '0.0731', 'HR@20': '0.1648', 'NDCG@20': '0.0841'}
2025-03-04 13:33:48,359 - EarlyStopping counter: 1 out of 10
2025-03-04 13:34:17,623 - {'epoch': 44, 'rec_loss': '6.7147'}
2025-03-04 13:34:26,074 - {'Epoch': 44, 'HR@5': '0.0887', 'NDCG@5': '0.0623', 'HR@10': '0.1222', 'NDCG@10': '0.0730', 'HR@20': '0.1643', 'NDCG@20': '0.0836'}
2025-03-04 13:34:26,075 - EarlyStopping counter: 2 out of 10
2025-03-04 13:34:53,821 - {'epoch': 45, 'rec_loss': '6.7181'}
2025-03-04 13:35:01,755 - {'Epoch': 45, 'HR@5': '0.0884', 'NDCG@5': '0.0620', 'HR@10': '0.1206', 'NDCG@10': '0.0725', 'HR@20': '0.1649', 'NDCG@20': '0.0836'}
2025-03-04 13:35:01,756 - EarlyStopping counter: 3 out of 10
2025-03-04 13:35:30,544 - {'epoch': 46, 'rec_loss': '6.7055'}
2025-03-04 13:35:38,465 - {'Epoch': 46, 'HR@5': '0.0893', 'NDCG@5': '0.0626', 'HR@10': '0.1210', 'NDCG@10': '0.0727', 'HR@20': '0.1642', 'NDCG@20': '0.0836'}
2025-03-04 13:35:38,466 - EarlyStopping counter: 4 out of 10
2025-03-04 13:36:06,591 - {'epoch': 47, 'rec_loss': '6.7038'}
2025-03-04 13:36:14,396 - {'Epoch': 47, 'HR@5': '0.0889', 'NDCG@5': '0.0630', 'HR@10': '0.1206', 'NDCG@10': '0.0732', 'HR@20': '0.1639', 'NDCG@20': '0.0840'}
2025-03-04 13:36:14,397 - EarlyStopping counter: 5 out of 10
2025-03-04 13:36:41,982 - {'epoch': 48, 'rec_loss': '6.7004'}
2025-03-04 13:36:49,878 - {'Epoch': 48, 'HR@5': '0.0877', 'NDCG@5': '0.0618', 'HR@10': '0.1205', 'NDCG@10': '0.0724', 'HR@20': '0.1630', 'NDCG@20': '0.0831'}
2025-03-04 13:36:49,879 - EarlyStopping counter: 6 out of 10
2025-03-04 13:37:17,583 - {'epoch': 49, 'rec_loss': '6.6975'}
2025-03-04 13:37:25,651 - {'Epoch': 49, 'HR@5': '0.0876', 'NDCG@5': '0.0622', 'HR@10': '0.1210', 'NDCG@10': '0.0730', 'HR@20': '0.1637', 'NDCG@20': '0.0837'}
2025-03-04 13:37:25,652 - EarlyStopping counter: 7 out of 10
2025-03-04 13:37:53,457 - {'epoch': 50, 'rec_loss': '6.6983'}
2025-03-04 13:38:01,514 - {'Epoch': 50, 'HR@5': '0.0880', 'NDCG@5': '0.0629', 'HR@10': '0.1230', 'NDCG@10': '0.0741', 'HR@20': '0.1651', 'NDCG@20': '0.0847'}
2025-03-04 13:38:01,515 - Validation score increased.  Saving model ...
2025-03-04 13:38:29,881 - {'epoch': 51, 'rec_loss': '6.6941'}
2025-03-04 13:38:37,718 - {'Epoch': 51, 'HR@5': '0.0890', 'NDCG@5': '0.0625', 'HR@10': '0.1209', 'NDCG@10': '0.0728', 'HR@20': '0.1642', 'NDCG@20': '0.0836'}
2025-03-04 13:38:37,719 - EarlyStopping counter: 1 out of 10
2025-03-04 13:39:05,232 - {'epoch': 52, 'rec_loss': '6.6858'}
2025-03-04 13:39:13,379 - {'Epoch': 52, 'HR@5': '0.0883', 'NDCG@5': '0.0621', 'HR@10': '0.1212', 'NDCG@10': '0.0727', 'HR@20': '0.1651', 'NDCG@20': '0.0838'}
2025-03-04 13:39:13,380 - EarlyStopping counter: 2 out of 10
2025-03-04 13:39:41,569 - {'epoch': 53, 'rec_loss': '6.6834'}
2025-03-04 13:39:50,029 - {'Epoch': 53, 'HR@5': '0.0883', 'NDCG@5': '0.0623', 'HR@10': '0.1218', 'NDCG@10': '0.0730', 'HR@20': '0.1649', 'NDCG@20': '0.0839'}
2025-03-04 13:39:50,031 - EarlyStopping counter: 3 out of 10
2025-03-04 13:40:18,496 - {'epoch': 54, 'rec_loss': '6.6809'}
2025-03-04 13:40:26,399 - {'Epoch': 54, 'HR@5': '0.0891', 'NDCG@5': '0.0631', 'HR@10': '0.1224', 'NDCG@10': '0.0738', 'HR@20': '0.1658', 'NDCG@20': '0.0847'}
2025-03-04 13:40:26,400 - EarlyStopping counter: 4 out of 10
2025-03-04 13:40:54,432 - {'epoch': 55, 'rec_loss': '6.6759'}
2025-03-04 13:41:02,808 - {'Epoch': 55, 'HR@5': '0.0890', 'NDCG@5': '0.0630', 'HR@10': '0.1215', 'NDCG@10': '0.0735', 'HR@20': '0.1656', 'NDCG@20': '0.0846'}
2025-03-04 13:41:02,809 - EarlyStopping counter: 5 out of 10
2025-03-04 13:41:30,954 - {'epoch': 56, 'rec_loss': '6.6703'}
2025-03-04 13:41:39,159 - {'Epoch': 56, 'HR@5': '0.0889', 'NDCG@5': '0.0624', 'HR@10': '0.1215', 'NDCG@10': '0.0729', 'HR@20': '0.1648', 'NDCG@20': '0.0838'}
2025-03-04 13:41:39,161 - EarlyStopping counter: 6 out of 10
2025-03-04 13:42:07,505 - {'epoch': 57, 'rec_loss': '6.6658'}
2025-03-04 13:42:16,067 - {'Epoch': 57, 'HR@5': '0.0885', 'NDCG@5': '0.0626', 'HR@10': '0.1214', 'NDCG@10': '0.0732', 'HR@20': '0.1647', 'NDCG@20': '0.0841'}
2025-03-04 13:42:16,068 - EarlyStopping counter: 7 out of 10
2025-03-04 13:42:44,264 - {'epoch': 58, 'rec_loss': '6.6610'}
2025-03-04 13:42:52,287 - {'Epoch': 58, 'HR@5': '0.0889', 'NDCG@5': '0.0629', 'HR@10': '0.1219', 'NDCG@10': '0.0735', 'HR@20': '0.1648', 'NDCG@20': '0.0843'}
2025-03-04 13:42:52,288 - EarlyStopping counter: 8 out of 10
2025-03-04 13:43:20,094 - {'epoch': 59, 'rec_loss': '6.6587'}
2025-03-04 13:43:27,937 - {'Epoch': 59, 'HR@5': '0.0888', 'NDCG@5': '0.0628', 'HR@10': '0.1224', 'NDCG@10': '0.0736', 'HR@20': '0.1646', 'NDCG@20': '0.0843'}
2025-03-04 13:43:27,938 - EarlyStopping counter: 9 out of 10
2025-03-04 13:43:55,669 - {'epoch': 60, 'rec_loss': '6.6556'}
2025-03-04 13:44:03,355 - {'Epoch': 60, 'HR@5': '0.0883', 'NDCG@5': '0.0626', 'HR@10': '0.1220', 'NDCG@10': '0.0735', 'HR@20': '0.1658', 'NDCG@20': '0.0845'}
2025-03-04 13:44:03,356 - EarlyStopping counter: 10 out of 10
2025-03-04 13:44:03,357 - Early stopping
2025-03-04 13:44:03,357 - ---------------Test Score---------------
2025-03-04 13:44:11,709 - {'Epoch': 0, 'HR@5': '0.0711', 'NDCG@5': '0.0508', 'HR@10': '0.0988', 'NDCG@10': '0.0597', 'HR@20': '0.1376', 'NDCG@20': '0.0695'}
2025-03-04 13:44:11,710 - Scale_Beauty
2025-03-04 13:44:11,710 - {'Epoch': 0, 'HR@5': '0.0711', 'NDCG@5': '0.0508', 'HR@10': '0.0988', 'NDCG@10': '0.0597', 'HR@20': '0.1376', 'NDCG@20': '0.0695'}
2025-03-04 13:45:36,360 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[10, 5], kernels=[8, 12, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-04 13:45:39,158 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-04 13:45:39,164 - Total Parameters: 928145
2025-03-04 13:46:09,264 - {'epoch': 0, 'rec_loss': '8.8296'}
2025-03-04 13:46:17,900 - {'Epoch': 0, 'HR@5': '0.0195', 'NDCG@5': '0.0126', 'HR@10': '0.0314', 'NDCG@10': '0.0165', 'HR@20': '0.0472', 'NDCG@20': '0.0204'}
2025-03-04 13:46:17,901 - Validation score increased.  Saving model ...
2025-03-04 13:46:45,807 - {'epoch': 1, 'rec_loss': '8.3007'}
2025-03-04 13:46:53,938 - {'Epoch': 1, 'HR@5': '0.0384', 'NDCG@5': '0.0248', 'HR@10': '0.0573', 'NDCG@10': '0.0309', 'HR@20': '0.0827', 'NDCG@20': '0.0373'}
2025-03-04 13:46:53,939 - Validation score increased.  Saving model ...
2025-03-04 13:47:21,811 - {'epoch': 2, 'rec_loss': '7.9912'}
2025-03-04 13:47:29,837 - {'Epoch': 2, 'HR@5': '0.0501', 'NDCG@5': '0.0336', 'HR@10': '0.0742', 'NDCG@10': '0.0413', 'HR@20': '0.1047', 'NDCG@20': '0.0489'}
2025-03-04 13:47:29,838 - Validation score increased.  Saving model ...
2025-03-04 13:47:57,620 - {'epoch': 3, 'rec_loss': '7.7813'}
2025-03-04 13:48:05,521 - {'Epoch': 3, 'HR@5': '0.0622', 'NDCG@5': '0.0432', 'HR@10': '0.0868', 'NDCG@10': '0.0511', 'HR@20': '0.1219', 'NDCG@20': '0.0600'}
2025-03-04 13:48:05,522 - Validation score increased.  Saving model ...
2025-03-04 13:48:34,976 - {'epoch': 4, 'rec_loss': '7.6297'}
2025-03-04 13:48:42,728 - {'Epoch': 4, 'HR@5': '0.0683', 'NDCG@5': '0.0468', 'HR@10': '0.0971', 'NDCG@10': '0.0561', 'HR@20': '0.1345', 'NDCG@20': '0.0655'}
2025-03-04 13:48:42,729 - Validation score increased.  Saving model ...
2025-03-04 13:49:11,147 - {'epoch': 5, 'rec_loss': '7.5152'}
2025-03-04 13:49:18,794 - {'Epoch': 5, 'HR@5': '0.0749', 'NDCG@5': '0.0521', 'HR@10': '0.1034', 'NDCG@10': '0.0612', 'HR@20': '0.1416', 'NDCG@20': '0.0708'}
2025-03-04 13:49:18,796 - Validation score increased.  Saving model ...
2025-03-04 13:49:46,919 - {'epoch': 6, 'rec_loss': '7.4225'}
2025-03-04 13:49:54,721 - {'Epoch': 6, 'HR@5': '0.0770', 'NDCG@5': '0.0534', 'HR@10': '0.1066', 'NDCG@10': '0.0629', 'HR@20': '0.1455', 'NDCG@20': '0.0727'}
2025-03-04 13:49:54,726 - Validation score increased.  Saving model ...
2025-03-04 13:50:22,629 - {'epoch': 7, 'rec_loss': '7.3429'}
2025-03-04 13:50:30,238 - {'Epoch': 7, 'HR@5': '0.0793', 'NDCG@5': '0.0559', 'HR@10': '0.1092', 'NDCG@10': '0.0655', 'HR@20': '0.1501', 'NDCG@20': '0.0758'}
2025-03-04 13:50:30,240 - Validation score increased.  Saving model ...
2025-03-04 13:50:58,243 - {'epoch': 8, 'rec_loss': '7.2791'}
2025-03-04 13:51:06,155 - {'Epoch': 8, 'HR@5': '0.0800', 'NDCG@5': '0.0568', 'HR@10': '0.1117', 'NDCG@10': '0.0670', 'HR@20': '0.1514', 'NDCG@20': '0.0770'}
2025-03-04 13:51:06,156 - Validation score increased.  Saving model ...
2025-03-04 13:51:33,837 - {'epoch': 9, 'rec_loss': '7.2280'}
2025-03-04 13:51:41,485 - {'Epoch': 9, 'HR@5': '0.0824', 'NDCG@5': '0.0582', 'HR@10': '0.1135', 'NDCG@10': '0.0682', 'HR@20': '0.1530', 'NDCG@20': '0.0781'}
2025-03-04 13:51:41,487 - Validation score increased.  Saving model ...
2025-03-04 13:52:10,609 - {'epoch': 10, 'rec_loss': '7.1808'}
2025-03-04 13:52:18,812 - {'Epoch': 10, 'HR@5': '0.0821', 'NDCG@5': '0.0586', 'HR@10': '0.1143', 'NDCG@10': '0.0689', 'HR@20': '0.1557', 'NDCG@20': '0.0793'}
2025-03-04 13:52:18,813 - Validation score increased.  Saving model ...
2025-03-04 13:52:48,064 - {'epoch': 11, 'rec_loss': '7.1435'}
2025-03-04 13:52:55,899 - {'Epoch': 11, 'HR@5': '0.0828', 'NDCG@5': '0.0585', 'HR@10': '0.1150', 'NDCG@10': '0.0689', 'HR@20': '0.1566', 'NDCG@20': '0.0794'}
2025-03-04 13:52:55,900 - Validation score increased.  Saving model ...
2025-03-04 13:53:24,193 - {'epoch': 12, 'rec_loss': '7.1052'}
2025-03-04 13:53:32,019 - {'Epoch': 12, 'HR@5': '0.0849', 'NDCG@5': '0.0599', 'HR@10': '0.1165', 'NDCG@10': '0.0701', 'HR@20': '0.1572', 'NDCG@20': '0.0803'}
2025-03-04 13:53:32,020 - Validation score increased.  Saving model ...
2025-03-04 13:53:59,716 - {'epoch': 13, 'rec_loss': '7.0774'}
2025-03-04 13:54:07,525 - {'Epoch': 13, 'HR@5': '0.0849', 'NDCG@5': '0.0602', 'HR@10': '0.1182', 'NDCG@10': '0.0709', 'HR@20': '0.1586', 'NDCG@20': '0.0811'}
2025-03-04 13:54:07,526 - Validation score increased.  Saving model ...
2025-03-04 13:54:35,475 - {'epoch': 14, 'rec_loss': '7.0491'}
2025-03-04 13:54:43,355 - {'Epoch': 14, 'HR@5': '0.0851', 'NDCG@5': '0.0601', 'HR@10': '0.1168', 'NDCG@10': '0.0703', 'HR@20': '0.1592', 'NDCG@20': '0.0809'}
2025-03-04 13:54:43,360 - EarlyStopping counter: 1 out of 10
2025-03-04 13:55:11,682 - {'epoch': 15, 'rec_loss': '7.0257'}
2025-03-04 13:55:19,258 - {'Epoch': 15, 'HR@5': '0.0839', 'NDCG@5': '0.0597', 'HR@10': '0.1179', 'NDCG@10': '0.0706', 'HR@20': '0.1597', 'NDCG@20': '0.0811'}
2025-03-04 13:55:19,263 - Validation score increased.  Saving model ...
2025-03-04 13:55:47,553 - {'epoch': 16, 'rec_loss': '7.0008'}
2025-03-04 13:55:55,688 - {'Epoch': 16, 'HR@5': '0.0863', 'NDCG@5': '0.0617', 'HR@10': '0.1180', 'NDCG@10': '0.0719', 'HR@20': '0.1598', 'NDCG@20': '0.0825'}
2025-03-04 13:55:55,690 - Validation score increased.  Saving model ...
2025-03-04 13:56:23,320 - {'epoch': 17, 'rec_loss': '6.9823'}
2025-03-04 13:56:31,514 - {'Epoch': 17, 'HR@5': '0.0850', 'NDCG@5': '0.0603', 'HR@10': '0.1157', 'NDCG@10': '0.0702', 'HR@20': '0.1596', 'NDCG@20': '0.0812'}
2025-03-04 13:56:31,519 - EarlyStopping counter: 1 out of 10
2025-03-04 13:57:00,181 - {'epoch': 18, 'rec_loss': '6.9674'}
2025-03-04 13:57:07,900 - {'Epoch': 18, 'HR@5': '0.0865', 'NDCG@5': '0.0617', 'HR@10': '0.1191', 'NDCG@10': '0.0722', 'HR@20': '0.1609', 'NDCG@20': '0.0828'}
2025-03-04 13:57:07,901 - Validation score increased.  Saving model ...
2025-03-04 13:57:36,446 - {'epoch': 19, 'rec_loss': '6.9538'}
2025-03-04 13:57:44,310 - {'Epoch': 19, 'HR@5': '0.0862', 'NDCG@5': '0.0609', 'HR@10': '0.1190', 'NDCG@10': '0.0714', 'HR@20': '0.1605', 'NDCG@20': '0.0819'}
2025-03-04 13:57:44,311 - EarlyStopping counter: 1 out of 10
2025-03-04 13:58:11,664 - {'epoch': 20, 'rec_loss': '6.9345'}
2025-03-04 13:58:19,329 - {'Epoch': 20, 'HR@5': '0.0874', 'NDCG@5': '0.0615', 'HR@10': '0.1180', 'NDCG@10': '0.0713', 'HR@20': '0.1612', 'NDCG@20': '0.0822'}
2025-03-04 13:58:19,330 - EarlyStopping counter: 2 out of 10
2025-03-04 13:58:49,184 - {'epoch': 21, 'rec_loss': '6.9271'}
2025-03-04 13:58:57,099 - {'Epoch': 21, 'HR@5': '0.0858', 'NDCG@5': '0.0603', 'HR@10': '0.1185', 'NDCG@10': '0.0708', 'HR@20': '0.1615', 'NDCG@20': '0.0816'}
2025-03-04 13:58:57,104 - EarlyStopping counter: 3 out of 10
2025-03-04 13:59:24,683 - {'epoch': 22, 'rec_loss': '6.9108'}
2025-03-04 13:59:32,271 - {'Epoch': 22, 'HR@5': '0.0862', 'NDCG@5': '0.0615', 'HR@10': '0.1186', 'NDCG@10': '0.0719', 'HR@20': '0.1615', 'NDCG@20': '0.0826'}
2025-03-04 13:59:32,272 - EarlyStopping counter: 4 out of 10
2025-03-04 14:00:00,078 - {'epoch': 23, 'rec_loss': '6.8943'}
2025-03-04 14:00:08,232 - {'Epoch': 23, 'HR@5': '0.0869', 'NDCG@5': '0.0614', 'HR@10': '0.1174', 'NDCG@10': '0.0713', 'HR@20': '0.1618', 'NDCG@20': '0.0825'}
2025-03-04 14:00:08,238 - EarlyStopping counter: 5 out of 10
2025-03-04 14:00:36,137 - {'epoch': 24, 'rec_loss': '6.8836'}
2025-03-04 14:00:43,931 - {'Epoch': 24, 'HR@5': '0.0867', 'NDCG@5': '0.0612', 'HR@10': '0.1188', 'NDCG@10': '0.0716', 'HR@20': '0.1610', 'NDCG@20': '0.0822'}
2025-03-04 14:00:43,932 - EarlyStopping counter: 6 out of 10
2025-03-04 14:01:11,995 - {'epoch': 25, 'rec_loss': '6.8719'}
2025-03-04 14:01:19,668 - {'Epoch': 25, 'HR@5': '0.0867', 'NDCG@5': '0.0621', 'HR@10': '0.1198', 'NDCG@10': '0.0728', 'HR@20': '0.1620', 'NDCG@20': '0.0834'}
2025-03-04 14:01:19,669 - Validation score increased.  Saving model ...
2025-03-04 14:01:47,419 - {'epoch': 26, 'rec_loss': '6.8565'}
2025-03-04 14:01:55,414 - {'Epoch': 26, 'HR@5': '0.0868', 'NDCG@5': '0.0617', 'HR@10': '0.1204', 'NDCG@10': '0.0726', 'HR@20': '0.1616', 'NDCG@20': '0.0829'}
2025-03-04 14:01:55,415 - EarlyStopping counter: 1 out of 10
2025-03-04 14:02:22,971 - {'epoch': 27, 'rec_loss': '6.8492'}
2025-03-04 14:02:30,757 - {'Epoch': 27, 'HR@5': '0.0873', 'NDCG@5': '0.0621', 'HR@10': '0.1208', 'NDCG@10': '0.0729', 'HR@20': '0.1629', 'NDCG@20': '0.0835'}
2025-03-04 14:02:30,758 - Validation score increased.  Saving model ...
2025-03-04 14:02:57,808 - {'epoch': 28, 'rec_loss': '6.8389'}
2025-03-04 14:03:05,617 - {'Epoch': 28, 'HR@5': '0.0876', 'NDCG@5': '0.0618', 'HR@10': '0.1210', 'NDCG@10': '0.0726', 'HR@20': '0.1616', 'NDCG@20': '0.0828'}
2025-03-04 14:03:05,618 - EarlyStopping counter: 1 out of 10
2025-03-04 14:03:33,570 - {'epoch': 29, 'rec_loss': '6.8294'}
2025-03-04 14:03:41,300 - {'Epoch': 29, 'HR@5': '0.0872', 'NDCG@5': '0.0617', 'HR@10': '0.1206', 'NDCG@10': '0.0725', 'HR@20': '0.1635', 'NDCG@20': '0.0833'}
2025-03-04 14:03:41,301 - EarlyStopping counter: 2 out of 10
2025-03-04 14:04:09,291 - {'epoch': 30, 'rec_loss': '6.8278'}
2025-03-04 14:04:16,883 - {'Epoch': 30, 'HR@5': '0.0878', 'NDCG@5': '0.0621', 'HR@10': '0.1208', 'NDCG@10': '0.0726', 'HR@20': '0.1644', 'NDCG@20': '0.0836'}
2025-03-04 14:04:16,884 - Validation score increased.  Saving model ...
2025-03-04 14:04:45,185 - {'epoch': 31, 'rec_loss': '6.8174'}
2025-03-04 14:04:52,913 - {'Epoch': 31, 'HR@5': '0.0886', 'NDCG@5': '0.0622', 'HR@10': '0.1205', 'NDCG@10': '0.0725', 'HR@20': '0.1628', 'NDCG@20': '0.0832'}
2025-03-04 14:04:52,914 - EarlyStopping counter: 1 out of 10
2025-03-04 14:05:21,126 - {'epoch': 32, 'rec_loss': '6.8067'}
2025-03-04 14:05:29,490 - {'Epoch': 32, 'HR@5': '0.0881', 'NDCG@5': '0.0625', 'HR@10': '0.1215', 'NDCG@10': '0.0732', 'HR@20': '0.1634', 'NDCG@20': '0.0838'}
2025-03-04 14:05:29,491 - Validation score increased.  Saving model ...
2025-03-04 14:06:00,528 - {'epoch': 33, 'rec_loss': '6.7975'}
2025-03-04 14:06:08,619 - {'Epoch': 33, 'HR@5': '0.0876', 'NDCG@5': '0.0617', 'HR@10': '0.1197', 'NDCG@10': '0.0721', 'HR@20': '0.1646', 'NDCG@20': '0.0834'}
2025-03-04 14:06:08,620 - EarlyStopping counter: 1 out of 10
2025-03-04 14:06:36,660 - {'epoch': 34, 'rec_loss': '6.7934'}
2025-03-04 14:06:44,687 - {'Epoch': 34, 'HR@5': '0.0877', 'NDCG@5': '0.0617', 'HR@10': '0.1203', 'NDCG@10': '0.0722', 'HR@20': '0.1601', 'NDCG@20': '0.0822'}
2025-03-04 14:06:44,692 - EarlyStopping counter: 2 out of 10
2025-03-04 14:07:12,374 - {'epoch': 35, 'rec_loss': '6.7851'}
2025-03-04 14:07:20,121 - {'Epoch': 35, 'HR@5': '0.0883', 'NDCG@5': '0.0626', 'HR@10': '0.1204', 'NDCG@10': '0.0730', 'HR@20': '0.1625', 'NDCG@20': '0.0836'}
2025-03-04 14:07:20,123 - EarlyStopping counter: 3 out of 10
2025-03-04 14:07:47,176 - {'epoch': 36, 'rec_loss': '6.7770'}
2025-03-04 14:07:54,918 - {'Epoch': 36, 'HR@5': '0.0876', 'NDCG@5': '0.0627', 'HR@10': '0.1200', 'NDCG@10': '0.0732', 'HR@20': '0.1650', 'NDCG@20': '0.0845'}
2025-03-04 14:07:54,920 - Validation score increased.  Saving model ...
2025-03-04 14:08:21,873 - {'epoch': 37, 'rec_loss': '6.7726'}
2025-03-04 14:08:29,466 - {'Epoch': 37, 'HR@5': '0.0869', 'NDCG@5': '0.0615', 'HR@10': '0.1202', 'NDCG@10': '0.0723', 'HR@20': '0.1630', 'NDCG@20': '0.0830'}
2025-03-04 14:08:29,467 - EarlyStopping counter: 1 out of 10
2025-03-04 14:08:57,211 - {'epoch': 38, 'rec_loss': '6.7609'}
2025-03-04 14:09:04,946 - {'Epoch': 38, 'HR@5': '0.0886', 'NDCG@5': '0.0627', 'HR@10': '0.1206', 'NDCG@10': '0.0730', 'HR@20': '0.1646', 'NDCG@20': '0.0840'}
2025-03-04 14:09:04,947 - EarlyStopping counter: 2 out of 10
2025-03-04 14:09:32,450 - {'epoch': 39, 'rec_loss': '6.7588'}
2025-03-04 14:09:40,222 - {'Epoch': 39, 'HR@5': '0.0878', 'NDCG@5': '0.0618', 'HR@10': '0.1208', 'NDCG@10': '0.0724', 'HR@20': '0.1641', 'NDCG@20': '0.0833'}
2025-03-04 14:09:40,223 - EarlyStopping counter: 3 out of 10
2025-03-04 14:10:07,525 - {'epoch': 40, 'rec_loss': '6.7575'}
2025-03-04 14:10:15,214 - {'Epoch': 40, 'HR@5': '0.0874', 'NDCG@5': '0.0615', 'HR@10': '0.1205', 'NDCG@10': '0.0722', 'HR@20': '0.1632', 'NDCG@20': '0.0829'}
2025-03-04 14:10:15,215 - EarlyStopping counter: 4 out of 10
2025-03-04 14:10:42,770 - {'epoch': 41, 'rec_loss': '6.7462'}
2025-03-04 14:10:50,593 - {'Epoch': 41, 'HR@5': '0.0873', 'NDCG@5': '0.0617', 'HR@10': '0.1193', 'NDCG@10': '0.0720', 'HR@20': '0.1642', 'NDCG@20': '0.0833'}
2025-03-04 14:10:50,594 - EarlyStopping counter: 5 out of 10
2025-03-04 14:11:17,667 - {'epoch': 42, 'rec_loss': '6.7423'}
2025-03-04 14:11:25,474 - {'Epoch': 42, 'HR@5': '0.0888', 'NDCG@5': '0.0630', 'HR@10': '0.1210', 'NDCG@10': '0.0734', 'HR@20': '0.1632', 'NDCG@20': '0.0840'}
2025-03-04 14:11:25,478 - EarlyStopping counter: 6 out of 10
2025-03-04 14:11:52,994 - {'epoch': 43, 'rec_loss': '6.7369'}
2025-03-04 14:12:00,712 - {'Epoch': 43, 'HR@5': '0.0876', 'NDCG@5': '0.0620', 'HR@10': '0.1206', 'NDCG@10': '0.0727', 'HR@20': '0.1642', 'NDCG@20': '0.0836'}
2025-03-04 14:12:00,713 - EarlyStopping counter: 7 out of 10
2025-03-04 14:12:28,519 - {'epoch': 44, 'rec_loss': '6.7302'}
2025-03-04 14:12:36,634 - {'Epoch': 44, 'HR@5': '0.0883', 'NDCG@5': '0.0624', 'HR@10': '0.1219', 'NDCG@10': '0.0733', 'HR@20': '0.1646', 'NDCG@20': '0.0841'}
2025-03-04 14:12:36,635 - EarlyStopping counter: 8 out of 10
2025-03-04 14:13:03,808 - {'epoch': 45, 'rec_loss': '6.7286'}
2025-03-04 14:13:11,720 - {'Epoch': 45, 'HR@5': '0.0887', 'NDCG@5': '0.0625', 'HR@10': '0.1214', 'NDCG@10': '0.0730', 'HR@20': '0.1639', 'NDCG@20': '0.0837'}
2025-03-04 14:13:11,721 - EarlyStopping counter: 9 out of 10
2025-03-04 14:13:39,593 - {'epoch': 46, 'rec_loss': '6.7164'}
2025-03-04 14:13:47,586 - {'Epoch': 46, 'HR@5': '0.0892', 'NDCG@5': '0.0628', 'HR@10': '0.1214', 'NDCG@10': '0.0732', 'HR@20': '0.1635', 'NDCG@20': '0.0838'}
2025-03-04 14:13:47,587 - EarlyStopping counter: 10 out of 10
2025-03-04 14:13:47,587 - Early stopping
2025-03-04 14:13:47,587 - ---------------Test Score---------------
2025-03-04 14:13:55,218 - {'Epoch': 0, 'HR@5': '0.0719', 'NDCG@5': '0.0511', 'HR@10': '0.1001', 'NDCG@10': '0.0602', 'HR@20': '0.1374', 'NDCG@20': '0.0696'}
2025-03-04 14:13:55,219 - Scale_Beauty
2025-03-04 14:13:55,219 - {'Epoch': 0, 'HR@5': '0.0719', 'NDCG@5': '0.0511', 'HR@10': '0.1001', 'NDCG@10': '0.0602', 'HR@20': '0.1374', 'NDCG@20': '0.0696'}
2025-03-05 13:16:26,931 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-05 13:16:29,965 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-05 13:16:29,970 - Total Parameters: 928470
2025-03-05 13:16:59,940 - {'epoch': 0, 'rec_loss': '8.8304'}
2025-03-05 13:17:09,013 - {'Epoch': 0, 'HR@5': '0.0211', 'NDCG@5': '0.0131', 'HR@10': '0.0319', 'NDCG@10': '0.0166', 'HR@20': '0.0482', 'NDCG@20': '0.0207'}
2025-03-05 13:17:09,015 - Validation score increased.  Saving model ...
2025-03-05 13:17:36,811 - {'epoch': 1, 'rec_loss': '8.2943'}
2025-03-05 13:17:45,632 - {'Epoch': 1, 'HR@5': '0.0371', 'NDCG@5': '0.0246', 'HR@10': '0.0573', 'NDCG@10': '0.0310', 'HR@20': '0.0858', 'NDCG@20': '0.0381'}
2025-03-05 13:17:45,633 - Validation score increased.  Saving model ...
2025-03-05 13:18:16,175 - {'epoch': 2, 'rec_loss': '7.9838'}
2025-03-05 13:18:25,876 - {'Epoch': 2, 'HR@5': '0.0527', 'NDCG@5': '0.0347', 'HR@10': '0.0778', 'NDCG@10': '0.0427', 'HR@20': '0.1115', 'NDCG@20': '0.0512'}
2025-03-05 13:18:25,877 - Validation score increased.  Saving model ...
2025-03-05 13:19:06,856 - {'epoch': 3, 'rec_loss': '7.7730'}
2025-03-05 13:19:16,970 - {'Epoch': 3, 'HR@5': '0.0625', 'NDCG@5': '0.0426', 'HR@10': '0.0902', 'NDCG@10': '0.0515', 'HR@20': '0.1256', 'NDCG@20': '0.0604'}
2025-03-05 13:19:16,972 - Validation score increased.  Saving model ...
2025-03-05 13:19:51,829 - {'epoch': 4, 'rec_loss': '7.6250'}
2025-03-05 13:19:59,808 - {'Epoch': 4, 'HR@5': '0.0696', 'NDCG@5': '0.0478', 'HR@10': '0.0984', 'NDCG@10': '0.0571', 'HR@20': '0.1347', 'NDCG@20': '0.0662'}
2025-03-05 13:19:59,809 - Validation score increased.  Saving model ...
2025-03-05 13:20:28,372 - {'epoch': 5, 'rec_loss': '7.5074'}
2025-03-05 13:20:36,453 - {'Epoch': 5, 'HR@5': '0.0731', 'NDCG@5': '0.0517', 'HR@10': '0.1024', 'NDCG@10': '0.0612', 'HR@20': '0.1410', 'NDCG@20': '0.0709'}
2025-03-05 13:20:36,454 - Validation score increased.  Saving model ...
2025-03-05 13:21:17,982 - {'epoch': 6, 'rec_loss': '7.4068'}
2025-03-05 13:21:28,424 - {'Epoch': 6, 'HR@5': '0.0766', 'NDCG@5': '0.0540', 'HR@10': '0.1056', 'NDCG@10': '0.0633', 'HR@20': '0.1463', 'NDCG@20': '0.0735'}
2025-03-05 13:21:28,426 - Validation score increased.  Saving model ...
2025-03-05 13:22:04,072 - {'epoch': 7, 'rec_loss': '7.3355'}
2025-03-05 13:22:12,462 - {'Epoch': 7, 'HR@5': '0.0765', 'NDCG@5': '0.0538', 'HR@10': '0.1084', 'NDCG@10': '0.0640', 'HR@20': '0.1477', 'NDCG@20': '0.0740'}
2025-03-05 13:22:12,464 - Validation score increased.  Saving model ...
2025-03-05 13:22:38,871 - {'epoch': 8, 'rec_loss': '7.2698'}
2025-03-05 13:22:48,093 - {'Epoch': 8, 'HR@5': '0.0803', 'NDCG@5': '0.0571', 'HR@10': '0.1113', 'NDCG@10': '0.0671', 'HR@20': '0.1512', 'NDCG@20': '0.0771'}
2025-03-05 13:22:48,094 - Validation score increased.  Saving model ...
2025-03-05 13:23:28,239 - {'epoch': 9, 'rec_loss': '7.2215'}
2025-03-05 13:23:38,958 - {'Epoch': 9, 'HR@5': '0.0810', 'NDCG@5': '0.0571', 'HR@10': '0.1120', 'NDCG@10': '0.0671', 'HR@20': '0.1533', 'NDCG@20': '0.0775'}
2025-03-05 13:23:38,960 - Validation score increased.  Saving model ...
2025-03-05 13:24:15,174 - {'epoch': 10, 'rec_loss': '7.1758'}
2025-03-05 13:24:23,584 - {'Epoch': 10, 'HR@5': '0.0815', 'NDCG@5': '0.0576', 'HR@10': '0.1150', 'NDCG@10': '0.0684', 'HR@20': '0.1544', 'NDCG@20': '0.0783'}
2025-03-05 13:24:23,585 - Validation score increased.  Saving model ...
2025-03-05 13:24:49,697 - {'epoch': 11, 'rec_loss': '7.1425'}
2025-03-05 13:24:57,846 - {'Epoch': 11, 'HR@5': '0.0830', 'NDCG@5': '0.0581', 'HR@10': '0.1158', 'NDCG@10': '0.0687', 'HR@20': '0.1564', 'NDCG@20': '0.0789'}
2025-03-05 13:24:57,847 - Validation score increased.  Saving model ...
2025-03-05 13:25:39,306 - {'epoch': 12, 'rec_loss': '7.1077'}
2025-03-05 13:25:50,567 - {'Epoch': 12, 'HR@5': '0.0842', 'NDCG@5': '0.0597', 'HR@10': '0.1162', 'NDCG@10': '0.0701', 'HR@20': '0.1580', 'NDCG@20': '0.0806'}
2025-03-05 13:25:50,570 - Validation score increased.  Saving model ...
2025-03-05 13:26:25,569 - {'epoch': 13, 'rec_loss': '7.0754'}
2025-03-05 13:26:34,523 - {'Epoch': 13, 'HR@5': '0.0846', 'NDCG@5': '0.0600', 'HR@10': '0.1168', 'NDCG@10': '0.0703', 'HR@20': '0.1586', 'NDCG@20': '0.0809'}
2025-03-05 13:26:34,524 - Validation score increased.  Saving model ...
2025-03-05 13:27:00,688 - {'epoch': 14, 'rec_loss': '7.0489'}
2025-03-05 13:27:10,592 - {'Epoch': 14, 'HR@5': '0.0842', 'NDCG@5': '0.0599', 'HR@10': '0.1165', 'NDCG@10': '0.0704', 'HR@20': '0.1592', 'NDCG@20': '0.0811'}
2025-03-05 13:27:10,594 - Validation score increased.  Saving model ...
2025-03-05 13:27:53,402 - {'epoch': 15, 'rec_loss': '7.0312'}
2025-03-05 13:28:03,731 - {'Epoch': 15, 'HR@5': '0.0845', 'NDCG@5': '0.0596', 'HR@10': '0.1175', 'NDCG@10': '0.0703', 'HR@20': '0.1599', 'NDCG@20': '0.0810'}
2025-03-05 13:28:03,734 - EarlyStopping counter: 1 out of 10
2025-03-05 13:28:35,833 - {'epoch': 16, 'rec_loss': '7.0040'}
2025-03-05 13:28:44,552 - {'Epoch': 16, 'HR@5': '0.0823', 'NDCG@5': '0.0586', 'HR@10': '0.1164', 'NDCG@10': '0.0696', 'HR@20': '0.1611', 'NDCG@20': '0.0808'}
2025-03-05 13:28:44,553 - EarlyStopping counter: 2 out of 10
2025-03-05 13:29:15,135 - {'epoch': 17, 'rec_loss': '6.9850'}
2025-03-05 13:29:25,530 - {'Epoch': 17, 'HR@5': '0.0849', 'NDCG@5': '0.0598', 'HR@10': '0.1171', 'NDCG@10': '0.0702', 'HR@20': '0.1604', 'NDCG@20': '0.0811'}
2025-03-05 13:29:25,532 - EarlyStopping counter: 3 out of 10
2025-03-05 13:30:07,974 - {'epoch': 18, 'rec_loss': '6.9645'}
2025-03-05 13:30:18,434 - {'Epoch': 18, 'HR@5': '0.0848', 'NDCG@5': '0.0604', 'HR@10': '0.1176', 'NDCG@10': '0.0710', 'HR@20': '0.1606', 'NDCG@20': '0.0818'}
2025-03-05 13:30:18,436 - Validation score increased.  Saving model ...
2025-03-05 13:30:49,221 - {'epoch': 19, 'rec_loss': '6.9565'}
2025-03-05 13:30:57,186 - {'Epoch': 19, 'HR@5': '0.0839', 'NDCG@5': '0.0586', 'HR@10': '0.1173', 'NDCG@10': '0.0694', 'HR@20': '0.1621', 'NDCG@20': '0.0807'}
2025-03-05 13:30:57,188 - EarlyStopping counter: 1 out of 10
2025-03-05 13:31:28,623 - {'epoch': 20, 'rec_loss': '6.9385'}
2025-03-05 13:31:39,010 - {'Epoch': 20, 'HR@5': '0.0840', 'NDCG@5': '0.0590', 'HR@10': '0.1179', 'NDCG@10': '0.0700', 'HR@20': '0.1613', 'NDCG@20': '0.0809'}
2025-03-05 13:31:39,012 - EarlyStopping counter: 2 out of 10
2025-03-05 13:32:20,419 - {'epoch': 21, 'rec_loss': '6.9233'}
2025-03-05 13:32:30,623 - {'Epoch': 21, 'HR@5': '0.0846', 'NDCG@5': '0.0596', 'HR@10': '0.1179', 'NDCG@10': '0.0703', 'HR@20': '0.1600', 'NDCG@20': '0.0809'}
2025-03-05 13:32:30,625 - EarlyStopping counter: 3 out of 10
2025-03-05 13:33:00,753 - {'epoch': 22, 'rec_loss': '6.9136'}
2025-03-05 13:33:09,879 - {'Epoch': 22, 'HR@5': '0.0847', 'NDCG@5': '0.0598', 'HR@10': '0.1169', 'NDCG@10': '0.0702', 'HR@20': '0.1617', 'NDCG@20': '0.0814'}
2025-03-05 13:33:09,880 - EarlyStopping counter: 4 out of 10
2025-03-05 13:33:39,987 - {'epoch': 23, 'rec_loss': '6.8968'}
2025-03-05 13:33:50,950 - {'Epoch': 23, 'HR@5': '0.0857', 'NDCG@5': '0.0606', 'HR@10': '0.1181', 'NDCG@10': '0.0710', 'HR@20': '0.1619', 'NDCG@20': '0.0820'}
2025-03-05 13:33:50,952 - Validation score increased.  Saving model ...
2025-03-05 13:34:33,435 - {'epoch': 24, 'rec_loss': '6.8842'}
2025-03-05 13:34:43,817 - {'Epoch': 24, 'HR@5': '0.0850', 'NDCG@5': '0.0598', 'HR@10': '0.1185', 'NDCG@10': '0.0706', 'HR@20': '0.1602', 'NDCG@20': '0.0812'}
2025-03-05 13:34:43,819 - EarlyStopping counter: 1 out of 10
2025-03-05 13:35:12,459 - {'epoch': 25, 'rec_loss': '6.8755'}
2025-03-05 13:35:20,713 - {'Epoch': 25, 'HR@5': '0.0870', 'NDCG@5': '0.0616', 'HR@10': '0.1186', 'NDCG@10': '0.0717', 'HR@20': '0.1626', 'NDCG@20': '0.0827'}
2025-03-05 13:35:20,718 - Validation score increased.  Saving model ...
2025-03-05 13:35:46,732 - {'epoch': 26, 'rec_loss': '6.8597'}
2025-03-05 13:35:57,040 - {'Epoch': 26, 'HR@5': '0.0868', 'NDCG@5': '0.0614', 'HR@10': '0.1205', 'NDCG@10': '0.0722', 'HR@20': '0.1626', 'NDCG@20': '0.0827'}
2025-03-05 13:35:57,041 - EarlyStopping counter: 1 out of 10
2025-03-05 13:36:40,542 - {'epoch': 27, 'rec_loss': '6.8533'}
2025-03-05 13:36:51,460 - {'Epoch': 27, 'HR@5': '0.0869', 'NDCG@5': '0.0608', 'HR@10': '0.1184', 'NDCG@10': '0.0711', 'HR@20': '0.1621', 'NDCG@20': '0.0821'}
2025-03-05 13:36:51,462 - EarlyStopping counter: 2 out of 10
2025-03-05 13:37:21,702 - {'epoch': 28, 'rec_loss': '6.8428'}
2025-03-05 13:37:29,888 - {'Epoch': 28, 'HR@5': '0.0845', 'NDCG@5': '0.0604', 'HR@10': '0.1172', 'NDCG@10': '0.0709', 'HR@20': '0.1600', 'NDCG@20': '0.0817'}
2025-03-05 13:37:29,889 - EarlyStopping counter: 3 out of 10
2025-03-05 13:37:56,018 - {'epoch': 29, 'rec_loss': '6.8348'}
2025-03-05 13:38:05,554 - {'Epoch': 29, 'HR@5': '0.0862', 'NDCG@5': '0.0610', 'HR@10': '0.1192', 'NDCG@10': '0.0716', 'HR@20': '0.1621', 'NDCG@20': '0.0824'}
2025-03-05 13:38:05,555 - EarlyStopping counter: 4 out of 10
2025-03-05 13:38:47,107 - {'epoch': 30, 'rec_loss': '6.8288'}
2025-03-05 13:38:57,566 - {'Epoch': 30, 'HR@5': '0.0862', 'NDCG@5': '0.0611', 'HR@10': '0.1195', 'NDCG@10': '0.0719', 'HR@20': '0.1617', 'NDCG@20': '0.0825'}
2025-03-05 13:38:57,567 - EarlyStopping counter: 5 out of 10
2025-03-05 13:39:30,870 - {'epoch': 31, 'rec_loss': '6.8163'}
2025-03-05 13:39:39,046 - {'Epoch': 31, 'HR@5': '0.0879', 'NDCG@5': '0.0619', 'HR@10': '0.1194', 'NDCG@10': '0.0721', 'HR@20': '0.1618', 'NDCG@20': '0.0827'}
2025-03-05 13:39:39,047 - EarlyStopping counter: 6 out of 10
2025-03-05 13:40:08,160 - {'epoch': 32, 'rec_loss': '6.8119'}
2025-03-05 13:40:16,813 - {'Epoch': 32, 'HR@5': '0.0867', 'NDCG@5': '0.0614', 'HR@10': '0.1193', 'NDCG@10': '0.0720', 'HR@20': '0.1629', 'NDCG@20': '0.0830'}
2025-03-05 13:40:16,815 - Validation score increased.  Saving model ...
2025-03-05 13:40:58,167 - {'epoch': 33, 'rec_loss': '6.8023'}
2025-03-05 13:41:08,402 - {'Epoch': 33, 'HR@5': '0.0887', 'NDCG@5': '0.0621', 'HR@10': '0.1205', 'NDCG@10': '0.0724', 'HR@20': '0.1634', 'NDCG@20': '0.0832'}
2025-03-05 13:41:08,403 - Validation score increased.  Saving model ...
2025-03-05 13:41:43,451 - {'epoch': 34, 'rec_loss': '6.7897'}
2025-03-05 13:41:51,919 - {'Epoch': 34, 'HR@5': '0.0868', 'NDCG@5': '0.0608', 'HR@10': '0.1179', 'NDCG@10': '0.0708', 'HR@20': '0.1625', 'NDCG@20': '0.0821'}
2025-03-05 13:41:51,920 - EarlyStopping counter: 1 out of 10
2025-03-05 13:42:20,921 - {'epoch': 35, 'rec_loss': '6.7864'}
2025-03-05 13:42:28,750 - {'Epoch': 35, 'HR@5': '0.0871', 'NDCG@5': '0.0614', 'HR@10': '0.1187', 'NDCG@10': '0.0716', 'HR@20': '0.1617', 'NDCG@20': '0.0824'}
2025-03-05 13:42:28,752 - EarlyStopping counter: 2 out of 10
2025-03-05 13:43:09,983 - {'epoch': 36, 'rec_loss': '6.7771'}
2025-03-05 13:43:20,490 - {'Epoch': 36, 'HR@5': '0.0870', 'NDCG@5': '0.0610', 'HR@10': '0.1197', 'NDCG@10': '0.0715', 'HR@20': '0.1629', 'NDCG@20': '0.0824'}
2025-03-05 13:43:20,492 - EarlyStopping counter: 3 out of 10
2025-03-05 13:43:56,266 - {'epoch': 37, 'rec_loss': '6.7692'}
2025-03-05 13:44:04,875 - {'Epoch': 37, 'HR@5': '0.0856', 'NDCG@5': '0.0606', 'HR@10': '0.1170', 'NDCG@10': '0.0707', 'HR@20': '0.1623', 'NDCG@20': '0.0821'}
2025-03-05 13:44:04,877 - EarlyStopping counter: 4 out of 10
2025-03-05 13:44:33,456 - {'epoch': 38, 'rec_loss': '6.7611'}
2025-03-05 13:44:42,934 - {'Epoch': 38, 'HR@5': '0.0859', 'NDCG@5': '0.0602', 'HR@10': '0.1182', 'NDCG@10': '0.0706', 'HR@20': '0.1622', 'NDCG@20': '0.0817'}
2025-03-05 13:44:42,935 - EarlyStopping counter: 5 out of 10
2025-03-05 13:45:23,605 - {'epoch': 39, 'rec_loss': '6.7553'}
2025-03-05 13:45:33,837 - {'Epoch': 39, 'HR@5': '0.0871', 'NDCG@5': '0.0618', 'HR@10': '0.1202', 'NDCG@10': '0.0725', 'HR@20': '0.1625', 'NDCG@20': '0.0832'}
2025-03-05 13:45:33,839 - Validation score increased.  Saving model ...
2025-03-05 13:46:08,275 - {'epoch': 40, 'rec_loss': '6.7484'}
2025-03-05 13:46:16,704 - {'Epoch': 40, 'HR@5': '0.0883', 'NDCG@5': '0.0610', 'HR@10': '0.1196', 'NDCG@10': '0.0710', 'HR@20': '0.1624', 'NDCG@20': '0.0818'}
2025-03-05 13:46:16,705 - EarlyStopping counter: 1 out of 10
2025-03-05 13:46:42,928 - {'epoch': 41, 'rec_loss': '6.7477'}
2025-03-05 13:46:51,507 - {'Epoch': 41, 'HR@5': '0.0867', 'NDCG@5': '0.0608', 'HR@10': '0.1188', 'NDCG@10': '0.0711', 'HR@20': '0.1599', 'NDCG@20': '0.0815'}
2025-03-05 13:46:51,508 - EarlyStopping counter: 2 out of 10
2025-03-05 13:47:32,793 - {'epoch': 42, 'rec_loss': '6.7424'}
2025-03-05 13:47:42,924 - {'Epoch': 42, 'HR@5': '0.0860', 'NDCG@5': '0.0612', 'HR@10': '0.1192', 'NDCG@10': '0.0719', 'HR@20': '0.1624', 'NDCG@20': '0.0827'}
2025-03-05 13:47:42,925 - EarlyStopping counter: 3 out of 10
2025-03-05 13:48:16,879 - {'epoch': 43, 'rec_loss': '6.7372'}
2025-03-05 13:48:24,696 - {'Epoch': 43, 'HR@5': '0.0882', 'NDCG@5': '0.0623', 'HR@10': '0.1197', 'NDCG@10': '0.0724', 'HR@20': '0.1622', 'NDCG@20': '0.0831'}
2025-03-05 13:48:24,697 - EarlyStopping counter: 4 out of 10
2025-03-05 13:48:50,828 - {'epoch': 44, 'rec_loss': '6.7274'}
2025-03-05 13:49:00,149 - {'Epoch': 44, 'HR@5': '0.0866', 'NDCG@5': '0.0608', 'HR@10': '0.1196', 'NDCG@10': '0.0714', 'HR@20': '0.1607', 'NDCG@20': '0.0818'}
2025-03-05 13:49:00,151 - EarlyStopping counter: 5 out of 10
2025-03-05 13:49:39,695 - {'epoch': 45, 'rec_loss': '6.7289'}
2025-03-05 13:49:49,918 - {'Epoch': 45, 'HR@5': '0.0868', 'NDCG@5': '0.0618', 'HR@10': '0.1197', 'NDCG@10': '0.0724', 'HR@20': '0.1617', 'NDCG@20': '0.0830'}
2025-03-05 13:49:49,919 - EarlyStopping counter: 6 out of 10
2025-03-05 13:50:22,970 - {'epoch': 46, 'rec_loss': '6.7157'}
2025-03-05 13:50:31,795 - {'Epoch': 46, 'HR@5': '0.0883', 'NDCG@5': '0.0617', 'HR@10': '0.1206', 'NDCG@10': '0.0720', 'HR@20': '0.1614', 'NDCG@20': '0.0823'}
2025-03-05 13:50:31,797 - EarlyStopping counter: 7 out of 10
2025-03-05 13:51:01,680 - {'epoch': 47, 'rec_loss': '6.7079'}
2025-03-05 13:51:10,248 - {'Epoch': 47, 'HR@5': '0.0871', 'NDCG@5': '0.0611', 'HR@10': '0.1203', 'NDCG@10': '0.0718', 'HR@20': '0.1633', 'NDCG@20': '0.0826'}
2025-03-05 13:51:10,249 - EarlyStopping counter: 8 out of 10
2025-03-05 13:51:50,060 - {'epoch': 48, 'rec_loss': '6.7118'}
2025-03-05 13:52:00,083 - {'Epoch': 48, 'HR@5': '0.0871', 'NDCG@5': '0.0610', 'HR@10': '0.1193', 'NDCG@10': '0.0714', 'HR@20': '0.1626', 'NDCG@20': '0.0823'}
2025-03-05 13:52:00,084 - EarlyStopping counter: 9 out of 10
2025-03-05 13:52:36,214 - {'epoch': 49, 'rec_loss': '6.7047'}
2025-03-05 13:52:44,235 - {'Epoch': 49, 'HR@5': '0.0877', 'NDCG@5': '0.0619', 'HR@10': '0.1189', 'NDCG@10': '0.0719', 'HR@20': '0.1611', 'NDCG@20': '0.0826'}
2025-03-05 13:52:44,236 - EarlyStopping counter: 10 out of 10
2025-03-05 13:52:44,237 - Early stopping
2025-03-05 13:52:44,237 - ---------------Test Score---------------
2025-03-05 13:52:52,132 - {'Epoch': 0, 'HR@5': '0.0699', 'NDCG@5': '0.0499', 'HR@10': '0.0994', 'NDCG@10': '0.0595', 'HR@20': '0.1370', 'NDCG@20': '0.0689'}
2025-03-05 13:52:52,133 - Scale_Beauty
2025-03-05 13:52:52,133 - {'Epoch': 0, 'HR@5': '0.0699', 'NDCG@5': '0.0499', 'HR@10': '0.0994', 'NDCG@10': '0.0595', 'HR@20': '0.1370', 'NDCG@20': '0.0689'}
2025-03-05 22:00:36,691 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 12, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-05 22:00:39,668 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-05 22:00:39,674 - Total Parameters: 929445
2025-03-05 22:01:08,459 - {'epoch': 0, 'rec_loss': '8.8632'}
2025-03-05 22:01:17,501 - {'Epoch': 0, 'HR@5': '0.0145', 'NDCG@5': '0.0090', 'HR@10': '0.0245', 'NDCG@10': '0.0123', 'HR@20': '0.0395', 'NDCG@20': '0.0161'}
2025-03-05 22:01:17,506 - Validation score increased.  Saving model ...
2025-03-05 22:01:43,497 - {'epoch': 1, 'rec_loss': '8.3961'}
2025-03-05 22:01:53,210 - {'Epoch': 1, 'HR@5': '0.0322', 'NDCG@5': '0.0218', 'HR@10': '0.0503', 'NDCG@10': '0.0276', 'HR@20': '0.0737', 'NDCG@20': '0.0334'}
2025-03-05 22:01:53,211 - Validation score increased.  Saving model ...
2025-03-05 22:02:20,223 - {'epoch': 2, 'rec_loss': '8.0949'}
2025-03-05 22:02:29,734 - {'Epoch': 2, 'HR@5': '0.0437', 'NDCG@5': '0.0300', 'HR@10': '0.0654', 'NDCG@10': '0.0370', 'HR@20': '0.0938', 'NDCG@20': '0.0442'}
2025-03-05 22:02:29,735 - Validation score increased.  Saving model ...
2025-03-05 22:02:57,335 - {'epoch': 3, 'rec_loss': '7.8791'}
2025-03-05 22:03:06,858 - {'Epoch': 3, 'HR@5': '0.0548', 'NDCG@5': '0.0367', 'HR@10': '0.0792', 'NDCG@10': '0.0446', 'HR@20': '0.1136', 'NDCG@20': '0.0532'}
2025-03-05 22:03:06,860 - Validation score increased.  Saving model ...
2025-03-05 22:03:34,261 - {'epoch': 4, 'rec_loss': '7.7142'}
2025-03-05 22:03:43,281 - {'Epoch': 4, 'HR@5': '0.0625', 'NDCG@5': '0.0431', 'HR@10': '0.0890', 'NDCG@10': '0.0516', 'HR@20': '0.1242', 'NDCG@20': '0.0605'}
2025-03-05 22:03:43,282 - Validation score increased.  Saving model ...
2025-03-05 22:04:12,253 - {'epoch': 5, 'rec_loss': '7.5993'}
2025-03-05 22:04:21,386 - {'Epoch': 5, 'HR@5': '0.0685', 'NDCG@5': '0.0475', 'HR@10': '0.0975', 'NDCG@10': '0.0568', 'HR@20': '0.1327', 'NDCG@20': '0.0657'}
2025-03-05 22:04:21,395 - Validation score increased.  Saving model ...
2025-03-05 22:04:49,174 - {'epoch': 6, 'rec_loss': '7.5067'}
2025-03-05 22:04:58,451 - {'Epoch': 6, 'HR@5': '0.0721', 'NDCG@5': '0.0508', 'HR@10': '0.0997', 'NDCG@10': '0.0596', 'HR@20': '0.1376', 'NDCG@20': '0.0692'}
2025-03-05 22:04:58,452 - Validation score increased.  Saving model ...
2025-03-05 22:05:24,453 - {'epoch': 7, 'rec_loss': '7.4251'}
2025-03-05 22:05:33,393 - {'Epoch': 7, 'HR@5': '0.0751', 'NDCG@5': '0.0533', 'HR@10': '0.1045', 'NDCG@10': '0.0628', 'HR@20': '0.1423', 'NDCG@20': '0.0723'}
2025-03-05 22:05:33,395 - Validation score increased.  Saving model ...
2025-03-05 22:05:59,449 - {'epoch': 8, 'rec_loss': '7.3564'}
2025-03-05 22:06:08,354 - {'Epoch': 8, 'HR@5': '0.0793', 'NDCG@5': '0.0561', 'HR@10': '0.1061', 'NDCG@10': '0.0648', 'HR@20': '0.1442', 'NDCG@20': '0.0744'}
2025-03-05 22:06:08,355 - Validation score increased.  Saving model ...
2025-03-05 22:06:34,879 - {'epoch': 9, 'rec_loss': '7.3057'}
2025-03-05 22:06:43,904 - {'Epoch': 9, 'HR@5': '0.0783', 'NDCG@5': '0.0549', 'HR@10': '0.1090', 'NDCG@10': '0.0649', 'HR@20': '0.1470', 'NDCG@20': '0.0744'}
2025-03-05 22:06:43,906 - Validation score increased.  Saving model ...
2025-03-05 22:07:11,296 - {'epoch': 10, 'rec_loss': '7.2601'}
2025-03-05 22:07:20,677 - {'Epoch': 10, 'HR@5': '0.0791', 'NDCG@5': '0.0561', 'HR@10': '0.1083', 'NDCG@10': '0.0655', 'HR@20': '0.1470', 'NDCG@20': '0.0752'}
2025-03-05 22:07:20,678 - Validation score increased.  Saving model ...
2025-03-05 22:07:49,073 - {'epoch': 11, 'rec_loss': '7.2237'}
2025-03-05 22:07:58,630 - {'Epoch': 11, 'HR@5': '0.0808', 'NDCG@5': '0.0578', 'HR@10': '0.1096', 'NDCG@10': '0.0671', 'HR@20': '0.1479', 'NDCG@20': '0.0767'}
2025-03-05 22:07:58,631 - Validation score increased.  Saving model ...
2025-03-05 22:08:26,503 - {'epoch': 12, 'rec_loss': '7.1863'}
2025-03-05 22:08:35,668 - {'Epoch': 12, 'HR@5': '0.0822', 'NDCG@5': '0.0585', 'HR@10': '0.1110', 'NDCG@10': '0.0678', 'HR@20': '0.1499', 'NDCG@20': '0.0776'}
2025-03-05 22:08:35,670 - Validation score increased.  Saving model ...
2025-03-05 22:09:03,550 - {'epoch': 13, 'rec_loss': '7.1596'}
2025-03-05 22:09:13,148 - {'Epoch': 13, 'HR@5': '0.0830', 'NDCG@5': '0.0585', 'HR@10': '0.1127', 'NDCG@10': '0.0680', 'HR@20': '0.1497', 'NDCG@20': '0.0773'}
2025-03-05 22:09:13,157 - EarlyStopping counter: 1 out of 10
2025-03-05 22:09:39,884 - {'epoch': 14, 'rec_loss': '7.1306'}
2025-03-05 22:09:49,202 - {'Epoch': 14, 'HR@5': '0.0839', 'NDCG@5': '0.0590', 'HR@10': '0.1142', 'NDCG@10': '0.0688', 'HR@20': '0.1515', 'NDCG@20': '0.0781'}
2025-03-05 22:09:49,203 - Validation score increased.  Saving model ...
2025-03-05 22:10:16,288 - {'epoch': 15, 'rec_loss': '7.1092'}
2025-03-05 22:10:25,512 - {'Epoch': 15, 'HR@5': '0.0829', 'NDCG@5': '0.0586', 'HR@10': '0.1132', 'NDCG@10': '0.0684', 'HR@20': '0.1526', 'NDCG@20': '0.0783'}
2025-03-05 22:10:25,514 - Validation score increased.  Saving model ...
2025-03-05 22:10:53,884 - {'epoch': 16, 'rec_loss': '7.0898'}
2025-03-05 22:11:03,090 - {'Epoch': 16, 'HR@5': '0.0835', 'NDCG@5': '0.0590', 'HR@10': '0.1139', 'NDCG@10': '0.0688', 'HR@20': '0.1530', 'NDCG@20': '0.0786'}
2025-03-05 22:11:03,091 - Validation score increased.  Saving model ...
2025-03-05 22:11:29,163 - {'epoch': 17, 'rec_loss': '7.0711'}
2025-03-05 22:11:39,039 - {'Epoch': 17, 'HR@5': '0.0831', 'NDCG@5': '0.0586', 'HR@10': '0.1139', 'NDCG@10': '0.0685', 'HR@20': '0.1528', 'NDCG@20': '0.0783'}
2025-03-05 22:11:39,041 - EarlyStopping counter: 1 out of 10
2025-03-05 22:12:07,373 - {'epoch': 18, 'rec_loss': '7.0440'}
2025-03-05 22:12:16,226 - {'Epoch': 18, 'HR@5': '0.0828', 'NDCG@5': '0.0591', 'HR@10': '0.1126', 'NDCG@10': '0.0687', 'HR@20': '0.1518', 'NDCG@20': '0.0786'}
2025-03-05 22:12:16,227 - EarlyStopping counter: 2 out of 10
2025-03-05 22:12:44,075 - {'epoch': 19, 'rec_loss': '7.0335'}
2025-03-05 22:12:53,896 - {'Epoch': 19, 'HR@5': '0.0833', 'NDCG@5': '0.0595', 'HR@10': '0.1147', 'NDCG@10': '0.0696', 'HR@20': '0.1545', 'NDCG@20': '0.0797'}
2025-03-05 22:12:53,898 - Validation score increased.  Saving model ...
2025-03-05 22:13:22,102 - {'epoch': 20, 'rec_loss': '7.0141'}
2025-03-05 22:13:31,597 - {'Epoch': 20, 'HR@5': '0.0844', 'NDCG@5': '0.0600', 'HR@10': '0.1157', 'NDCG@10': '0.0701', 'HR@20': '0.1551', 'NDCG@20': '0.0800'}
2025-03-05 22:13:31,599 - Validation score increased.  Saving model ...
2025-03-05 22:14:00,323 - {'epoch': 21, 'rec_loss': '7.0065'}
2025-03-05 22:14:09,380 - {'Epoch': 21, 'HR@5': '0.0858', 'NDCG@5': '0.0606', 'HR@10': '0.1155', 'NDCG@10': '0.0702', 'HR@20': '0.1547', 'NDCG@20': '0.0800'}
2025-03-05 22:14:09,381 - EarlyStopping counter: 1 out of 10
2025-03-05 22:14:35,963 - {'epoch': 22, 'rec_loss': '6.9959'}
2025-03-05 22:14:45,038 - {'Epoch': 22, 'HR@5': '0.0842', 'NDCG@5': '0.0601', 'HR@10': '0.1155', 'NDCG@10': '0.0701', 'HR@20': '0.1555', 'NDCG@20': '0.0802'}
2025-03-05 22:14:45,040 - Validation score increased.  Saving model ...
2025-03-05 22:15:11,549 - {'epoch': 23, 'rec_loss': '6.9774'}
2025-03-05 22:15:20,390 - {'Epoch': 23, 'HR@5': '0.0850', 'NDCG@5': '0.0609', 'HR@10': '0.1137', 'NDCG@10': '0.0701', 'HR@20': '0.1549', 'NDCG@20': '0.0805'}
2025-03-05 22:15:20,391 - Validation score increased.  Saving model ...
2025-03-05 22:15:46,772 - {'epoch': 24, 'rec_loss': '6.9721'}
2025-03-05 22:15:55,885 - {'Epoch': 24, 'HR@5': '0.0843', 'NDCG@5': '0.0606', 'HR@10': '0.1154', 'NDCG@10': '0.0706', 'HR@20': '0.1555', 'NDCG@20': '0.0807'}
2025-03-05 22:15:55,887 - Validation score increased.  Saving model ...
2025-03-05 22:16:21,665 - {'epoch': 25, 'rec_loss': '6.9525'}
2025-03-05 22:16:30,579 - {'Epoch': 25, 'HR@5': '0.0841', 'NDCG@5': '0.0600', 'HR@10': '0.1150', 'NDCG@10': '0.0700', 'HR@20': '0.1573', 'NDCG@20': '0.0807'}
2025-03-05 22:16:30,587 - Validation score increased.  Saving model ...
2025-03-05 22:16:58,050 - {'epoch': 26, 'rec_loss': '6.9469'}
2025-03-05 22:17:07,161 - {'Epoch': 26, 'HR@5': '0.0849', 'NDCG@5': '0.0606', 'HR@10': '0.1147', 'NDCG@10': '0.0702', 'HR@20': '0.1567', 'NDCG@20': '0.0808'}
2025-03-05 22:17:07,163 - Validation score increased.  Saving model ...
2025-03-05 22:17:33,411 - {'epoch': 27, 'rec_loss': '6.9352'}
2025-03-05 22:17:43,406 - {'Epoch': 27, 'HR@5': '0.0850', 'NDCG@5': '0.0609', 'HR@10': '0.1155', 'NDCG@10': '0.0707', 'HR@20': '0.1569', 'NDCG@20': '0.0811'}
2025-03-05 22:17:43,407 - Validation score increased.  Saving model ...
2025-03-05 22:18:10,270 - {'epoch': 28, 'rec_loss': '6.9291'}
2025-03-05 22:18:19,423 - {'Epoch': 28, 'HR@5': '0.0863', 'NDCG@5': '0.0608', 'HR@10': '0.1162', 'NDCG@10': '0.0704', 'HR@20': '0.1560', 'NDCG@20': '0.0805'}
2025-03-05 22:18:19,424 - EarlyStopping counter: 1 out of 10
2025-03-05 22:18:46,990 - {'epoch': 29, 'rec_loss': '6.9239'}
2025-03-05 22:18:55,897 - {'Epoch': 29, 'HR@5': '0.0859', 'NDCG@5': '0.0603', 'HR@10': '0.1172', 'NDCG@10': '0.0705', 'HR@20': '0.1570', 'NDCG@20': '0.0805'}
2025-03-05 22:18:55,898 - EarlyStopping counter: 2 out of 10
2025-03-05 22:19:23,209 - {'epoch': 30, 'rec_loss': '6.9102'}
2025-03-05 22:19:32,485 - {'Epoch': 30, 'HR@5': '0.0861', 'NDCG@5': '0.0614', 'HR@10': '0.1168', 'NDCG@10': '0.0713', 'HR@20': '0.1602', 'NDCG@20': '0.0823'}
2025-03-05 22:19:32,486 - Validation score increased.  Saving model ...
2025-03-05 22:19:59,472 - {'epoch': 31, 'rec_loss': '6.8991'}
2025-03-05 22:20:09,093 - {'Epoch': 31, 'HR@5': '0.0863', 'NDCG@5': '0.0616', 'HR@10': '0.1171', 'NDCG@10': '0.0715', 'HR@20': '0.1587', 'NDCG@20': '0.0820'}
2025-03-05 22:20:09,094 - EarlyStopping counter: 1 out of 10
2025-03-05 22:20:35,727 - {'epoch': 32, 'rec_loss': '6.8994'}
2025-03-05 22:20:44,978 - {'Epoch': 32, 'HR@5': '0.0849', 'NDCG@5': '0.0606', 'HR@10': '0.1178', 'NDCG@10': '0.0711', 'HR@20': '0.1572', 'NDCG@20': '0.0810'}
2025-03-05 22:20:44,980 - EarlyStopping counter: 2 out of 10
2025-03-05 22:21:12,287 - {'epoch': 33, 'rec_loss': '6.8926'}
2025-03-05 22:21:21,590 - {'Epoch': 33, 'HR@5': '0.0857', 'NDCG@5': '0.0612', 'HR@10': '0.1166', 'NDCG@10': '0.0712', 'HR@20': '0.1578', 'NDCG@20': '0.0816'}
2025-03-05 22:21:21,591 - EarlyStopping counter: 3 out of 10
2025-03-05 22:21:50,371 - {'epoch': 34, 'rec_loss': '6.8743'}
2025-03-05 22:21:59,714 - {'Epoch': 34, 'HR@5': '0.0862', 'NDCG@5': '0.0612', 'HR@10': '0.1168', 'NDCG@10': '0.0711', 'HR@20': '0.1590', 'NDCG@20': '0.0817'}
2025-03-05 22:21:59,723 - EarlyStopping counter: 4 out of 10
2025-03-05 22:22:27,041 - {'epoch': 35, 'rec_loss': '6.8695'}
2025-03-05 22:22:36,273 - {'Epoch': 35, 'HR@5': '0.0843', 'NDCG@5': '0.0600', 'HR@10': '0.1168', 'NDCG@10': '0.0704', 'HR@20': '0.1582', 'NDCG@20': '0.0809'}
2025-03-05 22:22:36,274 - EarlyStopping counter: 5 out of 10
2025-03-05 22:23:03,764 - {'epoch': 36, 'rec_loss': '6.8679'}
2025-03-05 22:23:13,177 - {'Epoch': 36, 'HR@5': '0.0851', 'NDCG@5': '0.0610', 'HR@10': '0.1184', 'NDCG@10': '0.0717', 'HR@20': '0.1604', 'NDCG@20': '0.0823'}
2025-03-05 22:23:13,178 - EarlyStopping counter: 6 out of 10
2025-03-05 22:23:40,712 - {'epoch': 37, 'rec_loss': '6.8532'}
2025-03-05 22:23:50,303 - {'Epoch': 37, 'HR@5': '0.0860', 'NDCG@5': '0.0613', 'HR@10': '0.1177', 'NDCG@10': '0.0716', 'HR@20': '0.1600', 'NDCG@20': '0.0822'}
2025-03-05 22:23:50,304 - EarlyStopping counter: 7 out of 10
2025-03-05 22:24:16,422 - {'epoch': 38, 'rec_loss': '6.8526'}
2025-03-05 22:24:25,430 - {'Epoch': 38, 'HR@5': '0.0863', 'NDCG@5': '0.0613', 'HR@10': '0.1168', 'NDCG@10': '0.0711', 'HR@20': '0.1585', 'NDCG@20': '0.0816'}
2025-03-05 22:24:25,432 - EarlyStopping counter: 8 out of 10
2025-03-05 22:24:53,293 - {'epoch': 39, 'rec_loss': '6.8473'}
2025-03-05 22:25:02,484 - {'Epoch': 39, 'HR@5': '0.0849', 'NDCG@5': '0.0607', 'HR@10': '0.1156', 'NDCG@10': '0.0706', 'HR@20': '0.1574', 'NDCG@20': '0.0811'}
2025-03-05 22:25:02,492 - EarlyStopping counter: 9 out of 10
2025-03-05 22:25:29,469 - {'epoch': 40, 'rec_loss': '6.8462'}
2025-03-05 22:25:39,214 - {'Epoch': 40, 'HR@5': '0.0853', 'NDCG@5': '0.0615', 'HR@10': '0.1164', 'NDCG@10': '0.0714', 'HR@20': '0.1585', 'NDCG@20': '0.0821'}
2025-03-05 22:25:39,218 - EarlyStopping counter: 10 out of 10
2025-03-05 22:25:39,219 - Early stopping
2025-03-05 22:25:39,219 - ---------------Test Score---------------
2025-03-05 22:25:48,513 - {'Epoch': 0, 'HR@5': '0.0697', 'NDCG@5': '0.0499', 'HR@10': '0.0949', 'NDCG@10': '0.0580', 'HR@20': '0.1279', 'NDCG@20': '0.0663'}
2025-03-05 22:25:48,514 - Scale_Beauty
2025-03-05 22:25:48,514 - {'Epoch': 0, 'HR@5': '0.0697', 'NDCG@5': '0.0499', 'HR@10': '0.0949', 'NDCG@10': '0.0580', 'HR@20': '0.1279', 'NDCG@20': '0.0663'}
2025-03-06 15:35:43,881 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 12, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-06 15:35:47,636 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-06 15:35:47,642 - Total Parameters: 929445
2025-03-06 15:36:14,421 - {'epoch': 0, 'rec_loss': '8.8428'}
2025-03-06 15:36:23,402 - {'Epoch': 0, 'HR@5': '0.0193', 'NDCG@5': '0.0119', 'HR@10': '0.0294', 'NDCG@10': '0.0152', 'HR@20': '0.0465', 'NDCG@20': '0.0195'}
2025-03-06 15:36:23,403 - Validation score increased.  Saving model ...
2025-03-06 15:36:49,993 - {'epoch': 1, 'rec_loss': '8.3256'}
2025-03-06 15:36:58,997 - {'Epoch': 1, 'HR@5': '0.0368', 'NDCG@5': '0.0246', 'HR@10': '0.0563', 'NDCG@10': '0.0309', 'HR@20': '0.0815', 'NDCG@20': '0.0372'}
2025-03-06 15:36:58,998 - Validation score increased.  Saving model ...
2025-03-06 15:37:28,553 - {'epoch': 2, 'rec_loss': '8.0166'}
2025-03-06 15:37:38,023 - {'Epoch': 2, 'HR@5': '0.0486', 'NDCG@5': '0.0330', 'HR@10': '0.0728', 'NDCG@10': '0.0408', 'HR@20': '0.1022', 'NDCG@20': '0.0482'}
2025-03-06 15:37:38,028 - Validation score increased.  Saving model ...
2025-03-06 15:38:07,983 - {'epoch': 3, 'rec_loss': '7.8039'}
2025-03-06 15:38:17,154 - {'Epoch': 3, 'HR@5': '0.0591', 'NDCG@5': '0.0401', 'HR@10': '0.0862', 'NDCG@10': '0.0488', 'HR@20': '0.1207', 'NDCG@20': '0.0575'}
2025-03-06 15:38:17,155 - Validation score increased.  Saving model ...
2025-03-06 15:38:46,434 - {'epoch': 4, 'rec_loss': '7.6416'}
2025-03-06 15:38:54,976 - {'Epoch': 4, 'HR@5': '0.0674', 'NDCG@5': '0.0467', 'HR@10': '0.0944', 'NDCG@10': '0.0554', 'HR@20': '0.1311', 'NDCG@20': '0.0646'}
2025-03-06 15:38:54,977 - Validation score increased.  Saving model ...
2025-03-06 15:39:21,491 - {'epoch': 5, 'rec_loss': '7.5267'}
2025-03-06 15:39:30,106 - {'Epoch': 5, 'HR@5': '0.0728', 'NDCG@5': '0.0508', 'HR@10': '0.1018', 'NDCG@10': '0.0601', 'HR@20': '0.1381', 'NDCG@20': '0.0692'}
2025-03-06 15:39:30,107 - Validation score increased.  Saving model ...
2025-03-06 15:39:55,966 - {'epoch': 6, 'rec_loss': '7.4283'}
2025-03-06 15:40:04,654 - {'Epoch': 6, 'HR@5': '0.0758', 'NDCG@5': '0.0533', 'HR@10': '0.1049', 'NDCG@10': '0.0626', 'HR@20': '0.1454', 'NDCG@20': '0.0728'}
2025-03-06 15:40:04,656 - Validation score increased.  Saving model ...
2025-03-06 15:40:30,794 - {'epoch': 7, 'rec_loss': '7.3473'}
2025-03-06 15:40:40,306 - {'Epoch': 7, 'HR@5': '0.0798', 'NDCG@5': '0.0562', 'HR@10': '0.1082', 'NDCG@10': '0.0653', 'HR@20': '0.1488', 'NDCG@20': '0.0756'}
2025-03-06 15:40:40,308 - Validation score increased.  Saving model ...
2025-03-06 15:41:07,226 - {'epoch': 8, 'rec_loss': '7.2783'}
2025-03-06 15:41:16,513 - {'Epoch': 8, 'HR@5': '0.0814', 'NDCG@5': '0.0581', 'HR@10': '0.1102', 'NDCG@10': '0.0674', 'HR@20': '0.1500', 'NDCG@20': '0.0774'}
2025-03-06 15:41:16,515 - Validation score increased.  Saving model ...
2025-03-06 15:41:44,759 - {'epoch': 9, 'rec_loss': '7.2290'}
2025-03-06 15:41:53,777 - {'Epoch': 9, 'HR@5': '0.0831', 'NDCG@5': '0.0580', 'HR@10': '0.1129', 'NDCG@10': '0.0676', 'HR@20': '0.1517', 'NDCG@20': '0.0774'}
2025-03-06 15:41:53,778 - EarlyStopping counter: 1 out of 10
2025-03-06 15:42:17,990 - {'epoch': 10, 'rec_loss': '7.1815'}
2025-03-06 15:42:27,462 - {'Epoch': 10, 'HR@5': '0.0842', 'NDCG@5': '0.0594', 'HR@10': '0.1132', 'NDCG@10': '0.0687', 'HR@20': '0.1521', 'NDCG@20': '0.0784'}
2025-03-06 15:42:27,463 - Validation score increased.  Saving model ...
2025-03-06 15:42:52,395 - {'epoch': 11, 'rec_loss': '7.1438'}
2025-03-06 15:43:01,311 - {'Epoch': 11, 'HR@5': '0.0839', 'NDCG@5': '0.0596', 'HR@10': '0.1152', 'NDCG@10': '0.0697', 'HR@20': '0.1536', 'NDCG@20': '0.0793'}
2025-03-06 15:43:01,318 - Validation score increased.  Saving model ...
2025-03-06 15:43:27,497 - {'epoch': 12, 'rec_loss': '7.1058'}
2025-03-06 15:43:37,140 - {'Epoch': 12, 'HR@5': '0.0838', 'NDCG@5': '0.0594', 'HR@10': '0.1149', 'NDCG@10': '0.0693', 'HR@20': '0.1568', 'NDCG@20': '0.0799'}
2025-03-06 15:43:37,141 - Validation score increased.  Saving model ...
2025-03-06 15:44:04,344 - {'epoch': 13, 'rec_loss': '7.0823'}
2025-03-06 15:44:13,711 - {'Epoch': 13, 'HR@5': '0.0849', 'NDCG@5': '0.0597', 'HR@10': '0.1177', 'NDCG@10': '0.0703', 'HR@20': '0.1574', 'NDCG@20': '0.0803'}
2025-03-06 15:44:13,712 - Validation score increased.  Saving model ...
2025-03-06 15:44:40,933 - {'epoch': 14, 'rec_loss': '7.0529'}
2025-03-06 15:44:50,411 - {'Epoch': 14, 'HR@5': '0.0872', 'NDCG@5': '0.0607', 'HR@10': '0.1181', 'NDCG@10': '0.0706', 'HR@20': '0.1580', 'NDCG@20': '0.0807'}
2025-03-06 15:44:50,412 - Validation score increased.  Saving model ...
2025-03-06 15:45:14,346 - {'epoch': 15, 'rec_loss': '7.0351'}
2025-03-06 15:45:23,553 - {'Epoch': 15, 'HR@5': '0.0868', 'NDCG@5': '0.0605', 'HR@10': '0.1181', 'NDCG@10': '0.0705', 'HR@20': '0.1603', 'NDCG@20': '0.0812'}
2025-03-06 15:45:23,555 - Validation score increased.  Saving model ...
2025-03-06 15:45:48,624 - {'epoch': 16, 'rec_loss': '7.0108'}
2025-03-06 15:45:57,787 - {'Epoch': 16, 'HR@5': '0.0852', 'NDCG@5': '0.0600', 'HR@10': '0.1172', 'NDCG@10': '0.0703', 'HR@20': '0.1601', 'NDCG@20': '0.0811'}
2025-03-06 15:45:57,788 - EarlyStopping counter: 1 out of 10
2025-03-06 15:46:23,342 - {'epoch': 17, 'rec_loss': '6.9943'}
2025-03-06 15:46:32,975 - {'Epoch': 17, 'HR@5': '0.0846', 'NDCG@5': '0.0600', 'HR@10': '0.1185', 'NDCG@10': '0.0710', 'HR@20': '0.1595', 'NDCG@20': '0.0813'}
2025-03-06 15:46:32,977 - Validation score increased.  Saving model ...
2025-03-06 15:46:59,848 - {'epoch': 18, 'rec_loss': '6.9642'}
2025-03-06 15:47:09,571 - {'Epoch': 18, 'HR@5': '0.0862', 'NDCG@5': '0.0608', 'HR@10': '0.1183', 'NDCG@10': '0.0711', 'HR@20': '0.1605', 'NDCG@20': '0.0817'}
2025-03-06 15:47:09,573 - Validation score increased.  Saving model ...
2025-03-06 15:47:36,031 - {'epoch': 19, 'rec_loss': '6.9540'}
2025-03-06 15:47:45,755 - {'Epoch': 19, 'HR@5': '0.0863', 'NDCG@5': '0.0608', 'HR@10': '0.1199', 'NDCG@10': '0.0717', 'HR@20': '0.1610', 'NDCG@20': '0.0820'}
2025-03-06 15:47:45,757 - Validation score increased.  Saving model ...
2025-03-06 15:48:11,650 - {'epoch': 20, 'rec_loss': '6.9333'}
2025-03-06 15:48:20,776 - {'Epoch': 20, 'HR@5': '0.0868', 'NDCG@5': '0.0614', 'HR@10': '0.1217', 'NDCG@10': '0.0726', 'HR@20': '0.1631', 'NDCG@20': '0.0830'}
2025-03-06 15:48:20,781 - Validation score increased.  Saving model ...
2025-03-06 15:48:46,133 - {'epoch': 21, 'rec_loss': '6.9250'}
2025-03-06 15:48:55,097 - {'Epoch': 21, 'HR@5': '0.0870', 'NDCG@5': '0.0609', 'HR@10': '0.1195', 'NDCG@10': '0.0714', 'HR@20': '0.1628', 'NDCG@20': '0.0823'}
2025-03-06 15:48:55,098 - EarlyStopping counter: 1 out of 10
2025-03-06 15:49:23,191 - {'epoch': 22, 'rec_loss': '6.9153'}
2025-03-06 15:49:32,790 - {'Epoch': 22, 'HR@5': '0.0872', 'NDCG@5': '0.0614', 'HR@10': '0.1205', 'NDCG@10': '0.0721', 'HR@20': '0.1636', 'NDCG@20': '0.0830'}
2025-03-06 15:49:32,791 - EarlyStopping counter: 2 out of 10
2025-03-06 15:50:02,163 - {'epoch': 23, 'rec_loss': '6.8980'}
2025-03-06 15:50:12,059 - {'Epoch': 23, 'HR@5': '0.0874', 'NDCG@5': '0.0619', 'HR@10': '0.1202', 'NDCG@10': '0.0724', 'HR@20': '0.1624', 'NDCG@20': '0.0831'}
2025-03-06 15:50:12,065 - Validation score increased.  Saving model ...
2025-03-06 15:50:42,047 - {'epoch': 24, 'rec_loss': '6.8895'}
2025-03-06 15:50:51,984 - {'Epoch': 24, 'HR@5': '0.0862', 'NDCG@5': '0.0612', 'HR@10': '0.1196', 'NDCG@10': '0.0719', 'HR@20': '0.1628', 'NDCG@20': '0.0828'}
2025-03-06 15:50:51,985 - EarlyStopping counter: 1 out of 10
2025-03-06 15:51:18,856 - {'epoch': 25, 'rec_loss': '6.8706'}
2025-03-06 15:51:27,692 - {'Epoch': 25, 'HR@5': '0.0860', 'NDCG@5': '0.0608', 'HR@10': '0.1192', 'NDCG@10': '0.0715', 'HR@20': '0.1633', 'NDCG@20': '0.0826'}
2025-03-06 15:51:27,694 - EarlyStopping counter: 2 out of 10
2025-03-06 15:51:54,440 - {'epoch': 26, 'rec_loss': '6.8688'}
2025-03-06 15:52:04,375 - {'Epoch': 26, 'HR@5': '0.0865', 'NDCG@5': '0.0614', 'HR@10': '0.1207', 'NDCG@10': '0.0724', 'HR@20': '0.1630', 'NDCG@20': '0.0830'}
2025-03-06 15:52:04,377 - EarlyStopping counter: 3 out of 10
2025-03-06 15:52:31,809 - {'epoch': 27, 'rec_loss': '6.8526'}
2025-03-06 15:52:41,392 - {'Epoch': 27, 'HR@5': '0.0870', 'NDCG@5': '0.0619', 'HR@10': '0.1189', 'NDCG@10': '0.0721', 'HR@20': '0.1625', 'NDCG@20': '0.0831'}
2025-03-06 15:52:41,393 - Validation score increased.  Saving model ...
2025-03-06 15:53:11,782 - {'epoch': 28, 'rec_loss': '6.8478'}
2025-03-06 15:53:21,705 - {'Epoch': 28, 'HR@5': '0.0891', 'NDCG@5': '0.0621', 'HR@10': '0.1207', 'NDCG@10': '0.0722', 'HR@20': '0.1625', 'NDCG@20': '0.0827'}
2025-03-06 15:53:21,707 - EarlyStopping counter: 1 out of 10
2025-03-06 15:53:51,186 - {'epoch': 29, 'rec_loss': '6.8408'}
2025-03-06 15:54:01,185 - {'Epoch': 29, 'HR@5': '0.0863', 'NDCG@5': '0.0604', 'HR@10': '0.1200', 'NDCG@10': '0.0713', 'HR@20': '0.1635', 'NDCG@20': '0.0822'}
2025-03-06 15:54:01,186 - EarlyStopping counter: 2 out of 10
2025-03-06 15:54:30,005 - {'epoch': 30, 'rec_loss': '6.8287'}
2025-03-06 15:54:38,822 - {'Epoch': 30, 'HR@5': '0.0870', 'NDCG@5': '0.0617', 'HR@10': '0.1196', 'NDCG@10': '0.0722', 'HR@20': '0.1650', 'NDCG@20': '0.0836'}
2025-03-06 15:54:38,824 - Validation score increased.  Saving model ...
2025-03-06 15:55:05,919 - {'epoch': 31, 'rec_loss': '6.8175'}
2025-03-06 15:55:15,237 - {'Epoch': 31, 'HR@5': '0.0867', 'NDCG@5': '0.0620', 'HR@10': '0.1202', 'NDCG@10': '0.0728', 'HR@20': '0.1634', 'NDCG@20': '0.0837'}
2025-03-06 15:55:15,239 - Validation score increased.  Saving model ...
2025-03-06 15:55:44,316 - {'epoch': 32, 'rec_loss': '6.8147'}
2025-03-06 15:55:53,947 - {'Epoch': 32, 'HR@5': '0.0864', 'NDCG@5': '0.0614', 'HR@10': '0.1202', 'NDCG@10': '0.0722', 'HR@20': '0.1629', 'NDCG@20': '0.0831'}
2025-03-06 15:55:53,948 - EarlyStopping counter: 1 out of 10
2025-03-06 15:56:21,359 - {'epoch': 33, 'rec_loss': '6.8081'}
2025-03-06 15:56:31,253 - {'Epoch': 33, 'HR@5': '0.0864', 'NDCG@5': '0.0610', 'HR@10': '0.1185', 'NDCG@10': '0.0714', 'HR@20': '0.1618', 'NDCG@20': '0.0823'}
2025-03-06 15:56:31,254 - EarlyStopping counter: 2 out of 10
2025-03-06 15:56:59,711 - {'epoch': 34, 'rec_loss': '6.7943'}
2025-03-06 15:57:09,566 - {'Epoch': 34, 'HR@5': '0.0870', 'NDCG@5': '0.0615', 'HR@10': '0.1202', 'NDCG@10': '0.0722', 'HR@20': '0.1612', 'NDCG@20': '0.0825'}
2025-03-06 15:57:09,567 - EarlyStopping counter: 3 out of 10
2025-03-06 15:57:38,109 - {'epoch': 35, 'rec_loss': '6.7873'}
2025-03-06 15:57:47,177 - {'Epoch': 35, 'HR@5': '0.0868', 'NDCG@5': '0.0615', 'HR@10': '0.1194', 'NDCG@10': '0.0720', 'HR@20': '0.1629', 'NDCG@20': '0.0829'}
2025-03-06 15:57:47,179 - EarlyStopping counter: 4 out of 10
2025-03-06 15:58:14,031 - {'epoch': 36, 'rec_loss': '6.7826'}
2025-03-06 15:58:23,151 - {'Epoch': 36, 'HR@5': '0.0864', 'NDCG@5': '0.0617', 'HR@10': '0.1201', 'NDCG@10': '0.0725', 'HR@20': '0.1634', 'NDCG@20': '0.0834'}
2025-03-06 15:58:23,153 - EarlyStopping counter: 5 out of 10
2025-03-06 15:58:49,579 - {'epoch': 37, 'rec_loss': '6.7669'}
2025-03-06 15:58:58,964 - {'Epoch': 37, 'HR@5': '0.0855', 'NDCG@5': '0.0602', 'HR@10': '0.1200', 'NDCG@10': '0.0714', 'HR@20': '0.1643', 'NDCG@20': '0.0825'}
2025-03-06 15:58:58,965 - EarlyStopping counter: 6 out of 10
2025-03-06 15:59:26,666 - {'epoch': 38, 'rec_loss': '6.7667'}
2025-03-06 15:59:36,972 - {'Epoch': 38, 'HR@5': '0.0862', 'NDCG@5': '0.0606', 'HR@10': '0.1198', 'NDCG@10': '0.0714', 'HR@20': '0.1628', 'NDCG@20': '0.0822'}
2025-03-06 15:59:36,975 - EarlyStopping counter: 7 out of 10
2025-03-06 16:00:06,577 - {'epoch': 39, 'rec_loss': '6.7635'}
2025-03-06 16:00:16,958 - {'Epoch': 39, 'HR@5': '0.0852', 'NDCG@5': '0.0597', 'HR@10': '0.1179', 'NDCG@10': '0.0703', 'HR@20': '0.1613', 'NDCG@20': '0.0812'}
2025-03-06 16:00:16,960 - EarlyStopping counter: 8 out of 10
2025-03-06 16:00:45,642 - {'epoch': 40, 'rec_loss': '6.7641'}
2025-03-06 16:00:55,773 - {'Epoch': 40, 'HR@5': '0.0857', 'NDCG@5': '0.0608', 'HR@10': '0.1198', 'NDCG@10': '0.0717', 'HR@20': '0.1637', 'NDCG@20': '0.0827'}
2025-03-06 16:00:55,775 - EarlyStopping counter: 9 out of 10
2025-03-06 16:01:24,260 - {'epoch': 41, 'rec_loss': '6.7506'}
2025-03-06 16:01:33,738 - {'Epoch': 41, 'HR@5': '0.0867', 'NDCG@5': '0.0616', 'HR@10': '0.1189', 'NDCG@10': '0.0720', 'HR@20': '0.1627', 'NDCG@20': '0.0831'}
2025-03-06 16:01:33,739 - EarlyStopping counter: 10 out of 10
2025-03-06 16:01:33,739 - Early stopping
2025-03-06 16:01:33,739 - ---------------Test Score---------------
2025-03-06 16:01:43,359 - {'Epoch': 0, 'HR@5': '0.0719', 'NDCG@5': '0.0499', 'HR@10': '0.0996', 'NDCG@10': '0.0588', 'HR@20': '0.1366', 'NDCG@20': '0.0681'}
2025-03-06 16:01:43,360 - Scale_Beauty
2025-03-06 16:01:43,360 - {'Epoch': 0, 'HR@5': '0.0719', 'NDCG@5': '0.0499', 'HR@10': '0.0996', 'NDCG@10': '0.0588', 'HR@20': '0.1366', 'NDCG@20': '0.0681'}
2025-03-06 20:25:49,261 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 12, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-06 20:25:52,503 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-06 20:25:52,508 - Total Parameters: 929445
2025-03-06 20:26:25,959 - {'epoch': 0, 'rec_loss': '8.7692'}
2025-03-06 20:26:36,099 - {'Epoch': 0, 'HR@5': '0.0265', 'NDCG@5': '0.0169', 'HR@10': '0.0415', 'NDCG@10': '0.0217', 'HR@20': '0.0612', 'NDCG@20': '0.0267'}
2025-03-06 20:26:36,100 - Validation score increased.  Saving model ...
2025-03-06 20:27:07,781 - {'epoch': 1, 'rec_loss': '8.1509'}
2025-03-06 20:27:17,565 - {'Epoch': 1, 'HR@5': '0.0496', 'NDCG@5': '0.0334', 'HR@10': '0.0692', 'NDCG@10': '0.0396', 'HR@20': '0.0973', 'NDCG@20': '0.0467'}
2025-03-06 20:27:17,566 - Validation score increased.  Saving model ...
2025-03-06 20:27:49,255 - {'epoch': 2, 'rec_loss': '7.7994'}
2025-03-06 20:27:59,078 - {'Epoch': 2, 'HR@5': '0.0622', 'NDCG@5': '0.0433', 'HR@10': '0.0885', 'NDCG@10': '0.0518', 'HR@20': '0.1216', 'NDCG@20': '0.0601'}
2025-03-06 20:27:59,083 - Validation score increased.  Saving model ...
2025-03-06 20:28:29,698 - {'epoch': 3, 'rec_loss': '7.5468'}
2025-03-06 20:28:38,993 - {'Epoch': 3, 'HR@5': '0.0718', 'NDCG@5': '0.0499', 'HR@10': '0.1003', 'NDCG@10': '0.0591', 'HR@20': '0.1360', 'NDCG@20': '0.0680'}
2025-03-06 20:28:38,994 - Validation score increased.  Saving model ...
2025-03-06 20:29:09,698 - {'epoch': 4, 'rec_loss': '7.3627'}
2025-03-06 20:29:19,833 - {'Epoch': 4, 'HR@5': '0.0784', 'NDCG@5': '0.0554', 'HR@10': '0.1055', 'NDCG@10': '0.0641', 'HR@20': '0.1432', 'NDCG@20': '0.0736'}
2025-03-06 20:29:19,836 - Validation score increased.  Saving model ...
2025-03-06 20:29:56,201 - {'epoch': 5, 'rec_loss': '7.2200'}
2025-03-06 20:30:06,410 - {'Epoch': 5, 'HR@5': '0.0801', 'NDCG@5': '0.0566', 'HR@10': '0.1105', 'NDCG@10': '0.0664', 'HR@20': '0.1488', 'NDCG@20': '0.0760'}
2025-03-06 20:30:06,412 - Validation score increased.  Saving model ...
2025-03-06 20:30:41,404 - {'epoch': 6, 'rec_loss': '7.1225'}
2025-03-06 20:30:52,234 - {'Epoch': 6, 'HR@5': '0.0813', 'NDCG@5': '0.0571', 'HR@10': '0.1114', 'NDCG@10': '0.0669', 'HR@20': '0.1504', 'NDCG@20': '0.0767'}
2025-03-06 20:30:52,236 - Validation score increased.  Saving model ...
2025-03-06 20:31:25,099 - {'epoch': 7, 'rec_loss': '7.0421'}
2025-03-06 20:31:35,441 - {'Epoch': 7, 'HR@5': '0.0832', 'NDCG@5': '0.0586', 'HR@10': '0.1135', 'NDCG@10': '0.0684', 'HR@20': '0.1509', 'NDCG@20': '0.0778'}
2025-03-06 20:31:35,443 - Validation score increased.  Saving model ...
2025-03-06 20:32:08,042 - {'epoch': 8, 'rec_loss': '6.9777'}
2025-03-06 20:32:18,011 - {'Epoch': 8, 'HR@5': '0.0827', 'NDCG@5': '0.0583', 'HR@10': '0.1135', 'NDCG@10': '0.0682', 'HR@20': '0.1520', 'NDCG@20': '0.0779'}
2025-03-06 20:32:18,013 - Validation score increased.  Saving model ...
2025-03-06 20:32:47,781 - {'epoch': 9, 'rec_loss': '6.9252'}
2025-03-06 20:32:57,284 - {'Epoch': 9, 'HR@5': '0.0836', 'NDCG@5': '0.0585', 'HR@10': '0.1138', 'NDCG@10': '0.0682', 'HR@20': '0.1532', 'NDCG@20': '0.0781'}
2025-03-06 20:32:57,286 - Validation score increased.  Saving model ...
2025-03-06 20:33:27,285 - {'epoch': 10, 'rec_loss': '6.8909'}
2025-03-06 20:33:36,506 - {'Epoch': 10, 'HR@5': '0.0842', 'NDCG@5': '0.0589', 'HR@10': '0.1141', 'NDCG@10': '0.0686', 'HR@20': '0.1536', 'NDCG@20': '0.0785'}
2025-03-06 20:33:36,507 - Validation score increased.  Saving model ...
2025-03-06 20:34:08,246 - {'epoch': 11, 'rec_loss': '6.8453'}
2025-03-06 20:34:17,740 - {'Epoch': 11, 'HR@5': '0.0842', 'NDCG@5': '0.0596', 'HR@10': '0.1154', 'NDCG@10': '0.0696', 'HR@20': '0.1559', 'NDCG@20': '0.0799'}
2025-03-06 20:34:17,742 - Validation score increased.  Saving model ...
2025-03-06 20:34:47,284 - {'epoch': 12, 'rec_loss': '6.8112'}
2025-03-06 20:34:56,515 - {'Epoch': 12, 'HR@5': '0.0824', 'NDCG@5': '0.0586', 'HR@10': '0.1150', 'NDCG@10': '0.0691', 'HR@20': '0.1562', 'NDCG@20': '0.0795'}
2025-03-06 20:34:56,517 - EarlyStopping counter: 1 out of 10
2025-03-06 20:35:26,290 - {'epoch': 13, 'rec_loss': '6.7873'}
2025-03-06 20:35:35,386 - {'Epoch': 13, 'HR@5': '0.0851', 'NDCG@5': '0.0604', 'HR@10': '0.1187', 'NDCG@10': '0.0713', 'HR@20': '0.1599', 'NDCG@20': '0.0816'}
2025-03-06 20:35:35,387 - Validation score increased.  Saving model ...
2025-03-06 20:36:04,867 - {'epoch': 14, 'rec_loss': '6.7565'}
2025-03-06 20:36:14,789 - {'Epoch': 14, 'HR@5': '0.0847', 'NDCG@5': '0.0595', 'HR@10': '0.1181', 'NDCG@10': '0.0703', 'HR@20': '0.1576', 'NDCG@20': '0.0802'}
2025-03-06 20:36:14,790 - EarlyStopping counter: 1 out of 10
2025-03-06 20:36:48,966 - {'epoch': 15, 'rec_loss': '6.7328'}
2025-03-06 20:36:59,355 - {'Epoch': 15, 'HR@5': '0.0846', 'NDCG@5': '0.0599', 'HR@10': '0.1168', 'NDCG@10': '0.0703', 'HR@20': '0.1574', 'NDCG@20': '0.0805'}
2025-03-06 20:36:59,357 - EarlyStopping counter: 2 out of 10
2025-03-06 20:37:36,173 - {'epoch': 16, 'rec_loss': '6.7064'}
2025-03-06 20:37:46,303 - {'Epoch': 16, 'HR@5': '0.0846', 'NDCG@5': '0.0598', 'HR@10': '0.1167', 'NDCG@10': '0.0702', 'HR@20': '0.1574', 'NDCG@20': '0.0804'}
2025-03-06 20:37:46,305 - EarlyStopping counter: 3 out of 10
2025-03-06 20:38:24,249 - {'epoch': 17, 'rec_loss': '6.6880'}
2025-03-06 20:38:34,489 - {'Epoch': 17, 'HR@5': '0.0847', 'NDCG@5': '0.0597', 'HR@10': '0.1170', 'NDCG@10': '0.0701', 'HR@20': '0.1586', 'NDCG@20': '0.0806'}
2025-03-06 20:38:34,491 - EarlyStopping counter: 4 out of 10
2025-03-06 20:39:11,298 - {'epoch': 18, 'rec_loss': '6.6720'}
2025-03-06 20:39:22,040 - {'Epoch': 18, 'HR@5': '0.0840', 'NDCG@5': '0.0589', 'HR@10': '0.1162', 'NDCG@10': '0.0693', 'HR@20': '0.1575', 'NDCG@20': '0.0797'}
2025-03-06 20:39:22,041 - EarlyStopping counter: 5 out of 10
2025-03-06 20:40:00,840 - {'epoch': 19, 'rec_loss': '6.6505'}
2025-03-06 20:40:12,136 - {'Epoch': 19, 'HR@5': '0.0855', 'NDCG@5': '0.0598', 'HR@10': '0.1164', 'NDCG@10': '0.0697', 'HR@20': '0.1574', 'NDCG@20': '0.0801'}
2025-03-06 20:40:12,138 - EarlyStopping counter: 6 out of 10
2025-03-06 20:40:51,257 - {'epoch': 20, 'rec_loss': '6.6345'}
2025-03-06 20:41:02,659 - {'Epoch': 20, 'HR@5': '0.0849', 'NDCG@5': '0.0599', 'HR@10': '0.1178', 'NDCG@10': '0.0705', 'HR@20': '0.1571', 'NDCG@20': '0.0804'}
2025-03-06 20:41:02,661 - EarlyStopping counter: 7 out of 10
2025-03-06 20:41:39,809 - {'epoch': 21, 'rec_loss': '6.6170'}
2025-03-06 20:41:49,976 - {'Epoch': 21, 'HR@5': '0.0856', 'NDCG@5': '0.0597', 'HR@10': '0.1171', 'NDCG@10': '0.0699', 'HR@20': '0.1578', 'NDCG@20': '0.0801'}
2025-03-06 20:41:49,978 - EarlyStopping counter: 8 out of 10
2025-03-06 20:42:27,229 - {'epoch': 22, 'rec_loss': '6.6039'}
2025-03-06 20:42:38,153 - {'Epoch': 22, 'HR@5': '0.0850', 'NDCG@5': '0.0597', 'HR@10': '0.1185', 'NDCG@10': '0.0705', 'HR@20': '0.1581', 'NDCG@20': '0.0805'}
2025-03-06 20:42:38,154 - EarlyStopping counter: 9 out of 10
2025-03-06 20:43:16,649 - {'epoch': 23, 'rec_loss': '6.5920'}
2025-03-06 20:43:28,464 - {'Epoch': 23, 'HR@5': '0.0844', 'NDCG@5': '0.0596', 'HR@10': '0.1164', 'NDCG@10': '0.0698', 'HR@20': '0.1560', 'NDCG@20': '0.0798'}
2025-03-06 20:43:28,465 - EarlyStopping counter: 10 out of 10
2025-03-06 20:43:28,465 - Early stopping
2025-03-06 20:43:28,465 - ---------------Test Score---------------
2025-03-06 20:43:40,307 - {'Epoch': 0, 'HR@5': '0.0715', 'NDCG@5': '0.0505', 'HR@10': '0.0987', 'NDCG@10': '0.0593', 'HR@20': '0.1330', 'NDCG@20': '0.0679'}
2025-03-06 20:43:40,309 - Scale_Beauty
2025-03-06 20:43:40,309 - {'Epoch': 0, 'HR@5': '0.0715', 'NDCG@5': '0.0505', 'HR@10': '0.0987', 'NDCG@10': '0.0593', 'HR@20': '0.1330', 'NDCG@20': '0.0679'}
2025-03-06 22:51:24,561 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 12, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-06 22:51:27,557 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-06 22:51:27,562 - Total Parameters: 929445
2025-03-06 22:51:45,603 - {'epoch': 0, 'rec_loss': '8.9502'}
2025-03-06 22:51:54,479 - {'Epoch': 0, 'HR@5': '0.0163', 'NDCG@5': '0.0099', 'HR@10': '0.0257', 'NDCG@10': '0.0129', 'HR@20': '0.0397', 'NDCG@20': '0.0165'}
2025-03-06 22:51:54,480 - Validation score increased.  Saving model ...
2025-03-06 22:52:12,592 - {'epoch': 1, 'rec_loss': '8.4588'}
2025-03-06 22:52:21,536 - {'Epoch': 1, 'HR@5': '0.0319', 'NDCG@5': '0.0210', 'HR@10': '0.0498', 'NDCG@10': '0.0268', 'HR@20': '0.0726', 'NDCG@20': '0.0325'}
2025-03-06 22:52:21,537 - Validation score increased.  Saving model ...
2025-03-06 22:52:38,980 - {'epoch': 2, 'rec_loss': '8.1244'}
2025-03-06 22:52:47,784 - {'Epoch': 2, 'HR@5': '0.0438', 'NDCG@5': '0.0297', 'HR@10': '0.0639', 'NDCG@10': '0.0361', 'HR@20': '0.0935', 'NDCG@20': '0.0436'}
2025-03-06 22:52:47,795 - Validation score increased.  Saving model ...
2025-03-06 22:53:08,672 - {'epoch': 3, 'rec_loss': '7.9006'}
2025-03-06 22:53:18,295 - {'Epoch': 3, 'HR@5': '0.0534', 'NDCG@5': '0.0359', 'HR@10': '0.0787', 'NDCG@10': '0.0440', 'HR@20': '0.1118', 'NDCG@20': '0.0524'}
2025-03-06 22:53:18,303 - Validation score increased.  Saving model ...
2025-03-06 22:53:38,241 - {'epoch': 4, 'rec_loss': '7.7412'}
2025-03-06 22:53:47,321 - {'Epoch': 4, 'HR@5': '0.0625', 'NDCG@5': '0.0427', 'HR@10': '0.0882', 'NDCG@10': '0.0510', 'HR@20': '0.1252', 'NDCG@20': '0.0603'}
2025-03-06 22:53:47,322 - Validation score increased.  Saving model ...
2025-03-06 22:54:07,437 - {'epoch': 5, 'rec_loss': '7.6139'}
2025-03-06 22:54:16,351 - {'Epoch': 5, 'HR@5': '0.0672', 'NDCG@5': '0.0460', 'HR@10': '0.0960', 'NDCG@10': '0.0553', 'HR@20': '0.1332', 'NDCG@20': '0.0646'}
2025-03-06 22:54:16,356 - Validation score increased.  Saving model ...
2025-03-06 22:54:32,464 - {'epoch': 6, 'rec_loss': '7.5208'}
2025-03-06 22:54:41,537 - {'Epoch': 6, 'HR@5': '0.0705', 'NDCG@5': '0.0484', 'HR@10': '0.0998', 'NDCG@10': '0.0578', 'HR@20': '0.1404', 'NDCG@20': '0.0680'}
2025-03-06 22:54:41,538 - Validation score increased.  Saving model ...
2025-03-06 22:54:58,116 - {'epoch': 7, 'rec_loss': '7.4417'}
2025-03-06 22:55:06,504 - {'Epoch': 7, 'HR@5': '0.0747', 'NDCG@5': '0.0515', 'HR@10': '0.1051', 'NDCG@10': '0.0613', 'HR@20': '0.1437', 'NDCG@20': '0.0710'}
2025-03-06 22:55:06,506 - Validation score increased.  Saving model ...
2025-03-06 22:55:23,405 - {'epoch': 8, 'rec_loss': '7.3717'}
2025-03-06 22:55:32,024 - {'Epoch': 8, 'HR@5': '0.0768', 'NDCG@5': '0.0530', 'HR@10': '0.1066', 'NDCG@10': '0.0626', 'HR@20': '0.1489', 'NDCG@20': '0.0732'}
2025-03-06 22:55:32,025 - Validation score increased.  Saving model ...
2025-03-06 22:55:51,006 - {'epoch': 9, 'rec_loss': '7.3096'}
2025-03-06 22:56:00,292 - {'Epoch': 9, 'HR@5': '0.0773', 'NDCG@5': '0.0536', 'HR@10': '0.1100', 'NDCG@10': '0.0642', 'HR@20': '0.1527', 'NDCG@20': '0.0750'}
2025-03-06 22:56:00,294 - Validation score increased.  Saving model ...
2025-03-06 22:56:19,162 - {'epoch': 10, 'rec_loss': '7.2517'}
2025-03-06 22:56:28,486 - {'Epoch': 10, 'HR@5': '0.0783', 'NDCG@5': '0.0544', 'HR@10': '0.1126', 'NDCG@10': '0.0654', 'HR@20': '0.1547', 'NDCG@20': '0.0759'}
2025-03-06 22:56:28,487 - Validation score increased.  Saving model ...
2025-03-06 22:56:49,441 - {'epoch': 11, 'rec_loss': '7.2048'}
2025-03-06 22:56:58,838 - {'Epoch': 11, 'HR@5': '0.0811', 'NDCG@5': '0.0570', 'HR@10': '0.1129', 'NDCG@10': '0.0672', 'HR@20': '0.1546', 'NDCG@20': '0.0778'}
2025-03-06 22:56:58,839 - Validation score increased.  Saving model ...
2025-03-06 22:57:17,996 - {'epoch': 12, 'rec_loss': '7.1723'}
2025-03-06 22:57:26,180 - {'Epoch': 12, 'HR@5': '0.0820', 'NDCG@5': '0.0567', 'HR@10': '0.1139', 'NDCG@10': '0.0670', 'HR@20': '0.1567', 'NDCG@20': '0.0777'}
2025-03-06 22:57:26,181 - EarlyStopping counter: 1 out of 10
2025-03-06 22:57:41,774 - {'epoch': 13, 'rec_loss': '7.1303'}
2025-03-06 22:57:50,357 - {'Epoch': 13, 'HR@5': '0.0829', 'NDCG@5': '0.0578', 'HR@10': '0.1163', 'NDCG@10': '0.0685', 'HR@20': '0.1581', 'NDCG@20': '0.0791'}
2025-03-06 22:57:50,362 - Validation score increased.  Saving model ...
2025-03-06 22:58:07,614 - {'epoch': 14, 'rec_loss': '7.0961'}
2025-03-06 22:58:16,434 - {'Epoch': 14, 'HR@5': '0.0840', 'NDCG@5': '0.0589', 'HR@10': '0.1169', 'NDCG@10': '0.0695', 'HR@20': '0.1598', 'NDCG@20': '0.0803'}
2025-03-06 22:58:16,435 - Validation score increased.  Saving model ...
2025-03-06 22:58:32,673 - {'epoch': 15, 'rec_loss': '7.0695'}
2025-03-06 22:58:41,905 - {'Epoch': 15, 'HR@5': '0.0835', 'NDCG@5': '0.0586', 'HR@10': '0.1165', 'NDCG@10': '0.0692', 'HR@20': '0.1576', 'NDCG@20': '0.0795'}
2025-03-06 22:58:41,907 - EarlyStopping counter: 1 out of 10
2025-03-06 22:59:00,295 - {'epoch': 16, 'rec_loss': '7.0471'}
2025-03-06 22:59:09,952 - {'Epoch': 16, 'HR@5': '0.0845', 'NDCG@5': '0.0594', 'HR@10': '0.1162', 'NDCG@10': '0.0696', 'HR@20': '0.1587', 'NDCG@20': '0.0803'}
2025-03-06 22:59:09,953 - EarlyStopping counter: 2 out of 10
2025-03-06 22:59:28,494 - {'epoch': 17, 'rec_loss': '7.0292'}
2025-03-06 22:59:37,453 - {'Epoch': 17, 'HR@5': '0.0825', 'NDCG@5': '0.0577', 'HR@10': '0.1151', 'NDCG@10': '0.0682', 'HR@20': '0.1591', 'NDCG@20': '0.0792'}
2025-03-06 22:59:37,454 - EarlyStopping counter: 3 out of 10
2025-03-06 22:59:55,618 - {'epoch': 18, 'rec_loss': '7.0122'}
2025-03-06 23:00:04,694 - {'Epoch': 18, 'HR@5': '0.0832', 'NDCG@5': '0.0586', 'HR@10': '0.1143', 'NDCG@10': '0.0687', 'HR@20': '0.1591', 'NDCG@20': '0.0800'}
2025-03-06 23:00:04,695 - EarlyStopping counter: 4 out of 10
2025-03-06 23:00:22,336 - {'epoch': 19, 'rec_loss': '6.9852'}
2025-03-06 23:00:31,030 - {'Epoch': 19, 'HR@5': '0.0847', 'NDCG@5': '0.0597', 'HR@10': '0.1168', 'NDCG@10': '0.0700', 'HR@20': '0.1608', 'NDCG@20': '0.0812'}
2025-03-06 23:00:31,031 - Validation score increased.  Saving model ...
2025-03-06 23:00:47,309 - {'epoch': 20, 'rec_loss': '6.9639'}
2025-03-06 23:00:56,578 - {'Epoch': 20, 'HR@5': '0.0859', 'NDCG@5': '0.0597', 'HR@10': '0.1174', 'NDCG@10': '0.0698', 'HR@20': '0.1595', 'NDCG@20': '0.0803'}
2025-03-06 23:00:56,579 - EarlyStopping counter: 1 out of 10
2025-03-06 23:01:14,003 - {'epoch': 21, 'rec_loss': '6.9532'}
2025-03-06 23:01:22,567 - {'Epoch': 21, 'HR@5': '0.0850', 'NDCG@5': '0.0596', 'HR@10': '0.1170', 'NDCG@10': '0.0699', 'HR@20': '0.1611', 'NDCG@20': '0.0810'}
2025-03-06 23:01:22,568 - EarlyStopping counter: 2 out of 10
2025-03-06 23:01:38,778 - {'epoch': 22, 'rec_loss': '6.9441'}
2025-03-06 23:01:47,842 - {'Epoch': 22, 'HR@5': '0.0839', 'NDCG@5': '0.0591', 'HR@10': '0.1170', 'NDCG@10': '0.0697', 'HR@20': '0.1608', 'NDCG@20': '0.0807'}
2025-03-06 23:01:47,843 - EarlyStopping counter: 3 out of 10
2025-03-06 23:02:06,385 - {'epoch': 23, 'rec_loss': '6.9202'}
2025-03-06 23:02:15,282 - {'Epoch': 23, 'HR@5': '0.0840', 'NDCG@5': '0.0591', 'HR@10': '0.1176', 'NDCG@10': '0.0699', 'HR@20': '0.1595', 'NDCG@20': '0.0804'}
2025-03-06 23:02:15,283 - EarlyStopping counter: 4 out of 10
2025-03-06 23:02:33,717 - {'epoch': 24, 'rec_loss': '6.9100'}
2025-03-06 23:02:42,970 - {'Epoch': 24, 'HR@5': '0.0846', 'NDCG@5': '0.0591', 'HR@10': '0.1181', 'NDCG@10': '0.0698', 'HR@20': '0.1610', 'NDCG@20': '0.0806'}
2025-03-06 23:02:42,971 - EarlyStopping counter: 5 out of 10
2025-03-06 23:03:01,516 - {'epoch': 25, 'rec_loss': '6.8988'}
2025-03-06 23:03:10,917 - {'Epoch': 25, 'HR@5': '0.0852', 'NDCG@5': '0.0595', 'HR@10': '0.1170', 'NDCG@10': '0.0697', 'HR@20': '0.1621', 'NDCG@20': '0.0810'}
2025-03-06 23:03:10,918 - EarlyStopping counter: 6 out of 10
2025-03-06 23:03:27,218 - {'epoch': 26, 'rec_loss': '6.8903'}
2025-03-06 23:03:36,048 - {'Epoch': 26, 'HR@5': '0.0851', 'NDCG@5': '0.0597', 'HR@10': '0.1172', 'NDCG@10': '0.0700', 'HR@20': '0.1610', 'NDCG@20': '0.0811'}
2025-03-06 23:03:36,049 - EarlyStopping counter: 7 out of 10
2025-03-06 23:03:52,349 - {'epoch': 27, 'rec_loss': '6.8910'}
2025-03-06 23:04:01,062 - {'Epoch': 27, 'HR@5': '0.0860', 'NDCG@5': '0.0606', 'HR@10': '0.1168', 'NDCG@10': '0.0705', 'HR@20': '0.1618', 'NDCG@20': '0.0819'}
2025-03-06 23:04:01,063 - Validation score increased.  Saving model ...
2025-03-06 23:04:17,083 - {'epoch': 28, 'rec_loss': '6.8741'}
2025-03-06 23:04:26,159 - {'Epoch': 28, 'HR@5': '0.0867', 'NDCG@5': '0.0598', 'HR@10': '0.1180', 'NDCG@10': '0.0699', 'HR@20': '0.1629', 'NDCG@20': '0.0812'}
2025-03-06 23:04:26,161 - EarlyStopping counter: 1 out of 10
2025-03-06 23:04:43,321 - {'epoch': 29, 'rec_loss': '6.8627'}
2025-03-06 23:04:52,478 - {'Epoch': 29, 'HR@5': '0.0861', 'NDCG@5': '0.0597', 'HR@10': '0.1188', 'NDCG@10': '0.0703', 'HR@20': '0.1612', 'NDCG@20': '0.0810'}
2025-03-06 23:04:52,479 - EarlyStopping counter: 2 out of 10
2025-03-06 23:05:11,138 - {'epoch': 30, 'rec_loss': '6.8520'}
2025-03-06 23:05:19,783 - {'Epoch': 30, 'HR@5': '0.0861', 'NDCG@5': '0.0603', 'HR@10': '0.1193', 'NDCG@10': '0.0710', 'HR@20': '0.1620', 'NDCG@20': '0.0818'}
2025-03-06 23:05:19,784 - EarlyStopping counter: 3 out of 10
2025-03-06 23:05:38,198 - {'epoch': 31, 'rec_loss': '6.8470'}
2025-03-06 23:05:48,124 - {'Epoch': 31, 'HR@5': '0.0860', 'NDCG@5': '0.0599', 'HR@10': '0.1176', 'NDCG@10': '0.0701', 'HR@20': '0.1630', 'NDCG@20': '0.0815'}
2025-03-06 23:05:48,126 - EarlyStopping counter: 4 out of 10
2025-03-06 23:06:05,922 - {'epoch': 32, 'rec_loss': '6.8385'}
2025-03-06 23:06:14,846 - {'Epoch': 32, 'HR@5': '0.0870', 'NDCG@5': '0.0613', 'HR@10': '0.1198', 'NDCG@10': '0.0718', 'HR@20': '0.1644', 'NDCG@20': '0.0830'}
2025-03-06 23:06:14,847 - Validation score increased.  Saving model ...
2025-03-06 23:06:32,082 - {'epoch': 33, 'rec_loss': '6.8375'}
2025-03-06 23:06:41,165 - {'Epoch': 33, 'HR@5': '0.0857', 'NDCG@5': '0.0600', 'HR@10': '0.1181', 'NDCG@10': '0.0703', 'HR@20': '0.1611', 'NDCG@20': '0.0812'}
2025-03-06 23:06:41,166 - EarlyStopping counter: 1 out of 10
2025-03-06 23:06:58,288 - {'epoch': 34, 'rec_loss': '6.8231'}
2025-03-06 23:07:06,791 - {'Epoch': 34, 'HR@5': '0.0870', 'NDCG@5': '0.0602', 'HR@10': '0.1180', 'NDCG@10': '0.0702', 'HR@20': '0.1626', 'NDCG@20': '0.0814'}
2025-03-06 23:07:06,793 - EarlyStopping counter: 2 out of 10
2025-03-06 23:07:23,370 - {'epoch': 35, 'rec_loss': '6.8208'}
2025-03-06 23:07:32,141 - {'Epoch': 35, 'HR@5': '0.0851', 'NDCG@5': '0.0601', 'HR@10': '0.1188', 'NDCG@10': '0.0710', 'HR@20': '0.1633', 'NDCG@20': '0.0822'}
2025-03-06 23:07:32,142 - EarlyStopping counter: 3 out of 10
2025-03-06 23:07:50,055 - {'epoch': 36, 'rec_loss': '6.8132'}
2025-03-06 23:07:58,983 - {'Epoch': 36, 'HR@5': '0.0860', 'NDCG@5': '0.0605', 'HR@10': '0.1201', 'NDCG@10': '0.0714', 'HR@20': '0.1615', 'NDCG@20': '0.0818'}
2025-03-06 23:07:58,984 - EarlyStopping counter: 4 out of 10
2025-03-06 23:08:17,666 - {'epoch': 37, 'rec_loss': '6.8110'}
2025-03-06 23:08:27,135 - {'Epoch': 37, 'HR@5': '0.0855', 'NDCG@5': '0.0600', 'HR@10': '0.1199', 'NDCG@10': '0.0711', 'HR@20': '0.1628', 'NDCG@20': '0.0819'}
2025-03-06 23:08:27,136 - EarlyStopping counter: 5 out of 10
2025-03-06 23:08:46,548 - {'epoch': 38, 'rec_loss': '6.8116'}
2025-03-06 23:08:56,040 - {'Epoch': 38, 'HR@5': '0.0871', 'NDCG@5': '0.0604', 'HR@10': '0.1205', 'NDCG@10': '0.0711', 'HR@20': '0.1621', 'NDCG@20': '0.0816'}
2025-03-06 23:08:56,041 - EarlyStopping counter: 6 out of 10
2025-03-06 23:09:15,511 - {'epoch': 39, 'rec_loss': '6.7978'}
2025-03-06 23:09:23,991 - {'Epoch': 39, 'HR@5': '0.0868', 'NDCG@5': '0.0606', 'HR@10': '0.1188', 'NDCG@10': '0.0709', 'HR@20': '0.1627', 'NDCG@20': '0.0819'}
2025-03-06 23:09:23,992 - EarlyStopping counter: 7 out of 10
2025-03-06 23:09:40,082 - {'epoch': 40, 'rec_loss': '6.7936'}
2025-03-06 23:09:49,251 - {'Epoch': 40, 'HR@5': '0.0867', 'NDCG@5': '0.0605', 'HR@10': '0.1193', 'NDCG@10': '0.0710', 'HR@20': '0.1616', 'NDCG@20': '0.0816'}
2025-03-06 23:09:49,252 - EarlyStopping counter: 8 out of 10
2025-03-06 23:10:05,504 - {'epoch': 41, 'rec_loss': '6.7841'}
2025-03-06 23:10:13,555 - {'Epoch': 41, 'HR@5': '0.0868', 'NDCG@5': '0.0613', 'HR@10': '0.1202', 'NDCG@10': '0.0720', 'HR@20': '0.1629', 'NDCG@20': '0.0828'}
2025-03-06 23:10:13,557 - EarlyStopping counter: 9 out of 10
2025-03-06 23:10:31,187 - {'epoch': 42, 'rec_loss': '6.7847'}
2025-03-06 23:10:40,193 - {'Epoch': 42, 'HR@5': '0.0872', 'NDCG@5': '0.0613', 'HR@10': '0.1193', 'NDCG@10': '0.0717', 'HR@20': '0.1627', 'NDCG@20': '0.0826'}
2025-03-06 23:10:40,195 - EarlyStopping counter: 10 out of 10
2025-03-06 23:10:40,195 - Early stopping
2025-03-06 23:10:40,196 - ---------------Test Score---------------
2025-03-06 23:10:49,097 - {'Epoch': 0, 'HR@5': '0.0707', 'NDCG@5': '0.0489', 'HR@10': '0.0992', 'NDCG@10': '0.0581', 'HR@20': '0.1337', 'NDCG@20': '0.0668'}
2025-03-06 23:10:49,099 - Scale_Beauty
2025-03-06 23:10:49,099 - {'Epoch': 0, 'HR@5': '0.0707', 'NDCG@5': '0.0489', 'HR@10': '0.0992', 'NDCG@10': '0.0581', 'HR@20': '0.1337', 'NDCG@20': '0.0668'}
2025-03-07 10:24:17,260 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 12, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-07 10:24:21,179 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-07 10:24:21,186 - Total Parameters: 929445
2025-03-07 10:24:46,257 - {'epoch': 0, 'rec_loss': '8.8768'}
2025-03-07 10:24:56,803 - {'Epoch': 0, 'HR@5': '0.0155', 'NDCG@5': '0.0097', 'HR@10': '0.0259', 'NDCG@10': '0.0130', 'HR@20': '0.0392', 'NDCG@20': '0.0164'}
2025-03-07 10:24:56,805 - Validation score increased.  Saving model ...
2025-03-07 10:25:20,247 - {'epoch': 1, 'rec_loss': '8.4129'}
2025-03-07 10:25:31,621 - {'Epoch': 1, 'HR@5': '0.0313', 'NDCG@5': '0.0202', 'HR@10': '0.0490', 'NDCG@10': '0.0259', 'HR@20': '0.0707', 'NDCG@20': '0.0314'}
2025-03-07 10:25:31,628 - Validation score increased.  Saving model ...
2025-03-07 10:26:00,757 - {'epoch': 2, 'rec_loss': '8.1123'}
2025-03-07 10:26:11,227 - {'Epoch': 2, 'HR@5': '0.0410', 'NDCG@5': '0.0277', 'HR@10': '0.0623', 'NDCG@10': '0.0345', 'HR@20': '0.0935', 'NDCG@20': '0.0423'}
2025-03-07 10:26:11,238 - Validation score increased.  Saving model ...
2025-03-07 10:26:33,366 - {'epoch': 3, 'rec_loss': '7.8935'}
2025-03-07 10:26:43,438 - {'Epoch': 3, 'HR@5': '0.0504', 'NDCG@5': '0.0334', 'HR@10': '0.0775', 'NDCG@10': '0.0421', 'HR@20': '0.1134', 'NDCG@20': '0.0511'}
2025-03-07 10:26:43,450 - Validation score increased.  Saving model ...
2025-03-07 10:27:06,355 - {'epoch': 4, 'rec_loss': '7.7305'}
2025-03-07 10:27:15,740 - {'Epoch': 4, 'HR@5': '0.0611', 'NDCG@5': '0.0415', 'HR@10': '0.0885', 'NDCG@10': '0.0503', 'HR@20': '0.1248', 'NDCG@20': '0.0595'}
2025-03-07 10:27:15,741 - Validation score increased.  Saving model ...
2025-03-07 10:27:35,375 - {'epoch': 5, 'rec_loss': '7.6009'}
2025-03-07 10:27:44,269 - {'Epoch': 5, 'HR@5': '0.0685', 'NDCG@5': '0.0469', 'HR@10': '0.0980', 'NDCG@10': '0.0564', 'HR@20': '0.1351', 'NDCG@20': '0.0658'}
2025-03-07 10:27:44,271 - Validation score increased.  Saving model ...
2025-03-07 10:28:09,332 - {'epoch': 6, 'rec_loss': '7.4973'}
2025-03-07 10:28:19,933 - {'Epoch': 6, 'HR@5': '0.0716', 'NDCG@5': '0.0491', 'HR@10': '0.1019', 'NDCG@10': '0.0588', 'HR@20': '0.1418', 'NDCG@20': '0.0688'}
2025-03-07 10:28:19,935 - Validation score increased.  Saving model ...
2025-03-07 10:28:45,858 - {'epoch': 7, 'rec_loss': '7.4113'}
2025-03-07 10:28:55,875 - {'Epoch': 7, 'HR@5': '0.0770', 'NDCG@5': '0.0530', 'HR@10': '0.1075', 'NDCG@10': '0.0629', 'HR@20': '0.1470', 'NDCG@20': '0.0728'}
2025-03-07 10:28:55,877 - Validation score increased.  Saving model ...
2025-03-07 10:29:23,461 - {'epoch': 8, 'rec_loss': '7.3334'}
2025-03-07 10:29:34,812 - {'Epoch': 8, 'HR@5': '0.0791', 'NDCG@5': '0.0548', 'HR@10': '0.1092', 'NDCG@10': '0.0645', 'HR@20': '0.1493', 'NDCG@20': '0.0746'}
2025-03-07 10:29:34,813 - Validation score increased.  Saving model ...
2025-03-07 10:29:57,057 - {'epoch': 9, 'rec_loss': '7.2663'}
2025-03-07 10:30:06,312 - {'Epoch': 9, 'HR@5': '0.0791', 'NDCG@5': '0.0552', 'HR@10': '0.1117', 'NDCG@10': '0.0657', 'HR@20': '0.1523', 'NDCG@20': '0.0759'}
2025-03-07 10:30:06,314 - Validation score increased.  Saving model ...
2025-03-07 10:30:27,812 - {'epoch': 10, 'rec_loss': '7.2144'}
2025-03-07 10:30:37,043 - {'Epoch': 10, 'HR@5': '0.0799', 'NDCG@5': '0.0562', 'HR@10': '0.1123', 'NDCG@10': '0.0667', 'HR@20': '0.1539', 'NDCG@20': '0.0771'}
2025-03-07 10:30:37,052 - Validation score increased.  Saving model ...
2025-03-07 10:30:57,518 - {'epoch': 11, 'rec_loss': '7.1632'}
2025-03-07 10:31:06,155 - {'Epoch': 11, 'HR@5': '0.0817', 'NDCG@5': '0.0579', 'HR@10': '0.1152', 'NDCG@10': '0.0687', 'HR@20': '0.1572', 'NDCG@20': '0.0793'}
2025-03-07 10:31:06,157 - Validation score increased.  Saving model ...
2025-03-07 10:31:26,854 - {'epoch': 12, 'rec_loss': '7.1277'}
2025-03-07 10:31:36,917 - {'Epoch': 12, 'HR@5': '0.0833', 'NDCG@5': '0.0584', 'HR@10': '0.1151', 'NDCG@10': '0.0686', 'HR@20': '0.1576', 'NDCG@20': '0.0793'}
2025-03-07 10:31:36,919 - Validation score increased.  Saving model ...
2025-03-07 10:32:01,132 - {'epoch': 13, 'rec_loss': '7.0889'}
2025-03-07 10:32:11,536 - {'Epoch': 13, 'HR@5': '0.0833', 'NDCG@5': '0.0587', 'HR@10': '0.1162', 'NDCG@10': '0.0693', 'HR@20': '0.1591', 'NDCG@20': '0.0801'}
2025-03-07 10:32:11,537 - Validation score increased.  Saving model ...
2025-03-07 10:32:34,584 - {'epoch': 14, 'rec_loss': '7.0489'}
2025-03-07 10:32:45,495 - {'Epoch': 14, 'HR@5': '0.0837', 'NDCG@5': '0.0590', 'HR@10': '0.1178', 'NDCG@10': '0.0699', 'HR@20': '0.1597', 'NDCG@20': '0.0805'}
2025-03-07 10:32:45,502 - Validation score increased.  Saving model ...
2025-03-07 10:33:11,780 - {'epoch': 15, 'rec_loss': '7.0288'}
2025-03-07 10:33:20,832 - {'Epoch': 15, 'HR@5': '0.0829', 'NDCG@5': '0.0585', 'HR@10': '0.1170', 'NDCG@10': '0.0695', 'HR@20': '0.1603', 'NDCG@20': '0.0804'}
2025-03-07 10:33:20,833 - EarlyStopping counter: 1 out of 10
2025-03-07 10:33:42,436 - {'epoch': 16, 'rec_loss': '7.0056'}
2025-03-07 10:33:52,059 - {'Epoch': 16, 'HR@5': '0.0832', 'NDCG@5': '0.0591', 'HR@10': '0.1168', 'NDCG@10': '0.0699', 'HR@20': '0.1587', 'NDCG@20': '0.0805'}
2025-03-07 10:33:52,060 - EarlyStopping counter: 2 out of 10
2025-03-07 10:34:12,974 - {'epoch': 17, 'rec_loss': '6.9914'}
2025-03-07 10:34:22,529 - {'Epoch': 17, 'HR@5': '0.0824', 'NDCG@5': '0.0579', 'HR@10': '0.1164', 'NDCG@10': '0.0688', 'HR@20': '0.1596', 'NDCG@20': '0.0797'}
2025-03-07 10:34:22,530 - EarlyStopping counter: 3 out of 10
2025-03-07 10:34:41,549 - {'epoch': 18, 'rec_loss': '6.9654'}
2025-03-07 10:34:51,473 - {'Epoch': 18, 'HR@5': '0.0833', 'NDCG@5': '0.0586', 'HR@10': '0.1172', 'NDCG@10': '0.0696', 'HR@20': '0.1604', 'NDCG@20': '0.0804'}
2025-03-07 10:34:51,475 - EarlyStopping counter: 4 out of 10
2025-03-07 10:35:14,823 - {'epoch': 19, 'rec_loss': '6.9444'}
2025-03-07 10:35:24,976 - {'Epoch': 19, 'HR@5': '0.0842', 'NDCG@5': '0.0594', 'HR@10': '0.1188', 'NDCG@10': '0.0705', 'HR@20': '0.1615', 'NDCG@20': '0.0812'}
2025-03-07 10:35:24,988 - Validation score increased.  Saving model ...
2025-03-07 10:35:48,197 - {'epoch': 20, 'rec_loss': '6.9245'}
2025-03-07 10:35:58,510 - {'Epoch': 20, 'HR@5': '0.0841', 'NDCG@5': '0.0596', 'HR@10': '0.1169', 'NDCG@10': '0.0702', 'HR@20': '0.1605', 'NDCG@20': '0.0813'}
2025-03-07 10:35:58,512 - Validation score increased.  Saving model ...
2025-03-07 10:36:23,223 - {'epoch': 21, 'rec_loss': '6.9084'}
2025-03-07 10:36:33,201 - {'Epoch': 21, 'HR@5': '0.0832', 'NDCG@5': '0.0586', 'HR@10': '0.1177', 'NDCG@10': '0.0697', 'HR@20': '0.1615', 'NDCG@20': '0.0807'}
2025-03-07 10:36:33,202 - EarlyStopping counter: 1 out of 10
2025-03-07 10:36:54,262 - {'epoch': 22, 'rec_loss': '6.8963'}
2025-03-07 10:37:03,801 - {'Epoch': 22, 'HR@5': '0.0830', 'NDCG@5': '0.0586', 'HR@10': '0.1189', 'NDCG@10': '0.0701', 'HR@20': '0.1618', 'NDCG@20': '0.0809'}
2025-03-07 10:37:03,808 - EarlyStopping counter: 2 out of 10
2025-03-07 10:37:25,178 - {'epoch': 23, 'rec_loss': '6.8811'}
2025-03-07 10:37:35,041 - {'Epoch': 23, 'HR@5': '0.0839', 'NDCG@5': '0.0593', 'HR@10': '0.1182', 'NDCG@10': '0.0704', 'HR@20': '0.1613', 'NDCG@20': '0.0813'}
2025-03-07 10:37:35,048 - Validation score increased.  Saving model ...
2025-03-07 10:37:56,285 - {'epoch': 24, 'rec_loss': '6.8718'}
2025-03-07 10:38:06,418 - {'Epoch': 24, 'HR@5': '0.0836', 'NDCG@5': '0.0588', 'HR@10': '0.1180', 'NDCG@10': '0.0699', 'HR@20': '0.1625', 'NDCG@20': '0.0811'}
2025-03-07 10:38:06,424 - EarlyStopping counter: 1 out of 10
2025-03-07 10:38:29,616 - {'epoch': 25, 'rec_loss': '6.8596'}
2025-03-07 10:38:39,846 - {'Epoch': 25, 'HR@5': '0.0824', 'NDCG@5': '0.0579', 'HR@10': '0.1183', 'NDCG@10': '0.0695', 'HR@20': '0.1624', 'NDCG@20': '0.0806'}
2025-03-07 10:38:39,848 - EarlyStopping counter: 2 out of 10
2025-03-07 10:39:04,270 - {'epoch': 26, 'rec_loss': '6.8504'}
2025-03-07 10:39:14,666 - {'Epoch': 26, 'HR@5': '0.0836', 'NDCG@5': '0.0584', 'HR@10': '0.1186', 'NDCG@10': '0.0697', 'HR@20': '0.1616', 'NDCG@20': '0.0805'}
2025-03-07 10:39:14,667 - EarlyStopping counter: 3 out of 10
2025-03-07 10:39:37,869 - {'epoch': 27, 'rec_loss': '6.8471'}
2025-03-07 10:39:47,979 - {'Epoch': 27, 'HR@5': '0.0842', 'NDCG@5': '0.0593', 'HR@10': '0.1189', 'NDCG@10': '0.0704', 'HR@20': '0.1610', 'NDCG@20': '0.0810'}
2025-03-07 10:39:47,987 - EarlyStopping counter: 4 out of 10
2025-03-07 10:40:10,802 - {'epoch': 28, 'rec_loss': '6.8341'}
2025-03-07 10:40:20,871 - {'Epoch': 28, 'HR@5': '0.0842', 'NDCG@5': '0.0587', 'HR@10': '0.1191', 'NDCG@10': '0.0699', 'HR@20': '0.1625', 'NDCG@20': '0.0808'}
2025-03-07 10:40:20,876 - EarlyStopping counter: 5 out of 10
2025-03-07 10:40:42,711 - {'epoch': 29, 'rec_loss': '6.8215'}
2025-03-07 10:40:52,415 - {'Epoch': 29, 'HR@5': '0.0845', 'NDCG@5': '0.0587', 'HR@10': '0.1187', 'NDCG@10': '0.0697', 'HR@20': '0.1613', 'NDCG@20': '0.0804'}
2025-03-07 10:40:52,424 - EarlyStopping counter: 6 out of 10
2025-03-07 10:41:14,722 - {'epoch': 30, 'rec_loss': '6.8079'}
2025-03-07 10:41:24,123 - {'Epoch': 30, 'HR@5': '0.0846', 'NDCG@5': '0.0592', 'HR@10': '0.1199', 'NDCG@10': '0.0706', 'HR@20': '0.1626', 'NDCG@20': '0.0814'}
2025-03-07 10:41:24,124 - Validation score increased.  Saving model ...
2025-03-07 10:41:45,979 - {'epoch': 31, 'rec_loss': '6.8022'}
2025-03-07 10:41:56,630 - {'Epoch': 31, 'HR@5': '0.0856', 'NDCG@5': '0.0596', 'HR@10': '0.1191', 'NDCG@10': '0.0703', 'HR@20': '0.1628', 'NDCG@20': '0.0813'}
2025-03-07 10:41:56,639 - EarlyStopping counter: 1 out of 10
2025-03-07 10:42:20,346 - {'epoch': 32, 'rec_loss': '6.7919'}
2025-03-07 10:42:30,595 - {'Epoch': 32, 'HR@5': '0.0850', 'NDCG@5': '0.0598', 'HR@10': '0.1195', 'NDCG@10': '0.0709', 'HR@20': '0.1631', 'NDCG@20': '0.0819'}
2025-03-07 10:42:30,597 - Validation score increased.  Saving model ...
2025-03-07 10:42:55,158 - {'epoch': 33, 'rec_loss': '6.7906'}
2025-03-07 10:43:05,360 - {'Epoch': 33, 'HR@5': '0.0855', 'NDCG@5': '0.0596', 'HR@10': '0.1186', 'NDCG@10': '0.0703', 'HR@20': '0.1632', 'NDCG@20': '0.0815'}
2025-03-07 10:43:05,368 - EarlyStopping counter: 1 out of 10
2025-03-07 10:43:28,134 - {'epoch': 34, 'rec_loss': '6.7816'}
2025-03-07 10:43:37,485 - {'Epoch': 34, 'HR@5': '0.0848', 'NDCG@5': '0.0593', 'HR@10': '0.1184', 'NDCG@10': '0.0701', 'HR@20': '0.1620', 'NDCG@20': '0.0811'}
2025-03-07 10:43:37,487 - EarlyStopping counter: 2 out of 10
2025-03-07 10:43:59,343 - {'epoch': 35, 'rec_loss': '6.7769'}
2025-03-07 10:44:08,461 - {'Epoch': 35, 'HR@5': '0.0859', 'NDCG@5': '0.0598', 'HR@10': '0.1186', 'NDCG@10': '0.0703', 'HR@20': '0.1634', 'NDCG@20': '0.0816'}
2025-03-07 10:44:08,469 - EarlyStopping counter: 3 out of 10
2025-03-07 10:44:28,845 - {'epoch': 36, 'rec_loss': '6.7709'}
2025-03-07 10:44:38,075 - {'Epoch': 36, 'HR@5': '0.0854', 'NDCG@5': '0.0598', 'HR@10': '0.1194', 'NDCG@10': '0.0708', 'HR@20': '0.1601', 'NDCG@20': '0.0810'}
2025-03-07 10:44:38,076 - EarlyStopping counter: 4 out of 10
2025-03-07 10:44:59,484 - {'epoch': 37, 'rec_loss': '6.7682'}
2025-03-07 10:45:08,648 - {'Epoch': 37, 'HR@5': '0.0862', 'NDCG@5': '0.0598', 'HR@10': '0.1198', 'NDCG@10': '0.0706', 'HR@20': '0.1630', 'NDCG@20': '0.0815'}
2025-03-07 10:45:08,649 - EarlyStopping counter: 5 out of 10
2025-03-07 10:45:33,538 - {'epoch': 38, 'rec_loss': '6.7676'}
2025-03-07 10:45:44,023 - {'Epoch': 38, 'HR@5': '0.0858', 'NDCG@5': '0.0602', 'HR@10': '0.1200', 'NDCG@10': '0.0712', 'HR@20': '0.1636', 'NDCG@20': '0.0822'}
2025-03-07 10:45:44,025 - Validation score increased.  Saving model ...
2025-03-07 10:46:08,255 - {'epoch': 39, 'rec_loss': '6.7538'}
2025-03-07 10:46:19,094 - {'Epoch': 39, 'HR@5': '0.0856', 'NDCG@5': '0.0595', 'HR@10': '0.1180', 'NDCG@10': '0.0700', 'HR@20': '0.1629', 'NDCG@20': '0.0813'}
2025-03-07 10:46:19,106 - EarlyStopping counter: 1 out of 10
2025-03-07 10:46:41,595 - {'epoch': 40, 'rec_loss': '6.7528'}
2025-03-07 10:46:51,615 - {'Epoch': 40, 'HR@5': '0.0859', 'NDCG@5': '0.0604', 'HR@10': '0.1187', 'NDCG@10': '0.0710', 'HR@20': '0.1634', 'NDCG@20': '0.0823'}
2025-03-07 10:46:51,617 - Validation score increased.  Saving model ...
2025-03-07 10:47:14,816 - {'epoch': 41, 'rec_loss': '6.7407'}
2025-03-07 10:47:24,077 - {'Epoch': 41, 'HR@5': '0.0845', 'NDCG@5': '0.0596', 'HR@10': '0.1191', 'NDCG@10': '0.0707', 'HR@20': '0.1630', 'NDCG@20': '0.0817'}
2025-03-07 10:47:24,078 - EarlyStopping counter: 1 out of 10
2025-03-07 10:47:45,581 - {'epoch': 42, 'rec_loss': '6.7433'}
2025-03-07 10:47:55,464 - {'Epoch': 42, 'HR@5': '0.0855', 'NDCG@5': '0.0600', 'HR@10': '0.1215', 'NDCG@10': '0.0717', 'HR@20': '0.1637', 'NDCG@20': '0.0823'}
2025-03-07 10:47:55,472 - Validation score increased.  Saving model ...
2025-03-07 10:48:17,683 - {'epoch': 43, 'rec_loss': '6.7369'}
2025-03-07 10:48:27,251 - {'Epoch': 43, 'HR@5': '0.0856', 'NDCG@5': '0.0596', 'HR@10': '0.1181', 'NDCG@10': '0.0700', 'HR@20': '0.1631', 'NDCG@20': '0.0814'}
2025-03-07 10:48:27,260 - EarlyStopping counter: 1 out of 10
2025-03-07 10:48:46,909 - {'epoch': 44, 'rec_loss': '6.7278'}
2025-03-07 10:48:57,543 - {'Epoch': 44, 'HR@5': '0.0850', 'NDCG@5': '0.0591', 'HR@10': '0.1176', 'NDCG@10': '0.0696', 'HR@20': '0.1620', 'NDCG@20': '0.0808'}
2025-03-07 10:48:57,549 - EarlyStopping counter: 2 out of 10
2025-03-07 10:49:21,765 - {'epoch': 45, 'rec_loss': '6.7209'}
2025-03-07 10:49:32,246 - {'Epoch': 45, 'HR@5': '0.0855', 'NDCG@5': '0.0596', 'HR@10': '0.1193', 'NDCG@10': '0.0705', 'HR@20': '0.1632', 'NDCG@20': '0.0816'}
2025-03-07 10:49:32,257 - EarlyStopping counter: 3 out of 10
2025-03-07 10:49:56,271 - {'epoch': 46, 'rec_loss': '6.7262'}
2025-03-07 10:50:06,586 - {'Epoch': 46, 'HR@5': '0.0853', 'NDCG@5': '0.0598', 'HR@10': '0.1171', 'NDCG@10': '0.0700', 'HR@20': '0.1626', 'NDCG@20': '0.0814'}
2025-03-07 10:50:06,594 - EarlyStopping counter: 4 out of 10
2025-03-07 10:50:27,986 - {'epoch': 47, 'rec_loss': '6.7155'}
2025-03-07 10:50:37,562 - {'Epoch': 47, 'HR@5': '0.0855', 'NDCG@5': '0.0595', 'HR@10': '0.1172', 'NDCG@10': '0.0697', 'HR@20': '0.1625', 'NDCG@20': '0.0811'}
2025-03-07 10:50:37,563 - EarlyStopping counter: 5 out of 10
2025-03-07 10:50:58,681 - {'epoch': 48, 'rec_loss': '6.7119'}
2025-03-07 10:51:07,865 - {'Epoch': 48, 'HR@5': '0.0846', 'NDCG@5': '0.0598', 'HR@10': '0.1190', 'NDCG@10': '0.0709', 'HR@20': '0.1619', 'NDCG@20': '0.0817'}
2025-03-07 10:51:07,875 - EarlyStopping counter: 6 out of 10
2025-03-07 10:51:29,794 - {'epoch': 49, 'rec_loss': '6.7151'}
2025-03-07 10:51:40,109 - {'Epoch': 49, 'HR@5': '0.0862', 'NDCG@5': '0.0596', 'HR@10': '0.1183', 'NDCG@10': '0.0699', 'HR@20': '0.1621', 'NDCG@20': '0.0810'}
2025-03-07 10:51:40,110 - EarlyStopping counter: 7 out of 10
2025-03-07 10:52:00,919 - {'epoch': 50, 'rec_loss': '6.7064'}
2025-03-07 10:52:11,016 - {'Epoch': 50, 'HR@5': '0.0855', 'NDCG@5': '0.0597', 'HR@10': '0.1189', 'NDCG@10': '0.0705', 'HR@20': '0.1634', 'NDCG@20': '0.0817'}
2025-03-07 10:52:11,029 - EarlyStopping counter: 8 out of 10
2025-03-07 10:52:33,829 - {'epoch': 51, 'rec_loss': '6.7005'}
2025-03-07 10:52:43,885 - {'Epoch': 51, 'HR@5': '0.0856', 'NDCG@5': '0.0597', 'HR@10': '0.1189', 'NDCG@10': '0.0704', 'HR@20': '0.1623', 'NDCG@20': '0.0814'}
2025-03-07 10:52:43,887 - EarlyStopping counter: 9 out of 10
2025-03-07 10:53:08,710 - {'epoch': 52, 'rec_loss': '6.6945'}
2025-03-07 10:53:18,920 - {'Epoch': 52, 'HR@5': '0.0859', 'NDCG@5': '0.0602', 'HR@10': '0.1194', 'NDCG@10': '0.0709', 'HR@20': '0.1634', 'NDCG@20': '0.0820'}
2025-03-07 10:53:18,927 - EarlyStopping counter: 10 out of 10
2025-03-07 10:53:18,927 - Early stopping
2025-03-07 10:53:18,927 - ---------------Test Score---------------
2025-03-07 10:53:28,440 - {'Epoch': 0, 'HR@5': '0.0712', 'NDCG@5': '0.0501', 'HR@10': '0.0994', 'NDCG@10': '0.0592', 'HR@20': '0.1379', 'NDCG@20': '0.0689'}
2025-03-07 10:53:28,446 - Scale_Beauty
2025-03-07 10:53:28,446 - {'Epoch': 0, 'HR@5': '0.0712', 'NDCG@5': '0.0501', 'HR@10': '0.0994', 'NDCG@10': '0.0592', 'HR@20': '0.1379', 'NDCG@20': '0.0689'}
2025-03-07 14:36:33,309 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 12, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-07 14:36:37,407 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-07 14:36:37,413 - Total Parameters: 929445
2025-03-07 14:37:08,782 - {'epoch': 0, 'rec_loss': '8.8976'}
2025-03-07 14:37:20,102 - {'Epoch': 0, 'HR@5': '0.0132', 'NDCG@5': '0.0080', 'HR@10': '0.0237', 'NDCG@10': '0.0114', 'HR@20': '0.0356', 'NDCG@20': '0.0144'}
2025-03-07 14:37:20,104 - Validation score increased.  Saving model ...
2025-03-07 14:37:55,164 - {'epoch': 1, 'rec_loss': '8.4847'}
2025-03-07 14:38:05,771 - {'Epoch': 1, 'HR@5': '0.0279', 'NDCG@5': '0.0175', 'HR@10': '0.0414', 'NDCG@10': '0.0218', 'HR@20': '0.0613', 'NDCG@20': '0.0268'}
2025-03-07 14:38:05,772 - Validation score increased.  Saving model ...
2025-03-07 14:38:35,745 - {'epoch': 2, 'rec_loss': '8.2204'}
2025-03-07 14:38:45,723 - {'Epoch': 2, 'HR@5': '0.0366', 'NDCG@5': '0.0241', 'HR@10': '0.0545', 'NDCG@10': '0.0299', 'HR@20': '0.0797', 'NDCG@20': '0.0362'}
2025-03-07 14:38:45,725 - Validation score increased.  Saving model ...
2025-03-07 14:39:12,139 - {'epoch': 3, 'rec_loss': '8.0042'}
2025-03-07 14:39:21,147 - {'Epoch': 3, 'HR@5': '0.0440', 'NDCG@5': '0.0292', 'HR@10': '0.0656', 'NDCG@10': '0.0362', 'HR@20': '0.0963', 'NDCG@20': '0.0439'}
2025-03-07 14:39:21,148 - Validation score increased.  Saving model ...
2025-03-07 14:39:43,017 - {'epoch': 4, 'rec_loss': '7.8464'}
2025-03-07 14:39:51,684 - {'Epoch': 4, 'HR@5': '0.0543', 'NDCG@5': '0.0370', 'HR@10': '0.0786', 'NDCG@10': '0.0448', 'HR@20': '0.1121', 'NDCG@20': '0.0533'}
2025-03-07 14:39:51,685 - Validation score increased.  Saving model ...
2025-03-07 14:40:20,329 - {'epoch': 5, 'rec_loss': '7.7225'}
2025-03-07 14:40:29,878 - {'Epoch': 5, 'HR@5': '0.0603', 'NDCG@5': '0.0418', 'HR@10': '0.0885', 'NDCG@10': '0.0508', 'HR@20': '0.1204', 'NDCG@20': '0.0589'}
2025-03-07 14:40:29,879 - Validation score increased.  Saving model ...
2025-03-07 14:40:58,444 - {'epoch': 6, 'rec_loss': '7.6211'}
2025-03-07 14:41:09,200 - {'Epoch': 6, 'HR@5': '0.0646', 'NDCG@5': '0.0450', 'HR@10': '0.0925', 'NDCG@10': '0.0540', 'HR@20': '0.1274', 'NDCG@20': '0.0627'}
2025-03-07 14:41:09,202 - Validation score increased.  Saving model ...
2025-03-07 14:41:44,285 - {'epoch': 7, 'rec_loss': '7.5385'}
2025-03-07 14:41:54,300 - {'Epoch': 7, 'HR@5': '0.0698', 'NDCG@5': '0.0490', 'HR@10': '0.0973', 'NDCG@10': '0.0578', 'HR@20': '0.1324', 'NDCG@20': '0.0666'}
2025-03-07 14:41:54,301 - Validation score increased.  Saving model ...
2025-03-07 14:42:23,656 - {'epoch': 8, 'rec_loss': '7.4679'}
2025-03-07 14:42:33,080 - {'Epoch': 8, 'HR@5': '0.0727', 'NDCG@5': '0.0510', 'HR@10': '0.0996', 'NDCG@10': '0.0597', 'HR@20': '0.1367', 'NDCG@20': '0.0690'}
2025-03-07 14:42:33,082 - Validation score increased.  Saving model ...
2025-03-07 14:42:56,594 - {'epoch': 9, 'rec_loss': '7.4095'}
2025-03-07 14:43:05,496 - {'Epoch': 9, 'HR@5': '0.0738', 'NDCG@5': '0.0516', 'HR@10': '0.1030', 'NDCG@10': '0.0611', 'HR@20': '0.1405', 'NDCG@20': '0.0705'}
2025-03-07 14:43:05,498 - Validation score increased.  Saving model ...
2025-03-07 14:43:27,709 - {'epoch': 10, 'rec_loss': '7.3598'}
2025-03-07 14:43:36,533 - {'Epoch': 10, 'HR@5': '0.0761', 'NDCG@5': '0.0539', 'HR@10': '0.1045', 'NDCG@10': '0.0630', 'HR@20': '0.1419', 'NDCG@20': '0.0724'}
2025-03-07 14:43:36,535 - Validation score increased.  Saving model ...
2025-03-07 14:43:58,719 - {'epoch': 11, 'rec_loss': '7.3105'}
2025-03-07 14:44:08,314 - {'Epoch': 11, 'HR@5': '0.0764', 'NDCG@5': '0.0544', 'HR@10': '0.1062', 'NDCG@10': '0.0640', 'HR@20': '0.1432', 'NDCG@20': '0.0733'}
2025-03-07 14:44:08,316 - Validation score increased.  Saving model ...
2025-03-07 14:44:39,506 - {'epoch': 12, 'rec_loss': '7.2740'}
2025-03-07 14:44:50,430 - {'Epoch': 12, 'HR@5': '0.0772', 'NDCG@5': '0.0549', 'HR@10': '0.1068', 'NDCG@10': '0.0644', 'HR@20': '0.1453', 'NDCG@20': '0.0741'}
2025-03-07 14:44:50,431 - Validation score increased.  Saving model ...
2025-03-07 14:45:25,143 - {'epoch': 13, 'rec_loss': '7.2351'}
2025-03-07 14:45:36,739 - {'Epoch': 13, 'HR@5': '0.0778', 'NDCG@5': '0.0554', 'HR@10': '0.1089', 'NDCG@10': '0.0654', 'HR@20': '0.1469', 'NDCG@20': '0.0750'}
2025-03-07 14:45:36,749 - Validation score increased.  Saving model ...
2025-03-07 14:46:05,658 - {'epoch': 14, 'rec_loss': '7.2078'}
2025-03-07 14:46:15,168 - {'Epoch': 14, 'HR@5': '0.0796', 'NDCG@5': '0.0568', 'HR@10': '0.1096', 'NDCG@10': '0.0664', 'HR@20': '0.1473', 'NDCG@20': '0.0760'}
2025-03-07 14:46:15,170 - Validation score increased.  Saving model ...
2025-03-07 14:46:36,917 - {'epoch': 15, 'rec_loss': '7.1824'}
2025-03-07 14:46:45,521 - {'Epoch': 15, 'HR@5': '0.0794', 'NDCG@5': '0.0565', 'HR@10': '0.1107', 'NDCG@10': '0.0666', 'HR@20': '0.1480', 'NDCG@20': '0.0760'}
2025-03-07 14:46:45,523 - Validation score increased.  Saving model ...
2025-03-07 14:47:08,099 - {'epoch': 16, 'rec_loss': '7.1586'}
2025-03-07 14:47:16,960 - {'Epoch': 16, 'HR@5': '0.0805', 'NDCG@5': '0.0570', 'HR@10': '0.1105', 'NDCG@10': '0.0667', 'HR@20': '0.1504', 'NDCG@20': '0.0768'}
2025-03-07 14:47:16,961 - Validation score increased.  Saving model ...
2025-03-07 14:47:40,578 - {'epoch': 17, 'rec_loss': '7.1369'}
2025-03-07 14:47:50,064 - {'Epoch': 17, 'HR@5': '0.0794', 'NDCG@5': '0.0565', 'HR@10': '0.1110', 'NDCG@10': '0.0666', 'HR@20': '0.1489', 'NDCG@20': '0.0761'}
2025-03-07 14:47:50,066 - EarlyStopping counter: 1 out of 10
2025-03-07 14:48:21,469 - {'epoch': 18, 'rec_loss': '7.1138'}
2025-03-07 14:48:33,248 - {'Epoch': 18, 'HR@5': '0.0800', 'NDCG@5': '0.0566', 'HR@10': '0.1115', 'NDCG@10': '0.0667', 'HR@20': '0.1496', 'NDCG@20': '0.0763'}
2025-03-07 14:48:33,250 - EarlyStopping counter: 2 out of 10
2025-03-07 14:49:05,441 - {'epoch': 19, 'rec_loss': '7.0914'}
2025-03-07 14:49:17,342 - {'Epoch': 19, 'HR@5': '0.0818', 'NDCG@5': '0.0585', 'HR@10': '0.1118', 'NDCG@10': '0.0682', 'HR@20': '0.1509', 'NDCG@20': '0.0780'}
2025-03-07 14:49:17,343 - Validation score increased.  Saving model ...
2025-03-07 14:49:46,188 - {'epoch': 20, 'rec_loss': '7.0714'}
2025-03-07 14:49:56,103 - {'Epoch': 20, 'HR@5': '0.0822', 'NDCG@5': '0.0584', 'HR@10': '0.1129', 'NDCG@10': '0.0682', 'HR@20': '0.1514', 'NDCG@20': '0.0779'}
2025-03-07 14:49:56,104 - EarlyStopping counter: 1 out of 10
2025-03-07 14:50:19,650 - {'epoch': 21, 'rec_loss': '7.0549'}
2025-03-07 14:50:28,867 - {'Epoch': 21, 'HR@5': '0.0825', 'NDCG@5': '0.0583', 'HR@10': '0.1130', 'NDCG@10': '0.0681', 'HR@20': '0.1511', 'NDCG@20': '0.0777'}
2025-03-07 14:50:28,868 - EarlyStopping counter: 2 out of 10
2025-03-07 14:50:50,857 - {'epoch': 22, 'rec_loss': '7.0476'}
2025-03-07 14:51:00,191 - {'Epoch': 22, 'HR@5': '0.0815', 'NDCG@5': '0.0580', 'HR@10': '0.1137', 'NDCG@10': '0.0684', 'HR@20': '0.1535', 'NDCG@20': '0.0783'}
2025-03-07 14:51:00,193 - Validation score increased.  Saving model ...
2025-03-07 14:51:24,212 - {'epoch': 23, 'rec_loss': '7.0295'}
2025-03-07 14:51:34,311 - {'Epoch': 23, 'HR@5': '0.0813', 'NDCG@5': '0.0577', 'HR@10': '0.1135', 'NDCG@10': '0.0682', 'HR@20': '0.1529', 'NDCG@20': '0.0781'}
2025-03-07 14:51:34,313 - EarlyStopping counter: 1 out of 10
2025-03-07 14:52:04,636 - {'epoch': 24, 'rec_loss': '7.0214'}
2025-03-07 14:52:16,429 - {'Epoch': 24, 'HR@5': '0.0829', 'NDCG@5': '0.0588', 'HR@10': '0.1130', 'NDCG@10': '0.0685', 'HR@20': '0.1536', 'NDCG@20': '0.0788'}
2025-03-07 14:52:16,431 - Validation score increased.  Saving model ...
2025-03-07 14:52:47,346 - {'epoch': 25, 'rec_loss': '7.0032'}
2025-03-07 14:52:58,341 - {'Epoch': 25, 'HR@5': '0.0817', 'NDCG@5': '0.0580', 'HR@10': '0.1138', 'NDCG@10': '0.0683', 'HR@20': '0.1539', 'NDCG@20': '0.0784'}
2025-03-07 14:52:58,343 - EarlyStopping counter: 1 out of 10
2025-03-07 14:53:25,858 - {'epoch': 26, 'rec_loss': '6.9886'}
2025-03-07 14:53:35,772 - {'Epoch': 26, 'HR@5': '0.0835', 'NDCG@5': '0.0587', 'HR@10': '0.1138', 'NDCG@10': '0.0685', 'HR@20': '0.1535', 'NDCG@20': '0.0785'}
2025-03-07 14:53:35,780 - EarlyStopping counter: 2 out of 10
2025-03-07 14:53:57,963 - {'epoch': 27, 'rec_loss': '6.9786'}
2025-03-07 14:54:06,965 - {'Epoch': 27, 'HR@5': '0.0834', 'NDCG@5': '0.0598', 'HR@10': '0.1147', 'NDCG@10': '0.0699', 'HR@20': '0.1561', 'NDCG@20': '0.0803'}
2025-03-07 14:54:06,966 - Validation score increased.  Saving model ...
2025-03-07 14:54:28,804 - {'epoch': 28, 'rec_loss': '6.9717'}
2025-03-07 14:54:38,758 - {'Epoch': 28, 'HR@5': '0.0842', 'NDCG@5': '0.0591', 'HR@10': '0.1138', 'NDCG@10': '0.0686', 'HR@20': '0.1545', 'NDCG@20': '0.0789'}
2025-03-07 14:54:38,760 - EarlyStopping counter: 1 out of 10
2025-03-07 14:55:04,832 - {'epoch': 29, 'rec_loss': '6.9635'}
2025-03-07 14:55:14,992 - {'Epoch': 29, 'HR@5': '0.0827', 'NDCG@5': '0.0586', 'HR@10': '0.1147', 'NDCG@10': '0.0689', 'HR@20': '0.1557', 'NDCG@20': '0.0792'}
2025-03-07 14:55:14,993 - EarlyStopping counter: 2 out of 10
2025-03-07 14:55:40,821 - {'epoch': 30, 'rec_loss': '6.9511'}
2025-03-07 14:55:51,888 - {'Epoch': 30, 'HR@5': '0.0840', 'NDCG@5': '0.0598', 'HR@10': '0.1155', 'NDCG@10': '0.0699', 'HR@20': '0.1565', 'NDCG@20': '0.0803'}
2025-03-07 14:55:51,889 - EarlyStopping counter: 3 out of 10
2025-03-07 14:56:18,613 - {'epoch': 31, 'rec_loss': '6.9464'}
2025-03-07 14:56:29,074 - {'Epoch': 31, 'HR@5': '0.0844', 'NDCG@5': '0.0605', 'HR@10': '0.1159', 'NDCG@10': '0.0706', 'HR@20': '0.1566', 'NDCG@20': '0.0808'}
2025-03-07 14:56:29,075 - Validation score increased.  Saving model ...
2025-03-07 14:56:57,186 - {'epoch': 32, 'rec_loss': '6.9351'}
2025-03-07 14:57:07,987 - {'Epoch': 32, 'HR@5': '0.0849', 'NDCG@5': '0.0606', 'HR@10': '0.1152', 'NDCG@10': '0.0704', 'HR@20': '0.1565', 'NDCG@20': '0.0808'}
2025-03-07 14:57:07,990 - Validation score increased.  Saving model ...
2025-03-07 14:57:33,951 - {'epoch': 33, 'rec_loss': '6.9321'}
2025-03-07 14:57:44,511 - {'Epoch': 33, 'HR@5': '0.0843', 'NDCG@5': '0.0597', 'HR@10': '0.1148', 'NDCG@10': '0.0696', 'HR@20': '0.1557', 'NDCG@20': '0.0798'}
2025-03-07 14:57:44,513 - EarlyStopping counter: 1 out of 10
2025-03-07 14:58:11,363 - {'epoch': 34, 'rec_loss': '6.9255'}
2025-03-07 14:58:21,062 - {'Epoch': 34, 'HR@5': '0.0840', 'NDCG@5': '0.0600', 'HR@10': '0.1159', 'NDCG@10': '0.0703', 'HR@20': '0.1552', 'NDCG@20': '0.0801'}
2025-03-07 14:58:21,078 - EarlyStopping counter: 2 out of 10
2025-03-07 14:58:47,904 - {'epoch': 35, 'rec_loss': '6.9193'}
2025-03-07 14:58:57,688 - {'Epoch': 35, 'HR@5': '0.0850', 'NDCG@5': '0.0600', 'HR@10': '0.1164', 'NDCG@10': '0.0701', 'HR@20': '0.1557', 'NDCG@20': '0.0800'}
2025-03-07 14:58:57,691 - EarlyStopping counter: 3 out of 10
2025-03-07 14:59:17,969 - {'epoch': 36, 'rec_loss': '6.9089'}
2025-03-07 14:59:27,289 - {'Epoch': 36, 'HR@5': '0.0845', 'NDCG@5': '0.0603', 'HR@10': '0.1175', 'NDCG@10': '0.0709', 'HR@20': '0.1578', 'NDCG@20': '0.0811'}
2025-03-07 14:59:27,302 - Validation score increased.  Saving model ...
2025-03-07 14:59:56,819 - {'epoch': 37, 'rec_loss': '6.9077'}
2025-03-07 15:00:07,715 - {'Epoch': 37, 'HR@5': '0.0838', 'NDCG@5': '0.0594', 'HR@10': '0.1163', 'NDCG@10': '0.0699', 'HR@20': '0.1569', 'NDCG@20': '0.0801'}
2025-03-07 15:00:07,717 - EarlyStopping counter: 1 out of 10
2025-03-07 15:00:39,829 - {'epoch': 38, 'rec_loss': '6.8985'}
2025-03-07 15:00:52,194 - {'Epoch': 38, 'HR@5': '0.0846', 'NDCG@5': '0.0597', 'HR@10': '0.1172', 'NDCG@10': '0.0702', 'HR@20': '0.1580', 'NDCG@20': '0.0805'}
2025-03-07 15:00:52,196 - EarlyStopping counter: 2 out of 10
2025-03-07 15:01:22,144 - {'epoch': 39, 'rec_loss': '6.8937'}
2025-03-07 15:01:31,850 - {'Epoch': 39, 'HR@5': '0.0848', 'NDCG@5': '0.0603', 'HR@10': '0.1153', 'NDCG@10': '0.0701', 'HR@20': '0.1562', 'NDCG@20': '0.0804'}
2025-03-07 15:01:31,852 - EarlyStopping counter: 3 out of 10
2025-03-07 15:01:55,996 - {'epoch': 40, 'rec_loss': '6.8860'}
2025-03-07 15:02:06,363 - {'Epoch': 40, 'HR@5': '0.0859', 'NDCG@5': '0.0614', 'HR@10': '0.1177', 'NDCG@10': '0.0716', 'HR@20': '0.1579', 'NDCG@20': '0.0817'}
2025-03-07 15:02:06,364 - Validation score increased.  Saving model ...
2025-03-07 15:02:28,335 - {'epoch': 41, 'rec_loss': '6.8867'}
2025-03-07 15:02:37,613 - {'Epoch': 41, 'HR@5': '0.0863', 'NDCG@5': '0.0609', 'HR@10': '0.1180', 'NDCG@10': '0.0711', 'HR@20': '0.1576', 'NDCG@20': '0.0810'}
2025-03-07 15:02:37,615 - EarlyStopping counter: 1 out of 10
2025-03-07 15:02:59,798 - {'epoch': 42, 'rec_loss': '6.8759'}
2025-03-07 15:03:09,265 - {'Epoch': 42, 'HR@5': '0.0853', 'NDCG@5': '0.0605', 'HR@10': '0.1166', 'NDCG@10': '0.0706', 'HR@20': '0.1567', 'NDCG@20': '0.0807'}
2025-03-07 15:03:09,268 - EarlyStopping counter: 2 out of 10
2025-03-07 15:03:38,751 - {'epoch': 43, 'rec_loss': '6.8739'}
2025-03-07 15:03:50,558 - {'Epoch': 43, 'HR@5': '0.0857', 'NDCG@5': '0.0606', 'HR@10': '0.1170', 'NDCG@10': '0.0707', 'HR@20': '0.1590', 'NDCG@20': '0.0813'}
2025-03-07 15:03:50,561 - EarlyStopping counter: 3 out of 10
2025-03-07 15:04:23,142 - {'epoch': 44, 'rec_loss': '6.8704'}
2025-03-07 15:04:34,704 - {'Epoch': 44, 'HR@5': '0.0843', 'NDCG@5': '0.0593', 'HR@10': '0.1163', 'NDCG@10': '0.0696', 'HR@20': '0.1576', 'NDCG@20': '0.0800'}
2025-03-07 15:04:34,706 - EarlyStopping counter: 4 out of 10
2025-03-07 15:05:05,935 - {'epoch': 45, 'rec_loss': '6.8668'}
2025-03-07 15:05:15,660 - {'Epoch': 45, 'HR@5': '0.0846', 'NDCG@5': '0.0598', 'HR@10': '0.1183', 'NDCG@10': '0.0707', 'HR@20': '0.1588', 'NDCG@20': '0.0809'}
2025-03-07 15:05:15,661 - EarlyStopping counter: 5 out of 10
2025-03-07 15:05:37,138 - {'epoch': 46, 'rec_loss': '6.8596'}
2025-03-07 15:05:46,095 - {'Epoch': 46, 'HR@5': '0.0859', 'NDCG@5': '0.0609', 'HR@10': '0.1172', 'NDCG@10': '0.0710', 'HR@20': '0.1567', 'NDCG@20': '0.0809'}
2025-03-07 15:05:46,098 - EarlyStopping counter: 6 out of 10
2025-03-07 15:06:08,161 - {'epoch': 47, 'rec_loss': '6.8510'}
2025-03-07 15:06:17,173 - {'Epoch': 47, 'HR@5': '0.0844', 'NDCG@5': '0.0603', 'HR@10': '0.1165', 'NDCG@10': '0.0707', 'HR@20': '0.1575', 'NDCG@20': '0.0811'}
2025-03-07 15:06:17,179 - EarlyStopping counter: 7 out of 10
2025-03-07 15:06:38,466 - {'epoch': 48, 'rec_loss': '6.8439'}
2025-03-07 15:06:47,857 - {'Epoch': 48, 'HR@5': '0.0843', 'NDCG@5': '0.0601', 'HR@10': '0.1182', 'NDCG@10': '0.0710', 'HR@20': '0.1578', 'NDCG@20': '0.0810'}
2025-03-07 15:06:47,859 - EarlyStopping counter: 8 out of 10
2025-03-07 15:07:18,019 - {'epoch': 49, 'rec_loss': '6.8401'}
2025-03-07 15:07:29,380 - {'Epoch': 49, 'HR@5': '0.0845', 'NDCG@5': '0.0600', 'HR@10': '0.1171', 'NDCG@10': '0.0705', 'HR@20': '0.1582', 'NDCG@20': '0.0808'}
2025-03-07 15:07:29,381 - EarlyStopping counter: 9 out of 10
2025-03-07 15:08:00,234 - {'epoch': 50, 'rec_loss': '6.8436'}
2025-03-07 15:08:12,014 - {'Epoch': 50, 'HR@5': '0.0868', 'NDCG@5': '0.0611', 'HR@10': '0.1172', 'NDCG@10': '0.0709', 'HR@20': '0.1597', 'NDCG@20': '0.0816'}
2025-03-07 15:08:12,017 - EarlyStopping counter: 10 out of 10
2025-03-07 15:08:12,018 - Early stopping
2025-03-07 15:08:12,018 - ---------------Test Score---------------
2025-03-07 15:08:23,594 - {'Epoch': 0, 'HR@5': '0.0698', 'NDCG@5': '0.0502', 'HR@10': '0.0973', 'NDCG@10': '0.0591', 'HR@20': '0.1334', 'NDCG@20': '0.0682'}
2025-03-07 15:08:23,596 - Scale_Beauty
2025-03-07 15:08:23,596 - {'Epoch': 0, 'HR@5': '0.0698', 'NDCG@5': '0.0502', 'HR@10': '0.0973', 'NDCG@10': '0.0591', 'HR@20': '0.1334', 'NDCG@20': '0.0682'}
2025-03-21 14:14:02,568 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 12, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-21 14:14:16,649 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-21 14:14:16,656 - Total Parameters: 929445
2025-03-21 14:14:52,157 - {'epoch': 0, 'rec_loss': '8.8962'}
2025-03-21 14:15:01,611 - {'Epoch': 0, 'HR@5': '0.0192', 'NDCG@5': '0.0122', 'HR@10': '0.0316', 'NDCG@10': '0.0161', 'HR@20': '0.0472', 'NDCG@20': '0.0201'}
2025-03-21 14:15:01,615 - Validation score increased.  Saving model ...
2025-03-21 14:15:33,254 - {'epoch': 1, 'rec_loss': '8.4048'}
2025-03-21 14:15:42,883 - {'Epoch': 1, 'HR@5': '0.0342', 'NDCG@5': '0.0226', 'HR@10': '0.0523', 'NDCG@10': '0.0284', 'HR@20': '0.0765', 'NDCG@20': '0.0345'}
2025-03-21 14:15:42,885 - Validation score increased.  Saving model ...
2025-03-21 14:16:15,597 - {'epoch': 2, 'rec_loss': '8.1510'}
2025-03-21 14:16:25,398 - {'Epoch': 2, 'HR@5': '0.0435', 'NDCG@5': '0.0297', 'HR@10': '0.0659', 'NDCG@10': '0.0369', 'HR@20': '0.0964', 'NDCG@20': '0.0446'}
2025-03-21 14:16:25,404 - Validation score increased.  Saving model ...
2025-03-21 14:16:57,144 - {'epoch': 3, 'rec_loss': '7.9680'}
2025-03-21 14:17:06,141 - {'Epoch': 3, 'HR@5': '0.0535', 'NDCG@5': '0.0355', 'HR@10': '0.0783', 'NDCG@10': '0.0435', 'HR@20': '0.1127', 'NDCG@20': '0.0521'}
2025-03-21 14:17:06,147 - Validation score increased.  Saving model ...
2025-03-21 14:17:37,816 - {'epoch': 4, 'rec_loss': '7.8333'}
2025-03-21 14:17:46,761 - {'Epoch': 4, 'HR@5': '0.0613', 'NDCG@5': '0.0416', 'HR@10': '0.0865', 'NDCG@10': '0.0497', 'HR@20': '0.1205', 'NDCG@20': '0.0582'}
2025-03-21 14:17:46,762 - Validation score increased.  Saving model ...
2025-03-21 14:18:17,138 - {'epoch': 5, 'rec_loss': '7.7218'}
2025-03-21 14:18:26,716 - {'Epoch': 5, 'HR@5': '0.0665', 'NDCG@5': '0.0462', 'HR@10': '0.0954', 'NDCG@10': '0.0555', 'HR@20': '0.1313', 'NDCG@20': '0.0645'}
2025-03-21 14:18:26,718 - Validation score increased.  Saving model ...
2025-03-21 14:18:58,627 - {'epoch': 6, 'rec_loss': '7.6265'}
2025-03-21 14:19:07,279 - {'Epoch': 6, 'HR@5': '0.0695', 'NDCG@5': '0.0479', 'HR@10': '0.0985', 'NDCG@10': '0.0573', 'HR@20': '0.1364', 'NDCG@20': '0.0668'}
2025-03-21 14:19:07,281 - Validation score increased.  Saving model ...
2025-03-21 14:19:49,752 - {'epoch': 7, 'rec_loss': '7.5518'}
2025-03-21 14:19:59,755 - {'Epoch': 7, 'HR@5': '0.0741', 'NDCG@5': '0.0521', 'HR@10': '0.1031', 'NDCG@10': '0.0615', 'HR@20': '0.1412', 'NDCG@20': '0.0711'}
2025-03-21 14:19:59,757 - Validation score increased.  Saving model ...
2025-03-21 14:20:32,061 - {'epoch': 8, 'rec_loss': '7.4880'}
2025-03-21 14:20:41,164 - {'Epoch': 8, 'HR@5': '0.0770', 'NDCG@5': '0.0531', 'HR@10': '0.1057', 'NDCG@10': '0.0623', 'HR@20': '0.1455', 'NDCG@20': '0.0723'}
2025-03-21 14:20:41,165 - Validation score increased.  Saving model ...
2025-03-21 14:21:12,773 - {'epoch': 9, 'rec_loss': '7.4360'}
2025-03-21 14:21:22,278 - {'Epoch': 9, 'HR@5': '0.0770', 'NDCG@5': '0.0532', 'HR@10': '0.1092', 'NDCG@10': '0.0636', 'HR@20': '0.1470', 'NDCG@20': '0.0731'}
2025-03-21 14:21:22,279 - Validation score increased.  Saving model ...
2025-03-21 14:21:53,558 - {'epoch': 10, 'rec_loss': '7.3890'}
2025-03-21 14:22:02,598 - {'Epoch': 10, 'HR@5': '0.0783', 'NDCG@5': '0.0554', 'HR@10': '0.1091', 'NDCG@10': '0.0653', 'HR@20': '0.1494', 'NDCG@20': '0.0754'}
2025-03-21 14:22:02,604 - Validation score increased.  Saving model ...
2025-03-21 14:22:35,010 - {'epoch': 11, 'rec_loss': '7.3491'}
2025-03-21 14:22:44,473 - {'Epoch': 11, 'HR@5': '0.0788', 'NDCG@5': '0.0552', 'HR@10': '0.1104', 'NDCG@10': '0.0654', 'HR@20': '0.1503', 'NDCG@20': '0.0754'}
2025-03-21 14:22:44,475 - Validation score increased.  Saving model ...
2025-03-21 14:23:15,110 - {'epoch': 12, 'rec_loss': '7.3124'}
2025-03-21 14:23:24,087 - {'Epoch': 12, 'HR@5': '0.0795', 'NDCG@5': '0.0560', 'HR@10': '0.1106', 'NDCG@10': '0.0660', 'HR@20': '0.1527', 'NDCG@20': '0.0766'}
2025-03-21 14:23:24,089 - Validation score increased.  Saving model ...
2025-03-21 14:23:55,581 - {'epoch': 13, 'rec_loss': '7.2796'}
2025-03-21 14:24:05,123 - {'Epoch': 13, 'HR@5': '0.0806', 'NDCG@5': '0.0568', 'HR@10': '0.1138', 'NDCG@10': '0.0675', 'HR@20': '0.1546', 'NDCG@20': '0.0777'}
2025-03-21 14:24:05,124 - Validation score increased.  Saving model ...
2025-03-21 14:24:35,327 - {'epoch': 14, 'rec_loss': '7.2597'}
2025-03-21 14:24:44,722 - {'Epoch': 14, 'HR@5': '0.0846', 'NDCG@5': '0.0589', 'HR@10': '0.1148', 'NDCG@10': '0.0687', 'HR@20': '0.1553', 'NDCG@20': '0.0788'}
2025-03-21 14:24:44,727 - Validation score increased.  Saving model ...
2025-03-21 14:25:16,105 - {'epoch': 15, 'rec_loss': '7.2348'}
2025-03-21 14:25:25,281 - {'Epoch': 15, 'HR@5': '0.0833', 'NDCG@5': '0.0586', 'HR@10': '0.1154', 'NDCG@10': '0.0689', 'HR@20': '0.1562', 'NDCG@20': '0.0792'}
2025-03-21 14:25:25,282 - Validation score increased.  Saving model ...
2025-03-21 14:25:56,003 - {'epoch': 16, 'rec_loss': '7.2113'}
2025-03-21 14:26:05,218 - {'Epoch': 16, 'HR@5': '0.0828', 'NDCG@5': '0.0585', 'HR@10': '0.1155', 'NDCG@10': '0.0690', 'HR@20': '0.1566', 'NDCG@20': '0.0794'}
2025-03-21 14:26:05,219 - Validation score increased.  Saving model ...
2025-03-21 14:26:36,575 - {'epoch': 17, 'rec_loss': '7.1890'}
2025-03-21 14:26:45,713 - {'Epoch': 17, 'HR@5': '0.0826', 'NDCG@5': '0.0574', 'HR@10': '0.1148', 'NDCG@10': '0.0677', 'HR@20': '0.1562', 'NDCG@20': '0.0782'}
2025-03-21 14:26:45,715 - EarlyStopping counter: 1 out of 10
2025-03-21 14:27:16,320 - {'epoch': 18, 'rec_loss': '7.1748'}
2025-03-21 14:27:25,875 - {'Epoch': 18, 'HR@5': '0.0837', 'NDCG@5': '0.0586', 'HR@10': '0.1157', 'NDCG@10': '0.0688', 'HR@20': '0.1573', 'NDCG@20': '0.0793'}
2025-03-21 14:27:25,876 - EarlyStopping counter: 2 out of 10
2025-03-21 14:27:57,199 - {'epoch': 19, 'rec_loss': '7.1611'}
2025-03-21 14:28:06,637 - {'Epoch': 19, 'HR@5': '0.0846', 'NDCG@5': '0.0594', 'HR@10': '0.1172', 'NDCG@10': '0.0699', 'HR@20': '0.1589', 'NDCG@20': '0.0804'}
2025-03-21 14:28:06,638 - Validation score increased.  Saving model ...
2025-03-21 14:28:35,106 - {'epoch': 20, 'rec_loss': '7.1458'}
2025-03-21 14:28:44,188 - {'Epoch': 20, 'HR@5': '0.0844', 'NDCG@5': '0.0589', 'HR@10': '0.1175', 'NDCG@10': '0.0696', 'HR@20': '0.1576', 'NDCG@20': '0.0797'}
2025-03-21 14:28:44,190 - EarlyStopping counter: 1 out of 10
2025-03-21 14:29:11,990 - {'epoch': 21, 'rec_loss': '7.1280'}
2025-03-21 14:29:20,851 - {'Epoch': 21, 'HR@5': '0.0851', 'NDCG@5': '0.0593', 'HR@10': '0.1164', 'NDCG@10': '0.0694', 'HR@20': '0.1603', 'NDCG@20': '0.0804'}
2025-03-21 14:29:20,853 - EarlyStopping counter: 2 out of 10
2025-03-21 14:29:50,608 - {'epoch': 22, 'rec_loss': '7.1202'}
2025-03-21 14:30:00,371 - {'Epoch': 22, 'HR@5': '0.0850', 'NDCG@5': '0.0593', 'HR@10': '0.1181', 'NDCG@10': '0.0700', 'HR@20': '0.1609', 'NDCG@20': '0.0807'}
2025-03-21 14:30:00,372 - Validation score increased.  Saving model ...
2025-03-21 14:30:29,074 - {'epoch': 23, 'rec_loss': '7.1092'}
2025-03-21 14:30:37,335 - {'Epoch': 23, 'HR@5': '0.0857', 'NDCG@5': '0.0604', 'HR@10': '0.1171', 'NDCG@10': '0.0705', 'HR@20': '0.1593', 'NDCG@20': '0.0811'}
2025-03-21 14:30:37,343 - Validation score increased.  Saving model ...
2025-03-21 14:31:04,763 - {'epoch': 24, 'rec_loss': '7.0968'}
2025-03-21 14:31:13,797 - {'Epoch': 24, 'HR@5': '0.0849', 'NDCG@5': '0.0595', 'HR@10': '0.1177', 'NDCG@10': '0.0701', 'HR@20': '0.1600', 'NDCG@20': '0.0808'}
2025-03-21 14:31:13,805 - EarlyStopping counter: 1 out of 10
2025-03-21 14:31:41,995 - {'epoch': 25, 'rec_loss': '7.0861'}
2025-03-21 14:31:51,197 - {'Epoch': 25, 'HR@5': '0.0839', 'NDCG@5': '0.0590', 'HR@10': '0.1172', 'NDCG@10': '0.0697', 'HR@20': '0.1610', 'NDCG@20': '0.0808'}
2025-03-21 14:31:51,204 - EarlyStopping counter: 2 out of 10
2025-03-21 14:32:18,553 - {'epoch': 26, 'rec_loss': '7.0802'}
2025-03-21 14:32:28,216 - {'Epoch': 26, 'HR@5': '0.0860', 'NDCG@5': '0.0599', 'HR@10': '0.1183', 'NDCG@10': '0.0703', 'HR@20': '0.1611', 'NDCG@20': '0.0811'}
2025-03-21 14:32:28,217 - Validation score increased.  Saving model ...
2025-03-21 14:32:58,778 - {'epoch': 27, 'rec_loss': '7.0645'}
2025-03-21 14:33:08,565 - {'Epoch': 27, 'HR@5': '0.0855', 'NDCG@5': '0.0605', 'HR@10': '0.1178', 'NDCG@10': '0.0709', 'HR@20': '0.1617', 'NDCG@20': '0.0819'}
2025-03-21 14:33:08,566 - Validation score increased.  Saving model ...
2025-03-21 14:33:38,025 - {'epoch': 28, 'rec_loss': '7.0561'}
2025-03-21 14:33:47,644 - {'Epoch': 28, 'HR@5': '0.0843', 'NDCG@5': '0.0592', 'HR@10': '0.1184', 'NDCG@10': '0.0702', 'HR@20': '0.1608', 'NDCG@20': '0.0808'}
2025-03-21 14:33:47,645 - EarlyStopping counter: 1 out of 10
2025-03-21 14:34:16,510 - {'epoch': 29, 'rec_loss': '7.0491'}
2025-03-21 14:34:25,833 - {'Epoch': 29, 'HR@5': '0.0855', 'NDCG@5': '0.0596', 'HR@10': '0.1184', 'NDCG@10': '0.0701', 'HR@20': '0.1615', 'NDCG@20': '0.0810'}
2025-03-21 14:34:25,839 - EarlyStopping counter: 2 out of 10
2025-03-21 14:34:54,967 - {'epoch': 30, 'rec_loss': '7.0434'}
2025-03-21 14:35:04,364 - {'Epoch': 30, 'HR@5': '0.0860', 'NDCG@5': '0.0606', 'HR@10': '0.1193', 'NDCG@10': '0.0713', 'HR@20': '0.1630', 'NDCG@20': '0.0823'}
2025-03-21 14:35:04,365 - Validation score increased.  Saving model ...
2025-03-21 14:35:34,471 - {'epoch': 31, 'rec_loss': '7.0316'}
2025-03-21 14:35:43,740 - {'Epoch': 31, 'HR@5': '0.0847', 'NDCG@5': '0.0597', 'HR@10': '0.1175', 'NDCG@10': '0.0704', 'HR@20': '0.1623', 'NDCG@20': '0.0816'}
2025-03-21 14:35:43,741 - EarlyStopping counter: 1 out of 10
2025-03-21 14:36:11,681 - {'epoch': 32, 'rec_loss': '7.0247'}
2025-03-21 14:36:21,100 - {'Epoch': 32, 'HR@5': '0.0859', 'NDCG@5': '0.0609', 'HR@10': '0.1182', 'NDCG@10': '0.0713', 'HR@20': '0.1629', 'NDCG@20': '0.0825'}
2025-03-21 14:36:21,101 - Validation score increased.  Saving model ...
2025-03-21 14:36:49,683 - {'epoch': 33, 'rec_loss': '7.0174'}
2025-03-21 14:36:58,486 - {'Epoch': 33, 'HR@5': '0.0855', 'NDCG@5': '0.0605', 'HR@10': '0.1183', 'NDCG@10': '0.0710', 'HR@20': '0.1619', 'NDCG@20': '0.0820'}
2025-03-21 14:36:58,487 - EarlyStopping counter: 1 out of 10
2025-03-21 14:37:27,299 - {'epoch': 34, 'rec_loss': '7.0123'}
2025-03-21 14:37:36,043 - {'Epoch': 34, 'HR@5': '0.0868', 'NDCG@5': '0.0607', 'HR@10': '0.1188', 'NDCG@10': '0.0711', 'HR@20': '0.1622', 'NDCG@20': '0.0820'}
2025-03-21 14:37:36,044 - EarlyStopping counter: 2 out of 10
2025-03-21 14:38:04,617 - {'epoch': 35, 'rec_loss': '7.0046'}
2025-03-21 14:38:13,648 - {'Epoch': 35, 'HR@5': '0.0864', 'NDCG@5': '0.0610', 'HR@10': '0.1189', 'NDCG@10': '0.0715', 'HR@20': '0.1635', 'NDCG@20': '0.0827'}
2025-03-21 14:38:13,650 - Validation score increased.  Saving model ...
2025-03-21 14:38:43,276 - {'epoch': 36, 'rec_loss': '6.9954'}
2025-03-21 14:38:52,593 - {'Epoch': 36, 'HR@5': '0.0856', 'NDCG@5': '0.0605', 'HR@10': '0.1205', 'NDCG@10': '0.0718', 'HR@20': '0.1642', 'NDCG@20': '0.0827'}
2025-03-21 14:38:52,600 - Validation score increased.  Saving model ...
2025-03-21 14:39:19,138 - {'epoch': 37, 'rec_loss': '6.9896'}
2025-03-21 14:39:28,488 - {'Epoch': 37, 'HR@5': '0.0864', 'NDCG@5': '0.0597', 'HR@10': '0.1198', 'NDCG@10': '0.0705', 'HR@20': '0.1644', 'NDCG@20': '0.0817'}
2025-03-21 14:39:28,495 - EarlyStopping counter: 1 out of 10
2025-03-21 14:39:55,528 - {'epoch': 38, 'rec_loss': '6.9810'}
2025-03-21 14:40:04,982 - {'Epoch': 38, 'HR@5': '0.0861', 'NDCG@5': '0.0605', 'HR@10': '0.1206', 'NDCG@10': '0.0717', 'HR@20': '0.1638', 'NDCG@20': '0.0826'}
2025-03-21 14:40:04,984 - EarlyStopping counter: 2 out of 10
2025-03-21 14:40:33,857 - {'epoch': 39, 'rec_loss': '6.9748'}
2025-03-21 14:40:43,325 - {'Epoch': 39, 'HR@5': '0.0855', 'NDCG@5': '0.0596', 'HR@10': '0.1190', 'NDCG@10': '0.0703', 'HR@20': '0.1634', 'NDCG@20': '0.0815'}
2025-03-21 14:40:43,328 - EarlyStopping counter: 3 out of 10
2025-03-21 14:41:10,985 - {'epoch': 40, 'rec_loss': '6.9735'}
2025-03-21 14:41:20,132 - {'Epoch': 40, 'HR@5': '0.0856', 'NDCG@5': '0.0602', 'HR@10': '0.1186', 'NDCG@10': '0.0708', 'HR@20': '0.1648', 'NDCG@20': '0.0824'}
2025-03-21 14:41:20,139 - EarlyStopping counter: 4 out of 10
2025-03-21 14:41:48,819 - {'epoch': 41, 'rec_loss': '6.9671'}
2025-03-21 14:41:58,250 - {'Epoch': 41, 'HR@5': '0.0858', 'NDCG@5': '0.0610', 'HR@10': '0.1205', 'NDCG@10': '0.0722', 'HR@20': '0.1632', 'NDCG@20': '0.0830'}
2025-03-21 14:41:58,252 - Validation score increased.  Saving model ...
2025-03-21 14:42:26,360 - {'epoch': 42, 'rec_loss': '6.9573'}
2025-03-21 14:42:35,645 - {'Epoch': 42, 'HR@5': '0.0862', 'NDCG@5': '0.0605', 'HR@10': '0.1205', 'NDCG@10': '0.0716', 'HR@20': '0.1622', 'NDCG@20': '0.0821'}
2025-03-21 14:42:35,647 - EarlyStopping counter: 1 out of 10
2025-03-21 14:43:03,963 - {'epoch': 43, 'rec_loss': '6.9525'}
2025-03-21 14:43:12,929 - {'Epoch': 43, 'HR@5': '0.0868', 'NDCG@5': '0.0608', 'HR@10': '0.1218', 'NDCG@10': '0.0720', 'HR@20': '0.1644', 'NDCG@20': '0.0828'}
2025-03-21 14:43:12,931 - EarlyStopping counter: 2 out of 10
2025-03-21 14:43:41,567 - {'epoch': 44, 'rec_loss': '6.9482'}
2025-03-21 14:43:50,903 - {'Epoch': 44, 'HR@5': '0.0862', 'NDCG@5': '0.0602', 'HR@10': '0.1200', 'NDCG@10': '0.0710', 'HR@20': '0.1622', 'NDCG@20': '0.0816'}
2025-03-21 14:43:50,911 - EarlyStopping counter: 3 out of 10
2025-03-21 14:44:20,605 - {'epoch': 45, 'rec_loss': '6.9373'}
2025-03-21 14:44:29,955 - {'Epoch': 45, 'HR@5': '0.0863', 'NDCG@5': '0.0602', 'HR@10': '0.1202', 'NDCG@10': '0.0712', 'HR@20': '0.1649', 'NDCG@20': '0.0825'}
2025-03-21 14:44:29,956 - EarlyStopping counter: 4 out of 10
2025-03-21 14:45:00,049 - {'epoch': 46, 'rec_loss': '6.9324'}
2025-03-21 14:45:09,602 - {'Epoch': 46, 'HR@5': '0.0861', 'NDCG@5': '0.0603', 'HR@10': '0.1201', 'NDCG@10': '0.0712', 'HR@20': '0.1648', 'NDCG@20': '0.0825'}
2025-03-21 14:45:09,604 - EarlyStopping counter: 5 out of 10
2025-03-21 14:45:39,976 - {'epoch': 47, 'rec_loss': '6.9340'}
2025-03-21 14:45:49,429 - {'Epoch': 47, 'HR@5': '0.0857', 'NDCG@5': '0.0598', 'HR@10': '0.1195', 'NDCG@10': '0.0708', 'HR@20': '0.1650', 'NDCG@20': '0.0822'}
2025-03-21 14:45:49,436 - EarlyStopping counter: 6 out of 10
2025-03-21 14:46:19,090 - {'epoch': 48, 'rec_loss': '6.9346'}
2025-03-21 14:46:28,229 - {'Epoch': 48, 'HR@5': '0.0867', 'NDCG@5': '0.0606', 'HR@10': '0.1204', 'NDCG@10': '0.0715', 'HR@20': '0.1652', 'NDCG@20': '0.0828'}
2025-03-21 14:46:28,231 - EarlyStopping counter: 7 out of 10
2025-03-21 14:46:58,439 - {'epoch': 49, 'rec_loss': '6.9185'}
2025-03-21 14:47:08,023 - {'Epoch': 49, 'HR@5': '0.0864', 'NDCG@5': '0.0603', 'HR@10': '0.1208', 'NDCG@10': '0.0714', 'HR@20': '0.1638', 'NDCG@20': '0.0822'}
2025-03-21 14:47:08,025 - EarlyStopping counter: 8 out of 10
2025-03-21 14:47:38,749 - {'epoch': 50, 'rec_loss': '6.9195'}
2025-03-21 14:47:47,798 - {'Epoch': 50, 'HR@5': '0.0876', 'NDCG@5': '0.0612', 'HR@10': '0.1206', 'NDCG@10': '0.0718', 'HR@20': '0.1651', 'NDCG@20': '0.0831'}
2025-03-21 14:47:47,799 - Validation score increased.  Saving model ...
2025-03-21 14:48:18,268 - {'epoch': 51, 'rec_loss': '6.9145'}
2025-03-21 14:48:27,664 - {'Epoch': 51, 'HR@5': '0.0869', 'NDCG@5': '0.0607', 'HR@10': '0.1216', 'NDCG@10': '0.0718', 'HR@20': '0.1655', 'NDCG@20': '0.0828'}
2025-03-21 14:48:27,665 - EarlyStopping counter: 1 out of 10
2025-03-21 14:48:58,802 - {'epoch': 52, 'rec_loss': '6.9057'}
2025-03-21 14:49:08,196 - {'Epoch': 52, 'HR@5': '0.0860', 'NDCG@5': '0.0610', 'HR@10': '0.1203', 'NDCG@10': '0.0720', 'HR@20': '0.1652', 'NDCG@20': '0.0833'}
2025-03-21 14:49:08,202 - Validation score increased.  Saving model ...
2025-03-21 14:49:39,555 - {'epoch': 53, 'rec_loss': '6.9062'}
2025-03-21 14:49:49,205 - {'Epoch': 53, 'HR@5': '0.0879', 'NDCG@5': '0.0613', 'HR@10': '0.1216', 'NDCG@10': '0.0721', 'HR@20': '0.1662', 'NDCG@20': '0.0833'}
2025-03-21 14:49:49,206 - EarlyStopping counter: 1 out of 10
2025-03-21 14:50:18,061 - {'epoch': 54, 'rec_loss': '6.8995'}
2025-03-21 14:50:27,167 - {'Epoch': 54, 'HR@5': '0.0863', 'NDCG@5': '0.0606', 'HR@10': '0.1203', 'NDCG@10': '0.0715', 'HR@20': '0.1645', 'NDCG@20': '0.0826'}
2025-03-21 14:50:27,168 - EarlyStopping counter: 2 out of 10
2025-03-21 14:50:54,841 - {'epoch': 55, 'rec_loss': '6.9001'}
2025-03-21 14:51:04,769 - {'Epoch': 55, 'HR@5': '0.0872', 'NDCG@5': '0.0614', 'HR@10': '0.1210', 'NDCG@10': '0.0723', 'HR@20': '0.1652', 'NDCG@20': '0.0834'}
2025-03-21 14:51:04,775 - Validation score increased.  Saving model ...
2025-03-21 14:52:06,029 - {'epoch': 56, 'rec_loss': '6.8903'}
2025-03-21 14:52:19,196 - {'Epoch': 56, 'HR@5': '0.0867', 'NDCG@5': '0.0614', 'HR@10': '0.1201', 'NDCG@10': '0.0722', 'HR@20': '0.1647', 'NDCG@20': '0.0834'}
2025-03-21 14:52:19,203 - Validation score increased.  Saving model ...
2025-03-21 14:52:48,057 - {'epoch': 57, 'rec_loss': '6.8842'}
2025-03-21 14:52:58,058 - {'Epoch': 57, 'HR@5': '0.0867', 'NDCG@5': '0.0608', 'HR@10': '0.1191', 'NDCG@10': '0.0712', 'HR@20': '0.1640', 'NDCG@20': '0.0825'}
2025-03-21 14:52:58,060 - EarlyStopping counter: 1 out of 10
2025-03-21 14:53:27,857 - {'epoch': 58, 'rec_loss': '6.8819'}
2025-03-21 14:53:37,874 - {'Epoch': 58, 'HR@5': '0.0872', 'NDCG@5': '0.0611', 'HR@10': '0.1200', 'NDCG@10': '0.0716', 'HR@20': '0.1651', 'NDCG@20': '0.0829'}
2025-03-21 14:53:37,875 - EarlyStopping counter: 2 out of 10
2025-03-21 14:54:05,997 - {'epoch': 59, 'rec_loss': '6.8827'}
2025-03-21 14:54:15,938 - {'Epoch': 59, 'HR@5': '0.0871', 'NDCG@5': '0.0611', 'HR@10': '0.1201', 'NDCG@10': '0.0717', 'HR@20': '0.1655', 'NDCG@20': '0.0831'}
2025-03-21 14:54:15,939 - EarlyStopping counter: 3 out of 10
2025-03-21 14:54:48,346 - {'epoch': 60, 'rec_loss': '6.8745'}
2025-03-21 14:54:57,670 - {'Epoch': 60, 'HR@5': '0.0865', 'NDCG@5': '0.0612', 'HR@10': '0.1191', 'NDCG@10': '0.0717', 'HR@20': '0.1653', 'NDCG@20': '0.0833'}
2025-03-21 14:54:57,671 - EarlyStopping counter: 4 out of 10
2025-03-21 14:55:27,831 - {'epoch': 61, 'rec_loss': '6.8766'}
2025-03-21 14:55:37,114 - {'Epoch': 61, 'HR@5': '0.0868', 'NDCG@5': '0.0609', 'HR@10': '0.1210', 'NDCG@10': '0.0719', 'HR@20': '0.1645', 'NDCG@20': '0.0829'}
2025-03-21 14:55:37,121 - EarlyStopping counter: 5 out of 10
2025-03-21 14:56:06,371 - {'epoch': 62, 'rec_loss': '6.8730'}
2025-03-21 14:56:15,781 - {'Epoch': 62, 'HR@5': '0.0878', 'NDCG@5': '0.0615', 'HR@10': '0.1192', 'NDCG@10': '0.0716', 'HR@20': '0.1653', 'NDCG@20': '0.0833'}
2025-03-21 14:56:15,783 - EarlyStopping counter: 6 out of 10
2025-03-21 14:56:43,925 - {'epoch': 63, 'rec_loss': '6.8714'}
2025-03-21 14:56:53,165 - {'Epoch': 63, 'HR@5': '0.0864', 'NDCG@5': '0.0607', 'HR@10': '0.1201', 'NDCG@10': '0.0715', 'HR@20': '0.1661', 'NDCG@20': '0.0831'}
2025-03-21 14:56:53,166 - EarlyStopping counter: 7 out of 10
2025-03-21 14:57:20,569 - {'epoch': 64, 'rec_loss': '6.8650'}
2025-03-21 14:57:29,783 - {'Epoch': 64, 'HR@5': '0.0870', 'NDCG@5': '0.0606', 'HR@10': '0.1189', 'NDCG@10': '0.0710', 'HR@20': '0.1649', 'NDCG@20': '0.0826'}
2025-03-21 14:57:29,791 - EarlyStopping counter: 8 out of 10
2025-03-21 14:57:57,255 - {'epoch': 65, 'rec_loss': '6.8620'}
2025-03-21 14:58:06,596 - {'Epoch': 65, 'HR@5': '0.0858', 'NDCG@5': '0.0600', 'HR@10': '0.1198', 'NDCG@10': '0.0710', 'HR@20': '0.1655', 'NDCG@20': '0.0825'}
2025-03-21 14:58:06,598 - EarlyStopping counter: 9 out of 10
2025-03-21 14:58:32,963 - {'epoch': 66, 'rec_loss': '6.8644'}
2025-03-21 14:58:42,586 - {'Epoch': 66, 'HR@5': '0.0872', 'NDCG@5': '0.0610', 'HR@10': '0.1196', 'NDCG@10': '0.0715', 'HR@20': '0.1654', 'NDCG@20': '0.0830'}
2025-03-21 14:58:42,588 - EarlyStopping counter: 10 out of 10
2025-03-21 14:58:42,588 - Early stopping
2025-03-21 14:58:42,588 - ---------------Test Score---------------
2025-03-21 14:58:51,643 - {'Epoch': 0, 'HR@5': '0.0719', 'NDCG@5': '0.0508', 'HR@10': '0.1008', 'NDCG@10': '0.0601', 'HR@20': '0.1376', 'NDCG@20': '0.0693'}
2025-03-21 14:58:51,652 - Scale_Beauty
2025-03-21 14:58:51,652 - {'Epoch': 0, 'HR@5': '0.0719', 'NDCG@5': '0.0508', 'HR@10': '0.1008', 'NDCG@10': '0.0601', 'HR@20': '0.1376', 'NDCG@20': '0.0693'}
2025-03-21 15:14:20,725 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 12, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-21 15:14:38,488 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-21 15:14:38,542 - Total Parameters: 929445
2025-03-21 15:22:32,548 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 12, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-21 15:22:39,565 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-21 15:22:39,599 - Total Parameters: 929445
2025-03-21 15:24:01,182 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 12, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-21 15:24:07,501 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-21 15:24:07,527 - Total Parameters: 929445
2025-03-21 15:28:47,130 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 12, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-21 15:28:53,687 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-21 15:28:53,719 - Total Parameters: 929445
2025-03-21 15:32:47,445 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 12, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-21 15:32:53,622 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-21 15:32:53,651 - Total Parameters: 929445
2025-03-21 15:36:22,011 - {'epoch': 0, 'rec_loss': '8.7924'}
2025-03-21 15:36:44,859 - {'Epoch': 0, 'HR@5': '0.0239', 'NDCG@5': '0.0154', 'HR@10': '0.0361', 'NDCG@10': '0.0194', 'HR@20': '0.0558', 'NDCG@20': '0.0243'}
2025-03-21 15:36:44,865 - Validation score increased.  Saving model ...
2025-03-21 15:37:53,684 - {'epoch': 1, 'rec_loss': '8.2245'}
2025-03-21 15:38:18,468 - {'Epoch': 1, 'HR@5': '0.0433', 'NDCG@5': '0.0293', 'HR@10': '0.0632', 'NDCG@10': '0.0357', 'HR@20': '0.0897', 'NDCG@20': '0.0424'}
2025-03-21 15:38:18,470 - Validation score increased.  Saving model ...
2025-03-21 15:39:27,684 - {'epoch': 2, 'rec_loss': '7.8966'}
2025-03-21 15:39:49,235 - {'Epoch': 2, 'HR@5': '0.0568', 'NDCG@5': '0.0394', 'HR@10': '0.0822', 'NDCG@10': '0.0476', 'HR@20': '0.1144', 'NDCG@20': '0.0557'}
2025-03-21 15:39:49,238 - Validation score increased.  Saving model ...
2025-03-21 15:40:52,005 - {'epoch': 3, 'rec_loss': '7.6702'}
2025-03-21 15:41:14,710 - {'Epoch': 3, 'HR@5': '0.0674', 'NDCG@5': '0.0468', 'HR@10': '0.0949', 'NDCG@10': '0.0556', 'HR@20': '0.1318', 'NDCG@20': '0.0649'}
2025-03-21 15:41:14,711 - Validation score increased.  Saving model ...
2025-03-21 15:42:18,376 - {'epoch': 4, 'rec_loss': '7.4952'}
2025-03-21 15:42:37,413 - {'Epoch': 4, 'HR@5': '0.0746', 'NDCG@5': '0.0524', 'HR@10': '0.1024', 'NDCG@10': '0.0614', 'HR@20': '0.1404', 'NDCG@20': '0.0710'}
2025-03-21 15:42:37,425 - Validation score increased.  Saving model ...
2025-03-21 15:43:45,195 - {'epoch': 5, 'rec_loss': '7.3668'}
2025-03-21 15:44:06,510 - {'Epoch': 5, 'HR@5': '0.0787', 'NDCG@5': '0.0553', 'HR@10': '0.1072', 'NDCG@10': '0.0645', 'HR@20': '0.1470', 'NDCG@20': '0.0745'}
2025-03-21 15:44:06,519 - Validation score increased.  Saving model ...
2025-03-21 15:45:08,370 - {'epoch': 6, 'rec_loss': '7.2640'}
2025-03-21 15:45:30,373 - {'Epoch': 6, 'HR@5': '0.0803', 'NDCG@5': '0.0565', 'HR@10': '0.1101', 'NDCG@10': '0.0661', 'HR@20': '0.1507', 'NDCG@20': '0.0763'}
2025-03-21 15:45:30,378 - Validation score increased.  Saving model ...
2025-03-21 15:46:38,171 - {'epoch': 7, 'rec_loss': '7.1855'}
2025-03-21 15:47:01,871 - {'Epoch': 7, 'HR@5': '0.0821', 'NDCG@5': '0.0583', 'HR@10': '0.1121', 'NDCG@10': '0.0680', 'HR@20': '0.1527', 'NDCG@20': '0.0782'}
2025-03-21 15:47:01,873 - Validation score increased.  Saving model ...
2025-03-21 15:48:07,451 - {'epoch': 8, 'rec_loss': '7.1172'}
2025-03-21 15:48:28,949 - {'Epoch': 8, 'HR@5': '0.0836', 'NDCG@5': '0.0591', 'HR@10': '0.1131', 'NDCG@10': '0.0686', 'HR@20': '0.1529', 'NDCG@20': '0.0786'}
2025-03-21 15:48:28,961 - Validation score increased.  Saving model ...
2025-03-21 15:49:41,119 - {'epoch': 9, 'rec_loss': '7.0656'}
2025-03-21 15:50:03,808 - {'Epoch': 9, 'HR@5': '0.0833', 'NDCG@5': '0.0586', 'HR@10': '0.1147', 'NDCG@10': '0.0688', 'HR@20': '0.1544', 'NDCG@20': '0.0788'}
2025-03-21 15:50:03,813 - Validation score increased.  Saving model ...
2025-03-21 15:51:22,078 - {'epoch': 10, 'rec_loss': '7.0208'}
2025-03-21 15:51:47,132 - {'Epoch': 10, 'HR@5': '0.0838', 'NDCG@5': '0.0593', 'HR@10': '0.1152', 'NDCG@10': '0.0694', 'HR@20': '0.1536', 'NDCG@20': '0.0790'}
2025-03-21 15:51:47,136 - Validation score increased.  Saving model ...
2025-03-21 15:53:06,866 - {'epoch': 11, 'rec_loss': '6.9825'}
2025-03-21 15:53:30,471 - {'Epoch': 11, 'HR@5': '0.0845', 'NDCG@5': '0.0601', 'HR@10': '0.1165', 'NDCG@10': '0.0705', 'HR@20': '0.1566', 'NDCG@20': '0.0806'}
2025-03-21 15:53:30,476 - Validation score increased.  Saving model ...
2025-03-21 15:54:43,767 - {'epoch': 12, 'rec_loss': '6.9507'}
2025-03-21 15:55:07,253 - {'Epoch': 12, 'HR@5': '0.0848', 'NDCG@5': '0.0604', 'HR@10': '0.1175', 'NDCG@10': '0.0709', 'HR@20': '0.1591', 'NDCG@20': '0.0814'}
2025-03-21 15:55:07,272 - Validation score increased.  Saving model ...
2025-03-21 15:56:21,113 - {'epoch': 13, 'rec_loss': '6.9216'}
2025-03-21 15:56:44,854 - {'Epoch': 13, 'HR@5': '0.0859', 'NDCG@5': '0.0607', 'HR@10': '0.1192', 'NDCG@10': '0.0715', 'HR@20': '0.1595', 'NDCG@20': '0.0816'}
2025-03-21 15:56:44,860 - Validation score increased.  Saving model ...
2025-03-21 15:57:57,155 - {'epoch': 14, 'rec_loss': '6.8925'}
2025-03-21 15:58:18,314 - {'Epoch': 14, 'HR@5': '0.0869', 'NDCG@5': '0.0612', 'HR@10': '0.1192', 'NDCG@10': '0.0716', 'HR@20': '0.1592', 'NDCG@20': '0.0816'}
2025-03-21 15:58:18,316 - EarlyStopping counter: 1 out of 10
2025-03-21 15:59:15,917 - {'epoch': 15, 'rec_loss': '6.8750'}
2025-03-21 15:59:38,359 - {'Epoch': 15, 'HR@5': '0.0866', 'NDCG@5': '0.0605', 'HR@10': '0.1190', 'NDCG@10': '0.0709', 'HR@20': '0.1614', 'NDCG@20': '0.0816'}
2025-03-21 15:59:38,371 - EarlyStopping counter: 2 out of 10
2025-03-21 16:00:45,858 - {'epoch': 16, 'rec_loss': '6.8497'}
2025-03-21 16:01:09,379 - {'Epoch': 16, 'HR@5': '0.0856', 'NDCG@5': '0.0602', 'HR@10': '0.1186', 'NDCG@10': '0.0709', 'HR@20': '0.1606', 'NDCG@20': '0.0815'}
2025-03-21 16:01:09,382 - EarlyStopping counter: 3 out of 10
2025-03-21 16:02:22,639 - {'epoch': 17, 'rec_loss': '6.8361'}
2025-03-21 16:02:45,020 - {'Epoch': 17, 'HR@5': '0.0868', 'NDCG@5': '0.0607', 'HR@10': '0.1189', 'NDCG@10': '0.0710', 'HR@20': '0.1604', 'NDCG@20': '0.0815'}
2025-03-21 16:02:45,027 - EarlyStopping counter: 4 out of 10
2025-03-21 16:03:55,533 - {'epoch': 18, 'rec_loss': '6.8088'}
2025-03-21 16:04:17,765 - {'Epoch': 18, 'HR@5': '0.0858', 'NDCG@5': '0.0607', 'HR@10': '0.1203', 'NDCG@10': '0.0718', 'HR@20': '0.1615', 'NDCG@20': '0.0821'}
2025-03-21 16:04:17,772 - Validation score increased.  Saving model ...
2025-03-21 16:05:26,207 - {'epoch': 19, 'rec_loss': '6.7950'}
2025-03-21 16:05:49,544 - {'Epoch': 19, 'HR@5': '0.0861', 'NDCG@5': '0.0607', 'HR@10': '0.1194', 'NDCG@10': '0.0715', 'HR@20': '0.1628', 'NDCG@20': '0.0824'}
2025-03-21 16:05:49,550 - Validation score increased.  Saving model ...
2025-03-21 16:06:55,712 - {'epoch': 20, 'rec_loss': '6.7734'}
2025-03-21 16:07:18,262 - {'Epoch': 20, 'HR@5': '0.0876', 'NDCG@5': '0.0619', 'HR@10': '0.1206', 'NDCG@10': '0.0725', 'HR@20': '0.1631', 'NDCG@20': '0.0832'}
2025-03-21 16:07:18,278 - Validation score increased.  Saving model ...
2025-03-21 16:08:32,107 - {'epoch': 21, 'rec_loss': '6.7640'}
2025-03-21 16:08:53,419 - {'Epoch': 21, 'HR@5': '0.0881', 'NDCG@5': '0.0616', 'HR@10': '0.1217', 'NDCG@10': '0.0725', 'HR@20': '0.1618', 'NDCG@20': '0.0825'}
2025-03-21 16:08:53,425 - EarlyStopping counter: 1 out of 10
2025-03-21 16:10:10,239 - {'epoch': 22, 'rec_loss': '6.7480'}
2025-03-21 16:10:34,216 - {'Epoch': 22, 'HR@5': '0.0875', 'NDCG@5': '0.0621', 'HR@10': '0.1221', 'NDCG@10': '0.0732', 'HR@20': '0.1638', 'NDCG@20': '0.0837'}
2025-03-21 16:10:34,218 - Validation score increased.  Saving model ...
2025-03-21 16:11:48,209 - {'epoch': 23, 'rec_loss': '6.7370'}
2025-03-21 16:12:11,444 - {'Epoch': 23, 'HR@5': '0.0867', 'NDCG@5': '0.0612', 'HR@10': '0.1202', 'NDCG@10': '0.0720', 'HR@20': '0.1619', 'NDCG@20': '0.0825'}
2025-03-21 16:12:11,449 - EarlyStopping counter: 1 out of 10
2025-03-21 16:13:21,609 - {'epoch': 24, 'rec_loss': '6.7239'}
2025-03-21 16:13:46,627 - {'Epoch': 24, 'HR@5': '0.0860', 'NDCG@5': '0.0608', 'HR@10': '0.1201', 'NDCG@10': '0.0718', 'HR@20': '0.1623', 'NDCG@20': '0.0825'}
2025-03-21 16:13:46,629 - EarlyStopping counter: 2 out of 10
2025-03-21 16:14:57,812 - {'epoch': 25, 'rec_loss': '6.7089'}
2025-03-21 16:15:21,245 - {'Epoch': 25, 'HR@5': '0.0871', 'NDCG@5': '0.0614', 'HR@10': '0.1212', 'NDCG@10': '0.0724', 'HR@20': '0.1638', 'NDCG@20': '0.0831'}
2025-03-21 16:15:21,248 - EarlyStopping counter: 3 out of 10
2025-03-21 16:16:33,285 - {'epoch': 26, 'rec_loss': '6.7004'}
2025-03-21 16:16:54,054 - {'Epoch': 26, 'HR@5': '0.0877', 'NDCG@5': '0.0618', 'HR@10': '0.1205', 'NDCG@10': '0.0724', 'HR@20': '0.1653', 'NDCG@20': '0.0836'}
2025-03-21 16:16:54,057 - EarlyStopping counter: 4 out of 10
2025-03-21 16:18:07,830 - {'epoch': 27, 'rec_loss': '6.6855'}
2025-03-21 16:18:29,319 - {'Epoch': 27, 'HR@5': '0.0875', 'NDCG@5': '0.0621', 'HR@10': '0.1210', 'NDCG@10': '0.0728', 'HR@20': '0.1644', 'NDCG@20': '0.0838'}
2025-03-21 16:18:29,320 - Validation score increased.  Saving model ...
2025-03-21 16:19:45,507 - {'epoch': 28, 'rec_loss': '6.6744'}
2025-03-21 16:20:10,871 - {'Epoch': 28, 'HR@5': '0.0863', 'NDCG@5': '0.0608', 'HR@10': '0.1219', 'NDCG@10': '0.0723', 'HR@20': '0.1620', 'NDCG@20': '0.0824'}
2025-03-21 16:20:10,877 - EarlyStopping counter: 1 out of 10
2025-03-21 16:21:21,182 - {'epoch': 29, 'rec_loss': '6.6684'}
2025-03-21 16:21:43,548 - {'Epoch': 29, 'HR@5': '0.0865', 'NDCG@5': '0.0607', 'HR@10': '0.1206', 'NDCG@10': '0.0717', 'HR@20': '0.1632', 'NDCG@20': '0.0825'}
2025-03-21 16:21:43,549 - EarlyStopping counter: 2 out of 10
2025-03-21 16:22:54,902 - {'epoch': 30, 'rec_loss': '6.6582'}
2025-03-21 16:23:17,814 - {'Epoch': 30, 'HR@5': '0.0876', 'NDCG@5': '0.0621', 'HR@10': '0.1205', 'NDCG@10': '0.0728', 'HR@20': '0.1658', 'NDCG@20': '0.0842'}
2025-03-21 16:23:17,821 - Validation score increased.  Saving model ...
2025-03-21 16:24:31,263 - {'epoch': 31, 'rec_loss': '6.6488'}
2025-03-21 16:24:53,743 - {'Epoch': 31, 'HR@5': '0.0886', 'NDCG@5': '0.0626', 'HR@10': '0.1227', 'NDCG@10': '0.0735', 'HR@20': '0.1645', 'NDCG@20': '0.0841'}
2025-03-21 16:24:53,748 - EarlyStopping counter: 1 out of 10
2025-03-21 16:26:08,249 - {'epoch': 32, 'rec_loss': '6.6448'}
2025-03-21 16:26:28,432 - {'Epoch': 32, 'HR@5': '0.0875', 'NDCG@5': '0.0618', 'HR@10': '0.1214', 'NDCG@10': '0.0727', 'HR@20': '0.1647', 'NDCG@20': '0.0836'}
2025-03-21 16:26:28,434 - EarlyStopping counter: 2 out of 10
2025-03-21 16:27:41,649 - {'epoch': 33, 'rec_loss': '6.6341'}
2025-03-21 16:28:02,494 - {'Epoch': 33, 'HR@5': '0.0871', 'NDCG@5': '0.0614', 'HR@10': '0.1208', 'NDCG@10': '0.0722', 'HR@20': '0.1625', 'NDCG@20': '0.0827'}
2025-03-21 16:28:02,495 - EarlyStopping counter: 3 out of 10
2025-03-21 16:29:20,578 - {'epoch': 34, 'rec_loss': '6.6241'}
2025-03-21 16:29:44,894 - {'Epoch': 34, 'HR@5': '0.0890', 'NDCG@5': '0.0626', 'HR@10': '0.1219', 'NDCG@10': '0.0732', 'HR@20': '0.1629', 'NDCG@20': '0.0835'}
2025-03-21 16:29:44,897 - EarlyStopping counter: 4 out of 10
2025-03-21 16:31:02,094 - {'epoch': 35, 'rec_loss': '6.6188'}
2025-03-21 16:31:27,360 - {'Epoch': 35, 'HR@5': '0.0872', 'NDCG@5': '0.0616', 'HR@10': '0.1209', 'NDCG@10': '0.0725', 'HR@20': '0.1644', 'NDCG@20': '0.0834'}
2025-03-21 16:31:27,363 - EarlyStopping counter: 5 out of 10
2025-03-21 16:32:28,808 - {'epoch': 36, 'rec_loss': '6.6037'}
2025-03-21 16:32:53,567 - {'Epoch': 36, 'HR@5': '0.0870', 'NDCG@5': '0.0615', 'HR@10': '0.1213', 'NDCG@10': '0.0725', 'HR@20': '0.1649', 'NDCG@20': '0.0834'}
2025-03-21 16:32:53,569 - EarlyStopping counter: 6 out of 10
2025-03-21 16:34:00,627 - {'epoch': 37, 'rec_loss': '6.5965'}
2025-03-21 16:34:22,410 - {'Epoch': 37, 'HR@5': '0.0881', 'NDCG@5': '0.0615', 'HR@10': '0.1223', 'NDCG@10': '0.0726', 'HR@20': '0.1664', 'NDCG@20': '0.0837'}
2025-03-21 16:34:22,412 - EarlyStopping counter: 7 out of 10
2025-03-21 16:35:33,047 - {'epoch': 38, 'rec_loss': '6.5883'}
2025-03-21 16:35:54,986 - {'Epoch': 38, 'HR@5': '0.0881', 'NDCG@5': '0.0623', 'HR@10': '0.1215', 'NDCG@10': '0.0730', 'HR@20': '0.1646', 'NDCG@20': '0.0838'}
2025-03-21 16:35:54,988 - EarlyStopping counter: 8 out of 10
2025-03-21 16:37:06,827 - {'epoch': 39, 'rec_loss': '6.5902'}
2025-03-21 16:37:28,082 - {'Epoch': 39, 'HR@5': '0.0863', 'NDCG@5': '0.0608', 'HR@10': '0.1195', 'NDCG@10': '0.0715', 'HR@20': '0.1627', 'NDCG@20': '0.0823'}
2025-03-21 16:37:28,085 - EarlyStopping counter: 9 out of 10
2025-03-21 16:38:32,398 - {'epoch': 40, 'rec_loss': '6.5810'}
2025-03-21 16:38:52,756 - {'Epoch': 40, 'HR@5': '0.0864', 'NDCG@5': '0.0612', 'HR@10': '0.1202', 'NDCG@10': '0.0720', 'HR@20': '0.1641', 'NDCG@20': '0.0831'}
2025-03-21 16:38:52,757 - EarlyStopping counter: 10 out of 10
2025-03-21 16:38:52,757 - Early stopping
2025-03-21 16:38:52,758 - ---------------Test Score---------------
2025-03-21 16:39:13,924 - {'Epoch': 0, 'HR@5': '0.0703', 'NDCG@5': '0.0500', 'HR@10': '0.0977', 'NDCG@10': '0.0588', 'HR@20': '0.1355', 'NDCG@20': '0.0683'}
2025-03-21 16:39:13,925 - Scale_Beauty
2025-03-21 16:39:13,925 - {'Epoch': 0, 'HR@5': '0.0703', 'NDCG@5': '0.0500', 'HR@10': '0.0977', 'NDCG@10': '0.0588', 'HR@20': '0.1355', 'NDCG@20': '0.0683'}
2025-03-21 16:42:12,817 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[8, 12, 32], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-03-21 16:42:19,182 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-21 16:42:19,190 - Total Parameters: 929445
2025-03-21 16:43:16,458 - {'epoch': 0, 'rec_loss': '8.9092'}
2025-03-21 16:43:34,146 - {'Epoch': 0, 'HR@5': '0.0173', 'NDCG@5': '0.0107', 'HR@10': '0.0274', 'NDCG@10': '0.0139', 'HR@20': '0.0409', 'NDCG@20': '0.0173'}
2025-03-21 16:43:34,152 - Validation score increased.  Saving model ...
2025-03-21 16:44:36,746 - {'epoch': 1, 'rec_loss': '8.4761'}
2025-03-21 16:44:52,748 - {'Epoch': 1, 'HR@5': '0.0291', 'NDCG@5': '0.0189', 'HR@10': '0.0463', 'NDCG@10': '0.0245', 'HR@20': '0.0691', 'NDCG@20': '0.0302'}
2025-03-21 16:44:52,758 - Validation score increased.  Saving model ...
2025-03-21 16:45:48,811 - {'epoch': 2, 'rec_loss': '8.2375'}
2025-03-21 16:46:07,301 - {'Epoch': 2, 'HR@5': '0.0392', 'NDCG@5': '0.0259', 'HR@10': '0.0583', 'NDCG@10': '0.0321', 'HR@20': '0.0885', 'NDCG@20': '0.0397'}
2025-03-21 16:46:07,318 - Validation score increased.  Saving model ...
2025-03-21 16:47:02,790 - {'epoch': 3, 'rec_loss': '8.0616'}
2025-03-21 16:47:18,975 - {'Epoch': 3, 'HR@5': '0.0470', 'NDCG@5': '0.0308', 'HR@10': '0.0716', 'NDCG@10': '0.0388', 'HR@20': '0.1035', 'NDCG@20': '0.0468'}
2025-03-21 16:47:18,977 - Validation score increased.  Saving model ...
2025-03-21 16:48:11,848 - {'epoch': 4, 'rec_loss': '7.9376'}
2025-03-21 16:48:30,597 - {'Epoch': 4, 'HR@5': '0.0551', 'NDCG@5': '0.0374', 'HR@10': '0.0803', 'NDCG@10': '0.0455', 'HR@20': '0.1141', 'NDCG@20': '0.0541'}
2025-03-21 16:48:30,600 - Validation score increased.  Saving model ...
2025-03-21 16:49:31,332 - {'epoch': 5, 'rec_loss': '7.8443'}
2025-03-21 16:49:47,318 - {'Epoch': 5, 'HR@5': '0.0610', 'NDCG@5': '0.0417', 'HR@10': '0.0890', 'NDCG@10': '0.0507', 'HR@20': '0.1240', 'NDCG@20': '0.0595'}
2025-03-21 16:49:47,323 - Validation score increased.  Saving model ...
2025-03-21 16:50:49,902 - {'epoch': 6, 'rec_loss': '7.7646'}
2025-03-21 16:51:07,162 - {'Epoch': 6, 'HR@5': '0.0653', 'NDCG@5': '0.0447', 'HR@10': '0.0915', 'NDCG@10': '0.0531', 'HR@20': '0.1291', 'NDCG@20': '0.0625'}
2025-03-21 16:51:07,164 - Validation score increased.  Saving model ...
2025-03-21 16:52:07,129 - {'epoch': 7, 'rec_loss': '7.7000'}
2025-03-21 16:52:24,725 - {'Epoch': 7, 'HR@5': '0.0701', 'NDCG@5': '0.0483', 'HR@10': '0.0977', 'NDCG@10': '0.0571', 'HR@20': '0.1363', 'NDCG@20': '0.0668'}
2025-03-21 16:52:24,726 - Validation score increased.  Saving model ...
2025-03-21 16:53:27,795 - {'epoch': 8, 'rec_loss': '7.6447'}
2025-03-21 16:53:44,867 - {'Epoch': 8, 'HR@5': '0.0724', 'NDCG@5': '0.0501', 'HR@10': '0.1018', 'NDCG@10': '0.0596', 'HR@20': '0.1390', 'NDCG@20': '0.0690'}
2025-03-21 16:53:44,875 - Validation score increased.  Saving model ...
2025-03-21 16:54:43,293 - {'epoch': 9, 'rec_loss': '7.5952'}
2025-03-21 16:54:59,132 - {'Epoch': 9, 'HR@5': '0.0740', 'NDCG@5': '0.0506', 'HR@10': '0.1026', 'NDCG@10': '0.0598', 'HR@20': '0.1426', 'NDCG@20': '0.0698'}
2025-03-21 16:54:59,134 - Validation score increased.  Saving model ...
2025-03-21 16:56:00,497 - {'epoch': 10, 'rec_loss': '7.5480'}
2025-03-21 16:56:17,445 - {'Epoch': 10, 'HR@5': '0.0774', 'NDCG@5': '0.0531', 'HR@10': '0.1064', 'NDCG@10': '0.0625', 'HR@20': '0.1453', 'NDCG@20': '0.0722'}
2025-03-21 16:56:17,454 - Validation score increased.  Saving model ...
2025-03-21 16:57:03,428 - {'epoch': 11, 'rec_loss': '7.5054'}
2025-03-21 16:57:20,006 - {'Epoch': 11, 'HR@5': '0.0774', 'NDCG@5': '0.0542', 'HR@10': '0.1083', 'NDCG@10': '0.0641', 'HR@20': '0.1484', 'NDCG@20': '0.0742'}
2025-03-21 16:57:20,018 - Validation score increased.  Saving model ...
2025-03-21 16:58:30,040 - {'epoch': 12, 'rec_loss': '7.4814'}
2025-03-21 16:58:47,325 - {'Epoch': 12, 'HR@5': '0.0785', 'NDCG@5': '0.0544', 'HR@10': '0.1085', 'NDCG@10': '0.0641', 'HR@20': '0.1507', 'NDCG@20': '0.0748'}
2025-03-21 16:58:47,329 - Validation score increased.  Saving model ...
2025-03-21 17:00:08,390 - {'epoch': 13, 'rec_loss': '7.4473'}
2025-03-21 17:00:27,735 - {'Epoch': 13, 'HR@5': '0.0797', 'NDCG@5': '0.0553', 'HR@10': '0.1108', 'NDCG@10': '0.0653', 'HR@20': '0.1512', 'NDCG@20': '0.0755'}
2025-03-21 17:00:27,737 - Validation score increased.  Saving model ...
2025-03-21 17:01:45,900 - {'epoch': 14, 'rec_loss': '7.4211'}
2025-03-21 17:02:05,275 - {'Epoch': 14, 'HR@5': '0.0812', 'NDCG@5': '0.0566', 'HR@10': '0.1125', 'NDCG@10': '0.0667', 'HR@20': '0.1523', 'NDCG@20': '0.0767'}
2025-03-21 17:02:05,277 - Validation score increased.  Saving model ...
2025-03-21 17:03:30,834 - {'epoch': 15, 'rec_loss': '7.4002'}
2025-03-21 17:03:50,596 - {'Epoch': 15, 'HR@5': '0.0812', 'NDCG@5': '0.0566', 'HR@10': '0.1138', 'NDCG@10': '0.0671', 'HR@20': '0.1535', 'NDCG@20': '0.0770'}
2025-03-21 17:03:50,601 - Validation score increased.  Saving model ...
2025-03-21 17:04:50,572 - {'epoch': 16, 'rec_loss': '7.3745'}
2025-03-21 17:05:09,976 - {'Epoch': 16, 'HR@5': '0.0819', 'NDCG@5': '0.0571', 'HR@10': '0.1144', 'NDCG@10': '0.0675', 'HR@20': '0.1549', 'NDCG@20': '0.0777'}
2025-03-21 17:05:09,980 - Validation score increased.  Saving model ...
2025-03-21 17:06:19,730 - {'epoch': 17, 'rec_loss': '7.3578'}
2025-03-21 17:06:37,954 - {'Epoch': 17, 'HR@5': '0.0818', 'NDCG@5': '0.0568', 'HR@10': '0.1126', 'NDCG@10': '0.0668', 'HR@20': '0.1553', 'NDCG@20': '0.0775'}
2025-03-21 17:06:37,963 - EarlyStopping counter: 1 out of 10
2025-03-21 17:07:45,078 - {'epoch': 18, 'rec_loss': '7.3354'}
2025-03-21 17:08:03,938 - {'Epoch': 18, 'HR@5': '0.0832', 'NDCG@5': '0.0581', 'HR@10': '0.1161', 'NDCG@10': '0.0687', 'HR@20': '0.1574', 'NDCG@20': '0.0791'}
2025-03-21 17:08:03,941 - Validation score increased.  Saving model ...
2025-03-21 17:09:07,075 - {'epoch': 19, 'rec_loss': '7.3167'}
2025-03-21 17:09:25,847 - {'Epoch': 19, 'HR@5': '0.0825', 'NDCG@5': '0.0586', 'HR@10': '0.1149', 'NDCG@10': '0.0690', 'HR@20': '0.1570', 'NDCG@20': '0.0796'}
2025-03-21 17:09:25,853 - Validation score increased.  Saving model ...
2025-03-21 17:10:32,694 - {'epoch': 20, 'rec_loss': '7.3026'}
2025-03-21 17:10:52,291 - {'Epoch': 20, 'HR@5': '0.0833', 'NDCG@5': '0.0585', 'HR@10': '0.1153', 'NDCG@10': '0.0688', 'HR@20': '0.1567', 'NDCG@20': '0.0792'}
2025-03-21 17:10:52,293 - EarlyStopping counter: 1 out of 10
2025-03-21 17:11:48,541 - {'epoch': 21, 'rec_loss': '7.2977'}
2025-03-21 17:12:05,866 - {'Epoch': 21, 'HR@5': '0.0829', 'NDCG@5': '0.0584', 'HR@10': '0.1160', 'NDCG@10': '0.0690', 'HR@20': '0.1591', 'NDCG@20': '0.0799'}
2025-03-21 17:12:05,868 - Validation score increased.  Saving model ...
2025-03-21 17:13:03,566 - {'epoch': 22, 'rec_loss': '7.2796'}
2025-03-21 17:13:21,983 - {'Epoch': 22, 'HR@5': '0.0834', 'NDCG@5': '0.0590', 'HR@10': '0.1165', 'NDCG@10': '0.0696', 'HR@20': '0.1602', 'NDCG@20': '0.0807'}
2025-03-21 17:13:21,999 - Validation score increased.  Saving model ...
2025-03-21 17:14:19,966 - {'epoch': 23, 'rec_loss': '7.2634'}
2025-03-21 17:14:35,079 - {'Epoch': 23, 'HR@5': '0.0841', 'NDCG@5': '0.0590', 'HR@10': '0.1170', 'NDCG@10': '0.0696', 'HR@20': '0.1583', 'NDCG@20': '0.0800'}
2025-03-21 17:14:35,093 - EarlyStopping counter: 1 out of 10
2025-03-21 17:15:34,121 - {'epoch': 24, 'rec_loss': '7.2530'}
2025-03-21 17:15:51,602 - {'Epoch': 24, 'HR@5': '0.0848', 'NDCG@5': '0.0598', 'HR@10': '0.1172', 'NDCG@10': '0.0703', 'HR@20': '0.1591', 'NDCG@20': '0.0808'}
2025-03-21 17:15:51,610 - Validation score increased.  Saving model ...
2025-03-21 17:16:53,873 - {'epoch': 25, 'rec_loss': '7.2456'}
2025-03-21 17:17:10,481 - {'Epoch': 25, 'HR@5': '0.0828', 'NDCG@5': '0.0583', 'HR@10': '0.1165', 'NDCG@10': '0.0692', 'HR@20': '0.1593', 'NDCG@20': '0.0800'}
2025-03-21 17:17:10,482 - EarlyStopping counter: 1 out of 10
2025-03-21 17:18:16,039 - {'epoch': 26, 'rec_loss': '7.2335'}
2025-03-21 17:18:34,126 - {'Epoch': 26, 'HR@5': '0.0847', 'NDCG@5': '0.0592', 'HR@10': '0.1177', 'NDCG@10': '0.0699', 'HR@20': '0.1616', 'NDCG@20': '0.0809'}
2025-03-21 17:18:34,128 - Validation score increased.  Saving model ...
2025-03-21 17:19:34,294 - {'epoch': 27, 'rec_loss': '7.2281'}
2025-03-21 17:19:52,834 - {'Epoch': 27, 'HR@5': '0.0852', 'NDCG@5': '0.0603', 'HR@10': '0.1180', 'NDCG@10': '0.0708', 'HR@20': '0.1623', 'NDCG@20': '0.0820'}
2025-03-21 17:19:52,835 - Validation score increased.  Saving model ...
2025-03-21 17:20:54,412 - {'epoch': 28, 'rec_loss': '7.2146'}
2025-03-21 17:21:12,375 - {'Epoch': 28, 'HR@5': '0.0833', 'NDCG@5': '0.0587', 'HR@10': '0.1195', 'NDCG@10': '0.0703', 'HR@20': '0.1623', 'NDCG@20': '0.0811'}
2025-03-21 17:21:12,385 - EarlyStopping counter: 1 out of 10
2025-03-21 17:22:12,350 - {'epoch': 29, 'rec_loss': '7.2146'}
2025-03-21 17:22:30,072 - {'Epoch': 29, 'HR@5': '0.0848', 'NDCG@5': '0.0593', 'HR@10': '0.1174', 'NDCG@10': '0.0698', 'HR@20': '0.1614', 'NDCG@20': '0.0808'}
2025-03-21 17:22:30,074 - EarlyStopping counter: 2 out of 10
2025-03-21 17:23:26,025 - {'epoch': 30, 'rec_loss': '7.1984'}
2025-03-21 17:23:43,572 - {'Epoch': 30, 'HR@5': '0.0872', 'NDCG@5': '0.0615', 'HR@10': '0.1192', 'NDCG@10': '0.0718', 'HR@20': '0.1627', 'NDCG@20': '0.0827'}
2025-03-21 17:23:43,574 - Validation score increased.  Saving model ...
2025-03-21 17:24:42,963 - {'epoch': 31, 'rec_loss': '7.1922'}
2025-03-21 17:25:00,439 - {'Epoch': 31, 'HR@5': '0.0867', 'NDCG@5': '0.0610', 'HR@10': '0.1206', 'NDCG@10': '0.0720', 'HR@20': '0.1621', 'NDCG@20': '0.0824'}
2025-03-21 17:25:00,441 - EarlyStopping counter: 1 out of 10
2025-03-21 17:25:57,514 - {'epoch': 32, 'rec_loss': '7.1857'}
2025-03-21 17:26:07,841 - {'Epoch': 32, 'HR@5': '0.0871', 'NDCG@5': '0.0615', 'HR@10': '0.1201', 'NDCG@10': '0.0721', 'HR@20': '0.1634', 'NDCG@20': '0.0830'}
2025-03-21 17:26:07,843 - Validation score increased.  Saving model ...
2025-03-21 17:26:36,242 - {'epoch': 33, 'rec_loss': '7.1768'}
2025-03-21 17:26:45,774 - {'Epoch': 33, 'HR@5': '0.0869', 'NDCG@5': '0.0612', 'HR@10': '0.1203', 'NDCG@10': '0.0719', 'HR@20': '0.1627', 'NDCG@20': '0.0826'}
2025-03-21 17:26:45,776 - EarlyStopping counter: 1 out of 10
2025-03-21 17:27:17,224 - {'epoch': 34, 'rec_loss': '7.1724'}
2025-03-21 17:27:26,763 - {'Epoch': 34, 'HR@5': '0.0867', 'NDCG@5': '0.0614', 'HR@10': '0.1198', 'NDCG@10': '0.0721', 'HR@20': '0.1634', 'NDCG@20': '0.0830'}
2025-03-21 17:27:26,765 - Validation score increased.  Saving model ...
2025-03-21 17:28:01,267 - {'epoch': 35, 'rec_loss': '7.1659'}
2025-03-21 17:28:11,041 - {'Epoch': 35, 'HR@5': '0.0865', 'NDCG@5': '0.0613', 'HR@10': '0.1199', 'NDCG@10': '0.0721', 'HR@20': '0.1617', 'NDCG@20': '0.0826'}
2025-03-21 17:28:11,043 - EarlyStopping counter: 1 out of 10
2025-03-21 17:28:44,513 - {'epoch': 36, 'rec_loss': '7.1533'}
2025-03-21 17:28:53,964 - {'Epoch': 36, 'HR@5': '0.0861', 'NDCG@5': '0.0608', 'HR@10': '0.1206', 'NDCG@10': '0.0720', 'HR@20': '0.1617', 'NDCG@20': '0.0823'}
2025-03-21 17:28:53,965 - EarlyStopping counter: 2 out of 10
2025-03-21 17:29:24,403 - {'epoch': 37, 'rec_loss': '7.1528'}
2025-03-21 17:29:33,691 - {'Epoch': 37, 'HR@5': '0.0861', 'NDCG@5': '0.0606', 'HR@10': '0.1220', 'NDCG@10': '0.0722', 'HR@20': '0.1636', 'NDCG@20': '0.0826'}
2025-03-21 17:29:33,692 - EarlyStopping counter: 3 out of 10
2025-03-21 17:30:10,847 - {'epoch': 38, 'rec_loss': '7.1491'}
2025-03-21 17:30:27,808 - {'Epoch': 38, 'HR@5': '0.0867', 'NDCG@5': '0.0612', 'HR@10': '0.1214', 'NDCG@10': '0.0724', 'HR@20': '0.1650', 'NDCG@20': '0.0834'}
2025-03-21 17:30:27,816 - Validation score increased.  Saving model ...
2025-03-21 17:31:22,350 - {'epoch': 39, 'rec_loss': '7.1424'}
2025-03-21 17:31:38,325 - {'Epoch': 39, 'HR@5': '0.0851', 'NDCG@5': '0.0604', 'HR@10': '0.1197', 'NDCG@10': '0.0716', 'HR@20': '0.1633', 'NDCG@20': '0.0826'}
2025-03-21 17:31:38,327 - EarlyStopping counter: 1 out of 10
2025-03-21 17:32:15,962 - {'epoch': 40, 'rec_loss': '7.1325'}
2025-03-21 17:32:25,266 - {'Epoch': 40, 'HR@5': '0.0846', 'NDCG@5': '0.0607', 'HR@10': '0.1197', 'NDCG@10': '0.0720', 'HR@20': '0.1641', 'NDCG@20': '0.0832'}
2025-03-21 17:32:25,268 - EarlyStopping counter: 2 out of 10
2025-03-21 17:32:55,157 - {'epoch': 41, 'rec_loss': '7.1282'}
2025-03-21 17:33:04,101 - {'Epoch': 41, 'HR@5': '0.0865', 'NDCG@5': '0.0615', 'HR@10': '0.1204', 'NDCG@10': '0.0723', 'HR@20': '0.1639', 'NDCG@20': '0.0833'}
2025-03-21 17:33:04,108 - EarlyStopping counter: 3 out of 10
2025-03-21 17:33:33,972 - {'epoch': 42, 'rec_loss': '7.1207'}
2025-03-21 17:33:42,812 - {'Epoch': 42, 'HR@5': '0.0870', 'NDCG@5': '0.0613', 'HR@10': '0.1203', 'NDCG@10': '0.0720', 'HR@20': '0.1646', 'NDCG@20': '0.0832'}
2025-03-21 17:33:42,819 - EarlyStopping counter: 4 out of 10
2025-03-21 17:34:12,836 - {'epoch': 43, 'rec_loss': '7.1178'}
2025-03-21 17:34:21,890 - {'Epoch': 43, 'HR@5': '0.0879', 'NDCG@5': '0.0616', 'HR@10': '0.1211', 'NDCG@10': '0.0723', 'HR@20': '0.1648', 'NDCG@20': '0.0832'}
2025-03-21 17:34:21,892 - EarlyStopping counter: 5 out of 10
2025-03-21 17:34:50,540 - {'epoch': 44, 'rec_loss': '7.1060'}
2025-03-21 17:34:59,337 - {'Epoch': 44, 'HR@5': '0.0857', 'NDCG@5': '0.0606', 'HR@10': '0.1185', 'NDCG@10': '0.0712', 'HR@20': '0.1637', 'NDCG@20': '0.0825'}
2025-03-21 17:34:59,339 - EarlyStopping counter: 6 out of 10
2025-03-21 17:35:27,398 - {'epoch': 45, 'rec_loss': '7.1036'}
2025-03-21 17:35:36,380 - {'Epoch': 45, 'HR@5': '0.0863', 'NDCG@5': '0.0611', 'HR@10': '0.1212', 'NDCG@10': '0.0724', 'HR@20': '0.1642', 'NDCG@20': '0.0832'}
2025-03-21 17:35:36,387 - EarlyStopping counter: 7 out of 10
2025-03-21 17:36:04,686 - {'epoch': 46, 'rec_loss': '7.1008'}
2025-03-21 17:36:13,626 - {'Epoch': 46, 'HR@5': '0.0867', 'NDCG@5': '0.0614', 'HR@10': '0.1211', 'NDCG@10': '0.0725', 'HR@20': '0.1644', 'NDCG@20': '0.0834'}
2025-03-21 17:36:13,627 - Validation score increased.  Saving model ...
2025-03-21 17:36:42,993 - {'epoch': 47, 'rec_loss': '7.0976'}
2025-03-21 17:36:52,177 - {'Epoch': 47, 'HR@5': '0.0875', 'NDCG@5': '0.0617', 'HR@10': '0.1215', 'NDCG@10': '0.0725', 'HR@20': '0.1648', 'NDCG@20': '0.0834'}
2025-03-21 17:36:52,179 - Validation score increased.  Saving model ...
2025-03-21 17:37:22,347 - {'epoch': 48, 'rec_loss': '7.0915'}
2025-03-21 17:37:31,419 - {'Epoch': 48, 'HR@5': '0.0879', 'NDCG@5': '0.0622', 'HR@10': '0.1216', 'NDCG@10': '0.0730', 'HR@20': '0.1651', 'NDCG@20': '0.0839'}
2025-03-21 17:37:31,420 - Validation score increased.  Saving model ...
2025-03-21 17:38:00,625 - {'epoch': 49, 'rec_loss': '7.0848'}
2025-03-21 17:38:09,625 - {'Epoch': 49, 'HR@5': '0.0872', 'NDCG@5': '0.0617', 'HR@10': '0.1210', 'NDCG@10': '0.0726', 'HR@20': '0.1655', 'NDCG@20': '0.0838'}
2025-03-21 17:38:09,633 - EarlyStopping counter: 1 out of 10
2025-03-21 17:38:37,830 - {'epoch': 50, 'rec_loss': '7.0818'}
2025-03-21 17:38:46,499 - {'Epoch': 50, 'HR@5': '0.0875', 'NDCG@5': '0.0616', 'HR@10': '0.1206', 'NDCG@10': '0.0722', 'HR@20': '0.1648', 'NDCG@20': '0.0834'}
2025-03-21 17:38:46,501 - EarlyStopping counter: 2 out of 10
2025-03-21 17:39:13,668 - {'epoch': 51, 'rec_loss': '7.0772'}
2025-03-21 17:39:21,982 - {'Epoch': 51, 'HR@5': '0.0868', 'NDCG@5': '0.0612', 'HR@10': '0.1215', 'NDCG@10': '0.0724', 'HR@20': '0.1646', 'NDCG@20': '0.0832'}
2025-03-21 17:39:21,983 - EarlyStopping counter: 3 out of 10
2025-03-21 17:39:49,840 - {'epoch': 52, 'rec_loss': '7.0751'}
2025-03-21 17:39:59,095 - {'Epoch': 52, 'HR@5': '0.0872', 'NDCG@5': '0.0615', 'HR@10': '0.1210', 'NDCG@10': '0.0724', 'HR@20': '0.1648', 'NDCG@20': '0.0834'}
2025-03-21 17:39:59,096 - EarlyStopping counter: 4 out of 10
2025-03-21 17:40:28,110 - {'epoch': 53, 'rec_loss': '7.0682'}
2025-03-21 17:40:36,623 - {'Epoch': 53, 'HR@5': '0.0872', 'NDCG@5': '0.0615', 'HR@10': '0.1207', 'NDCG@10': '0.0724', 'HR@20': '0.1648', 'NDCG@20': '0.0835'}
2025-03-21 17:40:36,624 - EarlyStopping counter: 5 out of 10
2025-03-21 17:41:05,258 - {'epoch': 54, 'rec_loss': '7.0717'}
2025-03-21 17:41:14,492 - {'Epoch': 54, 'HR@5': '0.0880', 'NDCG@5': '0.0620', 'HR@10': '0.1208', 'NDCG@10': '0.0726', 'HR@20': '0.1649', 'NDCG@20': '0.0837'}
2025-03-21 17:41:14,494 - EarlyStopping counter: 6 out of 10
2025-03-21 17:41:42,225 - {'epoch': 55, 'rec_loss': '7.0650'}
2025-03-21 17:41:52,005 - {'Epoch': 55, 'HR@5': '0.0863', 'NDCG@5': '0.0615', 'HR@10': '0.1219', 'NDCG@10': '0.0730', 'HR@20': '0.1663', 'NDCG@20': '0.0841'}
2025-03-21 17:41:52,007 - Validation score increased.  Saving model ...
2025-03-21 17:42:21,739 - {'epoch': 56, 'rec_loss': '7.0630'}
2025-03-21 17:42:31,082 - {'Epoch': 56, 'HR@5': '0.0875', 'NDCG@5': '0.0615', 'HR@10': '0.1211', 'NDCG@10': '0.0723', 'HR@20': '0.1649', 'NDCG@20': '0.0833'}
2025-03-21 17:42:31,083 - EarlyStopping counter: 1 out of 10
2025-03-21 17:43:00,503 - {'epoch': 57, 'rec_loss': '7.0575'}
2025-03-21 17:43:10,153 - {'Epoch': 57, 'HR@5': '0.0859', 'NDCG@5': '0.0612', 'HR@10': '0.1214', 'NDCG@10': '0.0727', 'HR@20': '0.1648', 'NDCG@20': '0.0836'}
2025-03-21 17:43:10,154 - EarlyStopping counter: 2 out of 10
2025-03-21 17:43:37,709 - {'epoch': 58, 'rec_loss': '7.0527'}
2025-03-21 17:43:46,851 - {'Epoch': 58, 'HR@5': '0.0869', 'NDCG@5': '0.0611', 'HR@10': '0.1224', 'NDCG@10': '0.0726', 'HR@20': '0.1658', 'NDCG@20': '0.0835'}
2025-03-21 17:43:46,860 - EarlyStopping counter: 3 out of 10
2025-03-21 17:44:16,391 - {'epoch': 59, 'rec_loss': '7.0474'}
2025-03-21 17:44:25,505 - {'Epoch': 59, 'HR@5': '0.0877', 'NDCG@5': '0.0620', 'HR@10': '0.1216', 'NDCG@10': '0.0729', 'HR@20': '0.1658', 'NDCG@20': '0.0841'}
2025-03-21 17:44:25,507 - EarlyStopping counter: 4 out of 10
2025-03-21 17:44:54,077 - {'epoch': 60, 'rec_loss': '7.0495'}
2025-03-21 17:45:03,047 - {'Epoch': 60, 'HR@5': '0.0875', 'NDCG@5': '0.0614', 'HR@10': '0.1215', 'NDCG@10': '0.0723', 'HR@20': '0.1672', 'NDCG@20': '0.0838'}
2025-03-21 17:45:03,048 - EarlyStopping counter: 5 out of 10
2025-03-21 17:45:32,231 - {'epoch': 61, 'rec_loss': '7.0472'}
2025-03-21 17:45:40,952 - {'Epoch': 61, 'HR@5': '0.0873', 'NDCG@5': '0.0623', 'HR@10': '0.1219', 'NDCG@10': '0.0735', 'HR@20': '0.1665', 'NDCG@20': '0.0847'}
2025-03-21 17:45:40,953 - Validation score increased.  Saving model ...
2025-03-21 17:46:09,796 - {'epoch': 62, 'rec_loss': '7.0449'}
2025-03-21 17:46:18,927 - {'Epoch': 62, 'HR@5': '0.0885', 'NDCG@5': '0.0628', 'HR@10': '0.1224', 'NDCG@10': '0.0737', 'HR@20': '0.1676', 'NDCG@20': '0.0851'}
2025-03-21 17:46:18,928 - Validation score increased.  Saving model ...
2025-03-21 17:46:47,606 - {'epoch': 63, 'rec_loss': '7.0386'}
2025-03-21 17:46:56,697 - {'Epoch': 63, 'HR@5': '0.0884', 'NDCG@5': '0.0623', 'HR@10': '0.1227', 'NDCG@10': '0.0733', 'HR@20': '0.1677', 'NDCG@20': '0.0847'}
2025-03-21 17:46:56,699 - EarlyStopping counter: 1 out of 10
2025-03-21 17:47:26,822 - {'epoch': 64, 'rec_loss': '7.0313'}
2025-03-21 17:47:36,187 - {'Epoch': 64, 'HR@5': '0.0888', 'NDCG@5': '0.0621', 'HR@10': '0.1231', 'NDCG@10': '0.0731', 'HR@20': '0.1657', 'NDCG@20': '0.0838'}
2025-03-21 17:47:36,194 - EarlyStopping counter: 2 out of 10
2025-03-21 17:48:05,738 - {'epoch': 65, 'rec_loss': '7.0317'}
2025-03-21 17:48:14,570 - {'Epoch': 65, 'HR@5': '0.0886', 'NDCG@5': '0.0622', 'HR@10': '0.1217', 'NDCG@10': '0.0728', 'HR@20': '0.1673', 'NDCG@20': '0.0843'}
2025-03-21 17:48:14,572 - EarlyStopping counter: 3 out of 10
2025-03-21 17:48:44,365 - {'epoch': 66, 'rec_loss': '7.0279'}
2025-03-21 17:48:53,440 - {'Epoch': 66, 'HR@5': '0.0879', 'NDCG@5': '0.0619', 'HR@10': '0.1227', 'NDCG@10': '0.0731', 'HR@20': '0.1669', 'NDCG@20': '0.0843'}
2025-03-21 17:48:53,441 - EarlyStopping counter: 4 out of 10
2025-03-21 17:49:22,411 - {'epoch': 67, 'rec_loss': '7.0283'}
2025-03-21 17:49:32,064 - {'Epoch': 67, 'HR@5': '0.0884', 'NDCG@5': '0.0615', 'HR@10': '0.1224', 'NDCG@10': '0.0724', 'HR@20': '0.1667', 'NDCG@20': '0.0836'}
2025-03-21 17:49:32,065 - EarlyStopping counter: 5 out of 10
2025-03-21 17:50:01,647 - {'epoch': 68, 'rec_loss': '7.0245'}
2025-03-21 17:50:10,470 - {'Epoch': 68, 'HR@5': '0.0896', 'NDCG@5': '0.0634', 'HR@10': '0.1226', 'NDCG@10': '0.0741', 'HR@20': '0.1669', 'NDCG@20': '0.0853'}
2025-03-21 17:50:10,472 - Validation score increased.  Saving model ...
2025-03-21 17:50:40,855 - {'epoch': 69, 'rec_loss': '7.0178'}
2025-03-21 17:50:50,600 - {'Epoch': 69, 'HR@5': '0.0888', 'NDCG@5': '0.0627', 'HR@10': '0.1234', 'NDCG@10': '0.0738', 'HR@20': '0.1652', 'NDCG@20': '0.0844'}
2025-03-21 17:50:50,602 - EarlyStopping counter: 1 out of 10
2025-03-21 17:51:21,786 - {'epoch': 70, 'rec_loss': '7.0206'}
2025-03-21 17:51:31,154 - {'Epoch': 70, 'HR@5': '0.0884', 'NDCG@5': '0.0628', 'HR@10': '0.1233', 'NDCG@10': '0.0740', 'HR@20': '0.1669', 'NDCG@20': '0.0850'}
2025-03-21 17:51:31,161 - EarlyStopping counter: 2 out of 10
2025-03-21 17:52:01,197 - {'epoch': 71, 'rec_loss': '7.0120'}
2025-03-21 17:52:10,296 - {'Epoch': 71, 'HR@5': '0.0893', 'NDCG@5': '0.0625', 'HR@10': '0.1228', 'NDCG@10': '0.0732', 'HR@20': '0.1660', 'NDCG@20': '0.0841'}
2025-03-21 17:52:10,302 - EarlyStopping counter: 3 out of 10
2025-03-21 17:52:41,118 - {'epoch': 72, 'rec_loss': '7.0106'}
2025-03-21 17:52:50,524 - {'Epoch': 72, 'HR@5': '0.0895', 'NDCG@5': '0.0633', 'HR@10': '0.1229', 'NDCG@10': '0.0740', 'HR@20': '0.1680', 'NDCG@20': '0.0854'}
2025-03-21 17:52:50,525 - Validation score increased.  Saving model ...
2025-03-21 17:53:20,463 - {'epoch': 73, 'rec_loss': '7.0063'}
2025-03-21 17:53:29,813 - {'Epoch': 73, 'HR@5': '0.0875', 'NDCG@5': '0.0621', 'HR@10': '0.1231', 'NDCG@10': '0.0736', 'HR@20': '0.1674', 'NDCG@20': '0.0847'}
2025-03-21 17:53:29,815 - EarlyStopping counter: 1 out of 10
2025-03-21 17:53:59,342 - {'epoch': 74, 'rec_loss': '7.0128'}
2025-03-21 17:54:08,338 - {'Epoch': 74, 'HR@5': '0.0882', 'NDCG@5': '0.0624', 'HR@10': '0.1230', 'NDCG@10': '0.0736', 'HR@20': '0.1670', 'NDCG@20': '0.0846'}
2025-03-21 17:54:08,339 - EarlyStopping counter: 2 out of 10
2025-03-21 17:54:37,284 - {'epoch': 75, 'rec_loss': '7.0036'}
2025-03-21 17:54:46,810 - {'Epoch': 75, 'HR@5': '0.0881', 'NDCG@5': '0.0623', 'HR@10': '0.1232', 'NDCG@10': '0.0735', 'HR@20': '0.1668', 'NDCG@20': '0.0845'}
2025-03-21 17:54:46,812 - EarlyStopping counter: 3 out of 10
2025-03-21 17:55:15,771 - {'epoch': 76, 'rec_loss': '6.9987'}
2025-03-21 17:55:25,276 - {'Epoch': 76, 'HR@5': '0.0887', 'NDCG@5': '0.0622', 'HR@10': '0.1233', 'NDCG@10': '0.0733', 'HR@20': '0.1665', 'NDCG@20': '0.0842'}
2025-03-21 17:55:25,277 - EarlyStopping counter: 4 out of 10
2025-03-21 17:55:55,200 - {'epoch': 77, 'rec_loss': '6.9988'}
2025-03-21 17:56:04,694 - {'Epoch': 77, 'HR@5': '0.0879', 'NDCG@5': '0.0617', 'HR@10': '0.1223', 'NDCG@10': '0.0728', 'HR@20': '0.1681', 'NDCG@20': '0.0843'}
2025-03-21 17:56:04,695 - EarlyStopping counter: 5 out of 10
2025-03-21 17:56:34,972 - {'epoch': 78, 'rec_loss': '6.9970'}
2025-03-21 17:56:44,879 - {'Epoch': 78, 'HR@5': '0.0882', 'NDCG@5': '0.0623', 'HR@10': '0.1224', 'NDCG@10': '0.0733', 'HR@20': '0.1680', 'NDCG@20': '0.0848'}
2025-03-21 17:56:44,882 - EarlyStopping counter: 6 out of 10
2025-03-21 17:57:15,789 - {'epoch': 79, 'rec_loss': '6.9866'}
2025-03-21 17:57:25,256 - {'Epoch': 79, 'HR@5': '0.0898', 'NDCG@5': '0.0628', 'HR@10': '0.1233', 'NDCG@10': '0.0736', 'HR@20': '0.1668', 'NDCG@20': '0.0846'}
2025-03-21 17:57:25,257 - EarlyStopping counter: 7 out of 10
2025-03-21 17:57:54,195 - {'epoch': 80, 'rec_loss': '6.9938'}
2025-03-21 17:58:03,303 - {'Epoch': 80, 'HR@5': '0.0887', 'NDCG@5': '0.0626', 'HR@10': '0.1214', 'NDCG@10': '0.0732', 'HR@20': '0.1651', 'NDCG@20': '0.0842'}
2025-03-21 17:58:03,305 - EarlyStopping counter: 8 out of 10
2025-03-21 17:58:33,035 - {'epoch': 81, 'rec_loss': '6.9944'}
2025-03-21 17:58:42,196 - {'Epoch': 81, 'HR@5': '0.0896', 'NDCG@5': '0.0633', 'HR@10': '0.1220', 'NDCG@10': '0.0737', 'HR@20': '0.1687', 'NDCG@20': '0.0854'}
2025-03-21 17:58:42,198 - Validation score increased.  Saving model ...
2025-03-21 17:59:13,427 - {'epoch': 82, 'rec_loss': '6.9913'}
2025-03-21 17:59:22,638 - {'Epoch': 82, 'HR@5': '0.0884', 'NDCG@5': '0.0618', 'HR@10': '0.1226', 'NDCG@10': '0.0727', 'HR@20': '0.1656', 'NDCG@20': '0.0836'}
2025-03-21 17:59:22,639 - EarlyStopping counter: 1 out of 10
2025-03-21 17:59:52,506 - {'epoch': 83, 'rec_loss': '6.9881'}
2025-03-21 18:00:01,084 - {'Epoch': 83, 'HR@5': '0.0896', 'NDCG@5': '0.0631', 'HR@10': '0.1221', 'NDCG@10': '0.0735', 'HR@20': '0.1679', 'NDCG@20': '0.0851'}
2025-03-21 18:00:01,086 - EarlyStopping counter: 2 out of 10
2025-03-21 18:00:28,546 - {'epoch': 84, 'rec_loss': '6.9928'}
2025-03-21 18:00:37,945 - {'Epoch': 84, 'HR@5': '0.0890', 'NDCG@5': '0.0634', 'HR@10': '0.1237', 'NDCG@10': '0.0746', 'HR@20': '0.1689', 'NDCG@20': '0.0860'}
2025-03-21 18:00:37,951 - Validation score increased.  Saving model ...
2025-03-21 18:01:08,406 - {'epoch': 85, 'rec_loss': '6.9840'}
2025-03-21 18:01:17,897 - {'Epoch': 85, 'HR@5': '0.0886', 'NDCG@5': '0.0624', 'HR@10': '0.1231', 'NDCG@10': '0.0735', 'HR@20': '0.1662', 'NDCG@20': '0.0844'}
2025-03-21 18:01:17,903 - EarlyStopping counter: 1 out of 10
2025-03-21 18:01:49,175 - {'epoch': 86, 'rec_loss': '6.9812'}
2025-03-21 18:01:58,523 - {'Epoch': 86, 'HR@5': '0.0897', 'NDCG@5': '0.0631', 'HR@10': '0.1221', 'NDCG@10': '0.0735', 'HR@20': '0.1671', 'NDCG@20': '0.0849'}
2025-03-21 18:01:58,525 - EarlyStopping counter: 2 out of 10
2025-03-21 18:02:28,793 - {'epoch': 87, 'rec_loss': '6.9795'}
2025-03-21 18:02:37,865 - {'Epoch': 87, 'HR@5': '0.0889', 'NDCG@5': '0.0632', 'HR@10': '0.1212', 'NDCG@10': '0.0735', 'HR@20': '0.1679', 'NDCG@20': '0.0853'}
2025-03-21 18:02:37,867 - EarlyStopping counter: 3 out of 10
2025-03-21 18:03:07,739 - {'epoch': 88, 'rec_loss': '6.9762'}
2025-03-21 18:03:17,367 - {'Epoch': 88, 'HR@5': '0.0887', 'NDCG@5': '0.0628', 'HR@10': '0.1231', 'NDCG@10': '0.0738', 'HR@20': '0.1676', 'NDCG@20': '0.0851'}
2025-03-21 18:03:17,369 - EarlyStopping counter: 4 out of 10
2025-03-21 18:03:47,952 - {'epoch': 89, 'rec_loss': '6.9765'}
2025-03-21 18:03:57,164 - {'Epoch': 89, 'HR@5': '0.0898', 'NDCG@5': '0.0632', 'HR@10': '0.1239', 'NDCG@10': '0.0741', 'HR@20': '0.1680', 'NDCG@20': '0.0853'}
2025-03-21 18:03:57,166 - EarlyStopping counter: 5 out of 10
2025-03-21 18:04:27,829 - {'epoch': 90, 'rec_loss': '6.9751'}
2025-03-21 18:04:37,975 - {'Epoch': 90, 'HR@5': '0.0871', 'NDCG@5': '0.0618', 'HR@10': '0.1219', 'NDCG@10': '0.0730', 'HR@20': '0.1666', 'NDCG@20': '0.0842'}
2025-03-21 18:04:37,976 - EarlyStopping counter: 6 out of 10
2025-03-21 18:05:09,321 - {'epoch': 91, 'rec_loss': '6.9754'}
2025-03-21 18:05:19,082 - {'Epoch': 91, 'HR@5': '0.0897', 'NDCG@5': '0.0634', 'HR@10': '0.1229', 'NDCG@10': '0.0741', 'HR@20': '0.1676', 'NDCG@20': '0.0854'}
2025-03-21 18:05:19,091 - EarlyStopping counter: 7 out of 10
2025-03-21 18:05:50,300 - {'epoch': 92, 'rec_loss': '6.9744'}
2025-03-21 18:05:59,501 - {'Epoch': 92, 'HR@5': '0.0881', 'NDCG@5': '0.0619', 'HR@10': '0.1222', 'NDCG@10': '0.0729', 'HR@20': '0.1679', 'NDCG@20': '0.0844'}
2025-03-21 18:05:59,502 - EarlyStopping counter: 8 out of 10
2025-03-21 18:06:30,850 - {'epoch': 93, 'rec_loss': '6.9657'}
2025-03-21 18:06:40,959 - {'Epoch': 93, 'HR@5': '0.0885', 'NDCG@5': '0.0628', 'HR@10': '0.1232', 'NDCG@10': '0.0739', 'HR@20': '0.1680', 'NDCG@20': '0.0852'}
2025-03-21 18:06:40,960 - EarlyStopping counter: 9 out of 10
2025-03-21 18:07:12,341 - {'epoch': 94, 'rec_loss': '6.9723'}
2025-03-21 18:07:21,832 - {'Epoch': 94, 'HR@5': '0.0878', 'NDCG@5': '0.0628', 'HR@10': '0.1226', 'NDCG@10': '0.0740', 'HR@20': '0.1690', 'NDCG@20': '0.0857'}
2025-03-21 18:07:21,833 - EarlyStopping counter: 10 out of 10
2025-03-21 18:07:21,834 - Early stopping
2025-03-21 18:07:21,834 - ---------------Test Score---------------
2025-03-21 18:07:30,834 - {'Epoch': 0, 'HR@5': '0.0719', 'NDCG@5': '0.0507', 'HR@10': '0.1006', 'NDCG@10': '0.0599', 'HR@20': '0.1404', 'NDCG@20': '0.0699'}
2025-03-21 18:07:30,837 - Scale_Beauty
2025-03-21 18:07:30,837 - {'Epoch': 0, 'HR@5': '0.0719', 'NDCG@5': '0.0507', 'HR@10': '0.1006', 'NDCG@10': '0.0599', 'HR@20': '0.1404', 'NDCG@20': '0.0699'}
2025-04-03 13:48:52,239 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-04-03 13:48:56,677 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-04-03 13:48:56,693 - Total Parameters: 928470
2025-04-03 13:50:25,877 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='Scale_Beauty', num_items=10, num_users=22364, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/Scale_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2025-04-03 13:50:30,249 - ScaleRecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-04-03 13:50:30,256 - Total Parameters: 928470
