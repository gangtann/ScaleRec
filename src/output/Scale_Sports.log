2025-02-16 11:43:12,813 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-16 11:43:15,579 - HyperRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-16 11:43:15,583 - Total Parameters: 1329829
2025-02-16 11:43:56,857 - {'epoch': 0, 'rec_loss': '9.4034'}
2025-02-16 11:44:12,110 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0055', 'HR@10': '0.0127', 'NDCG@10': '0.0069', 'HR@20': '0.0224', 'NDCG@20': '0.0093'}
2025-02-16 11:44:12,118 - Validation score increased.  Saving model ...
2025-02-16 11:44:52,059 - {'epoch': 1, 'rec_loss': '9.1983'}
2025-02-16 11:45:07,655 - {'Epoch': 1, 'HR@5': '0.0152', 'NDCG@5': '0.0099', 'HR@10': '0.0259', 'NDCG@10': '0.0134', 'HR@20': '0.0407', 'NDCG@20': '0.0171'}
2025-02-16 11:45:07,656 - Validation score increased.  Saving model ...
2025-02-16 11:45:48,615 - {'epoch': 2, 'rec_loss': '8.9006'}
2025-02-16 11:46:04,289 - {'Epoch': 2, 'HR@5': '0.0213', 'NDCG@5': '0.0135', 'HR@10': '0.0339', 'NDCG@10': '0.0175', 'HR@20': '0.0536', 'NDCG@20': '0.0225'}
2025-02-16 11:46:04,295 - Validation score increased.  Saving model ...
2025-02-16 11:46:44,180 - {'epoch': 3, 'rec_loss': '8.6825'}
2025-02-16 11:47:00,179 - {'Epoch': 3, 'HR@5': '0.0297', 'NDCG@5': '0.0193', 'HR@10': '0.0460', 'NDCG@10': '0.0245', 'HR@20': '0.0684', 'NDCG@20': '0.0301'}
2025-02-16 11:47:00,182 - Validation score increased.  Saving model ...
2025-02-16 11:47:41,174 - {'epoch': 4, 'rec_loss': '8.5073'}
2025-02-16 11:47:57,512 - {'Epoch': 4, 'HR@5': '0.0340', 'NDCG@5': '0.0224', 'HR@10': '0.0506', 'NDCG@10': '0.0278', 'HR@20': '0.0749', 'NDCG@20': '0.0339'}
2025-02-16 11:47:57,513 - Validation score increased.  Saving model ...
2025-02-16 11:48:39,014 - {'epoch': 5, 'rec_loss': '8.3737'}
2025-02-16 11:48:54,913 - {'Epoch': 5, 'HR@5': '0.0396', 'NDCG@5': '0.0272', 'HR@10': '0.0581', 'NDCG@10': '0.0331', 'HR@20': '0.0833', 'NDCG@20': '0.0395'}
2025-02-16 11:48:54,915 - Validation score increased.  Saving model ...
2025-02-16 11:49:35,715 - {'epoch': 6, 'rec_loss': '8.2649'}
2025-02-16 11:49:51,916 - {'Epoch': 6, 'HR@5': '0.0407', 'NDCG@5': '0.0282', 'HR@10': '0.0596', 'NDCG@10': '0.0342', 'HR@20': '0.0864', 'NDCG@20': '0.0410'}
2025-02-16 11:49:51,917 - Validation score increased.  Saving model ...
2025-02-16 11:50:32,362 - {'epoch': 7, 'rec_loss': '8.1731'}
2025-02-16 11:50:48,493 - {'Epoch': 7, 'HR@5': '0.0427', 'NDCG@5': '0.0297', 'HR@10': '0.0627', 'NDCG@10': '0.0361', 'HR@20': '0.0896', 'NDCG@20': '0.0429'}
2025-02-16 11:50:48,496 - Validation score increased.  Saving model ...
2025-02-16 11:51:33,313 - {'epoch': 8, 'rec_loss': '8.0994'}
2025-02-16 11:51:49,282 - {'Epoch': 8, 'HR@5': '0.0458', 'NDCG@5': '0.0320', 'HR@10': '0.0652', 'NDCG@10': '0.0383', 'HR@20': '0.0930', 'NDCG@20': '0.0453'}
2025-02-16 11:51:49,283 - Validation score increased.  Saving model ...
2025-02-16 11:52:33,759 - {'epoch': 9, 'rec_loss': '8.0413'}
2025-02-16 11:52:50,056 - {'Epoch': 9, 'HR@5': '0.0471', 'NDCG@5': '0.0329', 'HR@10': '0.0665', 'NDCG@10': '0.0391', 'HR@20': '0.0947', 'NDCG@20': '0.0462'}
2025-02-16 11:52:50,057 - Validation score increased.  Saving model ...
2025-02-16 11:53:31,803 - {'epoch': 10, 'rec_loss': '7.9883'}
2025-02-16 11:53:48,745 - {'Epoch': 10, 'HR@5': '0.0473', 'NDCG@5': '0.0331', 'HR@10': '0.0688', 'NDCG@10': '0.0400', 'HR@20': '0.0962', 'NDCG@20': '0.0468'}
2025-02-16 11:53:48,747 - Validation score increased.  Saving model ...
2025-02-16 11:54:28,869 - {'epoch': 11, 'rec_loss': '7.9410'}
2025-02-16 11:54:44,916 - {'Epoch': 11, 'HR@5': '0.0491', 'NDCG@5': '0.0341', 'HR@10': '0.0686', 'NDCG@10': '0.0404', 'HR@20': '0.0964', 'NDCG@20': '0.0474'}
2025-02-16 11:54:44,917 - Validation score increased.  Saving model ...
2025-02-16 11:55:25,347 - {'epoch': 12, 'rec_loss': '7.9018'}
2025-02-16 11:55:42,270 - {'Epoch': 12, 'HR@5': '0.0473', 'NDCG@5': '0.0329', 'HR@10': '0.0687', 'NDCG@10': '0.0398', 'HR@20': '0.0976', 'NDCG@20': '0.0470'}
2025-02-16 11:55:42,271 - EarlyStopping counter: 1 out of 10
2025-02-16 11:56:24,060 - {'epoch': 13, 'rec_loss': '7.8695'}
2025-02-16 11:56:40,565 - {'Epoch': 13, 'HR@5': '0.0491', 'NDCG@5': '0.0343', 'HR@10': '0.0708', 'NDCG@10': '0.0412', 'HR@20': '0.0983', 'NDCG@20': '0.0481'}
2025-02-16 11:56:40,566 - Validation score increased.  Saving model ...
2025-02-16 11:57:25,361 - {'epoch': 14, 'rec_loss': '7.8371'}
2025-02-16 11:57:41,579 - {'Epoch': 14, 'HR@5': '0.0492', 'NDCG@5': '0.0342', 'HR@10': '0.0707', 'NDCG@10': '0.0411', 'HR@20': '0.0989', 'NDCG@20': '0.0482'}
2025-02-16 11:57:41,580 - Validation score increased.  Saving model ...
2025-02-16 11:58:27,821 - {'epoch': 15, 'rec_loss': '7.8115'}
2025-02-16 11:58:43,990 - {'Epoch': 15, 'HR@5': '0.0489', 'NDCG@5': '0.0341', 'HR@10': '0.0709', 'NDCG@10': '0.0412', 'HR@20': '0.0996', 'NDCG@20': '0.0484'}
2025-02-16 11:58:43,993 - Validation score increased.  Saving model ...
2025-02-16 11:59:24,338 - {'epoch': 16, 'rec_loss': '7.7921'}
2025-02-16 11:59:41,282 - {'Epoch': 16, 'HR@5': '0.0486', 'NDCG@5': '0.0339', 'HR@10': '0.0707', 'NDCG@10': '0.0410', 'HR@20': '0.1008', 'NDCG@20': '0.0486'}
2025-02-16 11:59:41,283 - Validation score increased.  Saving model ...
2025-02-16 12:00:22,428 - {'epoch': 17, 'rec_loss': '7.7617'}
2025-02-16 12:00:38,839 - {'Epoch': 17, 'HR@5': '0.0499', 'NDCG@5': '0.0346', 'HR@10': '0.0714', 'NDCG@10': '0.0416', 'HR@20': '0.1018', 'NDCG@20': '0.0492'}
2025-02-16 12:00:38,840 - Validation score increased.  Saving model ...
2025-02-16 12:01:22,833 - {'epoch': 18, 'rec_loss': '7.7482'}
2025-02-16 12:01:39,339 - {'Epoch': 18, 'HR@5': '0.0495', 'NDCG@5': '0.0343', 'HR@10': '0.0707', 'NDCG@10': '0.0411', 'HR@20': '0.1011', 'NDCG@20': '0.0488'}
2025-02-16 12:01:39,343 - EarlyStopping counter: 1 out of 10
2025-02-16 12:02:21,493 - {'epoch': 19, 'rec_loss': '7.7300'}
2025-02-16 12:02:37,809 - {'Epoch': 19, 'HR@5': '0.0496', 'NDCG@5': '0.0346', 'HR@10': '0.0725', 'NDCG@10': '0.0420', 'HR@20': '0.1016', 'NDCG@20': '0.0493'}
2025-02-16 12:02:37,810 - Validation score increased.  Saving model ...
2025-02-16 12:03:23,120 - {'epoch': 20, 'rec_loss': '7.7120'}
2025-02-16 12:03:39,532 - {'Epoch': 20, 'HR@5': '0.0513', 'NDCG@5': '0.0358', 'HR@10': '0.0725', 'NDCG@10': '0.0426', 'HR@20': '0.1015', 'NDCG@20': '0.0499'}
2025-02-16 12:03:39,533 - Validation score increased.  Saving model ...
2025-02-16 12:04:21,716 - {'epoch': 21, 'rec_loss': '7.6955'}
2025-02-16 12:04:37,921 - {'Epoch': 21, 'HR@5': '0.0511', 'NDCG@5': '0.0356', 'HR@10': '0.0726', 'NDCG@10': '0.0425', 'HR@20': '0.1014', 'NDCG@20': '0.0497'}
2025-02-16 12:04:37,922 - EarlyStopping counter: 1 out of 10
2025-02-16 12:05:19,385 - {'epoch': 22, 'rec_loss': '7.6830'}
2025-02-16 12:05:36,181 - {'Epoch': 22, 'HR@5': '0.0512', 'NDCG@5': '0.0356', 'HR@10': '0.0727', 'NDCG@10': '0.0425', 'HR@20': '0.1022', 'NDCG@20': '0.0499'}
2025-02-16 12:05:36,183 - Validation score increased.  Saving model ...
2025-02-16 12:06:17,250 - {'epoch': 23, 'rec_loss': '7.6675'}
2025-02-16 12:06:33,749 - {'Epoch': 23, 'HR@5': '0.0505', 'NDCG@5': '0.0351', 'HR@10': '0.0721', 'NDCG@10': '0.0421', 'HR@20': '0.1010', 'NDCG@20': '0.0494'}
2025-02-16 12:06:33,750 - EarlyStopping counter: 1 out of 10
2025-02-16 12:07:13,843 - {'epoch': 24, 'rec_loss': '7.6582'}
2025-02-16 12:07:30,743 - {'Epoch': 24, 'HR@5': '0.0517', 'NDCG@5': '0.0365', 'HR@10': '0.0728', 'NDCG@10': '0.0432', 'HR@20': '0.1000', 'NDCG@20': '0.0501'}
2025-02-16 12:07:30,744 - Validation score increased.  Saving model ...
2025-02-16 12:08:12,468 - {'epoch': 25, 'rec_loss': '7.6408'}
2025-02-16 12:08:29,061 - {'Epoch': 25, 'HR@5': '0.0514', 'NDCG@5': '0.0359', 'HR@10': '0.0734', 'NDCG@10': '0.0430', 'HR@20': '0.1035', 'NDCG@20': '0.0505'}
2025-02-16 12:08:29,062 - Validation score increased.  Saving model ...
2025-02-16 12:09:09,220 - {'epoch': 26, 'rec_loss': '7.6335'}
2025-02-16 12:09:27,003 - {'Epoch': 26, 'HR@5': '0.0516', 'NDCG@5': '0.0359', 'HR@10': '0.0730', 'NDCG@10': '0.0427', 'HR@20': '0.1024', 'NDCG@20': '0.0501'}
2025-02-16 12:09:27,006 - EarlyStopping counter: 1 out of 10
2025-02-16 12:10:11,831 - {'epoch': 27, 'rec_loss': '7.6216'}
2025-02-16 12:10:28,596 - {'Epoch': 27, 'HR@5': '0.0508', 'NDCG@5': '0.0356', 'HR@10': '0.0727', 'NDCG@10': '0.0426', 'HR@20': '0.1023', 'NDCG@20': '0.0501'}
2025-02-16 12:10:28,597 - EarlyStopping counter: 2 out of 10
2025-02-16 12:11:10,974 - {'epoch': 28, 'rec_loss': '7.6129'}
2025-02-16 12:11:29,033 - {'Epoch': 28, 'HR@5': '0.0510', 'NDCG@5': '0.0356', 'HR@10': '0.0723', 'NDCG@10': '0.0425', 'HR@20': '0.1025', 'NDCG@20': '0.0501'}
2025-02-16 12:11:29,038 - EarlyStopping counter: 3 out of 10
2025-02-16 12:12:08,351 - {'epoch': 29, 'rec_loss': '7.6024'}
2025-02-16 12:12:25,121 - {'Epoch': 29, 'HR@5': '0.0503', 'NDCG@5': '0.0354', 'HR@10': '0.0720', 'NDCG@10': '0.0424', 'HR@20': '0.1013', 'NDCG@20': '0.0498'}
2025-02-16 12:12:25,122 - EarlyStopping counter: 4 out of 10
2025-02-16 12:13:06,094 - {'epoch': 30, 'rec_loss': '7.5875'}
2025-02-16 12:13:22,454 - {'Epoch': 30, 'HR@5': '0.0517', 'NDCG@5': '0.0362', 'HR@10': '0.0739', 'NDCG@10': '0.0433', 'HR@20': '0.1031', 'NDCG@20': '0.0506'}
2025-02-16 12:13:22,457 - Validation score increased.  Saving model ...
2025-02-16 12:14:02,255 - {'epoch': 31, 'rec_loss': '7.5850'}
2025-02-16 12:14:18,875 - {'Epoch': 31, 'HR@5': '0.0514', 'NDCG@5': '0.0359', 'HR@10': '0.0726', 'NDCG@10': '0.0427', 'HR@20': '0.1028', 'NDCG@20': '0.0503'}
2025-02-16 12:14:18,879 - EarlyStopping counter: 1 out of 10
2025-02-16 12:15:00,070 - {'epoch': 32, 'rec_loss': '7.5760'}
2025-02-16 12:15:16,562 - {'Epoch': 32, 'HR@5': '0.0508', 'NDCG@5': '0.0358', 'HR@10': '0.0728', 'NDCG@10': '0.0429', 'HR@20': '0.1020', 'NDCG@20': '0.0502'}
2025-02-16 12:15:16,564 - EarlyStopping counter: 2 out of 10
2025-02-16 12:15:55,540 - {'epoch': 33, 'rec_loss': '7.5710'}
2025-02-16 12:16:11,895 - {'Epoch': 33, 'HR@5': '0.0508', 'NDCG@5': '0.0353', 'HR@10': '0.0715', 'NDCG@10': '0.0420', 'HR@20': '0.1012', 'NDCG@20': '0.0495'}
2025-02-16 12:16:11,896 - EarlyStopping counter: 3 out of 10
2025-02-16 12:16:50,009 - {'epoch': 34, 'rec_loss': '7.5652'}
2025-02-16 12:17:07,011 - {'Epoch': 34, 'HR@5': '0.0514', 'NDCG@5': '0.0356', 'HR@10': '0.0730', 'NDCG@10': '0.0425', 'HR@20': '0.1034', 'NDCG@20': '0.0502'}
2025-02-16 12:17:07,015 - EarlyStopping counter: 4 out of 10
2025-02-16 12:17:47,522 - {'epoch': 35, 'rec_loss': '7.5517'}
2025-02-16 12:18:05,921 - {'Epoch': 35, 'HR@5': '0.0516', 'NDCG@5': '0.0358', 'HR@10': '0.0723', 'NDCG@10': '0.0425', 'HR@20': '0.1024', 'NDCG@20': '0.0500'}
2025-02-16 12:18:05,923 - EarlyStopping counter: 5 out of 10
2025-02-16 12:18:44,552 - {'epoch': 36, 'rec_loss': '7.5460'}
2025-02-16 12:19:00,820 - {'Epoch': 36, 'HR@5': '0.0515', 'NDCG@5': '0.0360', 'HR@10': '0.0730', 'NDCG@10': '0.0429', 'HR@20': '0.1022', 'NDCG@20': '0.0503'}
2025-02-16 12:19:00,824 - EarlyStopping counter: 6 out of 10
2025-02-16 12:19:38,213 - {'epoch': 37, 'rec_loss': '7.5380'}
2025-02-16 12:19:57,099 - {'Epoch': 37, 'HR@5': '0.0517', 'NDCG@5': '0.0360', 'HR@10': '0.0734', 'NDCG@10': '0.0430', 'HR@20': '0.1033', 'NDCG@20': '0.0505'}
2025-02-16 12:19:57,102 - EarlyStopping counter: 7 out of 10
2025-02-16 12:20:33,968 - {'epoch': 38, 'rec_loss': '7.5374'}
2025-02-16 12:20:52,019 - {'Epoch': 38, 'HR@5': '0.0517', 'NDCG@5': '0.0361', 'HR@10': '0.0728', 'NDCG@10': '0.0428', 'HR@20': '0.1038', 'NDCG@20': '0.0507'}
2025-02-16 12:20:52,022 - Validation score increased.  Saving model ...
2025-02-16 12:21:29,428 - {'epoch': 39, 'rec_loss': '7.5279'}
2025-02-16 12:21:47,194 - {'Epoch': 39, 'HR@5': '0.0517', 'NDCG@5': '0.0359', 'HR@10': '0.0735', 'NDCG@10': '0.0429', 'HR@20': '0.1035', 'NDCG@20': '0.0504'}
2025-02-16 12:21:47,198 - EarlyStopping counter: 1 out of 10
2025-02-16 12:22:24,072 - {'epoch': 40, 'rec_loss': '7.5193'}
2025-02-16 12:22:42,998 - {'Epoch': 40, 'HR@5': '0.0503', 'NDCG@5': '0.0354', 'HR@10': '0.0733', 'NDCG@10': '0.0428', 'HR@20': '0.1026', 'NDCG@20': '0.0501'}
2025-02-16 12:22:43,000 - EarlyStopping counter: 2 out of 10
2025-02-16 12:23:20,411 - {'epoch': 41, 'rec_loss': '7.5096'}
2025-02-16 12:23:36,694 - {'Epoch': 41, 'HR@5': '0.0520', 'NDCG@5': '0.0360', 'HR@10': '0.0739', 'NDCG@10': '0.0430', 'HR@20': '0.1028', 'NDCG@20': '0.0503'}
2025-02-16 12:23:36,698 - EarlyStopping counter: 3 out of 10
2025-02-16 12:24:16,523 - {'epoch': 42, 'rec_loss': '7.5093'}
2025-02-16 12:24:34,631 - {'Epoch': 42, 'HR@5': '0.0519', 'NDCG@5': '0.0361', 'HR@10': '0.0736', 'NDCG@10': '0.0431', 'HR@20': '0.1027', 'NDCG@20': '0.0504'}
2025-02-16 12:24:34,634 - EarlyStopping counter: 4 out of 10
2025-02-16 12:25:11,588 - {'epoch': 43, 'rec_loss': '7.5082'}
2025-02-16 12:25:29,467 - {'Epoch': 43, 'HR@5': '0.0519', 'NDCG@5': '0.0363', 'HR@10': '0.0739', 'NDCG@10': '0.0434', 'HR@20': '0.1030', 'NDCG@20': '0.0507'}
2025-02-16 12:25:29,469 - Validation score increased.  Saving model ...
2025-02-16 12:26:06,429 - {'epoch': 44, 'rec_loss': '7.4959'}
2025-02-16 12:26:23,294 - {'Epoch': 44, 'HR@5': '0.0517', 'NDCG@5': '0.0361', 'HR@10': '0.0737', 'NDCG@10': '0.0431', 'HR@20': '0.1037', 'NDCG@20': '0.0507'}
2025-02-16 12:26:23,298 - EarlyStopping counter: 1 out of 10
2025-02-16 12:27:00,167 - {'epoch': 45, 'rec_loss': '7.4925'}
2025-02-16 12:27:16,596 - {'Epoch': 45, 'HR@5': '0.0515', 'NDCG@5': '0.0361', 'HR@10': '0.0740', 'NDCG@10': '0.0433', 'HR@20': '0.1030', 'NDCG@20': '0.0506'}
2025-02-16 12:27:16,599 - EarlyStopping counter: 2 out of 10
2025-02-16 12:27:57,391 - {'epoch': 46, 'rec_loss': '7.4891'}
2025-02-16 12:28:16,429 - {'Epoch': 46, 'HR@5': '0.0511', 'NDCG@5': '0.0358', 'HR@10': '0.0728', 'NDCG@10': '0.0428', 'HR@20': '0.1017', 'NDCG@20': '0.0501'}
2025-02-16 12:28:16,433 - EarlyStopping counter: 3 out of 10
2025-02-16 12:28:54,066 - {'epoch': 47, 'rec_loss': '7.4803'}
2025-02-16 12:29:13,134 - {'Epoch': 47, 'HR@5': '0.0523', 'NDCG@5': '0.0362', 'HR@10': '0.0735', 'NDCG@10': '0.0430', 'HR@20': '0.1034', 'NDCG@20': '0.0505'}
2025-02-16 12:29:13,137 - EarlyStopping counter: 4 out of 10
2025-02-16 12:29:51,098 - {'epoch': 48, 'rec_loss': '7.4764'}
2025-02-16 12:30:09,924 - {'Epoch': 48, 'HR@5': '0.0523', 'NDCG@5': '0.0365', 'HR@10': '0.0746', 'NDCG@10': '0.0437', 'HR@20': '0.1046', 'NDCG@20': '0.0512'}
2025-02-16 12:30:09,925 - Validation score increased.  Saving model ...
2025-02-16 12:30:47,001 - {'epoch': 49, 'rec_loss': '7.4748'}
2025-02-16 12:31:06,058 - {'Epoch': 49, 'HR@5': '0.0520', 'NDCG@5': '0.0363', 'HR@10': '0.0726', 'NDCG@10': '0.0430', 'HR@20': '0.1022', 'NDCG@20': '0.0504'}
2025-02-16 12:31:06,059 - EarlyStopping counter: 1 out of 10
2025-02-16 12:31:44,646 - {'epoch': 50, 'rec_loss': '7.4688'}
2025-02-16 12:32:03,619 - {'Epoch': 50, 'HR@5': '0.0510', 'NDCG@5': '0.0358', 'HR@10': '0.0729', 'NDCG@10': '0.0429', 'HR@20': '0.1030', 'NDCG@20': '0.0505'}
2025-02-16 12:32:03,621 - EarlyStopping counter: 2 out of 10
2025-02-16 12:32:40,981 - {'epoch': 51, 'rec_loss': '7.4654'}
2025-02-16 12:32:57,325 - {'Epoch': 51, 'HR@5': '0.0524', 'NDCG@5': '0.0364', 'HR@10': '0.0731', 'NDCG@10': '0.0430', 'HR@20': '0.1024', 'NDCG@20': '0.0504'}
2025-02-16 12:32:57,326 - EarlyStopping counter: 3 out of 10
2025-02-16 12:33:34,544 - {'epoch': 52, 'rec_loss': '7.4632'}
2025-02-16 12:33:50,957 - {'Epoch': 52, 'HR@5': '0.0523', 'NDCG@5': '0.0361', 'HR@10': '0.0737', 'NDCG@10': '0.0431', 'HR@20': '0.1038', 'NDCG@20': '0.0507'}
2025-02-16 12:33:50,961 - EarlyStopping counter: 4 out of 10
2025-02-16 12:34:28,504 - {'epoch': 53, 'rec_loss': '7.4641'}
2025-02-16 12:34:44,890 - {'Epoch': 53, 'HR@5': '0.0518', 'NDCG@5': '0.0363', 'HR@10': '0.0741', 'NDCG@10': '0.0434', 'HR@20': '0.1031', 'NDCG@20': '0.0507'}
2025-02-16 12:34:44,892 - EarlyStopping counter: 5 out of 10
2025-02-16 12:35:22,005 - {'epoch': 54, 'rec_loss': '7.4505'}
2025-02-16 12:35:40,990 - {'Epoch': 54, 'HR@5': '0.0522', 'NDCG@5': '0.0367', 'HR@10': '0.0731', 'NDCG@10': '0.0434', 'HR@20': '0.1032', 'NDCG@20': '0.0510'}
2025-02-16 12:35:40,991 - EarlyStopping counter: 6 out of 10
2025-02-16 12:36:18,105 - {'epoch': 55, 'rec_loss': '7.4476'}
2025-02-16 12:36:34,206 - {'Epoch': 55, 'HR@5': '0.0517', 'NDCG@5': '0.0362', 'HR@10': '0.0733', 'NDCG@10': '0.0432', 'HR@20': '0.1038', 'NDCG@20': '0.0508'}
2025-02-16 12:36:34,208 - EarlyStopping counter: 7 out of 10
2025-02-16 12:37:11,129 - {'epoch': 56, 'rec_loss': '7.4402'}
2025-02-16 12:37:27,614 - {'Epoch': 56, 'HR@5': '0.0513', 'NDCG@5': '0.0360', 'HR@10': '0.0732', 'NDCG@10': '0.0431', 'HR@20': '0.1039', 'NDCG@20': '0.0508'}
2025-02-16 12:37:27,615 - EarlyStopping counter: 8 out of 10
2025-02-16 12:38:05,608 - {'epoch': 57, 'rec_loss': '7.4398'}
2025-02-16 12:38:23,351 - {'Epoch': 57, 'HR@5': '0.0514', 'NDCG@5': '0.0361', 'HR@10': '0.0732', 'NDCG@10': '0.0431', 'HR@20': '0.1037', 'NDCG@20': '0.0508'}
2025-02-16 12:38:23,352 - EarlyStopping counter: 9 out of 10
2025-02-16 12:39:00,493 - {'epoch': 58, 'rec_loss': '7.4363'}
2025-02-16 12:39:19,082 - {'Epoch': 58, 'HR@5': '0.0521', 'NDCG@5': '0.0364', 'HR@10': '0.0729', 'NDCG@10': '0.0431', 'HR@20': '0.1037', 'NDCG@20': '0.0509'}
2025-02-16 12:39:19,086 - EarlyStopping counter: 10 out of 10
2025-02-16 12:39:19,086 - Early stopping
2025-02-16 12:39:19,086 - ---------------Test Score---------------
2025-02-16 12:39:38,116 - {'Epoch': 0, 'HR@5': '0.0427', 'NDCG@5': '0.0297', 'HR@10': '0.0618', 'NDCG@10': '0.0358', 'HR@20': '0.0880', 'NDCG@20': '0.0424'}
2025-02-16 12:39:38,117 - Scale_Sports
2025-02-16 12:39:38,117 - {'Epoch': 0, 'HR@5': '0.0427', 'NDCG@5': '0.0297', 'HR@10': '0.0618', 'NDCG@10': '0.0358', 'HR@20': '0.0880', 'NDCG@20': '0.0424'}
2025-02-20 11:34:41,684 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-20 11:34:44,473 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-20 11:34:44,478 - Total Parameters: 1329829
2025-02-20 11:35:25,963 - {'epoch': 0, 'rec_loss': '9.4030'}
2025-02-20 11:35:41,253 - {'Epoch': 0, 'HR@5': '0.0085', 'NDCG@5': '0.0056', 'HR@10': '0.0126', 'NDCG@10': '0.0069', 'HR@20': '0.0224', 'NDCG@20': '0.0093'}
2025-02-20 11:35:41,256 - Validation score increased.  Saving model ...
2025-02-20 11:36:21,500 - {'epoch': 1, 'rec_loss': '9.2018'}
2025-02-20 11:36:37,217 - {'Epoch': 1, 'HR@5': '0.0149', 'NDCG@5': '0.0097', 'HR@10': '0.0255', 'NDCG@10': '0.0131', 'HR@20': '0.0401', 'NDCG@20': '0.0167'}
2025-02-20 11:36:37,219 - Validation score increased.  Saving model ...
2025-02-20 11:37:17,382 - {'epoch': 2, 'rec_loss': '8.9206'}
2025-02-20 11:37:33,128 - {'Epoch': 2, 'HR@5': '0.0198', 'NDCG@5': '0.0127', 'HR@10': '0.0321', 'NDCG@10': '0.0166', 'HR@20': '0.0512', 'NDCG@20': '0.0214'}
2025-02-20 11:37:33,129 - Validation score increased.  Saving model ...
2025-02-20 11:38:14,417 - {'epoch': 3, 'rec_loss': '8.7209'}
2025-02-20 11:38:30,305 - {'Epoch': 3, 'HR@5': '0.0269', 'NDCG@5': '0.0173', 'HR@10': '0.0426', 'NDCG@10': '0.0224', 'HR@20': '0.0651', 'NDCG@20': '0.0281'}
2025-02-20 11:38:30,308 - Validation score increased.  Saving model ...
2025-02-20 11:39:10,690 - {'epoch': 4, 'rec_loss': '8.5553'}
2025-02-20 11:39:26,753 - {'Epoch': 4, 'HR@5': '0.0321', 'NDCG@5': '0.0210', 'HR@10': '0.0488', 'NDCG@10': '0.0263', 'HR@20': '0.0725', 'NDCG@20': '0.0322'}
2025-02-20 11:39:26,755 - Validation score increased.  Saving model ...
2025-02-20 11:40:08,130 - {'epoch': 5, 'rec_loss': '8.4266'}
2025-02-20 11:40:24,439 - {'Epoch': 5, 'HR@5': '0.0375', 'NDCG@5': '0.0256', 'HR@10': '0.0550', 'NDCG@10': '0.0312', 'HR@20': '0.0801', 'NDCG@20': '0.0375'}
2025-02-20 11:40:24,440 - Validation score increased.  Saving model ...
2025-02-20 11:41:05,716 - {'epoch': 6, 'rec_loss': '8.3231'}
2025-02-20 11:41:21,729 - {'Epoch': 6, 'HR@5': '0.0393', 'NDCG@5': '0.0270', 'HR@10': '0.0565', 'NDCG@10': '0.0325', 'HR@20': '0.0843', 'NDCG@20': '0.0395'}
2025-02-20 11:41:21,731 - Validation score increased.  Saving model ...
2025-02-20 11:42:04,327 - {'epoch': 7, 'rec_loss': '8.2356'}
2025-02-20 11:42:21,057 - {'Epoch': 7, 'HR@5': '0.0409', 'NDCG@5': '0.0285', 'HR@10': '0.0606', 'NDCG@10': '0.0348', 'HR@20': '0.0875', 'NDCG@20': '0.0416'}
2025-02-20 11:42:21,058 - Validation score increased.  Saving model ...
2025-02-20 11:43:02,386 - {'epoch': 8, 'rec_loss': '8.1633'}
2025-02-20 11:43:18,444 - {'Epoch': 8, 'HR@5': '0.0441', 'NDCG@5': '0.0304', 'HR@10': '0.0638', 'NDCG@10': '0.0368', 'HR@20': '0.0916', 'NDCG@20': '0.0437'}
2025-02-20 11:43:18,445 - Validation score increased.  Saving model ...
2025-02-20 11:43:59,116 - {'epoch': 9, 'rec_loss': '8.1045'}
2025-02-20 11:44:15,277 - {'Epoch': 9, 'HR@5': '0.0454', 'NDCG@5': '0.0317', 'HR@10': '0.0652', 'NDCG@10': '0.0381', 'HR@20': '0.0937', 'NDCG@20': '0.0453'}
2025-02-20 11:44:15,279 - Validation score increased.  Saving model ...
2025-02-20 11:44:57,016 - {'epoch': 10, 'rec_loss': '8.0525'}
2025-02-20 11:45:13,223 - {'Epoch': 10, 'HR@5': '0.0465', 'NDCG@5': '0.0324', 'HR@10': '0.0666', 'NDCG@10': '0.0389', 'HR@20': '0.0947', 'NDCG@20': '0.0460'}
2025-02-20 11:45:13,224 - Validation score increased.  Saving model ...
2025-02-20 11:45:56,412 - {'epoch': 11, 'rec_loss': '8.0038'}
2025-02-20 11:46:12,652 - {'Epoch': 11, 'HR@5': '0.0478', 'NDCG@5': '0.0332', 'HR@10': '0.0670', 'NDCG@10': '0.0394', 'HR@20': '0.0960', 'NDCG@20': '0.0467'}
2025-02-20 11:46:12,654 - Validation score increased.  Saving model ...
2025-02-20 11:46:59,696 - {'epoch': 12, 'rec_loss': '7.9645'}
2025-02-20 11:47:15,780 - {'Epoch': 12, 'HR@5': '0.0465', 'NDCG@5': '0.0327', 'HR@10': '0.0680', 'NDCG@10': '0.0396', 'HR@20': '0.0961', 'NDCG@20': '0.0466'}
2025-02-20 11:47:15,781 - EarlyStopping counter: 1 out of 10
2025-02-20 11:47:57,014 - {'epoch': 13, 'rec_loss': '7.9314'}
2025-02-20 11:48:12,944 - {'Epoch': 13, 'HR@5': '0.0486', 'NDCG@5': '0.0342', 'HR@10': '0.0689', 'NDCG@10': '0.0408', 'HR@20': '0.0974', 'NDCG@20': '0.0480'}
2025-02-20 11:48:12,950 - Validation score increased.  Saving model ...
2025-02-20 11:48:54,314 - {'epoch': 14, 'rec_loss': '7.8965'}
2025-02-20 11:49:10,461 - {'Epoch': 14, 'HR@5': '0.0482', 'NDCG@5': '0.0332', 'HR@10': '0.0714', 'NDCG@10': '0.0406', 'HR@20': '0.0984', 'NDCG@20': '0.0474'}
2025-02-20 11:49:10,463 - EarlyStopping counter: 1 out of 10
2025-02-20 11:49:51,819 - {'epoch': 15, 'rec_loss': '7.8724'}
2025-02-20 11:50:08,158 - {'Epoch': 15, 'HR@5': '0.0489', 'NDCG@5': '0.0340', 'HR@10': '0.0695', 'NDCG@10': '0.0406', 'HR@20': '0.0996', 'NDCG@20': '0.0482'}
2025-02-20 11:50:08,159 - Validation score increased.  Saving model ...
2025-02-20 11:50:49,891 - {'epoch': 16, 'rec_loss': '7.8500'}
2025-02-20 11:51:06,624 - {'Epoch': 16, 'HR@5': '0.0483', 'NDCG@5': '0.0337', 'HR@10': '0.0708', 'NDCG@10': '0.0409', 'HR@20': '0.1007', 'NDCG@20': '0.0484'}
2025-02-20 11:51:06,625 - Validation score increased.  Saving model ...
2025-02-20 11:51:48,729 - {'epoch': 17, 'rec_loss': '7.8192'}
2025-02-20 11:52:04,877 - {'Epoch': 17, 'HR@5': '0.0492', 'NDCG@5': '0.0342', 'HR@10': '0.0722', 'NDCG@10': '0.0416', 'HR@20': '0.1016', 'NDCG@20': '0.0490'}
2025-02-20 11:52:04,878 - Validation score increased.  Saving model ...
2025-02-20 11:52:46,235 - {'epoch': 18, 'rec_loss': '7.8082'}
2025-02-20 11:53:02,291 - {'Epoch': 18, 'HR@5': '0.0504', 'NDCG@5': '0.0349', 'HR@10': '0.0714', 'NDCG@10': '0.0417', 'HR@20': '0.1008', 'NDCG@20': '0.0491'}
2025-02-20 11:53:02,297 - Validation score increased.  Saving model ...
2025-02-20 11:53:42,828 - {'epoch': 19, 'rec_loss': '7.7863'}
2025-02-20 11:53:58,999 - {'Epoch': 19, 'HR@5': '0.0494', 'NDCG@5': '0.0343', 'HR@10': '0.0724', 'NDCG@10': '0.0417', 'HR@20': '0.1015', 'NDCG@20': '0.0490'}
2025-02-20 11:53:59,001 - EarlyStopping counter: 1 out of 10
2025-02-20 11:54:40,690 - {'epoch': 20, 'rec_loss': '7.7688'}
2025-02-20 11:54:56,710 - {'Epoch': 20, 'HR@5': '0.0514', 'NDCG@5': '0.0357', 'HR@10': '0.0728', 'NDCG@10': '0.0426', 'HR@20': '0.1017', 'NDCG@20': '0.0498'}
2025-02-20 11:54:56,713 - Validation score increased.  Saving model ...
2025-02-20 11:55:40,274 - {'epoch': 21, 'rec_loss': '7.7545'}
2025-02-20 11:55:56,324 - {'Epoch': 21, 'HR@5': '0.0510', 'NDCG@5': '0.0355', 'HR@10': '0.0723', 'NDCG@10': '0.0423', 'HR@20': '0.1027', 'NDCG@20': '0.0499'}
2025-02-20 11:55:56,327 - Validation score increased.  Saving model ...
2025-02-20 11:56:37,640 - {'epoch': 22, 'rec_loss': '7.7392'}
2025-02-20 11:56:53,474 - {'Epoch': 22, 'HR@5': '0.0503', 'NDCG@5': '0.0355', 'HR@10': '0.0730', 'NDCG@10': '0.0427', 'HR@20': '0.1023', 'NDCG@20': '0.0501'}
2025-02-20 11:56:53,475 - Validation score increased.  Saving model ...
2025-02-20 11:57:34,067 - {'epoch': 23, 'rec_loss': '7.7259'}
2025-02-20 11:57:50,351 - {'Epoch': 23, 'HR@5': '0.0499', 'NDCG@5': '0.0351', 'HR@10': '0.0722', 'NDCG@10': '0.0422', 'HR@20': '0.1016', 'NDCG@20': '0.0496'}
2025-02-20 11:57:50,352 - EarlyStopping counter: 1 out of 10
2025-02-20 11:58:31,820 - {'epoch': 24, 'rec_loss': '7.7152'}
2025-02-20 11:58:48,761 - {'Epoch': 24, 'HR@5': '0.0509', 'NDCG@5': '0.0358', 'HR@10': '0.0731', 'NDCG@10': '0.0429', 'HR@20': '0.1023', 'NDCG@20': '0.0502'}
2025-02-20 11:58:48,762 - Validation score increased.  Saving model ...
2025-02-20 11:59:30,188 - {'epoch': 25, 'rec_loss': '7.6986'}
2025-02-20 11:59:46,334 - {'Epoch': 25, 'HR@5': '0.0510', 'NDCG@5': '0.0359', 'HR@10': '0.0730', 'NDCG@10': '0.0430', 'HR@20': '0.1021', 'NDCG@20': '0.0503'}
2025-02-20 11:59:46,337 - Validation score increased.  Saving model ...
2025-02-20 12:00:31,131 - {'epoch': 26, 'rec_loss': '7.6906'}
2025-02-20 12:00:47,259 - {'Epoch': 26, 'HR@5': '0.0516', 'NDCG@5': '0.0358', 'HR@10': '0.0733', 'NDCG@10': '0.0428', 'HR@20': '0.1020', 'NDCG@20': '0.0501'}
2025-02-20 12:00:47,263 - EarlyStopping counter: 1 out of 10
2025-02-20 12:01:31,878 - {'epoch': 27, 'rec_loss': '7.6776'}
2025-02-20 12:01:48,315 - {'Epoch': 27, 'HR@5': '0.0505', 'NDCG@5': '0.0355', 'HR@10': '0.0732', 'NDCG@10': '0.0427', 'HR@20': '0.1018', 'NDCG@20': '0.0500'}
2025-02-20 12:01:48,319 - EarlyStopping counter: 2 out of 10
2025-02-20 12:02:29,422 - {'epoch': 28, 'rec_loss': '7.6703'}
2025-02-20 12:02:45,839 - {'Epoch': 28, 'HR@5': '0.0510', 'NDCG@5': '0.0357', 'HR@10': '0.0725', 'NDCG@10': '0.0426', 'HR@20': '0.1023', 'NDCG@20': '0.0501'}
2025-02-20 12:02:45,840 - EarlyStopping counter: 3 out of 10
2025-02-20 12:03:29,978 - {'epoch': 29, 'rec_loss': '7.6569'}
2025-02-20 12:03:45,827 - {'Epoch': 29, 'HR@5': '0.0507', 'NDCG@5': '0.0355', 'HR@10': '0.0717', 'NDCG@10': '0.0422', 'HR@20': '0.1016', 'NDCG@20': '0.0497'}
2025-02-20 12:03:45,828 - EarlyStopping counter: 4 out of 10
2025-02-20 12:04:26,800 - {'epoch': 30, 'rec_loss': '7.6465'}
2025-02-20 12:04:43,211 - {'Epoch': 30, 'HR@5': '0.0520', 'NDCG@5': '0.0359', 'HR@10': '0.0734', 'NDCG@10': '0.0428', 'HR@20': '0.1026', 'NDCG@20': '0.0502'}
2025-02-20 12:04:43,212 - EarlyStopping counter: 5 out of 10
2025-02-20 12:05:24,662 - {'epoch': 31, 'rec_loss': '7.6416'}
2025-02-20 12:05:41,228 - {'Epoch': 31, 'HR@5': '0.0515', 'NDCG@5': '0.0360', 'HR@10': '0.0726', 'NDCG@10': '0.0427', 'HR@20': '0.1028', 'NDCG@20': '0.0503'}
2025-02-20 12:05:41,229 - Validation score increased.  Saving model ...
2025-02-20 12:06:22,232 - {'epoch': 32, 'rec_loss': '7.6324'}
2025-02-20 12:06:38,427 - {'Epoch': 32, 'HR@5': '0.0513', 'NDCG@5': '0.0362', 'HR@10': '0.0733', 'NDCG@10': '0.0433', 'HR@20': '0.1032', 'NDCG@20': '0.0508'}
2025-02-20 12:06:38,429 - Validation score increased.  Saving model ...
2025-02-20 12:07:18,524 - {'epoch': 33, 'rec_loss': '7.6260'}
2025-02-20 12:07:34,836 - {'Epoch': 33, 'HR@5': '0.0505', 'NDCG@5': '0.0353', 'HR@10': '0.0733', 'NDCG@10': '0.0427', 'HR@20': '0.1018', 'NDCG@20': '0.0498'}
2025-02-20 12:07:34,839 - EarlyStopping counter: 1 out of 10
2025-02-20 12:08:16,350 - {'epoch': 34, 'rec_loss': '7.6196'}
2025-02-20 12:08:32,667 - {'Epoch': 34, 'HR@5': '0.0513', 'NDCG@5': '0.0358', 'HR@10': '0.0736', 'NDCG@10': '0.0430', 'HR@20': '0.1037', 'NDCG@20': '0.0506'}
2025-02-20 12:08:32,668 - EarlyStopping counter: 2 out of 10
2025-02-20 12:09:14,444 - {'epoch': 35, 'rec_loss': '7.6087'}
2025-02-20 12:09:30,816 - {'Epoch': 35, 'HR@5': '0.0516', 'NDCG@5': '0.0360', 'HR@10': '0.0739', 'NDCG@10': '0.0432', 'HR@20': '0.1028', 'NDCG@20': '0.0504'}
2025-02-20 12:09:30,818 - EarlyStopping counter: 3 out of 10
2025-02-20 12:10:11,862 - {'epoch': 36, 'rec_loss': '7.5985'}
2025-02-20 12:10:28,407 - {'Epoch': 36, 'HR@5': '0.0516', 'NDCG@5': '0.0361', 'HR@10': '0.0749', 'NDCG@10': '0.0436', 'HR@20': '0.1043', 'NDCG@20': '0.0510'}
2025-02-20 12:10:28,409 - Validation score increased.  Saving model ...
2025-02-20 12:11:10,356 - {'epoch': 37, 'rec_loss': '7.5904'}
2025-02-20 12:11:26,611 - {'Epoch': 37, 'HR@5': '0.0516', 'NDCG@5': '0.0357', 'HR@10': '0.0741', 'NDCG@10': '0.0429', 'HR@20': '0.1031', 'NDCG@20': '0.0502'}
2025-02-20 12:11:26,612 - EarlyStopping counter: 1 out of 10
2025-02-20 12:12:07,134 - {'epoch': 38, 'rec_loss': '7.5945'}
2025-02-20 12:12:23,342 - {'Epoch': 38, 'HR@5': '0.0512', 'NDCG@5': '0.0360', 'HR@10': '0.0737', 'NDCG@10': '0.0432', 'HR@20': '0.1033', 'NDCG@20': '0.0507'}
2025-02-20 12:12:23,345 - EarlyStopping counter: 2 out of 10
2025-02-20 12:13:04,423 - {'epoch': 39, 'rec_loss': '7.5818'}
2025-02-20 12:13:20,887 - {'Epoch': 39, 'HR@5': '0.0525', 'NDCG@5': '0.0364', 'HR@10': '0.0735', 'NDCG@10': '0.0432', 'HR@20': '0.1052', 'NDCG@20': '0.0512'}
2025-02-20 12:13:20,891 - Validation score increased.  Saving model ...
2025-02-20 12:14:02,183 - {'epoch': 40, 'rec_loss': '7.5735'}
2025-02-20 12:14:18,884 - {'Epoch': 40, 'HR@5': '0.0519', 'NDCG@5': '0.0362', 'HR@10': '0.0740', 'NDCG@10': '0.0433', 'HR@20': '0.1036', 'NDCG@20': '0.0508'}
2025-02-20 12:14:18,886 - EarlyStopping counter: 1 out of 10
2025-02-20 12:14:58,832 - {'epoch': 41, 'rec_loss': '7.5612'}
2025-02-20 12:15:14,951 - {'Epoch': 41, 'HR@5': '0.0519', 'NDCG@5': '0.0360', 'HR@10': '0.0735', 'NDCG@10': '0.0430', 'HR@20': '0.1033', 'NDCG@20': '0.0505'}
2025-02-20 12:15:14,952 - EarlyStopping counter: 2 out of 10
2025-02-20 12:15:56,869 - {'epoch': 42, 'rec_loss': '7.5639'}
2025-02-20 12:16:12,963 - {'Epoch': 42, 'HR@5': '0.0521', 'NDCG@5': '0.0365', 'HR@10': '0.0745', 'NDCG@10': '0.0437', 'HR@20': '0.1026', 'NDCG@20': '0.0508'}
2025-02-20 12:16:12,964 - EarlyStopping counter: 3 out of 10
2025-02-20 12:16:57,842 - {'epoch': 43, 'rec_loss': '7.5596'}
2025-02-20 12:17:14,454 - {'Epoch': 43, 'HR@5': '0.0518', 'NDCG@5': '0.0364', 'HR@10': '0.0740', 'NDCG@10': '0.0435', 'HR@20': '0.1031', 'NDCG@20': '0.0509'}
2025-02-20 12:17:14,457 - EarlyStopping counter: 4 out of 10
2025-02-20 12:17:55,365 - {'epoch': 44, 'rec_loss': '7.5514'}
2025-02-20 12:18:11,707 - {'Epoch': 44, 'HR@5': '0.0513', 'NDCG@5': '0.0359', 'HR@10': '0.0748', 'NDCG@10': '0.0434', 'HR@20': '0.1056', 'NDCG@20': '0.0512'}
2025-02-20 12:18:11,708 - EarlyStopping counter: 5 out of 10
2025-02-20 12:18:53,044 - {'epoch': 45, 'rec_loss': '7.5461'}
2025-02-20 12:19:09,302 - {'Epoch': 45, 'HR@5': '0.0509', 'NDCG@5': '0.0358', 'HR@10': '0.0740', 'NDCG@10': '0.0432', 'HR@20': '0.1034', 'NDCG@20': '0.0506'}
2025-02-20 12:19:09,306 - EarlyStopping counter: 6 out of 10
2025-02-20 12:19:50,232 - {'epoch': 46, 'rec_loss': '7.5437'}
2025-02-20 12:20:06,524 - {'Epoch': 46, 'HR@5': '0.0517', 'NDCG@5': '0.0364', 'HR@10': '0.0731', 'NDCG@10': '0.0432', 'HR@20': '0.1034', 'NDCG@20': '0.0509'}
2025-02-20 12:20:06,525 - EarlyStopping counter: 7 out of 10
2025-02-20 12:20:47,644 - {'epoch': 47, 'rec_loss': '7.5312'}
2025-02-20 12:21:03,880 - {'Epoch': 47, 'HR@5': '0.0520', 'NDCG@5': '0.0364', 'HR@10': '0.0742', 'NDCG@10': '0.0435', 'HR@20': '0.1042', 'NDCG@20': '0.0510'}
2025-02-20 12:21:03,882 - EarlyStopping counter: 8 out of 10
2025-02-20 12:21:47,406 - {'epoch': 48, 'rec_loss': '7.5363'}
2025-02-20 12:22:04,267 - {'Epoch': 48, 'HR@5': '0.0519', 'NDCG@5': '0.0360', 'HR@10': '0.0752', 'NDCG@10': '0.0435', 'HR@20': '0.1045', 'NDCG@20': '0.0508'}
2025-02-20 12:22:04,268 - EarlyStopping counter: 9 out of 10
2025-02-20 12:22:45,865 - {'epoch': 49, 'rec_loss': '7.5280'}
2025-02-20 12:23:02,235 - {'Epoch': 49, 'HR@5': '0.0515', 'NDCG@5': '0.0362', 'HR@10': '0.0744', 'NDCG@10': '0.0435', 'HR@20': '0.1027', 'NDCG@20': '0.0507'}
2025-02-20 12:23:02,239 - EarlyStopping counter: 10 out of 10
2025-02-20 12:23:02,239 - Early stopping
2025-02-20 12:23:02,239 - ---------------Test Score---------------
2025-02-20 12:23:18,810 - {'Epoch': 0, 'HR@5': '0.0426', 'NDCG@5': '0.0295', 'HR@10': '0.0626', 'NDCG@10': '0.0360', 'HR@20': '0.0883', 'NDCG@20': '0.0424'}
2025-02-20 12:23:18,811 - Scale_Sports
2025-02-20 12:23:18,811 - {'Epoch': 0, 'HR@5': '0.0426', 'NDCG@5': '0.0295', 'HR@10': '0.0626', 'NDCG@10': '0.0360', 'HR@20': '0.0883', 'NDCG@20': '0.0424'}
2025-02-20 12:40:08,180 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-20 12:40:10,945 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-20 12:40:10,950 - Total Parameters: 1329829
2025-02-20 12:40:54,326 - {'epoch': 0, 'rec_loss': '9.4026'}
2025-02-20 12:41:10,268 - {'Epoch': 0, 'HR@5': '0.0086', 'NDCG@5': '0.0056', 'HR@10': '0.0126', 'NDCG@10': '0.0069', 'HR@20': '0.0225', 'NDCG@20': '0.0093'}
2025-02-20 12:41:10,269 - Validation score increased.  Saving model ...
2025-02-20 12:41:52,075 - {'epoch': 1, 'rec_loss': '9.2186'}
2025-02-20 12:42:08,085 - {'Epoch': 1, 'HR@5': '0.0142', 'NDCG@5': '0.0091', 'HR@10': '0.0247', 'NDCG@10': '0.0125', 'HR@20': '0.0380', 'NDCG@20': '0.0158'}
2025-02-20 12:42:08,087 - Validation score increased.  Saving model ...
2025-02-20 12:42:48,323 - {'epoch': 2, 'rec_loss': '8.9637'}
2025-02-20 12:43:03,945 - {'Epoch': 2, 'HR@5': '0.0192', 'NDCG@5': '0.0122', 'HR@10': '0.0308', 'NDCG@10': '0.0159', 'HR@20': '0.0493', 'NDCG@20': '0.0205'}
2025-02-20 12:43:03,946 - Validation score increased.  Saving model ...
2025-02-20 12:43:45,058 - {'epoch': 3, 'rec_loss': '8.7822'}
2025-02-20 12:44:01,347 - {'Epoch': 3, 'HR@5': '0.0249', 'NDCG@5': '0.0161', 'HR@10': '0.0393', 'NDCG@10': '0.0207', 'HR@20': '0.0600', 'NDCG@20': '0.0259'}
2025-02-20 12:44:01,349 - Validation score increased.  Saving model ...
2025-02-20 12:44:42,446 - {'epoch': 4, 'rec_loss': '8.6269'}
2025-02-20 12:44:58,654 - {'Epoch': 4, 'HR@5': '0.0297', 'NDCG@5': '0.0195', 'HR@10': '0.0449', 'NDCG@10': '0.0244', 'HR@20': '0.0685', 'NDCG@20': '0.0303'}
2025-02-20 12:44:58,655 - Validation score increased.  Saving model ...
2025-02-20 12:45:41,428 - {'epoch': 5, 'rec_loss': '8.4974'}
2025-02-20 12:45:57,648 - {'Epoch': 5, 'HR@5': '0.0348', 'NDCG@5': '0.0235', 'HR@10': '0.0521', 'NDCG@10': '0.0290', 'HR@20': '0.0776', 'NDCG@20': '0.0354'}
2025-02-20 12:45:57,649 - Validation score increased.  Saving model ...
2025-02-20 12:46:37,961 - {'epoch': 6, 'rec_loss': '8.3973'}
2025-02-20 12:46:54,205 - {'Epoch': 6, 'HR@5': '0.0381', 'NDCG@5': '0.0259', 'HR@10': '0.0546', 'NDCG@10': '0.0312', 'HR@20': '0.0792', 'NDCG@20': '0.0374'}
2025-02-20 12:46:54,206 - Validation score increased.  Saving model ...
2025-02-20 12:47:35,428 - {'epoch': 7, 'rec_loss': '8.3123'}
2025-02-20 12:47:51,721 - {'Epoch': 7, 'HR@5': '0.0404', 'NDCG@5': '0.0275', 'HR@10': '0.0578', 'NDCG@10': '0.0331', 'HR@20': '0.0848', 'NDCG@20': '0.0399'}
2025-02-20 12:47:51,722 - Validation score increased.  Saving model ...
2025-02-20 12:48:33,502 - {'epoch': 8, 'rec_loss': '8.2387'}
2025-02-20 12:48:49,688 - {'Epoch': 8, 'HR@5': '0.0426', 'NDCG@5': '0.0291', 'HR@10': '0.0620', 'NDCG@10': '0.0353', 'HR@20': '0.0889', 'NDCG@20': '0.0421'}
2025-02-20 12:48:49,691 - Validation score increased.  Saving model ...
2025-02-20 12:49:30,620 - {'epoch': 9, 'rec_loss': '8.1821'}
2025-02-20 12:49:46,876 - {'Epoch': 9, 'HR@5': '0.0439', 'NDCG@5': '0.0305', 'HR@10': '0.0628', 'NDCG@10': '0.0366', 'HR@20': '0.0913', 'NDCG@20': '0.0438'}
2025-02-20 12:49:46,880 - Validation score increased.  Saving model ...
2025-02-20 12:50:27,957 - {'epoch': 10, 'rec_loss': '8.1309'}
2025-02-20 12:50:44,208 - {'Epoch': 10, 'HR@5': '0.0457', 'NDCG@5': '0.0313', 'HR@10': '0.0651', 'NDCG@10': '0.0376', 'HR@20': '0.0931', 'NDCG@20': '0.0446'}
2025-02-20 12:50:44,209 - Validation score increased.  Saving model ...
2025-02-20 12:51:25,344 - {'epoch': 11, 'rec_loss': '8.0837'}
2025-02-20 12:51:42,004 - {'Epoch': 11, 'HR@5': '0.0456', 'NDCG@5': '0.0320', 'HR@10': '0.0660', 'NDCG@10': '0.0385', 'HR@20': '0.0947', 'NDCG@20': '0.0457'}
2025-02-20 12:51:42,005 - Validation score increased.  Saving model ...
2025-02-20 12:52:22,851 - {'epoch': 12, 'rec_loss': '8.0436'}
2025-02-20 12:52:39,105 - {'Epoch': 12, 'HR@5': '0.0461', 'NDCG@5': '0.0319', 'HR@10': '0.0671', 'NDCG@10': '0.0387', 'HR@20': '0.0952', 'NDCG@20': '0.0457'}
2025-02-20 12:52:39,106 - Validation score increased.  Saving model ...
2025-02-20 12:53:18,495 - {'epoch': 13, 'rec_loss': '8.0088'}
2025-02-20 12:53:34,812 - {'Epoch': 13, 'HR@5': '0.0485', 'NDCG@5': '0.0337', 'HR@10': '0.0689', 'NDCG@10': '0.0402', 'HR@20': '0.0971', 'NDCG@20': '0.0473'}
2025-02-20 12:53:34,813 - Validation score increased.  Saving model ...
2025-02-20 12:54:15,790 - {'epoch': 14, 'rec_loss': '7.9736'}
2025-02-20 12:54:32,050 - {'Epoch': 14, 'HR@5': '0.0482', 'NDCG@5': '0.0328', 'HR@10': '0.0694', 'NDCG@10': '0.0396', 'HR@20': '0.0977', 'NDCG@20': '0.0467'}
2025-02-20 12:54:32,051 - EarlyStopping counter: 1 out of 10
2025-02-20 12:55:13,018 - {'epoch': 15, 'rec_loss': '7.9525'}
2025-02-20 12:55:29,666 - {'Epoch': 15, 'HR@5': '0.0479', 'NDCG@5': '0.0332', 'HR@10': '0.0697', 'NDCG@10': '0.0402', 'HR@20': '0.0988', 'NDCG@20': '0.0475'}
2025-02-20 12:55:29,668 - Validation score increased.  Saving model ...
2025-02-20 12:56:10,958 - {'epoch': 16, 'rec_loss': '7.9287'}
2025-02-20 12:56:27,931 - {'Epoch': 16, 'HR@5': '0.0479', 'NDCG@5': '0.0332', 'HR@10': '0.0700', 'NDCG@10': '0.0404', 'HR@20': '0.0999', 'NDCG@20': '0.0479'}
2025-02-20 12:56:27,932 - Validation score increased.  Saving model ...
2025-02-20 12:57:09,267 - {'epoch': 17, 'rec_loss': '7.8976'}
2025-02-20 12:57:25,680 - {'Epoch': 17, 'HR@5': '0.0486', 'NDCG@5': '0.0341', 'HR@10': '0.0713', 'NDCG@10': '0.0414', 'HR@20': '0.1001', 'NDCG@20': '0.0487'}
2025-02-20 12:57:25,683 - Validation score increased.  Saving model ...
2025-02-20 12:58:06,444 - {'epoch': 18, 'rec_loss': '7.8866'}
2025-02-20 12:58:23,049 - {'Epoch': 18, 'HR@5': '0.0499', 'NDCG@5': '0.0348', 'HR@10': '0.0716', 'NDCG@10': '0.0418', 'HR@20': '0.1007', 'NDCG@20': '0.0491'}
2025-02-20 12:58:23,050 - Validation score increased.  Saving model ...
2025-02-20 12:59:04,951 - {'epoch': 19, 'rec_loss': '7.8639'}
2025-02-20 12:59:21,653 - {'Epoch': 19, 'HR@5': '0.0495', 'NDCG@5': '0.0346', 'HR@10': '0.0718', 'NDCG@10': '0.0418', 'HR@20': '0.1008', 'NDCG@20': '0.0491'}
2025-02-20 12:59:21,654 - EarlyStopping counter: 1 out of 10
2025-02-20 13:00:05,726 - {'epoch': 20, 'rec_loss': '7.8482'}
2025-02-20 13:00:22,338 - {'Epoch': 20, 'HR@5': '0.0516', 'NDCG@5': '0.0362', 'HR@10': '0.0726', 'NDCG@10': '0.0429', 'HR@20': '0.1026', 'NDCG@20': '0.0505'}
2025-02-20 13:00:22,340 - Validation score increased.  Saving model ...
2025-02-20 13:01:04,104 - {'epoch': 21, 'rec_loss': '7.8330'}
2025-02-20 13:01:20,792 - {'Epoch': 21, 'HR@5': '0.0510', 'NDCG@5': '0.0355', 'HR@10': '0.0729', 'NDCG@10': '0.0425', 'HR@20': '0.1021', 'NDCG@20': '0.0499'}
2025-02-20 13:01:20,794 - EarlyStopping counter: 1 out of 10
2025-02-20 13:02:04,127 - {'epoch': 22, 'rec_loss': '7.8147'}
2025-02-20 13:02:20,958 - {'Epoch': 22, 'HR@5': '0.0513', 'NDCG@5': '0.0359', 'HR@10': '0.0724', 'NDCG@10': '0.0427', 'HR@20': '0.1031', 'NDCG@20': '0.0504'}
2025-02-20 13:02:20,960 - EarlyStopping counter: 2 out of 10
2025-02-20 13:03:03,484 - {'epoch': 23, 'rec_loss': '7.8031'}
2025-02-20 13:03:20,119 - {'Epoch': 23, 'HR@5': '0.0502', 'NDCG@5': '0.0351', 'HR@10': '0.0720', 'NDCG@10': '0.0421', 'HR@20': '0.1025', 'NDCG@20': '0.0498'}
2025-02-20 13:03:20,120 - EarlyStopping counter: 3 out of 10
2025-02-20 13:04:02,457 - {'epoch': 24, 'rec_loss': '7.7894'}
2025-02-20 13:04:19,197 - {'Epoch': 24, 'HR@5': '0.0519', 'NDCG@5': '0.0364', 'HR@10': '0.0722', 'NDCG@10': '0.0429', 'HR@20': '0.1028', 'NDCG@20': '0.0506'}
2025-02-20 13:04:19,202 - Validation score increased.  Saving model ...
2025-02-20 13:04:59,637 - {'epoch': 25, 'rec_loss': '7.7734'}
2025-02-20 13:05:16,263 - {'Epoch': 25, 'HR@5': '0.0521', 'NDCG@5': '0.0365', 'HR@10': '0.0731', 'NDCG@10': '0.0433', 'HR@20': '0.1032', 'NDCG@20': '0.0508'}
2025-02-20 13:05:16,264 - Validation score increased.  Saving model ...
2025-02-20 13:05:57,997 - {'epoch': 26, 'rec_loss': '7.7657'}
2025-02-20 13:06:14,766 - {'Epoch': 26, 'HR@5': '0.0522', 'NDCG@5': '0.0363', 'HR@10': '0.0736', 'NDCG@10': '0.0432', 'HR@20': '0.1032', 'NDCG@20': '0.0506'}
2025-02-20 13:06:14,767 - EarlyStopping counter: 1 out of 10
2025-02-20 13:06:57,085 - {'epoch': 27, 'rec_loss': '7.7540'}
2025-02-20 13:07:13,621 - {'Epoch': 27, 'HR@5': '0.0514', 'NDCG@5': '0.0363', 'HR@10': '0.0739', 'NDCG@10': '0.0435', 'HR@20': '0.1032', 'NDCG@20': '0.0508'}
2025-02-20 13:07:13,622 - EarlyStopping counter: 2 out of 10
2025-02-20 13:07:55,422 - {'epoch': 28, 'rec_loss': '7.7444'}
2025-02-20 13:08:12,277 - {'Epoch': 28, 'HR@5': '0.0519', 'NDCG@5': '0.0365', 'HR@10': '0.0726', 'NDCG@10': '0.0431', 'HR@20': '0.1041', 'NDCG@20': '0.0510'}
2025-02-20 13:08:12,278 - Validation score increased.  Saving model ...
2025-02-20 13:08:52,683 - {'epoch': 29, 'rec_loss': '7.7354'}
2025-02-20 13:09:09,098 - {'Epoch': 29, 'HR@5': '0.0509', 'NDCG@5': '0.0360', 'HR@10': '0.0730', 'NDCG@10': '0.0431', 'HR@20': '0.1036', 'NDCG@20': '0.0508'}
2025-02-20 13:09:09,100 - EarlyStopping counter: 1 out of 10
2025-02-20 13:09:49,911 - {'epoch': 30, 'rec_loss': '7.7258'}
2025-02-20 13:10:06,694 - {'Epoch': 30, 'HR@5': '0.0526', 'NDCG@5': '0.0364', 'HR@10': '0.0736', 'NDCG@10': '0.0431', 'HR@20': '0.1047', 'NDCG@20': '0.0509'}
2025-02-20 13:10:06,696 - EarlyStopping counter: 2 out of 10
2025-02-20 13:10:48,609 - {'epoch': 31, 'rec_loss': '7.7188'}
2025-02-20 13:11:06,149 - {'Epoch': 31, 'HR@5': '0.0514', 'NDCG@5': '0.0359', 'HR@10': '0.0733', 'NDCG@10': '0.0430', 'HR@20': '0.1038', 'NDCG@20': '0.0506'}
2025-02-20 13:11:06,151 - EarlyStopping counter: 3 out of 10
2025-02-20 13:11:47,292 - {'epoch': 32, 'rec_loss': '7.7075'}
2025-02-20 13:12:03,954 - {'Epoch': 32, 'HR@5': '0.0521', 'NDCG@5': '0.0365', 'HR@10': '0.0737', 'NDCG@10': '0.0435', 'HR@20': '0.1051', 'NDCG@20': '0.0514'}
2025-02-20 13:12:03,955 - Validation score increased.  Saving model ...
2025-02-20 13:12:44,832 - {'epoch': 33, 'rec_loss': '7.7051'}
2025-02-20 13:13:01,373 - {'Epoch': 33, 'HR@5': '0.0503', 'NDCG@5': '0.0358', 'HR@10': '0.0733', 'NDCG@10': '0.0431', 'HR@20': '0.1038', 'NDCG@20': '0.0508'}
2025-02-20 13:13:01,376 - EarlyStopping counter: 1 out of 10
2025-02-20 13:13:43,359 - {'epoch': 34, 'rec_loss': '7.6983'}
2025-02-20 13:14:00,100 - {'Epoch': 34, 'HR@5': '0.0514', 'NDCG@5': '0.0359', 'HR@10': '0.0744', 'NDCG@10': '0.0433', 'HR@20': '0.1055', 'NDCG@20': '0.0511'}
2025-02-20 13:14:00,101 - EarlyStopping counter: 2 out of 10
2025-02-20 13:14:39,660 - {'epoch': 35, 'rec_loss': '7.6859'}
2025-02-20 13:14:56,425 - {'Epoch': 35, 'HR@5': '0.0529', 'NDCG@5': '0.0367', 'HR@10': '0.0739', 'NDCG@10': '0.0435', 'HR@20': '0.1042', 'NDCG@20': '0.0511'}
2025-02-20 13:14:56,426 - EarlyStopping counter: 3 out of 10
2025-02-20 13:15:37,629 - {'epoch': 36, 'rec_loss': '7.6785'}
2025-02-20 13:15:54,420 - {'Epoch': 36, 'HR@5': '0.0527', 'NDCG@5': '0.0365', 'HR@10': '0.0752', 'NDCG@10': '0.0438', 'HR@20': '0.1050', 'NDCG@20': '0.0512'}
2025-02-20 13:15:54,423 - EarlyStopping counter: 4 out of 10
2025-02-20 13:16:35,224 - {'epoch': 37, 'rec_loss': '7.6694'}
2025-02-20 13:16:51,750 - {'Epoch': 37, 'HR@5': '0.0521', 'NDCG@5': '0.0362', 'HR@10': '0.0735', 'NDCG@10': '0.0431', 'HR@20': '0.1046', 'NDCG@20': '0.0510'}
2025-02-20 13:16:51,751 - EarlyStopping counter: 5 out of 10
2025-02-20 13:17:33,011 - {'epoch': 38, 'rec_loss': '7.6754'}
2025-02-20 13:17:49,961 - {'Epoch': 38, 'HR@5': '0.0524', 'NDCG@5': '0.0366', 'HR@10': '0.0745', 'NDCG@10': '0.0437', 'HR@20': '0.1049', 'NDCG@20': '0.0513'}
2025-02-20 13:17:49,962 - EarlyStopping counter: 6 out of 10
2025-02-20 13:18:30,889 - {'epoch': 39, 'rec_loss': '7.6587'}
2025-02-20 13:18:47,759 - {'Epoch': 39, 'HR@5': '0.0529', 'NDCG@5': '0.0367', 'HR@10': '0.0746', 'NDCG@10': '0.0436', 'HR@20': '0.1055', 'NDCG@20': '0.0514'}
2025-02-20 13:18:47,760 - Validation score increased.  Saving model ...
2025-02-20 13:19:28,721 - {'epoch': 40, 'rec_loss': '7.6511'}
2025-02-20 13:19:45,508 - {'Epoch': 40, 'HR@5': '0.0526', 'NDCG@5': '0.0370', 'HR@10': '0.0739', 'NDCG@10': '0.0439', 'HR@20': '0.1056', 'NDCG@20': '0.0518'}
2025-02-20 13:19:45,509 - Validation score increased.  Saving model ...
2025-02-20 13:20:26,323 - {'epoch': 41, 'rec_loss': '7.6432'}
2025-02-20 13:20:42,834 - {'Epoch': 41, 'HR@5': '0.0526', 'NDCG@5': '0.0369', 'HR@10': '0.0737', 'NDCG@10': '0.0437', 'HR@20': '0.1060', 'NDCG@20': '0.0518'}
2025-02-20 13:20:42,835 - EarlyStopping counter: 1 out of 10
2025-02-20 13:21:23,327 - {'epoch': 42, 'rec_loss': '7.6433'}
2025-02-20 13:21:39,989 - {'Epoch': 42, 'HR@5': '0.0520', 'NDCG@5': '0.0368', 'HR@10': '0.0747', 'NDCG@10': '0.0441', 'HR@20': '0.1049', 'NDCG@20': '0.0517'}
2025-02-20 13:21:39,990 - EarlyStopping counter: 2 out of 10
2025-02-20 13:22:21,027 - {'epoch': 43, 'rec_loss': '7.6405'}
2025-02-20 13:22:37,753 - {'Epoch': 43, 'HR@5': '0.0528', 'NDCG@5': '0.0369', 'HR@10': '0.0743', 'NDCG@10': '0.0438', 'HR@20': '0.1052', 'NDCG@20': '0.0516'}
2025-02-20 13:22:37,754 - EarlyStopping counter: 3 out of 10
2025-02-20 13:23:18,138 - {'epoch': 44, 'rec_loss': '7.6311'}
2025-02-20 13:23:35,004 - {'Epoch': 44, 'HR@5': '0.0532', 'NDCG@5': '0.0370', 'HR@10': '0.0754', 'NDCG@10': '0.0442', 'HR@20': '0.1063', 'NDCG@20': '0.0519'}
2025-02-20 13:23:35,005 - Validation score increased.  Saving model ...
2025-02-20 13:24:15,248 - {'epoch': 45, 'rec_loss': '7.6301'}
2025-02-20 13:24:32,095 - {'Epoch': 45, 'HR@5': '0.0530', 'NDCG@5': '0.0370', 'HR@10': '0.0736', 'NDCG@10': '0.0436', 'HR@20': '0.1049', 'NDCG@20': '0.0515'}
2025-02-20 13:24:32,096 - EarlyStopping counter: 1 out of 10
2025-02-20 13:25:12,974 - {'epoch': 46, 'rec_loss': '7.6260'}
2025-02-20 13:25:30,608 - {'Epoch': 46, 'HR@5': '0.0530', 'NDCG@5': '0.0373', 'HR@10': '0.0743', 'NDCG@10': '0.0441', 'HR@20': '0.1043', 'NDCG@20': '0.0517'}
2025-02-20 13:25:30,609 - EarlyStopping counter: 2 out of 10
2025-02-20 13:26:11,812 - {'epoch': 47, 'rec_loss': '7.6125'}
2025-02-20 13:26:28,535 - {'Epoch': 47, 'HR@5': '0.0519', 'NDCG@5': '0.0366', 'HR@10': '0.0745', 'NDCG@10': '0.0438', 'HR@20': '0.1056', 'NDCG@20': '0.0516'}
2025-02-20 13:26:28,536 - EarlyStopping counter: 3 out of 10
2025-02-20 13:27:09,353 - {'epoch': 48, 'rec_loss': '7.6167'}
2025-02-20 13:27:26,116 - {'Epoch': 48, 'HR@5': '0.0526', 'NDCG@5': '0.0366', 'HR@10': '0.0749', 'NDCG@10': '0.0438', 'HR@20': '0.1061', 'NDCG@20': '0.0517'}
2025-02-20 13:27:26,117 - EarlyStopping counter: 4 out of 10
2025-02-20 13:28:06,820 - {'epoch': 49, 'rec_loss': '7.6124'}
2025-02-20 13:28:23,779 - {'Epoch': 49, 'HR@5': '0.0527', 'NDCG@5': '0.0369', 'HR@10': '0.0748', 'NDCG@10': '0.0440', 'HR@20': '0.1047', 'NDCG@20': '0.0516'}
2025-02-20 13:28:23,780 - EarlyStopping counter: 5 out of 10
2025-02-20 13:29:04,084 - {'epoch': 50, 'rec_loss': '7.6092'}
2025-02-20 13:29:20,634 - {'Epoch': 50, 'HR@5': '0.0529', 'NDCG@5': '0.0368', 'HR@10': '0.0749', 'NDCG@10': '0.0438', 'HR@20': '0.1049', 'NDCG@20': '0.0514'}
2025-02-20 13:29:20,635 - EarlyStopping counter: 6 out of 10
2025-02-20 13:30:01,092 - {'epoch': 51, 'rec_loss': '7.5984'}
2025-02-20 13:30:17,950 - {'Epoch': 51, 'HR@5': '0.0525', 'NDCG@5': '0.0368', 'HR@10': '0.0754', 'NDCG@10': '0.0441', 'HR@20': '0.1057', 'NDCG@20': '0.0517'}
2025-02-20 13:30:17,951 - EarlyStopping counter: 7 out of 10
2025-02-20 13:30:58,333 - {'epoch': 52, 'rec_loss': '7.5991'}
2025-02-20 13:31:15,081 - {'Epoch': 52, 'HR@5': '0.0527', 'NDCG@5': '0.0366', 'HR@10': '0.0749', 'NDCG@10': '0.0438', 'HR@20': '0.1053', 'NDCG@20': '0.0514'}
2025-02-20 13:31:15,082 - EarlyStopping counter: 8 out of 10
2025-02-20 13:31:56,578 - {'epoch': 53, 'rec_loss': '7.5996'}
2025-02-20 13:32:13,361 - {'Epoch': 53, 'HR@5': '0.0529', 'NDCG@5': '0.0369', 'HR@10': '0.0745', 'NDCG@10': '0.0439', 'HR@20': '0.1061', 'NDCG@20': '0.0518'}
2025-02-20 13:32:13,362 - EarlyStopping counter: 9 out of 10
2025-02-20 13:32:53,624 - {'epoch': 54, 'rec_loss': '7.5896'}
2025-02-20 13:33:10,436 - {'Epoch': 54, 'HR@5': '0.0524', 'NDCG@5': '0.0369', 'HR@10': '0.0741', 'NDCG@10': '0.0439', 'HR@20': '0.1057', 'NDCG@20': '0.0518'}
2025-02-20 13:33:10,440 - EarlyStopping counter: 10 out of 10
2025-02-20 13:33:10,440 - Early stopping
2025-02-20 13:33:10,440 - ---------------Test Score---------------
2025-02-20 13:33:27,223 - {'Epoch': 0, 'HR@5': '0.0431', 'NDCG@5': '0.0300', 'HR@10': '0.0619', 'NDCG@10': '0.0361', 'HR@20': '0.0874', 'NDCG@20': '0.0426'}
2025-02-20 13:33:27,224 - Scale_Sports
2025-02-20 13:33:27,224 - {'Epoch': 0, 'HR@5': '0.0431', 'NDCG@5': '0.0300', 'HR@10': '0.0619', 'NDCG@10': '0.0361', 'HR@20': '0.0874', 'NDCG@20': '0.0426'}
2025-02-20 14:06:15,728 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], start_prob=0.3, end_prob=0.7, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-20 14:06:18,499 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-20 14:06:18,504 - Total Parameters: 1329829
2025-02-20 14:07:00,964 - {'epoch': 0, 'rec_loss': '9.4029'}
2025-02-20 14:07:17,608 - {'Epoch': 0, 'HR@5': '0.0085', 'NDCG@5': '0.0056', 'HR@10': '0.0124', 'NDCG@10': '0.0068', 'HR@20': '0.0221', 'NDCG@20': '0.0092'}
2025-02-20 14:07:17,609 - Validation score increased.  Saving model ...
2025-02-20 14:08:03,800 - {'epoch': 1, 'rec_loss': '9.2330'}
2025-02-20 14:08:19,364 - {'Epoch': 1, 'HR@5': '0.0127', 'NDCG@5': '0.0082', 'HR@10': '0.0226', 'NDCG@10': '0.0114', 'HR@20': '0.0360', 'NDCG@20': '0.0147'}
2025-02-20 14:08:19,365 - Validation score increased.  Saving model ...
2025-02-20 14:08:59,174 - {'epoch': 2, 'rec_loss': '8.9919'}
2025-02-20 14:09:14,591 - {'Epoch': 2, 'HR@5': '0.0183', 'NDCG@5': '0.0116', 'HR@10': '0.0292', 'NDCG@10': '0.0152', 'HR@20': '0.0481', 'NDCG@20': '0.0199'}
2025-02-20 14:09:14,592 - Validation score increased.  Saving model ...
2025-02-20 14:09:55,694 - {'epoch': 3, 'rec_loss': '8.8176'}
2025-02-20 14:10:11,176 - {'Epoch': 3, 'HR@5': '0.0228', 'NDCG@5': '0.0147', 'HR@10': '0.0360', 'NDCG@10': '0.0189', 'HR@20': '0.0572', 'NDCG@20': '0.0243'}
2025-02-20 14:10:11,177 - Validation score increased.  Saving model ...
2025-02-20 14:10:53,055 - {'epoch': 4, 'rec_loss': '8.6756'}
2025-02-20 14:11:08,817 - {'Epoch': 4, 'HR@5': '0.0276', 'NDCG@5': '0.0178', 'HR@10': '0.0428', 'NDCG@10': '0.0227', 'HR@20': '0.0665', 'NDCG@20': '0.0286'}
2025-02-20 14:11:08,818 - Validation score increased.  Saving model ...
2025-02-20 14:11:48,553 - {'epoch': 5, 'rec_loss': '8.5542'}
2025-02-20 14:12:04,320 - {'Epoch': 5, 'HR@5': '0.0335', 'NDCG@5': '0.0223', 'HR@10': '0.0501', 'NDCG@10': '0.0276', 'HR@20': '0.0742', 'NDCG@20': '0.0337'}
2025-02-20 14:12:04,321 - Validation score increased.  Saving model ...
2025-02-20 14:12:44,572 - {'epoch': 6, 'rec_loss': '8.4589'}
2025-02-20 14:13:00,339 - {'Epoch': 6, 'HR@5': '0.0357', 'NDCG@5': '0.0242', 'HR@10': '0.0525', 'NDCG@10': '0.0296', 'HR@20': '0.0784', 'NDCG@20': '0.0361'}
2025-02-20 14:13:00,340 - Validation score increased.  Saving model ...
2025-02-20 14:13:43,682 - {'epoch': 7, 'rec_loss': '8.3760'}
2025-02-20 14:13:59,831 - {'Epoch': 7, 'HR@5': '0.0383', 'NDCG@5': '0.0259', 'HR@10': '0.0560', 'NDCG@10': '0.0316', 'HR@20': '0.0816', 'NDCG@20': '0.0380'}
2025-02-20 14:13:59,832 - Validation score increased.  Saving model ...
2025-02-20 14:14:49,587 - {'epoch': 8, 'rec_loss': '8.3060'}
2025-02-20 14:15:05,386 - {'Epoch': 8, 'HR@5': '0.0408', 'NDCG@5': '0.0276', 'HR@10': '0.0601', 'NDCG@10': '0.0338', 'HR@20': '0.0862', 'NDCG@20': '0.0404'}
2025-02-20 14:15:05,388 - Validation score increased.  Saving model ...
2025-02-20 14:15:46,907 - {'epoch': 9, 'rec_loss': '8.2512'}
2025-02-20 14:16:02,774 - {'Epoch': 9, 'HR@5': '0.0431', 'NDCG@5': '0.0294', 'HR@10': '0.0615', 'NDCG@10': '0.0353', 'HR@20': '0.0888', 'NDCG@20': '0.0421'}
2025-02-20 14:16:02,775 - Validation score increased.  Saving model ...
2025-02-20 14:16:42,937 - {'epoch': 10, 'rec_loss': '8.2003'}
2025-02-20 14:16:58,768 - {'Epoch': 10, 'HR@5': '0.0447', 'NDCG@5': '0.0305', 'HR@10': '0.0635', 'NDCG@10': '0.0365', 'HR@20': '0.0912', 'NDCG@20': '0.0434'}
2025-02-20 14:16:58,769 - Validation score increased.  Saving model ...
2025-02-20 14:17:39,697 - {'epoch': 11, 'rec_loss': '8.1544'}
2025-02-20 14:17:55,880 - {'Epoch': 11, 'HR@5': '0.0455', 'NDCG@5': '0.0314', 'HR@10': '0.0646', 'NDCG@10': '0.0375', 'HR@20': '0.0916', 'NDCG@20': '0.0443'}
2025-02-20 14:17:55,881 - Validation score increased.  Saving model ...
2025-02-20 14:18:35,082 - {'epoch': 12, 'rec_loss': '8.1150'}
2025-02-20 14:18:51,128 - {'Epoch': 12, 'HR@5': '0.0452', 'NDCG@5': '0.0313', 'HR@10': '0.0651', 'NDCG@10': '0.0377', 'HR@20': '0.0935', 'NDCG@20': '0.0449'}
2025-02-20 14:18:51,130 - Validation score increased.  Saving model ...
2025-02-20 14:19:32,054 - {'epoch': 13, 'rec_loss': '8.0798'}
2025-02-20 14:19:48,159 - {'Epoch': 13, 'HR@5': '0.0470', 'NDCG@5': '0.0324', 'HR@10': '0.0677', 'NDCG@10': '0.0390', 'HR@20': '0.0955', 'NDCG@20': '0.0460'}
2025-02-20 14:19:48,160 - Validation score increased.  Saving model ...
2025-02-20 14:20:29,551 - {'epoch': 14, 'rec_loss': '8.0446'}
2025-02-20 14:20:45,714 - {'Epoch': 14, 'HR@5': '0.0469', 'NDCG@5': '0.0320', 'HR@10': '0.0672', 'NDCG@10': '0.0386', 'HR@20': '0.0971', 'NDCG@20': '0.0461'}
2025-02-20 14:20:45,715 - Validation score increased.  Saving model ...
2025-02-20 14:21:25,654 - {'epoch': 15, 'rec_loss': '8.0218'}
2025-02-20 14:21:41,710 - {'Epoch': 15, 'HR@5': '0.0478', 'NDCG@5': '0.0331', 'HR@10': '0.0686', 'NDCG@10': '0.0398', 'HR@20': '0.0978', 'NDCG@20': '0.0472'}
2025-02-20 14:21:41,711 - Validation score increased.  Saving model ...
2025-02-20 14:22:21,614 - {'epoch': 16, 'rec_loss': '7.9972'}
2025-02-20 14:22:37,953 - {'Epoch': 16, 'HR@5': '0.0471', 'NDCG@5': '0.0330', 'HR@10': '0.0685', 'NDCG@10': '0.0399', 'HR@20': '0.0989', 'NDCG@20': '0.0475'}
2025-02-20 14:22:37,955 - Validation score increased.  Saving model ...
2025-02-20 14:23:18,843 - {'epoch': 17, 'rec_loss': '7.9698'}
2025-02-20 14:23:34,771 - {'Epoch': 17, 'HR@5': '0.0477', 'NDCG@5': '0.0332', 'HR@10': '0.0688', 'NDCG@10': '0.0400', 'HR@20': '0.0992', 'NDCG@20': '0.0476'}
2025-02-20 14:23:34,772 - Validation score increased.  Saving model ...
2025-02-20 14:24:16,298 - {'epoch': 18, 'rec_loss': '7.9552'}
2025-02-20 14:24:32,519 - {'Epoch': 18, 'HR@5': '0.0496', 'NDCG@5': '0.0341', 'HR@10': '0.0701', 'NDCG@10': '0.0407', 'HR@20': '0.0994', 'NDCG@20': '0.0481'}
2025-02-20 14:24:32,520 - Validation score increased.  Saving model ...
2025-02-20 14:25:13,151 - {'epoch': 19, 'rec_loss': '7.9323'}
2025-02-20 14:25:29,336 - {'Epoch': 19, 'HR@5': '0.0490', 'NDCG@5': '0.0338', 'HR@10': '0.0698', 'NDCG@10': '0.0405', 'HR@20': '0.0989', 'NDCG@20': '0.0478'}
2025-02-20 14:25:29,337 - EarlyStopping counter: 1 out of 10
2025-02-20 14:26:10,314 - {'epoch': 20, 'rec_loss': '7.9149'}
2025-02-20 14:26:26,472 - {'Epoch': 20, 'HR@5': '0.0500', 'NDCG@5': '0.0345', 'HR@10': '0.0710', 'NDCG@10': '0.0413', 'HR@20': '0.1018', 'NDCG@20': '0.0490'}
2025-02-20 14:26:26,473 - Validation score increased.  Saving model ...
2025-02-20 14:27:07,729 - {'epoch': 21, 'rec_loss': '7.9045'}
2025-02-20 14:27:24,767 - {'Epoch': 21, 'HR@5': '0.0493', 'NDCG@5': '0.0342', 'HR@10': '0.0714', 'NDCG@10': '0.0413', 'HR@20': '0.1016', 'NDCG@20': '0.0489'}
2025-02-20 14:27:24,768 - EarlyStopping counter: 1 out of 10
2025-02-20 14:28:08,061 - {'epoch': 22, 'rec_loss': '7.8803'}
2025-02-20 14:28:24,362 - {'Epoch': 22, 'HR@5': '0.0496', 'NDCG@5': '0.0347', 'HR@10': '0.0714', 'NDCG@10': '0.0417', 'HR@20': '0.1013', 'NDCG@20': '0.0492'}
2025-02-20 14:28:24,363 - Validation score increased.  Saving model ...
2025-02-20 14:29:06,438 - {'epoch': 23, 'rec_loss': '7.8679'}
2025-02-20 14:29:22,690 - {'Epoch': 23, 'HR@5': '0.0498', 'NDCG@5': '0.0347', 'HR@10': '0.0715', 'NDCG@10': '0.0417', 'HR@20': '0.1016', 'NDCG@20': '0.0493'}
2025-02-20 14:29:22,691 - Validation score increased.  Saving model ...
2025-02-20 14:30:03,484 - {'epoch': 24, 'rec_loss': '7.8575'}
2025-02-20 14:30:19,885 - {'Epoch': 24, 'HR@5': '0.0505', 'NDCG@5': '0.0353', 'HR@10': '0.0717', 'NDCG@10': '0.0422', 'HR@20': '0.1028', 'NDCG@20': '0.0500'}
2025-02-20 14:30:19,886 - Validation score increased.  Saving model ...
2025-02-20 14:30:59,398 - {'epoch': 25, 'rec_loss': '7.8424'}
2025-02-20 14:31:15,681 - {'Epoch': 25, 'HR@5': '0.0508', 'NDCG@5': '0.0356', 'HR@10': '0.0737', 'NDCG@10': '0.0429', 'HR@20': '0.1021', 'NDCG@20': '0.0500'}
2025-02-20 14:31:15,683 - Validation score increased.  Saving model ...
2025-02-20 14:31:56,099 - {'epoch': 26, 'rec_loss': '7.8325'}
2025-02-20 14:32:12,495 - {'Epoch': 26, 'HR@5': '0.0508', 'NDCG@5': '0.0354', 'HR@10': '0.0731', 'NDCG@10': '0.0426', 'HR@20': '0.1029', 'NDCG@20': '0.0501'}
2025-02-20 14:32:12,496 - Validation score increased.  Saving model ...
2025-02-20 14:32:53,899 - {'epoch': 27, 'rec_loss': '7.8173'}
2025-02-20 14:33:10,412 - {'Epoch': 27, 'HR@5': '0.0512', 'NDCG@5': '0.0361', 'HR@10': '0.0735', 'NDCG@10': '0.0432', 'HR@20': '0.1023', 'NDCG@20': '0.0505'}
2025-02-20 14:33:10,413 - Validation score increased.  Saving model ...
2025-02-20 14:33:50,921 - {'epoch': 28, 'rec_loss': '7.8100'}
2025-02-20 14:34:07,187 - {'Epoch': 28, 'HR@5': '0.0511', 'NDCG@5': '0.0357', 'HR@10': '0.0729', 'NDCG@10': '0.0427', 'HR@20': '0.1033', 'NDCG@20': '0.0503'}
2025-02-20 14:34:07,188 - EarlyStopping counter: 1 out of 10
2025-02-20 14:34:47,999 - {'epoch': 29, 'rec_loss': '7.7982'}
2025-02-20 14:35:04,257 - {'Epoch': 29, 'HR@5': '0.0507', 'NDCG@5': '0.0356', 'HR@10': '0.0720', 'NDCG@10': '0.0425', 'HR@20': '0.1034', 'NDCG@20': '0.0504'}
2025-02-20 14:35:04,259 - EarlyStopping counter: 2 out of 10
2025-02-20 14:35:45,852 - {'epoch': 30, 'rec_loss': '7.7907'}
2025-02-20 14:36:02,641 - {'Epoch': 30, 'HR@5': '0.0502', 'NDCG@5': '0.0352', 'HR@10': '0.0730', 'NDCG@10': '0.0425', 'HR@20': '0.1040', 'NDCG@20': '0.0503'}
2025-02-20 14:36:02,642 - EarlyStopping counter: 3 out of 10
2025-02-20 14:36:44,274 - {'epoch': 31, 'rec_loss': '7.7844'}
2025-02-20 14:37:00,621 - {'Epoch': 31, 'HR@5': '0.0503', 'NDCG@5': '0.0353', 'HR@10': '0.0727', 'NDCG@10': '0.0425', 'HR@20': '0.1035', 'NDCG@20': '0.0503'}
2025-02-20 14:37:00,622 - EarlyStopping counter: 4 out of 10
2025-02-20 14:37:40,404 - {'epoch': 32, 'rec_loss': '7.7738'}
2025-02-20 14:37:57,402 - {'Epoch': 32, 'HR@5': '0.0509', 'NDCG@5': '0.0355', 'HR@10': '0.0734', 'NDCG@10': '0.0428', 'HR@20': '0.1043', 'NDCG@20': '0.0505'}
2025-02-20 14:37:57,403 - Validation score increased.  Saving model ...
2025-02-20 14:38:39,696 - {'epoch': 33, 'rec_loss': '7.7646'}
2025-02-20 14:38:56,039 - {'Epoch': 33, 'HR@5': '0.0509', 'NDCG@5': '0.0358', 'HR@10': '0.0717', 'NDCG@10': '0.0425', 'HR@20': '0.1031', 'NDCG@20': '0.0504'}
2025-02-20 14:38:56,040 - EarlyStopping counter: 1 out of 10
2025-02-20 14:39:36,765 - {'epoch': 34, 'rec_loss': '7.7573'}
2025-02-20 14:39:52,950 - {'Epoch': 34, 'HR@5': '0.0505', 'NDCG@5': '0.0355', 'HR@10': '0.0739', 'NDCG@10': '0.0430', 'HR@20': '0.1037', 'NDCG@20': '0.0505'}
2025-02-20 14:39:52,951 - Validation score increased.  Saving model ...
2025-02-20 14:40:34,496 - {'epoch': 35, 'rec_loss': '7.7465'}
2025-02-20 14:40:50,886 - {'Epoch': 35, 'HR@5': '0.0516', 'NDCG@5': '0.0361', 'HR@10': '0.0735', 'NDCG@10': '0.0431', 'HR@20': '0.1035', 'NDCG@20': '0.0507'}
2025-02-20 14:40:50,887 - Validation score increased.  Saving model ...
2025-02-20 14:41:35,625 - {'epoch': 36, 'rec_loss': '7.7390'}
2025-02-20 14:41:52,404 - {'Epoch': 36, 'HR@5': '0.0514', 'NDCG@5': '0.0357', 'HR@10': '0.0739', 'NDCG@10': '0.0429', 'HR@20': '0.1035', 'NDCG@20': '0.0503'}
2025-02-20 14:41:52,405 - EarlyStopping counter: 1 out of 10
2025-02-20 14:42:33,403 - {'epoch': 37, 'rec_loss': '7.7296'}
2025-02-20 14:42:49,812 - {'Epoch': 37, 'HR@5': '0.0510', 'NDCG@5': '0.0354', 'HR@10': '0.0729', 'NDCG@10': '0.0425', 'HR@20': '0.1042', 'NDCG@20': '0.0504'}
2025-02-20 14:42:49,813 - EarlyStopping counter: 2 out of 10
2025-02-20 14:43:30,891 - {'epoch': 38, 'rec_loss': '7.7336'}
2025-02-20 14:43:47,311 - {'Epoch': 38, 'HR@5': '0.0509', 'NDCG@5': '0.0357', 'HR@10': '0.0736', 'NDCG@10': '0.0430', 'HR@20': '0.1035', 'NDCG@20': '0.0505'}
2025-02-20 14:43:47,312 - EarlyStopping counter: 3 out of 10
2025-02-20 14:44:28,875 - {'epoch': 39, 'rec_loss': '7.7215'}
2025-02-20 14:44:45,287 - {'Epoch': 39, 'HR@5': '0.0516', 'NDCG@5': '0.0359', 'HR@10': '0.0734', 'NDCG@10': '0.0430', 'HR@20': '0.1057', 'NDCG@20': '0.0511'}
2025-02-20 14:44:45,288 - Validation score increased.  Saving model ...
2025-02-20 14:45:25,442 - {'epoch': 40, 'rec_loss': '7.7119'}
2025-02-20 14:45:42,019 - {'Epoch': 40, 'HR@5': '0.0512', 'NDCG@5': '0.0359', 'HR@10': '0.0732', 'NDCG@10': '0.0430', 'HR@20': '0.1037', 'NDCG@20': '0.0507'}
2025-02-20 14:45:42,020 - EarlyStopping counter: 1 out of 10
2025-02-20 14:46:23,464 - {'epoch': 41, 'rec_loss': '7.7013'}
2025-02-20 14:46:39,800 - {'Epoch': 41, 'HR@5': '0.0513', 'NDCG@5': '0.0360', 'HR@10': '0.0738', 'NDCG@10': '0.0433', 'HR@20': '0.1048', 'NDCG@20': '0.0511'}
2025-02-20 14:46:39,801 - EarlyStopping counter: 2 out of 10
2025-02-20 14:47:20,053 - {'epoch': 42, 'rec_loss': '7.7025'}
2025-02-20 14:47:36,642 - {'Epoch': 42, 'HR@5': '0.0521', 'NDCG@5': '0.0361', 'HR@10': '0.0742', 'NDCG@10': '0.0433', 'HR@20': '0.1041', 'NDCG@20': '0.0508'}
2025-02-20 14:47:36,644 - EarlyStopping counter: 3 out of 10
2025-02-20 14:48:17,680 - {'epoch': 43, 'rec_loss': '7.6957'}
2025-02-20 14:48:34,145 - {'Epoch': 43, 'HR@5': '0.0516', 'NDCG@5': '0.0359', 'HR@10': '0.0733', 'NDCG@10': '0.0429', 'HR@20': '0.1041', 'NDCG@20': '0.0506'}
2025-02-20 14:48:34,146 - EarlyStopping counter: 4 out of 10
2025-02-20 14:49:12,574 - {'epoch': 44, 'rec_loss': '7.6914'}
2025-02-20 14:49:29,067 - {'Epoch': 44, 'HR@5': '0.0521', 'NDCG@5': '0.0359', 'HR@10': '0.0748', 'NDCG@10': '0.0432', 'HR@20': '0.1050', 'NDCG@20': '0.0508'}
2025-02-20 14:49:29,069 - EarlyStopping counter: 5 out of 10
2025-02-20 14:50:10,641 - {'epoch': 45, 'rec_loss': '7.6866'}
2025-02-20 14:50:27,261 - {'Epoch': 45, 'HR@5': '0.0517', 'NDCG@5': '0.0356', 'HR@10': '0.0731', 'NDCG@10': '0.0425', 'HR@20': '0.1036', 'NDCG@20': '0.0502'}
2025-02-20 14:50:27,262 - EarlyStopping counter: 6 out of 10
2025-02-20 14:51:08,396 - {'epoch': 46, 'rec_loss': '7.6844'}
2025-02-20 14:51:24,964 - {'Epoch': 46, 'HR@5': '0.0524', 'NDCG@5': '0.0363', 'HR@10': '0.0740', 'NDCG@10': '0.0433', 'HR@20': '0.1036', 'NDCG@20': '0.0507'}
2025-02-20 14:51:24,965 - EarlyStopping counter: 7 out of 10
2025-02-20 14:52:06,265 - {'epoch': 47, 'rec_loss': '7.6708'}
2025-02-20 14:52:22,613 - {'Epoch': 47, 'HR@5': '0.0513', 'NDCG@5': '0.0359', 'HR@10': '0.0735', 'NDCG@10': '0.0430', 'HR@20': '0.1047', 'NDCG@20': '0.0509'}
2025-02-20 14:52:22,614 - EarlyStopping counter: 8 out of 10
2025-02-20 14:53:02,733 - {'epoch': 48, 'rec_loss': '7.6696'}
2025-02-20 14:53:19,358 - {'Epoch': 48, 'HR@5': '0.0518', 'NDCG@5': '0.0361', 'HR@10': '0.0742', 'NDCG@10': '0.0432', 'HR@20': '0.1047', 'NDCG@20': '0.0509'}
2025-02-20 14:53:19,359 - EarlyStopping counter: 9 out of 10
2025-02-20 14:53:58,791 - {'epoch': 49, 'rec_loss': '7.6714'}
2025-02-20 14:54:15,577 - {'Epoch': 49, 'HR@5': '0.0522', 'NDCG@5': '0.0364', 'HR@10': '0.0732', 'NDCG@10': '0.0432', 'HR@20': '0.1037', 'NDCG@20': '0.0509'}
2025-02-20 14:54:15,578 - EarlyStopping counter: 10 out of 10
2025-02-20 14:54:15,579 - Early stopping
2025-02-20 14:54:15,579 - ---------------Test Score---------------
2025-02-20 14:54:32,143 - {'Epoch': 0, 'HR@5': '0.0425', 'NDCG@5': '0.0296', 'HR@10': '0.0617', 'NDCG@10': '0.0357', 'HR@20': '0.0867', 'NDCG@20': '0.0420'}
2025-02-20 14:54:32,144 - Scale_Sports
2025-02-20 14:54:32,144 - {'Epoch': 0, 'HR@5': '0.0425', 'NDCG@5': '0.0296', 'HR@10': '0.0617', 'NDCG@10': '0.0357', 'HR@20': '0.0867', 'NDCG@20': '0.0420'}
2025-02-20 15:28:46,629 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25, 10], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-20 15:28:49,390 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-20 15:28:49,395 - Total Parameters: 1328854
2025-02-20 15:29:41,265 - {'epoch': 0, 'rec_loss': '9.4099'}
2025-02-20 15:29:59,187 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0053', 'HR@10': '0.0133', 'NDCG@10': '0.0069', 'HR@20': '0.0215', 'NDCG@20': '0.0090'}
2025-02-20 15:29:59,191 - Validation score increased.  Saving model ...
2025-02-20 15:30:48,932 - {'epoch': 1, 'rec_loss': '9.1772'}
2025-02-20 15:31:05,429 - {'Epoch': 1, 'HR@5': '0.0157', 'NDCG@5': '0.0101', 'HR@10': '0.0264', 'NDCG@10': '0.0135', 'HR@20': '0.0431', 'NDCG@20': '0.0177'}
2025-02-20 15:31:05,431 - Validation score increased.  Saving model ...
2025-02-20 15:31:57,543 - {'epoch': 2, 'rec_loss': '8.8604'}
2025-02-20 15:32:14,555 - {'Epoch': 2, 'HR@5': '0.0222', 'NDCG@5': '0.0143', 'HR@10': '0.0364', 'NDCG@10': '0.0189', 'HR@20': '0.0566', 'NDCG@20': '0.0239'}
2025-02-20 15:32:14,556 - Validation score increased.  Saving model ...
2025-02-20 15:33:07,953 - {'epoch': 3, 'rec_loss': '8.6471'}
2025-02-20 15:33:24,998 - {'Epoch': 3, 'HR@5': '0.0305', 'NDCG@5': '0.0199', 'HR@10': '0.0472', 'NDCG@10': '0.0253', 'HR@20': '0.0693', 'NDCG@20': '0.0308'}
2025-02-20 15:33:25,004 - Validation score increased.  Saving model ...
2025-02-20 15:34:15,710 - {'epoch': 4, 'rec_loss': '8.4711'}
2025-02-20 15:34:32,973 - {'Epoch': 4, 'HR@5': '0.0370', 'NDCG@5': '0.0253', 'HR@10': '0.0545', 'NDCG@10': '0.0309', 'HR@20': '0.0799', 'NDCG@20': '0.0373'}
2025-02-20 15:34:32,974 - Validation score increased.  Saving model ...
2025-02-20 15:35:26,526 - {'epoch': 5, 'rec_loss': '8.3365'}
2025-02-20 15:35:43,657 - {'Epoch': 5, 'HR@5': '0.0411', 'NDCG@5': '0.0278', 'HR@10': '0.0576', 'NDCG@10': '0.0331', 'HR@20': '0.0860', 'NDCG@20': '0.0402'}
2025-02-20 15:35:43,665 - Validation score increased.  Saving model ...
2025-02-20 15:36:37,508 - {'epoch': 6, 'rec_loss': '8.2255'}
2025-02-20 15:36:54,665 - {'Epoch': 6, 'HR@5': '0.0443', 'NDCG@5': '0.0303', 'HR@10': '0.0640', 'NDCG@10': '0.0366', 'HR@20': '0.0906', 'NDCG@20': '0.0434'}
2025-02-20 15:36:54,667 - Validation score increased.  Saving model ...
2025-02-20 15:37:49,090 - {'epoch': 7, 'rec_loss': '8.1399'}
2025-02-20 15:38:06,091 - {'Epoch': 7, 'HR@5': '0.0449', 'NDCG@5': '0.0311', 'HR@10': '0.0656', 'NDCG@10': '0.0377', 'HR@20': '0.0938', 'NDCG@20': '0.0448'}
2025-02-20 15:38:06,097 - Validation score increased.  Saving model ...
2025-02-20 15:38:58,674 - {'epoch': 8, 'rec_loss': '8.0709'}
2025-02-20 15:39:15,882 - {'Epoch': 8, 'HR@5': '0.0466', 'NDCG@5': '0.0326', 'HR@10': '0.0667', 'NDCG@10': '0.0391', 'HR@20': '0.0958', 'NDCG@20': '0.0464'}
2025-02-20 15:39:15,888 - Validation score increased.  Saving model ...
2025-02-20 15:40:09,041 - {'epoch': 9, 'rec_loss': '8.0117'}
2025-02-20 15:40:26,153 - {'Epoch': 9, 'HR@5': '0.0480', 'NDCG@5': '0.0332', 'HR@10': '0.0692', 'NDCG@10': '0.0400', 'HR@20': '0.0981', 'NDCG@20': '0.0472'}
2025-02-20 15:40:26,160 - Validation score increased.  Saving model ...
2025-02-20 15:41:17,530 - {'epoch': 10, 'rec_loss': '7.9662'}
2025-02-20 15:41:34,881 - {'Epoch': 10, 'HR@5': '0.0486', 'NDCG@5': '0.0338', 'HR@10': '0.0690', 'NDCG@10': '0.0404', 'HR@20': '0.0992', 'NDCG@20': '0.0480'}
2025-02-20 15:41:34,886 - Validation score increased.  Saving model ...
2025-02-20 15:42:23,445 - {'epoch': 11, 'rec_loss': '7.9268'}
2025-02-20 15:42:40,386 - {'Epoch': 11, 'HR@5': '0.0499', 'NDCG@5': '0.0346', 'HR@10': '0.0701', 'NDCG@10': '0.0411', 'HR@20': '0.0994', 'NDCG@20': '0.0485'}
2025-02-20 15:42:40,392 - Validation score increased.  Saving model ...
2025-02-20 15:43:33,979 - {'epoch': 12, 'rec_loss': '7.8861'}
2025-02-20 15:43:51,539 - {'Epoch': 12, 'HR@5': '0.0493', 'NDCG@5': '0.0340', 'HR@10': '0.0710', 'NDCG@10': '0.0410', 'HR@20': '0.1002', 'NDCG@20': '0.0483'}
2025-02-20 15:43:51,540 - EarlyStopping counter: 1 out of 10
2025-02-20 15:44:45,352 - {'epoch': 13, 'rec_loss': '7.8591'}
2025-02-20 15:45:02,488 - {'Epoch': 13, 'HR@5': '0.0508', 'NDCG@5': '0.0349', 'HR@10': '0.0722', 'NDCG@10': '0.0418', 'HR@20': '0.1016', 'NDCG@20': '0.0492'}
2025-02-20 15:45:02,495 - Validation score increased.  Saving model ...
2025-02-20 15:45:54,403 - {'epoch': 14, 'rec_loss': '7.8266'}
2025-02-20 15:46:11,888 - {'Epoch': 14, 'HR@5': '0.0503', 'NDCG@5': '0.0349', 'HR@10': '0.0719', 'NDCG@10': '0.0419', 'HR@20': '0.1016', 'NDCG@20': '0.0494'}
2025-02-20 15:46:11,890 - Validation score increased.  Saving model ...
2025-02-20 15:47:03,208 - {'epoch': 15, 'rec_loss': '7.8040'}
2025-02-20 15:47:20,481 - {'Epoch': 15, 'HR@5': '0.0505', 'NDCG@5': '0.0351', 'HR@10': '0.0726', 'NDCG@10': '0.0422', 'HR@20': '0.1021', 'NDCG@20': '0.0496'}
2025-02-20 15:47:20,484 - Validation score increased.  Saving model ...
2025-02-20 15:48:13,243 - {'epoch': 16, 'rec_loss': '7.7745'}
2025-02-20 15:48:30,565 - {'Epoch': 16, 'HR@5': '0.0500', 'NDCG@5': '0.0348', 'HR@10': '0.0728', 'NDCG@10': '0.0421', 'HR@20': '0.1026', 'NDCG@20': '0.0496'}
2025-02-20 15:48:30,574 - Validation score increased.  Saving model ...
2025-02-20 15:49:23,946 - {'epoch': 17, 'rec_loss': '7.7593'}
2025-02-20 15:49:41,171 - {'Epoch': 17, 'HR@5': '0.0508', 'NDCG@5': '0.0351', 'HR@10': '0.0735', 'NDCG@10': '0.0424', 'HR@20': '0.1030', 'NDCG@20': '0.0498'}
2025-02-20 15:49:41,177 - Validation score increased.  Saving model ...
2025-02-20 15:50:33,907 - {'epoch': 18, 'rec_loss': '7.7399'}
2025-02-20 15:50:51,451 - {'Epoch': 18, 'HR@5': '0.0513', 'NDCG@5': '0.0357', 'HR@10': '0.0740', 'NDCG@10': '0.0430', 'HR@20': '0.1036', 'NDCG@20': '0.0505'}
2025-02-20 15:50:51,456 - Validation score increased.  Saving model ...
2025-02-20 15:51:46,079 - {'epoch': 19, 'rec_loss': '7.7188'}
2025-02-20 15:52:03,521 - {'Epoch': 19, 'HR@5': '0.0513', 'NDCG@5': '0.0352', 'HR@10': '0.0740', 'NDCG@10': '0.0425', 'HR@20': '0.1046', 'NDCG@20': '0.0502'}
2025-02-20 15:52:03,527 - EarlyStopping counter: 1 out of 10
2025-02-20 15:52:59,206 - {'epoch': 20, 'rec_loss': '7.7068'}
2025-02-20 15:53:16,374 - {'Epoch': 20, 'HR@5': '0.0503', 'NDCG@5': '0.0355', 'HR@10': '0.0738', 'NDCG@10': '0.0431', 'HR@20': '0.1049', 'NDCG@20': '0.0509'}
2025-02-20 15:53:16,379 - Validation score increased.  Saving model ...
2025-02-20 15:54:11,942 - {'epoch': 21, 'rec_loss': '7.6890'}
2025-02-20 15:54:29,257 - {'Epoch': 21, 'HR@5': '0.0504', 'NDCG@5': '0.0346', 'HR@10': '0.0742', 'NDCG@10': '0.0423', 'HR@20': '0.1037', 'NDCG@20': '0.0497'}
2025-02-20 15:54:29,258 - EarlyStopping counter: 1 out of 10
2025-02-20 15:55:21,451 - {'epoch': 22, 'rec_loss': '7.6748'}
2025-02-20 15:55:38,861 - {'Epoch': 22, 'HR@5': '0.0523', 'NDCG@5': '0.0357', 'HR@10': '0.0746', 'NDCG@10': '0.0428', 'HR@20': '0.1042', 'NDCG@20': '0.0503'}
2025-02-20 15:55:38,866 - EarlyStopping counter: 2 out of 10
2025-02-20 15:56:31,844 - {'epoch': 23, 'rec_loss': '7.6577'}
2025-02-20 15:56:49,062 - {'Epoch': 23, 'HR@5': '0.0513', 'NDCG@5': '0.0353', 'HR@10': '0.0746', 'NDCG@10': '0.0429', 'HR@20': '0.1044', 'NDCG@20': '0.0504'}
2025-02-20 15:56:49,064 - EarlyStopping counter: 3 out of 10
2025-02-20 15:57:42,622 - {'epoch': 24, 'rec_loss': '7.6487'}
2025-02-20 15:57:59,809 - {'Epoch': 24, 'HR@5': '0.0520', 'NDCG@5': '0.0360', 'HR@10': '0.0744', 'NDCG@10': '0.0432', 'HR@20': '0.1042', 'NDCG@20': '0.0506'}
2025-02-20 15:57:59,813 - EarlyStopping counter: 4 out of 10
2025-02-20 15:58:53,237 - {'epoch': 25, 'rec_loss': '7.6350'}
2025-02-20 15:59:10,337 - {'Epoch': 25, 'HR@5': '0.0519', 'NDCG@5': '0.0360', 'HR@10': '0.0749', 'NDCG@10': '0.0434', 'HR@20': '0.1049', 'NDCG@20': '0.0510'}
2025-02-20 15:59:10,344 - Validation score increased.  Saving model ...
2025-02-20 16:00:02,575 - {'epoch': 26, 'rec_loss': '7.6235'}
2025-02-20 16:00:19,985 - {'Epoch': 26, 'HR@5': '0.0513', 'NDCG@5': '0.0354', 'HR@10': '0.0740', 'NDCG@10': '0.0427', 'HR@20': '0.1035', 'NDCG@20': '0.0501'}
2025-02-20 16:00:19,986 - EarlyStopping counter: 1 out of 10
2025-02-20 16:01:12,599 - {'epoch': 27, 'rec_loss': '7.6094'}
2025-02-20 16:01:29,892 - {'Epoch': 27, 'HR@5': '0.0502', 'NDCG@5': '0.0348', 'HR@10': '0.0741', 'NDCG@10': '0.0425', 'HR@20': '0.1032', 'NDCG@20': '0.0498'}
2025-02-20 16:01:29,897 - EarlyStopping counter: 2 out of 10
2025-02-20 16:02:21,504 - {'epoch': 28, 'rec_loss': '7.5981'}
2025-02-20 16:02:38,827 - {'Epoch': 28, 'HR@5': '0.0519', 'NDCG@5': '0.0357', 'HR@10': '0.0753', 'NDCG@10': '0.0433', 'HR@20': '0.1057', 'NDCG@20': '0.0509'}
2025-02-20 16:02:38,829 - EarlyStopping counter: 3 out of 10
2025-02-20 16:03:30,032 - {'epoch': 29, 'rec_loss': '7.5948'}
2025-02-20 16:03:47,497 - {'Epoch': 29, 'HR@5': '0.0502', 'NDCG@5': '0.0345', 'HR@10': '0.0738', 'NDCG@10': '0.0421', 'HR@20': '0.1049', 'NDCG@20': '0.0499'}
2025-02-20 16:03:47,500 - EarlyStopping counter: 4 out of 10
2025-02-20 16:04:41,119 - {'epoch': 30, 'rec_loss': '7.5835'}
2025-02-20 16:04:58,467 - {'Epoch': 30, 'HR@5': '0.0519', 'NDCG@5': '0.0357', 'HR@10': '0.0755', 'NDCG@10': '0.0434', 'HR@20': '0.1055', 'NDCG@20': '0.0509'}
2025-02-20 16:04:58,471 - EarlyStopping counter: 5 out of 10
2025-02-20 16:05:47,871 - {'epoch': 31, 'rec_loss': '7.5757'}
2025-02-20 16:06:05,180 - {'Epoch': 31, 'HR@5': '0.0515', 'NDCG@5': '0.0356', 'HR@10': '0.0747', 'NDCG@10': '0.0430', 'HR@20': '0.1045', 'NDCG@20': '0.0506'}
2025-02-20 16:06:05,181 - EarlyStopping counter: 6 out of 10
2025-02-20 16:06:55,981 - {'epoch': 32, 'rec_loss': '7.5691'}
2025-02-20 16:07:13,095 - {'Epoch': 32, 'HR@5': '0.0508', 'NDCG@5': '0.0353', 'HR@10': '0.0756', 'NDCG@10': '0.0432', 'HR@20': '0.1050', 'NDCG@20': '0.0506'}
2025-02-20 16:07:13,100 - EarlyStopping counter: 7 out of 10
2025-02-20 16:08:03,047 - {'epoch': 33, 'rec_loss': '7.5582'}
2025-02-20 16:08:20,271 - {'Epoch': 33, 'HR@5': '0.0516', 'NDCG@5': '0.0358', 'HR@10': '0.0744', 'NDCG@10': '0.0432', 'HR@20': '0.1059', 'NDCG@20': '0.0511'}
2025-02-20 16:08:20,278 - Validation score increased.  Saving model ...
2025-02-20 16:09:16,299 - {'epoch': 34, 'rec_loss': '7.5528'}
2025-02-20 16:09:33,398 - {'Epoch': 34, 'HR@5': '0.0514', 'NDCG@5': '0.0358', 'HR@10': '0.0744', 'NDCG@10': '0.0433', 'HR@20': '0.1044', 'NDCG@20': '0.0508'}
2025-02-20 16:09:33,401 - EarlyStopping counter: 1 out of 10
2025-02-20 16:10:26,195 - {'epoch': 35, 'rec_loss': '7.5429'}
2025-02-20 16:10:44,386 - {'Epoch': 35, 'HR@5': '0.0523', 'NDCG@5': '0.0363', 'HR@10': '0.0754', 'NDCG@10': '0.0436', 'HR@20': '0.1051', 'NDCG@20': '0.0511'}
2025-02-20 16:10:44,388 - Validation score increased.  Saving model ...
2025-02-20 16:11:35,561 - {'epoch': 36, 'rec_loss': '7.5353'}
2025-02-20 16:11:53,648 - {'Epoch': 36, 'HR@5': '0.0515', 'NDCG@5': '0.0362', 'HR@10': '0.0746', 'NDCG@10': '0.0437', 'HR@20': '0.1050', 'NDCG@20': '0.0513'}
2025-02-20 16:11:53,651 - Validation score increased.  Saving model ...
2025-02-20 16:12:48,483 - {'epoch': 37, 'rec_loss': '7.5205'}
2025-02-20 16:13:06,002 - {'Epoch': 37, 'HR@5': '0.0517', 'NDCG@5': '0.0357', 'HR@10': '0.0745', 'NDCG@10': '0.0430', 'HR@20': '0.1045', 'NDCG@20': '0.0506'}
2025-02-20 16:13:06,004 - EarlyStopping counter: 1 out of 10
2025-02-20 16:13:58,333 - {'epoch': 38, 'rec_loss': '7.5218'}
2025-02-20 16:14:14,923 - {'Epoch': 38, 'HR@5': '0.0512', 'NDCG@5': '0.0353', 'HR@10': '0.0737', 'NDCG@10': '0.0426', 'HR@20': '0.1036', 'NDCG@20': '0.0501'}
2025-02-20 16:14:14,928 - EarlyStopping counter: 2 out of 10
2025-02-20 16:15:03,567 - {'epoch': 39, 'rec_loss': '7.5145'}
2025-02-20 16:15:21,071 - {'Epoch': 39, 'HR@5': '0.0523', 'NDCG@5': '0.0365', 'HR@10': '0.0750', 'NDCG@10': '0.0438', 'HR@20': '0.1041', 'NDCG@20': '0.0512'}
2025-02-20 16:15:21,072 - EarlyStopping counter: 3 out of 10
2025-02-20 16:16:16,878 - {'epoch': 40, 'rec_loss': '7.5028'}
2025-02-20 16:16:34,115 - {'Epoch': 40, 'HR@5': '0.0518', 'NDCG@5': '0.0359', 'HR@10': '0.0737', 'NDCG@10': '0.0429', 'HR@20': '0.1036', 'NDCG@20': '0.0505'}
2025-02-20 16:16:34,119 - EarlyStopping counter: 4 out of 10
2025-02-20 16:17:26,466 - {'epoch': 41, 'rec_loss': '7.4959'}
2025-02-20 16:17:44,792 - {'Epoch': 41, 'HR@5': '0.0514', 'NDCG@5': '0.0358', 'HR@10': '0.0740', 'NDCG@10': '0.0431', 'HR@20': '0.1035', 'NDCG@20': '0.0505'}
2025-02-20 16:17:44,793 - EarlyStopping counter: 5 out of 10
2025-02-20 16:18:36,496 - {'epoch': 42, 'rec_loss': '7.4943'}
2025-02-20 16:18:54,923 - {'Epoch': 42, 'HR@5': '0.0513', 'NDCG@5': '0.0357', 'HR@10': '0.0736', 'NDCG@10': '0.0429', 'HR@20': '0.1036', 'NDCG@20': '0.0504'}
2025-02-20 16:18:54,924 - EarlyStopping counter: 6 out of 10
2025-02-20 16:19:50,394 - {'epoch': 43, 'rec_loss': '7.4874'}
2025-02-20 16:20:08,221 - {'Epoch': 43, 'HR@5': '0.0523', 'NDCG@5': '0.0361', 'HR@10': '0.0739', 'NDCG@10': '0.0430', 'HR@20': '0.1031', 'NDCG@20': '0.0504'}
2025-02-20 16:20:08,228 - EarlyStopping counter: 7 out of 10
2025-02-20 16:20:57,307 - {'epoch': 44, 'rec_loss': '7.4808'}
2025-02-20 16:21:14,805 - {'Epoch': 44, 'HR@5': '0.0518', 'NDCG@5': '0.0359', 'HR@10': '0.0746', 'NDCG@10': '0.0433', 'HR@20': '0.1037', 'NDCG@20': '0.0506'}
2025-02-20 16:21:14,810 - EarlyStopping counter: 8 out of 10
2025-02-20 16:22:07,773 - {'epoch': 45, 'rec_loss': '7.4705'}
2025-02-20 16:22:25,738 - {'Epoch': 45, 'HR@5': '0.0518', 'NDCG@5': '0.0361', 'HR@10': '0.0737', 'NDCG@10': '0.0432', 'HR@20': '0.1037', 'NDCG@20': '0.0507'}
2025-02-20 16:22:25,743 - EarlyStopping counter: 9 out of 10
2025-02-20 16:23:20,376 - {'epoch': 46, 'rec_loss': '7.4728'}
2025-02-20 16:23:37,665 - {'Epoch': 46, 'HR@5': '0.0517', 'NDCG@5': '0.0358', 'HR@10': '0.0743', 'NDCG@10': '0.0431', 'HR@20': '0.1037', 'NDCG@20': '0.0505'}
2025-02-20 16:23:37,668 - EarlyStopping counter: 10 out of 10
2025-02-20 16:23:37,669 - Early stopping
2025-02-20 16:23:37,669 - ---------------Test Score---------------
2025-02-20 16:23:54,905 - {'Epoch': 0, 'HR@5': '0.0419', 'NDCG@5': '0.0293', 'HR@10': '0.0614', 'NDCG@10': '0.0356', 'HR@20': '0.0866', 'NDCG@20': '0.0419'}
2025-02-20 16:23:54,909 - Scale_Sports
2025-02-20 16:23:54,909 - {'Epoch': 0, 'HR@5': '0.0419', 'NDCG@5': '0.0293', 'HR@10': '0.0614', 'NDCG@10': '0.0356', 'HR@20': '0.0866', 'NDCG@20': '0.0419'}
2025-02-20 16:53:51,735 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-20 16:53:55,090 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=50, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-20 16:53:55,094 - Total Parameters: 1331454
2025-02-20 16:54:21,203 - {'epoch': 0, 'rec_loss': '9.4042'}
2025-02-20 16:54:37,170 - {'Epoch': 0, 'HR@5': '0.0081', 'NDCG@5': '0.0054', 'HR@10': '0.0126', 'NDCG@10': '0.0069', 'HR@20': '0.0229', 'NDCG@20': '0.0094'}
2025-02-20 16:54:37,171 - Validation score increased.  Saving model ...
2025-02-20 16:55:03,528 - {'epoch': 1, 'rec_loss': '9.2775'}
2025-02-20 16:55:19,699 - {'Epoch': 1, 'HR@5': '0.0087', 'NDCG@5': '0.0056', 'HR@10': '0.0154', 'NDCG@10': '0.0077', 'HR@20': '0.0268', 'NDCG@20': '0.0106'}
2025-02-20 16:55:19,700 - Validation score increased.  Saving model ...
2025-02-20 16:55:47,635 - {'epoch': 2, 'rec_loss': '9.1675'}
2025-02-20 16:56:02,824 - {'Epoch': 2, 'HR@5': '0.0120', 'NDCG@5': '0.0078', 'HR@10': '0.0211', 'NDCG@10': '0.0107', 'HR@20': '0.0353', 'NDCG@20': '0.0143'}
2025-02-20 16:56:02,825 - Validation score increased.  Saving model ...
2025-02-20 16:56:31,683 - {'epoch': 3, 'rec_loss': '9.0117'}
2025-02-20 16:56:46,294 - {'Epoch': 3, 'HR@5': '0.0173', 'NDCG@5': '0.0109', 'HR@10': '0.0274', 'NDCG@10': '0.0142', 'HR@20': '0.0452', 'NDCG@20': '0.0186'}
2025-02-20 16:56:46,295 - Validation score increased.  Saving model ...
2025-02-20 16:57:11,845 - {'epoch': 4, 'rec_loss': '8.8906'}
2025-02-20 16:57:26,554 - {'Epoch': 4, 'HR@5': '0.0195', 'NDCG@5': '0.0128', 'HR@10': '0.0310', 'NDCG@10': '0.0165', 'HR@20': '0.0496', 'NDCG@20': '0.0212'}
2025-02-20 16:57:26,555 - Validation score increased.  Saving model ...
2025-02-20 16:57:51,459 - {'epoch': 5, 'rec_loss': '8.8036'}
2025-02-20 16:58:05,872 - {'Epoch': 5, 'HR@5': '0.0204', 'NDCG@5': '0.0133', 'HR@10': '0.0344', 'NDCG@10': '0.0178', 'HR@20': '0.0534', 'NDCG@20': '0.0226'}
2025-02-20 16:58:05,873 - Validation score increased.  Saving model ...
2025-02-20 16:58:31,628 - {'epoch': 6, 'rec_loss': '8.7293'}
2025-02-20 16:58:46,620 - {'Epoch': 6, 'HR@5': '0.0240', 'NDCG@5': '0.0155', 'HR@10': '0.0386', 'NDCG@10': '0.0202', 'HR@20': '0.0603', 'NDCG@20': '0.0256'}
2025-02-20 16:58:46,622 - Validation score increased.  Saving model ...
2025-02-20 16:59:12,199 - {'epoch': 7, 'rec_loss': '8.6605'}
2025-02-20 16:59:27,136 - {'Epoch': 7, 'HR@5': '0.0274', 'NDCG@5': '0.0175', 'HR@10': '0.0425', 'NDCG@10': '0.0224', 'HR@20': '0.0653', 'NDCG@20': '0.0281'}
2025-02-20 16:59:27,138 - Validation score increased.  Saving model ...
2025-02-20 16:59:52,386 - {'epoch': 8, 'rec_loss': '8.5981'}
2025-02-20 17:00:07,217 - {'Epoch': 8, 'HR@5': '0.0308', 'NDCG@5': '0.0198', 'HR@10': '0.0465', 'NDCG@10': '0.0249', 'HR@20': '0.0709', 'NDCG@20': '0.0310'}
2025-02-20 17:00:07,219 - Validation score increased.  Saving model ...
2025-02-20 17:00:33,765 - {'epoch': 9, 'rec_loss': '8.5415'}
2025-02-20 17:00:49,184 - {'Epoch': 9, 'HR@5': '0.0330', 'NDCG@5': '0.0216', 'HR@10': '0.0497', 'NDCG@10': '0.0270', 'HR@20': '0.0741', 'NDCG@20': '0.0331'}
2025-02-20 17:00:49,186 - Validation score increased.  Saving model ...
2025-02-20 17:01:15,155 - {'epoch': 10, 'rec_loss': '8.4861'}
2025-02-20 17:01:30,211 - {'Epoch': 10, 'HR@5': '0.0341', 'NDCG@5': '0.0227', 'HR@10': '0.0515', 'NDCG@10': '0.0284', 'HR@20': '0.0768', 'NDCG@20': '0.0347'}
2025-02-20 17:01:30,212 - Validation score increased.  Saving model ...
2025-02-20 17:01:57,194 - {'epoch': 11, 'rec_loss': '8.4444'}
2025-02-20 17:02:12,060 - {'Epoch': 11, 'HR@5': '0.0354', 'NDCG@5': '0.0236', 'HR@10': '0.0540', 'NDCG@10': '0.0296', 'HR@20': '0.0798', 'NDCG@20': '0.0360'}
2025-02-20 17:02:12,064 - Validation score increased.  Saving model ...
2025-02-20 17:02:37,491 - {'epoch': 12, 'rec_loss': '8.4040'}
2025-02-20 17:02:52,371 - {'Epoch': 12, 'HR@5': '0.0378', 'NDCG@5': '0.0250', 'HR@10': '0.0569', 'NDCG@10': '0.0312', 'HR@20': '0.0820', 'NDCG@20': '0.0375'}
2025-02-20 17:02:52,375 - Validation score increased.  Saving model ...
2025-02-20 17:03:17,887 - {'epoch': 13, 'rec_loss': '8.3683'}
2025-02-20 17:03:32,963 - {'Epoch': 13, 'HR@5': '0.0388', 'NDCG@5': '0.0261', 'HR@10': '0.0576', 'NDCG@10': '0.0321', 'HR@20': '0.0842', 'NDCG@20': '0.0388'}
2025-02-20 17:03:32,964 - Validation score increased.  Saving model ...
2025-02-20 17:03:59,420 - {'epoch': 14, 'rec_loss': '8.3342'}
2025-02-20 17:04:14,593 - {'Epoch': 14, 'HR@5': '0.0397', 'NDCG@5': '0.0268', 'HR@10': '0.0581', 'NDCG@10': '0.0327', 'HR@20': '0.0867', 'NDCG@20': '0.0399'}
2025-02-20 17:04:14,594 - Validation score increased.  Saving model ...
2025-02-20 17:04:40,429 - {'epoch': 15, 'rec_loss': '8.3092'}
2025-02-20 17:04:55,469 - {'Epoch': 15, 'HR@5': '0.0401', 'NDCG@5': '0.0274', 'HR@10': '0.0604', 'NDCG@10': '0.0339', 'HR@20': '0.0871', 'NDCG@20': '0.0406'}
2025-02-20 17:04:55,470 - Validation score increased.  Saving model ...
2025-02-20 17:05:23,921 - {'epoch': 16, 'rec_loss': '8.2791'}
2025-02-20 17:05:39,352 - {'Epoch': 16, 'HR@5': '0.0411', 'NDCG@5': '0.0277', 'HR@10': '0.0615', 'NDCG@10': '0.0343', 'HR@20': '0.0893', 'NDCG@20': '0.0413'}
2025-02-20 17:05:39,353 - Validation score increased.  Saving model ...
2025-02-20 17:06:05,176 - {'epoch': 17, 'rec_loss': '8.2552'}
2025-02-20 17:06:20,404 - {'Epoch': 17, 'HR@5': '0.0432', 'NDCG@5': '0.0294', 'HR@10': '0.0633', 'NDCG@10': '0.0359', 'HR@20': '0.0914', 'NDCG@20': '0.0429'}
2025-02-20 17:06:20,405 - Validation score increased.  Saving model ...
2025-02-20 17:06:45,077 - {'epoch': 18, 'rec_loss': '8.2305'}
2025-02-20 17:07:00,288 - {'Epoch': 18, 'HR@5': '0.0442', 'NDCG@5': '0.0300', 'HR@10': '0.0640', 'NDCG@10': '0.0364', 'HR@20': '0.0919', 'NDCG@20': '0.0434'}
2025-02-20 17:07:00,290 - Validation score increased.  Saving model ...
2025-02-20 17:07:25,814 - {'epoch': 19, 'rec_loss': '8.2098'}
2025-02-20 17:07:42,470 - {'Epoch': 19, 'HR@5': '0.0444', 'NDCG@5': '0.0304', 'HR@10': '0.0643', 'NDCG@10': '0.0368', 'HR@20': '0.0939', 'NDCG@20': '0.0443'}
2025-02-20 17:07:42,473 - Validation score increased.  Saving model ...
2025-02-20 17:08:08,469 - {'epoch': 20, 'rec_loss': '8.1896'}
2025-02-20 17:08:23,705 - {'Epoch': 20, 'HR@5': '0.0447', 'NDCG@5': '0.0306', 'HR@10': '0.0651', 'NDCG@10': '0.0372', 'HR@20': '0.0938', 'NDCG@20': '0.0444'}
2025-02-20 17:08:23,706 - Validation score increased.  Saving model ...
2025-02-20 17:08:51,474 - {'epoch': 21, 'rec_loss': '8.1705'}
2025-02-20 17:09:06,785 - {'Epoch': 21, 'HR@5': '0.0464', 'NDCG@5': '0.0315', 'HR@10': '0.0665', 'NDCG@10': '0.0380', 'HR@20': '0.0952', 'NDCG@20': '0.0452'}
2025-02-20 17:09:06,786 - Validation score increased.  Saving model ...
2025-02-20 17:09:32,556 - {'epoch': 22, 'rec_loss': '8.1536'}
2025-02-20 17:09:47,980 - {'Epoch': 22, 'HR@5': '0.0463', 'NDCG@5': '0.0318', 'HR@10': '0.0662', 'NDCG@10': '0.0382', 'HR@20': '0.0958', 'NDCG@20': '0.0456'}
2025-02-20 17:09:47,982 - Validation score increased.  Saving model ...
2025-02-20 17:10:14,787 - {'epoch': 23, 'rec_loss': '8.1385'}
2025-02-20 17:10:30,352 - {'Epoch': 23, 'HR@5': '0.0464', 'NDCG@5': '0.0322', 'HR@10': '0.0682', 'NDCG@10': '0.0393', 'HR@20': '0.0979', 'NDCG@20': '0.0467'}
2025-02-20 17:10:30,353 - Validation score increased.  Saving model ...
2025-02-20 17:10:56,790 - {'epoch': 24, 'rec_loss': '8.1260'}
2025-02-20 17:11:13,760 - {'Epoch': 24, 'HR@5': '0.0466', 'NDCG@5': '0.0321', 'HR@10': '0.0674', 'NDCG@10': '0.0388', 'HR@20': '0.0978', 'NDCG@20': '0.0464'}
2025-02-20 17:11:13,764 - EarlyStopping counter: 1 out of 10
2025-02-20 17:11:38,700 - {'epoch': 25, 'rec_loss': '8.1140'}
2025-02-20 17:11:55,018 - {'Epoch': 25, 'HR@5': '0.0471', 'NDCG@5': '0.0326', 'HR@10': '0.0692', 'NDCG@10': '0.0397', 'HR@20': '0.0987', 'NDCG@20': '0.0471'}
2025-02-20 17:11:55,021 - Validation score increased.  Saving model ...
2025-02-20 17:12:21,180 - {'epoch': 26, 'rec_loss': '8.1034'}
2025-02-20 17:12:36,776 - {'Epoch': 26, 'HR@5': '0.0474', 'NDCG@5': '0.0323', 'HR@10': '0.0688', 'NDCG@10': '0.0392', 'HR@20': '0.1006', 'NDCG@20': '0.0472'}
2025-02-20 17:12:36,777 - Validation score increased.  Saving model ...
2025-02-20 17:13:02,344 - {'epoch': 27, 'rec_loss': '8.0823'}
2025-02-20 17:13:17,808 - {'Epoch': 27, 'HR@5': '0.0476', 'NDCG@5': '0.0330', 'HR@10': '0.0700', 'NDCG@10': '0.0402', 'HR@20': '0.1002', 'NDCG@20': '0.0477'}
2025-02-20 17:13:17,812 - Validation score increased.  Saving model ...
2025-02-20 17:13:42,875 - {'epoch': 28, 'rec_loss': '8.0794'}
2025-02-20 17:13:58,444 - {'Epoch': 28, 'HR@5': '0.0486', 'NDCG@5': '0.0338', 'HR@10': '0.0699', 'NDCG@10': '0.0406', 'HR@20': '0.1003', 'NDCG@20': '0.0483'}
2025-02-20 17:13:58,445 - Validation score increased.  Saving model ...
2025-02-20 17:14:23,490 - {'epoch': 29, 'rec_loss': '8.0655'}
2025-02-20 17:14:39,489 - {'Epoch': 29, 'HR@5': '0.0484', 'NDCG@5': '0.0339', 'HR@10': '0.0710', 'NDCG@10': '0.0412', 'HR@20': '0.1015', 'NDCG@20': '0.0489'}
2025-02-20 17:14:39,490 - Validation score increased.  Saving model ...
2025-02-20 17:15:03,112 - {'epoch': 30, 'rec_loss': '8.0551'}
2025-02-20 17:15:18,644 - {'Epoch': 30, 'HR@5': '0.0481', 'NDCG@5': '0.0334', 'HR@10': '0.0712', 'NDCG@10': '0.0409', 'HR@20': '0.1017', 'NDCG@20': '0.0485'}
2025-02-20 17:15:18,645 - EarlyStopping counter: 1 out of 10
2025-02-20 17:15:44,524 - {'epoch': 31, 'rec_loss': '8.0474'}
2025-02-20 17:16:00,359 - {'Epoch': 31, 'HR@5': '0.0486', 'NDCG@5': '0.0336', 'HR@10': '0.0707', 'NDCG@10': '0.0408', 'HR@20': '0.1009', 'NDCG@20': '0.0484'}
2025-02-20 17:16:00,363 - EarlyStopping counter: 2 out of 10
2025-02-20 17:16:27,767 - {'epoch': 32, 'rec_loss': '8.0373'}
2025-02-20 17:16:43,538 - {'Epoch': 32, 'HR@5': '0.0488', 'NDCG@5': '0.0334', 'HR@10': '0.0713', 'NDCG@10': '0.0406', 'HR@20': '0.1026', 'NDCG@20': '0.0485'}
2025-02-20 17:16:43,539 - EarlyStopping counter: 3 out of 10
2025-02-20 17:17:10,557 - {'epoch': 33, 'rec_loss': '8.0308'}
2025-02-20 17:17:30,370 - {'Epoch': 33, 'HR@5': '0.0490', 'NDCG@5': '0.0343', 'HR@10': '0.0719', 'NDCG@10': '0.0417', 'HR@20': '0.1026', 'NDCG@20': '0.0494'}
2025-02-20 17:17:30,374 - Validation score increased.  Saving model ...
2025-02-20 17:17:59,460 - {'epoch': 34, 'rec_loss': '8.0231'}
2025-02-20 17:18:15,298 - {'Epoch': 34, 'HR@5': '0.0495', 'NDCG@5': '0.0342', 'HR@10': '0.0722', 'NDCG@10': '0.0415', 'HR@20': '0.1016', 'NDCG@20': '0.0489'}
2025-02-20 17:18:15,301 - EarlyStopping counter: 1 out of 10
2025-02-20 17:18:42,003 - {'epoch': 35, 'rec_loss': '8.0199'}
2025-02-20 17:18:58,348 - {'Epoch': 35, 'HR@5': '0.0496', 'NDCG@5': '0.0344', 'HR@10': '0.0730', 'NDCG@10': '0.0419', 'HR@20': '0.1029', 'NDCG@20': '0.0495'}
2025-02-20 17:18:58,349 - Validation score increased.  Saving model ...
2025-02-20 17:19:24,682 - {'epoch': 36, 'rec_loss': '8.0114'}
2025-02-20 17:19:42,498 - {'Epoch': 36, 'HR@5': '0.0497', 'NDCG@5': '0.0347', 'HR@10': '0.0723', 'NDCG@10': '0.0420', 'HR@20': '0.1035', 'NDCG@20': '0.0498'}
2025-02-20 17:19:42,501 - Validation score increased.  Saving model ...
2025-02-20 17:20:10,716 - {'epoch': 37, 'rec_loss': '7.9990'}
2025-02-20 17:20:27,151 - {'Epoch': 37, 'HR@5': '0.0497', 'NDCG@5': '0.0345', 'HR@10': '0.0724', 'NDCG@10': '0.0418', 'HR@20': '0.1027', 'NDCG@20': '0.0494'}
2025-02-20 17:20:27,152 - EarlyStopping counter: 1 out of 10
2025-02-20 17:20:53,957 - {'epoch': 38, 'rec_loss': '7.9939'}
2025-02-20 17:21:11,953 - {'Epoch': 38, 'HR@5': '0.0502', 'NDCG@5': '0.0348', 'HR@10': '0.0730', 'NDCG@10': '0.0421', 'HR@20': '0.1025', 'NDCG@20': '0.0495'}
2025-02-20 17:21:11,954 - EarlyStopping counter: 2 out of 10
2025-02-20 17:21:40,089 - {'epoch': 39, 'rec_loss': '7.9821'}
2025-02-20 17:21:55,656 - {'Epoch': 39, 'HR@5': '0.0502', 'NDCG@5': '0.0345', 'HR@10': '0.0739', 'NDCG@10': '0.0422', 'HR@20': '0.1037', 'NDCG@20': '0.0496'}
2025-02-20 17:21:55,657 - EarlyStopping counter: 3 out of 10
2025-02-20 17:22:22,443 - {'epoch': 40, 'rec_loss': '7.9878'}
2025-02-20 17:22:38,179 - {'Epoch': 40, 'HR@5': '0.0505', 'NDCG@5': '0.0350', 'HR@10': '0.0733', 'NDCG@10': '0.0423', 'HR@20': '0.1040', 'NDCG@20': '0.0500'}
2025-02-20 17:22:38,180 - Validation score increased.  Saving model ...
2025-02-20 17:23:02,653 - {'epoch': 41, 'rec_loss': '7.9705'}
2025-02-20 17:23:18,106 - {'Epoch': 41, 'HR@5': '0.0505', 'NDCG@5': '0.0348', 'HR@10': '0.0734', 'NDCG@10': '0.0422', 'HR@20': '0.1037', 'NDCG@20': '0.0498'}
2025-02-20 17:23:18,107 - EarlyStopping counter: 1 out of 10
2025-02-20 17:23:42,338 - {'epoch': 42, 'rec_loss': '7.9719'}
2025-02-20 17:23:58,927 - {'Epoch': 42, 'HR@5': '0.0502', 'NDCG@5': '0.0348', 'HR@10': '0.0726', 'NDCG@10': '0.0420', 'HR@20': '0.1042', 'NDCG@20': '0.0499'}
2025-02-20 17:23:58,929 - EarlyStopping counter: 2 out of 10
2025-02-20 17:24:25,996 - {'epoch': 43, 'rec_loss': '7.9597'}
2025-02-20 17:24:43,992 - {'Epoch': 43, 'HR@5': '0.0496', 'NDCG@5': '0.0344', 'HR@10': '0.0727', 'NDCG@10': '0.0419', 'HR@20': '0.1050', 'NDCG@20': '0.0500'}
2025-02-20 17:24:43,993 - EarlyStopping counter: 3 out of 10
2025-02-20 17:25:11,126 - {'epoch': 44, 'rec_loss': '7.9598'}
2025-02-20 17:25:27,296 - {'Epoch': 44, 'HR@5': '0.0506', 'NDCG@5': '0.0352', 'HR@10': '0.0741', 'NDCG@10': '0.0427', 'HR@20': '0.1052', 'NDCG@20': '0.0506'}
2025-02-20 17:25:27,302 - Validation score increased.  Saving model ...
2025-02-20 17:25:53,109 - {'epoch': 45, 'rec_loss': '7.9576'}
2025-02-20 17:26:10,767 - {'Epoch': 45, 'HR@5': '0.0494', 'NDCG@5': '0.0344', 'HR@10': '0.0736', 'NDCG@10': '0.0422', 'HR@20': '0.1053', 'NDCG@20': '0.0502'}
2025-02-20 17:26:10,768 - EarlyStopping counter: 1 out of 10
2025-02-20 17:26:36,881 - {'epoch': 46, 'rec_loss': '7.9536'}
2025-02-20 17:26:53,499 - {'Epoch': 46, 'HR@5': '0.0500', 'NDCG@5': '0.0347', 'HR@10': '0.0725', 'NDCG@10': '0.0419', 'HR@20': '0.1056', 'NDCG@20': '0.0503'}
2025-02-20 17:26:53,500 - EarlyStopping counter: 2 out of 10
2025-02-20 17:27:16,790 - {'epoch': 47, 'rec_loss': '7.9462'}
2025-02-20 17:27:34,751 - {'Epoch': 47, 'HR@5': '0.0515', 'NDCG@5': '0.0356', 'HR@10': '0.0739', 'NDCG@10': '0.0427', 'HR@20': '0.1064', 'NDCG@20': '0.0509'}
2025-02-20 17:27:34,752 - Validation score increased.  Saving model ...
2025-02-20 17:27:59,205 - {'epoch': 48, 'rec_loss': '7.9401'}
2025-02-20 17:28:14,827 - {'Epoch': 48, 'HR@5': '0.0520', 'NDCG@5': '0.0362', 'HR@10': '0.0746', 'NDCG@10': '0.0435', 'HR@20': '0.1056', 'NDCG@20': '0.0512'}
2025-02-20 17:28:14,832 - Validation score increased.  Saving model ...
2025-02-20 17:28:40,262 - {'epoch': 49, 'rec_loss': '7.9383'}
2025-02-20 17:28:57,885 - {'Epoch': 49, 'HR@5': '0.0514', 'NDCG@5': '0.0356', 'HR@10': '0.0742', 'NDCG@10': '0.0429', 'HR@20': '0.1061', 'NDCG@20': '0.0509'}
2025-02-20 17:28:57,886 - EarlyStopping counter: 1 out of 10
2025-02-20 17:29:23,209 - {'epoch': 50, 'rec_loss': '7.9271'}
2025-02-20 17:29:38,815 - {'Epoch': 50, 'HR@5': '0.0509', 'NDCG@5': '0.0347', 'HR@10': '0.0744', 'NDCG@10': '0.0423', 'HR@20': '0.1054', 'NDCG@20': '0.0501'}
2025-02-20 17:29:38,819 - EarlyStopping counter: 2 out of 10
2025-02-20 17:30:02,507 - {'epoch': 51, 'rec_loss': '7.9351'}
2025-02-20 17:30:17,845 - {'Epoch': 51, 'HR@5': '0.0504', 'NDCG@5': '0.0351', 'HR@10': '0.0742', 'NDCG@10': '0.0428', 'HR@20': '0.1060', 'NDCG@20': '0.0508'}
2025-02-20 17:30:17,849 - EarlyStopping counter: 3 out of 10
2025-02-20 17:30:40,802 - {'epoch': 52, 'rec_loss': '7.9244'}
2025-02-20 17:30:58,717 - {'Epoch': 52, 'HR@5': '0.0501', 'NDCG@5': '0.0348', 'HR@10': '0.0742', 'NDCG@10': '0.0425', 'HR@20': '0.1061', 'NDCG@20': '0.0506'}
2025-02-20 17:30:58,719 - EarlyStopping counter: 4 out of 10
2025-02-20 17:31:21,930 - {'epoch': 53, 'rec_loss': '7.9211'}
2025-02-20 17:31:39,816 - {'Epoch': 53, 'HR@5': '0.0507', 'NDCG@5': '0.0353', 'HR@10': '0.0739', 'NDCG@10': '0.0427', 'HR@20': '0.1064', 'NDCG@20': '0.0509'}
2025-02-20 17:31:39,818 - EarlyStopping counter: 5 out of 10
2025-02-20 17:32:03,062 - {'epoch': 54, 'rec_loss': '7.9118'}
2025-02-20 17:32:20,942 - {'Epoch': 54, 'HR@5': '0.0505', 'NDCG@5': '0.0350', 'HR@10': '0.0746', 'NDCG@10': '0.0427', 'HR@20': '0.1056', 'NDCG@20': '0.0505'}
2025-02-20 17:32:20,946 - EarlyStopping counter: 6 out of 10
2025-02-20 17:32:44,115 - {'epoch': 55, 'rec_loss': '7.9102'}
2025-02-20 17:33:01,860 - {'Epoch': 55, 'HR@5': '0.0506', 'NDCG@5': '0.0352', 'HR@10': '0.0753', 'NDCG@10': '0.0431', 'HR@20': '0.1069', 'NDCG@20': '0.0510'}
2025-02-20 17:33:01,865 - EarlyStopping counter: 7 out of 10
2025-02-20 17:33:24,827 - {'epoch': 56, 'rec_loss': '7.9128'}
2025-02-20 17:33:40,588 - {'Epoch': 56, 'HR@5': '0.0512', 'NDCG@5': '0.0356', 'HR@10': '0.0745', 'NDCG@10': '0.0431', 'HR@20': '0.1065', 'NDCG@20': '0.0511'}
2025-02-20 17:33:40,589 - EarlyStopping counter: 8 out of 10
2025-02-20 17:34:03,494 - {'epoch': 57, 'rec_loss': '7.8991'}
2025-02-20 17:34:20,656 - {'Epoch': 57, 'HR@5': '0.0504', 'NDCG@5': '0.0348', 'HR@10': '0.0749', 'NDCG@10': '0.0427', 'HR@20': '0.1059', 'NDCG@20': '0.0505'}
2025-02-20 17:34:20,660 - EarlyStopping counter: 9 out of 10
2025-02-20 17:34:43,533 - {'epoch': 58, 'rec_loss': '7.9047'}
2025-02-20 17:35:00,703 - {'Epoch': 58, 'HR@5': '0.0509', 'NDCG@5': '0.0351', 'HR@10': '0.0752', 'NDCG@10': '0.0430', 'HR@20': '0.1067', 'NDCG@20': '0.0509'}
2025-02-20 17:35:00,704 - EarlyStopping counter: 10 out of 10
2025-02-20 17:35:00,704 - Early stopping
2025-02-20 17:35:00,704 - ---------------Test Score---------------
2025-02-20 17:35:18,479 - {'Epoch': 0, 'HR@5': '0.0427', 'NDCG@5': '0.0294', 'HR@10': '0.0604', 'NDCG@10': '0.0351', 'HR@20': '0.0862', 'NDCG@20': '0.0415'}
2025-02-20 17:35:18,482 - Scale_Sports
2025-02-20 17:35:18,482 - {'Epoch': 0, 'HR@5': '0.0427', 'NDCG@5': '0.0294', 'HR@10': '0.0604', 'NDCG@10': '0.0351', 'HR@20': '0.0862', 'NDCG@20': '0.0415'}
2025-02-20 19:36:57,391 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25, 10], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-20 19:37:00,147 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-20 19:37:00,152 - Total Parameters: 1328854
2025-02-20 19:37:58,485 - {'epoch': 0, 'rec_loss': '9.4099'}
2025-02-20 19:38:15,658 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0053', 'HR@10': '0.0133', 'NDCG@10': '0.0069', 'HR@20': '0.0215', 'NDCG@20': '0.0090'}
2025-02-20 19:38:15,660 - Validation score increased.  Saving model ...
2025-02-20 19:39:13,350 - {'epoch': 1, 'rec_loss': '9.1772'}
2025-02-20 19:39:30,629 - {'Epoch': 1, 'HR@5': '0.0157', 'NDCG@5': '0.0101', 'HR@10': '0.0264', 'NDCG@10': '0.0135', 'HR@20': '0.0431', 'NDCG@20': '0.0177'}
2025-02-20 19:39:30,634 - Validation score increased.  Saving model ...
2025-02-20 19:40:24,066 - {'epoch': 2, 'rec_loss': '8.8604'}
2025-02-20 19:40:40,632 - {'Epoch': 2, 'HR@5': '0.0222', 'NDCG@5': '0.0143', 'HR@10': '0.0364', 'NDCG@10': '0.0189', 'HR@20': '0.0566', 'NDCG@20': '0.0239'}
2025-02-20 19:40:40,634 - Validation score increased.  Saving model ...
2025-02-20 19:41:39,293 - {'epoch': 3, 'rec_loss': '8.6471'}
2025-02-20 19:41:57,020 - {'Epoch': 3, 'HR@5': '0.0305', 'NDCG@5': '0.0199', 'HR@10': '0.0472', 'NDCG@10': '0.0253', 'HR@20': '0.0693', 'NDCG@20': '0.0308'}
2025-02-20 19:41:57,021 - Validation score increased.  Saving model ...
2025-02-20 19:42:48,484 - {'epoch': 4, 'rec_loss': '8.4711'}
2025-02-20 19:43:07,972 - {'Epoch': 4, 'HR@5': '0.0370', 'NDCG@5': '0.0253', 'HR@10': '0.0545', 'NDCG@10': '0.0309', 'HR@20': '0.0799', 'NDCG@20': '0.0373'}
2025-02-20 19:43:07,974 - Validation score increased.  Saving model ...
2025-02-20 19:44:01,535 - {'epoch': 5, 'rec_loss': '8.3365'}
2025-02-20 19:44:20,100 - {'Epoch': 5, 'HR@5': '0.0411', 'NDCG@5': '0.0278', 'HR@10': '0.0576', 'NDCG@10': '0.0331', 'HR@20': '0.0860', 'NDCG@20': '0.0402'}
2025-02-20 19:44:20,102 - Validation score increased.  Saving model ...
2025-02-20 19:45:13,339 - {'epoch': 6, 'rec_loss': '8.2255'}
2025-02-20 19:45:31,455 - {'Epoch': 6, 'HR@5': '0.0443', 'NDCG@5': '0.0303', 'HR@10': '0.0640', 'NDCG@10': '0.0366', 'HR@20': '0.0906', 'NDCG@20': '0.0434'}
2025-02-20 19:45:31,462 - Validation score increased.  Saving model ...
2025-02-20 19:46:26,998 - {'epoch': 7, 'rec_loss': '8.1399'}
2025-02-20 19:46:43,908 - {'Epoch': 7, 'HR@5': '0.0449', 'NDCG@5': '0.0311', 'HR@10': '0.0656', 'NDCG@10': '0.0377', 'HR@20': '0.0938', 'NDCG@20': '0.0448'}
2025-02-20 19:46:43,910 - Validation score increased.  Saving model ...
2025-02-20 19:47:36,802 - {'epoch': 8, 'rec_loss': '8.0709'}
2025-02-20 19:47:53,786 - {'Epoch': 8, 'HR@5': '0.0466', 'NDCG@5': '0.0326', 'HR@10': '0.0667', 'NDCG@10': '0.0391', 'HR@20': '0.0958', 'NDCG@20': '0.0464'}
2025-02-20 19:47:53,791 - Validation score increased.  Saving model ...
2025-02-20 19:48:46,149 - {'epoch': 9, 'rec_loss': '8.0117'}
2025-02-20 19:49:05,073 - {'Epoch': 9, 'HR@5': '0.0480', 'NDCG@5': '0.0332', 'HR@10': '0.0692', 'NDCG@10': '0.0400', 'HR@20': '0.0981', 'NDCG@20': '0.0472'}
2025-02-20 19:49:05,078 - Validation score increased.  Saving model ...
2025-02-20 19:49:56,089 - {'epoch': 10, 'rec_loss': '7.9662'}
2025-02-20 19:50:12,873 - {'Epoch': 10, 'HR@5': '0.0486', 'NDCG@5': '0.0338', 'HR@10': '0.0690', 'NDCG@10': '0.0404', 'HR@20': '0.0992', 'NDCG@20': '0.0480'}
2025-02-20 19:50:12,880 - Validation score increased.  Saving model ...
2025-02-20 19:51:02,255 - {'epoch': 11, 'rec_loss': '7.9268'}
2025-02-20 19:51:20,002 - {'Epoch': 11, 'HR@5': '0.0499', 'NDCG@5': '0.0346', 'HR@10': '0.0701', 'NDCG@10': '0.0411', 'HR@20': '0.0994', 'NDCG@20': '0.0485'}
2025-02-20 19:51:20,009 - Validation score increased.  Saving model ...
2025-02-20 19:52:10,895 - {'epoch': 12, 'rec_loss': '7.8861'}
2025-02-20 19:52:27,952 - {'Epoch': 12, 'HR@5': '0.0493', 'NDCG@5': '0.0340', 'HR@10': '0.0710', 'NDCG@10': '0.0410', 'HR@20': '0.1002', 'NDCG@20': '0.0483'}
2025-02-20 19:52:27,958 - EarlyStopping counter: 1 out of 10
2025-02-20 19:53:17,226 - {'epoch': 13, 'rec_loss': '7.8591'}
2025-02-20 19:53:34,361 - {'Epoch': 13, 'HR@5': '0.0508', 'NDCG@5': '0.0349', 'HR@10': '0.0722', 'NDCG@10': '0.0418', 'HR@20': '0.1016', 'NDCG@20': '0.0492'}
2025-02-20 19:53:34,368 - Validation score increased.  Saving model ...
2025-02-20 19:54:25,510 - {'epoch': 14, 'rec_loss': '7.8266'}
2025-02-20 19:54:42,541 - {'Epoch': 14, 'HR@5': '0.0503', 'NDCG@5': '0.0349', 'HR@10': '0.0719', 'NDCG@10': '0.0419', 'HR@20': '0.1016', 'NDCG@20': '0.0494'}
2025-02-20 19:54:42,543 - Validation score increased.  Saving model ...
2025-02-20 19:55:33,762 - {'epoch': 15, 'rec_loss': '7.8040'}
2025-02-20 19:55:50,487 - {'Epoch': 15, 'HR@5': '0.0505', 'NDCG@5': '0.0351', 'HR@10': '0.0726', 'NDCG@10': '0.0422', 'HR@20': '0.1021', 'NDCG@20': '0.0496'}
2025-02-20 19:55:50,489 - Validation score increased.  Saving model ...
2025-02-20 19:56:46,083 - {'epoch': 16, 'rec_loss': '7.7745'}
2025-02-20 19:57:03,719 - {'Epoch': 16, 'HR@5': '0.0500', 'NDCG@5': '0.0348', 'HR@10': '0.0728', 'NDCG@10': '0.0421', 'HR@20': '0.1026', 'NDCG@20': '0.0496'}
2025-02-20 19:57:03,723 - Validation score increased.  Saving model ...
2025-02-20 19:57:56,385 - {'epoch': 17, 'rec_loss': '7.7593'}
2025-02-20 19:58:13,389 - {'Epoch': 17, 'HR@5': '0.0508', 'NDCG@5': '0.0351', 'HR@10': '0.0735', 'NDCG@10': '0.0424', 'HR@20': '0.1030', 'NDCG@20': '0.0498'}
2025-02-20 19:58:13,396 - Validation score increased.  Saving model ...
2025-02-20 19:59:10,081 - {'epoch': 18, 'rec_loss': '7.7399'}
2025-02-20 19:59:27,833 - {'Epoch': 18, 'HR@5': '0.0513', 'NDCG@5': '0.0357', 'HR@10': '0.0740', 'NDCG@10': '0.0430', 'HR@20': '0.1036', 'NDCG@20': '0.0505'}
2025-02-20 19:59:27,838 - Validation score increased.  Saving model ...
2025-02-20 20:00:22,204 - {'epoch': 19, 'rec_loss': '7.7188'}
2025-02-20 20:00:39,073 - {'Epoch': 19, 'HR@5': '0.0513', 'NDCG@5': '0.0352', 'HR@10': '0.0740', 'NDCG@10': '0.0425', 'HR@20': '0.1046', 'NDCG@20': '0.0502'}
2025-02-20 20:00:39,077 - EarlyStopping counter: 1 out of 10
2025-02-20 20:01:27,563 - {'epoch': 20, 'rec_loss': '7.7068'}
2025-02-20 20:01:44,474 - {'Epoch': 20, 'HR@5': '0.0503', 'NDCG@5': '0.0355', 'HR@10': '0.0738', 'NDCG@10': '0.0431', 'HR@20': '0.1049', 'NDCG@20': '0.0509'}
2025-02-20 20:01:44,475 - Validation score increased.  Saving model ...
2025-02-20 20:02:36,347 - {'epoch': 21, 'rec_loss': '7.6890'}
2025-02-20 20:02:53,363 - {'Epoch': 21, 'HR@5': '0.0504', 'NDCG@5': '0.0346', 'HR@10': '0.0742', 'NDCG@10': '0.0423', 'HR@20': '0.1037', 'NDCG@20': '0.0497'}
2025-02-20 20:02:53,364 - EarlyStopping counter: 1 out of 10
2025-02-20 20:03:43,180 - {'epoch': 22, 'rec_loss': '7.6748'}
2025-02-20 20:03:59,961 - {'Epoch': 22, 'HR@5': '0.0523', 'NDCG@5': '0.0357', 'HR@10': '0.0746', 'NDCG@10': '0.0428', 'HR@20': '0.1042', 'NDCG@20': '0.0503'}
2025-02-20 20:03:59,962 - EarlyStopping counter: 2 out of 10
2025-02-20 20:04:51,141 - {'epoch': 23, 'rec_loss': '7.6577'}
2025-02-20 20:05:08,254 - {'Epoch': 23, 'HR@5': '0.0513', 'NDCG@5': '0.0353', 'HR@10': '0.0746', 'NDCG@10': '0.0429', 'HR@20': '0.1044', 'NDCG@20': '0.0504'}
2025-02-20 20:05:08,259 - EarlyStopping counter: 3 out of 10
2025-02-20 20:06:00,953 - {'epoch': 24, 'rec_loss': '7.6487'}
2025-02-20 20:06:18,729 - {'Epoch': 24, 'HR@5': '0.0520', 'NDCG@5': '0.0360', 'HR@10': '0.0744', 'NDCG@10': '0.0432', 'HR@20': '0.1042', 'NDCG@20': '0.0506'}
2025-02-20 20:06:18,731 - EarlyStopping counter: 4 out of 10
2025-02-20 20:07:18,702 - {'epoch': 25, 'rec_loss': '7.6350'}
2025-02-20 20:07:35,485 - {'Epoch': 25, 'HR@5': '0.0519', 'NDCG@5': '0.0360', 'HR@10': '0.0749', 'NDCG@10': '0.0434', 'HR@20': '0.1049', 'NDCG@20': '0.0510'}
2025-02-20 20:07:35,491 - Validation score increased.  Saving model ...
2025-02-20 20:08:34,568 - {'epoch': 26, 'rec_loss': '7.6235'}
2025-02-20 20:08:51,996 - {'Epoch': 26, 'HR@5': '0.0513', 'NDCG@5': '0.0354', 'HR@10': '0.0740', 'NDCG@10': '0.0427', 'HR@20': '0.1035', 'NDCG@20': '0.0501'}
2025-02-20 20:08:52,002 - EarlyStopping counter: 1 out of 10
2025-02-20 20:09:46,267 - {'epoch': 27, 'rec_loss': '7.6094'}
2025-02-20 20:10:03,009 - {'Epoch': 27, 'HR@5': '0.0502', 'NDCG@5': '0.0348', 'HR@10': '0.0741', 'NDCG@10': '0.0425', 'HR@20': '0.1032', 'NDCG@20': '0.0498'}
2025-02-20 20:10:03,010 - EarlyStopping counter: 2 out of 10
2025-02-20 20:10:57,008 - {'epoch': 28, 'rec_loss': '7.5981'}
2025-02-20 20:11:14,365 - {'Epoch': 28, 'HR@5': '0.0519', 'NDCG@5': '0.0357', 'HR@10': '0.0753', 'NDCG@10': '0.0433', 'HR@20': '0.1057', 'NDCG@20': '0.0509'}
2025-02-20 20:11:14,369 - EarlyStopping counter: 3 out of 10
2025-02-20 20:12:07,917 - {'epoch': 29, 'rec_loss': '7.5948'}
2025-02-20 20:12:26,180 - {'Epoch': 29, 'HR@5': '0.0502', 'NDCG@5': '0.0345', 'HR@10': '0.0738', 'NDCG@10': '0.0421', 'HR@20': '0.1049', 'NDCG@20': '0.0499'}
2025-02-20 20:12:26,186 - EarlyStopping counter: 4 out of 10
2025-02-20 20:13:18,214 - {'epoch': 30, 'rec_loss': '7.5835'}
2025-02-20 20:13:36,196 - {'Epoch': 30, 'HR@5': '0.0519', 'NDCG@5': '0.0357', 'HR@10': '0.0755', 'NDCG@10': '0.0434', 'HR@20': '0.1055', 'NDCG@20': '0.0509'}
2025-02-20 20:13:36,198 - EarlyStopping counter: 5 out of 10
2025-02-20 20:14:28,701 - {'epoch': 31, 'rec_loss': '7.5757'}
2025-02-20 20:14:48,310 - {'Epoch': 31, 'HR@5': '0.0515', 'NDCG@5': '0.0356', 'HR@10': '0.0747', 'NDCG@10': '0.0430', 'HR@20': '0.1045', 'NDCG@20': '0.0506'}
2025-02-20 20:14:48,316 - EarlyStopping counter: 6 out of 10
2025-02-20 20:15:43,063 - {'epoch': 32, 'rec_loss': '7.5691'}
2025-02-20 20:16:01,290 - {'Epoch': 32, 'HR@5': '0.0508', 'NDCG@5': '0.0353', 'HR@10': '0.0756', 'NDCG@10': '0.0432', 'HR@20': '0.1050', 'NDCG@20': '0.0506'}
2025-02-20 20:16:01,292 - EarlyStopping counter: 7 out of 10
2025-02-20 20:16:55,168 - {'epoch': 33, 'rec_loss': '7.5582'}
2025-02-20 20:17:12,328 - {'Epoch': 33, 'HR@5': '0.0516', 'NDCG@5': '0.0358', 'HR@10': '0.0744', 'NDCG@10': '0.0432', 'HR@20': '0.1059', 'NDCG@20': '0.0511'}
2025-02-20 20:17:12,329 - Validation score increased.  Saving model ...
2025-02-20 20:18:12,298 - {'epoch': 34, 'rec_loss': '7.5528'}
2025-02-20 20:18:31,345 - {'Epoch': 34, 'HR@5': '0.0514', 'NDCG@5': '0.0358', 'HR@10': '0.0744', 'NDCG@10': '0.0433', 'HR@20': '0.1044', 'NDCG@20': '0.0508'}
2025-02-20 20:18:31,347 - EarlyStopping counter: 1 out of 10
2025-02-20 20:19:26,122 - {'epoch': 35, 'rec_loss': '7.5429'}
2025-02-20 20:19:45,295 - {'Epoch': 35, 'HR@5': '0.0523', 'NDCG@5': '0.0363', 'HR@10': '0.0754', 'NDCG@10': '0.0436', 'HR@20': '0.1051', 'NDCG@20': '0.0511'}
2025-02-20 20:19:45,296 - Validation score increased.  Saving model ...
2025-02-20 20:20:42,259 - {'epoch': 36, 'rec_loss': '7.5353'}
2025-02-20 20:20:59,499 - {'Epoch': 36, 'HR@5': '0.0515', 'NDCG@5': '0.0362', 'HR@10': '0.0746', 'NDCG@10': '0.0437', 'HR@20': '0.1050', 'NDCG@20': '0.0513'}
2025-02-20 20:20:59,508 - Validation score increased.  Saving model ...
2025-02-20 20:21:55,294 - {'epoch': 37, 'rec_loss': '7.5205'}
2025-02-20 20:22:12,386 - {'Epoch': 37, 'HR@5': '0.0517', 'NDCG@5': '0.0357', 'HR@10': '0.0745', 'NDCG@10': '0.0430', 'HR@20': '0.1045', 'NDCG@20': '0.0506'}
2025-02-20 20:22:12,388 - EarlyStopping counter: 1 out of 10
2025-02-20 20:23:05,577 - {'epoch': 38, 'rec_loss': '7.5218'}
2025-02-20 20:23:22,967 - {'Epoch': 38, 'HR@5': '0.0512', 'NDCG@5': '0.0353', 'HR@10': '0.0737', 'NDCG@10': '0.0426', 'HR@20': '0.1036', 'NDCG@20': '0.0501'}
2025-02-20 20:23:22,973 - EarlyStopping counter: 2 out of 10
2025-02-20 20:24:15,723 - {'epoch': 39, 'rec_loss': '7.5145'}
2025-02-20 20:24:35,106 - {'Epoch': 39, 'HR@5': '0.0523', 'NDCG@5': '0.0365', 'HR@10': '0.0750', 'NDCG@10': '0.0438', 'HR@20': '0.1041', 'NDCG@20': '0.0512'}
2025-02-20 20:24:35,107 - EarlyStopping counter: 3 out of 10
2025-02-20 20:25:31,249 - {'epoch': 40, 'rec_loss': '7.5028'}
2025-02-20 20:25:50,813 - {'Epoch': 40, 'HR@5': '0.0518', 'NDCG@5': '0.0359', 'HR@10': '0.0737', 'NDCG@10': '0.0429', 'HR@20': '0.1036', 'NDCG@20': '0.0505'}
2025-02-20 20:25:50,818 - EarlyStopping counter: 4 out of 10
2025-02-20 20:26:45,981 - {'epoch': 41, 'rec_loss': '7.4959'}
2025-02-20 20:27:05,207 - {'Epoch': 41, 'HR@5': '0.0514', 'NDCG@5': '0.0358', 'HR@10': '0.0740', 'NDCG@10': '0.0431', 'HR@20': '0.1035', 'NDCG@20': '0.0505'}
2025-02-20 20:27:05,209 - EarlyStopping counter: 5 out of 10
2025-02-20 20:28:04,206 - {'epoch': 42, 'rec_loss': '7.4943'}
2025-02-20 20:28:22,212 - {'Epoch': 42, 'HR@5': '0.0513', 'NDCG@5': '0.0357', 'HR@10': '0.0736', 'NDCG@10': '0.0429', 'HR@20': '0.1036', 'NDCG@20': '0.0504'}
2025-02-20 20:28:22,218 - EarlyStopping counter: 6 out of 10
2025-02-20 20:29:16,770 - {'epoch': 43, 'rec_loss': '7.4874'}
2025-02-20 20:29:33,856 - {'Epoch': 43, 'HR@5': '0.0523', 'NDCG@5': '0.0361', 'HR@10': '0.0739', 'NDCG@10': '0.0430', 'HR@20': '0.1031', 'NDCG@20': '0.0504'}
2025-02-20 20:29:33,859 - EarlyStopping counter: 7 out of 10
2025-02-20 20:30:32,849 - {'epoch': 44, 'rec_loss': '7.4808'}
2025-02-20 20:30:50,214 - {'Epoch': 44, 'HR@5': '0.0518', 'NDCG@5': '0.0359', 'HR@10': '0.0746', 'NDCG@10': '0.0433', 'HR@20': '0.1037', 'NDCG@20': '0.0506'}
2025-02-20 20:30:50,215 - EarlyStopping counter: 8 out of 10
2025-02-20 20:31:44,219 - {'epoch': 45, 'rec_loss': '7.4705'}
2025-02-20 20:32:03,478 - {'Epoch': 45, 'HR@5': '0.0518', 'NDCG@5': '0.0361', 'HR@10': '0.0737', 'NDCG@10': '0.0432', 'HR@20': '0.1037', 'NDCG@20': '0.0507'}
2025-02-20 20:32:03,482 - EarlyStopping counter: 9 out of 10
2025-02-20 20:32:58,126 - {'epoch': 46, 'rec_loss': '7.4728'}
2025-02-20 20:33:15,294 - {'Epoch': 46, 'HR@5': '0.0517', 'NDCG@5': '0.0358', 'HR@10': '0.0743', 'NDCG@10': '0.0431', 'HR@20': '0.1037', 'NDCG@20': '0.0505'}
2025-02-20 20:33:15,296 - EarlyStopping counter: 10 out of 10
2025-02-20 20:33:15,296 - Early stopping
2025-02-20 20:33:15,296 - ---------------Test Score---------------
2025-02-20 20:33:32,403 - {'Epoch': 0, 'HR@5': '0.0419', 'NDCG@5': '0.0293', 'HR@10': '0.0614', 'NDCG@10': '0.0356', 'HR@20': '0.0866', 'NDCG@20': '0.0419'}
2025-02-20 20:33:32,404 - Scale_Sports
2025-02-20 20:33:32,405 - {'Epoch': 0, 'HR@5': '0.0419', 'NDCG@5': '0.0293', 'HR@10': '0.0614', 'NDCG@10': '0.0356', 'HR@20': '0.0866', 'NDCG@20': '0.0419'}
2025-02-20 21:07:30,954 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25, 10, 5], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-20 21:07:33,983 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-20 21:07:33,988 - Total Parameters: 1328529
2025-02-20 21:08:39,462 - {'epoch': 0, 'rec_loss': '9.4221'}
2025-02-20 21:08:58,943 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0054', 'HR@10': '0.0127', 'NDCG@10': '0.0069', 'HR@20': '0.0221', 'NDCG@20': '0.0092'}
2025-02-20 21:08:58,948 - Validation score increased.  Saving model ...
2025-02-20 21:10:05,779 - {'epoch': 1, 'rec_loss': '9.1711'}
2025-02-20 21:10:26,197 - {'Epoch': 1, 'HR@5': '0.0170', 'NDCG@5': '0.0110', 'HR@10': '0.0271', 'NDCG@10': '0.0142', 'HR@20': '0.0424', 'NDCG@20': '0.0181'}
2025-02-20 21:10:26,199 - Validation score increased.  Saving model ...
2025-02-20 21:11:34,278 - {'epoch': 2, 'rec_loss': '8.8198'}
2025-02-20 21:11:51,858 - {'Epoch': 2, 'HR@5': '0.0255', 'NDCG@5': '0.0164', 'HR@10': '0.0402', 'NDCG@10': '0.0211', 'HR@20': '0.0610', 'NDCG@20': '0.0263'}
2025-02-20 21:11:51,864 - Validation score increased.  Saving model ...
2025-02-20 21:12:57,038 - {'epoch': 3, 'rec_loss': '8.5725'}
2025-02-20 21:13:15,751 - {'Epoch': 3, 'HR@5': '0.0339', 'NDCG@5': '0.0229', 'HR@10': '0.0495', 'NDCG@10': '0.0279', 'HR@20': '0.0728', 'NDCG@20': '0.0337'}
2025-02-20 21:13:15,757 - Validation score increased.  Saving model ...
2025-02-20 21:14:23,560 - {'epoch': 4, 'rec_loss': '8.3849'}
2025-02-20 21:14:42,790 - {'Epoch': 4, 'HR@5': '0.0392', 'NDCG@5': '0.0271', 'HR@10': '0.0579', 'NDCG@10': '0.0332', 'HR@20': '0.0828', 'NDCG@20': '0.0394'}
2025-02-20 21:14:42,795 - Validation score increased.  Saving model ...
2025-02-20 21:15:56,731 - {'epoch': 5, 'rec_loss': '8.2473'}
2025-02-20 21:16:17,800 - {'Epoch': 5, 'HR@5': '0.0439', 'NDCG@5': '0.0300', 'HR@10': '0.0621', 'NDCG@10': '0.0358', 'HR@20': '0.0882', 'NDCG@20': '0.0423'}
2025-02-20 21:16:17,805 - Validation score increased.  Saving model ...
2025-02-20 21:17:24,954 - {'epoch': 6, 'rec_loss': '8.1361'}
2025-02-20 21:17:43,310 - {'Epoch': 6, 'HR@5': '0.0438', 'NDCG@5': '0.0304', 'HR@10': '0.0632', 'NDCG@10': '0.0366', 'HR@20': '0.0899', 'NDCG@20': '0.0434'}
2025-02-20 21:17:43,312 - Validation score increased.  Saving model ...
2025-02-20 21:18:54,905 - {'epoch': 7, 'rec_loss': '8.0532'}
2025-02-20 21:19:16,265 - {'Epoch': 7, 'HR@5': '0.0465', 'NDCG@5': '0.0328', 'HR@10': '0.0662', 'NDCG@10': '0.0391', 'HR@20': '0.0933', 'NDCG@20': '0.0459'}
2025-02-20 21:19:16,271 - Validation score increased.  Saving model ...
2025-02-20 21:20:30,116 - {'epoch': 8, 'rec_loss': '7.9872'}
2025-02-20 21:20:52,564 - {'Epoch': 8, 'HR@5': '0.0464', 'NDCG@5': '0.0321', 'HR@10': '0.0673', 'NDCG@10': '0.0388', 'HR@20': '0.0961', 'NDCG@20': '0.0461'}
2025-02-20 21:20:52,569 - Validation score increased.  Saving model ...
2025-02-20 21:22:05,672 - {'epoch': 9, 'rec_loss': '7.9318'}
2025-02-20 21:22:26,874 - {'Epoch': 9, 'HR@5': '0.0474', 'NDCG@5': '0.0332', 'HR@10': '0.0690', 'NDCG@10': '0.0401', 'HR@20': '0.0972', 'NDCG@20': '0.0472'}
2025-02-20 21:22:26,876 - Validation score increased.  Saving model ...
2025-02-20 21:23:34,130 - {'epoch': 10, 'rec_loss': '7.8809'}
2025-02-20 21:23:52,672 - {'Epoch': 10, 'HR@5': '0.0489', 'NDCG@5': '0.0345', 'HR@10': '0.0693', 'NDCG@10': '0.0410', 'HR@20': '0.0996', 'NDCG@20': '0.0486'}
2025-02-20 21:23:52,678 - Validation score increased.  Saving model ...
2025-02-20 21:25:00,049 - {'epoch': 11, 'rec_loss': '7.8424'}
2025-02-20 21:25:20,406 - {'Epoch': 11, 'HR@5': '0.0486', 'NDCG@5': '0.0340', 'HR@10': '0.0709', 'NDCG@10': '0.0412', 'HR@20': '0.0994', 'NDCG@20': '0.0483'}
2025-02-20 21:25:20,408 - EarlyStopping counter: 1 out of 10
2025-02-20 21:26:31,319 - {'epoch': 12, 'rec_loss': '7.8108'}
2025-02-20 21:26:54,434 - {'Epoch': 12, 'HR@5': '0.0487', 'NDCG@5': '0.0339', 'HR@10': '0.0701', 'NDCG@10': '0.0408', 'HR@20': '0.0987', 'NDCG@20': '0.0480'}
2025-02-20 21:26:54,438 - EarlyStopping counter: 2 out of 10
2025-02-20 21:28:03,558 - {'epoch': 13, 'rec_loss': '7.7824'}
2025-02-20 21:28:23,717 - {'Epoch': 13, 'HR@5': '0.0493', 'NDCG@5': '0.0344', 'HR@10': '0.0716', 'NDCG@10': '0.0416', 'HR@20': '0.1009', 'NDCG@20': '0.0490'}
2025-02-20 21:28:23,719 - Validation score increased.  Saving model ...
2025-02-20 21:29:32,985 - {'epoch': 14, 'rec_loss': '7.7501'}
2025-02-20 21:29:52,788 - {'Epoch': 14, 'HR@5': '0.0505', 'NDCG@5': '0.0350', 'HR@10': '0.0712', 'NDCG@10': '0.0416', 'HR@20': '0.0998', 'NDCG@20': '0.0488'}
2025-02-20 21:29:52,793 - EarlyStopping counter: 1 out of 10
2025-02-20 21:31:02,124 - {'epoch': 15, 'rec_loss': '7.7271'}
2025-02-20 21:31:22,683 - {'Epoch': 15, 'HR@5': '0.0503', 'NDCG@5': '0.0350', 'HR@10': '0.0726', 'NDCG@10': '0.0422', 'HR@20': '0.1011', 'NDCG@20': '0.0494'}
2025-02-20 21:31:22,685 - Validation score increased.  Saving model ...
2025-02-20 21:32:32,223 - {'epoch': 16, 'rec_loss': '7.7067'}
2025-02-20 21:32:52,735 - {'Epoch': 16, 'HR@5': '0.0509', 'NDCG@5': '0.0359', 'HR@10': '0.0715', 'NDCG@10': '0.0426', 'HR@20': '0.1016', 'NDCG@20': '0.0502'}
2025-02-20 21:32:52,739 - Validation score increased.  Saving model ...
2025-02-20 21:34:01,091 - {'epoch': 17, 'rec_loss': '7.6820'}
2025-02-20 21:34:20,910 - {'Epoch': 17, 'HR@5': '0.0507', 'NDCG@5': '0.0356', 'HR@10': '0.0711', 'NDCG@10': '0.0422', 'HR@20': '0.1006', 'NDCG@20': '0.0496'}
2025-02-20 21:34:20,911 - EarlyStopping counter: 1 out of 10
2025-02-20 21:35:28,643 - {'epoch': 18, 'rec_loss': '7.6600'}
2025-02-20 21:35:51,951 - {'Epoch': 18, 'HR@5': '0.0505', 'NDCG@5': '0.0355', 'HR@10': '0.0731', 'NDCG@10': '0.0427', 'HR@20': '0.1017', 'NDCG@20': '0.0500'}
2025-02-20 21:35:51,959 - EarlyStopping counter: 2 out of 10
2025-02-20 21:37:03,913 - {'epoch': 19, 'rec_loss': '7.6390'}
2025-02-20 21:37:22,611 - {'Epoch': 19, 'HR@5': '0.0508', 'NDCG@5': '0.0355', 'HR@10': '0.0730', 'NDCG@10': '0.0426', 'HR@20': '0.1017', 'NDCG@20': '0.0498'}
2025-02-20 21:37:22,616 - EarlyStopping counter: 3 out of 10
2025-02-20 21:38:30,004 - {'epoch': 20, 'rec_loss': '7.6315'}
2025-02-20 21:38:50,691 - {'Epoch': 20, 'HR@5': '0.0512', 'NDCG@5': '0.0362', 'HR@10': '0.0723', 'NDCG@10': '0.0430', 'HR@20': '0.1010', 'NDCG@20': '0.0502'}
2025-02-20 21:38:50,697 - Validation score increased.  Saving model ...
2025-02-20 21:39:59,640 - {'epoch': 21, 'rec_loss': '7.6106'}
2025-02-20 21:40:21,583 - {'Epoch': 21, 'HR@5': '0.0505', 'NDCG@5': '0.0353', 'HR@10': '0.0728', 'NDCG@10': '0.0425', 'HR@20': '0.1020', 'NDCG@20': '0.0498'}
2025-02-20 21:40:21,585 - EarlyStopping counter: 1 out of 10
2025-02-20 21:41:30,715 - {'epoch': 22, 'rec_loss': '7.5990'}
2025-02-20 21:41:51,781 - {'Epoch': 22, 'HR@5': '0.0515', 'NDCG@5': '0.0357', 'HR@10': '0.0725', 'NDCG@10': '0.0424', 'HR@20': '0.1020', 'NDCG@20': '0.0498'}
2025-02-20 21:41:51,783 - EarlyStopping counter: 2 out of 10
2025-02-20 21:42:57,962 - {'epoch': 23, 'rec_loss': '7.5820'}
2025-02-20 21:43:17,481 - {'Epoch': 23, 'HR@5': '0.0507', 'NDCG@5': '0.0357', 'HR@10': '0.0726', 'NDCG@10': '0.0428', 'HR@20': '0.1014', 'NDCG@20': '0.0501'}
2025-02-20 21:43:17,488 - EarlyStopping counter: 3 out of 10
2025-02-20 21:44:23,994 - {'epoch': 24, 'rec_loss': '7.5706'}
2025-02-20 21:44:43,424 - {'Epoch': 24, 'HR@5': '0.0506', 'NDCG@5': '0.0352', 'HR@10': '0.0729', 'NDCG@10': '0.0424', 'HR@20': '0.1021', 'NDCG@20': '0.0498'}
2025-02-20 21:44:43,429 - EarlyStopping counter: 4 out of 10
2025-02-20 21:45:46,710 - {'epoch': 25, 'rec_loss': '7.5531'}
2025-02-20 21:46:05,413 - {'Epoch': 25, 'HR@5': '0.0505', 'NDCG@5': '0.0351', 'HR@10': '0.0718', 'NDCG@10': '0.0420', 'HR@20': '0.1014', 'NDCG@20': '0.0494'}
2025-02-20 21:46:05,417 - EarlyStopping counter: 5 out of 10
2025-02-20 21:47:10,921 - {'epoch': 26, 'rec_loss': '7.5399'}
2025-02-20 21:47:29,241 - {'Epoch': 26, 'HR@5': '0.0511', 'NDCG@5': '0.0355', 'HR@10': '0.0732', 'NDCG@10': '0.0426', 'HR@20': '0.1031', 'NDCG@20': '0.0501'}
2025-02-20 21:47:29,244 - EarlyStopping counter: 6 out of 10
2025-02-20 21:48:36,111 - {'epoch': 27, 'rec_loss': '7.5303'}
2025-02-20 21:48:57,094 - {'Epoch': 27, 'HR@5': '0.0511', 'NDCG@5': '0.0354', 'HR@10': '0.0730', 'NDCG@10': '0.0424', 'HR@20': '0.1021', 'NDCG@20': '0.0497'}
2025-02-20 21:48:57,099 - EarlyStopping counter: 7 out of 10
2025-02-20 21:50:02,883 - {'epoch': 28, 'rec_loss': '7.5191'}
2025-02-20 21:50:23,826 - {'Epoch': 28, 'HR@5': '0.0502', 'NDCG@5': '0.0352', 'HR@10': '0.0730', 'NDCG@10': '0.0426', 'HR@20': '0.1029', 'NDCG@20': '0.0501'}
2025-02-20 21:50:23,831 - EarlyStopping counter: 8 out of 10
2025-02-20 21:51:33,189 - {'epoch': 29, 'rec_loss': '7.5106'}
2025-02-20 21:51:51,367 - {'Epoch': 29, 'HR@5': '0.0512', 'NDCG@5': '0.0356', 'HR@10': '0.0733', 'NDCG@10': '0.0427', 'HR@20': '0.1037', 'NDCG@20': '0.0503'}
2025-02-20 21:51:51,371 - Validation score increased.  Saving model ...
2025-02-20 21:52:57,434 - {'epoch': 30, 'rec_loss': '7.4965'}
2025-02-20 21:53:17,101 - {'Epoch': 30, 'HR@5': '0.0511', 'NDCG@5': '0.0355', 'HR@10': '0.0736', 'NDCG@10': '0.0428', 'HR@20': '0.1034', 'NDCG@20': '0.0502'}
2025-02-20 21:53:17,106 - EarlyStopping counter: 1 out of 10
2025-02-20 21:54:21,766 - {'epoch': 31, 'rec_loss': '7.4906'}
2025-02-20 21:54:42,775 - {'Epoch': 31, 'HR@5': '0.0514', 'NDCG@5': '0.0358', 'HR@10': '0.0727', 'NDCG@10': '0.0427', 'HR@20': '0.1024', 'NDCG@20': '0.0501'}
2025-02-20 21:54:42,781 - EarlyStopping counter: 2 out of 10
2025-02-20 21:55:49,816 - {'epoch': 32, 'rec_loss': '7.4732'}
2025-02-20 21:56:08,448 - {'Epoch': 32, 'HR@5': '0.0512', 'NDCG@5': '0.0355', 'HR@10': '0.0739', 'NDCG@10': '0.0428', 'HR@20': '0.1023', 'NDCG@20': '0.0499'}
2025-02-20 21:56:08,454 - EarlyStopping counter: 3 out of 10
2025-02-20 21:57:16,735 - {'epoch': 33, 'rec_loss': '7.4774'}
2025-02-20 21:57:36,073 - {'Epoch': 33, 'HR@5': '0.0521', 'NDCG@5': '0.0367', 'HR@10': '0.0739', 'NDCG@10': '0.0437', 'HR@20': '0.1024', 'NDCG@20': '0.0509'}
2025-02-20 21:57:36,075 - Validation score increased.  Saving model ...
2025-02-20 21:58:41,652 - {'epoch': 34, 'rec_loss': '7.4629'}
2025-02-20 21:59:01,537 - {'Epoch': 34, 'HR@5': '0.0517', 'NDCG@5': '0.0362', 'HR@10': '0.0733', 'NDCG@10': '0.0432', 'HR@20': '0.1021', 'NDCG@20': '0.0504'}
2025-02-20 21:59:01,539 - EarlyStopping counter: 1 out of 10
2025-02-20 22:00:10,755 - {'epoch': 35, 'rec_loss': '7.4564'}
2025-02-20 22:00:31,871 - {'Epoch': 35, 'HR@5': '0.0527', 'NDCG@5': '0.0366', 'HR@10': '0.0741', 'NDCG@10': '0.0434', 'HR@20': '0.1030', 'NDCG@20': '0.0507'}
2025-02-20 22:00:31,877 - EarlyStopping counter: 2 out of 10
2025-02-20 22:01:41,451 - {'epoch': 36, 'rec_loss': '7.4430'}
2025-02-20 22:01:59,749 - {'Epoch': 36, 'HR@5': '0.0507', 'NDCG@5': '0.0350', 'HR@10': '0.0725', 'NDCG@10': '0.0420', 'HR@20': '0.1022', 'NDCG@20': '0.0494'}
2025-02-20 22:01:59,751 - EarlyStopping counter: 3 out of 10
2025-02-20 22:03:05,338 - {'epoch': 37, 'rec_loss': '7.4409'}
2025-02-20 22:03:23,536 - {'Epoch': 37, 'HR@5': '0.0505', 'NDCG@5': '0.0351', 'HR@10': '0.0722', 'NDCG@10': '0.0422', 'HR@20': '0.1035', 'NDCG@20': '0.0500'}
2025-02-20 22:03:23,538 - EarlyStopping counter: 4 out of 10
2025-02-20 22:04:28,104 - {'epoch': 38, 'rec_loss': '7.4329'}
2025-02-20 22:04:49,059 - {'Epoch': 38, 'HR@5': '0.0502', 'NDCG@5': '0.0347', 'HR@10': '0.0717', 'NDCG@10': '0.0416', 'HR@20': '0.1029', 'NDCG@20': '0.0494'}
2025-02-20 22:04:49,063 - EarlyStopping counter: 5 out of 10
2025-02-20 22:05:53,607 - {'epoch': 39, 'rec_loss': '7.4223'}
2025-02-20 22:06:14,444 - {'Epoch': 39, 'HR@5': '0.0517', 'NDCG@5': '0.0359', 'HR@10': '0.0736', 'NDCG@10': '0.0429', 'HR@20': '0.1025', 'NDCG@20': '0.0502'}
2025-02-20 22:06:14,446 - EarlyStopping counter: 6 out of 10
2025-02-20 22:07:20,895 - {'epoch': 40, 'rec_loss': '7.4207'}
2025-02-20 22:07:40,824 - {'Epoch': 40, 'HR@5': '0.0509', 'NDCG@5': '0.0348', 'HR@10': '0.0733', 'NDCG@10': '0.0420', 'HR@20': '0.1022', 'NDCG@20': '0.0492'}
2025-02-20 22:07:40,830 - EarlyStopping counter: 7 out of 10
2025-02-20 22:08:45,546 - {'epoch': 41, 'rec_loss': '7.4108'}
2025-02-20 22:09:06,658 - {'Epoch': 41, 'HR@5': '0.0508', 'NDCG@5': '0.0350', 'HR@10': '0.0728', 'NDCG@10': '0.0421', 'HR@20': '0.1018', 'NDCG@20': '0.0494'}
2025-02-20 22:09:06,666 - EarlyStopping counter: 8 out of 10
2025-02-20 22:10:12,672 - {'epoch': 42, 'rec_loss': '7.4036'}
2025-02-20 22:10:33,064 - {'Epoch': 42, 'HR@5': '0.0509', 'NDCG@5': '0.0353', 'HR@10': '0.0724', 'NDCG@10': '0.0422', 'HR@20': '0.1028', 'NDCG@20': '0.0499'}
2025-02-20 22:10:33,066 - EarlyStopping counter: 9 out of 10
2025-02-20 22:11:39,266 - {'epoch': 43, 'rec_loss': '7.4016'}
2025-02-20 22:12:00,248 - {'Epoch': 43, 'HR@5': '0.0501', 'NDCG@5': '0.0351', 'HR@10': '0.0719', 'NDCG@10': '0.0421', 'HR@20': '0.1023', 'NDCG@20': '0.0498'}
2025-02-20 22:12:00,254 - EarlyStopping counter: 10 out of 10
2025-02-20 22:12:00,255 - Early stopping
2025-02-20 22:12:00,255 - ---------------Test Score---------------
2025-02-20 22:12:18,331 - {'Epoch': 0, 'HR@5': '0.0417', 'NDCG@5': '0.0296', 'HR@10': '0.0610', 'NDCG@10': '0.0358', 'HR@20': '0.0856', 'NDCG@20': '0.0420'}
2025-02-20 22:12:18,333 - Scale_Sports
2025-02-20 22:12:18,333 - {'Epoch': 0, 'HR@5': '0.0417', 'NDCG@5': '0.0296', 'HR@10': '0.0610', 'NDCG@10': '0.0358', 'HR@20': '0.0856', 'NDCG@20': '0.0420'}
2025-02-20 22:50:51,734 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 10], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-20 22:50:54,641 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-20 22:50:54,653 - Total Parameters: 1328854
2025-02-20 22:51:34,431 - {'epoch': 0, 'rec_loss': '9.4021'}
2025-02-20 22:51:52,352 - {'Epoch': 0, 'HR@5': '0.0081', 'NDCG@5': '0.0054', 'HR@10': '0.0127', 'NDCG@10': '0.0069', 'HR@20': '0.0224', 'NDCG@20': '0.0093'}
2025-02-20 22:51:52,355 - Validation score increased.  Saving model ...
2025-02-20 22:52:31,349 - {'epoch': 1, 'rec_loss': '9.2228'}
2025-02-20 22:52:48,420 - {'Epoch': 1, 'HR@5': '0.0133', 'NDCG@5': '0.0083', 'HR@10': '0.0234', 'NDCG@10': '0.0115', 'HR@20': '0.0377', 'NDCG@20': '0.0151'}
2025-02-20 22:52:48,425 - Validation score increased.  Saving model ...
2025-02-20 22:53:26,627 - {'epoch': 2, 'rec_loss': '8.9611'}
2025-02-20 22:53:44,173 - {'Epoch': 2, 'HR@5': '0.0187', 'NDCG@5': '0.0118', 'HR@10': '0.0301', 'NDCG@10': '0.0155', 'HR@20': '0.0486', 'NDCG@20': '0.0201'}
2025-02-20 22:53:44,174 - Validation score increased.  Saving model ...
2025-02-20 22:54:23,125 - {'epoch': 3, 'rec_loss': '8.7695'}
2025-02-20 22:54:40,339 - {'Epoch': 3, 'HR@5': '0.0226', 'NDCG@5': '0.0148', 'HR@10': '0.0388', 'NDCG@10': '0.0201', 'HR@20': '0.0607', 'NDCG@20': '0.0256'}
2025-02-20 22:54:40,341 - Validation score increased.  Saving model ...
2025-02-20 22:55:20,299 - {'epoch': 4, 'rec_loss': '8.6208'}
2025-02-20 22:55:36,125 - {'Epoch': 4, 'HR@5': '0.0296', 'NDCG@5': '0.0194', 'HR@10': '0.0458', 'NDCG@10': '0.0246', 'HR@20': '0.0689', 'NDCG@20': '0.0304'}
2025-02-20 22:55:36,126 - Validation score increased.  Saving model ...
2025-02-20 22:56:15,322 - {'epoch': 5, 'rec_loss': '8.4973'}
2025-02-20 22:56:33,261 - {'Epoch': 5, 'HR@5': '0.0341', 'NDCG@5': '0.0222', 'HR@10': '0.0523', 'NDCG@10': '0.0280', 'HR@20': '0.0764', 'NDCG@20': '0.0341'}
2025-02-20 22:56:33,266 - Validation score increased.  Saving model ...
2025-02-20 22:57:13,298 - {'epoch': 6, 'rec_loss': '8.3982'}
2025-02-20 22:57:31,022 - {'Epoch': 6, 'HR@5': '0.0374', 'NDCG@5': '0.0251', 'HR@10': '0.0551', 'NDCG@10': '0.0308', 'HR@20': '0.0813', 'NDCG@20': '0.0374'}
2025-02-20 22:57:31,025 - Validation score increased.  Saving model ...
2025-02-20 22:58:11,234 - {'epoch': 7, 'rec_loss': '8.3175'}
2025-02-20 22:58:28,412 - {'Epoch': 7, 'HR@5': '0.0408', 'NDCG@5': '0.0280', 'HR@10': '0.0592', 'NDCG@10': '0.0339', 'HR@20': '0.0860', 'NDCG@20': '0.0407'}
2025-02-20 22:58:28,413 - Validation score increased.  Saving model ...
2025-02-20 22:59:07,005 - {'epoch': 8, 'rec_loss': '8.2464'}
2025-02-20 22:59:24,194 - {'Epoch': 8, 'HR@5': '0.0428', 'NDCG@5': '0.0288', 'HR@10': '0.0607', 'NDCG@10': '0.0346', 'HR@20': '0.0881', 'NDCG@20': '0.0415'}
2025-02-20 22:59:24,199 - Validation score increased.  Saving model ...
2025-02-20 23:00:02,758 - {'epoch': 9, 'rec_loss': '8.1888'}
2025-02-20 23:00:18,966 - {'Epoch': 9, 'HR@5': '0.0433', 'NDCG@5': '0.0301', 'HR@10': '0.0638', 'NDCG@10': '0.0367', 'HR@20': '0.0907', 'NDCG@20': '0.0435'}
2025-02-20 23:00:18,967 - Validation score increased.  Saving model ...
2025-02-20 23:01:00,692 - {'epoch': 10, 'rec_loss': '8.1380'}
2025-02-20 23:01:17,225 - {'Epoch': 10, 'HR@5': '0.0466', 'NDCG@5': '0.0322', 'HR@10': '0.0660', 'NDCG@10': '0.0384', 'HR@20': '0.0942', 'NDCG@20': '0.0455'}
2025-02-20 23:01:17,226 - Validation score increased.  Saving model ...
2025-02-20 23:01:58,185 - {'epoch': 11, 'rec_loss': '8.0951'}
2025-02-20 23:02:16,552 - {'Epoch': 11, 'HR@5': '0.0465', 'NDCG@5': '0.0322', 'HR@10': '0.0671', 'NDCG@10': '0.0388', 'HR@20': '0.0954', 'NDCG@20': '0.0459'}
2025-02-20 23:02:16,553 - Validation score increased.  Saving model ...
2025-02-20 23:02:55,563 - {'epoch': 12, 'rec_loss': '8.0541'}
2025-02-20 23:03:11,927 - {'Epoch': 12, 'HR@5': '0.0474', 'NDCG@5': '0.0328', 'HR@10': '0.0682', 'NDCG@10': '0.0395', 'HR@20': '0.0967', 'NDCG@20': '0.0467'}
2025-02-20 23:03:11,930 - Validation score increased.  Saving model ...
2025-02-20 23:03:50,066 - {'epoch': 13, 'rec_loss': '8.0197'}
2025-02-20 23:04:08,762 - {'Epoch': 13, 'HR@5': '0.0491', 'NDCG@5': '0.0341', 'HR@10': '0.0705', 'NDCG@10': '0.0410', 'HR@20': '0.0975', 'NDCG@20': '0.0478'}
2025-02-20 23:04:08,766 - Validation score increased.  Saving model ...
2025-02-20 23:04:48,087 - {'epoch': 14, 'rec_loss': '7.9866'}
2025-02-20 23:05:06,426 - {'Epoch': 14, 'HR@5': '0.0487', 'NDCG@5': '0.0338', 'HR@10': '0.0688', 'NDCG@10': '0.0403', 'HR@20': '0.0979', 'NDCG@20': '0.0476'}
2025-02-20 23:05:06,427 - EarlyStopping counter: 1 out of 10
2025-02-20 23:05:44,643 - {'epoch': 15, 'rec_loss': '7.9604'}
2025-02-20 23:06:03,501 - {'Epoch': 15, 'HR@5': '0.0489', 'NDCG@5': '0.0341', 'HR@10': '0.0698', 'NDCG@10': '0.0409', 'HR@20': '0.0991', 'NDCG@20': '0.0483'}
2025-02-20 23:06:03,506 - Validation score increased.  Saving model ...
2025-02-20 23:06:42,812 - {'epoch': 16, 'rec_loss': '7.9419'}
2025-02-20 23:07:01,566 - {'Epoch': 16, 'HR@5': '0.0498', 'NDCG@5': '0.0349', 'HR@10': '0.0718', 'NDCG@10': '0.0419', 'HR@20': '0.1002', 'NDCG@20': '0.0491'}
2025-02-20 23:07:01,571 - Validation score increased.  Saving model ...
2025-02-20 23:07:40,669 - {'epoch': 17, 'rec_loss': '7.9136'}
2025-02-20 23:07:57,543 - {'Epoch': 17, 'HR@5': '0.0495', 'NDCG@5': '0.0346', 'HR@10': '0.0712', 'NDCG@10': '0.0416', 'HR@20': '0.0995', 'NDCG@20': '0.0488'}
2025-02-20 23:07:57,551 - EarlyStopping counter: 1 out of 10
2025-02-20 23:08:37,284 - {'epoch': 18, 'rec_loss': '7.8990'}
2025-02-20 23:08:54,558 - {'Epoch': 18, 'HR@5': '0.0505', 'NDCG@5': '0.0353', 'HR@10': '0.0719', 'NDCG@10': '0.0422', 'HR@20': '0.1008', 'NDCG@20': '0.0494'}
2025-02-20 23:08:54,559 - Validation score increased.  Saving model ...
2025-02-20 23:09:34,317 - {'epoch': 19, 'rec_loss': '7.8765'}
2025-02-20 23:09:53,302 - {'Epoch': 19, 'HR@5': '0.0502', 'NDCG@5': '0.0351', 'HR@10': '0.0726', 'NDCG@10': '0.0423', 'HR@20': '0.1008', 'NDCG@20': '0.0494'}
2025-02-20 23:09:53,308 - EarlyStopping counter: 1 out of 10
2025-02-20 23:10:33,424 - {'epoch': 20, 'rec_loss': '7.8593'}
2025-02-20 23:10:50,094 - {'Epoch': 20, 'HR@5': '0.0509', 'NDCG@5': '0.0356', 'HR@10': '0.0729', 'NDCG@10': '0.0427', 'HR@20': '0.1008', 'NDCG@20': '0.0497'}
2025-02-20 23:10:50,095 - Validation score increased.  Saving model ...
2025-02-20 23:11:29,512 - {'epoch': 21, 'rec_loss': '7.8490'}
2025-02-20 23:11:46,128 - {'Epoch': 21, 'HR@5': '0.0507', 'NDCG@5': '0.0351', 'HR@10': '0.0721', 'NDCG@10': '0.0420', 'HR@20': '0.1019', 'NDCG@20': '0.0495'}
2025-02-20 23:11:46,129 - EarlyStopping counter: 1 out of 10
2025-02-20 23:12:25,417 - {'epoch': 22, 'rec_loss': '7.8303'}
2025-02-20 23:12:43,775 - {'Epoch': 22, 'HR@5': '0.0515', 'NDCG@5': '0.0359', 'HR@10': '0.0730', 'NDCG@10': '0.0428', 'HR@20': '0.1028', 'NDCG@20': '0.0503'}
2025-02-20 23:12:43,779 - Validation score increased.  Saving model ...
2025-02-20 23:13:21,854 - {'epoch': 23, 'rec_loss': '7.8151'}
2025-02-20 23:13:40,033 - {'Epoch': 23, 'HR@5': '0.0521', 'NDCG@5': '0.0362', 'HR@10': '0.0740', 'NDCG@10': '0.0432', 'HR@20': '0.1021', 'NDCG@20': '0.0503'}
2025-02-20 23:13:40,035 - Validation score increased.  Saving model ...
2025-02-20 23:14:18,291 - {'epoch': 24, 'rec_loss': '7.8042'}
2025-02-20 23:14:37,574 - {'Epoch': 24, 'HR@5': '0.0514', 'NDCG@5': '0.0358', 'HR@10': '0.0736', 'NDCG@10': '0.0430', 'HR@20': '0.1018', 'NDCG@20': '0.0500'}
2025-02-20 23:14:37,578 - EarlyStopping counter: 1 out of 10
2025-02-20 23:15:16,108 - {'epoch': 25, 'rec_loss': '7.7840'}
2025-02-20 23:15:33,004 - {'Epoch': 25, 'HR@5': '0.0513', 'NDCG@5': '0.0359', 'HR@10': '0.0739', 'NDCG@10': '0.0432', 'HR@20': '0.1013', 'NDCG@20': '0.0501'}
2025-02-20 23:15:33,007 - EarlyStopping counter: 2 out of 10
2025-02-20 23:16:12,344 - {'epoch': 26, 'rec_loss': '7.7756'}
2025-02-20 23:16:28,648 - {'Epoch': 26, 'HR@5': '0.0527', 'NDCG@5': '0.0367', 'HR@10': '0.0737', 'NDCG@10': '0.0434', 'HR@20': '0.1028', 'NDCG@20': '0.0507'}
2025-02-20 23:16:28,651 - Validation score increased.  Saving model ...
2025-02-20 23:17:07,671 - {'epoch': 27, 'rec_loss': '7.7620'}
2025-02-20 23:17:25,819 - {'Epoch': 27, 'HR@5': '0.0521', 'NDCG@5': '0.0365', 'HR@10': '0.0748', 'NDCG@10': '0.0438', 'HR@20': '0.1041', 'NDCG@20': '0.0512'}
2025-02-20 23:17:25,820 - Validation score increased.  Saving model ...
2025-02-20 23:18:04,063 - {'epoch': 28, 'rec_loss': '7.7523'}
2025-02-20 23:18:23,326 - {'Epoch': 28, 'HR@5': '0.0516', 'NDCG@5': '0.0362', 'HR@10': '0.0744', 'NDCG@10': '0.0435', 'HR@20': '0.1032', 'NDCG@20': '0.0508'}
2025-02-20 23:18:23,330 - EarlyStopping counter: 1 out of 10
2025-02-20 23:19:01,975 - {'epoch': 29, 'rec_loss': '7.7393'}
2025-02-20 23:19:20,832 - {'Epoch': 29, 'HR@5': '0.0517', 'NDCG@5': '0.0361', 'HR@10': '0.0742', 'NDCG@10': '0.0433', 'HR@20': '0.1037', 'NDCG@20': '0.0508'}
2025-02-20 23:19:20,833 - EarlyStopping counter: 2 out of 10
2025-02-20 23:19:59,383 - {'epoch': 30, 'rec_loss': '7.7347'}
2025-02-20 23:20:16,057 - {'Epoch': 30, 'HR@5': '0.0521', 'NDCG@5': '0.0364', 'HR@10': '0.0739', 'NDCG@10': '0.0434', 'HR@20': '0.1039', 'NDCG@20': '0.0510'}
2025-02-20 23:20:16,058 - EarlyStopping counter: 3 out of 10
2025-02-20 23:20:56,984 - {'epoch': 31, 'rec_loss': '7.7234'}
2025-02-20 23:21:16,007 - {'Epoch': 31, 'HR@5': '0.0529', 'NDCG@5': '0.0369', 'HR@10': '0.0740', 'NDCG@10': '0.0437', 'HR@20': '0.1029', 'NDCG@20': '0.0510'}
2025-02-20 23:21:16,008 - EarlyStopping counter: 4 out of 10
2025-02-20 23:21:56,876 - {'epoch': 32, 'rec_loss': '7.7148'}
2025-02-20 23:22:13,680 - {'Epoch': 32, 'HR@5': '0.0524', 'NDCG@5': '0.0367', 'HR@10': '0.0754', 'NDCG@10': '0.0441', 'HR@20': '0.1045', 'NDCG@20': '0.0514'}
2025-02-20 23:22:13,684 - Validation score increased.  Saving model ...
2025-02-20 23:22:52,704 - {'epoch': 33, 'rec_loss': '7.7123'}
2025-02-20 23:23:09,996 - {'Epoch': 33, 'HR@5': '0.0525', 'NDCG@5': '0.0367', 'HR@10': '0.0748', 'NDCG@10': '0.0439', 'HR@20': '0.1032', 'NDCG@20': '0.0511'}
2025-02-20 23:23:09,997 - EarlyStopping counter: 1 out of 10
2025-02-20 23:23:50,324 - {'epoch': 34, 'rec_loss': '7.6951'}
2025-02-20 23:24:09,073 - {'Epoch': 34, 'HR@5': '0.0531', 'NDCG@5': '0.0370', 'HR@10': '0.0762', 'NDCG@10': '0.0444', 'HR@20': '0.1048', 'NDCG@20': '0.0517'}
2025-02-20 23:24:09,074 - Validation score increased.  Saving model ...
2025-02-20 23:24:49,354 - {'epoch': 35, 'rec_loss': '7.6893'}
2025-02-20 23:25:07,710 - {'Epoch': 35, 'HR@5': '0.0524', 'NDCG@5': '0.0364', 'HR@10': '0.0753', 'NDCG@10': '0.0438', 'HR@20': '0.1055', 'NDCG@20': '0.0514'}
2025-02-20 23:25:07,711 - EarlyStopping counter: 1 out of 10
2025-02-20 23:25:48,520 - {'epoch': 36, 'rec_loss': '7.6821'}
2025-02-20 23:26:05,219 - {'Epoch': 36, 'HR@5': '0.0519', 'NDCG@5': '0.0362', 'HR@10': '0.0755', 'NDCG@10': '0.0439', 'HR@20': '0.1048', 'NDCG@20': '0.0512'}
2025-02-20 23:26:05,223 - EarlyStopping counter: 2 out of 10
2025-02-20 23:26:45,727 - {'epoch': 37, 'rec_loss': '7.6769'}
2025-02-20 23:27:03,995 - {'Epoch': 37, 'HR@5': '0.0520', 'NDCG@5': '0.0362', 'HR@10': '0.0733', 'NDCG@10': '0.0430', 'HR@20': '0.1052', 'NDCG@20': '0.0511'}
2025-02-20 23:27:03,996 - EarlyStopping counter: 3 out of 10
2025-02-20 23:27:42,203 - {'epoch': 38, 'rec_loss': '7.6756'}
2025-02-20 23:27:58,588 - {'Epoch': 38, 'HR@5': '0.0521', 'NDCG@5': '0.0368', 'HR@10': '0.0751', 'NDCG@10': '0.0442', 'HR@20': '0.1064', 'NDCG@20': '0.0521'}
2025-02-20 23:27:58,593 - Validation score increased.  Saving model ...
2025-02-20 23:28:37,811 - {'epoch': 39, 'rec_loss': '7.6685'}
2025-02-20 23:28:54,248 - {'Epoch': 39, 'HR@5': '0.0523', 'NDCG@5': '0.0365', 'HR@10': '0.0753', 'NDCG@10': '0.0439', 'HR@20': '0.1057', 'NDCG@20': '0.0515'}
2025-02-20 23:28:54,253 - EarlyStopping counter: 1 out of 10
2025-02-20 23:29:34,609 - {'epoch': 40, 'rec_loss': '7.6540'}
2025-02-20 23:29:50,876 - {'Epoch': 40, 'HR@5': '0.0523', 'NDCG@5': '0.0367', 'HR@10': '0.0748', 'NDCG@10': '0.0440', 'HR@20': '0.1050', 'NDCG@20': '0.0516'}
2025-02-20 23:29:50,879 - EarlyStopping counter: 2 out of 10
2025-02-20 23:30:30,188 - {'epoch': 41, 'rec_loss': '7.6505'}
2025-02-20 23:30:47,637 - {'Epoch': 41, 'HR@5': '0.0522', 'NDCG@5': '0.0363', 'HR@10': '0.0750', 'NDCG@10': '0.0437', 'HR@20': '0.1044', 'NDCG@20': '0.0511'}
2025-02-20 23:30:47,638 - EarlyStopping counter: 3 out of 10
2025-02-20 23:31:26,409 - {'epoch': 42, 'rec_loss': '7.6475'}
2025-02-20 23:31:43,640 - {'Epoch': 42, 'HR@5': '0.0524', 'NDCG@5': '0.0367', 'HR@10': '0.0752', 'NDCG@10': '0.0440', 'HR@20': '0.1051', 'NDCG@20': '0.0516'}
2025-02-20 23:31:43,641 - EarlyStopping counter: 4 out of 10
2025-02-20 23:32:26,055 - {'epoch': 43, 'rec_loss': '7.6434'}
2025-02-20 23:32:42,713 - {'Epoch': 43, 'HR@5': '0.0527', 'NDCG@5': '0.0368', 'HR@10': '0.0765', 'NDCG@10': '0.0444', 'HR@20': '0.1057', 'NDCG@20': '0.0518'}
2025-02-20 23:32:42,718 - EarlyStopping counter: 5 out of 10
2025-02-20 23:33:24,413 - {'epoch': 44, 'rec_loss': '7.6370'}
2025-02-20 23:33:42,669 - {'Epoch': 44, 'HR@5': '0.0523', 'NDCG@5': '0.0364', 'HR@10': '0.0751', 'NDCG@10': '0.0438', 'HR@20': '0.1054', 'NDCG@20': '0.0514'}
2025-02-20 23:33:42,673 - EarlyStopping counter: 6 out of 10
2025-02-20 23:34:22,577 - {'epoch': 45, 'rec_loss': '7.6313'}
2025-02-20 23:34:39,893 - {'Epoch': 45, 'HR@5': '0.0530', 'NDCG@5': '0.0369', 'HR@10': '0.0764', 'NDCG@10': '0.0444', 'HR@20': '0.1045', 'NDCG@20': '0.0514'}
2025-02-20 23:34:39,895 - EarlyStopping counter: 7 out of 10
2025-02-20 23:35:19,085 - {'epoch': 46, 'rec_loss': '7.6259'}
2025-02-20 23:35:38,131 - {'Epoch': 46, 'HR@5': '0.0525', 'NDCG@5': '0.0368', 'HR@10': '0.0759', 'NDCG@10': '0.0443', 'HR@20': '0.1046', 'NDCG@20': '0.0515'}
2025-02-20 23:35:38,136 - EarlyStopping counter: 8 out of 10
2025-02-20 23:36:17,561 - {'epoch': 47, 'rec_loss': '7.6213'}
2025-02-20 23:36:34,013 - {'Epoch': 47, 'HR@5': '0.0523', 'NDCG@5': '0.0367', 'HR@10': '0.0757', 'NDCG@10': '0.0442', 'HR@20': '0.1051', 'NDCG@20': '0.0516'}
2025-02-20 23:36:34,018 - EarlyStopping counter: 9 out of 10
2025-02-20 23:37:12,150 - {'epoch': 48, 'rec_loss': '7.6201'}
2025-02-20 23:37:28,899 - {'Epoch': 48, 'HR@5': '0.0523', 'NDCG@5': '0.0369', 'HR@10': '0.0751', 'NDCG@10': '0.0442', 'HR@20': '0.1052', 'NDCG@20': '0.0518'}
2025-02-20 23:37:28,903 - EarlyStopping counter: 10 out of 10
2025-02-20 23:37:28,903 - Early stopping
2025-02-20 23:37:28,903 - ---------------Test Score---------------
2025-02-20 23:37:45,343 - {'Epoch': 0, 'HR@5': '0.0434', 'NDCG@5': '0.0306', 'HR@10': '0.0623', 'NDCG@10': '0.0367', 'HR@20': '0.0873', 'NDCG@20': '0.0430'}
2025-02-20 23:37:45,345 - Scale_Sports
2025-02-20 23:37:45,345 - {'Epoch': 0, 'HR@5': '0.0434', 'NDCG@5': '0.0306', 'HR@10': '0.0623', 'NDCG@10': '0.0367', 'HR@20': '0.0873', 'NDCG@20': '0.0430'}
2025-02-21 09:27:17,385 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 5], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-21 09:27:20,195 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-21 09:27:20,200 - Total Parameters: 1328529
2025-02-21 09:28:03,401 - {'epoch': 0, 'rec_loss': '9.4036'}
2025-02-21 09:28:19,904 - {'Epoch': 0, 'HR@5': '0.0084', 'NDCG@5': '0.0054', 'HR@10': '0.0126', 'NDCG@10': '0.0067', 'HR@20': '0.0217', 'NDCG@20': '0.0090'}
2025-02-21 09:28:19,909 - Validation score increased.  Saving model ...
2025-02-21 09:28:59,842 - {'epoch': 1, 'rec_loss': '9.2142'}
2025-02-21 09:29:15,696 - {'Epoch': 1, 'HR@5': '0.0154', 'NDCG@5': '0.0098', 'HR@10': '0.0252', 'NDCG@10': '0.0129', 'HR@20': '0.0390', 'NDCG@20': '0.0164'}
2025-02-21 09:29:15,703 - Validation score increased.  Saving model ...
2025-02-21 09:30:00,449 - {'epoch': 2, 'rec_loss': '8.9404'}
2025-02-21 09:30:16,181 - {'Epoch': 2, 'HR@5': '0.0188', 'NDCG@5': '0.0124', 'HR@10': '0.0317', 'NDCG@10': '0.0165', 'HR@20': '0.0523', 'NDCG@20': '0.0217'}
2025-02-21 09:30:16,183 - Validation score increased.  Saving model ...
2025-02-21 09:30:57,647 - {'epoch': 3, 'rec_loss': '8.7448'}
2025-02-21 09:31:13,590 - {'Epoch': 3, 'HR@5': '0.0273', 'NDCG@5': '0.0178', 'HR@10': '0.0418', 'NDCG@10': '0.0225', 'HR@20': '0.0641', 'NDCG@20': '0.0281'}
2025-02-21 09:31:13,591 - Validation score increased.  Saving model ...
2025-02-21 09:31:58,599 - {'epoch': 4, 'rec_loss': '8.5959'}
2025-02-21 09:32:14,349 - {'Epoch': 4, 'HR@5': '0.0312', 'NDCG@5': '0.0207', 'HR@10': '0.0479', 'NDCG@10': '0.0261', 'HR@20': '0.0724', 'NDCG@20': '0.0322'}
2025-02-21 09:32:14,350 - Validation score increased.  Saving model ...
2025-02-21 09:32:57,061 - {'epoch': 5, 'rec_loss': '8.4792'}
2025-02-21 09:33:12,820 - {'Epoch': 5, 'HR@5': '0.0358', 'NDCG@5': '0.0237', 'HR@10': '0.0539', 'NDCG@10': '0.0295', 'HR@20': '0.0791', 'NDCG@20': '0.0358'}
2025-02-21 09:33:12,822 - Validation score increased.  Saving model ...
2025-02-21 09:33:52,030 - {'epoch': 6, 'rec_loss': '8.3831'}
2025-02-21 09:34:08,059 - {'Epoch': 6, 'HR@5': '0.0395', 'NDCG@5': '0.0266', 'HR@10': '0.0580', 'NDCG@10': '0.0326', 'HR@20': '0.0836', 'NDCG@20': '0.0390'}
2025-02-21 09:34:08,064 - Validation score increased.  Saving model ...
2025-02-21 09:34:49,402 - {'epoch': 7, 'rec_loss': '8.3055'}
2025-02-21 09:35:05,329 - {'Epoch': 7, 'HR@5': '0.0399', 'NDCG@5': '0.0273', 'HR@10': '0.0603', 'NDCG@10': '0.0339', 'HR@20': '0.0879', 'NDCG@20': '0.0408'}
2025-02-21 09:35:05,330 - Validation score increased.  Saving model ...
2025-02-21 09:35:48,066 - {'epoch': 8, 'rec_loss': '8.2340'}
2025-02-21 09:36:04,248 - {'Epoch': 8, 'HR@5': '0.0429', 'NDCG@5': '0.0294', 'HR@10': '0.0620', 'NDCG@10': '0.0355', 'HR@20': '0.0905', 'NDCG@20': '0.0427'}
2025-02-21 09:36:04,250 - Validation score increased.  Saving model ...
2025-02-21 09:36:46,462 - {'epoch': 9, 'rec_loss': '8.1850'}
2025-02-21 09:37:02,603 - {'Epoch': 9, 'HR@5': '0.0447', 'NDCG@5': '0.0309', 'HR@10': '0.0640', 'NDCG@10': '0.0371', 'HR@20': '0.0927', 'NDCG@20': '0.0443'}
2025-02-21 09:37:02,604 - Validation score increased.  Saving model ...
2025-02-21 09:37:43,040 - {'epoch': 10, 'rec_loss': '8.1288'}
2025-02-21 09:37:59,439 - {'Epoch': 10, 'HR@5': '0.0451', 'NDCG@5': '0.0307', 'HR@10': '0.0663', 'NDCG@10': '0.0375', 'HR@20': '0.0935', 'NDCG@20': '0.0444'}
2025-02-21 09:37:59,440 - Validation score increased.  Saving model ...
2025-02-21 09:38:41,933 - {'epoch': 11, 'rec_loss': '8.0899'}
2025-02-21 09:38:58,652 - {'Epoch': 11, 'HR@5': '0.0456', 'NDCG@5': '0.0315', 'HR@10': '0.0672', 'NDCG@10': '0.0384', 'HR@20': '0.0955', 'NDCG@20': '0.0455'}
2025-02-21 09:38:58,653 - Validation score increased.  Saving model ...
2025-02-21 09:39:38,578 - {'epoch': 12, 'rec_loss': '8.0502'}
2025-02-21 09:39:55,009 - {'Epoch': 12, 'HR@5': '0.0471', 'NDCG@5': '0.0328', 'HR@10': '0.0688', 'NDCG@10': '0.0397', 'HR@20': '0.0967', 'NDCG@20': '0.0467'}
2025-02-21 09:39:55,013 - Validation score increased.  Saving model ...
2025-02-21 09:40:34,998 - {'epoch': 13, 'rec_loss': '8.0168'}
2025-02-21 09:40:51,830 - {'Epoch': 13, 'HR@5': '0.0479', 'NDCG@5': '0.0333', 'HR@10': '0.0684', 'NDCG@10': '0.0399', 'HR@20': '0.0970', 'NDCG@20': '0.0471'}
2025-02-21 09:40:51,834 - Validation score increased.  Saving model ...
2025-02-21 09:41:33,182 - {'epoch': 14, 'rec_loss': '7.9816'}
2025-02-21 09:41:49,610 - {'Epoch': 14, 'HR@5': '0.0484', 'NDCG@5': '0.0335', 'HR@10': '0.0691', 'NDCG@10': '0.0402', 'HR@20': '0.0987', 'NDCG@20': '0.0477'}
2025-02-21 09:41:49,614 - Validation score increased.  Saving model ...
2025-02-21 09:42:29,978 - {'epoch': 15, 'rec_loss': '7.9589'}
2025-02-21 09:42:46,409 - {'Epoch': 15, 'HR@5': '0.0480', 'NDCG@5': '0.0334', 'HR@10': '0.0699', 'NDCG@10': '0.0404', 'HR@20': '0.0997', 'NDCG@20': '0.0479'}
2025-02-21 09:42:46,412 - Validation score increased.  Saving model ...
2025-02-21 09:43:27,484 - {'epoch': 16, 'rec_loss': '7.9348'}
2025-02-21 09:43:43,968 - {'Epoch': 16, 'HR@5': '0.0493', 'NDCG@5': '0.0344', 'HR@10': '0.0702', 'NDCG@10': '0.0411', 'HR@20': '0.1008', 'NDCG@20': '0.0487'}
2025-02-21 09:43:43,971 - Validation score increased.  Saving model ...
2025-02-21 09:44:24,685 - {'epoch': 17, 'rec_loss': '7.9076'}
2025-02-21 09:44:41,138 - {'Epoch': 17, 'HR@5': '0.0502', 'NDCG@5': '0.0353', 'HR@10': '0.0705', 'NDCG@10': '0.0418', 'HR@20': '0.1003', 'NDCG@20': '0.0493'}
2025-02-21 09:44:41,142 - Validation score increased.  Saving model ...
2025-02-21 09:45:22,070 - {'epoch': 18, 'rec_loss': '7.8934'}
2025-02-21 09:45:39,731 - {'Epoch': 18, 'HR@5': '0.0492', 'NDCG@5': '0.0345', 'HR@10': '0.0702', 'NDCG@10': '0.0412', 'HR@20': '0.1012', 'NDCG@20': '0.0490'}
2025-02-21 09:45:39,733 - EarlyStopping counter: 1 out of 10
2025-02-21 09:46:25,318 - {'epoch': 19, 'rec_loss': '7.8746'}
2025-02-21 09:46:41,982 - {'Epoch': 19, 'HR@5': '0.0497', 'NDCG@5': '0.0348', 'HR@10': '0.0713', 'NDCG@10': '0.0418', 'HR@20': '0.1009', 'NDCG@20': '0.0492'}
2025-02-21 09:46:41,985 - EarlyStopping counter: 2 out of 10
2025-02-21 09:47:22,216 - {'epoch': 20, 'rec_loss': '7.8533'}
2025-02-21 09:47:38,703 - {'Epoch': 20, 'HR@5': '0.0505', 'NDCG@5': '0.0351', 'HR@10': '0.0716', 'NDCG@10': '0.0419', 'HR@20': '0.1014', 'NDCG@20': '0.0494'}
2025-02-21 09:47:38,704 - Validation score increased.  Saving model ...
2025-02-21 09:48:19,573 - {'epoch': 21, 'rec_loss': '7.8365'}
2025-02-21 09:48:37,277 - {'Epoch': 21, 'HR@5': '0.0501', 'NDCG@5': '0.0347', 'HR@10': '0.0718', 'NDCG@10': '0.0417', 'HR@20': '0.1031', 'NDCG@20': '0.0495'}
2025-02-21 09:48:37,284 - Validation score increased.  Saving model ...
2025-02-21 09:49:17,545 - {'epoch': 22, 'rec_loss': '7.8197'}
2025-02-21 09:49:36,195 - {'Epoch': 22, 'HR@5': '0.0503', 'NDCG@5': '0.0351', 'HR@10': '0.0731', 'NDCG@10': '0.0424', 'HR@20': '0.1023', 'NDCG@20': '0.0498'}
2025-02-21 09:49:36,198 - Validation score increased.  Saving model ...
2025-02-21 09:50:16,197 - {'epoch': 23, 'rec_loss': '7.8090'}
2025-02-21 09:50:33,718 - {'Epoch': 23, 'HR@5': '0.0489', 'NDCG@5': '0.0342', 'HR@10': '0.0727', 'NDCG@10': '0.0418', 'HR@20': '0.1026', 'NDCG@20': '0.0494'}
2025-02-21 09:50:33,723 - EarlyStopping counter: 1 out of 10
2025-02-21 09:51:14,032 - {'epoch': 24, 'rec_loss': '7.7990'}
2025-02-21 09:51:31,672 - {'Epoch': 24, 'HR@5': '0.0510', 'NDCG@5': '0.0356', 'HR@10': '0.0737', 'NDCG@10': '0.0428', 'HR@20': '0.1046', 'NDCG@20': '0.0506'}
2025-02-21 09:51:31,673 - Validation score increased.  Saving model ...
2025-02-21 09:52:12,894 - {'epoch': 25, 'rec_loss': '7.7832'}
2025-02-21 09:52:31,925 - {'Epoch': 25, 'HR@5': '0.0494', 'NDCG@5': '0.0349', 'HR@10': '0.0740', 'NDCG@10': '0.0427', 'HR@20': '0.1041', 'NDCG@20': '0.0503'}
2025-02-21 09:52:31,926 - EarlyStopping counter: 1 out of 10
2025-02-21 09:53:14,196 - {'epoch': 26, 'rec_loss': '7.7690'}
2025-02-21 09:53:33,379 - {'Epoch': 26, 'HR@5': '0.0494', 'NDCG@5': '0.0349', 'HR@10': '0.0731', 'NDCG@10': '0.0425', 'HR@20': '0.1042', 'NDCG@20': '0.0504'}
2025-02-21 09:53:33,381 - EarlyStopping counter: 2 out of 10
2025-02-21 09:54:12,768 - {'epoch': 27, 'rec_loss': '7.7615'}
2025-02-21 09:54:30,235 - {'Epoch': 27, 'HR@5': '0.0501', 'NDCG@5': '0.0349', 'HR@10': '0.0735', 'NDCG@10': '0.0424', 'HR@20': '0.1037', 'NDCG@20': '0.0500'}
2025-02-21 09:54:30,236 - EarlyStopping counter: 3 out of 10
2025-02-21 09:55:11,296 - {'epoch': 28, 'rec_loss': '7.7471'}
2025-02-21 09:55:29,083 - {'Epoch': 28, 'HR@5': '0.0507', 'NDCG@5': '0.0353', 'HR@10': '0.0743', 'NDCG@10': '0.0429', 'HR@20': '0.1046', 'NDCG@20': '0.0505'}
2025-02-21 09:55:29,088 - EarlyStopping counter: 4 out of 10
2025-02-21 09:56:08,845 - {'epoch': 29, 'rec_loss': '7.7385'}
2025-02-21 09:56:26,358 - {'Epoch': 29, 'HR@5': '0.0509', 'NDCG@5': '0.0353', 'HR@10': '0.0733', 'NDCG@10': '0.0425', 'HR@20': '0.1038', 'NDCG@20': '0.0502'}
2025-02-21 09:56:26,363 - EarlyStopping counter: 5 out of 10
2025-02-21 09:57:05,124 - {'epoch': 30, 'rec_loss': '7.7286'}
2025-02-21 09:57:24,287 - {'Epoch': 30, 'HR@5': '0.0510', 'NDCG@5': '0.0355', 'HR@10': '0.0742', 'NDCG@10': '0.0429', 'HR@20': '0.1045', 'NDCG@20': '0.0505'}
2025-02-21 09:57:24,291 - EarlyStopping counter: 6 out of 10
2025-02-21 09:58:03,098 - {'epoch': 31, 'rec_loss': '7.7169'}
2025-02-21 09:58:21,692 - {'Epoch': 31, 'HR@5': '0.0505', 'NDCG@5': '0.0352', 'HR@10': '0.0735', 'NDCG@10': '0.0426', 'HR@20': '0.1042', 'NDCG@20': '0.0503'}
2025-02-21 09:58:21,693 - EarlyStopping counter: 7 out of 10
2025-02-21 09:59:01,484 - {'epoch': 32, 'rec_loss': '7.7081'}
2025-02-21 09:59:18,578 - {'Epoch': 32, 'HR@5': '0.0521', 'NDCG@5': '0.0362', 'HR@10': '0.0741', 'NDCG@10': '0.0433', 'HR@20': '0.1050', 'NDCG@20': '0.0511'}
2025-02-21 09:59:18,580 - Validation score increased.  Saving model ...
2025-02-21 09:59:58,458 - {'epoch': 33, 'rec_loss': '7.7076'}
2025-02-21 10:00:15,787 - {'Epoch': 33, 'HR@5': '0.0512', 'NDCG@5': '0.0358', 'HR@10': '0.0744', 'NDCG@10': '0.0433', 'HR@20': '0.1047', 'NDCG@20': '0.0509'}
2025-02-21 10:00:15,793 - EarlyStopping counter: 1 out of 10
2025-02-21 10:00:54,591 - {'epoch': 34, 'rec_loss': '7.6939'}
2025-02-21 10:01:12,225 - {'Epoch': 34, 'HR@5': '0.0511', 'NDCG@5': '0.0357', 'HR@10': '0.0736', 'NDCG@10': '0.0429', 'HR@20': '0.1036', 'NDCG@20': '0.0504'}
2025-02-21 10:01:12,230 - EarlyStopping counter: 2 out of 10
2025-02-21 10:01:51,956 - {'epoch': 35, 'rec_loss': '7.6907'}
2025-02-21 10:02:09,704 - {'Epoch': 35, 'HR@5': '0.0516', 'NDCG@5': '0.0364', 'HR@10': '0.0743', 'NDCG@10': '0.0437', 'HR@20': '0.1054', 'NDCG@20': '0.0514'}
2025-02-21 10:02:09,705 - Validation score increased.  Saving model ...
2025-02-21 10:02:48,618 - {'epoch': 36, 'rec_loss': '7.6807'}
2025-02-21 10:03:06,038 - {'Epoch': 36, 'HR@5': '0.0523', 'NDCG@5': '0.0362', 'HR@10': '0.0741', 'NDCG@10': '0.0433', 'HR@20': '0.1056', 'NDCG@20': '0.0512'}
2025-02-21 10:03:06,041 - EarlyStopping counter: 1 out of 10
2025-02-21 10:03:45,843 - {'epoch': 37, 'rec_loss': '7.6727'}
2025-02-21 10:04:04,151 - {'Epoch': 37, 'HR@5': '0.0524', 'NDCG@5': '0.0363', 'HR@10': '0.0747', 'NDCG@10': '0.0435', 'HR@20': '0.1056', 'NDCG@20': '0.0512'}
2025-02-21 10:04:04,153 - EarlyStopping counter: 2 out of 10
2025-02-21 10:04:44,719 - {'epoch': 38, 'rec_loss': '7.6736'}
2025-02-21 10:05:02,835 - {'Epoch': 38, 'HR@5': '0.0520', 'NDCG@5': '0.0362', 'HR@10': '0.0744', 'NDCG@10': '0.0434', 'HR@20': '0.1047', 'NDCG@20': '0.0511'}
2025-02-21 10:05:02,837 - EarlyStopping counter: 3 out of 10
2025-02-21 10:05:42,105 - {'epoch': 39, 'rec_loss': '7.6656'}
2025-02-21 10:06:00,580 - {'Epoch': 39, 'HR@5': '0.0530', 'NDCG@5': '0.0369', 'HR@10': '0.0750', 'NDCG@10': '0.0440', 'HR@20': '0.1068', 'NDCG@20': '0.0520'}
2025-02-21 10:06:00,585 - Validation score increased.  Saving model ...
2025-02-21 10:06:41,708 - {'epoch': 40, 'rec_loss': '7.6535'}
2025-02-21 10:06:58,831 - {'Epoch': 40, 'HR@5': '0.0524', 'NDCG@5': '0.0366', 'HR@10': '0.0744', 'NDCG@10': '0.0437', 'HR@20': '0.1059', 'NDCG@20': '0.0517'}
2025-02-21 10:06:58,833 - EarlyStopping counter: 1 out of 10
2025-02-21 10:07:38,172 - {'epoch': 41, 'rec_loss': '7.6485'}
2025-02-21 10:07:55,098 - {'Epoch': 41, 'HR@5': '0.0528', 'NDCG@5': '0.0369', 'HR@10': '0.0755', 'NDCG@10': '0.0442', 'HR@20': '0.1064', 'NDCG@20': '0.0520'}
2025-02-21 10:07:55,099 - Validation score increased.  Saving model ...
2025-02-21 10:08:35,693 - {'epoch': 42, 'rec_loss': '7.6414'}
2025-02-21 10:08:54,368 - {'Epoch': 42, 'HR@5': '0.0528', 'NDCG@5': '0.0369', 'HR@10': '0.0752', 'NDCG@10': '0.0441', 'HR@20': '0.1063', 'NDCG@20': '0.0519'}
2025-02-21 10:08:54,376 - EarlyStopping counter: 1 out of 10
2025-02-21 10:09:33,537 - {'epoch': 43, 'rec_loss': '7.6409'}
2025-02-21 10:09:52,062 - {'Epoch': 43, 'HR@5': '0.0529', 'NDCG@5': '0.0373', 'HR@10': '0.0766', 'NDCG@10': '0.0450', 'HR@20': '0.1079', 'NDCG@20': '0.0528'}
2025-02-21 10:09:52,064 - Validation score increased.  Saving model ...
2025-02-21 10:10:31,625 - {'epoch': 44, 'rec_loss': '7.6326'}
2025-02-21 10:10:49,346 - {'Epoch': 44, 'HR@5': '0.0529', 'NDCG@5': '0.0367', 'HR@10': '0.0753', 'NDCG@10': '0.0439', 'HR@20': '0.1062', 'NDCG@20': '0.0517'}
2025-02-21 10:10:49,347 - EarlyStopping counter: 1 out of 10
2025-02-21 10:11:28,718 - {'epoch': 45, 'rec_loss': '7.6270'}
2025-02-21 10:11:45,697 - {'Epoch': 45, 'HR@5': '0.0528', 'NDCG@5': '0.0367', 'HR@10': '0.0749', 'NDCG@10': '0.0438', 'HR@20': '0.1058', 'NDCG@20': '0.0516'}
2025-02-21 10:11:45,698 - EarlyStopping counter: 2 out of 10
2025-02-21 10:12:24,380 - {'epoch': 46, 'rec_loss': '7.6249'}
2025-02-21 10:12:41,121 - {'Epoch': 46, 'HR@5': '0.0532', 'NDCG@5': '0.0370', 'HR@10': '0.0755', 'NDCG@10': '0.0441', 'HR@20': '0.1062', 'NDCG@20': '0.0519'}
2025-02-21 10:12:41,126 - EarlyStopping counter: 3 out of 10
2025-02-21 10:13:19,569 - {'epoch': 47, 'rec_loss': '7.6168'}
2025-02-21 10:13:38,839 - {'Epoch': 47, 'HR@5': '0.0526', 'NDCG@5': '0.0368', 'HR@10': '0.0746', 'NDCG@10': '0.0439', 'HR@20': '0.1062', 'NDCG@20': '0.0519'}
2025-02-21 10:13:38,841 - EarlyStopping counter: 4 out of 10
2025-02-21 10:14:19,018 - {'epoch': 48, 'rec_loss': '7.6166'}
2025-02-21 10:14:36,525 - {'Epoch': 48, 'HR@5': '0.0527', 'NDCG@5': '0.0368', 'HR@10': '0.0760', 'NDCG@10': '0.0443', 'HR@20': '0.1070', 'NDCG@20': '0.0521'}
2025-02-21 10:14:36,526 - EarlyStopping counter: 5 out of 10
2025-02-21 10:15:15,210 - {'epoch': 49, 'rec_loss': '7.6163'}
2025-02-21 10:15:32,200 - {'Epoch': 49, 'HR@5': '0.0530', 'NDCG@5': '0.0369', 'HR@10': '0.0757', 'NDCG@10': '0.0442', 'HR@20': '0.1064', 'NDCG@20': '0.0519'}
2025-02-21 10:15:32,202 - EarlyStopping counter: 6 out of 10
2025-02-21 10:16:11,618 - {'epoch': 50, 'rec_loss': '7.6087'}
2025-02-21 10:16:28,598 - {'Epoch': 50, 'HR@5': '0.0515', 'NDCG@5': '0.0360', 'HR@10': '0.0747', 'NDCG@10': '0.0435', 'HR@20': '0.1057', 'NDCG@20': '0.0513'}
2025-02-21 10:16:28,602 - EarlyStopping counter: 7 out of 10
2025-02-21 10:17:08,312 - {'epoch': 51, 'rec_loss': '7.6049'}
2025-02-21 10:17:27,275 - {'Epoch': 51, 'HR@5': '0.0530', 'NDCG@5': '0.0367', 'HR@10': '0.0755', 'NDCG@10': '0.0439', 'HR@20': '0.1062', 'NDCG@20': '0.0516'}
2025-02-21 10:17:27,282 - EarlyStopping counter: 8 out of 10
2025-02-21 10:18:06,032 - {'epoch': 52, 'rec_loss': '7.5985'}
2025-02-21 10:18:22,856 - {'Epoch': 52, 'HR@5': '0.0532', 'NDCG@5': '0.0368', 'HR@10': '0.0757', 'NDCG@10': '0.0440', 'HR@20': '0.1067', 'NDCG@20': '0.0518'}
2025-02-21 10:18:22,857 - EarlyStopping counter: 9 out of 10
2025-02-21 10:19:02,171 - {'epoch': 53, 'rec_loss': '7.6008'}
2025-02-21 10:19:20,687 - {'Epoch': 53, 'HR@5': '0.0522', 'NDCG@5': '0.0363', 'HR@10': '0.0751', 'NDCG@10': '0.0437', 'HR@20': '0.1062', 'NDCG@20': '0.0515'}
2025-02-21 10:19:20,691 - EarlyStopping counter: 10 out of 10
2025-02-21 10:19:20,691 - Early stopping
2025-02-21 10:19:20,691 - ---------------Test Score---------------
2025-02-21 10:19:39,295 - {'Epoch': 0, 'HR@5': '0.0435', 'NDCG@5': '0.0298', 'HR@10': '0.0633', 'NDCG@10': '0.0362', 'HR@20': '0.0896', 'NDCG@20': '0.0428'}
2025-02-21 10:19:39,299 - Scale_Sports
2025-02-21 10:19:39,299 - {'Epoch': 0, 'HR@5': '0.0435', 'NDCG@5': '0.0298', 'HR@10': '0.0633', 'NDCG@10': '0.0362', 'HR@20': '0.0896', 'NDCG@20': '0.0428'}
2025-02-21 11:00:33,368 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 5], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-21 11:00:36,394 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-21 11:00:36,405 - Total Parameters: 1328529
2025-02-21 11:01:18,997 - {'epoch': 0, 'rec_loss': '9.4061'}
2025-02-21 11:01:36,754 - {'Epoch': 0, 'HR@5': '0.0080', 'NDCG@5': '0.0054', 'HR@10': '0.0126', 'NDCG@10': '0.0068', 'HR@20': '0.0212', 'NDCG@20': '0.0090'}
2025-02-21 11:01:36,760 - Validation score increased.  Saving model ...
2025-02-21 11:02:17,018 - {'epoch': 1, 'rec_loss': '9.2349'}
2025-02-21 11:02:34,268 - {'Epoch': 1, 'HR@5': '0.0124', 'NDCG@5': '0.0081', 'HR@10': '0.0216', 'NDCG@10': '0.0110', 'HR@20': '0.0361', 'NDCG@20': '0.0147'}
2025-02-21 11:02:34,272 - Validation score increased.  Saving model ...
2025-02-21 11:03:14,643 - {'epoch': 2, 'rec_loss': '8.9604'}
2025-02-21 11:03:32,177 - {'Epoch': 2, 'HR@5': '0.0177', 'NDCG@5': '0.0115', 'HR@10': '0.0306', 'NDCG@10': '0.0156', 'HR@20': '0.0479', 'NDCG@20': '0.0199'}
2025-02-21 11:03:32,179 - Validation score increased.  Saving model ...
2025-02-21 11:04:12,116 - {'epoch': 3, 'rec_loss': '8.7525'}
2025-02-21 11:04:30,266 - {'Epoch': 3, 'HR@5': '0.0256', 'NDCG@5': '0.0163', 'HR@10': '0.0392', 'NDCG@10': '0.0206', 'HR@20': '0.0619', 'NDCG@20': '0.0263'}
2025-02-21 11:04:30,270 - Validation score increased.  Saving model ...
2025-02-21 11:05:10,819 - {'epoch': 4, 'rec_loss': '8.5988'}
2025-02-21 11:05:29,144 - {'Epoch': 4, 'HR@5': '0.0310', 'NDCG@5': '0.0208', 'HR@10': '0.0474', 'NDCG@10': '0.0260', 'HR@20': '0.0717', 'NDCG@20': '0.0321'}
2025-02-21 11:05:29,147 - Validation score increased.  Saving model ...
2025-02-21 11:06:09,008 - {'epoch': 5, 'rec_loss': '8.4831'}
2025-02-21 11:06:26,907 - {'Epoch': 5, 'HR@5': '0.0351', 'NDCG@5': '0.0236', 'HR@10': '0.0536', 'NDCG@10': '0.0296', 'HR@20': '0.0788', 'NDCG@20': '0.0359'}
2025-02-21 11:06:26,910 - Validation score increased.  Saving model ...
2025-02-21 11:07:06,666 - {'epoch': 6, 'rec_loss': '8.3858'}
2025-02-21 11:07:24,803 - {'Epoch': 6, 'HR@5': '0.0393', 'NDCG@5': '0.0269', 'HR@10': '0.0572', 'NDCG@10': '0.0326', 'HR@20': '0.0825', 'NDCG@20': '0.0390'}
2025-02-21 11:07:24,805 - Validation score increased.  Saving model ...
2025-02-21 11:08:06,012 - {'epoch': 7, 'rec_loss': '8.3058'}
2025-02-21 11:08:23,383 - {'Epoch': 7, 'HR@5': '0.0415', 'NDCG@5': '0.0279', 'HR@10': '0.0605', 'NDCG@10': '0.0340', 'HR@20': '0.0869', 'NDCG@20': '0.0406'}
2025-02-21 11:08:23,384 - Validation score increased.  Saving model ...
2025-02-21 11:09:03,374 - {'epoch': 8, 'rec_loss': '8.2374'}
2025-02-21 11:09:21,196 - {'Epoch': 8, 'HR@5': '0.0426', 'NDCG@5': '0.0293', 'HR@10': '0.0632', 'NDCG@10': '0.0359', 'HR@20': '0.0909', 'NDCG@20': '0.0429'}
2025-02-21 11:09:21,197 - Validation score increased.  Saving model ...
2025-02-21 11:10:00,801 - {'epoch': 9, 'rec_loss': '8.1777'}
2025-02-21 11:10:18,589 - {'Epoch': 9, 'HR@5': '0.0450', 'NDCG@5': '0.0305', 'HR@10': '0.0638', 'NDCG@10': '0.0366', 'HR@20': '0.0923', 'NDCG@20': '0.0437'}
2025-02-21 11:10:18,590 - Validation score increased.  Saving model ...
2025-02-21 11:10:58,313 - {'epoch': 10, 'rec_loss': '8.1282'}
2025-02-21 11:11:16,382 - {'Epoch': 10, 'HR@5': '0.0460', 'NDCG@5': '0.0313', 'HR@10': '0.0666', 'NDCG@10': '0.0379', 'HR@20': '0.0944', 'NDCG@20': '0.0449'}
2025-02-21 11:11:16,383 - Validation score increased.  Saving model ...
2025-02-21 11:11:56,920 - {'epoch': 11, 'rec_loss': '8.0901'}
2025-02-21 11:12:14,848 - {'Epoch': 11, 'HR@5': '0.0463', 'NDCG@5': '0.0319', 'HR@10': '0.0674', 'NDCG@10': '0.0386', 'HR@20': '0.0963', 'NDCG@20': '0.0459'}
2025-02-21 11:12:14,852 - Validation score increased.  Saving model ...
2025-02-21 11:12:54,230 - {'epoch': 12, 'rec_loss': '8.0511'}
2025-02-21 11:13:12,722 - {'Epoch': 12, 'HR@5': '0.0463', 'NDCG@5': '0.0322', 'HR@10': '0.0683', 'NDCG@10': '0.0393', 'HR@20': '0.0968', 'NDCG@20': '0.0465'}
2025-02-21 11:13:12,723 - Validation score increased.  Saving model ...
2025-02-21 11:13:52,465 - {'epoch': 13, 'rec_loss': '8.0210'}
2025-02-21 11:14:10,975 - {'Epoch': 13, 'HR@5': '0.0485', 'NDCG@5': '0.0334', 'HR@10': '0.0696', 'NDCG@10': '0.0402', 'HR@20': '0.0996', 'NDCG@20': '0.0477'}
2025-02-21 11:14:10,979 - Validation score increased.  Saving model ...
2025-02-21 11:14:51,358 - {'epoch': 14, 'rec_loss': '7.9906'}
2025-02-21 11:15:09,995 - {'Epoch': 14, 'HR@5': '0.0479', 'NDCG@5': '0.0334', 'HR@10': '0.0703', 'NDCG@10': '0.0406', 'HR@20': '0.0984', 'NDCG@20': '0.0477'}
2025-02-21 11:15:09,998 - EarlyStopping counter: 1 out of 10
2025-02-21 11:15:49,462 - {'epoch': 15, 'rec_loss': '7.9607'}
2025-02-21 11:16:07,167 - {'Epoch': 15, 'HR@5': '0.0491', 'NDCG@5': '0.0339', 'HR@10': '0.0708', 'NDCG@10': '0.0409', 'HR@20': '0.0998', 'NDCG@20': '0.0482'}
2025-02-21 11:16:07,169 - Validation score increased.  Saving model ...
2025-02-21 11:16:47,232 - {'epoch': 16, 'rec_loss': '7.9365'}
2025-02-21 11:17:05,038 - {'Epoch': 16, 'HR@5': '0.0487', 'NDCG@5': '0.0339', 'HR@10': '0.0708', 'NDCG@10': '0.0410', 'HR@20': '0.1003', 'NDCG@20': '0.0484'}
2025-02-21 11:17:05,039 - Validation score increased.  Saving model ...
2025-02-21 11:17:46,773 - {'epoch': 17, 'rec_loss': '7.9159'}
2025-02-21 11:18:05,681 - {'Epoch': 17, 'HR@5': '0.0484', 'NDCG@5': '0.0339', 'HR@10': '0.0708', 'NDCG@10': '0.0411', 'HR@20': '0.1008', 'NDCG@20': '0.0486'}
2025-02-21 11:18:05,682 - Validation score increased.  Saving model ...
2025-02-21 11:18:45,678 - {'epoch': 18, 'rec_loss': '7.8926'}
2025-02-21 11:19:04,207 - {'Epoch': 18, 'HR@5': '0.0490', 'NDCG@5': '0.0341', 'HR@10': '0.0708', 'NDCG@10': '0.0411', 'HR@20': '0.1017', 'NDCG@20': '0.0489'}
2025-02-21 11:19:04,209 - Validation score increased.  Saving model ...
2025-02-21 11:19:45,134 - {'epoch': 19, 'rec_loss': '7.8753'}
2025-02-21 11:20:03,230 - {'Epoch': 19, 'HR@5': '0.0498', 'NDCG@5': '0.0343', 'HR@10': '0.0727', 'NDCG@10': '0.0417', 'HR@20': '0.1026', 'NDCG@20': '0.0492'}
2025-02-21 11:20:03,234 - Validation score increased.  Saving model ...
2025-02-21 11:20:43,595 - {'epoch': 20, 'rec_loss': '7.8622'}
2025-02-21 11:21:02,250 - {'Epoch': 20, 'HR@5': '0.0496', 'NDCG@5': '0.0347', 'HR@10': '0.0724', 'NDCG@10': '0.0421', 'HR@20': '0.1028', 'NDCG@20': '0.0497'}
2025-02-21 11:21:02,252 - Validation score increased.  Saving model ...
2025-02-21 11:21:43,689 - {'epoch': 21, 'rec_loss': '7.8384'}
2025-02-21 11:22:02,651 - {'Epoch': 21, 'HR@5': '0.0503', 'NDCG@5': '0.0354', 'HR@10': '0.0728', 'NDCG@10': '0.0427', 'HR@20': '0.1048', 'NDCG@20': '0.0507'}
2025-02-21 11:22:02,656 - Validation score increased.  Saving model ...
2025-02-21 11:22:43,494 - {'epoch': 22, 'rec_loss': '7.8287'}
2025-02-21 11:23:02,441 - {'Epoch': 22, 'HR@5': '0.0499', 'NDCG@5': '0.0348', 'HR@10': '0.0724', 'NDCG@10': '0.0421', 'HR@20': '0.1025', 'NDCG@20': '0.0497'}
2025-02-21 11:23:02,442 - EarlyStopping counter: 1 out of 10
2025-02-21 11:23:43,622 - {'epoch': 23, 'rec_loss': '7.8147'}
2025-02-21 11:24:01,519 - {'Epoch': 23, 'HR@5': '0.0496', 'NDCG@5': '0.0349', 'HR@10': '0.0731', 'NDCG@10': '0.0424', 'HR@20': '0.1033', 'NDCG@20': '0.0501'}
2025-02-21 11:24:01,520 - EarlyStopping counter: 2 out of 10
2025-02-21 11:24:42,084 - {'epoch': 24, 'rec_loss': '7.8027'}
2025-02-21 11:24:59,975 - {'Epoch': 24, 'HR@5': '0.0504', 'NDCG@5': '0.0352', 'HR@10': '0.0728', 'NDCG@10': '0.0424', 'HR@20': '0.1041', 'NDCG@20': '0.0502'}
2025-02-21 11:24:59,977 - EarlyStopping counter: 3 out of 10
2025-02-21 11:25:39,845 - {'epoch': 25, 'rec_loss': '7.7903'}
2025-02-21 11:25:58,068 - {'Epoch': 25, 'HR@5': '0.0518', 'NDCG@5': '0.0357', 'HR@10': '0.0746', 'NDCG@10': '0.0429', 'HR@20': '0.1048', 'NDCG@20': '0.0505'}
2025-02-21 11:25:58,069 - EarlyStopping counter: 4 out of 10
2025-02-21 11:26:37,971 - {'epoch': 26, 'rec_loss': '7.7767'}
2025-02-21 11:26:56,508 - {'Epoch': 26, 'HR@5': '0.0519', 'NDCG@5': '0.0359', 'HR@10': '0.0747', 'NDCG@10': '0.0432', 'HR@20': '0.1053', 'NDCG@20': '0.0509'}
2025-02-21 11:26:56,509 - Validation score increased.  Saving model ...
2025-02-21 11:27:35,846 - {'epoch': 27, 'rec_loss': '7.7648'}
2025-02-21 11:27:54,231 - {'Epoch': 27, 'HR@5': '0.0521', 'NDCG@5': '0.0360', 'HR@10': '0.0749', 'NDCG@10': '0.0433', 'HR@20': '0.1046', 'NDCG@20': '0.0508'}
2025-02-21 11:27:54,232 - EarlyStopping counter: 1 out of 10
2025-02-21 11:28:34,354 - {'epoch': 28, 'rec_loss': '7.7507'}
2025-02-21 11:28:52,849 - {'Epoch': 28, 'HR@5': '0.0514', 'NDCG@5': '0.0357', 'HR@10': '0.0742', 'NDCG@10': '0.0430', 'HR@20': '0.1040', 'NDCG@20': '0.0505'}
2025-02-21 11:28:52,853 - EarlyStopping counter: 2 out of 10
2025-02-21 11:29:32,219 - {'epoch': 29, 'rec_loss': '7.7435'}
2025-02-21 11:29:50,372 - {'Epoch': 29, 'HR@5': '0.0506', 'NDCG@5': '0.0356', 'HR@10': '0.0745', 'NDCG@10': '0.0434', 'HR@20': '0.1047', 'NDCG@20': '0.0509'}
2025-02-21 11:29:50,373 - EarlyStopping counter: 3 out of 10
2025-02-21 11:30:30,911 - {'epoch': 30, 'rec_loss': '7.7358'}
2025-02-21 11:30:48,740 - {'Epoch': 30, 'HR@5': '0.0517', 'NDCG@5': '0.0358', 'HR@10': '0.0737', 'NDCG@10': '0.0429', 'HR@20': '0.1046', 'NDCG@20': '0.0506'}
2025-02-21 11:30:48,745 - EarlyStopping counter: 4 out of 10
2025-02-21 11:31:29,233 - {'epoch': 31, 'rec_loss': '7.7285'}
2025-02-21 11:31:47,488 - {'Epoch': 31, 'HR@5': '0.0516', 'NDCG@5': '0.0360', 'HR@10': '0.0741', 'NDCG@10': '0.0433', 'HR@20': '0.1035', 'NDCG@20': '0.0507'}
2025-02-21 11:31:47,489 - EarlyStopping counter: 5 out of 10
2025-02-21 11:32:26,772 - {'epoch': 32, 'rec_loss': '7.7215'}
2025-02-21 11:32:44,784 - {'Epoch': 32, 'HR@5': '0.0513', 'NDCG@5': '0.0358', 'HR@10': '0.0737', 'NDCG@10': '0.0430', 'HR@20': '0.1045', 'NDCG@20': '0.0508'}
2025-02-21 11:32:44,786 - EarlyStopping counter: 6 out of 10
2025-02-21 11:33:24,900 - {'epoch': 33, 'rec_loss': '7.7079'}
2025-02-21 11:33:43,797 - {'Epoch': 33, 'HR@5': '0.0513', 'NDCG@5': '0.0359', 'HR@10': '0.0742', 'NDCG@10': '0.0433', 'HR@20': '0.1049', 'NDCG@20': '0.0510'}
2025-02-21 11:33:43,801 - Validation score increased.  Saving model ...
2025-02-21 11:34:23,984 - {'epoch': 34, 'rec_loss': '7.7112'}
2025-02-21 11:34:41,589 - {'Epoch': 34, 'HR@5': '0.0517', 'NDCG@5': '0.0359', 'HR@10': '0.0741', 'NDCG@10': '0.0430', 'HR@20': '0.1048', 'NDCG@20': '0.0508'}
2025-02-21 11:34:41,591 - EarlyStopping counter: 1 out of 10
2025-02-21 11:35:20,683 - {'epoch': 35, 'rec_loss': '7.7000'}
2025-02-21 11:35:38,930 - {'Epoch': 35, 'HR@5': '0.0516', 'NDCG@5': '0.0358', 'HR@10': '0.0741', 'NDCG@10': '0.0430', 'HR@20': '0.1049', 'NDCG@20': '0.0508'}
2025-02-21 11:35:38,932 - EarlyStopping counter: 2 out of 10
2025-02-21 11:36:18,428 - {'epoch': 36, 'rec_loss': '7.6952'}
2025-02-21 11:36:37,342 - {'Epoch': 36, 'HR@5': '0.0511', 'NDCG@5': '0.0356', 'HR@10': '0.0745', 'NDCG@10': '0.0432', 'HR@20': '0.1036', 'NDCG@20': '0.0505'}
2025-02-21 11:36:37,346 - EarlyStopping counter: 3 out of 10
2025-02-21 11:37:17,010 - {'epoch': 37, 'rec_loss': '7.6868'}
2025-02-21 11:37:35,242 - {'Epoch': 37, 'HR@5': '0.0521', 'NDCG@5': '0.0361', 'HR@10': '0.0747', 'NDCG@10': '0.0434', 'HR@20': '0.1055', 'NDCG@20': '0.0512'}
2025-02-21 11:37:35,244 - Validation score increased.  Saving model ...
2025-02-21 11:38:14,168 - {'epoch': 38, 'rec_loss': '7.6748'}
2025-02-21 11:38:32,201 - {'Epoch': 38, 'HR@5': '0.0516', 'NDCG@5': '0.0359', 'HR@10': '0.0759', 'NDCG@10': '0.0438', 'HR@20': '0.1056', 'NDCG@20': '0.0513'}
2025-02-21 11:38:32,203 - Validation score increased.  Saving model ...
2025-02-21 11:39:12,705 - {'epoch': 39, 'rec_loss': '7.6715'}
2025-02-21 11:39:31,484 - {'Epoch': 39, 'HR@5': '0.0524', 'NDCG@5': '0.0361', 'HR@10': '0.0750', 'NDCG@10': '0.0434', 'HR@20': '0.1053', 'NDCG@20': '0.0510'}
2025-02-21 11:39:31,486 - EarlyStopping counter: 1 out of 10
2025-02-21 11:40:10,877 - {'epoch': 40, 'rec_loss': '7.6640'}
2025-02-21 11:40:29,235 - {'Epoch': 40, 'HR@5': '0.0516', 'NDCG@5': '0.0358', 'HR@10': '0.0757', 'NDCG@10': '0.0435', 'HR@20': '0.1058', 'NDCG@20': '0.0511'}
2025-02-21 11:40:29,239 - EarlyStopping counter: 2 out of 10
2025-02-21 11:41:08,928 - {'epoch': 41, 'rec_loss': '7.6552'}
2025-02-21 11:41:27,036 - {'Epoch': 41, 'HR@5': '0.0523', 'NDCG@5': '0.0362', 'HR@10': '0.0761', 'NDCG@10': '0.0438', 'HR@20': '0.1056', 'NDCG@20': '0.0512'}
2025-02-21 11:41:27,037 - EarlyStopping counter: 3 out of 10
2025-02-21 11:42:07,617 - {'epoch': 42, 'rec_loss': '7.6525'}
2025-02-21 11:42:26,526 - {'Epoch': 42, 'HR@5': '0.0522', 'NDCG@5': '0.0363', 'HR@10': '0.0761', 'NDCG@10': '0.0440', 'HR@20': '0.1071', 'NDCG@20': '0.0518'}
2025-02-21 11:42:26,531 - Validation score increased.  Saving model ...
2025-02-21 11:43:07,889 - {'epoch': 43, 'rec_loss': '7.6499'}
2025-02-21 11:43:25,830 - {'Epoch': 43, 'HR@5': '0.0528', 'NDCG@5': '0.0364', 'HR@10': '0.0759', 'NDCG@10': '0.0438', 'HR@20': '0.1058', 'NDCG@20': '0.0514'}
2025-02-21 11:43:25,833 - EarlyStopping counter: 1 out of 10
2025-02-21 11:44:08,219 - {'epoch': 44, 'rec_loss': '7.6392'}
2025-02-21 11:44:26,941 - {'Epoch': 44, 'HR@5': '0.0527', 'NDCG@5': '0.0367', 'HR@10': '0.0765', 'NDCG@10': '0.0443', 'HR@20': '0.1060', 'NDCG@20': '0.0517'}
2025-02-21 11:44:26,943 - EarlyStopping counter: 2 out of 10
2025-02-21 11:45:08,084 - {'epoch': 45, 'rec_loss': '7.6358'}
2025-02-21 11:45:27,284 - {'Epoch': 45, 'HR@5': '0.0527', 'NDCG@5': '0.0364', 'HR@10': '0.0759', 'NDCG@10': '0.0438', 'HR@20': '0.1071', 'NDCG@20': '0.0517'}
2025-02-21 11:45:27,286 - EarlyStopping counter: 3 out of 10
2025-02-21 11:46:07,554 - {'epoch': 46, 'rec_loss': '7.6325'}
2025-02-21 11:46:25,949 - {'Epoch': 46, 'HR@5': '0.0526', 'NDCG@5': '0.0368', 'HR@10': '0.0750', 'NDCG@10': '0.0440', 'HR@20': '0.1062', 'NDCG@20': '0.0519'}
2025-02-21 11:46:25,950 - Validation score increased.  Saving model ...
2025-02-21 11:47:05,808 - {'epoch': 47, 'rec_loss': '7.6366'}
2025-02-21 11:47:24,041 - {'Epoch': 47, 'HR@5': '0.0529', 'NDCG@5': '0.0366', 'HR@10': '0.0763', 'NDCG@10': '0.0441', 'HR@20': '0.1070', 'NDCG@20': '0.0518'}
2025-02-21 11:47:24,043 - EarlyStopping counter: 1 out of 10
2025-02-21 11:48:03,859 - {'epoch': 48, 'rec_loss': '7.6174'}
2025-02-21 11:48:21,480 - {'Epoch': 48, 'HR@5': '0.0533', 'NDCG@5': '0.0371', 'HR@10': '0.0758', 'NDCG@10': '0.0443', 'HR@20': '0.1057', 'NDCG@20': '0.0519'}
2025-02-21 11:48:21,485 - Validation score increased.  Saving model ...
2025-02-21 11:49:01,689 - {'epoch': 49, 'rec_loss': '7.6200'}
2025-02-21 11:49:19,620 - {'Epoch': 49, 'HR@5': '0.0527', 'NDCG@5': '0.0366', 'HR@10': '0.0753', 'NDCG@10': '0.0439', 'HR@20': '0.1058', 'NDCG@20': '0.0516'}
2025-02-21 11:49:19,624 - EarlyStopping counter: 1 out of 10
2025-02-21 11:50:00,977 - {'epoch': 50, 'rec_loss': '7.6181'}
2025-02-21 11:50:19,592 - {'Epoch': 50, 'HR@5': '0.0524', 'NDCG@5': '0.0365', 'HR@10': '0.0746', 'NDCG@10': '0.0436', 'HR@20': '0.1044', 'NDCG@20': '0.0512'}
2025-02-21 11:50:19,595 - EarlyStopping counter: 2 out of 10
2025-02-21 11:50:59,477 - {'epoch': 51, 'rec_loss': '7.6078'}
2025-02-21 11:51:18,008 - {'Epoch': 51, 'HR@5': '0.0519', 'NDCG@5': '0.0363', 'HR@10': '0.0749', 'NDCG@10': '0.0437', 'HR@20': '0.1058', 'NDCG@20': '0.0514'}
2025-02-21 11:51:18,010 - EarlyStopping counter: 3 out of 10
2025-02-21 11:51:59,723 - {'epoch': 52, 'rec_loss': '7.6020'}
2025-02-21 11:52:18,476 - {'Epoch': 52, 'HR@5': '0.0518', 'NDCG@5': '0.0359', 'HR@10': '0.0754', 'NDCG@10': '0.0434', 'HR@20': '0.1055', 'NDCG@20': '0.0510'}
2025-02-21 11:52:18,477 - EarlyStopping counter: 4 out of 10
2025-02-21 11:52:58,436 - {'epoch': 53, 'rec_loss': '7.6077'}
2025-02-21 11:53:16,358 - {'Epoch': 53, 'HR@5': '0.0518', 'NDCG@5': '0.0359', 'HR@10': '0.0749', 'NDCG@10': '0.0433', 'HR@20': '0.1060', 'NDCG@20': '0.0512'}
2025-02-21 11:53:16,362 - EarlyStopping counter: 5 out of 10
2025-02-21 11:53:56,324 - {'epoch': 54, 'rec_loss': '7.6008'}
2025-02-21 11:54:14,667 - {'Epoch': 54, 'HR@5': '0.0516', 'NDCG@5': '0.0359', 'HR@10': '0.0748', 'NDCG@10': '0.0434', 'HR@20': '0.1055', 'NDCG@20': '0.0511'}
2025-02-21 11:54:14,671 - EarlyStopping counter: 6 out of 10
2025-02-21 11:54:54,822 - {'epoch': 55, 'rec_loss': '7.5936'}
2025-02-21 11:55:13,395 - {'Epoch': 55, 'HR@5': '0.0533', 'NDCG@5': '0.0368', 'HR@10': '0.0759', 'NDCG@10': '0.0440', 'HR@20': '0.1055', 'NDCG@20': '0.0515'}
2025-02-21 11:55:13,397 - EarlyStopping counter: 7 out of 10
2025-02-21 11:55:53,685 - {'epoch': 56, 'rec_loss': '7.5921'}
2025-02-21 11:56:11,363 - {'Epoch': 56, 'HR@5': '0.0525', 'NDCG@5': '0.0365', 'HR@10': '0.0757', 'NDCG@10': '0.0439', 'HR@20': '0.1058', 'NDCG@20': '0.0515'}
2025-02-21 11:56:11,364 - EarlyStopping counter: 8 out of 10
2025-02-21 11:56:51,372 - {'epoch': 57, 'rec_loss': '7.5879'}
2025-02-21 11:57:09,649 - {'Epoch': 57, 'HR@5': '0.0520', 'NDCG@5': '0.0364', 'HR@10': '0.0743', 'NDCG@10': '0.0435', 'HR@20': '0.1062', 'NDCG@20': '0.0516'}
2025-02-21 11:57:09,651 - EarlyStopping counter: 9 out of 10
2025-02-21 11:57:49,031 - {'epoch': 58, 'rec_loss': '7.5849'}
2025-02-21 11:58:07,868 - {'Epoch': 58, 'HR@5': '0.0519', 'NDCG@5': '0.0364', 'HR@10': '0.0748', 'NDCG@10': '0.0438', 'HR@20': '0.1062', 'NDCG@20': '0.0517'}
2025-02-21 11:58:07,873 - EarlyStopping counter: 10 out of 10
2025-02-21 11:58:07,873 - Early stopping
2025-02-21 11:58:07,873 - ---------------Test Score---------------
2025-02-21 11:58:26,174 - {'Epoch': 0, 'HR@5': '0.0431', 'NDCG@5': '0.0299', 'HR@10': '0.0628', 'NDCG@10': '0.0363', 'HR@20': '0.0892', 'NDCG@20': '0.0429'}
2025-02-21 11:58:26,176 - Scale_Sports
2025-02-21 11:58:26,177 - {'Epoch': 0, 'HR@5': '0.0431', 'NDCG@5': '0.0299', 'HR@10': '0.0628', 'NDCG@10': '0.0363', 'HR@20': '0.0892', 'NDCG@20': '0.0429'}
2025-02-21 12:03:10,336 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-21 12:03:13,376 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-21 12:03:13,387 - Total Parameters: 1328854
2025-02-21 12:03:54,353 - {'epoch': 0, 'rec_loss': '9.4016'}
2025-02-21 12:04:12,119 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0054', 'HR@10': '0.0125', 'NDCG@10': '0.0068', 'HR@20': '0.0215', 'NDCG@20': '0.0090'}
2025-02-21 12:04:12,122 - Validation score increased.  Saving model ...
2025-02-21 12:04:53,109 - {'epoch': 1, 'rec_loss': '9.2044'}
2025-02-21 12:05:10,092 - {'Epoch': 1, 'HR@5': '0.0138', 'NDCG@5': '0.0086', 'HR@10': '0.0224', 'NDCG@10': '0.0114', 'HR@20': '0.0392', 'NDCG@20': '0.0156'}
2025-02-21 12:05:10,094 - Validation score increased.  Saving model ...
2025-02-21 12:05:50,332 - {'epoch': 2, 'rec_loss': '8.9419'}
2025-02-21 12:06:08,223 - {'Epoch': 2, 'HR@5': '0.0173', 'NDCG@5': '0.0118', 'HR@10': '0.0301', 'NDCG@10': '0.0159', 'HR@20': '0.0483', 'NDCG@20': '0.0205'}
2025-02-21 12:06:08,224 - Validation score increased.  Saving model ...
2025-02-21 12:06:48,454 - {'epoch': 3, 'rec_loss': '8.7534'}
2025-02-21 12:07:06,167 - {'Epoch': 3, 'HR@5': '0.0266', 'NDCG@5': '0.0173', 'HR@10': '0.0404', 'NDCG@10': '0.0217', 'HR@20': '0.0632', 'NDCG@20': '0.0275'}
2025-02-21 12:07:06,168 - Validation score increased.  Saving model ...
2025-02-21 12:07:46,801 - {'epoch': 4, 'rec_loss': '8.6044'}
2025-02-21 12:08:04,260 - {'Epoch': 4, 'HR@5': '0.0301', 'NDCG@5': '0.0198', 'HR@10': '0.0471', 'NDCG@10': '0.0252', 'HR@20': '0.0713', 'NDCG@20': '0.0313'}
2025-02-21 12:08:04,261 - Validation score increased.  Saving model ...
2025-02-21 12:08:44,978 - {'epoch': 5, 'rec_loss': '8.4818'}
2025-02-21 12:09:02,610 - {'Epoch': 5, 'HR@5': '0.0366', 'NDCG@5': '0.0243', 'HR@10': '0.0539', 'NDCG@10': '0.0299', 'HR@20': '0.0787', 'NDCG@20': '0.0361'}
2025-02-21 12:09:02,611 - Validation score increased.  Saving model ...
2025-02-21 12:09:44,893 - {'epoch': 6, 'rec_loss': '8.3899'}
2025-02-21 12:10:03,151 - {'Epoch': 6, 'HR@5': '0.0378', 'NDCG@5': '0.0255', 'HR@10': '0.0567', 'NDCG@10': '0.0316', 'HR@20': '0.0829', 'NDCG@20': '0.0382'}
2025-02-21 12:10:03,154 - Validation score increased.  Saving model ...
2025-02-21 12:10:44,284 - {'epoch': 7, 'rec_loss': '8.3088'}
2025-02-21 12:11:01,369 - {'Epoch': 7, 'HR@5': '0.0401', 'NDCG@5': '0.0275', 'HR@10': '0.0592', 'NDCG@10': '0.0337', 'HR@20': '0.0859', 'NDCG@20': '0.0404'}
2025-02-21 12:11:01,370 - Validation score increased.  Saving model ...
2025-02-21 12:11:41,926 - {'epoch': 8, 'rec_loss': '8.2410'}
2025-02-21 12:11:59,479 - {'Epoch': 8, 'HR@5': '0.0427', 'NDCG@5': '0.0297', 'HR@10': '0.0615', 'NDCG@10': '0.0358', 'HR@20': '0.0893', 'NDCG@20': '0.0427'}
2025-02-21 12:11:59,480 - Validation score increased.  Saving model ...
2025-02-21 12:12:39,149 - {'epoch': 9, 'rec_loss': '8.1844'}
2025-02-21 12:12:56,566 - {'Epoch': 9, 'HR@5': '0.0439', 'NDCG@5': '0.0305', 'HR@10': '0.0631', 'NDCG@10': '0.0366', 'HR@20': '0.0917', 'NDCG@20': '0.0438'}
2025-02-21 12:12:56,567 - Validation score increased.  Saving model ...
2025-02-21 12:13:36,543 - {'epoch': 10, 'rec_loss': '8.1396'}
2025-02-21 12:13:53,952 - {'Epoch': 10, 'HR@5': '0.0446', 'NDCG@5': '0.0311', 'HR@10': '0.0648', 'NDCG@10': '0.0376', 'HR@20': '0.0916', 'NDCG@20': '0.0443'}
2025-02-21 12:13:53,954 - Validation score increased.  Saving model ...
2025-02-21 12:14:34,625 - {'epoch': 11, 'rec_loss': '8.0916'}
2025-02-21 12:14:53,264 - {'Epoch': 11, 'HR@5': '0.0463', 'NDCG@5': '0.0318', 'HR@10': '0.0663', 'NDCG@10': '0.0382', 'HR@20': '0.0956', 'NDCG@20': '0.0456'}
2025-02-21 12:14:53,266 - Validation score increased.  Saving model ...
2025-02-21 12:15:33,276 - {'epoch': 12, 'rec_loss': '8.0572'}
2025-02-21 12:15:50,639 - {'Epoch': 12, 'HR@5': '0.0477', 'NDCG@5': '0.0328', 'HR@10': '0.0677', 'NDCG@10': '0.0392', 'HR@20': '0.0958', 'NDCG@20': '0.0463'}
2025-02-21 12:15:50,641 - Validation score increased.  Saving model ...
2025-02-21 12:16:31,782 - {'epoch': 13, 'rec_loss': '8.0266'}
2025-02-21 12:16:50,037 - {'Epoch': 13, 'HR@5': '0.0475', 'NDCG@5': '0.0329', 'HR@10': '0.0680', 'NDCG@10': '0.0395', 'HR@20': '0.0966', 'NDCG@20': '0.0467'}
2025-02-21 12:16:50,039 - Validation score increased.  Saving model ...
2025-02-21 12:17:30,504 - {'epoch': 14, 'rec_loss': '7.9981'}
2025-02-21 12:17:48,306 - {'Epoch': 14, 'HR@5': '0.0486', 'NDCG@5': '0.0336', 'HR@10': '0.0685', 'NDCG@10': '0.0401', 'HR@20': '0.0975', 'NDCG@20': '0.0473'}
2025-02-21 12:17:48,307 - Validation score increased.  Saving model ...
2025-02-21 12:18:29,071 - {'epoch': 15, 'rec_loss': '7.9702'}
2025-02-21 12:18:46,302 - {'Epoch': 15, 'HR@5': '0.0489', 'NDCG@5': '0.0338', 'HR@10': '0.0692', 'NDCG@10': '0.0404', 'HR@20': '0.0982', 'NDCG@20': '0.0476'}
2025-02-21 12:18:46,303 - Validation score increased.  Saving model ...
2025-02-21 12:19:27,040 - {'epoch': 16, 'rec_loss': '7.9471'}
2025-02-21 12:19:45,400 - {'Epoch': 16, 'HR@5': '0.0486', 'NDCG@5': '0.0338', 'HR@10': '0.0690', 'NDCG@10': '0.0403', 'HR@20': '0.0995', 'NDCG@20': '0.0480'}
2025-02-21 12:19:45,405 - Validation score increased.  Saving model ...
2025-02-21 12:20:25,840 - {'epoch': 17, 'rec_loss': '7.9256'}
2025-02-21 12:20:43,624 - {'Epoch': 17, 'HR@5': '0.0488', 'NDCG@5': '0.0341', 'HR@10': '0.0698', 'NDCG@10': '0.0409', 'HR@20': '0.0983', 'NDCG@20': '0.0480'}
2025-02-21 12:20:43,625 - Validation score increased.  Saving model ...
2025-02-21 12:21:24,735 - {'epoch': 18, 'rec_loss': '7.9030'}
2025-02-21 12:21:41,973 - {'Epoch': 18, 'HR@5': '0.0494', 'NDCG@5': '0.0345', 'HR@10': '0.0716', 'NDCG@10': '0.0416', 'HR@20': '0.1004', 'NDCG@20': '0.0488'}
2025-02-21 12:21:41,974 - Validation score increased.  Saving model ...
2025-02-21 12:22:22,782 - {'epoch': 19, 'rec_loss': '7.8821'}
2025-02-21 12:22:40,693 - {'Epoch': 19, 'HR@5': '0.0498', 'NDCG@5': '0.0349', 'HR@10': '0.0716', 'NDCG@10': '0.0419', 'HR@20': '0.1009', 'NDCG@20': '0.0492'}
2025-02-21 12:22:40,698 - Validation score increased.  Saving model ...
2025-02-21 12:23:21,425 - {'epoch': 20, 'rec_loss': '7.8683'}
2025-02-21 12:23:39,873 - {'Epoch': 20, 'HR@5': '0.0514', 'NDCG@5': '0.0355', 'HR@10': '0.0729', 'NDCG@10': '0.0424', 'HR@20': '0.1026', 'NDCG@20': '0.0499'}
2025-02-21 12:23:39,875 - Validation score increased.  Saving model ...
2025-02-21 12:24:20,737 - {'epoch': 21, 'rec_loss': '7.8478'}
2025-02-21 12:24:38,882 - {'Epoch': 21, 'HR@5': '0.0495', 'NDCG@5': '0.0342', 'HR@10': '0.0707', 'NDCG@10': '0.0410', 'HR@20': '0.1026', 'NDCG@20': '0.0490'}
2025-02-21 12:24:38,884 - EarlyStopping counter: 1 out of 10
2025-02-21 12:25:20,003 - {'epoch': 22, 'rec_loss': '7.8354'}
2025-02-21 12:25:38,445 - {'Epoch': 22, 'HR@5': '0.0502', 'NDCG@5': '0.0349', 'HR@10': '0.0719', 'NDCG@10': '0.0418', 'HR@20': '0.1029', 'NDCG@20': '0.0496'}
2025-02-21 12:25:38,447 - EarlyStopping counter: 2 out of 10
2025-02-21 12:26:20,641 - {'epoch': 23, 'rec_loss': '7.8210'}
2025-02-21 12:26:39,011 - {'Epoch': 23, 'HR@5': '0.0501', 'NDCG@5': '0.0347', 'HR@10': '0.0723', 'NDCG@10': '0.0419', 'HR@20': '0.1032', 'NDCG@20': '0.0496'}
2025-02-21 12:26:39,015 - EarlyStopping counter: 3 out of 10
2025-02-21 12:27:19,902 - {'epoch': 24, 'rec_loss': '7.8063'}
2025-02-21 12:27:37,456 - {'Epoch': 24, 'HR@5': '0.0497', 'NDCG@5': '0.0348', 'HR@10': '0.0727', 'NDCG@10': '0.0422', 'HR@20': '0.1041', 'NDCG@20': '0.0500'}
2025-02-21 12:27:37,457 - Validation score increased.  Saving model ...
2025-02-21 12:28:18,003 - {'epoch': 25, 'rec_loss': '7.7910'}
2025-02-21 12:28:36,283 - {'Epoch': 25, 'HR@5': '0.0502', 'NDCG@5': '0.0350', 'HR@10': '0.0730', 'NDCG@10': '0.0423', 'HR@20': '0.1045', 'NDCG@20': '0.0503'}
2025-02-21 12:28:36,285 - Validation score increased.  Saving model ...
2025-02-21 12:29:17,820 - {'epoch': 26, 'rec_loss': '7.7805'}
2025-02-21 12:29:35,755 - {'Epoch': 26, 'HR@5': '0.0516', 'NDCG@5': '0.0360', 'HR@10': '0.0737', 'NDCG@10': '0.0432', 'HR@20': '0.1032', 'NDCG@20': '0.0506'}
2025-02-21 12:29:35,759 - Validation score increased.  Saving model ...
2025-02-21 12:30:16,736 - {'epoch': 27, 'rec_loss': '7.7632'}
2025-02-21 12:30:35,128 - {'Epoch': 27, 'HR@5': '0.0515', 'NDCG@5': '0.0357', 'HR@10': '0.0735', 'NDCG@10': '0.0428', 'HR@20': '0.1030', 'NDCG@20': '0.0502'}
2025-02-21 12:30:35,129 - EarlyStopping counter: 1 out of 10
2025-02-21 12:31:16,112 - {'epoch': 28, 'rec_loss': '7.7580'}
2025-02-21 12:31:34,638 - {'Epoch': 28, 'HR@5': '0.0505', 'NDCG@5': '0.0357', 'HR@10': '0.0735', 'NDCG@10': '0.0432', 'HR@20': '0.1041', 'NDCG@20': '0.0508'}
2025-02-21 12:31:34,640 - Validation score increased.  Saving model ...
2025-02-21 12:32:16,401 - {'epoch': 29, 'rec_loss': '7.7481'}
2025-02-21 12:32:34,596 - {'Epoch': 29, 'HR@5': '0.0512', 'NDCG@5': '0.0357', 'HR@10': '0.0740', 'NDCG@10': '0.0430', 'HR@20': '0.1046', 'NDCG@20': '0.0507'}
2025-02-21 12:32:34,597 - EarlyStopping counter: 1 out of 10
2025-02-21 12:33:15,122 - {'epoch': 30, 'rec_loss': '7.7386'}
2025-02-21 12:33:33,903 - {'Epoch': 30, 'HR@5': '0.0507', 'NDCG@5': '0.0354', 'HR@10': '0.0742', 'NDCG@10': '0.0429', 'HR@20': '0.1034', 'NDCG@20': '0.0503'}
2025-02-21 12:33:33,904 - EarlyStopping counter: 2 out of 10
2025-02-21 12:34:15,278 - {'epoch': 31, 'rec_loss': '7.7285'}
2025-02-21 12:34:33,467 - {'Epoch': 31, 'HR@5': '0.0510', 'NDCG@5': '0.0353', 'HR@10': '0.0735', 'NDCG@10': '0.0426', 'HR@20': '0.1049', 'NDCG@20': '0.0505'}
2025-02-21 12:34:33,469 - EarlyStopping counter: 3 out of 10
2025-02-21 12:35:13,138 - {'epoch': 32, 'rec_loss': '7.7164'}
2025-02-21 12:35:31,757 - {'Epoch': 32, 'HR@5': '0.0516', 'NDCG@5': '0.0356', 'HR@10': '0.0740', 'NDCG@10': '0.0428', 'HR@20': '0.1052', 'NDCG@20': '0.0506'}
2025-02-21 12:35:31,758 - EarlyStopping counter: 4 out of 10
2025-02-21 12:36:12,924 - {'epoch': 33, 'rec_loss': '7.7091'}
2025-02-21 12:36:31,521 - {'Epoch': 33, 'HR@5': '0.0522', 'NDCG@5': '0.0362', 'HR@10': '0.0744', 'NDCG@10': '0.0434', 'HR@20': '0.1051', 'NDCG@20': '0.0511'}
2025-02-21 12:36:31,523 - Validation score increased.  Saving model ...
2025-02-21 12:37:12,859 - {'epoch': 34, 'rec_loss': '7.7088'}
2025-02-21 12:37:31,227 - {'Epoch': 34, 'HR@5': '0.0511', 'NDCG@5': '0.0356', 'HR@10': '0.0744', 'NDCG@10': '0.0431', 'HR@20': '0.1052', 'NDCG@20': '0.0508'}
2025-02-21 12:37:31,229 - EarlyStopping counter: 1 out of 10
2025-02-21 12:38:11,644 - {'epoch': 35, 'rec_loss': '7.6945'}
2025-02-21 12:38:29,848 - {'Epoch': 35, 'HR@5': '0.0521', 'NDCG@5': '0.0362', 'HR@10': '0.0749', 'NDCG@10': '0.0436', 'HR@20': '0.1064', 'NDCG@20': '0.0515'}
2025-02-21 12:38:29,850 - Validation score increased.  Saving model ...
2025-02-21 12:39:11,143 - {'epoch': 36, 'rec_loss': '7.6873'}
2025-02-21 12:39:30,173 - {'Epoch': 36, 'HR@5': '0.0517', 'NDCG@5': '0.0362', 'HR@10': '0.0748', 'NDCG@10': '0.0436', 'HR@20': '0.1056', 'NDCG@20': '0.0514'}
2025-02-21 12:39:30,174 - EarlyStopping counter: 1 out of 10
2025-02-21 12:40:10,694 - {'epoch': 37, 'rec_loss': '7.6797'}
2025-02-21 12:40:29,128 - {'Epoch': 37, 'HR@5': '0.0516', 'NDCG@5': '0.0359', 'HR@10': '0.0746', 'NDCG@10': '0.0433', 'HR@20': '0.1060', 'NDCG@20': '0.0512'}
2025-02-21 12:40:29,129 - EarlyStopping counter: 2 out of 10
2025-02-21 12:41:09,791 - {'epoch': 38, 'rec_loss': '7.6684'}
2025-02-21 12:41:28,063 - {'Epoch': 38, 'HR@5': '0.0523', 'NDCG@5': '0.0363', 'HR@10': '0.0749', 'NDCG@10': '0.0435', 'HR@20': '0.1060', 'NDCG@20': '0.0514'}
2025-02-21 12:41:28,064 - EarlyStopping counter: 3 out of 10
2025-02-21 12:42:08,391 - {'epoch': 39, 'rec_loss': '7.6653'}
2025-02-21 12:42:26,437 - {'Epoch': 39, 'HR@5': '0.0518', 'NDCG@5': '0.0363', 'HR@10': '0.0746', 'NDCG@10': '0.0437', 'HR@20': '0.1061', 'NDCG@20': '0.0516'}
2025-02-21 12:42:26,441 - Validation score increased.  Saving model ...
2025-02-21 12:43:06,440 - {'epoch': 40, 'rec_loss': '7.6584'}
2025-02-21 12:43:24,344 - {'Epoch': 40, 'HR@5': '0.0523', 'NDCG@5': '0.0367', 'HR@10': '0.0748', 'NDCG@10': '0.0439', 'HR@20': '0.1046', 'NDCG@20': '0.0514'}
2025-02-21 12:43:24,345 - EarlyStopping counter: 1 out of 10
2025-02-21 12:44:03,687 - {'epoch': 41, 'rec_loss': '7.6471'}
2025-02-21 12:44:21,546 - {'Epoch': 41, 'HR@5': '0.0517', 'NDCG@5': '0.0361', 'HR@10': '0.0748', 'NDCG@10': '0.0435', 'HR@20': '0.1051', 'NDCG@20': '0.0511'}
2025-02-21 12:44:21,548 - EarlyStopping counter: 2 out of 10
2025-02-21 12:45:02,377 - {'epoch': 42, 'rec_loss': '7.6461'}
2025-02-21 12:45:21,210 - {'Epoch': 42, 'HR@5': '0.0513', 'NDCG@5': '0.0360', 'HR@10': '0.0745', 'NDCG@10': '0.0435', 'HR@20': '0.1053', 'NDCG@20': '0.0512'}
2025-02-21 12:45:21,211 - EarlyStopping counter: 3 out of 10
2025-02-21 12:46:02,195 - {'epoch': 43, 'rec_loss': '7.6415'}
2025-02-21 12:46:20,276 - {'Epoch': 43, 'HR@5': '0.0517', 'NDCG@5': '0.0358', 'HR@10': '0.0751', 'NDCG@10': '0.0434', 'HR@20': '0.1058', 'NDCG@20': '0.0511'}
2025-02-21 12:46:20,277 - EarlyStopping counter: 4 out of 10
2025-02-21 12:46:59,564 - {'epoch': 44, 'rec_loss': '7.6359'}
2025-02-21 12:47:17,733 - {'Epoch': 44, 'HR@5': '0.0523', 'NDCG@5': '0.0362', 'HR@10': '0.0767', 'NDCG@10': '0.0441', 'HR@20': '0.1070', 'NDCG@20': '0.0517'}
2025-02-21 12:47:17,735 - Validation score increased.  Saving model ...
2025-02-21 12:47:57,793 - {'epoch': 45, 'rec_loss': '7.6319'}
2025-02-21 12:48:16,770 - {'Epoch': 45, 'HR@5': '0.0516', 'NDCG@5': '0.0361', 'HR@10': '0.0755', 'NDCG@10': '0.0437', 'HR@20': '0.1059', 'NDCG@20': '0.0514'}
2025-02-21 12:48:16,772 - EarlyStopping counter: 1 out of 10
2025-02-21 12:48:57,455 - {'epoch': 46, 'rec_loss': '7.6300'}
2025-02-21 12:49:15,211 - {'Epoch': 46, 'HR@5': '0.0515', 'NDCG@5': '0.0360', 'HR@10': '0.0757', 'NDCG@10': '0.0438', 'HR@20': '0.1051', 'NDCG@20': '0.0512'}
2025-02-21 12:49:15,215 - EarlyStopping counter: 2 out of 10
2025-02-21 12:49:55,379 - {'epoch': 47, 'rec_loss': '7.6277'}
2025-02-21 12:50:13,516 - {'Epoch': 47, 'HR@5': '0.0525', 'NDCG@5': '0.0365', 'HR@10': '0.0750', 'NDCG@10': '0.0437', 'HR@20': '0.1060', 'NDCG@20': '0.0515'}
2025-02-21 12:50:13,517 - EarlyStopping counter: 3 out of 10
2025-02-21 12:50:54,062 - {'epoch': 48, 'rec_loss': '7.6166'}
2025-02-21 12:51:11,578 - {'Epoch': 48, 'HR@5': '0.0524', 'NDCG@5': '0.0362', 'HR@10': '0.0753', 'NDCG@10': '0.0435', 'HR@20': '0.1060', 'NDCG@20': '0.0513'}
2025-02-21 12:51:11,579 - EarlyStopping counter: 4 out of 10
2025-02-21 12:51:52,914 - {'epoch': 49, 'rec_loss': '7.6154'}
2025-02-21 12:52:11,485 - {'Epoch': 49, 'HR@5': '0.0521', 'NDCG@5': '0.0364', 'HR@10': '0.0740', 'NDCG@10': '0.0434', 'HR@20': '0.1060', 'NDCG@20': '0.0515'}
2025-02-21 12:52:11,486 - EarlyStopping counter: 5 out of 10
2025-02-21 12:52:52,121 - {'epoch': 50, 'rec_loss': '7.6159'}
2025-02-21 12:53:10,723 - {'Epoch': 50, 'HR@5': '0.0518', 'NDCG@5': '0.0362', 'HR@10': '0.0756', 'NDCG@10': '0.0439', 'HR@20': '0.1058', 'NDCG@20': '0.0515'}
2025-02-21 12:53:10,724 - EarlyStopping counter: 6 out of 10
2025-02-21 12:53:51,141 - {'epoch': 51, 'rec_loss': '7.6054'}
2025-02-21 12:54:09,100 - {'Epoch': 51, 'HR@5': '0.0515', 'NDCG@5': '0.0360', 'HR@10': '0.0751', 'NDCG@10': '0.0436', 'HR@20': '0.1059', 'NDCG@20': '0.0514'}
2025-02-21 12:54:09,101 - EarlyStopping counter: 7 out of 10
2025-02-21 12:54:49,911 - {'epoch': 52, 'rec_loss': '7.6012'}
2025-02-21 12:55:08,050 - {'Epoch': 52, 'HR@5': '0.0518', 'NDCG@5': '0.0364', 'HR@10': '0.0756', 'NDCG@10': '0.0440', 'HR@20': '0.1058', 'NDCG@20': '0.0516'}
2025-02-21 12:55:08,052 - EarlyStopping counter: 8 out of 10
2025-02-21 12:55:47,646 - {'epoch': 53, 'rec_loss': '7.6014'}
2025-02-21 12:56:05,605 - {'Epoch': 53, 'HR@5': '0.0521', 'NDCG@5': '0.0365', 'HR@10': '0.0760', 'NDCG@10': '0.0442', 'HR@20': '0.1058', 'NDCG@20': '0.0517'}
2025-02-21 12:56:05,607 - Validation score increased.  Saving model ...
2025-02-21 12:56:46,216 - {'epoch': 54, 'rec_loss': '7.5939'}
2025-02-21 12:57:04,419 - {'Epoch': 54, 'HR@5': '0.0527', 'NDCG@5': '0.0365', 'HR@10': '0.0765', 'NDCG@10': '0.0442', 'HR@20': '0.1062', 'NDCG@20': '0.0517'}
2025-02-21 12:57:04,420 - EarlyStopping counter: 1 out of 10
2025-02-21 12:57:44,969 - {'epoch': 55, 'rec_loss': '7.5874'}
2025-02-21 12:58:03,007 - {'Epoch': 55, 'HR@5': '0.0529', 'NDCG@5': '0.0369', 'HR@10': '0.0777', 'NDCG@10': '0.0449', 'HR@20': '0.1063', 'NDCG@20': '0.0521'}
2025-02-21 12:58:03,008 - Validation score increased.  Saving model ...
2025-02-21 12:58:43,190 - {'epoch': 56, 'rec_loss': '7.5873'}
2025-02-21 12:59:01,311 - {'Epoch': 56, 'HR@5': '0.0524', 'NDCG@5': '0.0361', 'HR@10': '0.0762', 'NDCG@10': '0.0438', 'HR@20': '0.1064', 'NDCG@20': '0.0513'}
2025-02-21 12:59:01,312 - EarlyStopping counter: 1 out of 10
2025-02-21 12:59:41,534 - {'epoch': 57, 'rec_loss': '7.5815'}
2025-02-21 12:59:59,745 - {'Epoch': 57, 'HR@5': '0.0508', 'NDCG@5': '0.0355', 'HR@10': '0.0753', 'NDCG@10': '0.0434', 'HR@20': '0.1062', 'NDCG@20': '0.0512'}
2025-02-21 12:59:59,746 - EarlyStopping counter: 2 out of 10
2025-02-21 13:00:39,679 - {'epoch': 58, 'rec_loss': '7.5807'}
2025-02-21 13:00:58,191 - {'Epoch': 58, 'HR@5': '0.0522', 'NDCG@5': '0.0366', 'HR@10': '0.0757', 'NDCG@10': '0.0441', 'HR@20': '0.1070', 'NDCG@20': '0.0520'}
2025-02-21 13:00:58,193 - EarlyStopping counter: 3 out of 10
2025-02-21 13:01:38,418 - {'epoch': 59, 'rec_loss': '7.5775'}
2025-02-21 13:01:57,193 - {'Epoch': 59, 'HR@5': '0.0515', 'NDCG@5': '0.0362', 'HR@10': '0.0765', 'NDCG@10': '0.0442', 'HR@20': '0.1068', 'NDCG@20': '0.0518'}
2025-02-21 13:01:57,195 - EarlyStopping counter: 4 out of 10
2025-02-21 13:02:38,483 - {'epoch': 60, 'rec_loss': '7.5700'}
2025-02-21 13:02:56,582 - {'Epoch': 60, 'HR@5': '0.0519', 'NDCG@5': '0.0362', 'HR@10': '0.0759', 'NDCG@10': '0.0439', 'HR@20': '0.1062', 'NDCG@20': '0.0515'}
2025-02-21 13:02:56,583 - EarlyStopping counter: 5 out of 10
2025-02-21 13:03:37,061 - {'epoch': 61, 'rec_loss': '7.5664'}
2025-02-21 13:03:55,467 - {'Epoch': 61, 'HR@5': '0.0526', 'NDCG@5': '0.0366', 'HR@10': '0.0755', 'NDCG@10': '0.0440', 'HR@20': '0.1080', 'NDCG@20': '0.0522'}
2025-02-21 13:03:55,468 - Validation score increased.  Saving model ...
2025-02-21 13:04:35,672 - {'epoch': 62, 'rec_loss': '7.5662'}
2025-02-21 13:04:53,725 - {'Epoch': 62, 'HR@5': '0.0521', 'NDCG@5': '0.0362', 'HR@10': '0.0764', 'NDCG@10': '0.0439', 'HR@20': '0.1070', 'NDCG@20': '0.0517'}
2025-02-21 13:04:53,726 - EarlyStopping counter: 1 out of 10
2025-02-21 13:05:34,761 - {'epoch': 63, 'rec_loss': '7.5644'}
2025-02-21 13:05:52,758 - {'Epoch': 63, 'HR@5': '0.0522', 'NDCG@5': '0.0366', 'HR@10': '0.0768', 'NDCG@10': '0.0445', 'HR@20': '0.1081', 'NDCG@20': '0.0524'}
2025-02-21 13:05:52,760 - Validation score increased.  Saving model ...
2025-02-21 13:06:32,816 - {'epoch': 64, 'rec_loss': '7.5591'}
2025-02-21 13:06:51,316 - {'Epoch': 64, 'HR@5': '0.0525', 'NDCG@5': '0.0365', 'HR@10': '0.0766', 'NDCG@10': '0.0442', 'HR@20': '0.1073', 'NDCG@20': '0.0519'}
2025-02-21 13:06:51,318 - EarlyStopping counter: 1 out of 10
2025-02-21 13:07:32,174 - {'epoch': 65, 'rec_loss': '7.5534'}
2025-02-21 13:07:50,563 - {'Epoch': 65, 'HR@5': '0.0532', 'NDCG@5': '0.0371', 'HR@10': '0.0767', 'NDCG@10': '0.0446', 'HR@20': '0.1077', 'NDCG@20': '0.0524'}
2025-02-21 13:07:50,567 - Validation score increased.  Saving model ...
2025-02-21 13:08:31,912 - {'epoch': 66, 'rec_loss': '7.5512'}
2025-02-21 13:08:50,627 - {'Epoch': 66, 'HR@5': '0.0523', 'NDCG@5': '0.0363', 'HR@10': '0.0754', 'NDCG@10': '0.0437', 'HR@20': '0.1060', 'NDCG@20': '0.0514'}
2025-02-21 13:08:50,628 - EarlyStopping counter: 1 out of 10
2025-02-21 13:09:30,375 - {'epoch': 67, 'rec_loss': '7.5509'}
2025-02-21 13:09:48,755 - {'Epoch': 67, 'HR@5': '0.0528', 'NDCG@5': '0.0367', 'HR@10': '0.0764', 'NDCG@10': '0.0443', 'HR@20': '0.1069', 'NDCG@20': '0.0520'}
2025-02-21 13:09:48,757 - EarlyStopping counter: 2 out of 10
2025-02-21 13:10:29,158 - {'epoch': 68, 'rec_loss': '7.5449'}
2025-02-21 13:10:48,088 - {'Epoch': 68, 'HR@5': '0.0528', 'NDCG@5': '0.0368', 'HR@10': '0.0767', 'NDCG@10': '0.0445', 'HR@20': '0.1067', 'NDCG@20': '0.0520'}
2025-02-21 13:10:48,090 - EarlyStopping counter: 3 out of 10
2025-02-21 13:11:28,721 - {'epoch': 69, 'rec_loss': '7.5435'}
2025-02-21 13:11:46,889 - {'Epoch': 69, 'HR@5': '0.0535', 'NDCG@5': '0.0371', 'HR@10': '0.0759', 'NDCG@10': '0.0443', 'HR@20': '0.1071', 'NDCG@20': '0.0521'}
2025-02-21 13:11:46,891 - EarlyStopping counter: 4 out of 10
2025-02-21 13:12:27,602 - {'epoch': 70, 'rec_loss': '7.5376'}
2025-02-21 13:12:45,962 - {'Epoch': 70, 'HR@5': '0.0522', 'NDCG@5': '0.0365', 'HR@10': '0.0760', 'NDCG@10': '0.0441', 'HR@20': '0.1067', 'NDCG@20': '0.0518'}
2025-02-21 13:12:45,964 - EarlyStopping counter: 5 out of 10
2025-02-21 13:13:27,315 - {'epoch': 71, 'rec_loss': '7.5405'}
2025-02-21 13:13:46,257 - {'Epoch': 71, 'HR@5': '0.0530', 'NDCG@5': '0.0370', 'HR@10': '0.0769', 'NDCG@10': '0.0446', 'HR@20': '0.1069', 'NDCG@20': '0.0522'}
2025-02-21 13:13:46,258 - EarlyStopping counter: 6 out of 10
2025-02-21 13:14:26,475 - {'epoch': 72, 'rec_loss': '7.5404'}
2025-02-21 13:14:44,640 - {'Epoch': 72, 'HR@5': '0.0535', 'NDCG@5': '0.0372', 'HR@10': '0.0766', 'NDCG@10': '0.0446', 'HR@20': '0.1067', 'NDCG@20': '0.0522'}
2025-02-21 13:14:44,642 - EarlyStopping counter: 7 out of 10
2025-02-21 13:15:24,898 - {'epoch': 73, 'rec_loss': '7.5336'}
2025-02-21 13:15:43,153 - {'Epoch': 73, 'HR@5': '0.0525', 'NDCG@5': '0.0363', 'HR@10': '0.0764', 'NDCG@10': '0.0440', 'HR@20': '0.1070', 'NDCG@20': '0.0517'}
2025-02-21 13:15:43,154 - EarlyStopping counter: 8 out of 10
2025-02-21 13:16:24,312 - {'epoch': 74, 'rec_loss': '7.5360'}
2025-02-21 13:16:42,904 - {'Epoch': 74, 'HR@5': '0.0526', 'NDCG@5': '0.0369', 'HR@10': '0.0771', 'NDCG@10': '0.0448', 'HR@20': '0.1071', 'NDCG@20': '0.0523'}
2025-02-21 13:16:42,906 - EarlyStopping counter: 9 out of 10
2025-02-21 13:17:23,455 - {'epoch': 75, 'rec_loss': '7.5248'}
2025-02-21 13:17:42,457 - {'Epoch': 75, 'HR@5': '0.0533', 'NDCG@5': '0.0373', 'HR@10': '0.0757', 'NDCG@10': '0.0445', 'HR@20': '0.1072', 'NDCG@20': '0.0524'}
2025-02-21 13:17:42,460 - EarlyStopping counter: 10 out of 10
2025-02-21 13:17:42,461 - Early stopping
2025-02-21 13:17:42,461 - ---------------Test Score---------------
2025-02-21 13:18:00,881 - {'Epoch': 0, 'HR@5': '0.0438', 'NDCG@5': '0.0301', 'HR@10': '0.0638', 'NDCG@10': '0.0365', 'HR@20': '0.0894', 'NDCG@20': '0.0429'}
2025-02-21 13:18:00,882 - Scale_Sports
2025-02-21 13:18:00,883 - {'Epoch': 0, 'HR@5': '0.0438', 'NDCG@5': '0.0301', 'HR@10': '0.0638', 'NDCG@10': '0.0365', 'HR@20': '0.0894', 'NDCG@20': '0.0429'}
2025-02-21 14:29:35,228 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='hyperrec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 5], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-21 14:29:38,033 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-21 14:29:38,038 - Total Parameters: 1328529
2025-02-21 14:30:20,026 - {'epoch': 0, 'rec_loss': '9.4061'}
2025-02-21 14:30:36,442 - {'Epoch': 0, 'HR@5': '0.0080', 'NDCG@5': '0.0054', 'HR@10': '0.0126', 'NDCG@10': '0.0068', 'HR@20': '0.0212', 'NDCG@20': '0.0090'}
2025-02-21 14:30:36,443 - Validation score increased.  Saving model ...
2025-02-21 14:31:19,031 - {'epoch': 1, 'rec_loss': '9.2349'}
2025-02-21 14:31:34,953 - {'Epoch': 1, 'HR@5': '0.0124', 'NDCG@5': '0.0081', 'HR@10': '0.0216', 'NDCG@10': '0.0110', 'HR@20': '0.0361', 'NDCG@20': '0.0147'}
2025-02-21 14:31:34,954 - Validation score increased.  Saving model ...
2025-02-21 14:32:17,133 - {'epoch': 2, 'rec_loss': '8.9604'}
2025-02-21 14:32:33,096 - {'Epoch': 2, 'HR@5': '0.0177', 'NDCG@5': '0.0115', 'HR@10': '0.0306', 'NDCG@10': '0.0156', 'HR@20': '0.0479', 'NDCG@20': '0.0199'}
2025-02-21 14:32:33,097 - Validation score increased.  Saving model ...
2025-02-21 14:33:13,685 - {'epoch': 3, 'rec_loss': '8.7525'}
2025-02-21 14:33:29,628 - {'Epoch': 3, 'HR@5': '0.0256', 'NDCG@5': '0.0163', 'HR@10': '0.0392', 'NDCG@10': '0.0206', 'HR@20': '0.0619', 'NDCG@20': '0.0263'}
2025-02-21 14:33:29,629 - Validation score increased.  Saving model ...
2025-02-21 14:34:09,995 - {'epoch': 4, 'rec_loss': '8.5988'}
2025-02-21 14:34:26,395 - {'Epoch': 4, 'HR@5': '0.0310', 'NDCG@5': '0.0208', 'HR@10': '0.0474', 'NDCG@10': '0.0260', 'HR@20': '0.0717', 'NDCG@20': '0.0321'}
2025-02-21 14:34:26,396 - Validation score increased.  Saving model ...
2025-02-21 14:35:07,431 - {'epoch': 5, 'rec_loss': '8.4831'}
2025-02-21 14:35:23,679 - {'Epoch': 5, 'HR@5': '0.0351', 'NDCG@5': '0.0236', 'HR@10': '0.0536', 'NDCG@10': '0.0296', 'HR@20': '0.0788', 'NDCG@20': '0.0359'}
2025-02-21 14:35:23,680 - Validation score increased.  Saving model ...
2025-02-21 14:36:03,412 - {'epoch': 6, 'rec_loss': '8.3858'}
2025-02-21 14:36:19,707 - {'Epoch': 6, 'HR@5': '0.0393', 'NDCG@5': '0.0269', 'HR@10': '0.0572', 'NDCG@10': '0.0326', 'HR@20': '0.0825', 'NDCG@20': '0.0390'}
2025-02-21 14:36:19,708 - Validation score increased.  Saving model ...
2025-02-21 14:37:00,792 - {'epoch': 7, 'rec_loss': '8.3058'}
2025-02-21 14:37:16,997 - {'Epoch': 7, 'HR@5': '0.0415', 'NDCG@5': '0.0279', 'HR@10': '0.0605', 'NDCG@10': '0.0340', 'HR@20': '0.0869', 'NDCG@20': '0.0406'}
2025-02-21 14:37:17,001 - Validation score increased.  Saving model ...
2025-02-21 14:37:57,865 - {'epoch': 8, 'rec_loss': '8.2374'}
2025-02-21 14:38:14,129 - {'Epoch': 8, 'HR@5': '0.0426', 'NDCG@5': '0.0293', 'HR@10': '0.0632', 'NDCG@10': '0.0359', 'HR@20': '0.0909', 'NDCG@20': '0.0429'}
2025-02-21 14:38:14,130 - Validation score increased.  Saving model ...
2025-02-21 14:38:55,414 - {'epoch': 9, 'rec_loss': '8.1777'}
2025-02-21 14:39:11,457 - {'Epoch': 9, 'HR@5': '0.0450', 'NDCG@5': '0.0305', 'HR@10': '0.0638', 'NDCG@10': '0.0366', 'HR@20': '0.0923', 'NDCG@20': '0.0437'}
2025-02-21 14:39:11,458 - Validation score increased.  Saving model ...
2025-02-21 14:39:52,178 - {'epoch': 10, 'rec_loss': '8.1282'}
2025-02-21 14:40:08,772 - {'Epoch': 10, 'HR@5': '0.0460', 'NDCG@5': '0.0313', 'HR@10': '0.0666', 'NDCG@10': '0.0379', 'HR@20': '0.0944', 'NDCG@20': '0.0449'}
2025-02-21 14:40:08,776 - Validation score increased.  Saving model ...
2025-02-21 14:40:49,831 - {'epoch': 11, 'rec_loss': '8.0901'}
2025-02-21 14:41:06,312 - {'Epoch': 11, 'HR@5': '0.0463', 'NDCG@5': '0.0319', 'HR@10': '0.0674', 'NDCG@10': '0.0386', 'HR@20': '0.0963', 'NDCG@20': '0.0459'}
2025-02-21 14:41:06,314 - Validation score increased.  Saving model ...
2025-02-21 14:41:46,856 - {'epoch': 12, 'rec_loss': '8.0511'}
2025-02-21 14:42:02,976 - {'Epoch': 12, 'HR@5': '0.0463', 'NDCG@5': '0.0322', 'HR@10': '0.0683', 'NDCG@10': '0.0393', 'HR@20': '0.0968', 'NDCG@20': '0.0465'}
2025-02-21 14:42:02,979 - Validation score increased.  Saving model ...
2025-02-21 14:42:43,858 - {'epoch': 13, 'rec_loss': '8.0210'}
2025-02-21 14:43:00,904 - {'Epoch': 13, 'HR@5': '0.0485', 'NDCG@5': '0.0334', 'HR@10': '0.0696', 'NDCG@10': '0.0402', 'HR@20': '0.0996', 'NDCG@20': '0.0477'}
2025-02-21 14:43:00,905 - Validation score increased.  Saving model ...
2025-02-21 14:43:41,786 - {'epoch': 14, 'rec_loss': '7.9906'}
2025-02-21 14:43:58,099 - {'Epoch': 14, 'HR@5': '0.0479', 'NDCG@5': '0.0334', 'HR@10': '0.0703', 'NDCG@10': '0.0406', 'HR@20': '0.0984', 'NDCG@20': '0.0477'}
2025-02-21 14:43:58,100 - EarlyStopping counter: 1 out of 10
2025-02-21 14:44:38,106 - {'epoch': 15, 'rec_loss': '7.9607'}
2025-02-21 14:44:54,385 - {'Epoch': 15, 'HR@5': '0.0491', 'NDCG@5': '0.0339', 'HR@10': '0.0708', 'NDCG@10': '0.0409', 'HR@20': '0.0998', 'NDCG@20': '0.0482'}
2025-02-21 14:44:54,386 - Validation score increased.  Saving model ...
2025-02-21 14:45:34,000 - {'epoch': 16, 'rec_loss': '7.9365'}
2025-02-21 14:45:50,239 - {'Epoch': 16, 'HR@5': '0.0487', 'NDCG@5': '0.0339', 'HR@10': '0.0708', 'NDCG@10': '0.0410', 'HR@20': '0.1003', 'NDCG@20': '0.0484'}
2025-02-21 14:45:50,240 - Validation score increased.  Saving model ...
2025-02-21 14:46:30,900 - {'epoch': 17, 'rec_loss': '7.9159'}
2025-02-21 14:46:47,311 - {'Epoch': 17, 'HR@5': '0.0484', 'NDCG@5': '0.0339', 'HR@10': '0.0708', 'NDCG@10': '0.0411', 'HR@20': '0.1008', 'NDCG@20': '0.0486'}
2025-02-21 14:46:47,315 - Validation score increased.  Saving model ...
2025-02-21 14:47:28,803 - {'epoch': 18, 'rec_loss': '7.8926'}
2025-02-21 14:47:46,591 - {'Epoch': 18, 'HR@5': '0.0490', 'NDCG@5': '0.0341', 'HR@10': '0.0708', 'NDCG@10': '0.0411', 'HR@20': '0.1017', 'NDCG@20': '0.0489'}
2025-02-21 14:47:46,592 - Validation score increased.  Saving model ...
2025-02-21 14:48:26,072 - {'epoch': 19, 'rec_loss': '7.8753'}
2025-02-21 14:48:43,745 - {'Epoch': 19, 'HR@5': '0.0498', 'NDCG@5': '0.0343', 'HR@10': '0.0727', 'NDCG@10': '0.0417', 'HR@20': '0.1026', 'NDCG@20': '0.0492'}
2025-02-21 14:48:43,746 - Validation score increased.  Saving model ...
2025-02-21 14:49:23,298 - {'epoch': 20, 'rec_loss': '7.8622'}
2025-02-21 14:49:41,492 - {'Epoch': 20, 'HR@5': '0.0496', 'NDCG@5': '0.0347', 'HR@10': '0.0724', 'NDCG@10': '0.0421', 'HR@20': '0.1028', 'NDCG@20': '0.0497'}
2025-02-21 14:49:41,493 - Validation score increased.  Saving model ...
2025-02-21 14:50:24,266 - {'epoch': 21, 'rec_loss': '7.8384'}
2025-02-21 14:50:41,354 - {'Epoch': 21, 'HR@5': '0.0503', 'NDCG@5': '0.0354', 'HR@10': '0.0728', 'NDCG@10': '0.0427', 'HR@20': '0.1048', 'NDCG@20': '0.0507'}
2025-02-21 14:50:41,355 - Validation score increased.  Saving model ...
2025-02-21 14:51:20,356 - {'epoch': 22, 'rec_loss': '7.8287'}
2025-02-21 14:51:38,815 - {'Epoch': 22, 'HR@5': '0.0499', 'NDCG@5': '0.0348', 'HR@10': '0.0724', 'NDCG@10': '0.0421', 'HR@20': '0.1025', 'NDCG@20': '0.0497'}
2025-02-21 14:51:38,817 - EarlyStopping counter: 1 out of 10
2025-02-21 14:52:17,438 - {'epoch': 23, 'rec_loss': '7.8147'}
2025-02-21 14:52:33,962 - {'Epoch': 23, 'HR@5': '0.0496', 'NDCG@5': '0.0349', 'HR@10': '0.0731', 'NDCG@10': '0.0424', 'HR@20': '0.1033', 'NDCG@20': '0.0501'}
2025-02-21 14:52:33,963 - EarlyStopping counter: 2 out of 10
2025-02-21 14:53:17,861 - {'epoch': 24, 'rec_loss': '7.8027'}
2025-02-21 14:53:36,906 - {'Epoch': 24, 'HR@5': '0.0504', 'NDCG@5': '0.0352', 'HR@10': '0.0728', 'NDCG@10': '0.0424', 'HR@20': '0.1041', 'NDCG@20': '0.0502'}
2025-02-21 14:53:36,907 - EarlyStopping counter: 3 out of 10
2025-02-21 14:54:26,887 - {'epoch': 25, 'rec_loss': '7.7903'}
2025-02-21 14:54:44,767 - {'Epoch': 25, 'HR@5': '0.0518', 'NDCG@5': '0.0357', 'HR@10': '0.0746', 'NDCG@10': '0.0429', 'HR@20': '0.1048', 'NDCG@20': '0.0505'}
2025-02-21 14:54:44,769 - EarlyStopping counter: 4 out of 10
2025-02-21 14:55:32,498 - {'epoch': 26, 'rec_loss': '7.7767'}
2025-02-21 14:55:50,903 - {'Epoch': 26, 'HR@5': '0.0519', 'NDCG@5': '0.0359', 'HR@10': '0.0747', 'NDCG@10': '0.0432', 'HR@20': '0.1053', 'NDCG@20': '0.0509'}
2025-02-21 14:55:50,905 - Validation score increased.  Saving model ...
2025-02-21 14:56:38,803 - {'epoch': 27, 'rec_loss': '7.7648'}
2025-02-21 14:56:57,546 - {'Epoch': 27, 'HR@5': '0.0521', 'NDCG@5': '0.0360', 'HR@10': '0.0749', 'NDCG@10': '0.0433', 'HR@20': '0.1046', 'NDCG@20': '0.0508'}
2025-02-21 14:56:57,550 - EarlyStopping counter: 1 out of 10
2025-02-21 14:57:48,939 - {'epoch': 28, 'rec_loss': '7.7507'}
2025-02-21 14:58:08,340 - {'Epoch': 28, 'HR@5': '0.0514', 'NDCG@5': '0.0357', 'HR@10': '0.0742', 'NDCG@10': '0.0430', 'HR@20': '0.1040', 'NDCG@20': '0.0505'}
2025-02-21 14:58:08,342 - EarlyStopping counter: 2 out of 10
2025-02-21 14:59:00,660 - {'epoch': 29, 'rec_loss': '7.7435'}
2025-02-21 14:59:20,367 - {'Epoch': 29, 'HR@5': '0.0506', 'NDCG@5': '0.0356', 'HR@10': '0.0745', 'NDCG@10': '0.0434', 'HR@20': '0.1047', 'NDCG@20': '0.0509'}
2025-02-21 14:59:20,372 - EarlyStopping counter: 3 out of 10
2025-02-21 15:00:13,546 - {'epoch': 30, 'rec_loss': '7.7358'}
2025-02-21 15:00:32,816 - {'Epoch': 30, 'HR@5': '0.0517', 'NDCG@5': '0.0358', 'HR@10': '0.0737', 'NDCG@10': '0.0429', 'HR@20': '0.1046', 'NDCG@20': '0.0506'}
2025-02-21 15:00:32,818 - EarlyStopping counter: 4 out of 10
2025-02-21 15:01:25,858 - {'epoch': 31, 'rec_loss': '7.7285'}
2025-02-21 15:01:45,676 - {'Epoch': 31, 'HR@5': '0.0516', 'NDCG@5': '0.0360', 'HR@10': '0.0741', 'NDCG@10': '0.0433', 'HR@20': '0.1035', 'NDCG@20': '0.0507'}
2025-02-21 15:01:45,678 - EarlyStopping counter: 5 out of 10
2025-02-21 15:02:37,020 - {'epoch': 32, 'rec_loss': '7.7215'}
2025-02-21 15:02:56,993 - {'Epoch': 32, 'HR@5': '0.0513', 'NDCG@5': '0.0358', 'HR@10': '0.0737', 'NDCG@10': '0.0430', 'HR@20': '0.1045', 'NDCG@20': '0.0508'}
2025-02-21 15:02:56,997 - EarlyStopping counter: 6 out of 10
2025-02-21 15:03:40,842 - {'epoch': 33, 'rec_loss': '7.7079'}
2025-02-21 15:03:58,636 - {'Epoch': 33, 'HR@5': '0.0513', 'NDCG@5': '0.0359', 'HR@10': '0.0742', 'NDCG@10': '0.0433', 'HR@20': '0.1049', 'NDCG@20': '0.0510'}
2025-02-21 15:03:58,638 - Validation score increased.  Saving model ...
2025-02-21 15:04:39,228 - {'epoch': 34, 'rec_loss': '7.7112'}
2025-02-21 15:04:56,522 - {'Epoch': 34, 'HR@5': '0.0517', 'NDCG@5': '0.0359', 'HR@10': '0.0741', 'NDCG@10': '0.0430', 'HR@20': '0.1048', 'NDCG@20': '0.0508'}
2025-02-21 15:04:56,526 - EarlyStopping counter: 1 out of 10
2025-02-21 15:05:37,967 - {'epoch': 35, 'rec_loss': '7.7000'}
2025-02-21 15:05:56,470 - {'Epoch': 35, 'HR@5': '0.0516', 'NDCG@5': '0.0358', 'HR@10': '0.0741', 'NDCG@10': '0.0430', 'HR@20': '0.1049', 'NDCG@20': '0.0508'}
2025-02-21 15:05:56,472 - EarlyStopping counter: 2 out of 10
2025-02-21 15:06:35,911 - {'epoch': 36, 'rec_loss': '7.6952'}
2025-02-21 15:06:54,122 - {'Epoch': 36, 'HR@5': '0.0511', 'NDCG@5': '0.0356', 'HR@10': '0.0745', 'NDCG@10': '0.0432', 'HR@20': '0.1036', 'NDCG@20': '0.0505'}
2025-02-21 15:06:54,124 - EarlyStopping counter: 3 out of 10
2025-02-21 15:07:34,745 - {'epoch': 37, 'rec_loss': '7.6868'}
2025-02-21 15:07:52,424 - {'Epoch': 37, 'HR@5': '0.0521', 'NDCG@5': '0.0361', 'HR@10': '0.0747', 'NDCG@10': '0.0434', 'HR@20': '0.1055', 'NDCG@20': '0.0512'}
2025-02-21 15:07:52,426 - Validation score increased.  Saving model ...
2025-02-21 15:08:31,946 - {'epoch': 38, 'rec_loss': '7.6748'}
2025-02-21 15:08:50,483 - {'Epoch': 38, 'HR@5': '0.0516', 'NDCG@5': '0.0359', 'HR@10': '0.0759', 'NDCG@10': '0.0438', 'HR@20': '0.1056', 'NDCG@20': '0.0513'}
2025-02-21 15:08:50,484 - Validation score increased.  Saving model ...
2025-02-21 15:09:30,770 - {'epoch': 39, 'rec_loss': '7.6715'}
2025-02-21 15:09:48,670 - {'Epoch': 39, 'HR@5': '0.0524', 'NDCG@5': '0.0361', 'HR@10': '0.0750', 'NDCG@10': '0.0434', 'HR@20': '0.1053', 'NDCG@20': '0.0510'}
2025-02-21 15:09:48,672 - EarlyStopping counter: 1 out of 10
2025-02-21 15:10:29,195 - {'epoch': 40, 'rec_loss': '7.6640'}
2025-02-21 15:10:47,086 - {'Epoch': 40, 'HR@5': '0.0516', 'NDCG@5': '0.0358', 'HR@10': '0.0757', 'NDCG@10': '0.0435', 'HR@20': '0.1058', 'NDCG@20': '0.0511'}
2025-02-21 15:10:47,088 - EarlyStopping counter: 2 out of 10
2025-02-21 15:11:29,696 - {'epoch': 41, 'rec_loss': '7.6552'}
2025-02-21 15:11:47,744 - {'Epoch': 41, 'HR@5': '0.0523', 'NDCG@5': '0.0362', 'HR@10': '0.0761', 'NDCG@10': '0.0438', 'HR@20': '0.1056', 'NDCG@20': '0.0512'}
2025-02-21 15:11:47,746 - EarlyStopping counter: 3 out of 10
2025-02-21 15:12:27,236 - {'epoch': 42, 'rec_loss': '7.6525'}
2025-02-21 15:12:45,336 - {'Epoch': 42, 'HR@5': '0.0522', 'NDCG@5': '0.0363', 'HR@10': '0.0761', 'NDCG@10': '0.0440', 'HR@20': '0.1071', 'NDCG@20': '0.0518'}
2025-02-21 15:12:45,337 - Validation score increased.  Saving model ...
2025-02-21 15:13:24,094 - {'epoch': 43, 'rec_loss': '7.6499'}
2025-02-21 15:13:41,634 - {'Epoch': 43, 'HR@5': '0.0528', 'NDCG@5': '0.0364', 'HR@10': '0.0759', 'NDCG@10': '0.0438', 'HR@20': '0.1058', 'NDCG@20': '0.0514'}
2025-02-21 15:13:41,636 - EarlyStopping counter: 1 out of 10
2025-02-21 15:14:20,666 - {'epoch': 44, 'rec_loss': '7.6392'}
2025-02-21 15:14:39,075 - {'Epoch': 44, 'HR@5': '0.0527', 'NDCG@5': '0.0367', 'HR@10': '0.0765', 'NDCG@10': '0.0443', 'HR@20': '0.1060', 'NDCG@20': '0.0517'}
2025-02-21 15:14:39,077 - EarlyStopping counter: 2 out of 10
2025-02-21 15:15:17,875 - {'epoch': 45, 'rec_loss': '7.6358'}
2025-02-21 15:15:35,768 - {'Epoch': 45, 'HR@5': '0.0527', 'NDCG@5': '0.0364', 'HR@10': '0.0759', 'NDCG@10': '0.0438', 'HR@20': '0.1071', 'NDCG@20': '0.0517'}
2025-02-21 15:15:35,769 - EarlyStopping counter: 3 out of 10
2025-02-21 15:16:14,588 - {'epoch': 46, 'rec_loss': '7.6325'}
2025-02-21 15:16:33,553 - {'Epoch': 46, 'HR@5': '0.0526', 'NDCG@5': '0.0368', 'HR@10': '0.0750', 'NDCG@10': '0.0440', 'HR@20': '0.1062', 'NDCG@20': '0.0519'}
2025-02-21 15:16:33,555 - Validation score increased.  Saving model ...
2025-02-21 15:17:14,145 - {'epoch': 47, 'rec_loss': '7.6366'}
2025-02-21 15:17:32,070 - {'Epoch': 47, 'HR@5': '0.0529', 'NDCG@5': '0.0366', 'HR@10': '0.0763', 'NDCG@10': '0.0441', 'HR@20': '0.1070', 'NDCG@20': '0.0518'}
2025-02-21 15:17:32,071 - EarlyStopping counter: 1 out of 10
2025-02-21 15:18:13,070 - {'epoch': 48, 'rec_loss': '7.6174'}
2025-02-21 15:18:32,422 - {'Epoch': 48, 'HR@5': '0.0533', 'NDCG@5': '0.0371', 'HR@10': '0.0758', 'NDCG@10': '0.0443', 'HR@20': '0.1057', 'NDCG@20': '0.0519'}
2025-02-21 15:18:32,423 - Validation score increased.  Saving model ...
2025-02-21 15:19:12,209 - {'epoch': 49, 'rec_loss': '7.6200'}
2025-02-21 15:19:29,585 - {'Epoch': 49, 'HR@5': '0.0527', 'NDCG@5': '0.0366', 'HR@10': '0.0753', 'NDCG@10': '0.0439', 'HR@20': '0.1058', 'NDCG@20': '0.0516'}
2025-02-21 15:19:29,586 - EarlyStopping counter: 1 out of 10
2025-02-21 15:20:09,726 - {'epoch': 50, 'rec_loss': '7.6181'}
2025-02-21 15:20:29,270 - {'Epoch': 50, 'HR@5': '0.0524', 'NDCG@5': '0.0365', 'HR@10': '0.0746', 'NDCG@10': '0.0436', 'HR@20': '0.1044', 'NDCG@20': '0.0512'}
2025-02-21 15:20:29,274 - EarlyStopping counter: 2 out of 10
2025-02-21 15:21:08,769 - {'epoch': 51, 'rec_loss': '7.6078'}
2025-02-21 15:21:27,176 - {'Epoch': 51, 'HR@5': '0.0519', 'NDCG@5': '0.0363', 'HR@10': '0.0749', 'NDCG@10': '0.0437', 'HR@20': '0.1058', 'NDCG@20': '0.0514'}
2025-02-21 15:21:27,177 - EarlyStopping counter: 3 out of 10
2025-02-21 15:22:06,189 - {'epoch': 52, 'rec_loss': '7.6020'}
2025-02-21 15:22:24,598 - {'Epoch': 52, 'HR@5': '0.0518', 'NDCG@5': '0.0359', 'HR@10': '0.0754', 'NDCG@10': '0.0434', 'HR@20': '0.1055', 'NDCG@20': '0.0510'}
2025-02-21 15:22:24,599 - EarlyStopping counter: 4 out of 10
2025-02-21 15:23:05,724 - {'epoch': 53, 'rec_loss': '7.6077'}
2025-02-21 15:23:23,435 - {'Epoch': 53, 'HR@5': '0.0518', 'NDCG@5': '0.0359', 'HR@10': '0.0749', 'NDCG@10': '0.0433', 'HR@20': '0.1060', 'NDCG@20': '0.0512'}
2025-02-21 15:23:23,439 - EarlyStopping counter: 5 out of 10
2025-02-21 15:24:05,847 - {'epoch': 54, 'rec_loss': '7.6008'}
2025-02-21 15:24:23,595 - {'Epoch': 54, 'HR@5': '0.0516', 'NDCG@5': '0.0359', 'HR@10': '0.0748', 'NDCG@10': '0.0434', 'HR@20': '0.1055', 'NDCG@20': '0.0511'}
2025-02-21 15:24:23,597 - EarlyStopping counter: 6 out of 10
2025-02-21 15:25:04,909 - {'epoch': 55, 'rec_loss': '7.5936'}
2025-02-21 15:25:23,233 - {'Epoch': 55, 'HR@5': '0.0533', 'NDCG@5': '0.0368', 'HR@10': '0.0759', 'NDCG@10': '0.0440', 'HR@20': '0.1055', 'NDCG@20': '0.0515'}
2025-02-21 15:25:23,234 - EarlyStopping counter: 7 out of 10
2025-02-21 15:26:02,415 - {'epoch': 56, 'rec_loss': '7.5921'}
2025-02-21 15:26:22,189 - {'Epoch': 56, 'HR@5': '0.0525', 'NDCG@5': '0.0365', 'HR@10': '0.0757', 'NDCG@10': '0.0439', 'HR@20': '0.1058', 'NDCG@20': '0.0515'}
2025-02-21 15:26:22,190 - EarlyStopping counter: 8 out of 10
2025-02-21 15:27:01,326 - {'epoch': 57, 'rec_loss': '7.5879'}
2025-02-21 15:27:20,517 - {'Epoch': 57, 'HR@5': '0.0520', 'NDCG@5': '0.0364', 'HR@10': '0.0743', 'NDCG@10': '0.0435', 'HR@20': '0.1062', 'NDCG@20': '0.0516'}
2025-02-21 15:27:20,518 - EarlyStopping counter: 9 out of 10
2025-02-21 15:27:59,991 - {'epoch': 58, 'rec_loss': '7.5849'}
2025-02-21 15:28:19,246 - {'Epoch': 58, 'HR@5': '0.0519', 'NDCG@5': '0.0364', 'HR@10': '0.0748', 'NDCG@10': '0.0438', 'HR@20': '0.1062', 'NDCG@20': '0.0517'}
2025-02-21 15:28:19,248 - EarlyStopping counter: 10 out of 10
2025-02-21 15:28:19,248 - Early stopping
2025-02-21 15:28:19,248 - ---------------Test Score---------------
2025-02-21 15:28:35,918 - {'Epoch': 0, 'HR@5': '0.0431', 'NDCG@5': '0.0299', 'HR@10': '0.0628', 'NDCG@10': '0.0363', 'HR@20': '0.0892', 'NDCG@20': '0.0429'}
2025-02-21 15:28:35,920 - Scale_Sports
2025-02-21 15:28:35,920 - {'Epoch': 0, 'HR@5': '0.0431', 'NDCG@5': '0.0299', 'HR@10': '0.0628', 'NDCG@10': '0.0363', 'HR@20': '0.0892', 'NDCG@20': '0.0429'}
2025-02-21 18:41:10,677 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[10, 5], kernels=[4, 8, 12], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-21 18:41:15,237 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-21 18:41:15,253 - Total Parameters: 1328529
2025-02-21 18:41:57,108 - {'epoch': 0, 'rec_loss': '9.4050'}
2025-02-21 18:42:13,568 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0054', 'HR@10': '0.0126', 'NDCG@10': '0.0068', 'HR@20': '0.0221', 'NDCG@20': '0.0092'}
2025-02-21 18:42:13,572 - Validation score increased.  Saving model ...
2025-02-21 18:42:56,237 - {'epoch': 1, 'rec_loss': '9.1921'}
2025-02-21 18:43:12,763 - {'Epoch': 1, 'HR@5': '0.0170', 'NDCG@5': '0.0106', 'HR@10': '0.0269', 'NDCG@10': '0.0138', 'HR@20': '0.0428', 'NDCG@20': '0.0178'}
2025-02-21 18:43:12,768 - Validation score increased.  Saving model ...
2025-02-21 18:43:52,852 - {'epoch': 2, 'rec_loss': '8.9227'}
2025-02-21 18:44:09,495 - {'Epoch': 2, 'HR@5': '0.0196', 'NDCG@5': '0.0129', 'HR@10': '0.0315', 'NDCG@10': '0.0168', 'HR@20': '0.0513', 'NDCG@20': '0.0218'}
2025-02-21 18:44:09,496 - Validation score increased.  Saving model ...
2025-02-21 18:44:49,776 - {'epoch': 3, 'rec_loss': '8.7338'}
2025-02-21 18:45:07,384 - {'Epoch': 3, 'HR@5': '0.0246', 'NDCG@5': '0.0159', 'HR@10': '0.0403', 'NDCG@10': '0.0210', 'HR@20': '0.0618', 'NDCG@20': '0.0264'}
2025-02-21 18:45:07,388 - Validation score increased.  Saving model ...
2025-02-21 18:45:49,391 - {'epoch': 4, 'rec_loss': '8.5911'}
2025-02-21 18:46:07,803 - {'Epoch': 4, 'HR@5': '0.0315', 'NDCG@5': '0.0209', 'HR@10': '0.0475', 'NDCG@10': '0.0260', 'HR@20': '0.0707', 'NDCG@20': '0.0318'}
2025-02-21 18:46:07,805 - Validation score increased.  Saving model ...
2025-02-21 18:46:48,554 - {'epoch': 5, 'rec_loss': '8.4772'}
2025-02-21 18:47:05,886 - {'Epoch': 5, 'HR@5': '0.0367', 'NDCG@5': '0.0244', 'HR@10': '0.0545', 'NDCG@10': '0.0301', 'HR@20': '0.0793', 'NDCG@20': '0.0363'}
2025-02-21 18:47:05,888 - Validation score increased.  Saving model ...
2025-02-21 18:47:47,321 - {'epoch': 6, 'rec_loss': '8.3818'}
2025-02-21 18:48:05,434 - {'Epoch': 6, 'HR@5': '0.0387', 'NDCG@5': '0.0262', 'HR@10': '0.0566', 'NDCG@10': '0.0320', 'HR@20': '0.0831', 'NDCG@20': '0.0386'}
2025-02-21 18:48:05,436 - Validation score increased.  Saving model ...
2025-02-21 18:48:49,104 - {'epoch': 7, 'rec_loss': '8.2991'}
2025-02-21 18:49:08,416 - {'Epoch': 7, 'HR@5': '0.0407', 'NDCG@5': '0.0280', 'HR@10': '0.0598', 'NDCG@10': '0.0341', 'HR@20': '0.0866', 'NDCG@20': '0.0409'}
2025-02-21 18:49:08,420 - Validation score increased.  Saving model ...
2025-02-21 18:49:50,751 - {'epoch': 8, 'rec_loss': '8.2377'}
2025-02-21 18:50:09,339 - {'Epoch': 8, 'HR@5': '0.0430', 'NDCG@5': '0.0296', 'HR@10': '0.0628', 'NDCG@10': '0.0360', 'HR@20': '0.0904', 'NDCG@20': '0.0429'}
2025-02-21 18:50:09,341 - Validation score increased.  Saving model ...
2025-02-21 18:50:51,190 - {'epoch': 9, 'rec_loss': '8.1772'}
2025-02-21 18:51:10,056 - {'Epoch': 9, 'HR@5': '0.0450', 'NDCG@5': '0.0311', 'HR@10': '0.0654', 'NDCG@10': '0.0376', 'HR@20': '0.0937', 'NDCG@20': '0.0448'}
2025-02-21 18:51:10,057 - Validation score increased.  Saving model ...
2025-02-21 18:51:53,157 - {'epoch': 10, 'rec_loss': '8.1276'}
2025-02-21 18:52:09,550 - {'Epoch': 10, 'HR@5': '0.0452', 'NDCG@5': '0.0311', 'HR@10': '0.0666', 'NDCG@10': '0.0380', 'HR@20': '0.0942', 'NDCG@20': '0.0450'}
2025-02-21 18:52:09,555 - Validation score increased.  Saving model ...
2025-02-21 18:52:53,262 - {'epoch': 11, 'rec_loss': '8.0801'}
2025-02-21 18:53:12,482 - {'Epoch': 11, 'HR@5': '0.0462', 'NDCG@5': '0.0317', 'HR@10': '0.0683', 'NDCG@10': '0.0388', 'HR@20': '0.0965', 'NDCG@20': '0.0459'}
2025-02-21 18:53:12,495 - Validation score increased.  Saving model ...
2025-02-21 18:53:55,479 - {'epoch': 12, 'rec_loss': '8.0444'}
2025-02-21 18:54:13,078 - {'Epoch': 12, 'HR@5': '0.0465', 'NDCG@5': '0.0323', 'HR@10': '0.0684', 'NDCG@10': '0.0394', 'HR@20': '0.0977', 'NDCG@20': '0.0468'}
2025-02-21 18:54:13,082 - Validation score increased.  Saving model ...
2025-02-21 18:54:55,742 - {'epoch': 13, 'rec_loss': '8.0131'}
2025-02-21 18:55:16,530 - {'Epoch': 13, 'HR@5': '0.0480', 'NDCG@5': '0.0331', 'HR@10': '0.0691', 'NDCG@10': '0.0399', 'HR@20': '0.0996', 'NDCG@20': '0.0475'}
2025-02-21 18:55:16,532 - Validation score increased.  Saving model ...
2025-02-21 18:55:59,952 - {'epoch': 14, 'rec_loss': '7.9841'}
2025-02-21 18:56:17,257 - {'Epoch': 14, 'HR@5': '0.0480', 'NDCG@5': '0.0331', 'HR@10': '0.0705', 'NDCG@10': '0.0403', 'HR@20': '0.1004', 'NDCG@20': '0.0478'}
2025-02-21 18:56:17,264 - Validation score increased.  Saving model ...
2025-02-21 18:56:59,824 - {'epoch': 15, 'rec_loss': '7.9573'}
2025-02-21 18:57:19,521 - {'Epoch': 15, 'HR@5': '0.0484', 'NDCG@5': '0.0334', 'HR@10': '0.0713', 'NDCG@10': '0.0408', 'HR@20': '0.1007', 'NDCG@20': '0.0482'}
2025-02-21 18:57:19,525 - Validation score increased.  Saving model ...
2025-02-21 18:58:03,592 - {'epoch': 16, 'rec_loss': '7.9302'}
2025-02-21 18:58:22,298 - {'Epoch': 16, 'HR@5': '0.0482', 'NDCG@5': '0.0336', 'HR@10': '0.0710', 'NDCG@10': '0.0410', 'HR@20': '0.1013', 'NDCG@20': '0.0486'}
2025-02-21 18:58:22,300 - Validation score increased.  Saving model ...
2025-02-21 18:59:04,080 - {'epoch': 17, 'rec_loss': '7.9098'}
2025-02-21 18:59:22,900 - {'Epoch': 17, 'HR@5': '0.0487', 'NDCG@5': '0.0337', 'HR@10': '0.0715', 'NDCG@10': '0.0411', 'HR@20': '0.1021', 'NDCG@20': '0.0488'}
2025-02-21 18:59:22,905 - Validation score increased.  Saving model ...
2025-02-21 19:00:05,809 - {'epoch': 18, 'rec_loss': '7.8873'}
2025-02-21 19:00:24,879 - {'Epoch': 18, 'HR@5': '0.0494', 'NDCG@5': '0.0336', 'HR@10': '0.0725', 'NDCG@10': '0.0410', 'HR@20': '0.1024', 'NDCG@20': '0.0485'}
2025-02-21 19:00:24,881 - EarlyStopping counter: 1 out of 10
2025-02-21 19:01:06,250 - {'epoch': 19, 'rec_loss': '7.8648'}
2025-02-21 19:01:25,815 - {'Epoch': 19, 'HR@5': '0.0496', 'NDCG@5': '0.0341', 'HR@10': '0.0723', 'NDCG@10': '0.0415', 'HR@20': '0.1032', 'NDCG@20': '0.0493'}
2025-02-21 19:01:25,823 - Validation score increased.  Saving model ...
2025-02-21 19:02:09,268 - {'epoch': 20, 'rec_loss': '7.8531'}
2025-02-21 19:02:26,923 - {'Epoch': 20, 'HR@5': '0.0497', 'NDCG@5': '0.0341', 'HR@10': '0.0726', 'NDCG@10': '0.0415', 'HR@20': '0.1037', 'NDCG@20': '0.0493'}
2025-02-21 19:02:26,929 - Validation score increased.  Saving model ...
2025-02-21 19:03:11,842 - {'epoch': 21, 'rec_loss': '7.8310'}
2025-02-21 19:03:31,630 - {'Epoch': 21, 'HR@5': '0.0493', 'NDCG@5': '0.0339', 'HR@10': '0.0718', 'NDCG@10': '0.0411', 'HR@20': '0.1027', 'NDCG@20': '0.0489'}
2025-02-21 19:03:31,637 - EarlyStopping counter: 1 out of 10
2025-02-21 19:04:15,049 - {'epoch': 22, 'rec_loss': '7.8198'}
2025-02-21 19:04:34,098 - {'Epoch': 22, 'HR@5': '0.0501', 'NDCG@5': '0.0343', 'HR@10': '0.0733', 'NDCG@10': '0.0418', 'HR@20': '0.1035', 'NDCG@20': '0.0493'}
2025-02-21 19:04:34,099 - Validation score increased.  Saving model ...
2025-02-21 19:05:18,252 - {'epoch': 23, 'rec_loss': '7.8081'}
2025-02-21 19:05:36,820 - {'Epoch': 23, 'HR@5': '0.0502', 'NDCG@5': '0.0345', 'HR@10': '0.0730', 'NDCG@10': '0.0418', 'HR@20': '0.1031', 'NDCG@20': '0.0494'}
2025-02-21 19:05:36,825 - Validation score increased.  Saving model ...
2025-02-21 19:06:23,356 - {'epoch': 24, 'rec_loss': '7.7953'}
2025-02-21 19:06:41,838 - {'Epoch': 24, 'HR@5': '0.0504', 'NDCG@5': '0.0348', 'HR@10': '0.0739', 'NDCG@10': '0.0424', 'HR@20': '0.1036', 'NDCG@20': '0.0499'}
2025-02-21 19:06:41,842 - Validation score increased.  Saving model ...
2025-02-21 19:07:25,181 - {'epoch': 25, 'rec_loss': '7.7796'}
2025-02-21 19:07:42,865 - {'Epoch': 25, 'HR@5': '0.0506', 'NDCG@5': '0.0347', 'HR@10': '0.0741', 'NDCG@10': '0.0422', 'HR@20': '0.1036', 'NDCG@20': '0.0497'}
2025-02-21 19:07:42,868 - EarlyStopping counter: 1 out of 10
2025-02-21 19:08:25,322 - {'epoch': 26, 'rec_loss': '7.7674'}
2025-02-21 19:08:43,530 - {'Epoch': 26, 'HR@5': '0.0491', 'NDCG@5': '0.0342', 'HR@10': '0.0724', 'NDCG@10': '0.0418', 'HR@20': '0.1020', 'NDCG@20': '0.0492'}
2025-02-21 19:08:43,537 - EarlyStopping counter: 2 out of 10
2025-02-21 19:09:26,640 - {'epoch': 27, 'rec_loss': '7.7573'}
2025-02-21 19:09:44,139 - {'Epoch': 27, 'HR@5': '0.0512', 'NDCG@5': '0.0355', 'HR@10': '0.0732', 'NDCG@10': '0.0425', 'HR@20': '0.1030', 'NDCG@20': '0.0500'}
2025-02-21 19:09:44,146 - Validation score increased.  Saving model ...
2025-02-21 19:10:25,189 - {'epoch': 28, 'rec_loss': '7.7456'}
2025-02-21 19:10:46,139 - {'Epoch': 28, 'HR@5': '0.0507', 'NDCG@5': '0.0350', 'HR@10': '0.0732', 'NDCG@10': '0.0423', 'HR@20': '0.1039', 'NDCG@20': '0.0500'}
2025-02-21 19:10:46,144 - EarlyStopping counter: 1 out of 10
2025-02-21 19:11:27,287 - {'epoch': 29, 'rec_loss': '7.7348'}
2025-02-21 19:11:45,819 - {'Epoch': 29, 'HR@5': '0.0506', 'NDCG@5': '0.0352', 'HR@10': '0.0735', 'NDCG@10': '0.0425', 'HR@20': '0.1040', 'NDCG@20': '0.0502'}
2025-02-21 19:11:45,821 - Validation score increased.  Saving model ...
2025-02-21 19:12:28,675 - {'epoch': 30, 'rec_loss': '7.7241'}
2025-02-21 19:12:47,865 - {'Epoch': 30, 'HR@5': '0.0516', 'NDCG@5': '0.0356', 'HR@10': '0.0750', 'NDCG@10': '0.0431', 'HR@20': '0.1041', 'NDCG@20': '0.0505'}
2025-02-21 19:12:47,867 - Validation score increased.  Saving model ...
2025-02-21 19:13:28,487 - {'epoch': 31, 'rec_loss': '7.7209'}
2025-02-21 19:13:47,269 - {'Epoch': 31, 'HR@5': '0.0503', 'NDCG@5': '0.0345', 'HR@10': '0.0740', 'NDCG@10': '0.0421', 'HR@20': '0.1042', 'NDCG@20': '0.0497'}
2025-02-21 19:13:47,270 - EarlyStopping counter: 1 out of 10
2025-02-21 19:14:30,264 - {'epoch': 32, 'rec_loss': '7.7051'}
2025-02-21 19:14:47,783 - {'Epoch': 32, 'HR@5': '0.0512', 'NDCG@5': '0.0352', 'HR@10': '0.0738', 'NDCG@10': '0.0424', 'HR@20': '0.1061', 'NDCG@20': '0.0506'}
2025-02-21 19:14:47,785 - Validation score increased.  Saving model ...
2025-02-21 19:15:30,837 - {'epoch': 33, 'rec_loss': '7.6989'}
2025-02-21 19:15:49,271 - {'Epoch': 33, 'HR@5': '0.0511', 'NDCG@5': '0.0351', 'HR@10': '0.0743', 'NDCG@10': '0.0426', 'HR@20': '0.1060', 'NDCG@20': '0.0506'}
2025-02-21 19:15:49,273 - EarlyStopping counter: 1 out of 10
2025-02-21 19:16:32,973 - {'epoch': 34, 'rec_loss': '7.6986'}
2025-02-21 19:16:51,314 - {'Epoch': 34, 'HR@5': '0.0516', 'NDCG@5': '0.0353', 'HR@10': '0.0745', 'NDCG@10': '0.0427', 'HR@20': '0.1051', 'NDCG@20': '0.0504'}
2025-02-21 19:16:51,315 - EarlyStopping counter: 2 out of 10
2025-02-21 19:17:32,543 - {'epoch': 35, 'rec_loss': '7.6848'}
2025-02-21 19:17:51,778 - {'Epoch': 35, 'HR@5': '0.0518', 'NDCG@5': '0.0355', 'HR@10': '0.0739', 'NDCG@10': '0.0426', 'HR@20': '0.1049', 'NDCG@20': '0.0504'}
2025-02-21 19:17:51,783 - EarlyStopping counter: 3 out of 10
2025-02-21 19:18:33,746 - {'epoch': 36, 'rec_loss': '7.6798'}
2025-02-21 19:18:52,555 - {'Epoch': 36, 'HR@5': '0.0523', 'NDCG@5': '0.0359', 'HR@10': '0.0755', 'NDCG@10': '0.0434', 'HR@20': '0.1058', 'NDCG@20': '0.0510'}
2025-02-21 19:18:52,565 - Validation score increased.  Saving model ...
2025-02-21 19:19:35,343 - {'epoch': 37, 'rec_loss': '7.6685'}
2025-02-21 19:19:52,642 - {'Epoch': 37, 'HR@5': '0.0518', 'NDCG@5': '0.0354', 'HR@10': '0.0758', 'NDCG@10': '0.0431', 'HR@20': '0.1045', 'NDCG@20': '0.0503'}
2025-02-21 19:19:52,643 - EarlyStopping counter: 1 out of 10
2025-02-21 19:20:35,663 - {'epoch': 38, 'rec_loss': '7.6607'}
2025-02-21 19:20:53,407 - {'Epoch': 38, 'HR@5': '0.0524', 'NDCG@5': '0.0359', 'HR@10': '0.0753', 'NDCG@10': '0.0432', 'HR@20': '0.1057', 'NDCG@20': '0.0509'}
2025-02-21 19:20:53,412 - EarlyStopping counter: 2 out of 10
2025-02-21 19:21:34,839 - {'epoch': 39, 'rec_loss': '7.6510'}
2025-02-21 19:21:53,442 - {'Epoch': 39, 'HR@5': '0.0514', 'NDCG@5': '0.0351', 'HR@10': '0.0742', 'NDCG@10': '0.0425', 'HR@20': '0.1054', 'NDCG@20': '0.0504'}
2025-02-21 19:21:53,446 - EarlyStopping counter: 3 out of 10
2025-02-21 19:22:37,026 - {'epoch': 40, 'rec_loss': '7.6556'}
2025-02-21 19:22:56,376 - {'Epoch': 40, 'HR@5': '0.0520', 'NDCG@5': '0.0359', 'HR@10': '0.0742', 'NDCG@10': '0.0431', 'HR@20': '0.1071', 'NDCG@20': '0.0514'}
2025-02-21 19:22:56,381 - Validation score increased.  Saving model ...
2025-02-21 19:23:38,475 - {'epoch': 41, 'rec_loss': '7.6413'}
2025-02-21 19:23:56,672 - {'Epoch': 41, 'HR@5': '0.0515', 'NDCG@5': '0.0359', 'HR@10': '0.0746', 'NDCG@10': '0.0433', 'HR@20': '0.1058', 'NDCG@20': '0.0512'}
2025-02-21 19:23:56,676 - EarlyStopping counter: 1 out of 10
2025-02-21 19:24:38,791 - {'epoch': 42, 'rec_loss': '7.6439'}
2025-02-21 19:24:56,187 - {'Epoch': 42, 'HR@5': '0.0526', 'NDCG@5': '0.0365', 'HR@10': '0.0757', 'NDCG@10': '0.0440', 'HR@20': '0.1063', 'NDCG@20': '0.0517'}
2025-02-21 19:24:56,191 - Validation score increased.  Saving model ...
2025-02-21 19:25:39,411 - {'epoch': 43, 'rec_loss': '7.6367'}
2025-02-21 19:25:58,529 - {'Epoch': 43, 'HR@5': '0.0522', 'NDCG@5': '0.0361', 'HR@10': '0.0749', 'NDCG@10': '0.0434', 'HR@20': '0.1060', 'NDCG@20': '0.0512'}
2025-02-21 19:25:58,533 - EarlyStopping counter: 1 out of 10
2025-02-21 19:26:41,404 - {'epoch': 44, 'rec_loss': '7.6282'}
2025-02-21 19:27:00,234 - {'Epoch': 44, 'HR@5': '0.0520', 'NDCG@5': '0.0361', 'HR@10': '0.0743', 'NDCG@10': '0.0433', 'HR@20': '0.1052', 'NDCG@20': '0.0510'}
2025-02-21 19:27:00,235 - EarlyStopping counter: 2 out of 10
2025-02-21 19:27:41,811 - {'epoch': 45, 'rec_loss': '7.6188'}
2025-02-21 19:28:00,317 - {'Epoch': 45, 'HR@5': '0.0518', 'NDCG@5': '0.0358', 'HR@10': '0.0743', 'NDCG@10': '0.0430', 'HR@20': '0.1051', 'NDCG@20': '0.0508'}
2025-02-21 19:28:00,319 - EarlyStopping counter: 3 out of 10
2025-02-21 19:28:40,834 - {'epoch': 46, 'rec_loss': '7.6226'}
2025-02-21 19:29:00,232 - {'Epoch': 46, 'HR@5': '0.0518', 'NDCG@5': '0.0355', 'HR@10': '0.0745', 'NDCG@10': '0.0428', 'HR@20': '0.1059', 'NDCG@20': '0.0508'}
2025-02-21 19:29:00,233 - EarlyStopping counter: 4 out of 10
2025-02-21 19:29:41,177 - {'epoch': 47, 'rec_loss': '7.6212'}
2025-02-21 19:30:00,368 - {'Epoch': 47, 'HR@5': '0.0521', 'NDCG@5': '0.0359', 'HR@10': '0.0748', 'NDCG@10': '0.0433', 'HR@20': '0.1067', 'NDCG@20': '0.0513'}
2025-02-21 19:30:00,374 - EarlyStopping counter: 5 out of 10
2025-02-21 19:30:43,726 - {'epoch': 48, 'rec_loss': '7.6000'}
2025-02-21 19:31:02,172 - {'Epoch': 48, 'HR@5': '0.0517', 'NDCG@5': '0.0363', 'HR@10': '0.0748', 'NDCG@10': '0.0437', 'HR@20': '0.1050', 'NDCG@20': '0.0513'}
2025-02-21 19:31:02,176 - EarlyStopping counter: 6 out of 10
2025-02-21 19:31:43,816 - {'epoch': 49, 'rec_loss': '7.6042'}
2025-02-21 19:32:02,975 - {'Epoch': 49, 'HR@5': '0.0522', 'NDCG@5': '0.0361', 'HR@10': '0.0751', 'NDCG@10': '0.0434', 'HR@20': '0.1044', 'NDCG@20': '0.0508'}
2025-02-21 19:32:02,983 - EarlyStopping counter: 7 out of 10
2025-02-21 19:32:45,525 - {'epoch': 50, 'rec_loss': '7.6105'}
2025-02-21 19:33:03,344 - {'Epoch': 50, 'HR@5': '0.0524', 'NDCG@5': '0.0365', 'HR@10': '0.0750', 'NDCG@10': '0.0437', 'HR@20': '0.1059', 'NDCG@20': '0.0515'}
2025-02-21 19:33:03,345 - EarlyStopping counter: 8 out of 10
2025-02-21 19:33:48,503 - {'epoch': 51, 'rec_loss': '7.5962'}
2025-02-21 19:34:07,308 - {'Epoch': 51, 'HR@5': '0.0527', 'NDCG@5': '0.0366', 'HR@10': '0.0753', 'NDCG@10': '0.0439', 'HR@20': '0.1058', 'NDCG@20': '0.0516'}
2025-02-21 19:34:07,310 - EarlyStopping counter: 9 out of 10
2025-02-21 19:34:53,451 - {'epoch': 52, 'rec_loss': '7.5929'}
2025-02-21 19:35:11,492 - {'Epoch': 52, 'HR@5': '0.0524', 'NDCG@5': '0.0366', 'HR@10': '0.0758', 'NDCG@10': '0.0441', 'HR@20': '0.1065', 'NDCG@20': '0.0518'}
2025-02-21 19:35:11,493 - Validation score increased.  Saving model ...
2025-02-21 19:35:55,004 - {'epoch': 53, 'rec_loss': '7.5958'}
2025-02-21 19:36:14,291 - {'Epoch': 53, 'HR@5': '0.0519', 'NDCG@5': '0.0359', 'HR@10': '0.0764', 'NDCG@10': '0.0438', 'HR@20': '0.1064', 'NDCG@20': '0.0514'}
2025-02-21 19:36:14,299 - EarlyStopping counter: 1 out of 10
2025-02-21 19:36:55,428 - {'epoch': 54, 'rec_loss': '7.5883'}
2025-02-21 19:37:14,434 - {'Epoch': 54, 'HR@5': '0.0530', 'NDCG@5': '0.0366', 'HR@10': '0.0760', 'NDCG@10': '0.0440', 'HR@20': '0.1059', 'NDCG@20': '0.0515'}
2025-02-21 19:37:14,439 - EarlyStopping counter: 2 out of 10
2025-02-21 19:37:56,361 - {'epoch': 55, 'rec_loss': '7.5766'}
2025-02-21 19:38:13,469 - {'Epoch': 55, 'HR@5': '0.0540', 'NDCG@5': '0.0374', 'HR@10': '0.0767', 'NDCG@10': '0.0446', 'HR@20': '0.1062', 'NDCG@20': '0.0521'}
2025-02-21 19:38:13,471 - Validation score increased.  Saving model ...
2025-02-21 19:38:58,210 - {'epoch': 56, 'rec_loss': '7.5801'}
2025-02-21 19:39:16,541 - {'Epoch': 56, 'HR@5': '0.0532', 'NDCG@5': '0.0369', 'HR@10': '0.0763', 'NDCG@10': '0.0443', 'HR@20': '0.1063', 'NDCG@20': '0.0519'}
2025-02-21 19:39:16,542 - EarlyStopping counter: 1 out of 10
2025-02-21 19:40:03,989 - {'epoch': 57, 'rec_loss': '7.5711'}
2025-02-21 19:40:24,351 - {'Epoch': 57, 'HR@5': '0.0525', 'NDCG@5': '0.0363', 'HR@10': '0.0751', 'NDCG@10': '0.0436', 'HR@20': '0.1053', 'NDCG@20': '0.0512'}
2025-02-21 19:40:24,352 - EarlyStopping counter: 2 out of 10
2025-02-21 19:41:30,868 - {'epoch': 58, 'rec_loss': '7.5702'}
2025-02-21 19:41:51,301 - {'Epoch': 58, 'HR@5': '0.0525', 'NDCG@5': '0.0362', 'HR@10': '0.0753', 'NDCG@10': '0.0435', 'HR@20': '0.1055', 'NDCG@20': '0.0511'}
2025-02-21 19:41:51,303 - EarlyStopping counter: 3 out of 10
2025-02-21 19:42:55,867 - {'epoch': 59, 'rec_loss': '7.5698'}
2025-02-21 19:43:16,560 - {'Epoch': 59, 'HR@5': '0.0534', 'NDCG@5': '0.0364', 'HR@10': '0.0755', 'NDCG@10': '0.0435', 'HR@20': '0.1064', 'NDCG@20': '0.0512'}
2025-02-21 19:43:16,565 - EarlyStopping counter: 4 out of 10
2025-02-21 19:44:21,580 - {'epoch': 60, 'rec_loss': '7.5621'}
2025-02-21 19:44:41,187 - {'Epoch': 60, 'HR@5': '0.0532', 'NDCG@5': '0.0363', 'HR@10': '0.0759', 'NDCG@10': '0.0436', 'HR@20': '0.1064', 'NDCG@20': '0.0514'}
2025-02-21 19:44:41,192 - EarlyStopping counter: 5 out of 10
2025-02-21 19:45:44,593 - {'epoch': 61, 'rec_loss': '7.5597'}
2025-02-21 19:46:05,118 - {'Epoch': 61, 'HR@5': '0.0528', 'NDCG@5': '0.0364', 'HR@10': '0.0755', 'NDCG@10': '0.0437', 'HR@20': '0.1073', 'NDCG@20': '0.0517'}
2025-02-21 19:46:05,126 - EarlyStopping counter: 6 out of 10
2025-02-21 19:47:09,510 - {'epoch': 62, 'rec_loss': '7.5560'}
2025-02-21 19:47:27,929 - {'Epoch': 62, 'HR@5': '0.0528', 'NDCG@5': '0.0364', 'HR@10': '0.0745', 'NDCG@10': '0.0434', 'HR@20': '0.1055', 'NDCG@20': '0.0512'}
2025-02-21 19:47:27,932 - EarlyStopping counter: 7 out of 10
2025-02-21 19:48:24,060 - {'epoch': 63, 'rec_loss': '7.5599'}
2025-02-21 19:48:42,274 - {'Epoch': 63, 'HR@5': '0.0526', 'NDCG@5': '0.0361', 'HR@10': '0.0757', 'NDCG@10': '0.0435', 'HR@20': '0.1055', 'NDCG@20': '0.0510'}
2025-02-21 19:48:42,278 - EarlyStopping counter: 8 out of 10
2025-02-21 19:49:35,545 - {'epoch': 64, 'rec_loss': '7.5489'}
2025-02-21 19:49:55,325 - {'Epoch': 64, 'HR@5': '0.0523', 'NDCG@5': '0.0360', 'HR@10': '0.0748', 'NDCG@10': '0.0433', 'HR@20': '0.1065', 'NDCG@20': '0.0512'}
2025-02-21 19:49:55,332 - EarlyStopping counter: 9 out of 10
2025-02-21 19:50:51,757 - {'epoch': 65, 'rec_loss': '7.5463'}
2025-02-21 19:51:11,575 - {'Epoch': 65, 'HR@5': '0.0530', 'NDCG@5': '0.0370', 'HR@10': '0.0754', 'NDCG@10': '0.0442', 'HR@20': '0.1055', 'NDCG@20': '0.0518'}
2025-02-21 19:51:11,580 - EarlyStopping counter: 10 out of 10
2025-02-21 19:51:11,580 - Early stopping
2025-02-21 19:51:11,580 - ---------------Test Score---------------
2025-02-21 19:51:31,895 - {'Epoch': 0, 'HR@5': '0.0423', 'NDCG@5': '0.0297', 'HR@10': '0.0611', 'NDCG@10': '0.0357', 'HR@20': '0.0879', 'NDCG@20': '0.0425'}
2025-02-21 19:51:31,897 - Scale_Sports
2025-02-21 19:51:31,897 - {'Epoch': 0, 'HR@5': '0.0423', 'NDCG@5': '0.0297', 'HR@10': '0.0611', 'NDCG@10': '0.0357', 'HR@20': '0.0879', 'NDCG@20': '0.0425'}
2025-02-23 18:16:35,897 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-23 18:16:38,726 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-23 18:16:38,731 - Total Parameters: 1328854
2025-02-23 18:17:20,576 - {'epoch': 0, 'rec_loss': '9.4019'}
2025-02-23 18:17:39,799 - {'Epoch': 0, 'HR@5': '0.0083', 'NDCG@5': '0.0055', 'HR@10': '0.0126', 'NDCG@10': '0.0068', 'HR@20': '0.0217', 'NDCG@20': '0.0091'}
2025-02-23 18:17:39,803 - Validation score increased.  Saving model ...
2025-02-23 18:18:21,431 - {'epoch': 1, 'rec_loss': '9.1622'}
2025-02-23 18:18:39,890 - {'Epoch': 1, 'HR@5': '0.0158', 'NDCG@5': '0.0101', 'HR@10': '0.0272', 'NDCG@10': '0.0137', 'HR@20': '0.0434', 'NDCG@20': '0.0178'}
2025-02-23 18:18:39,891 - Validation score increased.  Saving model ...
2025-02-23 18:19:23,239 - {'epoch': 2, 'rec_loss': '8.8670'}
2025-02-23 18:19:40,106 - {'Epoch': 2, 'HR@5': '0.0210', 'NDCG@5': '0.0134', 'HR@10': '0.0347', 'NDCG@10': '0.0178', 'HR@20': '0.0539', 'NDCG@20': '0.0226'}
2025-02-23 18:19:40,107 - Validation score increased.  Saving model ...
2025-02-23 18:20:21,826 - {'epoch': 3, 'rec_loss': '8.6548'}
2025-02-23 18:20:39,384 - {'Epoch': 3, 'HR@5': '0.0299', 'NDCG@5': '0.0199', 'HR@10': '0.0453', 'NDCG@10': '0.0248', 'HR@20': '0.0690', 'NDCG@20': '0.0308'}
2025-02-23 18:20:39,387 - Validation score increased.  Saving model ...
2025-02-23 18:21:21,875 - {'epoch': 4, 'rec_loss': '8.4943'}
2025-02-23 18:21:38,090 - {'Epoch': 4, 'HR@5': '0.0342', 'NDCG@5': '0.0229', 'HR@10': '0.0517', 'NDCG@10': '0.0286', 'HR@20': '0.0775', 'NDCG@20': '0.0351'}
2025-02-23 18:21:38,091 - Validation score increased.  Saving model ...
2025-02-23 18:22:21,639 - {'epoch': 5, 'rec_loss': '8.3612'}
2025-02-23 18:22:38,936 - {'Epoch': 5, 'HR@5': '0.0397', 'NDCG@5': '0.0268', 'HR@10': '0.0579', 'NDCG@10': '0.0326', 'HR@20': '0.0826', 'NDCG@20': '0.0389'}
2025-02-23 18:22:38,940 - Validation score increased.  Saving model ...
2025-02-23 18:23:20,175 - {'epoch': 6, 'rec_loss': '8.2622'}
2025-02-23 18:23:37,427 - {'Epoch': 6, 'HR@5': '0.0415', 'NDCG@5': '0.0282', 'HR@10': '0.0605', 'NDCG@10': '0.0343', 'HR@20': '0.0868', 'NDCG@20': '0.0409'}
2025-02-23 18:23:37,435 - Validation score increased.  Saving model ...
2025-02-23 18:24:16,474 - {'epoch': 7, 'rec_loss': '8.1782'}
2025-02-23 18:24:35,001 - {'Epoch': 7, 'HR@5': '0.0425', 'NDCG@5': '0.0295', 'HR@10': '0.0630', 'NDCG@10': '0.0361', 'HR@20': '0.0901', 'NDCG@20': '0.0429'}
2025-02-23 18:24:35,003 - Validation score increased.  Saving model ...
2025-02-23 18:25:17,268 - {'epoch': 8, 'rec_loss': '8.1053'}
2025-02-23 18:25:33,928 - {'Epoch': 8, 'HR@5': '0.0455', 'NDCG@5': '0.0313', 'HR@10': '0.0639', 'NDCG@10': '0.0373', 'HR@20': '0.0926', 'NDCG@20': '0.0445'}
2025-02-23 18:25:33,932 - Validation score increased.  Saving model ...
2025-02-23 18:26:15,433 - {'epoch': 9, 'rec_loss': '8.0473'}
2025-02-23 18:26:32,521 - {'Epoch': 9, 'HR@5': '0.0460', 'NDCG@5': '0.0319', 'HR@10': '0.0661', 'NDCG@10': '0.0383', 'HR@20': '0.0933', 'NDCG@20': '0.0452'}
2025-02-23 18:26:32,522 - Validation score increased.  Saving model ...
2025-02-23 18:27:11,350 - {'epoch': 10, 'rec_loss': '8.0003'}
2025-02-23 18:27:30,398 - {'Epoch': 10, 'HR@5': '0.0456', 'NDCG@5': '0.0319', 'HR@10': '0.0665', 'NDCG@10': '0.0386', 'HR@20': '0.0945', 'NDCG@20': '0.0456'}
2025-02-23 18:27:30,399 - Validation score increased.  Saving model ...
2025-02-23 18:28:10,237 - {'epoch': 11, 'rec_loss': '7.9526'}
2025-02-23 18:28:29,401 - {'Epoch': 11, 'HR@5': '0.0474', 'NDCG@5': '0.0329', 'HR@10': '0.0686', 'NDCG@10': '0.0397', 'HR@20': '0.0974', 'NDCG@20': '0.0470'}
2025-02-23 18:28:29,404 - Validation score increased.  Saving model ...
2025-02-23 18:29:08,089 - {'epoch': 12, 'rec_loss': '7.9169'}
2025-02-23 18:29:27,230 - {'Epoch': 12, 'HR@5': '0.0476', 'NDCG@5': '0.0335', 'HR@10': '0.0688', 'NDCG@10': '0.0403', 'HR@20': '0.0985', 'NDCG@20': '0.0478'}
2025-02-23 18:29:27,233 - Validation score increased.  Saving model ...
2025-02-23 18:30:04,890 - {'epoch': 13, 'rec_loss': '7.8832'}
2025-02-23 18:30:22,954 - {'Epoch': 13, 'HR@5': '0.0479', 'NDCG@5': '0.0335', 'HR@10': '0.0697', 'NDCG@10': '0.0405', 'HR@20': '0.1000', 'NDCG@20': '0.0481'}
2025-02-23 18:30:22,957 - Validation score increased.  Saving model ...
2025-02-23 18:31:06,039 - {'epoch': 14, 'rec_loss': '7.8564'}
2025-02-23 18:31:24,996 - {'Epoch': 14, 'HR@5': '0.0490', 'NDCG@5': '0.0344', 'HR@10': '0.0703', 'NDCG@10': '0.0412', 'HR@20': '0.0997', 'NDCG@20': '0.0486'}
2025-02-23 18:31:25,002 - Validation score increased.  Saving model ...
2025-02-23 18:32:03,495 - {'epoch': 15, 'rec_loss': '7.8289'}
2025-02-23 18:32:20,163 - {'Epoch': 15, 'HR@5': '0.0494', 'NDCG@5': '0.0342', 'HR@10': '0.0708', 'NDCG@10': '0.0411', 'HR@20': '0.0998', 'NDCG@20': '0.0483'}
2025-02-23 18:32:20,167 - EarlyStopping counter: 1 out of 10
2025-02-23 18:33:00,863 - {'epoch': 16, 'rec_loss': '7.8049'}
2025-02-23 18:33:19,003 - {'Epoch': 16, 'HR@5': '0.0488', 'NDCG@5': '0.0341', 'HR@10': '0.0699', 'NDCG@10': '0.0409', 'HR@20': '0.1000', 'NDCG@20': '0.0485'}
2025-02-23 18:33:19,008 - EarlyStopping counter: 2 out of 10
2025-02-23 18:33:56,171 - {'epoch': 17, 'rec_loss': '7.7815'}
2025-02-23 18:34:14,921 - {'Epoch': 17, 'HR@5': '0.0490', 'NDCG@5': '0.0344', 'HR@10': '0.0711', 'NDCG@10': '0.0414', 'HR@20': '0.1005', 'NDCG@20': '0.0488'}
2025-02-23 18:34:14,922 - Validation score increased.  Saving model ...
2025-02-23 18:34:53,749 - {'epoch': 18, 'rec_loss': '7.7606'}
2025-02-23 18:35:10,603 - {'Epoch': 18, 'HR@5': '0.0498', 'NDCG@5': '0.0347', 'HR@10': '0.0707', 'NDCG@10': '0.0414', 'HR@20': '0.1009', 'NDCG@20': '0.0491'}
2025-02-23 18:35:10,608 - Validation score increased.  Saving model ...
2025-02-23 18:35:48,048 - {'epoch': 19, 'rec_loss': '7.7417'}
2025-02-23 18:36:04,767 - {'Epoch': 19, 'HR@5': '0.0509', 'NDCG@5': '0.0353', 'HR@10': '0.0719', 'NDCG@10': '0.0420', 'HR@20': '0.1020', 'NDCG@20': '0.0496'}
2025-02-23 18:36:04,769 - Validation score increased.  Saving model ...
2025-02-23 18:36:43,625 - {'epoch': 20, 'rec_loss': '7.7283'}
2025-02-23 18:37:00,409 - {'Epoch': 20, 'HR@5': '0.0510', 'NDCG@5': '0.0356', 'HR@10': '0.0740', 'NDCG@10': '0.0430', 'HR@20': '0.1026', 'NDCG@20': '0.0502'}
2025-02-23 18:37:00,411 - Validation score increased.  Saving model ...
2025-02-23 18:37:40,620 - {'epoch': 21, 'rec_loss': '7.7064'}
2025-02-23 18:37:59,917 - {'Epoch': 21, 'HR@5': '0.0496', 'NDCG@5': '0.0342', 'HR@10': '0.0707', 'NDCG@10': '0.0410', 'HR@20': '0.1016', 'NDCG@20': '0.0487'}
2025-02-23 18:37:59,922 - EarlyStopping counter: 1 out of 10
2025-02-23 18:38:38,409 - {'epoch': 22, 'rec_loss': '7.6948'}
2025-02-23 18:38:56,047 - {'Epoch': 22, 'HR@5': '0.0500', 'NDCG@5': '0.0347', 'HR@10': '0.0730', 'NDCG@10': '0.0421', 'HR@20': '0.1027', 'NDCG@20': '0.0496'}
2025-02-23 18:38:56,052 - EarlyStopping counter: 2 out of 10
2025-02-23 18:39:37,769 - {'epoch': 23, 'rec_loss': '7.6801'}
2025-02-23 18:39:54,721 - {'Epoch': 23, 'HR@5': '0.0496', 'NDCG@5': '0.0343', 'HR@10': '0.0728', 'NDCG@10': '0.0417', 'HR@20': '0.1031', 'NDCG@20': '0.0493'}
2025-02-23 18:39:54,726 - EarlyStopping counter: 3 out of 10
2025-02-23 18:40:37,423 - {'epoch': 24, 'rec_loss': '7.6630'}
2025-02-23 18:40:54,155 - {'Epoch': 24, 'HR@5': '0.0502', 'NDCG@5': '0.0353', 'HR@10': '0.0734', 'NDCG@10': '0.0428', 'HR@20': '0.1043', 'NDCG@20': '0.0506'}
2025-02-23 18:40:54,159 - Validation score increased.  Saving model ...
2025-02-23 18:41:36,763 - {'epoch': 25, 'rec_loss': '7.6486'}
2025-02-23 18:41:55,876 - {'Epoch': 25, 'HR@5': '0.0502', 'NDCG@5': '0.0350', 'HR@10': '0.0744', 'NDCG@10': '0.0428', 'HR@20': '0.1042', 'NDCG@20': '0.0503'}
2025-02-23 18:41:55,880 - EarlyStopping counter: 1 out of 10
2025-02-23 18:42:38,573 - {'epoch': 26, 'rec_loss': '7.6405'}
2025-02-23 18:42:57,815 - {'Epoch': 26, 'HR@5': '0.0512', 'NDCG@5': '0.0358', 'HR@10': '0.0726', 'NDCG@10': '0.0428', 'HR@20': '0.1033', 'NDCG@20': '0.0505'}
2025-02-23 18:42:57,816 - EarlyStopping counter: 2 out of 10
2025-02-23 18:43:35,223 - {'epoch': 27, 'rec_loss': '7.6235'}
2025-02-23 18:43:54,212 - {'Epoch': 27, 'HR@5': '0.0527', 'NDCG@5': '0.0362', 'HR@10': '0.0740', 'NDCG@10': '0.0430', 'HR@20': '0.1031', 'NDCG@20': '0.0503'}
2025-02-23 18:43:54,213 - EarlyStopping counter: 3 out of 10
2025-02-23 18:44:35,116 - {'epoch': 28, 'rec_loss': '7.6198'}
2025-02-23 18:44:52,394 - {'Epoch': 28, 'HR@5': '0.0512', 'NDCG@5': '0.0358', 'HR@10': '0.0742', 'NDCG@10': '0.0432', 'HR@20': '0.1042', 'NDCG@20': '0.0507'}
2025-02-23 18:44:52,395 - Validation score increased.  Saving model ...
2025-02-23 18:45:30,273 - {'epoch': 29, 'rec_loss': '7.6089'}
2025-02-23 18:45:49,158 - {'Epoch': 29, 'HR@5': '0.0512', 'NDCG@5': '0.0354', 'HR@10': '0.0742', 'NDCG@10': '0.0429', 'HR@20': '0.1041', 'NDCG@20': '0.0504'}
2025-02-23 18:45:49,163 - EarlyStopping counter: 1 out of 10
2025-02-23 18:46:27,315 - {'epoch': 30, 'rec_loss': '7.6006'}
2025-02-23 18:46:47,311 - {'Epoch': 30, 'HR@5': '0.0513', 'NDCG@5': '0.0352', 'HR@10': '0.0732', 'NDCG@10': '0.0423', 'HR@20': '0.1033', 'NDCG@20': '0.0498'}
2025-02-23 18:46:47,316 - EarlyStopping counter: 2 out of 10
2025-02-23 18:47:26,925 - {'epoch': 31, 'rec_loss': '7.5881'}
2025-02-23 18:47:46,134 - {'Epoch': 31, 'HR@5': '0.0506', 'NDCG@5': '0.0348', 'HR@10': '0.0733', 'NDCG@10': '0.0421', 'HR@20': '0.1044', 'NDCG@20': '0.0499'}
2025-02-23 18:47:46,135 - EarlyStopping counter: 3 out of 10
2025-02-23 18:48:23,765 - {'epoch': 32, 'rec_loss': '7.5786'}
2025-02-23 18:48:40,943 - {'Epoch': 32, 'HR@5': '0.0514', 'NDCG@5': '0.0355', 'HR@10': '0.0742', 'NDCG@10': '0.0429', 'HR@20': '0.1045', 'NDCG@20': '0.0505'}
2025-02-23 18:48:40,950 - EarlyStopping counter: 4 out of 10
2025-02-23 18:49:21,168 - {'epoch': 33, 'rec_loss': '7.5684'}
2025-02-23 18:49:39,247 - {'Epoch': 33, 'HR@5': '0.0521', 'NDCG@5': '0.0363', 'HR@10': '0.0741', 'NDCG@10': '0.0434', 'HR@20': '0.1044', 'NDCG@20': '0.0511'}
2025-02-23 18:49:39,248 - Validation score increased.  Saving model ...
2025-02-23 18:50:18,033 - {'epoch': 34, 'rec_loss': '7.5671'}
2025-02-23 18:50:36,975 - {'Epoch': 34, 'HR@5': '0.0513', 'NDCG@5': '0.0356', 'HR@10': '0.0733', 'NDCG@10': '0.0427', 'HR@20': '0.1034', 'NDCG@20': '0.0503'}
2025-02-23 18:50:36,980 - EarlyStopping counter: 1 out of 10
2025-02-23 18:51:14,862 - {'epoch': 35, 'rec_loss': '7.5558'}
2025-02-23 18:51:33,134 - {'Epoch': 35, 'HR@5': '0.0514', 'NDCG@5': '0.0357', 'HR@10': '0.0748', 'NDCG@10': '0.0432', 'HR@20': '0.1049', 'NDCG@20': '0.0508'}
2025-02-23 18:51:33,139 - EarlyStopping counter: 2 out of 10
2025-02-23 18:52:10,481 - {'epoch': 36, 'rec_loss': '7.5543'}
2025-02-23 18:52:29,596 - {'Epoch': 36, 'HR@5': '0.0510', 'NDCG@5': '0.0355', 'HR@10': '0.0739', 'NDCG@10': '0.0429', 'HR@20': '0.1038', 'NDCG@20': '0.0504'}
2025-02-23 18:52:29,599 - EarlyStopping counter: 3 out of 10
2025-02-23 18:53:08,120 - {'epoch': 37, 'rec_loss': '7.5422'}
2025-02-23 18:53:26,996 - {'Epoch': 37, 'HR@5': '0.0507', 'NDCG@5': '0.0356', 'HR@10': '0.0733', 'NDCG@10': '0.0429', 'HR@20': '0.1038', 'NDCG@20': '0.0505'}
2025-02-23 18:53:26,997 - EarlyStopping counter: 4 out of 10
2025-02-23 18:54:04,223 - {'epoch': 38, 'rec_loss': '7.5295'}
2025-02-23 18:54:24,046 - {'Epoch': 38, 'HR@5': '0.0528', 'NDCG@5': '0.0365', 'HR@10': '0.0752', 'NDCG@10': '0.0437', 'HR@20': '0.1057', 'NDCG@20': '0.0514'}
2025-02-23 18:54:24,048 - Validation score increased.  Saving model ...
2025-02-23 18:55:02,029 - {'epoch': 39, 'rec_loss': '7.5251'}
2025-02-23 18:55:22,327 - {'Epoch': 39, 'HR@5': '0.0518', 'NDCG@5': '0.0360', 'HR@10': '0.0752', 'NDCG@10': '0.0436', 'HR@20': '0.1056', 'NDCG@20': '0.0512'}
2025-02-23 18:55:22,330 - EarlyStopping counter: 1 out of 10
2025-02-23 18:56:02,133 - {'epoch': 40, 'rec_loss': '7.5212'}
2025-02-23 18:56:21,510 - {'Epoch': 40, 'HR@5': '0.0520', 'NDCG@5': '0.0363', 'HR@10': '0.0740', 'NDCG@10': '0.0434', 'HR@20': '0.1046', 'NDCG@20': '0.0511'}
2025-02-23 18:56:21,511 - EarlyStopping counter: 2 out of 10
2025-02-23 18:57:01,128 - {'epoch': 41, 'rec_loss': '7.5122'}
2025-02-23 18:57:21,026 - {'Epoch': 41, 'HR@5': '0.0511', 'NDCG@5': '0.0358', 'HR@10': '0.0733', 'NDCG@10': '0.0429', 'HR@20': '0.1043', 'NDCG@20': '0.0507'}
2025-02-23 18:57:21,027 - EarlyStopping counter: 3 out of 10
2025-02-23 18:57:58,630 - {'epoch': 42, 'rec_loss': '7.5068'}
2025-02-23 18:58:17,943 - {'Epoch': 42, 'HR@5': '0.0515', 'NDCG@5': '0.0360', 'HR@10': '0.0743', 'NDCG@10': '0.0433', 'HR@20': '0.1051', 'NDCG@20': '0.0510'}
2025-02-23 18:58:17,944 - EarlyStopping counter: 4 out of 10
2025-02-23 18:58:55,466 - {'epoch': 43, 'rec_loss': '7.5049'}
2025-02-23 18:59:14,239 - {'Epoch': 43, 'HR@5': '0.0520', 'NDCG@5': '0.0358', 'HR@10': '0.0740', 'NDCG@10': '0.0429', 'HR@20': '0.1061', 'NDCG@20': '0.0510'}
2025-02-23 18:59:14,240 - EarlyStopping counter: 5 out of 10
2025-02-23 18:59:52,904 - {'epoch': 44, 'rec_loss': '7.4941'}
2025-02-23 19:00:11,976 - {'Epoch': 44, 'HR@5': '0.0518', 'NDCG@5': '0.0360', 'HR@10': '0.0751', 'NDCG@10': '0.0435', 'HR@20': '0.1063', 'NDCG@20': '0.0513'}
2025-02-23 19:00:11,982 - EarlyStopping counter: 6 out of 10
2025-02-23 19:00:52,056 - {'epoch': 45, 'rec_loss': '7.4962'}
2025-02-23 19:01:11,759 - {'Epoch': 45, 'HR@5': '0.0525', 'NDCG@5': '0.0363', 'HR@10': '0.0755', 'NDCG@10': '0.0437', 'HR@20': '0.1061', 'NDCG@20': '0.0514'}
2025-02-23 19:01:11,760 - EarlyStopping counter: 7 out of 10
2025-02-23 19:01:49,180 - {'epoch': 46, 'rec_loss': '7.4894'}
2025-02-23 19:02:07,869 - {'Epoch': 46, 'HR@5': '0.0517', 'NDCG@5': '0.0357', 'HR@10': '0.0749', 'NDCG@10': '0.0432', 'HR@20': '0.1048', 'NDCG@20': '0.0507'}
2025-02-23 19:02:07,870 - EarlyStopping counter: 8 out of 10
2025-02-23 19:02:46,282 - {'epoch': 47, 'rec_loss': '7.4873'}
2025-02-23 19:03:05,600 - {'Epoch': 47, 'HR@5': '0.0511', 'NDCG@5': '0.0355', 'HR@10': '0.0746', 'NDCG@10': '0.0431', 'HR@20': '0.1043', 'NDCG@20': '0.0505'}
2025-02-23 19:03:05,603 - EarlyStopping counter: 9 out of 10
2025-02-23 19:03:43,323 - {'epoch': 48, 'rec_loss': '7.4794'}
2025-02-23 19:04:02,647 - {'Epoch': 48, 'HR@5': '0.0520', 'NDCG@5': '0.0359', 'HR@10': '0.0747', 'NDCG@10': '0.0433', 'HR@20': '0.1053', 'NDCG@20': '0.0510'}
2025-02-23 19:04:02,649 - EarlyStopping counter: 10 out of 10
2025-02-23 19:04:02,649 - Early stopping
2025-02-23 19:04:02,649 - ---------------Test Score---------------
2025-02-23 19:04:19,394 - {'Epoch': 0, 'HR@5': '0.0427', 'NDCG@5': '0.0296', 'HR@10': '0.0617', 'NDCG@10': '0.0357', 'HR@20': '0.0877', 'NDCG@20': '0.0423'}
2025-02-23 19:04:19,400 - Scale_Sports
2025-02-23 19:04:19,400 - {'Epoch': 0, 'HR@5': '0.0427', 'NDCG@5': '0.0296', 'HR@10': '0.0617', 'NDCG@10': '0.0357', 'HR@20': '0.0877', 'NDCG@20': '0.0423'}
2025-02-23 19:07:31,927 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-23 19:07:34,748 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-23 19:07:34,754 - Total Parameters: 1328854
2025-02-23 19:08:14,254 - {'epoch': 0, 'rec_loss': '9.4019'}
2025-02-23 19:08:33,095 - {'Epoch': 0, 'HR@5': '0.0083', 'NDCG@5': '0.0054', 'HR@10': '0.0127', 'NDCG@10': '0.0068', 'HR@20': '0.0215', 'NDCG@20': '0.0090'}
2025-02-23 19:08:33,100 - Validation score increased.  Saving model ...
2025-02-23 19:09:12,983 - {'epoch': 1, 'rec_loss': '9.1787'}
2025-02-23 19:09:29,298 - {'Epoch': 1, 'HR@5': '0.0151', 'NDCG@5': '0.0096', 'HR@10': '0.0260', 'NDCG@10': '0.0131', 'HR@20': '0.0427', 'NDCG@20': '0.0173'}
2025-02-23 19:09:29,301 - Validation score increased.  Saving model ...
2025-02-23 19:10:09,910 - {'epoch': 2, 'rec_loss': '8.8952'}
2025-02-23 19:10:26,028 - {'Epoch': 2, 'HR@5': '0.0197', 'NDCG@5': '0.0128', 'HR@10': '0.0332', 'NDCG@10': '0.0171', 'HR@20': '0.0519', 'NDCG@20': '0.0218'}
2025-02-23 19:10:26,029 - Validation score increased.  Saving model ...
2025-02-23 19:11:06,478 - {'epoch': 3, 'rec_loss': '8.6943'}
2025-02-23 19:11:24,097 - {'Epoch': 3, 'HR@5': '0.0287', 'NDCG@5': '0.0188', 'HR@10': '0.0440', 'NDCG@10': '0.0237', 'HR@20': '0.0658', 'NDCG@20': '0.0291'}
2025-02-23 19:11:24,098 - Validation score increased.  Saving model ...
2025-02-23 19:12:04,312 - {'epoch': 4, 'rec_loss': '8.5410'}
2025-02-23 19:12:19,946 - {'Epoch': 4, 'HR@5': '0.0323', 'NDCG@5': '0.0214', 'HR@10': '0.0487', 'NDCG@10': '0.0267', 'HR@20': '0.0748', 'NDCG@20': '0.0333'}
2025-02-23 19:12:19,947 - Validation score increased.  Saving model ...
2025-02-23 19:13:00,747 - {'epoch': 5, 'rec_loss': '8.4139'}
2025-02-23 19:13:16,925 - {'Epoch': 5, 'HR@5': '0.0382', 'NDCG@5': '0.0257', 'HR@10': '0.0553', 'NDCG@10': '0.0312', 'HR@20': '0.0805', 'NDCG@20': '0.0375'}
2025-02-23 19:13:16,926 - Validation score increased.  Saving model ...
2025-02-23 19:13:58,282 - {'epoch': 6, 'rec_loss': '8.3182'}
2025-02-23 19:14:15,329 - {'Epoch': 6, 'HR@5': '0.0398', 'NDCG@5': '0.0273', 'HR@10': '0.0589', 'NDCG@10': '0.0334', 'HR@20': '0.0849', 'NDCG@20': '0.0400'}
2025-02-23 19:14:15,330 - Validation score increased.  Saving model ...
2025-02-23 19:14:58,272 - {'epoch': 7, 'rec_loss': '8.2362'}
2025-02-23 19:15:15,443 - {'Epoch': 7, 'HR@5': '0.0422', 'NDCG@5': '0.0290', 'HR@10': '0.0612', 'NDCG@10': '0.0351', 'HR@20': '0.0881', 'NDCG@20': '0.0418'}
2025-02-23 19:15:15,444 - Validation score increased.  Saving model ...
2025-02-23 19:15:56,470 - {'epoch': 8, 'rec_loss': '8.1639'}
2025-02-23 19:16:12,621 - {'Epoch': 8, 'HR@5': '0.0448', 'NDCG@5': '0.0310', 'HR@10': '0.0633', 'NDCG@10': '0.0370', 'HR@20': '0.0904', 'NDCG@20': '0.0438'}
2025-02-23 19:16:12,622 - Validation score increased.  Saving model ...
2025-02-23 19:16:53,719 - {'epoch': 9, 'rec_loss': '8.1067'}
2025-02-23 19:17:12,096 - {'Epoch': 9, 'HR@5': '0.0458', 'NDCG@5': '0.0315', 'HR@10': '0.0652', 'NDCG@10': '0.0378', 'HR@20': '0.0928', 'NDCG@20': '0.0447'}
2025-02-23 19:17:12,097 - Validation score increased.  Saving model ...
2025-02-23 19:17:57,997 - {'epoch': 10, 'rec_loss': '8.0607'}
2025-02-23 19:18:14,232 - {'Epoch': 10, 'HR@5': '0.0446', 'NDCG@5': '0.0315', 'HR@10': '0.0655', 'NDCG@10': '0.0383', 'HR@20': '0.0934', 'NDCG@20': '0.0452'}
2025-02-23 19:18:14,234 - Validation score increased.  Saving model ...
2025-02-23 19:18:56,955 - {'epoch': 11, 'rec_loss': '8.0124'}
2025-02-23 19:19:14,289 - {'Epoch': 11, 'HR@5': '0.0466', 'NDCG@5': '0.0322', 'HR@10': '0.0677', 'NDCG@10': '0.0390', 'HR@20': '0.0955', 'NDCG@20': '0.0460'}
2025-02-23 19:19:14,290 - Validation score increased.  Saving model ...
2025-02-23 19:19:56,126 - {'epoch': 12, 'rec_loss': '7.9783'}
2025-02-23 19:20:12,857 - {'Epoch': 12, 'HR@5': '0.0473', 'NDCG@5': '0.0330', 'HR@10': '0.0685', 'NDCG@10': '0.0398', 'HR@20': '0.0971', 'NDCG@20': '0.0470'}
2025-02-23 19:20:12,858 - Validation score increased.  Saving model ...
2025-02-23 19:20:53,285 - {'epoch': 13, 'rec_loss': '7.9447'}
2025-02-23 19:21:09,613 - {'Epoch': 13, 'HR@5': '0.0468', 'NDCG@5': '0.0326', 'HR@10': '0.0691', 'NDCG@10': '0.0398', 'HR@20': '0.0979', 'NDCG@20': '0.0470'}
2025-02-23 19:21:09,617 - Validation score increased.  Saving model ...
2025-02-23 19:21:51,040 - {'epoch': 14, 'rec_loss': '7.9159'}
2025-02-23 19:22:07,350 - {'Epoch': 14, 'HR@5': '0.0485', 'NDCG@5': '0.0340', 'HR@10': '0.0696', 'NDCG@10': '0.0408', 'HR@20': '0.0989', 'NDCG@20': '0.0481'}
2025-02-23 19:22:07,353 - Validation score increased.  Saving model ...
2025-02-23 19:22:47,806 - {'epoch': 15, 'rec_loss': '7.8893'}
2025-02-23 19:23:04,202 - {'Epoch': 15, 'HR@5': '0.0484', 'NDCG@5': '0.0338', 'HR@10': '0.0693', 'NDCG@10': '0.0405', 'HR@20': '0.0991', 'NDCG@20': '0.0480'}
2025-02-23 19:23:04,203 - EarlyStopping counter: 1 out of 10
2025-02-23 19:23:44,464 - {'epoch': 16, 'rec_loss': '7.8669'}
2025-02-23 19:24:00,947 - {'Epoch': 16, 'HR@5': '0.0488', 'NDCG@5': '0.0338', 'HR@10': '0.0707', 'NDCG@10': '0.0408', 'HR@20': '0.1001', 'NDCG@20': '0.0482'}
2025-02-23 19:24:00,950 - Validation score increased.  Saving model ...
2025-02-23 19:24:42,398 - {'epoch': 17, 'rec_loss': '7.8438'}
2025-02-23 19:24:58,711 - {'Epoch': 17, 'HR@5': '0.0488', 'NDCG@5': '0.0341', 'HR@10': '0.0701', 'NDCG@10': '0.0410', 'HR@20': '0.0997', 'NDCG@20': '0.0484'}
2025-02-23 19:24:58,714 - Validation score increased.  Saving model ...
2025-02-23 19:25:38,669 - {'epoch': 18, 'rec_loss': '7.8217'}
2025-02-23 19:25:56,000 - {'Epoch': 18, 'HR@5': '0.0499', 'NDCG@5': '0.0346', 'HR@10': '0.0717', 'NDCG@10': '0.0416', 'HR@20': '0.1013', 'NDCG@20': '0.0490'}
2025-02-23 19:25:56,001 - Validation score increased.  Saving model ...
2025-02-23 19:26:36,102 - {'epoch': 19, 'rec_loss': '7.8012'}
2025-02-23 19:26:53,051 - {'Epoch': 19, 'HR@5': '0.0505', 'NDCG@5': '0.0351', 'HR@10': '0.0721', 'NDCG@10': '0.0421', 'HR@20': '0.1009', 'NDCG@20': '0.0493'}
2025-02-23 19:26:53,052 - Validation score increased.  Saving model ...
2025-02-23 19:27:33,983 - {'epoch': 20, 'rec_loss': '7.7870'}
2025-02-23 19:27:51,110 - {'Epoch': 20, 'HR@5': '0.0514', 'NDCG@5': '0.0354', 'HR@10': '0.0736', 'NDCG@10': '0.0426', 'HR@20': '0.1013', 'NDCG@20': '0.0495'}
2025-02-23 19:27:51,114 - Validation score increased.  Saving model ...
2025-02-23 19:28:34,592 - {'epoch': 21, 'rec_loss': '7.7634'}
2025-02-23 19:28:51,006 - {'Epoch': 21, 'HR@5': '0.0495', 'NDCG@5': '0.0343', 'HR@10': '0.0712', 'NDCG@10': '0.0413', 'HR@20': '0.1018', 'NDCG@20': '0.0490'}
2025-02-23 19:28:51,009 - EarlyStopping counter: 1 out of 10
2025-02-23 19:29:28,152 - {'epoch': 22, 'rec_loss': '7.7522'}
2025-02-23 19:29:44,636 - {'Epoch': 22, 'HR@5': '0.0507', 'NDCG@5': '0.0352', 'HR@10': '0.0722', 'NDCG@10': '0.0421', 'HR@20': '0.1030', 'NDCG@20': '0.0498'}
2025-02-23 19:29:44,639 - Validation score increased.  Saving model ...
2025-02-23 19:30:24,019 - {'epoch': 23, 'rec_loss': '7.7375'}
2025-02-23 19:30:40,592 - {'Epoch': 23, 'HR@5': '0.0495', 'NDCG@5': '0.0343', 'HR@10': '0.0716', 'NDCG@10': '0.0414', 'HR@20': '0.1024', 'NDCG@20': '0.0492'}
2025-02-23 19:30:40,593 - EarlyStopping counter: 1 out of 10
2025-02-23 19:31:20,035 - {'epoch': 24, 'rec_loss': '7.7199'}
2025-02-23 19:31:37,348 - {'Epoch': 24, 'HR@5': '0.0514', 'NDCG@5': '0.0357', 'HR@10': '0.0726', 'NDCG@10': '0.0425', 'HR@20': '0.1030', 'NDCG@20': '0.0501'}
2025-02-23 19:31:37,349 - Validation score increased.  Saving model ...
2025-02-23 19:32:14,718 - {'epoch': 25, 'rec_loss': '7.7075'}
2025-02-23 19:32:31,227 - {'Epoch': 25, 'HR@5': '0.0514', 'NDCG@5': '0.0356', 'HR@10': '0.0735', 'NDCG@10': '0.0427', 'HR@20': '0.1044', 'NDCG@20': '0.0505'}
2025-02-23 19:32:31,229 - Validation score increased.  Saving model ...
2025-02-23 19:33:08,650 - {'epoch': 26, 'rec_loss': '7.6965'}
2025-02-23 19:33:27,683 - {'Epoch': 26, 'HR@5': '0.0514', 'NDCG@5': '0.0359', 'HR@10': '0.0730', 'NDCG@10': '0.0429', 'HR@20': '0.1025', 'NDCG@20': '0.0503'}
2025-02-23 19:33:27,685 - EarlyStopping counter: 1 out of 10
2025-02-23 19:34:10,177 - {'epoch': 27, 'rec_loss': '7.6817'}
2025-02-23 19:34:27,347 - {'Epoch': 27, 'HR@5': '0.0512', 'NDCG@5': '0.0356', 'HR@10': '0.0737', 'NDCG@10': '0.0428', 'HR@20': '0.1030', 'NDCG@20': '0.0502'}
2025-02-23 19:34:27,348 - EarlyStopping counter: 2 out of 10
2025-02-23 19:35:11,067 - {'epoch': 28, 'rec_loss': '7.6736'}
2025-02-23 19:35:29,846 - {'Epoch': 28, 'HR@5': '0.0509', 'NDCG@5': '0.0357', 'HR@10': '0.0726', 'NDCG@10': '0.0427', 'HR@20': '0.1031', 'NDCG@20': '0.0504'}
2025-02-23 19:35:29,847 - EarlyStopping counter: 3 out of 10
2025-02-23 19:36:07,579 - {'epoch': 29, 'rec_loss': '7.6656'}
2025-02-23 19:36:24,232 - {'Epoch': 29, 'HR@5': '0.0512', 'NDCG@5': '0.0355', 'HR@10': '0.0737', 'NDCG@10': '0.0427', 'HR@20': '0.1048', 'NDCG@20': '0.0505'}
2025-02-23 19:36:24,233 - Validation score increased.  Saving model ...
2025-02-23 19:37:06,857 - {'epoch': 30, 'rec_loss': '7.6567'}
2025-02-23 19:37:24,478 - {'Epoch': 30, 'HR@5': '0.0510', 'NDCG@5': '0.0357', 'HR@10': '0.0732', 'NDCG@10': '0.0428', 'HR@20': '0.1037', 'NDCG@20': '0.0505'}
2025-02-23 19:37:24,481 - EarlyStopping counter: 1 out of 10
2025-02-23 19:38:08,257 - {'epoch': 31, 'rec_loss': '7.6458'}
2025-02-23 19:38:25,550 - {'Epoch': 31, 'HR@5': '0.0510', 'NDCG@5': '0.0353', 'HR@10': '0.0734', 'NDCG@10': '0.0426', 'HR@20': '0.1037', 'NDCG@20': '0.0502'}
2025-02-23 19:38:25,552 - EarlyStopping counter: 2 out of 10
2025-02-23 19:39:06,337 - {'epoch': 32, 'rec_loss': '7.6331'}
2025-02-23 19:39:24,658 - {'Epoch': 32, 'HR@5': '0.0508', 'NDCG@5': '0.0352', 'HR@10': '0.0730', 'NDCG@10': '0.0424', 'HR@20': '0.1036', 'NDCG@20': '0.0501'}
2025-02-23 19:39:24,659 - EarlyStopping counter: 3 out of 10
2025-02-23 19:40:03,237 - {'epoch': 33, 'rec_loss': '7.6266'}
2025-02-23 19:40:22,305 - {'Epoch': 33, 'HR@5': '0.0513', 'NDCG@5': '0.0358', 'HR@10': '0.0741', 'NDCG@10': '0.0432', 'HR@20': '0.1036', 'NDCG@20': '0.0506'}
2025-02-23 19:40:22,306 - Validation score increased.  Saving model ...
2025-02-23 19:40:59,599 - {'epoch': 34, 'rec_loss': '7.6252'}
2025-02-23 19:41:18,432 - {'Epoch': 34, 'HR@5': '0.0512', 'NDCG@5': '0.0356', 'HR@10': '0.0739', 'NDCG@10': '0.0429', 'HR@20': '0.1046', 'NDCG@20': '0.0506'}
2025-02-23 19:41:18,433 - Validation score increased.  Saving model ...
2025-02-23 19:41:56,716 - {'epoch': 35, 'rec_loss': '7.6121'}
2025-02-23 19:42:14,311 - {'Epoch': 35, 'HR@5': '0.0518', 'NDCG@5': '0.0360', 'HR@10': '0.0747', 'NDCG@10': '0.0434', 'HR@20': '0.1050', 'NDCG@20': '0.0510'}
2025-02-23 19:42:14,312 - Validation score increased.  Saving model ...
2025-02-23 19:42:58,646 - {'epoch': 36, 'rec_loss': '7.6074'}
2025-02-23 19:43:15,336 - {'Epoch': 36, 'HR@5': '0.0511', 'NDCG@5': '0.0358', 'HR@10': '0.0737', 'NDCG@10': '0.0431', 'HR@20': '0.1041', 'NDCG@20': '0.0507'}
2025-02-23 19:43:15,337 - EarlyStopping counter: 1 out of 10
2025-02-23 19:43:54,801 - {'epoch': 37, 'rec_loss': '7.5992'}
2025-02-23 19:44:11,546 - {'Epoch': 37, 'HR@5': '0.0520', 'NDCG@5': '0.0361', 'HR@10': '0.0733', 'NDCG@10': '0.0429', 'HR@20': '0.1043', 'NDCG@20': '0.0508'}
2025-02-23 19:44:11,547 - EarlyStopping counter: 2 out of 10
2025-02-23 19:44:48,850 - {'epoch': 38, 'rec_loss': '7.5856'}
2025-02-23 19:45:07,277 - {'Epoch': 38, 'HR@5': '0.0524', 'NDCG@5': '0.0363', 'HR@10': '0.0739', 'NDCG@10': '0.0432', 'HR@20': '0.1044', 'NDCG@20': '0.0509'}
2025-02-23 19:45:07,279 - EarlyStopping counter: 3 out of 10
2025-02-23 19:45:45,286 - {'epoch': 39, 'rec_loss': '7.5832'}
2025-02-23 19:46:04,337 - {'Epoch': 39, 'HR@5': '0.0519', 'NDCG@5': '0.0362', 'HR@10': '0.0737', 'NDCG@10': '0.0432', 'HR@20': '0.1042', 'NDCG@20': '0.0508'}
2025-02-23 19:46:04,338 - EarlyStopping counter: 4 out of 10
2025-02-23 19:46:41,607 - {'epoch': 40, 'rec_loss': '7.5802'}
2025-02-23 19:47:00,779 - {'Epoch': 40, 'HR@5': '0.0513', 'NDCG@5': '0.0359', 'HR@10': '0.0740', 'NDCG@10': '0.0432', 'HR@20': '0.1027', 'NDCG@20': '0.0505'}
2025-02-23 19:47:00,781 - EarlyStopping counter: 5 out of 10
2025-02-23 19:47:38,083 - {'epoch': 41, 'rec_loss': '7.5697'}
2025-02-23 19:47:57,148 - {'Epoch': 41, 'HR@5': '0.0520', 'NDCG@5': '0.0361', 'HR@10': '0.0737', 'NDCG@10': '0.0431', 'HR@20': '0.1048', 'NDCG@20': '0.0509'}
2025-02-23 19:47:57,150 - EarlyStopping counter: 6 out of 10
2025-02-23 19:48:35,696 - {'epoch': 42, 'rec_loss': '7.5633'}
2025-02-23 19:48:54,740 - {'Epoch': 42, 'HR@5': '0.0514', 'NDCG@5': '0.0358', 'HR@10': '0.0739', 'NDCG@10': '0.0431', 'HR@20': '0.1046', 'NDCG@20': '0.0508'}
2025-02-23 19:48:54,742 - EarlyStopping counter: 7 out of 10
2025-02-23 19:49:32,582 - {'epoch': 43, 'rec_loss': '7.5627'}
2025-02-23 19:49:51,610 - {'Epoch': 43, 'HR@5': '0.0514', 'NDCG@5': '0.0356', 'HR@10': '0.0745', 'NDCG@10': '0.0431', 'HR@20': '0.1055', 'NDCG@20': '0.0509'}
2025-02-23 19:49:51,611 - EarlyStopping counter: 8 out of 10
2025-02-23 19:50:28,882 - {'epoch': 44, 'rec_loss': '7.5543'}
2025-02-23 19:50:47,339 - {'Epoch': 44, 'HR@5': '0.0523', 'NDCG@5': '0.0361', 'HR@10': '0.0758', 'NDCG@10': '0.0436', 'HR@20': '0.1057', 'NDCG@20': '0.0512'}
2025-02-23 19:50:47,342 - Validation score increased.  Saving model ...
2025-02-23 19:51:28,279 - {'epoch': 45, 'rec_loss': '7.5507'}
2025-02-23 19:51:46,095 - {'Epoch': 45, 'HR@5': '0.0519', 'NDCG@5': '0.0361', 'HR@10': '0.0752', 'NDCG@10': '0.0436', 'HR@20': '0.1047', 'NDCG@20': '0.0511'}
2025-02-23 19:51:46,096 - EarlyStopping counter: 1 out of 10
2025-02-23 19:52:24,681 - {'epoch': 46, 'rec_loss': '7.5477'}
2025-02-23 19:52:42,235 - {'Epoch': 46, 'HR@5': '0.0518', 'NDCG@5': '0.0361', 'HR@10': '0.0743', 'NDCG@10': '0.0434', 'HR@20': '0.1037', 'NDCG@20': '0.0508'}
2025-02-23 19:52:42,236 - EarlyStopping counter: 2 out of 10
2025-02-23 19:53:24,854 - {'epoch': 47, 'rec_loss': '7.5461'}
2025-02-23 19:53:41,456 - {'Epoch': 47, 'HR@5': '0.0520', 'NDCG@5': '0.0362', 'HR@10': '0.0742', 'NDCG@10': '0.0434', 'HR@20': '0.1036', 'NDCG@20': '0.0508'}
2025-02-23 19:53:41,457 - EarlyStopping counter: 3 out of 10
2025-02-23 19:54:26,591 - {'epoch': 48, 'rec_loss': '7.5374'}
2025-02-23 19:54:44,555 - {'Epoch': 48, 'HR@5': '0.0523', 'NDCG@5': '0.0362', 'HR@10': '0.0750', 'NDCG@10': '0.0435', 'HR@20': '0.1044', 'NDCG@20': '0.0509'}
2025-02-23 19:54:44,556 - EarlyStopping counter: 4 out of 10
2025-02-23 19:55:26,394 - {'epoch': 49, 'rec_loss': '7.5333'}
2025-02-23 19:55:42,916 - {'Epoch': 49, 'HR@5': '0.0514', 'NDCG@5': '0.0359', 'HR@10': '0.0743', 'NDCG@10': '0.0433', 'HR@20': '0.1045', 'NDCG@20': '0.0509'}
2025-02-23 19:55:42,917 - EarlyStopping counter: 5 out of 10
2025-02-23 19:56:23,310 - {'epoch': 50, 'rec_loss': '7.5327'}
2025-02-23 19:56:41,150 - {'Epoch': 50, 'HR@5': '0.0518', 'NDCG@5': '0.0359', 'HR@10': '0.0741', 'NDCG@10': '0.0430', 'HR@20': '0.1048', 'NDCG@20': '0.0508'}
2025-02-23 19:56:41,152 - EarlyStopping counter: 6 out of 10
2025-02-23 19:57:21,950 - {'epoch': 51, 'rec_loss': '7.5236'}
2025-02-23 19:57:39,278 - {'Epoch': 51, 'HR@5': '0.0517', 'NDCG@5': '0.0360', 'HR@10': '0.0739', 'NDCG@10': '0.0431', 'HR@20': '0.1051', 'NDCG@20': '0.0510'}
2025-02-23 19:57:39,280 - EarlyStopping counter: 7 out of 10
2025-02-23 19:58:18,355 - {'epoch': 52, 'rec_loss': '7.5212'}
2025-02-23 19:58:37,594 - {'Epoch': 52, 'HR@5': '0.0518', 'NDCG@5': '0.0359', 'HR@10': '0.0739', 'NDCG@10': '0.0430', 'HR@20': '0.1045', 'NDCG@20': '0.0507'}
2025-02-23 19:58:37,595 - EarlyStopping counter: 8 out of 10
2025-02-23 19:59:14,999 - {'epoch': 53, 'rec_loss': '7.5170'}
2025-02-23 19:59:33,652 - {'Epoch': 53, 'HR@5': '0.0516', 'NDCG@5': '0.0359', 'HR@10': '0.0753', 'NDCG@10': '0.0436', 'HR@20': '0.1046', 'NDCG@20': '0.0509'}
2025-02-23 19:59:33,653 - EarlyStopping counter: 9 out of 10
2025-02-23 20:00:11,989 - {'epoch': 54, 'rec_loss': '7.5092'}
2025-02-23 20:00:31,164 - {'Epoch': 54, 'HR@5': '0.0518', 'NDCG@5': '0.0358', 'HR@10': '0.0747', 'NDCG@10': '0.0432', 'HR@20': '0.1049', 'NDCG@20': '0.0508'}
2025-02-23 20:00:31,166 - EarlyStopping counter: 10 out of 10
2025-02-23 20:00:31,166 - Early stopping
2025-02-23 20:00:31,166 - ---------------Test Score---------------
2025-02-23 20:00:49,766 - {'Epoch': 0, 'HR@5': '0.0435', 'NDCG@5': '0.0305', 'HR@10': '0.0622', 'NDCG@10': '0.0365', 'HR@20': '0.0888', 'NDCG@20': '0.0432'}
2025-02-23 20:00:49,768 - Scale_Sports
2025-02-23 20:00:49,768 - {'Epoch': 0, 'HR@5': '0.0435', 'NDCG@5': '0.0305', 'HR@10': '0.0622', 'NDCG@10': '0.0365', 'HR@20': '0.0888', 'NDCG@20': '0.0432'}
2025-02-23 20:05:36,434 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.7, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-23 20:05:39,245 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-23 20:05:39,250 - Total Parameters: 1328854
2025-02-23 20:06:18,810 - {'epoch': 0, 'rec_loss': '9.4022'}
2025-02-23 20:06:35,348 - {'Epoch': 0, 'HR@5': '0.0083', 'NDCG@5': '0.0054', 'HR@10': '0.0128', 'NDCG@10': '0.0068', 'HR@20': '0.0215', 'NDCG@20': '0.0090'}
2025-02-23 20:06:35,349 - Validation score increased.  Saving model ...
2025-02-23 20:07:14,184 - {'epoch': 1, 'rec_loss': '9.1874'}
2025-02-23 20:07:32,416 - {'Epoch': 1, 'HR@5': '0.0136', 'NDCG@5': '0.0087', 'HR@10': '0.0239', 'NDCG@10': '0.0120', 'HR@20': '0.0405', 'NDCG@20': '0.0162'}
2025-02-23 20:07:32,417 - Validation score increased.  Saving model ...
2025-02-23 20:08:12,559 - {'epoch': 2, 'rec_loss': '8.9154'}
2025-02-23 20:08:28,803 - {'Epoch': 2, 'HR@5': '0.0183', 'NDCG@5': '0.0123', 'HR@10': '0.0307', 'NDCG@10': '0.0162', 'HR@20': '0.0503', 'NDCG@20': '0.0212'}
2025-02-23 20:08:28,805 - Validation score increased.  Saving model ...
2025-02-23 20:09:05,888 - {'epoch': 3, 'rec_loss': '8.7249'}
2025-02-23 20:09:23,507 - {'Epoch': 3, 'HR@5': '0.0271', 'NDCG@5': '0.0176', 'HR@10': '0.0420', 'NDCG@10': '0.0224', 'HR@20': '0.0646', 'NDCG@20': '0.0281'}
2025-02-23 20:09:23,509 - Validation score increased.  Saving model ...
2025-02-23 20:10:02,660 - {'epoch': 4, 'rec_loss': '8.5781'}
2025-02-23 20:10:17,773 - {'Epoch': 4, 'HR@5': '0.0300', 'NDCG@5': '0.0197', 'HR@10': '0.0464', 'NDCG@10': '0.0250', 'HR@20': '0.0714', 'NDCG@20': '0.0313'}
2025-02-23 20:10:17,774 - Validation score increased.  Saving model ...
2025-02-23 20:10:55,770 - {'epoch': 5, 'rec_loss': '8.4594'}
2025-02-23 20:11:12,003 - {'Epoch': 5, 'HR@5': '0.0364', 'NDCG@5': '0.0245', 'HR@10': '0.0527', 'NDCG@10': '0.0297', 'HR@20': '0.0789', 'NDCG@20': '0.0363'}
2025-02-23 20:11:12,004 - Validation score increased.  Saving model ...
2025-02-23 20:11:50,052 - {'epoch': 6, 'rec_loss': '8.3695'}
2025-02-23 20:12:07,272 - {'Epoch': 6, 'HR@5': '0.0381', 'NDCG@5': '0.0257', 'HR@10': '0.0561', 'NDCG@10': '0.0315', 'HR@20': '0.0829', 'NDCG@20': '0.0382'}
2025-02-23 20:12:07,273 - Validation score increased.  Saving model ...
2025-02-23 20:12:45,197 - {'epoch': 7, 'rec_loss': '8.2914'}
2025-02-23 20:13:03,805 - {'Epoch': 7, 'HR@5': '0.0408', 'NDCG@5': '0.0278', 'HR@10': '0.0585', 'NDCG@10': '0.0334', 'HR@20': '0.0867', 'NDCG@20': '0.0405'}
2025-02-23 20:13:03,806 - Validation score increased.  Saving model ...
2025-02-23 20:13:46,368 - {'epoch': 8, 'rec_loss': '8.2211'}
2025-02-23 20:14:02,770 - {'Epoch': 8, 'HR@5': '0.0429', 'NDCG@5': '0.0297', 'HR@10': '0.0610', 'NDCG@10': '0.0355', 'HR@20': '0.0884', 'NDCG@20': '0.0424'}
2025-02-23 20:14:02,772 - Validation score increased.  Saving model ...
2025-02-23 20:14:40,946 - {'epoch': 9, 'rec_loss': '8.1635'}
2025-02-23 20:14:56,940 - {'Epoch': 9, 'HR@5': '0.0433', 'NDCG@5': '0.0300', 'HR@10': '0.0635', 'NDCG@10': '0.0365', 'HR@20': '0.0901', 'NDCG@20': '0.0432'}
2025-02-23 20:14:56,941 - Validation score increased.  Saving model ...
2025-02-23 20:15:37,804 - {'epoch': 10, 'rec_loss': '8.1182'}
2025-02-23 20:15:56,055 - {'Epoch': 10, 'HR@5': '0.0446', 'NDCG@5': '0.0311', 'HR@10': '0.0634', 'NDCG@10': '0.0372', 'HR@20': '0.0915', 'NDCG@20': '0.0442'}
2025-02-23 20:15:56,057 - Validation score increased.  Saving model ...
2025-02-23 20:16:39,444 - {'epoch': 11, 'rec_loss': '8.0702'}
2025-02-23 20:16:58,044 - {'Epoch': 11, 'HR@5': '0.0450', 'NDCG@5': '0.0313', 'HR@10': '0.0660', 'NDCG@10': '0.0381', 'HR@20': '0.0953', 'NDCG@20': '0.0454'}
2025-02-23 20:16:58,045 - Validation score increased.  Saving model ...
2025-02-23 20:17:37,292 - {'epoch': 12, 'rec_loss': '8.0352'}
2025-02-23 20:17:54,942 - {'Epoch': 12, 'HR@5': '0.0467', 'NDCG@5': '0.0326', 'HR@10': '0.0669', 'NDCG@10': '0.0390', 'HR@20': '0.0950', 'NDCG@20': '0.0461'}
2025-02-23 20:17:54,944 - Validation score increased.  Saving model ...
2025-02-23 20:18:32,731 - {'epoch': 13, 'rec_loss': '8.0010'}
2025-02-23 20:18:51,521 - {'Epoch': 13, 'HR@5': '0.0461', 'NDCG@5': '0.0320', 'HR@10': '0.0671', 'NDCG@10': '0.0388', 'HR@20': '0.0967', 'NDCG@20': '0.0463'}
2025-02-23 20:18:51,523 - Validation score increased.  Saving model ...
2025-02-23 20:19:32,720 - {'epoch': 14, 'rec_loss': '7.9725'}
2025-02-23 20:19:49,047 - {'Epoch': 14, 'HR@5': '0.0480', 'NDCG@5': '0.0336', 'HR@10': '0.0680', 'NDCG@10': '0.0400', 'HR@20': '0.0973', 'NDCG@20': '0.0474'}
2025-02-23 20:19:49,048 - Validation score increased.  Saving model ...
2025-02-23 20:20:28,374 - {'epoch': 15, 'rec_loss': '7.9440'}
2025-02-23 20:20:46,152 - {'Epoch': 15, 'HR@5': '0.0475', 'NDCG@5': '0.0331', 'HR@10': '0.0694', 'NDCG@10': '0.0402', 'HR@20': '0.0984', 'NDCG@20': '0.0474'}
2025-02-23 20:20:46,154 - Validation score increased.  Saving model ...
2025-02-23 20:21:26,518 - {'epoch': 16, 'rec_loss': '7.9197'}
2025-02-23 20:21:43,392 - {'Epoch': 16, 'HR@5': '0.0485', 'NDCG@5': '0.0336', 'HR@10': '0.0691', 'NDCG@10': '0.0402', 'HR@20': '0.0991', 'NDCG@20': '0.0478'}
2025-02-23 20:21:43,393 - Validation score increased.  Saving model ...
2025-02-23 20:22:21,246 - {'epoch': 17, 'rec_loss': '7.8984'}
2025-02-23 20:22:39,965 - {'Epoch': 17, 'HR@5': '0.0490', 'NDCG@5': '0.0345', 'HR@10': '0.0698', 'NDCG@10': '0.0412', 'HR@20': '0.0991', 'NDCG@20': '0.0485'}
2025-02-23 20:22:39,967 - Validation score increased.  Saving model ...
2025-02-23 20:23:17,788 - {'epoch': 18, 'rec_loss': '7.8751'}
2025-02-23 20:23:35,153 - {'Epoch': 18, 'HR@5': '0.0499', 'NDCG@5': '0.0347', 'HR@10': '0.0720', 'NDCG@10': '0.0419', 'HR@20': '0.1017', 'NDCG@20': '0.0493'}
2025-02-23 20:23:35,155 - Validation score increased.  Saving model ...
2025-02-23 20:24:12,997 - {'epoch': 19, 'rec_loss': '7.8539'}
2025-02-23 20:24:30,963 - {'Epoch': 19, 'HR@5': '0.0501', 'NDCG@5': '0.0351', 'HR@10': '0.0712', 'NDCG@10': '0.0419', 'HR@20': '0.1001', 'NDCG@20': '0.0492'}
2025-02-23 20:24:30,964 - EarlyStopping counter: 1 out of 10
2025-02-23 20:25:13,808 - {'epoch': 20, 'rec_loss': '7.8386'}
2025-02-23 20:25:33,539 - {'Epoch': 20, 'HR@5': '0.0510', 'NDCG@5': '0.0353', 'HR@10': '0.0725', 'NDCG@10': '0.0422', 'HR@20': '0.1017', 'NDCG@20': '0.0496'}
2025-02-23 20:25:33,540 - Validation score increased.  Saving model ...
2025-02-23 20:26:11,471 - {'epoch': 21, 'rec_loss': '7.8165'}
2025-02-23 20:26:30,429 - {'Epoch': 21, 'HR@5': '0.0495', 'NDCG@5': '0.0345', 'HR@10': '0.0717', 'NDCG@10': '0.0416', 'HR@20': '0.1009', 'NDCG@20': '0.0489'}
2025-02-23 20:26:30,431 - EarlyStopping counter: 1 out of 10
2025-02-23 20:27:08,977 - {'epoch': 22, 'rec_loss': '7.8071'}
2025-02-23 20:27:27,597 - {'Epoch': 22, 'HR@5': '0.0501', 'NDCG@5': '0.0349', 'HR@10': '0.0717', 'NDCG@10': '0.0418', 'HR@20': '0.1008', 'NDCG@20': '0.0492'}
2025-02-23 20:27:27,598 - EarlyStopping counter: 2 out of 10
2025-02-23 20:28:06,205 - {'epoch': 23, 'rec_loss': '7.7914'}
2025-02-23 20:28:24,765 - {'Epoch': 23, 'HR@5': '0.0504', 'NDCG@5': '0.0349', 'HR@10': '0.0723', 'NDCG@10': '0.0419', 'HR@20': '0.1015', 'NDCG@20': '0.0493'}
2025-02-23 20:28:24,766 - EarlyStopping counter: 3 out of 10
2025-02-23 20:29:01,833 - {'epoch': 24, 'rec_loss': '7.7734'}
2025-02-23 20:29:20,414 - {'Epoch': 24, 'HR@5': '0.0504', 'NDCG@5': '0.0349', 'HR@10': '0.0730', 'NDCG@10': '0.0422', 'HR@20': '0.1023', 'NDCG@20': '0.0496'}
2025-02-23 20:29:20,416 - Validation score increased.  Saving model ...
2025-02-23 20:29:57,491 - {'epoch': 25, 'rec_loss': '7.7597'}
2025-02-23 20:30:15,334 - {'Epoch': 25, 'HR@5': '0.0508', 'NDCG@5': '0.0354', 'HR@10': '0.0743', 'NDCG@10': '0.0430', 'HR@20': '0.1044', 'NDCG@20': '0.0505'}
2025-02-23 20:30:15,335 - Validation score increased.  Saving model ...
2025-02-23 20:30:52,925 - {'epoch': 26, 'rec_loss': '7.7472'}
2025-02-23 20:31:10,096 - {'Epoch': 26, 'HR@5': '0.0516', 'NDCG@5': '0.0359', 'HR@10': '0.0736', 'NDCG@10': '0.0430', 'HR@20': '0.1026', 'NDCG@20': '0.0503'}
2025-02-23 20:31:10,101 - EarlyStopping counter: 1 out of 10
2025-02-23 20:31:47,323 - {'epoch': 27, 'rec_loss': '7.7341'}
2025-02-23 20:32:06,228 - {'Epoch': 27, 'HR@5': '0.0513', 'NDCG@5': '0.0355', 'HR@10': '0.0728', 'NDCG@10': '0.0425', 'HR@20': '0.1028', 'NDCG@20': '0.0500'}
2025-02-23 20:32:06,229 - EarlyStopping counter: 2 out of 10
2025-02-23 20:32:43,231 - {'epoch': 28, 'rec_loss': '7.7252'}
2025-02-23 20:33:01,749 - {'Epoch': 28, 'HR@5': '0.0516', 'NDCG@5': '0.0357', 'HR@10': '0.0732', 'NDCG@10': '0.0426', 'HR@20': '0.1027', 'NDCG@20': '0.0501'}
2025-02-23 20:33:01,750 - EarlyStopping counter: 3 out of 10
2025-02-23 20:33:38,818 - {'epoch': 29, 'rec_loss': '7.7142'}
2025-02-23 20:33:57,719 - {'Epoch': 29, 'HR@5': '0.0512', 'NDCG@5': '0.0358', 'HR@10': '0.0732', 'NDCG@10': '0.0429', 'HR@20': '0.1048', 'NDCG@20': '0.0509'}
2025-02-23 20:33:57,720 - Validation score increased.  Saving model ...
2025-02-23 20:34:39,071 - {'epoch': 30, 'rec_loss': '7.7073'}
2025-02-23 20:34:55,442 - {'Epoch': 30, 'HR@5': '0.0518', 'NDCG@5': '0.0360', 'HR@10': '0.0740', 'NDCG@10': '0.0432', 'HR@20': '0.1046', 'NDCG@20': '0.0509'}
2025-02-23 20:34:55,443 - EarlyStopping counter: 1 out of 10
2025-02-23 20:35:34,970 - {'epoch': 31, 'rec_loss': '7.6959'}
2025-02-23 20:35:53,263 - {'Epoch': 31, 'HR@5': '0.0513', 'NDCG@5': '0.0358', 'HR@10': '0.0741', 'NDCG@10': '0.0431', 'HR@20': '0.1041', 'NDCG@20': '0.0507'}
2025-02-23 20:35:53,264 - EarlyStopping counter: 2 out of 10
2025-02-23 20:36:33,879 - {'epoch': 32, 'rec_loss': '7.6858'}
2025-02-23 20:36:52,820 - {'Epoch': 32, 'HR@5': '0.0519', 'NDCG@5': '0.0360', 'HR@10': '0.0741', 'NDCG@10': '0.0431', 'HR@20': '0.1037', 'NDCG@20': '0.0506'}
2025-02-23 20:36:52,823 - EarlyStopping counter: 3 out of 10
2025-02-23 20:37:33,491 - {'epoch': 33, 'rec_loss': '7.6743'}
2025-02-23 20:37:50,255 - {'Epoch': 33, 'HR@5': '0.0516', 'NDCG@5': '0.0362', 'HR@10': '0.0738', 'NDCG@10': '0.0434', 'HR@20': '0.1040', 'NDCG@20': '0.0510'}
2025-02-23 20:37:50,256 - Validation score increased.  Saving model ...
2025-02-23 20:38:28,982 - {'epoch': 34, 'rec_loss': '7.6774'}
2025-02-23 20:38:45,530 - {'Epoch': 34, 'HR@5': '0.0521', 'NDCG@5': '0.0362', 'HR@10': '0.0752', 'NDCG@10': '0.0436', 'HR@20': '0.1045', 'NDCG@20': '0.0510'}
2025-02-23 20:38:45,531 - Validation score increased.  Saving model ...
2025-02-23 20:39:24,113 - {'epoch': 35, 'rec_loss': '7.6601'}
2025-02-23 20:39:40,593 - {'Epoch': 35, 'HR@5': '0.0522', 'NDCG@5': '0.0363', 'HR@10': '0.0746', 'NDCG@10': '0.0435', 'HR@20': '0.1057', 'NDCG@20': '0.0513'}
2025-02-23 20:39:40,602 - Validation score increased.  Saving model ...
2025-02-23 20:40:19,691 - {'epoch': 36, 'rec_loss': '7.6530'}
2025-02-23 20:40:39,619 - {'Epoch': 36, 'HR@5': '0.0523', 'NDCG@5': '0.0370', 'HR@10': '0.0744', 'NDCG@10': '0.0440', 'HR@20': '0.1046', 'NDCG@20': '0.0517'}
2025-02-23 20:40:39,620 - Validation score increased.  Saving model ...
2025-02-23 20:41:17,576 - {'epoch': 37, 'rec_loss': '7.6452'}
2025-02-23 20:41:36,645 - {'Epoch': 37, 'HR@5': '0.0523', 'NDCG@5': '0.0365', 'HR@10': '0.0751', 'NDCG@10': '0.0439', 'HR@20': '0.1054', 'NDCG@20': '0.0515'}
2025-02-23 20:41:36,646 - EarlyStopping counter: 1 out of 10
2025-02-23 20:42:18,558 - {'epoch': 38, 'rec_loss': '7.6319'}
2025-02-23 20:42:38,543 - {'Epoch': 38, 'HR@5': '0.0529', 'NDCG@5': '0.0367', 'HR@10': '0.0749', 'NDCG@10': '0.0438', 'HR@20': '0.1054', 'NDCG@20': '0.0514'}
2025-02-23 20:42:38,544 - EarlyStopping counter: 2 out of 10
2025-02-23 20:43:17,254 - {'epoch': 39, 'rec_loss': '7.6310'}
2025-02-23 20:43:33,493 - {'Epoch': 39, 'HR@5': '0.0528', 'NDCG@5': '0.0368', 'HR@10': '0.0746', 'NDCG@10': '0.0439', 'HR@20': '0.1045', 'NDCG@20': '0.0514'}
2025-02-23 20:43:33,497 - EarlyStopping counter: 3 out of 10
2025-02-23 20:44:14,957 - {'epoch': 40, 'rec_loss': '7.6272'}
2025-02-23 20:44:33,903 - {'Epoch': 40, 'HR@5': '0.0523', 'NDCG@5': '0.0367', 'HR@10': '0.0743', 'NDCG@10': '0.0438', 'HR@20': '0.1034', 'NDCG@20': '0.0511'}
2025-02-23 20:44:33,905 - EarlyStopping counter: 4 out of 10
2025-02-23 20:45:13,371 - {'epoch': 41, 'rec_loss': '7.6126'}
2025-02-23 20:45:32,313 - {'Epoch': 41, 'HR@5': '0.0521', 'NDCG@5': '0.0364', 'HR@10': '0.0754', 'NDCG@10': '0.0439', 'HR@20': '0.1042', 'NDCG@20': '0.0511'}
2025-02-23 20:45:32,314 - EarlyStopping counter: 5 out of 10
2025-02-23 20:46:11,455 - {'epoch': 42, 'rec_loss': '7.6123'}
2025-02-23 20:46:30,514 - {'Epoch': 42, 'HR@5': '0.0522', 'NDCG@5': '0.0367', 'HR@10': '0.0757', 'NDCG@10': '0.0443', 'HR@20': '0.1051', 'NDCG@20': '0.0517'}
2025-02-23 20:46:30,515 - Validation score increased.  Saving model ...
2025-02-23 20:47:07,573 - {'epoch': 43, 'rec_loss': '7.6085'}
2025-02-23 20:47:24,744 - {'Epoch': 43, 'HR@5': '0.0528', 'NDCG@5': '0.0367', 'HR@10': '0.0754', 'NDCG@10': '0.0440', 'HR@20': '0.1048', 'NDCG@20': '0.0514'}
2025-02-23 20:47:24,745 - EarlyStopping counter: 1 out of 10
2025-02-23 20:48:01,744 - {'epoch': 44, 'rec_loss': '7.6013'}
2025-02-23 20:48:20,607 - {'Epoch': 44, 'HR@5': '0.0533', 'NDCG@5': '0.0370', 'HR@10': '0.0760', 'NDCG@10': '0.0443', 'HR@20': '0.1061', 'NDCG@20': '0.0519'}
2025-02-23 20:48:20,608 - Validation score increased.  Saving model ...
2025-02-23 20:49:02,177 - {'epoch': 45, 'rec_loss': '7.5967'}
2025-02-23 20:49:19,940 - {'Epoch': 45, 'HR@5': '0.0524', 'NDCG@5': '0.0366', 'HR@10': '0.0757', 'NDCG@10': '0.0441', 'HR@20': '0.1057', 'NDCG@20': '0.0517'}
2025-02-23 20:49:19,941 - EarlyStopping counter: 1 out of 10
2025-02-23 20:49:57,472 - {'epoch': 46, 'rec_loss': '7.5955'}
2025-02-23 20:50:13,844 - {'Epoch': 46, 'HR@5': '0.0519', 'NDCG@5': '0.0364', 'HR@10': '0.0755', 'NDCG@10': '0.0440', 'HR@20': '0.1045', 'NDCG@20': '0.0513'}
2025-02-23 20:50:13,846 - EarlyStopping counter: 2 out of 10
2025-02-23 20:50:52,844 - {'epoch': 47, 'rec_loss': '7.5929'}
2025-02-23 20:51:09,994 - {'Epoch': 47, 'HR@5': '0.0526', 'NDCG@5': '0.0369', 'HR@10': '0.0758', 'NDCG@10': '0.0444', 'HR@20': '0.1055', 'NDCG@20': '0.0518'}
2025-02-23 20:51:09,995 - EarlyStopping counter: 3 out of 10
2025-02-23 20:51:47,098 - {'epoch': 48, 'rec_loss': '7.5791'}
2025-02-23 20:52:03,576 - {'Epoch': 48, 'HR@5': '0.0524', 'NDCG@5': '0.0364', 'HR@10': '0.0754', 'NDCG@10': '0.0439', 'HR@20': '0.1050', 'NDCG@20': '0.0513'}
2025-02-23 20:52:03,577 - EarlyStopping counter: 4 out of 10
2025-02-23 20:52:41,518 - {'epoch': 49, 'rec_loss': '7.5764'}
2025-02-23 20:52:58,896 - {'Epoch': 49, 'HR@5': '0.0522', 'NDCG@5': '0.0365', 'HR@10': '0.0762', 'NDCG@10': '0.0442', 'HR@20': '0.1056', 'NDCG@20': '0.0516'}
2025-02-23 20:52:58,897 - EarlyStopping counter: 5 out of 10
2025-02-23 20:53:36,010 - {'epoch': 50, 'rec_loss': '7.5801'}
2025-02-23 20:53:55,109 - {'Epoch': 50, 'HR@5': '0.0516', 'NDCG@5': '0.0363', 'HR@10': '0.0756', 'NDCG@10': '0.0441', 'HR@20': '0.1049', 'NDCG@20': '0.0515'}
2025-02-23 20:53:55,110 - EarlyStopping counter: 6 out of 10
2025-02-23 20:54:35,213 - {'epoch': 51, 'rec_loss': '7.5678'}
2025-02-23 20:54:54,256 - {'Epoch': 51, 'HR@5': '0.0529', 'NDCG@5': '0.0369', 'HR@10': '0.0758', 'NDCG@10': '0.0442', 'HR@20': '0.1050', 'NDCG@20': '0.0516'}
2025-02-23 20:54:54,257 - EarlyStopping counter: 7 out of 10
2025-02-23 20:55:31,844 - {'epoch': 52, 'rec_loss': '7.5660'}
2025-02-23 20:55:50,808 - {'Epoch': 52, 'HR@5': '0.0525', 'NDCG@5': '0.0364', 'HR@10': '0.0756', 'NDCG@10': '0.0438', 'HR@20': '0.1056', 'NDCG@20': '0.0514'}
2025-02-23 20:55:50,809 - EarlyStopping counter: 8 out of 10
2025-02-23 20:56:33,164 - {'epoch': 53, 'rec_loss': '7.5591'}
2025-02-23 20:56:50,534 - {'Epoch': 53, 'HR@5': '0.0526', 'NDCG@5': '0.0368', 'HR@10': '0.0765', 'NDCG@10': '0.0445', 'HR@20': '0.1039', 'NDCG@20': '0.0514'}
2025-02-23 20:56:50,535 - EarlyStopping counter: 9 out of 10
2025-02-23 20:57:31,970 - {'epoch': 54, 'rec_loss': '7.5542'}
2025-02-23 20:57:48,194 - {'Epoch': 54, 'HR@5': '0.0531', 'NDCG@5': '0.0367', 'HR@10': '0.0763', 'NDCG@10': '0.0442', 'HR@20': '0.1054', 'NDCG@20': '0.0515'}
2025-02-23 20:57:48,195 - EarlyStopping counter: 10 out of 10
2025-02-23 20:57:48,195 - Early stopping
2025-02-23 20:57:48,196 - ---------------Test Score---------------
2025-02-23 20:58:06,952 - {'Epoch': 0, 'HR@5': '0.0431', 'NDCG@5': '0.0303', 'HR@10': '0.0624', 'NDCG@10': '0.0364', 'HR@20': '0.0889', 'NDCG@20': '0.0431'}
2025-02-23 20:58:06,954 - Scale_Sports
2025-02-23 20:58:06,954 - {'Epoch': 0, 'HR@5': '0.0431', 'NDCG@5': '0.0303', 'HR@10': '0.0624', 'NDCG@10': '0.0364', 'HR@20': '0.0889', 'NDCG@20': '0.0431'}
2025-02-23 21:20:15,667 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 5], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-23 21:20:18,438 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-23 21:20:18,443 - Total Parameters: 1328529
2025-02-23 21:20:56,871 - {'epoch': 0, 'rec_loss': '9.4045'}
2025-02-23 21:21:13,060 - {'Epoch': 0, 'HR@5': '0.0084', 'NDCG@5': '0.0054', 'HR@10': '0.0127', 'NDCG@10': '0.0067', 'HR@20': '0.0215', 'NDCG@20': '0.0090'}
2025-02-23 21:21:13,061 - Validation score increased.  Saving model ...
2025-02-23 21:21:54,180 - {'epoch': 1, 'rec_loss': '9.1882'}
2025-02-23 21:22:10,015 - {'Epoch': 1, 'HR@5': '0.0166', 'NDCG@5': '0.0105', 'HR@10': '0.0265', 'NDCG@10': '0.0137', 'HR@20': '0.0415', 'NDCG@20': '0.0175'}
2025-02-23 21:22:10,017 - Validation score increased.  Saving model ...
2025-02-23 21:22:47,490 - {'epoch': 2, 'rec_loss': '8.8714'}
2025-02-23 21:23:03,148 - {'Epoch': 2, 'HR@5': '0.0229', 'NDCG@5': '0.0146', 'HR@10': '0.0364', 'NDCG@10': '0.0190', 'HR@20': '0.0580', 'NDCG@20': '0.0244'}
2025-02-23 21:23:03,149 - Validation score increased.  Saving model ...
2025-02-23 21:23:39,791 - {'epoch': 3, 'rec_loss': '8.6523'}
2025-02-23 21:23:57,885 - {'Epoch': 3, 'HR@5': '0.0316', 'NDCG@5': '0.0208', 'HR@10': '0.0486', 'NDCG@10': '0.0262', 'HR@20': '0.0703', 'NDCG@20': '0.0316'}
2025-02-23 21:23:57,888 - Validation score increased.  Saving model ...
2025-02-23 21:24:34,532 - {'epoch': 4, 'rec_loss': '8.4913'}
2025-02-23 21:24:50,538 - {'Epoch': 4, 'HR@5': '0.0361', 'NDCG@5': '0.0245', 'HR@10': '0.0538', 'NDCG@10': '0.0302', 'HR@20': '0.0779', 'NDCG@20': '0.0363'}
2025-02-23 21:24:50,544 - Validation score increased.  Saving model ...
2025-02-23 21:25:28,480 - {'epoch': 5, 'rec_loss': '8.3653'}
2025-02-23 21:25:44,436 - {'Epoch': 5, 'HR@5': '0.0389', 'NDCG@5': '0.0263', 'HR@10': '0.0581', 'NDCG@10': '0.0325', 'HR@20': '0.0840', 'NDCG@20': '0.0391'}
2025-02-23 21:25:44,440 - Validation score increased.  Saving model ...
2025-02-23 21:26:21,255 - {'epoch': 6, 'rec_loss': '8.2594'}
2025-02-23 21:26:38,356 - {'Epoch': 6, 'HR@5': '0.0430', 'NDCG@5': '0.0294', 'HR@10': '0.0618', 'NDCG@10': '0.0355', 'HR@20': '0.0887', 'NDCG@20': '0.0422'}
2025-02-23 21:26:38,361 - Validation score increased.  Saving model ...
2025-02-23 21:27:15,105 - {'epoch': 7, 'rec_loss': '8.1751'}
2025-02-23 21:27:33,387 - {'Epoch': 7, 'HR@5': '0.0432', 'NDCG@5': '0.0299', 'HR@10': '0.0634', 'NDCG@10': '0.0364', 'HR@20': '0.0910', 'NDCG@20': '0.0433'}
2025-02-23 21:27:33,388 - Validation score increased.  Saving model ...
2025-02-23 21:28:10,040 - {'epoch': 8, 'rec_loss': '8.1009'}
2025-02-23 21:28:26,306 - {'Epoch': 8, 'HR@5': '0.0459', 'NDCG@5': '0.0312', 'HR@10': '0.0657', 'NDCG@10': '0.0376', 'HR@20': '0.0931', 'NDCG@20': '0.0445'}
2025-02-23 21:28:26,307 - Validation score increased.  Saving model ...
2025-02-23 21:29:05,282 - {'epoch': 9, 'rec_loss': '8.0472'}
2025-02-23 21:29:23,726 - {'Epoch': 9, 'HR@5': '0.0469', 'NDCG@5': '0.0324', 'HR@10': '0.0672', 'NDCG@10': '0.0389', 'HR@20': '0.0951', 'NDCG@20': '0.0459'}
2025-02-23 21:29:23,728 - Validation score increased.  Saving model ...
2025-02-23 21:30:00,396 - {'epoch': 10, 'rec_loss': '7.9907'}
2025-02-23 21:30:18,962 - {'Epoch': 10, 'HR@5': '0.0470', 'NDCG@5': '0.0320', 'HR@10': '0.0678', 'NDCG@10': '0.0387', 'HR@20': '0.0961', 'NDCG@20': '0.0458'}
2025-02-23 21:30:18,965 - EarlyStopping counter: 1 out of 10
2025-02-23 21:30:55,617 - {'epoch': 11, 'rec_loss': '7.9516'}
2025-02-23 21:31:14,576 - {'Epoch': 11, 'HR@5': '0.0477', 'NDCG@5': '0.0328', 'HR@10': '0.0681', 'NDCG@10': '0.0394', 'HR@20': '0.0964', 'NDCG@20': '0.0465'}
2025-02-23 21:31:14,582 - Validation score increased.  Saving model ...
2025-02-23 21:31:51,180 - {'epoch': 12, 'rec_loss': '7.9072'}
2025-02-23 21:32:09,764 - {'Epoch': 12, 'HR@5': '0.0490', 'NDCG@5': '0.0340', 'HR@10': '0.0699', 'NDCG@10': '0.0407', 'HR@20': '0.0982', 'NDCG@20': '0.0478'}
2025-02-23 21:32:09,770 - Validation score increased.  Saving model ...
2025-02-23 21:32:48,312 - {'epoch': 13, 'rec_loss': '7.8762'}
2025-02-23 21:33:06,989 - {'Epoch': 13, 'HR@5': '0.0500', 'NDCG@5': '0.0344', 'HR@10': '0.0700', 'NDCG@10': '0.0409', 'HR@20': '0.0981', 'NDCG@20': '0.0479'}
2025-02-23 21:33:06,993 - Validation score increased.  Saving model ...
2025-02-23 21:33:43,652 - {'epoch': 14, 'rec_loss': '7.8446'}
2025-02-23 21:34:00,245 - {'Epoch': 14, 'HR@5': '0.0492', 'NDCG@5': '0.0341', 'HR@10': '0.0701', 'NDCG@10': '0.0409', 'HR@20': '0.0996', 'NDCG@20': '0.0482'}
2025-02-23 21:34:00,248 - Validation score increased.  Saving model ...
2025-02-23 21:34:36,901 - {'epoch': 15, 'rec_loss': '7.8225'}
2025-02-23 21:34:55,703 - {'Epoch': 15, 'HR@5': '0.0496', 'NDCG@5': '0.0343', 'HR@10': '0.0715', 'NDCG@10': '0.0413', 'HR@20': '0.1001', 'NDCG@20': '0.0485'}
2025-02-23 21:34:55,706 - Validation score increased.  Saving model ...
2025-02-23 21:35:32,390 - {'epoch': 16, 'rec_loss': '7.7969'}
2025-02-23 21:35:50,896 - {'Epoch': 16, 'HR@5': '0.0500', 'NDCG@5': '0.0345', 'HR@10': '0.0721', 'NDCG@10': '0.0416', 'HR@20': '0.1001', 'NDCG@20': '0.0486'}
2025-02-23 21:35:50,897 - Validation score increased.  Saving model ...
2025-02-23 21:36:27,555 - {'epoch': 17, 'rec_loss': '7.7750'}
2025-02-23 21:36:44,398 - {'Epoch': 17, 'HR@5': '0.0504', 'NDCG@5': '0.0349', 'HR@10': '0.0705', 'NDCG@10': '0.0414', 'HR@20': '0.0997', 'NDCG@20': '0.0488'}
2025-02-23 21:36:44,401 - Validation score increased.  Saving model ...
2025-02-23 21:37:21,176 - {'epoch': 18, 'rec_loss': '7.7593'}
2025-02-23 21:37:38,965 - {'Epoch': 18, 'HR@5': '0.0491', 'NDCG@5': '0.0344', 'HR@10': '0.0708', 'NDCG@10': '0.0414', 'HR@20': '0.1011', 'NDCG@20': '0.0490'}
2025-02-23 21:37:38,966 - Validation score increased.  Saving model ...
2025-02-23 21:38:15,587 - {'epoch': 19, 'rec_loss': '7.7404'}
2025-02-23 21:38:34,354 - {'Epoch': 19, 'HR@5': '0.0506', 'NDCG@5': '0.0354', 'HR@10': '0.0717', 'NDCG@10': '0.0422', 'HR@20': '0.1016', 'NDCG@20': '0.0497'}
2025-02-23 21:38:34,358 - Validation score increased.  Saving model ...
2025-02-23 21:39:11,020 - {'epoch': 20, 'rec_loss': '7.7195'}
2025-02-23 21:39:27,489 - {'Epoch': 20, 'HR@5': '0.0514', 'NDCG@5': '0.0356', 'HR@10': '0.0727', 'NDCG@10': '0.0425', 'HR@20': '0.1025', 'NDCG@20': '0.0499'}
2025-02-23 21:39:27,494 - Validation score increased.  Saving model ...
2025-02-23 21:40:04,212 - {'epoch': 21, 'rec_loss': '7.7068'}
2025-02-23 21:40:20,796 - {'Epoch': 21, 'HR@5': '0.0510', 'NDCG@5': '0.0354', 'HR@10': '0.0734', 'NDCG@10': '0.0426', 'HR@20': '0.1036', 'NDCG@20': '0.0501'}
2025-02-23 21:40:20,797 - Validation score increased.  Saving model ...
2025-02-23 21:40:57,880 - {'epoch': 22, 'rec_loss': '7.6888'}
2025-02-23 21:41:14,252 - {'Epoch': 22, 'HR@5': '0.0511', 'NDCG@5': '0.0355', 'HR@10': '0.0732', 'NDCG@10': '0.0426', 'HR@20': '0.1029', 'NDCG@20': '0.0502'}
2025-02-23 21:41:14,255 - Validation score increased.  Saving model ...
2025-02-23 21:41:51,054 - {'epoch': 23, 'rec_loss': '7.6784'}
2025-02-23 21:42:09,540 - {'Epoch': 23, 'HR@5': '0.0500', 'NDCG@5': '0.0348', 'HR@10': '0.0727', 'NDCG@10': '0.0420', 'HR@20': '0.1025', 'NDCG@20': '0.0496'}
2025-02-23 21:42:09,543 - EarlyStopping counter: 1 out of 10
2025-02-23 21:42:46,217 - {'epoch': 24, 'rec_loss': '7.6706'}
2025-02-23 21:43:05,030 - {'Epoch': 24, 'HR@5': '0.0506', 'NDCG@5': '0.0354', 'HR@10': '0.0738', 'NDCG@10': '0.0428', 'HR@20': '0.1039', 'NDCG@20': '0.0503'}
2025-02-23 21:43:05,034 - Validation score increased.  Saving model ...
2025-02-23 21:43:44,003 - {'epoch': 25, 'rec_loss': '7.6541'}
2025-02-23 21:44:01,128 - {'Epoch': 25, 'HR@5': '0.0508', 'NDCG@5': '0.0356', 'HR@10': '0.0742', 'NDCG@10': '0.0431', 'HR@20': '0.1038', 'NDCG@20': '0.0506'}
2025-02-23 21:44:01,129 - Validation score increased.  Saving model ...
2025-02-23 21:44:38,816 - {'epoch': 26, 'rec_loss': '7.6439'}
2025-02-23 21:44:57,798 - {'Epoch': 26, 'HR@5': '0.0501', 'NDCG@5': '0.0353', 'HR@10': '0.0733', 'NDCG@10': '0.0427', 'HR@20': '0.1032', 'NDCG@20': '0.0503'}
2025-02-23 21:44:57,802 - EarlyStopping counter: 1 out of 10
2025-02-23 21:45:34,414 - {'epoch': 27, 'rec_loss': '7.6352'}
2025-02-23 21:45:50,465 - {'Epoch': 27, 'HR@5': '0.0501', 'NDCG@5': '0.0350', 'HR@10': '0.0733', 'NDCG@10': '0.0425', 'HR@20': '0.1031', 'NDCG@20': '0.0500'}
2025-02-23 21:45:50,473 - EarlyStopping counter: 2 out of 10
2025-02-23 21:46:28,467 - {'epoch': 28, 'rec_loss': '7.6223'}
2025-02-23 21:46:44,868 - {'Epoch': 28, 'HR@5': '0.0516', 'NDCG@5': '0.0357', 'HR@10': '0.0735', 'NDCG@10': '0.0428', 'HR@20': '0.1040', 'NDCG@20': '0.0504'}
2025-02-23 21:46:44,870 - EarlyStopping counter: 3 out of 10
2025-02-23 21:47:21,569 - {'epoch': 29, 'rec_loss': '7.6164'}
2025-02-23 21:47:39,991 - {'Epoch': 29, 'HR@5': '0.0509', 'NDCG@5': '0.0355', 'HR@10': '0.0729', 'NDCG@10': '0.0426', 'HR@20': '0.1034', 'NDCG@20': '0.0503'}
2025-02-23 21:47:39,995 - EarlyStopping counter: 4 out of 10
2025-02-23 21:48:17,485 - {'epoch': 30, 'rec_loss': '7.6056'}
2025-02-23 21:48:34,907 - {'Epoch': 30, 'HR@5': '0.0503', 'NDCG@5': '0.0353', 'HR@10': '0.0737', 'NDCG@10': '0.0429', 'HR@20': '0.1046', 'NDCG@20': '0.0506'}
2025-02-23 21:48:34,910 - Validation score increased.  Saving model ...
2025-02-23 21:49:13,327 - {'epoch': 31, 'rec_loss': '7.5954'}
2025-02-23 21:49:32,486 - {'Epoch': 31, 'HR@5': '0.0508', 'NDCG@5': '0.0352', 'HR@10': '0.0733', 'NDCG@10': '0.0425', 'HR@20': '0.1041', 'NDCG@20': '0.0502'}
2025-02-23 21:49:32,487 - EarlyStopping counter: 1 out of 10
2025-02-23 21:50:12,666 - {'epoch': 32, 'rec_loss': '7.5830'}
2025-02-23 21:50:30,785 - {'Epoch': 32, 'HR@5': '0.0518', 'NDCG@5': '0.0360', 'HR@10': '0.0747', 'NDCG@10': '0.0434', 'HR@20': '0.1048', 'NDCG@20': '0.0510'}
2025-02-23 21:50:30,791 - Validation score increased.  Saving model ...
2025-02-23 21:51:07,730 - {'epoch': 33, 'rec_loss': '7.5825'}
2025-02-23 21:51:26,427 - {'Epoch': 33, 'HR@5': '0.0518', 'NDCG@5': '0.0361', 'HR@10': '0.0736', 'NDCG@10': '0.0431', 'HR@20': '0.1041', 'NDCG@20': '0.0508'}
2025-02-23 21:51:26,432 - EarlyStopping counter: 1 out of 10
2025-02-23 21:52:03,112 - {'epoch': 34, 'rec_loss': '7.5731'}
2025-02-23 21:52:21,420 - {'Epoch': 34, 'HR@5': '0.0510', 'NDCG@5': '0.0358', 'HR@10': '0.0728', 'NDCG@10': '0.0428', 'HR@20': '0.1030', 'NDCG@20': '0.0504'}
2025-02-23 21:52:21,426 - EarlyStopping counter: 2 out of 10
2025-02-23 21:53:00,865 - {'epoch': 35, 'rec_loss': '7.5666'}
2025-02-23 21:53:18,167 - {'Epoch': 35, 'HR@5': '0.0514', 'NDCG@5': '0.0360', 'HR@10': '0.0734', 'NDCG@10': '0.0430', 'HR@20': '0.1038', 'NDCG@20': '0.0507'}
2025-02-23 21:53:18,170 - EarlyStopping counter: 3 out of 10
2025-02-23 21:53:55,316 - {'epoch': 36, 'rec_loss': '7.5557'}
2025-02-23 21:54:11,903 - {'Epoch': 36, 'HR@5': '0.0517', 'NDCG@5': '0.0359', 'HR@10': '0.0737', 'NDCG@10': '0.0430', 'HR@20': '0.1035', 'NDCG@20': '0.0505'}
2025-02-23 21:54:11,905 - EarlyStopping counter: 4 out of 10
2025-02-23 21:54:52,593 - {'epoch': 37, 'rec_loss': '7.5493'}
2025-02-23 21:55:09,249 - {'Epoch': 37, 'HR@5': '0.0521', 'NDCG@5': '0.0364', 'HR@10': '0.0743', 'NDCG@10': '0.0436', 'HR@20': '0.1049', 'NDCG@20': '0.0513'}
2025-02-23 21:55:09,251 - Validation score increased.  Saving model ...
2025-02-23 21:55:45,956 - {'epoch': 38, 'rec_loss': '7.5455'}
2025-02-23 21:56:02,800 - {'Epoch': 38, 'HR@5': '0.0510', 'NDCG@5': '0.0356', 'HR@10': '0.0733', 'NDCG@10': '0.0428', 'HR@20': '0.1035', 'NDCG@20': '0.0504'}
2025-02-23 21:56:02,802 - EarlyStopping counter: 1 out of 10
2025-02-23 21:56:40,050 - {'epoch': 39, 'rec_loss': '7.5412'}
2025-02-23 21:56:58,090 - {'Epoch': 39, 'HR@5': '0.0517', 'NDCG@5': '0.0360', 'HR@10': '0.0737', 'NDCG@10': '0.0431', 'HR@20': '0.1057', 'NDCG@20': '0.0511'}
2025-02-23 21:56:58,092 - EarlyStopping counter: 2 out of 10
2025-02-23 21:57:35,555 - {'epoch': 40, 'rec_loss': '7.5279'}
2025-02-23 21:57:54,428 - {'Epoch': 40, 'HR@5': '0.0515', 'NDCG@5': '0.0358', 'HR@10': '0.0748', 'NDCG@10': '0.0433', 'HR@20': '0.1053', 'NDCG@20': '0.0510'}
2025-02-23 21:57:54,434 - EarlyStopping counter: 3 out of 10
2025-02-23 21:58:31,094 - {'epoch': 41, 'rec_loss': '7.5258'}
2025-02-23 21:58:49,466 - {'Epoch': 41, 'HR@5': '0.0524', 'NDCG@5': '0.0366', 'HR@10': '0.0753', 'NDCG@10': '0.0440', 'HR@20': '0.1055', 'NDCG@20': '0.0516'}
2025-02-23 21:58:49,467 - Validation score increased.  Saving model ...
2025-02-23 21:59:26,503 - {'epoch': 42, 'rec_loss': '7.5156'}
2025-02-23 21:59:44,374 - {'Epoch': 42, 'HR@5': '0.0527', 'NDCG@5': '0.0363', 'HR@10': '0.0740', 'NDCG@10': '0.0431', 'HR@20': '0.1030', 'NDCG@20': '0.0505'}
2025-02-23 21:59:44,375 - EarlyStopping counter: 1 out of 10
2025-02-23 22:00:21,789 - {'epoch': 43, 'rec_loss': '7.5142'}
2025-02-23 22:00:40,724 - {'Epoch': 43, 'HR@5': '0.0535', 'NDCG@5': '0.0369', 'HR@10': '0.0752', 'NDCG@10': '0.0439', 'HR@20': '0.1068', 'NDCG@20': '0.0518'}
2025-02-23 22:00:40,731 - Validation score increased.  Saving model ...
2025-02-23 22:01:17,387 - {'epoch': 44, 'rec_loss': '7.5077'}
2025-02-23 22:01:35,900 - {'Epoch': 44, 'HR@5': '0.0528', 'NDCG@5': '0.0362', 'HR@10': '0.0757', 'NDCG@10': '0.0436', 'HR@20': '0.1050', 'NDCG@20': '0.0509'}
2025-02-23 22:01:35,907 - EarlyStopping counter: 1 out of 10
2025-02-23 22:02:12,651 - {'epoch': 45, 'rec_loss': '7.5030'}
2025-02-23 22:02:29,219 - {'Epoch': 45, 'HR@5': '0.0523', 'NDCG@5': '0.0361', 'HR@10': '0.0743', 'NDCG@10': '0.0432', 'HR@20': '0.1041', 'NDCG@20': '0.0507'}
2025-02-23 22:02:29,223 - EarlyStopping counter: 2 out of 10
2025-02-23 22:03:05,801 - {'epoch': 46, 'rec_loss': '7.4966'}
2025-02-23 22:03:24,708 - {'Epoch': 46, 'HR@5': '0.0511', 'NDCG@5': '0.0357', 'HR@10': '0.0745', 'NDCG@10': '0.0432', 'HR@20': '0.1042', 'NDCG@20': '0.0507'}
2025-02-23 22:03:24,712 - EarlyStopping counter: 3 out of 10
2025-02-23 22:04:02,664 - {'epoch': 47, 'rec_loss': '7.4919'}
2025-02-23 22:04:21,450 - {'Epoch': 47, 'HR@5': '0.0515', 'NDCG@5': '0.0359', 'HR@10': '0.0750', 'NDCG@10': '0.0435', 'HR@20': '0.1055', 'NDCG@20': '0.0511'}
2025-02-23 22:04:21,452 - EarlyStopping counter: 4 out of 10
2025-02-23 22:04:59,409 - {'epoch': 48, 'rec_loss': '7.4870'}
2025-02-23 22:05:16,849 - {'Epoch': 48, 'HR@5': '0.0526', 'NDCG@5': '0.0363', 'HR@10': '0.0752', 'NDCG@10': '0.0436', 'HR@20': '0.1061', 'NDCG@20': '0.0514'}
2025-02-23 22:05:16,852 - EarlyStopping counter: 5 out of 10
2025-02-23 22:05:53,429 - {'epoch': 49, 'rec_loss': '7.4881'}
2025-02-23 22:06:11,348 - {'Epoch': 49, 'HR@5': '0.0520', 'NDCG@5': '0.0361', 'HR@10': '0.0746', 'NDCG@10': '0.0433', 'HR@20': '0.1037', 'NDCG@20': '0.0506'}
2025-02-23 22:06:11,349 - EarlyStopping counter: 6 out of 10
2025-02-23 22:06:48,074 - {'epoch': 50, 'rec_loss': '7.4760'}
2025-02-23 22:07:04,743 - {'Epoch': 50, 'HR@5': '0.0514', 'NDCG@5': '0.0359', 'HR@10': '0.0738', 'NDCG@10': '0.0430', 'HR@20': '0.1042', 'NDCG@20': '0.0507'}
2025-02-23 22:07:04,744 - EarlyStopping counter: 7 out of 10
2025-02-23 22:07:44,442 - {'epoch': 51, 'rec_loss': '7.4761'}
2025-02-23 22:08:00,903 - {'Epoch': 51, 'HR@5': '0.0514', 'NDCG@5': '0.0360', 'HR@10': '0.0733', 'NDCG@10': '0.0431', 'HR@20': '0.1044', 'NDCG@20': '0.0508'}
2025-02-23 22:08:00,909 - EarlyStopping counter: 8 out of 10
2025-02-23 22:08:38,085 - {'epoch': 52, 'rec_loss': '7.4707'}
2025-02-23 22:08:56,257 - {'Epoch': 52, 'HR@5': '0.0521', 'NDCG@5': '0.0361', 'HR@10': '0.0748', 'NDCG@10': '0.0434', 'HR@20': '0.1062', 'NDCG@20': '0.0512'}
2025-02-23 22:08:56,261 - EarlyStopping counter: 9 out of 10
2025-02-23 22:09:33,027 - {'epoch': 53, 'rec_loss': '7.4698'}
2025-02-23 22:09:49,549 - {'Epoch': 53, 'HR@5': '0.0510', 'NDCG@5': '0.0356', 'HR@10': '0.0731', 'NDCG@10': '0.0427', 'HR@20': '0.1030', 'NDCG@20': '0.0502'}
2025-02-23 22:09:49,550 - EarlyStopping counter: 10 out of 10
2025-02-23 22:09:49,550 - Early stopping
2025-02-23 22:09:49,550 - ---------------Test Score---------------
2025-02-23 22:10:06,352 - {'Epoch': 0, 'HR@5': '0.0433', 'NDCG@5': '0.0301', 'HR@10': '0.0627', 'NDCG@10': '0.0363', 'HR@20': '0.0880', 'NDCG@20': '0.0427'}
2025-02-23 22:10:06,353 - Scale_Sports
2025-02-23 22:10:06,353 - {'Epoch': 0, 'HR@5': '0.0433', 'NDCG@5': '0.0301', 'HR@10': '0.0627', 'NDCG@10': '0.0363', 'HR@20': '0.0880', 'NDCG@20': '0.0427'}
2025-02-23 22:18:06,107 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[4, 8, 12], start_prob=0.3, end_prob=0.7, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-23 22:18:08,923 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-23 22:18:08,928 - Total Parameters: 1328854
2025-02-23 22:18:49,892 - {'epoch': 0, 'rec_loss': '9.4024'}
2025-02-23 22:19:06,962 - {'Epoch': 0, 'HR@5': '0.0083', 'NDCG@5': '0.0054', 'HR@10': '0.0130', 'NDCG@10': '0.0069', 'HR@20': '0.0215', 'NDCG@20': '0.0090'}
2025-02-23 22:19:06,963 - Validation score increased.  Saving model ...
2025-02-23 22:19:47,709 - {'epoch': 1, 'rec_loss': '9.2112'}
2025-02-23 22:20:05,741 - {'Epoch': 1, 'HR@5': '0.0133', 'NDCG@5': '0.0084', 'HR@10': '0.0218', 'NDCG@10': '0.0111', 'HR@20': '0.0372', 'NDCG@20': '0.0150'}
2025-02-23 22:20:05,742 - Validation score increased.  Saving model ...
2025-02-23 22:20:47,275 - {'epoch': 2, 'rec_loss': '8.9655'}
2025-02-23 22:21:05,364 - {'Epoch': 2, 'HR@5': '0.0172', 'NDCG@5': '0.0117', 'HR@10': '0.0287', 'NDCG@10': '0.0153', 'HR@20': '0.0469', 'NDCG@20': '0.0199'}
2025-02-23 22:21:05,366 - Validation score increased.  Saving model ...
2025-02-23 22:21:45,365 - {'epoch': 3, 'rec_loss': '8.7882'}
2025-02-23 22:22:01,267 - {'Epoch': 3, 'HR@5': '0.0250', 'NDCG@5': '0.0161', 'HR@10': '0.0381', 'NDCG@10': '0.0203', 'HR@20': '0.0603', 'NDCG@20': '0.0259'}
2025-02-23 22:22:01,271 - Validation score increased.  Saving model ...
2025-02-23 22:22:38,954 - {'epoch': 4, 'rec_loss': '8.6477'}
2025-02-23 22:22:57,386 - {'Epoch': 4, 'HR@5': '0.0279', 'NDCG@5': '0.0181', 'HR@10': '0.0439', 'NDCG@10': '0.0233', 'HR@20': '0.0676', 'NDCG@20': '0.0292'}
2025-02-23 22:22:57,388 - Validation score increased.  Saving model ...
2025-02-23 22:23:37,909 - {'epoch': 5, 'rec_loss': '8.5324'}
2025-02-23 22:23:54,147 - {'Epoch': 5, 'HR@5': '0.0339', 'NDCG@5': '0.0223', 'HR@10': '0.0505', 'NDCG@10': '0.0276', 'HR@20': '0.0755', 'NDCG@20': '0.0339'}
2025-02-23 22:23:54,149 - Validation score increased.  Saving model ...
2025-02-23 22:24:34,492 - {'epoch': 6, 'rec_loss': '8.4461'}
2025-02-23 22:24:52,951 - {'Epoch': 6, 'HR@5': '0.0374', 'NDCG@5': '0.0248', 'HR@10': '0.0539', 'NDCG@10': '0.0301', 'HR@20': '0.0795', 'NDCG@20': '0.0364'}
2025-02-23 22:24:52,952 - Validation score increased.  Saving model ...
2025-02-23 22:25:34,958 - {'epoch': 7, 'rec_loss': '8.3700'}
2025-02-23 22:25:51,223 - {'Epoch': 7, 'HR@5': '0.0392', 'NDCG@5': '0.0265', 'HR@10': '0.0567', 'NDCG@10': '0.0321', 'HR@20': '0.0830', 'NDCG@20': '0.0387'}
2025-02-23 22:25:51,224 - Validation score increased.  Saving model ...
2025-02-23 22:26:29,806 - {'epoch': 8, 'rec_loss': '8.3045'}
2025-02-23 22:26:45,773 - {'Epoch': 8, 'HR@5': '0.0415', 'NDCG@5': '0.0285', 'HR@10': '0.0587', 'NDCG@10': '0.0340', 'HR@20': '0.0857', 'NDCG@20': '0.0408'}
2025-02-23 22:26:45,774 - Validation score increased.  Saving model ...
2025-02-23 22:27:23,817 - {'epoch': 9, 'rec_loss': '8.2483'}
2025-02-23 22:27:41,234 - {'Epoch': 9, 'HR@5': '0.0427', 'NDCG@5': '0.0289', 'HR@10': '0.0610', 'NDCG@10': '0.0348', 'HR@20': '0.0891', 'NDCG@20': '0.0419'}
2025-02-23 22:27:41,235 - Validation score increased.  Saving model ...
2025-02-23 22:28:21,852 - {'epoch': 10, 'rec_loss': '8.2039'}
2025-02-23 22:28:40,331 - {'Epoch': 10, 'HR@5': '0.0440', 'NDCG@5': '0.0302', 'HR@10': '0.0633', 'NDCG@10': '0.0364', 'HR@20': '0.0900', 'NDCG@20': '0.0431'}
2025-02-23 22:28:40,332 - Validation score increased.  Saving model ...
2025-02-23 22:29:18,409 - {'epoch': 11, 'rec_loss': '8.1579'}
2025-02-23 22:29:34,364 - {'Epoch': 11, 'HR@5': '0.0445', 'NDCG@5': '0.0307', 'HR@10': '0.0655', 'NDCG@10': '0.0374', 'HR@20': '0.0921', 'NDCG@20': '0.0441'}
2025-02-23 22:29:34,366 - Validation score increased.  Saving model ...
2025-02-23 22:30:16,107 - {'epoch': 12, 'rec_loss': '8.1224'}
2025-02-23 22:30:33,988 - {'Epoch': 12, 'HR@5': '0.0458', 'NDCG@5': '0.0318', 'HR@10': '0.0660', 'NDCG@10': '0.0383', 'HR@20': '0.0940', 'NDCG@20': '0.0453'}
2025-02-23 22:30:33,989 - Validation score increased.  Saving model ...
2025-02-23 22:31:16,387 - {'epoch': 13, 'rec_loss': '8.0906'}
2025-02-23 22:31:33,326 - {'Epoch': 13, 'HR@5': '0.0462', 'NDCG@5': '0.0318', 'HR@10': '0.0677', 'NDCG@10': '0.0387', 'HR@20': '0.0973', 'NDCG@20': '0.0461'}
2025-02-23 22:31:33,327 - Validation score increased.  Saving model ...
2025-02-23 22:32:12,771 - {'epoch': 14, 'rec_loss': '8.0616'}
2025-02-23 22:32:31,375 - {'Epoch': 14, 'HR@5': '0.0481', 'NDCG@5': '0.0330', 'HR@10': '0.0677', 'NDCG@10': '0.0393', 'HR@20': '0.0973', 'NDCG@20': '0.0468'}
2025-02-23 22:32:31,377 - Validation score increased.  Saving model ...
2025-02-23 22:33:10,902 - {'epoch': 15, 'rec_loss': '8.0335'}
2025-02-23 22:33:29,546 - {'Epoch': 15, 'HR@5': '0.0477', 'NDCG@5': '0.0330', 'HR@10': '0.0690', 'NDCG@10': '0.0399', 'HR@20': '0.0983', 'NDCG@20': '0.0472'}
2025-02-23 22:33:29,548 - Validation score increased.  Saving model ...
2025-02-23 22:34:07,491 - {'epoch': 16, 'rec_loss': '8.0105'}
2025-02-23 22:34:23,864 - {'Epoch': 16, 'HR@5': '0.0482', 'NDCG@5': '0.0335', 'HR@10': '0.0685', 'NDCG@10': '0.0400', 'HR@20': '0.0990', 'NDCG@20': '0.0476'}
2025-02-23 22:34:23,865 - Validation score increased.  Saving model ...
2025-02-23 22:35:03,589 - {'epoch': 17, 'rec_loss': '7.9887'}
2025-02-23 22:35:21,274 - {'Epoch': 17, 'HR@5': '0.0483', 'NDCG@5': '0.0339', 'HR@10': '0.0686', 'NDCG@10': '0.0404', 'HR@20': '0.0990', 'NDCG@20': '0.0481'}
2025-02-23 22:35:21,277 - Validation score increased.  Saving model ...
2025-02-23 22:35:58,852 - {'epoch': 18, 'rec_loss': '7.9674'}
2025-02-23 22:36:16,226 - {'Epoch': 18, 'HR@5': '0.0495', 'NDCG@5': '0.0344', 'HR@10': '0.0711', 'NDCG@10': '0.0414', 'HR@20': '0.1015', 'NDCG@20': '0.0490'}
2025-02-23 22:36:16,227 - Validation score increased.  Saving model ...
2025-02-23 22:36:53,613 - {'epoch': 19, 'rec_loss': '7.9450'}
2025-02-23 22:37:11,878 - {'Epoch': 19, 'HR@5': '0.0489', 'NDCG@5': '0.0343', 'HR@10': '0.0709', 'NDCG@10': '0.0414', 'HR@20': '0.0999', 'NDCG@20': '0.0487'}
2025-02-23 22:37:11,880 - EarlyStopping counter: 1 out of 10
2025-02-23 22:37:49,139 - {'epoch': 20, 'rec_loss': '7.9273'}
2025-02-23 22:38:05,723 - {'Epoch': 20, 'HR@5': '0.0505', 'NDCG@5': '0.0351', 'HR@10': '0.0726', 'NDCG@10': '0.0422', 'HR@20': '0.1021', 'NDCG@20': '0.0496'}
2025-02-23 22:38:05,724 - Validation score increased.  Saving model ...
2025-02-23 22:38:43,605 - {'epoch': 21, 'rec_loss': '7.9067'}
2025-02-23 22:39:00,173 - {'Epoch': 21, 'HR@5': '0.0492', 'NDCG@5': '0.0340', 'HR@10': '0.0722', 'NDCG@10': '0.0414', 'HR@20': '0.1012', 'NDCG@20': '0.0487'}
2025-02-23 22:39:00,174 - EarlyStopping counter: 1 out of 10
2025-02-23 22:39:38,369 - {'epoch': 22, 'rec_loss': '7.8952'}
2025-02-23 22:39:57,145 - {'Epoch': 22, 'HR@5': '0.0490', 'NDCG@5': '0.0343', 'HR@10': '0.0714', 'NDCG@10': '0.0415', 'HR@20': '0.1017', 'NDCG@20': '0.0491'}
2025-02-23 22:39:57,146 - EarlyStopping counter: 2 out of 10
2025-02-23 22:40:35,527 - {'epoch': 23, 'rec_loss': '7.8788'}
2025-02-23 22:40:52,849 - {'Epoch': 23, 'HR@5': '0.0502', 'NDCG@5': '0.0347', 'HR@10': '0.0730', 'NDCG@10': '0.0420', 'HR@20': '0.1032', 'NDCG@20': '0.0495'}
2025-02-23 22:40:52,850 - EarlyStopping counter: 3 out of 10
2025-02-23 22:41:34,847 - {'epoch': 24, 'rec_loss': '7.8653'}
2025-02-23 22:41:51,537 - {'Epoch': 24, 'HR@5': '0.0502', 'NDCG@5': '0.0347', 'HR@10': '0.0733', 'NDCG@10': '0.0422', 'HR@20': '0.1036', 'NDCG@20': '0.0498'}
2025-02-23 22:41:51,539 - Validation score increased.  Saving model ...
2025-02-23 22:42:33,396 - {'epoch': 25, 'rec_loss': '7.8495'}
2025-02-23 22:42:49,724 - {'Epoch': 25, 'HR@5': '0.0511', 'NDCG@5': '0.0353', 'HR@10': '0.0746', 'NDCG@10': '0.0428', 'HR@20': '0.1043', 'NDCG@20': '0.0503'}
2025-02-23 22:42:49,725 - Validation score increased.  Saving model ...
2025-02-23 22:43:31,208 - {'epoch': 26, 'rec_loss': '7.8367'}
2025-02-23 22:43:50,161 - {'Epoch': 26, 'HR@5': '0.0526', 'NDCG@5': '0.0363', 'HR@10': '0.0745', 'NDCG@10': '0.0434', 'HR@20': '0.1035', 'NDCG@20': '0.0506'}
2025-02-23 22:43:50,162 - Validation score increased.  Saving model ...
2025-02-23 22:44:35,555 - {'epoch': 27, 'rec_loss': '7.8249'}
2025-02-23 22:44:54,477 - {'Epoch': 27, 'HR@5': '0.0520', 'NDCG@5': '0.0357', 'HR@10': '0.0734', 'NDCG@10': '0.0426', 'HR@20': '0.1027', 'NDCG@20': '0.0500'}
2025-02-23 22:44:54,478 - EarlyStopping counter: 1 out of 10
2025-02-23 22:45:37,408 - {'epoch': 28, 'rec_loss': '7.8155'}
2025-02-23 22:45:53,833 - {'Epoch': 28, 'HR@5': '0.0515', 'NDCG@5': '0.0359', 'HR@10': '0.0746', 'NDCG@10': '0.0433', 'HR@20': '0.1033', 'NDCG@20': '0.0505'}
2025-02-23 22:45:53,834 - EarlyStopping counter: 2 out of 10
2025-02-23 22:46:35,410 - {'epoch': 29, 'rec_loss': '7.8043'}
2025-02-23 22:46:52,022 - {'Epoch': 29, 'HR@5': '0.0521', 'NDCG@5': '0.0359', 'HR@10': '0.0741', 'NDCG@10': '0.0430', 'HR@20': '0.1048', 'NDCG@20': '0.0507'}
2025-02-23 22:46:52,023 - Validation score increased.  Saving model ...
2025-02-23 22:47:35,691 - {'epoch': 30, 'rec_loss': '7.7950'}
2025-02-23 22:47:53,772 - {'Epoch': 30, 'HR@5': '0.0521', 'NDCG@5': '0.0361', 'HR@10': '0.0749', 'NDCG@10': '0.0435', 'HR@20': '0.1038', 'NDCG@20': '0.0507'}
2025-02-23 22:47:53,774 - Validation score increased.  Saving model ...
2025-02-23 22:48:35,048 - {'epoch': 31, 'rec_loss': '7.7875'}
2025-02-23 22:48:53,252 - {'Epoch': 31, 'HR@5': '0.0522', 'NDCG@5': '0.0362', 'HR@10': '0.0746', 'NDCG@10': '0.0434', 'HR@20': '0.1052', 'NDCG@20': '0.0511'}
2025-02-23 22:48:53,253 - Validation score increased.  Saving model ...
2025-02-23 22:49:33,133 - {'epoch': 32, 'rec_loss': '7.7788'}
2025-02-23 22:49:50,020 - {'Epoch': 32, 'HR@5': '0.0523', 'NDCG@5': '0.0360', 'HR@10': '0.0748', 'NDCG@10': '0.0432', 'HR@20': '0.1046', 'NDCG@20': '0.0507'}
2025-02-23 22:49:50,022 - EarlyStopping counter: 1 out of 10
2025-02-23 22:50:31,211 - {'epoch': 33, 'rec_loss': '7.7662'}
2025-02-23 22:50:47,947 - {'Epoch': 33, 'HR@5': '0.0527', 'NDCG@5': '0.0367', 'HR@10': '0.0753', 'NDCG@10': '0.0440', 'HR@20': '0.1052', 'NDCG@20': '0.0516'}
2025-02-23 22:50:47,948 - Validation score increased.  Saving model ...
2025-02-23 22:51:28,667 - {'epoch': 34, 'rec_loss': '7.7676'}
2025-02-23 22:51:45,342 - {'Epoch': 34, 'HR@5': '0.0525', 'NDCG@5': '0.0362', 'HR@10': '0.0751', 'NDCG@10': '0.0435', 'HR@20': '0.1054', 'NDCG@20': '0.0510'}
2025-02-23 22:51:45,344 - EarlyStopping counter: 1 out of 10
2025-02-23 22:52:26,413 - {'epoch': 35, 'rec_loss': '7.7535'}
2025-02-23 22:52:42,608 - {'Epoch': 35, 'HR@5': '0.0529', 'NDCG@5': '0.0363', 'HR@10': '0.0758', 'NDCG@10': '0.0437', 'HR@20': '0.1063', 'NDCG@20': '0.0513'}
2025-02-23 22:52:42,610 - EarlyStopping counter: 2 out of 10
2025-02-23 22:53:24,072 - {'epoch': 36, 'rec_loss': '7.7443'}
2025-02-23 22:53:40,541 - {'Epoch': 36, 'HR@5': '0.0521', 'NDCG@5': '0.0366', 'HR@10': '0.0754', 'NDCG@10': '0.0441', 'HR@20': '0.1053', 'NDCG@20': '0.0517'}
2025-02-23 22:53:40,542 - Validation score increased.  Saving model ...
2025-02-23 22:54:19,537 - {'epoch': 37, 'rec_loss': '7.7386'}
2025-02-23 22:54:37,528 - {'Epoch': 37, 'HR@5': '0.0523', 'NDCG@5': '0.0362', 'HR@10': '0.0750', 'NDCG@10': '0.0435', 'HR@20': '0.1058', 'NDCG@20': '0.0512'}
2025-02-23 22:54:37,529 - EarlyStopping counter: 1 out of 10
2025-02-23 22:55:14,915 - {'epoch': 38, 'rec_loss': '7.7244'}
2025-02-23 22:55:33,774 - {'Epoch': 38, 'HR@5': '0.0528', 'NDCG@5': '0.0366', 'HR@10': '0.0752', 'NDCG@10': '0.0438', 'HR@20': '0.1066', 'NDCG@20': '0.0517'}
2025-02-23 22:55:33,775 - EarlyStopping counter: 2 out of 10
2025-02-23 22:56:11,047 - {'epoch': 39, 'rec_loss': '7.7251'}
2025-02-23 22:56:27,740 - {'Epoch': 39, 'HR@5': '0.0522', 'NDCG@5': '0.0366', 'HR@10': '0.0749', 'NDCG@10': '0.0440', 'HR@20': '0.1057', 'NDCG@20': '0.0517'}
2025-02-23 22:56:27,742 - Validation score increased.  Saving model ...
2025-02-23 22:57:06,275 - {'epoch': 40, 'rec_loss': '7.7155'}
2025-02-23 22:57:24,522 - {'Epoch': 40, 'HR@5': '0.0522', 'NDCG@5': '0.0364', 'HR@10': '0.0745', 'NDCG@10': '0.0437', 'HR@20': '0.1049', 'NDCG@20': '0.0513'}
2025-02-23 22:57:24,524 - EarlyStopping counter: 1 out of 10
2025-02-23 22:58:02,711 - {'epoch': 41, 'rec_loss': '7.7042'}
2025-02-23 22:58:19,816 - {'Epoch': 41, 'HR@5': '0.0524', 'NDCG@5': '0.0364', 'HR@10': '0.0744', 'NDCG@10': '0.0435', 'HR@20': '0.1056', 'NDCG@20': '0.0514'}
2025-02-23 22:58:19,817 - EarlyStopping counter: 2 out of 10
2025-02-23 22:58:57,651 - {'epoch': 42, 'rec_loss': '7.7033'}
2025-02-23 22:59:13,935 - {'Epoch': 42, 'HR@5': '0.0527', 'NDCG@5': '0.0367', 'HR@10': '0.0757', 'NDCG@10': '0.0441', 'HR@20': '0.1057', 'NDCG@20': '0.0516'}
2025-02-23 22:59:13,936 - EarlyStopping counter: 3 out of 10
2025-02-23 22:59:52,265 - {'epoch': 43, 'rec_loss': '7.7015'}
2025-02-23 23:00:11,200 - {'Epoch': 43, 'HR@5': '0.0518', 'NDCG@5': '0.0359', 'HR@10': '0.0755', 'NDCG@10': '0.0435', 'HR@20': '0.1053', 'NDCG@20': '0.0510'}
2025-02-23 23:00:11,201 - EarlyStopping counter: 4 out of 10
2025-02-23 23:00:48,580 - {'epoch': 44, 'rec_loss': '7.6928'}
2025-02-23 23:01:05,161 - {'Epoch': 44, 'HR@5': '0.0540', 'NDCG@5': '0.0370', 'HR@10': '0.0759', 'NDCG@10': '0.0441', 'HR@20': '0.1064', 'NDCG@20': '0.0518'}
2025-02-23 23:01:05,165 - Validation score increased.  Saving model ...
2025-02-23 23:01:45,485 - {'epoch': 45, 'rec_loss': '7.6900'}
2025-02-23 23:02:03,231 - {'Epoch': 45, 'HR@5': '0.0523', 'NDCG@5': '0.0365', 'HR@10': '0.0755', 'NDCG@10': '0.0440', 'HR@20': '0.1064', 'NDCG@20': '0.0518'}
2025-02-23 23:02:03,232 - Validation score increased.  Saving model ...
2025-02-23 23:02:40,526 - {'epoch': 46, 'rec_loss': '7.6877'}
2025-02-23 23:02:58,580 - {'Epoch': 46, 'HR@5': '0.0524', 'NDCG@5': '0.0364', 'HR@10': '0.0755', 'NDCG@10': '0.0438', 'HR@20': '0.1058', 'NDCG@20': '0.0514'}
2025-02-23 23:02:58,581 - EarlyStopping counter: 1 out of 10
2025-02-23 23:03:36,532 - {'epoch': 47, 'rec_loss': '7.6832'}
2025-02-23 23:03:54,956 - {'Epoch': 47, 'HR@5': '0.0526', 'NDCG@5': '0.0366', 'HR@10': '0.0759', 'NDCG@10': '0.0442', 'HR@20': '0.1068', 'NDCG@20': '0.0519'}
2025-02-23 23:03:54,957 - Validation score increased.  Saving model ...
2025-02-23 23:04:33,882 - {'epoch': 48, 'rec_loss': '7.6723'}
2025-02-23 23:04:53,510 - {'Epoch': 48, 'HR@5': '0.0526', 'NDCG@5': '0.0363', 'HR@10': '0.0763', 'NDCG@10': '0.0439', 'HR@20': '0.1065', 'NDCG@20': '0.0515'}
2025-02-23 23:04:53,511 - EarlyStopping counter: 1 out of 10
2025-02-23 23:05:30,757 - {'epoch': 49, 'rec_loss': '7.6713'}
2025-02-23 23:05:48,601 - {'Epoch': 49, 'HR@5': '0.0523', 'NDCG@5': '0.0365', 'HR@10': '0.0761', 'NDCG@10': '0.0442', 'HR@20': '0.1062', 'NDCG@20': '0.0518'}
2025-02-23 23:05:48,602 - EarlyStopping counter: 2 out of 10
2025-02-23 23:06:25,886 - {'epoch': 50, 'rec_loss': '7.6750'}
2025-02-23 23:06:44,902 - {'Epoch': 50, 'HR@5': '0.0526', 'NDCG@5': '0.0364', 'HR@10': '0.0759', 'NDCG@10': '0.0439', 'HR@20': '0.1057', 'NDCG@20': '0.0514'}
2025-02-23 23:06:44,904 - EarlyStopping counter: 3 out of 10
2025-02-23 23:07:22,511 - {'epoch': 51, 'rec_loss': '7.6633'}
2025-02-23 23:07:41,381 - {'Epoch': 51, 'HR@5': '0.0522', 'NDCG@5': '0.0362', 'HR@10': '0.0756', 'NDCG@10': '0.0437', 'HR@20': '0.1051', 'NDCG@20': '0.0512'}
2025-02-23 23:07:41,382 - EarlyStopping counter: 4 out of 10
2025-02-23 23:08:18,651 - {'epoch': 52, 'rec_loss': '7.6588'}
2025-02-23 23:08:36,205 - {'Epoch': 52, 'HR@5': '0.0523', 'NDCG@5': '0.0363', 'HR@10': '0.0757', 'NDCG@10': '0.0439', 'HR@20': '0.1055', 'NDCG@20': '0.0514'}
2025-02-23 23:08:36,206 - EarlyStopping counter: 5 out of 10
2025-02-23 23:09:13,499 - {'epoch': 53, 'rec_loss': '7.6544'}
2025-02-23 23:09:32,387 - {'Epoch': 53, 'HR@5': '0.0534', 'NDCG@5': '0.0371', 'HR@10': '0.0758', 'NDCG@10': '0.0443', 'HR@20': '0.1055', 'NDCG@20': '0.0517'}
2025-02-23 23:09:32,388 - EarlyStopping counter: 6 out of 10
2025-02-23 23:10:13,414 - {'epoch': 54, 'rec_loss': '7.6504'}
2025-02-23 23:10:31,841 - {'Epoch': 54, 'HR@5': '0.0529', 'NDCG@5': '0.0365', 'HR@10': '0.0761', 'NDCG@10': '0.0439', 'HR@20': '0.1058', 'NDCG@20': '0.0514'}
2025-02-23 23:10:31,843 - EarlyStopping counter: 7 out of 10
2025-02-23 23:11:09,094 - {'epoch': 55, 'rec_loss': '7.6431'}
2025-02-23 23:11:28,130 - {'Epoch': 55, 'HR@5': '0.0527', 'NDCG@5': '0.0367', 'HR@10': '0.0772', 'NDCG@10': '0.0446', 'HR@20': '0.1056', 'NDCG@20': '0.0518'}
2025-02-23 23:11:28,132 - EarlyStopping counter: 8 out of 10
2025-02-23 23:12:06,976 - {'epoch': 56, 'rec_loss': '7.6414'}
2025-02-23 23:12:25,717 - {'Epoch': 56, 'HR@5': '0.0522', 'NDCG@5': '0.0362', 'HR@10': '0.0759', 'NDCG@10': '0.0439', 'HR@20': '0.1056', 'NDCG@20': '0.0514'}
2025-02-23 23:12:25,718 - EarlyStopping counter: 9 out of 10
2025-02-23 23:13:03,586 - {'epoch': 57, 'rec_loss': '7.6379'}
2025-02-23 23:13:23,542 - {'Epoch': 57, 'HR@5': '0.0521', 'NDCG@5': '0.0360', 'HR@10': '0.0744', 'NDCG@10': '0.0432', 'HR@20': '0.1049', 'NDCG@20': '0.0509'}
2025-02-23 23:13:23,545 - EarlyStopping counter: 10 out of 10
2025-02-23 23:13:23,545 - Early stopping
2025-02-23 23:13:23,545 - ---------------Test Score---------------
2025-02-23 23:13:40,290 - {'Epoch': 0, 'HR@5': '0.0420', 'NDCG@5': '0.0292', 'HR@10': '0.0615', 'NDCG@10': '0.0355', 'HR@20': '0.0875', 'NDCG@20': '0.0420'}
2025-02-23 23:13:40,291 - Scale_Sports
2025-02-23 23:13:40,291 - {'Epoch': 0, 'HR@5': '0.0420', 'NDCG@5': '0.0292', 'HR@10': '0.0615', 'NDCG@10': '0.0355', 'HR@20': '0.0875', 'NDCG@20': '0.0420'}
2025-02-23 23:20:25,915 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[4, 8, 12], start_prob=0.3, end_prob=0.5, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-23 23:20:28,650 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-23 23:20:28,655 - Total Parameters: 1328854
2025-02-23 23:21:11,323 - {'epoch': 0, 'rec_loss': '9.4023'}
2025-02-23 23:21:27,723 - {'Epoch': 0, 'HR@5': '0.0083', 'NDCG@5': '0.0055', 'HR@10': '0.0127', 'NDCG@10': '0.0069', 'HR@20': '0.0216', 'NDCG@20': '0.0091'}
2025-02-23 23:21:27,728 - Validation score increased.  Saving model ...
2025-02-23 23:22:06,704 - {'epoch': 1, 'rec_loss': '9.1912'}
2025-02-23 23:22:23,986 - {'Epoch': 1, 'HR@5': '0.0142', 'NDCG@5': '0.0090', 'HR@10': '0.0247', 'NDCG@10': '0.0123', 'HR@20': '0.0412', 'NDCG@20': '0.0165'}
2025-02-23 23:22:23,987 - Validation score increased.  Saving model ...
2025-02-23 23:23:01,757 - {'epoch': 2, 'rec_loss': '8.9151'}
2025-02-23 23:23:19,573 - {'Epoch': 2, 'HR@5': '0.0189', 'NDCG@5': '0.0123', 'HR@10': '0.0319', 'NDCG@10': '0.0165', 'HR@20': '0.0498', 'NDCG@20': '0.0210'}
2025-02-23 23:23:19,575 - Validation score increased.  Saving model ...
2025-02-23 23:23:56,761 - {'epoch': 3, 'rec_loss': '8.7121'}
2025-02-23 23:24:12,928 - {'Epoch': 3, 'HR@5': '0.0279', 'NDCG@5': '0.0180', 'HR@10': '0.0425', 'NDCG@10': '0.0227', 'HR@20': '0.0657', 'NDCG@20': '0.0285'}
2025-02-23 23:24:12,929 - Validation score increased.  Saving model ...
2025-02-23 23:24:49,974 - {'epoch': 4, 'rec_loss': '8.5553'}
2025-02-23 23:25:05,955 - {'Epoch': 4, 'HR@5': '0.0323', 'NDCG@5': '0.0211', 'HR@10': '0.0498', 'NDCG@10': '0.0267', 'HR@20': '0.0746', 'NDCG@20': '0.0329'}
2025-02-23 23:25:05,957 - Validation score increased.  Saving model ...
2025-02-23 23:25:42,928 - {'epoch': 5, 'rec_loss': '8.4252'}
2025-02-23 23:26:01,382 - {'Epoch': 5, 'HR@5': '0.0387', 'NDCG@5': '0.0255', 'HR@10': '0.0555', 'NDCG@10': '0.0309', 'HR@20': '0.0812', 'NDCG@20': '0.0374'}
2025-02-23 23:26:01,384 - Validation score increased.  Saving model ...
2025-02-23 23:26:38,266 - {'epoch': 6, 'rec_loss': '8.3289'}
2025-02-23 23:26:55,235 - {'Epoch': 6, 'HR@5': '0.0396', 'NDCG@5': '0.0268', 'HR@10': '0.0592', 'NDCG@10': '0.0331', 'HR@20': '0.0856', 'NDCG@20': '0.0397'}
2025-02-23 23:26:55,236 - Validation score increased.  Saving model ...
2025-02-23 23:27:32,222 - {'epoch': 7, 'rec_loss': '8.2459'}
2025-02-23 23:27:50,881 - {'Epoch': 7, 'HR@5': '0.0419', 'NDCG@5': '0.0287', 'HR@10': '0.0615', 'NDCG@10': '0.0350', 'HR@20': '0.0896', 'NDCG@20': '0.0420'}
2025-02-23 23:27:50,882 - Validation score increased.  Saving model ...
2025-02-23 23:28:29,625 - {'epoch': 8, 'rec_loss': '8.1755'}
2025-02-23 23:28:48,136 - {'Epoch': 8, 'HR@5': '0.0444', 'NDCG@5': '0.0305', 'HR@10': '0.0632', 'NDCG@10': '0.0366', 'HR@20': '0.0913', 'NDCG@20': '0.0436'}
2025-02-23 23:28:48,137 - Validation score increased.  Saving model ...
2025-02-23 23:29:25,017 - {'epoch': 9, 'rec_loss': '8.1173'}
2025-02-23 23:29:43,586 - {'Epoch': 9, 'HR@5': '0.0448', 'NDCG@5': '0.0311', 'HR@10': '0.0657', 'NDCG@10': '0.0378', 'HR@20': '0.0929', 'NDCG@20': '0.0447'}
2025-02-23 23:29:43,587 - Validation score increased.  Saving model ...
2025-02-23 23:30:20,422 - {'epoch': 10, 'rec_loss': '8.0711'}
2025-02-23 23:30:36,940 - {'Epoch': 10, 'HR@5': '0.0456', 'NDCG@5': '0.0316', 'HR@10': '0.0666', 'NDCG@10': '0.0383', 'HR@20': '0.0948', 'NDCG@20': '0.0453'}
2025-02-23 23:30:36,941 - Validation score increased.  Saving model ...
2025-02-23 23:31:14,007 - {'epoch': 11, 'rec_loss': '8.0238'}
2025-02-23 23:31:32,642 - {'Epoch': 11, 'HR@5': '0.0466', 'NDCG@5': '0.0322', 'HR@10': '0.0676', 'NDCG@10': '0.0390', 'HR@20': '0.0961', 'NDCG@20': '0.0461'}
2025-02-23 23:31:32,643 - Validation score increased.  Saving model ...
2025-02-23 23:32:11,271 - {'epoch': 12, 'rec_loss': '7.9883'}
2025-02-23 23:32:27,807 - {'Epoch': 12, 'HR@5': '0.0473', 'NDCG@5': '0.0330', 'HR@10': '0.0684', 'NDCG@10': '0.0398', 'HR@20': '0.0981', 'NDCG@20': '0.0473'}
2025-02-23 23:32:27,808 - Validation score increased.  Saving model ...
2025-02-23 23:33:07,400 - {'epoch': 13, 'rec_loss': '7.9575'}
2025-02-23 23:33:26,041 - {'Epoch': 13, 'HR@5': '0.0467', 'NDCG@5': '0.0328', 'HR@10': '0.0691', 'NDCG@10': '0.0400', 'HR@20': '0.0990', 'NDCG@20': '0.0475'}
2025-02-23 23:33:26,045 - Validation score increased.  Saving model ...
2025-02-23 23:34:02,911 - {'epoch': 14, 'rec_loss': '7.9286'}
2025-02-23 23:34:21,534 - {'Epoch': 14, 'HR@5': '0.0482', 'NDCG@5': '0.0335', 'HR@10': '0.0696', 'NDCG@10': '0.0404', 'HR@20': '0.0996', 'NDCG@20': '0.0480'}
2025-02-23 23:34:21,535 - Validation score increased.  Saving model ...
2025-02-23 23:34:58,492 - {'epoch': 15, 'rec_loss': '7.9024'}
2025-02-23 23:35:14,539 - {'Epoch': 15, 'HR@5': '0.0488', 'NDCG@5': '0.0339', 'HR@10': '0.0695', 'NDCG@10': '0.0406', 'HR@20': '0.0999', 'NDCG@20': '0.0482'}
2025-02-23 23:35:14,540 - Validation score increased.  Saving model ...
2025-02-23 23:35:51,469 - {'epoch': 16, 'rec_loss': '7.8786'}
2025-02-23 23:36:07,854 - {'Epoch': 16, 'HR@5': '0.0489', 'NDCG@5': '0.0341', 'HR@10': '0.0703', 'NDCG@10': '0.0410', 'HR@20': '0.1012', 'NDCG@20': '0.0488'}
2025-02-23 23:36:07,856 - Validation score increased.  Saving model ...
2025-02-23 23:36:44,832 - {'epoch': 17, 'rec_loss': '7.8598'}
2025-02-23 23:37:03,595 - {'Epoch': 17, 'HR@5': '0.0496', 'NDCG@5': '0.0345', 'HR@10': '0.0704', 'NDCG@10': '0.0413', 'HR@20': '0.1006', 'NDCG@20': '0.0489'}
2025-02-23 23:37:03,596 - Validation score increased.  Saving model ...
2025-02-23 23:37:40,488 - {'epoch': 18, 'rec_loss': '7.8373'}
2025-02-23 23:37:59,184 - {'Epoch': 18, 'HR@5': '0.0495', 'NDCG@5': '0.0344', 'HR@10': '0.0715', 'NDCG@10': '0.0415', 'HR@20': '0.1021', 'NDCG@20': '0.0492'}
2025-02-23 23:37:59,185 - Validation score increased.  Saving model ...
2025-02-23 23:38:37,844 - {'epoch': 19, 'rec_loss': '7.8187'}
2025-02-23 23:38:54,240 - {'Epoch': 19, 'HR@5': '0.0503', 'NDCG@5': '0.0349', 'HR@10': '0.0717', 'NDCG@10': '0.0418', 'HR@20': '0.1027', 'NDCG@20': '0.0495'}
2025-02-23 23:38:54,242 - Validation score increased.  Saving model ...
2025-02-23 23:39:31,201 - {'epoch': 20, 'rec_loss': '7.8051'}
2025-02-23 23:39:47,457 - {'Epoch': 20, 'HR@5': '0.0505', 'NDCG@5': '0.0351', 'HR@10': '0.0735', 'NDCG@10': '0.0425', 'HR@20': '0.1036', 'NDCG@20': '0.0501'}
2025-02-23 23:39:47,458 - Validation score increased.  Saving model ...
2025-02-23 23:40:24,640 - {'epoch': 21, 'rec_loss': '7.7813'}
2025-02-23 23:40:41,031 - {'Epoch': 21, 'HR@5': '0.0497', 'NDCG@5': '0.0339', 'HR@10': '0.0710', 'NDCG@10': '0.0408', 'HR@20': '0.1030', 'NDCG@20': '0.0489'}
2025-02-23 23:40:41,032 - EarlyStopping counter: 1 out of 10
2025-02-23 23:41:19,552 - {'epoch': 22, 'rec_loss': '7.7719'}
2025-02-23 23:41:36,133 - {'Epoch': 22, 'HR@5': '0.0510', 'NDCG@5': '0.0351', 'HR@10': '0.0730', 'NDCG@10': '0.0421', 'HR@20': '0.1032', 'NDCG@20': '0.0497'}
2025-02-23 23:41:36,134 - EarlyStopping counter: 2 out of 10
2025-02-23 23:42:14,253 - {'epoch': 23, 'rec_loss': '7.7577'}
2025-02-23 23:42:30,483 - {'Epoch': 23, 'HR@5': '0.0506', 'NDCG@5': '0.0346', 'HR@10': '0.0727', 'NDCG@10': '0.0417', 'HR@20': '0.1018', 'NDCG@20': '0.0490'}
2025-02-23 23:42:30,484 - EarlyStopping counter: 3 out of 10
2025-02-23 23:43:10,121 - {'epoch': 24, 'rec_loss': '7.7420'}
2025-02-23 23:43:27,609 - {'Epoch': 24, 'HR@5': '0.0511', 'NDCG@5': '0.0357', 'HR@10': '0.0742', 'NDCG@10': '0.0431', 'HR@20': '0.1044', 'NDCG@20': '0.0507'}
2025-02-23 23:43:27,610 - Validation score increased.  Saving model ...
2025-02-23 23:44:04,629 - {'epoch': 25, 'rec_loss': '7.7252'}
2025-02-23 23:44:21,201 - {'Epoch': 25, 'HR@5': '0.0506', 'NDCG@5': '0.0353', 'HR@10': '0.0737', 'NDCG@10': '0.0427', 'HR@20': '0.1046', 'NDCG@20': '0.0505'}
2025-02-23 23:44:21,202 - EarlyStopping counter: 1 out of 10
2025-02-23 23:44:59,692 - {'epoch': 26, 'rec_loss': '7.7157'}
2025-02-23 23:45:18,750 - {'Epoch': 26, 'HR@5': '0.0512', 'NDCG@5': '0.0356', 'HR@10': '0.0732', 'NDCG@10': '0.0428', 'HR@20': '0.1035', 'NDCG@20': '0.0504'}
2025-02-23 23:45:18,751 - EarlyStopping counter: 2 out of 10
2025-02-23 23:45:55,579 - {'epoch': 27, 'rec_loss': '7.6988'}
2025-02-23 23:46:14,348 - {'Epoch': 27, 'HR@5': '0.0520', 'NDCG@5': '0.0356', 'HR@10': '0.0745', 'NDCG@10': '0.0428', 'HR@20': '0.1039', 'NDCG@20': '0.0502'}
2025-02-23 23:46:14,349 - EarlyStopping counter: 3 out of 10
2025-02-23 23:46:51,171 - {'epoch': 28, 'rec_loss': '7.6965'}
2025-02-23 23:47:07,278 - {'Epoch': 28, 'HR@5': '0.0517', 'NDCG@5': '0.0359', 'HR@10': '0.0742', 'NDCG@10': '0.0431', 'HR@20': '0.1041', 'NDCG@20': '0.0506'}
2025-02-23 23:47:07,283 - EarlyStopping counter: 4 out of 10
2025-02-23 23:47:45,293 - {'epoch': 29, 'rec_loss': '7.6860'}
2025-02-23 23:48:02,496 - {'Epoch': 29, 'HR@5': '0.0514', 'NDCG@5': '0.0357', 'HR@10': '0.0747', 'NDCG@10': '0.0432', 'HR@20': '0.1046', 'NDCG@20': '0.0507'}
2025-02-23 23:48:02,497 - EarlyStopping counter: 5 out of 10
2025-02-23 23:48:40,332 - {'epoch': 30, 'rec_loss': '7.6739'}
2025-02-23 23:48:59,326 - {'Epoch': 30, 'HR@5': '0.0515', 'NDCG@5': '0.0357', 'HR@10': '0.0744', 'NDCG@10': '0.0431', 'HR@20': '0.1039', 'NDCG@20': '0.0505'}
2025-02-23 23:48:59,328 - EarlyStopping counter: 6 out of 10
2025-02-23 23:49:36,627 - {'epoch': 31, 'rec_loss': '7.6629'}
2025-02-23 23:49:53,304 - {'Epoch': 31, 'HR@5': '0.0512', 'NDCG@5': '0.0356', 'HR@10': '0.0739', 'NDCG@10': '0.0429', 'HR@20': '0.1049', 'NDCG@20': '0.0507'}
2025-02-23 23:49:53,305 - EarlyStopping counter: 7 out of 10
2025-02-23 23:50:33,607 - {'epoch': 32, 'rec_loss': '7.6512'}
2025-02-23 23:50:52,150 - {'Epoch': 32, 'HR@5': '0.0515', 'NDCG@5': '0.0355', 'HR@10': '0.0748', 'NDCG@10': '0.0430', 'HR@20': '0.1049', 'NDCG@20': '0.0505'}
2025-02-23 23:50:52,152 - EarlyStopping counter: 8 out of 10
2025-02-23 23:51:29,725 - {'epoch': 33, 'rec_loss': '7.6424'}
2025-02-23 23:51:46,630 - {'Epoch': 33, 'HR@5': '0.0521', 'NDCG@5': '0.0362', 'HR@10': '0.0748', 'NDCG@10': '0.0436', 'HR@20': '0.1067', 'NDCG@20': '0.0516'}
2025-02-23 23:51:46,631 - Validation score increased.  Saving model ...
2025-02-23 23:52:23,540 - {'epoch': 34, 'rec_loss': '7.6427'}
2025-02-23 23:52:42,655 - {'Epoch': 34, 'HR@5': '0.0519', 'NDCG@5': '0.0360', 'HR@10': '0.0737', 'NDCG@10': '0.0430', 'HR@20': '0.1046', 'NDCG@20': '0.0507'}
2025-02-23 23:52:42,656 - EarlyStopping counter: 1 out of 10
2025-02-23 23:53:19,662 - {'epoch': 35, 'rec_loss': '7.6278'}
2025-02-23 23:53:36,231 - {'Epoch': 35, 'HR@5': '0.0518', 'NDCG@5': '0.0363', 'HR@10': '0.0761', 'NDCG@10': '0.0441', 'HR@20': '0.1065', 'NDCG@20': '0.0517'}
2025-02-23 23:53:36,232 - Validation score increased.  Saving model ...
2025-02-23 23:54:13,102 - {'epoch': 36, 'rec_loss': '7.6256'}
2025-02-23 23:54:32,020 - {'Epoch': 36, 'HR@5': '0.0513', 'NDCG@5': '0.0356', 'HR@10': '0.0750', 'NDCG@10': '0.0433', 'HR@20': '0.1052', 'NDCG@20': '0.0509'}
2025-02-23 23:54:32,021 - EarlyStopping counter: 1 out of 10
2025-02-23 23:55:08,900 - {'epoch': 37, 'rec_loss': '7.6140'}
2025-02-23 23:55:26,232 - {'Epoch': 37, 'HR@5': '0.0516', 'NDCG@5': '0.0362', 'HR@10': '0.0754', 'NDCG@10': '0.0438', 'HR@20': '0.1053', 'NDCG@20': '0.0513'}
2025-02-23 23:55:26,233 - EarlyStopping counter: 2 out of 10
2025-02-23 23:56:03,032 - {'epoch': 38, 'rec_loss': '7.6036'}
2025-02-23 23:56:20,457 - {'Epoch': 38, 'HR@5': '0.0529', 'NDCG@5': '0.0366', 'HR@10': '0.0755', 'NDCG@10': '0.0439', 'HR@20': '0.1059', 'NDCG@20': '0.0515'}
2025-02-23 23:56:20,458 - EarlyStopping counter: 3 out of 10
2025-02-23 23:56:57,232 - {'epoch': 39, 'rec_loss': '7.5965'}
2025-02-23 23:57:13,822 - {'Epoch': 39, 'HR@5': '0.0530', 'NDCG@5': '0.0365', 'HR@10': '0.0762', 'NDCG@10': '0.0439', 'HR@20': '0.1053', 'NDCG@20': '0.0513'}
2025-02-23 23:57:13,824 - EarlyStopping counter: 4 out of 10
2025-02-23 23:57:50,800 - {'epoch': 40, 'rec_loss': '7.5917'}
2025-02-23 23:58:07,276 - {'Epoch': 40, 'HR@5': '0.0524', 'NDCG@5': '0.0366', 'HR@10': '0.0758', 'NDCG@10': '0.0442', 'HR@20': '0.1049', 'NDCG@20': '0.0515'}
2025-02-23 23:58:07,278 - EarlyStopping counter: 5 out of 10
2025-02-23 23:58:44,098 - {'epoch': 41, 'rec_loss': '7.5827'}
2025-02-23 23:59:00,686 - {'Epoch': 41, 'HR@5': '0.0512', 'NDCG@5': '0.0357', 'HR@10': '0.0754', 'NDCG@10': '0.0435', 'HR@20': '0.1054', 'NDCG@20': '0.0510'}
2025-02-23 23:59:00,687 - EarlyStopping counter: 6 out of 10
2025-02-23 23:59:37,540 - {'epoch': 42, 'rec_loss': '7.5781'}
2025-02-23 23:59:56,636 - {'Epoch': 42, 'HR@5': '0.0524', 'NDCG@5': '0.0363', 'HR@10': '0.0758', 'NDCG@10': '0.0438', 'HR@20': '0.1062', 'NDCG@20': '0.0515'}
2025-02-23 23:59:56,638 - EarlyStopping counter: 7 out of 10
2025-02-24 00:00:33,494 - {'epoch': 43, 'rec_loss': '7.5743'}
2025-02-24 00:00:52,368 - {'Epoch': 43, 'HR@5': '0.0525', 'NDCG@5': '0.0361', 'HR@10': '0.0758', 'NDCG@10': '0.0436', 'HR@20': '0.1065', 'NDCG@20': '0.0513'}
2025-02-24 00:00:52,369 - EarlyStopping counter: 8 out of 10
2025-02-24 00:01:30,419 - {'epoch': 44, 'rec_loss': '7.5695'}
2025-02-24 00:01:46,737 - {'Epoch': 44, 'HR@5': '0.0523', 'NDCG@5': '0.0361', 'HR@10': '0.0767', 'NDCG@10': '0.0440', 'HR@20': '0.1072', 'NDCG@20': '0.0516'}
2025-02-24 00:01:46,738 - EarlyStopping counter: 9 out of 10
2025-02-24 00:02:23,618 - {'epoch': 45, 'rec_loss': '7.5656'}
2025-02-24 00:02:42,481 - {'Epoch': 45, 'HR@5': '0.0524', 'NDCG@5': '0.0362', 'HR@10': '0.0754', 'NDCG@10': '0.0436', 'HR@20': '0.1069', 'NDCG@20': '0.0516'}
2025-02-24 00:02:42,482 - EarlyStopping counter: 10 out of 10
2025-02-24 00:02:42,482 - Early stopping
2025-02-24 00:02:42,482 - ---------------Test Score---------------
2025-02-24 00:02:59,126 - {'Epoch': 0, 'HR@5': '0.0431', 'NDCG@5': '0.0299', 'HR@10': '0.0621', 'NDCG@10': '0.0360', 'HR@20': '0.0883', 'NDCG@20': '0.0426'}
2025-02-24 00:02:59,127 - Scale_Sports
2025-02-24 00:02:59,127 - {'Epoch': 0, 'HR@5': '0.0431', 'NDCG@5': '0.0299', 'HR@10': '0.0621', 'NDCG@10': '0.0360', 'HR@20': '0.0883', 'NDCG@20': '0.0426'}
2025-02-24 00:15:02,831 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 5], kernels=[4, 8, 12], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-24 00:15:05,673 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-24 00:15:05,678 - Total Parameters: 1328529
2025-02-24 00:15:44,735 - {'epoch': 0, 'rec_loss': '9.4036'}
2025-02-24 00:16:00,971 - {'Epoch': 0, 'HR@5': '0.0084', 'NDCG@5': '0.0054', 'HR@10': '0.0126', 'NDCG@10': '0.0067', 'HR@20': '0.0217', 'NDCG@20': '0.0090'}
2025-02-24 00:16:00,973 - Validation score increased.  Saving model ...
2025-02-24 00:16:41,100 - {'epoch': 1, 'rec_loss': '9.2142'}
2025-02-24 00:16:58,873 - {'Epoch': 1, 'HR@5': '0.0154', 'NDCG@5': '0.0098', 'HR@10': '0.0252', 'NDCG@10': '0.0129', 'HR@20': '0.0390', 'NDCG@20': '0.0164'}
2025-02-24 00:16:58,874 - Validation score increased.  Saving model ...
2025-02-24 00:17:38,088 - {'epoch': 2, 'rec_loss': '8.9404'}
2025-02-24 00:17:53,918 - {'Epoch': 2, 'HR@5': '0.0188', 'NDCG@5': '0.0124', 'HR@10': '0.0317', 'NDCG@10': '0.0165', 'HR@20': '0.0523', 'NDCG@20': '0.0217'}
2025-02-24 00:17:53,919 - Validation score increased.  Saving model ...
2025-02-24 00:18:34,317 - {'epoch': 3, 'rec_loss': '8.7448'}
2025-02-24 00:18:49,787 - {'Epoch': 3, 'HR@5': '0.0273', 'NDCG@5': '0.0178', 'HR@10': '0.0418', 'NDCG@10': '0.0225', 'HR@20': '0.0641', 'NDCG@20': '0.0281'}
2025-02-24 00:18:49,788 - Validation score increased.  Saving model ...
2025-02-24 00:19:30,157 - {'epoch': 4, 'rec_loss': '8.5959'}
2025-02-24 00:19:47,109 - {'Epoch': 4, 'HR@5': '0.0312', 'NDCG@5': '0.0207', 'HR@10': '0.0479', 'NDCG@10': '0.0261', 'HR@20': '0.0724', 'NDCG@20': '0.0322'}
2025-02-24 00:19:47,113 - Validation score increased.  Saving model ...
2025-02-24 00:20:27,971 - {'epoch': 5, 'rec_loss': '8.4792'}
2025-02-24 00:20:44,756 - {'Epoch': 5, 'HR@5': '0.0358', 'NDCG@5': '0.0237', 'HR@10': '0.0539', 'NDCG@10': '0.0295', 'HR@20': '0.0791', 'NDCG@20': '0.0358'}
2025-02-24 00:20:44,759 - Validation score increased.  Saving model ...
2025-02-24 00:21:28,901 - {'epoch': 6, 'rec_loss': '8.3831'}
2025-02-24 00:21:44,692 - {'Epoch': 6, 'HR@5': '0.0395', 'NDCG@5': '0.0266', 'HR@10': '0.0580', 'NDCG@10': '0.0326', 'HR@20': '0.0836', 'NDCG@20': '0.0390'}
2025-02-24 00:21:44,695 - Validation score increased.  Saving model ...
2025-02-24 00:22:25,694 - {'epoch': 7, 'rec_loss': '8.3055'}
2025-02-24 00:22:41,606 - {'Epoch': 7, 'HR@5': '0.0399', 'NDCG@5': '0.0273', 'HR@10': '0.0603', 'NDCG@10': '0.0339', 'HR@20': '0.0879', 'NDCG@20': '0.0408'}
2025-02-24 00:22:41,608 - Validation score increased.  Saving model ...
2025-02-24 00:23:23,624 - {'epoch': 8, 'rec_loss': '8.2340'}
2025-02-24 00:23:39,620 - {'Epoch': 8, 'HR@5': '0.0429', 'NDCG@5': '0.0294', 'HR@10': '0.0620', 'NDCG@10': '0.0355', 'HR@20': '0.0905', 'NDCG@20': '0.0427'}
2025-02-24 00:23:39,621 - Validation score increased.  Saving model ...
2025-02-24 00:24:21,421 - {'epoch': 9, 'rec_loss': '8.1850'}
2025-02-24 00:24:37,209 - {'Epoch': 9, 'HR@5': '0.0447', 'NDCG@5': '0.0309', 'HR@10': '0.0640', 'NDCG@10': '0.0371', 'HR@20': '0.0927', 'NDCG@20': '0.0443'}
2025-02-24 00:24:37,215 - Validation score increased.  Saving model ...
2025-02-24 00:25:18,359 - {'epoch': 10, 'rec_loss': '8.1288'}
2025-02-24 00:25:34,536 - {'Epoch': 10, 'HR@5': '0.0451', 'NDCG@5': '0.0307', 'HR@10': '0.0663', 'NDCG@10': '0.0375', 'HR@20': '0.0935', 'NDCG@20': '0.0444'}
2025-02-24 00:25:34,537 - Validation score increased.  Saving model ...
2025-02-24 00:26:17,358 - {'epoch': 11, 'rec_loss': '8.0899'}
2025-02-24 00:26:33,736 - {'Epoch': 11, 'HR@5': '0.0456', 'NDCG@5': '0.0315', 'HR@10': '0.0672', 'NDCG@10': '0.0384', 'HR@20': '0.0955', 'NDCG@20': '0.0455'}
2025-02-24 00:26:33,737 - Validation score increased.  Saving model ...
2025-02-24 00:27:17,147 - {'epoch': 12, 'rec_loss': '8.0502'}
2025-02-24 00:27:33,343 - {'Epoch': 12, 'HR@5': '0.0471', 'NDCG@5': '0.0328', 'HR@10': '0.0688', 'NDCG@10': '0.0397', 'HR@20': '0.0967', 'NDCG@20': '0.0467'}
2025-02-24 00:27:33,347 - Validation score increased.  Saving model ...
2025-02-24 00:28:13,621 - {'epoch': 13, 'rec_loss': '8.0168'}
2025-02-24 00:28:29,772 - {'Epoch': 13, 'HR@5': '0.0479', 'NDCG@5': '0.0333', 'HR@10': '0.0684', 'NDCG@10': '0.0399', 'HR@20': '0.0970', 'NDCG@20': '0.0471'}
2025-02-24 00:28:29,773 - Validation score increased.  Saving model ...
2025-02-24 00:29:10,953 - {'epoch': 14, 'rec_loss': '7.9816'}
2025-02-24 00:29:27,491 - {'Epoch': 14, 'HR@5': '0.0484', 'NDCG@5': '0.0335', 'HR@10': '0.0691', 'NDCG@10': '0.0402', 'HR@20': '0.0987', 'NDCG@20': '0.0477'}
2025-02-24 00:29:27,493 - Validation score increased.  Saving model ...
2025-02-24 00:30:08,914 - {'epoch': 15, 'rec_loss': '7.9589'}
2025-02-24 00:30:25,112 - {'Epoch': 15, 'HR@5': '0.0480', 'NDCG@5': '0.0334', 'HR@10': '0.0699', 'NDCG@10': '0.0404', 'HR@20': '0.0997', 'NDCG@20': '0.0479'}
2025-02-24 00:30:25,116 - Validation score increased.  Saving model ...
2025-02-24 00:31:08,478 - {'epoch': 16, 'rec_loss': '7.9348'}
2025-02-24 00:31:25,765 - {'Epoch': 16, 'HR@5': '0.0493', 'NDCG@5': '0.0344', 'HR@10': '0.0702', 'NDCG@10': '0.0411', 'HR@20': '0.1008', 'NDCG@20': '0.0487'}
2025-02-24 00:31:25,766 - Validation score increased.  Saving model ...
2025-02-24 00:32:06,933 - {'epoch': 17, 'rec_loss': '7.9076'}
2025-02-24 00:32:23,225 - {'Epoch': 17, 'HR@5': '0.0502', 'NDCG@5': '0.0353', 'HR@10': '0.0705', 'NDCG@10': '0.0418', 'HR@20': '0.1003', 'NDCG@20': '0.0493'}
2025-02-24 00:32:23,226 - Validation score increased.  Saving model ...
2025-02-24 00:33:04,412 - {'epoch': 18, 'rec_loss': '7.8934'}
2025-02-24 00:33:20,807 - {'Epoch': 18, 'HR@5': '0.0492', 'NDCG@5': '0.0345', 'HR@10': '0.0702', 'NDCG@10': '0.0412', 'HR@20': '0.1012', 'NDCG@20': '0.0490'}
2025-02-24 00:33:20,808 - EarlyStopping counter: 1 out of 10
2025-02-24 00:34:00,826 - {'epoch': 19, 'rec_loss': '7.8746'}
2025-02-24 00:34:17,135 - {'Epoch': 19, 'HR@5': '0.0497', 'NDCG@5': '0.0348', 'HR@10': '0.0713', 'NDCG@10': '0.0418', 'HR@20': '0.1009', 'NDCG@20': '0.0492'}
2025-02-24 00:34:17,136 - EarlyStopping counter: 2 out of 10
2025-02-24 00:34:58,097 - {'epoch': 20, 'rec_loss': '7.8533'}
2025-02-24 00:35:14,852 - {'Epoch': 20, 'HR@5': '0.0505', 'NDCG@5': '0.0351', 'HR@10': '0.0716', 'NDCG@10': '0.0419', 'HR@20': '0.1014', 'NDCG@20': '0.0494'}
2025-02-24 00:35:14,853 - Validation score increased.  Saving model ...
2025-02-24 00:35:58,398 - {'epoch': 21, 'rec_loss': '7.8365'}
2025-02-24 00:36:15,954 - {'Epoch': 21, 'HR@5': '0.0501', 'NDCG@5': '0.0347', 'HR@10': '0.0718', 'NDCG@10': '0.0417', 'HR@20': '0.1031', 'NDCG@20': '0.0495'}
2025-02-24 00:36:15,957 - Validation score increased.  Saving model ...
2025-02-24 00:36:57,307 - {'epoch': 22, 'rec_loss': '7.8197'}
2025-02-24 00:37:14,423 - {'Epoch': 22, 'HR@5': '0.0503', 'NDCG@5': '0.0351', 'HR@10': '0.0731', 'NDCG@10': '0.0424', 'HR@20': '0.1023', 'NDCG@20': '0.0498'}
2025-02-24 00:37:14,424 - Validation score increased.  Saving model ...
2025-02-24 00:37:54,729 - {'epoch': 23, 'rec_loss': '7.8090'}
2025-02-24 00:38:11,217 - {'Epoch': 23, 'HR@5': '0.0489', 'NDCG@5': '0.0342', 'HR@10': '0.0727', 'NDCG@10': '0.0418', 'HR@20': '0.1026', 'NDCG@20': '0.0494'}
2025-02-24 00:38:11,221 - EarlyStopping counter: 1 out of 10
2025-02-24 00:38:52,338 - {'epoch': 24, 'rec_loss': '7.7990'}
2025-02-24 00:39:08,854 - {'Epoch': 24, 'HR@5': '0.0510', 'NDCG@5': '0.0356', 'HR@10': '0.0737', 'NDCG@10': '0.0428', 'HR@20': '0.1046', 'NDCG@20': '0.0506'}
2025-02-24 00:39:08,856 - Validation score increased.  Saving model ...
2025-02-24 00:39:49,591 - {'epoch': 25, 'rec_loss': '7.7832'}
2025-02-24 00:40:06,071 - {'Epoch': 25, 'HR@5': '0.0494', 'NDCG@5': '0.0349', 'HR@10': '0.0740', 'NDCG@10': '0.0427', 'HR@20': '0.1041', 'NDCG@20': '0.0503'}
2025-02-24 00:40:06,072 - EarlyStopping counter: 1 out of 10
2025-02-24 00:40:46,489 - {'epoch': 26, 'rec_loss': '7.7690'}
2025-02-24 00:41:03,307 - {'Epoch': 26, 'HR@5': '0.0494', 'NDCG@5': '0.0349', 'HR@10': '0.0731', 'NDCG@10': '0.0425', 'HR@20': '0.1042', 'NDCG@20': '0.0504'}
2025-02-24 00:41:03,309 - EarlyStopping counter: 2 out of 10
2025-02-24 00:41:44,624 - {'epoch': 27, 'rec_loss': '7.7615'}
2025-02-24 00:42:00,891 - {'Epoch': 27, 'HR@5': '0.0501', 'NDCG@5': '0.0349', 'HR@10': '0.0735', 'NDCG@10': '0.0424', 'HR@20': '0.1037', 'NDCG@20': '0.0500'}
2025-02-24 00:42:00,897 - EarlyStopping counter: 3 out of 10
2025-02-24 00:42:41,859 - {'epoch': 28, 'rec_loss': '7.7471'}
2025-02-24 00:42:58,292 - {'Epoch': 28, 'HR@5': '0.0507', 'NDCG@5': '0.0353', 'HR@10': '0.0743', 'NDCG@10': '0.0429', 'HR@20': '0.1046', 'NDCG@20': '0.0505'}
2025-02-24 00:42:58,294 - EarlyStopping counter: 4 out of 10
2025-02-24 00:43:38,283 - {'epoch': 29, 'rec_loss': '7.7385'}
2025-02-24 00:43:54,542 - {'Epoch': 29, 'HR@5': '0.0509', 'NDCG@5': '0.0353', 'HR@10': '0.0733', 'NDCG@10': '0.0425', 'HR@20': '0.1038', 'NDCG@20': '0.0502'}
2025-02-24 00:43:54,543 - EarlyStopping counter: 5 out of 10
2025-02-24 00:44:35,625 - {'epoch': 30, 'rec_loss': '7.7286'}
2025-02-24 00:44:52,080 - {'Epoch': 30, 'HR@5': '0.0510', 'NDCG@5': '0.0355', 'HR@10': '0.0742', 'NDCG@10': '0.0429', 'HR@20': '0.1045', 'NDCG@20': '0.0505'}
2025-02-24 00:44:52,081 - EarlyStopping counter: 6 out of 10
2025-02-24 00:45:32,620 - {'epoch': 31, 'rec_loss': '7.7169'}
2025-02-24 00:45:48,577 - {'Epoch': 31, 'HR@5': '0.0505', 'NDCG@5': '0.0352', 'HR@10': '0.0735', 'NDCG@10': '0.0426', 'HR@20': '0.1042', 'NDCG@20': '0.0503'}
2025-02-24 00:45:48,580 - EarlyStopping counter: 7 out of 10
2025-02-24 00:46:29,127 - {'epoch': 32, 'rec_loss': '7.7081'}
2025-02-24 00:46:45,650 - {'Epoch': 32, 'HR@5': '0.0521', 'NDCG@5': '0.0362', 'HR@10': '0.0741', 'NDCG@10': '0.0433', 'HR@20': '0.1050', 'NDCG@20': '0.0511'}
2025-02-24 00:46:45,653 - Validation score increased.  Saving model ...
2025-02-24 00:47:26,425 - {'epoch': 33, 'rec_loss': '7.7076'}
2025-02-24 00:47:42,747 - {'Epoch': 33, 'HR@5': '0.0512', 'NDCG@5': '0.0358', 'HR@10': '0.0744', 'NDCG@10': '0.0433', 'HR@20': '0.1047', 'NDCG@20': '0.0509'}
2025-02-24 00:47:42,748 - EarlyStopping counter: 1 out of 10
2025-02-24 00:48:22,795 - {'epoch': 34, 'rec_loss': '7.6939'}
2025-02-24 00:48:39,154 - {'Epoch': 34, 'HR@5': '0.0511', 'NDCG@5': '0.0357', 'HR@10': '0.0736', 'NDCG@10': '0.0429', 'HR@20': '0.1036', 'NDCG@20': '0.0504'}
2025-02-24 00:48:39,158 - EarlyStopping counter: 2 out of 10
2025-02-24 00:49:19,706 - {'epoch': 35, 'rec_loss': '7.6907'}
2025-02-24 00:49:36,262 - {'Epoch': 35, 'HR@5': '0.0516', 'NDCG@5': '0.0364', 'HR@10': '0.0743', 'NDCG@10': '0.0437', 'HR@20': '0.1054', 'NDCG@20': '0.0514'}
2025-02-24 00:49:36,267 - Validation score increased.  Saving model ...
2025-02-24 00:50:17,735 - {'epoch': 36, 'rec_loss': '7.6807'}
2025-02-24 00:50:34,158 - {'Epoch': 36, 'HR@5': '0.0523', 'NDCG@5': '0.0362', 'HR@10': '0.0741', 'NDCG@10': '0.0433', 'HR@20': '0.1056', 'NDCG@20': '0.0512'}
2025-02-24 00:50:34,160 - EarlyStopping counter: 1 out of 10
2025-02-24 00:51:15,314 - {'epoch': 37, 'rec_loss': '7.6727'}
2025-02-24 00:51:31,847 - {'Epoch': 37, 'HR@5': '0.0524', 'NDCG@5': '0.0363', 'HR@10': '0.0747', 'NDCG@10': '0.0435', 'HR@20': '0.1056', 'NDCG@20': '0.0512'}
2025-02-24 00:51:31,851 - EarlyStopping counter: 2 out of 10
2025-02-24 00:52:13,887 - {'epoch': 38, 'rec_loss': '7.6736'}
2025-02-24 00:52:30,833 - {'Epoch': 38, 'HR@5': '0.0520', 'NDCG@5': '0.0362', 'HR@10': '0.0744', 'NDCG@10': '0.0434', 'HR@20': '0.1047', 'NDCG@20': '0.0511'}
2025-02-24 00:52:30,834 - EarlyStopping counter: 3 out of 10
2025-02-24 00:53:10,749 - {'epoch': 39, 'rec_loss': '7.6656'}
2025-02-24 00:53:28,055 - {'Epoch': 39, 'HR@5': '0.0530', 'NDCG@5': '0.0369', 'HR@10': '0.0750', 'NDCG@10': '0.0440', 'HR@20': '0.1068', 'NDCG@20': '0.0520'}
2025-02-24 00:53:28,059 - Validation score increased.  Saving model ...
2025-02-24 00:54:06,991 - {'epoch': 40, 'rec_loss': '7.6535'}
2025-02-24 00:54:24,715 - {'Epoch': 40, 'HR@5': '0.0524', 'NDCG@5': '0.0366', 'HR@10': '0.0744', 'NDCG@10': '0.0437', 'HR@20': '0.1059', 'NDCG@20': '0.0517'}
2025-02-24 00:54:24,721 - EarlyStopping counter: 1 out of 10
2025-02-24 00:55:02,563 - {'epoch': 41, 'rec_loss': '7.6485'}
2025-02-24 00:55:21,109 - {'Epoch': 41, 'HR@5': '0.0528', 'NDCG@5': '0.0369', 'HR@10': '0.0755', 'NDCG@10': '0.0442', 'HR@20': '0.1064', 'NDCG@20': '0.0520'}
2025-02-24 00:55:21,114 - Validation score increased.  Saving model ...
2025-02-24 00:56:03,236 - {'epoch': 42, 'rec_loss': '7.6414'}
2025-02-24 00:56:23,290 - {'Epoch': 42, 'HR@5': '0.0528', 'NDCG@5': '0.0369', 'HR@10': '0.0752', 'NDCG@10': '0.0441', 'HR@20': '0.1063', 'NDCG@20': '0.0519'}
2025-02-24 00:56:23,291 - EarlyStopping counter: 1 out of 10
2025-02-24 00:57:02,297 - {'epoch': 43, 'rec_loss': '7.6409'}
2025-02-24 00:57:22,202 - {'Epoch': 43, 'HR@5': '0.0529', 'NDCG@5': '0.0373', 'HR@10': '0.0766', 'NDCG@10': '0.0450', 'HR@20': '0.1079', 'NDCG@20': '0.0528'}
2025-02-24 00:57:22,203 - Validation score increased.  Saving model ...
2025-02-24 00:58:00,623 - {'epoch': 44, 'rec_loss': '7.6326'}
2025-02-24 00:58:17,184 - {'Epoch': 44, 'HR@5': '0.0529', 'NDCG@5': '0.0367', 'HR@10': '0.0753', 'NDCG@10': '0.0439', 'HR@20': '0.1062', 'NDCG@20': '0.0517'}
2025-02-24 00:58:17,188 - EarlyStopping counter: 1 out of 10
2025-02-24 00:58:54,625 - {'epoch': 45, 'rec_loss': '7.6270'}
2025-02-24 00:59:12,930 - {'Epoch': 45, 'HR@5': '0.0528', 'NDCG@5': '0.0367', 'HR@10': '0.0749', 'NDCG@10': '0.0438', 'HR@20': '0.1058', 'NDCG@20': '0.0516'}
2025-02-24 00:59:12,934 - EarlyStopping counter: 2 out of 10
2025-02-24 00:59:52,669 - {'epoch': 46, 'rec_loss': '7.6249'}
2025-02-24 01:00:09,153 - {'Epoch': 46, 'HR@5': '0.0532', 'NDCG@5': '0.0370', 'HR@10': '0.0755', 'NDCG@10': '0.0441', 'HR@20': '0.1062', 'NDCG@20': '0.0519'}
2025-02-24 01:00:09,154 - EarlyStopping counter: 3 out of 10
2025-02-24 01:00:51,686 - {'epoch': 47, 'rec_loss': '7.6168'}
2025-02-24 01:01:08,256 - {'Epoch': 47, 'HR@5': '0.0526', 'NDCG@5': '0.0368', 'HR@10': '0.0746', 'NDCG@10': '0.0439', 'HR@20': '0.1062', 'NDCG@20': '0.0519'}
2025-02-24 01:01:08,259 - EarlyStopping counter: 4 out of 10
2025-02-24 01:01:47,460 - {'epoch': 48, 'rec_loss': '7.6166'}
2025-02-24 01:02:06,250 - {'Epoch': 48, 'HR@5': '0.0527', 'NDCG@5': '0.0368', 'HR@10': '0.0760', 'NDCG@10': '0.0443', 'HR@20': '0.1070', 'NDCG@20': '0.0521'}
2025-02-24 01:02:06,254 - EarlyStopping counter: 5 out of 10
2025-02-24 01:02:44,968 - {'epoch': 49, 'rec_loss': '7.6163'}
2025-02-24 01:03:03,680 - {'Epoch': 49, 'HR@5': '0.0530', 'NDCG@5': '0.0369', 'HR@10': '0.0757', 'NDCG@10': '0.0442', 'HR@20': '0.1064', 'NDCG@20': '0.0519'}
2025-02-24 01:03:03,685 - EarlyStopping counter: 6 out of 10
2025-02-24 01:03:41,077 - {'epoch': 50, 'rec_loss': '7.6087'}
2025-02-24 01:03:58,265 - {'Epoch': 50, 'HR@5': '0.0515', 'NDCG@5': '0.0360', 'HR@10': '0.0747', 'NDCG@10': '0.0435', 'HR@20': '0.1057', 'NDCG@20': '0.0513'}
2025-02-24 01:03:58,266 - EarlyStopping counter: 7 out of 10
2025-02-24 01:04:41,018 - {'epoch': 51, 'rec_loss': '7.6049'}
2025-02-24 01:04:59,141 - {'Epoch': 51, 'HR@5': '0.0530', 'NDCG@5': '0.0367', 'HR@10': '0.0755', 'NDCG@10': '0.0439', 'HR@20': '0.1062', 'NDCG@20': '0.0516'}
2025-02-24 01:04:59,147 - EarlyStopping counter: 8 out of 10
2025-02-24 01:05:41,301 - {'epoch': 52, 'rec_loss': '7.5985'}
2025-02-24 01:05:57,664 - {'Epoch': 52, 'HR@5': '0.0532', 'NDCG@5': '0.0368', 'HR@10': '0.0757', 'NDCG@10': '0.0440', 'HR@20': '0.1067', 'NDCG@20': '0.0518'}
2025-02-24 01:05:57,665 - EarlyStopping counter: 9 out of 10
2025-02-24 01:06:34,588 - {'epoch': 53, 'rec_loss': '7.6008'}
2025-02-24 01:06:53,446 - {'Epoch': 53, 'HR@5': '0.0522', 'NDCG@5': '0.0363', 'HR@10': '0.0751', 'NDCG@10': '0.0437', 'HR@20': '0.1062', 'NDCG@20': '0.0515'}
2025-02-24 01:06:53,447 - EarlyStopping counter: 10 out of 10
2025-02-24 01:06:53,447 - Early stopping
2025-02-24 01:06:53,447 - ---------------Test Score---------------
2025-02-24 01:07:12,339 - {'Epoch': 0, 'HR@5': '0.0435', 'NDCG@5': '0.0298', 'HR@10': '0.0633', 'NDCG@10': '0.0362', 'HR@20': '0.0896', 'NDCG@20': '0.0428'}
2025-02-24 01:07:12,342 - Scale_Sports
2025-02-24 01:07:12,342 - {'Epoch': 0, 'HR@5': '0.0435', 'NDCG@5': '0.0298', 'HR@10': '0.0633', 'NDCG@10': '0.0362', 'HR@20': '0.0896', 'NDCG@20': '0.0428'}
2025-02-24 12:00:07,693 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[4, 8, 12], start_prob=0.2, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-24 12:00:10,453 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-24 12:00:10,458 - Total Parameters: 1328854
2025-02-24 12:00:51,563 - {'epoch': 0, 'rec_loss': '9.4019'}
2025-02-24 12:01:09,597 - {'Epoch': 0, 'HR@5': '0.0083', 'NDCG@5': '0.0054', 'HR@10': '0.0127', 'NDCG@10': '0.0068', 'HR@20': '0.0215', 'NDCG@20': '0.0090'}
2025-02-24 12:01:09,598 - Validation score increased.  Saving model ...
2025-02-24 12:01:46,985 - {'epoch': 1, 'rec_loss': '9.1787'}
2025-02-24 12:02:04,553 - {'Epoch': 1, 'HR@5': '0.0151', 'NDCG@5': '0.0096', 'HR@10': '0.0260', 'NDCG@10': '0.0131', 'HR@20': '0.0427', 'NDCG@20': '0.0173'}
2025-02-24 12:02:04,556 - Validation score increased.  Saving model ...
2025-02-24 12:02:41,287 - {'epoch': 2, 'rec_loss': '8.8952'}
2025-02-24 12:02:59,650 - {'Epoch': 2, 'HR@5': '0.0197', 'NDCG@5': '0.0128', 'HR@10': '0.0332', 'NDCG@10': '0.0171', 'HR@20': '0.0519', 'NDCG@20': '0.0218'}
2025-02-24 12:02:59,656 - Validation score increased.  Saving model ...
2025-02-24 12:03:36,375 - {'epoch': 3, 'rec_loss': '8.6943'}
2025-02-24 12:03:54,048 - {'Epoch': 3, 'HR@5': '0.0287', 'NDCG@5': '0.0188', 'HR@10': '0.0440', 'NDCG@10': '0.0237', 'HR@20': '0.0658', 'NDCG@20': '0.0291'}
2025-02-24 12:03:54,052 - Validation score increased.  Saving model ...
2025-02-24 12:04:31,281 - {'epoch': 4, 'rec_loss': '8.5410'}
2025-02-24 12:04:47,107 - {'Epoch': 4, 'HR@5': '0.0323', 'NDCG@5': '0.0214', 'HR@10': '0.0487', 'NDCG@10': '0.0267', 'HR@20': '0.0748', 'NDCG@20': '0.0333'}
2025-02-24 12:04:47,111 - Validation score increased.  Saving model ...
2025-02-24 12:05:24,232 - {'epoch': 5, 'rec_loss': '8.4139'}
2025-02-24 12:05:40,759 - {'Epoch': 5, 'HR@5': '0.0382', 'NDCG@5': '0.0257', 'HR@10': '0.0553', 'NDCG@10': '0.0312', 'HR@20': '0.0805', 'NDCG@20': '0.0375'}
2025-02-24 12:05:40,760 - Validation score increased.  Saving model ...
2025-02-24 12:06:17,582 - {'epoch': 6, 'rec_loss': '8.3182'}
2025-02-24 12:06:35,723 - {'Epoch': 6, 'HR@5': '0.0398', 'NDCG@5': '0.0273', 'HR@10': '0.0589', 'NDCG@10': '0.0334', 'HR@20': '0.0849', 'NDCG@20': '0.0400'}
2025-02-24 12:06:35,727 - Validation score increased.  Saving model ...
2025-02-24 12:07:12,376 - {'epoch': 7, 'rec_loss': '8.2362'}
2025-02-24 12:07:29,662 - {'Epoch': 7, 'HR@5': '0.0422', 'NDCG@5': '0.0290', 'HR@10': '0.0612', 'NDCG@10': '0.0351', 'HR@20': '0.0881', 'NDCG@20': '0.0418'}
2025-02-24 12:07:29,670 - Validation score increased.  Saving model ...
2025-02-24 12:08:07,944 - {'epoch': 8, 'rec_loss': '8.1639'}
2025-02-24 12:08:23,875 - {'Epoch': 8, 'HR@5': '0.0448', 'NDCG@5': '0.0310', 'HR@10': '0.0633', 'NDCG@10': '0.0370', 'HR@20': '0.0904', 'NDCG@20': '0.0438'}
2025-02-24 12:08:23,876 - Validation score increased.  Saving model ...
2025-02-24 12:09:01,002 - {'epoch': 9, 'rec_loss': '8.1067'}
2025-02-24 12:09:18,461 - {'Epoch': 9, 'HR@5': '0.0458', 'NDCG@5': '0.0315', 'HR@10': '0.0652', 'NDCG@10': '0.0378', 'HR@20': '0.0928', 'NDCG@20': '0.0447'}
2025-02-24 12:09:18,466 - Validation score increased.  Saving model ...
2025-02-24 12:09:55,333 - {'epoch': 10, 'rec_loss': '8.0607'}
2025-02-24 12:10:14,033 - {'Epoch': 10, 'HR@5': '0.0446', 'NDCG@5': '0.0315', 'HR@10': '0.0655', 'NDCG@10': '0.0383', 'HR@20': '0.0934', 'NDCG@20': '0.0452'}
2025-02-24 12:10:14,034 - Validation score increased.  Saving model ...
2025-02-24 12:10:51,402 - {'epoch': 11, 'rec_loss': '8.0124'}
2025-02-24 12:11:10,103 - {'Epoch': 11, 'HR@5': '0.0466', 'NDCG@5': '0.0322', 'HR@10': '0.0677', 'NDCG@10': '0.0390', 'HR@20': '0.0955', 'NDCG@20': '0.0460'}
2025-02-24 12:11:10,106 - Validation score increased.  Saving model ...
2025-02-24 12:11:46,880 - {'epoch': 12, 'rec_loss': '7.9783'}
2025-02-24 12:12:04,379 - {'Epoch': 12, 'HR@5': '0.0473', 'NDCG@5': '0.0330', 'HR@10': '0.0685', 'NDCG@10': '0.0398', 'HR@20': '0.0971', 'NDCG@20': '0.0470'}
2025-02-24 12:12:04,383 - Validation score increased.  Saving model ...
2025-02-24 12:12:41,338 - {'epoch': 13, 'rec_loss': '7.9447'}
2025-02-24 12:12:57,664 - {'Epoch': 13, 'HR@5': '0.0468', 'NDCG@5': '0.0326', 'HR@10': '0.0691', 'NDCG@10': '0.0398', 'HR@20': '0.0979', 'NDCG@20': '0.0470'}
2025-02-24 12:12:57,667 - Validation score increased.  Saving model ...
2025-02-24 12:13:34,422 - {'epoch': 14, 'rec_loss': '7.9159'}
2025-02-24 12:13:52,907 - {'Epoch': 14, 'HR@5': '0.0485', 'NDCG@5': '0.0340', 'HR@10': '0.0696', 'NDCG@10': '0.0408', 'HR@20': '0.0989', 'NDCG@20': '0.0481'}
2025-02-24 12:13:52,910 - Validation score increased.  Saving model ...
2025-02-24 12:14:32,642 - {'epoch': 15, 'rec_loss': '7.8893'}
2025-02-24 12:14:50,853 - {'Epoch': 15, 'HR@5': '0.0484', 'NDCG@5': '0.0338', 'HR@10': '0.0693', 'NDCG@10': '0.0405', 'HR@20': '0.0991', 'NDCG@20': '0.0480'}
2025-02-24 12:14:50,854 - EarlyStopping counter: 1 out of 10
2025-02-24 12:15:27,533 - {'epoch': 16, 'rec_loss': '7.8669'}
2025-02-24 12:15:46,499 - {'Epoch': 16, 'HR@5': '0.0488', 'NDCG@5': '0.0338', 'HR@10': '0.0707', 'NDCG@10': '0.0408', 'HR@20': '0.1001', 'NDCG@20': '0.0482'}
2025-02-24 12:15:46,503 - Validation score increased.  Saving model ...
2025-02-24 12:16:24,172 - {'epoch': 17, 'rec_loss': '7.8438'}
2025-02-24 12:16:41,689 - {'Epoch': 17, 'HR@5': '0.0488', 'NDCG@5': '0.0341', 'HR@10': '0.0701', 'NDCG@10': '0.0410', 'HR@20': '0.0997', 'NDCG@20': '0.0484'}
2025-02-24 12:16:41,690 - Validation score increased.  Saving model ...
2025-02-24 12:17:19,475 - {'epoch': 18, 'rec_loss': '7.8217'}
2025-02-24 12:17:36,974 - {'Epoch': 18, 'HR@5': '0.0499', 'NDCG@5': '0.0346', 'HR@10': '0.0717', 'NDCG@10': '0.0416', 'HR@20': '0.1013', 'NDCG@20': '0.0490'}
2025-02-24 12:17:36,977 - Validation score increased.  Saving model ...
2025-02-24 12:18:14,891 - {'epoch': 19, 'rec_loss': '7.8012'}
2025-02-24 12:18:33,883 - {'Epoch': 19, 'HR@5': '0.0505', 'NDCG@5': '0.0351', 'HR@10': '0.0721', 'NDCG@10': '0.0421', 'HR@20': '0.1009', 'NDCG@20': '0.0493'}
2025-02-24 12:18:33,887 - Validation score increased.  Saving model ...
2025-02-24 12:19:11,309 - {'epoch': 20, 'rec_loss': '7.7870'}
2025-02-24 12:19:27,910 - {'Epoch': 20, 'HR@5': '0.0514', 'NDCG@5': '0.0354', 'HR@10': '0.0736', 'NDCG@10': '0.0426', 'HR@20': '0.1013', 'NDCG@20': '0.0495'}
2025-02-24 12:19:27,914 - Validation score increased.  Saving model ...
2025-02-24 12:20:07,741 - {'epoch': 21, 'rec_loss': '7.7634'}
2025-02-24 12:20:24,432 - {'Epoch': 21, 'HR@5': '0.0495', 'NDCG@5': '0.0343', 'HR@10': '0.0712', 'NDCG@10': '0.0413', 'HR@20': '0.1018', 'NDCG@20': '0.0490'}
2025-02-24 12:20:24,436 - EarlyStopping counter: 1 out of 10
2025-02-24 12:21:04,593 - {'epoch': 22, 'rec_loss': '7.7522'}
2025-02-24 12:21:22,919 - {'Epoch': 22, 'HR@5': '0.0507', 'NDCG@5': '0.0352', 'HR@10': '0.0722', 'NDCG@10': '0.0421', 'HR@20': '0.1030', 'NDCG@20': '0.0498'}
2025-02-24 12:21:22,925 - Validation score increased.  Saving model ...
2025-02-24 12:22:03,446 - {'epoch': 23, 'rec_loss': '7.7375'}
2025-02-24 12:22:20,496 - {'Epoch': 23, 'HR@5': '0.0495', 'NDCG@5': '0.0343', 'HR@10': '0.0716', 'NDCG@10': '0.0414', 'HR@20': '0.1024', 'NDCG@20': '0.0492'}
2025-02-24 12:22:20,497 - EarlyStopping counter: 1 out of 10
2025-02-24 12:22:58,249 - {'epoch': 24, 'rec_loss': '7.7199'}
2025-02-24 12:23:17,234 - {'Epoch': 24, 'HR@5': '0.0514', 'NDCG@5': '0.0357', 'HR@10': '0.0726', 'NDCG@10': '0.0425', 'HR@20': '0.1030', 'NDCG@20': '0.0501'}
2025-02-24 12:23:17,237 - Validation score increased.  Saving model ...
2025-02-24 12:23:54,825 - {'epoch': 25, 'rec_loss': '7.7075'}
2025-02-24 12:24:13,692 - {'Epoch': 25, 'HR@5': '0.0514', 'NDCG@5': '0.0356', 'HR@10': '0.0735', 'NDCG@10': '0.0427', 'HR@20': '0.1044', 'NDCG@20': '0.0505'}
2025-02-24 12:24:13,693 - Validation score increased.  Saving model ...
2025-02-24 12:24:50,396 - {'epoch': 26, 'rec_loss': '7.6965'}
2025-02-24 12:25:06,918 - {'Epoch': 26, 'HR@5': '0.0514', 'NDCG@5': '0.0359', 'HR@10': '0.0730', 'NDCG@10': '0.0429', 'HR@20': '0.1025', 'NDCG@20': '0.0503'}
2025-02-24 12:25:06,926 - EarlyStopping counter: 1 out of 10
2025-02-24 12:25:43,679 - {'epoch': 27, 'rec_loss': '7.6817'}
2025-02-24 12:26:02,585 - {'Epoch': 27, 'HR@5': '0.0512', 'NDCG@5': '0.0356', 'HR@10': '0.0737', 'NDCG@10': '0.0428', 'HR@20': '0.1030', 'NDCG@20': '0.0502'}
2025-02-24 12:26:02,587 - EarlyStopping counter: 2 out of 10
2025-02-24 12:26:39,684 - {'epoch': 28, 'rec_loss': '7.6736'}
2025-02-24 12:26:58,707 - {'Epoch': 28, 'HR@5': '0.0509', 'NDCG@5': '0.0357', 'HR@10': '0.0726', 'NDCG@10': '0.0427', 'HR@20': '0.1031', 'NDCG@20': '0.0504'}
2025-02-24 12:26:58,710 - EarlyStopping counter: 3 out of 10
2025-02-24 12:27:38,085 - {'epoch': 29, 'rec_loss': '7.6656'}
2025-02-24 12:27:56,985 - {'Epoch': 29, 'HR@5': '0.0512', 'NDCG@5': '0.0355', 'HR@10': '0.0737', 'NDCG@10': '0.0427', 'HR@20': '0.1048', 'NDCG@20': '0.0505'}
2025-02-24 12:27:56,986 - Validation score increased.  Saving model ...
2025-02-24 12:28:36,537 - {'epoch': 30, 'rec_loss': '7.6567'}
2025-02-24 12:28:54,876 - {'Epoch': 30, 'HR@5': '0.0510', 'NDCG@5': '0.0357', 'HR@10': '0.0732', 'NDCG@10': '0.0428', 'HR@20': '0.1037', 'NDCG@20': '0.0505'}
2025-02-24 12:28:54,879 - EarlyStopping counter: 1 out of 10
2025-02-24 12:29:31,588 - {'epoch': 31, 'rec_loss': '7.6458'}
2025-02-24 12:29:50,702 - {'Epoch': 31, 'HR@5': '0.0510', 'NDCG@5': '0.0353', 'HR@10': '0.0734', 'NDCG@10': '0.0426', 'HR@20': '0.1037', 'NDCG@20': '0.0502'}
2025-02-24 12:29:50,703 - EarlyStopping counter: 2 out of 10
2025-02-24 12:30:28,405 - {'epoch': 32, 'rec_loss': '7.6331'}
2025-02-24 12:30:47,472 - {'Epoch': 32, 'HR@5': '0.0508', 'NDCG@5': '0.0352', 'HR@10': '0.0730', 'NDCG@10': '0.0424', 'HR@20': '0.1036', 'NDCG@20': '0.0501'}
2025-02-24 12:30:47,477 - EarlyStopping counter: 3 out of 10
2025-02-24 12:31:24,913 - {'epoch': 33, 'rec_loss': '7.6266'}
2025-02-24 12:31:41,655 - {'Epoch': 33, 'HR@5': '0.0513', 'NDCG@5': '0.0358', 'HR@10': '0.0741', 'NDCG@10': '0.0432', 'HR@20': '0.1036', 'NDCG@20': '0.0506'}
2025-02-24 12:31:41,656 - Validation score increased.  Saving model ...
2025-02-24 12:32:18,372 - {'epoch': 34, 'rec_loss': '7.6252'}
2025-02-24 12:32:36,652 - {'Epoch': 34, 'HR@5': '0.0512', 'NDCG@5': '0.0356', 'HR@10': '0.0739', 'NDCG@10': '0.0429', 'HR@20': '0.1046', 'NDCG@20': '0.0506'}
2025-02-24 12:32:36,655 - Validation score increased.  Saving model ...
2025-02-24 12:33:13,374 - {'epoch': 35, 'rec_loss': '7.6121'}
2025-02-24 12:33:30,832 - {'Epoch': 35, 'HR@5': '0.0518', 'NDCG@5': '0.0360', 'HR@10': '0.0747', 'NDCG@10': '0.0434', 'HR@20': '0.1050', 'NDCG@20': '0.0510'}
2025-02-24 12:33:30,838 - Validation score increased.  Saving model ...
2025-02-24 12:34:07,508 - {'epoch': 36, 'rec_loss': '7.6074'}
2025-02-24 12:34:24,088 - {'Epoch': 36, 'HR@5': '0.0511', 'NDCG@5': '0.0358', 'HR@10': '0.0737', 'NDCG@10': '0.0431', 'HR@20': '0.1041', 'NDCG@20': '0.0507'}
2025-02-24 12:34:24,089 - EarlyStopping counter: 1 out of 10
2025-02-24 12:35:00,878 - {'epoch': 37, 'rec_loss': '7.5992'}
2025-02-24 12:35:18,396 - {'Epoch': 37, 'HR@5': '0.0520', 'NDCG@5': '0.0361', 'HR@10': '0.0733', 'NDCG@10': '0.0429', 'HR@20': '0.1043', 'NDCG@20': '0.0508'}
2025-02-24 12:35:18,397 - EarlyStopping counter: 2 out of 10
2025-02-24 12:35:55,176 - {'epoch': 38, 'rec_loss': '7.5856'}
2025-02-24 12:36:13,474 - {'Epoch': 38, 'HR@5': '0.0524', 'NDCG@5': '0.0363', 'HR@10': '0.0739', 'NDCG@10': '0.0432', 'HR@20': '0.1044', 'NDCG@20': '0.0509'}
2025-02-24 12:36:13,476 - EarlyStopping counter: 3 out of 10
2025-02-24 12:36:50,942 - {'epoch': 39, 'rec_loss': '7.5832'}
2025-02-24 12:37:07,456 - {'Epoch': 39, 'HR@5': '0.0519', 'NDCG@5': '0.0362', 'HR@10': '0.0737', 'NDCG@10': '0.0432', 'HR@20': '0.1042', 'NDCG@20': '0.0508'}
2025-02-24 12:37:07,457 - EarlyStopping counter: 4 out of 10
2025-02-24 12:37:44,088 - {'epoch': 40, 'rec_loss': '7.5802'}
2025-02-24 12:38:01,646 - {'Epoch': 40, 'HR@5': '0.0513', 'NDCG@5': '0.0359', 'HR@10': '0.0740', 'NDCG@10': '0.0432', 'HR@20': '0.1027', 'NDCG@20': '0.0505'}
2025-02-24 12:38:01,648 - EarlyStopping counter: 5 out of 10
2025-02-24 12:38:38,465 - {'epoch': 41, 'rec_loss': '7.5697'}
2025-02-24 12:38:56,735 - {'Epoch': 41, 'HR@5': '0.0520', 'NDCG@5': '0.0361', 'HR@10': '0.0737', 'NDCG@10': '0.0431', 'HR@20': '0.1048', 'NDCG@20': '0.0509'}
2025-02-24 12:38:56,737 - EarlyStopping counter: 6 out of 10
2025-02-24 12:39:35,212 - {'epoch': 42, 'rec_loss': '7.5633'}
2025-02-24 12:39:53,911 - {'Epoch': 42, 'HR@5': '0.0514', 'NDCG@5': '0.0358', 'HR@10': '0.0739', 'NDCG@10': '0.0431', 'HR@20': '0.1046', 'NDCG@20': '0.0508'}
2025-02-24 12:39:53,914 - EarlyStopping counter: 7 out of 10
2025-02-24 12:40:32,630 - {'epoch': 43, 'rec_loss': '7.5627'}
2025-02-24 12:40:49,063 - {'Epoch': 43, 'HR@5': '0.0514', 'NDCG@5': '0.0356', 'HR@10': '0.0745', 'NDCG@10': '0.0431', 'HR@20': '0.1055', 'NDCG@20': '0.0509'}
2025-02-24 12:40:49,064 - EarlyStopping counter: 8 out of 10
2025-02-24 12:41:26,035 - {'epoch': 44, 'rec_loss': '7.5543'}
2025-02-24 12:41:42,518 - {'Epoch': 44, 'HR@5': '0.0523', 'NDCG@5': '0.0361', 'HR@10': '0.0758', 'NDCG@10': '0.0436', 'HR@20': '0.1057', 'NDCG@20': '0.0512'}
2025-02-24 12:41:42,522 - Validation score increased.  Saving model ...
2025-02-24 12:42:19,224 - {'epoch': 45, 'rec_loss': '7.5507'}
2025-02-24 12:42:38,244 - {'Epoch': 45, 'HR@5': '0.0519', 'NDCG@5': '0.0361', 'HR@10': '0.0752', 'NDCG@10': '0.0436', 'HR@20': '0.1047', 'NDCG@20': '0.0511'}
2025-02-24 12:42:38,248 - EarlyStopping counter: 1 out of 10
2025-02-24 12:43:14,899 - {'epoch': 46, 'rec_loss': '7.5477'}
2025-02-24 12:43:33,409 - {'Epoch': 46, 'HR@5': '0.0518', 'NDCG@5': '0.0361', 'HR@10': '0.0743', 'NDCG@10': '0.0434', 'HR@20': '0.1037', 'NDCG@20': '0.0508'}
2025-02-24 12:43:33,411 - EarlyStopping counter: 2 out of 10
2025-02-24 12:44:10,112 - {'epoch': 47, 'rec_loss': '7.5461'}
2025-02-24 12:44:26,471 - {'Epoch': 47, 'HR@5': '0.0520', 'NDCG@5': '0.0362', 'HR@10': '0.0742', 'NDCG@10': '0.0434', 'HR@20': '0.1036', 'NDCG@20': '0.0508'}
2025-02-24 12:44:26,475 - EarlyStopping counter: 3 out of 10
2025-02-24 12:45:03,496 - {'epoch': 48, 'rec_loss': '7.5374'}
2025-02-24 12:45:19,815 - {'Epoch': 48, 'HR@5': '0.0523', 'NDCG@5': '0.0362', 'HR@10': '0.0750', 'NDCG@10': '0.0435', 'HR@20': '0.1044', 'NDCG@20': '0.0509'}
2025-02-24 12:45:19,819 - EarlyStopping counter: 4 out of 10
2025-02-24 12:45:56,488 - {'epoch': 49, 'rec_loss': '7.5333'}
2025-02-24 12:46:15,527 - {'Epoch': 49, 'HR@5': '0.0514', 'NDCG@5': '0.0359', 'HR@10': '0.0743', 'NDCG@10': '0.0433', 'HR@20': '0.1045', 'NDCG@20': '0.0509'}
2025-02-24 12:46:15,531 - EarlyStopping counter: 5 out of 10
2025-02-24 12:46:52,159 - {'epoch': 50, 'rec_loss': '7.5327'}
2025-02-24 12:47:11,143 - {'Epoch': 50, 'HR@5': '0.0518', 'NDCG@5': '0.0359', 'HR@10': '0.0741', 'NDCG@10': '0.0430', 'HR@20': '0.1048', 'NDCG@20': '0.0508'}
2025-02-24 12:47:11,145 - EarlyStopping counter: 6 out of 10
2025-02-24 12:47:47,825 - {'epoch': 51, 'rec_loss': '7.5236'}
2025-02-24 12:48:06,430 - {'Epoch': 51, 'HR@5': '0.0517', 'NDCG@5': '0.0360', 'HR@10': '0.0739', 'NDCG@10': '0.0431', 'HR@20': '0.1051', 'NDCG@20': '0.0510'}
2025-02-24 12:48:06,434 - EarlyStopping counter: 7 out of 10
2025-02-24 12:48:43,055 - {'epoch': 52, 'rec_loss': '7.5212'}
2025-02-24 12:49:01,627 - {'Epoch': 52, 'HR@5': '0.0518', 'NDCG@5': '0.0359', 'HR@10': '0.0739', 'NDCG@10': '0.0430', 'HR@20': '0.1045', 'NDCG@20': '0.0507'}
2025-02-24 12:49:01,631 - EarlyStopping counter: 8 out of 10
2025-02-24 12:49:41,845 - {'epoch': 53, 'rec_loss': '7.5170'}
2025-02-24 12:49:58,368 - {'Epoch': 53, 'HR@5': '0.0516', 'NDCG@5': '0.0359', 'HR@10': '0.0753', 'NDCG@10': '0.0436', 'HR@20': '0.1046', 'NDCG@20': '0.0509'}
2025-02-24 12:49:58,369 - EarlyStopping counter: 9 out of 10
2025-02-24 12:50:35,036 - {'epoch': 54, 'rec_loss': '7.5092'}
2025-02-24 12:50:51,678 - {'Epoch': 54, 'HR@5': '0.0518', 'NDCG@5': '0.0358', 'HR@10': '0.0747', 'NDCG@10': '0.0432', 'HR@20': '0.1049', 'NDCG@20': '0.0508'}
2025-02-24 12:50:51,679 - EarlyStopping counter: 10 out of 10
2025-02-24 12:50:51,680 - Early stopping
2025-02-24 12:50:51,680 - ---------------Test Score---------------
2025-02-24 12:51:10,294 - {'Epoch': 0, 'HR@5': '0.0435', 'NDCG@5': '0.0305', 'HR@10': '0.0622', 'NDCG@10': '0.0365', 'HR@20': '0.0888', 'NDCG@20': '0.0432'}
2025-02-24 12:51:10,296 - Scale_Sports
2025-02-24 12:51:10,297 - {'Epoch': 0, 'HR@5': '0.0435', 'NDCG@5': '0.0305', 'HR@10': '0.0622', 'NDCG@10': '0.0365', 'HR@20': '0.0888', 'NDCG@20': '0.0432'}
2025-02-24 12:53:48,661 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[4, 8, 12], start_prob=0.6, end_prob=0.3, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-24 12:53:51,490 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-24 12:53:51,495 - Total Parameters: 1328854
2025-02-24 12:54:30,643 - {'epoch': 0, 'rec_loss': '9.4008'}
2025-02-24 12:54:49,453 - {'Epoch': 0, 'HR@5': '0.0083', 'NDCG@5': '0.0055', 'HR@10': '0.0129', 'NDCG@10': '0.0070', 'HR@20': '0.0221', 'NDCG@20': '0.0093'}
2025-02-24 12:54:49,454 - Validation score increased.  Saving model ...
2025-02-24 12:55:30,542 - {'epoch': 1, 'rec_loss': '9.1841'}
2025-02-24 12:55:47,499 - {'Epoch': 1, 'HR@5': '0.0151', 'NDCG@5': '0.0098', 'HR@10': '0.0256', 'NDCG@10': '0.0132', 'HR@20': '0.0415', 'NDCG@20': '0.0172'}
2025-02-24 12:55:47,501 - Validation score increased.  Saving model ...
2025-02-24 12:56:27,663 - {'epoch': 2, 'rec_loss': '8.9240'}
2025-02-24 12:56:43,327 - {'Epoch': 2, 'HR@5': '0.0185', 'NDCG@5': '0.0122', 'HR@10': '0.0311', 'NDCG@10': '0.0162', 'HR@20': '0.0494', 'NDCG@20': '0.0208'}
2025-02-24 12:56:43,328 - Validation score increased.  Saving model ...
2025-02-24 12:57:24,477 - {'epoch': 3, 'rec_loss': '8.7433'}
2025-02-24 12:57:40,315 - {'Epoch': 3, 'HR@5': '0.0261', 'NDCG@5': '0.0167', 'HR@10': '0.0410', 'NDCG@10': '0.0215', 'HR@20': '0.0630', 'NDCG@20': '0.0270'}
2025-02-24 12:57:40,317 - Validation score increased.  Saving model ...
2025-02-24 12:58:21,546 - {'epoch': 4, 'rec_loss': '8.6011'}
2025-02-24 12:58:37,475 - {'Epoch': 4, 'HR@5': '0.0305', 'NDCG@5': '0.0199', 'HR@10': '0.0467', 'NDCG@10': '0.0250', 'HR@20': '0.0719', 'NDCG@20': '0.0314'}
2025-02-24 12:58:37,476 - Validation score increased.  Saving model ...
2025-02-24 12:59:18,103 - {'epoch': 5, 'rec_loss': '8.4805'}
2025-02-24 12:59:33,879 - {'Epoch': 5, 'HR@5': '0.0357', 'NDCG@5': '0.0240', 'HR@10': '0.0528', 'NDCG@10': '0.0295', 'HR@20': '0.0772', 'NDCG@20': '0.0356'}
2025-02-24 12:59:33,880 - Validation score increased.  Saving model ...
2025-02-24 13:00:15,471 - {'epoch': 6, 'rec_loss': '8.3914'}
2025-02-24 13:00:31,512 - {'Epoch': 6, 'HR@5': '0.0382', 'NDCG@5': '0.0257', 'HR@10': '0.0562', 'NDCG@10': '0.0315', 'HR@20': '0.0816', 'NDCG@20': '0.0379'}
2025-02-24 13:00:31,513 - Validation score increased.  Saving model ...
2025-02-24 13:01:11,967 - {'epoch': 7, 'rec_loss': '8.3076'}
2025-02-24 13:01:28,168 - {'Epoch': 7, 'HR@5': '0.0407', 'NDCG@5': '0.0275', 'HR@10': '0.0598', 'NDCG@10': '0.0336', 'HR@20': '0.0854', 'NDCG@20': '0.0401'}
2025-02-24 13:01:28,171 - Validation score increased.  Saving model ...
2025-02-24 13:02:08,418 - {'epoch': 8, 'rec_loss': '8.2374'}
2025-02-24 13:02:24,745 - {'Epoch': 8, 'HR@5': '0.0425', 'NDCG@5': '0.0293', 'HR@10': '0.0618', 'NDCG@10': '0.0356', 'HR@20': '0.0888', 'NDCG@20': '0.0423'}
2025-02-24 13:02:24,746 - Validation score increased.  Saving model ...
2025-02-24 13:03:06,517 - {'epoch': 9, 'rec_loss': '8.1819'}
2025-02-24 13:03:22,969 - {'Epoch': 9, 'HR@5': '0.0446', 'NDCG@5': '0.0305', 'HR@10': '0.0633', 'NDCG@10': '0.0366', 'HR@20': '0.0911', 'NDCG@20': '0.0436'}
2025-02-24 13:03:22,972 - Validation score increased.  Saving model ...
2025-02-24 13:04:04,959 - {'epoch': 10, 'rec_loss': '8.1316'}
2025-02-24 13:04:21,191 - {'Epoch': 10, 'HR@5': '0.0459', 'NDCG@5': '0.0317', 'HR@10': '0.0662', 'NDCG@10': '0.0382', 'HR@20': '0.0919', 'NDCG@20': '0.0447'}
2025-02-24 13:04:21,198 - Validation score increased.  Saving model ...
2025-02-24 13:05:02,466 - {'epoch': 11, 'rec_loss': '8.0862'}
2025-02-24 13:05:18,928 - {'Epoch': 11, 'HR@5': '0.0460', 'NDCG@5': '0.0317', 'HR@10': '0.0670', 'NDCG@10': '0.0385', 'HR@20': '0.0952', 'NDCG@20': '0.0456'}
2025-02-24 13:05:18,929 - Validation score increased.  Saving model ...
2025-02-24 13:05:59,295 - {'epoch': 12, 'rec_loss': '8.0478'}
2025-02-24 13:06:15,711 - {'Epoch': 12, 'HR@5': '0.0470', 'NDCG@5': '0.0325', 'HR@10': '0.0680', 'NDCG@10': '0.0393', 'HR@20': '0.0966', 'NDCG@20': '0.0465'}
2025-02-24 13:06:15,712 - Validation score increased.  Saving model ...
2025-02-24 13:06:55,894 - {'epoch': 13, 'rec_loss': '8.0151'}
2025-02-24 13:07:12,086 - {'Epoch': 13, 'HR@5': '0.0476', 'NDCG@5': '0.0329', 'HR@10': '0.0684', 'NDCG@10': '0.0396', 'HR@20': '0.0973', 'NDCG@20': '0.0469'}
2025-02-24 13:07:12,087 - Validation score increased.  Saving model ...
2025-02-24 13:07:53,298 - {'epoch': 14, 'rec_loss': '7.9876'}
2025-02-24 13:08:09,361 - {'Epoch': 14, 'HR@5': '0.0485', 'NDCG@5': '0.0339', 'HR@10': '0.0693', 'NDCG@10': '0.0406', 'HR@20': '0.0987', 'NDCG@20': '0.0480'}
2025-02-24 13:08:09,366 - Validation score increased.  Saving model ...
2025-02-24 13:08:50,351 - {'epoch': 15, 'rec_loss': '7.9567'}
2025-02-24 13:09:08,675 - {'Epoch': 15, 'HR@5': '0.0486', 'NDCG@5': '0.0338', 'HR@10': '0.0695', 'NDCG@10': '0.0405', 'HR@20': '0.0974', 'NDCG@20': '0.0475'}
2025-02-24 13:09:08,676 - EarlyStopping counter: 1 out of 10
2025-02-24 13:09:46,789 - {'epoch': 16, 'rec_loss': '7.9353'}
2025-02-24 13:10:05,319 - {'Epoch': 16, 'HR@5': '0.0481', 'NDCG@5': '0.0334', 'HR@10': '0.0702', 'NDCG@10': '0.0405', 'HR@20': '0.0992', 'NDCG@20': '0.0478'}
2025-02-24 13:10:05,320 - EarlyStopping counter: 2 out of 10
2025-02-24 13:10:44,136 - {'epoch': 17, 'rec_loss': '7.9098'}
2025-02-24 13:11:03,140 - {'Epoch': 17, 'HR@5': '0.0483', 'NDCG@5': '0.0337', 'HR@10': '0.0699', 'NDCG@10': '0.0406', 'HR@20': '0.0994', 'NDCG@20': '0.0480'}
2025-02-24 13:11:03,141 - Validation score increased.  Saving model ...
2025-02-24 13:11:41,095 - {'epoch': 18, 'rec_loss': '7.8881'}
2025-02-24 13:11:57,586 - {'Epoch': 18, 'HR@5': '0.0494', 'NDCG@5': '0.0344', 'HR@10': '0.0708', 'NDCG@10': '0.0414', 'HR@20': '0.1013', 'NDCG@20': '0.0490'}
2025-02-24 13:11:57,587 - Validation score increased.  Saving model ...
2025-02-24 13:12:36,276 - {'epoch': 19, 'rec_loss': '7.8671'}
2025-02-24 13:12:53,468 - {'Epoch': 19, 'HR@5': '0.0490', 'NDCG@5': '0.0345', 'HR@10': '0.0710', 'NDCG@10': '0.0415', 'HR@20': '0.1016', 'NDCG@20': '0.0492'}
2025-02-24 13:12:53,470 - Validation score increased.  Saving model ...
2025-02-24 13:13:31,739 - {'epoch': 20, 'rec_loss': '7.8504'}
2025-02-24 13:13:48,172 - {'Epoch': 20, 'HR@5': '0.0504', 'NDCG@5': '0.0348', 'HR@10': '0.0722', 'NDCG@10': '0.0418', 'HR@20': '0.1027', 'NDCG@20': '0.0495'}
2025-02-24 13:13:48,173 - Validation score increased.  Saving model ...
2025-02-24 13:14:26,861 - {'epoch': 21, 'rec_loss': '7.8305'}
2025-02-24 13:14:43,510 - {'Epoch': 21, 'HR@5': '0.0490', 'NDCG@5': '0.0337', 'HR@10': '0.0716', 'NDCG@10': '0.0410', 'HR@20': '0.1015', 'NDCG@20': '0.0485'}
2025-02-24 13:14:43,512 - EarlyStopping counter: 1 out of 10
2025-02-24 13:15:25,456 - {'epoch': 22, 'rec_loss': '7.8201'}
2025-02-24 13:15:45,188 - {'Epoch': 22, 'HR@5': '0.0507', 'NDCG@5': '0.0351', 'HR@10': '0.0727', 'NDCG@10': '0.0422', 'HR@20': '0.1027', 'NDCG@20': '0.0497'}
2025-02-24 13:15:45,189 - Validation score increased.  Saving model ...
2025-02-24 13:16:24,822 - {'epoch': 23, 'rec_loss': '7.8040'}
2025-02-24 13:16:43,874 - {'Epoch': 23, 'HR@5': '0.0506', 'NDCG@5': '0.0344', 'HR@10': '0.0730', 'NDCG@10': '0.0416', 'HR@20': '0.1037', 'NDCG@20': '0.0494'}
2025-02-24 13:16:43,876 - EarlyStopping counter: 1 out of 10
2025-02-24 13:17:25,881 - {'epoch': 24, 'rec_loss': '7.7888'}
2025-02-24 13:17:44,447 - {'Epoch': 24, 'HR@5': '0.0506', 'NDCG@5': '0.0351', 'HR@10': '0.0735', 'NDCG@10': '0.0425', 'HR@20': '0.1030', 'NDCG@20': '0.0498'}
2025-02-24 13:17:44,448 - Validation score increased.  Saving model ...
2025-02-24 13:18:30,374 - {'epoch': 25, 'rec_loss': '7.7715'}
2025-02-24 13:18:47,642 - {'Epoch': 25, 'HR@5': '0.0505', 'NDCG@5': '0.0348', 'HR@10': '0.0731', 'NDCG@10': '0.0421', 'HR@20': '0.1049', 'NDCG@20': '0.0501'}
2025-02-24 13:18:47,643 - Validation score increased.  Saving model ...
2025-02-24 13:19:28,434 - {'epoch': 26, 'rec_loss': '7.7620'}
2025-02-24 13:19:45,867 - {'Epoch': 26, 'HR@5': '0.0513', 'NDCG@5': '0.0356', 'HR@10': '0.0735', 'NDCG@10': '0.0428', 'HR@20': '0.1037', 'NDCG@20': '0.0504'}
2025-02-24 13:19:45,874 - Validation score increased.  Saving model ...
2025-02-24 13:20:27,937 - {'epoch': 27, 'rec_loss': '7.7530'}
2025-02-24 13:20:46,299 - {'Epoch': 27, 'HR@5': '0.0509', 'NDCG@5': '0.0352', 'HR@10': '0.0734', 'NDCG@10': '0.0425', 'HR@20': '0.1036', 'NDCG@20': '0.0500'}
2025-02-24 13:20:46,300 - EarlyStopping counter: 1 out of 10
2025-02-24 13:21:30,314 - {'epoch': 28, 'rec_loss': '7.7465'}
2025-02-24 13:21:47,188 - {'Epoch': 28, 'HR@5': '0.0502', 'NDCG@5': '0.0349', 'HR@10': '0.0747', 'NDCG@10': '0.0428', 'HR@20': '0.1047', 'NDCG@20': '0.0504'}
2025-02-24 13:21:47,190 - EarlyStopping counter: 2 out of 10
2025-02-24 13:22:28,960 - {'epoch': 29, 'rec_loss': '7.7326'}
2025-02-24 13:22:46,424 - {'Epoch': 29, 'HR@5': '0.0514', 'NDCG@5': '0.0356', 'HR@10': '0.0742', 'NDCG@10': '0.0430', 'HR@20': '0.1057', 'NDCG@20': '0.0509'}
2025-02-24 13:22:46,426 - Validation score increased.  Saving model ...
2025-02-24 13:23:27,037 - {'epoch': 30, 'rec_loss': '7.7264'}
2025-02-24 13:23:43,583 - {'Epoch': 30, 'HR@5': '0.0508', 'NDCG@5': '0.0355', 'HR@10': '0.0737', 'NDCG@10': '0.0428', 'HR@20': '0.1047', 'NDCG@20': '0.0506'}
2025-02-24 13:23:43,584 - EarlyStopping counter: 1 out of 10
2025-02-24 13:24:23,067 - {'epoch': 31, 'rec_loss': '7.7133'}
2025-02-24 13:24:39,748 - {'Epoch': 31, 'HR@5': '0.0508', 'NDCG@5': '0.0356', 'HR@10': '0.0746', 'NDCG@10': '0.0432', 'HR@20': '0.1050', 'NDCG@20': '0.0509'}
2025-02-24 13:24:39,749 - EarlyStopping counter: 2 out of 10
2025-02-24 13:25:21,829 - {'epoch': 32, 'rec_loss': '7.7035'}
2025-02-24 13:25:38,321 - {'Epoch': 32, 'HR@5': '0.0508', 'NDCG@5': '0.0350', 'HR@10': '0.0744', 'NDCG@10': '0.0426', 'HR@20': '0.1053', 'NDCG@20': '0.0504'}
2025-02-24 13:25:38,326 - EarlyStopping counter: 3 out of 10
2025-02-24 13:26:19,255 - {'epoch': 33, 'rec_loss': '7.6935'}
2025-02-24 13:26:37,807 - {'Epoch': 33, 'HR@5': '0.0505', 'NDCG@5': '0.0353', 'HR@10': '0.0748', 'NDCG@10': '0.0432', 'HR@20': '0.1059', 'NDCG@20': '0.0510'}
2025-02-24 13:26:37,808 - Validation score increased.  Saving model ...
2025-02-24 13:27:18,807 - {'epoch': 34, 'rec_loss': '7.6906'}
2025-02-24 13:27:35,422 - {'Epoch': 34, 'HR@5': '0.0504', 'NDCG@5': '0.0354', 'HR@10': '0.0740', 'NDCG@10': '0.0430', 'HR@20': '0.1042', 'NDCG@20': '0.0506'}
2025-02-24 13:27:35,423 - EarlyStopping counter: 1 out of 10
2025-02-24 13:28:17,627 - {'epoch': 35, 'rec_loss': '7.6836'}
2025-02-24 13:28:34,314 - {'Epoch': 35, 'HR@5': '0.0508', 'NDCG@5': '0.0353', 'HR@10': '0.0740', 'NDCG@10': '0.0428', 'HR@20': '0.1053', 'NDCG@20': '0.0507'}
2025-02-24 13:28:34,315 - EarlyStopping counter: 2 out of 10
2025-02-24 13:29:14,926 - {'epoch': 36, 'rec_loss': '7.6766'}
2025-02-24 13:29:31,461 - {'Epoch': 36, 'HR@5': '0.0508', 'NDCG@5': '0.0355', 'HR@10': '0.0747', 'NDCG@10': '0.0432', 'HR@20': '0.1041', 'NDCG@20': '0.0506'}
2025-02-24 13:29:31,466 - EarlyStopping counter: 3 out of 10
2025-02-24 13:30:12,070 - {'epoch': 37, 'rec_loss': '7.6668'}
2025-02-24 13:30:29,283 - {'Epoch': 37, 'HR@5': '0.0516', 'NDCG@5': '0.0357', 'HR@10': '0.0755', 'NDCG@10': '0.0433', 'HR@20': '0.1058', 'NDCG@20': '0.0510'}
2025-02-24 13:30:29,284 - EarlyStopping counter: 4 out of 10
2025-02-24 13:31:09,800 - {'epoch': 38, 'rec_loss': '7.6558'}
2025-02-24 13:31:26,495 - {'Epoch': 38, 'HR@5': '0.0508', 'NDCG@5': '0.0351', 'HR@10': '0.0740', 'NDCG@10': '0.0426', 'HR@20': '0.1060', 'NDCG@20': '0.0507'}
2025-02-24 13:31:26,496 - EarlyStopping counter: 5 out of 10
2025-02-24 13:32:04,456 - {'epoch': 39, 'rec_loss': '7.6465'}
2025-02-24 13:32:20,779 - {'Epoch': 39, 'HR@5': '0.0512', 'NDCG@5': '0.0357', 'HR@10': '0.0747', 'NDCG@10': '0.0432', 'HR@20': '0.1057', 'NDCG@20': '0.0511'}
2025-02-24 13:32:20,781 - Validation score increased.  Saving model ...
2025-02-24 13:33:01,107 - {'epoch': 40, 'rec_loss': '7.6443'}
2025-02-24 13:33:17,847 - {'Epoch': 40, 'HR@5': '0.0516', 'NDCG@5': '0.0359', 'HR@10': '0.0744', 'NDCG@10': '0.0432', 'HR@20': '0.1051', 'NDCG@20': '0.0509'}
2025-02-24 13:33:17,848 - EarlyStopping counter: 1 out of 10
2025-02-24 13:33:58,919 - {'epoch': 41, 'rec_loss': '7.6307'}
2025-02-24 13:34:15,399 - {'Epoch': 41, 'HR@5': '0.0506', 'NDCG@5': '0.0353', 'HR@10': '0.0748', 'NDCG@10': '0.0431', 'HR@20': '0.1054', 'NDCG@20': '0.0508'}
2025-02-24 13:34:15,400 - EarlyStopping counter: 2 out of 10
2025-02-24 13:34:57,241 - {'epoch': 42, 'rec_loss': '7.6341'}
2025-02-24 13:35:13,703 - {'Epoch': 42, 'HR@5': '0.0513', 'NDCG@5': '0.0360', 'HR@10': '0.0755', 'NDCG@10': '0.0438', 'HR@20': '0.1059', 'NDCG@20': '0.0514'}
2025-02-24 13:35:13,704 - Validation score increased.  Saving model ...
2025-02-24 13:35:53,990 - {'epoch': 43, 'rec_loss': '7.6250'}
2025-02-24 13:36:10,453 - {'Epoch': 43, 'HR@5': '0.0509', 'NDCG@5': '0.0355', 'HR@10': '0.0753', 'NDCG@10': '0.0433', 'HR@20': '0.1063', 'NDCG@20': '0.0511'}
2025-02-24 13:36:10,455 - EarlyStopping counter: 1 out of 10
2025-02-24 13:36:52,758 - {'epoch': 44, 'rec_loss': '7.6223'}
2025-02-24 13:37:09,925 - {'Epoch': 44, 'HR@5': '0.0515', 'NDCG@5': '0.0358', 'HR@10': '0.0760', 'NDCG@10': '0.0437', 'HR@20': '0.1070', 'NDCG@20': '0.0515'}
2025-02-24 13:37:09,926 - Validation score increased.  Saving model ...
2025-02-24 13:37:51,495 - {'epoch': 45, 'rec_loss': '7.6203'}
2025-02-24 13:38:09,155 - {'Epoch': 45, 'HR@5': '0.0512', 'NDCG@5': '0.0357', 'HR@10': '0.0746', 'NDCG@10': '0.0433', 'HR@20': '0.1060', 'NDCG@20': '0.0512'}
2025-02-24 13:38:09,157 - EarlyStopping counter: 1 out of 10
2025-02-24 13:38:51,907 - {'epoch': 46, 'rec_loss': '7.6112'}
2025-02-24 13:39:08,366 - {'Epoch': 46, 'HR@5': '0.0509', 'NDCG@5': '0.0356', 'HR@10': '0.0750', 'NDCG@10': '0.0434', 'HR@20': '0.1053', 'NDCG@20': '0.0510'}
2025-02-24 13:39:08,371 - EarlyStopping counter: 2 out of 10
2025-02-24 13:39:49,593 - {'epoch': 47, 'rec_loss': '7.6108'}
2025-02-24 13:40:06,498 - {'Epoch': 47, 'HR@5': '0.0513', 'NDCG@5': '0.0360', 'HR@10': '0.0753', 'NDCG@10': '0.0437', 'HR@20': '0.1066', 'NDCG@20': '0.0516'}
2025-02-24 13:40:06,499 - Validation score increased.  Saving model ...
2025-02-24 13:40:49,830 - {'epoch': 48, 'rec_loss': '7.6019'}
2025-02-24 13:41:06,441 - {'Epoch': 48, 'HR@5': '0.0511', 'NDCG@5': '0.0354', 'HR@10': '0.0741', 'NDCG@10': '0.0428', 'HR@20': '0.1047', 'NDCG@20': '0.0505'}
2025-02-24 13:41:06,442 - EarlyStopping counter: 1 out of 10
2025-02-24 13:41:47,535 - {'epoch': 49, 'rec_loss': '7.5996'}
2025-02-24 13:42:04,840 - {'Epoch': 49, 'HR@5': '0.0522', 'NDCG@5': '0.0365', 'HR@10': '0.0749', 'NDCG@10': '0.0438', 'HR@20': '0.1051', 'NDCG@20': '0.0514'}
2025-02-24 13:42:04,841 - EarlyStopping counter: 2 out of 10
2025-02-24 13:42:49,720 - {'epoch': 50, 'rec_loss': '7.5962'}
2025-02-24 13:43:07,346 - {'Epoch': 50, 'HR@5': '0.0509', 'NDCG@5': '0.0355', 'HR@10': '0.0750', 'NDCG@10': '0.0432', 'HR@20': '0.1051', 'NDCG@20': '0.0508'}
2025-02-24 13:43:07,347 - EarlyStopping counter: 3 out of 10
2025-02-24 13:43:49,333 - {'epoch': 51, 'rec_loss': '7.5864'}
2025-02-24 13:44:06,057 - {'Epoch': 51, 'HR@5': '0.0511', 'NDCG@5': '0.0356', 'HR@10': '0.0746', 'NDCG@10': '0.0431', 'HR@20': '0.1056', 'NDCG@20': '0.0509'}
2025-02-24 13:44:06,059 - EarlyStopping counter: 4 out of 10
2025-02-24 13:44:46,792 - {'epoch': 52, 'rec_loss': '7.5897'}
2025-02-24 13:45:03,639 - {'Epoch': 52, 'HR@5': '0.0512', 'NDCG@5': '0.0355', 'HR@10': '0.0743', 'NDCG@10': '0.0430', 'HR@20': '0.1052', 'NDCG@20': '0.0508'}
2025-02-24 13:45:03,641 - EarlyStopping counter: 5 out of 10
2025-02-24 13:45:46,946 - {'epoch': 53, 'rec_loss': '7.5849'}
2025-02-24 13:46:03,614 - {'Epoch': 53, 'HR@5': '0.0513', 'NDCG@5': '0.0356', 'HR@10': '0.0748', 'NDCG@10': '0.0432', 'HR@20': '0.1062', 'NDCG@20': '0.0511'}
2025-02-24 13:46:03,615 - EarlyStopping counter: 6 out of 10
2025-02-24 13:46:50,961 - {'epoch': 54, 'rec_loss': '7.5790'}
2025-02-24 13:47:07,761 - {'Epoch': 54, 'HR@5': '0.0509', 'NDCG@5': '0.0352', 'HR@10': '0.0747', 'NDCG@10': '0.0429', 'HR@20': '0.1062', 'NDCG@20': '0.0508'}
2025-02-24 13:47:07,762 - EarlyStopping counter: 7 out of 10
2025-02-24 13:47:49,106 - {'epoch': 55, 'rec_loss': '7.5728'}
2025-02-24 13:48:06,003 - {'Epoch': 55, 'HR@5': '0.0516', 'NDCG@5': '0.0358', 'HR@10': '0.0737', 'NDCG@10': '0.0430', 'HR@20': '0.1058', 'NDCG@20': '0.0511'}
2025-02-24 13:48:06,005 - EarlyStopping counter: 8 out of 10
2025-02-24 13:48:47,011 - {'epoch': 56, 'rec_loss': '7.5698'}
2025-02-24 13:49:03,701 - {'Epoch': 56, 'HR@5': '0.0505', 'NDCG@5': '0.0356', 'HR@10': '0.0746', 'NDCG@10': '0.0434', 'HR@20': '0.1057', 'NDCG@20': '0.0512'}
2025-02-24 13:49:03,702 - EarlyStopping counter: 9 out of 10
2025-02-24 13:49:45,173 - {'epoch': 57, 'rec_loss': '7.5624'}
2025-02-24 13:50:01,773 - {'Epoch': 57, 'HR@5': '0.0511', 'NDCG@5': '0.0354', 'HR@10': '0.0745', 'NDCG@10': '0.0429', 'HR@20': '0.1052', 'NDCG@20': '0.0507'}
2025-02-24 13:50:01,775 - EarlyStopping counter: 10 out of 10
2025-02-24 13:50:01,775 - Early stopping
2025-02-24 13:50:01,775 - ---------------Test Score---------------
2025-02-24 13:50:18,126 - {'Epoch': 0, 'HR@5': '0.0438', 'NDCG@5': '0.0302', 'HR@10': '0.0605', 'NDCG@10': '0.0356', 'HR@20': '0.0869', 'NDCG@20': '0.0422'}
2025-02-24 13:50:18,127 - Scale_Sports
2025-02-24 13:50:18,127 - {'Epoch': 0, 'HR@5': '0.0438', 'NDCG@5': '0.0302', 'HR@10': '0.0605', 'NDCG@10': '0.0356', 'HR@20': '0.0869', 'NDCG@20': '0.0422'}
2025-02-24 13:55:46,048 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 10, 5], kernels=[4, 8, 12], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-24 13:55:48,854 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-24 13:55:48,859 - Total Parameters: 1328529
2025-02-24 13:56:41,948 - {'epoch': 0, 'rec_loss': '9.4135'}
2025-02-24 13:57:01,754 - {'Epoch': 0, 'HR@5': '0.0083', 'NDCG@5': '0.0055', 'HR@10': '0.0130', 'NDCG@10': '0.0070', 'HR@20': '0.0214', 'NDCG@20': '0.0091'}
2025-02-24 13:57:01,758 - Validation score increased.  Saving model ...
2025-02-24 13:57:53,021 - {'epoch': 1, 'rec_loss': '9.1921'}
2025-02-24 13:58:12,607 - {'Epoch': 1, 'HR@5': '0.0162', 'NDCG@5': '0.0102', 'HR@10': '0.0261', 'NDCG@10': '0.0134', 'HR@20': '0.0420', 'NDCG@20': '0.0174'}
2025-02-24 13:58:12,612 - Validation score increased.  Saving model ...
2025-02-24 13:59:03,435 - {'epoch': 2, 'rec_loss': '8.8615'}
2025-02-24 13:59:22,900 - {'Epoch': 2, 'HR@5': '0.0226', 'NDCG@5': '0.0149', 'HR@10': '0.0370', 'NDCG@10': '0.0195', 'HR@20': '0.0571', 'NDCG@20': '0.0246'}
2025-02-24 13:59:22,901 - Validation score increased.  Saving model ...
2025-02-24 14:00:13,855 - {'epoch': 3, 'rec_loss': '8.6321'}
2025-02-24 14:00:30,532 - {'Epoch': 3, 'HR@5': '0.0315', 'NDCG@5': '0.0207', 'HR@10': '0.0477', 'NDCG@10': '0.0259', 'HR@20': '0.0715', 'NDCG@20': '0.0319'}
2025-02-24 14:00:30,533 - Validation score increased.  Saving model ...
2025-02-24 14:01:21,434 - {'epoch': 4, 'rec_loss': '8.4615'}
2025-02-24 14:01:40,929 - {'Epoch': 4, 'HR@5': '0.0360', 'NDCG@5': '0.0241', 'HR@10': '0.0545', 'NDCG@10': '0.0300', 'HR@20': '0.0799', 'NDCG@20': '0.0364'}
2025-02-24 14:01:40,933 - Validation score increased.  Saving model ...
2025-02-24 14:02:31,852 - {'epoch': 5, 'rec_loss': '8.3270'}
2025-02-24 14:02:48,956 - {'Epoch': 5, 'HR@5': '0.0397', 'NDCG@5': '0.0271', 'HR@10': '0.0598', 'NDCG@10': '0.0335', 'HR@20': '0.0863', 'NDCG@20': '0.0402'}
2025-02-24 14:02:48,958 - Validation score increased.  Saving model ...
2025-02-24 14:03:40,171 - {'epoch': 6, 'rec_loss': '8.2187'}
2025-02-24 14:03:59,846 - {'Epoch': 6, 'HR@5': '0.0433', 'NDCG@5': '0.0297', 'HR@10': '0.0635', 'NDCG@10': '0.0362', 'HR@20': '0.0909', 'NDCG@20': '0.0431'}
2025-02-24 14:03:59,849 - Validation score increased.  Saving model ...
2025-02-24 14:04:50,765 - {'epoch': 7, 'rec_loss': '8.1375'}
2025-02-24 14:05:10,820 - {'Epoch': 7, 'HR@5': '0.0445', 'NDCG@5': '0.0309', 'HR@10': '0.0651', 'NDCG@10': '0.0376', 'HR@20': '0.0951', 'NDCG@20': '0.0451'}
2025-02-24 14:05:10,821 - Validation score increased.  Saving model ...
2025-02-24 14:06:01,816 - {'epoch': 8, 'rec_loss': '8.0690'}
2025-02-24 14:06:21,767 - {'Epoch': 8, 'HR@5': '0.0470', 'NDCG@5': '0.0326', 'HR@10': '0.0673', 'NDCG@10': '0.0391', 'HR@20': '0.0959', 'NDCG@20': '0.0463'}
2025-02-24 14:06:21,772 - Validation score increased.  Saving model ...
2025-02-24 14:07:14,464 - {'epoch': 9, 'rec_loss': '8.0125'}
2025-02-24 14:07:34,468 - {'Epoch': 9, 'HR@5': '0.0468', 'NDCG@5': '0.0324', 'HR@10': '0.0678', 'NDCG@10': '0.0391', 'HR@20': '0.0959', 'NDCG@20': '0.0461'}
2025-02-24 14:07:34,470 - EarlyStopping counter: 1 out of 10
2025-02-24 14:08:25,511 - {'epoch': 10, 'rec_loss': '7.9658'}
2025-02-24 14:08:42,950 - {'Epoch': 10, 'HR@5': '0.0474', 'NDCG@5': '0.0334', 'HR@10': '0.0689', 'NDCG@10': '0.0403', 'HR@20': '0.0974', 'NDCG@20': '0.0474'}
2025-02-24 14:08:42,951 - Validation score increased.  Saving model ...
2025-02-24 14:09:34,869 - {'epoch': 11, 'rec_loss': '7.9255'}
2025-02-24 14:09:52,331 - {'Epoch': 11, 'HR@5': '0.0476', 'NDCG@5': '0.0335', 'HR@10': '0.0697', 'NDCG@10': '0.0406', 'HR@20': '0.0991', 'NDCG@20': '0.0480'}
2025-02-24 14:09:52,335 - Validation score increased.  Saving model ...
2025-02-24 14:10:43,285 - {'epoch': 12, 'rec_loss': '7.8858'}
2025-02-24 14:11:03,498 - {'Epoch': 12, 'HR@5': '0.0489', 'NDCG@5': '0.0340', 'HR@10': '0.0705', 'NDCG@10': '0.0409', 'HR@20': '0.0992', 'NDCG@20': '0.0482'}
2025-02-24 14:11:03,502 - Validation score increased.  Saving model ...
2025-02-24 14:11:57,082 - {'epoch': 13, 'rec_loss': '7.8628'}
2025-02-24 14:12:17,176 - {'Epoch': 13, 'HR@5': '0.0487', 'NDCG@5': '0.0336', 'HR@10': '0.0708', 'NDCG@10': '0.0407', 'HR@20': '0.1004', 'NDCG@20': '0.0481'}
2025-02-24 14:12:17,180 - EarlyStopping counter: 1 out of 10
2025-02-24 14:13:09,644 - {'epoch': 14, 'rec_loss': '7.8326'}
2025-02-24 14:13:29,791 - {'Epoch': 14, 'HR@5': '0.0494', 'NDCG@5': '0.0345', 'HR@10': '0.0719', 'NDCG@10': '0.0418', 'HR@20': '0.1009', 'NDCG@20': '0.0491'}
2025-02-24 14:13:29,796 - Validation score increased.  Saving model ...
2025-02-24 14:14:21,860 - {'epoch': 15, 'rec_loss': '7.8122'}
2025-02-24 14:14:41,650 - {'Epoch': 15, 'HR@5': '0.0493', 'NDCG@5': '0.0344', 'HR@10': '0.0724', 'NDCG@10': '0.0418', 'HR@20': '0.1008', 'NDCG@20': '0.0490'}
2025-02-24 14:14:41,652 - EarlyStopping counter: 1 out of 10
2025-02-24 14:15:32,525 - {'epoch': 16, 'rec_loss': '7.7845'}
2025-02-24 14:15:51,626 - {'Epoch': 16, 'HR@5': '0.0505', 'NDCG@5': '0.0350', 'HR@10': '0.0715', 'NDCG@10': '0.0418', 'HR@20': '0.1014', 'NDCG@20': '0.0493'}
2025-02-24 14:15:51,628 - Validation score increased.  Saving model ...
2025-02-24 14:16:42,634 - {'epoch': 17, 'rec_loss': '7.7735'}
2025-02-24 14:17:01,854 - {'Epoch': 17, 'HR@5': '0.0498', 'NDCG@5': '0.0345', 'HR@10': '0.0728', 'NDCG@10': '0.0419', 'HR@20': '0.1014', 'NDCG@20': '0.0491'}
2025-02-24 14:17:01,860 - EarlyStopping counter: 1 out of 10
2025-02-24 14:17:52,779 - {'epoch': 18, 'rec_loss': '7.7513'}
2025-02-24 14:18:13,039 - {'Epoch': 18, 'HR@5': '0.0499', 'NDCG@5': '0.0347', 'HR@10': '0.0733', 'NDCG@10': '0.0423', 'HR@20': '0.1024', 'NDCG@20': '0.0496'}
2025-02-24 14:18:13,040 - Validation score increased.  Saving model ...
2025-02-24 14:19:04,062 - {'epoch': 19, 'rec_loss': '7.7368'}
2025-02-24 14:19:24,229 - {'Epoch': 19, 'HR@5': '0.0497', 'NDCG@5': '0.0349', 'HR@10': '0.0719', 'NDCG@10': '0.0421', 'HR@20': '0.1026', 'NDCG@20': '0.0499'}
2025-02-24 14:19:24,230 - Validation score increased.  Saving model ...
2025-02-24 14:20:15,275 - {'epoch': 20, 'rec_loss': '7.7215'}
2025-02-24 14:20:35,153 - {'Epoch': 20, 'HR@5': '0.0515', 'NDCG@5': '0.0357', 'HR@10': '0.0738', 'NDCG@10': '0.0429', 'HR@20': '0.1025', 'NDCG@20': '0.0501'}
2025-02-24 14:20:35,154 - Validation score increased.  Saving model ...
2025-02-24 14:21:26,676 - {'epoch': 21, 'rec_loss': '7.7067'}
2025-02-24 14:21:46,071 - {'Epoch': 21, 'HR@5': '0.0512', 'NDCG@5': '0.0360', 'HR@10': '0.0752', 'NDCG@10': '0.0436', 'HR@20': '0.1046', 'NDCG@20': '0.0510'}
2025-02-24 14:21:46,073 - Validation score increased.  Saving model ...
2025-02-24 14:22:37,042 - {'epoch': 22, 'rec_loss': '7.6908'}
2025-02-24 14:22:54,499 - {'Epoch': 22, 'HR@5': '0.0521', 'NDCG@5': '0.0363', 'HR@10': '0.0746', 'NDCG@10': '0.0435', 'HR@20': '0.1040', 'NDCG@20': '0.0509'}
2025-02-24 14:22:54,505 - EarlyStopping counter: 1 out of 10
2025-02-24 14:23:44,798 - {'epoch': 23, 'rec_loss': '7.6806'}
2025-02-24 14:24:04,729 - {'Epoch': 23, 'HR@5': '0.0522', 'NDCG@5': '0.0364', 'HR@10': '0.0738', 'NDCG@10': '0.0433', 'HR@20': '0.1042', 'NDCG@20': '0.0510'}
2025-02-24 14:24:04,730 - EarlyStopping counter: 2 out of 10
2025-02-24 14:24:55,635 - {'epoch': 24, 'rec_loss': '7.6664'}
2025-02-24 14:25:13,158 - {'Epoch': 24, 'HR@5': '0.0514', 'NDCG@5': '0.0355', 'HR@10': '0.0736', 'NDCG@10': '0.0427', 'HR@20': '0.1039', 'NDCG@20': '0.0503'}
2025-02-24 14:25:13,160 - EarlyStopping counter: 3 out of 10
2025-02-24 14:26:04,381 - {'epoch': 25, 'rec_loss': '7.6549'}
2025-02-24 14:26:22,001 - {'Epoch': 25, 'HR@5': '0.0520', 'NDCG@5': '0.0361', 'HR@10': '0.0746', 'NDCG@10': '0.0433', 'HR@20': '0.1042', 'NDCG@20': '0.0508'}
2025-02-24 14:26:22,005 - EarlyStopping counter: 4 out of 10
2025-02-24 14:27:13,133 - {'epoch': 26, 'rec_loss': '7.6405'}
2025-02-24 14:27:30,656 - {'Epoch': 26, 'HR@5': '0.0513', 'NDCG@5': '0.0355', 'HR@10': '0.0738', 'NDCG@10': '0.0427', 'HR@20': '0.1034', 'NDCG@20': '0.0502'}
2025-02-24 14:27:30,657 - EarlyStopping counter: 5 out of 10
2025-02-24 14:28:21,537 - {'epoch': 27, 'rec_loss': '7.6286'}
2025-02-24 14:28:41,351 - {'Epoch': 27, 'HR@5': '0.0517', 'NDCG@5': '0.0359', 'HR@10': '0.0743', 'NDCG@10': '0.0432', 'HR@20': '0.1030', 'NDCG@20': '0.0504'}
2025-02-24 14:28:41,352 - EarlyStopping counter: 6 out of 10
2025-02-24 14:29:32,298 - {'epoch': 28, 'rec_loss': '7.6187'}
2025-02-24 14:29:52,485 - {'Epoch': 28, 'HR@5': '0.0527', 'NDCG@5': '0.0367', 'HR@10': '0.0732', 'NDCG@10': '0.0433', 'HR@20': '0.1030', 'NDCG@20': '0.0508'}
2025-02-24 14:29:52,486 - EarlyStopping counter: 7 out of 10
2025-02-24 14:30:43,510 - {'epoch': 29, 'rec_loss': '7.6083'}
2025-02-24 14:31:01,065 - {'Epoch': 29, 'HR@5': '0.0511', 'NDCG@5': '0.0349', 'HR@10': '0.0748', 'NDCG@10': '0.0425', 'HR@20': '0.1046', 'NDCG@20': '0.0501'}
2025-02-24 14:31:01,067 - EarlyStopping counter: 8 out of 10
2025-02-24 14:31:52,079 - {'epoch': 30, 'rec_loss': '7.6000'}
2025-02-24 14:32:12,405 - {'Epoch': 30, 'HR@5': '0.0520', 'NDCG@5': '0.0357', 'HR@10': '0.0740', 'NDCG@10': '0.0428', 'HR@20': '0.1049', 'NDCG@20': '0.0506'}
2025-02-24 14:32:12,406 - EarlyStopping counter: 9 out of 10
2025-02-24 14:33:05,652 - {'epoch': 31, 'rec_loss': '7.5895'}
2025-02-24 14:33:24,382 - {'Epoch': 31, 'HR@5': '0.0525', 'NDCG@5': '0.0361', 'HR@10': '0.0745', 'NDCG@10': '0.0432', 'HR@20': '0.1038', 'NDCG@20': '0.0506'}
2025-02-24 14:33:24,385 - EarlyStopping counter: 10 out of 10
2025-02-24 14:33:24,385 - Early stopping
2025-02-24 14:33:24,385 - ---------------Test Score---------------
2025-02-24 14:33:41,984 - {'Epoch': 0, 'HR@5': '0.0414', 'NDCG@5': '0.0288', 'HR@10': '0.0601', 'NDCG@10': '0.0348', 'HR@20': '0.0851', 'NDCG@20': '0.0411'}
2025-02-24 14:33:41,987 - Scale_Sports
2025-02-24 14:33:41,988 - {'Epoch': 0, 'HR@5': '0.0414', 'NDCG@5': '0.0288', 'HR@10': '0.0601', 'NDCG@10': '0.0348', 'HR@20': '0.0851', 'NDCG@20': '0.0411'}
2025-02-24 14:39:05,637 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10, 5], kernels=[4, 8, 12], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-24 14:39:08,463 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-24 14:39:08,468 - Total Parameters: 1328529
2025-02-24 14:40:03,861 - {'epoch': 0, 'rec_loss': '9.4123'}
2025-02-24 14:40:23,728 - {'Epoch': 0, 'HR@5': '0.0081', 'NDCG@5': '0.0053', 'HR@10': '0.0127', 'NDCG@10': '0.0068', 'HR@20': '0.0217', 'NDCG@20': '0.0090'}
2025-02-24 14:40:23,732 - Validation score increased.  Saving model ...
2025-02-24 14:41:16,034 - {'epoch': 1, 'rec_loss': '9.1620'}
2025-02-24 14:41:35,060 - {'Epoch': 1, 'HR@5': '0.0158', 'NDCG@5': '0.0101', 'HR@10': '0.0255', 'NDCG@10': '0.0132', 'HR@20': '0.0415', 'NDCG@20': '0.0172'}
2025-02-24 14:41:35,062 - Validation score increased.  Saving model ...
2025-02-24 14:42:27,149 - {'epoch': 2, 'rec_loss': '8.8450'}
2025-02-24 14:42:45,432 - {'Epoch': 2, 'HR@5': '0.0230', 'NDCG@5': '0.0153', 'HR@10': '0.0381', 'NDCG@10': '0.0201', 'HR@20': '0.0573', 'NDCG@20': '0.0250'}
2025-02-24 14:42:45,436 - Validation score increased.  Saving model ...
2025-02-24 14:43:37,782 - {'epoch': 3, 'rec_loss': '8.6227'}
2025-02-24 14:43:56,762 - {'Epoch': 3, 'HR@5': '0.0302', 'NDCG@5': '0.0199', 'HR@10': '0.0459', 'NDCG@10': '0.0250', 'HR@20': '0.0700', 'NDCG@20': '0.0310'}
2025-02-24 14:43:56,766 - Validation score increased.  Saving model ...
2025-02-24 14:44:49,025 - {'epoch': 4, 'rec_loss': '8.4567'}
2025-02-24 14:45:06,037 - {'Epoch': 4, 'HR@5': '0.0364', 'NDCG@5': '0.0241', 'HR@10': '0.0546', 'NDCG@10': '0.0299', 'HR@20': '0.0795', 'NDCG@20': '0.0362'}
2025-02-24 14:45:06,041 - Validation score increased.  Saving model ...
2025-02-24 14:46:03,123 - {'epoch': 5, 'rec_loss': '8.3262'}
2025-02-24 14:46:23,249 - {'Epoch': 5, 'HR@5': '0.0405', 'NDCG@5': '0.0273', 'HR@10': '0.0599', 'NDCG@10': '0.0336', 'HR@20': '0.0862', 'NDCG@20': '0.0401'}
2025-02-24 14:46:23,251 - Validation score increased.  Saving model ...
2025-02-24 14:47:15,127 - {'epoch': 6, 'rec_loss': '8.2229'}
2025-02-24 14:47:33,492 - {'Epoch': 6, 'HR@5': '0.0428', 'NDCG@5': '0.0287', 'HR@10': '0.0623', 'NDCG@10': '0.0350', 'HR@20': '0.0883', 'NDCG@20': '0.0415'}
2025-02-24 14:47:33,493 - Validation score increased.  Saving model ...
2025-02-24 14:48:25,458 - {'epoch': 7, 'rec_loss': '8.1416'}
2025-02-24 14:48:43,573 - {'Epoch': 7, 'HR@5': '0.0453', 'NDCG@5': '0.0309', 'HR@10': '0.0654', 'NDCG@10': '0.0373', 'HR@20': '0.0927', 'NDCG@20': '0.0442'}
2025-02-24 14:48:43,581 - Validation score increased.  Saving model ...
2025-02-24 14:49:35,716 - {'epoch': 8, 'rec_loss': '8.0721'}
2025-02-24 14:49:55,364 - {'Epoch': 8, 'HR@5': '0.0450', 'NDCG@5': '0.0312', 'HR@10': '0.0667', 'NDCG@10': '0.0382', 'HR@20': '0.0957', 'NDCG@20': '0.0455'}
2025-02-24 14:49:55,366 - Validation score increased.  Saving model ...
2025-02-24 14:50:47,636 - {'epoch': 9, 'rec_loss': '8.0116'}
2025-02-24 14:51:04,900 - {'Epoch': 9, 'HR@5': '0.0474', 'NDCG@5': '0.0322', 'HR@10': '0.0686', 'NDCG@10': '0.0390', 'HR@20': '0.0957', 'NDCG@20': '0.0458'}
2025-02-24 14:51:04,901 - Validation score increased.  Saving model ...
2025-02-24 14:51:57,241 - {'epoch': 10, 'rec_loss': '7.9688'}
2025-02-24 14:52:15,939 - {'Epoch': 10, 'HR@5': '0.0484', 'NDCG@5': '0.0329', 'HR@10': '0.0699', 'NDCG@10': '0.0398', 'HR@20': '0.0989', 'NDCG@20': '0.0471'}
2025-02-24 14:52:15,940 - Validation score increased.  Saving model ...
2025-02-24 14:53:08,045 - {'epoch': 11, 'rec_loss': '7.9270'}
2025-02-24 14:53:25,538 - {'Epoch': 11, 'HR@5': '0.0482', 'NDCG@5': '0.0334', 'HR@10': '0.0704', 'NDCG@10': '0.0406', 'HR@20': '0.0988', 'NDCG@20': '0.0477'}
2025-02-24 14:53:25,541 - Validation score increased.  Saving model ...
2025-02-24 14:54:22,065 - {'epoch': 12, 'rec_loss': '7.8942'}
2025-02-24 14:54:39,355 - {'Epoch': 12, 'HR@5': '0.0482', 'NDCG@5': '0.0334', 'HR@10': '0.0699', 'NDCG@10': '0.0404', 'HR@20': '0.0991', 'NDCG@20': '0.0477'}
2025-02-24 14:54:39,361 - EarlyStopping counter: 1 out of 10
2025-02-24 14:55:31,355 - {'epoch': 13, 'rec_loss': '7.8578'}
2025-02-24 14:55:51,102 - {'Epoch': 13, 'HR@5': '0.0488', 'NDCG@5': '0.0335', 'HR@10': '0.0706', 'NDCG@10': '0.0406', 'HR@20': '0.1001', 'NDCG@20': '0.0480'}
2025-02-24 14:55:51,103 - Validation score increased.  Saving model ...
2025-02-24 14:56:43,835 - {'epoch': 14, 'rec_loss': '7.8303'}
2025-02-24 14:57:01,119 - {'Epoch': 14, 'HR@5': '0.0495', 'NDCG@5': '0.0340', 'HR@10': '0.0719', 'NDCG@10': '0.0412', 'HR@20': '0.1003', 'NDCG@20': '0.0483'}
2025-02-24 14:57:01,121 - Validation score increased.  Saving model ...
2025-02-24 14:57:53,334 - {'epoch': 15, 'rec_loss': '7.8087'}
2025-02-24 14:58:13,199 - {'Epoch': 15, 'HR@5': '0.0508', 'NDCG@5': '0.0349', 'HR@10': '0.0716', 'NDCG@10': '0.0415', 'HR@20': '0.1008', 'NDCG@20': '0.0489'}
2025-02-24 14:58:13,202 - Validation score increased.  Saving model ...
2025-02-24 14:59:07,166 - {'epoch': 16, 'rec_loss': '7.7878'}
2025-02-24 14:59:24,246 - {'Epoch': 16, 'HR@5': '0.0509', 'NDCG@5': '0.0347', 'HR@10': '0.0724', 'NDCG@10': '0.0416', 'HR@20': '0.1027', 'NDCG@20': '0.0492'}
2025-02-24 14:59:24,247 - Validation score increased.  Saving model ...
2025-02-24 15:00:17,392 - {'epoch': 17, 'rec_loss': '7.7663'}
2025-02-24 15:00:35,538 - {'Epoch': 17, 'HR@5': '0.0508', 'NDCG@5': '0.0351', 'HR@10': '0.0720', 'NDCG@10': '0.0420', 'HR@20': '0.1021', 'NDCG@20': '0.0495'}
2025-02-24 15:00:35,544 - Validation score increased.  Saving model ...
2025-02-24 15:01:32,193 - {'epoch': 18, 'rec_loss': '7.7423'}
2025-02-24 15:01:50,163 - {'Epoch': 18, 'HR@5': '0.0509', 'NDCG@5': '0.0353', 'HR@10': '0.0725', 'NDCG@10': '0.0422', 'HR@20': '0.1015', 'NDCG@20': '0.0495'}
2025-02-24 15:01:50,164 - Validation score increased.  Saving model ...
2025-02-24 15:02:44,621 - {'epoch': 19, 'rec_loss': '7.7305'}
2025-02-24 15:03:02,372 - {'Epoch': 19, 'HR@5': '0.0503', 'NDCG@5': '0.0347', 'HR@10': '0.0721', 'NDCG@10': '0.0417', 'HR@20': '0.1014', 'NDCG@20': '0.0490'}
2025-02-24 15:03:02,378 - EarlyStopping counter: 1 out of 10
2025-02-24 15:03:54,604 - {'epoch': 20, 'rec_loss': '7.7112'}
2025-02-24 15:04:14,620 - {'Epoch': 20, 'HR@5': '0.0504', 'NDCG@5': '0.0350', 'HR@10': '0.0738', 'NDCG@10': '0.0426', 'HR@20': '0.1032', 'NDCG@20': '0.0499'}
2025-02-24 15:04:14,625 - Validation score increased.  Saving model ...
2025-02-24 15:05:07,209 - {'epoch': 21, 'rec_loss': '7.6951'}
2025-02-24 15:05:24,985 - {'Epoch': 21, 'HR@5': '0.0514', 'NDCG@5': '0.0355', 'HR@10': '0.0733', 'NDCG@10': '0.0425', 'HR@20': '0.1032', 'NDCG@20': '0.0500'}
2025-02-24 15:05:24,988 - Validation score increased.  Saving model ...
2025-02-24 15:06:18,438 - {'epoch': 22, 'rec_loss': '7.6839'}
2025-02-24 15:06:35,961 - {'Epoch': 22, 'HR@5': '0.0522', 'NDCG@5': '0.0360', 'HR@10': '0.0743', 'NDCG@10': '0.0431', 'HR@20': '0.1032', 'NDCG@20': '0.0504'}
2025-02-24 15:06:35,965 - Validation score increased.  Saving model ...
2025-02-24 15:07:31,288 - {'epoch': 23, 'rec_loss': '7.6653'}
2025-02-24 15:07:52,044 - {'Epoch': 23, 'HR@5': '0.0511', 'NDCG@5': '0.0351', 'HR@10': '0.0730', 'NDCG@10': '0.0422', 'HR@20': '0.1037', 'NDCG@20': '0.0499'}
2025-02-24 15:07:52,049 - EarlyStopping counter: 1 out of 10
2025-02-24 15:08:46,181 - {'epoch': 24, 'rec_loss': '7.6548'}
2025-02-24 15:09:05,327 - {'Epoch': 24, 'HR@5': '0.0511', 'NDCG@5': '0.0353', 'HR@10': '0.0744', 'NDCG@10': '0.0428', 'HR@20': '0.1026', 'NDCG@20': '0.0499'}
2025-02-24 15:09:05,330 - EarlyStopping counter: 2 out of 10
2025-02-24 15:10:02,528 - {'epoch': 25, 'rec_loss': '7.6426'}
2025-02-24 15:10:23,260 - {'Epoch': 25, 'HR@5': '0.0512', 'NDCG@5': '0.0358', 'HR@10': '0.0752', 'NDCG@10': '0.0435', 'HR@20': '0.1048', 'NDCG@20': '0.0510'}
2025-02-24 15:10:23,267 - Validation score increased.  Saving model ...
2025-02-24 15:11:19,494 - {'epoch': 26, 'rec_loss': '7.6351'}
2025-02-24 15:11:37,426 - {'Epoch': 26, 'HR@5': '0.0513', 'NDCG@5': '0.0356', 'HR@10': '0.0744', 'NDCG@10': '0.0430', 'HR@20': '0.1040', 'NDCG@20': '0.0505'}
2025-02-24 15:11:37,427 - EarlyStopping counter: 1 out of 10
2025-02-24 15:12:29,384 - {'epoch': 27, 'rec_loss': '7.6217'}
2025-02-24 15:12:46,906 - {'Epoch': 27, 'HR@5': '0.0507', 'NDCG@5': '0.0353', 'HR@10': '0.0730', 'NDCG@10': '0.0424', 'HR@20': '0.1046', 'NDCG@20': '0.0504'}
2025-02-24 15:12:46,908 - EarlyStopping counter: 2 out of 10
2025-02-24 15:13:37,882 - {'epoch': 28, 'rec_loss': '7.6113'}
2025-02-24 15:13:57,489 - {'Epoch': 28, 'HR@5': '0.0518', 'NDCG@5': '0.0357', 'HR@10': '0.0735', 'NDCG@10': '0.0427', 'HR@20': '0.1041', 'NDCG@20': '0.0504'}
2025-02-24 15:13:57,490 - EarlyStopping counter: 3 out of 10
2025-02-24 15:14:48,829 - {'epoch': 29, 'rec_loss': '7.5986'}
2025-02-24 15:15:08,390 - {'Epoch': 29, 'HR@5': '0.0523', 'NDCG@5': '0.0364', 'HR@10': '0.0749', 'NDCG@10': '0.0437', 'HR@20': '0.1049', 'NDCG@20': '0.0512'}
2025-02-24 15:15:08,393 - Validation score increased.  Saving model ...
2025-02-24 15:16:05,176 - {'epoch': 30, 'rec_loss': '7.5933'}
2025-02-24 15:16:25,025 - {'Epoch': 30, 'HR@5': '0.0516', 'NDCG@5': '0.0359', 'HR@10': '0.0737', 'NDCG@10': '0.0430', 'HR@20': '0.1044', 'NDCG@20': '0.0508'}
2025-02-24 15:16:25,031 - EarlyStopping counter: 1 out of 10
2025-02-24 15:17:16,235 - {'epoch': 31, 'rec_loss': '7.5817'}
2025-02-24 15:17:33,625 - {'Epoch': 31, 'HR@5': '0.0502', 'NDCG@5': '0.0349', 'HR@10': '0.0734', 'NDCG@10': '0.0423', 'HR@20': '0.1041', 'NDCG@20': '0.0501'}
2025-02-24 15:17:33,632 - EarlyStopping counter: 2 out of 10
2025-02-24 15:18:25,567 - {'epoch': 32, 'rec_loss': '7.5732'}
2025-02-24 15:18:43,555 - {'Epoch': 32, 'HR@5': '0.0498', 'NDCG@5': '0.0350', 'HR@10': '0.0740', 'NDCG@10': '0.0427', 'HR@20': '0.1051', 'NDCG@20': '0.0506'}
2025-02-24 15:18:43,559 - EarlyStopping counter: 3 out of 10
2025-02-24 15:19:36,194 - {'epoch': 33, 'rec_loss': '7.5679'}
2025-02-24 15:19:53,614 - {'Epoch': 33, 'HR@5': '0.0512', 'NDCG@5': '0.0355', 'HR@10': '0.0731', 'NDCG@10': '0.0425', 'HR@20': '0.1042', 'NDCG@20': '0.0503'}
2025-02-24 15:19:53,618 - EarlyStopping counter: 4 out of 10
2025-02-24 15:20:50,305 - {'epoch': 34, 'rec_loss': '7.5603'}
2025-02-24 15:21:10,261 - {'Epoch': 34, 'HR@5': '0.0513', 'NDCG@5': '0.0355', 'HR@10': '0.0735', 'NDCG@10': '0.0427', 'HR@20': '0.1036', 'NDCG@20': '0.0502'}
2025-02-24 15:21:10,266 - EarlyStopping counter: 5 out of 10
2025-02-24 15:22:01,250 - {'epoch': 35, 'rec_loss': '7.5486'}
2025-02-24 15:22:18,691 - {'Epoch': 35, 'HR@5': '0.0503', 'NDCG@5': '0.0349', 'HR@10': '0.0726', 'NDCG@10': '0.0421', 'HR@20': '0.1031', 'NDCG@20': '0.0497'}
2025-02-24 15:22:18,694 - EarlyStopping counter: 6 out of 10
2025-02-24 15:23:12,307 - {'epoch': 36, 'rec_loss': '7.5469'}
2025-02-24 15:23:29,760 - {'Epoch': 36, 'HR@5': '0.0514', 'NDCG@5': '0.0354', 'HR@10': '0.0725', 'NDCG@10': '0.0422', 'HR@20': '0.1046', 'NDCG@20': '0.0503'}
2025-02-24 15:23:29,764 - EarlyStopping counter: 7 out of 10
2025-02-24 15:24:22,377 - {'epoch': 37, 'rec_loss': '7.5403'}
2025-02-24 15:24:39,730 - {'Epoch': 37, 'HR@5': '0.0503', 'NDCG@5': '0.0348', 'HR@10': '0.0740', 'NDCG@10': '0.0424', 'HR@20': '0.1040', 'NDCG@20': '0.0499'}
2025-02-24 15:24:39,731 - EarlyStopping counter: 8 out of 10
2025-02-24 15:25:31,884 - {'epoch': 38, 'rec_loss': '7.5293'}
2025-02-24 15:25:49,235 - {'Epoch': 38, 'HR@5': '0.0508', 'NDCG@5': '0.0352', 'HR@10': '0.0717', 'NDCG@10': '0.0419', 'HR@20': '0.1031', 'NDCG@20': '0.0498'}
2025-02-24 15:25:49,236 - EarlyStopping counter: 9 out of 10
2025-02-24 15:26:41,730 - {'epoch': 39, 'rec_loss': '7.5239'}
2025-02-24 15:27:01,854 - {'Epoch': 39, 'HR@5': '0.0498', 'NDCG@5': '0.0348', 'HR@10': '0.0732', 'NDCG@10': '0.0423', 'HR@20': '0.1041', 'NDCG@20': '0.0501'}
2025-02-24 15:27:01,855 - EarlyStopping counter: 10 out of 10
2025-02-24 15:27:01,855 - Early stopping
2025-02-24 15:27:01,855 - ---------------Test Score---------------
2025-02-24 15:27:20,898 - {'Epoch': 0, 'HR@5': '0.0419', 'NDCG@5': '0.0290', 'HR@10': '0.0609', 'NDCG@10': '0.0351', 'HR@20': '0.0857', 'NDCG@20': '0.0413'}
2025-02-24 15:27:20,901 - Scale_Sports
2025-02-24 15:27:20,902 - {'Epoch': 0, 'HR@5': '0.0419', 'NDCG@5': '0.0290', 'HR@10': '0.0609', 'NDCG@10': '0.0351', 'HR@20': '0.0857', 'NDCG@20': '0.0413'}
2025-02-24 15:29:47,413 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25, 5], kernels=[4, 8, 12], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-24 15:29:50,232 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-24 15:29:50,237 - Total Parameters: 1328529
2025-02-24 15:30:49,480 - {'epoch': 0, 'rec_loss': '9.4138'}
2025-02-24 15:31:08,642 - {'Epoch': 0, 'HR@5': '0.0084', 'NDCG@5': '0.0055', 'HR@10': '0.0127', 'NDCG@10': '0.0069', 'HR@20': '0.0221', 'NDCG@20': '0.0093'}
2025-02-24 15:31:08,646 - Validation score increased.  Saving model ...
2025-02-24 15:31:59,625 - {'epoch': 1, 'rec_loss': '9.1855'}
2025-02-24 15:32:18,648 - {'Epoch': 1, 'HR@5': '0.0160', 'NDCG@5': '0.0102', 'HR@10': '0.0263', 'NDCG@10': '0.0135', 'HR@20': '0.0419', 'NDCG@20': '0.0174'}
2025-02-24 15:32:18,649 - Validation score increased.  Saving model ...
2025-02-24 15:33:15,185 - {'epoch': 2, 'rec_loss': '8.8605'}
2025-02-24 15:33:34,757 - {'Epoch': 2, 'HR@5': '0.0225', 'NDCG@5': '0.0143', 'HR@10': '0.0359', 'NDCG@10': '0.0186', 'HR@20': '0.0564', 'NDCG@20': '0.0238'}
2025-02-24 15:33:34,760 - Validation score increased.  Saving model ...
2025-02-24 15:34:25,726 - {'epoch': 3, 'rec_loss': '8.6388'}
2025-02-24 15:34:44,325 - {'Epoch': 3, 'HR@5': '0.0304', 'NDCG@5': '0.0198', 'HR@10': '0.0477', 'NDCG@10': '0.0253', 'HR@20': '0.0727', 'NDCG@20': '0.0315'}
2025-02-24 15:34:44,328 - Validation score increased.  Saving model ...
2025-02-24 15:35:34,155 - {'epoch': 4, 'rec_loss': '8.4684'}
2025-02-24 15:35:51,344 - {'Epoch': 4, 'HR@5': '0.0360', 'NDCG@5': '0.0246', 'HR@10': '0.0536', 'NDCG@10': '0.0303', 'HR@20': '0.0804', 'NDCG@20': '0.0370'}
2025-02-24 15:35:51,346 - Validation score increased.  Saving model ...
2025-02-24 15:36:45,311 - {'epoch': 5, 'rec_loss': '8.3376'}
2025-02-24 15:37:03,348 - {'Epoch': 5, 'HR@5': '0.0400', 'NDCG@5': '0.0272', 'HR@10': '0.0594', 'NDCG@10': '0.0334', 'HR@20': '0.0844', 'NDCG@20': '0.0398'}
2025-02-24 15:37:03,351 - Validation score increased.  Saving model ...
2025-02-24 15:37:58,499 - {'epoch': 6, 'rec_loss': '8.2313'}
2025-02-24 15:38:16,147 - {'Epoch': 6, 'HR@5': '0.0421', 'NDCG@5': '0.0288', 'HR@10': '0.0619', 'NDCG@10': '0.0352', 'HR@20': '0.0879', 'NDCG@20': '0.0417'}
2025-02-24 15:38:16,148 - Validation score increased.  Saving model ...
2025-02-24 15:39:10,371 - {'epoch': 7, 'rec_loss': '8.1461'}
2025-02-24 15:39:28,667 - {'Epoch': 7, 'HR@5': '0.0438', 'NDCG@5': '0.0304', 'HR@10': '0.0642', 'NDCG@10': '0.0370', 'HR@20': '0.0909', 'NDCG@20': '0.0437'}
2025-02-24 15:39:28,671 - Validation score increased.  Saving model ...
2025-02-24 15:40:20,444 - {'epoch': 8, 'rec_loss': '8.0783'}
2025-02-24 15:40:37,966 - {'Epoch': 8, 'HR@5': '0.0450', 'NDCG@5': '0.0313', 'HR@10': '0.0649', 'NDCG@10': '0.0377', 'HR@20': '0.0940', 'NDCG@20': '0.0450'}
2025-02-24 15:40:37,967 - Validation score increased.  Saving model ...
2025-02-24 15:41:31,266 - {'epoch': 9, 'rec_loss': '8.0178'}
2025-02-24 15:41:48,361 - {'Epoch': 9, 'HR@5': '0.0460', 'NDCG@5': '0.0322', 'HR@10': '0.0656', 'NDCG@10': '0.0385', 'HR@20': '0.0948', 'NDCG@20': '0.0459'}
2025-02-24 15:41:48,366 - Validation score increased.  Saving model ...
2025-02-24 15:42:39,796 - {'epoch': 10, 'rec_loss': '7.9714'}
2025-02-24 15:42:57,196 - {'Epoch': 10, 'HR@5': '0.0478', 'NDCG@5': '0.0333', 'HR@10': '0.0680', 'NDCG@10': '0.0399', 'HR@20': '0.0967', 'NDCG@20': '0.0471'}
2025-02-24 15:42:57,199 - Validation score increased.  Saving model ...
2025-02-24 15:43:51,062 - {'epoch': 11, 'rec_loss': '7.9299'}
2025-02-24 15:44:08,404 - {'Epoch': 11, 'HR@5': '0.0474', 'NDCG@5': '0.0334', 'HR@10': '0.0682', 'NDCG@10': '0.0401', 'HR@20': '0.0970', 'NDCG@20': '0.0473'}
2025-02-24 15:44:08,406 - Validation score increased.  Saving model ...
2025-02-24 15:45:00,018 - {'epoch': 12, 'rec_loss': '7.8919'}
2025-02-24 15:45:20,021 - {'Epoch': 12, 'HR@5': '0.0487', 'NDCG@5': '0.0340', 'HR@10': '0.0701', 'NDCG@10': '0.0409', 'HR@20': '0.0989', 'NDCG@20': '0.0481'}
2025-02-24 15:45:20,022 - Validation score increased.  Saving model ...
2025-02-24 15:46:12,349 - {'epoch': 13, 'rec_loss': '7.8643'}
2025-02-24 15:46:31,331 - {'Epoch': 13, 'HR@5': '0.0487', 'NDCG@5': '0.0338', 'HR@10': '0.0705', 'NDCG@10': '0.0409', 'HR@20': '0.0989', 'NDCG@20': '0.0480'}
2025-02-24 15:46:31,332 - EarlyStopping counter: 1 out of 10
2025-02-24 15:47:26,472 - {'epoch': 14, 'rec_loss': '7.8341'}
2025-02-24 15:47:44,625 - {'Epoch': 14, 'HR@5': '0.0482', 'NDCG@5': '0.0338', 'HR@10': '0.0702', 'NDCG@10': '0.0409', 'HR@20': '0.1013', 'NDCG@20': '0.0488'}
2025-02-24 15:47:44,628 - Validation score increased.  Saving model ...
2025-02-24 15:48:35,691 - {'epoch': 15, 'rec_loss': '7.8111'}
2025-02-24 15:48:55,664 - {'Epoch': 15, 'HR@5': '0.0498', 'NDCG@5': '0.0348', 'HR@10': '0.0714', 'NDCG@10': '0.0418', 'HR@20': '0.1021', 'NDCG@20': '0.0495'}
2025-02-24 15:48:55,667 - Validation score increased.  Saving model ...
2025-02-24 15:49:48,302 - {'epoch': 16, 'rec_loss': '7.7835'}
2025-02-24 15:50:07,378 - {'Epoch': 16, 'HR@5': '0.0496', 'NDCG@5': '0.0347', 'HR@10': '0.0708', 'NDCG@10': '0.0415', 'HR@20': '0.1013', 'NDCG@20': '0.0492'}
2025-02-24 15:50:07,379 - EarlyStopping counter: 1 out of 10
2025-02-24 15:51:02,320 - {'epoch': 17, 'rec_loss': '7.7636'}
2025-02-24 15:51:20,137 - {'Epoch': 17, 'HR@5': '0.0503', 'NDCG@5': '0.0350', 'HR@10': '0.0716', 'NDCG@10': '0.0419', 'HR@20': '0.1027', 'NDCG@20': '0.0497'}
2025-02-24 15:51:20,143 - Validation score increased.  Saving model ...
2025-02-24 15:52:16,961 - {'epoch': 18, 'rec_loss': '7.7441'}
2025-02-24 15:52:34,501 - {'Epoch': 18, 'HR@5': '0.0504', 'NDCG@5': '0.0353', 'HR@10': '0.0720', 'NDCG@10': '0.0422', 'HR@20': '0.1025', 'NDCG@20': '0.0499'}
2025-02-24 15:52:34,505 - Validation score increased.  Saving model ...
2025-02-24 15:53:26,974 - {'epoch': 19, 'rec_loss': '7.7272'}
2025-02-24 15:53:44,303 - {'Epoch': 19, 'HR@5': '0.0496', 'NDCG@5': '0.0350', 'HR@10': '0.0725', 'NDCG@10': '0.0424', 'HR@20': '0.1015', 'NDCG@20': '0.0497'}
2025-02-24 15:53:44,307 - EarlyStopping counter: 1 out of 10
2025-02-24 15:54:38,678 - {'epoch': 20, 'rec_loss': '7.7065'}
2025-02-24 15:54:56,202 - {'Epoch': 20, 'HR@5': '0.0504', 'NDCG@5': '0.0353', 'HR@10': '0.0726', 'NDCG@10': '0.0424', 'HR@20': '0.1026', 'NDCG@20': '0.0500'}
2025-02-24 15:54:56,204 - Validation score increased.  Saving model ...
2025-02-24 15:55:51,406 - {'epoch': 21, 'rec_loss': '7.6934'}
2025-02-24 15:56:08,927 - {'Epoch': 21, 'HR@5': '0.0513', 'NDCG@5': '0.0359', 'HR@10': '0.0739', 'NDCG@10': '0.0432', 'HR@20': '0.1047', 'NDCG@20': '0.0510'}
2025-02-24 15:56:08,933 - Validation score increased.  Saving model ...
2025-02-24 15:57:08,288 - {'epoch': 22, 'rec_loss': '7.6789'}
2025-02-24 15:57:25,557 - {'Epoch': 22, 'HR@5': '0.0508', 'NDCG@5': '0.0354', 'HR@10': '0.0732', 'NDCG@10': '0.0427', 'HR@20': '0.1043', 'NDCG@20': '0.0505'}
2025-02-24 15:57:25,558 - EarlyStopping counter: 1 out of 10
2025-02-24 15:58:20,916 - {'epoch': 23, 'rec_loss': '7.6629'}
2025-02-24 15:58:38,534 - {'Epoch': 23, 'HR@5': '0.0521', 'NDCG@5': '0.0364', 'HR@10': '0.0739', 'NDCG@10': '0.0434', 'HR@20': '0.1049', 'NDCG@20': '0.0512'}
2025-02-24 15:58:38,536 - Validation score increased.  Saving model ...
2025-02-24 15:59:33,745 - {'epoch': 24, 'rec_loss': '7.6507'}
2025-02-24 15:59:52,011 - {'Epoch': 24, 'HR@5': '0.0512', 'NDCG@5': '0.0358', 'HR@10': '0.0734', 'NDCG@10': '0.0430', 'HR@20': '0.1037', 'NDCG@20': '0.0506'}
2025-02-24 15:59:52,012 - EarlyStopping counter: 1 out of 10
2025-02-24 16:00:44,632 - {'epoch': 25, 'rec_loss': '7.6392'}
2025-02-24 16:01:02,567 - {'Epoch': 25, 'HR@5': '0.0519', 'NDCG@5': '0.0360', 'HR@10': '0.0746', 'NDCG@10': '0.0433', 'HR@20': '0.1057', 'NDCG@20': '0.0511'}
2025-02-24 16:01:02,571 - EarlyStopping counter: 2 out of 10
2025-02-24 16:01:54,306 - {'epoch': 26, 'rec_loss': '7.6293'}
2025-02-24 16:02:11,534 - {'Epoch': 26, 'HR@5': '0.0503', 'NDCG@5': '0.0351', 'HR@10': '0.0733', 'NDCG@10': '0.0426', 'HR@20': '0.1027', 'NDCG@20': '0.0500'}
2025-02-24 16:02:11,535 - EarlyStopping counter: 3 out of 10
2025-02-24 16:03:06,445 - {'epoch': 27, 'rec_loss': '7.6124'}
2025-02-24 16:03:23,933 - {'Epoch': 27, 'HR@5': '0.0515', 'NDCG@5': '0.0354', 'HR@10': '0.0742', 'NDCG@10': '0.0427', 'HR@20': '0.1047', 'NDCG@20': '0.0504'}
2025-02-24 16:03:23,935 - EarlyStopping counter: 4 out of 10
2025-02-24 16:04:13,394 - {'epoch': 28, 'rec_loss': '7.6033'}
2025-02-24 16:04:30,794 - {'Epoch': 28, 'HR@5': '0.0508', 'NDCG@5': '0.0355', 'HR@10': '0.0744', 'NDCG@10': '0.0431', 'HR@20': '0.1059', 'NDCG@20': '0.0511'}
2025-02-24 16:04:30,801 - EarlyStopping counter: 5 out of 10
2025-02-24 16:05:24,981 - {'epoch': 29, 'rec_loss': '7.5987'}
2025-02-24 16:05:43,152 - {'Epoch': 29, 'HR@5': '0.0530', 'NDCG@5': '0.0368', 'HR@10': '0.0746', 'NDCG@10': '0.0437', 'HR@20': '0.1065', 'NDCG@20': '0.0517'}
2025-02-24 16:05:43,156 - Validation score increased.  Saving model ...
2025-02-24 16:06:36,103 - {'epoch': 30, 'rec_loss': '7.5879'}
2025-02-24 16:06:53,707 - {'Epoch': 30, 'HR@5': '0.0517', 'NDCG@5': '0.0362', 'HR@10': '0.0753', 'NDCG@10': '0.0438', 'HR@20': '0.1060', 'NDCG@20': '0.0515'}
2025-02-24 16:06:53,713 - EarlyStopping counter: 1 out of 10
2025-02-24 16:07:46,027 - {'epoch': 31, 'rec_loss': '7.5769'}
2025-02-24 16:08:03,626 - {'Epoch': 31, 'HR@5': '0.0517', 'NDCG@5': '0.0359', 'HR@10': '0.0751', 'NDCG@10': '0.0434', 'HR@20': '0.1042', 'NDCG@20': '0.0507'}
2025-02-24 16:08:03,627 - EarlyStopping counter: 2 out of 10
2025-02-24 16:08:59,752 - {'epoch': 32, 'rec_loss': '7.5692'}
2025-02-24 16:09:17,586 - {'Epoch': 32, 'HR@5': '0.0515', 'NDCG@5': '0.0355', 'HR@10': '0.0753', 'NDCG@10': '0.0431', 'HR@20': '0.1054', 'NDCG@20': '0.0506'}
2025-02-24 16:09:17,588 - EarlyStopping counter: 3 out of 10
2025-02-24 16:10:09,426 - {'epoch': 33, 'rec_loss': '7.5635'}
2025-02-24 16:10:26,754 - {'Epoch': 33, 'HR@5': '0.0512', 'NDCG@5': '0.0353', 'HR@10': '0.0742', 'NDCG@10': '0.0428', 'HR@20': '0.1046', 'NDCG@20': '0.0504'}
2025-02-24 16:10:26,760 - EarlyStopping counter: 4 out of 10
2025-02-24 16:11:17,635 - {'epoch': 34, 'rec_loss': '7.5536'}
2025-02-24 16:11:35,101 - {'Epoch': 34, 'HR@5': '0.0522', 'NDCG@5': '0.0360', 'HR@10': '0.0749', 'NDCG@10': '0.0433', 'HR@20': '0.1041', 'NDCG@20': '0.0507'}
2025-02-24 16:11:35,104 - EarlyStopping counter: 5 out of 10
2025-02-24 16:12:26,671 - {'epoch': 35, 'rec_loss': '7.5440'}
2025-02-24 16:12:44,548 - {'Epoch': 35, 'HR@5': '0.0531', 'NDCG@5': '0.0368', 'HR@10': '0.0751', 'NDCG@10': '0.0439', 'HR@20': '0.1059', 'NDCG@20': '0.0516'}
2025-02-24 16:12:44,550 - EarlyStopping counter: 6 out of 10
2025-02-24 16:13:37,324 - {'epoch': 36, 'rec_loss': '7.5428'}
2025-02-24 16:13:54,995 - {'Epoch': 36, 'HR@5': '0.0527', 'NDCG@5': '0.0365', 'HR@10': '0.0746', 'NDCG@10': '0.0436', 'HR@20': '0.1037', 'NDCG@20': '0.0509'}
2025-02-24 16:13:54,999 - EarlyStopping counter: 7 out of 10
2025-02-24 16:14:46,443 - {'epoch': 37, 'rec_loss': '7.5281'}
2025-02-24 16:15:04,118 - {'Epoch': 37, 'HR@5': '0.0529', 'NDCG@5': '0.0368', 'HR@10': '0.0763', 'NDCG@10': '0.0443', 'HR@20': '0.1060', 'NDCG@20': '0.0518'}
2025-02-24 16:15:04,122 - Validation score increased.  Saving model ...
2025-02-24 16:15:56,406 - {'epoch': 38, 'rec_loss': '7.5242'}
2025-02-24 16:16:16,079 - {'Epoch': 38, 'HR@5': '0.0522', 'NDCG@5': '0.0361', 'HR@10': '0.0749', 'NDCG@10': '0.0435', 'HR@20': '0.1043', 'NDCG@20': '0.0509'}
2025-02-24 16:16:16,081 - EarlyStopping counter: 1 out of 10
2025-02-24 16:17:07,876 - {'epoch': 39, 'rec_loss': '7.5198'}
2025-02-24 16:17:25,609 - {'Epoch': 39, 'HR@5': '0.0528', 'NDCG@5': '0.0365', 'HR@10': '0.0749', 'NDCG@10': '0.0436', 'HR@20': '0.1053', 'NDCG@20': '0.0512'}
2025-02-24 16:17:25,611 - EarlyStopping counter: 2 out of 10
2025-02-24 16:18:17,286 - {'epoch': 40, 'rec_loss': '7.5123'}
2025-02-24 16:18:35,089 - {'Epoch': 40, 'HR@5': '0.0518', 'NDCG@5': '0.0363', 'HR@10': '0.0742', 'NDCG@10': '0.0435', 'HR@20': '0.1054', 'NDCG@20': '0.0513'}
2025-02-24 16:18:35,091 - EarlyStopping counter: 3 out of 10
2025-02-24 16:19:31,304 - {'epoch': 41, 'rec_loss': '7.5029'}
2025-02-24 16:19:49,306 - {'Epoch': 41, 'HR@5': '0.0520', 'NDCG@5': '0.0357', 'HR@10': '0.0745', 'NDCG@10': '0.0429', 'HR@20': '0.1041', 'NDCG@20': '0.0504'}
2025-02-24 16:19:49,308 - EarlyStopping counter: 4 out of 10
2025-02-24 16:20:42,312 - {'epoch': 42, 'rec_loss': '7.4926'}
2025-02-24 16:21:00,031 - {'Epoch': 42, 'HR@5': '0.0529', 'NDCG@5': '0.0369', 'HR@10': '0.0746', 'NDCG@10': '0.0438', 'HR@20': '0.1051', 'NDCG@20': '0.0515'}
2025-02-24 16:21:00,037 - EarlyStopping counter: 5 out of 10
2025-02-24 16:21:54,934 - {'epoch': 43, 'rec_loss': '7.4910'}
2025-02-24 16:22:12,449 - {'Epoch': 43, 'HR@5': '0.0521', 'NDCG@5': '0.0361', 'HR@10': '0.0747', 'NDCG@10': '0.0433', 'HR@20': '0.1041', 'NDCG@20': '0.0507'}
2025-02-24 16:22:12,450 - EarlyStopping counter: 6 out of 10
2025-02-24 16:23:02,992 - {'epoch': 44, 'rec_loss': '7.4851'}
2025-02-24 16:23:20,640 - {'Epoch': 44, 'HR@5': '0.0528', 'NDCG@5': '0.0366', 'HR@10': '0.0753', 'NDCG@10': '0.0438', 'HR@20': '0.1046', 'NDCG@20': '0.0512'}
2025-02-24 16:23:20,648 - EarlyStopping counter: 7 out of 10
2025-02-24 16:24:14,530 - {'epoch': 45, 'rec_loss': '7.4788'}
2025-02-24 16:24:32,168 - {'Epoch': 45, 'HR@5': '0.0522', 'NDCG@5': '0.0363', 'HR@10': '0.0749', 'NDCG@10': '0.0436', 'HR@20': '0.1042', 'NDCG@20': '0.0510'}
2025-02-24 16:24:32,170 - EarlyStopping counter: 8 out of 10
2025-02-24 16:25:25,144 - {'epoch': 46, 'rec_loss': '7.4784'}
2025-02-24 16:25:42,474 - {'Epoch': 46, 'HR@5': '0.0517', 'NDCG@5': '0.0358', 'HR@10': '0.0752', 'NDCG@10': '0.0433', 'HR@20': '0.1040', 'NDCG@20': '0.0505'}
2025-02-24 16:25:42,477 - EarlyStopping counter: 9 out of 10
2025-02-24 16:26:36,838 - {'epoch': 47, 'rec_loss': '7.4676'}
2025-02-24 16:26:54,582 - {'Epoch': 47, 'HR@5': '0.0521', 'NDCG@5': '0.0361', 'HR@10': '0.0748', 'NDCG@10': '0.0434', 'HR@20': '0.1052', 'NDCG@20': '0.0511'}
2025-02-24 16:26:54,584 - EarlyStopping counter: 10 out of 10
2025-02-24 16:26:54,584 - Early stopping
2025-02-24 16:26:54,584 - ---------------Test Score---------------
2025-02-24 16:27:14,808 - {'Epoch': 0, 'HR@5': '0.0426', 'NDCG@5': '0.0295', 'HR@10': '0.0613', 'NDCG@10': '0.0355', 'HR@20': '0.0858', 'NDCG@20': '0.0417'}
2025-02-24 16:27:14,809 - Scale_Sports
2025-02-24 16:27:14,810 - {'Epoch': 0, 'HR@5': '0.0426', 'NDCG@5': '0.0295', 'HR@10': '0.0613', 'NDCG@10': '0.0355', 'HR@20': '0.0858', 'NDCG@20': '0.0417'}
2025-02-28 15:58:20,946 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-28 15:58:23,905 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-28 15:58:23,910 - Total Parameters: 1328854
2025-02-28 15:59:04,480 - {'epoch': 0, 'rec_loss': '9.4007'}
2025-02-28 15:59:21,301 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0054', 'HR@10': '0.0126', 'NDCG@10': '0.0068', 'HR@20': '0.0214', 'NDCG@20': '0.0090'}
2025-02-28 15:59:21,303 - Validation score increased.  Saving model ...
2025-02-28 16:00:00,287 - {'epoch': 1, 'rec_loss': '9.1854'}
2025-02-28 16:00:18,703 - {'Epoch': 1, 'HR@5': '0.0146', 'NDCG@5': '0.0092', 'HR@10': '0.0241', 'NDCG@10': '0.0122', 'HR@20': '0.0409', 'NDCG@20': '0.0165'}
2025-02-28 16:00:18,704 - Validation score increased.  Saving model ...
2025-02-28 16:00:58,833 - {'epoch': 2, 'rec_loss': '8.9246'}
2025-02-28 16:01:15,728 - {'Epoch': 2, 'HR@5': '0.0179', 'NDCG@5': '0.0119', 'HR@10': '0.0305', 'NDCG@10': '0.0159', 'HR@20': '0.0490', 'NDCG@20': '0.0206'}
2025-02-28 16:01:15,729 - Validation score increased.  Saving model ...
2025-02-28 16:01:55,193 - {'epoch': 3, 'rec_loss': '8.7401'}
2025-02-28 16:02:10,969 - {'Epoch': 3, 'HR@5': '0.0268', 'NDCG@5': '0.0175', 'HR@10': '0.0412', 'NDCG@10': '0.0221', 'HR@20': '0.0625', 'NDCG@20': '0.0274'}
2025-02-28 16:02:10,970 - Validation score increased.  Saving model ...
2025-02-28 16:02:47,773 - {'epoch': 4, 'rec_loss': '8.5940'}
2025-02-28 16:03:06,024 - {'Epoch': 4, 'HR@5': '0.0305', 'NDCG@5': '0.0200', 'HR@10': '0.0471', 'NDCG@10': '0.0254', 'HR@20': '0.0706', 'NDCG@20': '0.0313'}
2025-02-28 16:03:06,025 - Validation score increased.  Saving model ...
2025-02-28 16:03:43,459 - {'epoch': 5, 'rec_loss': '8.4734'}
2025-02-28 16:04:01,848 - {'Epoch': 5, 'HR@5': '0.0361', 'NDCG@5': '0.0241', 'HR@10': '0.0534', 'NDCG@10': '0.0296', 'HR@20': '0.0793', 'NDCG@20': '0.0362'}
2025-02-28 16:04:01,849 - Validation score increased.  Saving model ...
2025-02-28 16:04:40,253 - {'epoch': 6, 'rec_loss': '8.3825'}
2025-02-28 16:04:56,519 - {'Epoch': 6, 'HR@5': '0.0379', 'NDCG@5': '0.0257', 'HR@10': '0.0569', 'NDCG@10': '0.0318', 'HR@20': '0.0823', 'NDCG@20': '0.0382'}
2025-02-28 16:04:56,521 - Validation score increased.  Saving model ...
2025-02-28 16:05:34,527 - {'epoch': 7, 'rec_loss': '8.3024'}
2025-02-28 16:05:50,811 - {'Epoch': 7, 'HR@5': '0.0404', 'NDCG@5': '0.0275', 'HR@10': '0.0592', 'NDCG@10': '0.0335', 'HR@20': '0.0862', 'NDCG@20': '0.0403'}
2025-02-28 16:05:50,816 - Validation score increased.  Saving model ...
2025-02-28 16:06:29,753 - {'epoch': 8, 'rec_loss': '8.2361'}
2025-02-28 16:06:46,049 - {'Epoch': 8, 'HR@5': '0.0428', 'NDCG@5': '0.0296', 'HR@10': '0.0621', 'NDCG@10': '0.0359', 'HR@20': '0.0896', 'NDCG@20': '0.0428'}
2025-02-28 16:06:46,053 - Validation score increased.  Saving model ...
2025-02-28 16:07:24,212 - {'epoch': 9, 'rec_loss': '8.1798'}
2025-02-28 16:07:40,808 - {'Epoch': 9, 'HR@5': '0.0445', 'NDCG@5': '0.0306', 'HR@10': '0.0640', 'NDCG@10': '0.0369', 'HR@20': '0.0917', 'NDCG@20': '0.0439'}
2025-02-28 16:07:40,810 - Validation score increased.  Saving model ...
2025-02-28 16:08:19,617 - {'epoch': 10, 'rec_loss': '8.1355'}
2025-02-28 16:08:36,617 - {'Epoch': 10, 'HR@5': '0.0450', 'NDCG@5': '0.0314', 'HR@10': '0.0650', 'NDCG@10': '0.0378', 'HR@20': '0.0915', 'NDCG@20': '0.0445'}
2025-02-28 16:08:36,618 - Validation score increased.  Saving model ...
2025-02-28 16:09:14,447 - {'epoch': 11, 'rec_loss': '8.0891'}
2025-02-28 16:09:30,700 - {'Epoch': 11, 'HR@5': '0.0465', 'NDCG@5': '0.0321', 'HR@10': '0.0669', 'NDCG@10': '0.0387', 'HR@20': '0.0945', 'NDCG@20': '0.0456'}
2025-02-28 16:09:30,702 - Validation score increased.  Saving model ...
2025-02-28 16:10:07,654 - {'epoch': 12, 'rec_loss': '8.0535'}
2025-02-28 16:10:25,748 - {'Epoch': 12, 'HR@5': '0.0473', 'NDCG@5': '0.0329', 'HR@10': '0.0683', 'NDCG@10': '0.0396', 'HR@20': '0.0964', 'NDCG@20': '0.0466'}
2025-02-28 16:10:25,749 - Validation score increased.  Saving model ...
2025-02-28 16:11:03,215 - {'epoch': 13, 'rec_loss': '8.0224'}
2025-02-28 16:11:20,781 - {'Epoch': 13, 'HR@5': '0.0471', 'NDCG@5': '0.0327', 'HR@10': '0.0686', 'NDCG@10': '0.0396', 'HR@20': '0.0976', 'NDCG@20': '0.0468'}
2025-02-28 16:11:20,782 - Validation score increased.  Saving model ...
2025-02-28 16:11:57,837 - {'epoch': 14, 'rec_loss': '7.9941'}
2025-02-28 16:12:15,041 - {'Epoch': 14, 'HR@5': '0.0486', 'NDCG@5': '0.0336', 'HR@10': '0.0698', 'NDCG@10': '0.0404', 'HR@20': '0.0990', 'NDCG@20': '0.0477'}
2025-02-28 16:12:15,042 - Validation score increased.  Saving model ...
2025-02-28 16:12:52,476 - {'epoch': 15, 'rec_loss': '7.9662'}
2025-02-28 16:13:11,269 - {'Epoch': 15, 'HR@5': '0.0486', 'NDCG@5': '0.0336', 'HR@10': '0.0699', 'NDCG@10': '0.0404', 'HR@20': '0.0989', 'NDCG@20': '0.0477'}
2025-02-28 16:13:11,270 - EarlyStopping counter: 1 out of 10
2025-02-28 16:13:48,762 - {'epoch': 16, 'rec_loss': '7.9439'}
2025-02-28 16:14:07,163 - {'Epoch': 16, 'HR@5': '0.0485', 'NDCG@5': '0.0337', 'HR@10': '0.0699', 'NDCG@10': '0.0406', 'HR@20': '0.0999', 'NDCG@20': '0.0481'}
2025-02-28 16:14:07,164 - Validation score increased.  Saving model ...
2025-02-28 16:14:45,476 - {'epoch': 17, 'rec_loss': '7.9218'}
2025-02-28 16:15:02,023 - {'Epoch': 17, 'HR@5': '0.0484', 'NDCG@5': '0.0339', 'HR@10': '0.0695', 'NDCG@10': '0.0407', 'HR@20': '0.0989', 'NDCG@20': '0.0481'}
2025-02-28 16:15:02,024 - EarlyStopping counter: 1 out of 10
2025-02-28 16:15:41,325 - {'epoch': 18, 'rec_loss': '7.9022'}
2025-02-28 16:15:59,867 - {'Epoch': 18, 'HR@5': '0.0497', 'NDCG@5': '0.0344', 'HR@10': '0.0715', 'NDCG@10': '0.0414', 'HR@20': '0.1007', 'NDCG@20': '0.0487'}
2025-02-28 16:15:59,869 - Validation score increased.  Saving model ...
2025-02-28 16:16:38,735 - {'epoch': 19, 'rec_loss': '7.8806'}
2025-02-28 16:16:55,755 - {'Epoch': 19, 'HR@5': '0.0497', 'NDCG@5': '0.0347', 'HR@10': '0.0709', 'NDCG@10': '0.0415', 'HR@20': '0.1006', 'NDCG@20': '0.0490'}
2025-02-28 16:16:55,756 - Validation score increased.  Saving model ...
2025-02-28 16:17:35,369 - {'epoch': 20, 'rec_loss': '7.8665'}
2025-02-28 16:17:51,896 - {'Epoch': 20, 'HR@5': '0.0509', 'NDCG@5': '0.0351', 'HR@10': '0.0728', 'NDCG@10': '0.0422', 'HR@20': '0.1024', 'NDCG@20': '0.0496'}
2025-02-28 16:17:51,897 - Validation score increased.  Saving model ...
2025-02-28 16:18:29,642 - {'epoch': 21, 'rec_loss': '7.8443'}
2025-02-28 16:18:47,487 - {'Epoch': 21, 'HR@5': '0.0494', 'NDCG@5': '0.0341', 'HR@10': '0.0712', 'NDCG@10': '0.0412', 'HR@20': '0.1009', 'NDCG@20': '0.0487'}
2025-02-28 16:18:47,492 - EarlyStopping counter: 1 out of 10
2025-02-28 16:19:25,251 - {'epoch': 22, 'rec_loss': '7.8314'}
2025-02-28 16:19:42,204 - {'Epoch': 22, 'HR@5': '0.0495', 'NDCG@5': '0.0347', 'HR@10': '0.0717', 'NDCG@10': '0.0418', 'HR@20': '0.1021', 'NDCG@20': '0.0495'}
2025-02-28 16:19:42,205 - EarlyStopping counter: 2 out of 10
2025-02-28 16:20:19,699 - {'epoch': 23, 'rec_loss': '7.8172'}
2025-02-28 16:20:37,694 - {'Epoch': 23, 'HR@5': '0.0496', 'NDCG@5': '0.0347', 'HR@10': '0.0720', 'NDCG@10': '0.0419', 'HR@20': '0.1025', 'NDCG@20': '0.0496'}
2025-02-28 16:20:37,697 - EarlyStopping counter: 3 out of 10
2025-02-28 16:21:16,091 - {'epoch': 24, 'rec_loss': '7.8030'}
2025-02-28 16:21:33,440 - {'Epoch': 24, 'HR@5': '0.0500', 'NDCG@5': '0.0349', 'HR@10': '0.0723', 'NDCG@10': '0.0421', 'HR@20': '0.1029', 'NDCG@20': '0.0498'}
2025-02-28 16:21:33,442 - Validation score increased.  Saving model ...
2025-02-28 16:22:11,246 - {'epoch': 25, 'rec_loss': '7.7859'}
2025-02-28 16:22:29,209 - {'Epoch': 25, 'HR@5': '0.0506', 'NDCG@5': '0.0353', 'HR@10': '0.0729', 'NDCG@10': '0.0424', 'HR@20': '0.1036', 'NDCG@20': '0.0502'}
2025-02-28 16:22:29,210 - Validation score increased.  Saving model ...
2025-02-28 16:23:07,416 - {'epoch': 26, 'rec_loss': '7.7759'}
2025-02-28 16:23:24,571 - {'Epoch': 26, 'HR@5': '0.0514', 'NDCG@5': '0.0358', 'HR@10': '0.0730', 'NDCG@10': '0.0428', 'HR@20': '0.1030', 'NDCG@20': '0.0503'}
2025-02-28 16:23:24,572 - Validation score increased.  Saving model ...
2025-02-28 16:24:04,181 - {'epoch': 27, 'rec_loss': '7.7595'}
2025-02-28 16:24:22,079 - {'Epoch': 27, 'HR@5': '0.0508', 'NDCG@5': '0.0353', 'HR@10': '0.0742', 'NDCG@10': '0.0429', 'HR@20': '0.1030', 'NDCG@20': '0.0501'}
2025-02-28 16:24:22,080 - EarlyStopping counter: 1 out of 10
2025-02-28 16:25:01,064 - {'epoch': 28, 'rec_loss': '7.7531'}
2025-02-28 16:25:19,221 - {'Epoch': 28, 'HR@5': '0.0502', 'NDCG@5': '0.0356', 'HR@10': '0.0740', 'NDCG@10': '0.0433', 'HR@20': '0.1028', 'NDCG@20': '0.0505'}
2025-02-28 16:25:19,223 - Validation score increased.  Saving model ...
2025-02-28 16:25:56,860 - {'epoch': 29, 'rec_loss': '7.7436'}
2025-02-28 16:26:13,584 - {'Epoch': 29, 'HR@5': '0.0512', 'NDCG@5': '0.0355', 'HR@10': '0.0737', 'NDCG@10': '0.0427', 'HR@20': '0.1036', 'NDCG@20': '0.0503'}
2025-02-28 16:26:13,589 - EarlyStopping counter: 1 out of 10
2025-02-28 16:26:52,626 - {'epoch': 30, 'rec_loss': '7.7346'}
2025-02-28 16:27:11,628 - {'Epoch': 30, 'HR@5': '0.0512', 'NDCG@5': '0.0357', 'HR@10': '0.0739', 'NDCG@10': '0.0430', 'HR@20': '0.1023', 'NDCG@20': '0.0502'}
2025-02-28 16:27:11,629 - EarlyStopping counter: 2 out of 10
2025-02-28 16:27:49,077 - {'epoch': 31, 'rec_loss': '7.7241'}
2025-02-28 16:28:07,664 - {'Epoch': 31, 'HR@5': '0.0514', 'NDCG@5': '0.0355', 'HR@10': '0.0733', 'NDCG@10': '0.0426', 'HR@20': '0.1034', 'NDCG@20': '0.0502'}
2025-02-28 16:28:07,674 - EarlyStopping counter: 3 out of 10
2025-02-28 16:28:46,267 - {'epoch': 32, 'rec_loss': '7.7113'}
2025-02-28 16:29:03,855 - {'Epoch': 32, 'HR@5': '0.0510', 'NDCG@5': '0.0355', 'HR@10': '0.0745', 'NDCG@10': '0.0430', 'HR@20': '0.1043', 'NDCG@20': '0.0505'}
2025-02-28 16:29:03,858 - EarlyStopping counter: 4 out of 10
2025-02-28 16:29:41,666 - {'epoch': 33, 'rec_loss': '7.7027'}
2025-02-28 16:29:59,508 - {'Epoch': 33, 'HR@5': '0.0520', 'NDCG@5': '0.0360', 'HR@10': '0.0752', 'NDCG@10': '0.0435', 'HR@20': '0.1046', 'NDCG@20': '0.0509'}
2025-02-28 16:29:59,514 - Validation score increased.  Saving model ...
2025-02-28 16:30:39,147 - {'epoch': 34, 'rec_loss': '7.7017'}
2025-02-28 16:30:56,565 - {'Epoch': 34, 'HR@5': '0.0519', 'NDCG@5': '0.0361', 'HR@10': '0.0749', 'NDCG@10': '0.0435', 'HR@20': '0.1035', 'NDCG@20': '0.0507'}
2025-02-28 16:30:56,571 - EarlyStopping counter: 1 out of 10
2025-02-28 16:31:34,156 - {'epoch': 35, 'rec_loss': '7.6902'}
2025-02-28 16:31:51,077 - {'Epoch': 35, 'HR@5': '0.0524', 'NDCG@5': '0.0362', 'HR@10': '0.0757', 'NDCG@10': '0.0437', 'HR@20': '0.1057', 'NDCG@20': '0.0512'}
2025-02-28 16:31:51,078 - Validation score increased.  Saving model ...
2025-02-28 16:32:29,035 - {'epoch': 36, 'rec_loss': '7.6826'}
2025-02-28 16:32:47,993 - {'Epoch': 36, 'HR@5': '0.0515', 'NDCG@5': '0.0361', 'HR@10': '0.0750', 'NDCG@10': '0.0436', 'HR@20': '0.1052', 'NDCG@20': '0.0512'}
2025-02-28 16:32:47,995 - EarlyStopping counter: 1 out of 10
2025-02-28 16:33:26,729 - {'epoch': 37, 'rec_loss': '7.6763'}
2025-02-28 16:33:44,063 - {'Epoch': 37, 'HR@5': '0.0525', 'NDCG@5': '0.0366', 'HR@10': '0.0753', 'NDCG@10': '0.0439', 'HR@20': '0.1059', 'NDCG@20': '0.0516'}
2025-02-28 16:33:44,065 - Validation score increased.  Saving model ...
2025-02-28 16:34:22,332 - {'epoch': 38, 'rec_loss': '7.6648'}
2025-02-28 16:34:39,345 - {'Epoch': 38, 'HR@5': '0.0515', 'NDCG@5': '0.0359', 'HR@10': '0.0749', 'NDCG@10': '0.0435', 'HR@20': '0.1054', 'NDCG@20': '0.0512'}
2025-02-28 16:34:39,347 - EarlyStopping counter: 1 out of 10
2025-02-28 16:35:16,822 - {'epoch': 39, 'rec_loss': '7.6625'}
2025-02-28 16:35:34,438 - {'Epoch': 39, 'HR@5': '0.0524', 'NDCG@5': '0.0364', 'HR@10': '0.0742', 'NDCG@10': '0.0434', 'HR@20': '0.1053', 'NDCG@20': '0.0512'}
2025-02-28 16:35:34,440 - EarlyStopping counter: 2 out of 10
2025-02-28 16:36:12,516 - {'epoch': 40, 'rec_loss': '7.6549'}
2025-02-28 16:36:30,713 - {'Epoch': 40, 'HR@5': '0.0520', 'NDCG@5': '0.0360', 'HR@10': '0.0739', 'NDCG@10': '0.0430', 'HR@20': '0.1042', 'NDCG@20': '0.0507'}
2025-02-28 16:36:30,714 - EarlyStopping counter: 3 out of 10
2025-02-28 16:37:09,640 - {'epoch': 41, 'rec_loss': '7.6451'}
2025-02-28 16:37:26,409 - {'Epoch': 41, 'HR@5': '0.0519', 'NDCG@5': '0.0361', 'HR@10': '0.0748', 'NDCG@10': '0.0434', 'HR@20': '0.1047', 'NDCG@20': '0.0510'}
2025-02-28 16:37:26,410 - EarlyStopping counter: 4 out of 10
2025-02-28 16:38:04,088 - {'epoch': 42, 'rec_loss': '7.6434'}
2025-02-28 16:38:22,039 - {'Epoch': 42, 'HR@5': '0.0516', 'NDCG@5': '0.0360', 'HR@10': '0.0754', 'NDCG@10': '0.0436', 'HR@20': '0.1044', 'NDCG@20': '0.0510'}
2025-02-28 16:38:22,040 - EarlyStopping counter: 5 out of 10
2025-02-28 16:39:00,814 - {'epoch': 43, 'rec_loss': '7.6390'}
2025-02-28 16:39:17,534 - {'Epoch': 43, 'HR@5': '0.0528', 'NDCG@5': '0.0365', 'HR@10': '0.0749', 'NDCG@10': '0.0437', 'HR@20': '0.1055', 'NDCG@20': '0.0514'}
2025-02-28 16:39:17,538 - EarlyStopping counter: 6 out of 10
2025-02-28 16:39:56,677 - {'epoch': 44, 'rec_loss': '7.6330'}
2025-02-28 16:40:14,107 - {'Epoch': 44, 'HR@5': '0.0524', 'NDCG@5': '0.0363', 'HR@10': '0.0760', 'NDCG@10': '0.0439', 'HR@20': '0.1069', 'NDCG@20': '0.0517'}
2025-02-28 16:40:14,108 - Validation score increased.  Saving model ...
2025-02-28 16:40:53,404 - {'epoch': 45, 'rec_loss': '7.6283'}
2025-02-28 16:41:10,455 - {'Epoch': 45, 'HR@5': '0.0522', 'NDCG@5': '0.0364', 'HR@10': '0.0746', 'NDCG@10': '0.0436', 'HR@20': '0.1051', 'NDCG@20': '0.0513'}
2025-02-28 16:41:10,459 - EarlyStopping counter: 1 out of 10
2025-02-28 16:41:48,939 - {'epoch': 46, 'rec_loss': '7.6266'}
2025-02-28 16:42:06,325 - {'Epoch': 46, 'HR@5': '0.0521', 'NDCG@5': '0.0364', 'HR@10': '0.0750', 'NDCG@10': '0.0438', 'HR@20': '0.1048', 'NDCG@20': '0.0512'}
2025-02-28 16:42:06,328 - EarlyStopping counter: 2 out of 10
2025-02-28 16:42:46,512 - {'epoch': 47, 'rec_loss': '7.6267'}
2025-02-28 16:43:04,177 - {'Epoch': 47, 'HR@5': '0.0523', 'NDCG@5': '0.0363', 'HR@10': '0.0753', 'NDCG@10': '0.0438', 'HR@20': '0.1061', 'NDCG@20': '0.0515'}
2025-02-28 16:43:04,178 - EarlyStopping counter: 3 out of 10
2025-02-28 16:43:41,963 - {'epoch': 48, 'rec_loss': '7.6129'}
2025-02-28 16:44:00,367 - {'Epoch': 48, 'HR@5': '0.0526', 'NDCG@5': '0.0365', 'HR@10': '0.0749', 'NDCG@10': '0.0437', 'HR@20': '0.1054', 'NDCG@20': '0.0514'}
2025-02-28 16:44:00,370 - EarlyStopping counter: 4 out of 10
2025-02-28 16:44:38,031 - {'epoch': 49, 'rec_loss': '7.6131'}
2025-02-28 16:44:55,292 - {'Epoch': 49, 'HR@5': '0.0524', 'NDCG@5': '0.0365', 'HR@10': '0.0753', 'NDCG@10': '0.0438', 'HR@20': '0.1053', 'NDCG@20': '0.0514'}
2025-02-28 16:44:55,293 - EarlyStopping counter: 5 out of 10
2025-02-28 16:45:33,197 - {'epoch': 50, 'rec_loss': '7.6151'}
2025-02-28 16:45:50,383 - {'Epoch': 50, 'HR@5': '0.0517', 'NDCG@5': '0.0361', 'HR@10': '0.0759', 'NDCG@10': '0.0439', 'HR@20': '0.1056', 'NDCG@20': '0.0513'}
2025-02-28 16:45:50,384 - EarlyStopping counter: 6 out of 10
2025-02-28 16:46:28,579 - {'epoch': 51, 'rec_loss': '7.6031'}
2025-02-28 16:46:46,812 - {'Epoch': 51, 'HR@5': '0.0523', 'NDCG@5': '0.0363', 'HR@10': '0.0747', 'NDCG@10': '0.0436', 'HR@20': '0.1050', 'NDCG@20': '0.0512'}
2025-02-28 16:46:46,813 - EarlyStopping counter: 7 out of 10
2025-02-28 16:47:24,621 - {'epoch': 52, 'rec_loss': '7.6000'}
2025-02-28 16:47:43,021 - {'Epoch': 52, 'HR@5': '0.0524', 'NDCG@5': '0.0364', 'HR@10': '0.0744', 'NDCG@10': '0.0435', 'HR@20': '0.1049', 'NDCG@20': '0.0511'}
2025-02-28 16:47:43,026 - EarlyStopping counter: 8 out of 10
2025-02-28 16:48:22,349 - {'epoch': 53, 'rec_loss': '7.5995'}
2025-02-28 16:48:39,156 - {'Epoch': 53, 'HR@5': '0.0527', 'NDCG@5': '0.0364', 'HR@10': '0.0763', 'NDCG@10': '0.0440', 'HR@20': '0.1054', 'NDCG@20': '0.0513'}
2025-02-28 16:48:39,157 - EarlyStopping counter: 9 out of 10
2025-02-28 16:49:17,160 - {'epoch': 54, 'rec_loss': '7.5933'}
2025-02-28 16:49:34,379 - {'Epoch': 54, 'HR@5': '0.0529', 'NDCG@5': '0.0365', 'HR@10': '0.0756', 'NDCG@10': '0.0438', 'HR@20': '0.1057', 'NDCG@20': '0.0514'}
2025-02-28 16:49:34,381 - EarlyStopping counter: 10 out of 10
2025-02-28 16:49:34,381 - Early stopping
2025-02-28 16:49:34,381 - ---------------Test Score---------------
2025-02-28 16:49:53,410 - {'Epoch': 0, 'HR@5': '0.0442', 'NDCG@5': '0.0306', 'HR@10': '0.0630', 'NDCG@10': '0.0367', 'HR@20': '0.0897', 'NDCG@20': '0.0434'}
2025-02-28 16:49:53,411 - Scale_Sports
2025-02-28 16:49:53,411 - {'Epoch': 0, 'HR@5': '0.0442', 'NDCG@5': '0.0306', 'HR@10': '0.0630', 'NDCG@10': '0.0367', 'HR@20': '0.0897', 'NDCG@20': '0.0434'}
2025-02-28 16:54:58,002 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 4, 6], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-28 16:55:00,895 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-28 16:55:00,900 - Total Parameters: 1328854
2025-02-28 16:55:40,435 - {'epoch': 0, 'rec_loss': '9.4009'}
2025-02-28 16:55:59,270 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0054', 'HR@10': '0.0125', 'NDCG@10': '0.0067', 'HR@20': '0.0213', 'NDCG@20': '0.0090'}
2025-02-28 16:55:59,275 - Validation score increased.  Saving model ...
2025-02-28 16:56:39,144 - {'epoch': 1, 'rec_loss': '9.1945'}
2025-02-28 16:56:56,258 - {'Epoch': 1, 'HR@5': '0.0143', 'NDCG@5': '0.0089', 'HR@10': '0.0235', 'NDCG@10': '0.0119', 'HR@20': '0.0399', 'NDCG@20': '0.0160'}
2025-02-28 16:56:56,265 - Validation score increased.  Saving model ...
2025-02-28 16:57:38,099 - {'epoch': 2, 'rec_loss': '8.9338'}
2025-02-28 16:57:55,776 - {'Epoch': 2, 'HR@5': '0.0174', 'NDCG@5': '0.0118', 'HR@10': '0.0299', 'NDCG@10': '0.0158', 'HR@20': '0.0478', 'NDCG@20': '0.0203'}
2025-02-28 16:57:55,781 - Validation score increased.  Saving model ...
2025-02-28 16:58:35,571 - {'epoch': 3, 'rec_loss': '8.7470'}
2025-02-28 16:58:51,704 - {'Epoch': 3, 'HR@5': '0.0266', 'NDCG@5': '0.0174', 'HR@10': '0.0408', 'NDCG@10': '0.0219', 'HR@20': '0.0628', 'NDCG@20': '0.0274'}
2025-02-28 16:58:51,709 - Validation score increased.  Saving model ...
2025-02-28 16:59:30,438 - {'epoch': 4, 'rec_loss': '8.5988'}
2025-02-28 16:59:46,540 - {'Epoch': 4, 'HR@5': '0.0304', 'NDCG@5': '0.0198', 'HR@10': '0.0471', 'NDCG@10': '0.0252', 'HR@20': '0.0714', 'NDCG@20': '0.0313'}
2025-02-28 16:59:46,542 - Validation score increased.  Saving model ...
2025-02-28 17:00:27,121 - {'epoch': 5, 'rec_loss': '8.4764'}
2025-02-28 17:00:43,404 - {'Epoch': 5, 'HR@5': '0.0365', 'NDCG@5': '0.0243', 'HR@10': '0.0535', 'NDCG@10': '0.0297', 'HR@20': '0.0788', 'NDCG@20': '0.0361'}
2025-02-28 17:00:43,409 - Validation score increased.  Saving model ...
2025-02-28 17:01:24,281 - {'epoch': 6, 'rec_loss': '8.3844'}
2025-02-28 17:01:40,558 - {'Epoch': 6, 'HR@5': '0.0382', 'NDCG@5': '0.0258', 'HR@10': '0.0571', 'NDCG@10': '0.0319', 'HR@20': '0.0825', 'NDCG@20': '0.0382'}
2025-02-28 17:01:40,562 - Validation score increased.  Saving model ...
2025-02-28 17:02:22,708 - {'epoch': 7, 'rec_loss': '8.3036'}
2025-02-28 17:02:39,169 - {'Epoch': 7, 'HR@5': '0.0408', 'NDCG@5': '0.0276', 'HR@10': '0.0594', 'NDCG@10': '0.0336', 'HR@20': '0.0862', 'NDCG@20': '0.0403'}
2025-02-28 17:02:39,170 - Validation score increased.  Saving model ...
2025-02-28 17:03:20,511 - {'epoch': 8, 'rec_loss': '8.2363'}
2025-02-28 17:03:37,213 - {'Epoch': 8, 'HR@5': '0.0429', 'NDCG@5': '0.0299', 'HR@10': '0.0623', 'NDCG@10': '0.0361', 'HR@20': '0.0889', 'NDCG@20': '0.0428'}
2025-02-28 17:03:37,214 - Validation score increased.  Saving model ...
2025-02-28 17:04:17,611 - {'epoch': 9, 'rec_loss': '8.1802'}
2025-02-28 17:04:33,624 - {'Epoch': 9, 'HR@5': '0.0441', 'NDCG@5': '0.0306', 'HR@10': '0.0635', 'NDCG@10': '0.0368', 'HR@20': '0.0914', 'NDCG@20': '0.0438'}
2025-02-28 17:04:33,628 - Validation score increased.  Saving model ...
2025-02-28 17:05:13,478 - {'epoch': 10, 'rec_loss': '8.1356'}
2025-02-28 17:05:30,486 - {'Epoch': 10, 'HR@5': '0.0444', 'NDCG@5': '0.0313', 'HR@10': '0.0648', 'NDCG@10': '0.0379', 'HR@20': '0.0921', 'NDCG@20': '0.0447'}
2025-02-28 17:05:30,490 - Validation score increased.  Saving model ...
2025-02-28 17:06:14,020 - {'epoch': 11, 'rec_loss': '8.0884'}
2025-02-28 17:06:30,356 - {'Epoch': 11, 'HR@5': '0.0459', 'NDCG@5': '0.0318', 'HR@10': '0.0666', 'NDCG@10': '0.0385', 'HR@20': '0.0946', 'NDCG@20': '0.0455'}
2025-02-28 17:06:30,362 - Validation score increased.  Saving model ...
2025-02-28 17:07:12,388 - {'epoch': 12, 'rec_loss': '8.0533'}
2025-02-28 17:07:29,279 - {'Epoch': 12, 'HR@5': '0.0471', 'NDCG@5': '0.0326', 'HR@10': '0.0683', 'NDCG@10': '0.0395', 'HR@20': '0.0966', 'NDCG@20': '0.0466'}
2025-02-28 17:07:29,285 - Validation score increased.  Saving model ...
2025-02-28 17:08:09,827 - {'epoch': 13, 'rec_loss': '8.0224'}
2025-02-28 17:08:27,258 - {'Epoch': 13, 'HR@5': '0.0469', 'NDCG@5': '0.0327', 'HR@10': '0.0685', 'NDCG@10': '0.0396', 'HR@20': '0.0972', 'NDCG@20': '0.0468'}
2025-02-28 17:08:27,263 - Validation score increased.  Saving model ...
2025-02-28 17:09:08,357 - {'epoch': 14, 'rec_loss': '7.9943'}
2025-02-28 17:09:24,702 - {'Epoch': 14, 'HR@5': '0.0485', 'NDCG@5': '0.0337', 'HR@10': '0.0690', 'NDCG@10': '0.0402', 'HR@20': '0.0980', 'NDCG@20': '0.0475'}
2025-02-28 17:09:24,703 - Validation score increased.  Saving model ...
2025-02-28 17:10:05,023 - {'epoch': 15, 'rec_loss': '7.9655'}
2025-02-28 17:10:22,604 - {'Epoch': 15, 'HR@5': '0.0488', 'NDCG@5': '0.0338', 'HR@10': '0.0689', 'NDCG@10': '0.0403', 'HR@20': '0.0989', 'NDCG@20': '0.0478'}
2025-02-28 17:10:22,608 - Validation score increased.  Saving model ...
2025-02-28 17:11:03,452 - {'epoch': 16, 'rec_loss': '7.9435'}
2025-02-28 17:11:20,733 - {'Epoch': 16, 'HR@5': '0.0480', 'NDCG@5': '0.0334', 'HR@10': '0.0691', 'NDCG@10': '0.0402', 'HR@20': '0.0994', 'NDCG@20': '0.0478'}
2025-02-28 17:11:20,736 - EarlyStopping counter: 1 out of 10
2025-02-28 17:12:01,961 - {'epoch': 17, 'rec_loss': '7.9216'}
2025-02-28 17:12:20,027 - {'Epoch': 17, 'HR@5': '0.0486', 'NDCG@5': '0.0340', 'HR@10': '0.0696', 'NDCG@10': '0.0407', 'HR@20': '0.0990', 'NDCG@20': '0.0481'}
2025-02-28 17:12:20,031 - Validation score increased.  Saving model ...
2025-02-28 17:13:01,349 - {'epoch': 18, 'rec_loss': '7.9014'}
2025-02-28 17:13:18,176 - {'Epoch': 18, 'HR@5': '0.0494', 'NDCG@5': '0.0345', 'HR@10': '0.0716', 'NDCG@10': '0.0416', 'HR@20': '0.1011', 'NDCG@20': '0.0490'}
2025-02-28 17:13:18,181 - Validation score increased.  Saving model ...
2025-02-28 17:13:58,165 - {'epoch': 19, 'rec_loss': '7.8801'}
2025-02-28 17:14:14,801 - {'Epoch': 19, 'HR@5': '0.0499', 'NDCG@5': '0.0349', 'HR@10': '0.0709', 'NDCG@10': '0.0417', 'HR@20': '0.1012', 'NDCG@20': '0.0493'}
2025-02-28 17:14:14,802 - Validation score increased.  Saving model ...
2025-02-28 17:14:57,437 - {'epoch': 20, 'rec_loss': '7.8658'}
2025-02-28 17:15:14,271 - {'Epoch': 20, 'HR@5': '0.0509', 'NDCG@5': '0.0354', 'HR@10': '0.0733', 'NDCG@10': '0.0425', 'HR@20': '0.1026', 'NDCG@20': '0.0499'}
2025-02-28 17:15:14,272 - Validation score increased.  Saving model ...
2025-02-28 17:15:57,006 - {'epoch': 21, 'rec_loss': '7.8439'}
2025-02-28 17:16:14,204 - {'Epoch': 21, 'HR@5': '0.0498', 'NDCG@5': '0.0344', 'HR@10': '0.0704', 'NDCG@10': '0.0410', 'HR@20': '0.1013', 'NDCG@20': '0.0488'}
2025-02-28 17:16:14,208 - EarlyStopping counter: 1 out of 10
2025-02-28 17:16:54,259 - {'epoch': 22, 'rec_loss': '7.8317'}
2025-02-28 17:17:12,445 - {'Epoch': 22, 'HR@5': '0.0501', 'NDCG@5': '0.0350', 'HR@10': '0.0713', 'NDCG@10': '0.0418', 'HR@20': '0.1021', 'NDCG@20': '0.0496'}
2025-02-28 17:17:12,448 - EarlyStopping counter: 2 out of 10
2025-02-28 17:17:52,731 - {'epoch': 23, 'rec_loss': '7.8180'}
2025-02-28 17:18:11,846 - {'Epoch': 23, 'HR@5': '0.0495', 'NDCG@5': '0.0346', 'HR@10': '0.0716', 'NDCG@10': '0.0417', 'HR@20': '0.1030', 'NDCG@20': '0.0496'}
2025-02-28 17:18:11,851 - EarlyStopping counter: 3 out of 10
2025-02-28 17:18:51,292 - {'epoch': 24, 'rec_loss': '7.8035'}
2025-02-28 17:19:09,923 - {'Epoch': 24, 'HR@5': '0.0497', 'NDCG@5': '0.0349', 'HR@10': '0.0723', 'NDCG@10': '0.0422', 'HR@20': '0.1033', 'NDCG@20': '0.0500'}
2025-02-28 17:19:09,926 - Validation score increased.  Saving model ...
2025-02-28 17:19:57,187 - {'epoch': 25, 'rec_loss': '7.7877'}
2025-02-28 17:20:15,743 - {'Epoch': 25, 'HR@5': '0.0509', 'NDCG@5': '0.0354', 'HR@10': '0.0736', 'NDCG@10': '0.0427', 'HR@20': '0.1040', 'NDCG@20': '0.0503'}
2025-02-28 17:20:15,744 - Validation score increased.  Saving model ...
2025-02-28 17:21:08,349 - {'epoch': 26, 'rec_loss': '7.7772'}
2025-02-28 17:21:26,757 - {'Epoch': 26, 'HR@5': '0.0515', 'NDCG@5': '0.0360', 'HR@10': '0.0737', 'NDCG@10': '0.0432', 'HR@20': '0.1026', 'NDCG@20': '0.0505'}
2025-02-28 17:21:26,762 - Validation score increased.  Saving model ...
2025-02-28 17:22:21,541 - {'epoch': 27, 'rec_loss': '7.7601'}
2025-02-28 17:22:40,982 - {'Epoch': 27, 'HR@5': '0.0512', 'NDCG@5': '0.0356', 'HR@10': '0.0739', 'NDCG@10': '0.0429', 'HR@20': '0.1034', 'NDCG@20': '0.0502'}
2025-02-28 17:22:40,983 - EarlyStopping counter: 1 out of 10
2025-02-28 17:23:31,965 - {'epoch': 28, 'rec_loss': '7.7541'}
2025-02-28 17:23:51,123 - {'Epoch': 28, 'HR@5': '0.0506', 'NDCG@5': '0.0357', 'HR@10': '0.0743', 'NDCG@10': '0.0433', 'HR@20': '0.1029', 'NDCG@20': '0.0505'}
2025-02-28 17:23:51,124 - Validation score increased.  Saving model ...
2025-02-28 17:24:42,711 - {'epoch': 29, 'rec_loss': '7.7446'}
2025-02-28 17:25:00,968 - {'Epoch': 29, 'HR@5': '0.0510', 'NDCG@5': '0.0356', 'HR@10': '0.0737', 'NDCG@10': '0.0429', 'HR@20': '0.1038', 'NDCG@20': '0.0504'}
2025-02-28 17:25:00,972 - EarlyStopping counter: 1 out of 10
2025-02-28 17:25:50,148 - {'epoch': 30, 'rec_loss': '7.7346'}
2025-02-28 17:26:10,815 - {'Epoch': 30, 'HR@5': '0.0509', 'NDCG@5': '0.0355', 'HR@10': '0.0742', 'NDCG@10': '0.0430', 'HR@20': '0.1035', 'NDCG@20': '0.0503'}
2025-02-28 17:26:10,818 - EarlyStopping counter: 2 out of 10
2025-02-28 17:27:02,533 - {'epoch': 31, 'rec_loss': '7.7247'}
2025-02-28 17:27:22,169 - {'Epoch': 31, 'HR@5': '0.0517', 'NDCG@5': '0.0358', 'HR@10': '0.0744', 'NDCG@10': '0.0431', 'HR@20': '0.1044', 'NDCG@20': '0.0506'}
2025-02-28 17:27:22,173 - Validation score increased.  Saving model ...
2025-02-28 17:28:12,972 - {'epoch': 32, 'rec_loss': '7.7122'}
2025-02-28 17:28:32,324 - {'Epoch': 32, 'HR@5': '0.0514', 'NDCG@5': '0.0355', 'HR@10': '0.0743', 'NDCG@10': '0.0429', 'HR@20': '0.1043', 'NDCG@20': '0.0504'}
2025-02-28 17:28:32,328 - EarlyStopping counter: 1 out of 10
2025-02-28 17:29:23,355 - {'epoch': 33, 'rec_loss': '7.7037'}
2025-02-28 17:29:42,694 - {'Epoch': 33, 'HR@5': '0.0524', 'NDCG@5': '0.0364', 'HR@10': '0.0748', 'NDCG@10': '0.0436', 'HR@20': '0.1042', 'NDCG@20': '0.0510'}
2025-02-28 17:29:42,697 - Validation score increased.  Saving model ...
2025-02-28 17:30:33,708 - {'epoch': 34, 'rec_loss': '7.7038'}
2025-02-28 17:30:53,028 - {'Epoch': 34, 'HR@5': '0.0510', 'NDCG@5': '0.0356', 'HR@10': '0.0750', 'NDCG@10': '0.0434', 'HR@20': '0.1053', 'NDCG@20': '0.0510'}
2025-02-28 17:30:53,029 - Validation score increased.  Saving model ...
2025-02-28 17:31:44,430 - {'epoch': 35, 'rec_loss': '7.6908'}
2025-02-28 17:32:03,014 - {'Epoch': 35, 'HR@5': '0.0522', 'NDCG@5': '0.0364', 'HR@10': '0.0755', 'NDCG@10': '0.0439', 'HR@20': '0.1059', 'NDCG@20': '0.0515'}
2025-02-28 17:32:03,016 - Validation score increased.  Saving model ...
2025-02-28 17:32:54,212 - {'epoch': 36, 'rec_loss': '7.6823'}
2025-02-28 17:33:13,771 - {'Epoch': 36, 'HR@5': '0.0508', 'NDCG@5': '0.0359', 'HR@10': '0.0756', 'NDCG@10': '0.0439', 'HR@20': '0.1055', 'NDCG@20': '0.0514'}
2025-02-28 17:33:13,777 - EarlyStopping counter: 1 out of 10
2025-02-28 17:34:05,029 - {'epoch': 37, 'rec_loss': '7.6762'}
2025-02-28 17:34:23,715 - {'Epoch': 37, 'HR@5': '0.0521', 'NDCG@5': '0.0366', 'HR@10': '0.0757', 'NDCG@10': '0.0442', 'HR@20': '0.1055', 'NDCG@20': '0.0517'}
2025-02-28 17:34:23,716 - Validation score increased.  Saving model ...
2025-02-28 17:35:18,261 - {'epoch': 38, 'rec_loss': '7.6648'}
2025-02-28 17:35:37,657 - {'Epoch': 38, 'HR@5': '0.0524', 'NDCG@5': '0.0365', 'HR@10': '0.0757', 'NDCG@10': '0.0440', 'HR@20': '0.1051', 'NDCG@20': '0.0514'}
2025-02-28 17:35:37,659 - EarlyStopping counter: 1 out of 10
2025-02-28 17:36:29,355 - {'epoch': 39, 'rec_loss': '7.6620'}
2025-02-28 17:36:47,711 - {'Epoch': 39, 'HR@5': '0.0523', 'NDCG@5': '0.0365', 'HR@10': '0.0750', 'NDCG@10': '0.0437', 'HR@20': '0.1048', 'NDCG@20': '0.0512'}
2025-02-28 17:36:47,716 - EarlyStopping counter: 2 out of 10
2025-02-28 17:37:40,630 - {'epoch': 40, 'rec_loss': '7.6547'}
2025-02-28 17:37:59,450 - {'Epoch': 40, 'HR@5': '0.0526', 'NDCG@5': '0.0366', 'HR@10': '0.0747', 'NDCG@10': '0.0437', 'HR@20': '0.1047', 'NDCG@20': '0.0513'}
2025-02-28 17:37:59,454 - EarlyStopping counter: 3 out of 10
2025-02-28 17:38:49,291 - {'epoch': 41, 'rec_loss': '7.6442'}
2025-02-28 17:39:09,936 - {'Epoch': 41, 'HR@5': '0.0523', 'NDCG@5': '0.0361', 'HR@10': '0.0749', 'NDCG@10': '0.0433', 'HR@20': '0.1048', 'NDCG@20': '0.0509'}
2025-02-28 17:39:09,937 - EarlyStopping counter: 4 out of 10
2025-02-28 17:40:03,459 - {'epoch': 42, 'rec_loss': '7.6426'}
2025-02-28 17:40:22,429 - {'Epoch': 42, 'HR@5': '0.0512', 'NDCG@5': '0.0359', 'HR@10': '0.0748', 'NDCG@10': '0.0435', 'HR@20': '0.1049', 'NDCG@20': '0.0510'}
2025-02-28 17:40:22,433 - EarlyStopping counter: 5 out of 10
2025-02-28 17:41:14,729 - {'epoch': 43, 'rec_loss': '7.6383'}
2025-02-28 17:41:33,850 - {'Epoch': 43, 'HR@5': '0.0530', 'NDCG@5': '0.0367', 'HR@10': '0.0755', 'NDCG@10': '0.0439', 'HR@20': '0.1054', 'NDCG@20': '0.0514'}
2025-02-28 17:41:33,854 - EarlyStopping counter: 6 out of 10
2025-02-28 17:42:26,701 - {'epoch': 44, 'rec_loss': '7.6326'}
2025-02-28 17:42:44,758 - {'Epoch': 44, 'HR@5': '0.0529', 'NDCG@5': '0.0365', 'HR@10': '0.0765', 'NDCG@10': '0.0441', 'HR@20': '0.1066', 'NDCG@20': '0.0517'}
2025-02-28 17:42:44,764 - Validation score increased.  Saving model ...
2025-02-28 17:43:37,057 - {'epoch': 45, 'rec_loss': '7.6278'}
2025-02-28 17:43:56,262 - {'Epoch': 45, 'HR@5': '0.0523', 'NDCG@5': '0.0364', 'HR@10': '0.0754', 'NDCG@10': '0.0438', 'HR@20': '0.1055', 'NDCG@20': '0.0514'}
2025-02-28 17:43:56,269 - EarlyStopping counter: 1 out of 10
2025-02-28 17:44:49,186 - {'epoch': 46, 'rec_loss': '7.6265'}
2025-02-28 17:45:07,485 - {'Epoch': 46, 'HR@5': '0.0517', 'NDCG@5': '0.0361', 'HR@10': '0.0753', 'NDCG@10': '0.0437', 'HR@20': '0.1046', 'NDCG@20': '0.0511'}
2025-02-28 17:45:07,491 - EarlyStopping counter: 2 out of 10
2025-02-28 17:46:03,478 - {'epoch': 47, 'rec_loss': '7.6269'}
2025-02-28 17:46:23,666 - {'Epoch': 47, 'HR@5': '0.0524', 'NDCG@5': '0.0367', 'HR@10': '0.0750', 'NDCG@10': '0.0439', 'HR@20': '0.1051', 'NDCG@20': '0.0515'}
2025-02-28 17:46:23,669 - EarlyStopping counter: 3 out of 10
2025-02-28 17:47:16,181 - {'epoch': 48, 'rec_loss': '7.6132'}
2025-02-28 17:47:35,618 - {'Epoch': 48, 'HR@5': '0.0521', 'NDCG@5': '0.0363', 'HR@10': '0.0758', 'NDCG@10': '0.0439', 'HR@20': '0.1058', 'NDCG@20': '0.0514'}
2025-02-28 17:47:35,621 - EarlyStopping counter: 4 out of 10
2025-02-28 17:48:30,220 - {'epoch': 49, 'rec_loss': '7.6136'}
2025-02-28 17:48:49,145 - {'Epoch': 49, 'HR@5': '0.0521', 'NDCG@5': '0.0363', 'HR@10': '0.0752', 'NDCG@10': '0.0437', 'HR@20': '0.1056', 'NDCG@20': '0.0513'}
2025-02-28 17:48:49,149 - EarlyStopping counter: 5 out of 10
2025-02-28 17:49:40,536 - {'epoch': 50, 'rec_loss': '7.6146'}
2025-02-28 17:49:59,775 - {'Epoch': 50, 'HR@5': '0.0514', 'NDCG@5': '0.0361', 'HR@10': '0.0755', 'NDCG@10': '0.0439', 'HR@20': '0.1045', 'NDCG@20': '0.0512'}
2025-02-28 17:49:59,781 - EarlyStopping counter: 6 out of 10
2025-02-28 17:50:53,085 - {'epoch': 51, 'rec_loss': '7.6021'}
2025-02-28 17:51:12,391 - {'Epoch': 51, 'HR@5': '0.0513', 'NDCG@5': '0.0359', 'HR@10': '0.0746', 'NDCG@10': '0.0434', 'HR@20': '0.1051', 'NDCG@20': '0.0511'}
2025-02-28 17:51:12,400 - EarlyStopping counter: 7 out of 10
2025-02-28 17:52:01,402 - {'epoch': 52, 'rec_loss': '7.5993'}
2025-02-28 17:52:20,588 - {'Epoch': 52, 'HR@5': '0.0514', 'NDCG@5': '0.0360', 'HR@10': '0.0751', 'NDCG@10': '0.0437', 'HR@20': '0.1055', 'NDCG@20': '0.0514'}
2025-02-28 17:52:20,592 - EarlyStopping counter: 8 out of 10
2025-02-28 17:53:11,089 - {'epoch': 53, 'rec_loss': '7.5987'}
2025-02-28 17:53:29,849 - {'Epoch': 53, 'HR@5': '0.0528', 'NDCG@5': '0.0365', 'HR@10': '0.0762', 'NDCG@10': '0.0440', 'HR@20': '0.1050', 'NDCG@20': '0.0512'}
2025-02-28 17:53:29,850 - EarlyStopping counter: 9 out of 10
2025-02-28 17:54:14,329 - {'epoch': 54, 'rec_loss': '7.5925'}
2025-02-28 17:54:33,484 - {'Epoch': 54, 'HR@5': '0.0529', 'NDCG@5': '0.0365', 'HR@10': '0.0759', 'NDCG@10': '0.0438', 'HR@20': '0.1054', 'NDCG@20': '0.0513'}
2025-02-28 17:54:33,488 - EarlyStopping counter: 10 out of 10
2025-02-28 17:54:33,489 - Early stopping
2025-02-28 17:54:33,489 - ---------------Test Score---------------
2025-02-28 17:54:51,734 - {'Epoch': 0, 'HR@5': '0.0433', 'NDCG@5': '0.0302', 'HR@10': '0.0637', 'NDCG@10': '0.0368', 'HR@20': '0.0904', 'NDCG@20': '0.0435'}
2025-02-28 17:54:51,739 - Scale_Sports
2025-02-28 17:54:51,739 - {'Epoch': 0, 'HR@5': '0.0433', 'NDCG@5': '0.0302', 'HR@10': '0.0637', 'NDCG@10': '0.0368', 'HR@20': '0.0904', 'NDCG@20': '0.0435'}
2025-02-28 19:09:58,596 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[4, 8, 24], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-28 19:10:01,836 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-28 19:10:01,848 - Total Parameters: 1328854
2025-02-28 19:10:43,707 - {'epoch': 0, 'rec_loss': '9.4018'}
2025-02-28 19:11:02,564 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0054', 'HR@10': '0.0124', 'NDCG@10': '0.0068', 'HR@20': '0.0214', 'NDCG@20': '0.0090'}
2025-02-28 19:11:02,565 - Validation score increased.  Saving model ...
2025-02-28 19:11:43,896 - {'epoch': 1, 'rec_loss': '9.2067'}
2025-02-28 19:12:02,448 - {'Epoch': 1, 'HR@5': '0.0139', 'NDCG@5': '0.0087', 'HR@10': '0.0225', 'NDCG@10': '0.0114', 'HR@20': '0.0391', 'NDCG@20': '0.0156'}
2025-02-28 19:12:02,450 - Validation score increased.  Saving model ...
2025-02-28 19:12:43,756 - {'epoch': 2, 'rec_loss': '8.9442'}
2025-02-28 19:13:01,939 - {'Epoch': 2, 'HR@5': '0.0172', 'NDCG@5': '0.0117', 'HR@10': '0.0300', 'NDCG@10': '0.0158', 'HR@20': '0.0482', 'NDCG@20': '0.0204'}
2025-02-28 19:13:01,941 - Validation score increased.  Saving model ...
2025-02-28 19:13:43,753 - {'epoch': 3, 'rec_loss': '8.7552'}
2025-02-28 19:14:01,244 - {'Epoch': 3, 'HR@5': '0.0268', 'NDCG@5': '0.0174', 'HR@10': '0.0406', 'NDCG@10': '0.0219', 'HR@20': '0.0631', 'NDCG@20': '0.0275'}
2025-02-28 19:14:01,247 - Validation score increased.  Saving model ...
2025-02-28 19:14:43,799 - {'epoch': 4, 'rec_loss': '8.6054'}
2025-02-28 19:15:02,358 - {'Epoch': 4, 'HR@5': '0.0304', 'NDCG@5': '0.0198', 'HR@10': '0.0469', 'NDCG@10': '0.0251', 'HR@20': '0.0711', 'NDCG@20': '0.0312'}
2025-02-28 19:15:02,362 - Validation score increased.  Saving model ...
2025-02-28 19:15:44,322 - {'epoch': 5, 'rec_loss': '8.4822'}
2025-02-28 19:16:02,579 - {'Epoch': 5, 'HR@5': '0.0363', 'NDCG@5': '0.0243', 'HR@10': '0.0536', 'NDCG@10': '0.0299', 'HR@20': '0.0783', 'NDCG@20': '0.0361'}
2025-02-28 19:16:02,581 - Validation score increased.  Saving model ...
2025-02-28 19:16:44,754 - {'epoch': 6, 'rec_loss': '8.3901'}
2025-02-28 19:17:03,595 - {'Epoch': 6, 'HR@5': '0.0379', 'NDCG@5': '0.0256', 'HR@10': '0.0565', 'NDCG@10': '0.0316', 'HR@20': '0.0828', 'NDCG@20': '0.0382'}
2025-02-28 19:17:03,597 - Validation score increased.  Saving model ...
2025-02-28 19:17:45,621 - {'epoch': 7, 'rec_loss': '8.3087'}
2025-02-28 19:18:04,269 - {'Epoch': 7, 'HR@5': '0.0403', 'NDCG@5': '0.0275', 'HR@10': '0.0594', 'NDCG@10': '0.0336', 'HR@20': '0.0860', 'NDCG@20': '0.0403'}
2025-02-28 19:18:04,271 - Validation score increased.  Saving model ...
2025-02-28 19:18:46,267 - {'epoch': 8, 'rec_loss': '8.2408'}
2025-02-28 19:19:04,019 - {'Epoch': 8, 'HR@5': '0.0430', 'NDCG@5': '0.0298', 'HR@10': '0.0614', 'NDCG@10': '0.0357', 'HR@20': '0.0886', 'NDCG@20': '0.0425'}
2025-02-28 19:19:04,021 - Validation score increased.  Saving model ...
2025-02-28 19:19:45,332 - {'epoch': 9, 'rec_loss': '8.1840'}
2025-02-28 19:20:03,740 - {'Epoch': 9, 'HR@5': '0.0441', 'NDCG@5': '0.0303', 'HR@10': '0.0634', 'NDCG@10': '0.0365', 'HR@20': '0.0912', 'NDCG@20': '0.0435'}
2025-02-28 19:20:03,742 - Validation score increased.  Saving model ...
2025-02-28 19:20:44,558 - {'epoch': 10, 'rec_loss': '8.1393'}
2025-02-28 19:21:03,192 - {'Epoch': 10, 'HR@5': '0.0448', 'NDCG@5': '0.0311', 'HR@10': '0.0648', 'NDCG@10': '0.0375', 'HR@20': '0.0915', 'NDCG@20': '0.0442'}
2025-02-28 19:21:03,194 - Validation score increased.  Saving model ...
2025-02-28 19:21:44,588 - {'epoch': 11, 'rec_loss': '8.0908'}
2025-02-28 19:22:03,615 - {'Epoch': 11, 'HR@5': '0.0460', 'NDCG@5': '0.0317', 'HR@10': '0.0663', 'NDCG@10': '0.0382', 'HR@20': '0.0953', 'NDCG@20': '0.0455'}
2025-02-28 19:22:03,619 - Validation score increased.  Saving model ...
2025-02-28 19:22:45,528 - {'epoch': 12, 'rec_loss': '8.0567'}
2025-02-28 19:23:04,235 - {'Epoch': 12, 'HR@5': '0.0473', 'NDCG@5': '0.0328', 'HR@10': '0.0680', 'NDCG@10': '0.0394', 'HR@20': '0.0959', 'NDCG@20': '0.0464'}
2025-02-28 19:23:04,237 - Validation score increased.  Saving model ...
2025-02-28 19:23:44,809 - {'epoch': 13, 'rec_loss': '8.0258'}
2025-02-28 19:24:03,681 - {'Epoch': 13, 'HR@5': '0.0476', 'NDCG@5': '0.0328', 'HR@10': '0.0676', 'NDCG@10': '0.0393', 'HR@20': '0.0969', 'NDCG@20': '0.0467'}
2025-02-28 19:24:03,685 - Validation score increased.  Saving model ...
2025-02-28 19:24:45,290 - {'epoch': 14, 'rec_loss': '7.9971'}
2025-02-28 19:25:04,357 - {'Epoch': 14, 'HR@5': '0.0483', 'NDCG@5': '0.0335', 'HR@10': '0.0689', 'NDCG@10': '0.0401', 'HR@20': '0.0980', 'NDCG@20': '0.0474'}
2025-02-28 19:25:04,361 - Validation score increased.  Saving model ...
2025-02-28 19:25:44,915 - {'epoch': 15, 'rec_loss': '7.9691'}
2025-02-28 19:26:03,352 - {'Epoch': 15, 'HR@5': '0.0486', 'NDCG@5': '0.0337', 'HR@10': '0.0696', 'NDCG@10': '0.0405', 'HR@20': '0.0980', 'NDCG@20': '0.0476'}
2025-02-28 19:26:03,353 - Validation score increased.  Saving model ...
2025-02-28 19:26:43,879 - {'epoch': 16, 'rec_loss': '7.9454'}
2025-02-28 19:27:02,876 - {'Epoch': 16, 'HR@5': '0.0484', 'NDCG@5': '0.0336', 'HR@10': '0.0688', 'NDCG@10': '0.0402', 'HR@20': '0.0990', 'NDCG@20': '0.0478'}
2025-02-28 19:27:02,877 - Validation score increased.  Saving model ...
2025-02-28 19:27:44,154 - {'epoch': 17, 'rec_loss': '7.9242'}
2025-02-28 19:28:02,385 - {'Epoch': 17, 'HR@5': '0.0486', 'NDCG@5': '0.0341', 'HR@10': '0.0696', 'NDCG@10': '0.0408', 'HR@20': '0.0984', 'NDCG@20': '0.0481'}
2025-02-28 19:28:02,386 - Validation score increased.  Saving model ...
2025-02-28 19:28:43,425 - {'epoch': 18, 'rec_loss': '7.9011'}
2025-02-28 19:29:02,349 - {'Epoch': 18, 'HR@5': '0.0494', 'NDCG@5': '0.0345', 'HR@10': '0.0710', 'NDCG@10': '0.0414', 'HR@20': '0.1002', 'NDCG@20': '0.0487'}
2025-02-28 19:29:02,351 - Validation score increased.  Saving model ...
2025-02-28 19:29:44,210 - {'epoch': 19, 'rec_loss': '7.8808'}
2025-02-28 19:30:03,047 - {'Epoch': 19, 'HR@5': '0.0499', 'NDCG@5': '0.0349', 'HR@10': '0.0711', 'NDCG@10': '0.0418', 'HR@20': '0.0999', 'NDCG@20': '0.0490'}
2025-02-28 19:30:03,048 - Validation score increased.  Saving model ...
2025-02-28 19:30:44,517 - {'epoch': 20, 'rec_loss': '7.8668'}
2025-02-28 19:31:03,057 - {'Epoch': 20, 'HR@5': '0.0510', 'NDCG@5': '0.0353', 'HR@10': '0.0724', 'NDCG@10': '0.0422', 'HR@20': '0.1019', 'NDCG@20': '0.0497'}
2025-02-28 19:31:03,058 - Validation score increased.  Saving model ...
2025-02-28 19:31:44,679 - {'epoch': 21, 'rec_loss': '7.8458'}
2025-02-28 19:32:03,510 - {'Epoch': 21, 'HR@5': '0.0495', 'NDCG@5': '0.0342', 'HR@10': '0.0702', 'NDCG@10': '0.0409', 'HR@20': '0.1032', 'NDCG@20': '0.0491'}
2025-02-28 19:32:03,511 - EarlyStopping counter: 1 out of 10
2025-02-28 19:32:44,491 - {'epoch': 22, 'rec_loss': '7.8337'}
2025-02-28 19:33:03,934 - {'Epoch': 22, 'HR@5': '0.0503', 'NDCG@5': '0.0351', 'HR@10': '0.0715', 'NDCG@10': '0.0419', 'HR@20': '0.1026', 'NDCG@20': '0.0497'}
2025-02-28 19:33:03,935 - Validation score increased.  Saving model ...
2025-02-28 19:33:44,800 - {'epoch': 23, 'rec_loss': '7.8186'}
2025-02-28 19:34:03,592 - {'Epoch': 23, 'HR@5': '0.0494', 'NDCG@5': '0.0343', 'HR@10': '0.0718', 'NDCG@10': '0.0415', 'HR@20': '0.1023', 'NDCG@20': '0.0492'}
2025-02-28 19:34:03,594 - EarlyStopping counter: 1 out of 10
2025-02-28 19:34:44,394 - {'epoch': 24, 'rec_loss': '7.8041'}
2025-02-28 19:35:04,124 - {'Epoch': 24, 'HR@5': '0.0496', 'NDCG@5': '0.0349', 'HR@10': '0.0717', 'NDCG@10': '0.0420', 'HR@20': '0.1029', 'NDCG@20': '0.0499'}
2025-02-28 19:35:04,132 - Validation score increased.  Saving model ...
2025-02-28 19:35:47,182 - {'epoch': 25, 'rec_loss': '7.7891'}
2025-02-28 19:36:06,278 - {'Epoch': 25, 'HR@5': '0.0505', 'NDCG@5': '0.0352', 'HR@10': '0.0724', 'NDCG@10': '0.0423', 'HR@20': '0.1041', 'NDCG@20': '0.0502'}
2025-02-28 19:36:06,280 - Validation score increased.  Saving model ...
2025-02-28 19:36:49,636 - {'epoch': 26, 'rec_loss': '7.7779'}
2025-02-28 19:37:08,823 - {'Epoch': 26, 'HR@5': '0.0513', 'NDCG@5': '0.0359', 'HR@10': '0.0735', 'NDCG@10': '0.0431', 'HR@20': '0.1028', 'NDCG@20': '0.0505'}
2025-02-28 19:37:08,826 - Validation score increased.  Saving model ...
2025-02-28 19:37:50,296 - {'epoch': 27, 'rec_loss': '7.7605'}
2025-02-28 19:38:09,235 - {'Epoch': 27, 'HR@5': '0.0511', 'NDCG@5': '0.0354', 'HR@10': '0.0738', 'NDCG@10': '0.0427', 'HR@20': '0.1033', 'NDCG@20': '0.0501'}
2025-02-28 19:38:09,240 - EarlyStopping counter: 1 out of 10
2025-02-28 19:38:52,704 - {'epoch': 28, 'rec_loss': '7.7547'}
2025-02-28 19:39:11,499 - {'Epoch': 28, 'HR@5': '0.0508', 'NDCG@5': '0.0358', 'HR@10': '0.0740', 'NDCG@10': '0.0433', 'HR@20': '0.1027', 'NDCG@20': '0.0505'}
2025-02-28 19:39:11,500 - EarlyStopping counter: 2 out of 10
2025-02-28 19:39:55,079 - {'epoch': 29, 'rec_loss': '7.7448'}
2025-02-28 19:40:14,196 - {'Epoch': 29, 'HR@5': '0.0508', 'NDCG@5': '0.0354', 'HR@10': '0.0734', 'NDCG@10': '0.0427', 'HR@20': '0.1045', 'NDCG@20': '0.0505'}
2025-02-28 19:40:14,197 - Validation score increased.  Saving model ...
2025-02-28 19:40:58,242 - {'epoch': 30, 'rec_loss': '7.7358'}
2025-02-28 19:41:17,252 - {'Epoch': 30, 'HR@5': '0.0506', 'NDCG@5': '0.0354', 'HR@10': '0.0741', 'NDCG@10': '0.0429', 'HR@20': '0.1035', 'NDCG@20': '0.0504'}
2025-02-28 19:41:17,253 - EarlyStopping counter: 1 out of 10
2025-02-28 19:42:01,152 - {'epoch': 31, 'rec_loss': '7.7252'}
2025-02-28 19:42:19,583 - {'Epoch': 31, 'HR@5': '0.0509', 'NDCG@5': '0.0354', 'HR@10': '0.0738', 'NDCG@10': '0.0428', 'HR@20': '0.1050', 'NDCG@20': '0.0506'}
2025-02-28 19:42:19,585 - Validation score increased.  Saving model ...
2025-02-28 19:43:04,710 - {'epoch': 32, 'rec_loss': '7.7128'}
2025-02-28 19:43:23,988 - {'Epoch': 32, 'HR@5': '0.0512', 'NDCG@5': '0.0355', 'HR@10': '0.0739', 'NDCG@10': '0.0428', 'HR@20': '0.1046', 'NDCG@20': '0.0505'}
2025-02-28 19:43:23,990 - EarlyStopping counter: 1 out of 10
2025-02-28 19:44:08,720 - {'epoch': 33, 'rec_loss': '7.7058'}
2025-02-28 19:44:27,663 - {'Epoch': 33, 'HR@5': '0.0515', 'NDCG@5': '0.0358', 'HR@10': '0.0743', 'NDCG@10': '0.0432', 'HR@20': '0.1050', 'NDCG@20': '0.0509'}
2025-02-28 19:44:27,667 - Validation score increased.  Saving model ...
2025-02-28 19:45:14,501 - {'epoch': 34, 'rec_loss': '7.7052'}
2025-02-28 19:45:33,105 - {'Epoch': 34, 'HR@5': '0.0510', 'NDCG@5': '0.0354', 'HR@10': '0.0746', 'NDCG@10': '0.0430', 'HR@20': '0.1048', 'NDCG@20': '0.0506'}
2025-02-28 19:45:33,106 - EarlyStopping counter: 1 out of 10
2025-02-28 19:46:17,293 - {'epoch': 35, 'rec_loss': '7.6914'}
2025-02-28 19:46:36,396 - {'Epoch': 35, 'HR@5': '0.0518', 'NDCG@5': '0.0362', 'HR@10': '0.0746', 'NDCG@10': '0.0435', 'HR@20': '0.1056', 'NDCG@20': '0.0513'}
2025-02-28 19:46:36,398 - Validation score increased.  Saving model ...
2025-02-28 19:47:21,510 - {'epoch': 36, 'rec_loss': '7.6838'}
2025-02-28 19:47:40,526 - {'Epoch': 36, 'HR@5': '0.0515', 'NDCG@5': '0.0364', 'HR@10': '0.0752', 'NDCG@10': '0.0440', 'HR@20': '0.1058', 'NDCG@20': '0.0517'}
2025-02-28 19:47:40,531 - Validation score increased.  Saving model ...
2025-02-28 19:48:24,517 - {'epoch': 37, 'rec_loss': '7.6769'}
2025-02-28 19:48:43,434 - {'Epoch': 37, 'HR@5': '0.0520', 'NDCG@5': '0.0361', 'HR@10': '0.0750', 'NDCG@10': '0.0435', 'HR@20': '0.1059', 'NDCG@20': '0.0513'}
2025-02-28 19:48:43,435 - EarlyStopping counter: 1 out of 10
2025-02-28 19:49:28,505 - {'epoch': 38, 'rec_loss': '7.6653'}
2025-02-28 19:49:47,919 - {'Epoch': 38, 'HR@5': '0.0518', 'NDCG@5': '0.0362', 'HR@10': '0.0744', 'NDCG@10': '0.0434', 'HR@20': '0.1058', 'NDCG@20': '0.0513'}
2025-02-28 19:49:47,922 - EarlyStopping counter: 2 out of 10
2025-02-28 19:50:33,103 - {'epoch': 39, 'rec_loss': '7.6620'}
2025-02-28 19:50:51,815 - {'Epoch': 39, 'HR@5': '0.0522', 'NDCG@5': '0.0365', 'HR@10': '0.0747', 'NDCG@10': '0.0437', 'HR@20': '0.1057', 'NDCG@20': '0.0515'}
2025-02-28 19:50:51,816 - EarlyStopping counter: 3 out of 10
2025-02-28 19:51:36,057 - {'epoch': 40, 'rec_loss': '7.6552'}
2025-02-28 19:51:54,323 - {'Epoch': 40, 'HR@5': '0.0525', 'NDCG@5': '0.0365', 'HR@10': '0.0751', 'NDCG@10': '0.0437', 'HR@20': '0.1045', 'NDCG@20': '0.0511'}
2025-02-28 19:51:54,324 - EarlyStopping counter: 4 out of 10
2025-02-28 19:52:39,069 - {'epoch': 41, 'rec_loss': '7.6443'}
2025-02-28 19:52:58,176 - {'Epoch': 41, 'HR@5': '0.0524', 'NDCG@5': '0.0362', 'HR@10': '0.0748', 'NDCG@10': '0.0434', 'HR@20': '0.1053', 'NDCG@20': '0.0511'}
2025-02-28 19:52:58,178 - EarlyStopping counter: 5 out of 10
2025-02-28 19:53:42,775 - {'epoch': 42, 'rec_loss': '7.6427'}
2025-02-28 19:54:02,177 - {'Epoch': 42, 'HR@5': '0.0515', 'NDCG@5': '0.0361', 'HR@10': '0.0743', 'NDCG@10': '0.0434', 'HR@20': '0.1058', 'NDCG@20': '0.0513'}
2025-02-28 19:54:02,183 - EarlyStopping counter: 6 out of 10
2025-02-28 19:54:45,361 - {'epoch': 43, 'rec_loss': '7.6391'}
2025-02-28 19:55:03,884 - {'Epoch': 43, 'HR@5': '0.0525', 'NDCG@5': '0.0363', 'HR@10': '0.0740', 'NDCG@10': '0.0432', 'HR@20': '0.1062', 'NDCG@20': '0.0513'}
2025-02-28 19:55:03,890 - EarlyStopping counter: 7 out of 10
2025-02-28 19:55:47,858 - {'epoch': 44, 'rec_loss': '7.6332'}
2025-02-28 19:56:06,486 - {'Epoch': 44, 'HR@5': '0.0530', 'NDCG@5': '0.0365', 'HR@10': '0.0764', 'NDCG@10': '0.0440', 'HR@20': '0.1074', 'NDCG@20': '0.0518'}
2025-02-28 19:56:06,490 - Validation score increased.  Saving model ...
2025-02-28 19:56:50,735 - {'epoch': 45, 'rec_loss': '7.6291'}
2025-02-28 19:57:09,563 - {'Epoch': 45, 'HR@5': '0.0516', 'NDCG@5': '0.0361', 'HR@10': '0.0752', 'NDCG@10': '0.0437', 'HR@20': '0.1056', 'NDCG@20': '0.0514'}
2025-02-28 19:57:09,565 - EarlyStopping counter: 1 out of 10
2025-02-28 19:57:52,863 - {'epoch': 46, 'rec_loss': '7.6275'}
2025-02-28 19:58:11,730 - {'Epoch': 46, 'HR@5': '0.0514', 'NDCG@5': '0.0360', 'HR@10': '0.0757', 'NDCG@10': '0.0438', 'HR@20': '0.1051', 'NDCG@20': '0.0512'}
2025-02-28 19:58:11,738 - EarlyStopping counter: 2 out of 10
2025-02-28 19:58:56,071 - {'epoch': 47, 'rec_loss': '7.6253'}
2025-02-28 19:59:15,456 - {'Epoch': 47, 'HR@5': '0.0525', 'NDCG@5': '0.0365', 'HR@10': '0.0748', 'NDCG@10': '0.0437', 'HR@20': '0.1062', 'NDCG@20': '0.0516'}
2025-02-28 19:59:15,458 - EarlyStopping counter: 3 out of 10
2025-02-28 19:59:59,518 - {'epoch': 48, 'rec_loss': '7.6146'}
2025-02-28 20:00:18,558 - {'Epoch': 48, 'HR@5': '0.0517', 'NDCG@5': '0.0360', 'HR@10': '0.0752', 'NDCG@10': '0.0436', 'HR@20': '0.1055', 'NDCG@20': '0.0512'}
2025-02-28 20:00:18,560 - EarlyStopping counter: 4 out of 10
2025-02-28 20:01:03,273 - {'epoch': 49, 'rec_loss': '7.6132'}
2025-02-28 20:01:21,340 - {'Epoch': 49, 'HR@5': '0.0523', 'NDCG@5': '0.0365', 'HR@10': '0.0745', 'NDCG@10': '0.0436', 'HR@20': '0.1056', 'NDCG@20': '0.0514'}
2025-02-28 20:01:21,341 - EarlyStopping counter: 5 out of 10
2025-02-28 20:02:03,913 - {'epoch': 50, 'rec_loss': '7.6142'}
2025-02-28 20:02:23,368 - {'Epoch': 50, 'HR@5': '0.0515', 'NDCG@5': '0.0361', 'HR@10': '0.0755', 'NDCG@10': '0.0438', 'HR@20': '0.1062', 'NDCG@20': '0.0516'}
2025-02-28 20:02:23,369 - EarlyStopping counter: 6 out of 10
2025-02-28 20:03:05,449 - {'epoch': 51, 'rec_loss': '7.6031'}
2025-02-28 20:03:24,329 - {'Epoch': 51, 'HR@5': '0.0515', 'NDCG@5': '0.0360', 'HR@10': '0.0760', 'NDCG@10': '0.0439', 'HR@20': '0.1057', 'NDCG@20': '0.0513'}
2025-02-28 20:03:24,330 - EarlyStopping counter: 7 out of 10
2025-02-28 20:04:06,730 - {'epoch': 52, 'rec_loss': '7.5991'}
2025-02-28 20:04:25,955 - {'Epoch': 52, 'HR@5': '0.0522', 'NDCG@5': '0.0364', 'HR@10': '0.0749', 'NDCG@10': '0.0437', 'HR@20': '0.1054', 'NDCG@20': '0.0514'}
2025-02-28 20:04:25,957 - EarlyStopping counter: 8 out of 10
2025-02-28 20:05:08,038 - {'epoch': 53, 'rec_loss': '7.5992'}
2025-02-28 20:05:27,004 - {'Epoch': 53, 'HR@5': '0.0523', 'NDCG@5': '0.0365', 'HR@10': '0.0756', 'NDCG@10': '0.0440', 'HR@20': '0.1058', 'NDCG@20': '0.0516'}
2025-02-28 20:05:27,005 - EarlyStopping counter: 9 out of 10
2025-02-28 20:06:09,937 - {'epoch': 54, 'rec_loss': '7.5917'}
2025-02-28 20:06:28,695 - {'Epoch': 54, 'HR@5': '0.0527', 'NDCG@5': '0.0366', 'HR@10': '0.0755', 'NDCG@10': '0.0440', 'HR@20': '0.1068', 'NDCG@20': '0.0518'}
2025-02-28 20:06:28,696 - Validation score increased.  Saving model ...
2025-02-28 20:07:11,149 - {'epoch': 55, 'rec_loss': '7.5861'}
2025-02-28 20:07:29,547 - {'Epoch': 55, 'HR@5': '0.0530', 'NDCG@5': '0.0369', 'HR@10': '0.0775', 'NDCG@10': '0.0448', 'HR@20': '0.1057', 'NDCG@20': '0.0519'}
2025-02-28 20:07:29,548 - Validation score increased.  Saving model ...
2025-02-28 20:08:13,444 - {'epoch': 56, 'rec_loss': '7.5852'}
2025-02-28 20:08:32,155 - {'Epoch': 56, 'HR@5': '0.0524', 'NDCG@5': '0.0361', 'HR@10': '0.0760', 'NDCG@10': '0.0437', 'HR@20': '0.1066', 'NDCG@20': '0.0514'}
2025-02-28 20:08:32,160 - EarlyStopping counter: 1 out of 10
2025-02-28 20:09:13,887 - {'epoch': 57, 'rec_loss': '7.5798'}
2025-02-28 20:09:33,058 - {'Epoch': 57, 'HR@5': '0.0516', 'NDCG@5': '0.0359', 'HR@10': '0.0748', 'NDCG@10': '0.0434', 'HR@20': '0.1068', 'NDCG@20': '0.0515'}
2025-02-28 20:09:33,063 - EarlyStopping counter: 2 out of 10
2025-02-28 20:10:17,469 - {'epoch': 58, 'rec_loss': '7.5787'}
2025-02-28 20:10:35,912 - {'Epoch': 58, 'HR@5': '0.0526', 'NDCG@5': '0.0368', 'HR@10': '0.0758', 'NDCG@10': '0.0443', 'HR@20': '0.1068', 'NDCG@20': '0.0521'}
2025-02-28 20:10:35,918 - Validation score increased.  Saving model ...
2025-02-28 20:11:18,022 - {'epoch': 59, 'rec_loss': '7.5763'}
2025-02-28 20:11:35,824 - {'Epoch': 59, 'HR@5': '0.0527', 'NDCG@5': '0.0368', 'HR@10': '0.0758', 'NDCG@10': '0.0442', 'HR@20': '0.1064', 'NDCG@20': '0.0519'}
2025-02-28 20:11:35,825 - EarlyStopping counter: 1 out of 10
2025-02-28 20:12:18,782 - {'epoch': 60, 'rec_loss': '7.5691'}
2025-02-28 20:12:38,213 - {'Epoch': 60, 'HR@5': '0.0524', 'NDCG@5': '0.0366', 'HR@10': '0.0753', 'NDCG@10': '0.0439', 'HR@20': '0.1068', 'NDCG@20': '0.0519'}
2025-02-28 20:12:38,218 - EarlyStopping counter: 2 out of 10
2025-02-28 20:13:19,508 - {'epoch': 61, 'rec_loss': '7.5655'}
2025-02-28 20:13:37,269 - {'Epoch': 61, 'HR@5': '0.0534', 'NDCG@5': '0.0370', 'HR@10': '0.0757', 'NDCG@10': '0.0442', 'HR@20': '0.1078', 'NDCG@20': '0.0522'}
2025-02-28 20:13:37,271 - Validation score increased.  Saving model ...
2025-02-28 20:14:20,005 - {'epoch': 62, 'rec_loss': '7.5649'}
2025-02-28 20:14:38,396 - {'Epoch': 62, 'HR@5': '0.0523', 'NDCG@5': '0.0363', 'HR@10': '0.0764', 'NDCG@10': '0.0440', 'HR@20': '0.1076', 'NDCG@20': '0.0519'}
2025-02-28 20:14:38,399 - EarlyStopping counter: 1 out of 10
2025-02-28 20:15:20,378 - {'epoch': 63, 'rec_loss': '7.5650'}
2025-02-28 20:15:38,821 - {'Epoch': 63, 'HR@5': '0.0527', 'NDCG@5': '0.0366', 'HR@10': '0.0775', 'NDCG@10': '0.0446', 'HR@20': '0.1073', 'NDCG@20': '0.0521'}
2025-02-28 20:15:38,823 - EarlyStopping counter: 2 out of 10
2025-02-28 20:16:20,578 - {'epoch': 64, 'rec_loss': '7.5582'}
2025-02-28 20:16:39,276 - {'Epoch': 64, 'HR@5': '0.0530', 'NDCG@5': '0.0367', 'HR@10': '0.0767', 'NDCG@10': '0.0443', 'HR@20': '0.1066', 'NDCG@20': '0.0519'}
2025-02-28 20:16:39,277 - EarlyStopping counter: 3 out of 10
2025-02-28 20:17:22,136 - {'epoch': 65, 'rec_loss': '7.5537'}
2025-02-28 20:17:40,697 - {'Epoch': 65, 'HR@5': '0.0535', 'NDCG@5': '0.0372', 'HR@10': '0.0769', 'NDCG@10': '0.0448', 'HR@20': '0.1068', 'NDCG@20': '0.0523'}
2025-02-28 20:17:40,702 - Validation score increased.  Saving model ...
2025-02-28 20:18:22,127 - {'epoch': 66, 'rec_loss': '7.5512'}
2025-02-28 20:18:40,893 - {'Epoch': 66, 'HR@5': '0.0522', 'NDCG@5': '0.0363', 'HR@10': '0.0758', 'NDCG@10': '0.0439', 'HR@20': '0.1064', 'NDCG@20': '0.0516'}
2025-02-28 20:18:40,896 - EarlyStopping counter: 1 out of 10
2025-02-28 20:19:24,880 - {'epoch': 67, 'rec_loss': '7.5506'}
2025-02-28 20:19:43,106 - {'Epoch': 67, 'HR@5': '0.0533', 'NDCG@5': '0.0371', 'HR@10': '0.0761', 'NDCG@10': '0.0444', 'HR@20': '0.1067', 'NDCG@20': '0.0521'}
2025-02-28 20:19:43,108 - EarlyStopping counter: 2 out of 10
2025-02-28 20:20:26,143 - {'epoch': 68, 'rec_loss': '7.5446'}
2025-02-28 20:20:44,315 - {'Epoch': 68, 'HR@5': '0.0530', 'NDCG@5': '0.0369', 'HR@10': '0.0766', 'NDCG@10': '0.0445', 'HR@20': '0.1064', 'NDCG@20': '0.0520'}
2025-02-28 20:20:44,318 - EarlyStopping counter: 3 out of 10
2025-02-28 20:21:25,708 - {'epoch': 69, 'rec_loss': '7.5439'}
2025-02-28 20:21:45,156 - {'Epoch': 69, 'HR@5': '0.0534', 'NDCG@5': '0.0370', 'HR@10': '0.0757', 'NDCG@10': '0.0442', 'HR@20': '0.1067', 'NDCG@20': '0.0520'}
2025-02-28 20:21:45,157 - EarlyStopping counter: 4 out of 10
2025-02-28 20:22:27,341 - {'epoch': 70, 'rec_loss': '7.5375'}
2025-02-28 20:22:46,039 - {'Epoch': 70, 'HR@5': '0.0525', 'NDCG@5': '0.0366', 'HR@10': '0.0758', 'NDCG@10': '0.0440', 'HR@20': '0.1064', 'NDCG@20': '0.0517'}
2025-02-28 20:22:46,042 - EarlyStopping counter: 5 out of 10
2025-02-28 20:23:28,743 - {'epoch': 71, 'rec_loss': '7.5404'}
2025-02-28 20:23:47,744 - {'Epoch': 71, 'HR@5': '0.0533', 'NDCG@5': '0.0371', 'HR@10': '0.0767', 'NDCG@10': '0.0446', 'HR@20': '0.1068', 'NDCG@20': '0.0522'}
2025-02-28 20:23:47,745 - EarlyStopping counter: 6 out of 10
2025-02-28 20:24:29,254 - {'epoch': 72, 'rec_loss': '7.5404'}
2025-02-28 20:24:48,227 - {'Epoch': 72, 'HR@5': '0.0535', 'NDCG@5': '0.0373', 'HR@10': '0.0765', 'NDCG@10': '0.0447', 'HR@20': '0.1063', 'NDCG@20': '0.0522'}
2025-02-28 20:24:48,228 - EarlyStopping counter: 7 out of 10
2025-02-28 20:25:30,199 - {'epoch': 73, 'rec_loss': '7.5341'}
2025-02-28 20:25:49,451 - {'Epoch': 73, 'HR@5': '0.0533', 'NDCG@5': '0.0366', 'HR@10': '0.0759', 'NDCG@10': '0.0438', 'HR@20': '0.1069', 'NDCG@20': '0.0516'}
2025-02-28 20:25:49,452 - EarlyStopping counter: 8 out of 10
2025-02-28 20:26:32,657 - {'epoch': 74, 'rec_loss': '7.5361'}
2025-02-28 20:26:51,647 - {'Epoch': 74, 'HR@5': '0.0530', 'NDCG@5': '0.0371', 'HR@10': '0.0763', 'NDCG@10': '0.0446', 'HR@20': '0.1071', 'NDCG@20': '0.0524'}
2025-02-28 20:26:51,650 - Validation score increased.  Saving model ...
2025-02-28 20:27:33,874 - {'epoch': 75, 'rec_loss': '7.5257'}
2025-02-28 20:27:51,827 - {'Epoch': 75, 'HR@5': '0.0536', 'NDCG@5': '0.0375', 'HR@10': '0.0760', 'NDCG@10': '0.0447', 'HR@20': '0.1065', 'NDCG@20': '0.0524'}
2025-02-28 20:27:51,828 - Validation score increased.  Saving model ...
2025-02-28 20:28:33,850 - {'epoch': 76, 'rec_loss': '7.5221'}
2025-02-28 20:28:52,598 - {'Epoch': 76, 'HR@5': '0.0539', 'NDCG@5': '0.0374', 'HR@10': '0.0755', 'NDCG@10': '0.0444', 'HR@20': '0.1079', 'NDCG@20': '0.0526'}
2025-02-28 20:28:52,599 - Validation score increased.  Saving model ...
2025-02-28 20:29:34,810 - {'epoch': 77, 'rec_loss': '7.5280'}
2025-02-28 20:29:53,741 - {'Epoch': 77, 'HR@5': '0.0531', 'NDCG@5': '0.0369', 'HR@10': '0.0754', 'NDCG@10': '0.0441', 'HR@20': '0.1057', 'NDCG@20': '0.0517'}
2025-02-28 20:29:53,745 - EarlyStopping counter: 1 out of 10
2025-02-28 20:30:37,755 - {'epoch': 78, 'rec_loss': '7.5250'}
2025-02-28 20:30:55,798 - {'Epoch': 78, 'HR@5': '0.0531', 'NDCG@5': '0.0370', 'HR@10': '0.0754', 'NDCG@10': '0.0442', 'HR@20': '0.1056', 'NDCG@20': '0.0517'}
2025-02-28 20:30:55,801 - EarlyStopping counter: 2 out of 10
2025-02-28 20:31:38,070 - {'epoch': 79, 'rec_loss': '7.5154'}
2025-02-28 20:31:56,150 - {'Epoch': 79, 'HR@5': '0.0526', 'NDCG@5': '0.0366', 'HR@10': '0.0759', 'NDCG@10': '0.0441', 'HR@20': '0.1070', 'NDCG@20': '0.0519'}
2025-02-28 20:31:56,151 - EarlyStopping counter: 3 out of 10
2025-02-28 20:32:39,103 - {'epoch': 80, 'rec_loss': '7.5176'}
2025-02-28 20:32:57,617 - {'Epoch': 80, 'HR@5': '0.0529', 'NDCG@5': '0.0370', 'HR@10': '0.0758', 'NDCG@10': '0.0444', 'HR@20': '0.1072', 'NDCG@20': '0.0523'}
2025-02-28 20:32:57,621 - EarlyStopping counter: 4 out of 10
2025-02-28 20:33:41,072 - {'epoch': 81, 'rec_loss': '7.5159'}
2025-02-28 20:34:01,077 - {'Epoch': 81, 'HR@5': '0.0534', 'NDCG@5': '0.0373', 'HR@10': '0.0761', 'NDCG@10': '0.0446', 'HR@20': '0.1059', 'NDCG@20': '0.0521'}
2025-02-28 20:34:01,081 - EarlyStopping counter: 5 out of 10
2025-02-28 20:34:43,470 - {'epoch': 82, 'rec_loss': '7.5159'}
2025-02-28 20:35:01,695 - {'Epoch': 82, 'HR@5': '0.0530', 'NDCG@5': '0.0373', 'HR@10': '0.0757', 'NDCG@10': '0.0446', 'HR@20': '0.1054', 'NDCG@20': '0.0521'}
2025-02-28 20:35:01,699 - EarlyStopping counter: 6 out of 10
2025-02-28 20:35:43,259 - {'epoch': 83, 'rec_loss': '7.5090'}
2025-02-28 20:36:01,447 - {'Epoch': 83, 'HR@5': '0.0534', 'NDCG@5': '0.0369', 'HR@10': '0.0763', 'NDCG@10': '0.0443', 'HR@20': '0.1060', 'NDCG@20': '0.0518'}
2025-02-28 20:36:01,448 - EarlyStopping counter: 7 out of 10
2025-02-28 20:36:44,318 - {'epoch': 84, 'rec_loss': '7.5058'}
2025-02-28 20:37:02,902 - {'Epoch': 84, 'HR@5': '0.0519', 'NDCG@5': '0.0363', 'HR@10': '0.0748', 'NDCG@10': '0.0437', 'HR@20': '0.1049', 'NDCG@20': '0.0513'}
2025-02-28 20:37:02,903 - EarlyStopping counter: 8 out of 10
2025-02-28 20:37:44,308 - {'epoch': 85, 'rec_loss': '7.5127'}
2025-02-28 20:38:01,703 - {'Epoch': 85, 'HR@5': '0.0540', 'NDCG@5': '0.0375', 'HR@10': '0.0764', 'NDCG@10': '0.0447', 'HR@20': '0.1052', 'NDCG@20': '0.0520'}
2025-02-28 20:38:01,707 - EarlyStopping counter: 9 out of 10
2025-02-28 20:38:42,017 - {'epoch': 86, 'rec_loss': '7.4982'}
2025-02-28 20:39:00,136 - {'Epoch': 86, 'HR@5': '0.0534', 'NDCG@5': '0.0373', 'HR@10': '0.0758', 'NDCG@10': '0.0445', 'HR@20': '0.1047', 'NDCG@20': '0.0518'}
2025-02-28 20:39:00,138 - EarlyStopping counter: 10 out of 10
2025-02-28 20:39:00,138 - Early stopping
2025-02-28 20:39:00,138 - ---------------Test Score---------------
2025-02-28 20:39:16,934 - {'Epoch': 0, 'HR@5': '0.0433', 'NDCG@5': '0.0300', 'HR@10': '0.0635', 'NDCG@10': '0.0365', 'HR@20': '0.0903', 'NDCG@20': '0.0432'}
2025-02-28 20:39:16,935 - Scale_Sports
2025-02-28 20:39:16,935 - {'Epoch': 0, 'HR@5': '0.0433', 'NDCG@5': '0.0300', 'HR@10': '0.0635', 'NDCG@10': '0.0365', 'HR@20': '0.0903', 'NDCG@20': '0.0432'}
2025-02-28 20:48:58,582 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 4, 8], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-28 20:49:05,748 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-28 20:49:05,807 - Total Parameters: 1328854
2025-02-28 20:49:50,760 - {'epoch': 0, 'rec_loss': '9.4010'}
2025-02-28 20:50:09,403 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0054', 'HR@10': '0.0125', 'NDCG@10': '0.0067', 'HR@20': '0.0213', 'NDCG@20': '0.0090'}
2025-02-28 20:50:09,405 - Validation score increased.  Saving model ...
2025-02-28 20:50:53,535 - {'epoch': 1, 'rec_loss': '9.1952'}
2025-02-28 20:51:11,470 - {'Epoch': 1, 'HR@5': '0.0142', 'NDCG@5': '0.0089', 'HR@10': '0.0232', 'NDCG@10': '0.0118', 'HR@20': '0.0398', 'NDCG@20': '0.0160'}
2025-02-28 20:51:11,471 - Validation score increased.  Saving model ...
2025-02-28 20:51:58,403 - {'epoch': 2, 'rec_loss': '8.9341'}
2025-02-28 20:52:16,968 - {'Epoch': 2, 'HR@5': '0.0175', 'NDCG@5': '0.0119', 'HR@10': '0.0301', 'NDCG@10': '0.0159', 'HR@20': '0.0481', 'NDCG@20': '0.0205'}
2025-02-28 20:52:16,973 - Validation score increased.  Saving model ...
2025-02-28 20:52:59,744 - {'epoch': 3, 'rec_loss': '8.7471'}
2025-02-28 20:53:17,935 - {'Epoch': 3, 'HR@5': '0.0265', 'NDCG@5': '0.0174', 'HR@10': '0.0407', 'NDCG@10': '0.0219', 'HR@20': '0.0628', 'NDCG@20': '0.0275'}
2025-02-28 20:53:17,937 - Validation score increased.  Saving model ...
2025-02-28 20:54:01,696 - {'epoch': 4, 'rec_loss': '8.5989'}
2025-02-28 20:54:20,916 - {'Epoch': 4, 'HR@5': '0.0303', 'NDCG@5': '0.0198', 'HR@10': '0.0472', 'NDCG@10': '0.0252', 'HR@20': '0.0711', 'NDCG@20': '0.0312'}
2025-02-28 20:54:20,917 - Validation score increased.  Saving model ...
2025-02-28 20:55:03,639 - {'epoch': 5, 'rec_loss': '8.4766'}
2025-02-28 20:55:22,847 - {'Epoch': 5, 'HR@5': '0.0366', 'NDCG@5': '0.0243', 'HR@10': '0.0540', 'NDCG@10': '0.0298', 'HR@20': '0.0787', 'NDCG@20': '0.0360'}
2025-02-28 20:55:22,853 - Validation score increased.  Saving model ...
2025-02-28 20:56:05,148 - {'epoch': 6, 'rec_loss': '8.3846'}
2025-02-28 20:56:23,850 - {'Epoch': 6, 'HR@5': '0.0379', 'NDCG@5': '0.0257', 'HR@10': '0.0573', 'NDCG@10': '0.0319', 'HR@20': '0.0828', 'NDCG@20': '0.0383'}
2025-02-28 20:56:23,855 - Validation score increased.  Saving model ...
2025-02-28 20:57:06,073 - {'epoch': 7, 'rec_loss': '8.3039'}
2025-02-28 20:57:24,951 - {'Epoch': 7, 'HR@5': '0.0403', 'NDCG@5': '0.0275', 'HR@10': '0.0591', 'NDCG@10': '0.0335', 'HR@20': '0.0863', 'NDCG@20': '0.0403'}
2025-02-28 20:57:24,957 - Validation score increased.  Saving model ...
2025-02-28 20:58:07,487 - {'epoch': 8, 'rec_loss': '8.2369'}
2025-02-28 20:58:26,408 - {'Epoch': 8, 'HR@5': '0.0432', 'NDCG@5': '0.0300', 'HR@10': '0.0621', 'NDCG@10': '0.0361', 'HR@20': '0.0888', 'NDCG@20': '0.0428'}
2025-02-28 20:58:26,410 - Validation score increased.  Saving model ...
2025-02-28 20:59:09,472 - {'epoch': 9, 'rec_loss': '8.1805'}
2025-02-28 20:59:28,135 - {'Epoch': 9, 'HR@5': '0.0442', 'NDCG@5': '0.0307', 'HR@10': '0.0635', 'NDCG@10': '0.0369', 'HR@20': '0.0917', 'NDCG@20': '0.0440'}
2025-02-28 20:59:28,138 - Validation score increased.  Saving model ...
2025-02-28 21:00:10,813 - {'epoch': 10, 'rec_loss': '8.1360'}
2025-02-28 21:00:29,941 - {'Epoch': 10, 'HR@5': '0.0442', 'NDCG@5': '0.0313', 'HR@10': '0.0648', 'NDCG@10': '0.0379', 'HR@20': '0.0919', 'NDCG@20': '0.0447'}
2025-02-28 21:00:29,945 - Validation score increased.  Saving model ...
2025-02-28 21:01:12,893 - {'epoch': 11, 'rec_loss': '8.0888'}
2025-02-28 21:01:31,593 - {'Epoch': 11, 'HR@5': '0.0461', 'NDCG@5': '0.0319', 'HR@10': '0.0667', 'NDCG@10': '0.0386', 'HR@20': '0.0950', 'NDCG@20': '0.0457'}
2025-02-28 21:01:31,600 - Validation score increased.  Saving model ...
2025-02-28 21:02:14,707 - {'epoch': 12, 'rec_loss': '8.0538'}
2025-02-28 21:02:33,579 - {'Epoch': 12, 'HR@5': '0.0473', 'NDCG@5': '0.0328', 'HR@10': '0.0685', 'NDCG@10': '0.0396', 'HR@20': '0.0962', 'NDCG@20': '0.0466'}
2025-02-28 21:02:33,584 - Validation score increased.  Saving model ...
2025-02-28 21:03:16,331 - {'epoch': 13, 'rec_loss': '8.0230'}
2025-02-28 21:03:35,761 - {'Epoch': 13, 'HR@5': '0.0467', 'NDCG@5': '0.0326', 'HR@10': '0.0684', 'NDCG@10': '0.0396', 'HR@20': '0.0970', 'NDCG@20': '0.0468'}
2025-02-28 21:03:35,762 - Validation score increased.  Saving model ...
2025-02-28 21:04:18,309 - {'epoch': 14, 'rec_loss': '7.9950'}
2025-02-28 21:04:37,192 - {'Epoch': 14, 'HR@5': '0.0484', 'NDCG@5': '0.0336', 'HR@10': '0.0687', 'NDCG@10': '0.0401', 'HR@20': '0.0982', 'NDCG@20': '0.0475'}
2025-02-28 21:04:37,199 - Validation score increased.  Saving model ...
2025-02-28 21:05:19,910 - {'epoch': 15, 'rec_loss': '7.9662'}
2025-02-28 21:05:38,834 - {'Epoch': 15, 'HR@5': '0.0489', 'NDCG@5': '0.0337', 'HR@10': '0.0689', 'NDCG@10': '0.0401', 'HR@20': '0.0987', 'NDCG@20': '0.0476'}
2025-02-28 21:05:38,839 - Validation score increased.  Saving model ...
2025-02-28 21:06:21,237 - {'epoch': 16, 'rec_loss': '7.9439'}
2025-02-28 21:06:40,843 - {'Epoch': 16, 'HR@5': '0.0483', 'NDCG@5': '0.0335', 'HR@10': '0.0692', 'NDCG@10': '0.0402', 'HR@20': '0.0997', 'NDCG@20': '0.0479'}
2025-02-28 21:06:40,848 - Validation score increased.  Saving model ...
2025-02-28 21:07:23,385 - {'epoch': 17, 'rec_loss': '7.9223'}
2025-02-28 21:07:42,937 - {'Epoch': 17, 'HR@5': '0.0483', 'NDCG@5': '0.0340', 'HR@10': '0.0691', 'NDCG@10': '0.0407', 'HR@20': '0.0993', 'NDCG@20': '0.0482'}
2025-02-28 21:07:42,943 - Validation score increased.  Saving model ...
2025-02-28 21:08:25,247 - {'epoch': 18, 'rec_loss': '7.9019'}
2025-02-28 21:08:44,676 - {'Epoch': 18, 'HR@5': '0.0494', 'NDCG@5': '0.0344', 'HR@10': '0.0715', 'NDCG@10': '0.0416', 'HR@20': '0.1003', 'NDCG@20': '0.0488'}
2025-02-28 21:08:44,682 - Validation score increased.  Saving model ...
2025-02-28 21:09:27,353 - {'epoch': 19, 'rec_loss': '7.8804'}
2025-02-28 21:09:46,371 - {'Epoch': 19, 'HR@5': '0.0503', 'NDCG@5': '0.0348', 'HR@10': '0.0710', 'NDCG@10': '0.0415', 'HR@20': '0.1009', 'NDCG@20': '0.0490'}
2025-02-28 21:09:46,375 - Validation score increased.  Saving model ...
2025-02-28 21:10:28,073 - {'epoch': 20, 'rec_loss': '7.8661'}
2025-02-28 21:10:47,912 - {'Epoch': 20, 'HR@5': '0.0512', 'NDCG@5': '0.0354', 'HR@10': '0.0727', 'NDCG@10': '0.0423', 'HR@20': '0.1026', 'NDCG@20': '0.0499'}
2025-02-28 21:10:47,914 - Validation score increased.  Saving model ...
2025-02-28 21:11:30,003 - {'epoch': 21, 'rec_loss': '7.8445'}
2025-02-28 21:11:50,133 - {'Epoch': 21, 'HR@5': '0.0495', 'NDCG@5': '0.0341', 'HR@10': '0.0707', 'NDCG@10': '0.0409', 'HR@20': '0.1014', 'NDCG@20': '0.0487'}
2025-02-28 21:11:50,135 - EarlyStopping counter: 1 out of 10
2025-02-28 21:12:33,322 - {'epoch': 22, 'rec_loss': '7.8322'}
2025-02-28 21:12:52,626 - {'Epoch': 22, 'HR@5': '0.0501', 'NDCG@5': '0.0349', 'HR@10': '0.0717', 'NDCG@10': '0.0418', 'HR@20': '0.1027', 'NDCG@20': '0.0496'}
2025-02-28 21:12:52,634 - EarlyStopping counter: 2 out of 10
2025-02-28 21:13:34,479 - {'epoch': 23, 'rec_loss': '7.8187'}
2025-02-28 21:13:53,981 - {'Epoch': 23, 'HR@5': '0.0499', 'NDCG@5': '0.0348', 'HR@10': '0.0719', 'NDCG@10': '0.0419', 'HR@20': '0.1030', 'NDCG@20': '0.0497'}
2025-02-28 21:13:53,988 - EarlyStopping counter: 3 out of 10
2025-02-28 21:14:36,146 - {'epoch': 24, 'rec_loss': '7.8043'}
2025-02-28 21:14:55,408 - {'Epoch': 24, 'HR@5': '0.0491', 'NDCG@5': '0.0346', 'HR@10': '0.0723', 'NDCG@10': '0.0421', 'HR@20': '0.1033', 'NDCG@20': '0.0499'}
2025-02-28 21:14:55,409 - Validation score increased.  Saving model ...
2025-02-28 21:15:37,171 - {'epoch': 25, 'rec_loss': '7.7883'}
2025-02-28 21:15:56,300 - {'Epoch': 25, 'HR@5': '0.0507', 'NDCG@5': '0.0352', 'HR@10': '0.0736', 'NDCG@10': '0.0426', 'HR@20': '0.1041', 'NDCG@20': '0.0502'}
2025-02-28 21:15:56,306 - Validation score increased.  Saving model ...
2025-02-28 21:16:38,383 - {'epoch': 26, 'rec_loss': '7.7776'}
2025-02-28 21:16:58,194 - {'Epoch': 26, 'HR@5': '0.0515', 'NDCG@5': '0.0360', 'HR@10': '0.0736', 'NDCG@10': '0.0432', 'HR@20': '0.1025', 'NDCG@20': '0.0505'}
2025-02-28 21:16:58,199 - Validation score increased.  Saving model ...
2025-02-28 21:17:39,710 - {'epoch': 27, 'rec_loss': '7.7606'}
2025-02-28 21:17:58,572 - {'Epoch': 27, 'HR@5': '0.0511', 'NDCG@5': '0.0353', 'HR@10': '0.0734', 'NDCG@10': '0.0426', 'HR@20': '0.1026', 'NDCG@20': '0.0499'}
2025-02-28 21:17:58,577 - EarlyStopping counter: 1 out of 10
2025-02-28 21:18:40,648 - {'epoch': 28, 'rec_loss': '7.7543'}
2025-02-28 21:18:59,699 - {'Epoch': 28, 'HR@5': '0.0506', 'NDCG@5': '0.0357', 'HR@10': '0.0736', 'NDCG@10': '0.0431', 'HR@20': '0.1029', 'NDCG@20': '0.0504'}
2025-02-28 21:18:59,705 - EarlyStopping counter: 2 out of 10
2025-02-28 21:19:41,083 - {'epoch': 29, 'rec_loss': '7.7450'}
2025-02-28 21:20:00,963 - {'Epoch': 29, 'HR@5': '0.0508', 'NDCG@5': '0.0355', 'HR@10': '0.0736', 'NDCG@10': '0.0428', 'HR@20': '0.1036', 'NDCG@20': '0.0504'}
2025-02-28 21:20:00,971 - EarlyStopping counter: 3 out of 10
2025-02-28 21:20:42,678 - {'epoch': 30, 'rec_loss': '7.7351'}
2025-02-28 21:21:01,861 - {'Epoch': 30, 'HR@5': '0.0509', 'NDCG@5': '0.0354', 'HR@10': '0.0739', 'NDCG@10': '0.0428', 'HR@20': '0.1032', 'NDCG@20': '0.0502'}
2025-02-28 21:21:01,864 - EarlyStopping counter: 4 out of 10
2025-02-28 21:21:43,973 - {'epoch': 31, 'rec_loss': '7.7249'}
2025-02-28 21:22:03,805 - {'Epoch': 31, 'HR@5': '0.0510', 'NDCG@5': '0.0354', 'HR@10': '0.0739', 'NDCG@10': '0.0428', 'HR@20': '0.1040', 'NDCG@20': '0.0504'}
2025-02-28 21:22:03,811 - EarlyStopping counter: 5 out of 10
2025-02-28 21:22:46,233 - {'epoch': 32, 'rec_loss': '7.7124'}
2025-02-28 21:23:05,596 - {'Epoch': 32, 'HR@5': '0.0510', 'NDCG@5': '0.0354', 'HR@10': '0.0740', 'NDCG@10': '0.0428', 'HR@20': '0.1041', 'NDCG@20': '0.0504'}
2025-02-28 21:23:05,598 - EarlyStopping counter: 6 out of 10
2025-02-28 21:23:47,566 - {'epoch': 33, 'rec_loss': '7.7040'}
2025-02-28 21:24:07,086 - {'Epoch': 33, 'HR@5': '0.0523', 'NDCG@5': '0.0363', 'HR@10': '0.0746', 'NDCG@10': '0.0435', 'HR@20': '0.1044', 'NDCG@20': '0.0510'}
2025-02-28 21:24:07,088 - Validation score increased.  Saving model ...
2025-02-28 21:24:48,927 - {'epoch': 34, 'rec_loss': '7.7040'}
2025-02-28 21:25:08,289 - {'Epoch': 34, 'HR@5': '0.0512', 'NDCG@5': '0.0357', 'HR@10': '0.0747', 'NDCG@10': '0.0433', 'HR@20': '0.1053', 'NDCG@20': '0.0510'}
2025-02-28 21:25:08,301 - Validation score increased.  Saving model ...
2025-02-28 21:25:50,483 - {'epoch': 35, 'rec_loss': '7.6910'}
2025-02-28 21:26:09,484 - {'Epoch': 35, 'HR@5': '0.0521', 'NDCG@5': '0.0363', 'HR@10': '0.0750', 'NDCG@10': '0.0437', 'HR@20': '0.1054', 'NDCG@20': '0.0514'}
2025-02-28 21:26:09,488 - Validation score increased.  Saving model ...
2025-02-28 21:26:49,661 - {'epoch': 36, 'rec_loss': '7.6827'}
2025-02-28 21:27:08,675 - {'Epoch': 36, 'HR@5': '0.0509', 'NDCG@5': '0.0359', 'HR@10': '0.0751', 'NDCG@10': '0.0437', 'HR@20': '0.1057', 'NDCG@20': '0.0514'}
2025-02-28 21:27:08,677 - Validation score increased.  Saving model ...
2025-02-28 21:27:50,413 - {'epoch': 37, 'rec_loss': '7.6761'}
2025-02-28 21:28:09,804 - {'Epoch': 37, 'HR@5': '0.0524', 'NDCG@5': '0.0364', 'HR@10': '0.0746', 'NDCG@10': '0.0435', 'HR@20': '0.1053', 'NDCG@20': '0.0513'}
2025-02-28 21:28:09,809 - EarlyStopping counter: 1 out of 10
2025-02-28 21:28:51,803 - {'epoch': 38, 'rec_loss': '7.6647'}
2025-02-28 21:29:11,221 - {'Epoch': 38, 'HR@5': '0.0522', 'NDCG@5': '0.0364', 'HR@10': '0.0753', 'NDCG@10': '0.0438', 'HR@20': '0.1055', 'NDCG@20': '0.0514'}
2025-02-28 21:29:11,223 - Validation score increased.  Saving model ...
2025-02-28 21:29:53,196 - {'epoch': 39, 'rec_loss': '7.6619'}
2025-02-28 21:30:12,580 - {'Epoch': 39, 'HR@5': '0.0520', 'NDCG@5': '0.0363', 'HR@10': '0.0747', 'NDCG@10': '0.0436', 'HR@20': '0.1047', 'NDCG@20': '0.0512'}
2025-02-28 21:30:12,581 - EarlyStopping counter: 1 out of 10
2025-02-28 21:30:54,272 - {'epoch': 40, 'rec_loss': '7.6542'}
2025-02-28 21:31:13,820 - {'Epoch': 40, 'HR@5': '0.0524', 'NDCG@5': '0.0364', 'HR@10': '0.0751', 'NDCG@10': '0.0436', 'HR@20': '0.1048', 'NDCG@20': '0.0511'}
2025-02-28 21:31:13,829 - EarlyStopping counter: 2 out of 10
2025-02-28 21:31:56,045 - {'epoch': 41, 'rec_loss': '7.6444'}
2025-02-28 21:32:15,419 - {'Epoch': 41, 'HR@5': '0.0525', 'NDCG@5': '0.0362', 'HR@10': '0.0744', 'NDCG@10': '0.0433', 'HR@20': '0.1052', 'NDCG@20': '0.0510'}
2025-02-28 21:32:15,421 - EarlyStopping counter: 3 out of 10
2025-02-28 21:32:57,417 - {'epoch': 42, 'rec_loss': '7.6427'}
2025-02-28 21:33:16,838 - {'Epoch': 42, 'HR@5': '0.0513', 'NDCG@5': '0.0359', 'HR@10': '0.0751', 'NDCG@10': '0.0436', 'HR@20': '0.1049', 'NDCG@20': '0.0511'}
2025-02-28 21:33:16,844 - EarlyStopping counter: 4 out of 10
2025-02-28 21:34:02,234 - {'epoch': 43, 'rec_loss': '7.6384'}
2025-02-28 21:34:22,554 - {'Epoch': 43, 'HR@5': '0.0524', 'NDCG@5': '0.0365', 'HR@10': '0.0755', 'NDCG@10': '0.0439', 'HR@20': '0.1052', 'NDCG@20': '0.0514'}
2025-02-28 21:34:22,556 - EarlyStopping counter: 5 out of 10
2025-02-28 21:35:10,715 - {'epoch': 44, 'rec_loss': '7.6329'}
2025-02-28 21:35:31,975 - {'Epoch': 44, 'HR@5': '0.0532', 'NDCG@5': '0.0367', 'HR@10': '0.0763', 'NDCG@10': '0.0441', 'HR@20': '0.1066', 'NDCG@20': '0.0517'}
2025-02-28 21:35:31,978 - Validation score increased.  Saving model ...
2025-02-28 21:36:16,261 - {'epoch': 45, 'rec_loss': '7.6283'}
2025-02-28 21:36:35,723 - {'Epoch': 45, 'HR@5': '0.0520', 'NDCG@5': '0.0363', 'HR@10': '0.0752', 'NDCG@10': '0.0438', 'HR@20': '0.1053', 'NDCG@20': '0.0514'}
2025-02-28 21:36:35,728 - EarlyStopping counter: 1 out of 10
2025-02-28 21:37:17,634 - {'epoch': 46, 'rec_loss': '7.6264'}
2025-02-28 21:37:36,626 - {'Epoch': 46, 'HR@5': '0.0515', 'NDCG@5': '0.0361', 'HR@10': '0.0753', 'NDCG@10': '0.0437', 'HR@20': '0.1045', 'NDCG@20': '0.0511'}
2025-02-28 21:37:36,628 - EarlyStopping counter: 2 out of 10
2025-02-28 21:38:17,869 - {'epoch': 47, 'rec_loss': '7.6267'}
2025-02-28 21:38:37,500 - {'Epoch': 47, 'HR@5': '0.0523', 'NDCG@5': '0.0366', 'HR@10': '0.0754', 'NDCG@10': '0.0440', 'HR@20': '0.1052', 'NDCG@20': '0.0515'}
2025-02-28 21:38:37,504 - EarlyStopping counter: 3 out of 10
2025-02-28 21:39:19,037 - {'epoch': 48, 'rec_loss': '7.6138'}
2025-02-28 21:39:38,571 - {'Epoch': 48, 'HR@5': '0.0520', 'NDCG@5': '0.0362', 'HR@10': '0.0760', 'NDCG@10': '0.0438', 'HR@20': '0.1053', 'NDCG@20': '0.0512'}
2025-02-28 21:39:38,577 - EarlyStopping counter: 4 out of 10
2025-02-28 21:40:18,518 - {'epoch': 49, 'rec_loss': '7.6131'}
2025-02-28 21:40:37,887 - {'Epoch': 49, 'HR@5': '0.0524', 'NDCG@5': '0.0365', 'HR@10': '0.0752', 'NDCG@10': '0.0438', 'HR@20': '0.1057', 'NDCG@20': '0.0515'}
2025-02-28 21:40:37,888 - EarlyStopping counter: 5 out of 10
2025-02-28 21:41:17,553 - {'epoch': 50, 'rec_loss': '7.6143'}
2025-02-28 21:41:37,060 - {'Epoch': 50, 'HR@5': '0.0519', 'NDCG@5': '0.0363', 'HR@10': '0.0758', 'NDCG@10': '0.0440', 'HR@20': '0.1041', 'NDCG@20': '0.0512'}
2025-02-28 21:41:37,062 - EarlyStopping counter: 6 out of 10
2025-02-28 21:42:17,056 - {'epoch': 51, 'rec_loss': '7.6019'}
2025-02-28 21:42:36,529 - {'Epoch': 51, 'HR@5': '0.0519', 'NDCG@5': '0.0361', 'HR@10': '0.0752', 'NDCG@10': '0.0436', 'HR@20': '0.1053', 'NDCG@20': '0.0511'}
2025-02-28 21:42:36,537 - EarlyStopping counter: 7 out of 10
2025-02-28 21:43:16,578 - {'epoch': 52, 'rec_loss': '7.5996'}
2025-02-28 21:43:36,277 - {'Epoch': 52, 'HR@5': '0.0522', 'NDCG@5': '0.0364', 'HR@10': '0.0756', 'NDCG@10': '0.0439', 'HR@20': '0.1049', 'NDCG@20': '0.0513'}
2025-02-28 21:43:36,285 - EarlyStopping counter: 8 out of 10
2025-02-28 21:44:22,084 - {'epoch': 53, 'rec_loss': '7.5987'}
2025-02-28 21:44:41,517 - {'Epoch': 53, 'HR@5': '0.0530', 'NDCG@5': '0.0366', 'HR@10': '0.0760', 'NDCG@10': '0.0440', 'HR@20': '0.1047', 'NDCG@20': '0.0512'}
2025-02-28 21:44:41,518 - EarlyStopping counter: 9 out of 10
2025-02-28 21:45:22,816 - {'epoch': 54, 'rec_loss': '7.5926'}
2025-02-28 21:45:42,208 - {'Epoch': 54, 'HR@5': '0.0530', 'NDCG@5': '0.0366', 'HR@10': '0.0757', 'NDCG@10': '0.0439', 'HR@20': '0.1053', 'NDCG@20': '0.0514'}
2025-02-28 21:45:42,218 - EarlyStopping counter: 10 out of 10
2025-02-28 21:45:42,219 - Early stopping
2025-02-28 21:45:42,219 - ---------------Test Score---------------
2025-02-28 21:46:01,566 - {'Epoch': 0, 'HR@5': '0.0430', 'NDCG@5': '0.0301', 'HR@10': '0.0631', 'NDCG@10': '0.0365', 'HR@20': '0.0900', 'NDCG@20': '0.0433'}
2025-02-28 21:46:01,571 - Scale_Sports
2025-02-28 21:46:01,571 - {'Epoch': 0, 'HR@5': '0.0430', 'NDCG@5': '0.0301', 'HR@10': '0.0631', 'NDCG@10': '0.0365', 'HR@20': '0.0900', 'NDCG@20': '0.0433'}
2025-02-28 21:48:38,186 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 4, 8, 12], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-28 21:48:42,040 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=4, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=4, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-28 21:48:42,058 - Total Parameters: 1328858
2025-02-28 21:49:32,086 - {'epoch': 0, 'rec_loss': '9.4012'}
2025-02-28 21:49:52,286 - {'Epoch': 0, 'HR@5': '0.0086', 'NDCG@5': '0.0056', 'HR@10': '0.0126', 'NDCG@10': '0.0068', 'HR@20': '0.0213', 'NDCG@20': '0.0090'}
2025-02-28 21:49:52,291 - Validation score increased.  Saving model ...
2025-02-28 21:50:40,072 - {'epoch': 1, 'rec_loss': '9.2278'}
2025-02-28 21:50:58,117 - {'Epoch': 1, 'HR@5': '0.0144', 'NDCG@5': '0.0087', 'HR@10': '0.0228', 'NDCG@10': '0.0114', 'HR@20': '0.0365', 'NDCG@20': '0.0148'}
2025-02-28 21:50:58,122 - Validation score increased.  Saving model ...
2025-02-28 21:51:42,904 - {'epoch': 2, 'rec_loss': '8.9641'}
2025-02-28 21:52:02,461 - {'Epoch': 2, 'HR@5': '0.0185', 'NDCG@5': '0.0119', 'HR@10': '0.0299', 'NDCG@10': '0.0155', 'HR@20': '0.0496', 'NDCG@20': '0.0204'}
2025-02-28 21:52:02,462 - Validation score increased.  Saving model ...
2025-02-28 21:52:53,326 - {'epoch': 3, 'rec_loss': '8.7574'}
2025-02-28 21:53:13,370 - {'Epoch': 3, 'HR@5': '0.0249', 'NDCG@5': '0.0159', 'HR@10': '0.0406', 'NDCG@10': '0.0209', 'HR@20': '0.0600', 'NDCG@20': '0.0259'}
2025-02-28 21:53:13,372 - Validation score increased.  Saving model ...
2025-02-28 21:54:15,649 - {'epoch': 4, 'rec_loss': '8.6134'}
2025-02-28 21:54:33,279 - {'Epoch': 4, 'HR@5': '0.0284', 'NDCG@5': '0.0186', 'HR@10': '0.0459', 'NDCG@10': '0.0242', 'HR@20': '0.0688', 'NDCG@20': '0.0300'}
2025-02-28 21:54:33,282 - Validation score increased.  Saving model ...
2025-02-28 21:55:23,875 - {'epoch': 5, 'rec_loss': '8.4944'}
2025-02-28 21:55:43,412 - {'Epoch': 5, 'HR@5': '0.0334', 'NDCG@5': '0.0224', 'HR@10': '0.0518', 'NDCG@10': '0.0283', 'HR@20': '0.0778', 'NDCG@20': '0.0348'}
2025-02-28 21:55:43,414 - Validation score increased.  Saving model ...
2025-02-28 21:56:34,695 - {'epoch': 6, 'rec_loss': '8.3958'}
2025-02-28 21:56:54,553 - {'Epoch': 6, 'HR@5': '0.0372', 'NDCG@5': '0.0252', 'HR@10': '0.0551', 'NDCG@10': '0.0310', 'HR@20': '0.0820', 'NDCG@20': '0.0377'}
2025-02-28 21:56:54,559 - Validation score increased.  Saving model ...
2025-02-28 21:57:40,640 - {'epoch': 7, 'rec_loss': '8.3167'}
2025-02-28 21:57:59,841 - {'Epoch': 7, 'HR@5': '0.0397', 'NDCG@5': '0.0270', 'HR@10': '0.0589', 'NDCG@10': '0.0332', 'HR@20': '0.0862', 'NDCG@20': '0.0400'}
2025-02-28 21:57:59,847 - Validation score increased.  Saving model ...
2025-02-28 21:58:46,763 - {'epoch': 8, 'rec_loss': '8.2484'}
2025-02-28 21:59:05,310 - {'Epoch': 8, 'HR@5': '0.0433', 'NDCG@5': '0.0298', 'HR@10': '0.0619', 'NDCG@10': '0.0358', 'HR@20': '0.0890', 'NDCG@20': '0.0426'}
2025-02-28 21:59:05,312 - Validation score increased.  Saving model ...
2025-02-28 21:59:52,693 - {'epoch': 9, 'rec_loss': '8.1844'}
2025-02-28 22:00:12,981 - {'Epoch': 9, 'HR@5': '0.0426', 'NDCG@5': '0.0292', 'HR@10': '0.0632', 'NDCG@10': '0.0358', 'HR@20': '0.0910', 'NDCG@20': '0.0429'}
2025-02-28 22:00:12,983 - Validation score increased.  Saving model ...
2025-02-28 22:00:55,369 - {'epoch': 10, 'rec_loss': '8.1324'}
2025-02-28 22:01:12,366 - {'Epoch': 10, 'HR@5': '0.0451', 'NDCG@5': '0.0310', 'HR@10': '0.0644', 'NDCG@10': '0.0372', 'HR@20': '0.0931', 'NDCG@20': '0.0444'}
2025-02-28 22:01:12,371 - Validation score increased.  Saving model ...
2025-02-28 22:01:58,929 - {'epoch': 11, 'rec_loss': '8.0914'}
2025-02-28 22:02:17,787 - {'Epoch': 11, 'HR@5': '0.0443', 'NDCG@5': '0.0309', 'HR@10': '0.0650', 'NDCG@10': '0.0376', 'HR@20': '0.0946', 'NDCG@20': '0.0450'}
2025-02-28 22:02:17,789 - Validation score increased.  Saving model ...
2025-02-28 22:03:04,869 - {'epoch': 12, 'rec_loss': '8.0549'}
2025-02-28 22:03:23,029 - {'Epoch': 12, 'HR@5': '0.0456', 'NDCG@5': '0.0317', 'HR@10': '0.0661', 'NDCG@10': '0.0383', 'HR@20': '0.0958', 'NDCG@20': '0.0458'}
2025-02-28 22:03:23,034 - Validation score increased.  Saving model ...
2025-02-28 22:04:05,374 - {'epoch': 13, 'rec_loss': '8.0193'}
2025-02-28 22:04:24,440 - {'Epoch': 13, 'HR@5': '0.0477', 'NDCG@5': '0.0333', 'HR@10': '0.0686', 'NDCG@10': '0.0400', 'HR@20': '0.0978', 'NDCG@20': '0.0473'}
2025-02-28 22:04:24,442 - Validation score increased.  Saving model ...
2025-02-28 22:05:16,129 - {'epoch': 14, 'rec_loss': '7.9904'}
2025-02-28 22:05:35,941 - {'Epoch': 14, 'HR@5': '0.0476', 'NDCG@5': '0.0330', 'HR@10': '0.0692', 'NDCG@10': '0.0399', 'HR@20': '0.0989', 'NDCG@20': '0.0474'}
2025-02-28 22:05:35,942 - Validation score increased.  Saving model ...
2025-02-28 22:06:30,302 - {'epoch': 15, 'rec_loss': '7.9621'}
2025-02-28 22:06:46,536 - {'Epoch': 15, 'HR@5': '0.0485', 'NDCG@5': '0.0338', 'HR@10': '0.0699', 'NDCG@10': '0.0407', 'HR@20': '0.0991', 'NDCG@20': '0.0480'}
2025-02-28 22:06:46,538 - Validation score increased.  Saving model ...
2025-02-28 22:07:27,531 - {'epoch': 16, 'rec_loss': '7.9353'}
2025-02-28 22:07:47,071 - {'Epoch': 16, 'HR@5': '0.0487', 'NDCG@5': '0.0341', 'HR@10': '0.0713', 'NDCG@10': '0.0413', 'HR@20': '0.0997', 'NDCG@20': '0.0485'}
2025-02-28 22:07:47,072 - Validation score increased.  Saving model ...
2025-02-28 22:08:30,833 - {'epoch': 17, 'rec_loss': '7.9166'}
2025-02-28 22:08:50,263 - {'Epoch': 17, 'HR@5': '0.0481', 'NDCG@5': '0.0335', 'HR@10': '0.0704', 'NDCG@10': '0.0407', 'HR@20': '0.0991', 'NDCG@20': '0.0480'}
2025-02-28 22:08:50,264 - EarlyStopping counter: 1 out of 10
2025-02-28 22:09:33,494 - {'epoch': 18, 'rec_loss': '7.8905'}
2025-02-28 22:09:52,734 - {'Epoch': 18, 'HR@5': '0.0498', 'NDCG@5': '0.0347', 'HR@10': '0.0710', 'NDCG@10': '0.0416', 'HR@20': '0.1000', 'NDCG@20': '0.0489'}
2025-02-28 22:09:52,742 - Validation score increased.  Saving model ...
2025-02-28 22:10:35,183 - {'epoch': 19, 'rec_loss': '7.8730'}
2025-02-28 22:10:53,638 - {'Epoch': 19, 'HR@5': '0.0494', 'NDCG@5': '0.0344', 'HR@10': '0.0709', 'NDCG@10': '0.0414', 'HR@20': '0.0994', 'NDCG@20': '0.0485'}
2025-02-28 22:10:53,640 - EarlyStopping counter: 1 out of 10
2025-02-28 22:11:35,831 - {'epoch': 20, 'rec_loss': '7.8594'}
2025-02-28 22:11:55,424 - {'Epoch': 20, 'HR@5': '0.0505', 'NDCG@5': '0.0351', 'HR@10': '0.0728', 'NDCG@10': '0.0423', 'HR@20': '0.1019', 'NDCG@20': '0.0496'}
2025-02-28 22:11:55,425 - Validation score increased.  Saving model ...
2025-02-28 22:12:38,509 - {'epoch': 21, 'rec_loss': '7.8317'}
2025-02-28 22:12:56,717 - {'Epoch': 21, 'HR@5': '0.0505', 'NDCG@5': '0.0348', 'HR@10': '0.0715', 'NDCG@10': '0.0415', 'HR@20': '0.1011', 'NDCG@20': '0.0490'}
2025-02-28 22:12:56,718 - EarlyStopping counter: 1 out of 10
2025-02-28 22:13:40,284 - {'epoch': 22, 'rec_loss': '7.8224'}
2025-02-28 22:13:59,336 - {'Epoch': 22, 'HR@5': '0.0511', 'NDCG@5': '0.0354', 'HR@10': '0.0726', 'NDCG@10': '0.0423', 'HR@20': '0.1016', 'NDCG@20': '0.0496'}
2025-02-28 22:13:59,337 - EarlyStopping counter: 2 out of 10
2025-02-28 22:14:42,132 - {'epoch': 23, 'rec_loss': '7.8130'}
2025-02-28 22:15:01,245 - {'Epoch': 23, 'HR@5': '0.0496', 'NDCG@5': '0.0348', 'HR@10': '0.0716', 'NDCG@10': '0.0418', 'HR@20': '0.1015', 'NDCG@20': '0.0494'}
2025-02-28 22:15:01,247 - EarlyStopping counter: 3 out of 10
2025-02-28 22:15:47,642 - {'epoch': 24, 'rec_loss': '7.8010'}
2025-02-28 22:16:06,499 - {'Epoch': 24, 'HR@5': '0.0507', 'NDCG@5': '0.0350', 'HR@10': '0.0714', 'NDCG@10': '0.0417', 'HR@20': '0.1015', 'NDCG@20': '0.0492'}
2025-02-28 22:16:06,503 - EarlyStopping counter: 4 out of 10
2025-02-28 22:16:53,366 - {'epoch': 25, 'rec_loss': '7.7793'}
2025-02-28 22:17:12,335 - {'Epoch': 25, 'HR@5': '0.0506', 'NDCG@5': '0.0353', 'HR@10': '0.0726', 'NDCG@10': '0.0424', 'HR@20': '0.1021', 'NDCG@20': '0.0498'}
2025-02-28 22:17:12,340 - Validation score increased.  Saving model ...
2025-02-28 22:17:57,526 - {'epoch': 26, 'rec_loss': '7.7699'}
2025-02-28 22:18:17,233 - {'Epoch': 26, 'HR@5': '0.0501', 'NDCG@5': '0.0352', 'HR@10': '0.0721', 'NDCG@10': '0.0422', 'HR@20': '0.1028', 'NDCG@20': '0.0500'}
2025-02-28 22:18:17,234 - Validation score increased.  Saving model ...
2025-02-28 22:19:03,896 - {'epoch': 27, 'rec_loss': '7.7585'}
2025-02-28 22:19:20,750 - {'Epoch': 27, 'HR@5': '0.0514', 'NDCG@5': '0.0355', 'HR@10': '0.0732', 'NDCG@10': '0.0425', 'HR@20': '0.1021', 'NDCG@20': '0.0498'}
2025-02-28 22:19:20,753 - EarlyStopping counter: 1 out of 10
2025-02-28 22:20:02,794 - {'epoch': 28, 'rec_loss': '7.7489'}
2025-02-28 22:20:21,538 - {'Epoch': 28, 'HR@5': '0.0514', 'NDCG@5': '0.0359', 'HR@10': '0.0731', 'NDCG@10': '0.0429', 'HR@20': '0.1025', 'NDCG@20': '0.0503'}
2025-02-28 22:20:21,539 - Validation score increased.  Saving model ...
2025-02-28 22:21:05,994 - {'epoch': 29, 'rec_loss': '7.7379'}
2025-02-28 22:21:25,729 - {'Epoch': 29, 'HR@5': '0.0508', 'NDCG@5': '0.0356', 'HR@10': '0.0735', 'NDCG@10': '0.0429', 'HR@20': '0.1025', 'NDCG@20': '0.0503'}
2025-02-28 22:21:25,730 - EarlyStopping counter: 1 out of 10
2025-02-28 22:22:12,284 - {'epoch': 30, 'rec_loss': '7.7294'}
2025-02-28 22:22:30,548 - {'Epoch': 30, 'HR@5': '0.0499', 'NDCG@5': '0.0353', 'HR@10': '0.0728', 'NDCG@10': '0.0426', 'HR@20': '0.1021', 'NDCG@20': '0.0500'}
2025-02-28 22:22:30,549 - EarlyStopping counter: 2 out of 10
2025-02-28 22:23:14,975 - {'epoch': 31, 'rec_loss': '7.7189'}
2025-02-28 22:23:34,363 - {'Epoch': 31, 'HR@5': '0.0513', 'NDCG@5': '0.0357', 'HR@10': '0.0730', 'NDCG@10': '0.0427', 'HR@20': '0.1034', 'NDCG@20': '0.0503'}
2025-02-28 22:23:34,368 - Validation score increased.  Saving model ...
2025-02-28 22:24:18,785 - {'epoch': 32, 'rec_loss': '7.7102'}
2025-02-28 22:24:35,890 - {'Epoch': 32, 'HR@5': '0.0511', 'NDCG@5': '0.0357', 'HR@10': '0.0731', 'NDCG@10': '0.0428', 'HR@20': '0.1036', 'NDCG@20': '0.0505'}
2025-02-28 22:24:35,895 - Validation score increased.  Saving model ...
2025-02-28 22:25:18,216 - {'epoch': 33, 'rec_loss': '7.7003'}
2025-02-28 22:25:36,655 - {'Epoch': 33, 'HR@5': '0.0522', 'NDCG@5': '0.0362', 'HR@10': '0.0745', 'NDCG@10': '0.0434', 'HR@20': '0.1049', 'NDCG@20': '0.0510'}
2025-02-28 22:25:36,660 - Validation score increased.  Saving model ...
2025-02-28 22:26:21,478 - {'epoch': 34, 'rec_loss': '7.7006'}
2025-02-28 22:26:40,223 - {'Epoch': 34, 'HR@5': '0.0512', 'NDCG@5': '0.0361', 'HR@10': '0.0747', 'NDCG@10': '0.0437', 'HR@20': '0.1038', 'NDCG@20': '0.0510'}
2025-02-28 22:26:40,224 - EarlyStopping counter: 1 out of 10
2025-02-28 22:27:21,026 - {'epoch': 35, 'rec_loss': '7.6905'}
2025-02-28 22:27:39,177 - {'Epoch': 35, 'HR@5': '0.0518', 'NDCG@5': '0.0360', 'HR@10': '0.0753', 'NDCG@10': '0.0435', 'HR@20': '0.1043', 'NDCG@20': '0.0508'}
2025-02-28 22:27:39,178 - EarlyStopping counter: 2 out of 10
2025-02-28 22:28:22,197 - {'epoch': 36, 'rec_loss': '7.6893'}
2025-02-28 22:28:41,676 - {'Epoch': 36, 'HR@5': '0.0515', 'NDCG@5': '0.0362', 'HR@10': '0.0745', 'NDCG@10': '0.0436', 'HR@20': '0.1042', 'NDCG@20': '0.0511'}
2025-02-28 22:28:41,680 - Validation score increased.  Saving model ...
2025-02-28 22:29:25,661 - {'epoch': 37, 'rec_loss': '7.6762'}
2025-02-28 22:29:44,420 - {'Epoch': 37, 'HR@5': '0.0518', 'NDCG@5': '0.0361', 'HR@10': '0.0742', 'NDCG@10': '0.0434', 'HR@20': '0.1041', 'NDCG@20': '0.0509'}
2025-02-28 22:29:44,421 - EarlyStopping counter: 1 out of 10
2025-02-28 22:30:24,352 - {'epoch': 38, 'rec_loss': '7.6694'}
2025-02-28 22:30:43,910 - {'Epoch': 38, 'HR@5': '0.0513', 'NDCG@5': '0.0360', 'HR@10': '0.0744', 'NDCG@10': '0.0434', 'HR@20': '0.1036', 'NDCG@20': '0.0508'}
2025-02-28 22:30:43,911 - EarlyStopping counter: 2 out of 10
2025-02-28 22:31:29,773 - {'epoch': 39, 'rec_loss': '7.6668'}
2025-02-28 22:31:49,342 - {'Epoch': 39, 'HR@5': '0.0528', 'NDCG@5': '0.0368', 'HR@10': '0.0755', 'NDCG@10': '0.0441', 'HR@20': '0.1050', 'NDCG@20': '0.0516'}
2025-02-28 22:31:49,343 - Validation score increased.  Saving model ...
2025-02-28 22:32:34,430 - {'epoch': 40, 'rec_loss': '7.6568'}
2025-02-28 22:32:52,740 - {'Epoch': 40, 'HR@5': '0.0514', 'NDCG@5': '0.0360', 'HR@10': '0.0749', 'NDCG@10': '0.0435', 'HR@20': '0.1040', 'NDCG@20': '0.0509'}
2025-02-28 22:32:52,745 - EarlyStopping counter: 1 out of 10
2025-02-28 22:33:39,355 - {'epoch': 41, 'rec_loss': '7.6438'}
2025-02-28 22:33:59,339 - {'Epoch': 41, 'HR@5': '0.0513', 'NDCG@5': '0.0358', 'HR@10': '0.0744', 'NDCG@10': '0.0433', 'HR@20': '0.1047', 'NDCG@20': '0.0509'}
2025-02-28 22:33:59,343 - EarlyStopping counter: 2 out of 10
2025-02-28 22:34:45,427 - {'epoch': 42, 'rec_loss': '7.6517'}
2025-02-28 22:35:03,548 - {'Epoch': 42, 'HR@5': '0.0526', 'NDCG@5': '0.0367', 'HR@10': '0.0738', 'NDCG@10': '0.0435', 'HR@20': '0.1044', 'NDCG@20': '0.0512'}
2025-02-28 22:35:03,553 - EarlyStopping counter: 3 out of 10
2025-02-28 22:35:44,051 - {'epoch': 43, 'rec_loss': '7.6394'}
2025-02-28 22:36:02,966 - {'Epoch': 43, 'HR@5': '0.0517', 'NDCG@5': '0.0361', 'HR@10': '0.0744', 'NDCG@10': '0.0434', 'HR@20': '0.1044', 'NDCG@20': '0.0509'}
2025-02-28 22:36:02,971 - EarlyStopping counter: 4 out of 10
2025-02-28 22:36:49,239 - {'epoch': 44, 'rec_loss': '7.6320'}
2025-02-28 22:37:08,906 - {'Epoch': 44, 'HR@5': '0.0520', 'NDCG@5': '0.0365', 'HR@10': '0.0739', 'NDCG@10': '0.0436', 'HR@20': '0.1053', 'NDCG@20': '0.0515'}
2025-02-28 22:37:08,911 - EarlyStopping counter: 5 out of 10
2025-02-28 22:37:53,257 - {'epoch': 45, 'rec_loss': '7.6300'}
2025-02-28 22:38:13,618 - {'Epoch': 45, 'HR@5': '0.0528', 'NDCG@5': '0.0369', 'HR@10': '0.0746', 'NDCG@10': '0.0439', 'HR@20': '0.1050', 'NDCG@20': '0.0516'}
2025-02-28 22:38:13,619 - Validation score increased.  Saving model ...
2025-02-28 22:39:00,602 - {'epoch': 46, 'rec_loss': '7.6291'}
2025-02-28 22:39:18,076 - {'Epoch': 46, 'HR@5': '0.0522', 'NDCG@5': '0.0365', 'HR@10': '0.0742', 'NDCG@10': '0.0435', 'HR@20': '0.1055', 'NDCG@20': '0.0514'}
2025-02-28 22:39:18,077 - EarlyStopping counter: 1 out of 10
2025-02-28 22:40:04,577 - {'epoch': 47, 'rec_loss': '7.6255'}
2025-02-28 22:40:22,409 - {'Epoch': 47, 'HR@5': '0.0526', 'NDCG@5': '0.0366', 'HR@10': '0.0749', 'NDCG@10': '0.0438', 'HR@20': '0.1059', 'NDCG@20': '0.0516'}
2025-02-28 22:40:22,414 - EarlyStopping counter: 2 out of 10
2025-02-28 22:41:04,448 - {'epoch': 48, 'rec_loss': '7.6092'}
2025-02-28 22:41:21,164 - {'Epoch': 48, 'HR@5': '0.0523', 'NDCG@5': '0.0363', 'HR@10': '0.0746', 'NDCG@10': '0.0435', 'HR@20': '0.1051', 'NDCG@20': '0.0511'}
2025-02-28 22:41:21,168 - EarlyStopping counter: 3 out of 10
2025-02-28 22:42:05,548 - {'epoch': 49, 'rec_loss': '7.6114'}
2025-02-28 22:42:24,220 - {'Epoch': 49, 'HR@5': '0.0525', 'NDCG@5': '0.0363', 'HR@10': '0.0744', 'NDCG@10': '0.0434', 'HR@20': '0.1055', 'NDCG@20': '0.0512'}
2025-02-28 22:42:24,225 - EarlyStopping counter: 4 out of 10
2025-02-28 22:43:08,587 - {'epoch': 50, 'rec_loss': '7.6122'}
2025-02-28 22:43:26,638 - {'Epoch': 50, 'HR@5': '0.0524', 'NDCG@5': '0.0362', 'HR@10': '0.0748', 'NDCG@10': '0.0434', 'HR@20': '0.1057', 'NDCG@20': '0.0512'}
2025-02-28 22:43:26,639 - EarlyStopping counter: 5 out of 10
2025-02-28 22:44:11,783 - {'epoch': 51, 'rec_loss': '7.6031'}
2025-02-28 22:44:30,996 - {'Epoch': 51, 'HR@5': '0.0526', 'NDCG@5': '0.0363', 'HR@10': '0.0745', 'NDCG@10': '0.0435', 'HR@20': '0.1051', 'NDCG@20': '0.0512'}
2025-02-28 22:44:30,997 - EarlyStopping counter: 6 out of 10
2025-02-28 22:45:15,127 - {'epoch': 52, 'rec_loss': '7.5963'}
2025-02-28 22:45:34,566 - {'Epoch': 52, 'HR@5': '0.0522', 'NDCG@5': '0.0364', 'HR@10': '0.0759', 'NDCG@10': '0.0441', 'HR@20': '0.1074', 'NDCG@20': '0.0520'}
2025-02-28 22:45:34,568 - Validation score increased.  Saving model ...
2025-02-28 22:46:14,618 - {'epoch': 53, 'rec_loss': '7.5950'}
2025-02-28 22:46:31,591 - {'Epoch': 53, 'HR@5': '0.0523', 'NDCG@5': '0.0369', 'HR@10': '0.0755', 'NDCG@10': '0.0443', 'HR@20': '0.1063', 'NDCG@20': '0.0521'}
2025-02-28 22:46:31,592 - Validation score increased.  Saving model ...
2025-02-28 22:47:14,500 - {'epoch': 54, 'rec_loss': '7.5913'}
2025-02-28 22:47:33,473 - {'Epoch': 54, 'HR@5': '0.0529', 'NDCG@5': '0.0368', 'HR@10': '0.0739', 'NDCG@10': '0.0436', 'HR@20': '0.1058', 'NDCG@20': '0.0516'}
2025-02-28 22:47:33,475 - EarlyStopping counter: 1 out of 10
2025-02-28 22:48:18,856 - {'epoch': 55, 'rec_loss': '7.5856'}
2025-02-28 22:48:38,615 - {'Epoch': 55, 'HR@5': '0.0525', 'NDCG@5': '0.0366', 'HR@10': '0.0752', 'NDCG@10': '0.0439', 'HR@20': '0.1067', 'NDCG@20': '0.0518'}
2025-02-28 22:48:38,617 - EarlyStopping counter: 2 out of 10
2025-02-28 22:49:23,093 - {'epoch': 56, 'rec_loss': '7.5812'}
2025-02-28 22:49:41,232 - {'Epoch': 56, 'HR@5': '0.0523', 'NDCG@5': '0.0363', 'HR@10': '0.0753', 'NDCG@10': '0.0437', 'HR@20': '0.1061', 'NDCG@20': '0.0514'}
2025-02-28 22:49:41,237 - EarlyStopping counter: 3 out of 10
2025-02-28 22:50:26,069 - {'epoch': 57, 'rec_loss': '7.5782'}
2025-02-28 22:50:45,454 - {'Epoch': 57, 'HR@5': '0.0519', 'NDCG@5': '0.0360', 'HR@10': '0.0745', 'NDCG@10': '0.0433', 'HR@20': '0.1063', 'NDCG@20': '0.0513'}
2025-02-28 22:50:45,459 - EarlyStopping counter: 4 out of 10
2025-02-28 22:51:25,773 - {'epoch': 58, 'rec_loss': '7.5792'}
2025-02-28 22:51:44,083 - {'Epoch': 58, 'HR@5': '0.0528', 'NDCG@5': '0.0367', 'HR@10': '0.0757', 'NDCG@10': '0.0440', 'HR@20': '0.1066', 'NDCG@20': '0.0518'}
2025-02-28 22:51:44,086 - EarlyStopping counter: 5 out of 10
2025-02-28 22:52:27,460 - {'epoch': 59, 'rec_loss': '7.5767'}
2025-02-28 22:52:47,177 - {'Epoch': 59, 'HR@5': '0.0516', 'NDCG@5': '0.0359', 'HR@10': '0.0751', 'NDCG@10': '0.0434', 'HR@20': '0.1062', 'NDCG@20': '0.0513'}
2025-02-28 22:52:47,182 - EarlyStopping counter: 6 out of 10
2025-02-28 22:53:31,797 - {'epoch': 60, 'rec_loss': '7.5677'}
2025-02-28 22:53:51,086 - {'Epoch': 60, 'HR@5': '0.0524', 'NDCG@5': '0.0363', 'HR@10': '0.0756', 'NDCG@10': '0.0437', 'HR@20': '0.1062', 'NDCG@20': '0.0514'}
2025-02-28 22:53:51,091 - EarlyStopping counter: 7 out of 10
2025-02-28 22:54:33,721 - {'epoch': 61, 'rec_loss': '7.5695'}
2025-02-28 22:54:53,363 - {'Epoch': 61, 'HR@5': '0.0527', 'NDCG@5': '0.0366', 'HR@10': '0.0756', 'NDCG@10': '0.0440', 'HR@20': '0.1067', 'NDCG@20': '0.0518'}
2025-02-28 22:54:53,364 - EarlyStopping counter: 8 out of 10
2025-02-28 22:55:39,979 - {'epoch': 62, 'rec_loss': '7.5654'}
2025-02-28 22:56:00,240 - {'Epoch': 62, 'HR@5': '0.0523', 'NDCG@5': '0.0360', 'HR@10': '0.0756', 'NDCG@10': '0.0435', 'HR@20': '0.1058', 'NDCG@20': '0.0511'}
2025-02-28 22:56:00,245 - EarlyStopping counter: 9 out of 10
2025-02-28 22:56:47,427 - {'epoch': 63, 'rec_loss': '7.5626'}
2025-02-28 22:57:05,929 - {'Epoch': 63, 'HR@5': '0.0517', 'NDCG@5': '0.0358', 'HR@10': '0.0757', 'NDCG@10': '0.0435', 'HR@20': '0.1056', 'NDCG@20': '0.0510'}
2025-02-28 22:57:05,931 - EarlyStopping counter: 10 out of 10
2025-02-28 22:57:05,931 - Early stopping
2025-02-28 22:57:05,931 - ---------------Test Score---------------
2025-02-28 22:57:24,313 - {'Epoch': 0, 'HR@5': '0.0435', 'NDCG@5': '0.0301', 'HR@10': '0.0632', 'NDCG@10': '0.0364', 'HR@20': '0.0873', 'NDCG@20': '0.0424'}
2025-02-28 22:57:24,317 - Scale_Sports
2025-02-28 22:57:24,318 - {'Epoch': 0, 'HR@5': '0.0435', 'NDCG@5': '0.0301', 'HR@10': '0.0632', 'NDCG@10': '0.0364', 'HR@20': '0.0873', 'NDCG@20': '0.0424'}
2025-02-28 23:01:00,036 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-02-28 23:01:03,158 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=2, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=2, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-02-28 23:01:03,172 - Total Parameters: 1328850
2025-02-28 23:01:42,912 - {'epoch': 0, 'rec_loss': '9.4030'}
2025-02-28 23:02:00,420 - {'Epoch': 0, 'HR@5': '0.0083', 'NDCG@5': '0.0055', 'HR@10': '0.0126', 'NDCG@10': '0.0069', 'HR@20': '0.0228', 'NDCG@20': '0.0094'}
2025-02-28 23:02:00,424 - Validation score increased.  Saving model ...
2025-02-28 23:02:35,583 - {'epoch': 1, 'rec_loss': '9.1950'}
2025-02-28 23:02:53,526 - {'Epoch': 1, 'HR@5': '0.0148', 'NDCG@5': '0.0097', 'HR@10': '0.0248', 'NDCG@10': '0.0129', 'HR@20': '0.0402', 'NDCG@20': '0.0167'}
2025-02-28 23:02:53,527 - Validation score increased.  Saving model ...
2025-02-28 23:03:33,373 - {'epoch': 2, 'rec_loss': '8.9263'}
2025-02-28 23:03:52,277 - {'Epoch': 2, 'HR@5': '0.0195', 'NDCG@5': '0.0130', 'HR@10': '0.0309', 'NDCG@10': '0.0166', 'HR@20': '0.0509', 'NDCG@20': '0.0216'}
2025-02-28 23:03:52,280 - Validation score increased.  Saving model ...
2025-02-28 23:04:33,203 - {'epoch': 3, 'rec_loss': '8.7372'}
2025-02-28 23:04:51,327 - {'Epoch': 3, 'HR@5': '0.0260', 'NDCG@5': '0.0163', 'HR@10': '0.0405', 'NDCG@10': '0.0210', 'HR@20': '0.0623', 'NDCG@20': '0.0265'}
2025-02-28 23:04:51,333 - Validation score increased.  Saving model ...
2025-02-28 23:05:30,086 - {'epoch': 4, 'rec_loss': '8.5881'}
2025-02-28 23:05:48,472 - {'Epoch': 4, 'HR@5': '0.0308', 'NDCG@5': '0.0204', 'HR@10': '0.0474', 'NDCG@10': '0.0257', 'HR@20': '0.0721', 'NDCG@20': '0.0319'}
2025-02-28 23:05:48,473 - Validation score increased.  Saving model ...
2025-02-28 23:06:28,544 - {'epoch': 5, 'rec_loss': '8.4739'}
2025-02-28 23:06:46,934 - {'Epoch': 5, 'HR@5': '0.0345', 'NDCG@5': '0.0231', 'HR@10': '0.0533', 'NDCG@10': '0.0292', 'HR@20': '0.0794', 'NDCG@20': '0.0358'}
2025-02-28 23:06:46,935 - Validation score increased.  Saving model ...
2025-02-28 23:07:26,999 - {'epoch': 6, 'rec_loss': '8.3767'}
2025-02-28 23:07:44,044 - {'Epoch': 6, 'HR@5': '0.0389', 'NDCG@5': '0.0264', 'HR@10': '0.0586', 'NDCG@10': '0.0328', 'HR@20': '0.0848', 'NDCG@20': '0.0394'}
2025-02-28 23:07:44,045 - Validation score increased.  Saving model ...
2025-02-28 23:08:21,147 - {'epoch': 7, 'rec_loss': '8.2986'}
2025-02-28 23:08:40,509 - {'Epoch': 7, 'HR@5': '0.0413', 'NDCG@5': '0.0287', 'HR@10': '0.0599', 'NDCG@10': '0.0346', 'HR@20': '0.0871', 'NDCG@20': '0.0415'}
2025-02-28 23:08:40,510 - Validation score increased.  Saving model ...
2025-02-28 23:09:19,607 - {'epoch': 8, 'rec_loss': '8.2332'}
2025-02-28 23:09:38,587 - {'Epoch': 8, 'HR@5': '0.0431', 'NDCG@5': '0.0296', 'HR@10': '0.0627', 'NDCG@10': '0.0359', 'HR@20': '0.0894', 'NDCG@20': '0.0427'}
2025-02-28 23:09:38,590 - Validation score increased.  Saving model ...
2025-02-28 23:10:19,401 - {'epoch': 9, 'rec_loss': '8.1686'}
2025-02-28 23:10:38,408 - {'Epoch': 9, 'HR@5': '0.0446', 'NDCG@5': '0.0308', 'HR@10': '0.0651', 'NDCG@10': '0.0374', 'HR@20': '0.0939', 'NDCG@20': '0.0446'}
2025-02-28 23:10:38,410 - Validation score increased.  Saving model ...
2025-02-28 23:11:18,401 - {'epoch': 10, 'rec_loss': '8.1257'}
2025-02-28 23:11:36,880 - {'Epoch': 10, 'HR@5': '0.0465', 'NDCG@5': '0.0322', 'HR@10': '0.0667', 'NDCG@10': '0.0387', 'HR@20': '0.0944', 'NDCG@20': '0.0456'}
2025-02-28 23:11:36,881 - Validation score increased.  Saving model ...
2025-02-28 23:12:16,191 - {'epoch': 11, 'rec_loss': '8.0816'}
2025-02-28 23:12:35,329 - {'Epoch': 11, 'HR@5': '0.0480', 'NDCG@5': '0.0333', 'HR@10': '0.0683', 'NDCG@10': '0.0398', 'HR@20': '0.0956', 'NDCG@20': '0.0467'}
2025-02-28 23:12:35,336 - Validation score increased.  Saving model ...
2025-02-28 23:13:10,948 - {'epoch': 12, 'rec_loss': '8.0433'}
2025-02-28 23:13:29,731 - {'Epoch': 12, 'HR@5': '0.0472', 'NDCG@5': '0.0332', 'HR@10': '0.0686', 'NDCG@10': '0.0401', 'HR@20': '0.0969', 'NDCG@20': '0.0472'}
2025-02-28 23:13:29,736 - Validation score increased.  Saving model ...
2025-02-28 23:14:14,072 - {'epoch': 13, 'rec_loss': '8.0123'}
2025-02-28 23:14:33,322 - {'Epoch': 13, 'HR@5': '0.0480', 'NDCG@5': '0.0334', 'HR@10': '0.0692', 'NDCG@10': '0.0402', 'HR@20': '0.0982', 'NDCG@20': '0.0475'}
2025-02-28 23:14:33,328 - Validation score increased.  Saving model ...
2025-02-28 23:15:14,548 - {'epoch': 14, 'rec_loss': '7.9862'}
2025-02-28 23:15:33,947 - {'Epoch': 14, 'HR@5': '0.0485', 'NDCG@5': '0.0335', 'HR@10': '0.0710', 'NDCG@10': '0.0408', 'HR@20': '0.0998', 'NDCG@20': '0.0480'}
2025-02-28 23:15:33,952 - Validation score increased.  Saving model ...
2025-02-28 23:16:15,715 - {'epoch': 15, 'rec_loss': '7.9575'}
2025-02-28 23:16:34,930 - {'Epoch': 15, 'HR@5': '0.0489', 'NDCG@5': '0.0344', 'HR@10': '0.0699', 'NDCG@10': '0.0411', 'HR@20': '0.0997', 'NDCG@20': '0.0486'}
2025-02-28 23:16:34,931 - Validation score increased.  Saving model ...
2025-02-28 23:17:14,055 - {'epoch': 16, 'rec_loss': '7.9334'}
2025-02-28 23:17:33,337 - {'Epoch': 16, 'HR@5': '0.0490', 'NDCG@5': '0.0344', 'HR@10': '0.0717', 'NDCG@10': '0.0417', 'HR@20': '0.1011', 'NDCG@20': '0.0491'}
2025-02-28 23:17:33,338 - Validation score increased.  Saving model ...
2025-02-28 23:18:12,580 - {'epoch': 17, 'rec_loss': '7.9149'}
2025-02-28 23:18:30,142 - {'Epoch': 17, 'HR@5': '0.0505', 'NDCG@5': '0.0355', 'HR@10': '0.0709', 'NDCG@10': '0.0420', 'HR@20': '0.1004', 'NDCG@20': '0.0494'}
2025-02-28 23:18:30,143 - Validation score increased.  Saving model ...
2025-02-28 23:19:06,839 - {'epoch': 18, 'rec_loss': '7.8926'}
2025-02-28 23:19:25,991 - {'Epoch': 18, 'HR@5': '0.0507', 'NDCG@5': '0.0355', 'HR@10': '0.0714', 'NDCG@10': '0.0422', 'HR@20': '0.1011', 'NDCG@20': '0.0497'}
2025-02-28 23:19:25,993 - Validation score increased.  Saving model ...
2025-02-28 23:20:09,029 - {'epoch': 19, 'rec_loss': '7.8701'}
2025-02-28 23:20:27,199 - {'Epoch': 19, 'HR@5': '0.0504', 'NDCG@5': '0.0351', 'HR@10': '0.0719', 'NDCG@10': '0.0420', 'HR@20': '0.1008', 'NDCG@20': '0.0493'}
2025-02-28 23:20:27,200 - EarlyStopping counter: 1 out of 10
2025-02-28 23:21:10,654 - {'epoch': 20, 'rec_loss': '7.8568'}
2025-02-28 23:21:30,215 - {'Epoch': 20, 'HR@5': '0.0503', 'NDCG@5': '0.0352', 'HR@10': '0.0723', 'NDCG@10': '0.0423', 'HR@20': '0.1030', 'NDCG@20': '0.0500'}
2025-02-28 23:21:30,217 - Validation score increased.  Saving model ...
2025-02-28 23:22:11,554 - {'epoch': 21, 'rec_loss': '7.8314'}
2025-02-28 23:22:30,902 - {'Epoch': 21, 'HR@5': '0.0510', 'NDCG@5': '0.0350', 'HR@10': '0.0725', 'NDCG@10': '0.0419', 'HR@20': '0.1012', 'NDCG@20': '0.0491'}
2025-02-28 23:22:30,906 - EarlyStopping counter: 1 out of 10
2025-02-28 23:23:12,105 - {'epoch': 22, 'rec_loss': '7.8267'}
2025-02-28 23:23:29,184 - {'Epoch': 22, 'HR@5': '0.0521', 'NDCG@5': '0.0360', 'HR@10': '0.0728', 'NDCG@10': '0.0427', 'HR@20': '0.1023', 'NDCG@20': '0.0501'}
2025-02-28 23:23:29,185 - Validation score increased.  Saving model ...
2025-02-28 23:24:05,011 - {'epoch': 23, 'rec_loss': '7.8115'}
2025-02-28 23:24:23,390 - {'Epoch': 23, 'HR@5': '0.0524', 'NDCG@5': '0.0366', 'HR@10': '0.0742', 'NDCG@10': '0.0436', 'HR@20': '0.1019', 'NDCG@20': '0.0506'}
2025-02-28 23:24:23,391 - Validation score increased.  Saving model ...
2025-02-28 23:25:02,845 - {'epoch': 24, 'rec_loss': '7.7966'}
2025-02-28 23:25:22,129 - {'Epoch': 24, 'HR@5': '0.0508', 'NDCG@5': '0.0352', 'HR@10': '0.0730', 'NDCG@10': '0.0423', 'HR@20': '0.1031', 'NDCG@20': '0.0499'}
2025-02-28 23:25:22,131 - EarlyStopping counter: 1 out of 10
2025-02-28 23:26:01,330 - {'epoch': 25, 'rec_loss': '7.7799'}
2025-02-28 23:26:19,441 - {'Epoch': 25, 'HR@5': '0.0520', 'NDCG@5': '0.0362', 'HR@10': '0.0736', 'NDCG@10': '0.0432', 'HR@20': '0.1031', 'NDCG@20': '0.0506'}
2025-02-28 23:26:19,442 - Validation score increased.  Saving model ...
2025-02-28 23:27:00,452 - {'epoch': 26, 'rec_loss': '7.7710'}
2025-02-28 23:27:19,282 - {'Epoch': 26, 'HR@5': '0.0521', 'NDCG@5': '0.0358', 'HR@10': '0.0734', 'NDCG@10': '0.0427', 'HR@20': '0.1044', 'NDCG@20': '0.0505'}
2025-02-28 23:27:19,283 - EarlyStopping counter: 1 out of 10
2025-02-28 23:28:01,628 - {'epoch': 27, 'rec_loss': '7.7605'}
2025-02-28 23:28:19,177 - {'Epoch': 27, 'HR@5': '0.0513', 'NDCG@5': '0.0356', 'HR@10': '0.0739', 'NDCG@10': '0.0429', 'HR@20': '0.1030', 'NDCG@20': '0.0502'}
2025-02-28 23:28:19,178 - EarlyStopping counter: 2 out of 10
2025-02-28 23:28:57,329 - {'epoch': 28, 'rec_loss': '7.7469'}
2025-02-28 23:29:13,739 - {'Epoch': 28, 'HR@5': '0.0523', 'NDCG@5': '0.0360', 'HR@10': '0.0740', 'NDCG@10': '0.0429', 'HR@20': '0.1037', 'NDCG@20': '0.0504'}
2025-02-28 23:29:13,741 - EarlyStopping counter: 3 out of 10
2025-02-28 23:29:54,012 - {'epoch': 29, 'rec_loss': '7.7358'}
2025-02-28 23:30:12,934 - {'Epoch': 29, 'HR@5': '0.0518', 'NDCG@5': '0.0357', 'HR@10': '0.0749', 'NDCG@10': '0.0432', 'HR@20': '0.1042', 'NDCG@20': '0.0505'}
2025-02-28 23:30:12,936 - EarlyStopping counter: 4 out of 10
2025-02-28 23:30:54,856 - {'epoch': 30, 'rec_loss': '7.7220'}
2025-02-28 23:31:13,346 - {'Epoch': 30, 'HR@5': '0.0517', 'NDCG@5': '0.0357', 'HR@10': '0.0749', 'NDCG@10': '0.0432', 'HR@20': '0.1029', 'NDCG@20': '0.0502'}
2025-02-28 23:31:13,353 - EarlyStopping counter: 5 out of 10
2025-02-28 23:31:52,720 - {'epoch': 31, 'rec_loss': '7.7164'}
2025-02-28 23:32:11,415 - {'Epoch': 31, 'HR@5': '0.0518', 'NDCG@5': '0.0360', 'HR@10': '0.0734', 'NDCG@10': '0.0429', 'HR@20': '0.1040', 'NDCG@20': '0.0506'}
2025-02-28 23:32:11,416 - Validation score increased.  Saving model ...
2025-02-28 23:32:52,339 - {'epoch': 32, 'rec_loss': '7.7066'}
2025-02-28 23:33:11,820 - {'Epoch': 32, 'HR@5': '0.0510', 'NDCG@5': '0.0359', 'HR@10': '0.0741', 'NDCG@10': '0.0433', 'HR@20': '0.1039', 'NDCG@20': '0.0508'}
2025-02-28 23:33:11,821 - Validation score increased.  Saving model ...
2025-02-28 23:33:52,397 - {'epoch': 33, 'rec_loss': '7.6999'}
2025-02-28 23:34:10,578 - {'Epoch': 33, 'HR@5': '0.0515', 'NDCG@5': '0.0360', 'HR@10': '0.0734', 'NDCG@10': '0.0431', 'HR@20': '0.1039', 'NDCG@20': '0.0507'}
2025-02-28 23:34:10,579 - EarlyStopping counter: 1 out of 10
2025-02-28 23:34:46,258 - {'epoch': 34, 'rec_loss': '7.6919'}
2025-02-28 23:35:03,948 - {'Epoch': 34, 'HR@5': '0.0521', 'NDCG@5': '0.0359', 'HR@10': '0.0732', 'NDCG@10': '0.0427', 'HR@20': '0.1031', 'NDCG@20': '0.0502'}
2025-02-28 23:35:03,954 - EarlyStopping counter: 2 out of 10
2025-02-28 23:35:40,211 - {'epoch': 35, 'rec_loss': '7.6822'}
2025-02-28 23:35:58,883 - {'Epoch': 35, 'HR@5': '0.0530', 'NDCG@5': '0.0366', 'HR@10': '0.0742', 'NDCG@10': '0.0434', 'HR@20': '0.1038', 'NDCG@20': '0.0509'}
2025-02-28 23:35:58,884 - Validation score increased.  Saving model ...
2025-02-28 23:36:34,054 - {'epoch': 36, 'rec_loss': '7.6819'}
2025-02-28 23:36:50,426 - {'Epoch': 36, 'HR@5': '0.0530', 'NDCG@5': '0.0367', 'HR@10': '0.0743', 'NDCG@10': '0.0435', 'HR@20': '0.1042', 'NDCG@20': '0.0510'}
2025-02-28 23:36:50,427 - Validation score increased.  Saving model ...
2025-02-28 23:37:27,059 - {'epoch': 37, 'rec_loss': '7.6666'}
2025-02-28 23:37:45,898 - {'Epoch': 37, 'HR@5': '0.0516', 'NDCG@5': '0.0361', 'HR@10': '0.0741', 'NDCG@10': '0.0434', 'HR@20': '0.1037', 'NDCG@20': '0.0508'}
2025-02-28 23:37:45,904 - EarlyStopping counter: 1 out of 10
2025-02-28 23:38:20,866 - {'epoch': 38, 'rec_loss': '7.6572'}
2025-02-28 23:38:37,942 - {'Epoch': 38, 'HR@5': '0.0534', 'NDCG@5': '0.0369', 'HR@10': '0.0757', 'NDCG@10': '0.0441', 'HR@20': '0.1055', 'NDCG@20': '0.0516'}
2025-02-28 23:38:37,945 - Validation score increased.  Saving model ...
2025-02-28 23:39:14,457 - {'epoch': 39, 'rec_loss': '7.6517'}
2025-02-28 23:39:33,593 - {'Epoch': 39, 'HR@5': '0.0529', 'NDCG@5': '0.0368', 'HR@10': '0.0742', 'NDCG@10': '0.0437', 'HR@20': '0.1031', 'NDCG@20': '0.0509'}
2025-02-28 23:39:33,598 - EarlyStopping counter: 1 out of 10
2025-02-28 23:40:09,875 - {'epoch': 40, 'rec_loss': '7.6433'}
2025-02-28 23:40:26,028 - {'Epoch': 40, 'HR@5': '0.0526', 'NDCG@5': '0.0360', 'HR@10': '0.0750', 'NDCG@10': '0.0432', 'HR@20': '0.1050', 'NDCG@20': '0.0507'}
2025-02-28 23:40:26,029 - EarlyStopping counter: 2 out of 10
2025-02-28 23:41:01,000 - {'epoch': 41, 'rec_loss': '7.6420'}
2025-02-28 23:41:18,472 - {'Epoch': 41, 'HR@5': '0.0524', 'NDCG@5': '0.0364', 'HR@10': '0.0757', 'NDCG@10': '0.0439', 'HR@20': '0.1059', 'NDCG@20': '0.0515'}
2025-02-28 23:41:18,473 - EarlyStopping counter: 3 out of 10
2025-02-28 23:41:53,877 - {'epoch': 42, 'rec_loss': '7.6362'}
2025-02-28 23:42:11,993 - {'Epoch': 42, 'HR@5': '0.0520', 'NDCG@5': '0.0364', 'HR@10': '0.0754', 'NDCG@10': '0.0439', 'HR@20': '0.1055', 'NDCG@20': '0.0515'}
2025-02-28 23:42:12,001 - EarlyStopping counter: 4 out of 10
2025-02-28 23:42:48,532 - {'epoch': 43, 'rec_loss': '7.6315'}
2025-02-28 23:43:06,876 - {'Epoch': 43, 'HR@5': '0.0519', 'NDCG@5': '0.0363', 'HR@10': '0.0751', 'NDCG@10': '0.0437', 'HR@20': '0.1046', 'NDCG@20': '0.0512'}
2025-02-28 23:43:06,877 - EarlyStopping counter: 5 out of 10
2025-02-28 23:43:42,683 - {'epoch': 44, 'rec_loss': '7.6270'}
2025-02-28 23:44:00,553 - {'Epoch': 44, 'HR@5': '0.0527', 'NDCG@5': '0.0366', 'HR@10': '0.0749', 'NDCG@10': '0.0437', 'HR@20': '0.1061', 'NDCG@20': '0.0516'}
2025-02-28 23:44:00,555 - EarlyStopping counter: 6 out of 10
2025-02-28 23:44:35,759 - {'epoch': 45, 'rec_loss': '7.6203'}
2025-02-28 23:44:52,369 - {'Epoch': 45, 'HR@5': '0.0527', 'NDCG@5': '0.0366', 'HR@10': '0.0740', 'NDCG@10': '0.0434', 'HR@20': '0.1052', 'NDCG@20': '0.0513'}
2025-02-28 23:44:52,371 - EarlyStopping counter: 7 out of 10
2025-02-28 23:45:27,363 - {'epoch': 46, 'rec_loss': '7.6147'}
2025-02-28 23:45:46,261 - {'Epoch': 46, 'HR@5': '0.0527', 'NDCG@5': '0.0368', 'HR@10': '0.0746', 'NDCG@10': '0.0438', 'HR@20': '0.1050', 'NDCG@20': '0.0515'}
2025-02-28 23:45:46,267 - EarlyStopping counter: 8 out of 10
2025-02-28 23:46:21,615 - {'epoch': 47, 'rec_loss': '7.6130'}
2025-02-28 23:46:40,441 - {'Epoch': 47, 'HR@5': '0.0522', 'NDCG@5': '0.0361', 'HR@10': '0.0748', 'NDCG@10': '0.0433', 'HR@20': '0.1048', 'NDCG@20': '0.0509'}
2025-02-28 23:46:40,442 - EarlyStopping counter: 9 out of 10
2025-02-28 23:47:15,468 - {'epoch': 48, 'rec_loss': '7.5998'}
2025-02-28 23:47:33,618 - {'Epoch': 48, 'HR@5': '0.0531', 'NDCG@5': '0.0369', 'HR@10': '0.0755', 'NDCG@10': '0.0440', 'HR@20': '0.1037', 'NDCG@20': '0.0512'}
2025-02-28 23:47:33,620 - EarlyStopping counter: 10 out of 10
2025-02-28 23:47:33,620 - Early stopping
2025-02-28 23:47:33,620 - ---------------Test Score---------------
2025-02-28 23:47:52,566 - {'Epoch': 0, 'HR@5': '0.0431', 'NDCG@5': '0.0300', 'HR@10': '0.0624', 'NDCG@10': '0.0362', 'HR@20': '0.0871', 'NDCG@20': '0.0424'}
2025-02-28 23:47:52,574 - Scale_Sports
2025-02-28 23:47:52,574 - {'Epoch': 0, 'HR@5': '0.0431', 'NDCG@5': '0.0300', 'HR@10': '0.0624', 'NDCG@10': '0.0362', 'HR@20': '0.0871', 'NDCG@20': '0.0424'}
2025-03-01 00:04:03,151 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25, 5], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-01 00:04:05,986 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-01 00:04:05,991 - Total Parameters: 1328529
2025-03-01 00:05:00,584 - {'epoch': 0, 'rec_loss': '9.4134'}
2025-03-01 00:05:20,484 - {'Epoch': 0, 'HR@5': '0.0084', 'NDCG@5': '0.0055', 'HR@10': '0.0128', 'NDCG@10': '0.0069', 'HR@20': '0.0222', 'NDCG@20': '0.0093'}
2025-03-01 00:05:20,486 - Validation score increased.  Saving model ...
2025-03-01 00:06:15,278 - {'epoch': 1, 'rec_loss': '9.1668'}
2025-03-01 00:06:33,576 - {'Epoch': 1, 'HR@5': '0.0166', 'NDCG@5': '0.0103', 'HR@10': '0.0267', 'NDCG@10': '0.0136', 'HR@20': '0.0419', 'NDCG@20': '0.0174'}
2025-03-01 00:06:33,578 - Validation score increased.  Saving model ...
2025-03-01 00:07:29,088 - {'epoch': 2, 'rec_loss': '8.8487'}
2025-03-01 00:07:47,930 - {'Epoch': 2, 'HR@5': '0.0229', 'NDCG@5': '0.0145', 'HR@10': '0.0358', 'NDCG@10': '0.0186', 'HR@20': '0.0569', 'NDCG@20': '0.0240'}
2025-03-01 00:07:47,932 - Validation score increased.  Saving model ...
2025-03-01 00:08:39,506 - {'epoch': 3, 'rec_loss': '8.6315'}
2025-03-01 00:08:56,116 - {'Epoch': 3, 'HR@5': '0.0304', 'NDCG@5': '0.0197', 'HR@10': '0.0482', 'NDCG@10': '0.0254', 'HR@20': '0.0722', 'NDCG@20': '0.0314'}
2025-03-01 00:08:56,117 - Validation score increased.  Saving model ...
2025-03-01 00:09:48,724 - {'epoch': 4, 'rec_loss': '8.4615'}
2025-03-01 00:10:08,127 - {'Epoch': 4, 'HR@5': '0.0365', 'NDCG@5': '0.0248', 'HR@10': '0.0537', 'NDCG@10': '0.0304', 'HR@20': '0.0809', 'NDCG@20': '0.0372'}
2025-03-01 00:10:08,128 - Validation score increased.  Saving model ...
2025-03-01 00:10:59,346 - {'epoch': 5, 'rec_loss': '8.3315'}
2025-03-01 00:11:17,506 - {'Epoch': 5, 'HR@5': '0.0401', 'NDCG@5': '0.0273', 'HR@10': '0.0594', 'NDCG@10': '0.0336', 'HR@20': '0.0852', 'NDCG@20': '0.0401'}
2025-03-01 00:11:17,507 - Validation score increased.  Saving model ...
2025-03-01 00:12:09,084 - {'epoch': 6, 'rec_loss': '8.2265'}
2025-03-01 00:12:27,883 - {'Epoch': 6, 'HR@5': '0.0415', 'NDCG@5': '0.0284', 'HR@10': '0.0617', 'NDCG@10': '0.0350', 'HR@20': '0.0883', 'NDCG@20': '0.0417'}
2025-03-01 00:12:27,887 - Validation score increased.  Saving model ...
2025-03-01 00:13:20,353 - {'epoch': 7, 'rec_loss': '8.1413'}
2025-03-01 00:13:39,159 - {'Epoch': 7, 'HR@5': '0.0444', 'NDCG@5': '0.0306', 'HR@10': '0.0644', 'NDCG@10': '0.0371', 'HR@20': '0.0922', 'NDCG@20': '0.0441'}
2025-03-01 00:13:39,160 - Validation score increased.  Saving model ...
2025-03-01 00:14:30,818 - {'epoch': 8, 'rec_loss': '8.0751'}
2025-03-01 00:14:47,945 - {'Epoch': 8, 'HR@5': '0.0452', 'NDCG@5': '0.0314', 'HR@10': '0.0658', 'NDCG@10': '0.0380', 'HR@20': '0.0938', 'NDCG@20': '0.0450'}
2025-03-01 00:14:47,946 - Validation score increased.  Saving model ...
2025-03-01 00:15:44,123 - {'epoch': 9, 'rec_loss': '8.0163'}
2025-03-01 00:16:01,242 - {'Epoch': 9, 'HR@5': '0.0462', 'NDCG@5': '0.0322', 'HR@10': '0.0668', 'NDCG@10': '0.0388', 'HR@20': '0.0951', 'NDCG@20': '0.0459'}
2025-03-01 00:16:01,244 - Validation score increased.  Saving model ...
2025-03-01 00:16:53,277 - {'epoch': 10, 'rec_loss': '7.9686'}
2025-03-01 00:17:12,285 - {'Epoch': 10, 'HR@5': '0.0485', 'NDCG@5': '0.0338', 'HR@10': '0.0685', 'NDCG@10': '0.0402', 'HR@20': '0.0958', 'NDCG@20': '0.0471'}
2025-03-01 00:17:12,286 - Validation score increased.  Saving model ...
2025-03-01 00:18:04,634 - {'epoch': 11, 'rec_loss': '7.9287'}
2025-03-01 00:18:22,387 - {'Epoch': 11, 'HR@5': '0.0473', 'NDCG@5': '0.0333', 'HR@10': '0.0681', 'NDCG@10': '0.0400', 'HR@20': '0.0962', 'NDCG@20': '0.0470'}
2025-03-01 00:18:22,388 - EarlyStopping counter: 1 out of 10
2025-03-01 00:19:13,966 - {'epoch': 12, 'rec_loss': '7.8928'}
2025-03-01 00:19:33,632 - {'Epoch': 12, 'HR@5': '0.0498', 'NDCG@5': '0.0350', 'HR@10': '0.0700', 'NDCG@10': '0.0414', 'HR@20': '0.0990', 'NDCG@20': '0.0487'}
2025-03-01 00:19:33,633 - Validation score increased.  Saving model ...
2025-03-01 00:20:30,139 - {'epoch': 13, 'rec_loss': '7.8641'}
2025-03-01 00:20:49,917 - {'Epoch': 13, 'HR@5': '0.0485', 'NDCG@5': '0.0339', 'HR@10': '0.0707', 'NDCG@10': '0.0410', 'HR@20': '0.1001', 'NDCG@20': '0.0484'}
2025-03-01 00:20:49,918 - EarlyStopping counter: 1 out of 10
2025-03-01 00:21:41,250 - {'epoch': 14, 'rec_loss': '7.8353'}
2025-03-01 00:22:00,950 - {'Epoch': 14, 'HR@5': '0.0492', 'NDCG@5': '0.0345', 'HR@10': '0.0710', 'NDCG@10': '0.0416', 'HR@20': '0.1012', 'NDCG@20': '0.0492'}
2025-03-01 00:22:00,952 - Validation score increased.  Saving model ...
2025-03-01 00:22:59,571 - {'epoch': 15, 'rec_loss': '7.8142'}
2025-03-01 00:23:17,119 - {'Epoch': 15, 'HR@5': '0.0501', 'NDCG@5': '0.0347', 'HR@10': '0.0712', 'NDCG@10': '0.0415', 'HR@20': '0.1030', 'NDCG@20': '0.0495'}
2025-03-01 00:23:17,120 - Validation score increased.  Saving model ...
2025-03-01 00:24:15,671 - {'epoch': 16, 'rec_loss': '7.7860'}
2025-03-01 00:24:33,294 - {'Epoch': 16, 'HR@5': '0.0493', 'NDCG@5': '0.0346', 'HR@10': '0.0718', 'NDCG@10': '0.0418', 'HR@20': '0.1019', 'NDCG@20': '0.0494'}
2025-03-01 00:24:33,295 - EarlyStopping counter: 1 out of 10
2025-03-01 00:25:30,471 - {'epoch': 17, 'rec_loss': '7.7668'}
2025-03-01 00:25:50,187 - {'Epoch': 17, 'HR@5': '0.0505', 'NDCG@5': '0.0353', 'HR@10': '0.0724', 'NDCG@10': '0.0423', 'HR@20': '0.1029', 'NDCG@20': '0.0499'}
2025-03-01 00:25:50,188 - Validation score increased.  Saving model ...
2025-03-01 00:26:42,789 - {'epoch': 18, 'rec_loss': '7.7475'}
2025-03-01 00:27:01,556 - {'Epoch': 18, 'HR@5': '0.0505', 'NDCG@5': '0.0352', 'HR@10': '0.0723', 'NDCG@10': '0.0422', 'HR@20': '0.1028', 'NDCG@20': '0.0499'}
2025-03-01 00:27:01,558 - EarlyStopping counter: 1 out of 10
2025-03-01 00:27:52,827 - {'epoch': 19, 'rec_loss': '7.7299'}
2025-03-01 00:28:10,070 - {'Epoch': 19, 'HR@5': '0.0506', 'NDCG@5': '0.0355', 'HR@10': '0.0734', 'NDCG@10': '0.0428', 'HR@20': '0.1025', 'NDCG@20': '0.0501'}
2025-03-01 00:28:10,072 - Validation score increased.  Saving model ...
2025-03-01 00:29:01,763 - {'epoch': 20, 'rec_loss': '7.7077'}
2025-03-01 00:29:19,133 - {'Epoch': 20, 'HR@5': '0.0511', 'NDCG@5': '0.0355', 'HR@10': '0.0728', 'NDCG@10': '0.0424', 'HR@20': '0.1036', 'NDCG@20': '0.0502'}
2025-03-01 00:29:19,135 - Validation score increased.  Saving model ...
2025-03-01 00:30:12,991 - {'epoch': 21, 'rec_loss': '7.6948'}
2025-03-01 00:30:32,676 - {'Epoch': 21, 'HR@5': '0.0512', 'NDCG@5': '0.0358', 'HR@10': '0.0739', 'NDCG@10': '0.0432', 'HR@20': '0.1038', 'NDCG@20': '0.0507'}
2025-03-01 00:30:32,677 - Validation score increased.  Saving model ...
2025-03-01 00:31:30,345 - {'epoch': 22, 'rec_loss': '7.6816'}
2025-03-01 00:31:51,753 - {'Epoch': 22, 'HR@5': '0.0519', 'NDCG@5': '0.0359', 'HR@10': '0.0743', 'NDCG@10': '0.0431', 'HR@20': '0.1039', 'NDCG@20': '0.0506'}
2025-03-01 00:31:51,754 - EarlyStopping counter: 1 out of 10
2025-03-01 00:32:45,802 - {'epoch': 23, 'rec_loss': '7.6656'}
2025-03-01 00:33:04,147 - {'Epoch': 23, 'HR@5': '0.0518', 'NDCG@5': '0.0360', 'HR@10': '0.0746', 'NDCG@10': '0.0433', 'HR@20': '0.1061', 'NDCG@20': '0.0512'}
2025-03-01 00:33:04,148 - Validation score increased.  Saving model ...
2025-03-01 00:33:55,366 - {'epoch': 24, 'rec_loss': '7.6523'}
2025-03-01 00:34:12,985 - {'Epoch': 24, 'HR@5': '0.0504', 'NDCG@5': '0.0352', 'HR@10': '0.0740', 'NDCG@10': '0.0429', 'HR@20': '0.1035', 'NDCG@20': '0.0503'}
2025-03-01 00:34:12,987 - EarlyStopping counter: 1 out of 10
2025-03-01 00:35:04,695 - {'epoch': 25, 'rec_loss': '7.6411'}
2025-03-01 00:35:22,212 - {'Epoch': 25, 'HR@5': '0.0511', 'NDCG@5': '0.0358', 'HR@10': '0.0751', 'NDCG@10': '0.0435', 'HR@20': '0.1066', 'NDCG@20': '0.0515'}
2025-03-01 00:35:22,213 - Validation score increased.  Saving model ...
2025-03-01 00:36:13,438 - {'epoch': 26, 'rec_loss': '7.6314'}
2025-03-01 00:36:30,668 - {'Epoch': 26, 'HR@5': '0.0503', 'NDCG@5': '0.0351', 'HR@10': '0.0742', 'NDCG@10': '0.0428', 'HR@20': '0.1033', 'NDCG@20': '0.0501'}
2025-03-01 00:36:30,669 - EarlyStopping counter: 1 out of 10
2025-03-01 00:37:30,400 - {'epoch': 27, 'rec_loss': '7.6139'}
2025-03-01 00:37:48,008 - {'Epoch': 27, 'HR@5': '0.0521', 'NDCG@5': '0.0358', 'HR@10': '0.0750', 'NDCG@10': '0.0432', 'HR@20': '0.1055', 'NDCG@20': '0.0509'}
2025-03-01 00:37:48,012 - EarlyStopping counter: 2 out of 10
2025-03-01 00:38:40,133 - {'epoch': 28, 'rec_loss': '7.6065'}
2025-03-01 00:38:57,531 - {'Epoch': 28, 'HR@5': '0.0523', 'NDCG@5': '0.0360', 'HR@10': '0.0754', 'NDCG@10': '0.0435', 'HR@20': '0.1060', 'NDCG@20': '0.0512'}
2025-03-01 00:38:57,532 - EarlyStopping counter: 3 out of 10
2025-03-01 00:39:49,698 - {'epoch': 29, 'rec_loss': '7.6016'}
2025-03-01 00:40:08,273 - {'Epoch': 29, 'HR@5': '0.0531', 'NDCG@5': '0.0366', 'HR@10': '0.0767', 'NDCG@10': '0.0442', 'HR@20': '0.1073', 'NDCG@20': '0.0519'}
2025-03-01 00:40:08,275 - Validation score increased.  Saving model ...
2025-03-01 00:40:59,535 - {'epoch': 30, 'rec_loss': '7.5897'}
2025-03-01 00:41:19,456 - {'Epoch': 30, 'HR@5': '0.0528', 'NDCG@5': '0.0365', 'HR@10': '0.0767', 'NDCG@10': '0.0441', 'HR@20': '0.1075', 'NDCG@20': '0.0519'}
2025-03-01 00:41:19,457 - Validation score increased.  Saving model ...
2025-03-01 00:42:11,358 - {'epoch': 31, 'rec_loss': '7.5795'}
2025-03-01 00:42:28,700 - {'Epoch': 31, 'HR@5': '0.0518', 'NDCG@5': '0.0356', 'HR@10': '0.0754', 'NDCG@10': '0.0433', 'HR@20': '0.1050', 'NDCG@20': '0.0507'}
2025-03-01 00:42:28,701 - EarlyStopping counter: 1 out of 10
2025-03-01 00:43:20,730 - {'epoch': 32, 'rec_loss': '7.5726'}
2025-03-01 00:43:38,073 - {'Epoch': 32, 'HR@5': '0.0527', 'NDCG@5': '0.0359', 'HR@10': '0.0755', 'NDCG@10': '0.0432', 'HR@20': '0.1059', 'NDCG@20': '0.0509'}
2025-03-01 00:43:38,074 - EarlyStopping counter: 2 out of 10
2025-03-01 00:44:29,842 - {'epoch': 33, 'rec_loss': '7.5629'}
2025-03-01 00:44:49,148 - {'Epoch': 33, 'HR@5': '0.0516', 'NDCG@5': '0.0355', 'HR@10': '0.0745', 'NDCG@10': '0.0429', 'HR@20': '0.1052', 'NDCG@20': '0.0506'}
2025-03-01 00:44:49,150 - EarlyStopping counter: 3 out of 10
2025-03-01 00:45:40,363 - {'epoch': 34, 'rec_loss': '7.5561'}
2025-03-01 00:45:57,646 - {'Epoch': 34, 'HR@5': '0.0523', 'NDCG@5': '0.0359', 'HR@10': '0.0750', 'NDCG@10': '0.0432', 'HR@20': '0.1048', 'NDCG@20': '0.0506'}
2025-03-01 00:45:57,647 - EarlyStopping counter: 4 out of 10
2025-03-01 00:46:48,638 - {'epoch': 35, 'rec_loss': '7.5455'}
2025-03-01 00:47:06,929 - {'Epoch': 35, 'HR@5': '0.0528', 'NDCG@5': '0.0363', 'HR@10': '0.0764', 'NDCG@10': '0.0439', 'HR@20': '0.1064', 'NDCG@20': '0.0515'}
2025-03-01 00:47:06,931 - EarlyStopping counter: 5 out of 10
2025-03-01 00:47:58,844 - {'epoch': 36, 'rec_loss': '7.5465'}
2025-03-01 00:48:18,258 - {'Epoch': 36, 'HR@5': '0.0521', 'NDCG@5': '0.0364', 'HR@10': '0.0750', 'NDCG@10': '0.0438', 'HR@20': '0.1048', 'NDCG@20': '0.0512'}
2025-03-01 00:48:18,259 - EarlyStopping counter: 6 out of 10
2025-03-01 00:49:09,819 - {'epoch': 37, 'rec_loss': '7.5316'}
2025-03-01 00:49:27,044 - {'Epoch': 37, 'HR@5': '0.0527', 'NDCG@5': '0.0364', 'HR@10': '0.0760', 'NDCG@10': '0.0440', 'HR@20': '0.1064', 'NDCG@20': '0.0516'}
2025-03-01 00:49:27,045 - EarlyStopping counter: 7 out of 10
2025-03-01 00:50:18,226 - {'epoch': 38, 'rec_loss': '7.5265'}
2025-03-01 00:50:36,984 - {'Epoch': 38, 'HR@5': '0.0524', 'NDCG@5': '0.0361', 'HR@10': '0.0746', 'NDCG@10': '0.0432', 'HR@20': '0.1047', 'NDCG@20': '0.0508'}
2025-03-01 00:50:36,985 - EarlyStopping counter: 8 out of 10
2025-03-01 00:51:28,091 - {'epoch': 39, 'rec_loss': '7.5214'}
2025-03-01 00:51:47,264 - {'Epoch': 39, 'HR@5': '0.0519', 'NDCG@5': '0.0359', 'HR@10': '0.0753', 'NDCG@10': '0.0435', 'HR@20': '0.1057', 'NDCG@20': '0.0511'}
2025-03-01 00:51:47,266 - EarlyStopping counter: 9 out of 10
2025-03-01 00:52:38,597 - {'epoch': 40, 'rec_loss': '7.5150'}
2025-03-01 00:52:57,849 - {'Epoch': 40, 'HR@5': '0.0521', 'NDCG@5': '0.0363', 'HR@10': '0.0742', 'NDCG@10': '0.0434', 'HR@20': '0.1060', 'NDCG@20': '0.0514'}
2025-03-01 00:52:57,850 - EarlyStopping counter: 10 out of 10
2025-03-01 00:52:57,850 - Early stopping
2025-03-01 00:52:57,850 - ---------------Test Score---------------
2025-03-01 00:53:18,165 - {'Epoch': 0, 'HR@5': '0.0428', 'NDCG@5': '0.0296', 'HR@10': '0.0618', 'NDCG@10': '0.0357', 'HR@20': '0.0864', 'NDCG@20': '0.0419'}
2025-03-01 00:53:18,170 - Scale_Sports
2025-03-01 00:53:18,170 - {'Epoch': 0, 'HR@5': '0.0428', 'NDCG@5': '0.0296', 'HR@10': '0.0618', 'NDCG@10': '0.0357', 'HR@20': '0.0864', 'NDCG@20': '0.0419'}
2025-03-01 01:38:26,115 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25, 10, 5], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-01 01:38:29,005 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-01 01:38:29,009 - Total Parameters: 1328529
2025-03-01 01:39:35,243 - {'epoch': 0, 'rec_loss': '9.4219'}
2025-03-01 01:39:54,924 - {'Epoch': 0, 'HR@5': '0.0081', 'NDCG@5': '0.0054', 'HR@10': '0.0127', 'NDCG@10': '0.0069', 'HR@20': '0.0223', 'NDCG@20': '0.0093'}
2025-03-01 01:39:54,929 - Validation score increased.  Saving model ...
2025-03-01 01:40:58,385 - {'epoch': 1, 'rec_loss': '9.1640'}
2025-03-01 01:41:19,003 - {'Epoch': 1, 'HR@5': '0.0170', 'NDCG@5': '0.0110', 'HR@10': '0.0277', 'NDCG@10': '0.0145', 'HR@20': '0.0434', 'NDCG@20': '0.0184'}
2025-03-01 01:41:19,008 - Validation score increased.  Saving model ...
2025-03-01 01:42:22,951 - {'epoch': 2, 'rec_loss': '8.8141'}
2025-03-01 01:42:43,602 - {'Epoch': 2, 'HR@5': '0.0255', 'NDCG@5': '0.0164', 'HR@10': '0.0404', 'NDCG@10': '0.0211', 'HR@20': '0.0613', 'NDCG@20': '0.0263'}
2025-03-01 01:42:43,606 - Validation score increased.  Saving model ...
2025-03-01 01:43:48,457 - {'epoch': 3, 'rec_loss': '8.5676'}
2025-03-01 01:44:06,170 - {'Epoch': 3, 'HR@5': '0.0340', 'NDCG@5': '0.0228', 'HR@10': '0.0500', 'NDCG@10': '0.0280', 'HR@20': '0.0736', 'NDCG@20': '0.0339'}
2025-03-01 01:44:06,175 - Validation score increased.  Saving model ...
2025-03-01 01:45:10,343 - {'epoch': 4, 'rec_loss': '8.3806'}
2025-03-01 01:45:31,577 - {'Epoch': 4, 'HR@5': '0.0400', 'NDCG@5': '0.0275', 'HR@10': '0.0581', 'NDCG@10': '0.0333', 'HR@20': '0.0836', 'NDCG@20': '0.0397'}
2025-03-01 01:45:31,586 - Validation score increased.  Saving model ...
2025-03-01 01:46:35,479 - {'epoch': 5, 'rec_loss': '8.2430'}
2025-03-01 01:46:56,076 - {'Epoch': 5, 'HR@5': '0.0432', 'NDCG@5': '0.0296', 'HR@10': '0.0624', 'NDCG@10': '0.0358', 'HR@20': '0.0882', 'NDCG@20': '0.0423'}
2025-03-01 01:46:56,083 - Validation score increased.  Saving model ...
2025-03-01 01:48:01,336 - {'epoch': 6, 'rec_loss': '8.1321'}
2025-03-01 01:48:19,362 - {'Epoch': 6, 'HR@5': '0.0441', 'NDCG@5': '0.0305', 'HR@10': '0.0628', 'NDCG@10': '0.0365', 'HR@20': '0.0905', 'NDCG@20': '0.0435'}
2025-03-01 01:48:19,367 - Validation score increased.  Saving model ...
2025-03-01 01:49:23,275 - {'epoch': 7, 'rec_loss': '8.0504'}
2025-03-01 01:49:44,297 - {'Epoch': 7, 'HR@5': '0.0463', 'NDCG@5': '0.0325', 'HR@10': '0.0660', 'NDCG@10': '0.0388', 'HR@20': '0.0929', 'NDCG@20': '0.0456'}
2025-03-01 01:49:44,303 - Validation score increased.  Saving model ...
2025-03-01 01:50:48,319 - {'epoch': 8, 'rec_loss': '7.9845'}
2025-03-01 01:51:08,208 - {'Epoch': 8, 'HR@5': '0.0457', 'NDCG@5': '0.0317', 'HR@10': '0.0674', 'NDCG@10': '0.0387', 'HR@20': '0.0957', 'NDCG@20': '0.0459'}
2025-03-01 01:51:08,210 - Validation score increased.  Saving model ...
2025-03-01 01:52:13,237 - {'epoch': 9, 'rec_loss': '7.9303'}
2025-03-01 01:52:33,957 - {'Epoch': 9, 'HR@5': '0.0469', 'NDCG@5': '0.0331', 'HR@10': '0.0690', 'NDCG@10': '0.0402', 'HR@20': '0.0968', 'NDCG@20': '0.0472'}
2025-03-01 01:52:33,960 - Validation score increased.  Saving model ...
2025-03-01 01:53:37,362 - {'epoch': 10, 'rec_loss': '7.8794'}
2025-03-01 01:53:58,310 - {'Epoch': 10, 'HR@5': '0.0487', 'NDCG@5': '0.0341', 'HR@10': '0.0697', 'NDCG@10': '0.0409', 'HR@20': '0.0991', 'NDCG@20': '0.0482'}
2025-03-01 01:53:58,318 - Validation score increased.  Saving model ...
2025-03-01 01:55:02,636 - {'epoch': 11, 'rec_loss': '7.8413'}
2025-03-01 01:55:20,582 - {'Epoch': 11, 'HR@5': '0.0485', 'NDCG@5': '0.0339', 'HR@10': '0.0707', 'NDCG@10': '0.0410', 'HR@20': '0.0991', 'NDCG@20': '0.0482'}
2025-03-01 01:55:20,587 - EarlyStopping counter: 1 out of 10
2025-03-01 01:56:24,681 - {'epoch': 12, 'rec_loss': '7.8101'}
2025-03-01 01:56:45,767 - {'Epoch': 12, 'HR@5': '0.0484', 'NDCG@5': '0.0338', 'HR@10': '0.0695', 'NDCG@10': '0.0406', 'HR@20': '0.0985', 'NDCG@20': '0.0479'}
2025-03-01 01:56:45,770 - EarlyStopping counter: 2 out of 10
2025-03-01 01:57:49,203 - {'epoch': 13, 'rec_loss': '7.7829'}
2025-03-01 01:58:07,366 - {'Epoch': 13, 'HR@5': '0.0498', 'NDCG@5': '0.0346', 'HR@10': '0.0712', 'NDCG@10': '0.0415', 'HR@20': '0.0998', 'NDCG@20': '0.0487'}
2025-03-01 01:58:07,376 - Validation score increased.  Saving model ...
2025-03-01 01:59:11,308 - {'epoch': 14, 'rec_loss': '7.7508'}
2025-03-01 01:59:33,249 - {'Epoch': 14, 'HR@5': '0.0497', 'NDCG@5': '0.0345', 'HR@10': '0.0712', 'NDCG@10': '0.0414', 'HR@20': '0.0991', 'NDCG@20': '0.0484'}
2025-03-01 01:59:33,253 - EarlyStopping counter: 1 out of 10
2025-03-01 02:00:37,217 - {'epoch': 15, 'rec_loss': '7.7303'}
2025-03-01 02:00:58,360 - {'Epoch': 15, 'HR@5': '0.0504', 'NDCG@5': '0.0351', 'HR@10': '0.0724', 'NDCG@10': '0.0422', 'HR@20': '0.1014', 'NDCG@20': '0.0495'}
2025-03-01 02:00:58,367 - Validation score increased.  Saving model ...
2025-03-01 02:02:02,489 - {'epoch': 16, 'rec_loss': '7.7106'}
2025-03-01 02:02:23,039 - {'Epoch': 16, 'HR@5': '0.0503', 'NDCG@5': '0.0356', 'HR@10': '0.0719', 'NDCG@10': '0.0426', 'HR@20': '0.1008', 'NDCG@20': '0.0498'}
2025-03-01 02:02:23,042 - Validation score increased.  Saving model ...
2025-03-01 02:03:27,985 - {'epoch': 17, 'rec_loss': '7.6868'}
2025-03-01 02:03:46,164 - {'Epoch': 17, 'HR@5': '0.0509', 'NDCG@5': '0.0354', 'HR@10': '0.0719', 'NDCG@10': '0.0421', 'HR@20': '0.1001', 'NDCG@20': '0.0492'}
2025-03-01 02:03:46,173 - EarlyStopping counter: 1 out of 10
2025-03-01 02:04:50,721 - {'epoch': 18, 'rec_loss': '7.6657'}
2025-03-01 02:05:08,791 - {'Epoch': 18, 'HR@5': '0.0502', 'NDCG@5': '0.0352', 'HR@10': '0.0725', 'NDCG@10': '0.0424', 'HR@20': '0.1012', 'NDCG@20': '0.0497'}
2025-03-01 02:05:08,794 - EarlyStopping counter: 2 out of 10
2025-03-01 02:06:14,036 - {'epoch': 19, 'rec_loss': '7.6436'}
2025-03-01 02:06:35,098 - {'Epoch': 19, 'HR@5': '0.0502', 'NDCG@5': '0.0357', 'HR@10': '0.0720', 'NDCG@10': '0.0427', 'HR@20': '0.1012', 'NDCG@20': '0.0500'}
2025-03-01 02:06:35,102 - Validation score increased.  Saving model ...
2025-03-01 02:07:40,974 - {'epoch': 20, 'rec_loss': '7.6377'}
2025-03-01 02:07:59,027 - {'Epoch': 20, 'HR@5': '0.0506', 'NDCG@5': '0.0358', 'HR@10': '0.0726', 'NDCG@10': '0.0429', 'HR@20': '0.1011', 'NDCG@20': '0.0500'}
2025-03-01 02:07:59,032 - EarlyStopping counter: 1 out of 10
2025-03-01 02:09:03,817 - {'epoch': 21, 'rec_loss': '7.6166'}
2025-03-01 02:09:24,698 - {'Epoch': 21, 'HR@5': '0.0505', 'NDCG@5': '0.0354', 'HR@10': '0.0725', 'NDCG@10': '0.0425', 'HR@20': '0.1014', 'NDCG@20': '0.0497'}
2025-03-01 02:09:24,704 - EarlyStopping counter: 2 out of 10
2025-03-01 02:10:28,976 - {'epoch': 22, 'rec_loss': '7.6056'}
2025-03-01 02:10:49,622 - {'Epoch': 22, 'HR@5': '0.0513', 'NDCG@5': '0.0355', 'HR@10': '0.0726', 'NDCG@10': '0.0424', 'HR@20': '0.1023', 'NDCG@20': '0.0498'}
2025-03-01 02:10:49,624 - EarlyStopping counter: 3 out of 10
2025-03-01 02:11:53,897 - {'epoch': 23, 'rec_loss': '7.5874'}
2025-03-01 02:12:12,516 - {'Epoch': 23, 'HR@5': '0.0506', 'NDCG@5': '0.0356', 'HR@10': '0.0730', 'NDCG@10': '0.0428', 'HR@20': '0.1016', 'NDCG@20': '0.0500'}
2025-03-01 02:12:12,519 - EarlyStopping counter: 4 out of 10
2025-03-01 02:13:16,514 - {'epoch': 24, 'rec_loss': '7.5772'}
2025-03-01 02:13:34,617 - {'Epoch': 24, 'HR@5': '0.0504', 'NDCG@5': '0.0350', 'HR@10': '0.0720', 'NDCG@10': '0.0420', 'HR@20': '0.1024', 'NDCG@20': '0.0497'}
2025-03-01 02:13:34,619 - EarlyStopping counter: 5 out of 10
2025-03-01 02:14:36,617 - {'epoch': 25, 'rec_loss': '7.5586'}
2025-03-01 02:14:57,865 - {'Epoch': 25, 'HR@5': '0.0510', 'NDCG@5': '0.0354', 'HR@10': '0.0715', 'NDCG@10': '0.0420', 'HR@20': '0.1003', 'NDCG@20': '0.0493'}
2025-03-01 02:14:57,872 - EarlyStopping counter: 6 out of 10
2025-03-01 02:16:02,165 - {'epoch': 26, 'rec_loss': '7.5461'}
2025-03-01 02:16:23,764 - {'Epoch': 26, 'HR@5': '0.0514', 'NDCG@5': '0.0357', 'HR@10': '0.0726', 'NDCG@10': '0.0425', 'HR@20': '0.1021', 'NDCG@20': '0.0499'}
2025-03-01 02:16:23,768 - EarlyStopping counter: 7 out of 10
2025-03-01 02:17:28,655 - {'epoch': 27, 'rec_loss': '7.5361'}
2025-03-01 02:17:49,633 - {'Epoch': 27, 'HR@5': '0.0517', 'NDCG@5': '0.0356', 'HR@10': '0.0724', 'NDCG@10': '0.0423', 'HR@20': '0.1012', 'NDCG@20': '0.0495'}
2025-03-01 02:17:49,638 - EarlyStopping counter: 8 out of 10
2025-03-01 02:18:53,527 - {'epoch': 28, 'rec_loss': '7.5239'}
2025-03-01 02:19:14,421 - {'Epoch': 28, 'HR@5': '0.0513', 'NDCG@5': '0.0357', 'HR@10': '0.0726', 'NDCG@10': '0.0426', 'HR@20': '0.1017', 'NDCG@20': '0.0499'}
2025-03-01 02:19:14,425 - EarlyStopping counter: 9 out of 10
2025-03-01 02:20:18,266 - {'epoch': 29, 'rec_loss': '7.5167'}
2025-03-01 02:20:37,730 - {'Epoch': 29, 'HR@5': '0.0515', 'NDCG@5': '0.0359', 'HR@10': '0.0726', 'NDCG@10': '0.0427', 'HR@20': '0.1026', 'NDCG@20': '0.0502'}
2025-03-01 02:20:37,735 - Validation score increased.  Saving model ...
2025-03-01 02:21:41,829 - {'epoch': 30, 'rec_loss': '7.5005'}
2025-03-01 02:22:02,757 - {'Epoch': 30, 'HR@5': '0.0518', 'NDCG@5': '0.0359', 'HR@10': '0.0726', 'NDCG@10': '0.0426', 'HR@20': '0.1023', 'NDCG@20': '0.0501'}
2025-03-01 02:22:02,758 - EarlyStopping counter: 1 out of 10
2025-03-01 02:23:06,393 - {'epoch': 31, 'rec_loss': '7.4953'}
2025-03-01 02:23:27,565 - {'Epoch': 31, 'HR@5': '0.0511', 'NDCG@5': '0.0357', 'HR@10': '0.0727', 'NDCG@10': '0.0427', 'HR@20': '0.1024', 'NDCG@20': '0.0501'}
2025-03-01 02:23:27,567 - EarlyStopping counter: 2 out of 10
2025-03-01 02:24:31,729 - {'epoch': 32, 'rec_loss': '7.4785'}
2025-03-01 02:24:53,422 - {'Epoch': 32, 'HR@5': '0.0510', 'NDCG@5': '0.0352', 'HR@10': '0.0731', 'NDCG@10': '0.0423', 'HR@20': '0.1020', 'NDCG@20': '0.0496'}
2025-03-01 02:24:53,424 - EarlyStopping counter: 3 out of 10
2025-03-01 02:25:57,343 - {'epoch': 33, 'rec_loss': '7.4815'}
2025-03-01 02:26:18,190 - {'Epoch': 33, 'HR@5': '0.0519', 'NDCG@5': '0.0367', 'HR@10': '0.0734', 'NDCG@10': '0.0436', 'HR@20': '0.1024', 'NDCG@20': '0.0509'}
2025-03-01 02:26:18,194 - Validation score increased.  Saving model ...
2025-03-01 02:27:22,271 - {'epoch': 34, 'rec_loss': '7.4670'}
2025-03-01 02:27:43,474 - {'Epoch': 34, 'HR@5': '0.0512', 'NDCG@5': '0.0357', 'HR@10': '0.0729', 'NDCG@10': '0.0426', 'HR@20': '0.1031', 'NDCG@20': '0.0502'}
2025-03-01 02:27:43,481 - EarlyStopping counter: 1 out of 10
2025-03-01 02:28:47,616 - {'epoch': 35, 'rec_loss': '7.4601'}
2025-03-01 02:29:08,338 - {'Epoch': 35, 'HR@5': '0.0523', 'NDCG@5': '0.0365', 'HR@10': '0.0740', 'NDCG@10': '0.0434', 'HR@20': '0.1036', 'NDCG@20': '0.0509'}
2025-03-01 02:29:08,343 - EarlyStopping counter: 2 out of 10
2025-03-01 02:30:12,285 - {'epoch': 36, 'rec_loss': '7.4483'}
2025-03-01 02:30:30,596 - {'Epoch': 36, 'HR@5': '0.0499', 'NDCG@5': '0.0347', 'HR@10': '0.0727', 'NDCG@10': '0.0420', 'HR@20': '0.1018', 'NDCG@20': '0.0494'}
2025-03-01 02:30:30,598 - EarlyStopping counter: 3 out of 10
2025-03-01 02:31:33,287 - {'epoch': 37, 'rec_loss': '7.4455'}
2025-03-01 02:31:54,245 - {'Epoch': 37, 'HR@5': '0.0510', 'NDCG@5': '0.0352', 'HR@10': '0.0734', 'NDCG@10': '0.0424', 'HR@20': '0.1034', 'NDCG@20': '0.0499'}
2025-03-01 02:31:54,252 - EarlyStopping counter: 4 out of 10
2025-03-01 02:32:58,360 - {'epoch': 38, 'rec_loss': '7.4372'}
2025-03-01 02:33:17,150 - {'Epoch': 38, 'HR@5': '0.0500', 'NDCG@5': '0.0346', 'HR@10': '0.0727', 'NDCG@10': '0.0419', 'HR@20': '0.1019', 'NDCG@20': '0.0493'}
2025-03-01 02:33:17,155 - EarlyStopping counter: 5 out of 10
2025-03-01 02:34:21,031 - {'epoch': 39, 'rec_loss': '7.4265'}
2025-03-01 02:34:40,925 - {'Epoch': 39, 'HR@5': '0.0511', 'NDCG@5': '0.0357', 'HR@10': '0.0739', 'NDCG@10': '0.0430', 'HR@20': '0.1028', 'NDCG@20': '0.0502'}
2025-03-01 02:34:40,927 - EarlyStopping counter: 6 out of 10
2025-03-01 02:35:45,989 - {'epoch': 40, 'rec_loss': '7.4242'}
2025-03-01 02:36:04,546 - {'Epoch': 40, 'HR@5': '0.0507', 'NDCG@5': '0.0351', 'HR@10': '0.0731', 'NDCG@10': '0.0423', 'HR@20': '0.1024', 'NDCG@20': '0.0497'}
2025-03-01 02:36:04,547 - EarlyStopping counter: 7 out of 10
2025-03-01 02:37:08,450 - {'epoch': 41, 'rec_loss': '7.4143'}
2025-03-01 02:37:27,116 - {'Epoch': 41, 'HR@5': '0.0505', 'NDCG@5': '0.0351', 'HR@10': '0.0719', 'NDCG@10': '0.0420', 'HR@20': '0.1026', 'NDCG@20': '0.0497'}
2025-03-01 02:37:27,121 - EarlyStopping counter: 8 out of 10
2025-03-01 02:38:31,065 - {'epoch': 42, 'rec_loss': '7.4074'}
2025-03-01 02:38:51,226 - {'Epoch': 42, 'HR@5': '0.0509', 'NDCG@5': '0.0354', 'HR@10': '0.0736', 'NDCG@10': '0.0427', 'HR@20': '0.1029', 'NDCG@20': '0.0501'}
2025-03-01 02:38:51,228 - EarlyStopping counter: 9 out of 10
2025-03-01 02:39:55,304 - {'epoch': 43, 'rec_loss': '7.4035'}
2025-03-01 02:40:13,361 - {'Epoch': 43, 'HR@5': '0.0503', 'NDCG@5': '0.0353', 'HR@10': '0.0721', 'NDCG@10': '0.0422', 'HR@20': '0.1017', 'NDCG@20': '0.0497'}
2025-03-01 02:40:13,363 - EarlyStopping counter: 10 out of 10
2025-03-01 02:40:13,363 - Early stopping
2025-03-01 02:40:13,363 - ---------------Test Score---------------
2025-03-01 02:40:31,188 - {'Epoch': 0, 'HR@5': '0.0427', 'NDCG@5': '0.0298', 'HR@10': '0.0610', 'NDCG@10': '0.0356', 'HR@20': '0.0856', 'NDCG@20': '0.0418'}
2025-03-01 02:40:31,189 - Scale_Sports
2025-03-01 02:40:31,190 - {'Epoch': 0, 'HR@5': '0.0427', 'NDCG@5': '0.0298', 'HR@10': '0.0610', 'NDCG@10': '0.0356', 'HR@20': '0.0856', 'NDCG@20': '0.0418'}
2025-03-01 10:38:51,561 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-01 10:38:54,550 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=50, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-01 10:38:54,555 - Total Parameters: 1331454
2025-03-01 10:39:23,612 - {'epoch': 0, 'rec_loss': '9.4042'}
2025-03-01 10:39:42,403 - {'Epoch': 0, 'HR@5': '0.0081', 'NDCG@5': '0.0054', 'HR@10': '0.0126', 'NDCG@10': '0.0068', 'HR@20': '0.0227', 'NDCG@20': '0.0094'}
2025-03-01 10:39:42,408 - Validation score increased.  Saving model ...
2025-03-01 10:40:11,457 - {'epoch': 1, 'rec_loss': '9.2780'}
2025-03-01 10:40:27,020 - {'Epoch': 1, 'HR@5': '0.0087', 'NDCG@5': '0.0056', 'HR@10': '0.0154', 'NDCG@10': '0.0077', 'HR@20': '0.0267', 'NDCG@20': '0.0105'}
2025-03-01 10:40:27,021 - Validation score increased.  Saving model ...
2025-03-01 10:40:52,307 - {'epoch': 2, 'rec_loss': '9.1621'}
2025-03-01 10:41:06,704 - {'Epoch': 2, 'HR@5': '0.0117', 'NDCG@5': '0.0077', 'HR@10': '0.0215', 'NDCG@10': '0.0108', 'HR@20': '0.0362', 'NDCG@20': '0.0145'}
2025-03-01 10:41:06,705 - Validation score increased.  Saving model ...
2025-03-01 10:41:32,540 - {'epoch': 3, 'rec_loss': '9.0050'}
2025-03-01 10:41:47,148 - {'Epoch': 3, 'HR@5': '0.0180', 'NDCG@5': '0.0115', 'HR@10': '0.0287', 'NDCG@10': '0.0149', 'HR@20': '0.0453', 'NDCG@20': '0.0190'}
2025-03-01 10:41:47,149 - Validation score increased.  Saving model ...
2025-03-01 10:42:12,886 - {'epoch': 4, 'rec_loss': '8.8904'}
2025-03-01 10:42:27,766 - {'Epoch': 4, 'HR@5': '0.0197', 'NDCG@5': '0.0128', 'HR@10': '0.0312', 'NDCG@10': '0.0165', 'HR@20': '0.0499', 'NDCG@20': '0.0213'}
2025-03-01 10:42:27,767 - Validation score increased.  Saving model ...
2025-03-01 10:42:56,084 - {'epoch': 5, 'rec_loss': '8.8038'}
2025-03-01 10:43:10,947 - {'Epoch': 5, 'HR@5': '0.0205', 'NDCG@5': '0.0136', 'HR@10': '0.0340', 'NDCG@10': '0.0179', 'HR@20': '0.0531', 'NDCG@20': '0.0227'}
2025-03-01 10:43:10,948 - Validation score increased.  Saving model ...
2025-03-01 10:43:36,662 - {'epoch': 6, 'rec_loss': '8.7262'}
2025-03-01 10:43:51,802 - {'Epoch': 6, 'HR@5': '0.0240', 'NDCG@5': '0.0155', 'HR@10': '0.0389', 'NDCG@10': '0.0203', 'HR@20': '0.0601', 'NDCG@20': '0.0256'}
2025-03-01 10:43:51,803 - Validation score increased.  Saving model ...
2025-03-01 10:44:18,674 - {'epoch': 7, 'rec_loss': '8.6568'}
2025-03-01 10:44:34,869 - {'Epoch': 7, 'HR@5': '0.0266', 'NDCG@5': '0.0174', 'HR@10': '0.0425', 'NDCG@10': '0.0225', 'HR@20': '0.0654', 'NDCG@20': '0.0283'}
2025-03-01 10:44:34,870 - Validation score increased.  Saving model ...
2025-03-01 10:45:00,845 - {'epoch': 8, 'rec_loss': '8.5906'}
2025-03-01 10:45:17,559 - {'Epoch': 8, 'HR@5': '0.0309', 'NDCG@5': '0.0199', 'HR@10': '0.0468', 'NDCG@10': '0.0251', 'HR@20': '0.0711', 'NDCG@20': '0.0312'}
2025-03-01 10:45:17,560 - Validation score increased.  Saving model ...
2025-03-01 10:45:45,151 - {'epoch': 9, 'rec_loss': '8.5357'}
2025-03-01 10:46:02,231 - {'Epoch': 9, 'HR@5': '0.0329', 'NDCG@5': '0.0216', 'HR@10': '0.0499', 'NDCG@10': '0.0271', 'HR@20': '0.0742', 'NDCG@20': '0.0331'}
2025-03-01 10:46:02,232 - Validation score increased.  Saving model ...
2025-03-01 10:46:29,768 - {'epoch': 10, 'rec_loss': '8.4791'}
2025-03-01 10:46:46,051 - {'Epoch': 10, 'HR@5': '0.0351', 'NDCG@5': '0.0231', 'HR@10': '0.0526', 'NDCG@10': '0.0287', 'HR@20': '0.0776', 'NDCG@20': '0.0350'}
2025-03-01 10:46:46,052 - Validation score increased.  Saving model ...
2025-03-01 10:47:14,063 - {'epoch': 11, 'rec_loss': '8.4392'}
2025-03-01 10:47:31,813 - {'Epoch': 11, 'HR@5': '0.0357', 'NDCG@5': '0.0237', 'HR@10': '0.0553', 'NDCG@10': '0.0301', 'HR@20': '0.0802', 'NDCG@20': '0.0363'}
2025-03-01 10:47:31,814 - Validation score increased.  Saving model ...
2025-03-01 10:47:57,437 - {'epoch': 12, 'rec_loss': '8.3990'}
2025-03-01 10:48:13,099 - {'Epoch': 12, 'HR@5': '0.0380', 'NDCG@5': '0.0255', 'HR@10': '0.0575', 'NDCG@10': '0.0318', 'HR@20': '0.0821', 'NDCG@20': '0.0380'}
2025-03-01 10:48:13,101 - Validation score increased.  Saving model ...
2025-03-01 10:48:39,987 - {'epoch': 13, 'rec_loss': '8.3635'}
2025-03-01 10:48:57,154 - {'Epoch': 13, 'HR@5': '0.0390', 'NDCG@5': '0.0263', 'HR@10': '0.0588', 'NDCG@10': '0.0326', 'HR@20': '0.0847', 'NDCG@20': '0.0391'}
2025-03-01 10:48:57,155 - Validation score increased.  Saving model ...
2025-03-01 10:49:31,444 - {'epoch': 14, 'rec_loss': '8.3309'}
2025-03-01 10:49:46,503 - {'Epoch': 14, 'HR@5': '0.0414', 'NDCG@5': '0.0278', 'HR@10': '0.0597', 'NDCG@10': '0.0337', 'HR@20': '0.0872', 'NDCG@20': '0.0406'}
2025-03-01 10:49:46,504 - Validation score increased.  Saving model ...
2025-03-01 10:50:12,333 - {'epoch': 15, 'rec_loss': '8.3067'}
2025-03-01 10:50:27,721 - {'Epoch': 15, 'HR@5': '0.0407', 'NDCG@5': '0.0279', 'HR@10': '0.0609', 'NDCG@10': '0.0344', 'HR@20': '0.0886', 'NDCG@20': '0.0413'}
2025-03-01 10:50:27,722 - Validation score increased.  Saving model ...
2025-03-01 10:50:52,816 - {'epoch': 16, 'rec_loss': '8.2779'}
2025-03-01 10:51:08,654 - {'Epoch': 16, 'HR@5': '0.0421', 'NDCG@5': '0.0283', 'HR@10': '0.0621', 'NDCG@10': '0.0348', 'HR@20': '0.0909', 'NDCG@20': '0.0420'}
2025-03-01 10:51:08,655 - Validation score increased.  Saving model ...
2025-03-01 10:51:35,406 - {'epoch': 17, 'rec_loss': '8.2548'}
2025-03-01 10:51:51,747 - {'Epoch': 17, 'HR@5': '0.0436', 'NDCG@5': '0.0299', 'HR@10': '0.0638', 'NDCG@10': '0.0364', 'HR@20': '0.0920', 'NDCG@20': '0.0435'}
2025-03-01 10:51:51,748 - Validation score increased.  Saving model ...
2025-03-01 10:52:17,663 - {'epoch': 18, 'rec_loss': '8.2320'}
2025-03-01 10:52:34,283 - {'Epoch': 18, 'HR@5': '0.0450', 'NDCG@5': '0.0305', 'HR@10': '0.0646', 'NDCG@10': '0.0368', 'HR@20': '0.0930', 'NDCG@20': '0.0440'}
2025-03-01 10:52:34,284 - Validation score increased.  Saving model ...
2025-03-01 10:53:01,048 - {'epoch': 19, 'rec_loss': '8.2114'}
2025-03-01 10:53:17,333 - {'Epoch': 19, 'HR@5': '0.0450', 'NDCG@5': '0.0306', 'HR@10': '0.0650', 'NDCG@10': '0.0370', 'HR@20': '0.0944', 'NDCG@20': '0.0444'}
2025-03-01 10:53:17,334 - Validation score increased.  Saving model ...
2025-03-01 10:53:43,516 - {'epoch': 20, 'rec_loss': '8.1922'}
2025-03-01 10:53:59,815 - {'Epoch': 20, 'HR@5': '0.0453', 'NDCG@5': '0.0309', 'HR@10': '0.0661', 'NDCG@10': '0.0376', 'HR@20': '0.0942', 'NDCG@20': '0.0446'}
2025-03-01 10:53:59,816 - Validation score increased.  Saving model ...
2025-03-01 10:54:24,965 - {'epoch': 21, 'rec_loss': '8.1752'}
2025-03-01 10:54:41,811 - {'Epoch': 21, 'HR@5': '0.0466', 'NDCG@5': '0.0318', 'HR@10': '0.0671', 'NDCG@10': '0.0385', 'HR@20': '0.0960', 'NDCG@20': '0.0457'}
2025-03-01 10:54:41,812 - Validation score increased.  Saving model ...
2025-03-01 10:55:10,247 - {'epoch': 22, 'rec_loss': '8.1583'}
2025-03-01 10:55:27,108 - {'Epoch': 22, 'HR@5': '0.0471', 'NDCG@5': '0.0322', 'HR@10': '0.0668', 'NDCG@10': '0.0386', 'HR@20': '0.0958', 'NDCG@20': '0.0459'}
2025-03-01 10:55:27,109 - Validation score increased.  Saving model ...
2025-03-01 10:55:53,776 - {'epoch': 23, 'rec_loss': '8.1437'}
2025-03-01 10:56:09,500 - {'Epoch': 23, 'HR@5': '0.0472', 'NDCG@5': '0.0324', 'HR@10': '0.0686', 'NDCG@10': '0.0393', 'HR@20': '0.0975', 'NDCG@20': '0.0466'}
2025-03-01 10:56:09,501 - Validation score increased.  Saving model ...
2025-03-01 10:56:36,794 - {'epoch': 24, 'rec_loss': '8.1315'}
2025-03-01 10:56:52,255 - {'Epoch': 24, 'HR@5': '0.0474', 'NDCG@5': '0.0326', 'HR@10': '0.0689', 'NDCG@10': '0.0395', 'HR@20': '0.0984', 'NDCG@20': '0.0469'}
2025-03-01 10:56:52,256 - Validation score increased.  Saving model ...
2025-03-01 10:57:18,040 - {'epoch': 25, 'rec_loss': '8.1203'}
2025-03-01 10:57:33,542 - {'Epoch': 25, 'HR@5': '0.0483', 'NDCG@5': '0.0331', 'HR@10': '0.0698', 'NDCG@10': '0.0400', 'HR@20': '0.0987', 'NDCG@20': '0.0473'}
2025-03-01 10:57:33,542 - Validation score increased.  Saving model ...
2025-03-01 10:58:02,971 - {'epoch': 26, 'rec_loss': '8.1082'}
2025-03-01 10:58:18,628 - {'Epoch': 26, 'HR@5': '0.0478', 'NDCG@5': '0.0327', 'HR@10': '0.0691', 'NDCG@10': '0.0396', 'HR@20': '0.1006', 'NDCG@20': '0.0475'}
2025-03-01 10:58:18,629 - Validation score increased.  Saving model ...
2025-03-01 10:58:44,752 - {'epoch': 27, 'rec_loss': '8.0861'}
2025-03-01 10:59:00,444 - {'Epoch': 27, 'HR@5': '0.0486', 'NDCG@5': '0.0334', 'HR@10': '0.0708', 'NDCG@10': '0.0406', 'HR@20': '0.1006', 'NDCG@20': '0.0481'}
2025-03-01 10:59:00,445 - Validation score increased.  Saving model ...
2025-03-01 10:59:26,914 - {'epoch': 28, 'rec_loss': '8.0838'}
2025-03-01 10:59:42,432 - {'Epoch': 28, 'HR@5': '0.0491', 'NDCG@5': '0.0342', 'HR@10': '0.0701', 'NDCG@10': '0.0410', 'HR@20': '0.1011', 'NDCG@20': '0.0488'}
2025-03-01 10:59:42,433 - Validation score increased.  Saving model ...
2025-03-01 11:00:07,863 - {'epoch': 29, 'rec_loss': '8.0702'}
2025-03-01 11:00:22,916 - {'Epoch': 29, 'HR@5': '0.0495', 'NDCG@5': '0.0346', 'HR@10': '0.0715', 'NDCG@10': '0.0417', 'HR@20': '0.1009', 'NDCG@20': '0.0491'}
2025-03-01 11:00:22,917 - Validation score increased.  Saving model ...
2025-03-01 11:00:48,692 - {'epoch': 30, 'rec_loss': '8.0614'}
2025-03-01 11:01:04,099 - {'Epoch': 30, 'HR@5': '0.0497', 'NDCG@5': '0.0341', 'HR@10': '0.0716', 'NDCG@10': '0.0411', 'HR@20': '0.1024', 'NDCG@20': '0.0488'}
2025-03-01 11:01:04,100 - EarlyStopping counter: 1 out of 10
2025-03-01 11:01:29,717 - {'epoch': 31, 'rec_loss': '8.0516'}
2025-03-01 11:01:45,026 - {'Epoch': 31, 'HR@5': '0.0504', 'NDCG@5': '0.0345', 'HR@10': '0.0720', 'NDCG@10': '0.0415', 'HR@20': '0.1019', 'NDCG@20': '0.0490'}
2025-03-01 11:01:45,029 - EarlyStopping counter: 2 out of 10
2025-03-01 11:02:10,947 - {'epoch': 32, 'rec_loss': '8.0406'}
2025-03-01 11:02:28,188 - {'Epoch': 32, 'HR@5': '0.0491', 'NDCG@5': '0.0337', 'HR@10': '0.0725', 'NDCG@10': '0.0412', 'HR@20': '0.1031', 'NDCG@20': '0.0489'}
2025-03-01 11:02:28,189 - EarlyStopping counter: 3 out of 10
2025-03-01 11:02:55,378 - {'epoch': 33, 'rec_loss': '8.0330'}
2025-03-01 11:03:12,950 - {'Epoch': 33, 'HR@5': '0.0506', 'NDCG@5': '0.0354', 'HR@10': '0.0728', 'NDCG@10': '0.0425', 'HR@20': '0.1026', 'NDCG@20': '0.0501'}
2025-03-01 11:03:12,951 - Validation score increased.  Saving model ...
2025-03-01 11:03:39,359 - {'epoch': 34, 'rec_loss': '8.0256'}
2025-03-01 11:03:54,874 - {'Epoch': 34, 'HR@5': '0.0498', 'NDCG@5': '0.0345', 'HR@10': '0.0721', 'NDCG@10': '0.0417', 'HR@20': '0.1033', 'NDCG@20': '0.0495'}
2025-03-01 11:03:54,875 - EarlyStopping counter: 1 out of 10
2025-03-01 11:04:21,015 - {'epoch': 35, 'rec_loss': '8.0222'}
2025-03-01 11:04:38,266 - {'Epoch': 35, 'HR@5': '0.0506', 'NDCG@5': '0.0351', 'HR@10': '0.0732', 'NDCG@10': '0.0424', 'HR@20': '0.1046', 'NDCG@20': '0.0503'}
2025-03-01 11:04:38,267 - Validation score increased.  Saving model ...
2025-03-01 11:05:04,163 - {'epoch': 36, 'rec_loss': '8.0157'}
2025-03-01 11:05:20,799 - {'Epoch': 36, 'HR@5': '0.0503', 'NDCG@5': '0.0352', 'HR@10': '0.0724', 'NDCG@10': '0.0423', 'HR@20': '0.1037', 'NDCG@20': '0.0502'}
2025-03-01 11:05:20,800 - EarlyStopping counter: 1 out of 10
2025-03-01 11:05:45,794 - {'epoch': 37, 'rec_loss': '7.9991'}
2025-03-01 11:06:01,750 - {'Epoch': 37, 'HR@5': '0.0497', 'NDCG@5': '0.0349', 'HR@10': '0.0724', 'NDCG@10': '0.0422', 'HR@20': '0.1041', 'NDCG@20': '0.0502'}
2025-03-01 11:06:01,751 - EarlyStopping counter: 2 out of 10
2025-03-01 11:06:27,822 - {'epoch': 38, 'rec_loss': '7.9958'}
2025-03-01 11:06:44,303 - {'Epoch': 38, 'HR@5': '0.0506', 'NDCG@5': '0.0354', 'HR@10': '0.0733', 'NDCG@10': '0.0427', 'HR@20': '0.1037', 'NDCG@20': '0.0503'}
2025-03-01 11:06:44,304 - Validation score increased.  Saving model ...
2025-03-01 11:07:12,955 - {'epoch': 39, 'rec_loss': '7.9839'}
2025-03-01 11:07:28,731 - {'Epoch': 39, 'HR@5': '0.0516', 'NDCG@5': '0.0354', 'HR@10': '0.0739', 'NDCG@10': '0.0425', 'HR@20': '0.1048', 'NDCG@20': '0.0503'}
2025-03-01 11:07:28,733 - EarlyStopping counter: 1 out of 10
2025-03-01 11:07:55,070 - {'epoch': 40, 'rec_loss': '7.9884'}
2025-03-01 11:08:13,759 - {'Epoch': 40, 'HR@5': '0.0514', 'NDCG@5': '0.0354', 'HR@10': '0.0740', 'NDCG@10': '0.0427', 'HR@20': '0.1039', 'NDCG@20': '0.0502'}
2025-03-01 11:08:13,760 - EarlyStopping counter: 2 out of 10
2025-03-01 11:08:38,771 - {'epoch': 41, 'rec_loss': '7.9720'}
2025-03-01 11:08:56,729 - {'Epoch': 41, 'HR@5': '0.0516', 'NDCG@5': '0.0353', 'HR@10': '0.0745', 'NDCG@10': '0.0427', 'HR@20': '0.1050', 'NDCG@20': '0.0503'}
2025-03-01 11:08:56,731 - EarlyStopping counter: 3 out of 10
2025-03-01 11:09:22,324 - {'epoch': 42, 'rec_loss': '7.9729'}
2025-03-01 11:09:38,180 - {'Epoch': 42, 'HR@5': '0.0516', 'NDCG@5': '0.0355', 'HR@10': '0.0737', 'NDCG@10': '0.0425', 'HR@20': '0.1041', 'NDCG@20': '0.0502'}
2025-03-01 11:09:38,181 - EarlyStopping counter: 4 out of 10
2025-03-01 11:10:03,848 - {'epoch': 43, 'rec_loss': '7.9593'}
2025-03-01 11:10:19,393 - {'Epoch': 43, 'HR@5': '0.0511', 'NDCG@5': '0.0354', 'HR@10': '0.0736', 'NDCG@10': '0.0426', 'HR@20': '0.1042', 'NDCG@20': '0.0503'}
2025-03-01 11:10:19,394 - EarlyStopping counter: 5 out of 10
2025-03-01 11:10:44,611 - {'epoch': 44, 'rec_loss': '7.9590'}
2025-03-01 11:11:00,208 - {'Epoch': 44, 'HR@5': '0.0517', 'NDCG@5': '0.0360', 'HR@10': '0.0746', 'NDCG@10': '0.0434', 'HR@20': '0.1060', 'NDCG@20': '0.0513'}
2025-03-01 11:11:00,209 - Validation score increased.  Saving model ...
2025-03-01 11:11:24,868 - {'epoch': 45, 'rec_loss': '7.9589'}
2025-03-01 11:11:40,247 - {'Epoch': 45, 'HR@5': '0.0507', 'NDCG@5': '0.0352', 'HR@10': '0.0739', 'NDCG@10': '0.0427', 'HR@20': '0.1054', 'NDCG@20': '0.0506'}
2025-03-01 11:11:40,248 - EarlyStopping counter: 1 out of 10
2025-03-01 11:12:06,117 - {'epoch': 46, 'rec_loss': '7.9528'}
2025-03-01 11:12:21,893 - {'Epoch': 46, 'HR@5': '0.0516', 'NDCG@5': '0.0357', 'HR@10': '0.0736', 'NDCG@10': '0.0428', 'HR@20': '0.1054', 'NDCG@20': '0.0508'}
2025-03-01 11:12:21,894 - EarlyStopping counter: 2 out of 10
2025-03-01 11:12:47,189 - {'epoch': 47, 'rec_loss': '7.9459'}
2025-03-01 11:13:03,263 - {'Epoch': 47, 'HR@5': '0.0520', 'NDCG@5': '0.0360', 'HR@10': '0.0750', 'NDCG@10': '0.0434', 'HR@20': '0.1063', 'NDCG@20': '0.0513'}
2025-03-01 11:13:03,264 - Validation score increased.  Saving model ...
2025-03-01 11:13:31,434 - {'epoch': 48, 'rec_loss': '7.9403'}
2025-03-01 11:13:47,106 - {'Epoch': 48, 'HR@5': '0.0515', 'NDCG@5': '0.0361', 'HR@10': '0.0745', 'NDCG@10': '0.0435', 'HR@20': '0.1058', 'NDCG@20': '0.0514'}
2025-03-01 11:13:47,107 - Validation score increased.  Saving model ...
2025-03-01 11:14:12,902 - {'epoch': 49, 'rec_loss': '7.9394'}
2025-03-01 11:14:28,630 - {'Epoch': 49, 'HR@5': '0.0513', 'NDCG@5': '0.0358', 'HR@10': '0.0740', 'NDCG@10': '0.0431', 'HR@20': '0.1062', 'NDCG@20': '0.0512'}
2025-03-01 11:14:28,631 - EarlyStopping counter: 1 out of 10
2025-03-01 11:14:56,857 - {'epoch': 50, 'rec_loss': '7.9264'}
2025-03-01 11:15:13,056 - {'Epoch': 50, 'HR@5': '0.0522', 'NDCG@5': '0.0358', 'HR@10': '0.0756', 'NDCG@10': '0.0433', 'HR@20': '0.1061', 'NDCG@20': '0.0510'}
2025-03-01 11:15:13,057 - EarlyStopping counter: 2 out of 10
2025-03-01 11:15:40,088 - {'epoch': 51, 'rec_loss': '7.9348'}
2025-03-01 11:15:56,394 - {'Epoch': 51, 'HR@5': '0.0518', 'NDCG@5': '0.0359', 'HR@10': '0.0748', 'NDCG@10': '0.0433', 'HR@20': '0.1059', 'NDCG@20': '0.0511'}
2025-03-01 11:15:56,395 - EarlyStopping counter: 3 out of 10
2025-03-01 11:16:23,156 - {'epoch': 52, 'rec_loss': '7.9256'}
2025-03-01 11:16:40,571 - {'Epoch': 52, 'HR@5': '0.0514', 'NDCG@5': '0.0356', 'HR@10': '0.0747', 'NDCG@10': '0.0432', 'HR@20': '0.1059', 'NDCG@20': '0.0510'}
2025-03-01 11:16:40,572 - EarlyStopping counter: 4 out of 10
2025-03-01 11:17:07,459 - {'epoch': 53, 'rec_loss': '7.9209'}
2025-03-01 11:17:25,919 - {'Epoch': 53, 'HR@5': '0.0519', 'NDCG@5': '0.0357', 'HR@10': '0.0743', 'NDCG@10': '0.0429', 'HR@20': '0.1058', 'NDCG@20': '0.0508'}
2025-03-01 11:17:25,921 - EarlyStopping counter: 5 out of 10
2025-03-01 11:17:51,790 - {'epoch': 54, 'rec_loss': '7.9126'}
2025-03-01 11:18:07,857 - {'Epoch': 54, 'HR@5': '0.0511', 'NDCG@5': '0.0353', 'HR@10': '0.0757', 'NDCG@10': '0.0432', 'HR@20': '0.1064', 'NDCG@20': '0.0509'}
2025-03-01 11:18:07,858 - EarlyStopping counter: 6 out of 10
2025-03-01 11:18:34,752 - {'epoch': 55, 'rec_loss': '7.9118'}
2025-03-01 11:18:50,711 - {'Epoch': 55, 'HR@5': '0.0517', 'NDCG@5': '0.0357', 'HR@10': '0.0751', 'NDCG@10': '0.0432', 'HR@20': '0.1061', 'NDCG@20': '0.0510'}
2025-03-01 11:18:50,712 - EarlyStopping counter: 7 out of 10
2025-03-01 11:19:16,441 - {'epoch': 56, 'rec_loss': '7.9142'}
2025-03-01 11:19:32,096 - {'Epoch': 56, 'HR@5': '0.0516', 'NDCG@5': '0.0359', 'HR@10': '0.0756', 'NDCG@10': '0.0436', 'HR@20': '0.1069', 'NDCG@20': '0.0515'}
2025-03-01 11:19:32,097 - Validation score increased.  Saving model ...
2025-03-01 11:19:58,084 - {'epoch': 57, 'rec_loss': '7.9013'}
2025-03-01 11:20:13,983 - {'Epoch': 57, 'HR@5': '0.0519', 'NDCG@5': '0.0359', 'HR@10': '0.0755', 'NDCG@10': '0.0434', 'HR@20': '0.1066', 'NDCG@20': '0.0513'}
2025-03-01 11:20:13,984 - EarlyStopping counter: 1 out of 10
2025-03-01 11:20:39,667 - {'epoch': 58, 'rec_loss': '7.9045'}
2025-03-01 11:20:55,217 - {'Epoch': 58, 'HR@5': '0.0512', 'NDCG@5': '0.0356', 'HR@10': '0.0759', 'NDCG@10': '0.0436', 'HR@20': '0.1067', 'NDCG@20': '0.0513'}
2025-03-01 11:20:55,218 - EarlyStopping counter: 2 out of 10
2025-03-01 11:21:20,554 - {'epoch': 59, 'rec_loss': '7.9003'}
2025-03-01 11:21:36,312 - {'Epoch': 59, 'HR@5': '0.0520', 'NDCG@5': '0.0356', 'HR@10': '0.0757', 'NDCG@10': '0.0433', 'HR@20': '0.1066', 'NDCG@20': '0.0511'}
2025-03-01 11:21:36,313 - EarlyStopping counter: 3 out of 10
2025-03-01 11:22:02,896 - {'epoch': 60, 'rec_loss': '7.8994'}
2025-03-01 11:22:18,680 - {'Epoch': 60, 'HR@5': '0.0523', 'NDCG@5': '0.0361', 'HR@10': '0.0755', 'NDCG@10': '0.0435', 'HR@20': '0.1069', 'NDCG@20': '0.0514'}
2025-03-01 11:22:18,681 - EarlyStopping counter: 4 out of 10
2025-03-01 11:22:42,858 - {'epoch': 61, 'rec_loss': '7.8911'}
2025-03-01 11:22:58,505 - {'Epoch': 61, 'HR@5': '0.0514', 'NDCG@5': '0.0357', 'HR@10': '0.0758', 'NDCG@10': '0.0436', 'HR@20': '0.1072', 'NDCG@20': '0.0514'}
2025-03-01 11:22:58,506 - EarlyStopping counter: 5 out of 10
2025-03-01 11:23:24,675 - {'epoch': 62, 'rec_loss': '7.8932'}
2025-03-01 11:23:40,406 - {'Epoch': 62, 'HR@5': '0.0526', 'NDCG@5': '0.0361', 'HR@10': '0.0759', 'NDCG@10': '0.0436', 'HR@20': '0.1076', 'NDCG@20': '0.0516'}
2025-03-01 11:23:40,406 - Validation score increased.  Saving model ...
2025-03-01 11:24:06,517 - {'epoch': 63, 'rec_loss': '7.8948'}
2025-03-01 11:24:24,326 - {'Epoch': 63, 'HR@5': '0.0523', 'NDCG@5': '0.0362', 'HR@10': '0.0757', 'NDCG@10': '0.0437', 'HR@20': '0.1072', 'NDCG@20': '0.0517'}
2025-03-01 11:24:24,327 - Validation score increased.  Saving model ...
2025-03-01 11:24:50,573 - {'epoch': 64, 'rec_loss': '7.8865'}
2025-03-01 11:25:08,421 - {'Epoch': 64, 'HR@5': '0.0515', 'NDCG@5': '0.0359', 'HR@10': '0.0755', 'NDCG@10': '0.0436', 'HR@20': '0.1062', 'NDCG@20': '0.0514'}
2025-03-01 11:25:08,422 - EarlyStopping counter: 1 out of 10
2025-03-01 11:25:37,654 - {'epoch': 65, 'rec_loss': '7.8853'}
2025-03-01 11:25:54,635 - {'Epoch': 65, 'HR@5': '0.0518', 'NDCG@5': '0.0357', 'HR@10': '0.0760', 'NDCG@10': '0.0435', 'HR@20': '0.1072', 'NDCG@20': '0.0514'}
2025-03-01 11:25:54,636 - EarlyStopping counter: 2 out of 10
2025-03-01 11:26:25,471 - {'epoch': 66, 'rec_loss': '7.8878'}
2025-03-01 11:26:41,285 - {'Epoch': 66, 'HR@5': '0.0521', 'NDCG@5': '0.0363', 'HR@10': '0.0756', 'NDCG@10': '0.0438', 'HR@20': '0.1065', 'NDCG@20': '0.0516'}
2025-03-01 11:26:41,286 - EarlyStopping counter: 3 out of 10
2025-03-01 11:27:07,021 - {'epoch': 67, 'rec_loss': '7.8849'}
2025-03-01 11:27:22,711 - {'Epoch': 67, 'HR@5': '0.0521', 'NDCG@5': '0.0360', 'HR@10': '0.0759', 'NDCG@10': '0.0436', 'HR@20': '0.1064', 'NDCG@20': '0.0513'}
2025-03-01 11:27:22,712 - EarlyStopping counter: 4 out of 10
2025-03-01 11:27:48,518 - {'epoch': 68, 'rec_loss': '7.8693'}
2025-03-01 11:28:03,972 - {'Epoch': 68, 'HR@5': '0.0528', 'NDCG@5': '0.0365', 'HR@10': '0.0765', 'NDCG@10': '0.0442', 'HR@20': '0.1069', 'NDCG@20': '0.0518'}
2025-03-01 11:28:03,973 - Validation score increased.  Saving model ...
2025-03-01 11:28:31,037 - {'epoch': 69, 'rec_loss': '7.8806'}
2025-03-01 11:28:46,652 - {'Epoch': 69, 'HR@5': '0.0523', 'NDCG@5': '0.0362', 'HR@10': '0.0762', 'NDCG@10': '0.0438', 'HR@20': '0.1060', 'NDCG@20': '0.0513'}
2025-03-01 11:28:46,657 - EarlyStopping counter: 1 out of 10
2025-03-01 11:29:12,326 - {'epoch': 70, 'rec_loss': '7.8741'}
2025-03-01 11:29:28,408 - {'Epoch': 70, 'HR@5': '0.0528', 'NDCG@5': '0.0364', 'HR@10': '0.0756', 'NDCG@10': '0.0437', 'HR@20': '0.1067', 'NDCG@20': '0.0516'}
2025-03-01 11:29:28,409 - EarlyStopping counter: 2 out of 10
2025-03-01 11:29:54,137 - {'epoch': 71, 'rec_loss': '7.8729'}
2025-03-01 11:30:09,920 - {'Epoch': 71, 'HR@5': '0.0527', 'NDCG@5': '0.0365', 'HR@10': '0.0754', 'NDCG@10': '0.0438', 'HR@20': '0.1064', 'NDCG@20': '0.0516'}
2025-03-01 11:30:09,921 - EarlyStopping counter: 3 out of 10
2025-03-01 11:30:35,943 - {'epoch': 72, 'rec_loss': '7.8713'}
2025-03-01 11:30:51,879 - {'Epoch': 72, 'HR@5': '0.0525', 'NDCG@5': '0.0364', 'HR@10': '0.0757', 'NDCG@10': '0.0438', 'HR@20': '0.1061', 'NDCG@20': '0.0515'}
2025-03-01 11:30:51,880 - EarlyStopping counter: 4 out of 10
2025-03-01 11:31:17,617 - {'epoch': 73, 'rec_loss': '7.8646'}
2025-03-01 11:31:33,298 - {'Epoch': 73, 'HR@5': '0.0530', 'NDCG@5': '0.0363', 'HR@10': '0.0755', 'NDCG@10': '0.0436', 'HR@20': '0.1062', 'NDCG@20': '0.0513'}
2025-03-01 11:31:33,302 - EarlyStopping counter: 5 out of 10
2025-03-01 11:31:59,099 - {'epoch': 74, 'rec_loss': '7.8608'}
2025-03-01 11:32:14,701 - {'Epoch': 74, 'HR@5': '0.0532', 'NDCG@5': '0.0365', 'HR@10': '0.0759', 'NDCG@10': '0.0438', 'HR@20': '0.1049', 'NDCG@20': '0.0511'}
2025-03-01 11:32:14,702 - EarlyStopping counter: 6 out of 10
2025-03-01 11:32:39,532 - {'epoch': 75, 'rec_loss': '7.8648'}
2025-03-01 11:32:55,027 - {'Epoch': 75, 'HR@5': '0.0525', 'NDCG@5': '0.0367', 'HR@10': '0.0757', 'NDCG@10': '0.0441', 'HR@20': '0.1069', 'NDCG@20': '0.0520'}
2025-03-01 11:32:55,028 - Validation score increased.  Saving model ...
2025-03-01 11:33:22,152 - {'epoch': 76, 'rec_loss': '7.8602'}
2025-03-01 11:33:38,081 - {'Epoch': 76, 'HR@5': '0.0530', 'NDCG@5': '0.0368', 'HR@10': '0.0749', 'NDCG@10': '0.0439', 'HR@20': '0.1058', 'NDCG@20': '0.0517'}
2025-03-01 11:33:38,082 - EarlyStopping counter: 1 out of 10
2025-03-01 11:34:04,033 - {'epoch': 77, 'rec_loss': '7.8569'}
2025-03-01 11:34:19,777 - {'Epoch': 77, 'HR@5': '0.0524', 'NDCG@5': '0.0362', 'HR@10': '0.0764', 'NDCG@10': '0.0439', 'HR@20': '0.1060', 'NDCG@20': '0.0514'}
2025-03-01 11:34:19,778 - EarlyStopping counter: 2 out of 10
2025-03-01 11:34:45,181 - {'epoch': 78, 'rec_loss': '7.8514'}
2025-03-01 11:35:00,886 - {'Epoch': 78, 'HR@5': '0.0527', 'NDCG@5': '0.0361', 'HR@10': '0.0751', 'NDCG@10': '0.0433', 'HR@20': '0.1064', 'NDCG@20': '0.0512'}
2025-03-01 11:35:00,887 - EarlyStopping counter: 3 out of 10
2025-03-01 11:35:27,763 - {'epoch': 79, 'rec_loss': '7.8578'}
2025-03-01 11:35:43,375 - {'Epoch': 79, 'HR@5': '0.0527', 'NDCG@5': '0.0364', 'HR@10': '0.0756', 'NDCG@10': '0.0438', 'HR@20': '0.1057', 'NDCG@20': '0.0514'}
2025-03-01 11:35:43,376 - EarlyStopping counter: 4 out of 10
2025-03-01 11:36:08,841 - {'epoch': 80, 'rec_loss': '7.8559'}
2025-03-01 11:36:24,755 - {'Epoch': 80, 'HR@5': '0.0524', 'NDCG@5': '0.0364', 'HR@10': '0.0751', 'NDCG@10': '0.0437', 'HR@20': '0.1064', 'NDCG@20': '0.0515'}
2025-03-01 11:36:24,756 - EarlyStopping counter: 5 out of 10
2025-03-01 11:36:50,179 - {'epoch': 81, 'rec_loss': '7.8548'}
2025-03-01 11:37:06,294 - {'Epoch': 81, 'HR@5': '0.0527', 'NDCG@5': '0.0367', 'HR@10': '0.0754', 'NDCG@10': '0.0440', 'HR@20': '0.1071', 'NDCG@20': '0.0520'}
2025-03-01 11:37:06,295 - Validation score increased.  Saving model ...
2025-03-01 11:37:33,581 - {'epoch': 82, 'rec_loss': '7.8490'}
2025-03-01 11:37:49,044 - {'Epoch': 82, 'HR@5': '0.0529', 'NDCG@5': '0.0368', 'HR@10': '0.0757', 'NDCG@10': '0.0441', 'HR@20': '0.1070', 'NDCG@20': '0.0519'}
2025-03-01 11:37:49,045 - EarlyStopping counter: 1 out of 10
2025-03-01 11:38:14,521 - {'epoch': 83, 'rec_loss': '7.8540'}
2025-03-01 11:38:32,329 - {'Epoch': 83, 'HR@5': '0.0525', 'NDCG@5': '0.0362', 'HR@10': '0.0758', 'NDCG@10': '0.0437', 'HR@20': '0.1067', 'NDCG@20': '0.0515'}
2025-03-01 11:38:32,330 - EarlyStopping counter: 2 out of 10
2025-03-01 11:38:57,061 - {'epoch': 84, 'rec_loss': '7.8491'}
2025-03-01 11:39:12,847 - {'Epoch': 84, 'HR@5': '0.0515', 'NDCG@5': '0.0359', 'HR@10': '0.0758', 'NDCG@10': '0.0437', 'HR@20': '0.1079', 'NDCG@20': '0.0518'}
2025-03-01 11:39:12,848 - EarlyStopping counter: 3 out of 10
2025-03-01 11:39:37,843 - {'epoch': 85, 'rec_loss': '7.8377'}
2025-03-01 11:39:53,486 - {'Epoch': 85, 'HR@5': '0.0522', 'NDCG@5': '0.0364', 'HR@10': '0.0764', 'NDCG@10': '0.0442', 'HR@20': '0.1077', 'NDCG@20': '0.0521'}
2025-03-01 11:39:53,487 - Validation score increased.  Saving model ...
2025-03-01 11:40:17,998 - {'epoch': 86, 'rec_loss': '7.8486'}
2025-03-01 11:40:33,675 - {'Epoch': 86, 'HR@5': '0.0516', 'NDCG@5': '0.0361', 'HR@10': '0.0756', 'NDCG@10': '0.0438', 'HR@20': '0.1081', 'NDCG@20': '0.0520'}
2025-03-01 11:40:33,675 - EarlyStopping counter: 1 out of 10
2025-03-01 11:40:59,479 - {'epoch': 87, 'rec_loss': '7.8371'}
2025-03-01 11:41:14,990 - {'Epoch': 87, 'HR@5': '0.0517', 'NDCG@5': '0.0357', 'HR@10': '0.0760', 'NDCG@10': '0.0435', 'HR@20': '0.1059', 'NDCG@20': '0.0511'}
2025-03-01 11:41:14,991 - EarlyStopping counter: 2 out of 10
2025-03-01 11:41:39,950 - {'epoch': 88, 'rec_loss': '7.8364'}
2025-03-01 11:41:55,757 - {'Epoch': 88, 'HR@5': '0.0525', 'NDCG@5': '0.0361', 'HR@10': '0.0765', 'NDCG@10': '0.0438', 'HR@20': '0.1072', 'NDCG@20': '0.0515'}
2025-03-01 11:41:55,758 - EarlyStopping counter: 3 out of 10
2025-03-01 11:42:21,802 - {'epoch': 89, 'rec_loss': '7.8400'}
2025-03-01 11:42:37,325 - {'Epoch': 89, 'HR@5': '0.0530', 'NDCG@5': '0.0367', 'HR@10': '0.0768', 'NDCG@10': '0.0443', 'HR@20': '0.1080', 'NDCG@20': '0.0522'}
2025-03-01 11:42:37,325 - Validation score increased.  Saving model ...
2025-03-01 11:43:02,635 - {'epoch': 90, 'rec_loss': '7.8302'}
2025-03-01 11:43:18,359 - {'Epoch': 90, 'HR@5': '0.0527', 'NDCG@5': '0.0364', 'HR@10': '0.0766', 'NDCG@10': '0.0441', 'HR@20': '0.1073', 'NDCG@20': '0.0518'}
2025-03-01 11:43:18,360 - EarlyStopping counter: 1 out of 10
2025-03-01 11:43:44,485 - {'epoch': 91, 'rec_loss': '7.8417'}
2025-03-01 11:44:00,093 - {'Epoch': 91, 'HR@5': '0.0527', 'NDCG@5': '0.0362', 'HR@10': '0.0756', 'NDCG@10': '0.0435', 'HR@20': '0.1064', 'NDCG@20': '0.0513'}
2025-03-01 11:44:00,094 - EarlyStopping counter: 2 out of 10
2025-03-01 11:44:27,074 - {'epoch': 92, 'rec_loss': '7.8333'}
2025-03-01 11:44:44,024 - {'Epoch': 92, 'HR@5': '0.0526', 'NDCG@5': '0.0362', 'HR@10': '0.0758', 'NDCG@10': '0.0436', 'HR@20': '0.1078', 'NDCG@20': '0.0517'}
2025-03-01 11:44:44,025 - EarlyStopping counter: 3 out of 10
2025-03-01 11:45:10,759 - {'epoch': 93, 'rec_loss': '7.8333'}
2025-03-01 11:45:27,473 - {'Epoch': 93, 'HR@5': '0.0523', 'NDCG@5': '0.0362', 'HR@10': '0.0757', 'NDCG@10': '0.0437', 'HR@20': '0.1068', 'NDCG@20': '0.0516'}
2025-03-01 11:45:27,476 - EarlyStopping counter: 4 out of 10
2025-03-01 11:45:53,217 - {'epoch': 94, 'rec_loss': '7.8304'}
2025-03-01 11:46:09,087 - {'Epoch': 94, 'HR@5': '0.0529', 'NDCG@5': '0.0365', 'HR@10': '0.0768', 'NDCG@10': '0.0442', 'HR@20': '0.1077', 'NDCG@20': '0.0520'}
2025-03-01 11:46:09,088 - EarlyStopping counter: 5 out of 10
2025-03-01 11:46:35,650 - {'epoch': 95, 'rec_loss': '7.8243'}
2025-03-01 11:46:53,652 - {'Epoch': 95, 'HR@5': '0.0521', 'NDCG@5': '0.0362', 'HR@10': '0.0766', 'NDCG@10': '0.0440', 'HR@20': '0.1069', 'NDCG@20': '0.0516'}
2025-03-01 11:46:53,653 - EarlyStopping counter: 6 out of 10
2025-03-01 11:47:21,852 - {'epoch': 96, 'rec_loss': '7.8294'}
2025-03-01 11:47:37,922 - {'Epoch': 96, 'HR@5': '0.0526', 'NDCG@5': '0.0365', 'HR@10': '0.0756', 'NDCG@10': '0.0439', 'HR@20': '0.1064', 'NDCG@20': '0.0516'}
2025-03-01 11:47:37,923 - EarlyStopping counter: 7 out of 10
2025-03-01 11:48:03,229 - {'epoch': 97, 'rec_loss': '7.8264'}
2025-03-01 11:48:20,237 - {'Epoch': 97, 'HR@5': '0.0532', 'NDCG@5': '0.0368', 'HR@10': '0.0758', 'NDCG@10': '0.0441', 'HR@20': '0.1076', 'NDCG@20': '0.0520'}
2025-03-01 11:48:20,238 - EarlyStopping counter: 8 out of 10
2025-03-01 11:48:46,780 - {'epoch': 98, 'rec_loss': '7.8215'}
2025-03-01 11:49:04,543 - {'Epoch': 98, 'HR@5': '0.0523', 'NDCG@5': '0.0365', 'HR@10': '0.0764', 'NDCG@10': '0.0442', 'HR@20': '0.1069', 'NDCG@20': '0.0519'}
2025-03-01 11:49:04,544 - EarlyStopping counter: 9 out of 10
2025-03-01 11:49:34,411 - {'epoch': 99, 'rec_loss': '7.8232'}
2025-03-01 11:49:50,180 - {'Epoch': 99, 'HR@5': '0.0527', 'NDCG@5': '0.0363', 'HR@10': '0.0763', 'NDCG@10': '0.0439', 'HR@20': '0.1081', 'NDCG@20': '0.0519'}
2025-03-01 11:49:50,181 - EarlyStopping counter: 10 out of 10
2025-03-01 11:49:50,181 - Early stopping
2025-03-01 11:49:50,182 - ---------------Test Score---------------
2025-03-01 11:50:07,362 - {'Epoch': 0, 'HR@5': '0.0423', 'NDCG@5': '0.0296', 'HR@10': '0.0615', 'NDCG@10': '0.0358', 'HR@20': '0.0876', 'NDCG@20': '0.0424'}
2025-03-01 11:50:07,364 - Scale_Sports
2025-03-01 11:50:07,364 - {'Epoch': 0, 'HR@5': '0.0423', 'NDCG@5': '0.0296', 'HR@10': '0.0615', 'NDCG@10': '0.0358', 'HR@20': '0.0876', 'NDCG@20': '0.0424'}
2025-03-01 12:21:56,945 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.0, end_prob=0.3, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-01 12:22:00,011 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-01 12:22:00,016 - Total Parameters: 1328854
2025-03-01 12:22:44,491 - {'epoch': 0, 'rec_loss': '9.4032'}
2025-03-01 12:23:03,262 - {'Epoch': 0, 'HR@5': '0.0084', 'NDCG@5': '0.0055', 'HR@10': '0.0129', 'NDCG@10': '0.0069', 'HR@20': '0.0234', 'NDCG@20': '0.0096'}
2025-03-01 12:23:03,267 - Validation score increased.  Saving model ...
2025-03-01 12:23:44,529 - {'epoch': 1, 'rec_loss': '9.0792'}
2025-03-01 12:24:03,140 - {'Epoch': 1, 'HR@5': '0.0175', 'NDCG@5': '0.0112', 'HR@10': '0.0303', 'NDCG@10': '0.0153', 'HR@20': '0.0477', 'NDCG@20': '0.0197'}
2025-03-01 12:24:03,141 - Validation score increased.  Saving model ...
2025-03-01 12:24:45,590 - {'epoch': 2, 'rec_loss': '8.7331'}
2025-03-01 12:25:03,245 - {'Epoch': 2, 'HR@5': '0.0271', 'NDCG@5': '0.0174', 'HR@10': '0.0425', 'NDCG@10': '0.0224', 'HR@20': '0.0655', 'NDCG@20': '0.0282'}
2025-03-01 12:25:03,246 - Validation score increased.  Saving model ...
2025-03-01 12:25:44,884 - {'epoch': 3, 'rec_loss': '8.4824'}
2025-03-01 12:26:03,503 - {'Epoch': 3, 'HR@5': '0.0350', 'NDCG@5': '0.0238', 'HR@10': '0.0516', 'NDCG@10': '0.0292', 'HR@20': '0.0784', 'NDCG@20': '0.0359'}
2025-03-01 12:26:03,505 - Validation score increased.  Saving model ...
2025-03-01 12:26:45,617 - {'epoch': 4, 'rec_loss': '8.2998'}
2025-03-01 12:27:02,130 - {'Epoch': 4, 'HR@5': '0.0396', 'NDCG@5': '0.0269', 'HR@10': '0.0591', 'NDCG@10': '0.0332', 'HR@20': '0.0855', 'NDCG@20': '0.0399'}
2025-03-01 12:27:02,135 - Validation score increased.  Saving model ...
2025-03-01 12:27:44,445 - {'epoch': 5, 'rec_loss': '8.1545'}
2025-03-01 12:28:03,124 - {'Epoch': 5, 'HR@5': '0.0429', 'NDCG@5': '0.0294', 'HR@10': '0.0637', 'NDCG@10': '0.0361', 'HR@20': '0.0886', 'NDCG@20': '0.0423'}
2025-03-01 12:28:03,127 - Validation score increased.  Saving model ...
2025-03-01 12:28:45,071 - {'epoch': 6, 'rec_loss': '8.0457'}
2025-03-01 12:29:01,688 - {'Epoch': 6, 'HR@5': '0.0429', 'NDCG@5': '0.0302', 'HR@10': '0.0641', 'NDCG@10': '0.0370', 'HR@20': '0.0919', 'NDCG@20': '0.0440'}
2025-03-01 12:29:01,689 - Validation score increased.  Saving model ...
2025-03-01 12:29:44,697 - {'epoch': 7, 'rec_loss': '7.9600'}
2025-03-01 12:30:02,804 - {'Epoch': 7, 'HR@5': '0.0470', 'NDCG@5': '0.0328', 'HR@10': '0.0671', 'NDCG@10': '0.0392', 'HR@20': '0.0951', 'NDCG@20': '0.0462'}
2025-03-01 12:30:02,805 - Validation score increased.  Saving model ...
2025-03-01 12:30:46,387 - {'epoch': 8, 'rec_loss': '7.8853'}
2025-03-01 12:31:03,002 - {'Epoch': 8, 'HR@5': '0.0466', 'NDCG@5': '0.0325', 'HR@10': '0.0671', 'NDCG@10': '0.0391', 'HR@20': '0.0950', 'NDCG@20': '0.0461'}
2025-03-01 12:31:03,003 - EarlyStopping counter: 1 out of 10
2025-03-01 12:31:46,002 - {'epoch': 9, 'rec_loss': '7.8280'}
2025-03-01 12:32:04,569 - {'Epoch': 9, 'HR@5': '0.0472', 'NDCG@5': '0.0330', 'HR@10': '0.0687', 'NDCG@10': '0.0399', 'HR@20': '0.0967', 'NDCG@20': '0.0469'}
2025-03-01 12:32:04,572 - Validation score increased.  Saving model ...
2025-03-01 12:32:46,805 - {'epoch': 10, 'rec_loss': '7.7784'}
2025-03-01 12:33:04,699 - {'Epoch': 10, 'HR@5': '0.0477', 'NDCG@5': '0.0329', 'HR@10': '0.0682', 'NDCG@10': '0.0395', 'HR@20': '0.0975', 'NDCG@20': '0.0468'}
2025-03-01 12:33:04,702 - EarlyStopping counter: 1 out of 10
2025-03-01 12:33:47,970 - {'epoch': 11, 'rec_loss': '7.7364'}
2025-03-01 12:34:06,403 - {'Epoch': 11, 'HR@5': '0.0480', 'NDCG@5': '0.0335', 'HR@10': '0.0699', 'NDCG@10': '0.0405', 'HR@20': '0.0993', 'NDCG@20': '0.0479'}
2025-03-01 12:34:06,407 - Validation score increased.  Saving model ...
2025-03-01 12:34:47,397 - {'epoch': 12, 'rec_loss': '7.6997'}
2025-03-01 12:35:05,213 - {'Epoch': 12, 'HR@5': '0.0485', 'NDCG@5': '0.0338', 'HR@10': '0.0704', 'NDCG@10': '0.0408', 'HR@20': '0.0999', 'NDCG@20': '0.0482'}
2025-03-01 12:35:05,214 - Validation score increased.  Saving model ...
2025-03-01 12:35:48,122 - {'epoch': 13, 'rec_loss': '7.6644'}
2025-03-01 12:36:07,042 - {'Epoch': 13, 'HR@5': '0.0482', 'NDCG@5': '0.0340', 'HR@10': '0.0701', 'NDCG@10': '0.0411', 'HR@20': '0.1004', 'NDCG@20': '0.0487'}
2025-03-01 12:36:07,047 - Validation score increased.  Saving model ...
2025-03-01 12:36:48,645 - {'epoch': 14, 'rec_loss': '7.6345'}
2025-03-01 12:37:06,824 - {'Epoch': 14, 'HR@5': '0.0494', 'NDCG@5': '0.0344', 'HR@10': '0.0718', 'NDCG@10': '0.0416', 'HR@20': '0.1013', 'NDCG@20': '0.0491'}
2025-03-01 12:37:06,828 - Validation score increased.  Saving model ...
2025-03-01 12:37:49,926 - {'epoch': 15, 'rec_loss': '7.6106'}
2025-03-01 12:38:06,357 - {'Epoch': 15, 'HR@5': '0.0483', 'NDCG@5': '0.0338', 'HR@10': '0.0703', 'NDCG@10': '0.0409', 'HR@20': '0.1010', 'NDCG@20': '0.0486'}
2025-03-01 12:38:06,359 - EarlyStopping counter: 1 out of 10
2025-03-01 12:38:50,199 - {'epoch': 16, 'rec_loss': '7.5853'}
2025-03-01 12:39:08,323 - {'Epoch': 16, 'HR@5': '0.0487', 'NDCG@5': '0.0338', 'HR@10': '0.0703', 'NDCG@10': '0.0408', 'HR@20': '0.1007', 'NDCG@20': '0.0484'}
2025-03-01 12:39:08,324 - EarlyStopping counter: 2 out of 10
2025-03-01 12:39:52,217 - {'epoch': 17, 'rec_loss': '7.5625'}
2025-03-01 12:40:09,198 - {'Epoch': 17, 'HR@5': '0.0486', 'NDCG@5': '0.0337', 'HR@10': '0.0701', 'NDCG@10': '0.0406', 'HR@20': '0.1005', 'NDCG@20': '0.0482'}
2025-03-01 12:40:09,199 - EarlyStopping counter: 3 out of 10
2025-03-01 12:40:53,121 - {'epoch': 18, 'rec_loss': '7.5438'}
2025-03-01 12:41:11,379 - {'Epoch': 18, 'HR@5': '0.0492', 'NDCG@5': '0.0341', 'HR@10': '0.0710', 'NDCG@10': '0.0412', 'HR@20': '0.1004', 'NDCG@20': '0.0486'}
2025-03-01 12:41:11,385 - EarlyStopping counter: 4 out of 10
2025-03-01 12:41:53,204 - {'epoch': 19, 'rec_loss': '7.5234'}
2025-03-01 12:42:10,918 - {'Epoch': 19, 'HR@5': '0.0490', 'NDCG@5': '0.0342', 'HR@10': '0.0700', 'NDCG@10': '0.0410', 'HR@20': '0.1004', 'NDCG@20': '0.0487'}
2025-03-01 12:42:10,919 - EarlyStopping counter: 5 out of 10
2025-03-01 12:42:54,828 - {'epoch': 20, 'rec_loss': '7.5062'}
2025-03-01 12:43:12,329 - {'Epoch': 20, 'HR@5': '0.0493', 'NDCG@5': '0.0340', 'HR@10': '0.0723', 'NDCG@10': '0.0414', 'HR@20': '0.1027', 'NDCG@20': '0.0490'}
2025-03-01 12:43:12,331 - EarlyStopping counter: 6 out of 10
2025-03-01 12:43:54,457 - {'epoch': 21, 'rec_loss': '7.4885'}
2025-03-01 12:44:14,563 - {'Epoch': 21, 'HR@5': '0.0490', 'NDCG@5': '0.0340', 'HR@10': '0.0709', 'NDCG@10': '0.0410', 'HR@20': '0.1014', 'NDCG@20': '0.0487'}
2025-03-01 12:44:14,568 - EarlyStopping counter: 7 out of 10
2025-03-01 12:45:02,076 - {'epoch': 22, 'rec_loss': '7.4773'}
2025-03-01 12:45:20,593 - {'Epoch': 22, 'HR@5': '0.0491', 'NDCG@5': '0.0340', 'HR@10': '0.0723', 'NDCG@10': '0.0415', 'HR@20': '0.1012', 'NDCG@20': '0.0488'}
2025-03-01 12:45:20,598 - EarlyStopping counter: 8 out of 10
2025-03-01 12:46:06,029 - {'epoch': 23, 'rec_loss': '7.4595'}
2025-03-01 12:46:25,937 - {'Epoch': 23, 'HR@5': '0.0483', 'NDCG@5': '0.0334', 'HR@10': '0.0717', 'NDCG@10': '0.0409', 'HR@20': '0.1005', 'NDCG@20': '0.0481'}
2025-03-01 12:46:25,939 - EarlyStopping counter: 9 out of 10
2025-03-01 12:47:13,204 - {'epoch': 24, 'rec_loss': '7.4433'}
2025-03-01 12:47:31,234 - {'Epoch': 24, 'HR@5': '0.0489', 'NDCG@5': '0.0344', 'HR@10': '0.0718', 'NDCG@10': '0.0418', 'HR@20': '0.1020', 'NDCG@20': '0.0494'}
2025-03-01 12:47:31,239 - Validation score increased.  Saving model ...
2025-03-01 12:48:18,445 - {'epoch': 25, 'rec_loss': '7.4303'}
2025-03-01 12:48:37,783 - {'Epoch': 25, 'HR@5': '0.0499', 'NDCG@5': '0.0349', 'HR@10': '0.0726', 'NDCG@10': '0.0422', 'HR@20': '0.1021', 'NDCG@20': '0.0496'}
2025-03-01 12:48:37,784 - Validation score increased.  Saving model ...
2025-03-01 12:49:23,863 - {'epoch': 26, 'rec_loss': '7.4211'}
2025-03-01 12:49:42,192 - {'Epoch': 26, 'HR@5': '0.0502', 'NDCG@5': '0.0348', 'HR@10': '0.0728', 'NDCG@10': '0.0421', 'HR@20': '0.1009', 'NDCG@20': '0.0492'}
2025-03-01 12:49:42,194 - EarlyStopping counter: 1 out of 10
2025-03-01 12:50:30,138 - {'epoch': 27, 'rec_loss': '7.4061'}
2025-03-01 12:50:51,408 - {'Epoch': 27, 'HR@5': '0.0505', 'NDCG@5': '0.0345', 'HR@10': '0.0736', 'NDCG@10': '0.0420', 'HR@20': '0.1014', 'NDCG@20': '0.0490'}
2025-03-01 12:50:51,411 - EarlyStopping counter: 2 out of 10
2025-03-01 12:51:36,965 - {'epoch': 28, 'rec_loss': '7.3967'}
2025-03-01 12:51:55,080 - {'Epoch': 28, 'HR@5': '0.0499', 'NDCG@5': '0.0346', 'HR@10': '0.0728', 'NDCG@10': '0.0419', 'HR@20': '0.1024', 'NDCG@20': '0.0494'}
2025-03-01 12:51:55,082 - EarlyStopping counter: 3 out of 10
2025-03-01 12:52:41,149 - {'epoch': 29, 'rec_loss': '7.3859'}
2025-03-01 12:53:00,812 - {'Epoch': 29, 'HR@5': '0.0485', 'NDCG@5': '0.0340', 'HR@10': '0.0716', 'NDCG@10': '0.0414', 'HR@20': '0.1019', 'NDCG@20': '0.0490'}
2025-03-01 12:53:00,813 - EarlyStopping counter: 4 out of 10
2025-03-01 12:53:43,255 - {'epoch': 30, 'rec_loss': '7.3785'}
2025-03-01 12:54:01,537 - {'Epoch': 30, 'HR@5': '0.0505', 'NDCG@5': '0.0344', 'HR@10': '0.0732', 'NDCG@10': '0.0417', 'HR@20': '0.1031', 'NDCG@20': '0.0492'}
2025-03-01 12:54:01,543 - EarlyStopping counter: 5 out of 10
2025-03-01 12:54:43,333 - {'epoch': 31, 'rec_loss': '7.3670'}
2025-03-01 12:55:02,785 - {'Epoch': 31, 'HR@5': '0.0500', 'NDCG@5': '0.0345', 'HR@10': '0.0725', 'NDCG@10': '0.0417', 'HR@20': '0.1025', 'NDCG@20': '0.0493'}
2025-03-01 12:55:02,786 - EarlyStopping counter: 6 out of 10
2025-03-01 12:55:42,409 - {'epoch': 32, 'rec_loss': '7.3568'}
2025-03-01 12:56:00,071 - {'Epoch': 32, 'HR@5': '0.0500', 'NDCG@5': '0.0343', 'HR@10': '0.0732', 'NDCG@10': '0.0418', 'HR@20': '0.1031', 'NDCG@20': '0.0493'}
2025-03-01 12:56:00,072 - EarlyStopping counter: 7 out of 10
2025-03-01 12:56:40,953 - {'epoch': 33, 'rec_loss': '7.3473'}
2025-03-01 12:56:59,390 - {'Epoch': 33, 'HR@5': '0.0492', 'NDCG@5': '0.0343', 'HR@10': '0.0726', 'NDCG@10': '0.0419', 'HR@20': '0.1026', 'NDCG@20': '0.0494'}
2025-03-01 12:56:59,391 - EarlyStopping counter: 8 out of 10
2025-03-01 12:57:45,955 - {'epoch': 34, 'rec_loss': '7.3362'}
2025-03-01 12:58:05,382 - {'Epoch': 34, 'HR@5': '0.0496', 'NDCG@5': '0.0342', 'HR@10': '0.0715', 'NDCG@10': '0.0413', 'HR@20': '0.1017', 'NDCG@20': '0.0488'}
2025-03-01 12:58:05,384 - EarlyStopping counter: 9 out of 10
2025-03-01 12:58:49,627 - {'epoch': 35, 'rec_loss': '7.3323'}
2025-03-01 12:59:07,210 - {'Epoch': 35, 'HR@5': '0.0496', 'NDCG@5': '0.0344', 'HR@10': '0.0732', 'NDCG@10': '0.0420', 'HR@20': '0.1025', 'NDCG@20': '0.0494'}
2025-03-01 12:59:07,211 - EarlyStopping counter: 10 out of 10
2025-03-01 12:59:07,211 - Early stopping
2025-03-01 12:59:07,211 - ---------------Test Score---------------
2025-03-01 12:59:24,884 - {'Epoch': 0, 'HR@5': '0.0421', 'NDCG@5': '0.0290', 'HR@10': '0.0601', 'NDCG@10': '0.0348', 'HR@20': '0.0847', 'NDCG@20': '0.0410'}
2025-03-01 12:59:24,886 - Scale_Sports
2025-03-01 12:59:24,886 - {'Epoch': 0, 'HR@5': '0.0421', 'NDCG@5': '0.0290', 'HR@10': '0.0601', 'NDCG@10': '0.0348', 'HR@20': '0.0847', 'NDCG@20': '0.0410'}
2025-03-01 13:23:01,975 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.1, end_prob=0.4, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-01 13:23:05,249 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-01 13:23:05,256 - Total Parameters: 1328854
2025-03-01 13:23:53,555 - {'epoch': 0, 'rec_loss': '9.4017'}
2025-03-01 13:24:11,085 - {'Epoch': 0, 'HR@5': '0.0083', 'NDCG@5': '0.0055', 'HR@10': '0.0128', 'NDCG@10': '0.0069', 'HR@20': '0.0233', 'NDCG@20': '0.0095'}
2025-03-01 13:24:11,086 - Validation score increased.  Saving model ...
2025-03-01 13:24:52,742 - {'epoch': 1, 'rec_loss': '9.1059'}
2025-03-01 13:25:12,037 - {'Epoch': 1, 'HR@5': '0.0173', 'NDCG@5': '0.0110', 'HR@10': '0.0295', 'NDCG@10': '0.0149', 'HR@20': '0.0460', 'NDCG@20': '0.0191'}
2025-03-01 13:25:12,039 - Validation score increased.  Saving model ...
2025-03-01 13:25:56,802 - {'epoch': 2, 'rec_loss': '8.7888'}
2025-03-01 13:26:15,724 - {'Epoch': 2, 'HR@5': '0.0249', 'NDCG@5': '0.0161', 'HR@10': '0.0389', 'NDCG@10': '0.0206', 'HR@20': '0.0610', 'NDCG@20': '0.0261'}
2025-03-01 13:26:15,729 - Validation score increased.  Saving model ...
2025-03-01 13:26:53,463 - {'epoch': 3, 'rec_loss': '8.5572'}
2025-03-01 13:27:12,586 - {'Epoch': 3, 'HR@5': '0.0337', 'NDCG@5': '0.0225', 'HR@10': '0.0498', 'NDCG@10': '0.0277', 'HR@20': '0.0745', 'NDCG@20': '0.0339'}
2025-03-01 13:27:12,588 - Validation score increased.  Saving model ...
2025-03-01 13:27:57,598 - {'epoch': 4, 'rec_loss': '8.3872'}
2025-03-01 13:28:16,284 - {'Epoch': 4, 'HR@5': '0.0377', 'NDCG@5': '0.0254', 'HR@10': '0.0556', 'NDCG@10': '0.0312', 'HR@20': '0.0819', 'NDCG@20': '0.0379'}
2025-03-01 13:28:16,289 - Validation score increased.  Saving model ...
2025-03-01 13:28:57,039 - {'epoch': 5, 'rec_loss': '8.2509'}
2025-03-01 13:29:15,673 - {'Epoch': 5, 'HR@5': '0.0422', 'NDCG@5': '0.0286', 'HR@10': '0.0607', 'NDCG@10': '0.0345', 'HR@20': '0.0873', 'NDCG@20': '0.0412'}
2025-03-01 13:29:15,679 - Validation score increased.  Saving model ...
2025-03-01 13:30:01,688 - {'epoch': 6, 'rec_loss': '8.1460'}
2025-03-01 13:30:20,775 - {'Epoch': 6, 'HR@5': '0.0425', 'NDCG@5': '0.0293', 'HR@10': '0.0624', 'NDCG@10': '0.0357', 'HR@20': '0.0905', 'NDCG@20': '0.0428'}
2025-03-01 13:30:20,779 - Validation score increased.  Saving model ...
2025-03-01 13:31:00,561 - {'epoch': 7, 'rec_loss': '8.0606'}
2025-03-01 13:31:20,826 - {'Epoch': 7, 'HR@5': '0.0455', 'NDCG@5': '0.0315', 'HR@10': '0.0658', 'NDCG@10': '0.0380', 'HR@20': '0.0930', 'NDCG@20': '0.0448'}
2025-03-01 13:31:20,830 - Validation score increased.  Saving model ...
2025-03-01 13:32:04,303 - {'epoch': 8, 'rec_loss': '7.9883'}
2025-03-01 13:32:22,566 - {'Epoch': 8, 'HR@5': '0.0465', 'NDCG@5': '0.0325', 'HR@10': '0.0658', 'NDCG@10': '0.0387', 'HR@20': '0.0939', 'NDCG@20': '0.0457'}
2025-03-01 13:32:22,572 - Validation score increased.  Saving model ...
2025-03-01 13:33:07,658 - {'epoch': 9, 'rec_loss': '7.9304'}
2025-03-01 13:33:27,469 - {'Epoch': 9, 'HR@5': '0.0474', 'NDCG@5': '0.0331', 'HR@10': '0.0689', 'NDCG@10': '0.0400', 'HR@20': '0.0964', 'NDCG@20': '0.0469'}
2025-03-01 13:33:27,472 - Validation score increased.  Saving model ...
2025-03-01 13:34:13,377 - {'epoch': 10, 'rec_loss': '7.8817'}
2025-03-01 13:34:32,385 - {'Epoch': 10, 'HR@5': '0.0473', 'NDCG@5': '0.0328', 'HR@10': '0.0680', 'NDCG@10': '0.0394', 'HR@20': '0.0967', 'NDCG@20': '0.0466'}
2025-03-01 13:34:32,386 - EarlyStopping counter: 1 out of 10
2025-03-01 13:35:12,926 - {'epoch': 11, 'rec_loss': '7.8375'}
2025-03-01 13:35:33,481 - {'Epoch': 11, 'HR@5': '0.0478', 'NDCG@5': '0.0335', 'HR@10': '0.0691', 'NDCG@10': '0.0404', 'HR@20': '0.0978', 'NDCG@20': '0.0476'}
2025-03-01 13:35:33,482 - Validation score increased.  Saving model ...
2025-03-01 13:36:20,280 - {'epoch': 12, 'rec_loss': '7.8014'}
2025-03-01 13:36:38,849 - {'Epoch': 12, 'HR@5': '0.0487', 'NDCG@5': '0.0342', 'HR@10': '0.0699', 'NDCG@10': '0.0410', 'HR@20': '0.1002', 'NDCG@20': '0.0486'}
2025-03-01 13:36:38,851 - Validation score increased.  Saving model ...
2025-03-01 13:37:21,154 - {'epoch': 13, 'rec_loss': '7.7658'}
2025-03-01 13:37:38,904 - {'Epoch': 13, 'HR@5': '0.0491', 'NDCG@5': '0.0343', 'HR@10': '0.0709', 'NDCG@10': '0.0412', 'HR@20': '0.1008', 'NDCG@20': '0.0488'}
2025-03-01 13:37:38,906 - Validation score increased.  Saving model ...
2025-03-01 13:38:22,684 - {'epoch': 14, 'rec_loss': '7.7360'}
2025-03-01 13:38:40,839 - {'Epoch': 14, 'HR@5': '0.0496', 'NDCG@5': '0.0348', 'HR@10': '0.0714', 'NDCG@10': '0.0418', 'HR@20': '0.1007', 'NDCG@20': '0.0492'}
2025-03-01 13:38:40,841 - Validation score increased.  Saving model ...
2025-03-01 13:39:24,068 - {'epoch': 15, 'rec_loss': '7.7129'}
2025-03-01 13:39:42,550 - {'Epoch': 15, 'HR@5': '0.0497', 'NDCG@5': '0.0347', 'HR@10': '0.0709', 'NDCG@10': '0.0415', 'HR@20': '0.1010', 'NDCG@20': '0.0491'}
2025-03-01 13:39:42,554 - EarlyStopping counter: 1 out of 10
2025-03-01 13:40:28,166 - {'epoch': 16, 'rec_loss': '7.6863'}
2025-03-01 13:40:47,683 - {'Epoch': 16, 'HR@5': '0.0486', 'NDCG@5': '0.0341', 'HR@10': '0.0707', 'NDCG@10': '0.0413', 'HR@20': '0.1007', 'NDCG@20': '0.0488'}
2025-03-01 13:40:47,687 - EarlyStopping counter: 2 out of 10
2025-03-01 13:41:26,633 - {'epoch': 17, 'rec_loss': '7.6648'}
2025-03-01 13:41:44,933 - {'Epoch': 17, 'HR@5': '0.0496', 'NDCG@5': '0.0345', 'HR@10': '0.0705', 'NDCG@10': '0.0413', 'HR@20': '0.0996', 'NDCG@20': '0.0486'}
2025-03-01 13:41:44,934 - EarlyStopping counter: 3 out of 10
2025-03-01 13:42:30,107 - {'epoch': 18, 'rec_loss': '7.6434'}
2025-03-01 13:42:49,740 - {'Epoch': 18, 'HR@5': '0.0500', 'NDCG@5': '0.0347', 'HR@10': '0.0713', 'NDCG@10': '0.0415', 'HR@20': '0.1000', 'NDCG@20': '0.0488'}
2025-03-01 13:42:49,741 - EarlyStopping counter: 4 out of 10
2025-03-01 13:43:30,060 - {'epoch': 19, 'rec_loss': '7.6239'}
2025-03-01 13:43:47,063 - {'Epoch': 19, 'HR@5': '0.0504', 'NDCG@5': '0.0353', 'HR@10': '0.0720', 'NDCG@10': '0.0422', 'HR@20': '0.1009', 'NDCG@20': '0.0495'}
2025-03-01 13:43:47,065 - Validation score increased.  Saving model ...
2025-03-01 13:44:30,580 - {'epoch': 20, 'rec_loss': '7.6113'}
2025-03-01 13:44:49,304 - {'Epoch': 20, 'HR@5': '0.0508', 'NDCG@5': '0.0354', 'HR@10': '0.0730', 'NDCG@10': '0.0426', 'HR@20': '0.1028', 'NDCG@20': '0.0501'}
2025-03-01 13:44:49,305 - Validation score increased.  Saving model ...
2025-03-01 13:45:29,231 - {'epoch': 21, 'rec_loss': '7.5911'}
2025-03-01 13:45:48,788 - {'Epoch': 21, 'HR@5': '0.0486', 'NDCG@5': '0.0342', 'HR@10': '0.0720', 'NDCG@10': '0.0417', 'HR@20': '0.1010', 'NDCG@20': '0.0490'}
2025-03-01 13:45:48,789 - EarlyStopping counter: 1 out of 10
2025-03-01 13:46:32,086 - {'epoch': 22, 'rec_loss': '7.5810'}
2025-03-01 13:46:51,702 - {'Epoch': 22, 'HR@5': '0.0500', 'NDCG@5': '0.0347', 'HR@10': '0.0726', 'NDCG@10': '0.0420', 'HR@20': '0.1019', 'NDCG@20': '0.0494'}
2025-03-01 13:46:51,706 - EarlyStopping counter: 2 out of 10
2025-03-01 13:47:34,537 - {'epoch': 23, 'rec_loss': '7.5649'}
2025-03-01 13:47:53,380 - {'Epoch': 23, 'HR@5': '0.0494', 'NDCG@5': '0.0343', 'HR@10': '0.0726', 'NDCG@10': '0.0418', 'HR@20': '0.1011', 'NDCG@20': '0.0490'}
2025-03-01 13:47:53,381 - EarlyStopping counter: 3 out of 10
2025-03-01 13:48:37,013 - {'epoch': 24, 'rec_loss': '7.5478'}
2025-03-01 13:48:55,902 - {'Epoch': 24, 'HR@5': '0.0503', 'NDCG@5': '0.0356', 'HR@10': '0.0729', 'NDCG@10': '0.0429', 'HR@20': '0.1037', 'NDCG@20': '0.0506'}
2025-03-01 13:48:55,903 - Validation score increased.  Saving model ...
2025-03-01 13:49:36,723 - {'epoch': 25, 'rec_loss': '7.5330'}
2025-03-01 13:49:56,044 - {'Epoch': 25, 'HR@5': '0.0505', 'NDCG@5': '0.0353', 'HR@10': '0.0741', 'NDCG@10': '0.0429', 'HR@20': '0.1032', 'NDCG@20': '0.0502'}
2025-03-01 13:49:56,049 - EarlyStopping counter: 1 out of 10
2025-03-01 13:50:40,674 - {'epoch': 26, 'rec_loss': '7.5239'}
2025-03-01 13:50:59,657 - {'Epoch': 26, 'HR@5': '0.0504', 'NDCG@5': '0.0353', 'HR@10': '0.0733', 'NDCG@10': '0.0427', 'HR@20': '0.1031', 'NDCG@20': '0.0501'}
2025-03-01 13:50:59,658 - EarlyStopping counter: 2 out of 10
2025-03-01 13:51:38,736 - {'epoch': 27, 'rec_loss': '7.5102'}
2025-03-01 13:51:57,865 - {'Epoch': 27, 'HR@5': '0.0513', 'NDCG@5': '0.0356', 'HR@10': '0.0728', 'NDCG@10': '0.0425', 'HR@20': '0.1032', 'NDCG@20': '0.0501'}
2025-03-01 13:51:57,868 - EarlyStopping counter: 3 out of 10
2025-03-01 13:52:42,743 - {'epoch': 28, 'rec_loss': '7.5047'}
2025-03-01 13:53:01,766 - {'Epoch': 28, 'HR@5': '0.0512', 'NDCG@5': '0.0356', 'HR@10': '0.0739', 'NDCG@10': '0.0429', 'HR@20': '0.1041', 'NDCG@20': '0.0505'}
2025-03-01 13:53:01,767 - EarlyStopping counter: 4 out of 10
2025-03-01 13:53:41,811 - {'epoch': 29, 'rec_loss': '7.4954'}
2025-03-01 13:54:00,955 - {'Epoch': 29, 'HR@5': '0.0500', 'NDCG@5': '0.0349', 'HR@10': '0.0728', 'NDCG@10': '0.0422', 'HR@20': '0.1030', 'NDCG@20': '0.0498'}
2025-03-01 13:54:00,958 - EarlyStopping counter: 5 out of 10
2025-03-01 13:54:44,489 - {'epoch': 30, 'rec_loss': '7.4860'}
2025-03-01 13:55:03,602 - {'Epoch': 30, 'HR@5': '0.0507', 'NDCG@5': '0.0351', 'HR@10': '0.0731', 'NDCG@10': '0.0424', 'HR@20': '0.1032', 'NDCG@20': '0.0500'}
2025-03-01 13:55:03,604 - EarlyStopping counter: 6 out of 10
2025-03-01 13:55:45,259 - {'epoch': 31, 'rec_loss': '7.4706'}
2025-03-01 13:56:05,060 - {'Epoch': 31, 'HR@5': '0.0504', 'NDCG@5': '0.0349', 'HR@10': '0.0730', 'NDCG@10': '0.0422', 'HR@20': '0.1022', 'NDCG@20': '0.0496'}
2025-03-01 13:56:05,063 - EarlyStopping counter: 7 out of 10
2025-03-01 13:56:50,920 - {'epoch': 32, 'rec_loss': '7.4604'}
2025-03-01 13:57:08,908 - {'Epoch': 32, 'HR@5': '0.0505', 'NDCG@5': '0.0351', 'HR@10': '0.0735', 'NDCG@10': '0.0424', 'HR@20': '0.1024', 'NDCG@20': '0.0497'}
2025-03-01 13:57:08,909 - EarlyStopping counter: 8 out of 10
2025-03-01 13:57:50,475 - {'epoch': 33, 'rec_loss': '7.4524'}
2025-03-01 13:58:09,701 - {'Epoch': 33, 'HR@5': '0.0514', 'NDCG@5': '0.0356', 'HR@10': '0.0737', 'NDCG@10': '0.0428', 'HR@20': '0.1035', 'NDCG@20': '0.0503'}
2025-03-01 13:58:09,706 - EarlyStopping counter: 9 out of 10
2025-03-01 13:58:53,551 - {'epoch': 34, 'rec_loss': '7.4455'}
2025-03-01 13:59:12,541 - {'Epoch': 34, 'HR@5': '0.0507', 'NDCG@5': '0.0352', 'HR@10': '0.0717', 'NDCG@10': '0.0419', 'HR@20': '0.1020', 'NDCG@20': '0.0495'}
2025-03-01 13:59:12,546 - EarlyStopping counter: 10 out of 10
2025-03-01 13:59:12,546 - Early stopping
2025-03-01 13:59:12,546 - ---------------Test Score---------------
2025-03-01 13:59:31,390 - {'Epoch': 0, 'HR@5': '0.0427', 'NDCG@5': '0.0296', 'HR@10': '0.0617', 'NDCG@10': '0.0358', 'HR@20': '0.0870', 'NDCG@20': '0.0421'}
2025-03-01 13:59:31,392 - Scale_Sports
2025-03-01 13:59:31,392 - {'Epoch': 0, 'HR@5': '0.0427', 'NDCG@5': '0.0296', 'HR@10': '0.0617', 'NDCG@10': '0.0358', 'HR@20': '0.0870', 'NDCG@20': '0.0421'}
2025-03-01 14:02:48,821 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.2, end_prob=0.5, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-01 14:02:52,007 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-01 14:02:52,012 - Total Parameters: 1328854
2025-03-01 14:03:36,279 - {'epoch': 0, 'rec_loss': '9.4008'}
2025-03-01 14:03:55,178 - {'Epoch': 0, 'HR@5': '0.0083', 'NDCG@5': '0.0055', 'HR@10': '0.0128', 'NDCG@10': '0.0069', 'HR@20': '0.0227', 'NDCG@20': '0.0094'}
2025-03-01 14:03:55,180 - Validation score increased.  Saving model ...
2025-03-01 14:04:41,181 - {'epoch': 1, 'rec_loss': '9.1334'}
2025-03-01 14:05:00,192 - {'Epoch': 1, 'HR@5': '0.0165', 'NDCG@5': '0.0105', 'HR@10': '0.0277', 'NDCG@10': '0.0141', 'HR@20': '0.0446', 'NDCG@20': '0.0184'}
2025-03-01 14:05:00,193 - Validation score increased.  Saving model ...
2025-03-01 14:05:42,359 - {'epoch': 2, 'rec_loss': '8.8491'}
2025-03-01 14:06:00,524 - {'Epoch': 2, 'HR@5': '0.0210', 'NDCG@5': '0.0137', 'HR@10': '0.0348', 'NDCG@10': '0.0181', 'HR@20': '0.0541', 'NDCG@20': '0.0230'}
2025-03-01 14:06:00,525 - Validation score increased.  Saving model ...
2025-03-01 14:06:43,999 - {'epoch': 3, 'rec_loss': '8.6435'}
2025-03-01 14:07:02,100 - {'Epoch': 3, 'HR@5': '0.0306', 'NDCG@5': '0.0202', 'HR@10': '0.0457', 'NDCG@10': '0.0250', 'HR@20': '0.0693', 'NDCG@20': '0.0309'}
2025-03-01 14:07:02,101 - Validation score increased.  Saving model ...
2025-03-01 14:07:43,051 - {'epoch': 4, 'rec_loss': '8.4838'}
2025-03-01 14:07:59,063 - {'Epoch': 4, 'HR@5': '0.0344', 'NDCG@5': '0.0230', 'HR@10': '0.0522', 'NDCG@10': '0.0287', 'HR@20': '0.0777', 'NDCG@20': '0.0351'}
2025-03-01 14:07:59,065 - Validation score increased.  Saving model ...
2025-03-01 14:08:38,538 - {'epoch': 5, 'rec_loss': '8.3533'}
2025-03-01 14:08:57,040 - {'Epoch': 5, 'HR@5': '0.0398', 'NDCG@5': '0.0272', 'HR@10': '0.0574', 'NDCG@10': '0.0329', 'HR@20': '0.0841', 'NDCG@20': '0.0396'}
2025-03-01 14:08:57,042 - Validation score increased.  Saving model ...
2025-03-01 14:09:36,229 - {'epoch': 6, 'rec_loss': '8.2551'}
2025-03-01 14:09:54,577 - {'Epoch': 6, 'HR@5': '0.0411', 'NDCG@5': '0.0277', 'HR@10': '0.0609', 'NDCG@10': '0.0341', 'HR@20': '0.0878', 'NDCG@20': '0.0409'}
2025-03-01 14:09:54,578 - Validation score increased.  Saving model ...
2025-03-01 14:10:35,713 - {'epoch': 7, 'rec_loss': '8.1724'}
2025-03-01 14:10:53,920 - {'Epoch': 7, 'HR@5': '0.0432', 'NDCG@5': '0.0295', 'HR@10': '0.0628', 'NDCG@10': '0.0358', 'HR@20': '0.0901', 'NDCG@20': '0.0427'}
2025-03-01 14:10:53,921 - Validation score increased.  Saving model ...
2025-03-01 14:11:31,654 - {'epoch': 8, 'rec_loss': '8.1010'}
2025-03-01 14:11:49,266 - {'Epoch': 8, 'HR@5': '0.0455', 'NDCG@5': '0.0313', 'HR@10': '0.0650', 'NDCG@10': '0.0375', 'HR@20': '0.0928', 'NDCG@20': '0.0445'}
2025-03-01 14:11:49,268 - Validation score increased.  Saving model ...
2025-03-01 14:12:31,799 - {'epoch': 9, 'rec_loss': '8.0422'}
2025-03-01 14:12:49,284 - {'Epoch': 9, 'HR@5': '0.0463', 'NDCG@5': '0.0318', 'HR@10': '0.0666', 'NDCG@10': '0.0383', 'HR@20': '0.0937', 'NDCG@20': '0.0452'}
2025-03-01 14:12:49,285 - Validation score increased.  Saving model ...
2025-03-01 14:13:31,963 - {'epoch': 10, 'rec_loss': '7.9961'}
2025-03-01 14:13:50,101 - {'Epoch': 10, 'HR@5': '0.0456', 'NDCG@5': '0.0317', 'HR@10': '0.0675', 'NDCG@10': '0.0387', 'HR@20': '0.0949', 'NDCG@20': '0.0455'}
2025-03-01 14:13:50,102 - Validation score increased.  Saving model ...
2025-03-01 14:14:30,872 - {'epoch': 11, 'rec_loss': '7.9503'}
2025-03-01 14:14:48,767 - {'Epoch': 11, 'HR@5': '0.0474', 'NDCG@5': '0.0330', 'HR@10': '0.0685', 'NDCG@10': '0.0398', 'HR@20': '0.0971', 'NDCG@20': '0.0470'}
2025-03-01 14:14:48,768 - Validation score increased.  Saving model ...
2025-03-01 14:15:27,787 - {'epoch': 12, 'rec_loss': '7.9149'}
2025-03-01 14:15:45,816 - {'Epoch': 12, 'HR@5': '0.0476', 'NDCG@5': '0.0335', 'HR@10': '0.0687', 'NDCG@10': '0.0403', 'HR@20': '0.0987', 'NDCG@20': '0.0479'}
2025-03-01 14:15:45,817 - Validation score increased.  Saving model ...
2025-03-01 14:16:26,259 - {'epoch': 13, 'rec_loss': '7.8818'}
2025-03-01 14:16:43,968 - {'Epoch': 13, 'HR@5': '0.0478', 'NDCG@5': '0.0337', 'HR@10': '0.0703', 'NDCG@10': '0.0409', 'HR@20': '0.0996', 'NDCG@20': '0.0482'}
2025-03-01 14:16:43,969 - Validation score increased.  Saving model ...
2025-03-01 14:17:21,954 - {'epoch': 14, 'rec_loss': '7.8557'}
2025-03-01 14:17:38,088 - {'Epoch': 14, 'HR@5': '0.0488', 'NDCG@5': '0.0340', 'HR@10': '0.0707', 'NDCG@10': '0.0411', 'HR@20': '0.1001', 'NDCG@20': '0.0485'}
2025-03-01 14:17:38,089 - Validation score increased.  Saving model ...
2025-03-01 14:18:21,182 - {'epoch': 15, 'rec_loss': '7.8304'}
2025-03-01 14:18:37,182 - {'Epoch': 15, 'HR@5': '0.0491', 'NDCG@5': '0.0342', 'HR@10': '0.0702', 'NDCG@10': '0.0409', 'HR@20': '0.0999', 'NDCG@20': '0.0484'}
2025-03-01 14:18:37,184 - EarlyStopping counter: 1 out of 10
2025-03-01 14:19:17,081 - {'epoch': 16, 'rec_loss': '7.8083'}
2025-03-01 14:19:33,451 - {'Epoch': 16, 'HR@5': '0.0491', 'NDCG@5': '0.0342', 'HR@10': '0.0705', 'NDCG@10': '0.0412', 'HR@20': '0.1006', 'NDCG@20': '0.0487'}
2025-03-01 14:19:33,452 - Validation score increased.  Saving model ...
2025-03-01 14:20:15,706 - {'epoch': 17, 'rec_loss': '7.7864'}
2025-03-01 14:20:31,645 - {'Epoch': 17, 'HR@5': '0.0488', 'NDCG@5': '0.0344', 'HR@10': '0.0708', 'NDCG@10': '0.0415', 'HR@20': '0.1010', 'NDCG@20': '0.0490'}
2025-03-01 14:20:31,646 - Validation score increased.  Saving model ...
2025-03-01 14:21:12,329 - {'epoch': 18, 'rec_loss': '7.7661'}
2025-03-01 14:21:29,497 - {'Epoch': 18, 'HR@5': '0.0495', 'NDCG@5': '0.0344', 'HR@10': '0.0711', 'NDCG@10': '0.0414', 'HR@20': '0.1003', 'NDCG@20': '0.0487'}
2025-03-01 14:21:29,498 - EarlyStopping counter: 1 out of 10
2025-03-01 14:22:10,366 - {'epoch': 19, 'rec_loss': '7.7465'}
2025-03-01 14:22:26,322 - {'Epoch': 19, 'HR@5': '0.0506', 'NDCG@5': '0.0353', 'HR@10': '0.0711', 'NDCG@10': '0.0419', 'HR@20': '0.1023', 'NDCG@20': '0.0497'}
2025-03-01 14:22:26,323 - Validation score increased.  Saving model ...
2025-03-01 14:23:06,901 - {'epoch': 20, 'rec_loss': '7.7350'}
2025-03-01 14:23:22,507 - {'Epoch': 20, 'HR@5': '0.0509', 'NDCG@5': '0.0356', 'HR@10': '0.0737', 'NDCG@10': '0.0430', 'HR@20': '0.1037', 'NDCG@20': '0.0505'}
2025-03-01 14:23:22,508 - Validation score increased.  Saving model ...
2025-03-01 14:24:03,184 - {'epoch': 21, 'rec_loss': '7.7119'}
2025-03-01 14:24:19,345 - {'Epoch': 21, 'HR@5': '0.0496', 'NDCG@5': '0.0343', 'HR@10': '0.0708', 'NDCG@10': '0.0411', 'HR@20': '0.1012', 'NDCG@20': '0.0488'}
2025-03-01 14:24:19,346 - EarlyStopping counter: 1 out of 10
2025-03-01 14:25:00,562 - {'epoch': 22, 'rec_loss': '7.7013'}
2025-03-01 14:25:18,663 - {'Epoch': 22, 'HR@5': '0.0506', 'NDCG@5': '0.0352', 'HR@10': '0.0732', 'NDCG@10': '0.0424', 'HR@20': '0.1027', 'NDCG@20': '0.0498'}
2025-03-01 14:25:18,664 - EarlyStopping counter: 2 out of 10
2025-03-01 14:25:59,643 - {'epoch': 23, 'rec_loss': '7.6863'}
2025-03-01 14:26:17,217 - {'Epoch': 23, 'HR@5': '0.0506', 'NDCG@5': '0.0350', 'HR@10': '0.0728', 'NDCG@10': '0.0421', 'HR@20': '0.1021', 'NDCG@20': '0.0495'}
2025-03-01 14:26:17,218 - EarlyStopping counter: 3 out of 10
2025-03-01 14:26:56,671 - {'epoch': 24, 'rec_loss': '7.6679'}
2025-03-01 14:27:14,123 - {'Epoch': 24, 'HR@5': '0.0512', 'NDCG@5': '0.0357', 'HR@10': '0.0732', 'NDCG@10': '0.0428', 'HR@20': '0.1031', 'NDCG@20': '0.0503'}
2025-03-01 14:27:14,124 - EarlyStopping counter: 4 out of 10
2025-03-01 14:27:53,991 - {'epoch': 25, 'rec_loss': '7.6544'}
2025-03-01 14:28:13,930 - {'Epoch': 25, 'HR@5': '0.0508', 'NDCG@5': '0.0351', 'HR@10': '0.0739', 'NDCG@10': '0.0425', 'HR@20': '0.1041', 'NDCG@20': '0.0502'}
2025-03-01 14:28:13,931 - EarlyStopping counter: 5 out of 10
2025-03-01 14:28:55,154 - {'epoch': 26, 'rec_loss': '7.6459'}
2025-03-01 14:29:13,883 - {'Epoch': 26, 'HR@5': '0.0521', 'NDCG@5': '0.0361', 'HR@10': '0.0736', 'NDCG@10': '0.0431', 'HR@20': '0.1035', 'NDCG@20': '0.0506'}
2025-03-01 14:29:13,885 - Validation score increased.  Saving model ...
2025-03-01 14:29:53,525 - {'epoch': 27, 'rec_loss': '7.6280'}
2025-03-01 14:30:10,988 - {'Epoch': 27, 'HR@5': '0.0523', 'NDCG@5': '0.0361', 'HR@10': '0.0739', 'NDCG@10': '0.0431', 'HR@20': '0.1040', 'NDCG@20': '0.0506'}
2025-03-01 14:30:10,989 - Validation score increased.  Saving model ...
2025-03-01 14:30:52,124 - {'epoch': 28, 'rec_loss': '7.6233'}
2025-03-01 14:31:09,775 - {'Epoch': 28, 'HR@5': '0.0515', 'NDCG@5': '0.0359', 'HR@10': '0.0748', 'NDCG@10': '0.0434', 'HR@20': '0.1040', 'NDCG@20': '0.0508'}
2025-03-01 14:31:09,776 - Validation score increased.  Saving model ...
2025-03-01 14:31:51,106 - {'epoch': 29, 'rec_loss': '7.6142'}
2025-03-01 14:32:08,691 - {'Epoch': 29, 'HR@5': '0.0516', 'NDCG@5': '0.0356', 'HR@10': '0.0747', 'NDCG@10': '0.0430', 'HR@20': '0.1059', 'NDCG@20': '0.0509'}
2025-03-01 14:32:08,693 - Validation score increased.  Saving model ...
2025-03-01 14:32:51,394 - {'epoch': 30, 'rec_loss': '7.6038'}
2025-03-01 14:33:09,659 - {'Epoch': 30, 'HR@5': '0.0516', 'NDCG@5': '0.0356', 'HR@10': '0.0739', 'NDCG@10': '0.0428', 'HR@20': '0.1045', 'NDCG@20': '0.0505'}
2025-03-01 14:33:09,660 - EarlyStopping counter: 1 out of 10
2025-03-01 14:33:51,746 - {'epoch': 31, 'rec_loss': '7.5892'}
2025-03-01 14:34:10,120 - {'Epoch': 31, 'HR@5': '0.0508', 'NDCG@5': '0.0353', 'HR@10': '0.0736', 'NDCG@10': '0.0426', 'HR@20': '0.1055', 'NDCG@20': '0.0507'}
2025-03-01 14:34:10,122 - EarlyStopping counter: 2 out of 10
2025-03-01 14:34:53,498 - {'epoch': 32, 'rec_loss': '7.5802'}
2025-03-01 14:35:11,999 - {'Epoch': 32, 'HR@5': '0.0516', 'NDCG@5': '0.0356', 'HR@10': '0.0745', 'NDCG@10': '0.0429', 'HR@20': '0.1058', 'NDCG@20': '0.0508'}
2025-03-01 14:35:12,001 - EarlyStopping counter: 3 out of 10
2025-03-01 14:35:52,563 - {'epoch': 33, 'rec_loss': '7.5702'}
2025-03-01 14:36:10,594 - {'Epoch': 33, 'HR@5': '0.0516', 'NDCG@5': '0.0364', 'HR@10': '0.0750', 'NDCG@10': '0.0439', 'HR@20': '0.1053', 'NDCG@20': '0.0516'}
2025-03-01 14:36:10,595 - Validation score increased.  Saving model ...
2025-03-01 14:36:50,580 - {'epoch': 34, 'rec_loss': '7.5680'}
2025-03-01 14:37:09,615 - {'Epoch': 34, 'HR@5': '0.0513', 'NDCG@5': '0.0358', 'HR@10': '0.0741', 'NDCG@10': '0.0431', 'HR@20': '0.1048', 'NDCG@20': '0.0508'}
2025-03-01 14:37:09,617 - EarlyStopping counter: 1 out of 10
2025-03-01 14:37:52,609 - {'epoch': 35, 'rec_loss': '7.5564'}
2025-03-01 14:38:11,996 - {'Epoch': 35, 'HR@5': '0.0520', 'NDCG@5': '0.0364', 'HR@10': '0.0757', 'NDCG@10': '0.0440', 'HR@20': '0.1050', 'NDCG@20': '0.0514'}
2025-03-01 14:38:11,998 - EarlyStopping counter: 2 out of 10
2025-03-01 14:38:53,357 - {'epoch': 36, 'rec_loss': '7.5543'}
2025-03-01 14:39:12,315 - {'Epoch': 36, 'HR@5': '0.0512', 'NDCG@5': '0.0359', 'HR@10': '0.0742', 'NDCG@10': '0.0433', 'HR@20': '0.1051', 'NDCG@20': '0.0511'}
2025-03-01 14:39:12,316 - EarlyStopping counter: 3 out of 10
2025-03-01 14:39:51,053 - {'epoch': 37, 'rec_loss': '7.5434'}
2025-03-01 14:40:08,787 - {'Epoch': 37, 'HR@5': '0.0516', 'NDCG@5': '0.0359', 'HR@10': '0.0744', 'NDCG@10': '0.0432', 'HR@20': '0.1046', 'NDCG@20': '0.0509'}
2025-03-01 14:40:08,788 - EarlyStopping counter: 4 out of 10
2025-03-01 14:40:48,915 - {'epoch': 38, 'rec_loss': '7.5310'}
2025-03-01 14:41:06,925 - {'Epoch': 38, 'HR@5': '0.0524', 'NDCG@5': '0.0366', 'HR@10': '0.0758', 'NDCG@10': '0.0442', 'HR@20': '0.1068', 'NDCG@20': '0.0520'}
2025-03-01 14:41:06,926 - Validation score increased.  Saving model ...
2025-03-01 14:41:49,725 - {'epoch': 39, 'rec_loss': '7.5261'}
2025-03-01 14:42:07,709 - {'Epoch': 39, 'HR@5': '0.0515', 'NDCG@5': '0.0360', 'HR@10': '0.0742', 'NDCG@10': '0.0433', 'HR@20': '0.1050', 'NDCG@20': '0.0511'}
2025-03-01 14:42:07,710 - EarlyStopping counter: 1 out of 10
2025-03-01 14:42:47,758 - {'epoch': 40, 'rec_loss': '7.5213'}
2025-03-01 14:43:06,898 - {'Epoch': 40, 'HR@5': '0.0517', 'NDCG@5': '0.0362', 'HR@10': '0.0746', 'NDCG@10': '0.0436', 'HR@20': '0.1053', 'NDCG@20': '0.0513'}
2025-03-01 14:43:06,899 - EarlyStopping counter: 2 out of 10
2025-03-01 14:43:45,818 - {'epoch': 41, 'rec_loss': '7.5123'}
2025-03-01 14:44:03,908 - {'Epoch': 41, 'HR@5': '0.0516', 'NDCG@5': '0.0361', 'HR@10': '0.0739', 'NDCG@10': '0.0432', 'HR@20': '0.1053', 'NDCG@20': '0.0511'}
2025-03-01 14:44:03,909 - EarlyStopping counter: 3 out of 10
2025-03-01 14:44:42,667 - {'epoch': 42, 'rec_loss': '7.5049'}
2025-03-01 14:45:00,540 - {'Epoch': 42, 'HR@5': '0.0515', 'NDCG@5': '0.0361', 'HR@10': '0.0744', 'NDCG@10': '0.0435', 'HR@20': '0.1055', 'NDCG@20': '0.0513'}
2025-03-01 14:45:00,541 - EarlyStopping counter: 4 out of 10
2025-03-01 14:45:40,619 - {'epoch': 43, 'rec_loss': '7.5048'}
2025-03-01 14:45:57,256 - {'Epoch': 43, 'HR@5': '0.0516', 'NDCG@5': '0.0359', 'HR@10': '0.0753', 'NDCG@10': '0.0435', 'HR@20': '0.1058', 'NDCG@20': '0.0512'}
2025-03-01 14:45:57,257 - EarlyStopping counter: 5 out of 10
2025-03-01 14:46:37,512 - {'epoch': 44, 'rec_loss': '7.4941'}
2025-03-01 14:46:53,762 - {'Epoch': 44, 'HR@5': '0.0528', 'NDCG@5': '0.0366', 'HR@10': '0.0759', 'NDCG@10': '0.0440', 'HR@20': '0.1074', 'NDCG@20': '0.0519'}
2025-03-01 14:46:53,764 - EarlyStopping counter: 6 out of 10
2025-03-01 14:47:34,026 - {'epoch': 45, 'rec_loss': '7.4959'}
2025-03-01 14:47:50,606 - {'Epoch': 45, 'HR@5': '0.0522', 'NDCG@5': '0.0363', 'HR@10': '0.0760', 'NDCG@10': '0.0439', 'HR@20': '0.1056', 'NDCG@20': '0.0514'}
2025-03-01 14:47:50,607 - EarlyStopping counter: 7 out of 10
2025-03-01 14:48:31,282 - {'epoch': 46, 'rec_loss': '7.4918'}
2025-03-01 14:48:47,112 - {'Epoch': 46, 'HR@5': '0.0517', 'NDCG@5': '0.0361', 'HR@10': '0.0749', 'NDCG@10': '0.0436', 'HR@20': '0.1056', 'NDCG@20': '0.0513'}
2025-03-01 14:48:47,113 - EarlyStopping counter: 8 out of 10
2025-03-01 14:49:29,733 - {'epoch': 47, 'rec_loss': '7.4856'}
2025-03-01 14:49:45,950 - {'Epoch': 47, 'HR@5': '0.0517', 'NDCG@5': '0.0361', 'HR@10': '0.0749', 'NDCG@10': '0.0435', 'HR@20': '0.1044', 'NDCG@20': '0.0509'}
2025-03-01 14:49:45,951 - EarlyStopping counter: 9 out of 10
2025-03-01 14:50:26,264 - {'epoch': 48, 'rec_loss': '7.4798'}
2025-03-01 14:50:42,477 - {'Epoch': 48, 'HR@5': '0.0519', 'NDCG@5': '0.0360', 'HR@10': '0.0745', 'NDCG@10': '0.0433', 'HR@20': '0.1054', 'NDCG@20': '0.0511'}
2025-03-01 14:50:42,478 - EarlyStopping counter: 10 out of 10
2025-03-01 14:50:42,478 - Early stopping
2025-03-01 14:50:42,478 - ---------------Test Score---------------
2025-03-01 14:50:58,763 - {'Epoch': 0, 'HR@5': '0.0425', 'NDCG@5': '0.0297', 'HR@10': '0.0626', 'NDCG@10': '0.0362', 'HR@20': '0.0881', 'NDCG@20': '0.0426'}
2025-03-01 14:50:58,764 - Scale_Sports
2025-03-01 14:50:58,764 - {'Epoch': 0, 'HR@5': '0.0425', 'NDCG@5': '0.0297', 'HR@10': '0.0626', 'NDCG@10': '0.0362', 'HR@20': '0.0881', 'NDCG@20': '0.0426'}
2025-03-01 14:56:33,664 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.4, end_prob=0.7, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-01 14:56:36,547 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-01 14:56:36,552 - Total Parameters: 1328854
2025-03-01 14:57:15,180 - {'epoch': 0, 'rec_loss': '9.4024'}
2025-03-01 14:57:31,447 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0053', 'HR@10': '0.0131', 'NDCG@10': '0.0069', 'HR@20': '0.0218', 'NDCG@20': '0.0091'}
2025-03-01 14:57:31,451 - Validation score increased.  Saving model ...
2025-03-01 14:58:09,267 - {'epoch': 1, 'rec_loss': '9.2293'}
2025-03-01 14:58:25,023 - {'Epoch': 1, 'HR@5': '0.0121', 'NDCG@5': '0.0077', 'HR@10': '0.0204', 'NDCG@10': '0.0104', 'HR@20': '0.0349', 'NDCG@20': '0.0141'}
2025-03-01 14:58:25,024 - Validation score increased.  Saving model ...
2025-03-01 14:59:04,921 - {'epoch': 2, 'rec_loss': '9.0083'}
2025-03-01 14:59:20,585 - {'Epoch': 2, 'HR@5': '0.0174', 'NDCG@5': '0.0113', 'HR@10': '0.0270', 'NDCG@10': '0.0144', 'HR@20': '0.0455', 'NDCG@20': '0.0191'}
2025-03-01 14:59:20,586 - Validation score increased.  Saving model ...
2025-03-01 15:00:01,199 - {'epoch': 3, 'rec_loss': '8.8461'}
2025-03-01 15:00:17,106 - {'Epoch': 3, 'HR@5': '0.0220', 'NDCG@5': '0.0139', 'HR@10': '0.0344', 'NDCG@10': '0.0179', 'HR@20': '0.0534', 'NDCG@20': '0.0227'}
2025-03-01 15:00:17,108 - Validation score increased.  Saving model ...
2025-03-01 15:00:59,109 - {'epoch': 4, 'rec_loss': '8.7188'}
2025-03-01 15:01:15,589 - {'Epoch': 4, 'HR@5': '0.0254', 'NDCG@5': '0.0164', 'HR@10': '0.0405', 'NDCG@10': '0.0213', 'HR@20': '0.0633', 'NDCG@20': '0.0270'}
2025-03-01 15:01:15,590 - Validation score increased.  Saving model ...
2025-03-01 15:01:55,806 - {'epoch': 5, 'rec_loss': '8.6061'}
2025-03-01 15:02:11,972 - {'Epoch': 5, 'HR@5': '0.0305', 'NDCG@5': '0.0201', 'HR@10': '0.0474', 'NDCG@10': '0.0255', 'HR@20': '0.0706', 'NDCG@20': '0.0313'}
2025-03-01 15:02:11,974 - Validation score increased.  Saving model ...
2025-03-01 15:02:51,523 - {'epoch': 6, 'rec_loss': '8.5245'}
2025-03-01 15:03:07,556 - {'Epoch': 6, 'HR@5': '0.0335', 'NDCG@5': '0.0222', 'HR@10': '0.0502', 'NDCG@10': '0.0276', 'HR@20': '0.0751', 'NDCG@20': '0.0339'}
2025-03-01 15:03:07,562 - Validation score increased.  Saving model ...
2025-03-01 15:03:45,920 - {'epoch': 7, 'rec_loss': '8.4483'}
2025-03-01 15:04:02,574 - {'Epoch': 7, 'HR@5': '0.0362', 'NDCG@5': '0.0239', 'HR@10': '0.0538', 'NDCG@10': '0.0295', 'HR@20': '0.0793', 'NDCG@20': '0.0359'}
2025-03-01 15:04:02,575 - Validation score increased.  Saving model ...
2025-03-01 15:04:42,330 - {'epoch': 8, 'rec_loss': '8.3879'}
2025-03-01 15:04:58,836 - {'Epoch': 8, 'HR@5': '0.0380', 'NDCG@5': '0.0258', 'HR@10': '0.0562', 'NDCG@10': '0.0317', 'HR@20': '0.0818', 'NDCG@20': '0.0381'}
2025-03-01 15:04:58,843 - Validation score increased.  Saving model ...
2025-03-01 15:05:38,788 - {'epoch': 9, 'rec_loss': '8.3325'}
2025-03-01 15:05:54,829 - {'Epoch': 9, 'HR@5': '0.0397', 'NDCG@5': '0.0268', 'HR@10': '0.0592', 'NDCG@10': '0.0330', 'HR@20': '0.0858', 'NDCG@20': '0.0397'}
2025-03-01 15:05:54,830 - Validation score increased.  Saving model ...
2025-03-01 15:06:34,763 - {'epoch': 10, 'rec_loss': '8.2880'}
2025-03-01 15:06:51,993 - {'Epoch': 10, 'HR@5': '0.0411', 'NDCG@5': '0.0282', 'HR@10': '0.0592', 'NDCG@10': '0.0340', 'HR@20': '0.0869', 'NDCG@20': '0.0410'}
2025-03-01 15:06:51,996 - Validation score increased.  Saving model ...
2025-03-01 15:07:33,129 - {'epoch': 11, 'rec_loss': '8.2457'}
2025-03-01 15:07:50,260 - {'Epoch': 11, 'HR@5': '0.0422', 'NDCG@5': '0.0290', 'HR@10': '0.0626', 'NDCG@10': '0.0355', 'HR@20': '0.0900', 'NDCG@20': '0.0424'}
2025-03-01 15:07:50,262 - Validation score increased.  Saving model ...
2025-03-01 15:08:30,175 - {'epoch': 12, 'rec_loss': '8.2101'}
2025-03-01 15:08:46,544 - {'Epoch': 12, 'HR@5': '0.0442', 'NDCG@5': '0.0305', 'HR@10': '0.0636', 'NDCG@10': '0.0367', 'HR@20': '0.0914', 'NDCG@20': '0.0437'}
2025-03-01 15:08:46,546 - Validation score increased.  Saving model ...
2025-03-01 15:09:27,483 - {'epoch': 13, 'rec_loss': '8.1786'}
2025-03-01 15:09:43,718 - {'Epoch': 13, 'HR@5': '0.0449', 'NDCG@5': '0.0309', 'HR@10': '0.0641', 'NDCG@10': '0.0371', 'HR@20': '0.0949', 'NDCG@20': '0.0448'}
2025-03-01 15:09:43,719 - Validation score increased.  Saving model ...
2025-03-01 15:10:23,415 - {'epoch': 14, 'rec_loss': '8.1552'}
2025-03-01 15:10:41,841 - {'Epoch': 14, 'HR@5': '0.0458', 'NDCG@5': '0.0315', 'HR@10': '0.0671', 'NDCG@10': '0.0383', 'HR@20': '0.0951', 'NDCG@20': '0.0454'}
2025-03-01 15:10:41,844 - Validation score increased.  Saving model ...
2025-03-01 15:11:22,475 - {'epoch': 15, 'rec_loss': '8.1268'}
2025-03-01 15:11:38,821 - {'Epoch': 15, 'HR@5': '0.0460', 'NDCG@5': '0.0319', 'HR@10': '0.0672', 'NDCG@10': '0.0387', 'HR@20': '0.0951', 'NDCG@20': '0.0457'}
2025-03-01 15:11:38,825 - Validation score increased.  Saving model ...
2025-03-01 15:12:18,706 - {'epoch': 16, 'rec_loss': '8.1051'}
2025-03-01 15:12:35,412 - {'Epoch': 16, 'HR@5': '0.0468', 'NDCG@5': '0.0323', 'HR@10': '0.0664', 'NDCG@10': '0.0387', 'HR@20': '0.0967', 'NDCG@20': '0.0463'}
2025-03-01 15:12:35,413 - Validation score increased.  Saving model ...
2025-03-01 15:13:15,029 - {'epoch': 17, 'rec_loss': '8.0834'}
2025-03-01 15:13:32,376 - {'Epoch': 17, 'HR@5': '0.0475', 'NDCG@5': '0.0327', 'HR@10': '0.0676', 'NDCG@10': '0.0392', 'HR@20': '0.0974', 'NDCG@20': '0.0466'}
2025-03-01 15:13:32,383 - Validation score increased.  Saving model ...
2025-03-01 15:14:10,586 - {'epoch': 18, 'rec_loss': '8.0658'}
2025-03-01 15:14:28,031 - {'Epoch': 18, 'HR@5': '0.0472', 'NDCG@5': '0.0333', 'HR@10': '0.0690', 'NDCG@10': '0.0403', 'HR@20': '0.0987', 'NDCG@20': '0.0478'}
2025-03-01 15:14:28,032 - Validation score increased.  Saving model ...
2025-03-01 15:15:05,159 - {'epoch': 19, 'rec_loss': '8.0439'}
2025-03-01 15:15:22,139 - {'Epoch': 19, 'HR@5': '0.0473', 'NDCG@5': '0.0332', 'HR@10': '0.0683', 'NDCG@10': '0.0400', 'HR@20': '0.0979', 'NDCG@20': '0.0474'}
2025-03-01 15:15:22,140 - EarlyStopping counter: 1 out of 10
2025-03-01 15:15:59,321 - {'epoch': 20, 'rec_loss': '8.0264'}
2025-03-01 15:16:16,072 - {'Epoch': 20, 'HR@5': '0.0502', 'NDCG@5': '0.0344', 'HR@10': '0.0707', 'NDCG@10': '0.0410', 'HR@20': '0.1011', 'NDCG@20': '0.0486'}
2025-03-01 15:16:16,073 - Validation score increased.  Saving model ...
2025-03-01 15:16:53,332 - {'epoch': 21, 'rec_loss': '8.0087'}
2025-03-01 15:17:12,385 - {'Epoch': 21, 'HR@5': '0.0485', 'NDCG@5': '0.0336', 'HR@10': '0.0703', 'NDCG@10': '0.0406', 'HR@20': '0.1008', 'NDCG@20': '0.0482'}
2025-03-01 15:17:12,386 - EarlyStopping counter: 1 out of 10
2025-03-01 15:17:49,680 - {'epoch': 22, 'rec_loss': '7.9955'}
2025-03-01 15:18:06,571 - {'Epoch': 22, 'HR@5': '0.0483', 'NDCG@5': '0.0336', 'HR@10': '0.0705', 'NDCG@10': '0.0408', 'HR@20': '0.1012', 'NDCG@20': '0.0485'}
2025-03-01 15:18:06,572 - EarlyStopping counter: 2 out of 10
2025-03-01 15:18:44,069 - {'epoch': 23, 'rec_loss': '7.9809'}
2025-03-01 15:19:03,004 - {'Epoch': 23, 'HR@5': '0.0485', 'NDCG@5': '0.0336', 'HR@10': '0.0711', 'NDCG@10': '0.0408', 'HR@20': '0.1012', 'NDCG@20': '0.0484'}
2025-03-01 15:19:03,007 - EarlyStopping counter: 3 out of 10
2025-03-01 15:19:40,398 - {'epoch': 24, 'rec_loss': '7.9663'}
2025-03-01 15:19:59,214 - {'Epoch': 24, 'HR@5': '0.0500', 'NDCG@5': '0.0342', 'HR@10': '0.0717', 'NDCG@10': '0.0412', 'HR@20': '0.1021', 'NDCG@20': '0.0488'}
2025-03-01 15:19:59,219 - Validation score increased.  Saving model ...
2025-03-01 15:20:36,920 - {'epoch': 25, 'rec_loss': '7.9535'}
2025-03-01 15:20:55,181 - {'Epoch': 25, 'HR@5': '0.0505', 'NDCG@5': '0.0347', 'HR@10': '0.0726', 'NDCG@10': '0.0418', 'HR@20': '0.1031', 'NDCG@20': '0.0495'}
2025-03-01 15:20:55,184 - Validation score increased.  Saving model ...
2025-03-01 15:21:32,996 - {'epoch': 26, 'rec_loss': '7.9445'}
2025-03-01 15:21:50,530 - {'Epoch': 26, 'HR@5': '0.0507', 'NDCG@5': '0.0355', 'HR@10': '0.0726', 'NDCG@10': '0.0425', 'HR@20': '0.1030', 'NDCG@20': '0.0502'}
2025-03-01 15:21:50,536 - Validation score increased.  Saving model ...
2025-03-01 15:22:27,791 - {'epoch': 27, 'rec_loss': '7.9303'}
2025-03-01 15:22:45,630 - {'Epoch': 27, 'HR@5': '0.0499', 'NDCG@5': '0.0346', 'HR@10': '0.0732', 'NDCG@10': '0.0421', 'HR@20': '0.1025', 'NDCG@20': '0.0494'}
2025-03-01 15:22:45,631 - EarlyStopping counter: 1 out of 10
2025-03-01 15:23:22,915 - {'epoch': 28, 'rec_loss': '7.9200'}
2025-03-01 15:23:40,518 - {'Epoch': 28, 'HR@5': '0.0502', 'NDCG@5': '0.0346', 'HR@10': '0.0738', 'NDCG@10': '0.0422', 'HR@20': '0.1031', 'NDCG@20': '0.0496'}
2025-03-01 15:23:40,522 - EarlyStopping counter: 2 out of 10
2025-03-01 15:24:17,773 - {'epoch': 29, 'rec_loss': '7.9116'}
2025-03-01 15:24:34,285 - {'Epoch': 29, 'HR@5': '0.0516', 'NDCG@5': '0.0356', 'HR@10': '0.0740', 'NDCG@10': '0.0428', 'HR@20': '0.1043', 'NDCG@20': '0.0504'}
2025-03-01 15:24:34,286 - Validation score increased.  Saving model ...
2025-03-01 15:25:12,392 - {'epoch': 30, 'rec_loss': '7.9002'}
2025-03-01 15:25:29,480 - {'Epoch': 30, 'HR@5': '0.0514', 'NDCG@5': '0.0351', 'HR@10': '0.0737', 'NDCG@10': '0.0423', 'HR@20': '0.1031', 'NDCG@20': '0.0497'}
2025-03-01 15:25:29,481 - EarlyStopping counter: 1 out of 10
2025-03-01 15:26:09,616 - {'epoch': 31, 'rec_loss': '7.8924'}
2025-03-01 15:26:26,817 - {'Epoch': 31, 'HR@5': '0.0512', 'NDCG@5': '0.0353', 'HR@10': '0.0737', 'NDCG@10': '0.0425', 'HR@20': '0.1046', 'NDCG@20': '0.0503'}
2025-03-01 15:26:26,819 - EarlyStopping counter: 2 out of 10
2025-03-01 15:27:06,523 - {'epoch': 32, 'rec_loss': '7.8808'}
2025-03-01 15:27:24,926 - {'Epoch': 32, 'HR@5': '0.0513', 'NDCG@5': '0.0349', 'HR@10': '0.0746', 'NDCG@10': '0.0424', 'HR@20': '0.1048', 'NDCG@20': '0.0500'}
2025-03-01 15:27:24,927 - EarlyStopping counter: 3 out of 10
2025-03-01 15:28:03,824 - {'epoch': 33, 'rec_loss': '7.8669'}
2025-03-01 15:28:20,689 - {'Epoch': 33, 'HR@5': '0.0518', 'NDCG@5': '0.0357', 'HR@10': '0.0749', 'NDCG@10': '0.0431', 'HR@20': '0.1050', 'NDCG@20': '0.0507'}
2025-03-01 15:28:20,690 - Validation score increased.  Saving model ...
2025-03-01 15:28:57,544 - {'epoch': 34, 'rec_loss': '7.8726'}
2025-03-01 15:29:16,434 - {'Epoch': 34, 'HR@5': '0.0519', 'NDCG@5': '0.0357', 'HR@10': '0.0751', 'NDCG@10': '0.0431', 'HR@20': '0.1059', 'NDCG@20': '0.0508'}
2025-03-01 15:29:16,435 - Validation score increased.  Saving model ...
2025-03-01 15:29:53,243 - {'epoch': 35, 'rec_loss': '7.8577'}
2025-03-01 15:30:11,507 - {'Epoch': 35, 'HR@5': '0.0517', 'NDCG@5': '0.0359', 'HR@10': '0.0759', 'NDCG@10': '0.0437', 'HR@20': '0.1058', 'NDCG@20': '0.0512'}
2025-03-01 15:30:11,508 - Validation score increased.  Saving model ...
2025-03-01 15:30:49,374 - {'epoch': 36, 'rec_loss': '7.8512'}
2025-03-01 15:31:07,329 - {'Epoch': 36, 'HR@5': '0.0528', 'NDCG@5': '0.0363', 'HR@10': '0.0755', 'NDCG@10': '0.0436', 'HR@20': '0.1064', 'NDCG@20': '0.0514'}
2025-03-01 15:31:07,332 - Validation score increased.  Saving model ...
2025-03-01 15:31:44,519 - {'epoch': 37, 'rec_loss': '7.8448'}
2025-03-01 15:32:01,302 - {'Epoch': 37, 'HR@5': '0.0519', 'NDCG@5': '0.0359', 'HR@10': '0.0750', 'NDCG@10': '0.0433', 'HR@20': '0.1060', 'NDCG@20': '0.0511'}
2025-03-01 15:32:01,303 - EarlyStopping counter: 1 out of 10
2025-03-01 15:32:38,226 - {'epoch': 38, 'rec_loss': '7.8302'}
2025-03-01 15:32:54,974 - {'Epoch': 38, 'HR@5': '0.0525', 'NDCG@5': '0.0361', 'HR@10': '0.0755', 'NDCG@10': '0.0435', 'HR@20': '0.1058', 'NDCG@20': '0.0511'}
2025-03-01 15:32:54,975 - EarlyStopping counter: 2 out of 10
2025-03-01 15:33:32,239 - {'epoch': 39, 'rec_loss': '7.8308'}
2025-03-01 15:33:49,998 - {'Epoch': 39, 'HR@5': '0.0519', 'NDCG@5': '0.0361', 'HR@10': '0.0760', 'NDCG@10': '0.0439', 'HR@20': '0.1058', 'NDCG@20': '0.0514'}
2025-03-01 15:33:50,000 - EarlyStopping counter: 3 out of 10
2025-03-01 15:34:27,001 - {'epoch': 40, 'rec_loss': '7.8238'}
2025-03-01 15:34:45,365 - {'Epoch': 40, 'HR@5': '0.0529', 'NDCG@5': '0.0367', 'HR@10': '0.0758', 'NDCG@10': '0.0441', 'HR@20': '0.1052', 'NDCG@20': '0.0514'}
2025-03-01 15:34:45,369 - Validation score increased.  Saving model ...
2025-03-01 15:35:22,497 - {'epoch': 41, 'rec_loss': '7.8146'}
2025-03-01 15:35:39,173 - {'Epoch': 41, 'HR@5': '0.0531', 'NDCG@5': '0.0366', 'HR@10': '0.0758', 'NDCG@10': '0.0440', 'HR@20': '0.1059', 'NDCG@20': '0.0515'}
2025-03-01 15:35:39,175 - Validation score increased.  Saving model ...
2025-03-01 15:36:20,858 - {'epoch': 42, 'rec_loss': '7.8153'}
2025-03-01 15:36:38,193 - {'Epoch': 42, 'HR@5': '0.0527', 'NDCG@5': '0.0366', 'HR@10': '0.0751', 'NDCG@10': '0.0438', 'HR@20': '0.1055', 'NDCG@20': '0.0514'}
2025-03-01 15:36:38,195 - EarlyStopping counter: 1 out of 10
2025-03-01 15:37:17,714 - {'epoch': 43, 'rec_loss': '7.8085'}
2025-03-01 15:37:36,235 - {'Epoch': 43, 'HR@5': '0.0521', 'NDCG@5': '0.0359', 'HR@10': '0.0755', 'NDCG@10': '0.0435', 'HR@20': '0.1052', 'NDCG@20': '0.0509'}
2025-03-01 15:37:36,236 - EarlyStopping counter: 2 out of 10
2025-03-01 15:38:13,003 - {'epoch': 44, 'rec_loss': '7.8014'}
2025-03-01 15:38:30,677 - {'Epoch': 44, 'HR@5': '0.0529', 'NDCG@5': '0.0363', 'HR@10': '0.0760', 'NDCG@10': '0.0438', 'HR@20': '0.1058', 'NDCG@20': '0.0513'}
2025-03-01 15:38:30,679 - EarlyStopping counter: 3 out of 10
2025-03-01 15:39:09,574 - {'epoch': 45, 'rec_loss': '7.7995'}
2025-03-01 15:39:27,929 - {'Epoch': 45, 'HR@5': '0.0525', 'NDCG@5': '0.0362', 'HR@10': '0.0754', 'NDCG@10': '0.0436', 'HR@20': '0.1063', 'NDCG@20': '0.0513'}
2025-03-01 15:39:27,931 - EarlyStopping counter: 4 out of 10
2025-03-01 15:40:18,285 - {'epoch': 46, 'rec_loss': '7.7967'}
2025-03-01 15:40:36,325 - {'Epoch': 46, 'HR@5': '0.0526', 'NDCG@5': '0.0365', 'HR@10': '0.0763', 'NDCG@10': '0.0441', 'HR@20': '0.1070', 'NDCG@20': '0.0519'}
2025-03-01 15:40:36,327 - Validation score increased.  Saving model ...
2025-03-01 15:41:14,689 - {'epoch': 47, 'rec_loss': '7.7895'}
2025-03-01 15:41:33,103 - {'Epoch': 47, 'HR@5': '0.0531', 'NDCG@5': '0.0367', 'HR@10': '0.0763', 'NDCG@10': '0.0442', 'HR@20': '0.1064', 'NDCG@20': '0.0518'}
2025-03-01 15:41:33,104 - EarlyStopping counter: 1 out of 10
2025-03-01 15:42:14,983 - {'epoch': 48, 'rec_loss': '7.7808'}
2025-03-01 15:42:33,733 - {'Epoch': 48, 'HR@5': '0.0529', 'NDCG@5': '0.0363', 'HR@10': '0.0765', 'NDCG@10': '0.0439', 'HR@20': '0.1064', 'NDCG@20': '0.0514'}
2025-03-01 15:42:33,736 - EarlyStopping counter: 2 out of 10
2025-03-01 15:43:18,990 - {'epoch': 49, 'rec_loss': '7.7787'}
2025-03-01 15:43:36,165 - {'Epoch': 49, 'HR@5': '0.0524', 'NDCG@5': '0.0365', 'HR@10': '0.0759', 'NDCG@10': '0.0440', 'HR@20': '0.1069', 'NDCG@20': '0.0519'}
2025-03-01 15:43:36,166 - Validation score increased.  Saving model ...
2025-03-01 15:44:19,115 - {'epoch': 50, 'rec_loss': '7.7801'}
2025-03-01 15:44:37,845 - {'Epoch': 50, 'HR@5': '0.0523', 'NDCG@5': '0.0361', 'HR@10': '0.0757', 'NDCG@10': '0.0436', 'HR@20': '0.1063', 'NDCG@20': '0.0513'}
2025-03-01 15:44:37,847 - EarlyStopping counter: 1 out of 10
2025-03-01 15:45:21,105 - {'epoch': 51, 'rec_loss': '7.7722'}
2025-03-01 15:45:39,596 - {'Epoch': 51, 'HR@5': '0.0527', 'NDCG@5': '0.0363', 'HR@10': '0.0757', 'NDCG@10': '0.0437', 'HR@20': '0.1061', 'NDCG@20': '0.0514'}
2025-03-01 15:45:39,597 - EarlyStopping counter: 2 out of 10
2025-03-01 15:46:18,386 - {'epoch': 52, 'rec_loss': '7.7657'}
2025-03-01 15:46:37,060 - {'Epoch': 52, 'HR@5': '0.0523', 'NDCG@5': '0.0360', 'HR@10': '0.0755', 'NDCG@10': '0.0435', 'HR@20': '0.1069', 'NDCG@20': '0.0514'}
2025-03-01 15:46:37,062 - EarlyStopping counter: 3 out of 10
2025-03-01 15:47:16,581 - {'epoch': 53, 'rec_loss': '7.7667'}
2025-03-01 15:47:35,855 - {'Epoch': 53, 'HR@5': '0.0524', 'NDCG@5': '0.0366', 'HR@10': '0.0767', 'NDCG@10': '0.0444', 'HR@20': '0.1064', 'NDCG@20': '0.0519'}
2025-03-01 15:47:35,856 - EarlyStopping counter: 4 out of 10
2025-03-01 15:48:17,590 - {'epoch': 54, 'rec_loss': '7.7601'}
2025-03-01 15:48:36,506 - {'Epoch': 54, 'HR@5': '0.0530', 'NDCG@5': '0.0366', 'HR@10': '0.0766', 'NDCG@10': '0.0442', 'HR@20': '0.1066', 'NDCG@20': '0.0517'}
2025-03-01 15:48:36,509 - EarlyStopping counter: 5 out of 10
2025-03-01 15:49:17,926 - {'epoch': 55, 'rec_loss': '7.7564'}
2025-03-01 15:49:34,825 - {'Epoch': 55, 'HR@5': '0.0527', 'NDCG@5': '0.0364', 'HR@10': '0.0769', 'NDCG@10': '0.0442', 'HR@20': '0.1073', 'NDCG@20': '0.0519'}
2025-03-01 15:49:34,826 - Validation score increased.  Saving model ...
2025-03-01 15:50:17,617 - {'epoch': 56, 'rec_loss': '7.7549'}
2025-03-01 15:50:37,701 - {'Epoch': 56, 'HR@5': '0.0527', 'NDCG@5': '0.0364', 'HR@10': '0.0758', 'NDCG@10': '0.0438', 'HR@20': '0.1076', 'NDCG@20': '0.0518'}
2025-03-01 15:50:37,704 - EarlyStopping counter: 1 out of 10
2025-03-01 15:51:19,536 - {'epoch': 57, 'rec_loss': '7.7520'}
2025-03-01 15:51:37,929 - {'Epoch': 57, 'HR@5': '0.0521', 'NDCG@5': '0.0360', 'HR@10': '0.0756', 'NDCG@10': '0.0436', 'HR@20': '0.1061', 'NDCG@20': '0.0512'}
2025-03-01 15:51:37,930 - EarlyStopping counter: 2 out of 10
2025-03-01 15:52:21,967 - {'epoch': 58, 'rec_loss': '7.7457'}
2025-03-01 15:52:39,662 - {'Epoch': 58, 'HR@5': '0.0528', 'NDCG@5': '0.0366', 'HR@10': '0.0765', 'NDCG@10': '0.0442', 'HR@20': '0.1068', 'NDCG@20': '0.0519'}
2025-03-01 15:52:39,665 - EarlyStopping counter: 3 out of 10
2025-03-01 15:53:23,628 - {'epoch': 59, 'rec_loss': '7.7427'}
2025-03-01 15:53:40,320 - {'Epoch': 59, 'HR@5': '0.0523', 'NDCG@5': '0.0364', 'HR@10': '0.0757', 'NDCG@10': '0.0439', 'HR@20': '0.1073', 'NDCG@20': '0.0519'}
2025-03-01 15:53:40,322 - Validation score increased.  Saving model ...
2025-03-01 15:54:18,964 - {'epoch': 60, 'rec_loss': '7.7361'}
2025-03-01 15:54:36,833 - {'Epoch': 60, 'HR@5': '0.0528', 'NDCG@5': '0.0363', 'HR@10': '0.0767', 'NDCG@10': '0.0441', 'HR@20': '0.1074', 'NDCG@20': '0.0518'}
2025-03-01 15:54:36,834 - EarlyStopping counter: 1 out of 10
2025-03-01 15:55:13,982 - {'epoch': 61, 'rec_loss': '7.7345'}
2025-03-01 15:55:32,422 - {'Epoch': 61, 'HR@5': '0.0517', 'NDCG@5': '0.0360', 'HR@10': '0.0767', 'NDCG@10': '0.0440', 'HR@20': '0.1073', 'NDCG@20': '0.0517'}
2025-03-01 15:55:32,424 - EarlyStopping counter: 2 out of 10
2025-03-01 15:56:16,190 - {'epoch': 62, 'rec_loss': '7.7330'}
2025-03-01 15:56:35,219 - {'Epoch': 62, 'HR@5': '0.0537', 'NDCG@5': '0.0369', 'HR@10': '0.0772', 'NDCG@10': '0.0444', 'HR@20': '0.1074', 'NDCG@20': '0.0520'}
2025-03-01 15:56:35,220 - Validation score increased.  Saving model ...
2025-03-01 15:57:13,187 - {'epoch': 63, 'rec_loss': '7.7300'}
2025-03-01 15:57:31,688 - {'Epoch': 63, 'HR@5': '0.0527', 'NDCG@5': '0.0366', 'HR@10': '0.0773', 'NDCG@10': '0.0446', 'HR@20': '0.1066', 'NDCG@20': '0.0519'}
2025-03-01 15:57:31,691 - EarlyStopping counter: 1 out of 10
2025-03-01 15:58:30,891 - {'epoch': 64, 'rec_loss': '7.7259'}
2025-03-01 15:58:48,959 - {'Epoch': 64, 'HR@5': '0.0527', 'NDCG@5': '0.0362', 'HR@10': '0.0764', 'NDCG@10': '0.0438', 'HR@20': '0.1073', 'NDCG@20': '0.0516'}
2025-03-01 15:58:48,960 - EarlyStopping counter: 2 out of 10
2025-03-01 15:59:50,904 - {'epoch': 65, 'rec_loss': '7.7168'}
2025-03-01 16:00:11,615 - {'Epoch': 65, 'HR@5': '0.0531', 'NDCG@5': '0.0366', 'HR@10': '0.0770', 'NDCG@10': '0.0443', 'HR@20': '0.1072', 'NDCG@20': '0.0519'}
2025-03-01 16:00:11,616 - EarlyStopping counter: 3 out of 10
2025-03-01 16:01:15,319 - {'epoch': 66, 'rec_loss': '7.7142'}
2025-03-01 16:01:36,265 - {'Epoch': 66, 'HR@5': '0.0523', 'NDCG@5': '0.0364', 'HR@10': '0.0764', 'NDCG@10': '0.0441', 'HR@20': '0.1069', 'NDCG@20': '0.0518'}
2025-03-01 16:01:36,266 - EarlyStopping counter: 4 out of 10
2025-03-01 16:02:39,362 - {'epoch': 67, 'rec_loss': '7.7161'}
2025-03-01 16:02:57,218 - {'Epoch': 67, 'HR@5': '0.0528', 'NDCG@5': '0.0367', 'HR@10': '0.0768', 'NDCG@10': '0.0444', 'HR@20': '0.1074', 'NDCG@20': '0.0521'}
2025-03-01 16:02:57,219 - Validation score increased.  Saving model ...
2025-03-01 16:03:59,965 - {'epoch': 68, 'rec_loss': '7.7105'}
2025-03-01 16:04:17,807 - {'Epoch': 68, 'HR@5': '0.0531', 'NDCG@5': '0.0367', 'HR@10': '0.0774', 'NDCG@10': '0.0445', 'HR@20': '0.1078', 'NDCG@20': '0.0522'}
2025-03-01 16:04:17,808 - Validation score increased.  Saving model ...
2025-03-01 16:05:18,631 - {'epoch': 69, 'rec_loss': '7.7082'}
2025-03-01 16:05:36,440 - {'Epoch': 69, 'HR@5': '0.0521', 'NDCG@5': '0.0361', 'HR@10': '0.0774', 'NDCG@10': '0.0442', 'HR@20': '0.1076', 'NDCG@20': '0.0518'}
2025-03-01 16:05:36,441 - EarlyStopping counter: 1 out of 10
2025-03-01 16:06:27,251 - {'epoch': 70, 'rec_loss': '7.7077'}
2025-03-01 16:06:45,726 - {'Epoch': 70, 'HR@5': '0.0523', 'NDCG@5': '0.0363', 'HR@10': '0.0760', 'NDCG@10': '0.0439', 'HR@20': '0.1071', 'NDCG@20': '0.0518'}
2025-03-01 16:06:45,727 - EarlyStopping counter: 2 out of 10
2025-03-01 16:07:25,208 - {'epoch': 71, 'rec_loss': '7.7087'}
2025-03-01 16:07:43,619 - {'Epoch': 71, 'HR@5': '0.0522', 'NDCG@5': '0.0359', 'HR@10': '0.0758', 'NDCG@10': '0.0435', 'HR@20': '0.1075', 'NDCG@20': '0.0515'}
2025-03-01 16:07:43,623 - EarlyStopping counter: 3 out of 10
2025-03-01 16:08:23,508 - {'epoch': 72, 'rec_loss': '7.6992'}
2025-03-01 16:08:41,865 - {'Epoch': 72, 'HR@5': '0.0525', 'NDCG@5': '0.0362', 'HR@10': '0.0757', 'NDCG@10': '0.0437', 'HR@20': '0.1078', 'NDCG@20': '0.0517'}
2025-03-01 16:08:41,866 - EarlyStopping counter: 4 out of 10
2025-03-01 16:09:23,909 - {'epoch': 73, 'rec_loss': '7.7021'}
2025-03-01 16:09:42,554 - {'Epoch': 73, 'HR@5': '0.0526', 'NDCG@5': '0.0363', 'HR@10': '0.0760', 'NDCG@10': '0.0438', 'HR@20': '0.1072', 'NDCG@20': '0.0516'}
2025-03-01 16:09:42,555 - EarlyStopping counter: 5 out of 10
2025-03-01 16:10:23,182 - {'epoch': 74, 'rec_loss': '7.6997'}
2025-03-01 16:10:42,677 - {'Epoch': 74, 'HR@5': '0.0532', 'NDCG@5': '0.0365', 'HR@10': '0.0778', 'NDCG@10': '0.0444', 'HR@20': '0.1075', 'NDCG@20': '0.0519'}
2025-03-01 16:10:42,678 - EarlyStopping counter: 6 out of 10
2025-03-01 16:11:30,157 - {'epoch': 75, 'rec_loss': '7.6914'}
2025-03-01 16:11:48,777 - {'Epoch': 75, 'HR@5': '0.0522', 'NDCG@5': '0.0361', 'HR@10': '0.0772', 'NDCG@10': '0.0441', 'HR@20': '0.1088', 'NDCG@20': '0.0521'}
2025-03-01 16:11:48,778 - EarlyStopping counter: 7 out of 10
2025-03-01 16:12:38,955 - {'epoch': 76, 'rec_loss': '7.6885'}
2025-03-01 16:12:58,630 - {'Epoch': 76, 'HR@5': '0.0535', 'NDCG@5': '0.0366', 'HR@10': '0.0777', 'NDCG@10': '0.0444', 'HR@20': '0.1083', 'NDCG@20': '0.0521'}
2025-03-01 16:12:58,634 - EarlyStopping counter: 8 out of 10
2025-03-01 16:13:48,788 - {'epoch': 77, 'rec_loss': '7.6976'}
2025-03-01 16:14:07,614 - {'Epoch': 77, 'HR@5': '0.0529', 'NDCG@5': '0.0359', 'HR@10': '0.0766', 'NDCG@10': '0.0435', 'HR@20': '0.1081', 'NDCG@20': '0.0514'}
2025-03-01 16:14:07,615 - EarlyStopping counter: 9 out of 10
2025-03-01 16:14:54,304 - {'epoch': 78, 'rec_loss': '7.6909'}
2025-03-01 16:15:13,499 - {'Epoch': 78, 'HR@5': '0.0527', 'NDCG@5': '0.0360', 'HR@10': '0.0765', 'NDCG@10': '0.0436', 'HR@20': '0.1062', 'NDCG@20': '0.0511'}
2025-03-01 16:15:13,500 - EarlyStopping counter: 10 out of 10
2025-03-01 16:15:13,500 - Early stopping
2025-03-01 16:15:13,501 - ---------------Test Score---------------
2025-03-01 16:15:32,893 - {'Epoch': 0, 'HR@5': '0.0424', 'NDCG@5': '0.0292', 'HR@10': '0.0609', 'NDCG@10': '0.0351', 'HR@20': '0.0878', 'NDCG@20': '0.0419'}
2025-03-01 16:15:32,894 - Scale_Sports
2025-03-01 16:15:32,894 - {'Epoch': 0, 'HR@5': '0.0424', 'NDCG@5': '0.0292', 'HR@10': '0.0609', 'NDCG@10': '0.0351', 'HR@20': '0.0878', 'NDCG@20': '0.0419'}
2025-03-01 16:24:16,384 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.5, end_prob=0.8, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-01 16:24:21,034 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-01 16:24:21,064 - Total Parameters: 1328854
2025-03-01 16:25:24,377 - {'epoch': 0, 'rec_loss': '9.4040'}
2025-03-01 16:25:42,181 - {'Epoch': 0, 'HR@5': '0.0083', 'NDCG@5': '0.0054', 'HR@10': '0.0128', 'NDCG@10': '0.0069', 'HR@20': '0.0211', 'NDCG@20': '0.0090'}
2025-03-01 16:25:42,182 - Validation score increased.  Saving model ...
2025-03-01 16:26:44,173 - {'epoch': 1, 'rec_loss': '9.2750'}
2025-03-01 16:27:02,143 - {'Epoch': 1, 'HR@5': '0.0097', 'NDCG@5': '0.0063', 'HR@10': '0.0166', 'NDCG@10': '0.0085', 'HR@20': '0.0277', 'NDCG@20': '0.0112'}
2025-03-01 16:27:02,144 - Validation score increased.  Saving model ...
2025-03-01 16:28:02,283 - {'epoch': 2, 'rec_loss': '9.1222'}
2025-03-01 16:28:20,384 - {'Epoch': 2, 'HR@5': '0.0126', 'NDCG@5': '0.0080', 'HR@10': '0.0221', 'NDCG@10': '0.0111', 'HR@20': '0.0370', 'NDCG@20': '0.0148'}
2025-03-01 16:28:20,385 - Validation score increased.  Saving model ...
2025-03-01 16:29:07,254 - {'epoch': 3, 'rec_loss': '8.9698'}
2025-03-01 16:29:28,017 - {'Epoch': 3, 'HR@5': '0.0188', 'NDCG@5': '0.0118', 'HR@10': '0.0294', 'NDCG@10': '0.0152', 'HR@20': '0.0462', 'NDCG@20': '0.0194'}
2025-03-01 16:29:28,018 - Validation score increased.  Saving model ...
2025-03-01 16:30:29,228 - {'epoch': 4, 'rec_loss': '8.8667'}
2025-03-01 16:30:45,802 - {'Epoch': 4, 'HR@5': '0.0176', 'NDCG@5': '0.0117', 'HR@10': '0.0312', 'NDCG@10': '0.0161', 'HR@20': '0.0515', 'NDCG@20': '0.0212'}
2025-03-01 16:30:45,803 - Validation score increased.  Saving model ...
2025-03-01 16:31:51,659 - {'epoch': 5, 'rec_loss': '8.7737'}
2025-03-01 16:32:09,964 - {'Epoch': 5, 'HR@5': '0.0242', 'NDCG@5': '0.0156', 'HR@10': '0.0379', 'NDCG@10': '0.0200', 'HR@20': '0.0595', 'NDCG@20': '0.0255'}
2025-03-01 16:32:09,965 - Validation score increased.  Saving model ...
2025-03-01 16:33:13,852 - {'epoch': 6, 'rec_loss': '8.6953'}
2025-03-01 16:33:33,131 - {'Epoch': 6, 'HR@5': '0.0260', 'NDCG@5': '0.0173', 'HR@10': '0.0421', 'NDCG@10': '0.0224', 'HR@20': '0.0645', 'NDCG@20': '0.0281'}
2025-03-01 16:33:33,132 - Validation score increased.  Saving model ...
2025-03-01 16:34:22,231 - {'epoch': 7, 'rec_loss': '8.6234'}
2025-03-01 16:34:42,589 - {'Epoch': 7, 'HR@5': '0.0298', 'NDCG@5': '0.0194', 'HR@10': '0.0455', 'NDCG@10': '0.0244', 'HR@20': '0.0686', 'NDCG@20': '0.0302'}
2025-03-01 16:34:42,591 - Validation score increased.  Saving model ...
2025-03-01 16:35:43,680 - {'epoch': 8, 'rec_loss': '8.5646'}
2025-03-01 16:36:02,460 - {'Epoch': 8, 'HR@5': '0.0319', 'NDCG@5': '0.0210', 'HR@10': '0.0479', 'NDCG@10': '0.0261', 'HR@20': '0.0719', 'NDCG@20': '0.0322'}
2025-03-01 16:36:02,462 - Validation score increased.  Saving model ...
2025-03-01 16:37:05,837 - {'epoch': 9, 'rec_loss': '8.5124'}
2025-03-01 16:37:24,435 - {'Epoch': 9, 'HR@5': '0.0333', 'NDCG@5': '0.0218', 'HR@10': '0.0505', 'NDCG@10': '0.0274', 'HR@20': '0.0745', 'NDCG@20': '0.0334'}
2025-03-01 16:37:24,436 - Validation score increased.  Saving model ...
2025-03-01 16:38:28,936 - {'epoch': 10, 'rec_loss': '8.4710'}
2025-03-01 16:38:48,823 - {'Epoch': 10, 'HR@5': '0.0355', 'NDCG@5': '0.0237', 'HR@10': '0.0527', 'NDCG@10': '0.0292', 'HR@20': '0.0782', 'NDCG@20': '0.0356'}
2025-03-01 16:38:48,824 - Validation score increased.  Saving model ...
2025-03-01 16:39:34,960 - {'epoch': 11, 'rec_loss': '8.4285'}
2025-03-01 16:39:54,643 - {'Epoch': 11, 'HR@5': '0.0366', 'NDCG@5': '0.0244', 'HR@10': '0.0551', 'NDCG@10': '0.0303', 'HR@20': '0.0802', 'NDCG@20': '0.0367'}
2025-03-01 16:39:54,645 - Validation score increased.  Saving model ...
2025-03-01 16:40:47,864 - {'epoch': 12, 'rec_loss': '8.3999'}
2025-03-01 16:41:06,668 - {'Epoch': 12, 'HR@5': '0.0382', 'NDCG@5': '0.0254', 'HR@10': '0.0567', 'NDCG@10': '0.0314', 'HR@20': '0.0835', 'NDCG@20': '0.0381'}
2025-03-01 16:41:06,670 - Validation score increased.  Saving model ...
2025-03-01 16:42:11,122 - {'epoch': 13, 'rec_loss': '8.3652'}
2025-03-01 16:42:30,377 - {'Epoch': 13, 'HR@5': '0.0376', 'NDCG@5': '0.0253', 'HR@10': '0.0573', 'NDCG@10': '0.0316', 'HR@20': '0.0841', 'NDCG@20': '0.0384'}
2025-03-01 16:42:30,379 - Validation score increased.  Saving model ...
2025-03-01 16:43:34,344 - {'epoch': 14, 'rec_loss': '8.3406'}
2025-03-01 16:43:53,245 - {'Epoch': 14, 'HR@5': '0.0396', 'NDCG@5': '0.0266', 'HR@10': '0.0595', 'NDCG@10': '0.0331', 'HR@20': '0.0865', 'NDCG@20': '0.0398'}
2025-03-01 16:43:53,246 - Validation score increased.  Saving model ...
2025-03-01 16:44:47,876 - {'epoch': 15, 'rec_loss': '8.3165'}
2025-03-01 16:45:07,187 - {'Epoch': 15, 'HR@5': '0.0402', 'NDCG@5': '0.0272', 'HR@10': '0.0604', 'NDCG@10': '0.0337', 'HR@20': '0.0876', 'NDCG@20': '0.0406'}
2025-03-01 16:45:07,189 - Validation score increased.  Saving model ...
2025-03-01 16:45:52,827 - {'epoch': 16, 'rec_loss': '8.2974'}
2025-03-01 16:46:12,089 - {'Epoch': 16, 'HR@5': '0.0405', 'NDCG@5': '0.0274', 'HR@10': '0.0598', 'NDCG@10': '0.0336', 'HR@20': '0.0873', 'NDCG@20': '0.0405'}
2025-03-01 16:46:12,091 - EarlyStopping counter: 1 out of 10
2025-03-01 16:46:58,555 - {'epoch': 17, 'rec_loss': '8.2747'}
2025-03-01 16:47:16,440 - {'Epoch': 17, 'HR@5': '0.0412', 'NDCG@5': '0.0281', 'HR@10': '0.0612', 'NDCG@10': '0.0345', 'HR@20': '0.0894', 'NDCG@20': '0.0416'}
2025-03-01 16:47:16,442 - Validation score increased.  Saving model ...
2025-03-01 16:47:57,866 - {'epoch': 18, 'rec_loss': '8.2553'}
2025-03-01 16:48:16,127 - {'Epoch': 18, 'HR@5': '0.0433', 'NDCG@5': '0.0298', 'HR@10': '0.0633', 'NDCG@10': '0.0362', 'HR@20': '0.0924', 'NDCG@20': '0.0435'}
2025-03-01 16:48:16,128 - Validation score increased.  Saving model ...
2025-03-01 16:49:05,573 - {'epoch': 19, 'rec_loss': '8.2387'}
2025-03-01 16:49:24,514 - {'Epoch': 19, 'HR@5': '0.0429', 'NDCG@5': '0.0292', 'HR@10': '0.0641', 'NDCG@10': '0.0360', 'HR@20': '0.0918', 'NDCG@20': '0.0429'}
2025-03-01 16:49:24,516 - EarlyStopping counter: 1 out of 10
2025-03-01 16:50:17,011 - {'epoch': 20, 'rec_loss': '8.2167'}
2025-03-01 16:50:34,716 - {'Epoch': 20, 'HR@5': '0.0450', 'NDCG@5': '0.0308', 'HR@10': '0.0652', 'NDCG@10': '0.0373', 'HR@20': '0.0949', 'NDCG@20': '0.0447'}
2025-03-01 16:50:34,717 - Validation score increased.  Saving model ...
2025-03-01 16:51:28,181 - {'epoch': 21, 'rec_loss': '8.1990'}
2025-03-01 16:51:47,546 - {'Epoch': 21, 'HR@5': '0.0448', 'NDCG@5': '0.0305', 'HR@10': '0.0648', 'NDCG@10': '0.0369', 'HR@20': '0.0947', 'NDCG@20': '0.0444'}
2025-03-01 16:51:47,548 - EarlyStopping counter: 1 out of 10
2025-03-01 16:52:41,703 - {'epoch': 22, 'rec_loss': '8.1906'}
2025-03-01 16:53:00,780 - {'Epoch': 22, 'HR@5': '0.0443', 'NDCG@5': '0.0303', 'HR@10': '0.0653', 'NDCG@10': '0.0371', 'HR@20': '0.0948', 'NDCG@20': '0.0445'}
2025-03-01 16:53:00,781 - EarlyStopping counter: 2 out of 10
2025-03-01 16:53:55,242 - {'epoch': 23, 'rec_loss': '8.1724'}
2025-03-01 16:54:13,626 - {'Epoch': 23, 'HR@5': '0.0445', 'NDCG@5': '0.0304', 'HR@10': '0.0658', 'NDCG@10': '0.0373', 'HR@20': '0.0960', 'NDCG@20': '0.0449'}
2025-03-01 16:54:13,627 - Validation score increased.  Saving model ...
2025-03-01 16:55:07,680 - {'epoch': 24, 'rec_loss': '8.1614'}
2025-03-01 16:55:26,276 - {'Epoch': 24, 'HR@5': '0.0466', 'NDCG@5': '0.0317', 'HR@10': '0.0677', 'NDCG@10': '0.0385', 'HR@20': '0.0967', 'NDCG@20': '0.0457'}
2025-03-01 16:55:26,278 - Validation score increased.  Saving model ...
2025-03-01 16:56:20,603 - {'epoch': 25, 'rec_loss': '8.1419'}
2025-03-01 16:56:38,602 - {'Epoch': 25, 'HR@5': '0.0460', 'NDCG@5': '0.0314', 'HR@10': '0.0687', 'NDCG@10': '0.0387', 'HR@20': '0.0976', 'NDCG@20': '0.0459'}
2025-03-01 16:56:38,603 - Validation score increased.  Saving model ...
2025-03-01 16:57:29,728 - {'epoch': 26, 'rec_loss': '8.1374'}
2025-03-01 16:57:48,872 - {'Epoch': 26, 'HR@5': '0.0466', 'NDCG@5': '0.0322', 'HR@10': '0.0687', 'NDCG@10': '0.0393', 'HR@20': '0.0976', 'NDCG@20': '0.0465'}
2025-03-01 16:57:48,873 - Validation score increased.  Saving model ...
2025-03-01 16:58:44,144 - {'epoch': 27, 'rec_loss': '8.1272'}
2025-03-01 16:59:03,671 - {'Epoch': 27, 'HR@5': '0.0469', 'NDCG@5': '0.0320', 'HR@10': '0.0683', 'NDCG@10': '0.0389', 'HR@20': '0.0976', 'NDCG@20': '0.0462'}
2025-03-01 16:59:03,673 - EarlyStopping counter: 1 out of 10
2025-03-01 16:59:56,035 - {'epoch': 28, 'rec_loss': '8.1178'}
2025-03-01 17:00:14,513 - {'Epoch': 28, 'HR@5': '0.0472', 'NDCG@5': '0.0321', 'HR@10': '0.0677', 'NDCG@10': '0.0387', 'HR@20': '0.0982', 'NDCG@20': '0.0463'}
2025-03-01 17:00:14,515 - EarlyStopping counter: 2 out of 10
2025-03-01 17:01:09,791 - {'epoch': 29, 'rec_loss': '8.1079'}
2025-03-01 17:01:28,443 - {'Epoch': 29, 'HR@5': '0.0477', 'NDCG@5': '0.0325', 'HR@10': '0.0689', 'NDCG@10': '0.0393', 'HR@20': '0.0990', 'NDCG@20': '0.0469'}
2025-03-01 17:01:28,445 - Validation score increased.  Saving model ...
2025-03-01 17:02:21,195 - {'epoch': 30, 'rec_loss': '8.0971'}
2025-03-01 17:02:40,076 - {'Epoch': 30, 'HR@5': '0.0483', 'NDCG@5': '0.0329', 'HR@10': '0.0695', 'NDCG@10': '0.0397', 'HR@20': '0.0986', 'NDCG@20': '0.0470'}
2025-03-01 17:02:40,077 - Validation score increased.  Saving model ...
2025-03-01 17:03:31,700 - {'epoch': 31, 'rec_loss': '8.0901'}
2025-03-01 17:03:49,805 - {'Epoch': 31, 'HR@5': '0.0479', 'NDCG@5': '0.0329', 'HR@10': '0.0697', 'NDCG@10': '0.0399', 'HR@20': '0.0997', 'NDCG@20': '0.0474'}
2025-03-01 17:03:49,807 - Validation score increased.  Saving model ...
2025-03-01 17:04:43,848 - {'epoch': 32, 'rec_loss': '8.0790'}
2025-03-01 17:05:03,128 - {'Epoch': 32, 'HR@5': '0.0483', 'NDCG@5': '0.0330', 'HR@10': '0.0701', 'NDCG@10': '0.0401', 'HR@20': '0.1000', 'NDCG@20': '0.0476'}
2025-03-01 17:05:03,130 - Validation score increased.  Saving model ...
2025-03-01 17:05:55,388 - {'epoch': 33, 'rec_loss': '8.0702'}
2025-03-01 17:06:13,522 - {'Epoch': 33, 'HR@5': '0.0491', 'NDCG@5': '0.0338', 'HR@10': '0.0706', 'NDCG@10': '0.0407', 'HR@20': '0.1006', 'NDCG@20': '0.0483'}
2025-03-01 17:06:13,523 - Validation score increased.  Saving model ...
2025-03-01 17:07:04,459 - {'epoch': 34, 'rec_loss': '8.0708'}
2025-03-01 17:07:24,118 - {'Epoch': 34, 'HR@5': '0.0483', 'NDCG@5': '0.0330', 'HR@10': '0.0707', 'NDCG@10': '0.0402', 'HR@20': '0.1002', 'NDCG@20': '0.0476'}
2025-03-01 17:07:24,119 - EarlyStopping counter: 1 out of 10
2025-03-01 17:08:16,984 - {'epoch': 35, 'rec_loss': '8.0534'}
2025-03-01 17:08:36,028 - {'Epoch': 35, 'HR@5': '0.0489', 'NDCG@5': '0.0338', 'HR@10': '0.0706', 'NDCG@10': '0.0407', 'HR@20': '0.1007', 'NDCG@20': '0.0483'}
2025-03-01 17:08:36,029 - Validation score increased.  Saving model ...
2025-03-01 17:09:29,411 - {'epoch': 36, 'rec_loss': '8.0489'}
2025-03-01 17:09:48,753 - {'Epoch': 36, 'HR@5': '0.0501', 'NDCG@5': '0.0346', 'HR@10': '0.0717', 'NDCG@10': '0.0416', 'HR@20': '0.1025', 'NDCG@20': '0.0493'}
2025-03-01 17:09:48,754 - Validation score increased.  Saving model ...
2025-03-01 17:10:42,531 - {'epoch': 37, 'rec_loss': '8.0424'}
2025-03-01 17:11:01,377 - {'Epoch': 37, 'HR@5': '0.0491', 'NDCG@5': '0.0336', 'HR@10': '0.0711', 'NDCG@10': '0.0407', 'HR@20': '0.1026', 'NDCG@20': '0.0486'}
2025-03-01 17:11:01,378 - EarlyStopping counter: 1 out of 10
2025-03-01 17:11:53,747 - {'epoch': 38, 'rec_loss': '8.0289'}
2025-03-01 17:12:13,551 - {'Epoch': 38, 'HR@5': '0.0496', 'NDCG@5': '0.0339', 'HR@10': '0.0720', 'NDCG@10': '0.0411', 'HR@20': '0.1028', 'NDCG@20': '0.0489'}
2025-03-01 17:12:13,552 - EarlyStopping counter: 2 out of 10
2025-03-01 17:13:05,859 - {'epoch': 39, 'rec_loss': '8.0329'}
2025-03-01 17:13:23,865 - {'Epoch': 39, 'HR@5': '0.0496', 'NDCG@5': '0.0341', 'HR@10': '0.0724', 'NDCG@10': '0.0414', 'HR@20': '0.1034', 'NDCG@20': '0.0492'}
2025-03-01 17:13:23,866 - EarlyStopping counter: 3 out of 10
2025-03-01 17:14:17,252 - {'epoch': 40, 'rec_loss': '8.0232'}
2025-03-01 17:14:35,804 - {'Epoch': 40, 'HR@5': '0.0496', 'NDCG@5': '0.0341', 'HR@10': '0.0727', 'NDCG@10': '0.0415', 'HR@20': '0.1025', 'NDCG@20': '0.0490'}
2025-03-01 17:14:35,805 - EarlyStopping counter: 4 out of 10
2025-03-01 17:15:27,962 - {'epoch': 41, 'rec_loss': '8.0145'}
2025-03-01 17:15:46,730 - {'Epoch': 41, 'HR@5': '0.0499', 'NDCG@5': '0.0343', 'HR@10': '0.0728', 'NDCG@10': '0.0416', 'HR@20': '0.1024', 'NDCG@20': '0.0491'}
2025-03-01 17:15:46,731 - EarlyStopping counter: 5 out of 10
2025-03-01 17:16:37,531 - {'epoch': 42, 'rec_loss': '8.0129'}
2025-03-01 17:16:56,825 - {'Epoch': 42, 'HR@5': '0.0494', 'NDCG@5': '0.0340', 'HR@10': '0.0722', 'NDCG@10': '0.0413', 'HR@20': '0.1021', 'NDCG@20': '0.0488'}
2025-03-01 17:16:56,827 - EarlyStopping counter: 6 out of 10
2025-03-01 17:17:48,907 - {'epoch': 43, 'rec_loss': '8.0042'}
2025-03-01 17:18:08,404 - {'Epoch': 43, 'HR@5': '0.0485', 'NDCG@5': '0.0331', 'HR@10': '0.0724', 'NDCG@10': '0.0408', 'HR@20': '0.1027', 'NDCG@20': '0.0484'}
2025-03-01 17:18:08,405 - EarlyStopping counter: 7 out of 10
2025-03-01 17:18:59,062 - {'epoch': 44, 'rec_loss': '7.9960'}
2025-03-01 17:19:17,331 - {'Epoch': 44, 'HR@5': '0.0499', 'NDCG@5': '0.0338', 'HR@10': '0.0728', 'NDCG@10': '0.0412', 'HR@20': '0.1031', 'NDCG@20': '0.0488'}
2025-03-01 17:19:17,333 - EarlyStopping counter: 8 out of 10
2025-03-01 17:20:05,211 - {'epoch': 45, 'rec_loss': '7.9977'}
2025-03-01 17:20:22,512 - {'Epoch': 45, 'HR@5': '0.0483', 'NDCG@5': '0.0332', 'HR@10': '0.0725', 'NDCG@10': '0.0410', 'HR@20': '0.1032', 'NDCG@20': '0.0488'}
2025-03-01 17:20:22,513 - EarlyStopping counter: 9 out of 10
2025-03-01 17:21:01,721 - {'epoch': 46, 'rec_loss': '7.9948'}
2025-03-01 17:21:20,542 - {'Epoch': 46, 'HR@5': '0.0496', 'NDCG@5': '0.0339', 'HR@10': '0.0724', 'NDCG@10': '0.0413', 'HR@20': '0.1036', 'NDCG@20': '0.0491'}
2025-03-01 17:21:20,543 - EarlyStopping counter: 10 out of 10
2025-03-01 17:21:20,543 - Early stopping
2025-03-01 17:21:20,543 - ---------------Test Score---------------
2025-03-01 17:21:39,975 - {'Epoch': 0, 'HR@5': '0.0386', 'NDCG@5': '0.0266', 'HR@10': '0.0569', 'NDCG@10': '0.0325', 'HR@20': '0.0840', 'NDCG@20': '0.0393'}
2025-03-01 17:21:39,976 - Scale_Sports
2025-03-01 17:21:39,977 - {'Epoch': 0, 'HR@5': '0.0386', 'NDCG@5': '0.0266', 'HR@10': '0.0569', 'NDCG@10': '0.0325', 'HR@20': '0.0840', 'NDCG@20': '0.0393'}
2025-03-01 17:23:37,034 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.6, end_prob=0.9, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-01 17:23:39,988 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-01 17:23:39,993 - Total Parameters: 1328854
2025-03-01 17:24:21,770 - {'epoch': 0, 'rec_loss': '9.4113'}
2025-03-01 17:24:41,901 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0053', 'HR@10': '0.0129', 'NDCG@10': '0.0068', 'HR@20': '0.0204', 'NDCG@20': '0.0087'}
2025-03-01 17:24:41,903 - Validation score increased.  Saving model ...
2025-03-01 17:25:35,557 - {'epoch': 1, 'rec_loss': '9.2952'}
2025-03-01 17:25:55,188 - {'Epoch': 1, 'HR@5': '0.0082', 'NDCG@5': '0.0055', 'HR@10': '0.0132', 'NDCG@10': '0.0070', 'HR@20': '0.0241', 'NDCG@20': '0.0098'}
2025-03-01 17:25:55,189 - Validation score increased.  Saving model ...
2025-03-01 17:26:47,784 - {'epoch': 2, 'rec_loss': '9.2450'}
2025-03-01 17:27:05,101 - {'Epoch': 2, 'HR@5': '0.0104', 'NDCG@5': '0.0066', 'HR@10': '0.0175', 'NDCG@10': '0.0089', 'HR@20': '0.0310', 'NDCG@20': '0.0123'}
2025-03-01 17:27:05,103 - Validation score increased.  Saving model ...
2025-03-01 17:27:56,826 - {'epoch': 3, 'rec_loss': '9.1240'}
2025-03-01 17:28:14,194 - {'Epoch': 3, 'HR@5': '0.0125', 'NDCG@5': '0.0078', 'HR@10': '0.0217', 'NDCG@10': '0.0108', 'HR@20': '0.0360', 'NDCG@20': '0.0144'}
2025-03-01 17:28:14,195 - Validation score increased.  Saving model ...
2025-03-01 17:29:07,419 - {'epoch': 4, 'rec_loss': '9.0195'}
2025-03-01 17:29:24,693 - {'Epoch': 4, 'HR@5': '0.0155', 'NDCG@5': '0.0101', 'HR@10': '0.0260', 'NDCG@10': '0.0135', 'HR@20': '0.0430', 'NDCG@20': '0.0178'}
2025-03-01 17:29:24,695 - Validation score increased.  Saving model ...
2025-03-01 17:30:17,313 - {'epoch': 5, 'rec_loss': '8.9426'}
2025-03-01 17:30:35,657 - {'Epoch': 5, 'HR@5': '0.0185', 'NDCG@5': '0.0116', 'HR@10': '0.0288', 'NDCG@10': '0.0150', 'HR@20': '0.0469', 'NDCG@20': '0.0195'}
2025-03-01 17:30:35,659 - Validation score increased.  Saving model ...
2025-03-01 17:31:29,343 - {'epoch': 6, 'rec_loss': '8.8837'}
2025-03-01 17:31:49,098 - {'Epoch': 6, 'HR@5': '0.0201', 'NDCG@5': '0.0128', 'HR@10': '0.0310', 'NDCG@10': '0.0163', 'HR@20': '0.0499', 'NDCG@20': '0.0210'}
2025-03-01 17:31:49,100 - Validation score increased.  Saving model ...
2025-03-01 17:32:41,200 - {'epoch': 7, 'rec_loss': '8.8258'}
2025-03-01 17:33:00,415 - {'Epoch': 7, 'HR@5': '0.0198', 'NDCG@5': '0.0130', 'HR@10': '0.0324', 'NDCG@10': '0.0170', 'HR@20': '0.0523', 'NDCG@20': '0.0220'}
2025-03-01 17:33:00,417 - Validation score increased.  Saving model ...
2025-03-01 17:33:52,585 - {'epoch': 8, 'rec_loss': '8.7775'}
2025-03-01 17:34:12,010 - {'Epoch': 8, 'HR@5': '0.0222', 'NDCG@5': '0.0144', 'HR@10': '0.0353', 'NDCG@10': '0.0186', 'HR@20': '0.0564', 'NDCG@20': '0.0239'}
2025-03-01 17:34:12,012 - Validation score increased.  Saving model ...
2025-03-01 17:35:08,846 - {'epoch': 9, 'rec_loss': '8.7318'}
2025-03-01 17:35:29,079 - {'Epoch': 9, 'HR@5': '0.0242', 'NDCG@5': '0.0159', 'HR@10': '0.0392', 'NDCG@10': '0.0206', 'HR@20': '0.0615', 'NDCG@20': '0.0262'}
2025-03-01 17:35:29,081 - Validation score increased.  Saving model ...
2025-03-01 17:36:21,919 - {'epoch': 10, 'rec_loss': '8.6924'}
2025-03-01 17:36:41,563 - {'Epoch': 10, 'HR@5': '0.0269', 'NDCG@5': '0.0174', 'HR@10': '0.0415', 'NDCG@10': '0.0221', 'HR@20': '0.0635', 'NDCG@20': '0.0276'}
2025-03-01 17:36:41,565 - Validation score increased.  Saving model ...
2025-03-01 17:37:32,862 - {'epoch': 11, 'rec_loss': '8.6520'}
2025-03-01 17:37:52,275 - {'Epoch': 11, 'HR@5': '0.0272', 'NDCG@5': '0.0178', 'HR@10': '0.0432', 'NDCG@10': '0.0229', 'HR@20': '0.0672', 'NDCG@20': '0.0290'}
2025-03-01 17:37:52,277 - Validation score increased.  Saving model ...
2025-03-01 17:38:48,843 - {'epoch': 12, 'rec_loss': '8.6241'}
2025-03-01 17:39:09,100 - {'Epoch': 12, 'HR@5': '0.0302', 'NDCG@5': '0.0195', 'HR@10': '0.0461', 'NDCG@10': '0.0246', 'HR@20': '0.0692', 'NDCG@20': '0.0304'}
2025-03-01 17:39:09,101 - Validation score increased.  Saving model ...
2025-03-01 17:40:01,253 - {'epoch': 13, 'rec_loss': '8.5944'}
2025-03-01 17:40:20,890 - {'Epoch': 13, 'HR@5': '0.0297', 'NDCG@5': '0.0193', 'HR@10': '0.0463', 'NDCG@10': '0.0247', 'HR@20': '0.0703', 'NDCG@20': '0.0307'}
2025-03-01 17:40:20,891 - Validation score increased.  Saving model ...
2025-03-01 17:41:14,682 - {'epoch': 14, 'rec_loss': '8.5650'}
2025-03-01 17:41:35,118 - {'Epoch': 14, 'HR@5': '0.0322', 'NDCG@5': '0.0206', 'HR@10': '0.0486', 'NDCG@10': '0.0259', 'HR@20': '0.0728', 'NDCG@20': '0.0320'}
2025-03-01 17:41:35,121 - Validation score increased.  Saving model ...
2025-03-01 17:42:30,923 - {'epoch': 15, 'rec_loss': '8.5444'}
2025-03-01 17:42:51,487 - {'Epoch': 15, 'HR@5': '0.0333', 'NDCG@5': '0.0219', 'HR@10': '0.0504', 'NDCG@10': '0.0274', 'HR@20': '0.0754', 'NDCG@20': '0.0337'}
2025-03-01 17:42:51,488 - Validation score increased.  Saving model ...
2025-03-01 17:43:44,080 - {'epoch': 16, 'rec_loss': '8.5229'}
2025-03-01 17:44:03,430 - {'Epoch': 16, 'HR@5': '0.0340', 'NDCG@5': '0.0222', 'HR@10': '0.0510', 'NDCG@10': '0.0276', 'HR@20': '0.0757', 'NDCG@20': '0.0339'}
2025-03-01 17:44:03,432 - Validation score increased.  Saving model ...
2025-03-01 17:44:59,936 - {'epoch': 17, 'rec_loss': '8.5022'}
2025-03-01 17:45:20,513 - {'Epoch': 17, 'HR@5': '0.0349', 'NDCG@5': '0.0230', 'HR@10': '0.0525', 'NDCG@10': '0.0287', 'HR@20': '0.0777', 'NDCG@20': '0.0350'}
2025-03-01 17:45:20,514 - Validation score increased.  Saving model ...
2025-03-01 17:46:19,402 - {'epoch': 18, 'rec_loss': '8.4812'}
2025-03-01 17:46:39,212 - {'Epoch': 18, 'HR@5': '0.0364', 'NDCG@5': '0.0239', 'HR@10': '0.0551', 'NDCG@10': '0.0299', 'HR@20': '0.0806', 'NDCG@20': '0.0363'}
2025-03-01 17:46:39,213 - Validation score increased.  Saving model ...
2025-03-01 17:47:34,456 - {'epoch': 19, 'rec_loss': '8.4680'}
2025-03-01 17:47:52,208 - {'Epoch': 19, 'HR@5': '0.0351', 'NDCG@5': '0.0231', 'HR@10': '0.0541', 'NDCG@10': '0.0292', 'HR@20': '0.0802', 'NDCG@20': '0.0358'}
2025-03-01 17:47:52,209 - EarlyStopping counter: 1 out of 10
2025-03-01 17:48:44,060 - {'epoch': 20, 'rec_loss': '8.4490'}
2025-03-01 17:49:02,223 - {'Epoch': 20, 'HR@5': '0.0381', 'NDCG@5': '0.0250', 'HR@10': '0.0563', 'NDCG@10': '0.0309', 'HR@20': '0.0825', 'NDCG@20': '0.0375'}
2025-03-01 17:49:02,225 - Validation score increased.  Saving model ...
2025-03-01 17:49:58,264 - {'epoch': 21, 'rec_loss': '8.4268'}
2025-03-01 17:50:17,022 - {'Epoch': 21, 'HR@5': '0.0372', 'NDCG@5': '0.0244', 'HR@10': '0.0560', 'NDCG@10': '0.0305', 'HR@20': '0.0830', 'NDCG@20': '0.0372'}
2025-03-01 17:50:17,025 - EarlyStopping counter: 1 out of 10
2025-03-01 17:51:06,801 - {'epoch': 22, 'rec_loss': '8.4203'}
2025-03-01 17:51:24,680 - {'Epoch': 22, 'HR@5': '0.0366', 'NDCG@5': '0.0246', 'HR@10': '0.0568', 'NDCG@10': '0.0311', 'HR@20': '0.0838', 'NDCG@20': '0.0379'}
2025-03-01 17:51:24,681 - Validation score increased.  Saving model ...
2025-03-01 17:52:19,111 - {'epoch': 23, 'rec_loss': '8.4071'}
2025-03-01 17:52:37,862 - {'Epoch': 23, 'HR@5': '0.0385', 'NDCG@5': '0.0254', 'HR@10': '0.0576', 'NDCG@10': '0.0315', 'HR@20': '0.0854', 'NDCG@20': '0.0385'}
2025-03-01 17:52:37,864 - Validation score increased.  Saving model ...
2025-03-01 17:53:32,600 - {'epoch': 24, 'rec_loss': '8.3952'}
2025-03-01 17:53:52,024 - {'Epoch': 24, 'HR@5': '0.0388', 'NDCG@5': '0.0256', 'HR@10': '0.0585', 'NDCG@10': '0.0319', 'HR@20': '0.0850', 'NDCG@20': '0.0386'}
2025-03-01 17:53:52,026 - Validation score increased.  Saving model ...
2025-03-01 17:54:41,960 - {'epoch': 25, 'rec_loss': '8.3794'}
2025-03-01 17:54:59,669 - {'Epoch': 25, 'HR@5': '0.0390', 'NDCG@5': '0.0260', 'HR@10': '0.0597', 'NDCG@10': '0.0327', 'HR@20': '0.0867', 'NDCG@20': '0.0395'}
2025-03-01 17:54:59,675 - Validation score increased.  Saving model ...
2025-03-01 17:55:53,622 - {'epoch': 26, 'rec_loss': '8.3746'}
2025-03-01 17:56:12,342 - {'Epoch': 26, 'HR@5': '0.0388', 'NDCG@5': '0.0260', 'HR@10': '0.0596', 'NDCG@10': '0.0327', 'HR@20': '0.0881', 'NDCG@20': '0.0398'}
2025-03-01 17:56:12,343 - Validation score increased.  Saving model ...
2025-03-01 17:57:01,310 - {'epoch': 27, 'rec_loss': '8.3614'}
2025-03-01 17:57:19,962 - {'Epoch': 27, 'HR@5': '0.0404', 'NDCG@5': '0.0271', 'HR@10': '0.0599', 'NDCG@10': '0.0333', 'HR@20': '0.0873', 'NDCG@20': '0.0402'}
2025-03-01 17:57:19,963 - Validation score increased.  Saving model ...
2025-03-01 17:58:04,119 - {'epoch': 28, 'rec_loss': '8.3554'}
2025-03-01 17:58:22,046 - {'Epoch': 28, 'HR@5': '0.0400', 'NDCG@5': '0.0269', 'HR@10': '0.0599', 'NDCG@10': '0.0333', 'HR@20': '0.0884', 'NDCG@20': '0.0405'}
2025-03-01 17:58:22,048 - Validation score increased.  Saving model ...
2025-03-01 17:59:01,418 - {'epoch': 29, 'rec_loss': '8.3421'}
2025-03-01 17:59:18,821 - {'Epoch': 29, 'HR@5': '0.0408', 'NDCG@5': '0.0271', 'HR@10': '0.0601', 'NDCG@10': '0.0333', 'HR@20': '0.0890', 'NDCG@20': '0.0405'}
2025-03-01 17:59:18,823 - Validation score increased.  Saving model ...
2025-03-01 17:59:58,307 - {'epoch': 30, 'rec_loss': '8.3332'}
2025-03-01 18:00:17,185 - {'Epoch': 30, 'HR@5': '0.0415', 'NDCG@5': '0.0278', 'HR@10': '0.0606', 'NDCG@10': '0.0339', 'HR@20': '0.0884', 'NDCG@20': '0.0408'}
2025-03-01 18:00:17,190 - Validation score increased.  Saving model ...
2025-03-01 18:00:57,072 - {'epoch': 31, 'rec_loss': '8.3221'}
2025-03-01 18:01:14,798 - {'Epoch': 31, 'HR@5': '0.0421', 'NDCG@5': '0.0281', 'HR@10': '0.0621', 'NDCG@10': '0.0345', 'HR@20': '0.0913', 'NDCG@20': '0.0418'}
2025-03-01 18:01:14,799 - Validation score increased.  Saving model ...
2025-03-01 18:01:54,413 - {'epoch': 32, 'rec_loss': '8.3186'}
2025-03-01 18:02:11,503 - {'Epoch': 32, 'HR@5': '0.0417', 'NDCG@5': '0.0280', 'HR@10': '0.0620', 'NDCG@10': '0.0345', 'HR@20': '0.0906', 'NDCG@20': '0.0417'}
2025-03-01 18:02:11,504 - EarlyStopping counter: 1 out of 10
2025-03-01 18:02:51,603 - {'epoch': 33, 'rec_loss': '8.3112'}
2025-03-01 18:03:09,851 - {'Epoch': 33, 'HR@5': '0.0427', 'NDCG@5': '0.0286', 'HR@10': '0.0619', 'NDCG@10': '0.0348', 'HR@20': '0.0904', 'NDCG@20': '0.0419'}
2025-03-01 18:03:09,853 - Validation score increased.  Saving model ...
2025-03-01 18:03:51,575 - {'epoch': 34, 'rec_loss': '8.3066'}
2025-03-01 18:04:10,181 - {'Epoch': 34, 'HR@5': '0.0417', 'NDCG@5': '0.0283', 'HR@10': '0.0616', 'NDCG@10': '0.0347', 'HR@20': '0.0913', 'NDCG@20': '0.0422'}
2025-03-01 18:04:10,182 - Validation score increased.  Saving model ...
2025-03-01 18:04:48,888 - {'epoch': 35, 'rec_loss': '8.2933'}
2025-03-01 18:05:06,587 - {'Epoch': 35, 'HR@5': '0.0430', 'NDCG@5': '0.0289', 'HR@10': '0.0629', 'NDCG@10': '0.0353', 'HR@20': '0.0914', 'NDCG@20': '0.0425'}
2025-03-01 18:05:06,588 - Validation score increased.  Saving model ...
2025-03-01 18:05:46,509 - {'epoch': 36, 'rec_loss': '8.2905'}
2025-03-01 18:06:05,513 - {'Epoch': 36, 'HR@5': '0.0441', 'NDCG@5': '0.0298', 'HR@10': '0.0641', 'NDCG@10': '0.0362', 'HR@20': '0.0930', 'NDCG@20': '0.0435'}
2025-03-01 18:06:05,517 - Validation score increased.  Saving model ...
2025-03-01 18:06:44,756 - {'epoch': 37, 'rec_loss': '8.2785'}
2025-03-01 18:07:03,726 - {'Epoch': 37, 'HR@5': '0.0435', 'NDCG@5': '0.0289', 'HR@10': '0.0642', 'NDCG@10': '0.0355', 'HR@20': '0.0935', 'NDCG@20': '0.0429'}
2025-03-01 18:07:03,729 - EarlyStopping counter: 1 out of 10
2025-03-01 18:07:43,078 - {'epoch': 38, 'rec_loss': '8.2671'}
2025-03-01 18:08:02,010 - {'Epoch': 38, 'HR@5': '0.0438', 'NDCG@5': '0.0295', 'HR@10': '0.0647', 'NDCG@10': '0.0362', 'HR@20': '0.0940', 'NDCG@20': '0.0435'}
2025-03-01 18:08:02,013 - Validation score increased.  Saving model ...
2025-03-01 18:08:41,471 - {'epoch': 39, 'rec_loss': '8.2704'}
2025-03-01 18:08:58,193 - {'Epoch': 39, 'HR@5': '0.0435', 'NDCG@5': '0.0293', 'HR@10': '0.0647', 'NDCG@10': '0.0362', 'HR@20': '0.0949', 'NDCG@20': '0.0437'}
2025-03-01 18:08:58,195 - Validation score increased.  Saving model ...
2025-03-01 18:09:37,890 - {'epoch': 40, 'rec_loss': '8.2623'}
2025-03-01 18:09:56,824 - {'Epoch': 40, 'HR@5': '0.0439', 'NDCG@5': '0.0296', 'HR@10': '0.0649', 'NDCG@10': '0.0364', 'HR@20': '0.0945', 'NDCG@20': '0.0438'}
2025-03-01 18:09:56,827 - Validation score increased.  Saving model ...
2025-03-01 18:10:36,704 - {'epoch': 41, 'rec_loss': '8.2516'}
2025-03-01 18:10:55,594 - {'Epoch': 41, 'HR@5': '0.0432', 'NDCG@5': '0.0292', 'HR@10': '0.0651', 'NDCG@10': '0.0363', 'HR@20': '0.0937', 'NDCG@20': '0.0434'}
2025-03-01 18:10:55,596 - EarlyStopping counter: 1 out of 10
2025-03-01 18:11:34,584 - {'epoch': 42, 'rec_loss': '8.2537'}
2025-03-01 18:11:52,137 - {'Epoch': 42, 'HR@5': '0.0445', 'NDCG@5': '0.0299', 'HR@10': '0.0644', 'NDCG@10': '0.0363', 'HR@20': '0.0938', 'NDCG@20': '0.0437'}
2025-03-01 18:11:52,140 - EarlyStopping counter: 2 out of 10
2025-03-01 18:12:31,763 - {'epoch': 43, 'rec_loss': '8.2419'}
2025-03-01 18:12:49,421 - {'Epoch': 43, 'HR@5': '0.0436', 'NDCG@5': '0.0292', 'HR@10': '0.0642', 'NDCG@10': '0.0359', 'HR@20': '0.0942', 'NDCG@20': '0.0434'}
2025-03-01 18:12:49,424 - EarlyStopping counter: 3 out of 10
2025-03-01 18:13:28,249 - {'epoch': 44, 'rec_loss': '8.2396'}
2025-03-01 18:13:47,091 - {'Epoch': 44, 'HR@5': '0.0442', 'NDCG@5': '0.0299', 'HR@10': '0.0661', 'NDCG@10': '0.0369', 'HR@20': '0.0958', 'NDCG@20': '0.0444'}
2025-03-01 18:13:47,093 - Validation score increased.  Saving model ...
2025-03-01 18:14:28,941 - {'epoch': 45, 'rec_loss': '8.2384'}
2025-03-01 18:14:48,240 - {'Epoch': 45, 'HR@5': '0.0449', 'NDCG@5': '0.0303', 'HR@10': '0.0655', 'NDCG@10': '0.0370', 'HR@20': '0.0957', 'NDCG@20': '0.0446'}
2025-03-01 18:14:48,244 - Validation score increased.  Saving model ...
2025-03-01 18:15:27,686 - {'epoch': 46, 'rec_loss': '8.2292'}
2025-03-01 18:15:45,451 - {'Epoch': 46, 'HR@5': '0.0446', 'NDCG@5': '0.0299', 'HR@10': '0.0654', 'NDCG@10': '0.0366', 'HR@20': '0.0962', 'NDCG@20': '0.0443'}
2025-03-01 18:15:45,452 - EarlyStopping counter: 1 out of 10
2025-03-01 18:16:25,631 - {'epoch': 47, 'rec_loss': '8.2329'}
2025-03-01 18:16:44,614 - {'Epoch': 47, 'HR@5': '0.0445', 'NDCG@5': '0.0301', 'HR@10': '0.0656', 'NDCG@10': '0.0369', 'HR@20': '0.0963', 'NDCG@20': '0.0446'}
2025-03-01 18:16:44,619 - Validation score increased.  Saving model ...
2025-03-01 18:17:23,973 - {'epoch': 48, 'rec_loss': '8.2222'}
2025-03-01 18:17:41,245 - {'Epoch': 48, 'HR@5': '0.0446', 'NDCG@5': '0.0299', 'HR@10': '0.0658', 'NDCG@10': '0.0368', 'HR@20': '0.0965', 'NDCG@20': '0.0445'}
2025-03-01 18:17:41,246 - EarlyStopping counter: 1 out of 10
2025-03-01 18:18:20,466 - {'epoch': 49, 'rec_loss': '8.2207'}
2025-03-01 18:18:37,958 - {'Epoch': 49, 'HR@5': '0.0447', 'NDCG@5': '0.0303', 'HR@10': '0.0661', 'NDCG@10': '0.0372', 'HR@20': '0.0971', 'NDCG@20': '0.0449'}
2025-03-01 18:18:37,960 - Validation score increased.  Saving model ...
2025-03-01 18:19:19,624 - {'epoch': 50, 'rec_loss': '8.2168'}
2025-03-01 18:19:37,029 - {'Epoch': 50, 'HR@5': '0.0449', 'NDCG@5': '0.0302', 'HR@10': '0.0662', 'NDCG@10': '0.0371', 'HR@20': '0.0953', 'NDCG@20': '0.0444'}
2025-03-01 18:19:37,031 - EarlyStopping counter: 1 out of 10
2025-03-01 18:20:18,002 - {'epoch': 51, 'rec_loss': '8.2185'}
2025-03-01 18:20:37,093 - {'Epoch': 51, 'HR@5': '0.0457', 'NDCG@5': '0.0309', 'HR@10': '0.0666', 'NDCG@10': '0.0376', 'HR@20': '0.0966', 'NDCG@20': '0.0452'}
2025-03-01 18:20:37,094 - Validation score increased.  Saving model ...
2025-03-01 18:21:18,174 - {'epoch': 52, 'rec_loss': '8.2079'}
2025-03-01 18:21:36,835 - {'Epoch': 52, 'HR@5': '0.0451', 'NDCG@5': '0.0306', 'HR@10': '0.0659', 'NDCG@10': '0.0373', 'HR@20': '0.0962', 'NDCG@20': '0.0449'}
2025-03-01 18:21:36,837 - EarlyStopping counter: 1 out of 10
2025-03-01 18:22:18,677 - {'epoch': 53, 'rec_loss': '8.2063'}
2025-03-01 18:22:36,890 - {'Epoch': 53, 'HR@5': '0.0462', 'NDCG@5': '0.0312', 'HR@10': '0.0676', 'NDCG@10': '0.0381', 'HR@20': '0.0982', 'NDCG@20': '0.0458'}
2025-03-01 18:22:36,892 - Validation score increased.  Saving model ...
2025-03-01 18:23:15,482 - {'epoch': 54, 'rec_loss': '8.2059'}
2025-03-01 18:23:33,110 - {'Epoch': 54, 'HR@5': '0.0455', 'NDCG@5': '0.0308', 'HR@10': '0.0668', 'NDCG@10': '0.0376', 'HR@20': '0.0976', 'NDCG@20': '0.0454'}
2025-03-01 18:23:33,111 - EarlyStopping counter: 1 out of 10
2025-03-01 18:24:15,147 - {'epoch': 55, 'rec_loss': '8.1928'}
2025-03-01 18:24:33,748 - {'Epoch': 55, 'HR@5': '0.0453', 'NDCG@5': '0.0305', 'HR@10': '0.0676', 'NDCG@10': '0.0377', 'HR@20': '0.0974', 'NDCG@20': '0.0451'}
2025-03-01 18:24:33,750 - EarlyStopping counter: 2 out of 10
2025-03-01 18:25:15,019 - {'epoch': 56, 'rec_loss': '8.1935'}
2025-03-01 18:25:32,607 - {'Epoch': 56, 'HR@5': '0.0460', 'NDCG@5': '0.0310', 'HR@10': '0.0672', 'NDCG@10': '0.0379', 'HR@20': '0.0987', 'NDCG@20': '0.0458'}
2025-03-01 18:25:32,609 - EarlyStopping counter: 3 out of 10
2025-03-01 18:26:16,064 - {'epoch': 57, 'rec_loss': '8.1964'}
2025-03-01 18:26:34,154 - {'Epoch': 57, 'HR@5': '0.0465', 'NDCG@5': '0.0313', 'HR@10': '0.0669', 'NDCG@10': '0.0379', 'HR@20': '0.0979', 'NDCG@20': '0.0457'}
2025-03-01 18:26:34,155 - EarlyStopping counter: 4 out of 10
2025-03-01 18:27:14,738 - {'epoch': 58, 'rec_loss': '8.1879'}
2025-03-01 18:27:32,744 - {'Epoch': 58, 'HR@5': '0.0465', 'NDCG@5': '0.0312', 'HR@10': '0.0677', 'NDCG@10': '0.0380', 'HR@20': '0.0989', 'NDCG@20': '0.0458'}
2025-03-01 18:27:32,749 - Validation score increased.  Saving model ...
2025-03-01 18:28:13,932 - {'epoch': 59, 'rec_loss': '8.2008'}
2025-03-01 18:28:31,415 - {'Epoch': 59, 'HR@5': '0.0457', 'NDCG@5': '0.0311', 'HR@10': '0.0681', 'NDCG@10': '0.0383', 'HR@20': '0.0978', 'NDCG@20': '0.0457'}
2025-03-01 18:28:31,417 - EarlyStopping counter: 1 out of 10
2025-03-01 18:29:13,577 - {'epoch': 60, 'rec_loss': '8.1800'}
2025-03-01 18:29:32,979 - {'Epoch': 60, 'HR@5': '0.0467', 'NDCG@5': '0.0312', 'HR@10': '0.0681', 'NDCG@10': '0.0381', 'HR@20': '0.0984', 'NDCG@20': '0.0457'}
2025-03-01 18:29:32,981 - EarlyStopping counter: 2 out of 10
2025-03-01 18:30:14,954 - {'epoch': 61, 'rec_loss': '8.1852'}
2025-03-01 18:30:31,844 - {'Epoch': 61, 'HR@5': '0.0465', 'NDCG@5': '0.0311', 'HR@10': '0.0674', 'NDCG@10': '0.0379', 'HR@20': '0.0980', 'NDCG@20': '0.0455'}
2025-03-01 18:30:31,846 - EarlyStopping counter: 3 out of 10
2025-03-01 18:31:13,396 - {'epoch': 62, 'rec_loss': '8.1778'}
2025-03-01 18:31:31,350 - {'Epoch': 62, 'HR@5': '0.0462', 'NDCG@5': '0.0312', 'HR@10': '0.0682', 'NDCG@10': '0.0383', 'HR@20': '0.0979', 'NDCG@20': '0.0457'}
2025-03-01 18:31:31,354 - EarlyStopping counter: 4 out of 10
2025-03-01 18:32:11,045 - {'epoch': 63, 'rec_loss': '8.1709'}
2025-03-01 18:32:30,322 - {'Epoch': 63, 'HR@5': '0.0462', 'NDCG@5': '0.0311', 'HR@10': '0.0671', 'NDCG@10': '0.0378', 'HR@20': '0.0988', 'NDCG@20': '0.0458'}
2025-03-01 18:32:30,324 - EarlyStopping counter: 5 out of 10
2025-03-01 18:33:13,019 - {'epoch': 64, 'rec_loss': '8.1763'}
2025-03-01 18:33:31,635 - {'Epoch': 64, 'HR@5': '0.0466', 'NDCG@5': '0.0312', 'HR@10': '0.0690', 'NDCG@10': '0.0384', 'HR@20': '0.0998', 'NDCG@20': '0.0461'}
2025-03-01 18:33:31,636 - Validation score increased.  Saving model ...
2025-03-01 18:34:16,126 - {'epoch': 65, 'rec_loss': '8.1682'}
2025-03-01 18:34:35,037 - {'Epoch': 65, 'HR@5': '0.0472', 'NDCG@5': '0.0316', 'HR@10': '0.0683', 'NDCG@10': '0.0384', 'HR@20': '0.0996', 'NDCG@20': '0.0463'}
2025-03-01 18:34:35,040 - Validation score increased.  Saving model ...
2025-03-01 18:35:14,902 - {'epoch': 66, 'rec_loss': '8.1653'}
2025-03-01 18:35:33,656 - {'Epoch': 66, 'HR@5': '0.0471', 'NDCG@5': '0.0320', 'HR@10': '0.0690', 'NDCG@10': '0.0391', 'HR@20': '0.1003', 'NDCG@20': '0.0470'}
2025-03-01 18:35:33,660 - Validation score increased.  Saving model ...
2025-03-01 18:36:15,225 - {'epoch': 67, 'rec_loss': '8.1677'}
2025-03-01 18:36:33,215 - {'Epoch': 67, 'HR@5': '0.0467', 'NDCG@5': '0.0313', 'HR@10': '0.0686', 'NDCG@10': '0.0384', 'HR@20': '0.0989', 'NDCG@20': '0.0460'}
2025-03-01 18:36:33,219 - EarlyStopping counter: 1 out of 10
2025-03-01 18:37:14,595 - {'epoch': 68, 'rec_loss': '8.1666'}
2025-03-01 18:37:32,045 - {'Epoch': 68, 'HR@5': '0.0469', 'NDCG@5': '0.0316', 'HR@10': '0.0678', 'NDCG@10': '0.0383', 'HR@20': '0.0991', 'NDCG@20': '0.0462'}
2025-03-01 18:37:32,046 - EarlyStopping counter: 2 out of 10
2025-03-01 18:38:13,514 - {'epoch': 69, 'rec_loss': '8.1598'}
2025-03-01 18:38:32,499 - {'Epoch': 69, 'HR@5': '0.0465', 'NDCG@5': '0.0314', 'HR@10': '0.0674', 'NDCG@10': '0.0381', 'HR@20': '0.0986', 'NDCG@20': '0.0459'}
2025-03-01 18:38:32,501 - EarlyStopping counter: 3 out of 10
2025-03-01 18:39:19,268 - {'epoch': 70, 'rec_loss': '8.1501'}
2025-03-01 18:39:39,449 - {'Epoch': 70, 'HR@5': '0.0469', 'NDCG@5': '0.0317', 'HR@10': '0.0682', 'NDCG@10': '0.0386', 'HR@20': '0.0993', 'NDCG@20': '0.0464'}
2025-03-01 18:39:39,451 - EarlyStopping counter: 4 out of 10
2025-03-01 18:40:22,743 - {'epoch': 71, 'rec_loss': '8.1549'}
2025-03-01 18:40:42,257 - {'Epoch': 71, 'HR@5': '0.0468', 'NDCG@5': '0.0315', 'HR@10': '0.0683', 'NDCG@10': '0.0384', 'HR@20': '0.0989', 'NDCG@20': '0.0461'}
2025-03-01 18:40:42,259 - EarlyStopping counter: 5 out of 10
2025-03-01 18:41:29,423 - {'epoch': 72, 'rec_loss': '8.1540'}
2025-03-01 18:41:48,637 - {'Epoch': 72, 'HR@5': '0.0458', 'NDCG@5': '0.0314', 'HR@10': '0.0683', 'NDCG@10': '0.0386', 'HR@20': '0.0992', 'NDCG@20': '0.0464'}
2025-03-01 18:41:48,639 - EarlyStopping counter: 6 out of 10
2025-03-01 18:42:33,776 - {'epoch': 73, 'rec_loss': '8.1529'}
2025-03-01 18:42:53,090 - {'Epoch': 73, 'HR@5': '0.0458', 'NDCG@5': '0.0311', 'HR@10': '0.0667', 'NDCG@10': '0.0378', 'HR@20': '0.0998', 'NDCG@20': '0.0461'}
2025-03-01 18:42:53,092 - EarlyStopping counter: 7 out of 10
2025-03-01 18:43:40,376 - {'epoch': 74, 'rec_loss': '8.1486'}
2025-03-01 18:43:59,298 - {'Epoch': 74, 'HR@5': '0.0475', 'NDCG@5': '0.0317', 'HR@10': '0.0679', 'NDCG@10': '0.0383', 'HR@20': '0.1002', 'NDCG@20': '0.0464'}
2025-03-01 18:43:59,302 - EarlyStopping counter: 8 out of 10
2025-03-01 18:44:43,970 - {'epoch': 75, 'rec_loss': '8.1468'}
2025-03-01 18:45:03,285 - {'Epoch': 75, 'HR@5': '0.0463', 'NDCG@5': '0.0317', 'HR@10': '0.0681', 'NDCG@10': '0.0387', 'HR@20': '0.1006', 'NDCG@20': '0.0468'}
2025-03-01 18:45:03,289 - EarlyStopping counter: 9 out of 10
2025-03-01 18:45:46,868 - {'epoch': 76, 'rec_loss': '8.1454'}
2025-03-01 18:46:05,577 - {'Epoch': 76, 'HR@5': '0.0465', 'NDCG@5': '0.0318', 'HR@10': '0.0686', 'NDCG@10': '0.0389', 'HR@20': '0.1002', 'NDCG@20': '0.0468'}
2025-03-01 18:46:05,578 - EarlyStopping counter: 10 out of 10
2025-03-01 18:46:05,578 - Early stopping
2025-03-01 18:46:05,578 - ---------------Test Score---------------
2025-03-01 18:46:24,348 - {'Epoch': 0, 'HR@5': '0.0356', 'NDCG@5': '0.0240', 'HR@10': '0.0553', 'NDCG@10': '0.0303', 'HR@20': '0.0797', 'NDCG@20': '0.0365'}
2025-03-01 18:46:24,349 - Scale_Sports
2025-03-01 18:46:24,350 - {'Epoch': 0, 'HR@5': '0.0356', 'NDCG@5': '0.0240', 'HR@10': '0.0553', 'NDCG@10': '0.0303', 'HR@20': '0.0797', 'NDCG@20': '0.0365'}
2025-03-01 19:23:13,242 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[4, 8], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-01 19:23:16,690 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=2, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=2, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-01 19:23:16,697 - Total Parameters: 1328850
2025-03-01 19:24:04,194 - {'epoch': 0, 'rec_loss': '9.4037'}
2025-03-01 19:24:23,739 - {'Epoch': 0, 'HR@5': '0.0084', 'NDCG@5': '0.0055', 'HR@10': '0.0126', 'NDCG@10': '0.0069', 'HR@20': '0.0227', 'NDCG@20': '0.0094'}
2025-03-01 19:24:23,744 - Validation score increased.  Saving model ...
2025-03-01 19:25:04,822 - {'epoch': 1, 'rec_loss': '9.2057'}
2025-03-01 19:25:22,293 - {'Epoch': 1, 'HR@5': '0.0143', 'NDCG@5': '0.0094', 'HR@10': '0.0246', 'NDCG@10': '0.0127', 'HR@20': '0.0396', 'NDCG@20': '0.0164'}
2025-03-01 19:25:22,295 - Validation score increased.  Saving model ...
2025-03-01 19:26:06,398 - {'epoch': 2, 'rec_loss': '8.9352'}
2025-03-01 19:26:26,529 - {'Epoch': 2, 'HR@5': '0.0195', 'NDCG@5': '0.0128', 'HR@10': '0.0308', 'NDCG@10': '0.0164', 'HR@20': '0.0504', 'NDCG@20': '0.0214'}
2025-03-01 19:26:26,532 - Validation score increased.  Saving model ...
2025-03-01 19:27:09,342 - {'epoch': 3, 'rec_loss': '8.7400'}
2025-03-01 19:27:27,148 - {'Epoch': 3, 'HR@5': '0.0260', 'NDCG@5': '0.0163', 'HR@10': '0.0405', 'NDCG@10': '0.0210', 'HR@20': '0.0624', 'NDCG@20': '0.0265'}
2025-03-01 19:27:27,150 - Validation score increased.  Saving model ...
2025-03-01 19:28:07,844 - {'epoch': 4, 'rec_loss': '8.5898'}
2025-03-01 19:28:26,624 - {'Epoch': 4, 'HR@5': '0.0307', 'NDCG@5': '0.0204', 'HR@10': '0.0471', 'NDCG@10': '0.0257', 'HR@20': '0.0714', 'NDCG@20': '0.0318'}
2025-03-01 19:28:26,630 - Validation score increased.  Saving model ...
2025-03-01 19:29:10,667 - {'epoch': 5, 'rec_loss': '8.4763'}
2025-03-01 19:29:29,084 - {'Epoch': 5, 'HR@5': '0.0354', 'NDCG@5': '0.0236', 'HR@10': '0.0531', 'NDCG@10': '0.0293', 'HR@20': '0.0787', 'NDCG@20': '0.0357'}
2025-03-01 19:29:29,085 - Validation score increased.  Saving model ...
2025-03-01 19:30:09,258 - {'epoch': 6, 'rec_loss': '8.3793'}
2025-03-01 19:30:27,443 - {'Epoch': 6, 'HR@5': '0.0396', 'NDCG@5': '0.0266', 'HR@10': '0.0585', 'NDCG@10': '0.0327', 'HR@20': '0.0850', 'NDCG@20': '0.0393'}
2025-03-01 19:30:27,444 - Validation score increased.  Saving model ...
2025-03-01 19:31:14,045 - {'epoch': 7, 'rec_loss': '8.3016'}
2025-03-01 19:31:33,629 - {'Epoch': 7, 'HR@5': '0.0411', 'NDCG@5': '0.0283', 'HR@10': '0.0598', 'NDCG@10': '0.0343', 'HR@20': '0.0867', 'NDCG@20': '0.0411'}
2025-03-01 19:31:33,636 - Validation score increased.  Saving model ...
2025-03-01 19:32:14,651 - {'epoch': 8, 'rec_loss': '8.2353'}
2025-03-01 19:32:32,986 - {'Epoch': 8, 'HR@5': '0.0427', 'NDCG@5': '0.0293', 'HR@10': '0.0621', 'NDCG@10': '0.0356', 'HR@20': '0.0895', 'NDCG@20': '0.0425'}
2025-03-01 19:32:32,989 - Validation score increased.  Saving model ...
2025-03-01 19:33:17,419 - {'epoch': 9, 'rec_loss': '8.1705'}
2025-03-01 19:33:37,818 - {'Epoch': 9, 'HR@5': '0.0442', 'NDCG@5': '0.0305', 'HR@10': '0.0652', 'NDCG@10': '0.0372', 'HR@20': '0.0923', 'NDCG@20': '0.0440'}
2025-03-01 19:33:37,821 - Validation score increased.  Saving model ...
2025-03-01 19:34:18,246 - {'epoch': 10, 'rec_loss': '8.1272'}
2025-03-01 19:34:36,896 - {'Epoch': 10, 'HR@5': '0.0468', 'NDCG@5': '0.0321', 'HR@10': '0.0663', 'NDCG@10': '0.0383', 'HR@20': '0.0942', 'NDCG@20': '0.0453'}
2025-03-01 19:34:36,902 - Validation score increased.  Saving model ...
2025-03-01 19:35:16,460 - {'epoch': 11, 'rec_loss': '8.0821'}
2025-03-01 19:35:36,780 - {'Epoch': 11, 'HR@5': '0.0472', 'NDCG@5': '0.0330', 'HR@10': '0.0673', 'NDCG@10': '0.0394', 'HR@20': '0.0963', 'NDCG@20': '0.0467'}
2025-03-01 19:35:36,784 - Validation score increased.  Saving model ...
2025-03-01 19:36:21,580 - {'epoch': 12, 'rec_loss': '8.0437'}
2025-03-01 19:36:41,170 - {'Epoch': 12, 'HR@5': '0.0470', 'NDCG@5': '0.0328', 'HR@10': '0.0683', 'NDCG@10': '0.0397', 'HR@20': '0.0967', 'NDCG@20': '0.0468'}
2025-03-01 19:36:41,175 - Validation score increased.  Saving model ...
2025-03-01 19:37:21,923 - {'epoch': 13, 'rec_loss': '8.0117'}
2025-03-01 19:37:39,981 - {'Epoch': 13, 'HR@5': '0.0475', 'NDCG@5': '0.0332', 'HR@10': '0.0687', 'NDCG@10': '0.0401', 'HR@20': '0.0985', 'NDCG@20': '0.0475'}
2025-03-01 19:37:39,986 - Validation score increased.  Saving model ...
2025-03-01 19:38:24,804 - {'epoch': 14, 'rec_loss': '7.9833'}
2025-03-01 19:38:45,942 - {'Epoch': 14, 'HR@5': '0.0478', 'NDCG@5': '0.0334', 'HR@10': '0.0704', 'NDCG@10': '0.0406', 'HR@20': '0.1008', 'NDCG@20': '0.0483'}
2025-03-01 19:38:45,946 - Validation score increased.  Saving model ...
2025-03-01 19:39:27,067 - {'epoch': 15, 'rec_loss': '7.9518'}
2025-03-01 19:39:43,889 - {'Epoch': 15, 'HR@5': '0.0490', 'NDCG@5': '0.0340', 'HR@10': '0.0690', 'NDCG@10': '0.0404', 'HR@20': '0.0996', 'NDCG@20': '0.0481'}
2025-03-01 19:39:43,890 - EarlyStopping counter: 1 out of 10
2025-03-01 19:40:25,741 - {'epoch': 16, 'rec_loss': '7.9277'}
2025-03-01 19:40:46,172 - {'Epoch': 16, 'HR@5': '0.0495', 'NDCG@5': '0.0346', 'HR@10': '0.0710', 'NDCG@10': '0.0415', 'HR@20': '0.1010', 'NDCG@20': '0.0491'}
2025-03-01 19:40:46,173 - Validation score increased.  Saving model ...
2025-03-01 19:41:33,729 - {'epoch': 17, 'rec_loss': '7.9082'}
2025-03-01 19:41:53,701 - {'Epoch': 17, 'HR@5': '0.0499', 'NDCG@5': '0.0347', 'HR@10': '0.0700', 'NDCG@10': '0.0412', 'HR@20': '0.1001', 'NDCG@20': '0.0488'}
2025-03-01 19:41:53,706 - EarlyStopping counter: 1 out of 10
2025-03-01 19:42:33,665 - {'epoch': 18, 'rec_loss': '7.8850'}
2025-03-01 19:42:51,910 - {'Epoch': 18, 'HR@5': '0.0502', 'NDCG@5': '0.0349', 'HR@10': '0.0714', 'NDCG@10': '0.0417', 'HR@20': '0.1011', 'NDCG@20': '0.0492'}
2025-03-01 19:42:51,917 - Validation score increased.  Saving model ...
2025-03-01 19:43:37,070 - {'epoch': 19, 'rec_loss': '7.8608'}
2025-03-01 19:43:56,633 - {'Epoch': 19, 'HR@5': '0.0500', 'NDCG@5': '0.0350', 'HR@10': '0.0719', 'NDCG@10': '0.0421', 'HR@20': '0.1015', 'NDCG@20': '0.0496'}
2025-03-01 19:43:56,635 - Validation score increased.  Saving model ...
2025-03-01 19:44:37,438 - {'epoch': 20, 'rec_loss': '7.8474'}
2025-03-01 19:44:54,313 - {'Epoch': 20, 'HR@5': '0.0507', 'NDCG@5': '0.0349', 'HR@10': '0.0726', 'NDCG@10': '0.0419', 'HR@20': '0.1032', 'NDCG@20': '0.0496'}
2025-03-01 19:44:54,318 - Validation score increased.  Saving model ...
2025-03-01 19:45:37,804 - {'epoch': 21, 'rec_loss': '7.8204'}
2025-03-01 19:45:58,552 - {'Epoch': 21, 'HR@5': '0.0505', 'NDCG@5': '0.0347', 'HR@10': '0.0731', 'NDCG@10': '0.0419', 'HR@20': '0.1016', 'NDCG@20': '0.0491'}
2025-03-01 19:45:58,557 - EarlyStopping counter: 1 out of 10
2025-03-01 19:46:43,657 - {'epoch': 22, 'rec_loss': '7.8151'}
2025-03-01 19:47:03,338 - {'Epoch': 22, 'HR@5': '0.0521', 'NDCG@5': '0.0359', 'HR@10': '0.0729', 'NDCG@10': '0.0426', 'HR@20': '0.1026', 'NDCG@20': '0.0501'}
2025-03-01 19:47:03,344 - Validation score increased.  Saving model ...
2025-03-01 19:47:45,227 - {'epoch': 23, 'rec_loss': '7.8015'}
2025-03-01 19:48:05,914 - {'Epoch': 23, 'HR@5': '0.0525', 'NDCG@5': '0.0366', 'HR@10': '0.0732', 'NDCG@10': '0.0432', 'HR@20': '0.1033', 'NDCG@20': '0.0508'}
2025-03-01 19:48:05,919 - Validation score increased.  Saving model ...
2025-03-01 19:48:52,169 - {'epoch': 24, 'rec_loss': '7.7853'}
2025-03-01 19:49:11,171 - {'Epoch': 24, 'HR@5': '0.0502', 'NDCG@5': '0.0347', 'HR@10': '0.0730', 'NDCG@10': '0.0420', 'HR@20': '0.1033', 'NDCG@20': '0.0496'}
2025-03-01 19:49:11,175 - EarlyStopping counter: 1 out of 10
2025-03-01 19:49:51,611 - {'epoch': 25, 'rec_loss': '7.7697'}
2025-03-01 19:50:10,651 - {'Epoch': 25, 'HR@5': '0.0519', 'NDCG@5': '0.0359', 'HR@10': '0.0732', 'NDCG@10': '0.0427', 'HR@20': '0.1042', 'NDCG@20': '0.0505'}
2025-03-01 19:50:10,658 - EarlyStopping counter: 2 out of 10
2025-03-01 19:50:57,900 - {'epoch': 26, 'rec_loss': '7.7590'}
2025-03-01 19:51:17,597 - {'Epoch': 26, 'HR@5': '0.0520', 'NDCG@5': '0.0357', 'HR@10': '0.0735', 'NDCG@10': '0.0426', 'HR@20': '0.1035', 'NDCG@20': '0.0501'}
2025-03-01 19:51:17,598 - EarlyStopping counter: 3 out of 10
2025-03-01 19:51:59,293 - {'epoch': 27, 'rec_loss': '7.7491'}
2025-03-01 19:52:18,631 - {'Epoch': 27, 'HR@5': '0.0515', 'NDCG@5': '0.0357', 'HR@10': '0.0737', 'NDCG@10': '0.0429', 'HR@20': '0.1043', 'NDCG@20': '0.0506'}
2025-03-01 19:52:18,639 - EarlyStopping counter: 4 out of 10
2025-03-01 19:53:04,020 - {'epoch': 28, 'rec_loss': '7.7360'}
2025-03-01 19:53:24,831 - {'Epoch': 28, 'HR@5': '0.0511', 'NDCG@5': '0.0355', 'HR@10': '0.0733', 'NDCG@10': '0.0427', 'HR@20': '0.1044', 'NDCG@20': '0.0505'}
2025-03-01 19:53:24,834 - EarlyStopping counter: 5 out of 10
2025-03-01 19:54:06,554 - {'epoch': 29, 'rec_loss': '7.7237'}
2025-03-01 19:54:24,982 - {'Epoch': 29, 'HR@5': '0.0514', 'NDCG@5': '0.0357', 'HR@10': '0.0744', 'NDCG@10': '0.0432', 'HR@20': '0.1053', 'NDCG@20': '0.0509'}
2025-03-01 19:54:24,984 - Validation score increased.  Saving model ...
2025-03-01 19:55:05,407 - {'epoch': 30, 'rec_loss': '7.7106'}
2025-03-01 19:55:26,021 - {'Epoch': 30, 'HR@5': '0.0516', 'NDCG@5': '0.0355', 'HR@10': '0.0742', 'NDCG@10': '0.0428', 'HR@20': '0.1038', 'NDCG@20': '0.0502'}
2025-03-01 19:55:26,022 - EarlyStopping counter: 1 out of 10
2025-03-01 19:56:13,070 - {'epoch': 31, 'rec_loss': '7.7066'}
2025-03-01 19:56:31,535 - {'Epoch': 31, 'HR@5': '0.0512', 'NDCG@5': '0.0357', 'HR@10': '0.0738', 'NDCG@10': '0.0430', 'HR@20': '0.1039', 'NDCG@20': '0.0505'}
2025-03-01 19:56:31,543 - EarlyStopping counter: 2 out of 10
2025-03-01 19:57:13,035 - {'epoch': 32, 'rec_loss': '7.6961'}
2025-03-01 19:57:32,534 - {'Epoch': 32, 'HR@5': '0.0515', 'NDCG@5': '0.0358', 'HR@10': '0.0739', 'NDCG@10': '0.0431', 'HR@20': '0.1042', 'NDCG@20': '0.0507'}
2025-03-01 19:57:32,542 - EarlyStopping counter: 3 out of 10
2025-03-01 19:58:20,759 - {'epoch': 33, 'rec_loss': '7.6900'}
2025-03-01 19:58:41,523 - {'Epoch': 33, 'HR@5': '0.0511', 'NDCG@5': '0.0358', 'HR@10': '0.0731', 'NDCG@10': '0.0429', 'HR@20': '0.1032', 'NDCG@20': '0.0505'}
2025-03-01 19:58:41,531 - EarlyStopping counter: 4 out of 10
2025-03-01 19:59:22,346 - {'epoch': 34, 'rec_loss': '7.6815'}
2025-03-01 19:59:40,203 - {'Epoch': 34, 'HR@5': '0.0515', 'NDCG@5': '0.0356', 'HR@10': '0.0734', 'NDCG@10': '0.0426', 'HR@20': '0.1031', 'NDCG@20': '0.0501'}
2025-03-01 19:59:40,208 - EarlyStopping counter: 5 out of 10
2025-03-01 20:00:22,411 - {'epoch': 35, 'rec_loss': '7.6717'}
2025-03-01 20:00:43,125 - {'Epoch': 35, 'HR@5': '0.0518', 'NDCG@5': '0.0362', 'HR@10': '0.0740', 'NDCG@10': '0.0433', 'HR@20': '0.1045', 'NDCG@20': '0.0510'}
2025-03-01 20:00:43,130 - Validation score increased.  Saving model ...
2025-03-01 20:01:29,158 - {'epoch': 36, 'rec_loss': '7.6719'}
2025-03-01 20:01:48,780 - {'Epoch': 36, 'HR@5': '0.0517', 'NDCG@5': '0.0362', 'HR@10': '0.0740', 'NDCG@10': '0.0433', 'HR@20': '0.1042', 'NDCG@20': '0.0509'}
2025-03-01 20:01:48,781 - EarlyStopping counter: 1 out of 10
2025-03-01 20:02:28,546 - {'epoch': 37, 'rec_loss': '7.6573'}
2025-03-01 20:02:47,500 - {'Epoch': 37, 'HR@5': '0.0516', 'NDCG@5': '0.0355', 'HR@10': '0.0750', 'NDCG@10': '0.0430', 'HR@20': '0.1040', 'NDCG@20': '0.0503'}
2025-03-01 20:02:47,505 - EarlyStopping counter: 2 out of 10
2025-03-01 20:03:34,719 - {'epoch': 38, 'rec_loss': '7.6472'}
2025-03-01 20:03:54,616 - {'Epoch': 38, 'HR@5': '0.0532', 'NDCG@5': '0.0362', 'HR@10': '0.0759', 'NDCG@10': '0.0435', 'HR@20': '0.1047', 'NDCG@20': '0.0508'}
2025-03-01 20:03:54,622 - EarlyStopping counter: 3 out of 10
2025-03-01 20:04:34,037 - {'epoch': 39, 'rec_loss': '7.6415'}
2025-03-01 20:04:51,559 - {'Epoch': 39, 'HR@5': '0.0520', 'NDCG@5': '0.0358', 'HR@10': '0.0742', 'NDCG@10': '0.0430', 'HR@20': '0.1040', 'NDCG@20': '0.0505'}
2025-03-01 20:04:51,566 - EarlyStopping counter: 4 out of 10
2025-03-01 20:05:34,485 - {'epoch': 40, 'rec_loss': '7.6342'}
2025-03-01 20:05:53,874 - {'Epoch': 40, 'HR@5': '0.0524', 'NDCG@5': '0.0354', 'HR@10': '0.0754', 'NDCG@10': '0.0428', 'HR@20': '0.1053', 'NDCG@20': '0.0504'}
2025-03-01 20:05:53,875 - EarlyStopping counter: 5 out of 10
2025-03-01 20:06:38,085 - {'epoch': 41, 'rec_loss': '7.6319'}
2025-03-01 20:06:57,121 - {'Epoch': 41, 'HR@5': '0.0528', 'NDCG@5': '0.0362', 'HR@10': '0.0752', 'NDCG@10': '0.0434', 'HR@20': '0.1052', 'NDCG@20': '0.0509'}
2025-03-01 20:06:57,125 - EarlyStopping counter: 6 out of 10
2025-03-01 20:07:37,561 - {'epoch': 42, 'rec_loss': '7.6277'}
2025-03-01 20:07:58,065 - {'Epoch': 42, 'HR@5': '0.0512', 'NDCG@5': '0.0355', 'HR@10': '0.0749', 'NDCG@10': '0.0431', 'HR@20': '0.1046', 'NDCG@20': '0.0506'}
2025-03-01 20:07:58,069 - EarlyStopping counter: 7 out of 10
2025-03-01 20:08:42,528 - {'epoch': 43, 'rec_loss': '7.6204'}
2025-03-01 20:09:02,693 - {'Epoch': 43, 'HR@5': '0.0515', 'NDCG@5': '0.0355', 'HR@10': '0.0750', 'NDCG@10': '0.0431', 'HR@20': '0.1041', 'NDCG@20': '0.0504'}
2025-03-01 20:09:02,701 - EarlyStopping counter: 8 out of 10
2025-03-01 20:09:44,102 - {'epoch': 44, 'rec_loss': '7.6174'}
2025-03-01 20:10:04,209 - {'Epoch': 44, 'HR@5': '0.0519', 'NDCG@5': '0.0361', 'HR@10': '0.0754', 'NDCG@10': '0.0437', 'HR@20': '0.1050', 'NDCG@20': '0.0511'}
2025-03-01 20:10:04,214 - Validation score increased.  Saving model ...
2025-03-01 20:10:51,761 - {'epoch': 45, 'rec_loss': '7.6087'}
2025-03-01 20:11:11,880 - {'Epoch': 45, 'HR@5': '0.0526', 'NDCG@5': '0.0362', 'HR@10': '0.0745', 'NDCG@10': '0.0433', 'HR@20': '0.1044', 'NDCG@20': '0.0508'}
2025-03-01 20:11:11,885 - EarlyStopping counter: 1 out of 10
2025-03-01 20:11:56,080 - {'epoch': 46, 'rec_loss': '7.6037'}
2025-03-01 20:12:15,995 - {'Epoch': 46, 'HR@5': '0.0526', 'NDCG@5': '0.0364', 'HR@10': '0.0746', 'NDCG@10': '0.0435', 'HR@20': '0.1055', 'NDCG@20': '0.0513'}
2025-03-01 20:12:15,996 - Validation score increased.  Saving model ...
2025-03-01 20:13:05,657 - {'epoch': 47, 'rec_loss': '7.6034'}
2025-03-01 20:13:26,118 - {'Epoch': 47, 'HR@5': '0.0520', 'NDCG@5': '0.0359', 'HR@10': '0.0749', 'NDCG@10': '0.0432', 'HR@20': '0.1046', 'NDCG@20': '0.0507'}
2025-03-01 20:13:26,120 - EarlyStopping counter: 1 out of 10
2025-03-01 20:14:08,367 - {'epoch': 48, 'rec_loss': '7.5921'}
2025-03-01 20:14:24,675 - {'Epoch': 48, 'HR@5': '0.0528', 'NDCG@5': '0.0365', 'HR@10': '0.0749', 'NDCG@10': '0.0437', 'HR@20': '0.1053', 'NDCG@20': '0.0513'}
2025-03-01 20:14:24,680 - Validation score increased.  Saving model ...
2025-03-01 20:15:10,047 - {'epoch': 49, 'rec_loss': '7.5908'}
2025-03-01 20:15:30,518 - {'Epoch': 49, 'HR@5': '0.0525', 'NDCG@5': '0.0361', 'HR@10': '0.0760', 'NDCG@10': '0.0436', 'HR@20': '0.1064', 'NDCG@20': '0.0513'}
2025-03-01 20:15:30,519 - EarlyStopping counter: 1 out of 10
2025-03-01 20:16:14,017 - {'epoch': 50, 'rec_loss': '7.5931'}
2025-03-01 20:16:32,331 - {'Epoch': 50, 'HR@5': '0.0521', 'NDCG@5': '0.0363', 'HR@10': '0.0743', 'NDCG@10': '0.0434', 'HR@20': '0.1046', 'NDCG@20': '0.0511'}
2025-03-01 20:16:32,334 - EarlyStopping counter: 2 out of 10
2025-03-01 20:17:13,627 - {'epoch': 51, 'rec_loss': '7.5816'}
2025-03-01 20:17:33,639 - {'Epoch': 51, 'HR@5': '0.0524', 'NDCG@5': '0.0363', 'HR@10': '0.0759', 'NDCG@10': '0.0438', 'HR@20': '0.1057', 'NDCG@20': '0.0513'}
2025-03-01 20:17:33,643 - EarlyStopping counter: 3 out of 10
2025-03-01 20:18:19,688 - {'epoch': 52, 'rec_loss': '7.5766'}
2025-03-01 20:18:39,652 - {'Epoch': 52, 'HR@5': '0.0521', 'NDCG@5': '0.0363', 'HR@10': '0.0756', 'NDCG@10': '0.0439', 'HR@20': '0.1061', 'NDCG@20': '0.0515'}
2025-03-01 20:18:39,657 - Validation score increased.  Saving model ...
2025-03-01 20:19:20,829 - {'epoch': 53, 'rec_loss': '7.5758'}
2025-03-01 20:19:40,776 - {'Epoch': 53, 'HR@5': '0.0523', 'NDCG@5': '0.0359', 'HR@10': '0.0758', 'NDCG@10': '0.0435', 'HR@20': '0.1054', 'NDCG@20': '0.0509'}
2025-03-01 20:19:40,777 - EarlyStopping counter: 1 out of 10
2025-03-01 20:20:25,685 - {'epoch': 54, 'rec_loss': '7.5689'}
2025-03-01 20:20:45,099 - {'Epoch': 54, 'HR@5': '0.0507', 'NDCG@5': '0.0353', 'HR@10': '0.0740', 'NDCG@10': '0.0428', 'HR@20': '0.1051', 'NDCG@20': '0.0507'}
2025-03-01 20:20:45,102 - EarlyStopping counter: 2 out of 10
2025-03-01 20:21:27,957 - {'epoch': 55, 'rec_loss': '7.5661'}
2025-03-01 20:21:45,404 - {'Epoch': 55, 'HR@5': '0.0515', 'NDCG@5': '0.0356', 'HR@10': '0.0735', 'NDCG@10': '0.0426', 'HR@20': '0.1048', 'NDCG@20': '0.0505'}
2025-03-01 20:21:45,407 - EarlyStopping counter: 3 out of 10
2025-03-01 20:22:32,588 - {'epoch': 56, 'rec_loss': '7.5614'}
2025-03-01 20:22:52,563 - {'Epoch': 56, 'HR@5': '0.0516', 'NDCG@5': '0.0359', 'HR@10': '0.0744', 'NDCG@10': '0.0432', 'HR@20': '0.1059', 'NDCG@20': '0.0511'}
2025-03-01 20:22:52,568 - EarlyStopping counter: 4 out of 10
2025-03-01 20:23:45,565 - {'epoch': 57, 'rec_loss': '7.5514'}
2025-03-01 20:24:07,692 - {'Epoch': 57, 'HR@5': '0.0521', 'NDCG@5': '0.0363', 'HR@10': '0.0745', 'NDCG@10': '0.0435', 'HR@20': '0.1058', 'NDCG@20': '0.0513'}
2025-03-01 20:24:07,693 - EarlyStopping counter: 5 out of 10
2025-03-01 20:24:57,987 - {'epoch': 58, 'rec_loss': '7.5546'}
2025-03-01 20:25:24,081 - {'Epoch': 58, 'HR@5': '0.0519', 'NDCG@5': '0.0361', 'HR@10': '0.0748', 'NDCG@10': '0.0434', 'HR@20': '0.1059', 'NDCG@20': '0.0513'}
2025-03-01 20:25:24,087 - EarlyStopping counter: 6 out of 10
2025-03-01 20:26:29,306 - {'epoch': 59, 'rec_loss': '7.5506'}
2025-03-01 20:26:50,024 - {'Epoch': 59, 'HR@5': '0.0522', 'NDCG@5': '0.0362', 'HR@10': '0.0742', 'NDCG@10': '0.0433', 'HR@20': '0.1043', 'NDCG@20': '0.0509'}
2025-03-01 20:26:50,025 - EarlyStopping counter: 7 out of 10
2025-03-01 20:27:39,709 - {'epoch': 60, 'rec_loss': '7.5426'}
2025-03-01 20:28:01,051 - {'Epoch': 60, 'HR@5': '0.0515', 'NDCG@5': '0.0359', 'HR@10': '0.0752', 'NDCG@10': '0.0435', 'HR@20': '0.1060', 'NDCG@20': '0.0513'}
2025-03-01 20:28:01,055 - EarlyStopping counter: 8 out of 10
2025-03-01 20:28:47,486 - {'epoch': 61, 'rec_loss': '7.5401'}
2025-03-01 20:29:09,923 - {'Epoch': 61, 'HR@5': '0.0521', 'NDCG@5': '0.0361', 'HR@10': '0.0749', 'NDCG@10': '0.0434', 'HR@20': '0.1056', 'NDCG@20': '0.0512'}
2025-03-01 20:29:09,928 - EarlyStopping counter: 9 out of 10
2025-03-01 20:29:54,353 - {'epoch': 62, 'rec_loss': '7.5436'}
2025-03-01 20:30:13,098 - {'Epoch': 62, 'HR@5': '0.0509', 'NDCG@5': '0.0356', 'HR@10': '0.0740', 'NDCG@10': '0.0430', 'HR@20': '0.1057', 'NDCG@20': '0.0510'}
2025-03-01 20:30:13,102 - EarlyStopping counter: 10 out of 10
2025-03-01 20:30:13,103 - Early stopping
2025-03-01 20:30:13,103 - ---------------Test Score---------------
2025-03-01 20:30:34,097 - {'Epoch': 0, 'HR@5': '0.0434', 'NDCG@5': '0.0299', 'HR@10': '0.0618', 'NDCG@10': '0.0359', 'HR@20': '0.0873', 'NDCG@20': '0.0423'}
2025-03-01 20:30:34,102 - Scale_Sports
2025-03-01 20:30:34,102 - {'Epoch': 0, 'HR@5': '0.0434', 'NDCG@5': '0.0299', 'HR@10': '0.0618', 'NDCG@10': '0.0359', 'HR@20': '0.0873', 'NDCG@20': '0.0423'}
2025-03-01 20:37:22,846 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[8, 16, 32], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-01 20:37:25,863 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-01 20:37:25,868 - Total Parameters: 1328854
2025-03-01 20:38:08,420 - {'epoch': 0, 'rec_loss': '9.4024'}
2025-03-01 20:38:28,129 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0054', 'HR@10': '0.0125', 'NDCG@10': '0.0068', 'HR@20': '0.0214', 'NDCG@20': '0.0090'}
2025-03-01 20:38:28,130 - Validation score increased.  Saving model ...
2025-03-01 20:39:09,676 - {'epoch': 1, 'rec_loss': '9.2172'}
2025-03-01 20:39:27,581 - {'Epoch': 1, 'HR@5': '0.0136', 'NDCG@5': '0.0085', 'HR@10': '0.0223', 'NDCG@10': '0.0113', 'HR@20': '0.0381', 'NDCG@20': '0.0153'}
2025-03-01 20:39:27,582 - Validation score increased.  Saving model ...
2025-03-01 20:40:12,051 - {'epoch': 2, 'rec_loss': '8.9530'}
2025-03-01 20:40:31,231 - {'Epoch': 2, 'HR@5': '0.0180', 'NDCG@5': '0.0119', 'HR@10': '0.0303', 'NDCG@10': '0.0159', 'HR@20': '0.0488', 'NDCG@20': '0.0205'}
2025-03-01 20:40:31,235 - Validation score increased.  Saving model ...
2025-03-01 20:41:13,057 - {'epoch': 3, 'rec_loss': '8.7604'}
2025-03-01 20:41:31,015 - {'Epoch': 3, 'HR@5': '0.0267', 'NDCG@5': '0.0174', 'HR@10': '0.0406', 'NDCG@10': '0.0219', 'HR@20': '0.0634', 'NDCG@20': '0.0276'}
2025-03-01 20:41:31,016 - Validation score increased.  Saving model ...
2025-03-01 20:42:15,193 - {'epoch': 4, 'rec_loss': '8.6104'}
2025-03-01 20:42:33,657 - {'Epoch': 4, 'HR@5': '0.0299', 'NDCG@5': '0.0196', 'HR@10': '0.0467', 'NDCG@10': '0.0250', 'HR@20': '0.0707', 'NDCG@20': '0.0310'}
2025-03-01 20:42:33,658 - Validation score increased.  Saving model ...
2025-03-01 20:43:14,194 - {'epoch': 5, 'rec_loss': '8.4876'}
2025-03-01 20:43:33,964 - {'Epoch': 5, 'HR@5': '0.0363', 'NDCG@5': '0.0243', 'HR@10': '0.0533', 'NDCG@10': '0.0298', 'HR@20': '0.0776', 'NDCG@20': '0.0359'}
2025-03-01 20:43:33,968 - Validation score increased.  Saving model ...
2025-03-01 20:44:13,783 - {'epoch': 6, 'rec_loss': '8.3958'}
2025-03-01 20:44:32,863 - {'Epoch': 6, 'HR@5': '0.0380', 'NDCG@5': '0.0256', 'HR@10': '0.0565', 'NDCG@10': '0.0315', 'HR@20': '0.0829', 'NDCG@20': '0.0382'}
2025-03-01 20:44:32,865 - Validation score increased.  Saving model ...
2025-03-01 20:45:15,279 - {'epoch': 7, 'rec_loss': '8.3142'}
2025-03-01 20:45:33,853 - {'Epoch': 7, 'HR@5': '0.0402', 'NDCG@5': '0.0276', 'HR@10': '0.0602', 'NDCG@10': '0.0340', 'HR@20': '0.0861', 'NDCG@20': '0.0405'}
2025-03-01 20:45:33,854 - Validation score increased.  Saving model ...
2025-03-01 20:46:17,302 - {'epoch': 8, 'rec_loss': '8.2457'}
2025-03-01 20:46:35,057 - {'Epoch': 8, 'HR@5': '0.0429', 'NDCG@5': '0.0297', 'HR@10': '0.0611', 'NDCG@10': '0.0355', 'HR@20': '0.0884', 'NDCG@20': '0.0424'}
2025-03-01 20:46:35,063 - Validation score increased.  Saving model ...
2025-03-01 20:47:17,828 - {'epoch': 9, 'rec_loss': '8.1891'}
2025-03-01 20:47:36,743 - {'Epoch': 9, 'HR@5': '0.0447', 'NDCG@5': '0.0307', 'HR@10': '0.0638', 'NDCG@10': '0.0369', 'HR@20': '0.0911', 'NDCG@20': '0.0437'}
2025-03-01 20:47:36,749 - Validation score increased.  Saving model ...
2025-03-01 20:48:18,212 - {'epoch': 10, 'rec_loss': '8.1436'}
2025-03-01 20:48:37,296 - {'Epoch': 10, 'HR@5': '0.0446', 'NDCG@5': '0.0310', 'HR@10': '0.0642', 'NDCG@10': '0.0373', 'HR@20': '0.0919', 'NDCG@20': '0.0443'}
2025-03-01 20:48:37,299 - Validation score increased.  Saving model ...
2025-03-01 20:49:16,538 - {'epoch': 11, 'rec_loss': '8.0940'}
2025-03-01 20:49:36,516 - {'Epoch': 11, 'HR@5': '0.0464', 'NDCG@5': '0.0318', 'HR@10': '0.0667', 'NDCG@10': '0.0383', 'HR@20': '0.0946', 'NDCG@20': '0.0453'}
2025-03-01 20:49:36,520 - Validation score increased.  Saving model ...
2025-03-01 20:50:18,177 - {'epoch': 12, 'rec_loss': '8.0602'}
2025-03-01 20:50:36,434 - {'Epoch': 12, 'HR@5': '0.0474', 'NDCG@5': '0.0328', 'HR@10': '0.0676', 'NDCG@10': '0.0393', 'HR@20': '0.0953', 'NDCG@20': '0.0462'}
2025-03-01 20:50:36,436 - Validation score increased.  Saving model ...
2025-03-01 20:51:18,633 - {'epoch': 13, 'rec_loss': '8.0275'}
2025-03-01 20:51:36,843 - {'Epoch': 13, 'HR@5': '0.0473', 'NDCG@5': '0.0328', 'HR@10': '0.0672', 'NDCG@10': '0.0391', 'HR@20': '0.0963', 'NDCG@20': '0.0464'}
2025-03-01 20:51:36,844 - Validation score increased.  Saving model ...
2025-03-01 20:52:19,829 - {'epoch': 14, 'rec_loss': '7.9985'}
2025-03-01 20:52:38,248 - {'Epoch': 14, 'HR@5': '0.0482', 'NDCG@5': '0.0333', 'HR@10': '0.0684', 'NDCG@10': '0.0398', 'HR@20': '0.0975', 'NDCG@20': '0.0471'}
2025-03-01 20:52:38,253 - Validation score increased.  Saving model ...
2025-03-01 20:53:19,655 - {'epoch': 15, 'rec_loss': '7.9702'}
2025-03-01 20:53:39,191 - {'Epoch': 15, 'HR@5': '0.0483', 'NDCG@5': '0.0335', 'HR@10': '0.0692', 'NDCG@10': '0.0402', 'HR@20': '0.0972', 'NDCG@20': '0.0473'}
2025-03-01 20:53:39,193 - Validation score increased.  Saving model ...
2025-03-01 20:54:17,041 - {'epoch': 16, 'rec_loss': '7.9452'}
2025-03-01 20:54:36,508 - {'Epoch': 16, 'HR@5': '0.0483', 'NDCG@5': '0.0335', 'HR@10': '0.0692', 'NDCG@10': '0.0402', 'HR@20': '0.0979', 'NDCG@20': '0.0474'}
2025-03-01 20:54:36,516 - Validation score increased.  Saving model ...
2025-03-01 20:55:17,944 - {'epoch': 17, 'rec_loss': '7.9230'}
2025-03-01 20:55:35,037 - {'Epoch': 17, 'HR@5': '0.0486', 'NDCG@5': '0.0341', 'HR@10': '0.0694', 'NDCG@10': '0.0408', 'HR@20': '0.0983', 'NDCG@20': '0.0480'}
2025-03-01 20:55:35,042 - Validation score increased.  Saving model ...
2025-03-01 20:56:14,504 - {'epoch': 18, 'rec_loss': '7.8985'}
2025-03-01 20:56:31,299 - {'Epoch': 18, 'HR@5': '0.0492', 'NDCG@5': '0.0344', 'HR@10': '0.0704', 'NDCG@10': '0.0411', 'HR@20': '0.1008', 'NDCG@20': '0.0488'}
2025-03-01 20:56:31,305 - Validation score increased.  Saving model ...
2025-03-01 20:57:12,534 - {'epoch': 19, 'rec_loss': '7.8773'}
2025-03-01 20:57:31,529 - {'Epoch': 19, 'HR@5': '0.0492', 'NDCG@5': '0.0346', 'HR@10': '0.0709', 'NDCG@10': '0.0416', 'HR@20': '0.1005', 'NDCG@20': '0.0490'}
2025-03-01 20:57:31,530 - Validation score increased.  Saving model ...
2025-03-01 20:58:13,269 - {'epoch': 20, 'rec_loss': '7.8634'}
2025-03-01 20:58:30,998 - {'Epoch': 20, 'HR@5': '0.0504', 'NDCG@5': '0.0351', 'HR@10': '0.0722', 'NDCG@10': '0.0422', 'HR@20': '0.1025', 'NDCG@20': '0.0498'}
2025-03-01 20:58:31,000 - Validation score increased.  Saving model ...
2025-03-01 20:59:12,179 - {'epoch': 21, 'rec_loss': '7.8406'}
2025-03-01 20:59:29,771 - {'Epoch': 21, 'HR@5': '0.0490', 'NDCG@5': '0.0342', 'HR@10': '0.0706', 'NDCG@10': '0.0411', 'HR@20': '0.1021', 'NDCG@20': '0.0490'}
2025-03-01 20:59:29,775 - EarlyStopping counter: 1 out of 10
2025-03-01 21:00:08,909 - {'epoch': 22, 'rec_loss': '7.8283'}
2025-03-01 21:00:27,748 - {'Epoch': 22, 'HR@5': '0.0500', 'NDCG@5': '0.0348', 'HR@10': '0.0708', 'NDCG@10': '0.0415', 'HR@20': '0.1028', 'NDCG@20': '0.0496'}
2025-03-01 21:00:27,756 - EarlyStopping counter: 2 out of 10
2025-03-01 21:01:06,418 - {'epoch': 23, 'rec_loss': '7.8118'}
2025-03-01 21:01:25,866 - {'Epoch': 23, 'HR@5': '0.0497', 'NDCG@5': '0.0346', 'HR@10': '0.0721', 'NDCG@10': '0.0418', 'HR@20': '0.1019', 'NDCG@20': '0.0493'}
2025-03-01 21:01:25,871 - EarlyStopping counter: 3 out of 10
2025-03-01 21:02:08,369 - {'epoch': 24, 'rec_loss': '7.7990'}
2025-03-01 21:02:27,331 - {'Epoch': 24, 'HR@5': '0.0506', 'NDCG@5': '0.0353', 'HR@10': '0.0724', 'NDCG@10': '0.0423', 'HR@20': '0.1026', 'NDCG@20': '0.0500'}
2025-03-01 21:02:27,332 - Validation score increased.  Saving model ...
2025-03-01 21:03:07,825 - {'epoch': 25, 'rec_loss': '7.7828'}
2025-03-01 21:03:24,313 - {'Epoch': 25, 'HR@5': '0.0507', 'NDCG@5': '0.0352', 'HR@10': '0.0730', 'NDCG@10': '0.0424', 'HR@20': '0.1036', 'NDCG@20': '0.0501'}
2025-03-01 21:03:24,317 - Validation score increased.  Saving model ...
2025-03-01 21:04:06,744 - {'epoch': 26, 'rec_loss': '7.7715'}
2025-03-01 21:04:27,731 - {'Epoch': 26, 'HR@5': '0.0512', 'NDCG@5': '0.0358', 'HR@10': '0.0730', 'NDCG@10': '0.0428', 'HR@20': '0.1032', 'NDCG@20': '0.0504'}
2025-03-01 21:04:27,740 - Validation score increased.  Saving model ...
2025-03-01 21:05:18,919 - {'epoch': 27, 'rec_loss': '7.7545'}
2025-03-01 21:05:38,639 - {'Epoch': 27, 'HR@5': '0.0517', 'NDCG@5': '0.0357', 'HR@10': '0.0739', 'NDCG@10': '0.0429', 'HR@20': '0.1036', 'NDCG@20': '0.0503'}
2025-03-01 21:05:38,640 - EarlyStopping counter: 1 out of 10
2025-03-01 21:06:18,984 - {'epoch': 28, 'rec_loss': '7.7498'}
2025-03-01 21:06:38,440 - {'Epoch': 28, 'HR@5': '0.0510', 'NDCG@5': '0.0358', 'HR@10': '0.0735', 'NDCG@10': '0.0430', 'HR@20': '0.1033', 'NDCG@20': '0.0505'}
2025-03-01 21:06:38,442 - Validation score increased.  Saving model ...
2025-03-01 21:07:19,141 - {'epoch': 29, 'rec_loss': '7.7391'}
2025-03-01 21:07:38,881 - {'Epoch': 29, 'HR@5': '0.0507', 'NDCG@5': '0.0356', 'HR@10': '0.0737', 'NDCG@10': '0.0429', 'HR@20': '0.1040', 'NDCG@20': '0.0506'}
2025-03-01 21:07:38,892 - Validation score increased.  Saving model ...
2025-03-01 21:08:21,203 - {'epoch': 30, 'rec_loss': '7.7307'}
2025-03-01 21:08:39,003 - {'Epoch': 30, 'HR@5': '0.0509', 'NDCG@5': '0.0355', 'HR@10': '0.0741', 'NDCG@10': '0.0429', 'HR@20': '0.1033', 'NDCG@20': '0.0503'}
2025-03-01 21:08:39,009 - EarlyStopping counter: 1 out of 10
2025-03-01 21:09:20,462 - {'epoch': 31, 'rec_loss': '7.7203'}
2025-03-01 21:09:37,361 - {'Epoch': 31, 'HR@5': '0.0507', 'NDCG@5': '0.0354', 'HR@10': '0.0733', 'NDCG@10': '0.0427', 'HR@20': '0.1045', 'NDCG@20': '0.0505'}
2025-03-01 21:09:37,362 - EarlyStopping counter: 2 out of 10
2025-03-01 21:10:18,777 - {'epoch': 32, 'rec_loss': '7.7082'}
2025-03-01 21:10:35,195 - {'Epoch': 32, 'HR@5': '0.0513', 'NDCG@5': '0.0354', 'HR@10': '0.0745', 'NDCG@10': '0.0428', 'HR@20': '0.1043', 'NDCG@20': '0.0503'}
2025-03-01 21:10:35,197 - EarlyStopping counter: 3 out of 10
2025-03-01 21:11:16,581 - {'epoch': 33, 'rec_loss': '7.7026'}
2025-03-01 21:11:35,774 - {'Epoch': 33, 'HR@5': '0.0526', 'NDCG@5': '0.0363', 'HR@10': '0.0742', 'NDCG@10': '0.0433', 'HR@20': '0.1049', 'NDCG@20': '0.0510'}
2025-03-01 21:11:35,783 - Validation score increased.  Saving model ...
2025-03-01 21:12:15,868 - {'epoch': 34, 'rec_loss': '7.7018'}
2025-03-01 21:12:34,755 - {'Epoch': 34, 'HR@5': '0.0510', 'NDCG@5': '0.0355', 'HR@10': '0.0735', 'NDCG@10': '0.0427', 'HR@20': '0.1049', 'NDCG@20': '0.0506'}
2025-03-01 21:12:34,756 - EarlyStopping counter: 1 out of 10
2025-03-01 21:13:13,823 - {'epoch': 35, 'rec_loss': '7.6897'}
2025-03-01 21:13:31,099 - {'Epoch': 35, 'HR@5': '0.0518', 'NDCG@5': '0.0359', 'HR@10': '0.0752', 'NDCG@10': '0.0434', 'HR@20': '0.1063', 'NDCG@20': '0.0513'}
2025-03-01 21:13:31,101 - Validation score increased.  Saving model ...
2025-03-01 21:14:11,842 - {'epoch': 36, 'rec_loss': '7.6825'}
2025-03-01 21:14:28,549 - {'Epoch': 36, 'HR@5': '0.0514', 'NDCG@5': '0.0359', 'HR@10': '0.0746', 'NDCG@10': '0.0434', 'HR@20': '0.1055', 'NDCG@20': '0.0512'}
2025-03-01 21:14:28,555 - EarlyStopping counter: 1 out of 10
2025-03-01 21:15:10,215 - {'epoch': 37, 'rec_loss': '7.6731'}
2025-03-01 21:15:27,366 - {'Epoch': 37, 'HR@5': '0.0519', 'NDCG@5': '0.0361', 'HR@10': '0.0751', 'NDCG@10': '0.0436', 'HR@20': '0.1060', 'NDCG@20': '0.0513'}
2025-03-01 21:15:27,367 - Validation score increased.  Saving model ...
2025-03-01 21:16:09,671 - {'epoch': 38, 'rec_loss': '7.6625'}
2025-03-01 21:16:29,376 - {'Epoch': 38, 'HR@5': '0.0525', 'NDCG@5': '0.0363', 'HR@10': '0.0749', 'NDCG@10': '0.0436', 'HR@20': '0.1053', 'NDCG@20': '0.0512'}
2025-03-01 21:16:29,379 - EarlyStopping counter: 1 out of 10
2025-03-01 21:17:08,885 - {'epoch': 39, 'rec_loss': '7.6595'}
2025-03-01 21:17:28,262 - {'Epoch': 39, 'HR@5': '0.0523', 'NDCG@5': '0.0364', 'HR@10': '0.0752', 'NDCG@10': '0.0437', 'HR@20': '0.1059', 'NDCG@20': '0.0514'}
2025-03-01 21:17:28,266 - Validation score increased.  Saving model ...
2025-03-01 21:18:10,308 - {'epoch': 40, 'rec_loss': '7.6536'}
2025-03-01 21:18:29,674 - {'Epoch': 40, 'HR@5': '0.0522', 'NDCG@5': '0.0365', 'HR@10': '0.0749', 'NDCG@10': '0.0438', 'HR@20': '0.1049', 'NDCG@20': '0.0514'}
2025-03-01 21:18:29,676 - EarlyStopping counter: 1 out of 10
2025-03-01 21:19:11,007 - {'epoch': 41, 'rec_loss': '7.6425'}
2025-03-01 21:19:27,805 - {'Epoch': 41, 'HR@5': '0.0521', 'NDCG@5': '0.0364', 'HR@10': '0.0747', 'NDCG@10': '0.0437', 'HR@20': '0.1051', 'NDCG@20': '0.0514'}
2025-03-01 21:19:27,806 - EarlyStopping counter: 2 out of 10
2025-03-01 21:20:10,939 - {'epoch': 42, 'rec_loss': '7.6399'}
2025-03-01 21:20:29,657 - {'Epoch': 42, 'HR@5': '0.0518', 'NDCG@5': '0.0362', 'HR@10': '0.0755', 'NDCG@10': '0.0438', 'HR@20': '0.1050', 'NDCG@20': '0.0512'}
2025-03-01 21:20:29,658 - EarlyStopping counter: 3 out of 10
2025-03-01 21:21:12,029 - {'epoch': 43, 'rec_loss': '7.6377'}
2025-03-01 21:21:30,307 - {'Epoch': 43, 'HR@5': '0.0519', 'NDCG@5': '0.0360', 'HR@10': '0.0750', 'NDCG@10': '0.0434', 'HR@20': '0.1057', 'NDCG@20': '0.0511'}
2025-03-01 21:21:30,311 - EarlyStopping counter: 4 out of 10
2025-03-01 21:22:11,616 - {'epoch': 44, 'rec_loss': '7.6328'}
2025-03-01 21:22:29,568 - {'Epoch': 44, 'HR@5': '0.0525', 'NDCG@5': '0.0364', 'HR@10': '0.0764', 'NDCG@10': '0.0441', 'HR@20': '0.1062', 'NDCG@20': '0.0516'}
2025-03-01 21:22:29,569 - Validation score increased.  Saving model ...
2025-03-01 21:23:12,364 - {'epoch': 45, 'rec_loss': '7.6268'}
2025-03-01 21:23:30,644 - {'Epoch': 45, 'HR@5': '0.0523', 'NDCG@5': '0.0364', 'HR@10': '0.0747', 'NDCG@10': '0.0435', 'HR@20': '0.1054', 'NDCG@20': '0.0513'}
2025-03-01 21:23:30,647 - EarlyStopping counter: 1 out of 10
2025-03-01 21:24:11,207 - {'epoch': 46, 'rec_loss': '7.6247'}
2025-03-01 21:24:30,694 - {'Epoch': 46, 'HR@5': '0.0522', 'NDCG@5': '0.0361', 'HR@10': '0.0748', 'NDCG@10': '0.0434', 'HR@20': '0.1053', 'NDCG@20': '0.0510'}
2025-03-01 21:24:30,697 - EarlyStopping counter: 2 out of 10
2025-03-01 21:25:11,416 - {'epoch': 47, 'rec_loss': '7.6234'}
2025-03-01 21:25:28,810 - {'Epoch': 47, 'HR@5': '0.0520', 'NDCG@5': '0.0361', 'HR@10': '0.0757', 'NDCG@10': '0.0437', 'HR@20': '0.1054', 'NDCG@20': '0.0512'}
2025-03-01 21:25:28,812 - EarlyStopping counter: 3 out of 10
2025-03-01 21:26:09,837 - {'epoch': 48, 'rec_loss': '7.6117'}
2025-03-01 21:26:28,922 - {'Epoch': 48, 'HR@5': '0.0516', 'NDCG@5': '0.0360', 'HR@10': '0.0752', 'NDCG@10': '0.0436', 'HR@20': '0.1055', 'NDCG@20': '0.0512'}
2025-03-01 21:26:28,927 - EarlyStopping counter: 4 out of 10
2025-03-01 21:27:12,106 - {'epoch': 49, 'rec_loss': '7.6115'}
2025-03-01 21:27:30,185 - {'Epoch': 49, 'HR@5': '0.0519', 'NDCG@5': '0.0363', 'HR@10': '0.0748', 'NDCG@10': '0.0436', 'HR@20': '0.1054', 'NDCG@20': '0.0513'}
2025-03-01 21:27:30,189 - EarlyStopping counter: 5 out of 10
2025-03-01 21:28:14,020 - {'epoch': 50, 'rec_loss': '7.6114'}
2025-03-01 21:28:32,246 - {'Epoch': 50, 'HR@5': '0.0516', 'NDCG@5': '0.0362', 'HR@10': '0.0762', 'NDCG@10': '0.0441', 'HR@20': '0.1061', 'NDCG@20': '0.0516'}
2025-03-01 21:28:32,249 - EarlyStopping counter: 6 out of 10
2025-03-01 21:29:13,205 - {'epoch': 51, 'rec_loss': '7.6025'}
2025-03-01 21:29:33,143 - {'Epoch': 51, 'HR@5': '0.0520', 'NDCG@5': '0.0363', 'HR@10': '0.0758', 'NDCG@10': '0.0439', 'HR@20': '0.1060', 'NDCG@20': '0.0515'}
2025-03-01 21:29:33,144 - EarlyStopping counter: 7 out of 10
2025-03-01 21:30:14,478 - {'epoch': 52, 'rec_loss': '7.5977'}
2025-03-01 21:30:35,141 - {'Epoch': 52, 'HR@5': '0.0515', 'NDCG@5': '0.0359', 'HR@10': '0.0756', 'NDCG@10': '0.0436', 'HR@20': '0.1058', 'NDCG@20': '0.0512'}
2025-03-01 21:30:35,142 - EarlyStopping counter: 8 out of 10
2025-03-01 21:31:17,658 - {'epoch': 53, 'rec_loss': '7.5971'}
2025-03-01 21:31:35,794 - {'Epoch': 53, 'HR@5': '0.0521', 'NDCG@5': '0.0360', 'HR@10': '0.0757', 'NDCG@10': '0.0436', 'HR@20': '0.1058', 'NDCG@20': '0.0512'}
2025-03-01 21:31:35,804 - EarlyStopping counter: 9 out of 10
2025-03-01 21:32:17,578 - {'epoch': 54, 'rec_loss': '7.5904'}
2025-03-01 21:32:35,438 - {'Epoch': 54, 'HR@5': '0.0531', 'NDCG@5': '0.0365', 'HR@10': '0.0765', 'NDCG@10': '0.0440', 'HR@20': '0.1070', 'NDCG@20': '0.0517'}
2025-03-01 21:32:35,445 - Validation score increased.  Saving model ...
2025-03-01 21:33:16,783 - {'epoch': 55, 'rec_loss': '7.5838'}
2025-03-01 21:33:33,980 - {'Epoch': 55, 'HR@5': '0.0531', 'NDCG@5': '0.0369', 'HR@10': '0.0771', 'NDCG@10': '0.0446', 'HR@20': '0.1060', 'NDCG@20': '0.0519'}
2025-03-01 21:33:33,982 - Validation score increased.  Saving model ...
2025-03-01 21:34:17,621 - {'epoch': 56, 'rec_loss': '7.5827'}
2025-03-01 21:34:36,837 - {'Epoch': 56, 'HR@5': '0.0525', 'NDCG@5': '0.0362', 'HR@10': '0.0762', 'NDCG@10': '0.0438', 'HR@20': '0.1070', 'NDCG@20': '0.0515'}
2025-03-01 21:34:36,838 - EarlyStopping counter: 1 out of 10
2025-03-01 21:35:16,063 - {'epoch': 57, 'rec_loss': '7.5769'}
2025-03-01 21:35:35,628 - {'Epoch': 57, 'HR@5': '0.0520', 'NDCG@5': '0.0360', 'HR@10': '0.0755', 'NDCG@10': '0.0435', 'HR@20': '0.1065', 'NDCG@20': '0.0513'}
2025-03-01 21:35:35,633 - EarlyStopping counter: 2 out of 10
2025-03-01 21:36:17,054 - {'epoch': 58, 'rec_loss': '7.5765'}
2025-03-01 21:36:35,302 - {'Epoch': 58, 'HR@5': '0.0519', 'NDCG@5': '0.0361', 'HR@10': '0.0764', 'NDCG@10': '0.0440', 'HR@20': '0.1065', 'NDCG@20': '0.0516'}
2025-03-01 21:36:35,303 - EarlyStopping counter: 3 out of 10
2025-03-01 21:37:16,584 - {'epoch': 59, 'rec_loss': '7.5762'}
2025-03-01 21:37:36,161 - {'Epoch': 59, 'HR@5': '0.0513', 'NDCG@5': '0.0359', 'HR@10': '0.0760', 'NDCG@10': '0.0439', 'HR@20': '0.1066', 'NDCG@20': '0.0516'}
2025-03-01 21:37:36,165 - EarlyStopping counter: 4 out of 10
2025-03-01 21:38:19,404 - {'epoch': 60, 'rec_loss': '7.5665'}
2025-03-01 21:38:37,688 - {'Epoch': 60, 'HR@5': '0.0514', 'NDCG@5': '0.0359', 'HR@10': '0.0754', 'NDCG@10': '0.0437', 'HR@20': '0.1067', 'NDCG@20': '0.0515'}
2025-03-01 21:38:37,694 - EarlyStopping counter: 5 out of 10
2025-03-01 21:39:19,332 - {'epoch': 61, 'rec_loss': '7.5623'}
2025-03-01 21:39:38,409 - {'Epoch': 61, 'HR@5': '0.0522', 'NDCG@5': '0.0363', 'HR@10': '0.0755', 'NDCG@10': '0.0438', 'HR@20': '0.1069', 'NDCG@20': '0.0517'}
2025-03-01 21:39:38,410 - EarlyStopping counter: 6 out of 10
2025-03-01 21:40:20,832 - {'epoch': 62, 'rec_loss': '7.5620'}
2025-03-01 21:40:40,712 - {'Epoch': 62, 'HR@5': '0.0524', 'NDCG@5': '0.0360', 'HR@10': '0.0763', 'NDCG@10': '0.0437', 'HR@20': '0.1072', 'NDCG@20': '0.0514'}
2025-03-01 21:40:40,716 - EarlyStopping counter: 7 out of 10
2025-03-01 21:41:22,108 - {'epoch': 63, 'rec_loss': '7.5632'}
2025-03-01 21:41:40,122 - {'Epoch': 63, 'HR@5': '0.0529', 'NDCG@5': '0.0366', 'HR@10': '0.0766', 'NDCG@10': '0.0442', 'HR@20': '0.1069', 'NDCG@20': '0.0518'}
2025-03-01 21:41:40,126 - EarlyStopping counter: 8 out of 10
2025-03-01 21:42:21,179 - {'epoch': 64, 'rec_loss': '7.5551'}
2025-03-01 21:42:39,867 - {'Epoch': 64, 'HR@5': '0.0527', 'NDCG@5': '0.0363', 'HR@10': '0.0761', 'NDCG@10': '0.0438', 'HR@20': '0.1060', 'NDCG@20': '0.0513'}
2025-03-01 21:42:39,869 - EarlyStopping counter: 9 out of 10
2025-03-01 21:43:21,815 - {'epoch': 65, 'rec_loss': '7.5513'}
2025-03-01 21:43:38,863 - {'Epoch': 65, 'HR@5': '0.0530', 'NDCG@5': '0.0370', 'HR@10': '0.0763', 'NDCG@10': '0.0445', 'HR@20': '0.1068', 'NDCG@20': '0.0521'}
2025-03-01 21:43:38,867 - Validation score increased.  Saving model ...
2025-03-01 21:44:22,098 - {'epoch': 66, 'rec_loss': '7.5490'}
2025-03-01 21:44:41,107 - {'Epoch': 66, 'HR@5': '0.0524', 'NDCG@5': '0.0362', 'HR@10': '0.0751', 'NDCG@10': '0.0435', 'HR@20': '0.1057', 'NDCG@20': '0.0512'}
2025-03-01 21:44:41,112 - EarlyStopping counter: 1 out of 10
2025-03-01 21:45:22,078 - {'epoch': 67, 'rec_loss': '7.5486'}
2025-03-01 21:45:39,808 - {'Epoch': 67, 'HR@5': '0.0527', 'NDCG@5': '0.0365', 'HR@10': '0.0751', 'NDCG@10': '0.0437', 'HR@20': '0.1064', 'NDCG@20': '0.0516'}
2025-03-01 21:45:39,814 - EarlyStopping counter: 2 out of 10
2025-03-01 21:46:20,027 - {'epoch': 68, 'rec_loss': '7.5421'}
2025-03-01 21:46:37,266 - {'Epoch': 68, 'HR@5': '0.0529', 'NDCG@5': '0.0370', 'HR@10': '0.0757', 'NDCG@10': '0.0443', 'HR@20': '0.1067', 'NDCG@20': '0.0521'}
2025-03-01 21:46:37,267 - EarlyStopping counter: 3 out of 10
2025-03-01 21:47:17,260 - {'epoch': 69, 'rec_loss': '7.5414'}
2025-03-01 21:47:36,579 - {'Epoch': 69, 'HR@5': '0.0521', 'NDCG@5': '0.0365', 'HR@10': '0.0753', 'NDCG@10': '0.0440', 'HR@20': '0.1053', 'NDCG@20': '0.0515'}
2025-03-01 21:47:36,580 - EarlyStopping counter: 4 out of 10
2025-03-01 21:48:18,186 - {'epoch': 70, 'rec_loss': '7.5353'}
2025-03-01 21:48:38,098 - {'Epoch': 70, 'HR@5': '0.0525', 'NDCG@5': '0.0365', 'HR@10': '0.0757', 'NDCG@10': '0.0440', 'HR@20': '0.1069', 'NDCG@20': '0.0518'}
2025-03-01 21:48:38,099 - EarlyStopping counter: 5 out of 10
2025-03-01 21:49:19,182 - {'epoch': 71, 'rec_loss': '7.5376'}
2025-03-01 21:49:38,296 - {'Epoch': 71, 'HR@5': '0.0532', 'NDCG@5': '0.0369', 'HR@10': '0.0769', 'NDCG@10': '0.0445', 'HR@20': '0.1059', 'NDCG@20': '0.0518'}
2025-03-01 21:49:38,300 - EarlyStopping counter: 6 out of 10
2025-03-01 21:50:19,597 - {'epoch': 72, 'rec_loss': '7.5369'}
2025-03-01 21:50:37,859 - {'Epoch': 72, 'HR@5': '0.0528', 'NDCG@5': '0.0366', 'HR@10': '0.0757', 'NDCG@10': '0.0440', 'HR@20': '0.1058', 'NDCG@20': '0.0516'}
2025-03-01 21:50:37,860 - EarlyStopping counter: 7 out of 10
2025-03-01 21:51:18,731 - {'epoch': 73, 'rec_loss': '7.5303'}
2025-03-01 21:51:38,078 - {'Epoch': 73, 'HR@5': '0.0529', 'NDCG@5': '0.0366', 'HR@10': '0.0759', 'NDCG@10': '0.0439', 'HR@20': '0.1064', 'NDCG@20': '0.0516'}
2025-03-01 21:51:38,083 - EarlyStopping counter: 8 out of 10
2025-03-01 21:52:18,918 - {'epoch': 74, 'rec_loss': '7.5323'}
2025-03-01 21:52:38,962 - {'Epoch': 74, 'HR@5': '0.0533', 'NDCG@5': '0.0371', 'HR@10': '0.0765', 'NDCG@10': '0.0445', 'HR@20': '0.1064', 'NDCG@20': '0.0521'}
2025-03-01 21:52:38,968 - EarlyStopping counter: 9 out of 10
2025-03-01 21:53:20,551 - {'epoch': 75, 'rec_loss': '7.5221'}
2025-03-01 21:53:37,723 - {'Epoch': 75, 'HR@5': '0.0533', 'NDCG@5': '0.0372', 'HR@10': '0.0767', 'NDCG@10': '0.0448', 'HR@20': '0.1068', 'NDCG@20': '0.0523'}
2025-03-01 21:53:37,729 - Validation score increased.  Saving model ...
2025-03-01 21:54:18,107 - {'epoch': 76, 'rec_loss': '7.5202'}
2025-03-01 21:54:37,272 - {'Epoch': 76, 'HR@5': '0.0533', 'NDCG@5': '0.0373', 'HR@10': '0.0762', 'NDCG@10': '0.0446', 'HR@20': '0.1081', 'NDCG@20': '0.0527'}
2025-03-01 21:54:37,277 - Validation score increased.  Saving model ...
2025-03-01 21:55:17,528 - {'epoch': 77, 'rec_loss': '7.5265'}
2025-03-01 21:55:36,701 - {'Epoch': 77, 'HR@5': '0.0527', 'NDCG@5': '0.0366', 'HR@10': '0.0754', 'NDCG@10': '0.0439', 'HR@20': '0.1063', 'NDCG@20': '0.0517'}
2025-03-01 21:55:36,702 - EarlyStopping counter: 1 out of 10
2025-03-01 21:56:15,211 - {'epoch': 78, 'rec_loss': '7.5217'}
2025-03-01 21:56:33,934 - {'Epoch': 78, 'HR@5': '0.0526', 'NDCG@5': '0.0367', 'HR@10': '0.0754', 'NDCG@10': '0.0440', 'HR@20': '0.1058', 'NDCG@20': '0.0517'}
2025-03-01 21:56:33,938 - EarlyStopping counter: 2 out of 10
2025-03-01 21:57:14,953 - {'epoch': 79, 'rec_loss': '7.5114'}
2025-03-01 21:57:31,521 - {'Epoch': 79, 'HR@5': '0.0519', 'NDCG@5': '0.0362', 'HR@10': '0.0758', 'NDCG@10': '0.0439', 'HR@20': '0.1071', 'NDCG@20': '0.0518'}
2025-03-01 21:57:31,525 - EarlyStopping counter: 3 out of 10
2025-03-01 21:58:12,945 - {'epoch': 80, 'rec_loss': '7.5142'}
2025-03-01 21:58:32,342 - {'Epoch': 80, 'HR@5': '0.0517', 'NDCG@5': '0.0363', 'HR@10': '0.0756', 'NDCG@10': '0.0440', 'HR@20': '0.1069', 'NDCG@20': '0.0518'}
2025-03-01 21:58:32,347 - EarlyStopping counter: 4 out of 10
2025-03-01 21:59:14,147 - {'epoch': 81, 'rec_loss': '7.5128'}
2025-03-01 21:59:33,431 - {'Epoch': 81, 'HR@5': '0.0527', 'NDCG@5': '0.0371', 'HR@10': '0.0756', 'NDCG@10': '0.0444', 'HR@20': '0.1060', 'NDCG@20': '0.0521'}
2025-03-01 21:59:33,432 - EarlyStopping counter: 5 out of 10
2025-03-01 22:00:15,480 - {'epoch': 82, 'rec_loss': '7.5149'}
2025-03-01 22:00:33,728 - {'Epoch': 82, 'HR@5': '0.0528', 'NDCG@5': '0.0375', 'HR@10': '0.0760', 'NDCG@10': '0.0450', 'HR@20': '0.1067', 'NDCG@20': '0.0527'}
2025-03-01 22:00:33,729 - Validation score increased.  Saving model ...
2025-03-01 22:01:14,245 - {'epoch': 83, 'rec_loss': '7.5068'}
2025-03-01 22:01:33,814 - {'Epoch': 83, 'HR@5': '0.0527', 'NDCG@5': '0.0370', 'HR@10': '0.0763', 'NDCG@10': '0.0446', 'HR@20': '0.1061', 'NDCG@20': '0.0520'}
2025-03-01 22:01:33,815 - EarlyStopping counter: 1 out of 10
2025-03-01 22:02:12,181 - {'epoch': 84, 'rec_loss': '7.5033'}
2025-03-01 22:02:32,225 - {'Epoch': 84, 'HR@5': '0.0526', 'NDCG@5': '0.0370', 'HR@10': '0.0751', 'NDCG@10': '0.0443', 'HR@20': '0.1053', 'NDCG@20': '0.0519'}
2025-03-01 22:02:32,227 - EarlyStopping counter: 2 out of 10
2025-03-01 22:03:12,328 - {'epoch': 85, 'rec_loss': '7.5098'}
2025-03-01 22:03:31,527 - {'Epoch': 85, 'HR@5': '0.0531', 'NDCG@5': '0.0370', 'HR@10': '0.0764', 'NDCG@10': '0.0445', 'HR@20': '0.1062', 'NDCG@20': '0.0520'}
2025-03-01 22:03:31,529 - EarlyStopping counter: 3 out of 10
2025-03-01 22:04:14,022 - {'epoch': 86, 'rec_loss': '7.4953'}
2025-03-01 22:04:31,761 - {'Epoch': 86, 'HR@5': '0.0536', 'NDCG@5': '0.0373', 'HR@10': '0.0758', 'NDCG@10': '0.0445', 'HR@20': '0.1055', 'NDCG@20': '0.0519'}
2025-03-01 22:04:31,763 - EarlyStopping counter: 4 out of 10
2025-03-01 22:05:13,806 - {'epoch': 87, 'rec_loss': '7.5021'}
2025-03-01 22:05:31,419 - {'Epoch': 87, 'HR@5': '0.0537', 'NDCG@5': '0.0377', 'HR@10': '0.0765', 'NDCG@10': '0.0450', 'HR@20': '0.1072', 'NDCG@20': '0.0527'}
2025-03-01 22:05:31,420 - EarlyStopping counter: 5 out of 10
2025-03-01 22:06:15,333 - {'epoch': 88, 'rec_loss': '7.4970'}
2025-03-01 22:06:34,588 - {'Epoch': 88, 'HR@5': '0.0534', 'NDCG@5': '0.0372', 'HR@10': '0.0764', 'NDCG@10': '0.0446', 'HR@20': '0.1067', 'NDCG@20': '0.0522'}
2025-03-01 22:06:34,590 - EarlyStopping counter: 6 out of 10
2025-03-01 22:07:17,697 - {'epoch': 89, 'rec_loss': '7.4984'}
2025-03-01 22:07:36,844 - {'Epoch': 89, 'HR@5': '0.0523', 'NDCG@5': '0.0363', 'HR@10': '0.0756', 'NDCG@10': '0.0438', 'HR@20': '0.1054', 'NDCG@20': '0.0513'}
2025-03-01 22:07:36,845 - EarlyStopping counter: 7 out of 10
2025-03-01 22:08:16,420 - {'epoch': 90, 'rec_loss': '7.4905'}
2025-03-01 22:08:36,893 - {'Epoch': 90, 'HR@5': '0.0528', 'NDCG@5': '0.0367', 'HR@10': '0.0749', 'NDCG@10': '0.0438', 'HR@20': '0.1062', 'NDCG@20': '0.0517'}
2025-03-01 22:08:36,899 - EarlyStopping counter: 8 out of 10
2025-03-01 22:09:16,342 - {'epoch': 91, 'rec_loss': '7.4967'}
2025-03-01 22:09:34,256 - {'Epoch': 91, 'HR@5': '0.0530', 'NDCG@5': '0.0370', 'HR@10': '0.0767', 'NDCG@10': '0.0446', 'HR@20': '0.1066', 'NDCG@20': '0.0521'}
2025-03-01 22:09:34,263 - EarlyStopping counter: 9 out of 10
2025-03-01 22:10:15,410 - {'epoch': 92, 'rec_loss': '7.4883'}
2025-03-01 22:10:33,972 - {'Epoch': 92, 'HR@5': '0.0528', 'NDCG@5': '0.0370', 'HR@10': '0.0756', 'NDCG@10': '0.0444', 'HR@20': '0.1060', 'NDCG@20': '0.0520'}
2025-03-01 22:10:33,976 - EarlyStopping counter: 10 out of 10
2025-03-01 22:10:33,976 - Early stopping
2025-03-01 22:10:33,976 - ---------------Test Score---------------
2025-03-01 22:10:53,545 - {'Epoch': 0, 'HR@5': '0.0430', 'NDCG@5': '0.0301', 'HR@10': '0.0623', 'NDCG@10': '0.0363', 'HR@20': '0.0901', 'NDCG@20': '0.0434'}
2025-03-01 22:10:53,551 - Scale_Sports
2025-03-01 22:10:53,552 - {'Epoch': 0, 'HR@5': '0.0430', 'NDCG@5': '0.0301', 'HR@10': '0.0623', 'NDCG@10': '0.0363', 'HR@20': '0.0901', 'NDCG@20': '0.0434'}
2025-03-03 13:34:00,088 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[8, 12, 32], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-03 13:34:03,120 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-03 13:34:03,127 - Total Parameters: 1328854
2025-03-03 13:35:02,036 - {'epoch': 0, 'rec_loss': '9.4023'}
2025-03-03 13:35:24,278 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0054', 'HR@10': '0.0125', 'NDCG@10': '0.0068', 'HR@20': '0.0215', 'NDCG@20': '0.0090'}
2025-03-03 13:35:24,279 - Validation score increased.  Saving model ...
2025-03-03 13:36:14,027 - {'epoch': 1, 'rec_loss': '9.2155'}
2025-03-03 13:36:36,063 - {'Epoch': 1, 'HR@5': '0.0137', 'NDCG@5': '0.0085', 'HR@10': '0.0219', 'NDCG@10': '0.0111', 'HR@20': '0.0382', 'NDCG@20': '0.0152'}
2025-03-03 13:36:36,068 - Validation score increased.  Saving model ...
2025-03-03 13:37:28,680 - {'epoch': 2, 'rec_loss': '8.9522'}
2025-03-03 13:37:49,381 - {'Epoch': 2, 'HR@5': '0.0178', 'NDCG@5': '0.0119', 'HR@10': '0.0302', 'NDCG@10': '0.0159', 'HR@20': '0.0485', 'NDCG@20': '0.0205'}
2025-03-03 13:37:49,384 - Validation score increased.  Saving model ...
2025-03-03 13:38:46,970 - {'epoch': 3, 'rec_loss': '8.7605'}
2025-03-03 13:39:06,562 - {'Epoch': 3, 'HR@5': '0.0269', 'NDCG@5': '0.0176', 'HR@10': '0.0406', 'NDCG@10': '0.0220', 'HR@20': '0.0630', 'NDCG@20': '0.0276'}
2025-03-03 13:39:06,567 - Validation score increased.  Saving model ...
2025-03-03 13:39:51,056 - {'epoch': 4, 'rec_loss': '8.6105'}
2025-03-03 13:40:10,616 - {'Epoch': 4, 'HR@5': '0.0300', 'NDCG@5': '0.0195', 'HR@10': '0.0466', 'NDCG@10': '0.0249', 'HR@20': '0.0706', 'NDCG@20': '0.0309'}
2025-03-03 13:40:10,618 - Validation score increased.  Saving model ...
2025-03-03 13:41:06,203 - {'epoch': 5, 'rec_loss': '8.4875'}
2025-03-03 13:41:26,056 - {'Epoch': 5, 'HR@5': '0.0366', 'NDCG@5': '0.0244', 'HR@10': '0.0534', 'NDCG@10': '0.0297', 'HR@20': '0.0776', 'NDCG@20': '0.0359'}
2025-03-03 13:41:26,066 - Validation score increased.  Saving model ...
2025-03-03 13:42:04,530 - {'epoch': 6, 'rec_loss': '8.3958'}
2025-03-03 13:42:21,993 - {'Epoch': 6, 'HR@5': '0.0381', 'NDCG@5': '0.0256', 'HR@10': '0.0566', 'NDCG@10': '0.0316', 'HR@20': '0.0824', 'NDCG@20': '0.0380'}
2025-03-03 13:42:22,000 - Validation score increased.  Saving model ...
2025-03-03 13:43:17,831 - {'epoch': 7, 'rec_loss': '8.3142'}
2025-03-03 13:43:38,755 - {'Epoch': 7, 'HR@5': '0.0405', 'NDCG@5': '0.0279', 'HR@10': '0.0599', 'NDCG@10': '0.0341', 'HR@20': '0.0858', 'NDCG@20': '0.0405'}
2025-03-03 13:43:38,757 - Validation score increased.  Saving model ...
2025-03-03 13:44:25,707 - {'epoch': 8, 'rec_loss': '8.2463'}
2025-03-03 13:44:44,391 - {'Epoch': 8, 'HR@5': '0.0426', 'NDCG@5': '0.0297', 'HR@10': '0.0615', 'NDCG@10': '0.0358', 'HR@20': '0.0883', 'NDCG@20': '0.0425'}
2025-03-03 13:44:44,392 - Validation score increased.  Saving model ...
2025-03-03 13:45:29,906 - {'epoch': 9, 'rec_loss': '8.1895'}
2025-03-03 13:45:50,464 - {'Epoch': 9, 'HR@5': '0.0445', 'NDCG@5': '0.0307', 'HR@10': '0.0635', 'NDCG@10': '0.0368', 'HR@20': '0.0910', 'NDCG@20': '0.0437'}
2025-03-03 13:45:50,468 - Validation score increased.  Saving model ...
2025-03-03 13:46:51,170 - {'epoch': 10, 'rec_loss': '8.1438'}
2025-03-03 13:47:08,972 - {'Epoch': 10, 'HR@5': '0.0449', 'NDCG@5': '0.0312', 'HR@10': '0.0645', 'NDCG@10': '0.0375', 'HR@20': '0.0913', 'NDCG@20': '0.0442'}
2025-03-03 13:47:08,978 - Validation score increased.  Saving model ...
2025-03-03 13:47:51,128 - {'epoch': 11, 'rec_loss': '8.0944'}
2025-03-03 13:48:09,642 - {'Epoch': 11, 'HR@5': '0.0463', 'NDCG@5': '0.0318', 'HR@10': '0.0667', 'NDCG@10': '0.0383', 'HR@20': '0.0947', 'NDCG@20': '0.0453'}
2025-03-03 13:48:09,643 - Validation score increased.  Saving model ...
2025-03-03 13:49:04,577 - {'epoch': 12, 'rec_loss': '8.0601'}
2025-03-03 13:49:25,002 - {'Epoch': 12, 'HR@5': '0.0478', 'NDCG@5': '0.0330', 'HR@10': '0.0677', 'NDCG@10': '0.0394', 'HR@20': '0.0950', 'NDCG@20': '0.0463'}
2025-03-03 13:49:25,003 - Validation score increased.  Saving model ...
2025-03-03 13:50:20,787 - {'epoch': 13, 'rec_loss': '8.0282'}
2025-03-03 13:50:37,363 - {'Epoch': 13, 'HR@5': '0.0474', 'NDCG@5': '0.0329', 'HR@10': '0.0678', 'NDCG@10': '0.0394', 'HR@20': '0.0965', 'NDCG@20': '0.0466'}
2025-03-03 13:50:37,365 - Validation score increased.  Saving model ...
2025-03-03 13:51:17,178 - {'epoch': 14, 'rec_loss': '7.9990'}
2025-03-03 13:51:37,341 - {'Epoch': 14, 'HR@5': '0.0480', 'NDCG@5': '0.0334', 'HR@10': '0.0688', 'NDCG@10': '0.0401', 'HR@20': '0.0978', 'NDCG@20': '0.0473'}
2025-03-03 13:51:37,342 - Validation score increased.  Saving model ...
2025-03-03 13:52:35,927 - {'epoch': 15, 'rec_loss': '7.9704'}
2025-03-03 13:52:56,676 - {'Epoch': 15, 'HR@5': '0.0484', 'NDCG@5': '0.0336', 'HR@10': '0.0688', 'NDCG@10': '0.0402', 'HR@20': '0.0974', 'NDCG@20': '0.0473'}
2025-03-03 13:52:56,677 - Validation score increased.  Saving model ...
2025-03-03 13:53:43,035 - {'epoch': 16, 'rec_loss': '7.9459'}
2025-03-03 13:54:02,054 - {'Epoch': 16, 'HR@5': '0.0485', 'NDCG@5': '0.0337', 'HR@10': '0.0689', 'NDCG@10': '0.0403', 'HR@20': '0.0984', 'NDCG@20': '0.0477'}
2025-03-03 13:54:02,059 - Validation score increased.  Saving model ...
2025-03-03 13:55:00,302 - {'epoch': 17, 'rec_loss': '7.9239'}
2025-03-03 13:55:20,937 - {'Epoch': 17, 'HR@5': '0.0483', 'NDCG@5': '0.0339', 'HR@10': '0.0691', 'NDCG@10': '0.0406', 'HR@20': '0.0986', 'NDCG@20': '0.0480'}
2025-03-03 13:55:20,942 - Validation score increased.  Saving model ...
2025-03-03 13:56:09,232 - {'epoch': 18, 'rec_loss': '7.8991'}
2025-03-03 13:56:26,953 - {'Epoch': 18, 'HR@5': '0.0495', 'NDCG@5': '0.0346', 'HR@10': '0.0707', 'NDCG@10': '0.0414', 'HR@20': '0.1005', 'NDCG@20': '0.0488'}
2025-03-03 13:56:26,956 - Validation score increased.  Saving model ...
2025-03-03 13:57:09,821 - {'epoch': 19, 'rec_loss': '7.8781'}
2025-03-03 13:57:30,546 - {'Epoch': 19, 'HR@5': '0.0493', 'NDCG@5': '0.0346', 'HR@10': '0.0710', 'NDCG@10': '0.0416', 'HR@20': '0.1005', 'NDCG@20': '0.0491'}
2025-03-03 13:57:30,556 - Validation score increased.  Saving model ...
2025-03-03 13:58:32,575 - {'epoch': 20, 'rec_loss': '7.8640'}
2025-03-03 13:58:51,448 - {'Epoch': 20, 'HR@5': '0.0505', 'NDCG@5': '0.0351', 'HR@10': '0.0726', 'NDCG@10': '0.0422', 'HR@20': '0.1023', 'NDCG@20': '0.0496'}
2025-03-03 13:58:51,449 - Validation score increased.  Saving model ...
2025-03-03 13:59:31,864 - {'epoch': 21, 'rec_loss': '7.8417'}
2025-03-03 13:59:49,654 - {'Epoch': 21, 'HR@5': '0.0496', 'NDCG@5': '0.0344', 'HR@10': '0.0703', 'NDCG@10': '0.0411', 'HR@20': '0.1025', 'NDCG@20': '0.0491'}
2025-03-03 13:59:49,655 - EarlyStopping counter: 1 out of 10
2025-03-03 14:00:48,898 - {'epoch': 22, 'rec_loss': '7.8293'}
2025-03-03 14:01:10,979 - {'Epoch': 22, 'HR@5': '0.0498', 'NDCG@5': '0.0348', 'HR@10': '0.0712', 'NDCG@10': '0.0417', 'HR@20': '0.1024', 'NDCG@20': '0.0495'}
2025-03-03 14:01:10,983 - EarlyStopping counter: 2 out of 10
2025-03-03 14:02:02,379 - {'epoch': 23, 'rec_loss': '7.8131'}
2025-03-03 14:02:20,729 - {'Epoch': 23, 'HR@5': '0.0496', 'NDCG@5': '0.0345', 'HR@10': '0.0718', 'NDCG@10': '0.0416', 'HR@20': '0.1023', 'NDCG@20': '0.0493'}
2025-03-03 14:02:20,730 - EarlyStopping counter: 3 out of 10
2025-03-03 14:03:11,766 - {'epoch': 24, 'rec_loss': '7.7997'}
2025-03-03 14:03:33,605 - {'Epoch': 24, 'HR@5': '0.0504', 'NDCG@5': '0.0351', 'HR@10': '0.0724', 'NDCG@10': '0.0422', 'HR@20': '0.1028', 'NDCG@20': '0.0498'}
2025-03-03 14:03:33,607 - Validation score increased.  Saving model ...
2025-03-03 14:04:33,077 - {'epoch': 25, 'rec_loss': '7.7836'}
2025-03-03 14:04:51,709 - {'Epoch': 25, 'HR@5': '0.0504', 'NDCG@5': '0.0351', 'HR@10': '0.0724', 'NDCG@10': '0.0422', 'HR@20': '0.1039', 'NDCG@20': '0.0501'}
2025-03-03 14:04:51,714 - Validation score increased.  Saving model ...
2025-03-03 14:05:30,749 - {'epoch': 26, 'rec_loss': '7.7727'}
2025-03-03 14:05:51,617 - {'Epoch': 26, 'HR@5': '0.0508', 'NDCG@5': '0.0357', 'HR@10': '0.0734', 'NDCG@10': '0.0429', 'HR@20': '0.1034', 'NDCG@20': '0.0505'}
2025-03-03 14:05:51,621 - Validation score increased.  Saving model ...
2025-03-03 14:06:50,647 - {'epoch': 27, 'rec_loss': '7.7551'}
2025-03-03 14:07:10,794 - {'Epoch': 27, 'HR@5': '0.0518', 'NDCG@5': '0.0359', 'HR@10': '0.0740', 'NDCG@10': '0.0430', 'HR@20': '0.1032', 'NDCG@20': '0.0503'}
2025-03-03 14:07:10,795 - EarlyStopping counter: 1 out of 10
2025-03-03 14:07:51,473 - {'epoch': 28, 'rec_loss': '7.7502'}
2025-03-03 14:08:08,395 - {'Epoch': 28, 'HR@5': '0.0509', 'NDCG@5': '0.0358', 'HR@10': '0.0732', 'NDCG@10': '0.0430', 'HR@20': '0.1030', 'NDCG@20': '0.0504'}
2025-03-03 14:08:08,403 - EarlyStopping counter: 2 out of 10
2025-03-03 14:09:05,088 - {'epoch': 29, 'rec_loss': '7.7397'}
2025-03-03 14:09:25,508 - {'Epoch': 29, 'HR@5': '0.0505', 'NDCG@5': '0.0355', 'HR@10': '0.0734', 'NDCG@10': '0.0429', 'HR@20': '0.1041', 'NDCG@20': '0.0506'}
2025-03-03 14:09:25,515 - Validation score increased.  Saving model ...
2025-03-03 14:10:18,561 - {'epoch': 30, 'rec_loss': '7.7310'}
2025-03-03 14:10:35,505 - {'Epoch': 30, 'HR@5': '0.0511', 'NDCG@5': '0.0355', 'HR@10': '0.0742', 'NDCG@10': '0.0429', 'HR@20': '0.1027', 'NDCG@20': '0.0501'}
2025-03-03 14:10:35,509 - EarlyStopping counter: 1 out of 10
2025-03-03 14:11:17,783 - {'epoch': 31, 'rec_loss': '7.7208'}
2025-03-03 14:11:38,691 - {'Epoch': 31, 'HR@5': '0.0509', 'NDCG@5': '0.0354', 'HR@10': '0.0735', 'NDCG@10': '0.0427', 'HR@20': '0.1047', 'NDCG@20': '0.0506'}
2025-03-03 14:11:38,693 - Validation score increased.  Saving model ...
2025-03-03 14:12:39,579 - {'epoch': 32, 'rec_loss': '7.7088'}
2025-03-03 14:12:59,950 - {'Epoch': 32, 'HR@5': '0.0513', 'NDCG@5': '0.0354', 'HR@10': '0.0744', 'NDCG@10': '0.0428', 'HR@20': '0.1045', 'NDCG@20': '0.0504'}
2025-03-03 14:12:59,954 - EarlyStopping counter: 1 out of 10
2025-03-03 14:13:38,312 - {'epoch': 33, 'rec_loss': '7.7026'}
2025-03-03 14:13:54,942 - {'Epoch': 33, 'HR@5': '0.0521', 'NDCG@5': '0.0361', 'HR@10': '0.0744', 'NDCG@10': '0.0432', 'HR@20': '0.1048', 'NDCG@20': '0.0509'}
2025-03-03 14:13:54,945 - Validation score increased.  Saving model ...
2025-03-03 14:14:55,296 - {'epoch': 34, 'rec_loss': '7.7019'}
2025-03-03 14:15:15,792 - {'Epoch': 34, 'HR@5': '0.0514', 'NDCG@5': '0.0357', 'HR@10': '0.0741', 'NDCG@10': '0.0430', 'HR@20': '0.1042', 'NDCG@20': '0.0505'}
2025-03-03 14:15:15,794 - EarlyStopping counter: 1 out of 10
2025-03-03 14:16:05,631 - {'epoch': 35, 'rec_loss': '7.6890'}
2025-03-03 14:16:22,930 - {'Epoch': 35, 'HR@5': '0.0518', 'NDCG@5': '0.0360', 'HR@10': '0.0747', 'NDCG@10': '0.0434', 'HR@20': '0.1060', 'NDCG@20': '0.0513'}
2025-03-03 14:16:22,932 - Validation score increased.  Saving model ...
2025-03-03 14:17:11,336 - {'epoch': 36, 'rec_loss': '7.6821'}
2025-03-03 14:17:31,858 - {'Epoch': 36, 'HR@5': '0.0510', 'NDCG@5': '0.0359', 'HR@10': '0.0750', 'NDCG@10': '0.0436', 'HR@20': '0.1058', 'NDCG@20': '0.0513'}
2025-03-03 14:17:31,859 - Validation score increased.  Saving model ...
2025-03-03 14:18:32,011 - {'epoch': 37, 'rec_loss': '7.6728'}
2025-03-03 14:18:49,537 - {'Epoch': 37, 'HR@5': '0.0515', 'NDCG@5': '0.0360', 'HR@10': '0.0748', 'NDCG@10': '0.0435', 'HR@20': '0.1062', 'NDCG@20': '0.0514'}
2025-03-03 14:18:49,538 - Validation score increased.  Saving model ...
2025-03-03 14:19:32,473 - {'epoch': 38, 'rec_loss': '7.6620'}
2025-03-03 14:19:51,822 - {'Epoch': 38, 'HR@5': '0.0522', 'NDCG@5': '0.0363', 'HR@10': '0.0749', 'NDCG@10': '0.0436', 'HR@20': '0.1049', 'NDCG@20': '0.0512'}
2025-03-03 14:19:51,827 - EarlyStopping counter: 1 out of 10
2025-03-03 14:20:52,319 - {'epoch': 39, 'rec_loss': '7.6592'}
2025-03-03 14:21:12,912 - {'Epoch': 39, 'HR@5': '0.0522', 'NDCG@5': '0.0365', 'HR@10': '0.0751', 'NDCG@10': '0.0439', 'HR@20': '0.1048', 'NDCG@20': '0.0514'}
2025-03-03 14:21:12,914 - EarlyStopping counter: 2 out of 10
2025-03-03 14:21:57,826 - {'epoch': 40, 'rec_loss': '7.6527'}
2025-03-03 14:22:14,416 - {'Epoch': 40, 'HR@5': '0.0518', 'NDCG@5': '0.0364', 'HR@10': '0.0748', 'NDCG@10': '0.0439', 'HR@20': '0.1041', 'NDCG@20': '0.0513'}
2025-03-03 14:22:14,421 - EarlyStopping counter: 3 out of 10
2025-03-03 14:23:13,052 - {'epoch': 41, 'rec_loss': '7.6422'}
2025-03-03 14:23:35,224 - {'Epoch': 41, 'HR@5': '0.0518', 'NDCG@5': '0.0363', 'HR@10': '0.0746', 'NDCG@10': '0.0437', 'HR@20': '0.1052', 'NDCG@20': '0.0513'}
2025-03-03 14:23:35,238 - EarlyStopping counter: 4 out of 10
2025-03-03 14:24:45,358 - {'epoch': 42, 'rec_loss': '7.6396'}
2025-03-03 14:25:03,779 - {'Epoch': 42, 'HR@5': '0.0520', 'NDCG@5': '0.0362', 'HR@10': '0.0749', 'NDCG@10': '0.0435', 'HR@20': '0.1055', 'NDCG@20': '0.0512'}
2025-03-03 14:25:03,780 - EarlyStopping counter: 5 out of 10
2025-03-03 14:25:45,388 - {'epoch': 43, 'rec_loss': '7.6373'}
2025-03-03 14:26:02,251 - {'Epoch': 43, 'HR@5': '0.0520', 'NDCG@5': '0.0360', 'HR@10': '0.0747', 'NDCG@10': '0.0433', 'HR@20': '0.1061', 'NDCG@20': '0.0512'}
2025-03-03 14:26:02,255 - EarlyStopping counter: 6 out of 10
2025-03-03 14:26:42,915 - {'epoch': 44, 'rec_loss': '7.6318'}
2025-03-03 14:26:58,732 - {'Epoch': 44, 'HR@5': '0.0523', 'NDCG@5': '0.0363', 'HR@10': '0.0767', 'NDCG@10': '0.0442', 'HR@20': '0.1063', 'NDCG@20': '0.0516'}
2025-03-03 14:26:58,733 - Validation score increased.  Saving model ...
2025-03-03 14:27:39,190 - {'epoch': 45, 'rec_loss': '7.6262'}
2025-03-03 14:27:55,893 - {'Epoch': 45, 'HR@5': '0.0519', 'NDCG@5': '0.0362', 'HR@10': '0.0749', 'NDCG@10': '0.0436', 'HR@20': '0.1058', 'NDCG@20': '0.0514'}
2025-03-03 14:27:55,899 - EarlyStopping counter: 1 out of 10
2025-03-03 14:28:36,075 - {'epoch': 46, 'rec_loss': '7.6241'}
2025-03-03 14:28:53,402 - {'Epoch': 46, 'HR@5': '0.0522', 'NDCG@5': '0.0360', 'HR@10': '0.0756', 'NDCG@10': '0.0435', 'HR@20': '0.1056', 'NDCG@20': '0.0511'}
2025-03-03 14:28:53,404 - EarlyStopping counter: 2 out of 10
2025-03-03 14:29:35,772 - {'epoch': 47, 'rec_loss': '7.6227'}
2025-03-03 14:29:55,713 - {'Epoch': 47, 'HR@5': '0.0517', 'NDCG@5': '0.0362', 'HR@10': '0.0750', 'NDCG@10': '0.0437', 'HR@20': '0.1059', 'NDCG@20': '0.0515'}
2025-03-03 14:29:55,718 - EarlyStopping counter: 3 out of 10
2025-03-03 14:30:37,533 - {'epoch': 48, 'rec_loss': '7.6119'}
2025-03-03 14:30:54,382 - {'Epoch': 48, 'HR@5': '0.0525', 'NDCG@5': '0.0363', 'HR@10': '0.0749', 'NDCG@10': '0.0435', 'HR@20': '0.1061', 'NDCG@20': '0.0513'}
2025-03-03 14:30:54,383 - EarlyStopping counter: 4 out of 10
2025-03-03 15:01:59,630 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[8, 12, 32], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-03 15:02:26,434 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-03 15:02:26,471 - Total Parameters: 1328854
2025-03-03 15:07:53,198 - {'epoch': 0, 'rec_loss': '9.4023'}
2025-03-03 15:08:10,571 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0054', 'HR@10': '0.0125', 'NDCG@10': '0.0068', 'HR@20': '0.0215', 'NDCG@20': '0.0090'}
2025-03-03 15:08:10,572 - Validation score increased.  Saving model ...
2025-03-03 15:08:50,952 - {'epoch': 1, 'rec_loss': '9.2155'}
2025-03-03 15:09:07,035 - {'Epoch': 1, 'HR@5': '0.0137', 'NDCG@5': '0.0085', 'HR@10': '0.0219', 'NDCG@10': '0.0111', 'HR@20': '0.0382', 'NDCG@20': '0.0152'}
2025-03-03 15:09:07,040 - Validation score increased.  Saving model ...
2025-03-03 15:09:51,281 - {'epoch': 2, 'rec_loss': '8.9522'}
2025-03-03 15:10:07,618 - {'Epoch': 2, 'HR@5': '0.0178', 'NDCG@5': '0.0119', 'HR@10': '0.0302', 'NDCG@10': '0.0159', 'HR@20': '0.0485', 'NDCG@20': '0.0205'}
2025-03-03 15:10:07,619 - Validation score increased.  Saving model ...
2025-03-03 15:10:48,043 - {'epoch': 3, 'rec_loss': '8.7605'}
2025-03-03 15:11:04,541 - {'Epoch': 3, 'HR@5': '0.0269', 'NDCG@5': '0.0176', 'HR@10': '0.0406', 'NDCG@10': '0.0220', 'HR@20': '0.0630', 'NDCG@20': '0.0276'}
2025-03-03 15:11:04,542 - Validation score increased.  Saving model ...
2025-03-03 15:11:47,637 - {'epoch': 4, 'rec_loss': '8.6105'}
2025-03-03 15:12:03,542 - {'Epoch': 4, 'HR@5': '0.0300', 'NDCG@5': '0.0195', 'HR@10': '0.0466', 'NDCG@10': '0.0249', 'HR@20': '0.0706', 'NDCG@20': '0.0309'}
2025-03-03 15:12:03,544 - Validation score increased.  Saving model ...
2025-03-03 15:12:46,940 - {'epoch': 5, 'rec_loss': '8.4875'}
2025-03-03 15:13:03,331 - {'Epoch': 5, 'HR@5': '0.0366', 'NDCG@5': '0.0244', 'HR@10': '0.0534', 'NDCG@10': '0.0297', 'HR@20': '0.0776', 'NDCG@20': '0.0359'}
2025-03-03 15:13:03,335 - Validation score increased.  Saving model ...
2025-03-03 15:13:43,775 - {'epoch': 6, 'rec_loss': '8.3958'}
2025-03-03 15:13:59,773 - {'Epoch': 6, 'HR@5': '0.0381', 'NDCG@5': '0.0256', 'HR@10': '0.0566', 'NDCG@10': '0.0316', 'HR@20': '0.0824', 'NDCG@20': '0.0380'}
2025-03-03 15:13:59,774 - Validation score increased.  Saving model ...
2025-03-03 15:14:41,467 - {'epoch': 7, 'rec_loss': '8.3142'}
2025-03-03 15:14:57,971 - {'Epoch': 7, 'HR@5': '0.0405', 'NDCG@5': '0.0279', 'HR@10': '0.0599', 'NDCG@10': '0.0341', 'HR@20': '0.0858', 'NDCG@20': '0.0405'}
2025-03-03 15:14:57,978 - Validation score increased.  Saving model ...
2025-03-03 15:15:39,231 - {'epoch': 8, 'rec_loss': '8.2463'}
2025-03-03 15:15:56,355 - {'Epoch': 8, 'HR@5': '0.0426', 'NDCG@5': '0.0297', 'HR@10': '0.0615', 'NDCG@10': '0.0358', 'HR@20': '0.0883', 'NDCG@20': '0.0425'}
2025-03-03 15:15:56,357 - Validation score increased.  Saving model ...
2025-03-03 15:23:23,232 - {'epoch': 9, 'rec_loss': '8.1895'}
2025-03-03 15:23:40,099 - {'Epoch': 9, 'HR@5': '0.0445', 'NDCG@5': '0.0307', 'HR@10': '0.0635', 'NDCG@10': '0.0368', 'HR@20': '0.0910', 'NDCG@20': '0.0437'}
2025-03-03 15:23:40,100 - Validation score increased.  Saving model ...
2025-03-03 15:24:23,039 - {'epoch': 10, 'rec_loss': '8.1438'}
2025-03-03 15:24:39,315 - {'Epoch': 10, 'HR@5': '0.0449', 'NDCG@5': '0.0312', 'HR@10': '0.0645', 'NDCG@10': '0.0375', 'HR@20': '0.0913', 'NDCG@20': '0.0442'}
2025-03-03 15:24:39,316 - Validation score increased.  Saving model ...
2025-03-03 15:25:21,032 - {'epoch': 11, 'rec_loss': '8.0944'}
2025-03-03 15:25:37,138 - {'Epoch': 11, 'HR@5': '0.0463', 'NDCG@5': '0.0318', 'HR@10': '0.0667', 'NDCG@10': '0.0383', 'HR@20': '0.0947', 'NDCG@20': '0.0453'}
2025-03-03 15:25:37,142 - Validation score increased.  Saving model ...
2025-03-03 15:26:19,359 - {'epoch': 12, 'rec_loss': '8.0601'}
2025-03-03 15:26:35,724 - {'Epoch': 12, 'HR@5': '0.0478', 'NDCG@5': '0.0330', 'HR@10': '0.0677', 'NDCG@10': '0.0394', 'HR@20': '0.0950', 'NDCG@20': '0.0463'}
2025-03-03 15:26:35,728 - Validation score increased.  Saving model ...
2025-03-03 15:27:17,157 - {'epoch': 13, 'rec_loss': '8.0282'}
2025-03-03 15:27:34,092 - {'Epoch': 13, 'HR@5': '0.0474', 'NDCG@5': '0.0329', 'HR@10': '0.0678', 'NDCG@10': '0.0394', 'HR@20': '0.0965', 'NDCG@20': '0.0466'}
2025-03-03 15:27:34,093 - Validation score increased.  Saving model ...
2025-03-03 15:28:15,238 - {'epoch': 14, 'rec_loss': '7.9990'}
2025-03-03 15:28:31,608 - {'Epoch': 14, 'HR@5': '0.0480', 'NDCG@5': '0.0334', 'HR@10': '0.0688', 'NDCG@10': '0.0401', 'HR@20': '0.0978', 'NDCG@20': '0.0473'}
2025-03-03 15:28:31,614 - Validation score increased.  Saving model ...
2025-03-03 15:29:12,771 - {'epoch': 15, 'rec_loss': '7.9704'}
2025-03-03 15:29:29,171 - {'Epoch': 15, 'HR@5': '0.0484', 'NDCG@5': '0.0336', 'HR@10': '0.0688', 'NDCG@10': '0.0402', 'HR@20': '0.0974', 'NDCG@20': '0.0473'}
2025-03-03 15:29:29,176 - Validation score increased.  Saving model ...
2025-03-03 15:30:10,330 - {'epoch': 16, 'rec_loss': '7.9459'}
2025-03-03 15:30:26,712 - {'Epoch': 16, 'HR@5': '0.0485', 'NDCG@5': '0.0337', 'HR@10': '0.0689', 'NDCG@10': '0.0403', 'HR@20': '0.0984', 'NDCG@20': '0.0477'}
2025-03-03 15:30:26,717 - Validation score increased.  Saving model ...
2025-03-03 15:31:08,160 - {'epoch': 17, 'rec_loss': '7.9239'}
2025-03-03 15:31:24,917 - {'Epoch': 17, 'HR@5': '0.0483', 'NDCG@5': '0.0339', 'HR@10': '0.0691', 'NDCG@10': '0.0406', 'HR@20': '0.0986', 'NDCG@20': '0.0480'}
2025-03-03 15:31:24,924 - Validation score increased.  Saving model ...
2025-03-03 15:32:05,184 - {'epoch': 18, 'rec_loss': '7.8991'}
2025-03-03 15:32:21,442 - {'Epoch': 18, 'HR@5': '0.0495', 'NDCG@5': '0.0346', 'HR@10': '0.0707', 'NDCG@10': '0.0414', 'HR@20': '0.1005', 'NDCG@20': '0.0488'}
2025-03-03 15:32:21,443 - Validation score increased.  Saving model ...
2025-03-03 15:33:01,314 - {'epoch': 19, 'rec_loss': '7.8781'}
2025-03-03 15:33:17,780 - {'Epoch': 19, 'HR@5': '0.0493', 'NDCG@5': '0.0346', 'HR@10': '0.0710', 'NDCG@10': '0.0416', 'HR@20': '0.1005', 'NDCG@20': '0.0491'}
2025-03-03 15:33:17,783 - Validation score increased.  Saving model ...
2025-03-03 15:33:59,377 - {'epoch': 20, 'rec_loss': '7.8640'}
2025-03-03 15:34:15,636 - {'Epoch': 20, 'HR@5': '0.0505', 'NDCG@5': '0.0351', 'HR@10': '0.0726', 'NDCG@10': '0.0422', 'HR@20': '0.1023', 'NDCG@20': '0.0496'}
2025-03-03 15:34:15,642 - Validation score increased.  Saving model ...
2025-03-03 15:34:55,406 - {'epoch': 21, 'rec_loss': '7.8417'}
2025-03-03 15:35:11,742 - {'Epoch': 21, 'HR@5': '0.0496', 'NDCG@5': '0.0344', 'HR@10': '0.0703', 'NDCG@10': '0.0411', 'HR@20': '0.1025', 'NDCG@20': '0.0491'}
2025-03-03 15:35:11,747 - EarlyStopping counter: 1 out of 10
2025-03-03 15:35:52,396 - {'epoch': 22, 'rec_loss': '7.8293'}
2025-03-03 15:36:08,616 - {'Epoch': 22, 'HR@5': '0.0498', 'NDCG@5': '0.0348', 'HR@10': '0.0712', 'NDCG@10': '0.0417', 'HR@20': '0.1024', 'NDCG@20': '0.0495'}
2025-03-03 15:36:08,622 - EarlyStopping counter: 2 out of 10
2025-03-03 15:36:48,702 - {'epoch': 23, 'rec_loss': '7.8131'}
2025-03-03 15:37:05,291 - {'Epoch': 23, 'HR@5': '0.0496', 'NDCG@5': '0.0345', 'HR@10': '0.0718', 'NDCG@10': '0.0416', 'HR@20': '0.1023', 'NDCG@20': '0.0493'}
2025-03-03 15:37:05,296 - EarlyStopping counter: 3 out of 10
2025-03-03 15:37:46,676 - {'epoch': 24, 'rec_loss': '7.7997'}
2025-03-03 15:38:02,972 - {'Epoch': 24, 'HR@5': '0.0504', 'NDCG@5': '0.0351', 'HR@10': '0.0724', 'NDCG@10': '0.0422', 'HR@20': '0.1028', 'NDCG@20': '0.0498'}
2025-03-03 15:38:02,973 - Validation score increased.  Saving model ...
2025-03-03 15:38:44,171 - {'epoch': 25, 'rec_loss': '7.7836'}
2025-03-03 15:39:01,172 - {'Epoch': 25, 'HR@5': '0.0504', 'NDCG@5': '0.0351', 'HR@10': '0.0724', 'NDCG@10': '0.0422', 'HR@20': '0.1039', 'NDCG@20': '0.0501'}
2025-03-03 15:39:01,175 - Validation score increased.  Saving model ...
2025-03-03 15:39:42,738 - {'epoch': 26, 'rec_loss': '7.7727'}
2025-03-03 15:39:59,620 - {'Epoch': 26, 'HR@5': '0.0508', 'NDCG@5': '0.0357', 'HR@10': '0.0734', 'NDCG@10': '0.0429', 'HR@20': '0.1034', 'NDCG@20': '0.0505'}
2025-03-03 15:39:59,623 - Validation score increased.  Saving model ...
2025-03-03 15:40:39,347 - {'epoch': 27, 'rec_loss': '7.7551'}
2025-03-03 15:40:55,715 - {'Epoch': 27, 'HR@5': '0.0518', 'NDCG@5': '0.0359', 'HR@10': '0.0740', 'NDCG@10': '0.0430', 'HR@20': '0.1032', 'NDCG@20': '0.0503'}
2025-03-03 15:40:55,716 - EarlyStopping counter: 1 out of 10
2025-03-03 15:41:35,522 - {'epoch': 28, 'rec_loss': '7.7502'}
2025-03-03 15:41:51,700 - {'Epoch': 28, 'HR@5': '0.0509', 'NDCG@5': '0.0358', 'HR@10': '0.0732', 'NDCG@10': '0.0430', 'HR@20': '0.1030', 'NDCG@20': '0.0504'}
2025-03-03 15:41:51,702 - EarlyStopping counter: 2 out of 10
2025-03-03 15:42:35,062 - {'epoch': 29, 'rec_loss': '7.7397'}
2025-03-03 15:42:51,603 - {'Epoch': 29, 'HR@5': '0.0505', 'NDCG@5': '0.0355', 'HR@10': '0.0734', 'NDCG@10': '0.0429', 'HR@20': '0.1041', 'NDCG@20': '0.0506'}
2025-03-03 15:42:51,607 - Validation score increased.  Saving model ...
2025-03-03 15:43:31,642 - {'epoch': 30, 'rec_loss': '7.7310'}
2025-03-03 15:43:48,174 - {'Epoch': 30, 'HR@5': '0.0511', 'NDCG@5': '0.0355', 'HR@10': '0.0742', 'NDCG@10': '0.0429', 'HR@20': '0.1027', 'NDCG@20': '0.0501'}
2025-03-03 15:43:48,175 - EarlyStopping counter: 1 out of 10
2025-03-03 15:44:28,717 - {'epoch': 31, 'rec_loss': '7.7208'}
2025-03-03 15:44:45,403 - {'Epoch': 31, 'HR@5': '0.0509', 'NDCG@5': '0.0354', 'HR@10': '0.0735', 'NDCG@10': '0.0427', 'HR@20': '0.1047', 'NDCG@20': '0.0506'}
2025-03-03 15:44:45,404 - Validation score increased.  Saving model ...
2025-03-03 15:45:29,693 - {'epoch': 32, 'rec_loss': '7.7088'}
2025-03-03 15:45:46,423 - {'Epoch': 32, 'HR@5': '0.0513', 'NDCG@5': '0.0354', 'HR@10': '0.0744', 'NDCG@10': '0.0428', 'HR@20': '0.1045', 'NDCG@20': '0.0504'}
2025-03-03 15:45:46,424 - EarlyStopping counter: 1 out of 10
2025-03-03 15:46:27,067 - {'epoch': 33, 'rec_loss': '7.7026'}
2025-03-03 15:46:43,404 - {'Epoch': 33, 'HR@5': '0.0521', 'NDCG@5': '0.0361', 'HR@10': '0.0744', 'NDCG@10': '0.0432', 'HR@20': '0.1048', 'NDCG@20': '0.0509'}
2025-03-03 15:46:43,405 - Validation score increased.  Saving model ...
2025-03-03 15:47:23,740 - {'epoch': 34, 'rec_loss': '7.7019'}
2025-03-03 15:47:40,501 - {'Epoch': 34, 'HR@5': '0.0514', 'NDCG@5': '0.0357', 'HR@10': '0.0741', 'NDCG@10': '0.0430', 'HR@20': '0.1042', 'NDCG@20': '0.0505'}
2025-03-03 15:47:40,503 - EarlyStopping counter: 1 out of 10
2025-03-03 15:48:22,147 - {'epoch': 35, 'rec_loss': '7.6890'}
2025-03-03 15:48:38,748 - {'Epoch': 35, 'HR@5': '0.0518', 'NDCG@5': '0.0360', 'HR@10': '0.0747', 'NDCG@10': '0.0434', 'HR@20': '0.1060', 'NDCG@20': '0.0513'}
2025-03-03 15:48:38,749 - Validation score increased.  Saving model ...
2025-03-03 15:49:21,611 - {'epoch': 36, 'rec_loss': '7.6821'}
2025-03-03 15:49:39,148 - {'Epoch': 36, 'HR@5': '0.0510', 'NDCG@5': '0.0359', 'HR@10': '0.0750', 'NDCG@10': '0.0436', 'HR@20': '0.1058', 'NDCG@20': '0.0513'}
2025-03-03 15:49:39,152 - Validation score increased.  Saving model ...
2025-03-03 15:50:21,081 - {'epoch': 37, 'rec_loss': '7.6728'}
2025-03-03 15:50:37,763 - {'Epoch': 37, 'HR@5': '0.0515', 'NDCG@5': '0.0360', 'HR@10': '0.0748', 'NDCG@10': '0.0435', 'HR@20': '0.1062', 'NDCG@20': '0.0514'}
2025-03-03 15:50:37,769 - Validation score increased.  Saving model ...
2025-03-03 15:51:18,774 - {'epoch': 38, 'rec_loss': '7.6620'}
2025-03-03 15:51:35,474 - {'Epoch': 38, 'HR@5': '0.0522', 'NDCG@5': '0.0363', 'HR@10': '0.0749', 'NDCG@10': '0.0436', 'HR@20': '0.1049', 'NDCG@20': '0.0512'}
2025-03-03 15:51:35,480 - EarlyStopping counter: 1 out of 10
2025-03-03 15:52:15,600 - {'epoch': 39, 'rec_loss': '7.6592'}
2025-03-03 15:52:31,947 - {'Epoch': 39, 'HR@5': '0.0522', 'NDCG@5': '0.0365', 'HR@10': '0.0751', 'NDCG@10': '0.0439', 'HR@20': '0.1048', 'NDCG@20': '0.0514'}
2025-03-03 15:52:31,954 - EarlyStopping counter: 2 out of 10
2025-03-03 15:53:12,061 - {'epoch': 40, 'rec_loss': '7.6527'}
2025-03-03 15:53:28,817 - {'Epoch': 40, 'HR@5': '0.0518', 'NDCG@5': '0.0364', 'HR@10': '0.0748', 'NDCG@10': '0.0439', 'HR@20': '0.1041', 'NDCG@20': '0.0513'}
2025-03-03 15:53:28,821 - EarlyStopping counter: 3 out of 10
2025-03-03 15:54:08,966 - {'epoch': 41, 'rec_loss': '7.6422'}
2025-03-03 15:54:25,392 - {'Epoch': 41, 'HR@5': '0.0518', 'NDCG@5': '0.0363', 'HR@10': '0.0746', 'NDCG@10': '0.0437', 'HR@20': '0.1052', 'NDCG@20': '0.0513'}
2025-03-03 15:54:25,393 - EarlyStopping counter: 4 out of 10
2025-03-03 15:55:05,840 - {'epoch': 42, 'rec_loss': '7.6396'}
2025-03-03 15:55:22,313 - {'Epoch': 42, 'HR@5': '0.0520', 'NDCG@5': '0.0362', 'HR@10': '0.0749', 'NDCG@10': '0.0435', 'HR@20': '0.1055', 'NDCG@20': '0.0512'}
2025-03-03 15:55:22,314 - EarlyStopping counter: 5 out of 10
2025-03-03 15:56:03,472 - {'epoch': 43, 'rec_loss': '7.6373'}
2025-03-03 15:56:20,033 - {'Epoch': 43, 'HR@5': '0.0520', 'NDCG@5': '0.0360', 'HR@10': '0.0747', 'NDCG@10': '0.0433', 'HR@20': '0.1061', 'NDCG@20': '0.0512'}
2025-03-03 15:56:20,034 - EarlyStopping counter: 6 out of 10
2025-03-03 15:57:00,280 - {'epoch': 44, 'rec_loss': '7.6318'}
2025-03-03 15:57:16,800 - {'Epoch': 44, 'HR@5': '0.0523', 'NDCG@5': '0.0363', 'HR@10': '0.0767', 'NDCG@10': '0.0442', 'HR@20': '0.1063', 'NDCG@20': '0.0516'}
2025-03-03 15:57:16,801 - Validation score increased.  Saving model ...
2025-03-03 15:57:56,533 - {'epoch': 45, 'rec_loss': '7.6262'}
2025-03-03 15:58:13,082 - {'Epoch': 45, 'HR@5': '0.0519', 'NDCG@5': '0.0362', 'HR@10': '0.0749', 'NDCG@10': '0.0436', 'HR@20': '0.1058', 'NDCG@20': '0.0514'}
2025-03-03 15:58:13,083 - EarlyStopping counter: 1 out of 10
2025-03-03 15:58:54,612 - {'epoch': 46, 'rec_loss': '7.6241'}
2025-03-03 15:59:11,292 - {'Epoch': 46, 'HR@5': '0.0522', 'NDCG@5': '0.0360', 'HR@10': '0.0756', 'NDCG@10': '0.0435', 'HR@20': '0.1056', 'NDCG@20': '0.0511'}
2025-03-03 15:59:11,298 - EarlyStopping counter: 2 out of 10
2025-03-03 15:59:50,276 - {'epoch': 47, 'rec_loss': '7.6227'}
2025-03-03 16:00:06,865 - {'Epoch': 47, 'HR@5': '0.0517', 'NDCG@5': '0.0362', 'HR@10': '0.0750', 'NDCG@10': '0.0437', 'HR@20': '0.1059', 'NDCG@20': '0.0515'}
2025-03-03 16:00:06,866 - EarlyStopping counter: 3 out of 10
2025-03-03 16:00:46,228 - {'epoch': 48, 'rec_loss': '7.6119'}
2025-03-03 16:01:02,827 - {'Epoch': 48, 'HR@5': '0.0525', 'NDCG@5': '0.0363', 'HR@10': '0.0749', 'NDCG@10': '0.0435', 'HR@20': '0.1061', 'NDCG@20': '0.0513'}
2025-03-03 16:01:02,833 - EarlyStopping counter: 4 out of 10
2025-03-03 16:01:42,235 - {'epoch': 49, 'rec_loss': '7.6110'}
2025-03-03 16:01:58,901 - {'Epoch': 49, 'HR@5': '0.0519', 'NDCG@5': '0.0362', 'HR@10': '0.0742', 'NDCG@10': '0.0434', 'HR@20': '0.1055', 'NDCG@20': '0.0513'}
2025-03-03 16:01:58,902 - EarlyStopping counter: 5 out of 10
2025-03-03 16:02:39,685 - {'epoch': 50, 'rec_loss': '7.6111'}
2025-03-03 16:02:56,238 - {'Epoch': 50, 'HR@5': '0.0516', 'NDCG@5': '0.0363', 'HR@10': '0.0764', 'NDCG@10': '0.0443', 'HR@20': '0.1055', 'NDCG@20': '0.0516'}
2025-03-03 16:02:56,242 - EarlyStopping counter: 6 out of 10
2025-03-03 16:03:36,804 - {'epoch': 51, 'rec_loss': '7.6013'}
2025-03-03 16:03:54,303 - {'Epoch': 51, 'HR@5': '0.0520', 'NDCG@5': '0.0362', 'HR@10': '0.0755', 'NDCG@10': '0.0437', 'HR@20': '0.1063', 'NDCG@20': '0.0515'}
2025-03-03 16:03:54,304 - EarlyStopping counter: 7 out of 10
2025-03-03 16:04:35,756 - {'epoch': 52, 'rec_loss': '7.5976'}
2025-03-03 16:04:52,382 - {'Epoch': 52, 'HR@5': '0.0518', 'NDCG@5': '0.0360', 'HR@10': '0.0762', 'NDCG@10': '0.0438', 'HR@20': '0.1055', 'NDCG@20': '0.0512'}
2025-03-03 16:04:52,387 - EarlyStopping counter: 8 out of 10
2025-03-03 16:05:33,119 - {'epoch': 53, 'rec_loss': '7.5962'}
2025-03-03 16:05:49,475 - {'Epoch': 53, 'HR@5': '0.0524', 'NDCG@5': '0.0363', 'HR@10': '0.0763', 'NDCG@10': '0.0440', 'HR@20': '0.1057', 'NDCG@20': '0.0515'}
2025-03-03 16:05:49,476 - EarlyStopping counter: 9 out of 10
2025-03-03 16:06:29,956 - {'epoch': 54, 'rec_loss': '7.5902'}
2025-03-03 16:06:47,648 - {'Epoch': 54, 'HR@5': '0.0529', 'NDCG@5': '0.0365', 'HR@10': '0.0756', 'NDCG@10': '0.0438', 'HR@20': '0.1070', 'NDCG@20': '0.0517'}
2025-03-03 16:06:47,649 - Validation score increased.  Saving model ...
2025-03-03 17:22:47,270 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[8, 12, 32], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-03 17:23:02,792 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-03 17:23:02,804 - Total Parameters: 1328854
2025-03-03 17:23:47,632 - {'epoch': 0, 'rec_loss': '9.4023'}
2025-03-03 17:24:03,984 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0054', 'HR@10': '0.0125', 'NDCG@10': '0.0068', 'HR@20': '0.0215', 'NDCG@20': '0.0090'}
2025-03-03 17:24:03,985 - Validation score increased.  Saving model ...
2025-03-03 17:24:43,973 - {'epoch': 1, 'rec_loss': '9.2155'}
2025-03-03 17:25:00,020 - {'Epoch': 1, 'HR@5': '0.0137', 'NDCG@5': '0.0085', 'HR@10': '0.0219', 'NDCG@10': '0.0111', 'HR@20': '0.0382', 'NDCG@20': '0.0152'}
2025-03-03 17:25:00,021 - Validation score increased.  Saving model ...
2025-03-03 17:25:39,229 - {'epoch': 2, 'rec_loss': '8.9522'}
2025-03-03 17:25:55,221 - {'Epoch': 2, 'HR@5': '0.0178', 'NDCG@5': '0.0119', 'HR@10': '0.0302', 'NDCG@10': '0.0159', 'HR@20': '0.0485', 'NDCG@20': '0.0205'}
2025-03-03 17:25:55,223 - Validation score increased.  Saving model ...
2025-03-03 17:26:35,683 - {'epoch': 3, 'rec_loss': '8.7605'}
2025-03-03 17:26:51,415 - {'Epoch': 3, 'HR@5': '0.0269', 'NDCG@5': '0.0176', 'HR@10': '0.0406', 'NDCG@10': '0.0220', 'HR@20': '0.0630', 'NDCG@20': '0.0276'}
2025-03-03 17:26:51,416 - Validation score increased.  Saving model ...
2025-03-03 17:27:32,216 - {'epoch': 4, 'rec_loss': '8.6105'}
2025-03-03 17:27:47,907 - {'Epoch': 4, 'HR@5': '0.0300', 'NDCG@5': '0.0195', 'HR@10': '0.0466', 'NDCG@10': '0.0249', 'HR@20': '0.0706', 'NDCG@20': '0.0309'}
2025-03-03 17:27:47,908 - Validation score increased.  Saving model ...
2025-03-03 17:28:28,411 - {'epoch': 5, 'rec_loss': '8.4875'}
2025-03-03 17:28:44,469 - {'Epoch': 5, 'HR@5': '0.0366', 'NDCG@5': '0.0244', 'HR@10': '0.0534', 'NDCG@10': '0.0297', 'HR@20': '0.0776', 'NDCG@20': '0.0359'}
2025-03-03 17:28:44,470 - Validation score increased.  Saving model ...
2025-03-03 17:29:25,611 - {'epoch': 6, 'rec_loss': '8.3958'}
2025-03-03 17:29:41,631 - {'Epoch': 6, 'HR@5': '0.0381', 'NDCG@5': '0.0256', 'HR@10': '0.0566', 'NDCG@10': '0.0316', 'HR@20': '0.0824', 'NDCG@20': '0.0380'}
2025-03-03 17:29:41,632 - Validation score increased.  Saving model ...
2025-03-03 17:30:23,843 - {'epoch': 7, 'rec_loss': '8.3142'}
2025-03-03 17:30:39,565 - {'Epoch': 7, 'HR@5': '0.0405', 'NDCG@5': '0.0279', 'HR@10': '0.0599', 'NDCG@10': '0.0341', 'HR@20': '0.0858', 'NDCG@20': '0.0405'}
2025-03-03 17:30:39,566 - Validation score increased.  Saving model ...
2025-03-03 17:31:20,974 - {'epoch': 8, 'rec_loss': '8.2463'}
2025-03-03 17:31:36,680 - {'Epoch': 8, 'HR@5': '0.0426', 'NDCG@5': '0.0297', 'HR@10': '0.0615', 'NDCG@10': '0.0358', 'HR@20': '0.0883', 'NDCG@20': '0.0425'}
2025-03-03 17:31:36,682 - Validation score increased.  Saving model ...
2025-03-03 17:32:17,540 - {'epoch': 9, 'rec_loss': '8.1895'}
2025-03-03 17:32:33,612 - {'Epoch': 9, 'HR@5': '0.0445', 'NDCG@5': '0.0307', 'HR@10': '0.0635', 'NDCG@10': '0.0368', 'HR@20': '0.0910', 'NDCG@20': '0.0437'}
2025-03-03 17:32:33,614 - Validation score increased.  Saving model ...
2025-03-03 17:33:14,354 - {'epoch': 10, 'rec_loss': '8.1438'}
2025-03-03 17:33:30,781 - {'Epoch': 10, 'HR@5': '0.0449', 'NDCG@5': '0.0312', 'HR@10': '0.0645', 'NDCG@10': '0.0375', 'HR@20': '0.0913', 'NDCG@20': '0.0442'}
2025-03-03 17:33:30,782 - Validation score increased.  Saving model ...
2025-03-03 17:34:08,379 - {'epoch': 11, 'rec_loss': '8.0944'}
2025-03-03 17:34:26,043 - {'Epoch': 11, 'HR@5': '0.0463', 'NDCG@5': '0.0318', 'HR@10': '0.0667', 'NDCG@10': '0.0383', 'HR@20': '0.0947', 'NDCG@20': '0.0453'}
2025-03-03 17:34:26,044 - Validation score increased.  Saving model ...
2025-03-03 17:35:04,661 - {'epoch': 12, 'rec_loss': '8.0601'}
2025-03-03 17:35:21,241 - {'Epoch': 12, 'HR@5': '0.0478', 'NDCG@5': '0.0330', 'HR@10': '0.0677', 'NDCG@10': '0.0394', 'HR@20': '0.0950', 'NDCG@20': '0.0463'}
2025-03-03 17:35:21,243 - Validation score increased.  Saving model ...
2025-03-03 17:36:02,552 - {'epoch': 13, 'rec_loss': '8.0282'}
2025-03-03 17:36:20,167 - {'Epoch': 13, 'HR@5': '0.0474', 'NDCG@5': '0.0329', 'HR@10': '0.0678', 'NDCG@10': '0.0394', 'HR@20': '0.0965', 'NDCG@20': '0.0466'}
2025-03-03 17:36:20,168 - Validation score increased.  Saving model ...
2025-03-03 17:37:12,442 - {'epoch': 14, 'rec_loss': '7.9990'}
2025-03-03 17:37:32,707 - {'Epoch': 14, 'HR@5': '0.0480', 'NDCG@5': '0.0334', 'HR@10': '0.0688', 'NDCG@10': '0.0401', 'HR@20': '0.0978', 'NDCG@20': '0.0473'}
2025-03-03 17:37:32,709 - Validation score increased.  Saving model ...
2025-03-03 17:38:19,097 - {'epoch': 15, 'rec_loss': '7.9704'}
2025-03-03 17:38:36,074 - {'Epoch': 15, 'HR@5': '0.0484', 'NDCG@5': '0.0336', 'HR@10': '0.0688', 'NDCG@10': '0.0402', 'HR@20': '0.0974', 'NDCG@20': '0.0473'}
2025-03-03 17:38:36,076 - Validation score increased.  Saving model ...
2025-03-03 17:39:15,842 - {'epoch': 16, 'rec_loss': '7.9459'}
2025-03-03 17:39:32,229 - {'Epoch': 16, 'HR@5': '0.0485', 'NDCG@5': '0.0337', 'HR@10': '0.0689', 'NDCG@10': '0.0403', 'HR@20': '0.0984', 'NDCG@20': '0.0477'}
2025-03-03 17:39:32,230 - Validation score increased.  Saving model ...
2025-03-03 17:40:12,826 - {'epoch': 17, 'rec_loss': '7.9239'}
2025-03-03 17:40:29,356 - {'Epoch': 17, 'HR@5': '0.0483', 'NDCG@5': '0.0339', 'HR@10': '0.0691', 'NDCG@10': '0.0406', 'HR@20': '0.0986', 'NDCG@20': '0.0480'}
2025-03-03 17:40:29,358 - Validation score increased.  Saving model ...
2025-03-03 17:41:14,055 - {'epoch': 18, 'rec_loss': '7.8991'}
2025-03-03 17:41:30,614 - {'Epoch': 18, 'HR@5': '0.0495', 'NDCG@5': '0.0346', 'HR@10': '0.0707', 'NDCG@10': '0.0414', 'HR@20': '0.1005', 'NDCG@20': '0.0488'}
2025-03-03 17:41:30,615 - Validation score increased.  Saving model ...
2025-03-03 17:42:13,312 - {'epoch': 19, 'rec_loss': '7.8781'}
2025-03-03 17:42:31,217 - {'Epoch': 19, 'HR@5': '0.0493', 'NDCG@5': '0.0346', 'HR@10': '0.0710', 'NDCG@10': '0.0416', 'HR@20': '0.1005', 'NDCG@20': '0.0491'}
2025-03-03 17:42:31,219 - Validation score increased.  Saving model ...
2025-03-03 17:43:15,609 - {'epoch': 20, 'rec_loss': '7.8640'}
2025-03-03 17:43:33,581 - {'Epoch': 20, 'HR@5': '0.0505', 'NDCG@5': '0.0351', 'HR@10': '0.0726', 'NDCG@10': '0.0422', 'HR@20': '0.1023', 'NDCG@20': '0.0496'}
2025-03-03 17:43:33,586 - Validation score increased.  Saving model ...
2025-03-03 17:44:20,592 - {'epoch': 21, 'rec_loss': '7.8417'}
2025-03-03 17:44:38,080 - {'Epoch': 21, 'HR@5': '0.0496', 'NDCG@5': '0.0344', 'HR@10': '0.0703', 'NDCG@10': '0.0411', 'HR@20': '0.1025', 'NDCG@20': '0.0491'}
2025-03-03 17:44:38,081 - EarlyStopping counter: 1 out of 10
2025-03-03 17:45:38,104 - {'epoch': 22, 'rec_loss': '7.8293'}
2025-03-03 17:45:59,659 - {'Epoch': 22, 'HR@5': '0.0498', 'NDCG@5': '0.0348', 'HR@10': '0.0712', 'NDCG@10': '0.0417', 'HR@20': '0.1024', 'NDCG@20': '0.0495'}
2025-03-03 17:45:59,661 - EarlyStopping counter: 2 out of 10
2025-03-03 17:46:43,363 - {'epoch': 23, 'rec_loss': '7.8131'}
2025-03-03 17:47:00,706 - {'Epoch': 23, 'HR@5': '0.0496', 'NDCG@5': '0.0345', 'HR@10': '0.0718', 'NDCG@10': '0.0416', 'HR@20': '0.1023', 'NDCG@20': '0.0493'}
2025-03-03 17:47:00,707 - EarlyStopping counter: 3 out of 10
2025-03-03 17:47:48,819 - {'epoch': 24, 'rec_loss': '7.7997'}
2025-03-03 17:48:05,444 - {'Epoch': 24, 'HR@5': '0.0504', 'NDCG@5': '0.0351', 'HR@10': '0.0724', 'NDCG@10': '0.0422', 'HR@20': '0.1028', 'NDCG@20': '0.0498'}
2025-03-03 17:48:05,445 - Validation score increased.  Saving model ...
2025-03-03 17:48:47,779 - {'epoch': 25, 'rec_loss': '7.7836'}
2025-03-03 17:49:05,161 - {'Epoch': 25, 'HR@5': '0.0504', 'NDCG@5': '0.0351', 'HR@10': '0.0724', 'NDCG@10': '0.0422', 'HR@20': '0.1039', 'NDCG@20': '0.0501'}
2025-03-03 17:49:05,162 - Validation score increased.  Saving model ...
2025-03-03 17:49:46,833 - {'epoch': 26, 'rec_loss': '7.7727'}
2025-03-03 17:50:05,197 - {'Epoch': 26, 'HR@5': '0.0508', 'NDCG@5': '0.0357', 'HR@10': '0.0734', 'NDCG@10': '0.0429', 'HR@20': '0.1034', 'NDCG@20': '0.0505'}
2025-03-03 17:50:05,198 - Validation score increased.  Saving model ...
2025-03-03 17:50:51,964 - {'epoch': 27, 'rec_loss': '7.7551'}
2025-03-03 17:51:10,714 - {'Epoch': 27, 'HR@5': '0.0518', 'NDCG@5': '0.0359', 'HR@10': '0.0740', 'NDCG@10': '0.0430', 'HR@20': '0.1032', 'NDCG@20': '0.0503'}
2025-03-03 17:51:10,716 - EarlyStopping counter: 1 out of 10
2025-03-03 17:52:11,842 - {'epoch': 28, 'rec_loss': '7.7502'}
2025-03-03 17:52:32,050 - {'Epoch': 28, 'HR@5': '0.0509', 'NDCG@5': '0.0358', 'HR@10': '0.0732', 'NDCG@10': '0.0430', 'HR@20': '0.1030', 'NDCG@20': '0.0504'}
2025-03-03 17:52:32,051 - EarlyStopping counter: 2 out of 10
2025-03-03 17:53:22,856 - {'epoch': 29, 'rec_loss': '7.7397'}
2025-03-03 17:53:41,239 - {'Epoch': 29, 'HR@5': '0.0505', 'NDCG@5': '0.0355', 'HR@10': '0.0734', 'NDCG@10': '0.0429', 'HR@20': '0.1041', 'NDCG@20': '0.0506'}
2025-03-03 17:53:41,240 - Validation score increased.  Saving model ...
2025-03-03 17:54:27,571 - {'epoch': 30, 'rec_loss': '7.7310'}
2025-03-03 17:54:48,416 - {'Epoch': 30, 'HR@5': '0.0511', 'NDCG@5': '0.0355', 'HR@10': '0.0742', 'NDCG@10': '0.0429', 'HR@20': '0.1027', 'NDCG@20': '0.0501'}
2025-03-03 17:54:48,418 - EarlyStopping counter: 1 out of 10
2025-03-03 17:55:48,943 - {'epoch': 31, 'rec_loss': '7.7208'}
2025-03-03 17:56:10,773 - {'Epoch': 31, 'HR@5': '0.0509', 'NDCG@5': '0.0354', 'HR@10': '0.0735', 'NDCG@10': '0.0427', 'HR@20': '0.1047', 'NDCG@20': '0.0506'}
2025-03-03 17:56:10,775 - Validation score increased.  Saving model ...
2025-03-03 17:56:52,661 - {'epoch': 32, 'rec_loss': '7.7088'}
2025-03-03 17:57:10,673 - {'Epoch': 32, 'HR@5': '0.0513', 'NDCG@5': '0.0354', 'HR@10': '0.0744', 'NDCG@10': '0.0428', 'HR@20': '0.1045', 'NDCG@20': '0.0504'}
2025-03-03 17:57:10,674 - EarlyStopping counter: 1 out of 10
2025-03-03 17:58:05,374 - {'epoch': 33, 'rec_loss': '7.7026'}
2025-03-03 17:58:27,325 - {'Epoch': 33, 'HR@5': '0.0521', 'NDCG@5': '0.0361', 'HR@10': '0.0744', 'NDCG@10': '0.0432', 'HR@20': '0.1048', 'NDCG@20': '0.0509'}
2025-03-03 17:58:27,327 - Validation score increased.  Saving model ...
2025-03-03 17:59:19,986 - {'epoch': 34, 'rec_loss': '7.7019'}
2025-03-03 17:59:36,791 - {'Epoch': 34, 'HR@5': '0.0514', 'NDCG@5': '0.0357', 'HR@10': '0.0741', 'NDCG@10': '0.0430', 'HR@20': '0.1042', 'NDCG@20': '0.0505'}
2025-03-03 17:59:36,792 - EarlyStopping counter: 1 out of 10
2025-03-03 18:00:25,082 - {'epoch': 35, 'rec_loss': '7.6890'}
2025-03-03 18:00:46,647 - {'Epoch': 35, 'HR@5': '0.0518', 'NDCG@5': '0.0360', 'HR@10': '0.0747', 'NDCG@10': '0.0434', 'HR@20': '0.1060', 'NDCG@20': '0.0513'}
2025-03-03 18:00:46,649 - Validation score increased.  Saving model ...
2025-03-03 18:01:45,324 - {'epoch': 36, 'rec_loss': '7.6821'}
2025-03-03 18:02:03,676 - {'Epoch': 36, 'HR@5': '0.0510', 'NDCG@5': '0.0359', 'HR@10': '0.0750', 'NDCG@10': '0.0436', 'HR@20': '0.1058', 'NDCG@20': '0.0513'}
2025-03-03 18:02:03,677 - Validation score increased.  Saving model ...
2025-03-03 18:02:43,415 - {'epoch': 37, 'rec_loss': '7.6728'}
2025-03-03 18:03:05,966 - {'Epoch': 37, 'HR@5': '0.0515', 'NDCG@5': '0.0360', 'HR@10': '0.0748', 'NDCG@10': '0.0435', 'HR@20': '0.1062', 'NDCG@20': '0.0514'}
2025-03-03 18:03:05,967 - Validation score increased.  Saving model ...
2025-03-03 18:04:11,123 - {'epoch': 38, 'rec_loss': '7.6620'}
2025-03-03 18:04:32,644 - {'Epoch': 38, 'HR@5': '0.0522', 'NDCG@5': '0.0363', 'HR@10': '0.0749', 'NDCG@10': '0.0436', 'HR@20': '0.1049', 'NDCG@20': '0.0512'}
2025-03-03 18:04:32,646 - EarlyStopping counter: 1 out of 10
2025-03-03 18:05:14,922 - {'epoch': 39, 'rec_loss': '7.6592'}
2025-03-03 18:05:31,811 - {'Epoch': 39, 'HR@5': '0.0522', 'NDCG@5': '0.0365', 'HR@10': '0.0751', 'NDCG@10': '0.0439', 'HR@20': '0.1048', 'NDCG@20': '0.0514'}
2025-03-03 18:05:31,813 - EarlyStopping counter: 2 out of 10
2025-03-03 18:06:32,263 - {'epoch': 40, 'rec_loss': '7.6527'}
2025-03-03 18:06:53,988 - {'Epoch': 40, 'HR@5': '0.0518', 'NDCG@5': '0.0364', 'HR@10': '0.0748', 'NDCG@10': '0.0439', 'HR@20': '0.1041', 'NDCG@20': '0.0513'}
2025-03-03 18:06:53,990 - EarlyStopping counter: 3 out of 10
2025-03-03 18:07:41,823 - {'epoch': 41, 'rec_loss': '7.6422'}
2025-03-03 18:07:59,626 - {'Epoch': 41, 'HR@5': '0.0518', 'NDCG@5': '0.0363', 'HR@10': '0.0746', 'NDCG@10': '0.0437', 'HR@20': '0.1052', 'NDCG@20': '0.0513'}
2025-03-03 18:07:59,627 - EarlyStopping counter: 4 out of 10
2025-03-03 18:08:50,886 - {'epoch': 42, 'rec_loss': '7.6396'}
2025-03-03 18:09:12,226 - {'Epoch': 42, 'HR@5': '0.0520', 'NDCG@5': '0.0362', 'HR@10': '0.0749', 'NDCG@10': '0.0435', 'HR@20': '0.1055', 'NDCG@20': '0.0512'}
2025-03-03 18:09:12,227 - EarlyStopping counter: 5 out of 10
2025-03-03 18:10:10,117 - {'epoch': 43, 'rec_loss': '7.6373'}
2025-03-03 18:10:27,137 - {'Epoch': 43, 'HR@5': '0.0520', 'NDCG@5': '0.0360', 'HR@10': '0.0747', 'NDCG@10': '0.0433', 'HR@20': '0.1061', 'NDCG@20': '0.0512'}
2025-03-03 18:10:27,138 - EarlyStopping counter: 6 out of 10
2025-03-03 18:11:10,252 - {'epoch': 44, 'rec_loss': '7.6318'}
2025-03-03 18:11:32,678 - {'Epoch': 44, 'HR@5': '0.0523', 'NDCG@5': '0.0363', 'HR@10': '0.0767', 'NDCG@10': '0.0442', 'HR@20': '0.1063', 'NDCG@20': '0.0516'}
2025-03-03 18:11:32,680 - Validation score increased.  Saving model ...
2025-03-03 18:12:36,093 - {'epoch': 45, 'rec_loss': '7.6262'}
2025-03-03 18:12:56,682 - {'Epoch': 45, 'HR@5': '0.0519', 'NDCG@5': '0.0362', 'HR@10': '0.0749', 'NDCG@10': '0.0436', 'HR@20': '0.1058', 'NDCG@20': '0.0514'}
2025-03-03 18:12:56,684 - EarlyStopping counter: 1 out of 10
2025-03-03 18:13:37,066 - {'epoch': 46, 'rec_loss': '7.6241'}
2025-03-03 18:13:53,867 - {'Epoch': 46, 'HR@5': '0.0522', 'NDCG@5': '0.0360', 'HR@10': '0.0756', 'NDCG@10': '0.0435', 'HR@20': '0.1056', 'NDCG@20': '0.0511'}
2025-03-03 18:13:53,869 - EarlyStopping counter: 2 out of 10
2025-03-03 18:14:49,241 - {'epoch': 47, 'rec_loss': '7.6227'}
2025-03-03 18:15:10,879 - {'Epoch': 47, 'HR@5': '0.0517', 'NDCG@5': '0.0362', 'HR@10': '0.0750', 'NDCG@10': '0.0437', 'HR@20': '0.1059', 'NDCG@20': '0.0515'}
2025-03-03 18:15:10,881 - EarlyStopping counter: 3 out of 10
2025-03-03 18:16:04,879 - {'epoch': 48, 'rec_loss': '7.6119'}
2025-03-03 18:16:23,173 - {'Epoch': 48, 'HR@5': '0.0525', 'NDCG@5': '0.0363', 'HR@10': '0.0749', 'NDCG@10': '0.0435', 'HR@20': '0.1061', 'NDCG@20': '0.0513'}
2025-03-03 18:16:23,174 - EarlyStopping counter: 4 out of 10
2025-03-03 18:17:13,244 - {'epoch': 49, 'rec_loss': '7.6110'}
2025-03-03 18:17:34,771 - {'Epoch': 49, 'HR@5': '0.0519', 'NDCG@5': '0.0362', 'HR@10': '0.0742', 'NDCG@10': '0.0434', 'HR@20': '0.1055', 'NDCG@20': '0.0513'}
2025-03-03 18:17:34,773 - EarlyStopping counter: 5 out of 10
2025-03-03 18:18:33,908 - {'epoch': 50, 'rec_loss': '7.6111'}
2025-03-03 18:18:50,667 - {'Epoch': 50, 'HR@5': '0.0516', 'NDCG@5': '0.0363', 'HR@10': '0.0764', 'NDCG@10': '0.0443', 'HR@20': '0.1055', 'NDCG@20': '0.0516'}
2025-03-03 18:18:50,668 - EarlyStopping counter: 6 out of 10
2025-03-03 18:19:32,207 - {'epoch': 51, 'rec_loss': '7.6013'}
2025-03-03 18:19:53,017 - {'Epoch': 51, 'HR@5': '0.0520', 'NDCG@5': '0.0362', 'HR@10': '0.0755', 'NDCG@10': '0.0437', 'HR@20': '0.1063', 'NDCG@20': '0.0515'}
2025-03-03 18:19:53,019 - EarlyStopping counter: 7 out of 10
2025-03-03 18:20:53,945 - {'epoch': 52, 'rec_loss': '7.5976'}
2025-03-03 18:21:15,718 - {'Epoch': 52, 'HR@5': '0.0518', 'NDCG@5': '0.0360', 'HR@10': '0.0762', 'NDCG@10': '0.0438', 'HR@20': '0.1055', 'NDCG@20': '0.0512'}
2025-03-03 18:21:15,721 - EarlyStopping counter: 8 out of 10
2025-03-03 18:21:55,925 - {'epoch': 53, 'rec_loss': '7.5962'}
2025-03-03 18:22:14,801 - {'Epoch': 53, 'HR@5': '0.0524', 'NDCG@5': '0.0363', 'HR@10': '0.0763', 'NDCG@10': '0.0440', 'HR@20': '0.1057', 'NDCG@20': '0.0515'}
2025-03-03 18:22:14,804 - EarlyStopping counter: 9 out of 10
2025-03-03 18:23:14,501 - {'epoch': 54, 'rec_loss': '7.5902'}
2025-03-03 18:23:36,785 - {'Epoch': 54, 'HR@5': '0.0529', 'NDCG@5': '0.0365', 'HR@10': '0.0756', 'NDCG@10': '0.0438', 'HR@20': '0.1070', 'NDCG@20': '0.0517'}
2025-03-03 18:23:36,787 - Validation score increased.  Saving model ...
2025-03-03 18:24:22,457 - {'epoch': 55, 'rec_loss': '7.5836'}
2025-03-03 18:24:40,114 - {'Epoch': 55, 'HR@5': '0.0528', 'NDCG@5': '0.0369', 'HR@10': '0.0766', 'NDCG@10': '0.0445', 'HR@20': '0.1062', 'NDCG@20': '0.0520'}
2025-03-03 18:24:40,115 - Validation score increased.  Saving model ...
2025-03-03 18:25:30,122 - {'epoch': 56, 'rec_loss': '7.5821'}
2025-03-03 18:25:51,494 - {'Epoch': 56, 'HR@5': '0.0524', 'NDCG@5': '0.0362', 'HR@10': '0.0763', 'NDCG@10': '0.0439', 'HR@20': '0.1070', 'NDCG@20': '0.0516'}
2025-03-03 18:25:51,495 - EarlyStopping counter: 1 out of 10
2025-03-03 18:26:50,710 - {'epoch': 57, 'rec_loss': '7.5766'}
2025-03-03 18:27:09,731 - {'Epoch': 57, 'HR@5': '0.0516', 'NDCG@5': '0.0359', 'HR@10': '0.0752', 'NDCG@10': '0.0435', 'HR@20': '0.1058', 'NDCG@20': '0.0512'}
2025-03-03 18:27:09,733 - EarlyStopping counter: 2 out of 10
2025-03-03 18:27:51,248 - {'epoch': 58, 'rec_loss': '7.5763'}
2025-03-03 18:28:13,309 - {'Epoch': 58, 'HR@5': '0.0516', 'NDCG@5': '0.0361', 'HR@10': '0.0767', 'NDCG@10': '0.0442', 'HR@20': '0.1066', 'NDCG@20': '0.0517'}
2025-03-03 18:28:13,312 - EarlyStopping counter: 3 out of 10
2025-03-03 18:29:13,429 - {'epoch': 59, 'rec_loss': '7.5749'}
2025-03-03 18:29:33,371 - {'Epoch': 59, 'HR@5': '0.0514', 'NDCG@5': '0.0363', 'HR@10': '0.0757', 'NDCG@10': '0.0441', 'HR@20': '0.1059', 'NDCG@20': '0.0517'}
2025-03-03 18:29:33,373 - EarlyStopping counter: 4 out of 10
2025-03-03 18:30:13,806 - {'epoch': 60, 'rec_loss': '7.5655'}
2025-03-03 18:30:33,486 - {'Epoch': 60, 'HR@5': '0.0520', 'NDCG@5': '0.0364', 'HR@10': '0.0757', 'NDCG@10': '0.0441', 'HR@20': '0.1060', 'NDCG@20': '0.0517'}
2025-03-03 18:30:33,487 - EarlyStopping counter: 5 out of 10
2025-03-03 18:31:33,559 - {'epoch': 61, 'rec_loss': '7.5628'}
2025-03-03 18:31:55,232 - {'Epoch': 61, 'HR@5': '0.0528', 'NDCG@5': '0.0366', 'HR@10': '0.0759', 'NDCG@10': '0.0440', 'HR@20': '0.1071', 'NDCG@20': '0.0518'}
2025-03-03 18:31:55,234 - EarlyStopping counter: 6 out of 10
2025-03-03 18:32:42,083 - {'epoch': 62, 'rec_loss': '7.5622'}
2025-03-03 18:32:59,373 - {'Epoch': 62, 'HR@5': '0.0522', 'NDCG@5': '0.0360', 'HR@10': '0.0758', 'NDCG@10': '0.0436', 'HR@20': '0.1074', 'NDCG@20': '0.0516'}
2025-03-03 18:32:59,376 - EarlyStopping counter: 7 out of 10
2025-03-03 18:33:49,444 - {'epoch': 63, 'rec_loss': '7.5623'}
2025-03-03 18:34:10,509 - {'Epoch': 63, 'HR@5': '0.0527', 'NDCG@5': '0.0365', 'HR@10': '0.0764', 'NDCG@10': '0.0442', 'HR@20': '0.1063', 'NDCG@20': '0.0517'}
2025-03-03 18:34:10,510 - EarlyStopping counter: 8 out of 10
2025-03-03 18:35:03,729 - {'epoch': 64, 'rec_loss': '7.5555'}
2025-03-03 18:35:22,191 - {'Epoch': 64, 'HR@5': '0.0524', 'NDCG@5': '0.0363', 'HR@10': '0.0768', 'NDCG@10': '0.0442', 'HR@20': '0.1065', 'NDCG@20': '0.0516'}
2025-03-03 18:35:22,192 - EarlyStopping counter: 9 out of 10
2025-03-03 18:36:10,780 - {'epoch': 65, 'rec_loss': '7.5507'}
2025-03-03 18:36:32,763 - {'Epoch': 65, 'HR@5': '0.0525', 'NDCG@5': '0.0368', 'HR@10': '0.0763', 'NDCG@10': '0.0445', 'HR@20': '0.1072', 'NDCG@20': '0.0523'}
2025-03-03 18:36:32,765 - Validation score increased.  Saving model ...
2025-03-03 18:37:33,419 - {'epoch': 66, 'rec_loss': '7.5482'}
2025-03-03 18:37:51,627 - {'Epoch': 66, 'HR@5': '0.0524', 'NDCG@5': '0.0364', 'HR@10': '0.0749', 'NDCG@10': '0.0436', 'HR@20': '0.1063', 'NDCG@20': '0.0515'}
2025-03-03 18:37:51,628 - EarlyStopping counter: 1 out of 10
2025-03-03 18:38:32,799 - {'epoch': 67, 'rec_loss': '7.5483'}
2025-03-03 18:38:53,331 - {'Epoch': 67, 'HR@5': '0.0530', 'NDCG@5': '0.0369', 'HR@10': '0.0750', 'NDCG@10': '0.0439', 'HR@20': '0.1069', 'NDCG@20': '0.0520'}
2025-03-03 18:38:53,333 - EarlyStopping counter: 2 out of 10
2025-03-03 18:39:53,199 - {'epoch': 68, 'rec_loss': '7.5424'}
2025-03-03 18:40:14,746 - {'Epoch': 68, 'HR@5': '0.0531', 'NDCG@5': '0.0373', 'HR@10': '0.0758', 'NDCG@10': '0.0445', 'HR@20': '0.1062', 'NDCG@20': '0.0522'}
2025-03-03 18:40:14,748 - EarlyStopping counter: 3 out of 10
2025-03-03 18:40:54,163 - {'epoch': 69, 'rec_loss': '7.5402'}
2025-03-03 18:41:10,848 - {'Epoch': 69, 'HR@5': '0.0526', 'NDCG@5': '0.0367', 'HR@10': '0.0757', 'NDCG@10': '0.0441', 'HR@20': '0.1057', 'NDCG@20': '0.0516'}
2025-03-03 18:41:10,849 - EarlyStopping counter: 4 out of 10
2025-03-03 18:42:10,084 - {'epoch': 70, 'rec_loss': '7.5350'}
2025-03-03 18:42:31,222 - {'Epoch': 70, 'HR@5': '0.0524', 'NDCG@5': '0.0366', 'HR@10': '0.0757', 'NDCG@10': '0.0440', 'HR@20': '0.1067', 'NDCG@20': '0.0518'}
2025-03-03 18:42:31,223 - EarlyStopping counter: 5 out of 10
2025-03-03 18:43:18,627 - {'epoch': 71, 'rec_loss': '7.5373'}
2025-03-03 18:43:37,570 - {'Epoch': 71, 'HR@5': '0.0531', 'NDCG@5': '0.0369', 'HR@10': '0.0762', 'NDCG@10': '0.0443', 'HR@20': '0.1063', 'NDCG@20': '0.0519'}
2025-03-03 18:43:37,571 - EarlyStopping counter: 6 out of 10
2025-03-03 18:44:22,486 - {'epoch': 72, 'rec_loss': '7.5373'}
2025-03-03 18:44:44,037 - {'Epoch': 72, 'HR@5': '0.0532', 'NDCG@5': '0.0370', 'HR@10': '0.0766', 'NDCG@10': '0.0445', 'HR@20': '0.1064', 'NDCG@20': '0.0520'}
2025-03-03 18:44:44,038 - EarlyStopping counter: 7 out of 10
2025-03-03 18:45:42,616 - {'epoch': 73, 'rec_loss': '7.5304'}
2025-03-03 18:45:59,567 - {'Epoch': 73, 'HR@5': '0.0527', 'NDCG@5': '0.0365', 'HR@10': '0.0765', 'NDCG@10': '0.0441', 'HR@20': '0.1070', 'NDCG@20': '0.0518'}
2025-03-03 18:45:59,568 - EarlyStopping counter: 8 out of 10
2025-03-03 18:46:40,270 - {'epoch': 74, 'rec_loss': '7.5321'}
2025-03-03 18:47:01,521 - {'Epoch': 74, 'HR@5': '0.0530', 'NDCG@5': '0.0371', 'HR@10': '0.0773', 'NDCG@10': '0.0449', 'HR@20': '0.1069', 'NDCG@20': '0.0524'}
2025-03-03 18:47:01,524 - Validation score increased.  Saving model ...
2025-03-03 18:48:00,602 - {'epoch': 75, 'rec_loss': '7.5217'}
2025-03-03 18:48:21,434 - {'Epoch': 75, 'HR@5': '0.0537', 'NDCG@5': '0.0375', 'HR@10': '0.0764', 'NDCG@10': '0.0448', 'HR@20': '0.1066', 'NDCG@20': '0.0524'}
2025-03-03 18:48:21,436 - Validation score increased.  Saving model ...
2025-03-03 18:49:02,594 - {'epoch': 76, 'rec_loss': '7.5197'}
2025-03-03 18:49:19,232 - {'Epoch': 76, 'HR@5': '0.0531', 'NDCG@5': '0.0372', 'HR@10': '0.0768', 'NDCG@10': '0.0448', 'HR@20': '0.1086', 'NDCG@20': '0.0529'}
2025-03-03 18:49:19,234 - Validation score increased.  Saving model ...
2025-03-03 18:50:19,006 - {'epoch': 77, 'rec_loss': '7.5256'}
2025-03-03 18:50:40,152 - {'Epoch': 77, 'HR@5': '0.0528', 'NDCG@5': '0.0369', 'HR@10': '0.0753', 'NDCG@10': '0.0442', 'HR@20': '0.1060', 'NDCG@20': '0.0519'}
2025-03-03 18:50:40,155 - EarlyStopping counter: 1 out of 10
2025-03-03 18:51:29,213 - {'epoch': 78, 'rec_loss': '7.5212'}
2025-03-03 18:51:47,233 - {'Epoch': 78, 'HR@5': '0.0523', 'NDCG@5': '0.0368', 'HR@10': '0.0762', 'NDCG@10': '0.0444', 'HR@20': '0.1059', 'NDCG@20': '0.0519'}
2025-03-03 18:51:47,234 - EarlyStopping counter: 2 out of 10
2025-03-03 18:52:36,008 - {'epoch': 79, 'rec_loss': '7.5114'}
2025-03-03 18:52:57,496 - {'Epoch': 79, 'HR@5': '0.0522', 'NDCG@5': '0.0365', 'HR@10': '0.0757', 'NDCG@10': '0.0441', 'HR@20': '0.1069', 'NDCG@20': '0.0519'}
2025-03-03 18:52:57,498 - EarlyStopping counter: 3 out of 10
2025-03-03 18:53:52,767 - {'epoch': 80, 'rec_loss': '7.5151'}
2025-03-03 18:54:11,568 - {'Epoch': 80, 'HR@5': '0.0520', 'NDCG@5': '0.0367', 'HR@10': '0.0761', 'NDCG@10': '0.0444', 'HR@20': '0.1074', 'NDCG@20': '0.0522'}
2025-03-03 18:54:11,570 - EarlyStopping counter: 4 out of 10
2025-03-03 18:54:50,890 - {'epoch': 81, 'rec_loss': '7.5127'}
2025-03-03 18:55:11,074 - {'Epoch': 81, 'HR@5': '0.0531', 'NDCG@5': '0.0373', 'HR@10': '0.0757', 'NDCG@10': '0.0446', 'HR@20': '0.1064', 'NDCG@20': '0.0523'}
2025-03-03 18:55:11,076 - EarlyStopping counter: 5 out of 10
2025-03-03 18:56:11,270 - {'epoch': 82, 'rec_loss': '7.5136'}
2025-03-03 18:56:32,616 - {'Epoch': 82, 'HR@5': '0.0527', 'NDCG@5': '0.0374', 'HR@10': '0.0763', 'NDCG@10': '0.0450', 'HR@20': '0.1062', 'NDCG@20': '0.0525'}
2025-03-03 18:56:32,619 - EarlyStopping counter: 6 out of 10
2025-03-03 18:57:15,785 - {'epoch': 83, 'rec_loss': '7.5058'}
2025-03-03 18:57:36,564 - {'Epoch': 83, 'HR@5': '0.0521', 'NDCG@5': '0.0366', 'HR@10': '0.0756', 'NDCG@10': '0.0442', 'HR@20': '0.1069', 'NDCG@20': '0.0520'}
2025-03-03 18:57:36,568 - EarlyStopping counter: 7 out of 10
2025-03-03 18:58:36,102 - {'epoch': 84, 'rec_loss': '7.5030'}
2025-03-03 18:58:56,903 - {'Epoch': 84, 'HR@5': '0.0523', 'NDCG@5': '0.0368', 'HR@10': '0.0748', 'NDCG@10': '0.0440', 'HR@20': '0.1055', 'NDCG@20': '0.0517'}
2025-03-03 18:58:56,905 - EarlyStopping counter: 8 out of 10
2025-03-03 18:59:42,893 - {'epoch': 85, 'rec_loss': '7.5094'}
2025-03-03 18:59:59,833 - {'Epoch': 85, 'HR@5': '0.0538', 'NDCG@5': '0.0374', 'HR@10': '0.0766', 'NDCG@10': '0.0447', 'HR@20': '0.1057', 'NDCG@20': '0.0521'}
2025-03-03 18:59:59,834 - EarlyStopping counter: 9 out of 10
2025-03-03 19:00:51,831 - {'epoch': 86, 'rec_loss': '7.4945'}
2025-03-03 19:01:13,455 - {'Epoch': 86, 'HR@5': '0.0536', 'NDCG@5': '0.0376', 'HR@10': '0.0751', 'NDCG@10': '0.0445', 'HR@20': '0.1051', 'NDCG@20': '0.0521'}
2025-03-03 19:01:13,457 - EarlyStopping counter: 10 out of 10
2025-03-03 19:01:13,458 - Early stopping
2025-03-03 19:01:13,458 - ---------------Test Score---------------
2025-03-03 19:01:34,428 - {'Epoch': 0, 'HR@5': '0.0433', 'NDCG@5': '0.0299', 'HR@10': '0.0633', 'NDCG@10': '0.0363', 'HR@20': '0.0910', 'NDCG@20': '0.0433'}
2025-03-03 19:01:34,430 - Scale_Sports
2025-03-03 19:01:34,430 - {'Epoch': 0, 'HR@5': '0.0433', 'NDCG@5': '0.0299', 'HR@10': '0.0633', 'NDCG@10': '0.0363', 'HR@20': '0.0910', 'NDCG@20': '0.0433'}
2025-03-03 19:14:44,732 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[8, 24, 32], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-03 19:14:48,542 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-03 19:14:48,551 - Total Parameters: 1328854
2025-03-03 19:15:45,177 - {'epoch': 0, 'rec_loss': '9.4025'}
2025-03-03 19:16:04,421 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0054', 'HR@10': '0.0125', 'NDCG@10': '0.0068', 'HR@20': '0.0213', 'NDCG@20': '0.0090'}
2025-03-03 19:16:04,426 - Validation score increased.  Saving model ...
2025-03-03 19:16:42,512 - {'epoch': 1, 'rec_loss': '9.2209'}
2025-03-03 19:17:00,138 - {'Epoch': 1, 'HR@5': '0.0136', 'NDCG@5': '0.0085', 'HR@10': '0.0226', 'NDCG@10': '0.0114', 'HR@20': '0.0379', 'NDCG@20': '0.0153'}
2025-03-03 19:17:00,143 - Validation score increased.  Saving model ...
2025-03-03 19:17:56,026 - {'epoch': 2, 'rec_loss': '8.9567'}
2025-03-03 19:18:16,672 - {'Epoch': 2, 'HR@5': '0.0180', 'NDCG@5': '0.0120', 'HR@10': '0.0303', 'NDCG@10': '0.0159', 'HR@20': '0.0487', 'NDCG@20': '0.0205'}
2025-03-03 19:18:16,673 - Validation score increased.  Saving model ...
2025-03-03 19:19:04,089 - {'epoch': 3, 'rec_loss': '8.7618'}
2025-03-03 19:19:20,716 - {'Epoch': 3, 'HR@5': '0.0270', 'NDCG@5': '0.0175', 'HR@10': '0.0404', 'NDCG@10': '0.0218', 'HR@20': '0.0630', 'NDCG@20': '0.0275'}
2025-03-03 19:19:20,721 - Validation score increased.  Saving model ...
2025-03-03 19:19:59,782 - {'epoch': 4, 'rec_loss': '8.6114'}
2025-03-03 19:20:19,771 - {'Epoch': 4, 'HR@5': '0.0301', 'NDCG@5': '0.0197', 'HR@10': '0.0465', 'NDCG@10': '0.0250', 'HR@20': '0.0711', 'NDCG@20': '0.0312'}
2025-03-03 19:20:19,776 - Validation score increased.  Saving model ...
2025-03-03 19:21:16,971 - {'epoch': 5, 'rec_loss': '8.4884'}
2025-03-03 19:21:38,355 - {'Epoch': 5, 'HR@5': '0.0363', 'NDCG@5': '0.0243', 'HR@10': '0.0536', 'NDCG@10': '0.0299', 'HR@20': '0.0773', 'NDCG@20': '0.0358'}
2025-03-03 19:21:38,359 - Validation score increased.  Saving model ...
2025-03-03 19:22:17,843 - {'epoch': 6, 'rec_loss': '8.3959'}
2025-03-03 19:22:36,967 - {'Epoch': 6, 'HR@5': '0.0381', 'NDCG@5': '0.0257', 'HR@10': '0.0563', 'NDCG@10': '0.0316', 'HR@20': '0.0823', 'NDCG@20': '0.0381'}
2025-03-03 19:22:36,972 - Validation score increased.  Saving model ...
2025-03-03 19:23:37,264 - {'epoch': 7, 'rec_loss': '8.3141'}
2025-03-03 19:23:57,830 - {'Epoch': 7, 'HR@5': '0.0401', 'NDCG@5': '0.0277', 'HR@10': '0.0595', 'NDCG@10': '0.0339', 'HR@20': '0.0862', 'NDCG@20': '0.0406'}
2025-03-03 19:23:57,835 - Validation score increased.  Saving model ...
2025-03-03 19:24:46,669 - {'epoch': 8, 'rec_loss': '8.2460'}
2025-03-03 19:25:03,290 - {'Epoch': 8, 'HR@5': '0.0429', 'NDCG@5': '0.0297', 'HR@10': '0.0614', 'NDCG@10': '0.0357', 'HR@20': '0.0886', 'NDCG@20': '0.0425'}
2025-03-03 19:25:03,296 - Validation score increased.  Saving model ...
2025-03-03 19:25:54,452 - {'epoch': 9, 'rec_loss': '8.1891'}
2025-03-03 19:26:15,256 - {'Epoch': 9, 'HR@5': '0.0446', 'NDCG@5': '0.0307', 'HR@10': '0.0638', 'NDCG@10': '0.0369', 'HR@20': '0.0914', 'NDCG@20': '0.0438'}
2025-03-03 19:26:15,260 - Validation score increased.  Saving model ...
2025-03-03 19:27:11,615 - {'epoch': 10, 'rec_loss': '8.1429'}
2025-03-03 19:27:30,130 - {'Epoch': 10, 'HR@5': '0.0447', 'NDCG@5': '0.0312', 'HR@10': '0.0641', 'NDCG@10': '0.0374', 'HR@20': '0.0921', 'NDCG@20': '0.0445'}
2025-03-03 19:27:30,134 - Validation score increased.  Saving model ...
2025-03-03 19:28:14,391 - {'epoch': 11, 'rec_loss': '8.0935'}
2025-03-03 19:28:35,249 - {'Epoch': 11, 'HR@5': '0.0465', 'NDCG@5': '0.0318', 'HR@10': '0.0666', 'NDCG@10': '0.0383', 'HR@20': '0.0943', 'NDCG@20': '0.0452'}
2025-03-03 19:28:35,253 - Validation score increased.  Saving model ...
2025-03-03 19:29:35,874 - {'epoch': 12, 'rec_loss': '8.0595'}
2025-03-03 19:29:56,209 - {'Epoch': 12, 'HR@5': '0.0476', 'NDCG@5': '0.0330', 'HR@10': '0.0676', 'NDCG@10': '0.0394', 'HR@20': '0.0952', 'NDCG@20': '0.0464'}
2025-03-03 19:29:56,211 - Validation score increased.  Saving model ...
2025-03-03 19:30:39,361 - {'epoch': 13, 'rec_loss': '8.0272'}
2025-03-03 19:30:56,545 - {'Epoch': 13, 'HR@5': '0.0474', 'NDCG@5': '0.0329', 'HR@10': '0.0677', 'NDCG@10': '0.0394', 'HR@20': '0.0964', 'NDCG@20': '0.0466'}
2025-03-03 19:30:56,547 - Validation score increased.  Saving model ...
2025-03-03 19:31:56,436 - {'epoch': 14, 'rec_loss': '7.9978'}
2025-03-03 19:32:17,604 - {'Epoch': 14, 'HR@5': '0.0483', 'NDCG@5': '0.0336', 'HR@10': '0.0687', 'NDCG@10': '0.0401', 'HR@20': '0.0969', 'NDCG@20': '0.0472'}
2025-03-03 19:32:17,611 - Validation score increased.  Saving model ...
2025-03-03 19:33:02,865 - {'epoch': 15, 'rec_loss': '7.9693'}
2025-03-03 19:33:20,509 - {'Epoch': 15, 'HR@5': '0.0487', 'NDCG@5': '0.0338', 'HR@10': '0.0691', 'NDCG@10': '0.0404', 'HR@20': '0.0974', 'NDCG@20': '0.0475'}
2025-03-03 19:33:20,513 - Validation score increased.  Saving model ...
2025-03-03 19:34:12,305 - {'epoch': 16, 'rec_loss': '7.9445'}
2025-03-03 19:34:34,533 - {'Epoch': 16, 'HR@5': '0.0487', 'NDCG@5': '0.0337', 'HR@10': '0.0693', 'NDCG@10': '0.0403', 'HR@20': '0.0988', 'NDCG@20': '0.0478'}
2025-03-03 19:34:34,542 - Validation score increased.  Saving model ...
2025-03-03 19:35:29,083 - {'epoch': 17, 'rec_loss': '7.9227'}
2025-03-03 19:35:45,921 - {'Epoch': 17, 'HR@5': '0.0487', 'NDCG@5': '0.0341', 'HR@10': '0.0694', 'NDCG@10': '0.0407', 'HR@20': '0.0980', 'NDCG@20': '0.0479'}
2025-03-03 19:35:45,926 - Validation score increased.  Saving model ...
2025-03-03 19:36:25,262 - {'epoch': 18, 'rec_loss': '7.8980'}
2025-03-03 19:36:46,201 - {'Epoch': 18, 'HR@5': '0.0491', 'NDCG@5': '0.0344', 'HR@10': '0.0710', 'NDCG@10': '0.0414', 'HR@20': '0.1002', 'NDCG@20': '0.0487'}
2025-03-03 19:36:46,208 - Validation score increased.  Saving model ...
2025-03-03 19:37:46,344 - {'epoch': 19, 'rec_loss': '7.8769'}
2025-03-03 19:38:07,054 - {'Epoch': 19, 'HR@5': '0.0494', 'NDCG@5': '0.0348', 'HR@10': '0.0710', 'NDCG@10': '0.0418', 'HR@20': '0.1002', 'NDCG@20': '0.0491'}
2025-03-03 19:38:07,060 - Validation score increased.  Saving model ...
2025-03-03 19:38:51,306 - {'epoch': 20, 'rec_loss': '7.8629'}
2025-03-03 19:39:09,419 - {'Epoch': 20, 'HR@5': '0.0505', 'NDCG@5': '0.0352', 'HR@10': '0.0723', 'NDCG@10': '0.0422', 'HR@20': '0.1023', 'NDCG@20': '0.0497'}
2025-03-03 19:39:09,422 - Validation score increased.  Saving model ...
2025-03-03 19:40:07,144 - {'epoch': 21, 'rec_loss': '7.8400'}
2025-03-03 19:40:28,743 - {'Epoch': 21, 'HR@5': '0.0489', 'NDCG@5': '0.0343', 'HR@10': '0.0702', 'NDCG@10': '0.0412', 'HR@20': '0.1016', 'NDCG@20': '0.0491'}
2025-03-03 19:40:28,759 - EarlyStopping counter: 1 out of 10
2025-03-03 19:41:18,800 - {'epoch': 22, 'rec_loss': '7.8275'}
2025-03-03 19:41:37,010 - {'Epoch': 22, 'HR@5': '0.0498', 'NDCG@5': '0.0350', 'HR@10': '0.0713', 'NDCG@10': '0.0419', 'HR@20': '0.1026', 'NDCG@20': '0.0498'}
2025-03-03 19:41:37,014 - Validation score increased.  Saving model ...
2025-03-03 19:42:27,391 - {'epoch': 23, 'rec_loss': '7.8106'}
2025-03-03 19:42:48,934 - {'Epoch': 23, 'HR@5': '0.0496', 'NDCG@5': '0.0344', 'HR@10': '0.0720', 'NDCG@10': '0.0416', 'HR@20': '0.1014', 'NDCG@20': '0.0490'}
2025-03-03 19:42:48,942 - EarlyStopping counter: 1 out of 10
2025-03-03 19:43:52,042 - {'epoch': 24, 'rec_loss': '7.7973'}
2025-03-03 19:44:11,008 - {'Epoch': 24, 'HR@5': '0.0503', 'NDCG@5': '0.0352', 'HR@10': '0.0720', 'NDCG@10': '0.0422', 'HR@20': '0.1024', 'NDCG@20': '0.0499'}
2025-03-03 19:44:11,014 - Validation score increased.  Saving model ...
2025-03-03 19:44:51,778 - {'epoch': 25, 'rec_loss': '7.7815'}
2025-03-03 19:45:11,882 - {'Epoch': 25, 'HR@5': '0.0504', 'NDCG@5': '0.0350', 'HR@10': '0.0727', 'NDCG@10': '0.0422', 'HR@20': '0.1038', 'NDCG@20': '0.0500'}
2025-03-03 19:45:11,886 - Validation score increased.  Saving model ...
2025-03-03 19:46:18,373 - {'epoch': 26, 'rec_loss': '7.7701'}
2025-03-03 19:46:40,355 - {'Epoch': 26, 'HR@5': '0.0516', 'NDCG@5': '0.0361', 'HR@10': '0.0731', 'NDCG@10': '0.0430', 'HR@20': '0.1031', 'NDCG@20': '0.0506'}
2025-03-03 19:46:40,358 - Validation score increased.  Saving model ...
2025-03-03 19:47:32,867 - {'epoch': 27, 'rec_loss': '7.7537'}
2025-03-03 19:47:50,697 - {'Epoch': 27, 'HR@5': '0.0517', 'NDCG@5': '0.0358', 'HR@10': '0.0741', 'NDCG@10': '0.0430', 'HR@20': '0.1032', 'NDCG@20': '0.0503'}
2025-03-03 19:47:50,702 - EarlyStopping counter: 1 out of 10
2025-03-03 19:48:46,691 - {'epoch': 28, 'rec_loss': '7.7481'}
2025-03-03 19:49:08,616 - {'Epoch': 28, 'HR@5': '0.0510', 'NDCG@5': '0.0358', 'HR@10': '0.0734', 'NDCG@10': '0.0430', 'HR@20': '0.1025', 'NDCG@20': '0.0504'}
2025-03-03 19:49:08,623 - EarlyStopping counter: 2 out of 10
2025-03-03 19:50:07,315 - {'epoch': 29, 'rec_loss': '7.7375'}
2025-03-03 19:50:26,435 - {'Epoch': 29, 'HR@5': '0.0505', 'NDCG@5': '0.0355', 'HR@10': '0.0733', 'NDCG@10': '0.0428', 'HR@20': '0.1039', 'NDCG@20': '0.0505'}
2025-03-03 19:50:26,437 - EarlyStopping counter: 3 out of 10
2025-03-03 19:51:08,702 - {'epoch': 30, 'rec_loss': '7.7291'}
2025-03-03 19:51:31,076 - {'Epoch': 30, 'HR@5': '0.0508', 'NDCG@5': '0.0355', 'HR@10': '0.0742', 'NDCG@10': '0.0430', 'HR@20': '0.1035', 'NDCG@20': '0.0503'}
2025-03-03 19:51:31,080 - EarlyStopping counter: 4 out of 10
2025-03-03 19:52:32,972 - {'epoch': 31, 'rec_loss': '7.7189'}
2025-03-03 19:52:53,789 - {'Epoch': 31, 'HR@5': '0.0504', 'NDCG@5': '0.0353', 'HR@10': '0.0734', 'NDCG@10': '0.0427', 'HR@20': '0.1048', 'NDCG@20': '0.0507'}
2025-03-03 19:52:53,793 - Validation score increased.  Saving model ...
2025-03-03 19:53:31,592 - {'epoch': 32, 'rec_loss': '7.7066'}
2025-03-03 19:53:50,681 - {'Epoch': 32, 'HR@5': '0.0513', 'NDCG@5': '0.0354', 'HR@10': '0.0743', 'NDCG@10': '0.0428', 'HR@20': '0.1038', 'NDCG@20': '0.0502'}
2025-03-03 19:53:50,686 - EarlyStopping counter: 1 out of 10
2025-03-03 19:54:48,885 - {'epoch': 33, 'rec_loss': '7.7005'}
2025-03-03 19:55:10,645 - {'Epoch': 33, 'HR@5': '0.0520', 'NDCG@5': '0.0362', 'HR@10': '0.0744', 'NDCG@10': '0.0434', 'HR@20': '0.1052', 'NDCG@20': '0.0512'}
2025-03-03 19:55:10,652 - Validation score increased.  Saving model ...
2025-03-03 19:55:59,063 - {'epoch': 34, 'rec_loss': '7.6997'}
2025-03-03 19:56:17,883 - {'Epoch': 34, 'HR@5': '0.0517', 'NDCG@5': '0.0360', 'HR@10': '0.0734', 'NDCG@10': '0.0429', 'HR@20': '0.1047', 'NDCG@20': '0.0508'}
2025-03-03 19:56:17,884 - EarlyStopping counter: 1 out of 10
2025-03-03 19:57:14,021 - {'epoch': 35, 'rec_loss': '7.6877'}
2025-03-03 19:57:38,110 - {'Epoch': 35, 'HR@5': '0.0524', 'NDCG@5': '0.0363', 'HR@10': '0.0745', 'NDCG@10': '0.0434', 'HR@20': '0.1061', 'NDCG@20': '0.0514'}
2025-03-03 19:57:38,114 - Validation score increased.  Saving model ...
2025-03-03 19:58:39,098 - {'epoch': 36, 'rec_loss': '7.6807'}
2025-03-03 19:58:57,846 - {'Epoch': 36, 'HR@5': '0.0516', 'NDCG@5': '0.0362', 'HR@10': '0.0755', 'NDCG@10': '0.0438', 'HR@20': '0.1056', 'NDCG@20': '0.0514'}
2025-03-03 19:58:57,851 - Validation score increased.  Saving model ...
2025-03-03 19:59:46,055 - {'epoch': 37, 'rec_loss': '7.6722'}
2025-03-03 20:00:08,125 - {'Epoch': 37, 'HR@5': '0.0519', 'NDCG@5': '0.0361', 'HR@10': '0.0750', 'NDCG@10': '0.0435', 'HR@20': '0.1057', 'NDCG@20': '0.0512'}
2025-03-03 20:00:08,131 - EarlyStopping counter: 1 out of 10
2025-03-03 20:01:15,182 - {'epoch': 38, 'rec_loss': '7.6618'}
2025-03-03 20:01:35,068 - {'Epoch': 38, 'HR@5': '0.0520', 'NDCG@5': '0.0362', 'HR@10': '0.0748', 'NDCG@10': '0.0436', 'HR@20': '0.1049', 'NDCG@20': '0.0512'}
2025-03-03 20:01:35,073 - EarlyStopping counter: 2 out of 10
2025-03-03 20:02:19,230 - {'epoch': 39, 'rec_loss': '7.6584'}
2025-03-03 20:02:38,294 - {'Epoch': 39, 'HR@5': '0.0525', 'NDCG@5': '0.0365', 'HR@10': '0.0748', 'NDCG@10': '0.0437', 'HR@20': '0.1057', 'NDCG@20': '0.0515'}
2025-03-03 20:02:38,299 - Validation score increased.  Saving model ...
2025-03-03 20:03:45,861 - {'epoch': 40, 'rec_loss': '7.6518'}
2025-03-03 20:04:09,836 - {'Epoch': 40, 'HR@5': '0.0521', 'NDCG@5': '0.0366', 'HR@10': '0.0753', 'NDCG@10': '0.0440', 'HR@20': '0.1049', 'NDCG@20': '0.0515'}
2025-03-03 20:04:09,838 - EarlyStopping counter: 1 out of 10
2025-03-03 20:05:06,186 - {'epoch': 41, 'rec_loss': '7.6410'}
2025-03-03 20:05:25,337 - {'Epoch': 41, 'HR@5': '0.0522', 'NDCG@5': '0.0365', 'HR@10': '0.0751', 'NDCG@10': '0.0438', 'HR@20': '0.1058', 'NDCG@20': '0.0516'}
2025-03-03 20:05:25,338 - Validation score increased.  Saving model ...
2025-03-03 20:06:14,707 - {'epoch': 42, 'rec_loss': '7.6385'}
2025-03-03 20:06:36,489 - {'Epoch': 42, 'HR@5': '0.0525', 'NDCG@5': '0.0365', 'HR@10': '0.0750', 'NDCG@10': '0.0437', 'HR@20': '0.1057', 'NDCG@20': '0.0514'}
2025-03-03 20:06:36,495 - EarlyStopping counter: 1 out of 10
2025-03-03 20:07:40,853 - {'epoch': 43, 'rec_loss': '7.6372'}
2025-03-03 20:07:58,662 - {'Epoch': 43, 'HR@5': '0.0526', 'NDCG@5': '0.0364', 'HR@10': '0.0751', 'NDCG@10': '0.0436', 'HR@20': '0.1057', 'NDCG@20': '0.0513'}
2025-03-03 20:07:58,664 - EarlyStopping counter: 2 out of 10
2025-03-03 20:08:38,255 - {'epoch': 44, 'rec_loss': '7.6320'}
2025-03-03 20:08:58,762 - {'Epoch': 44, 'HR@5': '0.0522', 'NDCG@5': '0.0363', 'HR@10': '0.0766', 'NDCG@10': '0.0442', 'HR@20': '0.1059', 'NDCG@20': '0.0516'}
2025-03-03 20:08:58,764 - Validation score increased.  Saving model ...
2025-03-03 20:09:59,765 - {'epoch': 45, 'rec_loss': '7.6266'}
2025-03-03 20:10:21,234 - {'Epoch': 45, 'HR@5': '0.0523', 'NDCG@5': '0.0365', 'HR@10': '0.0749', 'NDCG@10': '0.0437', 'HR@20': '0.1058', 'NDCG@20': '0.0515'}
2025-03-03 20:10:21,237 - EarlyStopping counter: 1 out of 10
2025-03-03 20:10:59,448 - {'epoch': 46, 'rec_loss': '7.6234'}
2025-03-03 20:11:15,746 - {'Epoch': 46, 'HR@5': '0.0521', 'NDCG@5': '0.0361', 'HR@10': '0.0751', 'NDCG@10': '0.0435', 'HR@20': '0.1059', 'NDCG@20': '0.0513'}
2025-03-03 20:11:15,747 - EarlyStopping counter: 2 out of 10
2025-03-03 20:12:07,851 - {'epoch': 47, 'rec_loss': '7.6223'}
2025-03-03 20:12:29,445 - {'Epoch': 47, 'HR@5': '0.0521', 'NDCG@5': '0.0362', 'HR@10': '0.0763', 'NDCG@10': '0.0440', 'HR@20': '0.1058', 'NDCG@20': '0.0514'}
2025-03-03 20:12:29,447 - EarlyStopping counter: 3 out of 10
2025-03-03 20:13:20,652 - {'epoch': 48, 'rec_loss': '7.6113'}
2025-03-03 20:13:39,382 - {'Epoch': 48, 'HR@5': '0.0520', 'NDCG@5': '0.0362', 'HR@10': '0.0750', 'NDCG@10': '0.0436', 'HR@20': '0.1061', 'NDCG@20': '0.0515'}
2025-03-03 20:13:39,387 - EarlyStopping counter: 4 out of 10
2025-03-03 20:14:23,663 - {'epoch': 49, 'rec_loss': '7.6112'}
2025-03-03 20:14:44,882 - {'Epoch': 49, 'HR@5': '0.0514', 'NDCG@5': '0.0362', 'HR@10': '0.0745', 'NDCG@10': '0.0437', 'HR@20': '0.1064', 'NDCG@20': '0.0517'}
2025-03-03 20:14:44,886 - Validation score increased.  Saving model ...
2025-03-03 20:15:43,261 - {'epoch': 50, 'rec_loss': '7.6108'}
2025-03-03 20:16:02,282 - {'Epoch': 50, 'HR@5': '0.0522', 'NDCG@5': '0.0365', 'HR@10': '0.0764', 'NDCG@10': '0.0443', 'HR@20': '0.1067', 'NDCG@20': '0.0519'}
2025-03-03 20:16:02,285 - Validation score increased.  Saving model ...
2025-03-03 20:16:41,506 - {'epoch': 51, 'rec_loss': '7.6022'}
2025-03-03 20:17:01,866 - {'Epoch': 51, 'HR@5': '0.0522', 'NDCG@5': '0.0364', 'HR@10': '0.0758', 'NDCG@10': '0.0439', 'HR@20': '0.1066', 'NDCG@20': '0.0517'}
2025-03-03 20:17:01,872 - EarlyStopping counter: 1 out of 10
2025-03-03 20:18:01,985 - {'epoch': 52, 'rec_loss': '7.5975'}
2025-03-03 20:18:23,664 - {'Epoch': 52, 'HR@5': '0.0521', 'NDCG@5': '0.0363', 'HR@10': '0.0754', 'NDCG@10': '0.0438', 'HR@20': '0.1055', 'NDCG@20': '0.0514'}
2025-03-03 20:18:23,668 - EarlyStopping counter: 2 out of 10
2025-03-03 20:19:05,150 - {'epoch': 53, 'rec_loss': '7.5973'}
2025-03-03 20:19:21,817 - {'Epoch': 53, 'HR@5': '0.0525', 'NDCG@5': '0.0364', 'HR@10': '0.0762', 'NDCG@10': '0.0440', 'HR@20': '0.1062', 'NDCG@20': '0.0516'}
2025-03-03 20:19:21,821 - EarlyStopping counter: 3 out of 10
2025-03-03 20:20:19,904 - {'epoch': 54, 'rec_loss': '7.5915'}
2025-03-03 20:20:36,458 - {'Epoch': 54, 'HR@5': '0.0530', 'NDCG@5': '0.0367', 'HR@10': '0.0765', 'NDCG@10': '0.0442', 'HR@20': '0.1073', 'NDCG@20': '0.0519'}
2025-03-03 20:20:36,464 - Validation score increased.  Saving model ...
2025-03-03 20:21:20,138 - {'epoch': 55, 'rec_loss': '7.5848'}
2025-03-03 20:21:37,956 - {'Epoch': 55, 'HR@5': '0.0530', 'NDCG@5': '0.0370', 'HR@10': '0.0772', 'NDCG@10': '0.0448', 'HR@20': '0.1066', 'NDCG@20': '0.0522'}
2025-03-03 20:21:37,959 - Validation score increased.  Saving model ...
2025-03-03 20:22:22,072 - {'epoch': 56, 'rec_loss': '7.5834'}
2025-03-03 20:22:40,716 - {'Epoch': 56, 'HR@5': '0.0525', 'NDCG@5': '0.0364', 'HR@10': '0.0763', 'NDCG@10': '0.0440', 'HR@20': '0.1074', 'NDCG@20': '0.0519'}
2025-03-03 20:22:40,724 - EarlyStopping counter: 1 out of 10
2025-03-03 20:23:26,533 - {'epoch': 57, 'rec_loss': '7.5774'}
2025-03-03 20:23:45,513 - {'Epoch': 57, 'HR@5': '0.0517', 'NDCG@5': '0.0360', 'HR@10': '0.0753', 'NDCG@10': '0.0436', 'HR@20': '0.1067', 'NDCG@20': '0.0515'}
2025-03-03 20:23:45,517 - EarlyStopping counter: 2 out of 10
2025-03-03 20:24:30,402 - {'epoch': 58, 'rec_loss': '7.5780'}
2025-03-03 20:24:49,988 - {'Epoch': 58, 'HR@5': '0.0529', 'NDCG@5': '0.0368', 'HR@10': '0.0766', 'NDCG@10': '0.0445', 'HR@20': '0.1055', 'NDCG@20': '0.0518'}
2025-03-03 20:24:49,994 - EarlyStopping counter: 3 out of 10
2025-03-03 20:25:31,682 - {'epoch': 59, 'rec_loss': '7.5768'}
2025-03-03 20:25:48,671 - {'Epoch': 59, 'HR@5': '0.0519', 'NDCG@5': '0.0365', 'HR@10': '0.0760', 'NDCG@10': '0.0442', 'HR@20': '0.1063', 'NDCG@20': '0.0518'}
2025-03-03 20:25:48,672 - EarlyStopping counter: 4 out of 10
2025-03-03 20:26:30,327 - {'epoch': 60, 'rec_loss': '7.5672'}
2025-03-03 20:26:46,885 - {'Epoch': 60, 'HR@5': '0.0527', 'NDCG@5': '0.0367', 'HR@10': '0.0763', 'NDCG@10': '0.0443', 'HR@20': '0.1060', 'NDCG@20': '0.0517'}
2025-03-03 20:26:46,890 - EarlyStopping counter: 5 out of 10
2025-03-03 20:27:27,520 - {'epoch': 61, 'rec_loss': '7.5641'}
2025-03-03 20:27:43,982 - {'Epoch': 61, 'HR@5': '0.0518', 'NDCG@5': '0.0363', 'HR@10': '0.0760', 'NDCG@10': '0.0441', 'HR@20': '0.1074', 'NDCG@20': '0.0520'}
2025-03-03 20:27:43,983 - EarlyStopping counter: 6 out of 10
2025-03-03 20:28:25,864 - {'epoch': 62, 'rec_loss': '7.5643'}
2025-03-03 20:28:44,108 - {'Epoch': 62, 'HR@5': '0.0523', 'NDCG@5': '0.0363', 'HR@10': '0.0766', 'NDCG@10': '0.0442', 'HR@20': '0.1077', 'NDCG@20': '0.0520'}
2025-03-03 20:28:44,109 - EarlyStopping counter: 7 out of 10
2025-03-03 20:29:25,539 - {'epoch': 63, 'rec_loss': '7.5662'}
2025-03-03 20:29:42,911 - {'Epoch': 63, 'HR@5': '0.0526', 'NDCG@5': '0.0368', 'HR@10': '0.0764', 'NDCG@10': '0.0444', 'HR@20': '0.1071', 'NDCG@20': '0.0521'}
2025-03-03 20:29:42,912 - EarlyStopping counter: 8 out of 10
2025-03-03 20:30:26,645 - {'epoch': 64, 'rec_loss': '7.5570'}
2025-03-03 20:30:43,975 - {'Epoch': 64, 'HR@5': '0.0534', 'NDCG@5': '0.0367', 'HR@10': '0.0764', 'NDCG@10': '0.0442', 'HR@20': '0.1062', 'NDCG@20': '0.0517'}
2025-03-03 20:30:43,978 - EarlyStopping counter: 9 out of 10
2025-03-03 20:31:27,606 - {'epoch': 65, 'rec_loss': '7.5535'}
2025-03-03 20:31:45,224 - {'Epoch': 65, 'HR@5': '0.0534', 'NDCG@5': '0.0371', 'HR@10': '0.0764', 'NDCG@10': '0.0445', 'HR@20': '0.1076', 'NDCG@20': '0.0523'}
2025-03-03 20:31:45,228 - Validation score increased.  Saving model ...
2025-03-03 20:32:28,337 - {'epoch': 66, 'rec_loss': '7.5516'}
2025-03-03 20:32:45,126 - {'Epoch': 66, 'HR@5': '0.0523', 'NDCG@5': '0.0364', 'HR@10': '0.0747', 'NDCG@10': '0.0436', 'HR@20': '0.1052', 'NDCG@20': '0.0513'}
2025-03-03 20:32:45,132 - EarlyStopping counter: 1 out of 10
2025-03-03 20:33:26,963 - {'epoch': 67, 'rec_loss': '7.5508'}
2025-03-03 20:33:45,292 - {'Epoch': 67, 'HR@5': '0.0538', 'NDCG@5': '0.0374', 'HR@10': '0.0760', 'NDCG@10': '0.0444', 'HR@20': '0.1069', 'NDCG@20': '0.0522'}
2025-03-03 20:33:45,294 - EarlyStopping counter: 2 out of 10
2025-03-03 20:34:32,539 - {'epoch': 68, 'rec_loss': '7.5456'}
2025-03-03 20:34:51,576 - {'Epoch': 68, 'HR@5': '0.0537', 'NDCG@5': '0.0374', 'HR@10': '0.0758', 'NDCG@10': '0.0445', 'HR@20': '0.1069', 'NDCG@20': '0.0523'}
2025-03-03 20:34:51,578 - EarlyStopping counter: 3 out of 10
2025-03-03 20:35:37,268 - {'epoch': 69, 'rec_loss': '7.5435'}
2025-03-03 20:35:56,461 - {'Epoch': 69, 'HR@5': '0.0529', 'NDCG@5': '0.0369', 'HR@10': '0.0754', 'NDCG@10': '0.0441', 'HR@20': '0.1067', 'NDCG@20': '0.0520'}
2025-03-03 20:35:56,463 - EarlyStopping counter: 4 out of 10
2025-03-03 20:36:45,731 - {'epoch': 70, 'rec_loss': '7.5376'}
2025-03-03 20:37:07,217 - {'Epoch': 70, 'HR@5': '0.0525', 'NDCG@5': '0.0367', 'HR@10': '0.0760', 'NDCG@10': '0.0443', 'HR@20': '0.1067', 'NDCG@20': '0.0520'}
2025-03-03 20:37:07,228 - EarlyStopping counter: 5 out of 10
2025-03-03 20:38:07,654 - {'epoch': 71, 'rec_loss': '7.5408'}
2025-03-03 20:38:28,731 - {'Epoch': 71, 'HR@5': '0.0531', 'NDCG@5': '0.0371', 'HR@10': '0.0764', 'NDCG@10': '0.0446', 'HR@20': '0.1069', 'NDCG@20': '0.0523'}
2025-03-03 20:38:28,740 - EarlyStopping counter: 6 out of 10
2025-03-03 20:39:11,575 - {'epoch': 72, 'rec_loss': '7.5401'}
2025-03-03 20:39:30,866 - {'Epoch': 72, 'HR@5': '0.0540', 'NDCG@5': '0.0373', 'HR@10': '0.0764', 'NDCG@10': '0.0445', 'HR@20': '0.1074', 'NDCG@20': '0.0523'}
2025-03-03 20:39:30,874 - EarlyStopping counter: 7 out of 10
2025-03-03 20:40:26,299 - {'epoch': 73, 'rec_loss': '7.5328'}
2025-03-03 20:40:47,404 - {'Epoch': 73, 'HR@5': '0.0526', 'NDCG@5': '0.0365', 'HR@10': '0.0763', 'NDCG@10': '0.0441', 'HR@20': '0.1072', 'NDCG@20': '0.0519'}
2025-03-03 20:40:47,411 - EarlyStopping counter: 8 out of 10
2025-03-03 20:41:42,822 - {'epoch': 74, 'rec_loss': '7.5351'}
2025-03-03 20:41:59,329 - {'Epoch': 74, 'HR@5': '0.0540', 'NDCG@5': '0.0374', 'HR@10': '0.0771', 'NDCG@10': '0.0449', 'HR@20': '0.1071', 'NDCG@20': '0.0524'}
2025-03-03 20:41:59,333 - Validation score increased.  Saving model ...
2025-03-03 20:42:41,022 - {'epoch': 75, 'rec_loss': '7.5243'}
2025-03-03 20:42:58,022 - {'Epoch': 75, 'HR@5': '0.0545', 'NDCG@5': '0.0377', 'HR@10': '0.0767', 'NDCG@10': '0.0448', 'HR@20': '0.1063', 'NDCG@20': '0.0523'}
2025-03-03 20:42:58,027 - EarlyStopping counter: 1 out of 10
2025-03-03 20:43:39,587 - {'epoch': 76, 'rec_loss': '7.5242'}
2025-03-03 20:43:56,435 - {'Epoch': 76, 'HR@5': '0.0537', 'NDCG@5': '0.0373', 'HR@10': '0.0769', 'NDCG@10': '0.0448', 'HR@20': '0.1089', 'NDCG@20': '0.0529'}
2025-03-03 20:43:56,436 - Validation score increased.  Saving model ...
2025-03-03 20:44:36,567 - {'epoch': 77, 'rec_loss': '7.5290'}
2025-03-03 20:44:53,266 - {'Epoch': 77, 'HR@5': '0.0531', 'NDCG@5': '0.0369', 'HR@10': '0.0758', 'NDCG@10': '0.0442', 'HR@20': '0.1073', 'NDCG@20': '0.0522'}
2025-03-03 20:44:53,272 - EarlyStopping counter: 1 out of 10
2025-03-03 20:45:33,928 - {'epoch': 78, 'rec_loss': '7.5254'}
2025-03-03 20:45:53,792 - {'Epoch': 78, 'HR@5': '0.0528', 'NDCG@5': '0.0369', 'HR@10': '0.0764', 'NDCG@10': '0.0445', 'HR@20': '0.1068', 'NDCG@20': '0.0522'}
2025-03-03 20:45:53,797 - EarlyStopping counter: 2 out of 10
2025-03-03 20:46:35,995 - {'epoch': 79, 'rec_loss': '7.5143'}
2025-03-03 20:46:53,465 - {'Epoch': 79, 'HR@5': '0.0524', 'NDCG@5': '0.0367', 'HR@10': '0.0767', 'NDCG@10': '0.0445', 'HR@20': '0.1073', 'NDCG@20': '0.0522'}
2025-03-03 20:46:53,468 - EarlyStopping counter: 3 out of 10
2025-03-03 20:47:33,072 - {'epoch': 80, 'rec_loss': '7.5182'}
2025-03-03 20:47:52,388 - {'Epoch': 80, 'HR@5': '0.0530', 'NDCG@5': '0.0371', 'HR@10': '0.0762', 'NDCG@10': '0.0445', 'HR@20': '0.1077', 'NDCG@20': '0.0524'}
2025-03-03 20:47:52,392 - EarlyStopping counter: 4 out of 10
2025-03-03 20:48:47,007 - {'epoch': 81, 'rec_loss': '7.5158'}
2025-03-03 20:49:07,699 - {'Epoch': 81, 'HR@5': '0.0538', 'NDCG@5': '0.0380', 'HR@10': '0.0758', 'NDCG@10': '0.0451', 'HR@20': '0.1075', 'NDCG@20': '0.0530'}
2025-03-03 20:49:07,700 - Validation score increased.  Saving model ...
2025-03-03 20:50:01,995 - {'epoch': 82, 'rec_loss': '7.5178'}
2025-03-03 20:50:22,380 - {'Epoch': 82, 'HR@5': '0.0538', 'NDCG@5': '0.0380', 'HR@10': '0.0764', 'NDCG@10': '0.0452', 'HR@20': '0.1074', 'NDCG@20': '0.0530'}
2025-03-03 20:50:22,384 - Validation score increased.  Saving model ...
2025-03-03 20:51:04,742 - {'epoch': 83, 'rec_loss': '7.5095'}
2025-03-03 20:51:25,733 - {'Epoch': 83, 'HR@5': '0.0529', 'NDCG@5': '0.0370', 'HR@10': '0.0757', 'NDCG@10': '0.0444', 'HR@20': '0.1067', 'NDCG@20': '0.0522'}
2025-03-03 20:51:25,735 - EarlyStopping counter: 1 out of 10
2025-03-03 20:52:23,095 - {'epoch': 84, 'rec_loss': '7.5069'}
2025-03-03 20:52:42,831 - {'Epoch': 84, 'HR@5': '0.0524', 'NDCG@5': '0.0368', 'HR@10': '0.0762', 'NDCG@10': '0.0445', 'HR@20': '0.1062', 'NDCG@20': '0.0520'}
2025-03-03 20:52:42,833 - EarlyStopping counter: 2 out of 10
2025-03-03 20:53:22,131 - {'epoch': 85, 'rec_loss': '7.5135'}
2025-03-03 20:53:42,236 - {'Epoch': 85, 'HR@5': '0.0541', 'NDCG@5': '0.0376', 'HR@10': '0.0768', 'NDCG@10': '0.0449', 'HR@20': '0.1061', 'NDCG@20': '0.0523'}
2025-03-03 20:53:42,238 - EarlyStopping counter: 3 out of 10
2025-03-03 20:54:38,647 - {'epoch': 86, 'rec_loss': '7.4989'}
2025-03-03 20:54:59,652 - {'Epoch': 86, 'HR@5': '0.0539', 'NDCG@5': '0.0374', 'HR@10': '0.0759', 'NDCG@10': '0.0445', 'HR@20': '0.1057', 'NDCG@20': '0.0521'}
2025-03-03 20:54:59,656 - EarlyStopping counter: 4 out of 10
2025-03-03 20:55:48,935 - {'epoch': 87, 'rec_loss': '7.5048'}
2025-03-03 20:56:08,018 - {'Epoch': 87, 'HR@5': '0.0539', 'NDCG@5': '0.0376', 'HR@10': '0.0765', 'NDCG@10': '0.0449', 'HR@20': '0.1070', 'NDCG@20': '0.0525'}
2025-03-03 20:56:08,021 - EarlyStopping counter: 5 out of 10
2025-03-03 20:57:01,204 - {'epoch': 88, 'rec_loss': '7.5006'}
2025-03-03 20:57:22,086 - {'Epoch': 88, 'HR@5': '0.0532', 'NDCG@5': '0.0372', 'HR@10': '0.0758', 'NDCG@10': '0.0446', 'HR@20': '0.1066', 'NDCG@20': '0.0523'}
2025-03-03 20:57:22,091 - EarlyStopping counter: 6 out of 10
2025-03-03 20:58:14,111 - {'epoch': 89, 'rec_loss': '7.5024'}
2025-03-03 20:58:31,627 - {'Epoch': 89, 'HR@5': '0.0533', 'NDCG@5': '0.0366', 'HR@10': '0.0761', 'NDCG@10': '0.0440', 'HR@20': '0.1051', 'NDCG@20': '0.0513'}
2025-03-03 20:58:31,632 - EarlyStopping counter: 7 out of 10
2025-03-03 20:59:13,169 - {'epoch': 90, 'rec_loss': '7.4932'}
2025-03-03 20:59:34,990 - {'Epoch': 90, 'HR@5': '0.0530', 'NDCG@5': '0.0366', 'HR@10': '0.0753', 'NDCG@10': '0.0437', 'HR@20': '0.1055', 'NDCG@20': '0.0514'}
2025-03-03 20:59:34,996 - EarlyStopping counter: 8 out of 10
2025-03-03 21:00:32,636 - {'epoch': 91, 'rec_loss': '7.5002'}
2025-03-03 21:00:54,081 - {'Epoch': 91, 'HR@5': '0.0533', 'NDCG@5': '0.0370', 'HR@10': '0.0764', 'NDCG@10': '0.0445', 'HR@20': '0.1071', 'NDCG@20': '0.0522'}
2025-03-03 21:00:54,083 - EarlyStopping counter: 9 out of 10
2025-03-03 21:01:32,951 - {'epoch': 92, 'rec_loss': '7.4925'}
2025-03-03 21:01:52,499 - {'Epoch': 92, 'HR@5': '0.0533', 'NDCG@5': '0.0373', 'HR@10': '0.0754', 'NDCG@10': '0.0444', 'HR@20': '0.1074', 'NDCG@20': '0.0524'}
2025-03-03 21:01:52,503 - EarlyStopping counter: 10 out of 10
2025-03-03 21:01:52,504 - Early stopping
2025-03-03 21:01:52,504 - ---------------Test Score---------------
2025-03-03 21:02:13,551 - {'Epoch': 0, 'HR@5': '0.0435', 'NDCG@5': '0.0302', 'HR@10': '0.0640', 'NDCG@10': '0.0368', 'HR@20': '0.0903', 'NDCG@20': '0.0434'}
2025-03-03 21:02:13,558 - Scale_Sports
2025-03-03 21:02:13,558 - {'Epoch': 0, 'HR@5': '0.0435', 'NDCG@5': '0.0302', 'HR@10': '0.0640', 'NDCG@10': '0.0368', 'HR@20': '0.0903', 'NDCG@20': '0.0434'}
2025-03-03 21:07:57,391 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 10], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-03 21:08:00,348 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-03 21:08:00,355 - Total Parameters: 1328854
2025-03-03 21:08:56,025 - {'epoch': 0, 'rec_loss': '9.4015'}
2025-03-03 21:09:17,329 - {'Epoch': 0, 'HR@5': '0.0081', 'NDCG@5': '0.0054', 'HR@10': '0.0129', 'NDCG@10': '0.0069', 'HR@20': '0.0224', 'NDCG@20': '0.0093'}
2025-03-03 21:09:17,331 - Validation score increased.  Saving model ...
2025-03-03 21:10:09,298 - {'epoch': 1, 'rec_loss': '9.2057'}
2025-03-03 21:10:28,308 - {'Epoch': 1, 'HR@5': '0.0138', 'NDCG@5': '0.0087', 'HR@10': '0.0243', 'NDCG@10': '0.0121', 'HR@20': '0.0385', 'NDCG@20': '0.0157'}
2025-03-03 21:10:28,309 - Validation score increased.  Saving model ...
2025-03-03 21:11:15,663 - {'epoch': 2, 'rec_loss': '8.9454'}
2025-03-03 21:11:36,050 - {'Epoch': 2, 'HR@5': '0.0189', 'NDCG@5': '0.0119', 'HR@10': '0.0295', 'NDCG@10': '0.0153', 'HR@20': '0.0488', 'NDCG@20': '0.0201'}
2025-03-03 21:11:36,052 - Validation score increased.  Saving model ...
2025-03-03 21:12:35,296 - {'epoch': 3, 'rec_loss': '8.7629'}
2025-03-03 21:12:51,547 - {'Epoch': 3, 'HR@5': '0.0232', 'NDCG@5': '0.0153', 'HR@10': '0.0388', 'NDCG@10': '0.0203', 'HR@20': '0.0604', 'NDCG@20': '0.0257'}
2025-03-03 21:12:51,548 - Validation score increased.  Saving model ...
2025-03-03 21:13:32,373 - {'epoch': 4, 'rec_loss': '8.6163'}
2025-03-03 21:13:50,308 - {'Epoch': 4, 'HR@5': '0.0303', 'NDCG@5': '0.0198', 'HR@10': '0.0462', 'NDCG@10': '0.0249', 'HR@20': '0.0694', 'NDCG@20': '0.0307'}
2025-03-03 21:13:50,310 - Validation score increased.  Saving model ...
2025-03-03 21:14:49,123 - {'epoch': 5, 'rec_loss': '8.4921'}
2025-03-03 21:15:09,494 - {'Epoch': 5, 'HR@5': '0.0342', 'NDCG@5': '0.0226', 'HR@10': '0.0525', 'NDCG@10': '0.0285', 'HR@20': '0.0765', 'NDCG@20': '0.0345'}
2025-03-03 21:15:09,495 - Validation score increased.  Saving model ...
2025-03-03 21:15:55,294 - {'epoch': 6, 'rec_loss': '8.3933'}
2025-03-03 21:16:11,708 - {'Epoch': 6, 'HR@5': '0.0381', 'NDCG@5': '0.0256', 'HR@10': '0.0556', 'NDCG@10': '0.0312', 'HR@20': '0.0811', 'NDCG@20': '0.0376'}
2025-03-03 21:16:11,710 - Validation score increased.  Saving model ...
2025-03-03 21:17:06,226 - {'epoch': 7, 'rec_loss': '8.3125'}
2025-03-03 21:17:26,503 - {'Epoch': 7, 'HR@5': '0.0412', 'NDCG@5': '0.0282', 'HR@10': '0.0591', 'NDCG@10': '0.0340', 'HR@20': '0.0865', 'NDCG@20': '0.0409'}
2025-03-03 21:17:26,507 - Validation score increased.  Saving model ...
2025-03-03 21:18:19,754 - {'epoch': 8, 'rec_loss': '8.2427'}
2025-03-03 21:18:36,541 - {'Epoch': 8, 'HR@5': '0.0424', 'NDCG@5': '0.0290', 'HR@10': '0.0602', 'NDCG@10': '0.0347', 'HR@20': '0.0885', 'NDCG@20': '0.0418'}
2025-03-03 21:18:36,550 - Validation score increased.  Saving model ...
2025-03-03 21:19:18,020 - {'epoch': 9, 'rec_loss': '8.1861'}
2025-03-03 21:19:38,539 - {'Epoch': 9, 'HR@5': '0.0439', 'NDCG@5': '0.0303', 'HR@10': '0.0638', 'NDCG@10': '0.0367', 'HR@20': '0.0907', 'NDCG@20': '0.0435'}
2025-03-03 21:19:38,545 - Validation score increased.  Saving model ...
2025-03-03 21:20:37,628 - {'epoch': 10, 'rec_loss': '8.1347'}
2025-03-03 21:20:58,125 - {'Epoch': 10, 'HR@5': '0.0468', 'NDCG@5': '0.0322', 'HR@10': '0.0671', 'NDCG@10': '0.0387', 'HR@20': '0.0937', 'NDCG@20': '0.0453'}
2025-03-03 21:20:58,126 - Validation score increased.  Saving model ...
2025-03-03 21:21:36,858 - {'epoch': 11, 'rec_loss': '8.0934'}
2025-03-03 21:21:54,590 - {'Epoch': 11, 'HR@5': '0.0472', 'NDCG@5': '0.0325', 'HR@10': '0.0674', 'NDCG@10': '0.0389', 'HR@20': '0.0956', 'NDCG@20': '0.0460'}
2025-03-03 21:21:54,591 - Validation score increased.  Saving model ...
2025-03-03 21:22:53,213 - {'epoch': 12, 'rec_loss': '8.0522'}
2025-03-03 21:23:14,126 - {'Epoch': 12, 'HR@5': '0.0483', 'NDCG@5': '0.0333', 'HR@10': '0.0682', 'NDCG@10': '0.0397', 'HR@20': '0.0958', 'NDCG@20': '0.0466'}
2025-03-03 21:23:14,130 - Validation score increased.  Saving model ...
2025-03-03 21:24:02,998 - {'epoch': 13, 'rec_loss': '8.0177'}
2025-03-03 21:24:20,333 - {'Epoch': 13, 'HR@5': '0.0492', 'NDCG@5': '0.0340', 'HR@10': '0.0701', 'NDCG@10': '0.0407', 'HR@20': '0.0980', 'NDCG@20': '0.0477'}
2025-03-03 21:24:20,336 - Validation score increased.  Saving model ...
2025-03-03 21:25:12,862 - {'epoch': 14, 'rec_loss': '7.9854'}
2025-03-03 21:25:33,309 - {'Epoch': 14, 'HR@5': '0.0485', 'NDCG@5': '0.0338', 'HR@10': '0.0692', 'NDCG@10': '0.0405', 'HR@20': '0.0978', 'NDCG@20': '0.0477'}
2025-03-03 21:25:33,316 - EarlyStopping counter: 1 out of 10
2025-03-03 21:26:31,416 - {'epoch': 15, 'rec_loss': '7.9601'}
2025-03-03 21:26:50,494 - {'Epoch': 15, 'HR@5': '0.0489', 'NDCG@5': '0.0340', 'HR@10': '0.0696', 'NDCG@10': '0.0407', 'HR@20': '0.0979', 'NDCG@20': '0.0478'}
2025-03-03 21:26:50,498 - Validation score increased.  Saving model ...
2025-03-03 21:27:33,159 - {'epoch': 16, 'rec_loss': '7.9428'}
2025-03-03 21:27:53,428 - {'Epoch': 16, 'HR@5': '0.0499', 'NDCG@5': '0.0347', 'HR@10': '0.0710', 'NDCG@10': '0.0415', 'HR@20': '0.0995', 'NDCG@20': '0.0486'}
2025-03-03 21:27:53,433 - Validation score increased.  Saving model ...
2025-03-03 21:28:52,511 - {'epoch': 17, 'rec_loss': '7.9138'}
2025-03-03 21:29:12,341 - {'Epoch': 17, 'HR@5': '0.0500', 'NDCG@5': '0.0348', 'HR@10': '0.0711', 'NDCG@10': '0.0416', 'HR@20': '0.0994', 'NDCG@20': '0.0488'}
2025-03-03 21:29:12,344 - Validation score increased.  Saving model ...
2025-03-03 21:29:50,731 - {'epoch': 18, 'rec_loss': '7.9000'}
2025-03-03 21:30:06,735 - {'Epoch': 18, 'HR@5': '0.0508', 'NDCG@5': '0.0354', 'HR@10': '0.0722', 'NDCG@10': '0.0423', 'HR@20': '0.1006', 'NDCG@20': '0.0494'}
2025-03-03 21:30:06,742 - Validation score increased.  Saving model ...
2025-03-03 21:31:03,091 - {'epoch': 19, 'rec_loss': '7.8788'}
2025-03-03 21:31:24,231 - {'Epoch': 19, 'HR@5': '0.0508', 'NDCG@5': '0.0354', 'HR@10': '0.0723', 'NDCG@10': '0.0423', 'HR@20': '0.1012', 'NDCG@20': '0.0496'}
2025-03-03 21:31:24,233 - Validation score increased.  Saving model ...
2025-03-03 21:32:13,498 - {'epoch': 20, 'rec_loss': '7.8605'}
2025-03-03 21:32:32,733 - {'Epoch': 20, 'HR@5': '0.0506', 'NDCG@5': '0.0356', 'HR@10': '0.0719', 'NDCG@10': '0.0425', 'HR@20': '0.1015', 'NDCG@20': '0.0499'}
2025-03-03 21:32:32,737 - Validation score increased.  Saving model ...
2025-03-03 21:33:21,504 - {'epoch': 21, 'rec_loss': '7.8506'}
2025-03-03 21:33:42,539 - {'Epoch': 21, 'HR@5': '0.0513', 'NDCG@5': '0.0355', 'HR@10': '0.0722', 'NDCG@10': '0.0422', 'HR@20': '0.1015', 'NDCG@20': '0.0496'}
2025-03-03 21:33:42,542 - EarlyStopping counter: 1 out of 10
2025-03-03 21:34:40,664 - {'epoch': 22, 'rec_loss': '7.8347'}
2025-03-03 21:34:59,525 - {'Epoch': 22, 'HR@5': '0.0515', 'NDCG@5': '0.0358', 'HR@10': '0.0724', 'NDCG@10': '0.0425', 'HR@20': '0.1024', 'NDCG@20': '0.0501'}
2025-03-03 21:34:59,526 - Validation score increased.  Saving model ...
2025-03-03 21:35:45,960 - {'epoch': 23, 'rec_loss': '7.8172'}
2025-03-03 21:36:06,505 - {'Epoch': 23, 'HR@5': '0.0516', 'NDCG@5': '0.0359', 'HR@10': '0.0737', 'NDCG@10': '0.0430', 'HR@20': '0.1019', 'NDCG@20': '0.0501'}
2025-03-03 21:36:06,510 - Validation score increased.  Saving model ...
2025-03-03 21:37:05,898 - {'epoch': 24, 'rec_loss': '7.8075'}
2025-03-03 21:37:25,623 - {'Epoch': 24, 'HR@5': '0.0504', 'NDCG@5': '0.0354', 'HR@10': '0.0736', 'NDCG@10': '0.0428', 'HR@20': '0.1018', 'NDCG@20': '0.0499'}
2025-03-03 21:37:25,627 - EarlyStopping counter: 1 out of 10
2025-03-03 21:38:06,949 - {'epoch': 25, 'rec_loss': '7.7884'}
2025-03-03 21:38:26,432 - {'Epoch': 25, 'HR@5': '0.0519', 'NDCG@5': '0.0358', 'HR@10': '0.0735', 'NDCG@10': '0.0427', 'HR@20': '0.1022', 'NDCG@20': '0.0499'}
2025-03-03 21:38:26,440 - EarlyStopping counter: 2 out of 10
2025-03-03 21:39:25,950 - {'epoch': 26, 'rec_loss': '7.7798'}
2025-03-03 21:39:46,754 - {'Epoch': 26, 'HR@5': '0.0517', 'NDCG@5': '0.0361', 'HR@10': '0.0733', 'NDCG@10': '0.0431', 'HR@20': '0.1019', 'NDCG@20': '0.0503'}
2025-03-03 21:39:46,755 - Validation score increased.  Saving model ...
2025-03-03 21:40:33,237 - {'epoch': 27, 'rec_loss': '7.7659'}
2025-03-03 21:40:52,218 - {'Epoch': 27, 'HR@5': '0.0521', 'NDCG@5': '0.0367', 'HR@10': '0.0741', 'NDCG@10': '0.0437', 'HR@20': '0.1038', 'NDCG@20': '0.0512'}
2025-03-03 21:40:52,220 - Validation score increased.  Saving model ...
2025-03-03 21:41:47,857 - {'epoch': 28, 'rec_loss': '7.7565'}
2025-03-03 21:42:08,910 - {'Epoch': 28, 'HR@5': '0.0512', 'NDCG@5': '0.0360', 'HR@10': '0.0740', 'NDCG@10': '0.0433', 'HR@20': '0.1036', 'NDCG@20': '0.0508'}
2025-03-03 21:42:08,912 - EarlyStopping counter: 1 out of 10
2025-03-03 21:43:04,425 - {'epoch': 29, 'rec_loss': '7.7437'}
2025-03-03 21:43:21,266 - {'Epoch': 29, 'HR@5': '0.0509', 'NDCG@5': '0.0358', 'HR@10': '0.0743', 'NDCG@10': '0.0433', 'HR@20': '0.1037', 'NDCG@20': '0.0507'}
2025-03-03 21:43:21,270 - EarlyStopping counter: 2 out of 10
2025-03-03 21:44:07,890 - {'epoch': 30, 'rec_loss': '7.7399'}
2025-03-03 21:44:29,311 - {'Epoch': 30, 'HR@5': '0.0524', 'NDCG@5': '0.0366', 'HR@10': '0.0745', 'NDCG@10': '0.0436', 'HR@20': '0.1043', 'NDCG@20': '0.0511'}
2025-03-03 21:44:29,313 - EarlyStopping counter: 3 out of 10
2025-03-03 21:45:28,823 - {'epoch': 31, 'rec_loss': '7.7280'}
2025-03-03 21:45:46,614 - {'Epoch': 31, 'HR@5': '0.0529', 'NDCG@5': '0.0368', 'HR@10': '0.0737', 'NDCG@10': '0.0435', 'HR@20': '0.1023', 'NDCG@20': '0.0507'}
2025-03-03 21:45:46,615 - EarlyStopping counter: 4 out of 10
2025-03-03 21:46:25,201 - {'epoch': 32, 'rec_loss': '7.7184'}
2025-03-03 21:46:45,465 - {'Epoch': 32, 'HR@5': '0.0525', 'NDCG@5': '0.0368', 'HR@10': '0.0748', 'NDCG@10': '0.0440', 'HR@20': '0.1032', 'NDCG@20': '0.0511'}
2025-03-03 21:46:45,467 - EarlyStopping counter: 5 out of 10
2025-03-03 21:47:44,951 - {'epoch': 33, 'rec_loss': '7.7159'}
2025-03-03 21:48:06,077 - {'Epoch': 33, 'HR@5': '0.0521', 'NDCG@5': '0.0367', 'HR@10': '0.0744', 'NDCG@10': '0.0439', 'HR@20': '0.1025', 'NDCG@20': '0.0510'}
2025-03-03 21:48:06,078 - EarlyStopping counter: 6 out of 10
2025-03-03 21:48:48,596 - {'epoch': 34, 'rec_loss': '7.6988'}
2025-03-03 21:49:08,216 - {'Epoch': 34, 'HR@5': '0.0525', 'NDCG@5': '0.0366', 'HR@10': '0.0752', 'NDCG@10': '0.0439', 'HR@20': '0.1037', 'NDCG@20': '0.0511'}
2025-03-03 21:49:08,218 - EarlyStopping counter: 7 out of 10
2025-03-03 21:50:01,934 - {'epoch': 35, 'rec_loss': '7.6920'}
2025-03-03 21:50:22,901 - {'Epoch': 35, 'HR@5': '0.0521', 'NDCG@5': '0.0364', 'HR@10': '0.0740', 'NDCG@10': '0.0434', 'HR@20': '0.1041', 'NDCG@20': '0.0510'}
2025-03-03 21:50:22,909 - EarlyStopping counter: 8 out of 10
2025-03-03 21:51:14,500 - {'epoch': 36, 'rec_loss': '7.6849'}
2025-03-03 21:51:33,477 - {'Epoch': 36, 'HR@5': '0.0518', 'NDCG@5': '0.0360', 'HR@10': '0.0751', 'NDCG@10': '0.0435', 'HR@20': '0.1034', 'NDCG@20': '0.0506'}
2025-03-03 21:51:33,479 - EarlyStopping counter: 9 out of 10
2025-03-03 21:52:18,369 - {'epoch': 37, 'rec_loss': '7.6792'}
2025-03-03 21:52:39,608 - {'Epoch': 37, 'HR@5': '0.0513', 'NDCG@5': '0.0360', 'HR@10': '0.0735', 'NDCG@10': '0.0431', 'HR@20': '0.1037', 'NDCG@20': '0.0508'}
2025-03-03 21:52:39,616 - EarlyStopping counter: 10 out of 10
2025-03-03 21:52:39,616 - Early stopping
2025-03-03 21:52:39,617 - ---------------Test Score---------------
2025-03-03 21:53:00,287 - {'Epoch': 0, 'HR@5': '0.0420', 'NDCG@5': '0.0296', 'HR@10': '0.0606', 'NDCG@10': '0.0356', 'HR@20': '0.0853', 'NDCG@20': '0.0418'}
2025-03-03 21:53:00,290 - Scale_Sports
2025-03-03 21:53:00,290 - {'Epoch': 0, 'HR@5': '0.0420', 'NDCG@5': '0.0296', 'HR@10': '0.0606', 'NDCG@10': '0.0356', 'HR@20': '0.0853', 'NDCG@20': '0.0418'}
2025-03-03 22:17:16,992 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 5], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-03 22:17:19,945 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-03 22:17:19,952 - Total Parameters: 1328529
2025-03-03 22:18:16,069 - {'epoch': 0, 'rec_loss': '9.4033'}
2025-03-03 22:18:37,105 - {'Epoch': 0, 'HR@5': '0.0084', 'NDCG@5': '0.0054', 'HR@10': '0.0127', 'NDCG@10': '0.0067', 'HR@20': '0.0215', 'NDCG@20': '0.0090'}
2025-03-03 22:18:37,109 - Validation score increased.  Saving model ...
2025-03-03 22:19:26,275 - {'epoch': 1, 'rec_loss': '9.2001'}
2025-03-03 22:19:43,997 - {'Epoch': 1, 'HR@5': '0.0156', 'NDCG@5': '0.0099', 'HR@10': '0.0259', 'NDCG@10': '0.0133', 'HR@20': '0.0399', 'NDCG@20': '0.0168'}
2025-03-03 22:19:44,001 - Validation score increased.  Saving model ...
2025-03-03 22:20:28,666 - {'epoch': 2, 'rec_loss': '8.9281'}
2025-03-03 22:20:48,128 - {'Epoch': 2, 'HR@5': '0.0191', 'NDCG@5': '0.0124', 'HR@10': '0.0320', 'NDCG@10': '0.0165', 'HR@20': '0.0529', 'NDCG@20': '0.0217'}
2025-03-03 22:20:48,130 - Validation score increased.  Saving model ...
2025-03-03 22:21:44,820 - {'epoch': 3, 'rec_loss': '8.7379'}
2025-03-03 22:22:02,714 - {'Epoch': 3, 'HR@5': '0.0270', 'NDCG@5': '0.0175', 'HR@10': '0.0420', 'NDCG@10': '0.0223', 'HR@20': '0.0642', 'NDCG@20': '0.0279'}
2025-03-03 22:22:02,715 - Validation score increased.  Saving model ...
2025-03-03 22:22:41,211 - {'epoch': 4, 'rec_loss': '8.5888'}
2025-03-03 22:22:57,684 - {'Epoch': 4, 'HR@5': '0.0318', 'NDCG@5': '0.0208', 'HR@10': '0.0472', 'NDCG@10': '0.0257', 'HR@20': '0.0727', 'NDCG@20': '0.0322'}
2025-03-03 22:22:57,689 - Validation score increased.  Saving model ...
2025-03-03 22:23:52,138 - {'epoch': 5, 'rec_loss': '8.4745'}
2025-03-03 22:24:12,048 - {'Epoch': 5, 'HR@5': '0.0357', 'NDCG@5': '0.0236', 'HR@10': '0.0528', 'NDCG@10': '0.0291', 'HR@20': '0.0784', 'NDCG@20': '0.0355'}
2025-03-03 22:24:12,054 - Validation score increased.  Saving model ...
2025-03-03 22:25:04,836 - {'epoch': 6, 'rec_loss': '8.3798'}
2025-03-03 22:25:20,697 - {'Epoch': 6, 'HR@5': '0.0397', 'NDCG@5': '0.0266', 'HR@10': '0.0581', 'NDCG@10': '0.0325', 'HR@20': '0.0838', 'NDCG@20': '0.0389'}
2025-03-03 22:25:20,702 - Validation score increased.  Saving model ...
2025-03-03 22:26:07,675 - {'epoch': 7, 'rec_loss': '8.3035'}
2025-03-03 22:26:27,935 - {'Epoch': 7, 'HR@5': '0.0406', 'NDCG@5': '0.0277', 'HR@10': '0.0592', 'NDCG@10': '0.0336', 'HR@20': '0.0871', 'NDCG@20': '0.0406'}
2025-03-03 22:26:27,939 - Validation score increased.  Saving model ...
2025-03-03 22:27:29,097 - {'epoch': 8, 'rec_loss': '8.2320'}
2025-03-03 22:27:48,227 - {'Epoch': 8, 'HR@5': '0.0427', 'NDCG@5': '0.0293', 'HR@10': '0.0631', 'NDCG@10': '0.0359', 'HR@20': '0.0901', 'NDCG@20': '0.0427'}
2025-03-03 22:27:48,231 - Validation score increased.  Saving model ...
2025-03-03 22:28:28,357 - {'epoch': 9, 'rec_loss': '8.1837'}
2025-03-03 22:28:44,684 - {'Epoch': 9, 'HR@5': '0.0443', 'NDCG@5': '0.0304', 'HR@10': '0.0639', 'NDCG@10': '0.0368', 'HR@20': '0.0935', 'NDCG@20': '0.0442'}
2025-03-03 22:28:44,690 - Validation score increased.  Saving model ...
2025-03-03 22:29:38,493 - {'epoch': 10, 'rec_loss': '8.1279'}
2025-03-03 22:29:59,262 - {'Epoch': 10, 'HR@5': '0.0451', 'NDCG@5': '0.0310', 'HR@10': '0.0655', 'NDCG@10': '0.0376', 'HR@20': '0.0934', 'NDCG@20': '0.0446'}
2025-03-03 22:29:59,267 - Validation score increased.  Saving model ...
2025-03-03 22:30:51,118 - {'epoch': 11, 'rec_loss': '8.0900'}
2025-03-03 22:31:08,468 - {'Epoch': 11, 'HR@5': '0.0455', 'NDCG@5': '0.0316', 'HR@10': '0.0669', 'NDCG@10': '0.0385', 'HR@20': '0.0952', 'NDCG@20': '0.0456'}
2025-03-03 22:31:08,469 - Validation score increased.  Saving model ...
2025-03-03 22:31:57,307 - {'epoch': 12, 'rec_loss': '8.0504'}
2025-03-03 22:32:18,224 - {'Epoch': 12, 'HR@5': '0.0472', 'NDCG@5': '0.0330', 'HR@10': '0.0677', 'NDCG@10': '0.0396', 'HR@20': '0.0966', 'NDCG@20': '0.0469'}
2025-03-03 22:32:18,226 - Validation score increased.  Saving model ...
2025-03-03 22:33:19,830 - {'epoch': 13, 'rec_loss': '8.0174'}
2025-03-03 22:33:38,869 - {'Epoch': 13, 'HR@5': '0.0472', 'NDCG@5': '0.0330', 'HR@10': '0.0685', 'NDCG@10': '0.0399', 'HR@20': '0.0972', 'NDCG@20': '0.0471'}
2025-03-03 22:33:38,873 - Validation score increased.  Saving model ...
2025-03-03 22:34:16,427 - {'epoch': 14, 'rec_loss': '7.9850'}
2025-03-03 22:34:35,244 - {'Epoch': 14, 'HR@5': '0.0485', 'NDCG@5': '0.0336', 'HR@10': '0.0693', 'NDCG@10': '0.0403', 'HR@20': '0.0979', 'NDCG@20': '0.0474'}
2025-03-03 22:34:35,246 - Validation score increased.  Saving model ...
2025-03-03 22:35:36,663 - {'epoch': 15, 'rec_loss': '7.9619'}
2025-03-03 22:35:58,087 - {'Epoch': 15, 'HR@5': '0.0478', 'NDCG@5': '0.0331', 'HR@10': '0.0691', 'NDCG@10': '0.0399', 'HR@20': '0.0993', 'NDCG@20': '0.0475'}
2025-03-03 22:35:58,090 - Validation score increased.  Saving model ...
2025-03-03 22:36:41,866 - {'epoch': 16, 'rec_loss': '7.9392'}
2025-03-03 22:36:59,153 - {'Epoch': 16, 'HR@5': '0.0489', 'NDCG@5': '0.0340', 'HR@10': '0.0701', 'NDCG@10': '0.0408', 'HR@20': '0.1001', 'NDCG@20': '0.0483'}
2025-03-03 22:36:59,158 - Validation score increased.  Saving model ...
2025-03-03 22:37:52,170 - {'epoch': 17, 'rec_loss': '7.9127'}
2025-03-03 22:38:12,722 - {'Epoch': 17, 'HR@5': '0.0488', 'NDCG@5': '0.0343', 'HR@10': '0.0692', 'NDCG@10': '0.0408', 'HR@20': '0.1000', 'NDCG@20': '0.0486'}
2025-03-03 22:38:12,725 - Validation score increased.  Saving model ...
2025-03-03 22:39:03,111 - {'epoch': 18, 'rec_loss': '7.8979'}
2025-03-03 22:39:21,337 - {'Epoch': 18, 'HR@5': '0.0488', 'NDCG@5': '0.0342', 'HR@10': '0.0701', 'NDCG@10': '0.0410', 'HR@20': '0.0998', 'NDCG@20': '0.0485'}
2025-03-03 22:39:21,343 - EarlyStopping counter: 1 out of 10
2025-03-03 22:39:58,828 - {'epoch': 19, 'rec_loss': '7.8788'}
2025-03-03 22:40:18,563 - {'Epoch': 19, 'HR@5': '0.0495', 'NDCG@5': '0.0346', 'HR@10': '0.0710', 'NDCG@10': '0.0415', 'HR@20': '0.1002', 'NDCG@20': '0.0488'}
2025-03-03 22:40:18,566 - Validation score increased.  Saving model ...
2025-03-03 22:41:16,388 - {'epoch': 20, 'rec_loss': '7.8591'}
2025-03-03 22:41:37,427 - {'Epoch': 20, 'HR@5': '0.0507', 'NDCG@5': '0.0353', 'HR@10': '0.0715', 'NDCG@10': '0.0419', 'HR@20': '0.1015', 'NDCG@20': '0.0495'}
2025-03-03 22:41:37,429 - Validation score increased.  Saving model ...
2025-03-03 22:42:19,951 - {'epoch': 21, 'rec_loss': '7.8402'}
2025-03-03 22:42:38,836 - {'Epoch': 21, 'HR@5': '0.0496', 'NDCG@5': '0.0346', 'HR@10': '0.0710', 'NDCG@10': '0.0415', 'HR@20': '0.1031', 'NDCG@20': '0.0496'}
2025-03-03 22:42:38,837 - Validation score increased.  Saving model ...
2025-03-03 22:43:37,091 - {'epoch': 22, 'rec_loss': '7.8248'}
2025-03-03 22:43:57,722 - {'Epoch': 22, 'HR@5': '0.0503', 'NDCG@5': '0.0353', 'HR@10': '0.0731', 'NDCG@10': '0.0426', 'HR@20': '0.1028', 'NDCG@20': '0.0501'}
2025-03-03 22:43:57,726 - Validation score increased.  Saving model ...
2025-03-03 22:44:49,916 - {'epoch': 23, 'rec_loss': '7.8146'}
2025-03-03 22:45:07,946 - {'Epoch': 23, 'HR@5': '0.0492', 'NDCG@5': '0.0343', 'HR@10': '0.0725', 'NDCG@10': '0.0418', 'HR@20': '0.1021', 'NDCG@20': '0.0492'}
2025-03-03 22:45:07,950 - EarlyStopping counter: 1 out of 10
2025-03-03 22:45:55,153 - {'epoch': 24, 'rec_loss': '7.8068'}
2025-03-03 22:46:16,589 - {'Epoch': 24, 'HR@5': '0.0509', 'NDCG@5': '0.0354', 'HR@10': '0.0732', 'NDCG@10': '0.0425', 'HR@20': '0.1037', 'NDCG@20': '0.0502'}
2025-03-03 22:46:16,591 - Validation score increased.  Saving model ...
2025-03-03 22:47:14,728 - {'epoch': 25, 'rec_loss': '7.7888'}
2025-03-03 22:47:33,190 - {'Epoch': 25, 'HR@5': '0.0500', 'NDCG@5': '0.0350', 'HR@10': '0.0734', 'NDCG@10': '0.0425', 'HR@20': '0.1042', 'NDCG@20': '0.0503'}
2025-03-03 22:47:33,191 - Validation score increased.  Saving model ...
2025-03-03 22:48:12,180 - {'epoch': 26, 'rec_loss': '7.7775'}
2025-03-03 22:48:31,750 - {'Epoch': 26, 'HR@5': '0.0508', 'NDCG@5': '0.0356', 'HR@10': '0.0732', 'NDCG@10': '0.0427', 'HR@20': '0.1037', 'NDCG@20': '0.0504'}
2025-03-03 22:48:31,755 - Validation score increased.  Saving model ...
2025-03-03 22:49:31,675 - {'epoch': 27, 'rec_loss': '7.7675'}
2025-03-03 22:49:52,490 - {'Epoch': 27, 'HR@5': '0.0501', 'NDCG@5': '0.0349', 'HR@10': '0.0737', 'NDCG@10': '0.0425', 'HR@20': '0.1038', 'NDCG@20': '0.0501'}
2025-03-03 22:49:52,494 - EarlyStopping counter: 1 out of 10
2025-03-03 22:50:38,908 - {'epoch': 28, 'rec_loss': '7.7537'}
2025-03-03 22:50:55,225 - {'Epoch': 28, 'HR@5': '0.0520', 'NDCG@5': '0.0360', 'HR@10': '0.0740', 'NDCG@10': '0.0431', 'HR@20': '0.1055', 'NDCG@20': '0.0510'}
2025-03-03 22:50:55,228 - Validation score increased.  Saving model ...
2025-03-03 22:51:42,540 - {'epoch': 29, 'rec_loss': '7.7451'}
2025-03-03 22:52:02,825 - {'Epoch': 29, 'HR@5': '0.0509', 'NDCG@5': '0.0355', 'HR@10': '0.0737', 'NDCG@10': '0.0428', 'HR@20': '0.1038', 'NDCG@20': '0.0503'}
2025-03-03 22:52:02,826 - EarlyStopping counter: 1 out of 10
2025-03-03 22:53:01,694 - {'epoch': 30, 'rec_loss': '7.7355'}
2025-03-03 22:53:21,943 - {'Epoch': 30, 'HR@5': '0.0512', 'NDCG@5': '0.0355', 'HR@10': '0.0740', 'NDCG@10': '0.0429', 'HR@20': '0.1042', 'NDCG@20': '0.0505'}
2025-03-03 22:53:21,944 - EarlyStopping counter: 2 out of 10
2025-03-03 22:54:01,284 - {'epoch': 31, 'rec_loss': '7.7229'}
2025-03-03 22:54:22,572 - {'Epoch': 31, 'HR@5': '0.0505', 'NDCG@5': '0.0352', 'HR@10': '0.0740', 'NDCG@10': '0.0428', 'HR@20': '0.1044', 'NDCG@20': '0.0504'}
2025-03-03 22:54:22,574 - EarlyStopping counter: 3 out of 10
2025-03-03 22:55:23,009 - {'epoch': 32, 'rec_loss': '7.7127'}
2025-03-03 22:55:43,900 - {'Epoch': 32, 'HR@5': '0.0527', 'NDCG@5': '0.0365', 'HR@10': '0.0751', 'NDCG@10': '0.0436', 'HR@20': '0.1048', 'NDCG@20': '0.0511'}
2025-03-03 22:55:43,904 - Validation score increased.  Saving model ...
2025-03-03 22:56:26,103 - {'epoch': 33, 'rec_loss': '7.7123'}
2025-03-03 22:56:44,927 - {'Epoch': 33, 'HR@5': '0.0514', 'NDCG@5': '0.0360', 'HR@10': '0.0745', 'NDCG@10': '0.0435', 'HR@20': '0.1056', 'NDCG@20': '0.0513'}
2025-03-03 22:56:44,932 - Validation score increased.  Saving model ...
2025-03-03 22:57:46,593 - {'epoch': 34, 'rec_loss': '7.7000'}
2025-03-03 22:58:08,131 - {'Epoch': 34, 'HR@5': '0.0510', 'NDCG@5': '0.0359', 'HR@10': '0.0733', 'NDCG@10': '0.0430', 'HR@20': '0.1048', 'NDCG@20': '0.0509'}
2025-03-03 22:58:08,135 - EarlyStopping counter: 1 out of 10
2025-03-03 22:58:57,247 - {'epoch': 35, 'rec_loss': '7.6961'}
2025-03-03 22:59:13,846 - {'Epoch': 35, 'HR@5': '0.0524', 'NDCG@5': '0.0365', 'HR@10': '0.0737', 'NDCG@10': '0.0433', 'HR@20': '0.1054', 'NDCG@20': '0.0513'}
2025-03-03 22:59:13,849 - EarlyStopping counter: 2 out of 10
2025-03-03 23:00:07,252 - {'epoch': 36, 'rec_loss': '7.6869'}
2025-03-03 23:00:29,142 - {'Epoch': 36, 'HR@5': '0.0519', 'NDCG@5': '0.0361', 'HR@10': '0.0750', 'NDCG@10': '0.0435', 'HR@20': '0.1054', 'NDCG@20': '0.0512'}
2025-03-03 23:00:29,143 - EarlyStopping counter: 3 out of 10
2025-03-03 23:01:25,314 - {'epoch': 37, 'rec_loss': '7.6779'}
2025-03-03 23:01:44,316 - {'Epoch': 37, 'HR@5': '0.0526', 'NDCG@5': '0.0368', 'HR@10': '0.0746', 'NDCG@10': '0.0439', 'HR@20': '0.1068', 'NDCG@20': '0.0520'}
2025-03-03 23:01:44,321 - Validation score increased.  Saving model ...
2025-03-03 23:02:28,815 - {'epoch': 38, 'rec_loss': '7.6773'}
2025-03-03 23:02:49,123 - {'Epoch': 38, 'HR@5': '0.0520', 'NDCG@5': '0.0365', 'HR@10': '0.0745', 'NDCG@10': '0.0437', 'HR@20': '0.1052', 'NDCG@20': '0.0515'}
2025-03-03 23:02:49,127 - EarlyStopping counter: 1 out of 10
2025-03-03 23:03:49,901 - {'epoch': 39, 'rec_loss': '7.6687'}
2025-03-03 23:04:11,479 - {'Epoch': 39, 'HR@5': '0.0530', 'NDCG@5': '0.0370', 'HR@10': '0.0761', 'NDCG@10': '0.0444', 'HR@20': '0.1066', 'NDCG@20': '0.0521'}
2025-03-03 23:04:11,481 - Validation score increased.  Saving model ...
2025-03-03 23:04:52,642 - {'epoch': 40, 'rec_loss': '7.6569'}
2025-03-03 23:05:11,599 - {'Epoch': 40, 'HR@5': '0.0534', 'NDCG@5': '0.0373', 'HR@10': '0.0747', 'NDCG@10': '0.0441', 'HR@20': '0.1053', 'NDCG@20': '0.0519'}
2025-03-03 23:05:11,600 - EarlyStopping counter: 1 out of 10
2025-03-03 23:06:11,410 - {'epoch': 41, 'rec_loss': '7.6520'}
2025-03-03 23:06:33,000 - {'Epoch': 41, 'HR@5': '0.0538', 'NDCG@5': '0.0375', 'HR@10': '0.0759', 'NDCG@10': '0.0446', 'HR@20': '0.1061', 'NDCG@20': '0.0522'}
2025-03-03 23:06:33,007 - Validation score increased.  Saving model ...
2025-03-03 23:07:21,067 - {'epoch': 42, 'rec_loss': '7.6452'}
2025-03-03 23:07:39,981 - {'Epoch': 42, 'HR@5': '0.0529', 'NDCG@5': '0.0371', 'HR@10': '0.0758', 'NDCG@10': '0.0445', 'HR@20': '0.1066', 'NDCG@20': '0.0522'}
2025-03-03 23:07:39,987 - Validation score increased.  Saving model ...
2025-03-03 23:08:28,118 - {'epoch': 43, 'rec_loss': '7.6447'}
2025-03-03 23:08:49,790 - {'Epoch': 43, 'HR@5': '0.0538', 'NDCG@5': '0.0379', 'HR@10': '0.0772', 'NDCG@10': '0.0454', 'HR@20': '0.1083', 'NDCG@20': '0.0532'}
2025-03-03 23:08:49,791 - Validation score increased.  Saving model ...
2025-03-03 23:09:48,300 - {'epoch': 44, 'rec_loss': '7.6361'}
2025-03-03 23:10:05,724 - {'Epoch': 44, 'HR@5': '0.0530', 'NDCG@5': '0.0372', 'HR@10': '0.0758', 'NDCG@10': '0.0445', 'HR@20': '0.1058', 'NDCG@20': '0.0521'}
2025-03-03 23:10:05,726 - EarlyStopping counter: 1 out of 10
2025-03-03 23:10:48,460 - {'epoch': 45, 'rec_loss': '7.6319'}
2025-03-03 23:11:09,466 - {'Epoch': 45, 'HR@5': '0.0535', 'NDCG@5': '0.0372', 'HR@10': '0.0760', 'NDCG@10': '0.0444', 'HR@20': '0.1055', 'NDCG@20': '0.0519'}
2025-03-03 23:11:09,472 - EarlyStopping counter: 2 out of 10
2025-03-03 23:12:05,598 - {'epoch': 46, 'rec_loss': '7.6285'}
2025-03-03 23:12:26,337 - {'Epoch': 46, 'HR@5': '0.0533', 'NDCG@5': '0.0370', 'HR@10': '0.0764', 'NDCG@10': '0.0445', 'HR@20': '0.1066', 'NDCG@20': '0.0521'}
2025-03-03 23:12:26,341 - EarlyStopping counter: 3 out of 10
2025-03-03 23:13:06,614 - {'epoch': 47, 'rec_loss': '7.6198'}
2025-03-03 23:13:25,603 - {'Epoch': 47, 'HR@5': '0.0530', 'NDCG@5': '0.0372', 'HR@10': '0.0750', 'NDCG@10': '0.0443', 'HR@20': '0.1066', 'NDCG@20': '0.0523'}
2025-03-03 23:13:25,605 - EarlyStopping counter: 4 out of 10
2025-03-03 23:14:24,215 - {'epoch': 48, 'rec_loss': '7.6205'}
2025-03-03 23:14:45,917 - {'Epoch': 48, 'HR@5': '0.0535', 'NDCG@5': '0.0374', 'HR@10': '0.0765', 'NDCG@10': '0.0448', 'HR@20': '0.1060', 'NDCG@20': '0.0522'}
2025-03-03 23:14:45,924 - EarlyStopping counter: 5 out of 10
2025-03-03 23:15:35,013 - {'epoch': 49, 'rec_loss': '7.6194'}
2025-03-03 23:15:53,473 - {'Epoch': 49, 'HR@5': '0.0526', 'NDCG@5': '0.0370', 'HR@10': '0.0764', 'NDCG@10': '0.0447', 'HR@20': '0.1074', 'NDCG@20': '0.0525'}
2025-03-03 23:15:53,478 - EarlyStopping counter: 6 out of 10
2025-03-03 23:16:37,183 - {'epoch': 50, 'rec_loss': '7.6102'}
2025-03-03 23:16:58,087 - {'Epoch': 50, 'HR@5': '0.0522', 'NDCG@5': '0.0365', 'HR@10': '0.0757', 'NDCG@10': '0.0441', 'HR@20': '0.1056', 'NDCG@20': '0.0516'}
2025-03-03 23:16:58,092 - EarlyStopping counter: 7 out of 10
2025-03-03 23:17:59,072 - {'epoch': 51, 'rec_loss': '7.6088'}
2025-03-03 23:18:18,332 - {'Epoch': 51, 'HR@5': '0.0527', 'NDCG@5': '0.0367', 'HR@10': '0.0755', 'NDCG@10': '0.0441', 'HR@20': '0.1053', 'NDCG@20': '0.0516'}
2025-03-03 23:18:18,333 - EarlyStopping counter: 8 out of 10
2025-03-03 23:18:58,534 - {'epoch': 52, 'rec_loss': '7.6023'}
2025-03-03 23:19:19,188 - {'Epoch': 52, 'HR@5': '0.0533', 'NDCG@5': '0.0370', 'HR@10': '0.0757', 'NDCG@10': '0.0442', 'HR@20': '0.1060', 'NDCG@20': '0.0518'}
2025-03-03 23:19:19,195 - EarlyStopping counter: 9 out of 10
2025-03-03 23:20:19,808 - {'epoch': 53, 'rec_loss': '7.6028'}
2025-03-03 23:20:41,040 - {'Epoch': 53, 'HR@5': '0.0527', 'NDCG@5': '0.0368', 'HR@10': '0.0753', 'NDCG@10': '0.0441', 'HR@20': '0.1058', 'NDCG@20': '0.0518'}
2025-03-03 23:20:41,044 - EarlyStopping counter: 10 out of 10
2025-03-03 23:20:41,044 - Early stopping
2025-03-03 23:20:41,044 - ---------------Test Score---------------
2025-03-03 23:20:58,869 - {'Epoch': 0, 'HR@5': '0.0441', 'NDCG@5': '0.0304', 'HR@10': '0.0640', 'NDCG@10': '0.0368', 'HR@20': '0.0902', 'NDCG@20': '0.0434'}
2025-03-03 23:20:58,873 - Scale_Sports
2025-03-03 23:20:58,873 - {'Epoch': 0, 'HR@5': '0.0441', 'NDCG@5': '0.0304', 'HR@10': '0.0640', 'NDCG@10': '0.0368', 'HR@20': '0.0902', 'NDCG@20': '0.0434'}
2025-03-03 23:23:38,869 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[50, 25], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-03 23:23:43,070 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=25, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-03 23:23:43,081 - Total Parameters: 1329829
2025-03-03 23:24:39,807 - {'epoch': 0, 'rec_loss': '9.4012'}
2025-03-03 23:25:00,585 - {'Epoch': 0, 'HR@5': '0.0087', 'NDCG@5': '0.0056', 'HR@10': '0.0126', 'NDCG@10': '0.0069', 'HR@20': '0.0226', 'NDCG@20': '0.0093'}
2025-03-03 23:25:00,587 - Validation score increased.  Saving model ...
2025-03-03 23:25:46,612 - {'epoch': 1, 'rec_loss': '9.2022'}
2025-03-03 23:26:02,919 - {'Epoch': 1, 'HR@5': '0.0151', 'NDCG@5': '0.0096', 'HR@10': '0.0252', 'NDCG@10': '0.0128', 'HR@20': '0.0392', 'NDCG@20': '0.0164'}
2025-03-03 23:26:02,921 - Validation score increased.  Saving model ...
2025-03-03 23:26:52,879 - {'epoch': 2, 'rec_loss': '8.9463'}
2025-03-03 23:27:13,056 - {'Epoch': 2, 'HR@5': '0.0196', 'NDCG@5': '0.0126', 'HR@10': '0.0314', 'NDCG@10': '0.0164', 'HR@20': '0.0503', 'NDCG@20': '0.0211'}
2025-03-03 23:27:13,064 - Validation score increased.  Saving model ...
2025-03-03 23:28:08,636 - {'epoch': 3, 'rec_loss': '8.7657'}
2025-03-03 23:28:24,690 - {'Epoch': 3, 'HR@5': '0.0255', 'NDCG@5': '0.0165', 'HR@10': '0.0398', 'NDCG@10': '0.0212', 'HR@20': '0.0617', 'NDCG@20': '0.0267'}
2025-03-03 23:28:24,693 - Validation score increased.  Saving model ...
2025-03-03 23:29:03,899 - {'epoch': 4, 'rec_loss': '8.6127'}
2025-03-03 23:29:25,378 - {'Epoch': 4, 'HR@5': '0.0301', 'NDCG@5': '0.0197', 'HR@10': '0.0458', 'NDCG@10': '0.0247', 'HR@20': '0.0700', 'NDCG@20': '0.0308'}
2025-03-03 23:29:25,380 - Validation score increased.  Saving model ...
2025-03-03 23:30:22,050 - {'epoch': 5, 'rec_loss': '8.4866'}
2025-03-03 23:30:43,121 - {'Epoch': 5, 'HR@5': '0.0353', 'NDCG@5': '0.0239', 'HR@10': '0.0529', 'NDCG@10': '0.0295', 'HR@20': '0.0777', 'NDCG@20': '0.0358'}
2025-03-03 23:30:43,123 - Validation score increased.  Saving model ...
2025-03-03 23:31:25,976 - {'epoch': 6, 'rec_loss': '8.3889'}
2025-03-03 23:31:43,633 - {'Epoch': 6, 'HR@5': '0.0384', 'NDCG@5': '0.0259', 'HR@10': '0.0549', 'NDCG@10': '0.0312', 'HR@20': '0.0809', 'NDCG@20': '0.0377'}
2025-03-03 23:31:43,634 - Validation score increased.  Saving model ...
2025-03-03 23:32:38,067 - {'epoch': 7, 'rec_loss': '8.3068'}
2025-03-03 23:32:59,202 - {'Epoch': 7, 'HR@5': '0.0406', 'NDCG@5': '0.0277', 'HR@10': '0.0587', 'NDCG@10': '0.0335', 'HR@20': '0.0860', 'NDCG@20': '0.0404'}
2025-03-03 23:32:59,204 - Validation score increased.  Saving model ...
2025-03-03 23:33:48,562 - {'epoch': 8, 'rec_loss': '8.2348'}
2025-03-03 23:34:07,487 - {'Epoch': 8, 'HR@5': '0.0427', 'NDCG@5': '0.0291', 'HR@10': '0.0623', 'NDCG@10': '0.0354', 'HR@20': '0.0896', 'NDCG@20': '0.0423'}
2025-03-03 23:34:07,489 - Validation score increased.  Saving model ...
2025-03-03 23:34:53,729 - {'epoch': 9, 'rec_loss': '8.1792'}
2025-03-03 23:35:14,862 - {'Epoch': 9, 'HR@5': '0.0444', 'NDCG@5': '0.0309', 'HR@10': '0.0646', 'NDCG@10': '0.0374', 'HR@20': '0.0911', 'NDCG@20': '0.0440'}
2025-03-03 23:35:14,863 - Validation score increased.  Saving model ...
2025-03-03 23:36:10,306 - {'epoch': 10, 'rec_loss': '8.1284'}
2025-03-03 23:36:29,268 - {'Epoch': 10, 'HR@5': '0.0456', 'NDCG@5': '0.0314', 'HR@10': '0.0662', 'NDCG@10': '0.0380', 'HR@20': '0.0937', 'NDCG@20': '0.0449'}
2025-03-03 23:36:29,271 - Validation score increased.  Saving model ...
2025-03-03 23:37:08,724 - {'epoch': 11, 'rec_loss': '8.0807'}
2025-03-03 23:37:30,004 - {'Epoch': 11, 'HR@5': '0.0462', 'NDCG@5': '0.0321', 'HR@10': '0.0666', 'NDCG@10': '0.0387', 'HR@20': '0.0949', 'NDCG@20': '0.0458'}
2025-03-03 23:37:30,009 - Validation score increased.  Saving model ...
2025-03-03 23:38:27,508 - {'epoch': 12, 'rec_loss': '8.0424'}
2025-03-03 23:38:49,446 - {'Epoch': 12, 'HR@5': '0.0466', 'NDCG@5': '0.0321', 'HR@10': '0.0671', 'NDCG@10': '0.0387', 'HR@20': '0.0949', 'NDCG@20': '0.0457'}
2025-03-03 23:38:49,450 - EarlyStopping counter: 1 out of 10
2025-03-03 23:39:31,553 - {'epoch': 13, 'rec_loss': '8.0082'}
2025-03-03 23:39:48,027 - {'Epoch': 13, 'HR@5': '0.0488', 'NDCG@5': '0.0337', 'HR@10': '0.0691', 'NDCG@10': '0.0403', 'HR@20': '0.0965', 'NDCG@20': '0.0471'}
2025-03-03 23:39:48,028 - Validation score increased.  Saving model ...
2025-03-03 23:40:42,521 - {'epoch': 14, 'rec_loss': '7.9737'}
2025-03-03 23:41:04,222 - {'Epoch': 14, 'HR@5': '0.0485', 'NDCG@5': '0.0331', 'HR@10': '0.0691', 'NDCG@10': '0.0397', 'HR@20': '0.0972', 'NDCG@20': '0.0468'}
2025-03-03 23:41:04,225 - EarlyStopping counter: 1 out of 10
2025-03-03 23:41:53,943 - {'epoch': 15, 'rec_loss': '7.9539'}
2025-03-03 23:42:11,628 - {'Epoch': 15, 'HR@5': '0.0482', 'NDCG@5': '0.0333', 'HR@10': '0.0694', 'NDCG@10': '0.0401', 'HR@20': '0.0976', 'NDCG@20': '0.0472'}
2025-03-03 23:42:11,633 - Validation score increased.  Saving model ...
2025-03-03 23:42:58,245 - {'epoch': 16, 'rec_loss': '7.9310'}
2025-03-03 23:43:19,098 - {'Epoch': 16, 'HR@5': '0.0481', 'NDCG@5': '0.0333', 'HR@10': '0.0701', 'NDCG@10': '0.0404', 'HR@20': '0.1001', 'NDCG@20': '0.0479'}
2025-03-03 23:43:19,099 - Validation score increased.  Saving model ...
2025-03-03 23:44:15,561 - {'epoch': 17, 'rec_loss': '7.9015'}
2025-03-03 23:44:34,311 - {'Epoch': 17, 'HR@5': '0.0491', 'NDCG@5': '0.0342', 'HR@10': '0.0710', 'NDCG@10': '0.0411', 'HR@20': '0.1001', 'NDCG@20': '0.0485'}
2025-03-03 23:44:34,312 - Validation score increased.  Saving model ...
2025-03-03 23:45:20,454 - {'epoch': 18, 'rec_loss': '7.8889'}
2025-03-03 23:45:40,504 - {'Epoch': 18, 'HR@5': '0.0499', 'NDCG@5': '0.0346', 'HR@10': '0.0710', 'NDCG@10': '0.0414', 'HR@20': '0.1010', 'NDCG@20': '0.0490'}
2025-03-03 23:45:40,506 - Validation score increased.  Saving model ...
2025-03-03 23:46:38,182 - {'epoch': 19, 'rec_loss': '7.8651'}
2025-03-03 23:46:59,363 - {'Epoch': 19, 'HR@5': '0.0491', 'NDCG@5': '0.0347', 'HR@10': '0.0714', 'NDCG@10': '0.0418', 'HR@20': '0.1011', 'NDCG@20': '0.0493'}
2025-03-03 23:46:59,364 - Validation score increased.  Saving model ...
2025-03-03 23:47:43,646 - {'epoch': 20, 'rec_loss': '7.8503'}
2025-03-03 23:48:01,818 - {'Epoch': 20, 'HR@5': '0.0519', 'NDCG@5': '0.0362', 'HR@10': '0.0728', 'NDCG@10': '0.0430', 'HR@20': '0.1017', 'NDCG@20': '0.0502'}
2025-03-03 23:48:01,821 - Validation score increased.  Saving model ...
2025-03-03 23:48:54,994 - {'epoch': 21, 'rec_loss': '7.8349'}
2025-03-03 23:49:16,324 - {'Epoch': 21, 'HR@5': '0.0509', 'NDCG@5': '0.0355', 'HR@10': '0.0732', 'NDCG@10': '0.0426', 'HR@20': '0.1026', 'NDCG@20': '0.0500'}
2025-03-03 23:49:16,325 - EarlyStopping counter: 1 out of 10
2025-03-03 23:50:07,338 - {'epoch': 22, 'rec_loss': '7.8172'}
2025-03-03 23:50:24,133 - {'Epoch': 22, 'HR@5': '0.0507', 'NDCG@5': '0.0357', 'HR@10': '0.0733', 'NDCG@10': '0.0429', 'HR@20': '0.1032', 'NDCG@20': '0.0504'}
2025-03-03 23:50:24,139 - Validation score increased.  Saving model ...
2025-03-03 23:51:03,395 - {'epoch': 23, 'rec_loss': '7.8050'}
2025-03-03 23:51:23,741 - {'Epoch': 23, 'HR@5': '0.0507', 'NDCG@5': '0.0354', 'HR@10': '0.0722', 'NDCG@10': '0.0423', 'HR@20': '0.1023', 'NDCG@20': '0.0499'}
2025-03-03 23:51:23,744 - EarlyStopping counter: 1 out of 10
2025-03-03 23:52:20,466 - {'epoch': 24, 'rec_loss': '7.7890'}
2025-03-03 23:52:41,915 - {'Epoch': 24, 'HR@5': '0.0520', 'NDCG@5': '0.0364', 'HR@10': '0.0727', 'NDCG@10': '0.0430', 'HR@20': '0.1023', 'NDCG@20': '0.0505'}
2025-03-03 23:52:41,919 - Validation score increased.  Saving model ...
2025-03-03 23:53:24,874 - {'epoch': 25, 'rec_loss': '7.7744'}
2025-03-03 23:53:43,811 - {'Epoch': 25, 'HR@5': '0.0511', 'NDCG@5': '0.0359', 'HR@10': '0.0726', 'NDCG@10': '0.0428', 'HR@20': '0.1034', 'NDCG@20': '0.0506'}
2025-03-03 23:53:43,812 - Validation score increased.  Saving model ...
2025-03-03 23:54:35,911 - {'epoch': 26, 'rec_loss': '7.7669'}
2025-03-03 23:54:57,093 - {'Epoch': 26, 'HR@5': '0.0517', 'NDCG@5': '0.0362', 'HR@10': '0.0728', 'NDCG@10': '0.0429', 'HR@20': '0.1034', 'NDCG@20': '0.0506'}
2025-03-03 23:54:57,098 - Validation score increased.  Saving model ...
2025-03-03 23:55:45,798 - {'epoch': 27, 'rec_loss': '7.7548'}
2025-03-03 23:56:05,132 - {'Epoch': 27, 'HR@5': '0.0518', 'NDCG@5': '0.0365', 'HR@10': '0.0735', 'NDCG@10': '0.0435', 'HR@20': '0.1034', 'NDCG@20': '0.0510'}
2025-03-03 23:56:05,135 - Validation score increased.  Saving model ...
2025-03-03 23:56:49,401 - {'epoch': 28, 'rec_loss': '7.7445'}
2025-03-03 23:57:10,937 - {'Epoch': 28, 'HR@5': '0.0516', 'NDCG@5': '0.0363', 'HR@10': '0.0729', 'NDCG@10': '0.0431', 'HR@20': '0.1028', 'NDCG@20': '0.0506'}
2025-03-03 23:57:10,940 - EarlyStopping counter: 1 out of 10
2025-03-03 23:58:07,057 - {'epoch': 29, 'rec_loss': '7.7351'}
2025-03-03 23:58:25,720 - {'Epoch': 29, 'HR@5': '0.0511', 'NDCG@5': '0.0360', 'HR@10': '0.0728', 'NDCG@10': '0.0429', 'HR@20': '0.1033', 'NDCG@20': '0.0506'}
2025-03-03 23:58:25,726 - EarlyStopping counter: 2 out of 10
2025-03-03 23:59:05,562 - {'epoch': 30, 'rec_loss': '7.7275'}
2025-03-03 23:59:25,226 - {'Epoch': 30, 'HR@5': '0.0526', 'NDCG@5': '0.0365', 'HR@10': '0.0741', 'NDCG@10': '0.0434', 'HR@20': '0.1041', 'NDCG@20': '0.0509'}
2025-03-03 23:59:25,228 - EarlyStopping counter: 3 out of 10
2025-03-04 00:00:20,869 - {'epoch': 31, 'rec_loss': '7.7179'}
2025-03-04 00:00:41,992 - {'Epoch': 31, 'HR@5': '0.0526', 'NDCG@5': '0.0364', 'HR@10': '0.0739', 'NDCG@10': '0.0433', 'HR@20': '0.1041', 'NDCG@20': '0.0508'}
2025-03-04 00:00:41,994 - EarlyStopping counter: 4 out of 10
2025-03-04 00:01:26,892 - {'epoch': 32, 'rec_loss': '7.7071'}
2025-03-04 00:01:44,013 - {'Epoch': 32, 'HR@5': '0.0519', 'NDCG@5': '0.0362', 'HR@10': '0.0743', 'NDCG@10': '0.0434', 'HR@20': '0.1049', 'NDCG@20': '0.0511'}
2025-03-04 00:01:44,015 - Validation score increased.  Saving model ...
2025-03-04 00:02:22,669 - {'epoch': 33, 'rec_loss': '7.7043'}
2025-03-04 00:02:41,343 - {'Epoch': 33, 'HR@5': '0.0519', 'NDCG@5': '0.0363', 'HR@10': '0.0736', 'NDCG@10': '0.0433', 'HR@20': '0.1047', 'NDCG@20': '0.0511'}
2025-03-04 00:02:41,347 - EarlyStopping counter: 1 out of 10
2025-03-04 00:03:19,752 - {'epoch': 34, 'rec_loss': '7.6985'}
2025-03-04 00:03:36,729 - {'Epoch': 34, 'HR@5': '0.0514', 'NDCG@5': '0.0360', 'HR@10': '0.0751', 'NDCG@10': '0.0436', 'HR@20': '0.1063', 'NDCG@20': '0.0514'}
2025-03-04 00:03:36,733 - Validation score increased.  Saving model ...
2025-03-04 00:04:13,696 - {'epoch': 35, 'rec_loss': '7.6845'}
2025-03-04 00:04:32,923 - {'Epoch': 35, 'HR@5': '0.0528', 'NDCG@5': '0.0367', 'HR@10': '0.0747', 'NDCG@10': '0.0437', 'HR@20': '0.1041', 'NDCG@20': '0.0511'}
2025-03-04 00:04:32,924 - EarlyStopping counter: 1 out of 10
2025-03-04 00:05:10,471 - {'epoch': 36, 'rec_loss': '7.6785'}
2025-03-04 00:05:27,713 - {'Epoch': 36, 'HR@5': '0.0527', 'NDCG@5': '0.0367', 'HR@10': '0.0753', 'NDCG@10': '0.0440', 'HR@20': '0.1052', 'NDCG@20': '0.0515'}
2025-03-04 00:05:27,714 - Validation score increased.  Saving model ...
2025-03-04 00:06:04,665 - {'epoch': 37, 'rec_loss': '7.6662'}
2025-03-04 00:06:23,449 - {'Epoch': 37, 'HR@5': '0.0525', 'NDCG@5': '0.0364', 'HR@10': '0.0753', 'NDCG@10': '0.0437', 'HR@20': '0.1049', 'NDCG@20': '0.0511'}
2025-03-04 00:06:23,453 - EarlyStopping counter: 1 out of 10
2025-03-04 00:07:02,649 - {'epoch': 38, 'rec_loss': '7.6715'}
2025-03-04 00:07:19,554 - {'Epoch': 38, 'HR@5': '0.0527', 'NDCG@5': '0.0366', 'HR@10': '0.0749', 'NDCG@10': '0.0437', 'HR@20': '0.1049', 'NDCG@20': '0.0512'}
2025-03-04 00:07:19,555 - EarlyStopping counter: 2 out of 10
2025-03-04 00:08:02,250 - {'epoch': 39, 'rec_loss': '7.6573'}
2025-03-04 00:08:19,505 - {'Epoch': 39, 'HR@5': '0.0535', 'NDCG@5': '0.0368', 'HR@10': '0.0752', 'NDCG@10': '0.0438', 'HR@20': '0.1053', 'NDCG@20': '0.0513'}
2025-03-04 00:08:19,506 - EarlyStopping counter: 3 out of 10
2025-03-04 00:08:56,505 - {'epoch': 40, 'rec_loss': '7.6496'}
2025-03-04 00:09:14,244 - {'Epoch': 40, 'HR@5': '0.0527', 'NDCG@5': '0.0369', 'HR@10': '0.0748', 'NDCG@10': '0.0440', 'HR@20': '0.1053', 'NDCG@20': '0.0516'}
2025-03-04 00:09:14,247 - Validation score increased.  Saving model ...
2025-03-04 00:09:51,150 - {'epoch': 41, 'rec_loss': '7.6400'}
2025-03-04 00:10:10,397 - {'Epoch': 41, 'HR@5': '0.0512', 'NDCG@5': '0.0363', 'HR@10': '0.0749', 'NDCG@10': '0.0439', 'HR@20': '0.1059', 'NDCG@20': '0.0517'}
2025-03-04 00:10:10,398 - Validation score increased.  Saving model ...
2025-03-04 00:10:47,393 - {'epoch': 42, 'rec_loss': '7.6417'}
2025-03-04 00:11:04,093 - {'Epoch': 42, 'HR@5': '0.0526', 'NDCG@5': '0.0368', 'HR@10': '0.0749', 'NDCG@10': '0.0440', 'HR@20': '0.1053', 'NDCG@20': '0.0517'}
2025-03-04 00:11:04,096 - EarlyStopping counter: 1 out of 10
2025-03-04 00:11:43,184 - {'epoch': 43, 'rec_loss': '7.6373'}
2025-03-04 00:12:02,291 - {'Epoch': 43, 'HR@5': '0.0524', 'NDCG@5': '0.0365', 'HR@10': '0.0750', 'NDCG@10': '0.0437', 'HR@20': '0.1056', 'NDCG@20': '0.0514'}
2025-03-04 00:12:02,293 - EarlyStopping counter: 2 out of 10
2025-03-04 00:12:39,712 - {'epoch': 44, 'rec_loss': '7.6293'}
2025-03-04 00:12:59,076 - {'Epoch': 44, 'HR@5': '0.0519', 'NDCG@5': '0.0365', 'HR@10': '0.0755', 'NDCG@10': '0.0441', 'HR@20': '0.1063', 'NDCG@20': '0.0518'}
2025-03-04 00:12:59,077 - Validation score increased.  Saving model ...
2025-03-04 00:13:36,723 - {'epoch': 45, 'rec_loss': '7.6259'}
2025-03-04 00:13:55,813 - {'Epoch': 45, 'HR@5': '0.0525', 'NDCG@5': '0.0368', 'HR@10': '0.0744', 'NDCG@10': '0.0438', 'HR@20': '0.1050', 'NDCG@20': '0.0515'}
2025-03-04 00:13:55,817 - EarlyStopping counter: 1 out of 10
2025-03-04 00:14:32,752 - {'epoch': 46, 'rec_loss': '7.6239'}
2025-03-04 00:14:51,490 - {'Epoch': 46, 'HR@5': '0.0522', 'NDCG@5': '0.0367', 'HR@10': '0.0746', 'NDCG@10': '0.0439', 'HR@20': '0.1048', 'NDCG@20': '0.0515'}
2025-03-04 00:14:51,491 - EarlyStopping counter: 2 out of 10
2025-03-04 00:15:28,435 - {'epoch': 47, 'rec_loss': '7.6112'}
2025-03-04 00:15:44,942 - {'Epoch': 47, 'HR@5': '0.0523', 'NDCG@5': '0.0366', 'HR@10': '0.0750', 'NDCG@10': '0.0439', 'HR@20': '0.1057', 'NDCG@20': '0.0516'}
2025-03-04 00:15:44,944 - EarlyStopping counter: 3 out of 10
2025-03-04 00:16:22,710 - {'epoch': 48, 'rec_loss': '7.6152'}
2025-03-04 00:16:39,589 - {'Epoch': 48, 'HR@5': '0.0521', 'NDCG@5': '0.0365', 'HR@10': '0.0746', 'NDCG@10': '0.0437', 'HR@20': '0.1053', 'NDCG@20': '0.0515'}
2025-03-04 00:16:39,590 - EarlyStopping counter: 4 out of 10
2025-03-04 00:17:19,435 - {'epoch': 49, 'rec_loss': '7.6103'}
2025-03-04 00:17:36,214 - {'Epoch': 49, 'HR@5': '0.0529', 'NDCG@5': '0.0372', 'HR@10': '0.0753', 'NDCG@10': '0.0444', 'HR@20': '0.1048', 'NDCG@20': '0.0518'}
2025-03-04 00:17:36,216 - EarlyStopping counter: 5 out of 10
2025-03-04 00:18:13,161 - {'epoch': 50, 'rec_loss': '7.6072'}
2025-03-04 00:18:30,838 - {'Epoch': 50, 'HR@5': '0.0525', 'NDCG@5': '0.0367', 'HR@10': '0.0751', 'NDCG@10': '0.0439', 'HR@20': '0.1057', 'NDCG@20': '0.0516'}
2025-03-04 00:18:30,839 - EarlyStopping counter: 6 out of 10
2025-03-04 00:19:13,478 - {'epoch': 51, 'rec_loss': '7.5954'}
2025-03-04 00:19:30,266 - {'Epoch': 51, 'HR@5': '0.0528', 'NDCG@5': '0.0369', 'HR@10': '0.0755', 'NDCG@10': '0.0442', 'HR@20': '0.1058', 'NDCG@20': '0.0518'}
2025-03-04 00:19:30,270 - EarlyStopping counter: 7 out of 10
2025-03-04 00:20:09,421 - {'epoch': 52, 'rec_loss': '7.5965'}
2025-03-04 00:20:29,629 - {'Epoch': 52, 'HR@5': '0.0531', 'NDCG@5': '0.0367', 'HR@10': '0.0746', 'NDCG@10': '0.0437', 'HR@20': '0.1067', 'NDCG@20': '0.0517'}
2025-03-04 00:20:29,632 - EarlyStopping counter: 8 out of 10
2025-03-04 00:21:06,507 - {'epoch': 53, 'rec_loss': '7.5977'}
2025-03-04 00:21:25,586 - {'Epoch': 53, 'HR@5': '0.0538', 'NDCG@5': '0.0373', 'HR@10': '0.0751', 'NDCG@10': '0.0442', 'HR@20': '0.1060', 'NDCG@20': '0.0519'}
2025-03-04 00:21:25,587 - Validation score increased.  Saving model ...
2025-03-04 00:22:04,460 - {'epoch': 54, 'rec_loss': '7.5870'}
2025-03-04 00:22:21,271 - {'Epoch': 54, 'HR@5': '0.0524', 'NDCG@5': '0.0369', 'HR@10': '0.0747', 'NDCG@10': '0.0441', 'HR@20': '0.1055', 'NDCG@20': '0.0519'}
2025-03-04 00:22:21,272 - EarlyStopping counter: 1 out of 10
2025-03-04 00:23:00,504 - {'epoch': 55, 'rec_loss': '7.5847'}
2025-03-04 00:23:19,646 - {'Epoch': 55, 'HR@5': '0.0530', 'NDCG@5': '0.0374', 'HR@10': '0.0749', 'NDCG@10': '0.0444', 'HR@20': '0.1065', 'NDCG@20': '0.0524'}
2025-03-04 00:23:19,647 - Validation score increased.  Saving model ...
2025-03-04 00:23:56,881 - {'epoch': 56, 'rec_loss': '7.5774'}
2025-03-04 00:24:16,665 - {'Epoch': 56, 'HR@5': '0.0526', 'NDCG@5': '0.0370', 'HR@10': '0.0757', 'NDCG@10': '0.0445', 'HR@20': '0.1051', 'NDCG@20': '0.0519'}
2025-03-04 00:24:16,666 - EarlyStopping counter: 1 out of 10
2025-03-04 00:24:53,516 - {'epoch': 57, 'rec_loss': '7.5793'}
2025-03-04 00:25:12,763 - {'Epoch': 57, 'HR@5': '0.0523', 'NDCG@5': '0.0364', 'HR@10': '0.0760', 'NDCG@10': '0.0441', 'HR@20': '0.1062', 'NDCG@20': '0.0516'}
2025-03-04 00:25:12,764 - EarlyStopping counter: 2 out of 10
2025-03-04 00:25:54,104 - {'epoch': 58, 'rec_loss': '7.5752'}
2025-03-04 00:26:13,438 - {'Epoch': 58, 'HR@5': '0.0533', 'NDCG@5': '0.0373', 'HR@10': '0.0757', 'NDCG@10': '0.0445', 'HR@20': '0.1051', 'NDCG@20': '0.0519'}
2025-03-04 00:26:13,440 - EarlyStopping counter: 3 out of 10
2025-03-04 00:26:50,985 - {'epoch': 59, 'rec_loss': '7.5723'}
2025-03-04 00:27:10,015 - {'Epoch': 59, 'HR@5': '0.0528', 'NDCG@5': '0.0370', 'HR@10': '0.0755', 'NDCG@10': '0.0443', 'HR@20': '0.1061', 'NDCG@20': '0.0520'}
2025-03-04 00:27:10,016 - EarlyStopping counter: 4 out of 10
2025-03-04 00:27:46,956 - {'epoch': 60, 'rec_loss': '7.5713'}
2025-03-04 00:28:05,761 - {'Epoch': 60, 'HR@5': '0.0535', 'NDCG@5': '0.0371', 'HR@10': '0.0757', 'NDCG@10': '0.0442', 'HR@20': '0.1054', 'NDCG@20': '0.0517'}
2025-03-04 00:28:05,762 - EarlyStopping counter: 5 out of 10
2025-03-04 00:28:42,694 - {'epoch': 61, 'rec_loss': '7.5654'}
2025-03-04 00:29:00,564 - {'Epoch': 61, 'HR@5': '0.0530', 'NDCG@5': '0.0370', 'HR@10': '0.0757', 'NDCG@10': '0.0443', 'HR@20': '0.1064', 'NDCG@20': '0.0520'}
2025-03-04 00:29:00,565 - EarlyStopping counter: 6 out of 10
2025-03-04 00:29:37,494 - {'epoch': 62, 'rec_loss': '7.5666'}
2025-03-04 00:29:56,330 - {'Epoch': 62, 'HR@5': '0.0529', 'NDCG@5': '0.0371', 'HR@10': '0.0755', 'NDCG@10': '0.0443', 'HR@20': '0.1059', 'NDCG@20': '0.0520'}
2025-03-04 00:29:56,332 - EarlyStopping counter: 7 out of 10
2025-03-04 00:30:33,295 - {'epoch': 63, 'rec_loss': '7.5607'}
2025-03-04 00:30:50,704 - {'Epoch': 63, 'HR@5': '0.0537', 'NDCG@5': '0.0375', 'HR@10': '0.0759', 'NDCG@10': '0.0446', 'HR@20': '0.1059', 'NDCG@20': '0.0521'}
2025-03-04 00:30:50,706 - EarlyStopping counter: 8 out of 10
2025-03-04 00:31:31,402 - {'epoch': 64, 'rec_loss': '7.5542'}
2025-03-04 00:31:48,346 - {'Epoch': 64, 'HR@5': '0.0535', 'NDCG@5': '0.0371', 'HR@10': '0.0755', 'NDCG@10': '0.0441', 'HR@20': '0.1064', 'NDCG@20': '0.0519'}
2025-03-04 00:31:48,348 - EarlyStopping counter: 9 out of 10
2025-03-04 00:32:31,997 - {'epoch': 65, 'rec_loss': '7.5595'}
2025-03-04 00:32:50,119 - {'Epoch': 65, 'HR@5': '0.0529', 'NDCG@5': '0.0371', 'HR@10': '0.0755', 'NDCG@10': '0.0443', 'HR@20': '0.1066', 'NDCG@20': '0.0521'}
2025-03-04 00:32:50,123 - EarlyStopping counter: 10 out of 10
2025-03-04 00:32:50,123 - Early stopping
2025-03-04 00:32:50,123 - ---------------Test Score---------------
2025-03-04 00:33:06,678 - {'Epoch': 0, 'HR@5': '0.0434', 'NDCG@5': '0.0298', 'HR@10': '0.0630', 'NDCG@10': '0.0361', 'HR@20': '0.0885', 'NDCG@20': '0.0425'}
2025-03-04 00:33:06,679 - Scale_Sports
2025-03-04 00:33:06,680 - {'Epoch': 0, 'HR@5': '0.0434', 'NDCG@5': '0.0298', 'HR@10': '0.0630', 'NDCG@10': '0.0361', 'HR@20': '0.0885', 'NDCG@20': '0.0425'}
2025-03-04 00:45:49,962 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 5], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-04 00:45:52,840 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-04 00:45:52,845 - Total Parameters: 1328529
2025-03-04 00:46:35,495 - {'epoch': 0, 'rec_loss': '9.4060'}
2025-03-04 00:46:52,024 - {'Epoch': 0, 'HR@5': '0.0081', 'NDCG@5': '0.0054', 'HR@10': '0.0125', 'NDCG@10': '0.0068', 'HR@20': '0.0211', 'NDCG@20': '0.0090'}
2025-03-04 00:46:52,025 - Validation score increased.  Saving model ...
2025-03-04 00:47:35,924 - {'epoch': 1, 'rec_loss': '9.2215'}
2025-03-04 00:47:52,038 - {'Epoch': 1, 'HR@5': '0.0128', 'NDCG@5': '0.0082', 'HR@10': '0.0217', 'NDCG@10': '0.0111', 'HR@20': '0.0371', 'NDCG@20': '0.0149'}
2025-03-04 00:47:52,039 - Validation score increased.  Saving model ...
2025-03-04 00:48:32,618 - {'epoch': 2, 'rec_loss': '8.9459'}
2025-03-04 00:48:49,071 - {'Epoch': 2, 'HR@5': '0.0174', 'NDCG@5': '0.0114', 'HR@10': '0.0301', 'NDCG@10': '0.0155', 'HR@20': '0.0485', 'NDCG@20': '0.0201'}
2025-03-04 00:48:49,072 - Validation score increased.  Saving model ...
2025-03-04 00:49:30,503 - {'epoch': 3, 'rec_loss': '8.7472'}
2025-03-04 00:49:46,744 - {'Epoch': 3, 'HR@5': '0.0253', 'NDCG@5': '0.0161', 'HR@10': '0.0398', 'NDCG@10': '0.0208', 'HR@20': '0.0615', 'NDCG@20': '0.0262'}
2025-03-04 00:49:46,745 - Validation score increased.  Saving model ...
2025-03-04 00:50:26,839 - {'epoch': 4, 'rec_loss': '8.5943'}
2025-03-04 00:50:43,225 - {'Epoch': 4, 'HR@5': '0.0324', 'NDCG@5': '0.0211', 'HR@10': '0.0480', 'NDCG@10': '0.0261', 'HR@20': '0.0724', 'NDCG@20': '0.0323'}
2025-03-04 00:50:43,227 - Validation score increased.  Saving model ...
2025-03-04 00:51:26,090 - {'epoch': 5, 'rec_loss': '8.4794'}
2025-03-04 00:51:42,660 - {'Epoch': 5, 'HR@5': '0.0351', 'NDCG@5': '0.0238', 'HR@10': '0.0531', 'NDCG@10': '0.0296', 'HR@20': '0.0787', 'NDCG@20': '0.0361'}
2025-03-04 00:51:42,663 - Validation score increased.  Saving model ...
2025-03-04 00:52:23,522 - {'epoch': 6, 'rec_loss': '8.3831'}
2025-03-04 00:52:39,807 - {'Epoch': 6, 'HR@5': '0.0388', 'NDCG@5': '0.0266', 'HR@10': '0.0570', 'NDCG@10': '0.0325', 'HR@20': '0.0824', 'NDCG@20': '0.0389'}
2025-03-04 00:52:39,808 - Validation score increased.  Saving model ...
2025-03-04 00:53:20,404 - {'epoch': 7, 'rec_loss': '8.3035'}
2025-03-04 00:53:37,369 - {'Epoch': 7, 'HR@5': '0.0410', 'NDCG@5': '0.0276', 'HR@10': '0.0605', 'NDCG@10': '0.0339', 'HR@20': '0.0868', 'NDCG@20': '0.0405'}
2025-03-04 00:53:37,372 - Validation score increased.  Saving model ...
2025-03-04 00:54:16,975 - {'epoch': 8, 'rec_loss': '8.2362'}
2025-03-04 00:54:33,416 - {'Epoch': 8, 'HR@5': '0.0427', 'NDCG@5': '0.0293', 'HR@10': '0.0637', 'NDCG@10': '0.0361', 'HR@20': '0.0905', 'NDCG@20': '0.0428'}
2025-03-04 00:54:33,419 - Validation score increased.  Saving model ...
2025-03-04 00:55:13,757 - {'epoch': 9, 'rec_loss': '8.1767'}
2025-03-04 00:55:30,108 - {'Epoch': 9, 'HR@5': '0.0455', 'NDCG@5': '0.0309', 'HR@10': '0.0644', 'NDCG@10': '0.0370', 'HR@20': '0.0923', 'NDCG@20': '0.0440'}
2025-03-04 00:55:30,109 - Validation score increased.  Saving model ...
2025-03-04 00:56:11,623 - {'epoch': 10, 'rec_loss': '8.1266'}
2025-03-04 00:56:27,945 - {'Epoch': 10, 'HR@5': '0.0455', 'NDCG@5': '0.0312', 'HR@10': '0.0669', 'NDCG@10': '0.0381', 'HR@20': '0.0944', 'NDCG@20': '0.0450'}
2025-03-04 00:56:27,946 - Validation score increased.  Saving model ...
2025-03-04 00:57:11,324 - {'epoch': 11, 'rec_loss': '8.0897'}
2025-03-04 00:57:27,508 - {'Epoch': 11, 'HR@5': '0.0463', 'NDCG@5': '0.0322', 'HR@10': '0.0667', 'NDCG@10': '0.0388', 'HR@20': '0.0965', 'NDCG@20': '0.0463'}
2025-03-04 00:57:27,511 - Validation score increased.  Saving model ...
2025-03-04 00:58:10,651 - {'epoch': 12, 'rec_loss': '8.0518'}
2025-03-04 00:58:26,902 - {'Epoch': 12, 'HR@5': '0.0473', 'NDCG@5': '0.0326', 'HR@10': '0.0682', 'NDCG@10': '0.0394', 'HR@20': '0.0973', 'NDCG@20': '0.0467'}
2025-03-04 00:58:26,903 - Validation score increased.  Saving model ...
2025-03-04 00:59:08,415 - {'epoch': 13, 'rec_loss': '8.0235'}
2025-03-04 00:59:24,840 - {'Epoch': 13, 'HR@5': '0.0488', 'NDCG@5': '0.0338', 'HR@10': '0.0698', 'NDCG@10': '0.0405', 'HR@20': '0.1000', 'NDCG@20': '0.0481'}
2025-03-04 00:59:24,841 - Validation score increased.  Saving model ...
2025-03-04 01:00:05,496 - {'epoch': 14, 'rec_loss': '7.9949'}
2025-03-04 01:00:22,129 - {'Epoch': 14, 'HR@5': '0.0486', 'NDCG@5': '0.0337', 'HR@10': '0.0705', 'NDCG@10': '0.0407', 'HR@20': '0.0989', 'NDCG@20': '0.0479'}
2025-03-04 01:00:22,133 - EarlyStopping counter: 1 out of 10
2025-03-04 01:01:02,485 - {'epoch': 15, 'rec_loss': '7.9645'}
2025-03-04 01:01:18,914 - {'Epoch': 15, 'HR@5': '0.0493', 'NDCG@5': '0.0345', 'HR@10': '0.0707', 'NDCG@10': '0.0414', 'HR@20': '0.0997', 'NDCG@20': '0.0488'}
2025-03-04 01:01:18,915 - Validation score increased.  Saving model ...
2025-03-04 01:01:59,709 - {'epoch': 16, 'rec_loss': '7.9401'}
2025-03-04 01:02:16,255 - {'Epoch': 16, 'HR@5': '0.0496', 'NDCG@5': '0.0343', 'HR@10': '0.0706', 'NDCG@10': '0.0411', 'HR@20': '0.1006', 'NDCG@20': '0.0486'}
2025-03-04 01:02:16,258 - EarlyStopping counter: 1 out of 10
2025-03-04 01:02:56,863 - {'epoch': 17, 'rec_loss': '7.9207'}
2025-03-04 01:03:13,385 - {'Epoch': 17, 'HR@5': '0.0486', 'NDCG@5': '0.0340', 'HR@10': '0.0717', 'NDCG@10': '0.0414', 'HR@20': '0.1012', 'NDCG@20': '0.0488'}
2025-03-04 01:03:13,386 - Validation score increased.  Saving model ...
2025-03-04 01:03:54,132 - {'epoch': 18, 'rec_loss': '7.8978'}
2025-03-04 01:04:10,512 - {'Epoch': 18, 'HR@5': '0.0500', 'NDCG@5': '0.0346', 'HR@10': '0.0720', 'NDCG@10': '0.0417', 'HR@20': '0.1010', 'NDCG@20': '0.0490'}
2025-03-04 01:04:10,515 - Validation score increased.  Saving model ...
2025-03-04 01:04:52,817 - {'epoch': 19, 'rec_loss': '7.8784'}
2025-03-04 01:05:09,271 - {'Epoch': 19, 'HR@5': '0.0503', 'NDCG@5': '0.0346', 'HR@10': '0.0723', 'NDCG@10': '0.0417', 'HR@20': '0.1018', 'NDCG@20': '0.0492'}
2025-03-04 01:05:09,272 - Validation score increased.  Saving model ...
2025-03-04 01:05:49,762 - {'epoch': 20, 'rec_loss': '7.8650'}
2025-03-04 01:06:06,146 - {'Epoch': 20, 'HR@5': '0.0501', 'NDCG@5': '0.0349', 'HR@10': '0.0731', 'NDCG@10': '0.0423', 'HR@20': '0.1023', 'NDCG@20': '0.0496'}
2025-03-04 01:06:06,147 - Validation score increased.  Saving model ...
2025-03-04 01:06:47,053 - {'epoch': 21, 'rec_loss': '7.8435'}
2025-03-04 01:07:03,565 - {'Epoch': 21, 'HR@5': '0.0506', 'NDCG@5': '0.0357', 'HR@10': '0.0729', 'NDCG@10': '0.0428', 'HR@20': '0.1040', 'NDCG@20': '0.0506'}
2025-03-04 01:07:03,570 - Validation score increased.  Saving model ...
2025-03-04 01:07:44,310 - {'epoch': 22, 'rec_loss': '7.8326'}
2025-03-04 01:08:00,962 - {'Epoch': 22, 'HR@5': '0.0504', 'NDCG@5': '0.0354', 'HR@10': '0.0720', 'NDCG@10': '0.0423', 'HR@20': '0.1025', 'NDCG@20': '0.0500'}
2025-03-04 01:08:00,966 - EarlyStopping counter: 1 out of 10
2025-03-04 01:08:42,499 - {'epoch': 23, 'rec_loss': '7.8193'}
2025-03-04 01:08:59,248 - {'Epoch': 23, 'HR@5': '0.0511', 'NDCG@5': '0.0358', 'HR@10': '0.0728', 'NDCG@10': '0.0428', 'HR@20': '0.1036', 'NDCG@20': '0.0505'}
2025-03-04 01:08:59,249 - EarlyStopping counter: 2 out of 10
2025-03-04 01:09:38,981 - {'epoch': 24, 'rec_loss': '7.8063'}
2025-03-04 01:09:55,160 - {'Epoch': 24, 'HR@5': '0.0512', 'NDCG@5': '0.0355', 'HR@10': '0.0732', 'NDCG@10': '0.0426', 'HR@20': '0.1041', 'NDCG@20': '0.0504'}
2025-03-04 01:09:55,161 - EarlyStopping counter: 3 out of 10
2025-03-04 01:10:36,682 - {'epoch': 25, 'rec_loss': '7.7942'}
2025-03-04 01:10:53,056 - {'Epoch': 25, 'HR@5': '0.0519', 'NDCG@5': '0.0362', 'HR@10': '0.0747', 'NDCG@10': '0.0434', 'HR@20': '0.1050', 'NDCG@20': '0.0511'}
2025-03-04 01:10:53,057 - Validation score increased.  Saving model ...
2025-03-04 01:11:33,606 - {'epoch': 26, 'rec_loss': '7.7796'}
2025-03-04 01:11:50,385 - {'Epoch': 26, 'HR@5': '0.0530', 'NDCG@5': '0.0364', 'HR@10': '0.0742', 'NDCG@10': '0.0432', 'HR@20': '0.1060', 'NDCG@20': '0.0513'}
2025-03-04 01:11:50,387 - Validation score increased.  Saving model ...
2025-03-04 01:12:31,325 - {'epoch': 27, 'rec_loss': '7.7652'}
2025-03-04 01:12:47,887 - {'Epoch': 27, 'HR@5': '0.0531', 'NDCG@5': '0.0368', 'HR@10': '0.0746', 'NDCG@10': '0.0437', 'HR@20': '0.1048', 'NDCG@20': '0.0513'}
2025-03-04 01:12:47,888 - Validation score increased.  Saving model ...
2025-03-04 01:13:28,738 - {'epoch': 28, 'rec_loss': '7.7516'}
2025-03-04 01:13:45,359 - {'Epoch': 28, 'HR@5': '0.0520', 'NDCG@5': '0.0362', 'HR@10': '0.0739', 'NDCG@10': '0.0432', 'HR@20': '0.1041', 'NDCG@20': '0.0508'}
2025-03-04 01:13:45,363 - EarlyStopping counter: 1 out of 10
2025-03-04 01:14:26,004 - {'epoch': 29, 'rec_loss': '7.7448'}
2025-03-04 01:14:42,734 - {'Epoch': 29, 'HR@5': '0.0524', 'NDCG@5': '0.0368', 'HR@10': '0.0746', 'NDCG@10': '0.0439', 'HR@20': '0.1054', 'NDCG@20': '0.0516'}
2025-03-04 01:14:42,735 - Validation score increased.  Saving model ...
2025-03-04 01:15:23,684 - {'epoch': 30, 'rec_loss': '7.7357'}
2025-03-04 01:15:40,106 - {'Epoch': 30, 'HR@5': '0.0517', 'NDCG@5': '0.0362', 'HR@10': '0.0742', 'NDCG@10': '0.0434', 'HR@20': '0.1045', 'NDCG@20': '0.0510'}
2025-03-04 01:15:40,109 - EarlyStopping counter: 1 out of 10
2025-03-04 01:16:21,043 - {'epoch': 31, 'rec_loss': '7.7272'}
2025-03-04 01:16:37,504 - {'Epoch': 31, 'HR@5': '0.0515', 'NDCG@5': '0.0361', 'HR@10': '0.0753', 'NDCG@10': '0.0437', 'HR@20': '0.1049', 'NDCG@20': '0.0511'}
2025-03-04 01:16:37,505 - EarlyStopping counter: 2 out of 10
2025-03-04 01:17:16,883 - {'epoch': 32, 'rec_loss': '7.7202'}
2025-03-04 01:17:33,557 - {'Epoch': 32, 'HR@5': '0.0515', 'NDCG@5': '0.0361', 'HR@10': '0.0736', 'NDCG@10': '0.0432', 'HR@20': '0.1041', 'NDCG@20': '0.0509'}
2025-03-04 01:17:33,558 - EarlyStopping counter: 3 out of 10
2025-03-04 01:18:15,115 - {'epoch': 33, 'rec_loss': '7.7067'}
2025-03-04 01:18:31,461 - {'Epoch': 33, 'HR@5': '0.0515', 'NDCG@5': '0.0360', 'HR@10': '0.0741', 'NDCG@10': '0.0433', 'HR@20': '0.1049', 'NDCG@20': '0.0510'}
2025-03-04 01:18:31,464 - EarlyStopping counter: 4 out of 10
2025-03-04 01:19:17,171 - {'epoch': 34, 'rec_loss': '7.7089'}
2025-03-04 01:19:33,679 - {'Epoch': 34, 'HR@5': '0.0517', 'NDCG@5': '0.0361', 'HR@10': '0.0746', 'NDCG@10': '0.0435', 'HR@20': '0.1050', 'NDCG@20': '0.0512'}
2025-03-04 01:19:33,682 - EarlyStopping counter: 5 out of 10
2025-03-04 01:20:14,177 - {'epoch': 35, 'rec_loss': '7.7005'}
2025-03-04 01:20:30,586 - {'Epoch': 35, 'HR@5': '0.0515', 'NDCG@5': '0.0358', 'HR@10': '0.0747', 'NDCG@10': '0.0433', 'HR@20': '0.1054', 'NDCG@20': '0.0510'}
2025-03-04 01:20:30,587 - EarlyStopping counter: 6 out of 10
2025-03-04 01:21:11,348 - {'epoch': 36, 'rec_loss': '7.6914'}
2025-03-04 01:21:28,452 - {'Epoch': 36, 'HR@5': '0.0520', 'NDCG@5': '0.0360', 'HR@10': '0.0743', 'NDCG@10': '0.0431', 'HR@20': '0.1049', 'NDCG@20': '0.0508'}
2025-03-04 01:21:28,453 - EarlyStopping counter: 7 out of 10
2025-03-04 01:22:06,847 - {'epoch': 37, 'rec_loss': '7.6863'}
2025-03-04 01:22:23,850 - {'Epoch': 37, 'HR@5': '0.0515', 'NDCG@5': '0.0362', 'HR@10': '0.0747', 'NDCG@10': '0.0437', 'HR@20': '0.1062', 'NDCG@20': '0.0516'}
2025-03-04 01:22:23,851 - EarlyStopping counter: 8 out of 10
2025-03-04 01:23:05,297 - {'epoch': 38, 'rec_loss': '7.6738'}
2025-03-04 01:23:22,217 - {'Epoch': 38, 'HR@5': '0.0519', 'NDCG@5': '0.0362', 'HR@10': '0.0766', 'NDCG@10': '0.0442', 'HR@20': '0.1071', 'NDCG@20': '0.0518'}
2025-03-04 01:23:22,218 - Validation score increased.  Saving model ...
2025-03-04 01:24:02,816 - {'epoch': 39, 'rec_loss': '7.6694'}
2025-03-04 01:24:19,425 - {'Epoch': 39, 'HR@5': '0.0517', 'NDCG@5': '0.0360', 'HR@10': '0.0748', 'NDCG@10': '0.0434', 'HR@20': '0.1055', 'NDCG@20': '0.0512'}
2025-03-04 01:24:19,426 - EarlyStopping counter: 1 out of 10
2025-03-04 01:25:00,316 - {'epoch': 40, 'rec_loss': '7.6623'}
2025-03-04 01:25:16,918 - {'Epoch': 40, 'HR@5': '0.0514', 'NDCG@5': '0.0358', 'HR@10': '0.0760', 'NDCG@10': '0.0438', 'HR@20': '0.1061', 'NDCG@20': '0.0513'}
2025-03-04 01:25:16,919 - EarlyStopping counter: 2 out of 10
2025-03-04 01:25:57,685 - {'epoch': 41, 'rec_loss': '7.6563'}
2025-03-04 01:26:13,893 - {'Epoch': 41, 'HR@5': '0.0517', 'NDCG@5': '0.0361', 'HR@10': '0.0762', 'NDCG@10': '0.0439', 'HR@20': '0.1061', 'NDCG@20': '0.0515'}
2025-03-04 01:26:13,894 - EarlyStopping counter: 3 out of 10
2025-03-04 01:26:54,600 - {'epoch': 42, 'rec_loss': '7.6521'}
2025-03-04 01:27:10,885 - {'Epoch': 42, 'HR@5': '0.0527', 'NDCG@5': '0.0366', 'HR@10': '0.0764', 'NDCG@10': '0.0442', 'HR@20': '0.1076', 'NDCG@20': '0.0521'}
2025-03-04 01:27:10,887 - Validation score increased.  Saving model ...
2025-03-04 01:27:51,552 - {'epoch': 43, 'rec_loss': '7.6490'}
2025-03-04 01:28:08,029 - {'Epoch': 43, 'HR@5': '0.0528', 'NDCG@5': '0.0364', 'HR@10': '0.0755', 'NDCG@10': '0.0438', 'HR@20': '0.1066', 'NDCG@20': '0.0516'}
2025-03-04 01:28:08,030 - EarlyStopping counter: 1 out of 10
2025-03-04 01:28:47,835 - {'epoch': 44, 'rec_loss': '7.6403'}
2025-03-04 01:29:04,555 - {'Epoch': 44, 'HR@5': '0.0532', 'NDCG@5': '0.0370', 'HR@10': '0.0761', 'NDCG@10': '0.0444', 'HR@20': '0.1063', 'NDCG@20': '0.0520'}
2025-03-04 01:29:04,556 - EarlyStopping counter: 2 out of 10
2025-03-04 01:29:45,929 - {'epoch': 45, 'rec_loss': '7.6356'}
2025-03-04 01:30:03,419 - {'Epoch': 45, 'HR@5': '0.0528', 'NDCG@5': '0.0365', 'HR@10': '0.0767', 'NDCG@10': '0.0442', 'HR@20': '0.1078', 'NDCG@20': '0.0520'}
2025-03-04 01:30:03,420 - EarlyStopping counter: 3 out of 10
2025-03-04 01:30:46,649 - {'epoch': 46, 'rec_loss': '7.6319'}
2025-03-04 01:31:03,674 - {'Epoch': 46, 'HR@5': '0.0530', 'NDCG@5': '0.0369', 'HR@10': '0.0760', 'NDCG@10': '0.0443', 'HR@20': '0.1069', 'NDCG@20': '0.0521'}
2025-03-04 01:31:03,675 - EarlyStopping counter: 4 out of 10
2025-03-04 01:31:48,397 - {'epoch': 47, 'rec_loss': '7.6340'}
2025-03-04 01:32:05,747 - {'Epoch': 47, 'HR@5': '0.0534', 'NDCG@5': '0.0368', 'HR@10': '0.0763', 'NDCG@10': '0.0442', 'HR@20': '0.1068', 'NDCG@20': '0.0519'}
2025-03-04 01:32:05,748 - EarlyStopping counter: 5 out of 10
2025-03-04 01:32:50,666 - {'epoch': 48, 'rec_loss': '7.6177'}
2025-03-04 01:33:07,092 - {'Epoch': 48, 'HR@5': '0.0535', 'NDCG@5': '0.0373', 'HR@10': '0.0767', 'NDCG@10': '0.0447', 'HR@20': '0.1070', 'NDCG@20': '0.0523'}
2025-03-04 01:33:07,093 - Validation score increased.  Saving model ...
2025-03-04 01:33:47,972 - {'epoch': 49, 'rec_loss': '7.6213'}
2025-03-04 01:34:04,845 - {'Epoch': 49, 'HR@5': '0.0535', 'NDCG@5': '0.0368', 'HR@10': '0.0758', 'NDCG@10': '0.0440', 'HR@20': '0.1074', 'NDCG@20': '0.0520'}
2025-03-04 01:34:04,850 - EarlyStopping counter: 1 out of 10
2025-03-04 01:34:45,275 - {'epoch': 50, 'rec_loss': '7.6189'}
2025-03-04 01:35:01,861 - {'Epoch': 50, 'HR@5': '0.0525', 'NDCG@5': '0.0364', 'HR@10': '0.0749', 'NDCG@10': '0.0436', 'HR@20': '0.1050', 'NDCG@20': '0.0512'}
2025-03-04 01:35:01,862 - EarlyStopping counter: 2 out of 10
2025-03-04 01:35:41,828 - {'epoch': 51, 'rec_loss': '7.6079'}
2025-03-04 01:35:58,620 - {'Epoch': 51, 'HR@5': '0.0517', 'NDCG@5': '0.0360', 'HR@10': '0.0755', 'NDCG@10': '0.0437', 'HR@20': '0.1063', 'NDCG@20': '0.0514'}
2025-03-04 01:35:58,621 - EarlyStopping counter: 3 out of 10
2025-03-04 01:36:39,476 - {'epoch': 52, 'rec_loss': '7.6033'}
2025-03-04 01:36:55,791 - {'Epoch': 52, 'HR@5': '0.0531', 'NDCG@5': '0.0366', 'HR@10': '0.0762', 'NDCG@10': '0.0440', 'HR@20': '0.1066', 'NDCG@20': '0.0516'}
2025-03-04 01:36:55,792 - EarlyStopping counter: 4 out of 10
2025-03-04 01:37:36,588 - {'epoch': 53, 'rec_loss': '7.6085'}
2025-03-04 01:37:53,224 - {'Epoch': 53, 'HR@5': '0.0522', 'NDCG@5': '0.0362', 'HR@10': '0.0752', 'NDCG@10': '0.0436', 'HR@20': '0.1063', 'NDCG@20': '0.0515'}
2025-03-04 01:37:53,225 - EarlyStopping counter: 5 out of 10
2025-03-04 01:38:34,341 - {'epoch': 54, 'rec_loss': '7.6002'}
2025-03-04 01:38:50,981 - {'Epoch': 54, 'HR@5': '0.0521', 'NDCG@5': '0.0362', 'HR@10': '0.0753', 'NDCG@10': '0.0437', 'HR@20': '0.1055', 'NDCG@20': '0.0513'}
2025-03-04 01:38:50,982 - EarlyStopping counter: 6 out of 10
2025-03-04 01:39:30,843 - {'epoch': 55, 'rec_loss': '7.5954'}
2025-03-04 01:39:47,390 - {'Epoch': 55, 'HR@5': '0.0537', 'NDCG@5': '0.0372', 'HR@10': '0.0752', 'NDCG@10': '0.0441', 'HR@20': '0.1065', 'NDCG@20': '0.0520'}
2025-03-04 01:39:47,391 - EarlyStopping counter: 7 out of 10
2025-03-04 01:40:27,351 - {'epoch': 56, 'rec_loss': '7.5928'}
2025-03-04 01:40:43,936 - {'Epoch': 56, 'HR@5': '0.0532', 'NDCG@5': '0.0366', 'HR@10': '0.0758', 'NDCG@10': '0.0439', 'HR@20': '0.1063', 'NDCG@20': '0.0516'}
2025-03-04 01:40:43,937 - EarlyStopping counter: 8 out of 10
2025-03-04 01:41:23,674 - {'epoch': 57, 'rec_loss': '7.5882'}
2025-03-04 01:41:40,571 - {'Epoch': 57, 'HR@5': '0.0517', 'NDCG@5': '0.0364', 'HR@10': '0.0747', 'NDCG@10': '0.0438', 'HR@20': '0.1057', 'NDCG@20': '0.0516'}
2025-03-04 01:41:40,572 - EarlyStopping counter: 9 out of 10
2025-03-04 01:42:20,449 - {'epoch': 58, 'rec_loss': '7.5871'}
2025-03-04 01:42:37,286 - {'Epoch': 58, 'HR@5': '0.0520', 'NDCG@5': '0.0364', 'HR@10': '0.0757', 'NDCG@10': '0.0440', 'HR@20': '0.1054', 'NDCG@20': '0.0515'}
2025-03-04 01:42:37,287 - EarlyStopping counter: 10 out of 10
2025-03-04 01:42:37,287 - Early stopping
2025-03-04 01:42:37,287 - ---------------Test Score---------------
2025-03-04 01:42:53,778 - {'Epoch': 0, 'HR@5': '0.0424', 'NDCG@5': '0.0299', 'HR@10': '0.0621', 'NDCG@10': '0.0362', 'HR@20': '0.0890', 'NDCG@20': '0.0430'}
2025-03-04 01:42:53,782 - Scale_Sports
2025-03-04 01:42:53,783 - {'Epoch': 0, 'HR@5': '0.0424', 'NDCG@5': '0.0299', 'HR@10': '0.0621', 'NDCG@10': '0.0362', 'HR@20': '0.0890', 'NDCG@20': '0.0430'}
2025-03-04 09:43:30,615 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[10, 5], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-04 09:43:33,455 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=5, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-04 09:43:33,460 - Total Parameters: 1328529
2025-03-04 09:44:14,700 - {'epoch': 0, 'rec_loss': '9.4046'}
2025-03-04 09:44:31,575 - {'Epoch': 0, 'HR@5': '0.0081', 'NDCG@5': '0.0054', 'HR@10': '0.0126', 'NDCG@10': '0.0068', 'HR@20': '0.0222', 'NDCG@20': '0.0092'}
2025-03-04 09:44:31,579 - Validation score increased.  Saving model ...
2025-03-04 09:45:12,306 - {'epoch': 1, 'rec_loss': '9.1877'}
2025-03-04 09:45:27,854 - {'Epoch': 1, 'HR@5': '0.0167', 'NDCG@5': '0.0105', 'HR@10': '0.0265', 'NDCG@10': '0.0136', 'HR@20': '0.0424', 'NDCG@20': '0.0176'}
2025-03-04 09:45:27,857 - Validation score increased.  Saving model ...
2025-03-04 09:46:08,546 - {'epoch': 2, 'rec_loss': '8.9184'}
2025-03-04 09:46:24,181 - {'Epoch': 2, 'HR@5': '0.0200', 'NDCG@5': '0.0130', 'HR@10': '0.0315', 'NDCG@10': '0.0168', 'HR@20': '0.0505', 'NDCG@20': '0.0215'}
2025-03-04 09:46:24,183 - Validation score increased.  Saving model ...
2025-03-04 09:47:03,979 - {'epoch': 3, 'rec_loss': '8.7306'}
2025-03-04 09:47:19,734 - {'Epoch': 3, 'HR@5': '0.0249', 'NDCG@5': '0.0161', 'HR@10': '0.0402', 'NDCG@10': '0.0210', 'HR@20': '0.0614', 'NDCG@20': '0.0264'}
2025-03-04 09:47:19,735 - Validation score increased.  Saving model ...
2025-03-04 09:47:58,290 - {'epoch': 4, 'rec_loss': '8.5883'}
2025-03-04 09:48:14,509 - {'Epoch': 4, 'HR@5': '0.0312', 'NDCG@5': '0.0206', 'HR@10': '0.0476', 'NDCG@10': '0.0258', 'HR@20': '0.0713', 'NDCG@20': '0.0318'}
2025-03-04 09:48:14,512 - Validation score increased.  Saving model ...
2025-03-04 09:48:55,786 - {'epoch': 5, 'rec_loss': '8.4741'}
2025-03-04 09:49:11,640 - {'Epoch': 5, 'HR@5': '0.0366', 'NDCG@5': '0.0246', 'HR@10': '0.0543', 'NDCG@10': '0.0302', 'HR@20': '0.0798', 'NDCG@20': '0.0366'}
2025-03-04 09:49:11,643 - Validation score increased.  Saving model ...
2025-03-04 09:49:52,593 - {'epoch': 6, 'rec_loss': '8.3790'}
2025-03-04 09:50:09,306 - {'Epoch': 6, 'HR@5': '0.0379', 'NDCG@5': '0.0258', 'HR@10': '0.0569', 'NDCG@10': '0.0319', 'HR@20': '0.0829', 'NDCG@20': '0.0385'}
2025-03-04 09:50:09,307 - Validation score increased.  Saving model ...
2025-03-04 09:50:50,525 - {'epoch': 7, 'rec_loss': '8.2963'}
2025-03-04 09:51:06,720 - {'Epoch': 7, 'HR@5': '0.0405', 'NDCG@5': '0.0277', 'HR@10': '0.0602', 'NDCG@10': '0.0341', 'HR@20': '0.0873', 'NDCG@20': '0.0409'}
2025-03-04 09:51:06,721 - Validation score increased.  Saving model ...
2025-03-04 09:51:46,478 - {'epoch': 8, 'rec_loss': '8.2355'}
2025-03-04 09:52:02,741 - {'Epoch': 8, 'HR@5': '0.0427', 'NDCG@5': '0.0296', 'HR@10': '0.0630', 'NDCG@10': '0.0361', 'HR@20': '0.0906', 'NDCG@20': '0.0430'}
2025-03-04 09:52:02,745 - Validation score increased.  Saving model ...
2025-03-04 09:52:41,678 - {'epoch': 9, 'rec_loss': '8.1753'}
2025-03-04 09:52:58,047 - {'Epoch': 9, 'HR@5': '0.0455', 'NDCG@5': '0.0312', 'HR@10': '0.0653', 'NDCG@10': '0.0376', 'HR@20': '0.0935', 'NDCG@20': '0.0447'}
2025-03-04 09:52:58,048 - Validation score increased.  Saving model ...
2025-03-04 09:53:37,034 - {'epoch': 10, 'rec_loss': '8.1257'}
2025-03-04 09:53:53,408 - {'Epoch': 10, 'HR@5': '0.0456', 'NDCG@5': '0.0312', 'HR@10': '0.0661', 'NDCG@10': '0.0378', 'HR@20': '0.0946', 'NDCG@20': '0.0450'}
2025-03-04 09:53:53,409 - Validation score increased.  Saving model ...
2025-03-04 09:54:34,780 - {'epoch': 11, 'rec_loss': '8.0801'}
2025-03-04 09:54:50,885 - {'Epoch': 11, 'HR@5': '0.0462', 'NDCG@5': '0.0318', 'HR@10': '0.0676', 'NDCG@10': '0.0387', 'HR@20': '0.0965', 'NDCG@20': '0.0460'}
2025-03-04 09:54:50,886 - Validation score increased.  Saving model ...
2025-03-04 09:55:30,533 - {'epoch': 12, 'rec_loss': '8.0459'}
2025-03-04 09:55:46,866 - {'Epoch': 12, 'HR@5': '0.0464', 'NDCG@5': '0.0322', 'HR@10': '0.0678', 'NDCG@10': '0.0391', 'HR@20': '0.0979', 'NDCG@20': '0.0467'}
2025-03-04 09:55:46,867 - Validation score increased.  Saving model ...
2025-03-04 09:56:27,714 - {'epoch': 13, 'rec_loss': '8.0141'}
2025-03-04 09:56:44,086 - {'Epoch': 13, 'HR@5': '0.0476', 'NDCG@5': '0.0328', 'HR@10': '0.0689', 'NDCG@10': '0.0397', 'HR@20': '0.0987', 'NDCG@20': '0.0472'}
2025-03-04 09:56:44,087 - Validation score increased.  Saving model ...
2025-03-04 09:57:24,462 - {'epoch': 14, 'rec_loss': '7.9862'}
2025-03-04 09:57:40,928 - {'Epoch': 14, 'HR@5': '0.0477', 'NDCG@5': '0.0329', 'HR@10': '0.0700', 'NDCG@10': '0.0401', 'HR@20': '0.1002', 'NDCG@20': '0.0477'}
2025-03-04 09:57:40,929 - Validation score increased.  Saving model ...
2025-03-04 09:58:20,911 - {'epoch': 15, 'rec_loss': '7.9610'}
2025-03-04 09:58:37,365 - {'Epoch': 15, 'HR@5': '0.0485', 'NDCG@5': '0.0335', 'HR@10': '0.0710', 'NDCG@10': '0.0408', 'HR@20': '0.1007', 'NDCG@20': '0.0482'}
2025-03-04 09:58:37,366 - Validation score increased.  Saving model ...
2025-03-04 09:59:15,933 - {'epoch': 16, 'rec_loss': '7.9334'}
2025-03-04 09:59:32,493 - {'Epoch': 16, 'HR@5': '0.0486', 'NDCG@5': '0.0336', 'HR@10': '0.0713', 'NDCG@10': '0.0409', 'HR@20': '0.1015', 'NDCG@20': '0.0485'}
2025-03-04 09:59:32,494 - Validation score increased.  Saving model ...
2025-03-04 10:00:14,085 - {'epoch': 17, 'rec_loss': '7.9140'}
2025-03-04 10:00:30,819 - {'Epoch': 17, 'HR@5': '0.0483', 'NDCG@5': '0.0336', 'HR@10': '0.0711', 'NDCG@10': '0.0409', 'HR@20': '0.1019', 'NDCG@20': '0.0487'}
2025-03-04 10:00:30,821 - Validation score increased.  Saving model ...
2025-03-04 10:01:10,643 - {'epoch': 18, 'rec_loss': '7.8918'}
2025-03-04 10:01:27,212 - {'Epoch': 18, 'HR@5': '0.0494', 'NDCG@5': '0.0338', 'HR@10': '0.0722', 'NDCG@10': '0.0411', 'HR@20': '0.1015', 'NDCG@20': '0.0485'}
2025-03-04 10:01:27,215 - EarlyStopping counter: 1 out of 10
2025-03-04 10:02:09,547 - {'epoch': 19, 'rec_loss': '7.8708'}
2025-03-04 10:02:26,183 - {'Epoch': 19, 'HR@5': '0.0503', 'NDCG@5': '0.0345', 'HR@10': '0.0725', 'NDCG@10': '0.0416', 'HR@20': '0.1028', 'NDCG@20': '0.0492'}
2025-03-04 10:02:26,184 - Validation score increased.  Saving model ...
2025-03-04 10:03:06,891 - {'epoch': 20, 'rec_loss': '7.8574'}
2025-03-04 10:03:23,429 - {'Epoch': 20, 'HR@5': '0.0497', 'NDCG@5': '0.0343', 'HR@10': '0.0726', 'NDCG@10': '0.0416', 'HR@20': '0.1031', 'NDCG@20': '0.0493'}
2025-03-04 10:03:23,430 - Validation score increased.  Saving model ...
2025-03-04 10:04:02,543 - {'epoch': 21, 'rec_loss': '7.8368'}
2025-03-04 10:04:19,115 - {'Epoch': 21, 'HR@5': '0.0490', 'NDCG@5': '0.0337', 'HR@10': '0.0717', 'NDCG@10': '0.0410', 'HR@20': '0.1021', 'NDCG@20': '0.0487'}
2025-03-04 10:04:19,117 - EarlyStopping counter: 1 out of 10
2025-03-04 10:04:59,344 - {'epoch': 22, 'rec_loss': '7.8268'}
2025-03-04 10:05:15,843 - {'Epoch': 22, 'HR@5': '0.0498', 'NDCG@5': '0.0344', 'HR@10': '0.0722', 'NDCG@10': '0.0416', 'HR@20': '0.1031', 'NDCG@20': '0.0494'}
2025-03-04 10:05:15,845 - Validation score increased.  Saving model ...
2025-03-04 10:05:54,789 - {'epoch': 23, 'rec_loss': '7.8133'}
2025-03-04 10:06:11,522 - {'Epoch': 23, 'HR@5': '0.0501', 'NDCG@5': '0.0346', 'HR@10': '0.0731', 'NDCG@10': '0.0420', 'HR@20': '0.1038', 'NDCG@20': '0.0498'}
2025-03-04 10:06:11,525 - Validation score increased.  Saving model ...
2025-03-04 10:06:52,593 - {'epoch': 24, 'rec_loss': '7.7999'}
2025-03-04 10:07:09,348 - {'Epoch': 24, 'HR@5': '0.0509', 'NDCG@5': '0.0351', 'HR@10': '0.0739', 'NDCG@10': '0.0425', 'HR@20': '0.1049', 'NDCG@20': '0.0503'}
2025-03-04 10:07:09,349 - Validation score increased.  Saving model ...
2025-03-04 10:07:49,843 - {'epoch': 25, 'rec_loss': '7.7853'}
2025-03-04 10:08:06,355 - {'Epoch': 25, 'HR@5': '0.0508', 'NDCG@5': '0.0348', 'HR@10': '0.0740', 'NDCG@10': '0.0423', 'HR@20': '0.1044', 'NDCG@20': '0.0500'}
2025-03-04 10:08:06,358 - EarlyStopping counter: 1 out of 10
2025-03-04 10:08:46,272 - {'epoch': 26, 'rec_loss': '7.7733'}
2025-03-04 10:09:02,869 - {'Epoch': 26, 'HR@5': '0.0503', 'NDCG@5': '0.0350', 'HR@10': '0.0731', 'NDCG@10': '0.0423', 'HR@20': '0.1028', 'NDCG@20': '0.0498'}
2025-03-04 10:09:02,870 - EarlyStopping counter: 2 out of 10
2025-03-04 10:09:42,164 - {'epoch': 27, 'rec_loss': '7.7642'}
2025-03-04 10:09:58,831 - {'Epoch': 27, 'HR@5': '0.0516', 'NDCG@5': '0.0356', 'HR@10': '0.0731', 'NDCG@10': '0.0425', 'HR@20': '0.1040', 'NDCG@20': '0.0503'}
2025-03-04 10:09:58,832 - EarlyStopping counter: 3 out of 10
2025-03-04 10:10:37,911 - {'epoch': 28, 'rec_loss': '7.7510'}
2025-03-04 10:10:54,623 - {'Epoch': 28, 'HR@5': '0.0519', 'NDCG@5': '0.0353', 'HR@10': '0.0737', 'NDCG@10': '0.0423', 'HR@20': '0.1045', 'NDCG@20': '0.0501'}
2025-03-04 10:10:54,624 - EarlyStopping counter: 4 out of 10
2025-03-04 10:11:35,447 - {'epoch': 29, 'rec_loss': '7.7399'}
2025-03-04 10:11:51,845 - {'Epoch': 29, 'HR@5': '0.0507', 'NDCG@5': '0.0352', 'HR@10': '0.0739', 'NDCG@10': '0.0428', 'HR@20': '0.1037', 'NDCG@20': '0.0502'}
2025-03-04 10:11:51,846 - EarlyStopping counter: 5 out of 10
2025-03-04 10:12:32,084 - {'epoch': 30, 'rec_loss': '7.7294'}
2025-03-04 10:12:48,591 - {'Epoch': 30, 'HR@5': '0.0520', 'NDCG@5': '0.0360', 'HR@10': '0.0748', 'NDCG@10': '0.0433', 'HR@20': '0.1043', 'NDCG@20': '0.0508'}
2025-03-04 10:12:48,592 - Validation score increased.  Saving model ...
2025-03-04 10:13:29,158 - {'epoch': 31, 'rec_loss': '7.7260'}
2025-03-04 10:13:45,839 - {'Epoch': 31, 'HR@5': '0.0511', 'NDCG@5': '0.0351', 'HR@10': '0.0742', 'NDCG@10': '0.0425', 'HR@20': '0.1048', 'NDCG@20': '0.0502'}
2025-03-04 10:13:45,840 - EarlyStopping counter: 1 out of 10
2025-03-04 10:14:27,422 - {'epoch': 32, 'rec_loss': '7.7138'}
2025-03-04 10:14:44,169 - {'Epoch': 32, 'HR@5': '0.0516', 'NDCG@5': '0.0354', 'HR@10': '0.0749', 'NDCG@10': '0.0429', 'HR@20': '0.1052', 'NDCG@20': '0.0505'}
2025-03-04 10:14:44,173 - EarlyStopping counter: 2 out of 10
2025-03-04 10:15:24,574 - {'epoch': 33, 'rec_loss': '7.7051'}
2025-03-04 10:15:41,999 - {'Epoch': 33, 'HR@5': '0.0517', 'NDCG@5': '0.0356', 'HR@10': '0.0748', 'NDCG@10': '0.0430', 'HR@20': '0.1058', 'NDCG@20': '0.0508'}
2025-03-04 10:15:42,001 - Validation score increased.  Saving model ...
2025-03-04 10:16:24,860 - {'epoch': 34, 'rec_loss': '7.7053'}
2025-03-04 10:16:41,906 - {'Epoch': 34, 'HR@5': '0.0523', 'NDCG@5': '0.0359', 'HR@10': '0.0742', 'NDCG@10': '0.0429', 'HR@20': '0.1053', 'NDCG@20': '0.0508'}
2025-03-04 10:16:41,907 - EarlyStopping counter: 1 out of 10
2025-03-04 10:17:26,190 - {'epoch': 35, 'rec_loss': '7.6904'}
2025-03-04 10:17:43,617 - {'Epoch': 35, 'HR@5': '0.0522', 'NDCG@5': '0.0358', 'HR@10': '0.0744', 'NDCG@10': '0.0429', 'HR@20': '0.1041', 'NDCG@20': '0.0504'}
2025-03-04 10:17:43,618 - EarlyStopping counter: 2 out of 10
2025-03-04 10:18:27,153 - {'epoch': 36, 'rec_loss': '7.6874'}
2025-03-04 10:18:43,951 - {'Epoch': 36, 'HR@5': '0.0522', 'NDCG@5': '0.0360', 'HR@10': '0.0751', 'NDCG@10': '0.0434', 'HR@20': '0.1053', 'NDCG@20': '0.0510'}
2025-03-04 10:18:43,952 - Validation score increased.  Saving model ...
2025-03-04 10:19:27,726 - {'epoch': 37, 'rec_loss': '7.6767'}
2025-03-04 10:19:45,327 - {'Epoch': 37, 'HR@5': '0.0524', 'NDCG@5': '0.0357', 'HR@10': '0.0746', 'NDCG@10': '0.0429', 'HR@20': '0.1049', 'NDCG@20': '0.0505'}
2025-03-04 10:19:45,328 - EarlyStopping counter: 1 out of 10
2025-03-04 10:20:27,174 - {'epoch': 38, 'rec_loss': '7.6700'}
2025-03-04 10:20:44,971 - {'Epoch': 38, 'HR@5': '0.0527', 'NDCG@5': '0.0363', 'HR@10': '0.0749', 'NDCG@10': '0.0435', 'HR@20': '0.1058', 'NDCG@20': '0.0512'}
2025-03-04 10:20:44,974 - Validation score increased.  Saving model ...
2025-03-04 10:21:26,074 - {'epoch': 39, 'rec_loss': '7.6600'}
2025-03-04 10:21:42,881 - {'Epoch': 39, 'HR@5': '0.0520', 'NDCG@5': '0.0356', 'HR@10': '0.0742', 'NDCG@10': '0.0427', 'HR@20': '0.1048', 'NDCG@20': '0.0504'}
2025-03-04 10:21:42,884 - EarlyStopping counter: 1 out of 10
2025-03-04 10:22:21,820 - {'epoch': 40, 'rec_loss': '7.6639'}
2025-03-04 10:22:38,565 - {'Epoch': 40, 'HR@5': '0.0520', 'NDCG@5': '0.0357', 'HR@10': '0.0750', 'NDCG@10': '0.0432', 'HR@20': '0.1056', 'NDCG@20': '0.0508'}
2025-03-04 10:22:38,566 - EarlyStopping counter: 2 out of 10
2025-03-04 10:23:17,367 - {'epoch': 41, 'rec_loss': '7.6497'}
2025-03-04 10:23:33,869 - {'Epoch': 41, 'HR@5': '0.0519', 'NDCG@5': '0.0362', 'HR@10': '0.0739', 'NDCG@10': '0.0433', 'HR@20': '0.1053', 'NDCG@20': '0.0512'}
2025-03-04 10:23:33,870 - Validation score increased.  Saving model ...
2025-03-04 10:24:16,581 - {'epoch': 42, 'rec_loss': '7.6521'}
2025-03-04 10:24:33,543 - {'Epoch': 42, 'HR@5': '0.0530', 'NDCG@5': '0.0365', 'HR@10': '0.0757', 'NDCG@10': '0.0438', 'HR@20': '0.1062', 'NDCG@20': '0.0516'}
2025-03-04 10:24:33,544 - Validation score increased.  Saving model ...
2025-03-04 10:25:14,313 - {'epoch': 43, 'rec_loss': '7.6458'}
2025-03-04 10:25:31,160 - {'Epoch': 43, 'HR@5': '0.0527', 'NDCG@5': '0.0362', 'HR@10': '0.0754', 'NDCG@10': '0.0435', 'HR@20': '0.1062', 'NDCG@20': '0.0512'}
2025-03-04 10:25:31,162 - EarlyStopping counter: 1 out of 10
2025-03-04 10:26:12,083 - {'epoch': 44, 'rec_loss': '7.6365'}
2025-03-04 10:26:28,566 - {'Epoch': 44, 'HR@5': '0.0524', 'NDCG@5': '0.0360', 'HR@10': '0.0740', 'NDCG@10': '0.0429', 'HR@20': '0.1062', 'NDCG@20': '0.0510'}
2025-03-04 10:26:28,567 - EarlyStopping counter: 2 out of 10
2025-03-04 10:27:09,041 - {'epoch': 45, 'rec_loss': '7.6295'}
2025-03-04 10:27:25,755 - {'Epoch': 45, 'HR@5': '0.0534', 'NDCG@5': '0.0364', 'HR@10': '0.0752', 'NDCG@10': '0.0434', 'HR@20': '0.1049', 'NDCG@20': '0.0509'}
2025-03-04 10:27:25,758 - EarlyStopping counter: 3 out of 10
2025-03-04 10:28:06,557 - {'epoch': 46, 'rec_loss': '7.6315'}
2025-03-04 10:28:23,850 - {'Epoch': 46, 'HR@5': '0.0528', 'NDCG@5': '0.0362', 'HR@10': '0.0749', 'NDCG@10': '0.0433', 'HR@20': '0.1055', 'NDCG@20': '0.0510'}
2025-03-04 10:28:23,851 - EarlyStopping counter: 4 out of 10
2025-03-04 10:29:04,090 - {'epoch': 47, 'rec_loss': '7.6310'}
2025-03-04 10:29:20,643 - {'Epoch': 47, 'HR@5': '0.0525', 'NDCG@5': '0.0364', 'HR@10': '0.0744', 'NDCG@10': '0.0434', 'HR@20': '0.1060', 'NDCG@20': '0.0514'}
2025-03-04 10:29:20,644 - EarlyStopping counter: 5 out of 10
2025-03-04 10:30:00,108 - {'epoch': 48, 'rec_loss': '7.6098'}
2025-03-04 10:30:16,627 - {'Epoch': 48, 'HR@5': '0.0519', 'NDCG@5': '0.0361', 'HR@10': '0.0749', 'NDCG@10': '0.0435', 'HR@20': '0.1051', 'NDCG@20': '0.0511'}
2025-03-04 10:30:16,631 - EarlyStopping counter: 6 out of 10
2025-03-04 10:30:58,317 - {'epoch': 49, 'rec_loss': '7.6133'}
2025-03-04 10:31:15,835 - {'Epoch': 49, 'HR@5': '0.0519', 'NDCG@5': '0.0361', 'HR@10': '0.0751', 'NDCG@10': '0.0436', 'HR@20': '0.1051', 'NDCG@20': '0.0511'}
2025-03-04 10:31:15,836 - EarlyStopping counter: 7 out of 10
2025-03-04 10:32:00,951 - {'epoch': 50, 'rec_loss': '7.6213'}
2025-03-04 10:32:18,363 - {'Epoch': 50, 'HR@5': '0.0525', 'NDCG@5': '0.0362', 'HR@10': '0.0750', 'NDCG@10': '0.0434', 'HR@20': '0.1059', 'NDCG@20': '0.0512'}
2025-03-04 10:32:18,364 - EarlyStopping counter: 8 out of 10
2025-03-04 10:33:00,109 - {'epoch': 51, 'rec_loss': '7.6069'}
2025-03-04 10:33:17,346 - {'Epoch': 51, 'HR@5': '0.0533', 'NDCG@5': '0.0368', 'HR@10': '0.0753', 'NDCG@10': '0.0439', 'HR@20': '0.1054', 'NDCG@20': '0.0515'}
2025-03-04 10:33:17,347 - EarlyStopping counter: 9 out of 10
2025-03-04 10:33:57,938 - {'epoch': 52, 'rec_loss': '7.6041'}
2025-03-04 10:34:14,186 - {'Epoch': 52, 'HR@5': '0.0530', 'NDCG@5': '0.0366', 'HR@10': '0.0753', 'NDCG@10': '0.0438', 'HR@20': '0.1060', 'NDCG@20': '0.0515'}
2025-03-04 10:34:14,189 - EarlyStopping counter: 10 out of 10
2025-03-04 10:34:14,189 - Early stopping
2025-03-04 10:34:14,189 - ---------------Test Score---------------
2025-03-04 10:34:30,919 - {'Epoch': 0, 'HR@5': '0.0433', 'NDCG@5': '0.0299', 'HR@10': '0.0630', 'NDCG@10': '0.0363', 'HR@20': '0.0873', 'NDCG@20': '0.0424'}
2025-03-04 10:34:30,925 - Scale_Sports
2025-03-04 10:34:30,925 - {'Epoch': 0, 'HR@5': '0.0433', 'NDCG@5': '0.0299', 'HR@10': '0.0630', 'NDCG@10': '0.0363', 'HR@20': '0.0873', 'NDCG@20': '0.0424'}
2025-03-05 23:30:05,988 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-05 23:30:08,991 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-05 23:30:08,996 - Total Parameters: 1328854
2025-03-05 23:30:48,751 - {'epoch': 0, 'rec_loss': '9.4063'}
2025-03-05 23:31:07,972 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0054', 'HR@10': '0.0129', 'NDCG@10': '0.0069', 'HR@20': '0.0216', 'NDCG@20': '0.0091'}
2025-03-05 23:31:07,980 - Validation score increased.  Saving model ...
2025-03-05 23:31:47,114 - {'epoch': 1, 'rec_loss': '9.2157'}
2025-03-05 23:32:05,506 - {'Epoch': 1, 'HR@5': '0.0124', 'NDCG@5': '0.0080', 'HR@10': '0.0207', 'NDCG@10': '0.0107', 'HR@20': '0.0351', 'NDCG@20': '0.0143'}
2025-03-05 23:32:05,511 - Validation score increased.  Saving model ...
2025-03-05 23:32:48,070 - {'epoch': 2, 'rec_loss': '8.9740'}
2025-03-05 23:33:05,925 - {'Epoch': 2, 'HR@5': '0.0171', 'NDCG@5': '0.0111', 'HR@10': '0.0283', 'NDCG@10': '0.0147', 'HR@20': '0.0456', 'NDCG@20': '0.0190'}
2025-03-05 23:33:05,926 - Validation score increased.  Saving model ...
2025-03-05 23:33:46,718 - {'epoch': 3, 'rec_loss': '8.8012'}
2025-03-05 23:34:05,503 - {'Epoch': 3, 'HR@5': '0.0212', 'NDCG@5': '0.0138', 'HR@10': '0.0349', 'NDCG@10': '0.0182', 'HR@20': '0.0553', 'NDCG@20': '0.0233'}
2025-03-05 23:34:05,505 - Validation score increased.  Saving model ...
2025-03-05 23:34:46,856 - {'epoch': 4, 'rec_loss': '8.6631'}
2025-03-05 23:35:05,597 - {'Epoch': 4, 'HR@5': '0.0264', 'NDCG@5': '0.0169', 'HR@10': '0.0412', 'NDCG@10': '0.0216', 'HR@20': '0.0638', 'NDCG@20': '0.0273'}
2025-03-05 23:35:05,599 - Validation score increased.  Saving model ...
2025-03-05 23:35:49,533 - {'epoch': 5, 'rec_loss': '8.5480'}
2025-03-05 23:36:07,768 - {'Epoch': 5, 'HR@5': '0.0315', 'NDCG@5': '0.0208', 'HR@10': '0.0481', 'NDCG@10': '0.0261', 'HR@20': '0.0722', 'NDCG@20': '0.0322'}
2025-03-05 23:36:07,775 - Validation score increased.  Saving model ...
2025-03-05 23:36:49,711 - {'epoch': 6, 'rec_loss': '8.4596'}
2025-03-05 23:37:07,616 - {'Epoch': 6, 'HR@5': '0.0332', 'NDCG@5': '0.0224', 'HR@10': '0.0509', 'NDCG@10': '0.0281', 'HR@20': '0.0755', 'NDCG@20': '0.0343'}
2025-03-05 23:37:07,617 - Validation score increased.  Saving model ...
2025-03-05 23:37:48,480 - {'epoch': 7, 'rec_loss': '8.3806'}
2025-03-05 23:38:06,293 - {'Epoch': 7, 'HR@5': '0.0371', 'NDCG@5': '0.0253', 'HR@10': '0.0546', 'NDCG@10': '0.0309', 'HR@20': '0.0787', 'NDCG@20': '0.0370'}
2025-03-05 23:38:06,297 - Validation score increased.  Saving model ...
2025-03-05 23:38:44,263 - {'epoch': 8, 'rec_loss': '8.3121'}
2025-03-05 23:39:02,465 - {'Epoch': 8, 'HR@5': '0.0386', 'NDCG@5': '0.0267', 'HR@10': '0.0571', 'NDCG@10': '0.0326', 'HR@20': '0.0818', 'NDCG@20': '0.0388'}
2025-03-05 23:39:02,467 - Validation score increased.  Saving model ...
2025-03-05 23:39:41,175 - {'epoch': 9, 'rec_loss': '8.2534'}
2025-03-05 23:39:59,604 - {'Epoch': 9, 'HR@5': '0.0405', 'NDCG@5': '0.0281', 'HR@10': '0.0589', 'NDCG@10': '0.0340', 'HR@20': '0.0848', 'NDCG@20': '0.0405'}
2025-03-05 23:39:59,605 - Validation score increased.  Saving model ...
2025-03-05 23:40:37,575 - {'epoch': 10, 'rec_loss': '8.2093'}
2025-03-05 23:40:56,293 - {'Epoch': 10, 'HR@5': '0.0417', 'NDCG@5': '0.0292', 'HR@10': '0.0600', 'NDCG@10': '0.0351', 'HR@20': '0.0867', 'NDCG@20': '0.0418'}
2025-03-05 23:40:56,295 - Validation score increased.  Saving model ...
2025-03-05 23:41:35,076 - {'epoch': 11, 'rec_loss': '8.1576'}
2025-03-05 23:41:53,771 - {'Epoch': 11, 'HR@5': '0.0431', 'NDCG@5': '0.0297', 'HR@10': '0.0627', 'NDCG@10': '0.0360', 'HR@20': '0.0880', 'NDCG@20': '0.0423'}
2025-03-05 23:41:53,772 - Validation score increased.  Saving model ...
2025-03-05 23:42:32,113 - {'epoch': 12, 'rec_loss': '8.1230'}
2025-03-05 23:42:51,277 - {'Epoch': 12, 'HR@5': '0.0444', 'NDCG@5': '0.0308', 'HR@10': '0.0627', 'NDCG@10': '0.0367', 'HR@20': '0.0896', 'NDCG@20': '0.0435'}
2025-03-05 23:42:51,279 - Validation score increased.  Saving model ...
2025-03-05 23:43:30,624 - {'epoch': 13, 'rec_loss': '8.0893'}
2025-03-05 23:43:48,975 - {'Epoch': 13, 'HR@5': '0.0441', 'NDCG@5': '0.0310', 'HR@10': '0.0636', 'NDCG@10': '0.0373', 'HR@20': '0.0919', 'NDCG@20': '0.0444'}
2025-03-05 23:43:48,978 - Validation score increased.  Saving model ...
2025-03-05 23:44:28,921 - {'epoch': 14, 'rec_loss': '8.0583'}
2025-03-05 23:44:46,791 - {'Epoch': 14, 'HR@5': '0.0458', 'NDCG@5': '0.0318', 'HR@10': '0.0651', 'NDCG@10': '0.0380', 'HR@20': '0.0933', 'NDCG@20': '0.0451'}
2025-03-05 23:44:46,796 - Validation score increased.  Saving model ...
2025-03-05 23:45:25,854 - {'epoch': 15, 'rec_loss': '8.0266'}
2025-03-05 23:45:44,395 - {'Epoch': 15, 'HR@5': '0.0459', 'NDCG@5': '0.0323', 'HR@10': '0.0664', 'NDCG@10': '0.0388', 'HR@20': '0.0935', 'NDCG@20': '0.0456'}
2025-03-05 23:45:44,396 - Validation score increased.  Saving model ...
2025-03-05 23:46:23,420 - {'epoch': 16, 'rec_loss': '8.0037'}
2025-03-05 23:46:41,963 - {'Epoch': 16, 'HR@5': '0.0466', 'NDCG@5': '0.0325', 'HR@10': '0.0660', 'NDCG@10': '0.0387', 'HR@20': '0.0948', 'NDCG@20': '0.0460'}
2025-03-05 23:46:41,972 - Validation score increased.  Saving model ...
2025-03-05 23:47:22,177 - {'epoch': 17, 'rec_loss': '7.9835'}
2025-03-05 23:47:40,806 - {'Epoch': 17, 'HR@5': '0.0466', 'NDCG@5': '0.0328', 'HR@10': '0.0657', 'NDCG@10': '0.0390', 'HR@20': '0.0944', 'NDCG@20': '0.0462'}
2025-03-05 23:47:40,810 - Validation score increased.  Saving model ...
2025-03-05 23:48:23,079 - {'epoch': 18, 'rec_loss': '7.9614'}
2025-03-05 23:48:42,070 - {'Epoch': 18, 'HR@5': '0.0480', 'NDCG@5': '0.0335', 'HR@10': '0.0676', 'NDCG@10': '0.0397', 'HR@20': '0.0965', 'NDCG@20': '0.0470'}
2025-03-05 23:48:42,072 - Validation score increased.  Saving model ...
2025-03-05 23:49:19,507 - {'epoch': 19, 'rec_loss': '7.9396'}
2025-03-05 23:49:38,069 - {'Epoch': 19, 'HR@5': '0.0484', 'NDCG@5': '0.0340', 'HR@10': '0.0682', 'NDCG@10': '0.0404', 'HR@20': '0.0966', 'NDCG@20': '0.0475'}
2025-03-05 23:49:38,074 - Validation score increased.  Saving model ...
2025-03-05 23:50:16,774 - {'epoch': 20, 'rec_loss': '7.9233'}
2025-03-05 23:50:35,551 - {'Epoch': 20, 'HR@5': '0.0480', 'NDCG@5': '0.0337', 'HR@10': '0.0686', 'NDCG@10': '0.0403', 'HR@20': '0.0969', 'NDCG@20': '0.0474'}
2025-03-05 23:50:35,558 - EarlyStopping counter: 1 out of 10
2025-03-05 23:51:14,346 - {'epoch': 21, 'rec_loss': '7.9017'}
2025-03-05 23:51:34,108 - {'Epoch': 21, 'HR@5': '0.0479', 'NDCG@5': '0.0331', 'HR@10': '0.0678', 'NDCG@10': '0.0395', 'HR@20': '0.0968', 'NDCG@20': '0.0468'}
2025-03-05 23:51:34,116 - EarlyStopping counter: 2 out of 10
2025-03-05 23:52:13,958 - {'epoch': 22, 'rec_loss': '7.8904'}
2025-03-05 23:52:33,220 - {'Epoch': 22, 'HR@5': '0.0484', 'NDCG@5': '0.0339', 'HR@10': '0.0687', 'NDCG@10': '0.0404', 'HR@20': '0.0960', 'NDCG@20': '0.0473'}
2025-03-05 23:52:33,223 - EarlyStopping counter: 3 out of 10
2025-03-05 23:53:11,946 - {'epoch': 23, 'rec_loss': '7.8768'}
2025-03-05 23:53:30,357 - {'Epoch': 23, 'HR@5': '0.0471', 'NDCG@5': '0.0332', 'HR@10': '0.0689', 'NDCG@10': '0.0403', 'HR@20': '0.0970', 'NDCG@20': '0.0473'}
2025-03-05 23:53:30,359 - EarlyStopping counter: 4 out of 10
2025-03-05 23:54:09,620 - {'epoch': 24, 'rec_loss': '7.8608'}
2025-03-05 23:54:28,315 - {'Epoch': 24, 'HR@5': '0.0484', 'NDCG@5': '0.0337', 'HR@10': '0.0694', 'NDCG@10': '0.0404', 'HR@20': '0.0972', 'NDCG@20': '0.0474'}
2025-03-05 23:54:28,319 - EarlyStopping counter: 5 out of 10
2025-03-05 23:55:06,734 - {'epoch': 25, 'rec_loss': '7.8488'}
2025-03-05 23:55:25,449 - {'Epoch': 25, 'HR@5': '0.0483', 'NDCG@5': '0.0337', 'HR@10': '0.0697', 'NDCG@10': '0.0406', 'HR@20': '0.0981', 'NDCG@20': '0.0477'}
2025-03-05 23:55:25,454 - Validation score increased.  Saving model ...
2025-03-05 23:56:05,765 - {'epoch': 26, 'rec_loss': '7.8382'}
2025-03-05 23:56:24,336 - {'Epoch': 26, 'HR@5': '0.0490', 'NDCG@5': '0.0345', 'HR@10': '0.0701', 'NDCG@10': '0.0413', 'HR@20': '0.0980', 'NDCG@20': '0.0483'}
2025-03-05 23:56:24,342 - Validation score increased.  Saving model ...
2025-03-05 23:57:04,884 - {'epoch': 27, 'rec_loss': '7.8227'}
2025-03-05 23:57:23,909 - {'Epoch': 27, 'HR@5': '0.0490', 'NDCG@5': '0.0340', 'HR@10': '0.0695', 'NDCG@10': '0.0406', 'HR@20': '0.0982', 'NDCG@20': '0.0478'}
2025-03-05 23:57:23,910 - EarlyStopping counter: 1 out of 10
2025-03-05 23:58:03,576 - {'epoch': 28, 'rec_loss': '7.8163'}
2025-03-05 23:58:22,218 - {'Epoch': 28, 'HR@5': '0.0493', 'NDCG@5': '0.0346', 'HR@10': '0.0695', 'NDCG@10': '0.0410', 'HR@20': '0.0998', 'NDCG@20': '0.0487'}
2025-03-05 23:58:22,222 - Validation score increased.  Saving model ...
2025-03-05 23:59:01,966 - {'epoch': 29, 'rec_loss': '7.8083'}
2025-03-05 23:59:20,590 - {'Epoch': 29, 'HR@5': '0.0492', 'NDCG@5': '0.0346', 'HR@10': '0.0704', 'NDCG@10': '0.0414', 'HR@20': '0.1001', 'NDCG@20': '0.0489'}
2025-03-05 23:59:20,592 - Validation score increased.  Saving model ...
2025-03-05 23:59:59,185 - {'epoch': 30, 'rec_loss': '7.8001'}
2025-03-06 00:00:18,075 - {'Epoch': 30, 'HR@5': '0.0493', 'NDCG@5': '0.0348', 'HR@10': '0.0708', 'NDCG@10': '0.0417', 'HR@20': '0.0995', 'NDCG@20': '0.0489'}
2025-03-06 00:00:18,081 - Validation score increased.  Saving model ...
2025-03-06 00:00:58,780 - {'epoch': 31, 'rec_loss': '7.7874'}
2025-03-06 00:01:17,412 - {'Epoch': 31, 'HR@5': '0.0495', 'NDCG@5': '0.0348', 'HR@10': '0.0709', 'NDCG@10': '0.0417', 'HR@20': '0.0991', 'NDCG@20': '0.0488'}
2025-03-06 00:01:17,421 - EarlyStopping counter: 1 out of 10
2025-03-06 00:01:56,518 - {'epoch': 32, 'rec_loss': '7.7772'}
2025-03-06 00:02:15,466 - {'Epoch': 32, 'HR@5': '0.0499', 'NDCG@5': '0.0347', 'HR@10': '0.0714', 'NDCG@10': '0.0416', 'HR@20': '0.0996', 'NDCG@20': '0.0487'}
2025-03-06 00:02:15,469 - EarlyStopping counter: 2 out of 10
2025-03-06 00:02:54,766 - {'epoch': 33, 'rec_loss': '7.7702'}
2025-03-06 00:03:13,597 - {'Epoch': 33, 'HR@5': '0.0510', 'NDCG@5': '0.0356', 'HR@10': '0.0715', 'NDCG@10': '0.0422', 'HR@20': '0.0997', 'NDCG@20': '0.0493'}
2025-03-06 00:03:13,598 - Validation score increased.  Saving model ...
2025-03-06 00:03:53,861 - {'epoch': 34, 'rec_loss': '7.7737'}
2025-03-06 00:04:13,707 - {'Epoch': 34, 'HR@5': '0.0499', 'NDCG@5': '0.0350', 'HR@10': '0.0716', 'NDCG@10': '0.0420', 'HR@20': '0.1002', 'NDCG@20': '0.0492'}
2025-03-06 00:04:13,708 - EarlyStopping counter: 1 out of 10
2025-03-06 00:04:52,798 - {'epoch': 35, 'rec_loss': '7.7600'}
2025-03-06 00:05:11,291 - {'Epoch': 35, 'HR@5': '0.0503', 'NDCG@5': '0.0353', 'HR@10': '0.0720', 'NDCG@10': '0.0423', 'HR@20': '0.1014', 'NDCG@20': '0.0497'}
2025-03-06 00:05:11,292 - Validation score increased.  Saving model ...
2025-03-06 00:05:51,076 - {'epoch': 36, 'rec_loss': '7.7565'}
2025-03-06 00:06:10,216 - {'Epoch': 36, 'HR@5': '0.0497', 'NDCG@5': '0.0349', 'HR@10': '0.0729', 'NDCG@10': '0.0424', 'HR@20': '0.1007', 'NDCG@20': '0.0494'}
2025-03-06 00:06:10,218 - EarlyStopping counter: 1 out of 10
2025-03-06 00:06:50,508 - {'epoch': 37, 'rec_loss': '7.7500'}
2025-03-06 00:07:09,851 - {'Epoch': 37, 'HR@5': '0.0510', 'NDCG@5': '0.0355', 'HR@10': '0.0718', 'NDCG@10': '0.0422', 'HR@20': '0.1007', 'NDCG@20': '0.0494'}
2025-03-06 00:07:09,855 - EarlyStopping counter: 2 out of 10
2025-03-06 00:07:50,212 - {'epoch': 38, 'rec_loss': '7.7380'}
2025-03-06 00:08:09,547 - {'Epoch': 38, 'HR@5': '0.0512', 'NDCG@5': '0.0355', 'HR@10': '0.0724', 'NDCG@10': '0.0424', 'HR@20': '0.1010', 'NDCG@20': '0.0496'}
2025-03-06 00:08:09,551 - EarlyStopping counter: 3 out of 10
2025-03-06 00:08:48,445 - {'epoch': 39, 'rec_loss': '7.7342'}
2025-03-06 00:09:07,344 - {'Epoch': 39, 'HR@5': '0.0510', 'NDCG@5': '0.0353', 'HR@10': '0.0723', 'NDCG@10': '0.0422', 'HR@20': '0.1018', 'NDCG@20': '0.0496'}
2025-03-06 00:09:07,350 - EarlyStopping counter: 4 out of 10
2025-03-06 00:09:49,666 - {'epoch': 40, 'rec_loss': '7.7286'}
2025-03-06 00:10:09,170 - {'Epoch': 40, 'HR@5': '0.0509', 'NDCG@5': '0.0356', 'HR@10': '0.0726', 'NDCG@10': '0.0426', 'HR@20': '0.1007', 'NDCG@20': '0.0496'}
2025-03-06 00:10:09,172 - EarlyStopping counter: 5 out of 10
2025-03-06 00:10:50,147 - {'epoch': 41, 'rec_loss': '7.7213'}
2025-03-06 00:11:10,002 - {'Epoch': 41, 'HR@5': '0.0509', 'NDCG@5': '0.0355', 'HR@10': '0.0725', 'NDCG@10': '0.0424', 'HR@20': '0.1007', 'NDCG@20': '0.0495'}
2025-03-06 00:11:10,004 - EarlyStopping counter: 6 out of 10
2025-03-06 00:11:51,213 - {'epoch': 42, 'rec_loss': '7.7183'}
2025-03-06 00:12:10,286 - {'Epoch': 42, 'HR@5': '0.0508', 'NDCG@5': '0.0355', 'HR@10': '0.0717', 'NDCG@10': '0.0422', 'HR@20': '0.0994', 'NDCG@20': '0.0492'}
2025-03-06 00:12:10,291 - EarlyStopping counter: 7 out of 10
2025-03-06 00:12:51,014 - {'epoch': 43, 'rec_loss': '7.7129'}
2025-03-06 00:13:09,752 - {'Epoch': 43, 'HR@5': '0.0503', 'NDCG@5': '0.0351', 'HR@10': '0.0717', 'NDCG@10': '0.0420', 'HR@20': '0.1003', 'NDCG@20': '0.0492'}
2025-03-06 00:13:09,754 - EarlyStopping counter: 8 out of 10
2025-03-06 00:13:50,531 - {'epoch': 44, 'rec_loss': '7.7071'}
2025-03-06 00:14:10,048 - {'Epoch': 44, 'HR@5': '0.0505', 'NDCG@5': '0.0351', 'HR@10': '0.0730', 'NDCG@10': '0.0424', 'HR@20': '0.1018', 'NDCG@20': '0.0496'}
2025-03-06 00:14:10,052 - EarlyStopping counter: 9 out of 10
2025-03-06 00:14:49,011 - {'epoch': 45, 'rec_loss': '7.7052'}
2025-03-06 00:15:08,128 - {'Epoch': 45, 'HR@5': '0.0499', 'NDCG@5': '0.0351', 'HR@10': '0.0714', 'NDCG@10': '0.0420', 'HR@20': '0.1005', 'NDCG@20': '0.0493'}
2025-03-06 00:15:08,132 - EarlyStopping counter: 10 out of 10
2025-03-06 00:15:08,132 - Early stopping
2025-03-06 00:15:08,132 - ---------------Test Score---------------
2025-03-06 00:15:26,862 - {'Epoch': 0, 'HR@5': '0.0411', 'NDCG@5': '0.0292', 'HR@10': '0.0580', 'NDCG@10': '0.0346', 'HR@20': '0.0815', 'NDCG@20': '0.0405'}
2025-03-06 00:15:26,867 - Scale_Sports
2025-03-06 00:15:26,867 - {'Epoch': 0, 'HR@5': '0.0411', 'NDCG@5': '0.0292', 'HR@10': '0.0580', 'NDCG@10': '0.0346', 'HR@20': '0.0815', 'NDCG@20': '0.0405'}
2025-03-06 10:55:20,300 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-06 10:55:23,557 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-06 10:55:23,563 - Total Parameters: 1328854
2025-03-06 10:55:59,778 - {'epoch': 0, 'rec_loss': '9.4022'}
2025-03-06 10:56:18,481 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0054', 'HR@10': '0.0126', 'NDCG@10': '0.0068', 'HR@20': '0.0217', 'NDCG@20': '0.0091'}
2025-03-06 10:56:18,482 - Validation score increased.  Saving model ...
2025-03-06 10:56:53,533 - {'epoch': 1, 'rec_loss': '9.1984'}
2025-03-06 10:57:12,507 - {'Epoch': 1, 'HR@5': '0.0142', 'NDCG@5': '0.0089', 'HR@10': '0.0230', 'NDCG@10': '0.0117', 'HR@20': '0.0391', 'NDCG@20': '0.0158'}
2025-03-06 10:57:12,509 - Validation score increased.  Saving model ...
2025-03-06 10:57:46,502 - {'epoch': 2, 'rec_loss': '8.9378'}
2025-03-06 10:58:05,282 - {'Epoch': 2, 'HR@5': '0.0171', 'NDCG@5': '0.0115', 'HR@10': '0.0299', 'NDCG@10': '0.0156', 'HR@20': '0.0485', 'NDCG@20': '0.0203'}
2025-03-06 10:58:05,284 - Validation score increased.  Saving model ...
2025-03-06 10:58:41,131 - {'epoch': 3, 'rec_loss': '8.7479'}
2025-03-06 10:59:00,752 - {'Epoch': 3, 'HR@5': '0.0265', 'NDCG@5': '0.0173', 'HR@10': '0.0410', 'NDCG@10': '0.0220', 'HR@20': '0.0621', 'NDCG@20': '0.0273'}
2025-03-06 10:59:00,756 - Validation score increased.  Saving model ...
2025-03-06 10:59:37,545 - {'epoch': 4, 'rec_loss': '8.5992'}
2025-03-06 10:59:56,593 - {'Epoch': 4, 'HR@5': '0.0299', 'NDCG@5': '0.0198', 'HR@10': '0.0472', 'NDCG@10': '0.0253', 'HR@20': '0.0710', 'NDCG@20': '0.0313'}
2025-03-06 10:59:56,594 - Validation score increased.  Saving model ...
2025-03-06 11:00:30,466 - {'epoch': 5, 'rec_loss': '8.4804'}
2025-03-06 11:00:49,485 - {'Epoch': 5, 'HR@5': '0.0369', 'NDCG@5': '0.0243', 'HR@10': '0.0530', 'NDCG@10': '0.0295', 'HR@20': '0.0783', 'NDCG@20': '0.0359'}
2025-03-06 11:00:49,487 - Validation score increased.  Saving model ...
2025-03-06 11:01:23,456 - {'epoch': 6, 'rec_loss': '8.3891'}
2025-03-06 11:01:42,747 - {'Epoch': 6, 'HR@5': '0.0384', 'NDCG@5': '0.0257', 'HR@10': '0.0570', 'NDCG@10': '0.0316', 'HR@20': '0.0822', 'NDCG@20': '0.0379'}
2025-03-06 11:01:42,748 - Validation score increased.  Saving model ...
2025-03-06 11:02:16,594 - {'epoch': 7, 'rec_loss': '8.3085'}
2025-03-06 11:02:35,216 - {'Epoch': 7, 'HR@5': '0.0403', 'NDCG@5': '0.0275', 'HR@10': '0.0590', 'NDCG@10': '0.0335', 'HR@20': '0.0858', 'NDCG@20': '0.0402'}
2025-03-06 11:02:35,217 - Validation score increased.  Saving model ...
2025-03-06 11:03:09,779 - {'epoch': 8, 'rec_loss': '8.2417'}
2025-03-06 11:03:28,647 - {'Epoch': 8, 'HR@5': '0.0426', 'NDCG@5': '0.0291', 'HR@10': '0.0617', 'NDCG@10': '0.0353', 'HR@20': '0.0890', 'NDCG@20': '0.0422'}
2025-03-06 11:03:28,650 - Validation score increased.  Saving model ...
2025-03-06 11:04:03,178 - {'epoch': 9, 'rec_loss': '8.1858'}
2025-03-06 11:04:22,036 - {'Epoch': 9, 'HR@5': '0.0430', 'NDCG@5': '0.0299', 'HR@10': '0.0628', 'NDCG@10': '0.0363', 'HR@20': '0.0914', 'NDCG@20': '0.0435'}
2025-03-06 11:04:22,037 - Validation score increased.  Saving model ...
2025-03-06 11:04:56,785 - {'epoch': 10, 'rec_loss': '8.1409'}
2025-03-06 11:05:16,076 - {'Epoch': 10, 'HR@5': '0.0441', 'NDCG@5': '0.0306', 'HR@10': '0.0633', 'NDCG@10': '0.0368', 'HR@20': '0.0910', 'NDCG@20': '0.0437'}
2025-03-06 11:05:16,077 - Validation score increased.  Saving model ...
2025-03-06 11:05:51,089 - {'epoch': 11, 'rec_loss': '8.0958'}
2025-03-06 11:06:10,054 - {'Epoch': 11, 'HR@5': '0.0456', 'NDCG@5': '0.0313', 'HR@10': '0.0658', 'NDCG@10': '0.0378', 'HR@20': '0.0941', 'NDCG@20': '0.0449'}
2025-03-06 11:06:10,056 - Validation score increased.  Saving model ...
2025-03-06 11:06:45,185 - {'epoch': 12, 'rec_loss': '8.0581'}
2025-03-06 11:07:04,135 - {'Epoch': 12, 'HR@5': '0.0465', 'NDCG@5': '0.0324', 'HR@10': '0.0666', 'NDCG@10': '0.0388', 'HR@20': '0.0964', 'NDCG@20': '0.0463'}
2025-03-06 11:07:04,138 - Validation score increased.  Saving model ...
2025-03-06 11:07:39,295 - {'epoch': 13, 'rec_loss': '8.0277'}
2025-03-06 11:07:58,177 - {'Epoch': 13, 'HR@5': '0.0463', 'NDCG@5': '0.0321', 'HR@10': '0.0678', 'NDCG@10': '0.0389', 'HR@20': '0.0966', 'NDCG@20': '0.0462'}
2025-03-06 11:07:58,180 - EarlyStopping counter: 1 out of 10
2025-03-06 11:08:32,238 - {'epoch': 14, 'rec_loss': '8.0003'}
2025-03-06 11:08:51,948 - {'Epoch': 14, 'HR@5': '0.0479', 'NDCG@5': '0.0332', 'HR@10': '0.0699', 'NDCG@10': '0.0402', 'HR@20': '0.0984', 'NDCG@20': '0.0474'}
2025-03-06 11:08:51,951 - Validation score increased.  Saving model ...
2025-03-06 11:09:25,462 - {'epoch': 15, 'rec_loss': '7.9693'}
2025-03-06 11:09:44,445 - {'Epoch': 15, 'HR@5': '0.0480', 'NDCG@5': '0.0335', 'HR@10': '0.0690', 'NDCG@10': '0.0403', 'HR@20': '0.0994', 'NDCG@20': '0.0479'}
2025-03-06 11:09:44,446 - Validation score increased.  Saving model ...
2025-03-06 11:10:19,422 - {'epoch': 16, 'rec_loss': '7.9488'}
2025-03-06 11:10:38,766 - {'Epoch': 16, 'HR@5': '0.0485', 'NDCG@5': '0.0334', 'HR@10': '0.0694', 'NDCG@10': '0.0401', 'HR@20': '0.0988', 'NDCG@20': '0.0475'}
2025-03-06 11:10:38,770 - EarlyStopping counter: 1 out of 10
2025-03-06 11:11:13,281 - {'epoch': 17, 'rec_loss': '7.9269'}
2025-03-06 11:11:32,183 - {'Epoch': 17, 'HR@5': '0.0487', 'NDCG@5': '0.0338', 'HR@10': '0.0700', 'NDCG@10': '0.0407', 'HR@20': '0.0993', 'NDCG@20': '0.0481'}
2025-03-06 11:11:32,185 - Validation score increased.  Saving model ...
2025-03-06 11:12:06,651 - {'epoch': 18, 'rec_loss': '7.9046'}
2025-03-06 11:12:26,483 - {'Epoch': 18, 'HR@5': '0.0501', 'NDCG@5': '0.0344', 'HR@10': '0.0720', 'NDCG@10': '0.0414', 'HR@20': '0.1011', 'NDCG@20': '0.0487'}
2025-03-06 11:12:26,487 - Validation score increased.  Saving model ...
2025-03-06 11:13:02,420 - {'epoch': 19, 'rec_loss': '7.8843'}
2025-03-06 11:13:21,610 - {'Epoch': 19, 'HR@5': '0.0499', 'NDCG@5': '0.0346', 'HR@10': '0.0707', 'NDCG@10': '0.0413', 'HR@20': '0.1008', 'NDCG@20': '0.0489'}
2025-03-06 11:13:21,611 - Validation score increased.  Saving model ...
2025-03-06 11:13:56,965 - {'epoch': 20, 'rec_loss': '7.8706'}
2025-03-06 11:14:16,008 - {'Epoch': 20, 'HR@5': '0.0515', 'NDCG@5': '0.0352', 'HR@10': '0.0740', 'NDCG@10': '0.0425', 'HR@20': '0.1023', 'NDCG@20': '0.0496'}
2025-03-06 11:14:16,011 - Validation score increased.  Saving model ...
2025-03-06 11:14:50,836 - {'epoch': 21, 'rec_loss': '7.8482'}
2025-03-06 11:15:09,994 - {'Epoch': 21, 'HR@5': '0.0493', 'NDCG@5': '0.0340', 'HR@10': '0.0715', 'NDCG@10': '0.0412', 'HR@20': '0.1009', 'NDCG@20': '0.0486'}
2025-03-06 11:15:09,996 - EarlyStopping counter: 1 out of 10
2025-03-06 11:15:44,343 - {'epoch': 22, 'rec_loss': '7.8368'}
2025-03-06 11:16:03,403 - {'Epoch': 22, 'HR@5': '0.0497', 'NDCG@5': '0.0345', 'HR@10': '0.0715', 'NDCG@10': '0.0416', 'HR@20': '0.1023', 'NDCG@20': '0.0493'}
2025-03-06 11:16:03,405 - EarlyStopping counter: 2 out of 10
2025-03-06 11:16:38,041 - {'epoch': 23, 'rec_loss': '7.8202'}
2025-03-06 11:16:57,208 - {'Epoch': 23, 'HR@5': '0.0499', 'NDCG@5': '0.0344', 'HR@10': '0.0728', 'NDCG@10': '0.0417', 'HR@20': '0.1023', 'NDCG@20': '0.0492'}
2025-03-06 11:16:57,210 - EarlyStopping counter: 3 out of 10
2025-03-06 11:17:31,695 - {'epoch': 24, 'rec_loss': '7.8088'}
2025-03-06 11:17:50,713 - {'Epoch': 24, 'HR@5': '0.0499', 'NDCG@5': '0.0348', 'HR@10': '0.0728', 'NDCG@10': '0.0421', 'HR@20': '0.1026', 'NDCG@20': '0.0497'}
2025-03-06 11:17:50,716 - Validation score increased.  Saving model ...
2025-03-06 11:18:25,154 - {'epoch': 25, 'rec_loss': '7.7906'}
2025-03-06 11:18:44,114 - {'Epoch': 25, 'HR@5': '0.0502', 'NDCG@5': '0.0350', 'HR@10': '0.0738', 'NDCG@10': '0.0426', 'HR@20': '0.1039', 'NDCG@20': '0.0502'}
2025-03-06 11:18:44,117 - Validation score increased.  Saving model ...
2025-03-06 11:19:18,994 - {'epoch': 26, 'rec_loss': '7.7793'}
2025-03-06 11:19:38,346 - {'Epoch': 26, 'HR@5': '0.0506', 'NDCG@5': '0.0355', 'HR@10': '0.0734', 'NDCG@10': '0.0429', 'HR@20': '0.1044', 'NDCG@20': '0.0507'}
2025-03-06 11:19:38,347 - Validation score increased.  Saving model ...
2025-03-06 11:20:13,009 - {'epoch': 27, 'rec_loss': '7.7651'}
2025-03-06 11:20:32,041 - {'Epoch': 27, 'HR@5': '0.0512', 'NDCG@5': '0.0356', 'HR@10': '0.0741', 'NDCG@10': '0.0429', 'HR@20': '0.1041', 'NDCG@20': '0.0505'}
2025-03-06 11:20:32,042 - EarlyStopping counter: 1 out of 10
2025-03-06 11:21:07,267 - {'epoch': 28, 'rec_loss': '7.7579'}
2025-03-06 11:21:26,308 - {'Epoch': 28, 'HR@5': '0.0514', 'NDCG@5': '0.0359', 'HR@10': '0.0740', 'NDCG@10': '0.0432', 'HR@20': '0.1040', 'NDCG@20': '0.0507'}
2025-03-06 11:21:26,311 - Validation score increased.  Saving model ...
2025-03-06 11:22:00,617 - {'epoch': 29, 'rec_loss': '7.7474'}
2025-03-06 11:22:20,606 - {'Epoch': 29, 'HR@5': '0.0514', 'NDCG@5': '0.0356', 'HR@10': '0.0746', 'NDCG@10': '0.0431', 'HR@20': '0.1049', 'NDCG@20': '0.0507'}
2025-03-06 11:22:20,610 - Validation score increased.  Saving model ...
2025-03-06 11:22:56,536 - {'epoch': 30, 'rec_loss': '7.7421'}
2025-03-06 11:23:15,715 - {'Epoch': 30, 'HR@5': '0.0516', 'NDCG@5': '0.0357', 'HR@10': '0.0734', 'NDCG@10': '0.0428', 'HR@20': '0.1044', 'NDCG@20': '0.0506'}
2025-03-06 11:23:15,716 - EarlyStopping counter: 1 out of 10
2025-03-06 11:23:50,597 - {'epoch': 31, 'rec_loss': '7.7298'}
2025-03-06 11:24:09,960 - {'Epoch': 31, 'HR@5': '0.0506', 'NDCG@5': '0.0352', 'HR@10': '0.0736', 'NDCG@10': '0.0427', 'HR@20': '0.1041', 'NDCG@20': '0.0503'}
2025-03-06 11:24:09,963 - EarlyStopping counter: 2 out of 10
2025-03-06 11:24:45,590 - {'epoch': 32, 'rec_loss': '7.7171'}
2025-03-06 11:25:04,898 - {'Epoch': 32, 'HR@5': '0.0511', 'NDCG@5': '0.0352', 'HR@10': '0.0749', 'NDCG@10': '0.0429', 'HR@20': '0.1042', 'NDCG@20': '0.0503'}
2025-03-06 11:25:04,900 - EarlyStopping counter: 3 out of 10
2025-03-06 11:25:39,367 - {'epoch': 33, 'rec_loss': '7.7102'}
2025-03-06 11:25:58,518 - {'Epoch': 33, 'HR@5': '0.0519', 'NDCG@5': '0.0359', 'HR@10': '0.0747', 'NDCG@10': '0.0432', 'HR@20': '0.1053', 'NDCG@20': '0.0509'}
2025-03-06 11:25:58,521 - Validation score increased.  Saving model ...
2025-03-06 11:26:32,825 - {'epoch': 34, 'rec_loss': '7.7088'}
2025-03-06 11:26:51,633 - {'Epoch': 34, 'HR@5': '0.0526', 'NDCG@5': '0.0362', 'HR@10': '0.0739', 'NDCG@10': '0.0430', 'HR@20': '0.1056', 'NDCG@20': '0.0510'}
2025-03-06 11:26:51,635 - Validation score increased.  Saving model ...
2025-03-06 11:27:26,521 - {'epoch': 35, 'rec_loss': '7.6952'}
2025-03-06 11:27:45,465 - {'Epoch': 35, 'HR@5': '0.0521', 'NDCG@5': '0.0361', 'HR@10': '0.0747', 'NDCG@10': '0.0434', 'HR@20': '0.1064', 'NDCG@20': '0.0514'}
2025-03-06 11:27:45,469 - Validation score increased.  Saving model ...
2025-03-06 11:28:19,392 - {'epoch': 36, 'rec_loss': '7.6901'}
2025-03-06 11:28:38,592 - {'Epoch': 36, 'HR@5': '0.0515', 'NDCG@5': '0.0360', 'HR@10': '0.0756', 'NDCG@10': '0.0438', 'HR@20': '0.1058', 'NDCG@20': '0.0514'}
2025-03-06 11:28:38,593 - Validation score increased.  Saving model ...
2025-03-06 11:29:12,892 - {'epoch': 37, 'rec_loss': '7.6814'}
2025-03-06 11:29:32,002 - {'Epoch': 37, 'HR@5': '0.0527', 'NDCG@5': '0.0364', 'HR@10': '0.0753', 'NDCG@10': '0.0436', 'HR@20': '0.1054', 'NDCG@20': '0.0512'}
2025-03-06 11:29:32,003 - EarlyStopping counter: 1 out of 10
2025-03-06 11:30:06,265 - {'epoch': 38, 'rec_loss': '7.6717'}
2025-03-06 11:30:25,302 - {'Epoch': 38, 'HR@5': '0.0527', 'NDCG@5': '0.0366', 'HR@10': '0.0753', 'NDCG@10': '0.0438', 'HR@20': '0.1056', 'NDCG@20': '0.0515'}
2025-03-06 11:30:25,304 - Validation score increased.  Saving model ...
2025-03-06 11:30:59,391 - {'epoch': 39, 'rec_loss': '7.6668'}
2025-03-06 11:31:18,390 - {'Epoch': 39, 'HR@5': '0.0519', 'NDCG@5': '0.0364', 'HR@10': '0.0752', 'NDCG@10': '0.0438', 'HR@20': '0.1060', 'NDCG@20': '0.0516'}
2025-03-06 11:31:18,392 - Validation score increased.  Saving model ...
2025-03-06 11:31:52,508 - {'epoch': 40, 'rec_loss': '7.6619'}
2025-03-06 11:32:11,379 - {'Epoch': 40, 'HR@5': '0.0522', 'NDCG@5': '0.0363', 'HR@10': '0.0753', 'NDCG@10': '0.0438', 'HR@20': '0.1051', 'NDCG@20': '0.0513'}
2025-03-06 11:32:11,380 - EarlyStopping counter: 1 out of 10
2025-03-06 11:32:45,233 - {'epoch': 41, 'rec_loss': '7.6515'}
2025-03-06 11:33:04,216 - {'Epoch': 41, 'HR@5': '0.0517', 'NDCG@5': '0.0359', 'HR@10': '0.0752', 'NDCG@10': '0.0435', 'HR@20': '0.1058', 'NDCG@20': '0.0512'}
2025-03-06 11:33:04,217 - EarlyStopping counter: 2 out of 10
2025-03-06 11:33:38,528 - {'epoch': 42, 'rec_loss': '7.6497'}
2025-03-06 11:33:57,719 - {'Epoch': 42, 'HR@5': '0.0528', 'NDCG@5': '0.0364', 'HR@10': '0.0760', 'NDCG@10': '0.0439', 'HR@20': '0.1058', 'NDCG@20': '0.0514'}
2025-03-06 11:33:57,721 - EarlyStopping counter: 3 out of 10
2025-03-06 11:34:31,706 - {'epoch': 43, 'rec_loss': '7.6462'}
2025-03-06 11:34:50,814 - {'Epoch': 43, 'HR@5': '0.0526', 'NDCG@5': '0.0360', 'HR@10': '0.0758', 'NDCG@10': '0.0436', 'HR@20': '0.1051', 'NDCG@20': '0.0509'}
2025-03-06 11:34:50,815 - EarlyStopping counter: 4 out of 10
2025-03-06 11:35:24,604 - {'epoch': 44, 'rec_loss': '7.6405'}
2025-03-06 11:35:43,745 - {'Epoch': 44, 'HR@5': '0.0527', 'NDCG@5': '0.0359', 'HR@10': '0.0765', 'NDCG@10': '0.0436', 'HR@20': '0.1063', 'NDCG@20': '0.0511'}
2025-03-06 11:35:43,749 - EarlyStopping counter: 5 out of 10
2025-03-06 11:36:18,194 - {'epoch': 45, 'rec_loss': '7.6373'}
2025-03-06 11:36:37,984 - {'Epoch': 45, 'HR@5': '0.0522', 'NDCG@5': '0.0362', 'HR@10': '0.0751', 'NDCG@10': '0.0435', 'HR@20': '0.1055', 'NDCG@20': '0.0512'}
2025-03-06 11:36:37,988 - EarlyStopping counter: 6 out of 10
2025-03-06 11:37:12,820 - {'epoch': 46, 'rec_loss': '7.6351'}
2025-03-06 11:37:32,179 - {'Epoch': 46, 'HR@5': '0.0521', 'NDCG@5': '0.0361', 'HR@10': '0.0755', 'NDCG@10': '0.0436', 'HR@20': '0.1051', 'NDCG@20': '0.0511'}
2025-03-06 11:37:32,180 - EarlyStopping counter: 7 out of 10
2025-03-06 11:38:06,489 - {'epoch': 47, 'rec_loss': '7.6310'}
2025-03-06 11:38:26,838 - {'Epoch': 47, 'HR@5': '0.0527', 'NDCG@5': '0.0364', 'HR@10': '0.0761', 'NDCG@10': '0.0439', 'HR@20': '0.1063', 'NDCG@20': '0.0515'}
2025-03-06 11:38:26,839 - EarlyStopping counter: 8 out of 10
2025-03-06 11:39:01,761 - {'epoch': 48, 'rec_loss': '7.6201'}
2025-03-06 11:39:20,924 - {'Epoch': 48, 'HR@5': '0.0524', 'NDCG@5': '0.0361', 'HR@10': '0.0758', 'NDCG@10': '0.0437', 'HR@20': '0.1067', 'NDCG@20': '0.0515'}
2025-03-06 11:39:20,925 - EarlyStopping counter: 9 out of 10
2025-03-06 11:39:55,243 - {'epoch': 49, 'rec_loss': '7.6198'}
2025-03-06 11:40:14,598 - {'Epoch': 49, 'HR@5': '0.0523', 'NDCG@5': '0.0363', 'HR@10': '0.0753', 'NDCG@10': '0.0437', 'HR@20': '0.1065', 'NDCG@20': '0.0516'}
2025-03-06 11:40:14,599 - EarlyStopping counter: 10 out of 10
2025-03-06 11:40:14,599 - Early stopping
2025-03-06 11:40:14,599 - ---------------Test Score---------------
2025-03-06 11:40:33,119 - {'Epoch': 0, 'HR@5': '0.0433', 'NDCG@5': '0.0298', 'HR@10': '0.0614', 'NDCG@10': '0.0356', 'HR@20': '0.0881', 'NDCG@20': '0.0424'}
2025-03-06 11:40:33,120 - Scale_Sports
2025-03-06 11:40:33,120 - {'Epoch': 0, 'HR@5': '0.0433', 'NDCG@5': '0.0298', 'HR@10': '0.0614', 'NDCG@10': '0.0356', 'HR@20': '0.0881', 'NDCG@20': '0.0424'}
2025-03-06 13:57:29,056 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-06 13:57:32,354 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-06 13:57:32,359 - Total Parameters: 1328854
2025-03-06 13:58:11,971 - {'epoch': 0, 'rec_loss': '9.4022'}
2025-03-06 13:58:31,179 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0054', 'HR@10': '0.0126', 'NDCG@10': '0.0068', 'HR@20': '0.0217', 'NDCG@20': '0.0091'}
2025-03-06 13:58:31,181 - Validation score increased.  Saving model ...
2025-03-06 13:59:13,031 - {'epoch': 1, 'rec_loss': '9.1984'}
2025-03-06 13:59:31,418 - {'Epoch': 1, 'HR@5': '0.0142', 'NDCG@5': '0.0089', 'HR@10': '0.0230', 'NDCG@10': '0.0117', 'HR@20': '0.0391', 'NDCG@20': '0.0158'}
2025-03-06 13:59:31,421 - Validation score increased.  Saving model ...
2025-03-06 14:00:10,226 - {'epoch': 2, 'rec_loss': '8.9378'}
2025-03-06 14:00:28,273 - {'Epoch': 2, 'HR@5': '0.0171', 'NDCG@5': '0.0115', 'HR@10': '0.0299', 'NDCG@10': '0.0156', 'HR@20': '0.0485', 'NDCG@20': '0.0203'}
2025-03-06 14:00:28,277 - Validation score increased.  Saving model ...
2025-03-06 14:01:04,270 - {'epoch': 3, 'rec_loss': '8.7479'}
2025-03-06 14:01:22,862 - {'Epoch': 3, 'HR@5': '0.0265', 'NDCG@5': '0.0173', 'HR@10': '0.0410', 'NDCG@10': '0.0220', 'HR@20': '0.0621', 'NDCG@20': '0.0273'}
2025-03-06 14:01:22,863 - Validation score increased.  Saving model ...
2025-03-06 14:01:59,292 - {'epoch': 4, 'rec_loss': '8.5992'}
2025-03-06 14:02:17,736 - {'Epoch': 4, 'HR@5': '0.0299', 'NDCG@5': '0.0198', 'HR@10': '0.0472', 'NDCG@10': '0.0253', 'HR@20': '0.0710', 'NDCG@20': '0.0313'}
2025-03-06 14:02:17,737 - Validation score increased.  Saving model ...
2025-03-06 14:02:52,987 - {'epoch': 5, 'rec_loss': '8.4804'}
2025-03-06 14:03:11,881 - {'Epoch': 5, 'HR@5': '0.0369', 'NDCG@5': '0.0243', 'HR@10': '0.0530', 'NDCG@10': '0.0295', 'HR@20': '0.0783', 'NDCG@20': '0.0359'}
2025-03-06 14:03:11,882 - Validation score increased.  Saving model ...
2025-03-06 14:03:46,397 - {'epoch': 6, 'rec_loss': '8.3891'}
2025-03-06 14:04:04,501 - {'Epoch': 6, 'HR@5': '0.0384', 'NDCG@5': '0.0257', 'HR@10': '0.0570', 'NDCG@10': '0.0316', 'HR@20': '0.0822', 'NDCG@20': '0.0379'}
2025-03-06 14:04:04,503 - Validation score increased.  Saving model ...
2025-03-06 14:04:40,746 - {'epoch': 7, 'rec_loss': '8.3085'}
2025-03-06 14:04:59,124 - {'Epoch': 7, 'HR@5': '0.0403', 'NDCG@5': '0.0275', 'HR@10': '0.0590', 'NDCG@10': '0.0335', 'HR@20': '0.0858', 'NDCG@20': '0.0402'}
2025-03-06 14:04:59,127 - Validation score increased.  Saving model ...
2025-03-06 14:05:35,735 - {'epoch': 8, 'rec_loss': '8.2417'}
2025-03-06 14:05:54,669 - {'Epoch': 8, 'HR@5': '0.0426', 'NDCG@5': '0.0291', 'HR@10': '0.0617', 'NDCG@10': '0.0353', 'HR@20': '0.0890', 'NDCG@20': '0.0422'}
2025-03-06 14:05:54,673 - Validation score increased.  Saving model ...
2025-03-06 14:06:29,186 - {'epoch': 9, 'rec_loss': '8.1858'}
2025-03-06 14:06:47,820 - {'Epoch': 9, 'HR@5': '0.0430', 'NDCG@5': '0.0299', 'HR@10': '0.0628', 'NDCG@10': '0.0363', 'HR@20': '0.0914', 'NDCG@20': '0.0435'}
2025-03-06 14:06:47,821 - Validation score increased.  Saving model ...
2025-03-06 14:07:27,848 - {'epoch': 10, 'rec_loss': '8.1409'}
2025-03-06 14:07:46,956 - {'Epoch': 10, 'HR@5': '0.0441', 'NDCG@5': '0.0306', 'HR@10': '0.0633', 'NDCG@10': '0.0368', 'HR@20': '0.0910', 'NDCG@20': '0.0437'}
2025-03-06 14:07:46,959 - Validation score increased.  Saving model ...
2025-03-06 14:08:24,652 - {'epoch': 11, 'rec_loss': '8.0958'}
2025-03-06 14:08:43,186 - {'Epoch': 11, 'HR@5': '0.0456', 'NDCG@5': '0.0313', 'HR@10': '0.0658', 'NDCG@10': '0.0378', 'HR@20': '0.0941', 'NDCG@20': '0.0449'}
2025-03-06 14:08:43,188 - Validation score increased.  Saving model ...
2025-03-06 14:09:19,992 - {'epoch': 12, 'rec_loss': '8.0581'}
2025-03-06 14:09:38,451 - {'Epoch': 12, 'HR@5': '0.0465', 'NDCG@5': '0.0324', 'HR@10': '0.0666', 'NDCG@10': '0.0388', 'HR@20': '0.0964', 'NDCG@20': '0.0463'}
2025-03-06 14:09:38,454 - Validation score increased.  Saving model ...
2025-03-06 14:10:18,888 - {'epoch': 13, 'rec_loss': '8.0277'}
2025-03-06 14:10:38,047 - {'Epoch': 13, 'HR@5': '0.0463', 'NDCG@5': '0.0321', 'HR@10': '0.0678', 'NDCG@10': '0.0389', 'HR@20': '0.0966', 'NDCG@20': '0.0462'}
2025-03-06 14:10:38,050 - EarlyStopping counter: 1 out of 10
2025-03-06 14:11:16,972 - {'epoch': 14, 'rec_loss': '8.0003'}
2025-03-06 14:11:35,961 - {'Epoch': 14, 'HR@5': '0.0479', 'NDCG@5': '0.0332', 'HR@10': '0.0699', 'NDCG@10': '0.0402', 'HR@20': '0.0984', 'NDCG@20': '0.0474'}
2025-03-06 14:11:35,962 - Validation score increased.  Saving model ...
2025-03-06 14:12:13,241 - {'epoch': 15, 'rec_loss': '7.9693'}
2025-03-06 14:12:32,089 - {'Epoch': 15, 'HR@5': '0.0480', 'NDCG@5': '0.0335', 'HR@10': '0.0690', 'NDCG@10': '0.0403', 'HR@20': '0.0994', 'NDCG@20': '0.0479'}
2025-03-06 14:12:32,093 - Validation score increased.  Saving model ...
2025-03-06 14:13:10,515 - {'epoch': 16, 'rec_loss': '7.9488'}
2025-03-06 14:13:29,380 - {'Epoch': 16, 'HR@5': '0.0485', 'NDCG@5': '0.0334', 'HR@10': '0.0694', 'NDCG@10': '0.0401', 'HR@20': '0.0988', 'NDCG@20': '0.0475'}
2025-03-06 14:13:29,383 - EarlyStopping counter: 1 out of 10
2025-03-06 14:14:08,150 - {'epoch': 17, 'rec_loss': '7.9269'}
2025-03-06 14:14:27,230 - {'Epoch': 17, 'HR@5': '0.0487', 'NDCG@5': '0.0338', 'HR@10': '0.0700', 'NDCG@10': '0.0407', 'HR@20': '0.0993', 'NDCG@20': '0.0481'}
2025-03-06 14:14:27,233 - Validation score increased.  Saving model ...
2025-03-06 14:15:04,237 - {'epoch': 18, 'rec_loss': '7.9046'}
2025-03-06 14:15:23,634 - {'Epoch': 18, 'HR@5': '0.0501', 'NDCG@5': '0.0344', 'HR@10': '0.0720', 'NDCG@10': '0.0414', 'HR@20': '0.1011', 'NDCG@20': '0.0487'}
2025-03-06 14:15:23,637 - Validation score increased.  Saving model ...
2025-03-06 14:16:02,299 - {'epoch': 19, 'rec_loss': '7.8843'}
2025-03-06 14:16:21,197 - {'Epoch': 19, 'HR@5': '0.0499', 'NDCG@5': '0.0346', 'HR@10': '0.0707', 'NDCG@10': '0.0413', 'HR@20': '0.1008', 'NDCG@20': '0.0489'}
2025-03-06 14:16:21,198 - Validation score increased.  Saving model ...
2025-03-06 14:16:58,148 - {'epoch': 20, 'rec_loss': '7.8706'}
2025-03-06 14:17:17,096 - {'Epoch': 20, 'HR@5': '0.0515', 'NDCG@5': '0.0352', 'HR@10': '0.0740', 'NDCG@10': '0.0425', 'HR@20': '0.1023', 'NDCG@20': '0.0496'}
2025-03-06 14:17:17,099 - Validation score increased.  Saving model ...
2025-03-06 14:17:53,024 - {'epoch': 21, 'rec_loss': '7.8482'}
2025-03-06 14:18:12,043 - {'Epoch': 21, 'HR@5': '0.0493', 'NDCG@5': '0.0340', 'HR@10': '0.0715', 'NDCG@10': '0.0412', 'HR@20': '0.1009', 'NDCG@20': '0.0486'}
2025-03-06 14:18:12,046 - EarlyStopping counter: 1 out of 10
2025-03-06 14:18:50,950 - {'epoch': 22, 'rec_loss': '7.8368'}
2025-03-06 14:19:10,195 - {'Epoch': 22, 'HR@5': '0.0497', 'NDCG@5': '0.0345', 'HR@10': '0.0715', 'NDCG@10': '0.0416', 'HR@20': '0.1023', 'NDCG@20': '0.0493'}
2025-03-06 14:19:10,197 - EarlyStopping counter: 2 out of 10
2025-03-06 14:19:48,282 - {'epoch': 23, 'rec_loss': '7.8202'}
2025-03-06 14:20:07,342 - {'Epoch': 23, 'HR@5': '0.0499', 'NDCG@5': '0.0344', 'HR@10': '0.0728', 'NDCG@10': '0.0417', 'HR@20': '0.1023', 'NDCG@20': '0.0492'}
2025-03-06 14:20:07,343 - EarlyStopping counter: 3 out of 10
2025-03-06 14:20:45,249 - {'epoch': 24, 'rec_loss': '7.8088'}
2025-03-06 14:21:04,180 - {'Epoch': 24, 'HR@5': '0.0499', 'NDCG@5': '0.0348', 'HR@10': '0.0728', 'NDCG@10': '0.0421', 'HR@20': '0.1026', 'NDCG@20': '0.0497'}
2025-03-06 14:21:04,183 - Validation score increased.  Saving model ...
2025-03-06 14:21:45,490 - {'epoch': 25, 'rec_loss': '7.7906'}
2025-03-06 14:22:04,859 - {'Epoch': 25, 'HR@5': '0.0502', 'NDCG@5': '0.0350', 'HR@10': '0.0738', 'NDCG@10': '0.0426', 'HR@20': '0.1039', 'NDCG@20': '0.0502'}
2025-03-06 14:22:04,862 - Validation score increased.  Saving model ...
2025-03-06 14:22:45,358 - {'epoch': 26, 'rec_loss': '7.7793'}
2025-03-06 14:23:04,876 - {'Epoch': 26, 'HR@5': '0.0506', 'NDCG@5': '0.0355', 'HR@10': '0.0734', 'NDCG@10': '0.0429', 'HR@20': '0.1044', 'NDCG@20': '0.0507'}
2025-03-06 14:23:04,878 - Validation score increased.  Saving model ...
2025-03-06 14:23:42,377 - {'epoch': 27, 'rec_loss': '7.7651'}
2025-03-06 14:24:01,592 - {'Epoch': 27, 'HR@5': '0.0512', 'NDCG@5': '0.0356', 'HR@10': '0.0741', 'NDCG@10': '0.0429', 'HR@20': '0.1041', 'NDCG@20': '0.0505'}
2025-03-06 14:24:01,595 - EarlyStopping counter: 1 out of 10
2025-03-06 14:24:40,038 - {'epoch': 28, 'rec_loss': '7.7579'}
2025-03-06 14:24:59,316 - {'Epoch': 28, 'HR@5': '0.0514', 'NDCG@5': '0.0359', 'HR@10': '0.0740', 'NDCG@10': '0.0432', 'HR@20': '0.1040', 'NDCG@20': '0.0507'}
2025-03-06 14:24:59,317 - Validation score increased.  Saving model ...
2025-03-06 14:25:39,670 - {'epoch': 29, 'rec_loss': '7.7474'}
2025-03-06 14:25:58,854 - {'Epoch': 29, 'HR@5': '0.0514', 'NDCG@5': '0.0356', 'HR@10': '0.0746', 'NDCG@10': '0.0431', 'HR@20': '0.1049', 'NDCG@20': '0.0507'}
2025-03-06 14:25:58,855 - Validation score increased.  Saving model ...
2025-03-06 14:26:37,511 - {'epoch': 30, 'rec_loss': '7.7421'}
2025-03-06 14:26:56,784 - {'Epoch': 30, 'HR@5': '0.0516', 'NDCG@5': '0.0357', 'HR@10': '0.0734', 'NDCG@10': '0.0428', 'HR@20': '0.1044', 'NDCG@20': '0.0506'}
2025-03-06 14:26:56,785 - EarlyStopping counter: 1 out of 10
2025-03-06 14:27:37,073 - {'epoch': 31, 'rec_loss': '7.7298'}
2025-03-06 14:27:56,704 - {'Epoch': 31, 'HR@5': '0.0506', 'NDCG@5': '0.0352', 'HR@10': '0.0736', 'NDCG@10': '0.0427', 'HR@20': '0.1041', 'NDCG@20': '0.0503'}
2025-03-06 14:27:56,709 - EarlyStopping counter: 2 out of 10
2025-03-06 14:28:35,628 - {'epoch': 32, 'rec_loss': '7.7171'}
2025-03-06 14:28:54,936 - {'Epoch': 32, 'HR@5': '0.0511', 'NDCG@5': '0.0352', 'HR@10': '0.0749', 'NDCG@10': '0.0429', 'HR@20': '0.1042', 'NDCG@20': '0.0503'}
2025-03-06 14:28:54,940 - EarlyStopping counter: 3 out of 10
2025-03-06 14:29:33,318 - {'epoch': 33, 'rec_loss': '7.7102'}
2025-03-06 14:29:52,280 - {'Epoch': 33, 'HR@5': '0.0519', 'NDCG@5': '0.0359', 'HR@10': '0.0747', 'NDCG@10': '0.0432', 'HR@20': '0.1053', 'NDCG@20': '0.0509'}
2025-03-06 14:29:52,284 - Validation score increased.  Saving model ...
2025-03-06 14:30:30,578 - {'epoch': 34, 'rec_loss': '7.7088'}
2025-03-06 14:30:50,032 - {'Epoch': 34, 'HR@5': '0.0526', 'NDCG@5': '0.0362', 'HR@10': '0.0739', 'NDCG@10': '0.0430', 'HR@20': '0.1056', 'NDCG@20': '0.0510'}
2025-03-06 14:30:50,033 - Validation score increased.  Saving model ...
2025-03-06 14:31:28,026 - {'epoch': 35, 'rec_loss': '7.6952'}
2025-03-06 14:31:46,934 - {'Epoch': 35, 'HR@5': '0.0521', 'NDCG@5': '0.0361', 'HR@10': '0.0747', 'NDCG@10': '0.0434', 'HR@20': '0.1064', 'NDCG@20': '0.0514'}
2025-03-06 14:31:46,935 - Validation score increased.  Saving model ...
2025-03-06 14:32:24,259 - {'epoch': 36, 'rec_loss': '7.6901'}
2025-03-06 14:32:43,146 - {'Epoch': 36, 'HR@5': '0.0515', 'NDCG@5': '0.0360', 'HR@10': '0.0756', 'NDCG@10': '0.0438', 'HR@20': '0.1058', 'NDCG@20': '0.0514'}
2025-03-06 14:32:43,148 - Validation score increased.  Saving model ...
2025-03-06 14:33:21,171 - {'epoch': 37, 'rec_loss': '7.6814'}
2025-03-06 14:33:40,904 - {'Epoch': 37, 'HR@5': '0.0527', 'NDCG@5': '0.0364', 'HR@10': '0.0753', 'NDCG@10': '0.0436', 'HR@20': '0.1054', 'NDCG@20': '0.0512'}
2025-03-06 14:33:40,908 - EarlyStopping counter: 1 out of 10
2025-03-06 14:34:19,298 - {'epoch': 38, 'rec_loss': '7.6717'}
2025-03-06 14:34:39,148 - {'Epoch': 38, 'HR@5': '0.0527', 'NDCG@5': '0.0366', 'HR@10': '0.0753', 'NDCG@10': '0.0438', 'HR@20': '0.1056', 'NDCG@20': '0.0515'}
2025-03-06 14:34:39,149 - Validation score increased.  Saving model ...
2025-03-06 14:35:16,403 - {'epoch': 39, 'rec_loss': '7.6668'}
2025-03-06 14:35:35,635 - {'Epoch': 39, 'HR@5': '0.0519', 'NDCG@5': '0.0364', 'HR@10': '0.0752', 'NDCG@10': '0.0438', 'HR@20': '0.1060', 'NDCG@20': '0.0516'}
2025-03-06 14:35:35,638 - Validation score increased.  Saving model ...
2025-03-06 14:36:15,947 - {'epoch': 40, 'rec_loss': '7.6619'}
2025-03-06 14:36:35,100 - {'Epoch': 40, 'HR@5': '0.0522', 'NDCG@5': '0.0363', 'HR@10': '0.0753', 'NDCG@10': '0.0438', 'HR@20': '0.1051', 'NDCG@20': '0.0513'}
2025-03-06 14:36:35,102 - EarlyStopping counter: 1 out of 10
2025-03-06 14:37:13,316 - {'epoch': 41, 'rec_loss': '7.6515'}
2025-03-06 14:37:32,594 - {'Epoch': 41, 'HR@5': '0.0517', 'NDCG@5': '0.0359', 'HR@10': '0.0752', 'NDCG@10': '0.0435', 'HR@20': '0.1058', 'NDCG@20': '0.0512'}
2025-03-06 14:37:32,597 - EarlyStopping counter: 2 out of 10
2025-03-06 14:38:09,177 - {'epoch': 42, 'rec_loss': '7.6497'}
2025-03-06 14:38:28,328 - {'Epoch': 42, 'HR@5': '0.0528', 'NDCG@5': '0.0364', 'HR@10': '0.0760', 'NDCG@10': '0.0439', 'HR@20': '0.1058', 'NDCG@20': '0.0514'}
2025-03-06 14:38:28,329 - EarlyStopping counter: 3 out of 10
2025-03-06 14:39:07,649 - {'epoch': 43, 'rec_loss': '7.6462'}
2025-03-06 14:39:27,026 - {'Epoch': 43, 'HR@5': '0.0526', 'NDCG@5': '0.0360', 'HR@10': '0.0758', 'NDCG@10': '0.0436', 'HR@20': '0.1051', 'NDCG@20': '0.0509'}
2025-03-06 14:39:27,028 - EarlyStopping counter: 4 out of 10
2025-03-06 14:40:06,524 - {'epoch': 44, 'rec_loss': '7.6405'}
2025-03-06 14:40:25,655 - {'Epoch': 44, 'HR@5': '0.0527', 'NDCG@5': '0.0359', 'HR@10': '0.0765', 'NDCG@10': '0.0436', 'HR@20': '0.1063', 'NDCG@20': '0.0511'}
2025-03-06 14:40:25,658 - EarlyStopping counter: 5 out of 10
2025-03-06 14:41:03,600 - {'epoch': 45, 'rec_loss': '7.6373'}
2025-03-06 14:41:22,324 - {'Epoch': 45, 'HR@5': '0.0522', 'NDCG@5': '0.0362', 'HR@10': '0.0751', 'NDCG@10': '0.0435', 'HR@20': '0.1055', 'NDCG@20': '0.0512'}
2025-03-06 14:41:22,327 - EarlyStopping counter: 6 out of 10
2025-03-06 14:41:59,957 - {'epoch': 46, 'rec_loss': '7.6351'}
2025-03-06 14:42:19,188 - {'Epoch': 46, 'HR@5': '0.0521', 'NDCG@5': '0.0361', 'HR@10': '0.0755', 'NDCG@10': '0.0436', 'HR@20': '0.1051', 'NDCG@20': '0.0511'}
2025-03-06 14:42:19,191 - EarlyStopping counter: 7 out of 10
2025-03-06 14:42:57,670 - {'epoch': 47, 'rec_loss': '7.6310'}
2025-03-06 14:43:16,751 - {'Epoch': 47, 'HR@5': '0.0527', 'NDCG@5': '0.0364', 'HR@10': '0.0761', 'NDCG@10': '0.0439', 'HR@20': '0.1063', 'NDCG@20': '0.0515'}
2025-03-06 14:43:16,753 - EarlyStopping counter: 8 out of 10
2025-03-06 14:43:54,405 - {'epoch': 48, 'rec_loss': '7.6201'}
2025-03-06 14:44:13,706 - {'Epoch': 48, 'HR@5': '0.0524', 'NDCG@5': '0.0361', 'HR@10': '0.0758', 'NDCG@10': '0.0437', 'HR@20': '0.1067', 'NDCG@20': '0.0515'}
2025-03-06 14:44:13,709 - EarlyStopping counter: 9 out of 10
2025-03-06 14:44:50,488 - {'epoch': 49, 'rec_loss': '7.6198'}
2025-03-06 14:45:09,788 - {'Epoch': 49, 'HR@5': '0.0523', 'NDCG@5': '0.0363', 'HR@10': '0.0753', 'NDCG@10': '0.0437', 'HR@20': '0.1065', 'NDCG@20': '0.0516'}
2025-03-06 14:45:09,790 - EarlyStopping counter: 10 out of 10
2025-03-06 14:45:09,790 - Early stopping
2025-03-06 14:45:09,790 - ---------------Test Score---------------
2025-03-06 14:45:29,164 - {'Epoch': 0, 'HR@5': '0.0433', 'NDCG@5': '0.0298', 'HR@10': '0.0614', 'NDCG@10': '0.0356', 'HR@20': '0.0881', 'NDCG@20': '0.0424'}
2025-03-06 14:45:29,165 - Scale_Sports
2025-03-06 14:45:29,165 - {'Epoch': 0, 'HR@5': '0.0433', 'NDCG@5': '0.0298', 'HR@10': '0.0614', 'NDCG@10': '0.0356', 'HR@20': '0.0881', 'NDCG@20': '0.0424'}
2025-03-06 20:51:00,698 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-06 20:51:04,843 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-06 20:51:04,860 - Total Parameters: 1328854
2025-03-06 20:52:10,258 - {'epoch': 0, 'rec_loss': '9.4055'}
2025-03-06 20:52:36,083 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0054', 'HR@10': '0.0133', 'NDCG@10': '0.0071', 'HR@20': '0.0235', 'NDCG@20': '0.0096'}
2025-03-06 20:52:36,089 - Validation score increased.  Saving model ...
2025-03-06 20:53:33,712 - {'epoch': 1, 'rec_loss': '9.0656'}
2025-03-06 20:53:56,584 - {'Epoch': 1, 'HR@5': '0.0181', 'NDCG@5': '0.0116', 'HR@10': '0.0312', 'NDCG@10': '0.0158', 'HR@20': '0.0494', 'NDCG@20': '0.0204'}
2025-03-06 20:53:56,591 - Validation score increased.  Saving model ...
2025-03-06 20:54:58,591 - {'epoch': 2, 'rec_loss': '8.6766'}
2025-03-06 20:55:24,844 - {'Epoch': 2, 'HR@5': '0.0297', 'NDCG@5': '0.0196', 'HR@10': '0.0458', 'NDCG@10': '0.0247', 'HR@20': '0.0688', 'NDCG@20': '0.0305'}
2025-03-06 20:55:24,849 - Validation score increased.  Saving model ...
2025-03-06 20:56:29,653 - {'epoch': 3, 'rec_loss': '8.3963'}
2025-03-06 20:56:53,932 - {'Epoch': 3, 'HR@5': '0.0381', 'NDCG@5': '0.0260', 'HR@10': '0.0562', 'NDCG@10': '0.0318', 'HR@20': '0.0815', 'NDCG@20': '0.0381'}
2025-03-06 20:56:53,934 - Validation score increased.  Saving model ...
2025-03-06 20:57:53,329 - {'epoch': 4, 'rec_loss': '8.1950'}
2025-03-06 20:58:17,028 - {'Epoch': 4, 'HR@5': '0.0416', 'NDCG@5': '0.0284', 'HR@10': '0.0608', 'NDCG@10': '0.0345', 'HR@20': '0.0876', 'NDCG@20': '0.0413'}
2025-03-06 20:58:17,030 - Validation score increased.  Saving model ...
2025-03-06 20:59:22,875 - {'epoch': 5, 'rec_loss': '8.0427'}
2025-03-06 20:59:48,152 - {'Epoch': 5, 'HR@5': '0.0447', 'NDCG@5': '0.0304', 'HR@10': '0.0651', 'NDCG@10': '0.0369', 'HR@20': '0.0908', 'NDCG@20': '0.0434'}
2025-03-06 20:59:48,157 - Validation score increased.  Saving model ...
2025-03-06 21:00:49,202 - {'epoch': 6, 'rec_loss': '7.9282'}
2025-03-06 21:01:13,908 - {'Epoch': 6, 'HR@5': '0.0464', 'NDCG@5': '0.0318', 'HR@10': '0.0664', 'NDCG@10': '0.0383', 'HR@20': '0.0924', 'NDCG@20': '0.0447'}
2025-03-06 21:01:13,916 - Validation score increased.  Saving model ...
2025-03-06 21:02:13,573 - {'epoch': 7, 'rec_loss': '7.8370'}
2025-03-06 21:02:40,284 - {'Epoch': 7, 'HR@5': '0.0473', 'NDCG@5': '0.0326', 'HR@10': '0.0687', 'NDCG@10': '0.0395', 'HR@20': '0.0960', 'NDCG@20': '0.0463'}
2025-03-06 21:02:40,289 - Validation score increased.  Saving model ...
2025-03-06 21:03:50,651 - {'epoch': 8, 'rec_loss': '7.7653'}
2025-03-06 21:04:17,856 - {'Epoch': 8, 'HR@5': '0.0485', 'NDCG@5': '0.0335', 'HR@10': '0.0684', 'NDCG@10': '0.0400', 'HR@20': '0.0966', 'NDCG@20': '0.0470'}
2025-03-06 21:04:17,861 - Validation score increased.  Saving model ...
2025-03-06 21:05:17,230 - {'epoch': 9, 'rec_loss': '7.7047'}
2025-03-06 21:05:41,541 - {'Epoch': 9, 'HR@5': '0.0490', 'NDCG@5': '0.0337', 'HR@10': '0.0704', 'NDCG@10': '0.0406', 'HR@20': '0.0966', 'NDCG@20': '0.0471'}
2025-03-06 21:05:41,560 - Validation score increased.  Saving model ...
2025-03-06 21:06:47,584 - {'epoch': 10, 'rec_loss': '7.6567'}
2025-03-06 21:07:14,831 - {'Epoch': 10, 'HR@5': '0.0476', 'NDCG@5': '0.0332', 'HR@10': '0.0681', 'NDCG@10': '0.0399', 'HR@20': '0.0981', 'NDCG@20': '0.0474'}
2025-03-06 21:07:14,833 - Validation score increased.  Saving model ...
2025-03-06 21:08:26,997 - {'epoch': 11, 'rec_loss': '7.6147'}
2025-03-06 21:08:50,987 - {'Epoch': 11, 'HR@5': '0.0480', 'NDCG@5': '0.0337', 'HR@10': '0.0700', 'NDCG@10': '0.0407', 'HR@20': '0.0995', 'NDCG@20': '0.0481'}
2025-03-06 21:08:50,991 - Validation score increased.  Saving model ...
2025-03-06 21:09:53,315 - {'epoch': 12, 'rec_loss': '7.5750'}
2025-03-06 21:10:18,382 - {'Epoch': 12, 'HR@5': '0.0481', 'NDCG@5': '0.0335', 'HR@10': '0.0700', 'NDCG@10': '0.0405', 'HR@20': '0.0996', 'NDCG@20': '0.0479'}
2025-03-06 21:10:18,384 - EarlyStopping counter: 1 out of 10
2025-03-06 21:11:23,651 - {'epoch': 13, 'rec_loss': '7.5412'}
2025-03-06 21:11:50,685 - {'Epoch': 13, 'HR@5': '0.0480', 'NDCG@5': '0.0335', 'HR@10': '0.0696', 'NDCG@10': '0.0404', 'HR@20': '0.0990', 'NDCG@20': '0.0478'}
2025-03-06 21:11:50,691 - EarlyStopping counter: 2 out of 10
2025-03-06 21:12:53,261 - {'epoch': 14, 'rec_loss': '7.5108'}
2025-03-06 21:13:17,147 - {'Epoch': 14, 'HR@5': '0.0491', 'NDCG@5': '0.0340', 'HR@10': '0.0711', 'NDCG@10': '0.0411', 'HR@20': '0.1002', 'NDCG@20': '0.0484'}
2025-03-06 21:13:17,154 - Validation score increased.  Saving model ...
2025-03-06 21:14:18,513 - {'epoch': 15, 'rec_loss': '7.4824'}
2025-03-06 21:14:44,112 - {'Epoch': 15, 'HR@5': '0.0488', 'NDCG@5': '0.0338', 'HR@10': '0.0703', 'NDCG@10': '0.0407', 'HR@20': '0.0987', 'NDCG@20': '0.0478'}
2025-03-06 21:14:44,118 - EarlyStopping counter: 1 out of 10
2025-03-06 21:15:52,731 - {'epoch': 16, 'rec_loss': '7.4635'}
2025-03-06 21:16:18,455 - {'Epoch': 16, 'HR@5': '0.0492', 'NDCG@5': '0.0339', 'HR@10': '0.0707', 'NDCG@10': '0.0409', 'HR@20': '0.0992', 'NDCG@20': '0.0480'}
2025-03-06 21:16:18,461 - EarlyStopping counter: 2 out of 10
2025-03-06 21:17:14,768 - {'epoch': 17, 'rec_loss': '7.4384'}
2025-03-06 21:17:38,856 - {'Epoch': 17, 'HR@5': '0.0495', 'NDCG@5': '0.0340', 'HR@10': '0.0709', 'NDCG@10': '0.0408', 'HR@20': '0.0985', 'NDCG@20': '0.0478'}
2025-03-06 21:17:38,858 - EarlyStopping counter: 3 out of 10
2025-03-06 21:18:42,132 - {'epoch': 18, 'rec_loss': '7.4171'}
2025-03-06 21:19:08,398 - {'Epoch': 18, 'HR@5': '0.0494', 'NDCG@5': '0.0336', 'HR@10': '0.0694', 'NDCG@10': '0.0400', 'HR@20': '0.0999', 'NDCG@20': '0.0477'}
2025-03-06 21:19:08,400 - EarlyStopping counter: 4 out of 10
2025-03-06 21:20:14,727 - {'epoch': 19, 'rec_loss': '7.3958'}
2025-03-06 21:20:38,277 - {'Epoch': 19, 'HR@5': '0.0494', 'NDCG@5': '0.0341', 'HR@10': '0.0710', 'NDCG@10': '0.0411', 'HR@20': '0.0989', 'NDCG@20': '0.0481'}
2025-03-06 21:20:38,279 - EarlyStopping counter: 5 out of 10
2025-03-06 21:21:36,515 - {'epoch': 20, 'rec_loss': '7.3797'}
2025-03-06 21:22:01,133 - {'Epoch': 20, 'HR@5': '0.0501', 'NDCG@5': '0.0343', 'HR@10': '0.0721', 'NDCG@10': '0.0414', 'HR@20': '0.1019', 'NDCG@20': '0.0489'}
2025-03-06 21:22:01,136 - Validation score increased.  Saving model ...
2025-03-06 21:23:08,061 - {'epoch': 21, 'rec_loss': '7.3638'}
2025-03-06 21:23:33,737 - {'Epoch': 21, 'HR@5': '0.0473', 'NDCG@5': '0.0326', 'HR@10': '0.0693', 'NDCG@10': '0.0397', 'HR@20': '0.0992', 'NDCG@20': '0.0472'}
2025-03-06 21:23:33,743 - EarlyStopping counter: 1 out of 10
2025-03-06 21:24:25,733 - {'epoch': 22, 'rec_loss': '7.3405'}
2025-03-06 21:24:47,617 - {'Epoch': 22, 'HR@5': '0.0481', 'NDCG@5': '0.0331', 'HR@10': '0.0706', 'NDCG@10': '0.0404', 'HR@20': '0.1001', 'NDCG@20': '0.0478'}
2025-03-06 21:24:47,625 - EarlyStopping counter: 2 out of 10
2025-03-06 21:25:38,365 - {'epoch': 23, 'rec_loss': '7.3307'}
2025-03-06 21:26:00,914 - {'Epoch': 23, 'HR@5': '0.0473', 'NDCG@5': '0.0326', 'HR@10': '0.0682', 'NDCG@10': '0.0393', 'HR@20': '0.0983', 'NDCG@20': '0.0469'}
2025-03-06 21:26:00,919 - EarlyStopping counter: 3 out of 10
2025-03-06 21:26:47,937 - {'epoch': 24, 'rec_loss': '7.3145'}
2025-03-06 21:27:08,325 - {'Epoch': 24, 'HR@5': '0.0483', 'NDCG@5': '0.0336', 'HR@10': '0.0706', 'NDCG@10': '0.0407', 'HR@20': '0.1001', 'NDCG@20': '0.0481'}
2025-03-06 21:27:08,332 - EarlyStopping counter: 4 out of 10
2025-03-06 21:27:51,882 - {'epoch': 25, 'rec_loss': '7.3049'}
2025-03-06 21:28:11,910 - {'Epoch': 25, 'HR@5': '0.0488', 'NDCG@5': '0.0334', 'HR@10': '0.0701', 'NDCG@10': '0.0403', 'HR@20': '0.1009', 'NDCG@20': '0.0480'}
2025-03-06 21:28:11,914 - EarlyStopping counter: 5 out of 10
2025-03-06 21:28:59,587 - {'epoch': 26, 'rec_loss': '7.2923'}
2025-03-06 21:29:20,130 - {'Epoch': 26, 'HR@5': '0.0497', 'NDCG@5': '0.0340', 'HR@10': '0.0718', 'NDCG@10': '0.0411', 'HR@20': '0.1008', 'NDCG@20': '0.0484'}
2025-03-06 21:29:20,139 - EarlyStopping counter: 6 out of 10
2025-03-06 21:30:05,604 - {'epoch': 27, 'rec_loss': '7.2800'}
2025-03-06 21:30:25,584 - {'Epoch': 27, 'HR@5': '0.0483', 'NDCG@5': '0.0332', 'HR@10': '0.0707', 'NDCG@10': '0.0404', 'HR@20': '0.0999', 'NDCG@20': '0.0478'}
2025-03-06 21:30:25,588 - EarlyStopping counter: 7 out of 10
2025-03-06 21:31:09,813 - {'epoch': 28, 'rec_loss': '7.2652'}
2025-03-06 21:31:29,471 - {'Epoch': 28, 'HR@5': '0.0476', 'NDCG@5': '0.0330', 'HR@10': '0.0704', 'NDCG@10': '0.0403', 'HR@20': '0.0995', 'NDCG@20': '0.0476'}
2025-03-06 21:31:29,482 - EarlyStopping counter: 8 out of 10
2025-03-06 21:32:15,908 - {'epoch': 29, 'rec_loss': '7.2600'}
2025-03-06 21:32:36,591 - {'Epoch': 29, 'HR@5': '0.0477', 'NDCG@5': '0.0330', 'HR@10': '0.0697', 'NDCG@10': '0.0401', 'HR@20': '0.0994', 'NDCG@20': '0.0476'}
2025-03-06 21:32:36,593 - EarlyStopping counter: 9 out of 10
2025-03-06 21:33:26,148 - {'epoch': 30, 'rec_loss': '7.2466'}
2025-03-06 21:33:45,540 - {'Epoch': 30, 'HR@5': '0.0473', 'NDCG@5': '0.0323', 'HR@10': '0.0698', 'NDCG@10': '0.0396', 'HR@20': '0.0997', 'NDCG@20': '0.0471'}
2025-03-06 21:33:45,547 - EarlyStopping counter: 10 out of 10
2025-03-06 21:33:45,547 - Early stopping
2025-03-06 21:33:45,547 - ---------------Test Score---------------
2025-03-06 21:34:05,589 - {'Epoch': 0, 'HR@5': '0.0406', 'NDCG@5': '0.0281', 'HR@10': '0.0596', 'NDCG@10': '0.0343', 'HR@20': '0.0847', 'NDCG@20': '0.0405'}
2025-03-06 21:34:05,595 - Scale_Sports
2025-03-06 21:34:05,595 - {'Epoch': 0, 'HR@5': '0.0406', 'NDCG@5': '0.0281', 'HR@10': '0.0596', 'NDCG@10': '0.0343', 'HR@20': '0.0847', 'NDCG@20': '0.0405'}
2025-03-07 01:17:36,619 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-07 01:17:40,301 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-07 01:17:40,308 - Total Parameters: 1328854
2025-03-07 01:18:10,309 - {'epoch': 0, 'rec_loss': '9.3927'}
2025-03-07 01:18:31,230 - {'Epoch': 0, 'HR@5': '0.0083', 'NDCG@5': '0.0055', 'HR@10': '0.0130', 'NDCG@10': '0.0070', 'HR@20': '0.0229', 'NDCG@20': '0.0094'}
2025-03-07 01:18:31,232 - Validation score increased.  Saving model ...
2025-03-07 01:18:59,020 - {'epoch': 1, 'rec_loss': '9.1721'}
2025-03-07 01:19:19,003 - {'Epoch': 1, 'HR@5': '0.0146', 'NDCG@5': '0.0092', 'HR@10': '0.0249', 'NDCG@10': '0.0125', 'HR@20': '0.0402', 'NDCG@20': '0.0163'}
2025-03-07 01:19:19,004 - Validation score increased.  Saving model ...
2025-03-07 01:19:48,878 - {'epoch': 2, 'rec_loss': '8.9430'}
2025-03-07 01:20:08,329 - {'Epoch': 2, 'HR@5': '0.0188', 'NDCG@5': '0.0120', 'HR@10': '0.0306', 'NDCG@10': '0.0157', 'HR@20': '0.0483', 'NDCG@20': '0.0202'}
2025-03-07 01:20:08,331 - Validation score increased.  Saving model ...
2025-03-07 01:20:36,312 - {'epoch': 3, 'rec_loss': '8.7867'}
2025-03-07 01:20:56,007 - {'Epoch': 3, 'HR@5': '0.0242', 'NDCG@5': '0.0152', 'HR@10': '0.0374', 'NDCG@10': '0.0194', 'HR@20': '0.0593', 'NDCG@20': '0.0249'}
2025-03-07 01:20:56,008 - Validation score increased.  Saving model ...
2025-03-07 01:21:18,033 - {'epoch': 4, 'rec_loss': '8.6619'}
2025-03-07 01:21:35,859 - {'Epoch': 4, 'HR@5': '0.0275', 'NDCG@5': '0.0178', 'HR@10': '0.0429', 'NDCG@10': '0.0227', 'HR@20': '0.0661', 'NDCG@20': '0.0285'}
2025-03-07 01:21:35,860 - Validation score increased.  Saving model ...
2025-03-07 01:21:59,031 - {'epoch': 5, 'rec_loss': '8.5541'}
2025-03-07 01:22:17,373 - {'Epoch': 5, 'HR@5': '0.0318', 'NDCG@5': '0.0206', 'HR@10': '0.0491', 'NDCG@10': '0.0262', 'HR@20': '0.0732', 'NDCG@20': '0.0322'}
2025-03-07 01:22:17,374 - Validation score increased.  Saving model ...
2025-03-07 01:22:46,116 - {'epoch': 6, 'rec_loss': '8.4674'}
2025-03-07 01:23:06,036 - {'Epoch': 6, 'HR@5': '0.0346', 'NDCG@5': '0.0227', 'HR@10': '0.0525', 'NDCG@10': '0.0285', 'HR@20': '0.0780', 'NDCG@20': '0.0349'}
2025-03-07 01:23:06,037 - Validation score increased.  Saving model ...
2025-03-07 01:23:34,700 - {'epoch': 7, 'rec_loss': '8.3864'}
2025-03-07 01:23:55,080 - {'Epoch': 7, 'HR@5': '0.0363', 'NDCG@5': '0.0243', 'HR@10': '0.0546', 'NDCG@10': '0.0302', 'HR@20': '0.0818', 'NDCG@20': '0.0371'}
2025-03-07 01:23:55,082 - Validation score increased.  Saving model ...
2025-03-07 01:24:23,229 - {'epoch': 8, 'rec_loss': '8.3201'}
2025-03-07 01:24:43,484 - {'Epoch': 8, 'HR@5': '0.0397', 'NDCG@5': '0.0268', 'HR@10': '0.0589', 'NDCG@10': '0.0330', 'HR@20': '0.0852', 'NDCG@20': '0.0396'}
2025-03-07 01:24:43,485 - Validation score increased.  Saving model ...
2025-03-07 01:25:13,234 - {'epoch': 9, 'rec_loss': '8.2543'}
2025-03-07 01:25:32,507 - {'Epoch': 9, 'HR@5': '0.0419', 'NDCG@5': '0.0284', 'HR@10': '0.0616', 'NDCG@10': '0.0348', 'HR@20': '0.0891', 'NDCG@20': '0.0417'}
2025-03-07 01:25:32,508 - Validation score increased.  Saving model ...
2025-03-07 01:25:58,132 - {'epoch': 10, 'rec_loss': '8.2003'}
2025-03-07 01:26:16,821 - {'Epoch': 10, 'HR@5': '0.0436', 'NDCG@5': '0.0295', 'HR@10': '0.0631', 'NDCG@10': '0.0357', 'HR@20': '0.0907', 'NDCG@20': '0.0426'}
2025-03-07 01:26:16,823 - Validation score increased.  Saving model ...
2025-03-07 01:26:43,954 - {'epoch': 11, 'rec_loss': '8.1469'}
2025-03-07 01:27:02,366 - {'Epoch': 11, 'HR@5': '0.0441', 'NDCG@5': '0.0301', 'HR@10': '0.0642', 'NDCG@10': '0.0366', 'HR@20': '0.0935', 'NDCG@20': '0.0440'}
2025-03-07 01:27:02,367 - Validation score increased.  Saving model ...
2025-03-07 01:27:33,325 - {'epoch': 12, 'rec_loss': '8.1035'}
2025-03-07 01:27:53,201 - {'Epoch': 12, 'HR@5': '0.0453', 'NDCG@5': '0.0308', 'HR@10': '0.0666', 'NDCG@10': '0.0377', 'HR@20': '0.0945', 'NDCG@20': '0.0447'}
2025-03-07 01:27:53,203 - Validation score increased.  Saving model ...
2025-03-07 01:28:24,394 - {'epoch': 13, 'rec_loss': '8.0645'}
2025-03-07 01:28:45,344 - {'Epoch': 13, 'HR@5': '0.0462', 'NDCG@5': '0.0320', 'HR@10': '0.0677', 'NDCG@10': '0.0389', 'HR@20': '0.0972', 'NDCG@20': '0.0463'}
2025-03-07 01:28:45,346 - Validation score increased.  Saving model ...
2025-03-07 01:29:17,062 - {'epoch': 14, 'rec_loss': '8.0298'}
2025-03-07 01:29:37,749 - {'Epoch': 14, 'HR@5': '0.0478', 'NDCG@5': '0.0331', 'HR@10': '0.0690', 'NDCG@10': '0.0400', 'HR@20': '0.0978', 'NDCG@20': '0.0472'}
2025-03-07 01:29:37,750 - Validation score increased.  Saving model ...
2025-03-07 01:30:08,832 - {'epoch': 15, 'rec_loss': '7.9978'}
2025-03-07 01:30:29,125 - {'Epoch': 15, 'HR@5': '0.0487', 'NDCG@5': '0.0334', 'HR@10': '0.0698', 'NDCG@10': '0.0402', 'HR@20': '0.0982', 'NDCG@20': '0.0473'}
2025-03-07 01:30:29,126 - Validation score increased.  Saving model ...
2025-03-07 01:30:54,140 - {'epoch': 16, 'rec_loss': '7.9701'}
2025-03-07 01:31:12,776 - {'Epoch': 16, 'HR@5': '0.0484', 'NDCG@5': '0.0331', 'HR@10': '0.0701', 'NDCG@10': '0.0401', 'HR@20': '0.0992', 'NDCG@20': '0.0474'}
2025-03-07 01:31:12,777 - Validation score increased.  Saving model ...
2025-03-07 01:31:39,558 - {'epoch': 17, 'rec_loss': '7.9421'}
2025-03-07 01:31:59,541 - {'Epoch': 17, 'HR@5': '0.0485', 'NDCG@5': '0.0336', 'HR@10': '0.0707', 'NDCG@10': '0.0407', 'HR@20': '0.1003', 'NDCG@20': '0.0481'}
2025-03-07 01:31:59,542 - Validation score increased.  Saving model ...
2025-03-07 01:32:29,188 - {'epoch': 18, 'rec_loss': '7.9172'}
2025-03-07 01:32:49,880 - {'Epoch': 18, 'HR@5': '0.0496', 'NDCG@5': '0.0343', 'HR@10': '0.0722', 'NDCG@10': '0.0416', 'HR@20': '0.1015', 'NDCG@20': '0.0489'}
2025-03-07 01:32:49,881 - Validation score increased.  Saving model ...
2025-03-07 01:33:20,521 - {'epoch': 19, 'rec_loss': '7.8953'}
2025-03-07 01:33:40,849 - {'Epoch': 19, 'HR@5': '0.0495', 'NDCG@5': '0.0343', 'HR@10': '0.0723', 'NDCG@10': '0.0416', 'HR@20': '0.1010', 'NDCG@20': '0.0488'}
2025-03-07 01:33:40,852 - EarlyStopping counter: 1 out of 10
2025-03-07 01:34:10,168 - {'epoch': 20, 'rec_loss': '7.8772'}
2025-03-07 01:34:29,803 - {'Epoch': 20, 'HR@5': '0.0506', 'NDCG@5': '0.0347', 'HR@10': '0.0725', 'NDCG@10': '0.0418', 'HR@20': '0.1031', 'NDCG@20': '0.0495'}
2025-03-07 01:34:29,804 - Validation score increased.  Saving model ...
2025-03-07 01:35:00,501 - {'epoch': 21, 'rec_loss': '7.8588'}
2025-03-07 01:35:18,650 - {'Epoch': 21, 'HR@5': '0.0494', 'NDCG@5': '0.0340', 'HR@10': '0.0717', 'NDCG@10': '0.0412', 'HR@20': '0.1015', 'NDCG@20': '0.0487'}
2025-03-07 01:35:18,652 - EarlyStopping counter: 1 out of 10
2025-03-07 01:35:43,452 - {'epoch': 22, 'rec_loss': '7.8409'}
2025-03-07 01:36:01,485 - {'Epoch': 22, 'HR@5': '0.0495', 'NDCG@5': '0.0344', 'HR@10': '0.0723', 'NDCG@10': '0.0417', 'HR@20': '0.1028', 'NDCG@20': '0.0494'}
2025-03-07 01:36:01,487 - EarlyStopping counter: 2 out of 10
2025-03-07 01:36:26,153 - {'epoch': 23, 'rec_loss': '7.8256'}
2025-03-07 01:36:46,160 - {'Epoch': 23, 'HR@5': '0.0492', 'NDCG@5': '0.0341', 'HR@10': '0.0722', 'NDCG@10': '0.0415', 'HR@20': '0.1021', 'NDCG@20': '0.0490'}
2025-03-07 01:36:46,161 - EarlyStopping counter: 3 out of 10
2025-03-07 01:37:14,971 - {'epoch': 24, 'rec_loss': '7.8128'}
2025-03-07 01:37:35,441 - {'Epoch': 24, 'HR@5': '0.0496', 'NDCG@5': '0.0345', 'HR@10': '0.0733', 'NDCG@10': '0.0421', 'HR@20': '0.1035', 'NDCG@20': '0.0497'}
2025-03-07 01:37:35,442 - Validation score increased.  Saving model ...
2025-03-07 01:38:05,768 - {'epoch': 25, 'rec_loss': '7.7991'}
2025-03-07 01:38:26,266 - {'Epoch': 25, 'HR@5': '0.0500', 'NDCG@5': '0.0348', 'HR@10': '0.0732', 'NDCG@10': '0.0422', 'HR@20': '0.1035', 'NDCG@20': '0.0498'}
2025-03-07 01:38:26,267 - Validation score increased.  Saving model ...
2025-03-07 01:38:55,985 - {'epoch': 26, 'rec_loss': '7.7813'}
2025-03-07 01:39:16,433 - {'Epoch': 26, 'HR@5': '0.0499', 'NDCG@5': '0.0344', 'HR@10': '0.0728', 'NDCG@10': '0.0418', 'HR@20': '0.1040', 'NDCG@20': '0.0497'}
2025-03-07 01:39:16,434 - EarlyStopping counter: 1 out of 10
2025-03-07 01:39:46,725 - {'epoch': 27, 'rec_loss': '7.7755'}
2025-03-07 01:40:04,469 - {'Epoch': 27, 'HR@5': '0.0500', 'NDCG@5': '0.0343', 'HR@10': '0.0730', 'NDCG@10': '0.0417', 'HR@20': '0.1042', 'NDCG@20': '0.0495'}
2025-03-07 01:40:04,470 - EarlyStopping counter: 2 out of 10
2025-03-07 01:40:30,567 - {'epoch': 28, 'rec_loss': '7.7585'}
2025-03-07 01:40:48,845 - {'Epoch': 28, 'HR@5': '0.0502', 'NDCG@5': '0.0350', 'HR@10': '0.0737', 'NDCG@10': '0.0426', 'HR@20': '0.1033', 'NDCG@20': '0.0500'}
2025-03-07 01:40:48,846 - Validation score increased.  Saving model ...
2025-03-07 01:41:17,060 - {'epoch': 29, 'rec_loss': '7.7474'}
2025-03-07 01:41:37,857 - {'Epoch': 29, 'HR@5': '0.0496', 'NDCG@5': '0.0345', 'HR@10': '0.0723', 'NDCG@10': '0.0417', 'HR@20': '0.1029', 'NDCG@20': '0.0494'}
2025-03-07 01:41:37,859 - EarlyStopping counter: 1 out of 10
2025-03-07 01:42:10,500 - {'epoch': 30, 'rec_loss': '7.7404'}
2025-03-07 01:42:30,175 - {'Epoch': 30, 'HR@5': '0.0501', 'NDCG@5': '0.0347', 'HR@10': '0.0726', 'NDCG@10': '0.0420', 'HR@20': '0.1037', 'NDCG@20': '0.0498'}
2025-03-07 01:42:30,176 - EarlyStopping counter: 2 out of 10
2025-03-07 01:42:59,955 - {'epoch': 31, 'rec_loss': '7.7310'}
2025-03-07 01:43:21,183 - {'Epoch': 31, 'HR@5': '0.0507', 'NDCG@5': '0.0353', 'HR@10': '0.0744', 'NDCG@10': '0.0428', 'HR@20': '0.1036', 'NDCG@20': '0.0502'}
2025-03-07 01:43:21,185 - Validation score increased.  Saving model ...
2025-03-07 01:43:51,853 - {'epoch': 32, 'rec_loss': '7.7176'}
2025-03-07 01:44:11,780 - {'Epoch': 32, 'HR@5': '0.0512', 'NDCG@5': '0.0351', 'HR@10': '0.0734', 'NDCG@10': '0.0422', 'HR@20': '0.1034', 'NDCG@20': '0.0498'}
2025-03-07 01:44:11,781 - EarlyStopping counter: 1 out of 10
2025-03-07 01:44:37,465 - {'epoch': 33, 'rec_loss': '7.7144'}
2025-03-07 01:44:55,996 - {'Epoch': 33, 'HR@5': '0.0508', 'NDCG@5': '0.0356', 'HR@10': '0.0748', 'NDCG@10': '0.0433', 'HR@20': '0.1050', 'NDCG@20': '0.0509'}
2025-03-07 01:44:55,997 - Validation score increased.  Saving model ...
2025-03-07 01:45:21,488 - {'epoch': 34, 'rec_loss': '7.7095'}
2025-03-07 01:45:39,543 - {'Epoch': 34, 'HR@5': '0.0517', 'NDCG@5': '0.0360', 'HR@10': '0.0733', 'NDCG@10': '0.0429', 'HR@20': '0.1048', 'NDCG@20': '0.0508'}
2025-03-07 01:45:39,545 - EarlyStopping counter: 1 out of 10
2025-03-07 01:46:08,694 - {'epoch': 35, 'rec_loss': '7.7009'}
2025-03-07 01:46:29,501 - {'Epoch': 35, 'HR@5': '0.0512', 'NDCG@5': '0.0355', 'HR@10': '0.0734', 'NDCG@10': '0.0426', 'HR@20': '0.1046', 'NDCG@20': '0.0505'}
2025-03-07 01:46:29,502 - EarlyStopping counter: 2 out of 10
2025-03-07 01:46:59,088 - {'epoch': 36, 'rec_loss': '7.6903'}
2025-03-07 01:47:20,045 - {'Epoch': 36, 'HR@5': '0.0512', 'NDCG@5': '0.0357', 'HR@10': '0.0737', 'NDCG@10': '0.0430', 'HR@20': '0.1046', 'NDCG@20': '0.0507'}
2025-03-07 01:47:20,047 - EarlyStopping counter: 3 out of 10
2025-03-07 01:47:50,663 - {'epoch': 37, 'rec_loss': '7.6842'}
2025-03-07 01:48:10,887 - {'Epoch': 37, 'HR@5': '0.0504', 'NDCG@5': '0.0348', 'HR@10': '0.0744', 'NDCG@10': '0.0425', 'HR@20': '0.1048', 'NDCG@20': '0.0502'}
2025-03-07 01:48:10,888 - EarlyStopping counter: 4 out of 10
2025-03-07 01:48:42,776 - {'epoch': 38, 'rec_loss': '7.6799'}
2025-03-07 01:49:03,284 - {'Epoch': 38, 'HR@5': '0.0501', 'NDCG@5': '0.0348', 'HR@10': '0.0735', 'NDCG@10': '0.0423', 'HR@20': '0.1046', 'NDCG@20': '0.0501'}
2025-03-07 01:49:03,285 - EarlyStopping counter: 5 out of 10
2025-03-07 01:49:28,619 - {'epoch': 39, 'rec_loss': '7.6733'}
2025-03-07 01:49:46,807 - {'Epoch': 39, 'HR@5': '0.0515', 'NDCG@5': '0.0358', 'HR@10': '0.0744', 'NDCG@10': '0.0431', 'HR@20': '0.1057', 'NDCG@20': '0.0510'}
2025-03-07 01:49:46,808 - Validation score increased.  Saving model ...
2025-03-07 01:50:12,009 - {'epoch': 40, 'rec_loss': '7.6660'}
2025-03-07 01:50:31,602 - {'Epoch': 40, 'HR@5': '0.0513', 'NDCG@5': '0.0356', 'HR@10': '0.0741', 'NDCG@10': '0.0429', 'HR@20': '0.1048', 'NDCG@20': '0.0507'}
2025-03-07 01:50:31,604 - EarlyStopping counter: 1 out of 10
2025-03-07 01:51:01,886 - {'epoch': 41, 'rec_loss': '7.6606'}
2025-03-07 01:51:23,373 - {'Epoch': 41, 'HR@5': '0.0500', 'NDCG@5': '0.0350', 'HR@10': '0.0742', 'NDCG@10': '0.0428', 'HR@20': '0.1043', 'NDCG@20': '0.0504'}
2025-03-07 01:51:23,375 - EarlyStopping counter: 2 out of 10
2025-03-07 01:51:54,613 - {'epoch': 42, 'rec_loss': '7.6519'}
2025-03-07 01:52:14,469 - {'Epoch': 42, 'HR@5': '0.0513', 'NDCG@5': '0.0357', 'HR@10': '0.0750', 'NDCG@10': '0.0433', 'HR@20': '0.1050', 'NDCG@20': '0.0509'}
2025-03-07 01:52:14,471 - EarlyStopping counter: 3 out of 10
2025-03-07 01:52:43,990 - {'epoch': 43, 'rec_loss': '7.6494'}
2025-03-07 01:53:03,926 - {'Epoch': 43, 'HR@5': '0.0506', 'NDCG@5': '0.0349', 'HR@10': '0.0737', 'NDCG@10': '0.0423', 'HR@20': '0.1043', 'NDCG@20': '0.0500'}
2025-03-07 01:53:03,927 - EarlyStopping counter: 4 out of 10
2025-03-07 01:53:33,765 - {'epoch': 44, 'rec_loss': '7.6555'}
2025-03-07 01:53:52,552 - {'Epoch': 44, 'HR@5': '0.0513', 'NDCG@5': '0.0357', 'HR@10': '0.0736', 'NDCG@10': '0.0429', 'HR@20': '0.1046', 'NDCG@20': '0.0507'}
2025-03-07 01:53:52,553 - EarlyStopping counter: 5 out of 10
2025-03-07 01:54:17,239 - {'epoch': 45, 'rec_loss': '7.6409'}
2025-03-07 01:54:35,724 - {'Epoch': 45, 'HR@5': '0.0504', 'NDCG@5': '0.0351', 'HR@10': '0.0733', 'NDCG@10': '0.0425', 'HR@20': '0.1044', 'NDCG@20': '0.0503'}
2025-03-07 01:54:35,725 - EarlyStopping counter: 6 out of 10
2025-03-07 01:55:01,020 - {'epoch': 46, 'rec_loss': '7.6372'}
2025-03-07 01:55:20,527 - {'Epoch': 46, 'HR@5': '0.0506', 'NDCG@5': '0.0350', 'HR@10': '0.0737', 'NDCG@10': '0.0424', 'HR@20': '0.1043', 'NDCG@20': '0.0501'}
2025-03-07 01:55:20,529 - EarlyStopping counter: 7 out of 10
2025-03-07 01:55:49,861 - {'epoch': 47, 'rec_loss': '7.6355'}
2025-03-07 01:56:10,400 - {'Epoch': 47, 'HR@5': '0.0509', 'NDCG@5': '0.0354', 'HR@10': '0.0735', 'NDCG@10': '0.0426', 'HR@20': '0.1048', 'NDCG@20': '0.0505'}
2025-03-07 01:56:10,402 - EarlyStopping counter: 8 out of 10
2025-03-07 01:56:40,540 - {'epoch': 48, 'rec_loss': '7.6300'}
2025-03-07 01:57:00,975 - {'Epoch': 48, 'HR@5': '0.0503', 'NDCG@5': '0.0348', 'HR@10': '0.0738', 'NDCG@10': '0.0424', 'HR@20': '0.1040', 'NDCG@20': '0.0500'}
2025-03-07 01:57:00,976 - EarlyStopping counter: 9 out of 10
2025-03-07 01:57:30,321 - {'epoch': 49, 'rec_loss': '7.6274'}
2025-03-07 01:57:50,784 - {'Epoch': 49, 'HR@5': '0.0519', 'NDCG@5': '0.0361', 'HR@10': '0.0743', 'NDCG@10': '0.0432', 'HR@20': '0.1042', 'NDCG@20': '0.0508'}
2025-03-07 01:57:50,785 - EarlyStopping counter: 10 out of 10
2025-03-07 01:57:50,785 - Early stopping
2025-03-07 01:57:50,785 - ---------------Test Score---------------
2025-03-07 01:58:11,623 - {'Epoch': 0, 'HR@5': '0.0417', 'NDCG@5': '0.0288', 'HR@10': '0.0602', 'NDCG@10': '0.0347', 'HR@20': '0.0857', 'NDCG@20': '0.0412'}
2025-03-07 01:58:11,624 - Scale_Sports
2025-03-07 01:58:11,624 - {'Epoch': 0, 'HR@5': '0.0417', 'NDCG@5': '0.0288', 'HR@10': '0.0602', 'NDCG@10': '0.0347', 'HR@20': '0.0857', 'NDCG@20': '0.0412'}
2025-03-07 11:51:44,680 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-07 11:51:48,552 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-07 11:51:48,562 - Total Parameters: 1328854
2025-03-07 11:52:27,371 - {'epoch': 0, 'rec_loss': '9.4006'}
2025-03-07 11:52:48,859 - {'Epoch': 0, 'HR@5': '0.0083', 'NDCG@5': '0.0055', 'HR@10': '0.0131', 'NDCG@10': '0.0070', 'HR@20': '0.0208', 'NDCG@20': '0.0089'}
2025-03-07 11:52:48,866 - Validation score increased.  Saving model ...
2025-03-07 11:53:33,675 - {'epoch': 1, 'rec_loss': '9.2056'}
2025-03-07 11:53:55,115 - {'Epoch': 1, 'HR@5': '0.0118', 'NDCG@5': '0.0078', 'HR@10': '0.0203', 'NDCG@10': '0.0104', 'HR@20': '0.0341', 'NDCG@20': '0.0139'}
2025-03-07 11:53:55,117 - Validation score increased.  Saving model ...
2025-03-07 11:54:38,082 - {'epoch': 2, 'rec_loss': '8.9945'}
2025-03-07 11:54:58,590 - {'Epoch': 2, 'HR@5': '0.0158', 'NDCG@5': '0.0100', 'HR@10': '0.0263', 'NDCG@10': '0.0134', 'HR@20': '0.0433', 'NDCG@20': '0.0177'}
2025-03-07 11:54:58,592 - Validation score increased.  Saving model ...
2025-03-07 11:55:35,196 - {'epoch': 3, 'rec_loss': '8.8521'}
2025-03-07 11:55:54,370 - {'Epoch': 3, 'HR@5': '0.0182', 'NDCG@5': '0.0115', 'HR@10': '0.0289', 'NDCG@10': '0.0149', 'HR@20': '0.0483', 'NDCG@20': '0.0198'}
2025-03-07 11:55:54,373 - Validation score increased.  Saving model ...
2025-03-07 11:56:31,090 - {'epoch': 4, 'rec_loss': '8.7433'}
2025-03-07 11:56:53,769 - {'Epoch': 4, 'HR@5': '0.0206', 'NDCG@5': '0.0134', 'HR@10': '0.0337', 'NDCG@10': '0.0176', 'HR@20': '0.0553', 'NDCG@20': '0.0231'}
2025-03-07 11:56:53,772 - Validation score increased.  Saving model ...
2025-03-07 11:57:37,709 - {'epoch': 5, 'rec_loss': '8.6436'}
2025-03-07 11:58:00,321 - {'Epoch': 5, 'HR@5': '0.0257', 'NDCG@5': '0.0166', 'HR@10': '0.0414', 'NDCG@10': '0.0216', 'HR@20': '0.0644', 'NDCG@20': '0.0274'}
2025-03-07 11:58:00,323 - Validation score increased.  Saving model ...
2025-03-07 11:58:39,198 - {'epoch': 6, 'rec_loss': '8.5608'}
2025-03-07 11:58:58,993 - {'Epoch': 6, 'HR@5': '0.0291', 'NDCG@5': '0.0189', 'HR@10': '0.0462', 'NDCG@10': '0.0243', 'HR@20': '0.0688', 'NDCG@20': '0.0300'}
2025-03-07 11:58:58,996 - Validation score increased.  Saving model ...
2025-03-07 11:59:30,805 - {'epoch': 7, 'rec_loss': '8.4770'}
2025-03-07 11:59:51,315 - {'Epoch': 7, 'HR@5': '0.0328', 'NDCG@5': '0.0217', 'HR@10': '0.0497', 'NDCG@10': '0.0272', 'HR@20': '0.0743', 'NDCG@20': '0.0334'}
2025-03-07 11:59:51,317 - Validation score increased.  Saving model ...
2025-03-07 12:00:32,847 - {'epoch': 8, 'rec_loss': '8.4116'}
2025-03-07 12:00:56,413 - {'Epoch': 8, 'HR@5': '0.0343', 'NDCG@5': '0.0233', 'HR@10': '0.0514', 'NDCG@10': '0.0287', 'HR@20': '0.0757', 'NDCG@20': '0.0348'}
2025-03-07 12:00:56,426 - Validation score increased.  Saving model ...
2025-03-07 12:01:42,071 - {'epoch': 9, 'rec_loss': '8.3518'}
2025-03-07 12:02:04,177 - {'Epoch': 9, 'HR@5': '0.0371', 'NDCG@5': '0.0251', 'HR@10': '0.0550', 'NDCG@10': '0.0308', 'HR@20': '0.0806', 'NDCG@20': '0.0373'}
2025-03-07 12:02:04,182 - Validation score increased.  Saving model ...
2025-03-07 12:02:41,594 - {'epoch': 10, 'rec_loss': '8.2998'}
2025-03-07 12:03:00,263 - {'Epoch': 10, 'HR@5': '0.0388', 'NDCG@5': '0.0262', 'HR@10': '0.0573', 'NDCG@10': '0.0322', 'HR@20': '0.0833', 'NDCG@20': '0.0387'}
2025-03-07 12:03:00,265 - Validation score increased.  Saving model ...
2025-03-07 12:03:36,502 - {'epoch': 11, 'rec_loss': '8.2541'}
2025-03-07 12:03:56,958 - {'Epoch': 11, 'HR@5': '0.0400', 'NDCG@5': '0.0268', 'HR@10': '0.0590', 'NDCG@10': '0.0329', 'HR@20': '0.0852', 'NDCG@20': '0.0395'}
2025-03-07 12:03:56,964 - Validation score increased.  Saving model ...
2025-03-07 12:04:42,380 - {'epoch': 12, 'rec_loss': '8.2129'}
2025-03-07 12:05:05,712 - {'Epoch': 12, 'HR@5': '0.0413', 'NDCG@5': '0.0281', 'HR@10': '0.0612', 'NDCG@10': '0.0345', 'HR@20': '0.0878', 'NDCG@20': '0.0412'}
2025-03-07 12:05:05,714 - Validation score increased.  Saving model ...
2025-03-07 12:05:47,787 - {'epoch': 13, 'rec_loss': '8.1723'}
2025-03-07 12:06:09,730 - {'Epoch': 13, 'HR@5': '0.0417', 'NDCG@5': '0.0285', 'HR@10': '0.0613', 'NDCG@10': '0.0348', 'HR@20': '0.0895', 'NDCG@20': '0.0419'}
2025-03-07 12:06:09,732 - Validation score increased.  Saving model ...
2025-03-07 12:06:40,763 - {'epoch': 14, 'rec_loss': '8.1420'}
2025-03-07 12:07:00,352 - {'Epoch': 14, 'HR@5': '0.0436', 'NDCG@5': '0.0297', 'HR@10': '0.0623', 'NDCG@10': '0.0357', 'HR@20': '0.0907', 'NDCG@20': '0.0429'}
2025-03-07 12:07:00,354 - Validation score increased.  Saving model ...
2025-03-07 12:07:36,503 - {'epoch': 15, 'rec_loss': '8.1117'}
2025-03-07 12:07:58,017 - {'Epoch': 15, 'HR@5': '0.0440', 'NDCG@5': '0.0305', 'HR@10': '0.0641', 'NDCG@10': '0.0370', 'HR@20': '0.0917', 'NDCG@20': '0.0439'}
2025-03-07 12:07:58,019 - Validation score increased.  Saving model ...
2025-03-07 12:08:47,333 - {'epoch': 16, 'rec_loss': '8.0803'}
2025-03-07 12:09:10,312 - {'Epoch': 16, 'HR@5': '0.0449', 'NDCG@5': '0.0312', 'HR@10': '0.0651', 'NDCG@10': '0.0377', 'HR@20': '0.0922', 'NDCG@20': '0.0445'}
2025-03-07 12:09:10,321 - Validation score increased.  Saving model ...
2025-03-07 12:09:50,892 - {'epoch': 17, 'rec_loss': '8.0605'}
2025-03-07 12:10:10,472 - {'Epoch': 17, 'HR@5': '0.0446', 'NDCG@5': '0.0314', 'HR@10': '0.0647', 'NDCG@10': '0.0379', 'HR@20': '0.0925', 'NDCG@20': '0.0449'}
2025-03-07 12:10:10,475 - Validation score increased.  Saving model ...
2025-03-07 12:10:43,947 - {'epoch': 18, 'rec_loss': '8.0368'}
2025-03-07 12:11:04,776 - {'Epoch': 18, 'HR@5': '0.0456', 'NDCG@5': '0.0316', 'HR@10': '0.0670', 'NDCG@10': '0.0385', 'HR@20': '0.0942', 'NDCG@20': '0.0454'}
2025-03-07 12:11:04,789 - Validation score increased.  Saving model ...
2025-03-07 12:11:45,283 - {'epoch': 19, 'rec_loss': '8.0221'}
2025-03-07 12:12:09,026 - {'Epoch': 19, 'HR@5': '0.0459', 'NDCG@5': '0.0322', 'HR@10': '0.0666', 'NDCG@10': '0.0389', 'HR@20': '0.0944', 'NDCG@20': '0.0459'}
2025-03-07 12:12:09,028 - Validation score increased.  Saving model ...
2025-03-07 12:12:54,005 - {'epoch': 20, 'rec_loss': '7.9921'}
2025-03-07 12:13:16,647 - {'Epoch': 20, 'HR@5': '0.0462', 'NDCG@5': '0.0325', 'HR@10': '0.0672', 'NDCG@10': '0.0392', 'HR@20': '0.0960', 'NDCG@20': '0.0465'}
2025-03-07 12:13:16,649 - Validation score increased.  Saving model ...
2025-03-07 12:13:49,572 - {'epoch': 21, 'rec_loss': '7.9792'}
2025-03-07 12:14:08,715 - {'Epoch': 21, 'HR@5': '0.0459', 'NDCG@5': '0.0318', 'HR@10': '0.0669', 'NDCG@10': '0.0386', 'HR@20': '0.0950', 'NDCG@20': '0.0457'}
2025-03-07 12:14:08,721 - EarlyStopping counter: 1 out of 10
2025-03-07 12:14:46,033 - {'epoch': 22, 'rec_loss': '7.9635'}
2025-03-07 12:15:06,823 - {'Epoch': 22, 'HR@5': '0.0468', 'NDCG@5': '0.0327', 'HR@10': '0.0681', 'NDCG@10': '0.0396', 'HR@20': '0.0976', 'NDCG@20': '0.0470'}
2025-03-07 12:15:06,825 - Validation score increased.  Saving model ...
2025-03-07 12:15:51,062 - {'epoch': 23, 'rec_loss': '7.9431'}
2025-03-07 12:16:15,747 - {'Epoch': 23, 'HR@5': '0.0469', 'NDCG@5': '0.0330', 'HR@10': '0.0688', 'NDCG@10': '0.0400', 'HR@20': '0.0971', 'NDCG@20': '0.0471'}
2025-03-07 12:16:15,751 - Validation score increased.  Saving model ...
2025-03-07 12:16:55,568 - {'epoch': 24, 'rec_loss': '7.9345'}
2025-03-07 12:17:17,131 - {'Epoch': 24, 'HR@5': '0.0479', 'NDCG@5': '0.0332', 'HR@10': '0.0690', 'NDCG@10': '0.0400', 'HR@20': '0.0979', 'NDCG@20': '0.0472'}
2025-03-07 12:17:17,133 - Validation score increased.  Saving model ...
2025-03-07 12:17:48,812 - {'epoch': 25, 'rec_loss': '7.9187'}
2025-03-07 12:18:08,913 - {'Epoch': 25, 'HR@5': '0.0482', 'NDCG@5': '0.0337', 'HR@10': '0.0684', 'NDCG@10': '0.0402', 'HR@20': '0.0975', 'NDCG@20': '0.0476'}
2025-03-07 12:18:08,915 - Validation score increased.  Saving model ...
2025-03-07 12:18:47,071 - {'epoch': 26, 'rec_loss': '7.9068'}
2025-03-07 12:19:11,663 - {'Epoch': 26, 'HR@5': '0.0493', 'NDCG@5': '0.0344', 'HR@10': '0.0707', 'NDCG@10': '0.0413', 'HR@20': '0.0985', 'NDCG@20': '0.0483'}
2025-03-07 12:19:11,666 - Validation score increased.  Saving model ...
2025-03-07 12:19:58,626 - {'epoch': 27, 'rec_loss': '7.8938'}
2025-03-07 12:20:21,667 - {'Epoch': 27, 'HR@5': '0.0487', 'NDCG@5': '0.0335', 'HR@10': '0.0698', 'NDCG@10': '0.0403', 'HR@20': '0.0978', 'NDCG@20': '0.0474'}
2025-03-07 12:20:21,669 - EarlyStopping counter: 1 out of 10
2025-03-07 12:20:58,908 - {'epoch': 28, 'rec_loss': '7.8850'}
2025-03-07 12:21:19,069 - {'Epoch': 28, 'HR@5': '0.0492', 'NDCG@5': '0.0342', 'HR@10': '0.0693', 'NDCG@10': '0.0407', 'HR@20': '0.0985', 'NDCG@20': '0.0480'}
2025-03-07 12:21:19,073 - EarlyStopping counter: 2 out of 10
2025-03-07 12:21:51,375 - {'epoch': 29, 'rec_loss': '7.8772'}
2025-03-07 12:22:11,730 - {'Epoch': 29, 'HR@5': '0.0484', 'NDCG@5': '0.0341', 'HR@10': '0.0699', 'NDCG@10': '0.0410', 'HR@20': '0.0981', 'NDCG@20': '0.0481'}
2025-03-07 12:22:11,736 - EarlyStopping counter: 3 out of 10
2025-03-07 12:22:56,056 - {'epoch': 30, 'rec_loss': '7.8658'}
2025-03-07 12:23:21,426 - {'Epoch': 30, 'HR@5': '0.0485', 'NDCG@5': '0.0341', 'HR@10': '0.0702', 'NDCG@10': '0.0411', 'HR@20': '0.0983', 'NDCG@20': '0.0481'}
2025-03-07 12:23:21,428 - EarlyStopping counter: 4 out of 10
2025-03-07 12:24:06,684 - {'epoch': 31, 'rec_loss': '7.8542'}
2025-03-07 12:24:27,772 - {'Epoch': 31, 'HR@5': '0.0492', 'NDCG@5': '0.0348', 'HR@10': '0.0703', 'NDCG@10': '0.0415', 'HR@20': '0.0991', 'NDCG@20': '0.0488'}
2025-03-07 12:24:27,774 - Validation score increased.  Saving model ...
2025-03-07 12:24:59,973 - {'epoch': 32, 'rec_loss': '7.8490'}
2025-03-07 12:25:19,589 - {'Epoch': 32, 'HR@5': '0.0494', 'NDCG@5': '0.0349', 'HR@10': '0.0705', 'NDCG@10': '0.0417', 'HR@20': '0.0993', 'NDCG@20': '0.0489'}
2025-03-07 12:25:19,595 - Validation score increased.  Saving model ...
2025-03-07 12:25:51,892 - {'epoch': 33, 'rec_loss': '7.8359'}
2025-03-07 12:26:14,520 - {'Epoch': 33, 'HR@5': '0.0497', 'NDCG@5': '0.0351', 'HR@10': '0.0709', 'NDCG@10': '0.0419', 'HR@20': '0.1003', 'NDCG@20': '0.0492'}
2025-03-07 12:26:14,522 - Validation score increased.  Saving model ...
2025-03-07 12:27:01,348 - {'epoch': 34, 'rec_loss': '7.8247'}
2025-03-07 12:27:26,541 - {'Epoch': 34, 'HR@5': '0.0496', 'NDCG@5': '0.0351', 'HR@10': '0.0702', 'NDCG@10': '0.0417', 'HR@20': '0.0994', 'NDCG@20': '0.0491'}
2025-03-07 12:27:26,548 - EarlyStopping counter: 1 out of 10
2025-03-07 12:28:08,114 - {'epoch': 35, 'rec_loss': '7.8216'}
2025-03-07 12:28:28,574 - {'Epoch': 35, 'HR@5': '0.0502', 'NDCG@5': '0.0352', 'HR@10': '0.0713', 'NDCG@10': '0.0419', 'HR@20': '0.0998', 'NDCG@20': '0.0491'}
2025-03-07 12:28:28,575 - EarlyStopping counter: 2 out of 10
2025-03-07 12:29:00,671 - {'epoch': 36, 'rec_loss': '7.8173'}
2025-03-07 12:29:20,568 - {'Epoch': 36, 'HR@5': '0.0499', 'NDCG@5': '0.0350', 'HR@10': '0.0715', 'NDCG@10': '0.0420', 'HR@20': '0.1009', 'NDCG@20': '0.0494'}
2025-03-07 12:29:20,572 - Validation score increased.  Saving model ...
2025-03-07 12:29:58,335 - {'epoch': 37, 'rec_loss': '7.8042'}
2025-03-07 12:30:22,967 - {'Epoch': 37, 'HR@5': '0.0503', 'NDCG@5': '0.0353', 'HR@10': '0.0724', 'NDCG@10': '0.0424', 'HR@20': '0.1007', 'NDCG@20': '0.0495'}
2025-03-07 12:30:22,971 - Validation score increased.  Saving model ...
2025-03-07 12:31:07,878 - {'epoch': 38, 'rec_loss': '7.7981'}
2025-03-07 12:31:33,787 - {'Epoch': 38, 'HR@5': '0.0502', 'NDCG@5': '0.0355', 'HR@10': '0.0716', 'NDCG@10': '0.0423', 'HR@20': '0.0998', 'NDCG@20': '0.0494'}
2025-03-07 12:31:33,789 - EarlyStopping counter: 1 out of 10
2025-03-07 12:32:07,221 - {'epoch': 39, 'rec_loss': '7.7945'}
2025-03-07 12:32:26,999 - {'Epoch': 39, 'HR@5': '0.0503', 'NDCG@5': '0.0354', 'HR@10': '0.0713', 'NDCG@10': '0.0421', 'HR@20': '0.1009', 'NDCG@20': '0.0496'}
2025-03-07 12:32:27,005 - Validation score increased.  Saving model ...
2025-03-07 12:32:59,601 - {'epoch': 40, 'rec_loss': '7.7857'}
2025-03-07 12:33:19,625 - {'Epoch': 40, 'HR@5': '0.0510', 'NDCG@5': '0.0359', 'HR@10': '0.0710', 'NDCG@10': '0.0423', 'HR@20': '0.1006', 'NDCG@20': '0.0498'}
2025-03-07 12:33:19,630 - Validation score increased.  Saving model ...
2025-03-07 12:34:02,448 - {'epoch': 41, 'rec_loss': '7.7811'}
2025-03-07 12:34:26,880 - {'Epoch': 41, 'HR@5': '0.0500', 'NDCG@5': '0.0354', 'HR@10': '0.0709', 'NDCG@10': '0.0422', 'HR@20': '0.1002', 'NDCG@20': '0.0495'}
2025-03-07 12:34:26,886 - EarlyStopping counter: 1 out of 10
2025-03-07 12:35:13,608 - {'epoch': 42, 'rec_loss': '7.7794'}
2025-03-07 12:35:34,091 - {'Epoch': 42, 'HR@5': '0.0503', 'NDCG@5': '0.0359', 'HR@10': '0.0711', 'NDCG@10': '0.0426', 'HR@20': '0.0997', 'NDCG@20': '0.0498'}
2025-03-07 12:35:34,092 - Validation score increased.  Saving model ...
2025-03-07 12:36:07,086 - {'epoch': 43, 'rec_loss': '7.7717'}
2025-03-07 12:36:26,923 - {'Epoch': 43, 'HR@5': '0.0511', 'NDCG@5': '0.0363', 'HR@10': '0.0715', 'NDCG@10': '0.0429', 'HR@20': '0.1002', 'NDCG@20': '0.0501'}
2025-03-07 12:36:26,925 - Validation score increased.  Saving model ...
2025-03-07 12:37:02,669 - {'epoch': 44, 'rec_loss': '7.7683'}
2025-03-07 12:37:25,543 - {'Epoch': 44, 'HR@5': '0.0514', 'NDCG@5': '0.0361', 'HR@10': '0.0727', 'NDCG@10': '0.0429', 'HR@20': '0.1018', 'NDCG@20': '0.0502'}
2025-03-07 12:37:25,545 - Validation score increased.  Saving model ...
2025-03-07 12:38:11,345 - {'epoch': 45, 'rec_loss': '7.7609'}
2025-03-07 12:38:35,441 - {'Epoch': 45, 'HR@5': '0.0510', 'NDCG@5': '0.0358', 'HR@10': '0.0719', 'NDCG@10': '0.0425', 'HR@20': '0.1006', 'NDCG@20': '0.0498'}
2025-03-07 12:38:35,448 - EarlyStopping counter: 1 out of 10
2025-03-07 12:39:10,683 - {'epoch': 46, 'rec_loss': '7.7589'}
2025-03-07 12:39:31,289 - {'Epoch': 46, 'HR@5': '0.0512', 'NDCG@5': '0.0359', 'HR@10': '0.0725', 'NDCG@10': '0.0427', 'HR@20': '0.1005', 'NDCG@20': '0.0498'}
2025-03-07 12:39:31,291 - EarlyStopping counter: 2 out of 10
2025-03-07 12:40:04,213 - {'epoch': 47, 'rec_loss': '7.7589'}
2025-03-07 12:40:24,917 - {'Epoch': 47, 'HR@5': '0.0512', 'NDCG@5': '0.0359', 'HR@10': '0.0726', 'NDCG@10': '0.0428', 'HR@20': '0.1018', 'NDCG@20': '0.0501'}
2025-03-07 12:40:24,919 - EarlyStopping counter: 3 out of 10
2025-03-07 12:41:04,125 - {'epoch': 48, 'rec_loss': '7.7476'}
2025-03-07 12:41:27,283 - {'Epoch': 48, 'HR@5': '0.0508', 'NDCG@5': '0.0358', 'HR@10': '0.0718', 'NDCG@10': '0.0425', 'HR@20': '0.1010', 'NDCG@20': '0.0499'}
2025-03-07 12:41:27,285 - EarlyStopping counter: 4 out of 10
2025-03-07 12:42:11,084 - {'epoch': 49, 'rec_loss': '7.7470'}
2025-03-07 12:42:34,131 - {'Epoch': 49, 'HR@5': '0.0509', 'NDCG@5': '0.0362', 'HR@10': '0.0729', 'NDCG@10': '0.0432', 'HR@20': '0.1006', 'NDCG@20': '0.0502'}
2025-03-07 12:42:34,133 - EarlyStopping counter: 5 out of 10
2025-03-07 12:43:09,349 - {'epoch': 50, 'rec_loss': '7.7438'}
2025-03-07 12:43:28,892 - {'Epoch': 50, 'HR@5': '0.0516', 'NDCG@5': '0.0362', 'HR@10': '0.0723', 'NDCG@10': '0.0429', 'HR@20': '0.1009', 'NDCG@20': '0.0501'}
2025-03-07 12:43:28,893 - EarlyStopping counter: 6 out of 10
2025-03-07 12:44:04,321 - {'epoch': 51, 'rec_loss': '7.7360'}
2025-03-07 12:44:25,213 - {'Epoch': 51, 'HR@5': '0.0504', 'NDCG@5': '0.0353', 'HR@10': '0.0726', 'NDCG@10': '0.0425', 'HR@20': '0.0997', 'NDCG@20': '0.0493'}
2025-03-07 12:44:25,215 - EarlyStopping counter: 7 out of 10
2025-03-07 12:45:05,556 - {'epoch': 52, 'rec_loss': '7.7422'}
2025-03-07 12:45:30,518 - {'Epoch': 52, 'HR@5': '0.0509', 'NDCG@5': '0.0359', 'HR@10': '0.0716', 'NDCG@10': '0.0426', 'HR@20': '0.1011', 'NDCG@20': '0.0500'}
2025-03-07 12:45:30,520 - EarlyStopping counter: 8 out of 10
2025-03-07 12:46:09,828 - {'epoch': 53, 'rec_loss': '7.7306'}
2025-03-07 12:46:31,106 - {'Epoch': 53, 'HR@5': '0.0507', 'NDCG@5': '0.0360', 'HR@10': '0.0717', 'NDCG@10': '0.0428', 'HR@20': '0.1014', 'NDCG@20': '0.0502'}
2025-03-07 12:46:31,113 - Validation score increased.  Saving model ...
2025-03-07 12:47:05,737 - {'epoch': 54, 'rec_loss': '7.7225'}
2025-03-07 12:47:26,581 - {'Epoch': 54, 'HR@5': '0.0507', 'NDCG@5': '0.0361', 'HR@10': '0.0729', 'NDCG@10': '0.0433', 'HR@20': '0.1014', 'NDCG@20': '0.0504'}
2025-03-07 12:47:26,583 - Validation score increased.  Saving model ...
2025-03-07 12:48:03,227 - {'epoch': 55, 'rec_loss': '7.7241'}
2025-03-07 12:48:26,128 - {'Epoch': 55, 'HR@5': '0.0519', 'NDCG@5': '0.0366', 'HR@10': '0.0728', 'NDCG@10': '0.0434', 'HR@20': '0.1008', 'NDCG@20': '0.0504'}
2025-03-07 12:48:26,132 - EarlyStopping counter: 1 out of 10
2025-03-07 12:49:03,780 - {'epoch': 56, 'rec_loss': '7.7189'}
2025-03-07 12:49:28,281 - {'Epoch': 56, 'HR@5': '0.0516', 'NDCG@5': '0.0363', 'HR@10': '0.0728', 'NDCG@10': '0.0431', 'HR@20': '0.1007', 'NDCG@20': '0.0501'}
2025-03-07 12:49:28,287 - EarlyStopping counter: 2 out of 10
2025-03-07 12:50:04,612 - {'epoch': 57, 'rec_loss': '7.7191'}
2025-03-07 12:50:28,989 - {'Epoch': 57, 'HR@5': '0.0510', 'NDCG@5': '0.0361', 'HR@10': '0.0732', 'NDCG@10': '0.0433', 'HR@20': '0.1008', 'NDCG@20': '0.0502'}
2025-03-07 12:50:28,991 - EarlyStopping counter: 3 out of 10
2025-03-07 12:51:04,248 - {'epoch': 58, 'rec_loss': '7.7131'}
2025-03-07 12:51:25,852 - {'Epoch': 58, 'HR@5': '0.0519', 'NDCG@5': '0.0364', 'HR@10': '0.0727', 'NDCG@10': '0.0430', 'HR@20': '0.1012', 'NDCG@20': '0.0502'}
2025-03-07 12:51:25,859 - EarlyStopping counter: 4 out of 10
2025-03-07 12:52:06,034 - {'epoch': 59, 'rec_loss': '7.7099'}
2025-03-07 12:52:27,222 - {'Epoch': 59, 'HR@5': '0.0523', 'NDCG@5': '0.0366', 'HR@10': '0.0727', 'NDCG@10': '0.0432', 'HR@20': '0.1015', 'NDCG@20': '0.0504'}
2025-03-07 12:52:27,231 - EarlyStopping counter: 5 out of 10
2025-03-07 12:53:07,005 - {'epoch': 60, 'rec_loss': '7.7056'}
2025-03-07 12:53:28,449 - {'Epoch': 60, 'HR@5': '0.0517', 'NDCG@5': '0.0365', 'HR@10': '0.0721', 'NDCG@10': '0.0431', 'HR@20': '0.1007', 'NDCG@20': '0.0503'}
2025-03-07 12:53:28,450 - EarlyStopping counter: 6 out of 10
2025-03-07 12:54:05,996 - {'epoch': 61, 'rec_loss': '7.7033'}
2025-03-07 12:54:29,592 - {'Epoch': 61, 'HR@5': '0.0515', 'NDCG@5': '0.0366', 'HR@10': '0.0728', 'NDCG@10': '0.0434', 'HR@20': '0.1011', 'NDCG@20': '0.0505'}
2025-03-07 12:54:29,597 - Validation score increased.  Saving model ...
2025-03-07 12:55:08,644 - {'epoch': 62, 'rec_loss': '7.7028'}
2025-03-07 12:55:31,866 - {'Epoch': 62, 'HR@5': '0.0515', 'NDCG@5': '0.0364', 'HR@10': '0.0731', 'NDCG@10': '0.0434', 'HR@20': '0.1005', 'NDCG@20': '0.0503'}
2025-03-07 12:55:31,868 - EarlyStopping counter: 1 out of 10
2025-03-07 12:56:06,971 - {'epoch': 63, 'rec_loss': '7.7004'}
2025-03-07 12:56:27,186 - {'Epoch': 63, 'HR@5': '0.0514', 'NDCG@5': '0.0366', 'HR@10': '0.0735', 'NDCG@10': '0.0437', 'HR@20': '0.1021', 'NDCG@20': '0.0509'}
2025-03-07 12:56:27,188 - Validation score increased.  Saving model ...
2025-03-07 12:57:04,578 - {'epoch': 64, 'rec_loss': '7.6936'}
2025-03-07 12:57:28,691 - {'Epoch': 64, 'HR@5': '0.0523', 'NDCG@5': '0.0369', 'HR@10': '0.0725', 'NDCG@10': '0.0434', 'HR@20': '0.1010', 'NDCG@20': '0.0505'}
2025-03-07 12:57:28,693 - EarlyStopping counter: 1 out of 10
2025-03-07 12:58:12,975 - {'epoch': 65, 'rec_loss': '7.6951'}
2025-03-07 12:58:36,616 - {'Epoch': 65, 'HR@5': '0.0525', 'NDCG@5': '0.0370', 'HR@10': '0.0735', 'NDCG@10': '0.0438', 'HR@20': '0.1022', 'NDCG@20': '0.0510'}
2025-03-07 12:58:36,626 - Validation score increased.  Saving model ...
2025-03-07 12:59:14,996 - {'epoch': 66, 'rec_loss': '7.6894'}
2025-03-07 12:59:36,593 - {'Epoch': 66, 'HR@5': '0.0523', 'NDCG@5': '0.0365', 'HR@10': '0.0723', 'NDCG@10': '0.0430', 'HR@20': '0.1013', 'NDCG@20': '0.0503'}
2025-03-07 12:59:36,595 - EarlyStopping counter: 1 out of 10
2025-03-07 13:00:08,087 - {'epoch': 67, 'rec_loss': '7.6854'}
2025-03-07 13:00:29,256 - {'Epoch': 67, 'HR@5': '0.0528', 'NDCG@5': '0.0370', 'HR@10': '0.0739', 'NDCG@10': '0.0438', 'HR@20': '0.1019', 'NDCG@20': '0.0508'}
2025-03-07 13:00:29,258 - EarlyStopping counter: 2 out of 10
2025-03-07 13:01:10,777 - {'epoch': 68, 'rec_loss': '7.6886'}
2025-03-07 13:01:35,366 - {'Epoch': 68, 'HR@5': '0.0509', 'NDCG@5': '0.0360', 'HR@10': '0.0731', 'NDCG@10': '0.0431', 'HR@20': '0.1018', 'NDCG@20': '0.0503'}
2025-03-07 13:01:35,368 - EarlyStopping counter: 3 out of 10
2025-03-07 13:02:19,402 - {'epoch': 69, 'rec_loss': '7.6771'}
2025-03-07 13:02:43,351 - {'Epoch': 69, 'HR@5': '0.0508', 'NDCG@5': '0.0360', 'HR@10': '0.0742', 'NDCG@10': '0.0435', 'HR@20': '0.1013', 'NDCG@20': '0.0503'}
2025-03-07 13:02:43,354 - EarlyStopping counter: 4 out of 10
2025-03-07 13:03:18,269 - {'epoch': 70, 'rec_loss': '7.6743'}
2025-03-07 13:03:38,310 - {'Epoch': 70, 'HR@5': '0.0519', 'NDCG@5': '0.0364', 'HR@10': '0.0730', 'NDCG@10': '0.0432', 'HR@20': '0.1016', 'NDCG@20': '0.0504'}
2025-03-07 13:03:38,315 - EarlyStopping counter: 5 out of 10
2025-03-07 13:04:12,812 - {'epoch': 71, 'rec_loss': '7.6802'}
2025-03-07 13:04:35,692 - {'Epoch': 71, 'HR@5': '0.0511', 'NDCG@5': '0.0364', 'HR@10': '0.0730', 'NDCG@10': '0.0434', 'HR@20': '0.1012', 'NDCG@20': '0.0505'}
2025-03-07 13:04:35,694 - EarlyStopping counter: 6 out of 10
2025-03-07 13:05:21,162 - {'epoch': 72, 'rec_loss': '7.6730'}
2025-03-07 13:05:47,208 - {'Epoch': 72, 'HR@5': '0.0508', 'NDCG@5': '0.0361', 'HR@10': '0.0731', 'NDCG@10': '0.0432', 'HR@20': '0.1007', 'NDCG@20': '0.0502'}
2025-03-07 13:05:47,211 - EarlyStopping counter: 7 out of 10
2025-03-07 13:06:25,082 - {'epoch': 73, 'rec_loss': '7.6687'}
2025-03-07 13:06:45,993 - {'Epoch': 73, 'HR@5': '0.0508', 'NDCG@5': '0.0361', 'HR@10': '0.0730', 'NDCG@10': '0.0432', 'HR@20': '0.1011', 'NDCG@20': '0.0503'}
2025-03-07 13:06:45,995 - EarlyStopping counter: 8 out of 10
2025-03-07 13:07:18,626 - {'epoch': 74, 'rec_loss': '7.6680'}
2025-03-07 13:07:38,711 - {'Epoch': 74, 'HR@5': '0.0509', 'NDCG@5': '0.0360', 'HR@10': '0.0722', 'NDCG@10': '0.0428', 'HR@20': '0.1012', 'NDCG@20': '0.0501'}
2025-03-07 13:07:38,713 - EarlyStopping counter: 9 out of 10
2025-03-07 13:08:17,708 - {'epoch': 75, 'rec_loss': '7.6727'}
2025-03-07 13:08:42,480 - {'Epoch': 75, 'HR@5': '0.0517', 'NDCG@5': '0.0365', 'HR@10': '0.0735', 'NDCG@10': '0.0436', 'HR@20': '0.1011', 'NDCG@20': '0.0505'}
2025-03-07 13:08:42,482 - EarlyStopping counter: 10 out of 10
2025-03-07 13:08:42,483 - Early stopping
2025-03-07 13:08:42,483 - ---------------Test Score---------------
2025-03-07 13:09:09,661 - {'Epoch': 0, 'HR@5': '0.0401', 'NDCG@5': '0.0283', 'HR@10': '0.0580', 'NDCG@10': '0.0341', 'HR@20': '0.0809', 'NDCG@20': '0.0398'}
2025-03-07 13:09:09,662 - Scale_Sports
2025-03-07 13:09:09,664 - {'Epoch': 0, 'HR@5': '0.0401', 'NDCG@5': '0.0283', 'HR@10': '0.0580', 'NDCG@10': '0.0341', 'HR@20': '0.0809', 'NDCG@20': '0.0398'}
2025-03-23 13:21:07,840 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-23 13:21:10,786 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-23 13:21:10,791 - Total Parameters: 1328854
2025-03-23 13:21:53,946 - {'epoch': 0, 'rec_loss': '9.3981'}
2025-03-23 13:22:12,771 - {'Epoch': 0, 'HR@5': '0.0084', 'NDCG@5': '0.0054', 'HR@10': '0.0130', 'NDCG@10': '0.0069', 'HR@20': '0.0232', 'NDCG@20': '0.0095'}
2025-03-23 13:22:12,773 - Validation score increased.  Saving model ...
2025-03-23 13:22:57,503 - {'epoch': 1, 'rec_loss': '9.1047'}
2025-03-23 13:23:16,649 - {'Epoch': 1, 'HR@5': '0.0171', 'NDCG@5': '0.0109', 'HR@10': '0.0289', 'NDCG@10': '0.0147', 'HR@20': '0.0447', 'NDCG@20': '0.0187'}
2025-03-23 13:23:16,650 - Validation score increased.  Saving model ...
2025-03-23 13:23:58,627 - {'epoch': 2, 'rec_loss': '8.8060'}
2025-03-23 13:24:14,939 - {'Epoch': 2, 'HR@5': '0.0240', 'NDCG@5': '0.0154', 'HR@10': '0.0383', 'NDCG@10': '0.0199', 'HR@20': '0.0598', 'NDCG@20': '0.0253'}
2025-03-23 13:24:14,941 - Validation score increased.  Saving model ...
2025-03-23 13:24:56,343 - {'epoch': 3, 'rec_loss': '8.5856'}
2025-03-23 13:25:14,919 - {'Epoch': 3, 'HR@5': '0.0320', 'NDCG@5': '0.0212', 'HR@10': '0.0484', 'NDCG@10': '0.0265', 'HR@20': '0.0716', 'NDCG@20': '0.0323'}
2025-03-23 13:25:14,921 - Validation score increased.  Saving model ...
2025-03-23 13:25:55,842 - {'epoch': 4, 'rec_loss': '8.4207'}
2025-03-23 13:26:14,805 - {'Epoch': 4, 'HR@5': '0.0373', 'NDCG@5': '0.0251', 'HR@10': '0.0555', 'NDCG@10': '0.0309', 'HR@20': '0.0810', 'NDCG@20': '0.0373'}
2025-03-23 13:26:14,807 - Validation score increased.  Saving model ...
2025-03-23 13:26:58,584 - {'epoch': 5, 'rec_loss': '8.2842'}
2025-03-23 13:27:16,269 - {'Epoch': 5, 'HR@5': '0.0414', 'NDCG@5': '0.0282', 'HR@10': '0.0602', 'NDCG@10': '0.0342', 'HR@20': '0.0859', 'NDCG@20': '0.0407'}
2025-03-23 13:27:16,270 - Validation score increased.  Saving model ...
2025-03-23 13:28:00,688 - {'epoch': 6, 'rec_loss': '8.1850'}
2025-03-23 13:28:19,329 - {'Epoch': 6, 'HR@5': '0.0419', 'NDCG@5': '0.0289', 'HR@10': '0.0628', 'NDCG@10': '0.0356', 'HR@20': '0.0897', 'NDCG@20': '0.0424'}
2025-03-23 13:28:19,331 - Validation score increased.  Saving model ...
2025-03-23 13:29:02,383 - {'epoch': 7, 'rec_loss': '8.0971'}
2025-03-23 13:29:22,018 - {'Epoch': 7, 'HR@5': '0.0446', 'NDCG@5': '0.0308', 'HR@10': '0.0640', 'NDCG@10': '0.0370', 'HR@20': '0.0920', 'NDCG@20': '0.0441'}
2025-03-23 13:29:22,020 - Validation score increased.  Saving model ...
2025-03-23 13:30:05,868 - {'epoch': 8, 'rec_loss': '8.0240'}
2025-03-23 13:30:23,833 - {'Epoch': 8, 'HR@5': '0.0460', 'NDCG@5': '0.0321', 'HR@10': '0.0661', 'NDCG@10': '0.0386', 'HR@20': '0.0941', 'NDCG@20': '0.0456'}
2025-03-23 13:30:23,834 - Validation score increased.  Saving model ...
2025-03-23 13:31:05,660 - {'epoch': 9, 'rec_loss': '7.9699'}
2025-03-23 13:31:24,341 - {'Epoch': 9, 'HR@5': '0.0457', 'NDCG@5': '0.0320', 'HR@10': '0.0670', 'NDCG@10': '0.0388', 'HR@20': '0.0949', 'NDCG@20': '0.0458'}
2025-03-23 13:31:24,343 - Validation score increased.  Saving model ...
2025-03-23 13:32:06,685 - {'epoch': 10, 'rec_loss': '7.9193'}
2025-03-23 13:32:26,255 - {'Epoch': 10, 'HR@5': '0.0461', 'NDCG@5': '0.0321', 'HR@10': '0.0674', 'NDCG@10': '0.0389', 'HR@20': '0.0963', 'NDCG@20': '0.0462'}
2025-03-23 13:32:26,257 - Validation score increased.  Saving model ...
2025-03-23 13:33:10,638 - {'epoch': 11, 'rec_loss': '7.8731'}
2025-03-23 13:33:30,144 - {'Epoch': 11, 'HR@5': '0.0480', 'NDCG@5': '0.0333', 'HR@10': '0.0689', 'NDCG@10': '0.0401', 'HR@20': '0.0973', 'NDCG@20': '0.0472'}
2025-03-23 13:33:30,148 - Validation score increased.  Saving model ...
2025-03-23 13:34:13,144 - {'epoch': 12, 'rec_loss': '7.8374'}
2025-03-23 13:34:31,450 - {'Epoch': 12, 'HR@5': '0.0481', 'NDCG@5': '0.0335', 'HR@10': '0.0695', 'NDCG@10': '0.0404', 'HR@20': '0.0988', 'NDCG@20': '0.0478'}
2025-03-23 13:34:31,453 - Validation score increased.  Saving model ...
2025-03-23 13:35:13,792 - {'epoch': 13, 'rec_loss': '7.8062'}
2025-03-23 13:35:32,385 - {'Epoch': 13, 'HR@5': '0.0489', 'NDCG@5': '0.0340', 'HR@10': '0.0700', 'NDCG@10': '0.0407', 'HR@20': '0.0993', 'NDCG@20': '0.0481'}
2025-03-23 13:35:32,387 - Validation score increased.  Saving model ...
2025-03-23 13:36:15,720 - {'epoch': 14, 'rec_loss': '7.7807'}
2025-03-23 13:36:34,925 - {'Epoch': 14, 'HR@5': '0.0496', 'NDCG@5': '0.0345', 'HR@10': '0.0703', 'NDCG@10': '0.0412', 'HR@20': '0.0998', 'NDCG@20': '0.0486'}
2025-03-23 13:36:34,926 - Validation score increased.  Saving model ...
2025-03-23 13:37:17,695 - {'epoch': 15, 'rec_loss': '7.7544'}
2025-03-23 13:37:34,456 - {'Epoch': 15, 'HR@5': '0.0486', 'NDCG@5': '0.0340', 'HR@10': '0.0706', 'NDCG@10': '0.0411', 'HR@20': '0.0996', 'NDCG@20': '0.0483'}
2025-03-23 13:37:34,458 - EarlyStopping counter: 1 out of 10
2025-03-23 13:38:17,363 - {'epoch': 16, 'rec_loss': '7.7294'}
2025-03-23 13:38:36,655 - {'Epoch': 16, 'HR@5': '0.0494', 'NDCG@5': '0.0345', 'HR@10': '0.0708', 'NDCG@10': '0.0414', 'HR@20': '0.0998', 'NDCG@20': '0.0487'}
2025-03-23 13:38:36,657 - Validation score increased.  Saving model ...
2025-03-23 13:39:20,278 - {'epoch': 17, 'rec_loss': '7.7125'}
2025-03-23 13:39:39,648 - {'Epoch': 17, 'HR@5': '0.0496', 'NDCG@5': '0.0348', 'HR@10': '0.0710', 'NDCG@10': '0.0417', 'HR@20': '0.1008', 'NDCG@20': '0.0492'}
2025-03-23 13:39:39,649 - Validation score increased.  Saving model ...
2025-03-23 13:40:24,582 - {'epoch': 18, 'rec_loss': '7.6951'}
2025-03-23 13:40:42,055 - {'Epoch': 18, 'HR@5': '0.0501', 'NDCG@5': '0.0347', 'HR@10': '0.0714', 'NDCG@10': '0.0415', 'HR@20': '0.1017', 'NDCG@20': '0.0491'}
2025-03-23 13:40:42,057 - EarlyStopping counter: 1 out of 10
2025-03-23 13:41:25,601 - {'epoch': 19, 'rec_loss': '7.6729'}
2025-03-23 13:41:44,815 - {'Epoch': 19, 'HR@5': '0.0504', 'NDCG@5': '0.0350', 'HR@10': '0.0717', 'NDCG@10': '0.0418', 'HR@20': '0.1017', 'NDCG@20': '0.0494'}
2025-03-23 13:41:44,816 - Validation score increased.  Saving model ...
2025-03-23 13:42:27,581 - {'epoch': 20, 'rec_loss': '7.6613'}
2025-03-23 13:42:46,547 - {'Epoch': 20, 'HR@5': '0.0514', 'NDCG@5': '0.0359', 'HR@10': '0.0741', 'NDCG@10': '0.0432', 'HR@20': '0.1028', 'NDCG@20': '0.0504'}
2025-03-23 13:42:46,548 - Validation score increased.  Saving model ...
2025-03-23 13:43:29,736 - {'epoch': 21, 'rec_loss': '7.6418'}
2025-03-23 13:43:48,311 - {'Epoch': 21, 'HR@5': '0.0500', 'NDCG@5': '0.0346', 'HR@10': '0.0708', 'NDCG@10': '0.0413', 'HR@20': '0.1009', 'NDCG@20': '0.0489'}
2025-03-23 13:43:48,312 - EarlyStopping counter: 1 out of 10
2025-03-23 13:44:34,343 - {'epoch': 22, 'rec_loss': '7.6310'}
2025-03-23 13:44:52,448 - {'Epoch': 22, 'HR@5': '0.0509', 'NDCG@5': '0.0355', 'HR@10': '0.0731', 'NDCG@10': '0.0427', 'HR@20': '0.1019', 'NDCG@20': '0.0500'}
2025-03-23 13:44:52,449 - EarlyStopping counter: 2 out of 10
2025-03-23 13:45:35,343 - {'epoch': 23, 'rec_loss': '7.6204'}
2025-03-23 13:45:54,805 - {'Epoch': 23, 'HR@5': '0.0506', 'NDCG@5': '0.0353', 'HR@10': '0.0728', 'NDCG@10': '0.0425', 'HR@20': '0.1014', 'NDCG@20': '0.0496'}
2025-03-23 13:45:54,807 - EarlyStopping counter: 3 out of 10
2025-03-23 13:46:37,485 - {'epoch': 24, 'rec_loss': '7.6044'}
2025-03-23 13:46:56,272 - {'Epoch': 24, 'HR@5': '0.0509', 'NDCG@5': '0.0360', 'HR@10': '0.0742', 'NDCG@10': '0.0435', 'HR@20': '0.1032', 'NDCG@20': '0.0508'}
2025-03-23 13:46:56,274 - Validation score increased.  Saving model ...
2025-03-23 13:47:39,466 - {'epoch': 25, 'rec_loss': '7.5943'}
2025-03-23 13:47:57,484 - {'Epoch': 25, 'HR@5': '0.0512', 'NDCG@5': '0.0356', 'HR@10': '0.0736', 'NDCG@10': '0.0429', 'HR@20': '0.1041', 'NDCG@20': '0.0505'}
2025-03-23 13:47:57,485 - EarlyStopping counter: 1 out of 10
2025-03-23 13:48:40,927 - {'epoch': 26, 'rec_loss': '7.5801'}
2025-03-23 13:49:00,062 - {'Epoch': 26, 'HR@5': '0.0521', 'NDCG@5': '0.0366', 'HR@10': '0.0751', 'NDCG@10': '0.0440', 'HR@20': '0.1022', 'NDCG@20': '0.0508'}
2025-03-23 13:49:00,064 - Validation score increased.  Saving model ...
2025-03-23 13:49:44,232 - {'epoch': 27, 'rec_loss': '7.5712'}
2025-03-23 13:50:03,879 - {'Epoch': 27, 'HR@5': '0.0525', 'NDCG@5': '0.0363', 'HR@10': '0.0742', 'NDCG@10': '0.0433', 'HR@20': '0.1030', 'NDCG@20': '0.0505'}
2025-03-23 13:50:03,881 - EarlyStopping counter: 1 out of 10
2025-03-23 13:50:46,014 - {'epoch': 28, 'rec_loss': '7.5655'}
2025-03-23 13:51:03,677 - {'Epoch': 28, 'HR@5': '0.0520', 'NDCG@5': '0.0364', 'HR@10': '0.0748', 'NDCG@10': '0.0437', 'HR@20': '0.1038', 'NDCG@20': '0.0511'}
2025-03-23 13:51:03,679 - Validation score increased.  Saving model ...
2025-03-23 13:51:45,025 - {'epoch': 29, 'rec_loss': '7.5551'}
2025-03-23 13:52:03,835 - {'Epoch': 29, 'HR@5': '0.0512', 'NDCG@5': '0.0358', 'HR@10': '0.0741', 'NDCG@10': '0.0432', 'HR@20': '0.1037', 'NDCG@20': '0.0507'}
2025-03-23 13:52:03,837 - EarlyStopping counter: 1 out of 10
2025-03-23 13:52:45,691 - {'epoch': 30, 'rec_loss': '7.5486'}
2025-03-23 13:53:04,753 - {'Epoch': 30, 'HR@5': '0.0518', 'NDCG@5': '0.0359', 'HR@10': '0.0740', 'NDCG@10': '0.0430', 'HR@20': '0.1041', 'NDCG@20': '0.0506'}
2025-03-23 13:53:04,755 - EarlyStopping counter: 2 out of 10
2025-03-23 13:53:48,349 - {'epoch': 31, 'rec_loss': '7.5345'}
2025-03-23 13:54:06,816 - {'Epoch': 31, 'HR@5': '0.0525', 'NDCG@5': '0.0363', 'HR@10': '0.0746', 'NDCG@10': '0.0434', 'HR@20': '0.1034', 'NDCG@20': '0.0506'}
2025-03-23 13:54:06,817 - EarlyStopping counter: 3 out of 10
2025-03-23 13:54:48,902 - {'epoch': 32, 'rec_loss': '7.5249'}
2025-03-23 13:55:08,461 - {'Epoch': 32, 'HR@5': '0.0521', 'NDCG@5': '0.0361', 'HR@10': '0.0746', 'NDCG@10': '0.0434', 'HR@20': '0.1053', 'NDCG@20': '0.0511'}
2025-03-23 13:55:08,462 - Validation score increased.  Saving model ...
2025-03-23 13:55:51,549 - {'epoch': 33, 'rec_loss': '7.5150'}
2025-03-23 13:56:10,312 - {'Epoch': 33, 'HR@5': '0.0517', 'NDCG@5': '0.0363', 'HR@10': '0.0739', 'NDCG@10': '0.0434', 'HR@20': '0.1046', 'NDCG@20': '0.0512'}
2025-03-23 13:56:10,313 - Validation score increased.  Saving model ...
2025-03-23 13:56:53,570 - {'epoch': 34, 'rec_loss': '7.5099'}
2025-03-23 13:57:12,032 - {'Epoch': 34, 'HR@5': '0.0515', 'NDCG@5': '0.0360', 'HR@10': '0.0742', 'NDCG@10': '0.0432', 'HR@20': '0.1036', 'NDCG@20': '0.0506'}
2025-03-23 13:57:12,035 - EarlyStopping counter: 1 out of 10
2025-03-23 13:57:53,714 - {'epoch': 35, 'rec_loss': '7.5050'}
2025-03-23 13:58:11,682 - {'Epoch': 35, 'HR@5': '0.0522', 'NDCG@5': '0.0368', 'HR@10': '0.0747', 'NDCG@10': '0.0440', 'HR@20': '0.1065', 'NDCG@20': '0.0520'}
2025-03-23 13:58:11,684 - Validation score increased.  Saving model ...
2025-03-23 13:58:53,921 - {'epoch': 36, 'rec_loss': '7.4989'}
2025-03-23 13:59:13,190 - {'Epoch': 36, 'HR@5': '0.0522', 'NDCG@5': '0.0362', 'HR@10': '0.0751', 'NDCG@10': '0.0435', 'HR@20': '0.1046', 'NDCG@20': '0.0510'}
2025-03-23 13:59:13,196 - EarlyStopping counter: 1 out of 10
2025-03-23 13:59:57,436 - {'epoch': 37, 'rec_loss': '7.4881'}
2025-03-23 14:00:16,270 - {'Epoch': 37, 'HR@5': '0.0514', 'NDCG@5': '0.0358', 'HR@10': '0.0751', 'NDCG@10': '0.0435', 'HR@20': '0.1059', 'NDCG@20': '0.0512'}
2025-03-23 14:00:16,272 - EarlyStopping counter: 2 out of 10
2025-03-23 14:00:56,543 - {'epoch': 38, 'rec_loss': '7.4758'}
2025-03-23 14:01:13,474 - {'Epoch': 38, 'HR@5': '0.0523', 'NDCG@5': '0.0365', 'HR@10': '0.0747', 'NDCG@10': '0.0437', 'HR@20': '0.1064', 'NDCG@20': '0.0517'}
2025-03-23 14:01:13,477 - EarlyStopping counter: 3 out of 10
2025-03-23 14:01:53,951 - {'epoch': 39, 'rec_loss': '7.4709'}
2025-03-23 14:02:13,514 - {'Epoch': 39, 'HR@5': '0.0523', 'NDCG@5': '0.0365', 'HR@10': '0.0751', 'NDCG@10': '0.0438', 'HR@20': '0.1055', 'NDCG@20': '0.0515'}
2025-03-23 14:02:13,517 - EarlyStopping counter: 4 out of 10
2025-03-23 14:02:55,715 - {'epoch': 40, 'rec_loss': '7.4687'}
2025-03-23 14:03:15,088 - {'Epoch': 40, 'HR@5': '0.0521', 'NDCG@5': '0.0363', 'HR@10': '0.0746', 'NDCG@10': '0.0435', 'HR@20': '0.1051', 'NDCG@20': '0.0512'}
2025-03-23 14:03:15,089 - EarlyStopping counter: 5 out of 10
2025-03-23 14:03:56,665 - {'epoch': 41, 'rec_loss': '7.4602'}
2025-03-23 14:04:13,886 - {'Epoch': 41, 'HR@5': '0.0520', 'NDCG@5': '0.0364', 'HR@10': '0.0745', 'NDCG@10': '0.0436', 'HR@20': '0.1053', 'NDCG@20': '0.0513'}
2025-03-23 14:04:13,888 - EarlyStopping counter: 6 out of 10
2025-03-23 14:04:53,759 - {'epoch': 42, 'rec_loss': '7.4522'}
2025-03-23 14:05:12,730 - {'Epoch': 42, 'HR@5': '0.0523', 'NDCG@5': '0.0365', 'HR@10': '0.0751', 'NDCG@10': '0.0438', 'HR@20': '0.1051', 'NDCG@20': '0.0514'}
2025-03-23 14:05:12,731 - EarlyStopping counter: 7 out of 10
2025-03-23 14:05:54,269 - {'epoch': 43, 'rec_loss': '7.4504'}
2025-03-23 14:06:13,853 - {'Epoch': 43, 'HR@5': '0.0527', 'NDCG@5': '0.0366', 'HR@10': '0.0746', 'NDCG@10': '0.0436', 'HR@20': '0.1050', 'NDCG@20': '0.0513'}
2025-03-23 14:06:13,854 - EarlyStopping counter: 8 out of 10
2025-03-23 14:06:57,094 - {'epoch': 44, 'rec_loss': '7.4409'}
2025-03-23 14:07:16,312 - {'Epoch': 44, 'HR@5': '0.0534', 'NDCG@5': '0.0370', 'HR@10': '0.0762', 'NDCG@10': '0.0443', 'HR@20': '0.1077', 'NDCG@20': '0.0523'}
2025-03-23 14:07:16,314 - Validation score increased.  Saving model ...
2025-03-23 14:07:59,645 - {'epoch': 45, 'rec_loss': '7.4339'}
2025-03-23 14:08:18,779 - {'Epoch': 45, 'HR@5': '0.0531', 'NDCG@5': '0.0367', 'HR@10': '0.0758', 'NDCG@10': '0.0440', 'HR@20': '0.1063', 'NDCG@20': '0.0517'}
2025-03-23 14:08:18,783 - EarlyStopping counter: 1 out of 10
2025-03-23 14:08:59,928 - {'epoch': 46, 'rec_loss': '7.4334'}
2025-03-23 14:09:18,963 - {'Epoch': 46, 'HR@5': '0.0523', 'NDCG@5': '0.0361', 'HR@10': '0.0765', 'NDCG@10': '0.0439', 'HR@20': '0.1065', 'NDCG@20': '0.0514'}
2025-03-23 14:09:18,964 - EarlyStopping counter: 2 out of 10
2025-03-23 14:10:02,015 - {'epoch': 47, 'rec_loss': '7.4302'}
2025-03-23 14:10:21,087 - {'Epoch': 47, 'HR@5': '0.0531', 'NDCG@5': '0.0370', 'HR@10': '0.0758', 'NDCG@10': '0.0443', 'HR@20': '0.1068', 'NDCG@20': '0.0520'}
2025-03-23 14:10:21,089 - EarlyStopping counter: 3 out of 10
2025-03-23 14:11:02,907 - {'epoch': 48, 'rec_loss': '7.4208'}
2025-03-23 14:11:19,721 - {'Epoch': 48, 'HR@5': '0.0525', 'NDCG@5': '0.0362', 'HR@10': '0.0755', 'NDCG@10': '0.0436', 'HR@20': '0.1057', 'NDCG@20': '0.0512'}
2025-03-23 14:11:19,722 - EarlyStopping counter: 4 out of 10
2025-03-23 14:12:02,152 - {'epoch': 49, 'rec_loss': '7.4192'}
2025-03-23 14:12:22,399 - {'Epoch': 49, 'HR@5': '0.0520', 'NDCG@5': '0.0361', 'HR@10': '0.0748', 'NDCG@10': '0.0434', 'HR@20': '0.1061', 'NDCG@20': '0.0513'}
2025-03-23 14:12:22,401 - EarlyStopping counter: 5 out of 10
2025-03-23 14:13:02,885 - {'epoch': 50, 'rec_loss': '7.4129'}
2025-03-23 14:13:22,472 - {'Epoch': 50, 'HR@5': '0.0522', 'NDCG@5': '0.0360', 'HR@10': '0.0746', 'NDCG@10': '0.0432', 'HR@20': '0.1058', 'NDCG@20': '0.0511'}
2025-03-23 14:13:22,477 - EarlyStopping counter: 6 out of 10
2025-03-23 14:14:03,635 - {'epoch': 51, 'rec_loss': '7.4054'}
2025-03-23 14:14:20,405 - {'Epoch': 51, 'HR@5': '0.0519', 'NDCG@5': '0.0359', 'HR@10': '0.0748', 'NDCG@10': '0.0432', 'HR@20': '0.1066', 'NDCG@20': '0.0512'}
2025-03-23 14:14:20,409 - EarlyStopping counter: 7 out of 10
2025-03-23 14:14:59,896 - {'epoch': 52, 'rec_loss': '7.4016'}
2025-03-23 14:15:19,604 - {'Epoch': 52, 'HR@5': '0.0519', 'NDCG@5': '0.0359', 'HR@10': '0.0744', 'NDCG@10': '0.0431', 'HR@20': '0.1057', 'NDCG@20': '0.0510'}
2025-03-23 14:15:19,605 - EarlyStopping counter: 8 out of 10
2025-03-23 14:16:01,246 - {'epoch': 53, 'rec_loss': '7.3997'}
2025-03-23 14:16:19,974 - {'Epoch': 53, 'HR@5': '0.0525', 'NDCG@5': '0.0364', 'HR@10': '0.0754', 'NDCG@10': '0.0438', 'HR@20': '0.1071', 'NDCG@20': '0.0517'}
2025-03-23 14:16:19,976 - EarlyStopping counter: 9 out of 10
2025-03-23 14:17:02,820 - {'epoch': 54, 'rec_loss': '7.3926'}
2025-03-23 14:17:20,272 - {'Epoch': 54, 'HR@5': '0.0521', 'NDCG@5': '0.0359', 'HR@10': '0.0754', 'NDCG@10': '0.0434', 'HR@20': '0.1055', 'NDCG@20': '0.0510'}
2025-03-23 14:17:20,273 - EarlyStopping counter: 10 out of 10
2025-03-23 14:17:20,274 - Early stopping
2025-03-23 14:17:20,274 - ---------------Test Score---------------
2025-03-23 14:17:39,435 - {'Epoch': 0, 'HR@5': '0.0439', 'NDCG@5': '0.0302', 'HR@10': '0.0631', 'NDCG@10': '0.0364', 'HR@20': '0.0891', 'NDCG@20': '0.0429'}
2025-03-23 14:17:39,436 - Scale_Sports
2025-03-23 14:17:39,437 - {'Epoch': 0, 'HR@5': '0.0439', 'NDCG@5': '0.0302', 'HR@10': '0.0631', 'NDCG@10': '0.0364', 'HR@20': '0.0891', 'NDCG@20': '0.0429'}
2025-03-23 14:41:36,117 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-23 14:41:39,040 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-23 14:41:39,048 - Total Parameters: 1328854
2025-03-23 15:44:48,804 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-23 15:44:52,062 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-23 15:44:52,070 - Total Parameters: 1328854
2025-03-23 15:45:35,711 - {'epoch': 0, 'rec_loss': '9.4376'}
2025-03-23 15:45:55,341 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0053', 'HR@10': '0.0128', 'NDCG@10': '0.0068', 'HR@20': '0.0207', 'NDCG@20': '0.0087'}
2025-03-23 15:45:55,343 - Validation score increased.  Saving model ...
2025-03-23 15:46:37,297 - {'epoch': 1, 'rec_loss': '9.3111'}
2025-03-23 15:46:56,331 - {'Epoch': 1, 'HR@5': '0.0083', 'NDCG@5': '0.0055', 'HR@10': '0.0130', 'NDCG@10': '0.0070', 'HR@20': '0.0219', 'NDCG@20': '0.0092'}
2025-03-23 15:46:56,337 - Validation score increased.  Saving model ...
2025-03-23 15:47:38,240 - {'epoch': 2, 'rec_loss': '9.2591'}
2025-03-23 15:47:55,026 - {'Epoch': 2, 'HR@5': '0.0110', 'NDCG@5': '0.0069', 'HR@10': '0.0167', 'NDCG@10': '0.0087', 'HR@20': '0.0312', 'NDCG@20': '0.0124'}
2025-03-23 15:47:55,027 - Validation score increased.  Saving model ...
2025-03-23 15:48:36,589 - {'epoch': 3, 'rec_loss': '9.1324'}
2025-03-23 15:48:54,550 - {'Epoch': 3, 'HR@5': '0.0141', 'NDCG@5': '0.0088', 'HR@10': '0.0235', 'NDCG@10': '0.0118', 'HR@20': '0.0383', 'NDCG@20': '0.0156'}
2025-03-23 15:48:54,552 - Validation score increased.  Saving model ...
2025-03-23 15:49:38,072 - {'epoch': 4, 'rec_loss': '9.0212'}
2025-03-23 15:49:55,740 - {'Epoch': 4, 'HR@5': '0.0158', 'NDCG@5': '0.0102', 'HR@10': '0.0271', 'NDCG@10': '0.0139', 'HR@20': '0.0446', 'NDCG@20': '0.0182'}
2025-03-23 15:49:55,741 - Validation score increased.  Saving model ...
2025-03-23 15:50:38,400 - {'epoch': 5, 'rec_loss': '8.9370'}
2025-03-23 15:50:54,399 - {'Epoch': 5, 'HR@5': '0.0183', 'NDCG@5': '0.0115', 'HR@10': '0.0292', 'NDCG@10': '0.0150', 'HR@20': '0.0475', 'NDCG@20': '0.0196'}
2025-03-23 15:50:54,400 - Validation score increased.  Saving model ...
2025-03-23 15:51:37,377 - {'epoch': 6, 'rec_loss': '8.8680'}
2025-03-23 15:51:55,308 - {'Epoch': 6, 'HR@5': '0.0198', 'NDCG@5': '0.0128', 'HR@10': '0.0320', 'NDCG@10': '0.0167', 'HR@20': '0.0508', 'NDCG@20': '0.0214'}
2025-03-23 15:51:55,310 - Validation score increased.  Saving model ...
2025-03-23 15:52:37,383 - {'epoch': 7, 'rec_loss': '8.8078'}
2025-03-23 15:52:55,046 - {'Epoch': 7, 'HR@5': '0.0201', 'NDCG@5': '0.0132', 'HR@10': '0.0340', 'NDCG@10': '0.0176', 'HR@20': '0.0549', 'NDCG@20': '0.0229'}
2025-03-23 15:52:55,050 - Validation score increased.  Saving model ...
2025-03-23 15:53:37,586 - {'epoch': 8, 'rec_loss': '8.7581'}
2025-03-23 15:53:55,637 - {'Epoch': 8, 'HR@5': '0.0246', 'NDCG@5': '0.0162', 'HR@10': '0.0397', 'NDCG@10': '0.0210', 'HR@20': '0.0609', 'NDCG@20': '0.0263'}
2025-03-23 15:53:55,639 - Validation score increased.  Saving model ...
2025-03-23 15:54:36,368 - {'epoch': 9, 'rec_loss': '8.7079'}
2025-03-23 15:54:53,048 - {'Epoch': 9, 'HR@5': '0.0271', 'NDCG@5': '0.0176', 'HR@10': '0.0428', 'NDCG@10': '0.0227', 'HR@20': '0.0657', 'NDCG@20': '0.0284'}
2025-03-23 15:54:53,049 - Validation score increased.  Saving model ...
2025-03-23 15:55:34,846 - {'epoch': 10, 'rec_loss': '8.6671'}
2025-03-23 15:55:53,320 - {'Epoch': 10, 'HR@5': '0.0294', 'NDCG@5': '0.0193', 'HR@10': '0.0458', 'NDCG@10': '0.0245', 'HR@20': '0.0688', 'NDCG@20': '0.0303'}
2025-03-23 15:55:53,322 - Validation score increased.  Saving model ...
2025-03-23 15:56:35,088 - {'epoch': 11, 'rec_loss': '8.6271'}
2025-03-23 15:56:53,528 - {'Epoch': 11, 'HR@5': '0.0294', 'NDCG@5': '0.0194', 'HR@10': '0.0482', 'NDCG@10': '0.0254', 'HR@20': '0.0724', 'NDCG@20': '0.0315'}
2025-03-23 15:56:53,533 - Validation score increased.  Saving model ...
2025-03-23 15:57:34,503 - {'epoch': 12, 'rec_loss': '8.5921'}
2025-03-23 15:57:52,096 - {'Epoch': 12, 'HR@5': '0.0328', 'NDCG@5': '0.0212', 'HR@10': '0.0497', 'NDCG@10': '0.0267', 'HR@20': '0.0749', 'NDCG@20': '0.0330'}
2025-03-23 15:57:52,098 - Validation score increased.  Saving model ...
2025-03-23 15:58:31,285 - {'epoch': 13, 'rec_loss': '8.5562'}
2025-03-23 15:58:49,918 - {'Epoch': 13, 'HR@5': '0.0318', 'NDCG@5': '0.0209', 'HR@10': '0.0514', 'NDCG@10': '0.0272', 'HR@20': '0.0763', 'NDCG@20': '0.0334'}
2025-03-23 15:58:49,923 - Validation score increased.  Saving model ...
2025-03-23 15:59:30,236 - {'epoch': 14, 'rec_loss': '8.5245'}
2025-03-23 15:59:48,465 - {'Epoch': 14, 'HR@5': '0.0348', 'NDCG@5': '0.0228', 'HR@10': '0.0526', 'NDCG@10': '0.0286', 'HR@20': '0.0785', 'NDCG@20': '0.0351'}
2025-03-23 15:59:48,467 - Validation score increased.  Saving model ...
2025-03-23 16:00:30,067 - {'epoch': 15, 'rec_loss': '8.5012'}
2025-03-23 16:00:47,751 - {'Epoch': 15, 'HR@5': '0.0365', 'NDCG@5': '0.0242', 'HR@10': '0.0544', 'NDCG@10': '0.0300', 'HR@20': '0.0810', 'NDCG@20': '0.0367'}
2025-03-23 16:00:47,755 - Validation score increased.  Saving model ...
2025-03-23 16:01:28,483 - {'epoch': 16, 'rec_loss': '8.4755'}
2025-03-23 16:01:44,865 - {'Epoch': 16, 'HR@5': '0.0358', 'NDCG@5': '0.0242', 'HR@10': '0.0544', 'NDCG@10': '0.0302', 'HR@20': '0.0818', 'NDCG@20': '0.0370'}
2025-03-23 16:01:44,866 - Validation score increased.  Saving model ...
2025-03-23 16:02:25,668 - {'epoch': 17, 'rec_loss': '8.4562'}
2025-03-23 16:02:45,093 - {'Epoch': 17, 'HR@5': '0.0377', 'NDCG@5': '0.0251', 'HR@10': '0.0563', 'NDCG@10': '0.0311', 'HR@20': '0.0836', 'NDCG@20': '0.0380'}
2025-03-23 16:02:45,095 - Validation score increased.  Saving model ...
2025-03-23 16:03:25,914 - {'epoch': 18, 'rec_loss': '8.4324'}
2025-03-23 16:03:44,293 - {'Epoch': 18, 'HR@5': '0.0387', 'NDCG@5': '0.0260', 'HR@10': '0.0583', 'NDCG@10': '0.0323', 'HR@20': '0.0856', 'NDCG@20': '0.0391'}
2025-03-23 16:03:44,297 - Validation score increased.  Saving model ...
2025-03-23 16:04:23,621 - {'epoch': 19, 'rec_loss': '8.4173'}
2025-03-23 16:04:39,774 - {'Epoch': 19, 'HR@5': '0.0390', 'NDCG@5': '0.0259', 'HR@10': '0.0585', 'NDCG@10': '0.0322', 'HR@20': '0.0863', 'NDCG@20': '0.0391'}
2025-03-23 16:04:39,777 - EarlyStopping counter: 1 out of 10
2025-03-23 16:05:20,897 - {'epoch': 20, 'rec_loss': '8.3920'}
2025-03-23 16:05:40,402 - {'Epoch': 20, 'HR@5': '0.0405', 'NDCG@5': '0.0272', 'HR@10': '0.0594', 'NDCG@10': '0.0332', 'HR@20': '0.0872', 'NDCG@20': '0.0402'}
2025-03-23 16:05:40,403 - Validation score increased.  Saving model ...
2025-03-23 16:06:21,834 - {'epoch': 21, 'rec_loss': '8.3825'}
2025-03-23 16:06:41,178 - {'Epoch': 21, 'HR@5': '0.0394', 'NDCG@5': '0.0263', 'HR@10': '0.0591', 'NDCG@10': '0.0326', 'HR@20': '0.0887', 'NDCG@20': '0.0400'}
2025-03-23 16:06:41,180 - EarlyStopping counter: 1 out of 10
2025-03-23 16:07:25,168 - {'epoch': 22, 'rec_loss': '8.3658'}
2025-03-23 16:07:40,736 - {'Epoch': 22, 'HR@5': '0.0402', 'NDCG@5': '0.0269', 'HR@10': '0.0609', 'NDCG@10': '0.0336', 'HR@20': '0.0891', 'NDCG@20': '0.0407'}
2025-03-23 16:07:40,738 - Validation score increased.  Saving model ...
2025-03-23 16:08:19,919 - {'epoch': 23, 'rec_loss': '8.3538'}
2025-03-23 16:08:38,790 - {'Epoch': 23, 'HR@5': '0.0423', 'NDCG@5': '0.0281', 'HR@10': '0.0622', 'NDCG@10': '0.0345', 'HR@20': '0.0908', 'NDCG@20': '0.0417'}
2025-03-23 16:08:38,791 - Validation score increased.  Saving model ...
2025-03-23 16:09:20,002 - {'epoch': 24, 'rec_loss': '8.3396'}
2025-03-23 16:09:38,522 - {'Epoch': 24, 'HR@5': '0.0415', 'NDCG@5': '0.0281', 'HR@10': '0.0623', 'NDCG@10': '0.0348', 'HR@20': '0.0914', 'NDCG@20': '0.0421'}
2025-03-23 16:09:38,527 - Validation score increased.  Saving model ...
2025-03-23 16:10:19,802 - {'epoch': 25, 'rec_loss': '8.3315'}
2025-03-23 16:10:38,606 - {'Epoch': 25, 'HR@5': '0.0426', 'NDCG@5': '0.0285', 'HR@10': '0.0624', 'NDCG@10': '0.0349', 'HR@20': '0.0921', 'NDCG@20': '0.0424'}
2025-03-23 16:10:38,608 - Validation score increased.  Saving model ...
2025-03-23 16:11:19,772 - {'epoch': 26, 'rec_loss': '8.3180'}
2025-03-23 16:11:37,311 - {'Epoch': 26, 'HR@5': '0.0435', 'NDCG@5': '0.0295', 'HR@10': '0.0633', 'NDCG@10': '0.0358', 'HR@20': '0.0919', 'NDCG@20': '0.0430'}
2025-03-23 16:11:37,313 - Validation score increased.  Saving model ...
2025-03-23 16:12:19,848 - {'epoch': 27, 'rec_loss': '8.3107'}
2025-03-23 16:12:38,938 - {'Epoch': 27, 'HR@5': '0.0437', 'NDCG@5': '0.0294', 'HR@10': '0.0626', 'NDCG@10': '0.0355', 'HR@20': '0.0921', 'NDCG@20': '0.0429'}
2025-03-23 16:12:38,942 - EarlyStopping counter: 1 out of 10
2025-03-23 16:13:20,139 - {'epoch': 28, 'rec_loss': '8.3025'}
2025-03-23 16:13:39,420 - {'Epoch': 28, 'HR@5': '0.0438', 'NDCG@5': '0.0295', 'HR@10': '0.0635', 'NDCG@10': '0.0359', 'HR@20': '0.0926', 'NDCG@20': '0.0432'}
2025-03-23 16:13:39,421 - Validation score increased.  Saving model ...
2025-03-23 16:14:19,861 - {'epoch': 29, 'rec_loss': '8.2957'}
2025-03-23 16:14:37,462 - {'Epoch': 29, 'HR@5': '0.0434', 'NDCG@5': '0.0294', 'HR@10': '0.0642', 'NDCG@10': '0.0361', 'HR@20': '0.0943', 'NDCG@20': '0.0436'}
2025-03-23 16:14:37,463 - Validation score increased.  Saving model ...
2025-03-23 16:15:17,333 - {'epoch': 30, 'rec_loss': '8.2807'}
2025-03-23 16:15:36,857 - {'Epoch': 30, 'HR@5': '0.0442', 'NDCG@5': '0.0304', 'HR@10': '0.0646', 'NDCG@10': '0.0369', 'HR@20': '0.0954', 'NDCG@20': '0.0447'}
2025-03-23 16:15:36,862 - Validation score increased.  Saving model ...
2025-03-23 16:16:19,368 - {'epoch': 31, 'rec_loss': '8.2766'}
2025-03-23 16:16:38,787 - {'Epoch': 31, 'HR@5': '0.0442', 'NDCG@5': '0.0301', 'HR@10': '0.0655', 'NDCG@10': '0.0370', 'HR@20': '0.0962', 'NDCG@20': '0.0447'}
2025-03-23 16:16:38,795 - Validation score increased.  Saving model ...
2025-03-23 16:17:20,224 - {'epoch': 32, 'rec_loss': '8.2674'}
2025-03-23 16:17:37,160 - {'Epoch': 32, 'HR@5': '0.0445', 'NDCG@5': '0.0300', 'HR@10': '0.0648', 'NDCG@10': '0.0365', 'HR@20': '0.0964', 'NDCG@20': '0.0444'}
2025-03-23 16:17:37,164 - EarlyStopping counter: 1 out of 10
2025-03-23 16:18:17,842 - {'epoch': 33, 'rec_loss': '8.2572'}
2025-03-23 16:18:36,894 - {'Epoch': 33, 'HR@5': '0.0447', 'NDCG@5': '0.0306', 'HR@10': '0.0661', 'NDCG@10': '0.0374', 'HR@20': '0.0965', 'NDCG@20': '0.0451'}
2025-03-23 16:18:36,895 - Validation score increased.  Saving model ...
2025-03-23 16:19:19,038 - {'epoch': 34, 'rec_loss': '8.2512'}
2025-03-23 16:19:38,082 - {'Epoch': 34, 'HR@5': '0.0445', 'NDCG@5': '0.0302', 'HR@10': '0.0651', 'NDCG@10': '0.0368', 'HR@20': '0.0962', 'NDCG@20': '0.0446'}
2025-03-23 16:19:38,084 - EarlyStopping counter: 1 out of 10
2025-03-23 16:20:20,850 - {'epoch': 35, 'rec_loss': '8.2493'}
2025-03-23 16:20:38,407 - {'Epoch': 35, 'HR@5': '0.0450', 'NDCG@5': '0.0308', 'HR@10': '0.0670', 'NDCG@10': '0.0379', 'HR@20': '0.0977', 'NDCG@20': '0.0456'}
2025-03-23 16:20:38,408 - Validation score increased.  Saving model ...
2025-03-23 16:21:17,734 - {'epoch': 36, 'rec_loss': '8.2439'}
2025-03-23 16:21:37,036 - {'Epoch': 36, 'HR@5': '0.0453', 'NDCG@5': '0.0312', 'HR@10': '0.0680', 'NDCG@10': '0.0385', 'HR@20': '0.0980', 'NDCG@20': '0.0460'}
2025-03-23 16:21:37,040 - Validation score increased.  Saving model ...
2025-03-23 16:22:19,117 - {'epoch': 37, 'rec_loss': '8.2367'}
2025-03-23 16:22:38,641 - {'Epoch': 37, 'HR@5': '0.0449', 'NDCG@5': '0.0305', 'HR@10': '0.0669', 'NDCG@10': '0.0376', 'HR@20': '0.0980', 'NDCG@20': '0.0454'}
2025-03-23 16:22:38,646 - EarlyStopping counter: 1 out of 10
2025-03-23 16:23:20,663 - {'epoch': 38, 'rec_loss': '8.2238'}
2025-03-23 16:23:39,504 - {'Epoch': 38, 'HR@5': '0.0455', 'NDCG@5': '0.0309', 'HR@10': '0.0675', 'NDCG@10': '0.0380', 'HR@20': '0.0976', 'NDCG@20': '0.0456'}
2025-03-23 16:23:39,511 - EarlyStopping counter: 2 out of 10
2025-03-23 16:24:18,849 - {'epoch': 39, 'rec_loss': '8.2241'}
2025-03-23 16:24:35,979 - {'Epoch': 39, 'HR@5': '0.0465', 'NDCG@5': '0.0319', 'HR@10': '0.0681', 'NDCG@10': '0.0389', 'HR@20': '0.0983', 'NDCG@20': '0.0465'}
2025-03-23 16:24:35,985 - Validation score increased.  Saving model ...
2025-03-23 16:25:17,768 - {'epoch': 40, 'rec_loss': '8.2187'}
2025-03-23 16:25:36,851 - {'Epoch': 40, 'HR@5': '0.0465', 'NDCG@5': '0.0318', 'HR@10': '0.0687', 'NDCG@10': '0.0389', 'HR@20': '0.0980', 'NDCG@20': '0.0463'}
2025-03-23 16:25:36,854 - EarlyStopping counter: 1 out of 10
2025-03-23 16:26:19,210 - {'epoch': 41, 'rec_loss': '8.2134'}
2025-03-23 16:26:38,137 - {'Epoch': 41, 'HR@5': '0.0467', 'NDCG@5': '0.0317', 'HR@10': '0.0680', 'NDCG@10': '0.0385', 'HR@20': '0.0980', 'NDCG@20': '0.0461'}
2025-03-23 16:26:38,142 - EarlyStopping counter: 2 out of 10
2025-03-23 16:27:19,615 - {'epoch': 42, 'rec_loss': '8.2062'}
2025-03-23 16:27:36,101 - {'Epoch': 42, 'HR@5': '0.0467', 'NDCG@5': '0.0321', 'HR@10': '0.0681', 'NDCG@10': '0.0389', 'HR@20': '0.0988', 'NDCG@20': '0.0466'}
2025-03-23 16:27:36,102 - Validation score increased.  Saving model ...
2025-03-23 16:28:16,782 - {'epoch': 43, 'rec_loss': '8.2007'}
2025-03-23 16:28:34,370 - {'Epoch': 43, 'HR@5': '0.0462', 'NDCG@5': '0.0316', 'HR@10': '0.0683', 'NDCG@10': '0.0387', 'HR@20': '0.0994', 'NDCG@20': '0.0465'}
2025-03-23 16:28:34,371 - EarlyStopping counter: 1 out of 10
2025-03-23 16:29:17,509 - {'epoch': 44, 'rec_loss': '8.1989'}
2025-03-23 16:29:33,915 - {'Epoch': 44, 'HR@5': '0.0473', 'NDCG@5': '0.0322', 'HR@10': '0.0686', 'NDCG@10': '0.0390', 'HR@20': '0.0995', 'NDCG@20': '0.0468'}
2025-03-23 16:29:33,920 - Validation score increased.  Saving model ...
2025-03-23 16:30:15,285 - {'epoch': 45, 'rec_loss': '8.1944'}
2025-03-23 16:30:31,657 - {'Epoch': 45, 'HR@5': '0.0463', 'NDCG@5': '0.0316', 'HR@10': '0.0685', 'NDCG@10': '0.0388', 'HR@20': '0.0988', 'NDCG@20': '0.0463'}
2025-03-23 16:30:31,661 - EarlyStopping counter: 1 out of 10
2025-03-23 16:31:12,297 - {'epoch': 46, 'rec_loss': '8.1902'}
2025-03-23 16:31:28,714 - {'Epoch': 46, 'HR@5': '0.0471', 'NDCG@5': '0.0322', 'HR@10': '0.0693', 'NDCG@10': '0.0393', 'HR@20': '0.0992', 'NDCG@20': '0.0468'}
2025-03-23 16:31:28,719 - Validation score increased.  Saving model ...
2025-03-23 16:32:10,854 - {'epoch': 47, 'rec_loss': '8.1832'}
2025-03-23 16:32:27,183 - {'Epoch': 47, 'HR@5': '0.0472', 'NDCG@5': '0.0320', 'HR@10': '0.0692', 'NDCG@10': '0.0391', 'HR@20': '0.0992', 'NDCG@20': '0.0466'}
2025-03-23 16:32:27,187 - EarlyStopping counter: 1 out of 10
2025-03-23 16:33:08,767 - {'epoch': 48, 'rec_loss': '8.1804'}
2025-03-23 16:33:25,118 - {'Epoch': 48, 'HR@5': '0.0476', 'NDCG@5': '0.0323', 'HR@10': '0.0700', 'NDCG@10': '0.0395', 'HR@20': '0.1004', 'NDCG@20': '0.0471'}
2025-03-23 16:33:25,119 - Validation score increased.  Saving model ...
2025-03-23 16:34:10,190 - {'epoch': 49, 'rec_loss': '8.1816'}
2025-03-23 16:34:26,740 - {'Epoch': 49, 'HR@5': '0.0472', 'NDCG@5': '0.0326', 'HR@10': '0.0684', 'NDCG@10': '0.0395', 'HR@20': '0.0997', 'NDCG@20': '0.0473'}
2025-03-23 16:34:26,744 - Validation score increased.  Saving model ...
2025-03-23 16:35:08,227 - {'epoch': 50, 'rec_loss': '8.1725'}
2025-03-23 16:35:24,765 - {'Epoch': 50, 'HR@5': '0.0477', 'NDCG@5': '0.0326', 'HR@10': '0.0693', 'NDCG@10': '0.0396', 'HR@20': '0.0993', 'NDCG@20': '0.0471'}
2025-03-23 16:35:24,767 - EarlyStopping counter: 1 out of 10
2025-03-23 16:36:06,324 - {'epoch': 51, 'rec_loss': '8.1704'}
2025-03-23 16:36:22,640 - {'Epoch': 51, 'HR@5': '0.0471', 'NDCG@5': '0.0322', 'HR@10': '0.0687', 'NDCG@10': '0.0392', 'HR@20': '0.0992', 'NDCG@20': '0.0468'}
2025-03-23 16:36:22,641 - EarlyStopping counter: 2 out of 10
2025-03-23 16:37:03,674 - {'epoch': 52, 'rec_loss': '8.1678'}
2025-03-23 16:37:20,033 - {'Epoch': 52, 'HR@5': '0.0475', 'NDCG@5': '0.0325', 'HR@10': '0.0690', 'NDCG@10': '0.0394', 'HR@20': '0.0989', 'NDCG@20': '0.0470'}
2025-03-23 16:37:20,035 - EarlyStopping counter: 3 out of 10
2025-03-23 16:37:59,391 - {'epoch': 53, 'rec_loss': '8.1654'}
2025-03-23 16:38:15,773 - {'Epoch': 53, 'HR@5': '0.0482', 'NDCG@5': '0.0331', 'HR@10': '0.0696', 'NDCG@10': '0.0400', 'HR@20': '0.1008', 'NDCG@20': '0.0478'}
2025-03-23 16:38:15,776 - Validation score increased.  Saving model ...
2025-03-23 16:38:56,889 - {'epoch': 54, 'rec_loss': '8.1657'}
2025-03-23 16:39:13,379 - {'Epoch': 54, 'HR@5': '0.0478', 'NDCG@5': '0.0326', 'HR@10': '0.0695', 'NDCG@10': '0.0395', 'HR@20': '0.0993', 'NDCG@20': '0.0470'}
2025-03-23 16:39:13,380 - EarlyStopping counter: 1 out of 10
2025-03-23 16:39:53,610 - {'epoch': 55, 'rec_loss': '8.1562'}
2025-03-23 16:40:10,137 - {'Epoch': 55, 'HR@5': '0.0483', 'NDCG@5': '0.0330', 'HR@10': '0.0696', 'NDCG@10': '0.0398', 'HR@20': '0.1008', 'NDCG@20': '0.0477'}
2025-03-23 16:40:10,138 - EarlyStopping counter: 2 out of 10
2025-03-23 16:40:50,895 - {'epoch': 56, 'rec_loss': '8.1578'}
2025-03-23 16:41:07,357 - {'Epoch': 56, 'HR@5': '0.0483', 'NDCG@5': '0.0326', 'HR@10': '0.0695', 'NDCG@10': '0.0394', 'HR@20': '0.1001', 'NDCG@20': '0.0471'}
2025-03-23 16:41:07,361 - EarlyStopping counter: 3 out of 10
2025-03-23 16:41:47,552 - {'epoch': 57, 'rec_loss': '8.1557'}
2025-03-23 16:42:04,024 - {'Epoch': 57, 'HR@5': '0.0478', 'NDCG@5': '0.0328', 'HR@10': '0.0696', 'NDCG@10': '0.0398', 'HR@20': '0.1010', 'NDCG@20': '0.0477'}
2025-03-23 16:42:04,029 - EarlyStopping counter: 4 out of 10
2025-03-23 16:42:44,269 - {'epoch': 58, 'rec_loss': '8.1517'}
2025-03-23 16:43:00,746 - {'Epoch': 58, 'HR@5': '0.0474', 'NDCG@5': '0.0325', 'HR@10': '0.0698', 'NDCG@10': '0.0397', 'HR@20': '0.1009', 'NDCG@20': '0.0475'}
2025-03-23 16:43:00,751 - EarlyStopping counter: 5 out of 10
2025-03-23 16:43:39,776 - {'epoch': 59, 'rec_loss': '8.1499'}
2025-03-23 16:43:56,185 - {'Epoch': 59, 'HR@5': '0.0469', 'NDCG@5': '0.0322', 'HR@10': '0.0694', 'NDCG@10': '0.0394', 'HR@20': '0.1004', 'NDCG@20': '0.0472'}
2025-03-23 16:43:56,186 - EarlyStopping counter: 6 out of 10
2025-03-23 16:44:36,989 - {'epoch': 60, 'rec_loss': '8.1417'}
2025-03-23 16:44:53,159 - {'Epoch': 60, 'HR@5': '0.0485', 'NDCG@5': '0.0331', 'HR@10': '0.0706', 'NDCG@10': '0.0402', 'HR@20': '0.1007', 'NDCG@20': '0.0478'}
2025-03-23 16:44:53,161 - EarlyStopping counter: 7 out of 10
2025-03-23 16:45:34,189 - {'epoch': 61, 'rec_loss': '8.1427'}
2025-03-23 16:45:50,467 - {'Epoch': 61, 'HR@5': '0.0484', 'NDCG@5': '0.0329', 'HR@10': '0.0692', 'NDCG@10': '0.0396', 'HR@20': '0.1007', 'NDCG@20': '0.0475'}
2025-03-23 16:45:50,472 - EarlyStopping counter: 8 out of 10
2025-03-23 16:46:30,906 - {'epoch': 62, 'rec_loss': '8.1381'}
2025-03-23 16:46:47,065 - {'Epoch': 62, 'HR@5': '0.0482', 'NDCG@5': '0.0328', 'HR@10': '0.0705', 'NDCG@10': '0.0400', 'HR@20': '0.1007', 'NDCG@20': '0.0476'}
2025-03-23 16:46:47,068 - EarlyStopping counter: 9 out of 10
2025-03-23 16:47:27,120 - {'epoch': 63, 'rec_loss': '8.1382'}
2025-03-23 16:47:43,404 - {'Epoch': 63, 'HR@5': '0.0478', 'NDCG@5': '0.0324', 'HR@10': '0.0694', 'NDCG@10': '0.0393', 'HR@20': '0.1001', 'NDCG@20': '0.0470'}
2025-03-23 16:47:43,407 - EarlyStopping counter: 10 out of 10
2025-03-23 16:47:43,407 - Early stopping
2025-03-23 16:47:43,407 - ---------------Test Score---------------
2025-03-23 16:47:59,761 - {'Epoch': 0, 'HR@5': '0.0377', 'NDCG@5': '0.0254', 'HR@10': '0.0564', 'NDCG@10': '0.0314', 'HR@20': '0.0809', 'NDCG@20': '0.0376'}
2025-03-23 16:47:59,762 - Scale_Sports
2025-03-23 16:47:59,762 - {'Epoch': 0, 'HR@5': '0.0377', 'NDCG@5': '0.0254', 'HR@10': '0.0564', 'NDCG@10': '0.0314', 'HR@20': '0.0809', 'NDCG@20': '0.0376'}
2025-03-23 17:24:47,715 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-03-23 17:24:50,580 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-03-23 17:24:50,585 - Total Parameters: 1328854
2025-03-23 17:25:33,923 - {'epoch': 0, 'rec_loss': '9.4443'}
2025-03-23 17:25:50,697 - {'Epoch': 0, 'HR@5': '0.0082', 'NDCG@5': '0.0053', 'HR@10': '0.0131', 'NDCG@10': '0.0069', 'HR@20': '0.0226', 'NDCG@20': '0.0092'}
2025-03-23 17:25:50,698 - Validation score increased.  Saving model ...
2025-03-23 17:26:31,738 - {'epoch': 1, 'rec_loss': '9.2590'}
2025-03-23 17:26:46,717 - {'Epoch': 1, 'HR@5': '0.0121', 'NDCG@5': '0.0077', 'HR@10': '0.0221', 'NDCG@10': '0.0109', 'HR@20': '0.0356', 'NDCG@20': '0.0143'}
2025-03-23 17:26:46,718 - Validation score increased.  Saving model ...
2025-03-23 17:27:27,050 - {'epoch': 2, 'rec_loss': '9.0212'}
2025-03-23 17:27:42,757 - {'Epoch': 2, 'HR@5': '0.0185', 'NDCG@5': '0.0115', 'HR@10': '0.0299', 'NDCG@10': '0.0151', 'HR@20': '0.0464', 'NDCG@20': '0.0193'}
2025-03-23 17:27:42,760 - Validation score increased.  Saving model ...
2025-03-23 17:28:25,016 - {'epoch': 3, 'rec_loss': '8.8449'}
2025-03-23 17:28:40,672 - {'Epoch': 3, 'HR@5': '0.0233', 'NDCG@5': '0.0149', 'HR@10': '0.0369', 'NDCG@10': '0.0192', 'HR@20': '0.0562', 'NDCG@20': '0.0241'}
2025-03-23 17:28:40,673 - Validation score increased.  Saving model ...
2025-03-23 17:29:22,011 - {'epoch': 4, 'rec_loss': '8.7041'}
2025-03-23 17:29:37,835 - {'Epoch': 4, 'HR@5': '0.0283', 'NDCG@5': '0.0181', 'HR@10': '0.0440', 'NDCG@10': '0.0231', 'HR@20': '0.0669', 'NDCG@20': '0.0289'}
2025-03-23 17:29:37,836 - Validation score increased.  Saving model ...
2025-03-23 17:30:18,972 - {'epoch': 5, 'rec_loss': '8.5770'}
2025-03-23 17:30:35,320 - {'Epoch': 5, 'HR@5': '0.0329', 'NDCG@5': '0.0217', 'HR@10': '0.0511', 'NDCG@10': '0.0275', 'HR@20': '0.0742', 'NDCG@20': '0.0333'}
2025-03-23 17:30:35,322 - Validation score increased.  Saving model ...
2025-03-23 17:31:18,408 - {'epoch': 6, 'rec_loss': '8.4764'}
2025-03-23 17:31:34,668 - {'Epoch': 6, 'HR@5': '0.0364', 'NDCG@5': '0.0242', 'HR@10': '0.0557', 'NDCG@10': '0.0304', 'HR@20': '0.0807', 'NDCG@20': '0.0367'}
2025-03-23 17:31:34,669 - Validation score increased.  Saving model ...
2025-03-23 17:32:16,511 - {'epoch': 7, 'rec_loss': '8.3916'}
2025-03-23 17:32:32,563 - {'Epoch': 7, 'HR@5': '0.0392', 'NDCG@5': '0.0262', 'HR@10': '0.0587', 'NDCG@10': '0.0324', 'HR@20': '0.0850', 'NDCG@20': '0.0391'}
2025-03-23 17:32:32,567 - Validation score increased.  Saving model ...
2025-03-23 17:33:12,377 - {'epoch': 8, 'rec_loss': '8.3267'}
2025-03-23 17:33:28,430 - {'Epoch': 8, 'HR@5': '0.0422', 'NDCG@5': '0.0287', 'HR@10': '0.0619', 'NDCG@10': '0.0349', 'HR@20': '0.0894', 'NDCG@20': '0.0419'}
2025-03-23 17:33:28,432 - Validation score increased.  Saving model ...
2025-03-23 17:34:08,636 - {'epoch': 9, 'rec_loss': '8.2642'}
2025-03-23 17:34:25,012 - {'Epoch': 9, 'HR@5': '0.0436', 'NDCG@5': '0.0300', 'HR@10': '0.0646', 'NDCG@10': '0.0367', 'HR@20': '0.0910', 'NDCG@20': '0.0433'}
2025-03-23 17:34:25,015 - Validation score increased.  Saving model ...
2025-03-23 17:35:05,422 - {'epoch': 10, 'rec_loss': '8.2128'}
2025-03-23 17:35:22,060 - {'Epoch': 10, 'HR@5': '0.0444', 'NDCG@5': '0.0305', 'HR@10': '0.0636', 'NDCG@10': '0.0366', 'HR@20': '0.0923', 'NDCG@20': '0.0439'}
2025-03-23 17:35:22,061 - Validation score increased.  Saving model ...
2025-03-23 17:36:02,522 - {'epoch': 11, 'rec_loss': '8.1718'}
2025-03-23 17:36:18,849 - {'Epoch': 11, 'HR@5': '0.0454', 'NDCG@5': '0.0310', 'HR@10': '0.0656', 'NDCG@10': '0.0375', 'HR@20': '0.0945', 'NDCG@20': '0.0448'}
2025-03-23 17:36:18,851 - Validation score increased.  Saving model ...
2025-03-23 17:37:00,990 - {'epoch': 12, 'rec_loss': '8.1350'}
2025-03-23 17:37:17,444 - {'Epoch': 12, 'HR@5': '0.0458', 'NDCG@5': '0.0317', 'HR@10': '0.0667', 'NDCG@10': '0.0385', 'HR@20': '0.0955', 'NDCG@20': '0.0457'}
2025-03-23 17:37:17,445 - Validation score increased.  Saving model ...
2025-03-23 17:38:00,315 - {'epoch': 13, 'rec_loss': '8.0983'}
2025-03-23 17:38:16,804 - {'Epoch': 13, 'HR@5': '0.0463', 'NDCG@5': '0.0316', 'HR@10': '0.0683', 'NDCG@10': '0.0387', 'HR@20': '0.0987', 'NDCG@20': '0.0463'}
2025-03-23 17:38:16,805 - Validation score increased.  Saving model ...
2025-03-23 17:39:00,815 - {'epoch': 14, 'rec_loss': '8.0714'}
2025-03-23 17:39:16,996 - {'Epoch': 14, 'HR@5': '0.0476', 'NDCG@5': '0.0329', 'HR@10': '0.0697', 'NDCG@10': '0.0400', 'HR@20': '0.0992', 'NDCG@20': '0.0474'}
2025-03-23 17:39:16,998 - Validation score increased.  Saving model ...
2025-03-23 17:39:58,470 - {'epoch': 15, 'rec_loss': '8.0418'}
2025-03-23 17:40:14,932 - {'Epoch': 15, 'HR@5': '0.0475', 'NDCG@5': '0.0332', 'HR@10': '0.0693', 'NDCG@10': '0.0401', 'HR@20': '0.0991', 'NDCG@20': '0.0476'}
2025-03-23 17:40:14,933 - Validation score increased.  Saving model ...
2025-03-23 17:40:55,551 - {'epoch': 16, 'rec_loss': '8.0145'}
2025-03-23 17:41:12,713 - {'Epoch': 16, 'HR@5': '0.0479', 'NDCG@5': '0.0330', 'HR@10': '0.0700', 'NDCG@10': '0.0402', 'HR@20': '0.1002', 'NDCG@20': '0.0478'}
2025-03-23 17:41:12,717 - Validation score increased.  Saving model ...
2025-03-23 17:41:53,324 - {'epoch': 17, 'rec_loss': '7.9904'}
2025-03-23 17:42:09,805 - {'Epoch': 17, 'HR@5': '0.0490', 'NDCG@5': '0.0338', 'HR@10': '0.0710', 'NDCG@10': '0.0409', 'HR@20': '0.1011', 'NDCG@20': '0.0484'}
2025-03-23 17:42:09,808 - Validation score increased.  Saving model ...
2025-03-23 17:42:53,292 - {'epoch': 18, 'rec_loss': '7.9668'}
2025-03-23 17:43:10,030 - {'Epoch': 18, 'HR@5': '0.0491', 'NDCG@5': '0.0340', 'HR@10': '0.0726', 'NDCG@10': '0.0416', 'HR@20': '0.1038', 'NDCG@20': '0.0493'}
2025-03-23 17:43:10,031 - Validation score increased.  Saving model ...
2025-03-23 17:43:51,320 - {'epoch': 19, 'rec_loss': '7.9506'}
2025-03-23 17:44:07,606 - {'Epoch': 19, 'HR@5': '0.0499', 'NDCG@5': '0.0343', 'HR@10': '0.0725', 'NDCG@10': '0.0416', 'HR@20': '0.1038', 'NDCG@20': '0.0495'}
2025-03-23 17:44:07,609 - Validation score increased.  Saving model ...
2025-03-23 17:44:48,503 - {'epoch': 20, 'rec_loss': '7.9354'}
2025-03-23 17:45:05,256 - {'Epoch': 20, 'HR@5': '0.0500', 'NDCG@5': '0.0346', 'HR@10': '0.0731', 'NDCG@10': '0.0420', 'HR@20': '0.1034', 'NDCG@20': '0.0496'}
2025-03-23 17:45:05,257 - Validation score increased.  Saving model ...
2025-03-23 17:45:45,151 - {'epoch': 21, 'rec_loss': '7.9148'}
2025-03-23 17:46:01,539 - {'Epoch': 21, 'HR@5': '0.0489', 'NDCG@5': '0.0340', 'HR@10': '0.0730', 'NDCG@10': '0.0417', 'HR@20': '0.1030', 'NDCG@20': '0.0493'}
2025-03-23 17:46:01,540 - EarlyStopping counter: 1 out of 10
2025-03-23 17:46:43,158 - {'epoch': 22, 'rec_loss': '7.9024'}
2025-03-23 17:46:59,651 - {'Epoch': 22, 'HR@5': '0.0510', 'NDCG@5': '0.0350', 'HR@10': '0.0739', 'NDCG@10': '0.0423', 'HR@20': '0.1042', 'NDCG@20': '0.0499'}
2025-03-23 17:46:59,652 - Validation score increased.  Saving model ...
2025-03-23 17:47:41,098 - {'epoch': 23, 'rec_loss': '7.8874'}
2025-03-23 17:47:57,714 - {'Epoch': 23, 'HR@5': '0.0503', 'NDCG@5': '0.0349', 'HR@10': '0.0737', 'NDCG@10': '0.0423', 'HR@20': '0.1042', 'NDCG@20': '0.0500'}
2025-03-23 17:47:57,716 - Validation score increased.  Saving model ...
2025-03-23 17:48:39,468 - {'epoch': 24, 'rec_loss': '7.8727'}
2025-03-23 17:48:55,994 - {'Epoch': 24, 'HR@5': '0.0508', 'NDCG@5': '0.0350', 'HR@10': '0.0749', 'NDCG@10': '0.0428', 'HR@20': '0.1050', 'NDCG@20': '0.0503'}
2025-03-23 17:48:55,998 - Validation score increased.  Saving model ...
2025-03-23 17:49:36,925 - {'epoch': 25, 'rec_loss': '7.8606'}
2025-03-23 17:49:53,341 - {'Epoch': 25, 'HR@5': '0.0505', 'NDCG@5': '0.0349', 'HR@10': '0.0742', 'NDCG@10': '0.0425', 'HR@20': '0.1061', 'NDCG@20': '0.0505'}
2025-03-23 17:49:53,342 - Validation score increased.  Saving model ...
2025-03-23 17:50:32,819 - {'epoch': 26, 'rec_loss': '7.8495'}
2025-03-23 17:50:49,448 - {'Epoch': 26, 'HR@5': '0.0512', 'NDCG@5': '0.0355', 'HR@10': '0.0740', 'NDCG@10': '0.0428', 'HR@20': '0.1046', 'NDCG@20': '0.0505'}
2025-03-23 17:50:49,450 - Validation score increased.  Saving model ...
2025-03-23 17:51:29,434 - {'epoch': 27, 'rec_loss': '7.8377'}
2025-03-23 17:51:45,896 - {'Epoch': 27, 'HR@5': '0.0516', 'NDCG@5': '0.0352', 'HR@10': '0.0750', 'NDCG@10': '0.0428', 'HR@20': '0.1046', 'NDCG@20': '0.0502'}
2025-03-23 17:51:45,899 - EarlyStopping counter: 1 out of 10
2025-03-23 17:52:27,096 - {'epoch': 28, 'rec_loss': '7.8299'}
2025-03-23 17:52:43,716 - {'Epoch': 28, 'HR@5': '0.0508', 'NDCG@5': '0.0350', 'HR@10': '0.0749', 'NDCG@10': '0.0428', 'HR@20': '0.1048', 'NDCG@20': '0.0503'}
2025-03-23 17:52:43,718 - EarlyStopping counter: 2 out of 10
2025-03-23 17:53:25,784 - {'epoch': 29, 'rec_loss': '7.8200'}
2025-03-23 17:53:42,279 - {'Epoch': 29, 'HR@5': '0.0516', 'NDCG@5': '0.0356', 'HR@10': '0.0756', 'NDCG@10': '0.0434', 'HR@20': '0.1043', 'NDCG@20': '0.0506'}
2025-03-23 17:53:42,280 - Validation score increased.  Saving model ...
2025-03-23 17:54:22,816 - {'epoch': 30, 'rec_loss': '7.8130'}
2025-03-23 17:54:39,524 - {'Epoch': 30, 'HR@5': '0.0522', 'NDCG@5': '0.0353', 'HR@10': '0.0746', 'NDCG@10': '0.0425', 'HR@20': '0.1054', 'NDCG@20': '0.0503'}
2025-03-23 17:54:39,525 - EarlyStopping counter: 1 out of 10
2025-03-23 17:55:20,710 - {'epoch': 31, 'rec_loss': '7.8016'}
2025-03-23 17:55:37,086 - {'Epoch': 31, 'HR@5': '0.0522', 'NDCG@5': '0.0356', 'HR@10': '0.0749', 'NDCG@10': '0.0429', 'HR@20': '0.1058', 'NDCG@20': '0.0507'}
2025-03-23 17:55:37,088 - Validation score increased.  Saving model ...
2025-03-23 17:56:21,002 - {'epoch': 32, 'rec_loss': '7.7883'}
2025-03-23 17:56:37,410 - {'Epoch': 32, 'HR@5': '0.0515', 'NDCG@5': '0.0353', 'HR@10': '0.0754', 'NDCG@10': '0.0430', 'HR@20': '0.1053', 'NDCG@20': '0.0505'}
2025-03-23 17:56:37,411 - EarlyStopping counter: 1 out of 10
2025-03-23 17:57:18,072 - {'epoch': 33, 'rec_loss': '7.7798'}
2025-03-23 17:57:35,484 - {'Epoch': 33, 'HR@5': '0.0523', 'NDCG@5': '0.0361', 'HR@10': '0.0749', 'NDCG@10': '0.0434', 'HR@20': '0.1057', 'NDCG@20': '0.0511'}
2025-03-23 17:57:35,485 - Validation score increased.  Saving model ...
2025-03-23 17:58:18,040 - {'epoch': 34, 'rec_loss': '7.7749'}
2025-03-23 17:58:34,816 - {'Epoch': 34, 'HR@5': '0.0524', 'NDCG@5': '0.0361', 'HR@10': '0.0748', 'NDCG@10': '0.0433', 'HR@20': '0.1058', 'NDCG@20': '0.0511'}
2025-03-23 17:58:34,821 - EarlyStopping counter: 1 out of 10
2025-03-23 17:59:16,222 - {'epoch': 35, 'rec_loss': '7.7662'}
2025-03-23 17:59:33,071 - {'Epoch': 35, 'HR@5': '0.0522', 'NDCG@5': '0.0359', 'HR@10': '0.0759', 'NDCG@10': '0.0436', 'HR@20': '0.1068', 'NDCG@20': '0.0513'}
2025-03-23 17:59:33,074 - Validation score increased.  Saving model ...
2025-03-23 18:00:13,913 - {'epoch': 36, 'rec_loss': '7.7627'}
2025-03-23 18:00:30,203 - {'Epoch': 36, 'HR@5': '0.0527', 'NDCG@5': '0.0362', 'HR@10': '0.0761', 'NDCG@10': '0.0437', 'HR@20': '0.1066', 'NDCG@20': '0.0514'}
2025-03-23 18:00:30,204 - Validation score increased.  Saving model ...
2025-03-23 18:01:12,881 - {'epoch': 37, 'rec_loss': '7.7556'}
2025-03-23 18:01:29,477 - {'Epoch': 37, 'HR@5': '0.0529', 'NDCG@5': '0.0363', 'HR@10': '0.0750', 'NDCG@10': '0.0435', 'HR@20': '0.1064', 'NDCG@20': '0.0514'}
2025-03-23 18:01:29,478 - EarlyStopping counter: 1 out of 10
2025-03-23 18:02:10,243 - {'epoch': 38, 'rec_loss': '7.7480'}
2025-03-23 18:02:26,808 - {'Epoch': 38, 'HR@5': '0.0523', 'NDCG@5': '0.0358', 'HR@10': '0.0758', 'NDCG@10': '0.0434', 'HR@20': '0.1070', 'NDCG@20': '0.0512'}
2025-03-23 18:02:26,809 - EarlyStopping counter: 2 out of 10
2025-03-23 18:03:07,938 - {'epoch': 39, 'rec_loss': '7.7444'}
2025-03-23 18:03:24,152 - {'Epoch': 39, 'HR@5': '0.0520', 'NDCG@5': '0.0358', 'HR@10': '0.0769', 'NDCG@10': '0.0438', 'HR@20': '0.1068', 'NDCG@20': '0.0513'}
2025-03-23 18:03:24,153 - EarlyStopping counter: 3 out of 10
2025-03-23 18:04:05,995 - {'epoch': 40, 'rec_loss': '7.7369'}
2025-03-23 18:04:22,677 - {'Epoch': 40, 'HR@5': '0.0521', 'NDCG@5': '0.0356', 'HR@10': '0.0757', 'NDCG@10': '0.0432', 'HR@20': '0.1069', 'NDCG@20': '0.0510'}
2025-03-23 18:04:22,678 - EarlyStopping counter: 4 out of 10
2025-03-23 18:05:03,546 - {'epoch': 41, 'rec_loss': '7.7305'}
2025-03-23 18:05:20,191 - {'Epoch': 41, 'HR@5': '0.0524', 'NDCG@5': '0.0356', 'HR@10': '0.0759', 'NDCG@10': '0.0432', 'HR@20': '0.1060', 'NDCG@20': '0.0508'}
2025-03-23 18:05:20,195 - EarlyStopping counter: 5 out of 10
2025-03-23 18:06:00,711 - {'epoch': 42, 'rec_loss': '7.7262'}
2025-03-23 18:06:17,270 - {'Epoch': 42, 'HR@5': '0.0524', 'NDCG@5': '0.0359', 'HR@10': '0.0760', 'NDCG@10': '0.0435', 'HR@20': '0.1078', 'NDCG@20': '0.0515'}
2025-03-23 18:06:17,271 - Validation score increased.  Saving model ...
2025-03-23 18:06:58,386 - {'epoch': 43, 'rec_loss': '7.7164'}
2025-03-23 18:07:14,914 - {'Epoch': 43, 'HR@5': '0.0522', 'NDCG@5': '0.0354', 'HR@10': '0.0762', 'NDCG@10': '0.0431', 'HR@20': '0.1068', 'NDCG@20': '0.0508'}
2025-03-23 18:07:14,915 - EarlyStopping counter: 1 out of 10
2025-03-23 18:07:55,235 - {'epoch': 44, 'rec_loss': '7.7149'}
2025-03-23 18:08:12,020 - {'Epoch': 44, 'HR@5': '0.0533', 'NDCG@5': '0.0366', 'HR@10': '0.0761', 'NDCG@10': '0.0439', 'HR@20': '0.1077', 'NDCG@20': '0.0519'}
2025-03-23 18:08:12,021 - Validation score increased.  Saving model ...
2025-03-23 18:08:53,168 - {'epoch': 45, 'rec_loss': '7.7094'}
2025-03-23 18:09:09,644 - {'Epoch': 45, 'HR@5': '0.0517', 'NDCG@5': '0.0356', 'HR@10': '0.0758', 'NDCG@10': '0.0434', 'HR@20': '0.1078', 'NDCG@20': '0.0514'}
2025-03-23 18:09:09,645 - EarlyStopping counter: 1 out of 10
2025-03-23 18:09:50,073 - {'epoch': 46, 'rec_loss': '7.7035'}
2025-03-23 18:10:07,609 - {'Epoch': 46, 'HR@5': '0.0528', 'NDCG@5': '0.0361', 'HR@10': '0.0761', 'NDCG@10': '0.0436', 'HR@20': '0.1073', 'NDCG@20': '0.0514'}
2025-03-23 18:10:07,610 - EarlyStopping counter: 2 out of 10
2025-03-23 18:10:48,712 - {'epoch': 47, 'rec_loss': '7.7037'}
2025-03-23 18:11:05,130 - {'Epoch': 47, 'HR@5': '0.0530', 'NDCG@5': '0.0364', 'HR@10': '0.0753', 'NDCG@10': '0.0435', 'HR@20': '0.1076', 'NDCG@20': '0.0516'}
2025-03-23 18:11:05,134 - EarlyStopping counter: 3 out of 10
2025-03-23 18:11:45,849 - {'epoch': 48, 'rec_loss': '7.6978'}
2025-03-23 18:12:02,982 - {'Epoch': 48, 'HR@5': '0.0521', 'NDCG@5': '0.0357', 'HR@10': '0.0757', 'NDCG@10': '0.0433', 'HR@20': '0.1068', 'NDCG@20': '0.0511'}
2025-03-23 18:12:02,985 - EarlyStopping counter: 4 out of 10
2025-03-23 18:12:44,135 - {'epoch': 49, 'rec_loss': '7.6919'}
2025-03-23 18:13:01,400 - {'Epoch': 49, 'HR@5': '0.0523', 'NDCG@5': '0.0359', 'HR@10': '0.0761', 'NDCG@10': '0.0436', 'HR@20': '0.1077', 'NDCG@20': '0.0516'}
2025-03-23 18:13:01,401 - EarlyStopping counter: 5 out of 10
2025-03-23 18:13:40,595 - {'epoch': 50, 'rec_loss': '7.6870'}
2025-03-23 18:13:57,879 - {'Epoch': 50, 'HR@5': '0.0531', 'NDCG@5': '0.0365', 'HR@10': '0.0761', 'NDCG@10': '0.0439', 'HR@20': '0.1072', 'NDCG@20': '0.0517'}
2025-03-23 18:13:57,882 - EarlyStopping counter: 6 out of 10
2025-03-23 18:14:40,392 - {'epoch': 51, 'rec_loss': '7.6846'}
2025-03-23 18:14:56,882 - {'Epoch': 51, 'HR@5': '0.0532', 'NDCG@5': '0.0363', 'HR@10': '0.0752', 'NDCG@10': '0.0434', 'HR@20': '0.1081', 'NDCG@20': '0.0516'}
2025-03-23 18:14:56,884 - EarlyStopping counter: 7 out of 10
2025-03-23 18:15:39,048 - {'epoch': 52, 'rec_loss': '7.6815'}
2025-03-23 18:15:55,580 - {'Epoch': 52, 'HR@5': '0.0527', 'NDCG@5': '0.0360', 'HR@10': '0.0752', 'NDCG@10': '0.0432', 'HR@20': '0.1074', 'NDCG@20': '0.0513'}
2025-03-23 18:15:55,583 - EarlyStopping counter: 8 out of 10
2025-03-23 18:16:37,285 - {'epoch': 53, 'rec_loss': '7.6787'}
2025-03-23 18:16:54,584 - {'Epoch': 53, 'HR@5': '0.0532', 'NDCG@5': '0.0364', 'HR@10': '0.0754', 'NDCG@10': '0.0435', 'HR@20': '0.1079', 'NDCG@20': '0.0517'}
2025-03-23 18:16:54,588 - EarlyStopping counter: 9 out of 10
2025-03-23 18:17:40,112 - {'epoch': 54, 'rec_loss': '7.6747'}
2025-03-23 18:17:56,676 - {'Epoch': 54, 'HR@5': '0.0524', 'NDCG@5': '0.0363', 'HR@10': '0.0755', 'NDCG@10': '0.0437', 'HR@20': '0.1082', 'NDCG@20': '0.0519'}
2025-03-23 18:17:56,677 - EarlyStopping counter: 10 out of 10
2025-03-23 18:17:56,678 - Early stopping
2025-03-23 18:17:56,678 - ---------------Test Score---------------
2025-03-23 18:18:13,281 - {'Epoch': 0, 'HR@5': '0.0419', 'NDCG@5': '0.0285', 'HR@10': '0.0616', 'NDCG@10': '0.0349', 'HR@20': '0.0881', 'NDCG@20': '0.0415'}
2025-03-23 18:18:13,285 - Scale_Sports
2025-03-23 18:18:13,285 - {'Epoch': 0, 'HR@5': '0.0419', 'NDCG@5': '0.0285', 'HR@10': '0.0616', 'NDCG@10': '0.0349', 'HR@20': '0.0881', 'NDCG@20': '0.0415'}
2025-04-02 23:05:10,344 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-04-02 23:05:19,274 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-04-02 23:05:19,362 - Total Parameters: 1328854
2025-04-02 23:07:54,791 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-04-02 23:07:59,724 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-04-02 23:07:59,751 - Total Parameters: 1328854
2025-04-02 23:09:17,438 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-04-02 23:09:22,811 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-04-02 23:09:22,818 - Total Parameters: 1328854
2025-04-02 23:10:47,447 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-04-02 23:10:51,352 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-04-02 23:10:51,368 - Total Parameters: 1328854
2025-04-02 23:12:41,371 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-04-02 23:12:46,846 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-04-02 23:12:46,959 - Total Parameters: 1328854
2025-04-02 23:16:09,403 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-04-02 23:16:14,826 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-04-02 23:16:14,862 - Total Parameters: 1328854
2025-04-02 23:17:26,985 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-04-02 23:17:32,230 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-04-02 23:17:32,258 - Total Parameters: 1328854
2025-04-02 23:22:20,307 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='Scale_Sports', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='scalerec', max_seq_length=50, hidden_size=64, num_hidden_layers=1, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, scales=[25, 10], kernels=[2, 3, 4], start_prob=0.3, end_prob=0.6, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/Scale_Sports.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-04-02 23:22:25,520 - ScaleRecModel(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
          (decomp): series_decomp_multi(
            (layer): Linear(in_features=1, out_features=3, bias=True)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
          (mask): QueryAdaptiveMasking()
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (cross_attens): CrossAttentionBlock(
    (layer): CrossAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (self_attens): TransformerBlock(
    (layer): MultiHeadAttention(
      (query): Linear(in_features=64, out_features=64, bias=True)
      (key): Linear(in_features=64, out_features=64, bias=True)
      (value): Linear(in_features=64, out_features=64, bias=True)
      (softmax): Softmax(dim=-1)
      (attn_dropout): Dropout(p=0.5, inplace=False)
      (dense): Linear(in_features=64, out_features=64, bias=True)
      (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      (out_dropout): Dropout(p=0.5, inplace=False)
      (decomp): series_decomp_multi(
        (layer): Linear(in_features=1, out_features=3, bias=True)
      )
    )
    (feed_forward): FeedForward(
      (dense_1): Linear(in_features=64, out_features=256, bias=True)
      (dense_2): Linear(in_features=256, out_features=64, bias=True)
      (LayerNorm): LayerNorm()
      (dropout): Dropout(p=0.5, inplace=False)
      (mask): QueryAdaptiveMasking()
    )
  )
  (guass): GaussianKernel(
    (W): Linear(in_features=64, out_features=10, bias=True)
    (softmax): Softmax(dim=-1)
  )
  (drop_scale): QueryAdaptiveMasking()
)
2025-04-02 23:22:25,602 - Total Parameters: 1328854
